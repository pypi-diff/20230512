# Comparing `tmp/genio_tools-1.4a1.dev9-py3-none-any.whl.zip` & `tmp/genio_tools-1.4a2-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,27 +1,27 @@
-Zip file size: 24685 bytes, number of entries: 25
--rw-rw-r--  2.0 unx      570 b- defN 23-May-03 12:11 aiot/__init__.py
--rw-rw-r--  2.0 unx     1088 b- defN 23-May-03 11:13 aiot/app.py
--rw-rw-r--  2.0 unx     4953 b- defN 23-May-03 12:11 aiot/board.py
--rw-rw-r--  2.0 unx     1973 b- defN 23-May-03 12:11 aiot/boardcontrol_linux.py
--rw-rw-r--  2.0 unx     2472 b- defN 23-May-03 12:11 aiot/boardcontrol_win.py
--rw-rw-r--  2.0 unx     2460 b- defN 23-May-03 09:03 aiot/bootrom.py
--rw-rw-r--  2.0 unx     3402 b- defN 23-May-03 09:03 aiot/config.py
--rw-rw-r--  2.0 unx     4040 b- defN 23-May-03 09:03 aiot/efuse.py
--rw-rw-r--  2.0 unx     1306 b- defN 23-May-03 09:03 aiot/fastboot.py
--rw-rw-r--  2.0 unx     9131 b- defN 23-May-03 12:11 aiot/flash.py
--rw-rw-r--  2.0 unx     1377 b- defN 23-May-03 09:03 aiot/ftdi.py
--rw-rw-r--  2.0 unx     3861 b- defN 23-May-03 12:11 aiot/ftdi_win.py
--rw-rw-r--  2.0 unx      800 b- defN 23-May-03 09:03 aiot/rpmb.py
--rw-rw-r--  2.0 unx     2665 b- defN 23-May-03 11:27 aiot/ubootenv.py
--rw-rw-r--  2.0 unx      170 b- defN 23-May-03 12:12 aiot/version.py
--rw-rw-r--  2.0 unx      126 b- defN 23-May-03 09:03 aiot/image/__init__.py
--rw-rw-r--  2.0 unx     2406 b- defN 23-May-03 11:27 aiot/image/android.py
--rw-rw-r--  2.0 unx     6736 b- defN 23-May-03 11:27 aiot/image/ubuntu.py
--rw-rw-r--  2.0 unx     9127 b- defN 23-May-03 11:27 aiot/image/yocto.py
--rw-rw-r--  2.0 unx     1091 b- defN 23-May-03 12:12 genio_tools-1.4a1.dev9.dist-info/LICENSE
--rw-rw-r--  2.0 unx      931 b- defN 23-May-03 12:12 genio_tools-1.4a1.dev9.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-May-03 12:12 genio_tools-1.4a1.dev9.dist-info/WHEEL
--rw-rw-r--  2.0 unx      334 b- defN 23-May-03 12:12 genio_tools-1.4a1.dev9.dist-info/entry_points.txt
--rw-rw-r--  2.0 unx        5 b- defN 23-May-03 12:12 genio_tools-1.4a1.dev9.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1927 b- defN 23-May-03 12:12 genio_tools-1.4a1.dev9.dist-info/RECORD
-25 files, 63043 bytes uncompressed, 21629 bytes compressed:  65.7%
+Zip file size: 25074 bytes, number of entries: 25
+-rw-rw-r--  2.0 unx      570 b- defN 23-May-11 10:18 aiot/__init__.py
+-rw-rw-r--  2.0 unx     1088 b- defN 23-May-11 10:18 aiot/app.py
+-rw-rw-r--  2.0 unx     4953 b- defN 23-May-11 10:18 aiot/board.py
+-rw-rw-r--  2.0 unx     1973 b- defN 23-May-11 10:18 aiot/boardcontrol_linux.py
+-rw-rw-r--  2.0 unx     2472 b- defN 23-May-11 10:18 aiot/boardcontrol_win.py
+-rw-rw-r--  2.0 unx     2460 b- defN 23-Mar-26 14:11 aiot/bootrom.py
+-rw-rw-r--  2.0 unx     3402 b- defN 23-Mar-26 14:11 aiot/config.py
+-rw-rw-r--  2.0 unx     4040 b- defN 23-Mar-26 14:11 aiot/efuse.py
+-rw-rw-r--  2.0 unx     1306 b- defN 23-Mar-26 14:11 aiot/fastboot.py
+-rw-rw-r--  2.0 unx     9504 b- defN 23-May-11 10:18 aiot/flash.py
+-rw-rw-r--  2.0 unx     1377 b- defN 23-Mar-26 14:11 aiot/ftdi.py
+-rw-rw-r--  2.0 unx     3861 b- defN 23-May-11 10:18 aiot/ftdi_win.py
+-rw-rw-r--  2.0 unx      800 b- defN 23-Mar-26 14:11 aiot/rpmb.py
+-rw-rw-r--  2.0 unx     3440 b- defN 23-May-12 08:25 aiot/ubootenv.py
+-rw-rw-r--  2.0 unx      157 b- defN 23-May-12 08:27 aiot/version.py
+-rw-rw-r--  2.0 unx      126 b- defN 23-Mar-26 14:11 aiot/image/__init__.py
+-rw-rw-r--  2.0 unx     2406 b- defN 23-May-11 10:18 aiot/image/android.py
+-rw-rw-r--  2.0 unx     6789 b- defN 23-May-11 10:18 aiot/image/ubuntu.py
+-rw-rw-r--  2.0 unx     9181 b- defN 23-May-11 10:18 aiot/image/yocto.py
+-rw-rw-r--  2.0 unx     1091 b- defN 23-May-12 08:27 genio_tools-1.4a2.dist-info/LICENSE
+-rw-rw-r--  2.0 unx      926 b- defN 23-May-12 08:27 genio_tools-1.4a2.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-May-12 08:27 genio_tools-1.4a2.dist-info/WHEEL
+-rw-rw-r--  2.0 unx      334 b- defN 23-May-12 08:27 genio_tools-1.4a2.dist-info/entry_points.txt
+-rw-rw-r--  2.0 unx        5 b- defN 23-May-12 08:27 genio_tools-1.4a2.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     1897 b- defN 23-May-12 08:27 genio_tools-1.4a2.dist-info/RECORD
+25 files, 64250 bytes uncompressed, 22078 bytes compressed:  65.6%
```

## zipnote {}

```diff
@@ -51,26 +51,26 @@
 
 Filename: aiot/image/ubuntu.py
 Comment: 
 
 Filename: aiot/image/yocto.py
 Comment: 
 
-Filename: genio_tools-1.4a1.dev9.dist-info/LICENSE
+Filename: genio_tools-1.4a2.dist-info/LICENSE
 Comment: 
 
-Filename: genio_tools-1.4a1.dev9.dist-info/METADATA
+Filename: genio_tools-1.4a2.dist-info/METADATA
 Comment: 
 
-Filename: genio_tools-1.4a1.dev9.dist-info/WHEEL
+Filename: genio_tools-1.4a2.dist-info/WHEEL
 Comment: 
 
-Filename: genio_tools-1.4a1.dev9.dist-info/entry_points.txt
+Filename: genio_tools-1.4a2.dist-info/entry_points.txt
 Comment: 
 
-Filename: genio_tools-1.4a1.dev9.dist-info/top_level.txt
+Filename: genio_tools-1.4a2.dist-info/top_level.txt
 Comment: 
 
-Filename: genio_tools-1.4a1.dev9.dist-info/RECORD
+Filename: genio_tools-1.4a2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## aiot/flash.py

```diff
@@ -129,14 +129,19 @@
             default = 4096, 
             type = lambda num: int(num, 0),
             help = 'Size of the U-Boot environment storage. Default to 4096 bytes.')
         group.add_argument('--uboot-env-redund-offset', 
             default = -1,
             type = lambda num: int(num, 0),
             help = 'Enable U-Boot redundant env generation and assign offset of the redundant data. No redundant env by default.')
+        group.add_argument('-e', '--uboot-env-set',
+            nargs='+',
+            metavar="KEY=VALUE",
+            help='Update or add U-Boot env variables using one or more KEY=VALUE pair. e.g. `-e boot_targets=ebbr ethaddr=00:11:22:33:44:55. '
+                 'Use double quote for VALUE if there are space characters, e.g. `-e boot_prefixes="/ /boot /oemboot"`.')
 
     def add_firmware_group(self, parser):
         group = parser.add_argument_group('Firmware')
         group.add_argument('--serialno', type=str, \
             help="Customize serial number used in adb and fastboot, e.g. the result of 'adb devices'\n"
                  "This is not the serial used by 'aiot-board -s' and 'aiot-flash -s',"
                  "which is FTDI serial connected to UART0.")
```

## aiot/ubootenv.py

```diff
@@ -14,22 +14,41 @@
         self.env_size = env_size
         with open(env_file, "r") as env:
             self.env = env.readlines()
 
     def add(self, name, value):
         self.env.append("{}={}".format(name, value))
 
+    def update_env_list(self, uboot_env_set):
+        '''
+        Takes a list of "KEY=VALUE" string and update/add u-boot env vars
+        accordings. This is primarily for the --uboot-env-set arg.
+        '''
+        if not uboot_env_set:
+            return
+        for pair in uboot_env_set:
+            try:
+                k, v = pair.split("=")
+                if not self.update(k, v):
+                    self.add(k, v)
+                    self.logger.info(f"Adding new uboot env: {k}={v}")
+            except ValueError:
+                self.logger.warn(f"Skipped malformed uboot env pair: '{pair}'")
+
     def update(self, name, value):
         new_env = []
+        updated = False
         for line in self.env:
             if line.startswith(name + '='):
                 new_env.append("{}={}".format(name, value))
+                updated = True
             else:
                 new_env.append(line)
         self.env = new_env
+        return updated
 
     def write_env(self, out, redund_id=-1):
             pos = out.tell()
 
             out.seek(pos + 4)
 
             if redund_id >= 0:
@@ -53,14 +72,17 @@
             crc = zlib.crc32(out.read(self.env_size - 4)) & 0xffffffff
 
             # Write CRC
             out.seek(pos)
             out.write(struct.pack("I", crc))
 
     def write_binary(self, filename = "u-boot-env.bin", redund_offset=-1):
+        for line in self.env:
+            self.logger.debug(f"(env) {line.strip()}")
+
         with open(filename, "w+b") as out:
             redund_id = -1
 
             if redund_offset != -1:
                 redund_id = 0
 
             self.write_env(out, redund_id)
```

## aiot/version.py

```diff
@@ -1,4 +1,4 @@
 # file generated by setuptools_scm
 # don't change, don't track in version control
-__version__ = version = '1.4a1.dev9'
-__version_tuple__ = version_tuple = (1, 4, 'dev9')
+__version__ = version = '1.4a2'
+__version_tuple__ = version_tuple = (1, 4)
```

## aiot/image/ubuntu.py

```diff
@@ -143,14 +143,15 @@
             hdr_crc32 = binascii.crc32(mbr.read(92))
             mbr.seek(528)
             mbr.write(struct.pack("<I", hdr_crc32))
 
     def generate_uboot_env(self):
         env = aiot.UBootEnv(int(self.uboot_env_size), f"{self.path}/u-boot-initial-env")
         env.gen_mac_addr(self.eth_oui, self.num_of_eth)
+        env.update_env_list(self.args.uboot_env_set)
         if not self.uboot_env_redund_support:
             self.uboot_env_redund_offset = -1
         env.write_binary(f"{self.path}/u-boot-env.bin", self.uboot_env_redund_offset)
 
     @classmethod
     def detect(cls, path):
         return os.path.exists(f"{path}/ubuntu.json")
```

## aiot/image/yocto.py

```diff
@@ -139,14 +139,16 @@
     def generate_uboot_env(self):
         env = aiot.UBootEnv(self.args.uboot_env_size,
                             f"{self.path}/u-boot-initial-env")
 
         if self.args.serialno:
             env.add("serial#", self.args.serialno)
 
+        env.update_env_list(self.args.uboot_env_set)
+
         if len(self.kernel_dtbo_autoload) > 0:
             boot_conf = f"#conf-{self.kernel_dtb.replace('/', '_')}"
             list_dtbo = ""
             for dtbo in self.kernel_dtbo_autoload:
                 boot_conf += f"#conf-{dtbo}"
                 list_dtbo += f"{dtbo} "
             env.update('boot_conf', boot_conf)
```

## Comparing `genio_tools-1.4a1.dev9.dist-info/LICENSE` & `genio_tools-1.4a2.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `genio_tools-1.4a1.dev9.dist-info/METADATA` & `genio_tools-1.4a2.dist-info/METADATA`

 * *Files 12% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: genio-tools
-Version: 1.4a1.dev9
+Version: 1.4a2
 Summary: Tools for flashing boards using MediaTek Genio SoCs
 Home-page: https://gitlab.com/mediatek/aiot/bsp/genio-tools
 Author: Fabien Parent
 Maintainer: Pablo Sun
 Maintainer-email: pablo.sun@mediatek.com
 License: UNKNOWN
 Platform: UNKNOWN
```

