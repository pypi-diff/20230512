# Comparing `tmp/dask-2023.4.1.tar.gz` & `tmp/dask-2023.5.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dask-2023.4.1.tar", last modified: Fri Apr 28 17:30:05 2023, max compression
+gzip compressed data, was "dask-2023.5.0.tar", last modified: Fri May 12 15:53:17 2023, max compression
```

## Comparing `dask-2023.4.1.tar` & `dask-2023.5.0.tar`

### file list

```diff
@@ -1,486 +1,486 @@
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.892868 dask-2023.4.1/
--rw-r--r--   0 james      (501) staff       (20)     1531 2022-10-24 20:44:15.000000 dask-2023.4.1/LICENSE.txt
--rw-r--r--   0 james      (501) staff       (20)      325 2022-11-09 22:20:24.000000 dask-2023.4.1/MANIFEST.in
--rw-r--r--   0 james      (501) staff       (20)     2582 2023-04-28 17:30:05.892202 dask-2023.4.1/PKG-INFO
--rw-r--r--   0 james      (501) staff       (20)     1291 2022-11-09 22:20:24.000000 dask-2023.4.1/README.rst
--rw-r--r--   0 james      (501) staff       (20)     2361 2023-04-26 17:05:49.000000 dask-2023.4.1/conftest.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.893501 dask-2023.4.1/dask/
--rw-r--r--   0 james      (501) staff       (20)      428 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/__init__.py
--rw-r--r--   0 james      (501) staff       (20)       97 2023-03-13 17:40:24.000000 dask-2023.4.1/dask/__main__.py
--rw-r--r--   0 james      (501) staff       (20)      607 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/_compatibility.py
--rw-r--r--   0 james      (501) staff       (20)      500 2023-04-28 17:30:05.893655 dask-2023.4.1/dask/_version.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.324088 dask-2023.4.1/dask/array/
--rw-r--r--   0 james      (501) staff       (20)     1543 2021-06-08 02:50:30.000000 dask-2023.4.1/dask/array/NUMPY_LICENSE.txt
--rw-r--r--   0 james      (501) staff       (20)     5377 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12564 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/backends.py
--rw-r--r--   0 james      (501) staff       (20)     9865 2023-03-14 21:35:42.000000 dask-2023.4.1/dask/array/blockwise.py
--rw-r--r--   0 james      (501) staff       (20)    12268 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/chunk.py
--rw-r--r--   0 james      (501) staff       (20)     5030 2022-11-14 20:10:31.000000 dask-2023.4.1/dask/array/chunk_types.py
--rw-r--r--   0 james      (501) staff       (20)   190909 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/core.py
--rw-r--r--   0 james      (501) staff       (20)    40564 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/creation.py
--rw-r--r--   0 james      (501) staff       (20)     2078 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/cupy_entry_point.py
--rw-r--r--   0 james      (501) staff       (20)      490 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/dispatch.py
--rw-r--r--   0 james      (501) staff       (20)     9153 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/einsumfuncs.py
--rw-r--r--   0 james      (501) staff       (20)     7216 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/fft.py
--rw-r--r--   0 james      (501) staff       (20)    32620 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/gufunc.py
--rw-r--r--   0 james      (501) staff       (20)     1960 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/image.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.325731 dask-2023.4.1/dask/array/lib/
--rw-r--r--   0 james      (501) staff       (20)       41 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/lib/__init__.py
--rw-r--r--   0 james      (501) staff       (20)       65 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/lib/stride_tricks.py
--rw-r--r--   0 james      (501) staff       (20)    53299 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/linalg.py
--rw-r--r--   0 james      (501) staff       (20)     6327 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/ma.py
--rw-r--r--   0 james      (501) staff       (20)     5663 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/numpy_compat.py
--rw-r--r--   0 james      (501) staff       (20)    12811 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/optimization.py
--rw-r--r--   0 james      (501) staff       (20)    28444 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/overlap.py
--rw-r--r--   0 james      (501) staff       (20)    10616 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/percentile.py
--rw-r--r--   0 james      (501) staff       (20)    40795 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/random.py
--rw-r--r--   0 james      (501) staff       (20)    27183 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/rechunk.py
--rw-r--r--   0 james      (501) staff       (20)    57251 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/reductions.py
--rw-r--r--   0 james      (501) staff       (20)    10729 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/reshape.py
--rw-r--r--   0 james      (501) staff       (20)    81898 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/routines.py
--rw-r--r--   0 james      (501) staff       (20)    72595 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/slicing.py
--rw-r--r--   0 james      (501) staff       (20)    14578 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/stats.py
--rw-r--r--   0 james      (501) staff       (20)     8012 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/array/svg.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.377364 dask-2023.4.1/dask/array/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/array/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)   161425 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_array_core.py
--rw-r--r--   0 james      (501) staff       (20)     6653 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_array_function.py
--rw-r--r--   0 james      (501) staff       (20)     3123 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/tests/test_array_utils.py
--rw-r--r--   0 james      (501) staff       (20)    23186 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_atop.py
--rw-r--r--   0 james      (501) staff       (20)     3055 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/array/tests/test_chunk.py
--rw-r--r--   0 james      (501) staff       (20)    31114 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_creation.py
--rw-r--r--   0 james      (501) staff       (20)    19852 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_core.py
--rw-r--r--   0 james      (501) staff       (20)     6420 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_creation.py
--rw-r--r--   0 james      (501) staff       (20)      558 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_gufunc.py
--rw-r--r--   0 james      (501) staff       (20)    13376 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_linalg.py
--rw-r--r--   0 james      (501) staff       (20)     4267 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/tests/test_cupy_overlap.py
--rw-r--r--   0 james      (501) staff       (20)     2826 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_percentile.py
--rw-r--r--   0 james      (501) staff       (20)     6443 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_cupy_random.py
--rw-r--r--   0 james      (501) staff       (20)     2188 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_reductions.py
--rw-r--r--   0 james      (501) staff       (20)     7401 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_routines.py
--rw-r--r--   0 james      (501) staff       (20)     4841 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_cupy_slicing.py
--rw-r--r--   0 james      (501) staff       (20)     2946 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_cupy_sparse.py
--rw-r--r--   0 james      (501) staff       (20)     8829 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_dispatch.py
--rw-r--r--   0 james      (501) staff       (20)     8401 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/array/tests/test_fft.py
--rw-r--r--   0 james      (501) staff       (20)    20977 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_gufunc.py
--rw-r--r--   0 james      (501) staff       (20)     1446 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/array/tests/test_image.py
--rw-r--r--   0 james      (501) staff       (20)    36412 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_linalg.py
--rw-r--r--   0 james      (501) staff       (20)    15599 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_masked.py
--rw-r--r--   0 james      (501) staff       (20)     1051 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/array/tests/test_numpy_compat.py
--rw-r--r--   0 james      (501) staff       (20)    17410 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_optimization.py
--rw-r--r--   0 james      (501) staff       (20)    26682 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_overlap.py
--rw-r--r--   0 james      (501) staff       (20)     3407 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_percentiles.py
--rw-r--r--   0 james      (501) staff       (20)    15467 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_random.py
--rw-r--r--   0 james      (501) staff       (20)    33636 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_rechunk.py
--rw-r--r--   0 james      (501) staff       (20)    32720 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_reductions.py
--rw-r--r--   0 james      (501) staff       (20)     7253 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/array/tests/test_reshape.py
--rw-r--r--   0 james      (501) staff       (20)    83813 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_routines.py
--rw-r--r--   0 james      (501) staff       (20)    32266 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/tests/test_slicing.py
--rw-r--r--   0 james      (501) staff       (20)     6556 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/tests/test_sparse.py
--rw-r--r--   0 james      (501) staff       (20)     5453 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_stats.py
--rw-r--r--   0 james      (501) staff       (20)     2704 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/array/tests/test_svg.py
--rw-r--r--   0 james      (501) staff       (20)      489 2023-03-13 17:40:24.000000 dask-2023.4.1/dask/array/tests/test_testing.py
--rw-r--r--   0 james      (501) staff       (20)    17354 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_ufunc.py
--rw-r--r--   0 james      (501) staff       (20)     2670 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/tests/test_wrap.py
--rw-r--r--   0 james      (501) staff       (20)     1281 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/tests/test_xarray.py
--rw-r--r--   0 james      (501) staff       (20)     4701 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/array/tiledb_io.py
--rw-r--r--   0 james      (501) staff       (20)     9907 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/array/ufunc.py
--rw-r--r--   0 james      (501) staff       (20)    18638 2023-03-03 18:04:26.000000 dask-2023.4.1/dask/array/utils.py
--rw-r--r--   0 james      (501) staff       (20)     6870 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/array/wrap.py
--rw-r--r--   0 james      (501) staff       (20)     4909 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/backends.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.384143 dask-2023.4.1/dask/bag/
--rw-r--r--   0 james      (501) staff       (20)      867 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bag/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     9075 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bag/avro.py
--rw-r--r--   0 james      (501) staff       (20)      726 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/bag/chunk.py
--rw-r--r--   0 james      (501) staff       (20)    84624 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/bag/core.py
--rw-r--r--   0 james      (501) staff       (20)     5428 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bag/random.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.390413 dask-2023.4.1/dask/bag/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/bag/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     3772 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/bag/tests/test_avro.py
--rw-r--r--   0 james      (501) staff       (20)    49657 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/bag/tests/test_bag.py
--rw-r--r--   0 james      (501) staff       (20)     6492 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bag/tests/test_random.py
--rw-r--r--   0 james      (501) staff       (20)     5013 2023-03-13 17:40:24.000000 dask-2023.4.1/dask/bag/tests/test_text.py
--rw-r--r--   0 james      (501) staff       (20)     6729 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bag/text.py
--rw-r--r--   0 james      (501) staff       (20)      204 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/bag/utils.py
--rw-r--r--   0 james      (501) staff       (20)    52102 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/base.py
--rw-r--r--   0 james      (501) staff       (20)    52987 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/blockwise.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.393371 dask-2023.4.1/dask/bytes/
--rw-r--r--   0 james      (501) staff       (20)       39 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bytes/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     6897 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/bytes/core.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.401112 dask-2023.4.1/dask/bytes/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/bytes/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     5122 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/bytes/tests/test_bytes_utils.py
--rw-r--r--   0 james      (501) staff       (20)      494 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/bytes/tests/test_compression.py
--rw-r--r--   0 james      (501) staff       (20)     6657 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/bytes/tests/test_http.py
--rw-r--r--   0 james      (501) staff       (20)    11440 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/bytes/tests/test_local.py
--rw-r--r--   0 james      (501) staff       (20)    19631 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/bytes/tests/test_s3.py
--rw-r--r--   0 james      (501) staff       (20)      464 2021-11-11 20:27:17.000000 dask-2023.4.1/dask/bytes/utils.py
--rw-r--r--   0 james      (501) staff       (20)     1965 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/cache.py
--rw-r--r--   0 james      (501) staff       (20)     4067 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/callbacks.py
--rw-r--r--   0 james      (501) staff       (20)     3028 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/cli.py
--rw-r--r--   0 james      (501) staff       (20)      487 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/compatibility.py
--rw-r--r--   0 james      (501) staff       (20)    21645 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/config.py
--rw-r--r--   0 james      (501) staff       (20)     1720 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/context.py
--rw-r--r--   0 james      (501) staff       (20)    14797 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/core.py
--rw-r--r--   0 james      (501) staff       (20)     6944 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dask-schema.yaml
--rw-r--r--   0 james      (501) staff       (20)     1498 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dask.yaml
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.428717 dask-2023.4.1/dask/dataframe/
--rw-r--r--   0 james      (501) staff       (20)     1776 2023-03-13 17:40:24.000000 dask-2023.4.1/dask/dataframe/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     6161 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/_compat.py
--rw-r--r--   0 james      (501) staff       (20)     2135 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/_dtypes.py
--rw-r--r--   0 james      (501) staff       (20)     3183 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/_pyarrow.py
--rw-r--r--   0 james      (501) staff       (20)     1900 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/_pyarrow_compat.py
--rw-r--r--   0 james      (501) staff       (20)    12101 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/accessor.py
--rw-r--r--   0 james      (501) staff       (20)    24289 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/backends.py
--rw-r--r--   0 james      (501) staff       (20)     9471 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/categorical.py
--rw-r--r--   0 james      (501) staff       (20)   298004 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/core.py
--rw-r--r--   0 james      (501) staff       (20)     4437 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/dispatch.py
--rw-r--r--   0 james      (501) staff       (20)      516 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/extensions.py
--rw-r--r--   0 james      (501) staff       (20)   114078 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/groupby.py
--rw-r--r--   0 james      (501) staff       (20)     2427 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/dataframe/hyperloglog.py
--rw-r--r--   0 james      (501) staff       (20)    13376 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/indexing.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.436326 dask-2023.4.1/dask/dataframe/io/
--rw-r--r--   0 james      (501) staff       (20)      670 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    33618 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/csv.py
--rw-r--r--   0 james      (501) staff       (20)     5745 2023-03-13 17:40:24.000000 dask-2023.4.1/dask/dataframe/io/demo.py
--rw-r--r--   0 james      (501) staff       (20)    18043 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/hdf.py
--rw-r--r--   0 james      (501) staff       (20)    38497 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/io.py
--rw-r--r--   0 james      (501) staff       (20)    11127 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/json.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.440295 dask-2023.4.1/dask/dataframe/io/orc/
--rw-r--r--   0 james      (501) staff       (20)       56 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/io/orc/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     4451 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/orc/arrow.py
--rw-r--r--   0 james      (501) staff       (20)     7062 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/orc/core.py
--rw-r--r--   0 james      (501) staff       (20)      473 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/orc/utils.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.447586 dask-2023.4.1/dask/dataframe/io/parquet/
--rw-r--r--   0 james      (501) staff       (20)      130 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/io/parquet/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    71139 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/parquet/arrow.py
--rw-r--r--   0 james      (501) staff       (20)    66556 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/parquet/core.py
--rw-r--r--   0 james      (501) staff       (20)    52390 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/parquet/fastparquet.py
--rw-r--r--   0 james      (501) staff       (20)    32860 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/parquet/utils.py
--rw-r--r--   0 james      (501) staff       (20)    21072 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/sql.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.459095 dask-2023.4.1/dask/dataframe/io/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:03:52.000000 dask-2023.4.1/dask/dataframe/io/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    58831 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_csv.py
--rw-r--r--   0 james      (501) staff       (20)     5000 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/tests/test_demo.py
--rw-r--r--   0 james      (501) staff       (20)    27186 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_hdf.py
--rw-r--r--   0 james      (501) staff       (20)    34402 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_io.py
--rw-r--r--   0 james      (501) staff       (20)     8589 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_json.py
--rw-r--r--   0 james      (501) staff       (20)     5202 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/io/tests/test_orc.py
--rw-r--r--   0 james      (501) staff       (20)   164250 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_parquet.py
--rw-r--r--   0 james      (501) staff       (20)    17596 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/tests/test_sql.py
--rw-r--r--   0 james      (501) staff       (20)     7863 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/io/utils.py
--rw-r--r--   0 james      (501) staff       (20)    13807 2023-04-28 01:51:01.000000 dask-2023.4.1/dask/dataframe/methods.py
--rw-r--r--   0 james      (501) staff       (20)    53848 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/multi.py
--rw-r--r--   0 james      (501) staff       (20)     1564 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/numeric.py
--rw-r--r--   0 james      (501) staff       (20)     8742 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/optimize.py
--rw-r--r--   0 james      (501) staff       (20)    20008 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/partitionquantiles.py
--rw-r--r--   0 james      (501) staff       (20)    11874 2023-04-28 16:31:39.000000 dask-2023.4.1/dask/dataframe/reshape.py
--rw-r--r--   0 james      (501) staff       (20)    22149 2023-04-28 16:31:39.000000 dask-2023.4.1/dask/dataframe/rolling.py
--rw-r--r--   0 james      (501) staff       (20)    38047 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/shuffle.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.487825 dask-2023.4.1/dask/dataframe/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/dataframe/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    10597 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_accessors.py
--rw-r--r--   0 james      (501) staff       (20)    64097 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/tests/test_arithmetics_reduction.py
--rw-r--r--   0 james      (501) staff       (20)      906 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/dataframe/tests/test_boolean.py
--rw-r--r--   0 james      (501) staff       (20)    16642 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/tests/test_categorical.py
--rw-r--r--   0 james      (501) staff       (20)   183446 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_dataframe.py
--rw-r--r--   0 james      (501) staff       (20)     1420 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/dataframe/tests/test_extensions.py
--rw-r--r--   0 james      (501) staff       (20)    14707 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_format.py
--rw-r--r--   0 james      (501) staff       (20)   118367 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/dataframe/tests/test_groupby.py
--rw-r--r--   0 james      (501) staff       (20)     2666 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/dataframe/tests/test_hashing.py
--rw-r--r--   0 james      (501) staff       (20)     2861 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/dataframe/tests/test_hyperloglog.py
--rw-r--r--   0 james      (501) staff       (20)    22346 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_indexing.py
--rw-r--r--   0 james      (501) staff       (20)     6998 2022-12-14 03:22:05.000000 dask-2023.4.1/dask/dataframe/tests/test_merge_column_and_index.py
--rw-r--r--   0 james      (501) staff       (20)    90981 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_multi.py
--rw-r--r--   0 james      (501) staff       (20)     2084 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_numeric.py
--rw-r--r--   0 james      (501) staff       (20)     1031 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/tests/test_optimize_dataframe.py
--rw-r--r--   0 james      (501) staff       (20)     6626 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_pyarrow.py
--rw-r--r--   0 james      (501) staff       (20)     4514 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_pyarrow_compat.py
--rw-r--r--   0 james      (501) staff       (20)    11535 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_reshape.py
--rw-r--r--   0 james      (501) staff       (20)    17488 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_rolling.py
--rw-r--r--   0 james      (501) staff       (20)    53350 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_shuffle.py
--rw-r--r--   0 james      (501) staff       (20)    16559 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tests/test_ufunc.py
--rw-r--r--   0 james      (501) staff       (20)    21243 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/tests/test_utils_dataframe.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.489379 dask-2023.4.1/dask/dataframe/tseries/
--rw-r--r--   0 james      (501) staff       (20)        0 2021-06-08 02:50:30.000000 dask-2023.4.1/dask/dataframe/tseries/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     7628 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dataframe/tseries/resample.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.490638 dask-2023.4.1/dask/dataframe/tseries/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/dataframe/tseries/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     6830 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/dataframe/tseries/tests/test_resample.py
--rw-r--r--   0 james      (501) staff       (20)    26442 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/dataframe/utils.py
--rw-r--r--   0 james      (501) staff       (20)     4901 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/datasets.py
--rw-r--r--   0 james      (501) staff       (20)    24353 2023-03-13 17:40:25.000000 dask-2023.4.1/dask/delayed.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.494004 dask-2023.4.1/dask/diagnostics/
--rw-r--r--   0 james      (501) staff       (20)      222 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/diagnostics/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12100 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/diagnostics/profile.py
--rw-r--r--   0 james      (501) staff       (20)    16296 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/diagnostics/profile_visualize.py
--rw-r--r--   0 james      (501) staff       (20)     4965 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/diagnostics/progress.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.496053 dask-2023.4.1/dask/diagnostics/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/diagnostics/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12009 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/diagnostics/tests/test_profiler.py
--rw-r--r--   0 james      (501) staff       (20)     3352 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/diagnostics/tests/test_progress.py
--rw-r--r--   0 james      (501) staff       (20)      679 2022-08-08 20:45:08.000000 dask-2023.4.1/dask/distributed.py
--rw-r--r--   0 james      (501) staff       (20)    16587 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/dot.py
--rw-r--r--   0 james      (501) staff       (20)    19595 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/graph_manipulation.py
--rw-r--r--   0 james      (501) staff       (20)     2456 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/hashing.py
--rw-r--r--   0 james      (501) staff       (20)    34771 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/highlevelgraph.py
--rw-r--r--   0 james      (501) staff       (20)    46007 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/layers.py
--rw-r--r--   0 james      (501) staff       (20)    18888 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/local.py
--rw-r--r--   0 james      (501) staff       (20)      450 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/ml.py
--rw-r--r--   0 james      (501) staff       (20)     8466 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/multiprocessing.py
--rw-r--r--   0 james      (501) staff       (20)    35602 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/optimization.py
--rw-r--r--   0 james      (501) staff       (20)    45732 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/order.py
--rw-r--r--   0 james      (501) staff       (20)        0 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/py.typed
--rw-r--r--   0 james      (501) staff       (20)    12561 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/rewrite.py
--rw-r--r--   0 james      (501) staff       (20)     7254 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/sizeof.py
--rw-r--r--   0 james      (501) staff       (20)     1474 2023-03-13 17:40:25.000000 dask-2023.4.1/dask/system.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.533173 dask-2023.4.1/dask/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:04:31.000000 dask-2023.4.1/dask/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)      706 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_backends.py
--rw-r--r--   0 james      (501) staff       (20)    51088 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_base.py
--rw-r--r--   0 james      (501) staff       (20)     1577 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/tests/test_cache.py
--rw-r--r--   0 james      (501) staff       (20)     2534 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/tests/test_callbacks.py
--rw-r--r--   0 james      (501) staff       (20)     1163 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_ci.py
--rw-r--r--   0 james      (501) staff       (20)     3230 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_cli.py
--rw-r--r--   0 james      (501) staff       (20)      343 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_compatibility.py
--rw-r--r--   0 james      (501) staff       (20)    17810 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_config.py
--rw-r--r--   0 james      (501) staff       (20)     1101 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/tests/test_context.py
--rw-r--r--   0 james      (501) staff       (20)     7386 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/tests/test_core.py
--rw-r--r--   0 james      (501) staff       (20)     1076 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_datasets.py
--rw-r--r--   0 james      (501) staff       (20)    22953 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_delayed.py
--rw-r--r--   0 james      (501) staff       (20)    31257 2023-04-28 16:31:41.000000 dask-2023.4.1/dask/tests/test_distributed.py
--rw-r--r--   0 james      (501) staff       (20)      889 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_docs.py
--rw-r--r--   0 james      (501) staff       (20)    12235 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_dot.py
--rw-r--r--   0 james      (501) staff       (20)    14088 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/tests/test_graph_manipulation.py
--rw-r--r--   0 james      (501) staff       (20)     1059 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/tests/test_hashing.py
--rw-r--r--   0 james      (501) staff       (20)     7929 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_highgraph.py
--rw-r--r--   0 james      (501) staff       (20)     9305 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_layers.py
--rw-r--r--   0 james      (501) staff       (20)     4972 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/tests/test_local.py
--rw-r--r--   0 james      (501) staff       (20)      382 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/tests/test_ml.py
--rw-r--r--   0 james      (501) staff       (20)     8421 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/tests/test_multiprocessing.py
--rw-r--r--   0 james      (501) staff       (20)    45191 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/tests/test_optimization.py
--rw-r--r--   0 james      (501) staff       (20)    28193 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/tests/test_order.py
--rw-r--r--   0 james      (501) staff       (20)     4648 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/tests/test_rewrite.py
--rw-r--r--   0 james      (501) staff       (20)     7482 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_sizeof.py
--rw-r--r--   0 james      (501) staff       (20)     7118 2023-04-26 17:05:49.000000 dask-2023.4.1/dask/tests/test_spark_compat.py
--rw-r--r--   0 james      (501) staff       (20)     1361 2022-02-04 20:18:56.000000 dask-2023.4.1/dask/tests/test_system.py
--rw-r--r--   0 james      (501) staff       (20)     4713 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_threaded.py
--rw-r--r--   0 james      (501) staff       (20)     5670 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/test_typing.py
--rw-r--r--   0 james      (501) staff       (20)    21288 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/tests/test_utils.py
--rw-r--r--   0 james      (501) staff       (20)     1562 2023-04-11 17:13:14.000000 dask-2023.4.1/dask/tests/test_utils_test.py
--rw-r--r--   0 james      (501) staff       (20)      175 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/tests/warning_aliases.py
--rw-r--r--   0 james      (501) staff       (20)     2993 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/threaded.py
--rw-r--r--   0 james      (501) staff       (20)    14538 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/typing.py
--rw-r--r--   0 james      (501) staff       (20)    55904 2023-04-25 18:34:46.000000 dask-2023.4.1/dask/utils.py
--rw-r--r--   0 james      (501) staff       (20)     4825 2023-04-11 17:13:14.000000 dask-2023.4.1/dask/utils_test.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.536563 dask-2023.4.1/dask/widgets/
--rw-r--r--   0 james      (501) staff       (20)      756 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/widgets/__init__.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.540894 dask-2023.4.1/dask/widgets/templates/
--rw-r--r--   0 james      (501) staff       (20)     1295 2023-03-13 17:40:25.000000 dask-2023.4.1/dask/widgets/templates/array.html.j2
--rw-r--r--   0 james      (501) staff       (20)      124 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/widgets/templates/dataframe.html.j2
--rw-r--r--   0 james      (501) staff       (20)     2579 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/widgets/templates/highlevelgraph.html.j2
--rw-r--r--   0 james      (501) staff       (20)     1981 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/widgets/templates/highlevelgraph_layer.html.j2
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.541859 dask-2023.4.1/dask/widgets/tests/
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.544802 dask-2023.4.1/dask/widgets/tests/templates/
--rw-r--r--   0 james      (501) staff       (20)       38 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/widgets/tests/templates/bytes.html.j2
--rw-r--r--   0 james      (501) staff       (20)       39 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/widgets/tests/templates/custom_filter.html.j2
--rw-r--r--   0 james      (501) staff       (20)       30 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/widgets/tests/templates/example.html.j2
--rw-r--r--   0 james      (501) staff       (20)     1365 2022-10-24 20:44:15.000000 dask-2023.4.1/dask/widgets/tests/test_widgets.py
--rw-r--r--   0 james      (501) staff       (20)     1084 2022-11-09 22:20:24.000000 dask-2023.4.1/dask/widgets/widgets.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.281037 dask-2023.4.1/dask.egg-info/
--rw-r--r--   0 james      (501) staff       (20)     2582 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/PKG-INFO
--rw-r--r--   0 james      (501) staff       (20)    13902 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/SOURCES.txt
--rw-r--r--   0 james      (501) staff       (20)        1 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/dependency_links.txt
--rw-r--r--   0 james      (501) staff       (20)      124 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/entry_points.txt
--rw-r--r--   0 james      (501) staff       (20)        1 2023-04-28 17:30:04.000000 dask-2023.4.1/dask.egg-info/not-zip-safe
--rw-r--r--   0 james      (501) staff       (20)      443 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/requires.txt
--rw-r--r--   0 james      (501) staff       (20)        5 2023-04-28 17:30:05.000000 dask-2023.4.1/dask.egg-info/top_level.txt
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.547610 dask-2023.4.1/docs/
--rw-r--r--   0 james      (501) staff       (20)     5741 2023-03-22 19:03:53.000000 dask-2023.4.1/docs/Makefile
--rw-r--r--   0 james      (501) staff       (20)     5186 2022-08-08 20:45:08.000000 dask-2023.4.1/docs/make.bat
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.693266 dask-2023.4.1/docs/source/
--rw-r--r--   0 james      (501) staff       (20)    17598 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/10-minutes-to-dask.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.706699 dask-2023.4.1/docs/source/_static/
--rw-r--r--   0 james      (501) staff       (20)    10187 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/_static/config_converter.js
--rw-r--r--   0 james      (501) staff       (20)    11021 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/_static/dask-simple.png
--rw-r--r--   0 james      (501) staff       (20)     2375 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/_static/main-page.css
--rw-r--r--   0 james      (501) staff       (20)    15598 2022-08-08 20:45:08.000000 dask-2023.4.1/docs/source/_static/profile.html
--rw-r--r--   0 james      (501) staff       (20)    65304 2022-08-08 20:45:08.000000 dask-2023.4.1/docs/source/_static/stacked_profile.html
--rw-r--r--   0 james      (501) staff       (20)      523 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/_static/style.css
--rw-r--r--   0 james      (501) staff       (20)      365 2021-06-16 20:41:28.000000 dask-2023.4.1/docs/source/_static/theme_overrides.css
--rw-r--r--   0 james      (501) staff       (20)   292662 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/_static/transpose_cyto.html
--rw-r--r--   0 james      (501) staff       (20)    49423 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/_static/yaml.min.js
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.708309 dask-2023.4.1/docs/source/_templates/
--rw-r--r--   0 james      (501) staff       (20)      180 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/_templates/layout.html
--rw-r--r--   0 james      (501) staff       (20)     2235 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/api.rst
--rw-r--r--   0 james      (501) staff       (20)     6896 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/array-api.rst
--rw-r--r--   0 james      (501) staff       (20)     2943 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/array-assignment.rst
--rw-r--r--   0 james      (501) staff       (20)     4740 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/array-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)    13035 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-chunks.rst
--rw-r--r--   0 james      (501) staff       (20)    18437 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-creation.rst
--rw-r--r--   0 james      (501) staff       (20)     5885 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/array-design.rst
--rw-r--r--   0 james      (501) staff       (20)     2857 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-gufunc.rst
--rw-r--r--   0 james      (501) staff       (20)     6069 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/array-overlap.rst
--rw-r--r--   0 james      (501) staff       (20)     3411 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-random.rst
--rw-r--r--   0 james      (501) staff       (20)     4137 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/array-slicing.rst
--rw-r--r--   0 james      (501) staff       (20)     3291 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-sparse.rst
--rw-r--r--   0 james      (501) staff       (20)     2018 2022-10-07 21:37:36.000000 dask-2023.4.1/docs/source/array-stack.rst
--rw-r--r--   0 james      (501) staff       (20)     1140 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array-stats.rst
--rw-r--r--   0 james      (501) staff       (20)     4121 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/array.rst
--rw-r--r--   0 james      (501) staff       (20)     1574 2022-08-08 20:45:08.000000 dask-2023.4.1/docs/source/bag-api.rst
--rw-r--r--   0 james      (501) staff       (20)     4557 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/bag-creation.rst
--rw-r--r--   0 james      (501) staff       (20)     4068 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/bag.rst
--rw-r--r--   0 james      (501) staff       (20)    14205 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     5553 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/caching.rst
--rw-r--r--   0 james      (501) staff       (20)   299276 2023-04-28 17:27:33.000000 dask-2023.4.1/docs/source/changelog.rst
--rw-r--r--   0 james      (501) staff       (20)      211 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/cheatsheet.rst
--rw-r--r--   0 james      (501) staff       (20)     4047 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/cli.rst
--rw-r--r--   0 james      (501) staff       (20)    15465 2023-03-13 20:41:19.000000 dask-2023.4.1/docs/source/conf.py
--rw-r--r--   0 james      (501) staff       (20)    16654 2023-04-06 21:35:01.000000 dask-2023.4.1/docs/source/configuration.rst
--rw-r--r--   0 james      (501) staff       (20)    18651 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/custom-collections.rst
--rw-r--r--   0 james      (501) staff       (20)     3604 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/custom-graphs.rst
--rw-r--r--   0 james      (501) staff       (20)      896 2023-03-20 18:17:18.000000 dask-2023.4.1/docs/source/dashboard-progress-script.py
--rw-r--r--   0 james      (501) staff       (20)    15045 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/dashboard.rst
--rw-r--r--   0 james      (501) staff       (20)   203552 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/daskcheatsheet.pdf
--rw-r--r--   0 james      (501) staff       (20)    11702 2023-04-28 16:31:41.000000 dask-2023.4.1/docs/source/dataframe-api.rst
--rw-r--r--   0 james      (501) staff       (20)     9611 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/dataframe-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     3951 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/dataframe-categoricals.rst
--rw-r--r--   0 james      (501) staff       (20)     5967 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/dataframe-create.rst
--rw-r--r--   0 james      (501) staff       (20)     5002 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/dataframe-design.rst
--rw-r--r--   0 james      (501) staff       (20)     6224 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/dataframe-extend.rst
--rw-r--r--   0 james      (501) staff       (20)     8050 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/dataframe-groupby.rst
--rw-r--r--   0 james      (501) staff       (20)     6115 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/dataframe-indexing.rst
--rw-r--r--   0 james      (501) staff       (20)     3454 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/dataframe-joins.rst
--rw-r--r--   0 james      (501) staff       (20)    10952 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/dataframe-parquet.rst
--rw-r--r--   0 james      (501) staff       (20)    12661 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/dataframe-sql.rst
--rw-r--r--   0 james      (501) staff       (20)     7772 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/dataframe.rst
--rw-r--r--   0 james      (501) staff       (20)      363 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/debugging-performance.rst
--rw-r--r--   0 james      (501) staff       (20)     1696 2022-08-08 20:45:08.000000 dask-2023.4.1/docs/source/delayed-api.rst
--rw-r--r--   0 james      (501) staff       (20)    17616 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/delayed-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     1497 2022-10-07 21:37:36.000000 dask-2023.4.1/docs/source/delayed-collections.rst
--rw-r--r--   0 james      (501) staff       (20)     6357 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/delayed.rst
--rw-r--r--   0 james      (501) staff       (20)     3620 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/deploying-cli.rst
--rw-r--r--   0 james      (501) staff       (20)     2965 2023-04-28 16:31:41.000000 dask-2023.4.1/docs/source/deploying-cloud.rst
--rw-r--r--   0 james      (501) staff       (20)     2868 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/deploying-docker.rst
--rw-r--r--   0 james      (501) staff       (20)     9939 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/deploying-hpc.rst
--rw-r--r--   0 james      (501) staff       (20)     4001 2023-04-28 16:31:41.000000 dask-2023.4.1/docs/source/deploying-kubernetes.rst
--rw-r--r--   0 james      (501) staff       (20)     5823 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/deploying-python-advanced.rst
--rw-r--r--   0 james      (501) staff       (20)     2839 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/deploying-python.rst
--rw-r--r--   0 james      (501) staff       (20)     1619 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/deploying-ssh.rst
--rw-r--r--   0 james      (501) staff       (20)     7266 2023-04-28 16:31:41.000000 dask-2023.4.1/docs/source/deploying.rst
--rw-r--r--   0 james      (501) staff       (20)    10758 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/deployment-considerations.rst
--rw-r--r--   0 james      (501) staff       (20)    13142 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/develop.rst
--rw-r--r--   0 james      (501) staff       (20)     4442 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/diagnostics-distributed.rst
--rw-r--r--   0 james      (501) staff       (20)    10407 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/diagnostics-local.rst
--rw-r--r--   0 james      (501) staff       (20)     4323 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/ecosystem.rst
--rw-r--r--   0 james      (501) staff       (20)    19964 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/faq.rst
--rw-r--r--   0 james      (501) staff       (20)    26361 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/futures.rst
--rw-r--r--   0 james      (501) staff       (20)     5820 2022-10-07 21:37:14.000000 dask-2023.4.1/docs/source/gpu.rst
--rw-r--r--   0 james      (501) staff       (20)     2541 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/graph_manipulation.rst
--rw-r--r--   0 james      (501) staff       (20)     5433 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/graphs.rst
--rw-r--r--   0 james      (501) staff       (20)     5399 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/graphviz.rst
--rw-r--r--   0 james      (501) staff       (20)     6946 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/high-level-graphs.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.718702 dask-2023.4.1/docs/source/how-to/
--rw-r--r--   0 james      (501) staff       (20)     4364 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/how-to/adaptive.rst
--rw-r--r--   0 james      (501) staff       (20)    15360 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/how-to/connect-to-remote-data.rst
--rw-r--r--   0 james      (501) staff       (20)     4209 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/how-to/customize-initialization.rst
--rw-r--r--   0 james      (501) staff       (20)    10859 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/how-to/debug.rst
--rw-r--r--   0 james      (501) staff       (20)     1722 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/how-to/extend-sizeof.rst
--rw-r--r--   0 james      (501) staff       (20)      433 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/how-to/index.rst
--rw-r--r--   0 james      (501) staff       (20)     4562 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/how-to/manage-environments.rst
--rw-r--r--   0 james      (501) staff       (20)     6680 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/how-to/selecting-the-collection-backend.rst
--rw-r--r--   0 james      (501) staff       (20)      902 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/how-to/setup-prometheus.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.890376 dask-2023.4.1/docs/source/images/
--rw-r--r--   0 james      (501) staff       (20)    99565 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/10_minutes_array_graph.png
--rw-r--r--   0 james      (501) staff       (20)    22442 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/10_minutes_bag_graph.png
--rw-r--r--   0 james      (501) staff       (20)    56229 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/10_minutes_dataframe_graph.png
--rw-r--r--   0 james      (501) staff       (20)     4059 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/HHMI_Janelia_Color.png
--rw-r--r--   0 james      (501) staff       (20)    18406 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/array.svg
--rw-r--r--   0 james      (501) staff       (20)  1620104 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/async-embarrassing.gif
--rw-r--r--   0 james      (501) staff       (20)    10752 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/concurrent-futures-threaded.webp
--rw-r--r--   0 james      (501) staff       (20)   135129 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/crosstalk.svg
--rw-r--r--   0 james      (501) staff       (20)  2367087 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dashboard_jupyterlab.png
--rw-r--r--   0 james      (501) staff       (20)    37971 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dashboard_link.png
--rw-r--r--   0 james      (501) staff       (20)    68712 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dashboard_memory.png
--rw-r--r--   0 james      (501) staff       (20)   281018 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/images/dashboard_memory_new.gif
--rw-r--r--   0 james      (501) staff       (20)    25435 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/images/dashboard_progress.png
--rw-r--r--   0 james      (501) staff       (20)   276928 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/images/dashboard_status.png
--rw-r--r--   0 james      (501) staff       (20)    12009 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/images/dashboard_task_processing.png
--rw-r--r--   0 james      (501) staff       (20)    58238 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dashboard_task_stream_unhealthy.png
--rw-r--r--   0 james      (501) staff       (20)   103654 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dashboard_taskstream_healthy.png
--rw-r--r--   0 james      (501) staff       (20)   112822 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/dask-adaptive.svg
--rw-r--r--   0 james      (501) staff       (20)    14645 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/dask-array.svg
--rw-r--r--   0 james      (501) staff       (20)   222084 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/dask-cluster-manager.svg
--rw-r--r--   0 james      (501) staff       (20)    18782 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/dask-dataframe.svg
--rw-r--r--   0 james      (501) staff       (20)   381903 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask-overview-distributed-callout.svg
--rw-r--r--   0 james      (501) staff       (20)   357643 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask-overview-schedulers.svg
--rw-r--r--   0 james      (501) staff       (20)    97471 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/dask-overview.svg
--rw-r--r--   0 james      (501) staff       (20)     3022 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_horizontal.svg
--rw-r--r--   0 james      (501) staff       (20)     3651 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_horizontal_black.svg
--rw-r--r--   0 james      (501) staff       (20)     3767 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_horizontal_on_blue.svg
--rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_horizontal_on_pink.svg
--rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_horizontal_white.svg
--rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_icon.svg
--rw-r--r--   0 james      (501) staff       (20)     1571 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_icon_black.svg
--rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_icon_on_pink.svg
--rw-r--r--   0 james      (501) staff       (20)     1609 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/dask_icon_white.svg
--rw-r--r--   0 james      (501) staff       (20)    20216 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/delayed-inc-double-add.svg
--rw-r--r--   0 james      (501) staff       (20)   104628 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/distributed-overview.svg
--rw-r--r--   0 james      (501) staff       (20)    18297 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/frame-shuffle.svg
--rw-r--r--   0 james      (501) staff       (20)    22979 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/frame-sort.svg
--rw-r--r--   0 james      (501) staff       (20)    12181 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/frame.svg
--rw-r--r--   0 james      (501) staff       (20)    41828 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/gputester-msg.png
--rw-r--r--   0 james      (501) staff       (20)   210392 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/growth_of_languages.png
--rw-r--r--   0 james      (501) staff       (20)   167834 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/growth_of_libraries.png
--rw-r--r--   0 james      (501) staff       (20)     4097 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/inc-add.svg
--rw-r--r--   0 james      (501) staff       (20)   123010 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/map-reduce-task-scheduling.svg
--rw-r--r--   0 james      (501) staff       (20)   482302 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/map_blocks_drop_axis.png
--rw-r--r--   0 james      (501) staff       (20)   113067 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/merge_chunks.png
--rw-r--r--   0 james      (501) staff       (20)    63244 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/merge_chunks_false.png
--rw-r--r--   0 james      (501) staff       (20)    13024 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/optimize_dask1.svg
--rw-r--r--   0 james      (501) staff       (20)     8803 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/optimize_dask2.svg
--rw-r--r--   0 james      (501) staff       (20)     5198 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/optimize_dask3.svg
--rw-r--r--   0 james      (501) staff       (20)     4104 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/optimize_dask4.svg
--rw-r--r--   0 james      (501) staff       (20)     2738 2021-11-11 17:33:01.000000 dask-2023.4.1/docs/source/images/optimize_dask5.svg
--rw-r--r--   0 james      (501) staff       (20)   292827 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/order-failure.png
--rw-r--r--   0 james      (501) staff       (20)   239828 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/order-success.png
--rw-r--r--   0 james      (501) staff       (20)    40833 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/overlap.svg
--rw-r--r--   0 james      (501) staff       (20)    18785 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/overlapping-blocks.svg
--rw-r--r--   0 james      (501) staff       (20)     4537 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/overlapping-neighbors.svg
--rw-r--r--   0 james      (501) staff       (20)    20533 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/pipeline.svg
--rw-r--r--   0 james      (501) staff       (20)    31576 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/reshape.png
--rw-r--r--   0 james      (501) staff       (20)    31410 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/reshape_problem.png
--rw-r--r--   0 james      (501) staff       (20)    33288 2021-11-11 20:27:17.000000 dask-2023.4.1/docs/source/images/reshape_rechunked.png
--rw-r--r--   0 james      (501) staff       (20)    50209 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/scaling-edges.png
--rw-r--r--   0 james      (501) staff       (20)    68476 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/scaling-nodes.png
--rw-r--r--   0 james      (501) staff       (20)    21294 2021-06-08 02:50:31.000000 dask-2023.4.1/docs/source/images/simple-dask.png
--rw-r--r--   0 james      (501) staff       (20)    27572 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/transpose-hlg-hovertooltip.png
--rw-r--r--   0 james      (501) staff       (20)    84492 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/images/transpose-hlg-html-repr.png
--rw-r--r--   0 james      (501) staff       (20)    39365 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/transpose.svg
--rw-r--r--   0 james      (501) staff       (20)    22446 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/transpose_opt.svg
--rw-r--r--   0 james      (501) staff       (20)   115022 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/images/trivial.svg
--rw-r--r--   0 james      (501) staff       (20)     2451 2021-06-08 02:51:08.000000 dask-2023.4.1/docs/source/images/unoverlapping-neighbors.svg
--rw-r--r--   0 james      (501) staff       (20)     6237 2023-03-13 17:40:25.000000 dask-2023.4.1/docs/source/index.rst
--rw-r--r--   0 james      (501) staff       (20)    15235 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/install.rst
--rw-r--r--   0 james      (501) staff       (20)      341 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/internals.rst
--rw-r--r--   0 james      (501) staff       (20)      868 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/logos.rst
--rw-r--r--   0 james      (501) staff       (20)     3573 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/maintainers.rst
--rw-r--r--   0 james      (501) staff       (20)    12200 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/optimize.rst
--rw-r--r--   0 james      (501) staff       (20)     7119 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/order.rst
--rw-r--r--   0 james      (501) staff       (20)     4810 2022-10-07 21:37:14.000000 dask-2023.4.1/docs/source/phases-of-computation.rst
--rw-r--r--   0 james      (501) staff       (20)     5089 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/presentations.rst
--rw-r--r--   0 james      (501) staff       (20)     6010 2022-10-07 21:37:14.000000 dask-2023.4.1/docs/source/scheduler-overview.rst
--rw-r--r--   0 james      (501) staff       (20)     4493 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/scheduling-policy.rst
--rw-r--r--   0 james      (501) staff       (20)    11014 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/scheduling.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-04-28 17:30:05.891276 dask-2023.4.1/docs/source/scripts/
--rw-r--r--   0 james      (501) staff       (20)     3258 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/scripts/scheduling.py
--rw-r--r--   0 james      (501) staff       (20)     6104 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/shared.rst
--rw-r--r--   0 james      (501) staff       (20)     9342 2022-11-09 22:20:24.000000 dask-2023.4.1/docs/source/spark.rst
--rw-r--r--   0 james      (501) staff       (20)     3966 2022-10-07 21:37:14.000000 dask-2023.4.1/docs/source/spec.rst
--rw-r--r--   0 james      (501) staff       (20)     4608 2023-04-25 18:34:46.000000 dask-2023.4.1/docs/source/support.rst
--rw-r--r--   0 james      (501) staff       (20)     1831 2021-06-16 20:41:28.000000 dask-2023.4.1/docs/source/understanding-performance.rst
--rw-r--r--   0 james      (501) staff       (20)    12205 2023-04-26 17:05:49.000000 dask-2023.4.1/docs/source/user-interfaces.rst
--rw-r--r--   0 james      (501) staff       (20)    11744 2022-10-24 20:44:15.000000 dask-2023.4.1/docs/source/why.rst
--rw-r--r--   0 james      (501) staff       (20)     5500 2023-04-28 17:21:18.000000 dask-2023.4.1/pyproject.toml
--rw-r--r--   0 james      (501) staff       (20)       38 2023-04-28 17:30:05.893028 dask-2023.4.1/setup.cfg
--rwxr-xr-x   0 james      (501) staff       (20)      194 2023-04-26 17:05:49.000000 dask-2023.4.1/setup.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:17.149675 dask-2023.5.0/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1531 2022-08-02 08:55:22.000000 dask-2023.5.0/LICENSE.txt
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      325 2022-08-02 08:55:22.000000 dask-2023.5.0/MANIFEST.in
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2582 2023-05-12 15:53:17.149102 dask-2023.5.0/PKG-INFO
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1291 2022-08-02 08:55:22.000000 dask-2023.5.0/README.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2361 2023-04-27 14:07:51.000000 dask-2023.5.0/conftest.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:17.150206 dask-2023.5.0/dask/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      428 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)       97 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/__main__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      607 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/_compatibility.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      500 2023-05-12 15:53:17.150347 dask-2023.5.0/dask/_version.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.607715 dask-2023.5.0/dask/array/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1543 2019-09-09 13:11:42.000000 dask-2023.5.0/dask/array/NUMPY_LICENSE.txt
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5377 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12564 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/backends.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     9947 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/array/blockwise.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12268 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/chunk.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5030 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/array/chunk_types.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   190916 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/array/core.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    40564 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/creation.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2078 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/cupy_entry_point.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      490 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/array/dispatch.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     9153 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/einsumfuncs.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7216 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/fft.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    32620 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/gufunc.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1960 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/image.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.609191 dask-2023.5.0/dask/array/lib/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)       41 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/lib/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)       65 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/lib/stride_tricks.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    53299 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/linalg.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6327 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/array/ma.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5663 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/numpy_compat.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12811 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/optimization.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    28444 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/overlap.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    10616 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/percentile.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    40795 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/random.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    27183 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/rechunk.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    57251 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/reductions.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    10729 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/reshape.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    81898 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/routines.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    72595 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/slicing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    14578 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/stats.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     8012 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/array/svg.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.706168 dask-2023.5.0/dask/array/tests/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/array/tests/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   161425 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_array_core.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6653 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_array_function.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3123 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/tests/test_array_utils.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    23186 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_atop.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3055 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/array/tests/test_chunk.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    31114 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_creation.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    19852 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_core.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6420 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_creation.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      558 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_gufunc.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    13376 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_linalg.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4267 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/tests/test_cupy_overlap.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2826 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_percentile.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6443 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_cupy_random.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2188 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_reductions.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7401 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_routines.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4841 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_cupy_slicing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2946 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_cupy_sparse.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     8829 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_dispatch.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     8401 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/tests/test_fft.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    20977 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_gufunc.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1446 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/array/tests/test_image.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    36412 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_linalg.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    15599 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_masked.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1051 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/array/tests/test_numpy_compat.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    17410 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_optimization.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    26682 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_overlap.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3407 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_percentiles.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    15467 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_random.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    33636 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_rechunk.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    32720 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_reductions.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7253 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/array/tests/test_reshape.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    83813 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_routines.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    32266 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/tests/test_slicing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6556 2022-08-17 10:33:51.000000 dask-2023.5.0/dask/array/tests/test_sparse.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5453 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/tests/test_stats.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2704 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/array/tests/test_svg.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      489 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/tests/test_testing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    17354 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/tests/test_ufunc.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2670 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/tests/test_wrap.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1281 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/array/tests/test_xarray.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4701 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/tiledb_io.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     9907 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/array/ufunc.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    18638 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/array/utils.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6870 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/array/wrap.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4909 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/backends.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.716839 dask-2023.5.0/dask/bag/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      867 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bag/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     9075 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/bag/avro.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      726 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bag/chunk.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    84624 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/bag/core.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5428 2022-08-17 10:33:51.000000 dask-2023.5.0/dask/bag/random.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.758481 dask-2023.5.0/dask/bag/tests/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/bag/tests/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3772 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/bag/tests/test_avro.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    49657 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/bag/tests/test_bag.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6492 2022-08-17 10:33:51.000000 dask-2023.5.0/dask/bag/tests/test_random.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5013 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/bag/tests/test_text.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6729 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bag/text.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      204 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bag/utils.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    52102 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/base.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    53252 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/blockwise.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.763969 dask-2023.5.0/dask/bytes/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)       39 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bytes/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6897 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/bytes/core.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.773717 dask-2023.5.0/dask/bytes/tests/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/bytes/tests/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5122 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/bytes/tests/test_bytes_utils.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      494 2020-01-16 09:59:28.000000 dask-2023.5.0/dask/bytes/tests/test_compression.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6657 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/bytes/tests/test_http.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    11440 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/bytes/tests/test_local.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    19631 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/bytes/tests/test_s3.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      464 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/bytes/utils.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1965 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/cache.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4067 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/callbacks.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3028 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/cli.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      487 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/compatibility.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    21645 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/config.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1720 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/context.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    14797 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/core.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6944 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dask-schema.yaml
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1498 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dask.yaml
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.812526 dask-2023.5.0/dask/dataframe/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1776 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/dataframe/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6978 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/_compat.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2135 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/_dtypes.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3183 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/_pyarrow.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1900 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/_pyarrow_compat.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12101 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/accessor.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    24289 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/backends.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     9471 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/categorical.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   299064 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/core.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4437 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/dataframe/dispatch.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      516 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/dataframe/extensions.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   114841 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/groupby.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2427 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/dataframe/hyperloglog.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    13376 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/indexing.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.822775 dask-2023.5.0/dask/dataframe/io/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      670 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/dataframe/io/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    33618 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/io/csv.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5745 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/dataframe/io/demo.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    18043 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/hdf.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    38497 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/dataframe/io/io.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    11127 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/json.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.827274 dask-2023.5.0/dask/dataframe/io/orc/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)       56 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/dataframe/io/orc/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4451 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/io/orc/arrow.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7062 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/io/orc/core.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      473 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/dataframe/io/orc/utils.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.833203 dask-2023.5.0/dask/dataframe/io/parquet/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      130 2022-08-02 08:55:22.000000 dask-2023.5.0/dask/dataframe/io/parquet/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    71139 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/parquet/arrow.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    66556 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/parquet/core.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    52390 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/parquet/fastparquet.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    32860 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/parquet/utils.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    21072 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/sql.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.844797 dask-2023.5.0/dask/dataframe/io/tests/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/dataframe/io/tests/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    58831 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/tests/test_csv.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5000 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/io/tests/test_demo.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    27186 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/tests/test_hdf.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    34402 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/tests/test_io.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     8589 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/tests/test_json.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5202 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/io/tests/test_orc.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   164356 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/io/tests/test_parquet.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    17596 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/tests/test_sql.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7863 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/io/utils.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    13979 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/methods.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    53848 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/multi.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1564 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/dataframe/numeric.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     8742 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/optimize.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    20008 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/partitionquantiles.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    11874 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/reshape.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    22149 2023-03-24 11:33:15.000000 dask-2023.5.0/dask/dataframe/rolling.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    38047 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/shuffle.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.873710 dask-2023.5.0/dask/dataframe/tests/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/dataframe/tests/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    10597 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_accessors.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    66179 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/tests/test_arithmetics_reduction.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      906 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/dataframe/tests/test_boolean.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    16642 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/tests/test_categorical.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   187198 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/tests/test_dataframe.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1420 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/dataframe/tests/test_extensions.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    14707 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/dataframe/tests/test_format.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   119303 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/tests/test_groupby.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2666 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/dataframe/tests/test_hashing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2861 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/dataframe/tests/test_hyperloglog.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    22346 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/tests/test_indexing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6998 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/dataframe/tests/test_merge_column_and_index.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    90981 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_multi.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2084 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_numeric.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1031 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/dataframe/tests/test_optimize_dataframe.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6626 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/tests/test_pyarrow.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4514 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/dataframe/tests/test_pyarrow_compat.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    11535 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_reshape.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    17488 2023-03-24 11:33:15.000000 dask-2023.5.0/dask/dataframe/tests/test_rolling.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    53350 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_shuffle.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    16559 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/tests/test_ufunc.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    21243 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/dataframe/tests/test_utils_dataframe.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.875090 dask-2023.5.0/dask/dataframe/tseries/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/dataframe/tseries/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7628 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/dataframe/tseries/resample.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.876744 dask-2023.5.0/dask/dataframe/tseries/tests/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/dataframe/tseries/tests/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6830 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/dataframe/tseries/tests/test_resample.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    26648 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/dataframe/utils.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5278 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/datasets.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    24353 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/delayed.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.881528 dask-2023.5.0/dask/diagnostics/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      222 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/diagnostics/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12100 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/diagnostics/profile.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    16296 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/diagnostics/profile_visualize.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4965 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/diagnostics/progress.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.884254 dask-2023.5.0/dask/diagnostics/tests/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/diagnostics/tests/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12009 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/diagnostics/tests/test_profiler.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3352 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/diagnostics/tests/test_progress.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      679 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/distributed.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    16587 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/dot.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    19595 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/graph_manipulation.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2456 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/hashing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    34771 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/highlevelgraph.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    46007 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/layers.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    18888 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/local.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      450 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/ml.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     8466 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/multiprocessing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    35602 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/optimization.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    45732 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/order.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/py.typed
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12561 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/rewrite.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7254 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/sizeof.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1474 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/system.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.917444 dask-2023.5.0/dask/tests/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        0 2019-09-09 13:11:43.000000 dask-2023.5.0/dask/tests/__init__.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      706 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/tests/test_backends.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    51088 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_base.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1577 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/tests/test_cache.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2534 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/tests/test_callbacks.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1163 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/tests/test_ci.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3230 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_cli.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      343 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_compatibility.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    17810 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_config.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1101 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_context.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7386 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_core.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1076 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_datasets.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    22953 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/tests/test_delayed.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    31257 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_distributed.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      889 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/tests/test_docs.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12235 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/tests/test_dot.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    15036 2023-05-12 15:11:40.000000 dask-2023.5.0/dask/tests/test_graph_manipulation.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1059 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/tests/test_hashing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7929 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_highgraph.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     9305 2023-03-23 09:49:13.000000 dask-2023.5.0/dask/tests/test_layers.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4972 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_local.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      382 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_ml.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     8421 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_multiprocessing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    45191 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_optimization.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    28193 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_order.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4648 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/tests/test_rewrite.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7482 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/tests/test_sizeof.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7118 2023-04-27 14:07:51.000000 dask-2023.5.0/dask/tests/test_spark_compat.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1361 2022-08-02 08:25:33.000000 dask-2023.5.0/dask/tests/test_system.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4713 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/tests/test_threaded.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5670 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/tests/test_typing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    21288 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/tests/test_utils.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1562 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/tests/test_utils_test.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      175 2023-02-13 13:29:57.000000 dask-2023.5.0/dask/tests/warning_aliases.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2993 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/threaded.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    14538 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/typing.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    55904 2023-03-16 13:18:46.000000 dask-2023.5.0/dask/utils.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4825 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/utils_test.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.919071 dask-2023.5.0/dask/widgets/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      756 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/widgets/__init__.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.922274 dask-2023.5.0/dask/widgets/templates/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1295 2022-11-28 16:52:43.000000 dask-2023.5.0/dask/widgets/templates/array.html.j2
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      124 2022-08-02 08:55:26.000000 dask-2023.5.0/dask/widgets/templates/dataframe.html.j2
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2579 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/widgets/templates/highlevelgraph.html.j2
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1981 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/widgets/templates/highlevelgraph_layer.html.j2
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.922828 dask-2023.5.0/dask/widgets/tests/
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.925752 dask-2023.5.0/dask/widgets/tests/templates/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)       38 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/widgets/tests/templates/bytes.html.j2
+-rw-r--r--   0 jtomlinson   (502) staff       (20)       39 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/widgets/tests/templates/custom_filter.html.j2
+-rw-r--r--   0 jtomlinson   (502) staff       (20)       30 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/widgets/tests/templates/example.html.j2
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1365 2022-08-02 08:26:56.000000 dask-2023.5.0/dask/widgets/tests/test_widgets.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1084 2022-08-02 08:55:23.000000 dask-2023.5.0/dask/widgets/widgets.py
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.576244 dask-2023.5.0/dask.egg-info/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2582 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/PKG-INFO
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    13902 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/SOURCES.txt
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        1 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/dependency_links.txt
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      124 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/entry_points.txt
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        1 2023-05-12 15:53:15.000000 dask-2023.5.0/dask.egg-info/not-zip-safe
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      443 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/requires.txt
+-rw-r--r--   0 jtomlinson   (502) staff       (20)        5 2023-05-12 15:53:16.000000 dask-2023.5.0/dask.egg-info/top_level.txt
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.927386 dask-2023.5.0/docs/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5741 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/Makefile
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5186 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/make.bat
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.988272 dask-2023.5.0/docs/source/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    17598 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/10-minutes-to-dask.rst
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.995555 dask-2023.5.0/docs/source/_static/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    10187 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/_static/config_converter.js
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    11021 2019-09-09 13:11:43.000000 dask-2023.5.0/docs/source/_static/dask-simple.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2375 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/_static/main-page.css
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    15598 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/_static/profile.html
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    65304 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/_static/stacked_profile.html
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      523 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/_static/style.css
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      365 2021-08-11 13:55:55.000000 dask-2023.5.0/docs/source/_static/theme_overrides.css
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   292662 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/_static/transpose_cyto.html
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    49423 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/_static/yaml.min.js
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:16.996741 dask-2023.5.0/docs/source/_templates/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      180 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/_templates/layout.html
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2235 2022-08-17 10:33:51.000000 dask-2023.5.0/docs/source/api.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6896 2023-03-23 09:49:13.000000 dask-2023.5.0/docs/source/array-api.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2943 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/array-assignment.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4740 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/array-best-practices.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    13035 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-chunks.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    18437 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-creation.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5885 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/array-design.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2857 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-gufunc.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6069 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/array-overlap.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3411 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-random.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4137 2021-08-18 09:15:49.000000 dask-2023.5.0/docs/source/array-slicing.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3291 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-sparse.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2018 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/array-stack.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1140 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array-stats.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4121 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/array.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1574 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/bag-api.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4557 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/bag-creation.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4068 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/bag.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    14205 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/best-practices.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5553 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/caching.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   301741 2023-05-12 15:39:48.000000 dask-2023.5.0/docs/source/changelog.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      211 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/cheatsheet.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4047 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/cli.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    15465 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/conf.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    16654 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/configuration.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    18651 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/custom-collections.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3604 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/custom-graphs.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      896 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/dashboard-progress-script.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    15045 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/dashboard.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   203552 2019-09-09 13:11:43.000000 dask-2023.5.0/docs/source/daskcheatsheet.pdf
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    13693 2023-05-12 15:11:40.000000 dask-2023.5.0/docs/source/dataframe-api.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     9611 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/dataframe-best-practices.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3951 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/dataframe-categoricals.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5967 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/dataframe-create.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5002 2022-08-17 10:33:51.000000 dask-2023.5.0/docs/source/dataframe-design.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6224 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/dataframe-extend.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     8050 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/dataframe-groupby.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6115 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/dataframe-indexing.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3454 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/dataframe-joins.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    10952 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/dataframe-parquet.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12661 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/dataframe-sql.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7772 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/dataframe.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      363 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/debugging-performance.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1696 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/delayed-api.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    17616 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/delayed-best-practices.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1497 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/delayed-collections.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6357 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/delayed.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3620 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/deploying-cli.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2965 2023-05-12 15:11:40.000000 dask-2023.5.0/docs/source/deploying-cloud.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2868 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/deploying-docker.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     9939 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/deploying-hpc.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4001 2023-05-12 15:11:40.000000 dask-2023.5.0/docs/source/deploying-kubernetes.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5823 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/deploying-python-advanced.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2839 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/deploying-python.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1619 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/deploying-ssh.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7266 2023-05-12 15:11:40.000000 dask-2023.5.0/docs/source/deploying.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    10758 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/deployment-considerations.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    13142 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/develop.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4442 2022-08-17 10:33:51.000000 dask-2023.5.0/docs/source/diagnostics-distributed.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    10407 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/diagnostics-local.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4323 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/ecosystem.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    19964 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/faq.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    25569 2023-05-12 15:11:40.000000 dask-2023.5.0/docs/source/futures.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5820 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/gpu.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2541 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/graph_manipulation.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5433 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/graphs.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5399 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/graphviz.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6946 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/high-level-graphs.rst
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:17.002504 dask-2023.5.0/docs/source/how-to/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4364 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/how-to/adaptive.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    15360 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/how-to/connect-to-remote-data.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4209 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/how-to/customize-initialization.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    10859 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/how-to/debug.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1722 2022-08-17 10:33:51.000000 dask-2023.5.0/docs/source/how-to/extend-sizeof.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      433 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/how-to/index.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4562 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/how-to/manage-environments.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6680 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/how-to/selecting-the-collection-backend.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      902 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/how-to/setup-prometheus.rst
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:17.146953 dask-2023.5.0/docs/source/images/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    99565 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/10_minutes_array_graph.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    22442 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/10_minutes_bag_graph.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    56229 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/10_minutes_dataframe_graph.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4059 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/HHMI_Janelia_Color.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    18406 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/array.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)  1620104 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/async-embarrassing.gif
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    10752 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/concurrent-futures-threaded.webp
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   135129 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/crosstalk.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)  2367087 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dashboard_jupyterlab.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    37971 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dashboard_link.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    68712 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dashboard_memory.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   281018 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/images/dashboard_memory_new.gif
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    25435 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/images/dashboard_progress.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   276928 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/images/dashboard_status.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12009 2023-03-16 13:18:46.000000 dask-2023.5.0/docs/source/images/dashboard_task_processing.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    58238 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dashboard_task_stream_unhealthy.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   103654 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dashboard_taskstream_healthy.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   112822 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-adaptive.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    14645 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-array.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   222084 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-cluster-manager.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    18782 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-dataframe.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   381903 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-overview-distributed-callout.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   357643 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-overview-schedulers.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    97471 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask-overview.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3022 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_horizontal.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3651 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_horizontal_black.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3767 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_horizontal_on_blue.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3738 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_horizontal_on_pink.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3738 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_horizontal_white.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1607 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_icon.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1571 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_icon_black.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1607 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_icon_on_pink.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1609 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/dask_icon_white.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    20216 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/delayed-inc-double-add.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   104628 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/distributed-overview.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    18297 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/frame-shuffle.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    22979 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/frame-sort.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12181 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/frame.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    41828 2022-08-02 08:26:56.000000 dask-2023.5.0/docs/source/images/gputester-msg.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   210392 2020-02-12 13:02:38.000000 dask-2023.5.0/docs/source/images/growth_of_languages.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   167834 2020-02-12 13:02:38.000000 dask-2023.5.0/docs/source/images/growth_of_libraries.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4097 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/inc-add.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   123010 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/map-reduce-task-scheduling.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   482302 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/map_blocks_drop_axis.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   113067 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/merge_chunks.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    63244 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/merge_chunks_false.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    13024 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/images/optimize_dask1.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     8803 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/images/optimize_dask2.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5198 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/images/optimize_dask3.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4104 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/images/optimize_dask4.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2738 2020-03-25 19:50:34.000000 dask-2023.5.0/docs/source/images/optimize_dask5.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   292827 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/order-failure.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   239828 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/order-success.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    40833 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/overlap.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    18785 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/overlapping-blocks.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4537 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/overlapping-neighbors.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    20533 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/pipeline.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    31576 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/reshape.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    31410 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/reshape_problem.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    33288 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/images/reshape_rechunked.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    50209 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/scaling-edges.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    68476 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/scaling-nodes.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    21294 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/simple-dask.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    27572 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/transpose-hlg-hovertooltip.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    84492 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/transpose-hlg-html-repr.png
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    39365 2019-09-09 13:11:44.000000 dask-2023.5.0/docs/source/images/transpose.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    22446 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/transpose_opt.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)   115022 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/images/trivial.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     2451 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/images/unoverlapping-neighbors.svg
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6237 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/index.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    15235 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/install.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      341 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/internals.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)      868 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/logos.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3573 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/maintainers.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12200 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/optimize.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     7119 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/order.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4810 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/phases-of-computation.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5089 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/presentations.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6010 2022-08-02 08:25:33.000000 dask-2023.5.0/docs/source/scheduler-overview.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4493 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/scheduling-policy.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    11014 2022-11-28 16:52:43.000000 dask-2023.5.0/docs/source/scheduling.rst
+drwxr-xr-x   0 jtomlinson   (502) staff       (20)        0 2023-05-12 15:53:17.147983 dask-2023.5.0/docs/source/scripts/
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3258 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/scripts/scheduling.py
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     6104 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/shared.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     9342 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/spark.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     3966 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/spec.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     4608 2023-02-13 13:29:57.000000 dask-2023.5.0/docs/source/support.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     1831 2019-09-23 13:38:35.000000 dask-2023.5.0/docs/source/understanding-performance.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    12205 2023-04-27 14:07:51.000000 dask-2023.5.0/docs/source/user-interfaces.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)    11744 2022-08-02 08:55:23.000000 dask-2023.5.0/docs/source/why.rst
+-rw-r--r--   0 jtomlinson   (502) staff       (20)     5500 2023-05-12 15:29:01.000000 dask-2023.5.0/pyproject.toml
+-rw-r--r--   0 jtomlinson   (502) staff       (20)       38 2023-05-12 15:53:17.149774 dask-2023.5.0/setup.cfg
+-rwxr-xr-x   0 jtomlinson   (502) staff       (20)      194 2023-04-27 14:07:51.000000 dask-2023.5.0/setup.py
```

### Comparing `dask-2023.4.1/LICENSE.txt` & `dask-2023.5.0/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/PKG-INFO` & `dask-2023.5.0/PKG-INFO`

 * *Files 4% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask
-Version: 2023.4.1
+Version: 2023.5.0
 Summary: Parallel PyData with Task Scheduling
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Homepage, https://github.com/dask/dask/
 Keywords: task-scheduling parallel numpy pandas pydata
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
```

### Comparing `dask-2023.4.1/README.rst` & `dask-2023.5.0/README.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/conftest.py` & `dask-2023.5.0/conftest.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/_compatibility.py` & `dask-2023.5.0/dask/_compatibility.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/NUMPY_LICENSE.txt` & `dask-2023.5.0/dask/array/NUMPY_LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/__init__.py` & `dask-2023.5.0/dask/array/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/backends.py` & `dask-2023.5.0/dask/array/backends.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/blockwise.py` & `dask-2023.5.0/dask/array/blockwise.py`

 * *Files 0% similar despite different names*

```diff
@@ -34,15 +34,16 @@
     Parameters
     ----------
     func : callable
         Function to apply to individual tuples of blocks
     out_ind : iterable
         Block pattern of the output, something like 'ijk' or (1, 2, 3)
     *args : sequence of Array, index pairs
-        Sequence like (x, 'ij', y, 'jk', z, 'i')
+        You may also pass literal arguments, accompanied by None index
+        e.g. (x, 'ij', y, 'jk', z, 'i', some_literal, None)
     **kwargs : dict
         Extra keyword arguments to pass to function
     dtype : np.dtype
         Datatype of resulting array.
     concatenate : bool, keyword only
         If true concatenate arrays along dummy indices, else provide lists
     adjust_chunks : dict
```

### Comparing `dask-2023.4.1/dask/array/chunk.py` & `dask-2023.5.0/dask/array/chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/chunk_types.py` & `dask-2023.5.0/dask/array/chunk_types.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/core.py` & `dask-2023.5.0/dask/array/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -3931,8002 +3931,8003 @@
 0000f5a0: 6e6c 7920 6c65 6e67 7468 2d31 2061 7272  nly length-1 arr
 0000f5b0: 6179 7320 6361 6e20 6265 2063 6f6e 7665  ays can be conve
 0000f5c0: 7274 6564 2074 6f20 5079 7468 6f6e 2073  rted to Python s
 0000f5d0: 6361 6c61 7273 2229 0a20 2020 2020 2020  calars").       
 0000f5e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
 0000f5f0: 2020 2072 6574 7572 6e20 6361 7374 5f74     return cast_t
 0000f600: 7970 6528 7365 6c66 2e63 6f6d 7075 7465  ype(self.compute
-0000f610: 2829 290a 0a20 2020 2064 6566 205f 5f69  ())..    def __i
-0000f620: 6e74 5f5f 2873 656c 6629 3a0a 2020 2020  nt__(self):.    
-0000f630: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000f640: 5f73 6361 6c61 7266 756e 6328 696e 7429  _scalarfunc(int)
-0000f650: 0a0a 2020 2020 5f5f 6c6f 6e67 5f5f 203d  ..    __long__ =
-0000f660: 205f 5f69 6e74 5f5f 2020 2320 7079 7468   __int__  # pyth
-0000f670: 6f6e 2032 0a0a 2020 2020 6465 6620 5f5f  on 2..    def __
-0000f680: 666c 6f61 745f 5f28 7365 6c66 293a 0a20  float__(self):. 
-0000f690: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000f6a0: 6c66 2e5f 7363 616c 6172 6675 6e63 2866  lf._scalarfunc(f
-0000f6b0: 6c6f 6174 290a 0a20 2020 2064 6566 205f  loat)..    def _
-0000f6c0: 5f63 6f6d 706c 6578 5f5f 2873 656c 6629  _complex__(self)
-0000f6d0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0000f6e0: 2073 656c 662e 5f73 6361 6c61 7266 756e   self._scalarfun
-0000f6f0: 6328 636f 6d70 6c65 7829 0a0a 2020 2020  c(complex)..    
-0000f700: 6465 6620 5f5f 696e 6465 785f 5f28 7365  def __index__(se
-0000f710: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-0000f720: 7572 6e20 7365 6c66 2e5f 7363 616c 6172  urn self._scalar
-0000f730: 6675 6e63 286f 7065 7261 746f 722e 696e  func(operator.in
-0000f740: 6465 7829 0a0a 2020 2020 6465 6620 5f5f  dex)..    def __
-0000f750: 7365 7469 7465 6d5f 5f28 7365 6c66 2c20  setitem__(self, 
-0000f760: 6b65 792c 2076 616c 7565 293a 0a20 2020  key, value):.   
-0000f770: 2020 2020 2069 6620 7661 6c75 6520 6973       if value is
-0000f780: 206e 702e 6d61 2e6d 6173 6b65 643a 0a20   np.ma.masked:. 
-0000f790: 2020 2020 2020 2020 2020 2076 616c 7565             value
-0000f7a0: 203d 206e 702e 6d61 2e6d 6173 6b65 645f   = np.ma.masked_
-0000f7b0: 616c 6c28 2829 2c20 6474 7970 653d 7365  all((), dtype=se
-0000f7c0: 6c66 2e64 7479 7065 290a 0a20 2020 2020  lf.dtype)..     
-0000f7d0: 2020 2069 6620 6e6f 7420 6973 5f64 6173     if not is_das
-0000f7e0: 6b5f 636f 6c6c 6563 7469 6f6e 2876 616c  k_collection(val
-0000f7f0: 7565 2920 616e 6420 6e70 2e69 736e 616e  ue) and np.isnan
-0000f800: 2876 616c 7565 292e 616e 7928 293a 0a20  (value).any():. 
-0000f810: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0000f820: 7375 6263 6c61 7373 2873 656c 662e 6474  subclass(self.dt
-0000f830: 7970 652e 7479 7065 2c20 496e 7465 6772  ype.type, Integr
-0000f840: 616c 293a 0a20 2020 2020 2020 2020 2020  al):.           
-0000f850: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000f860: 4572 726f 7228 2263 616e 6e6f 7420 636f  Error("cannot co
-0000f870: 6e76 6572 7420 666c 6f61 7420 4e61 4e20  nvert float NaN 
-0000f880: 746f 2069 6e74 6567 6572 2229 0a0a 2020  to integer")..  
-0000f890: 2020 2020 2020 2323 2055 7365 2074 6865        ## Use the
-0000f8a0: 2022 7768 6572 6522 206d 6574 686f 6420   "where" method 
-0000f8b0: 666f 7220 6361 7365 7320 7768 656e 206b  for cases when k
-0000f8c0: 6579 2069 7320 616e 2041 7272 6179 0a20  ey is an Array. 
-0000f8d0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0000f8e0: 616e 6365 286b 6579 2c20 4172 7261 7929  ance(key, Array)
-0000f8f0: 3a0a 2020 2020 2020 2020 2020 2020 6672  :.            fr
-0000f900: 6f6d 2064 6173 6b2e 6172 7261 792e 726f  om dask.array.ro
-0000f910: 7574 696e 6573 2069 6d70 6f72 7420 7768  utines import wh
-0000f920: 6572 650a 0a20 2020 2020 2020 2020 2020  ere..           
-0000f930: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
-0000f940: 616c 7565 2c20 4172 7261 7929 2061 6e64  alue, Array) and
-0000f950: 2076 616c 7565 2e6e 6469 6d20 3e20 313a   value.ndim > 1:
-0000f960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f970: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0000f980: 7228 2262 6f6f 6c65 616e 2069 6e64 6578  r("boolean index
-0000f990: 2061 7272 6179 2073 686f 756c 6420 6861   array should ha
-0000f9a0: 7665 2031 2064 696d 656e 7369 6f6e 2229  ve 1 dimension")
-0000f9b0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-0000f9c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000f9d0: 2020 7920 3d20 7768 6572 6528 6b65 792c    y = where(key,
-0000f9e0: 2076 616c 7565 2c20 7365 6c66 290a 2020   value, self).  
-0000f9f0: 2020 2020 2020 2020 2020 6578 6365 7074            except
-0000fa00: 2056 616c 7565 4572 726f 7220 6173 2065   ValueError as e
-0000fa10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000fa20: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0000fa30: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0000fa40: 2020 2020 2020 2020 2242 6f6f 6c65 616e          "Boolean
-0000fa50: 2069 6e64 6578 2061 7373 6967 6e6d 656e   index assignmen
-0000fa60: 7420 696e 2044 6173 6b20 220a 2020 2020  t in Dask ".    
-0000fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fa80: 2265 7870 6563 7473 2065 7175 616c 6c79  "expects equally
-0000fa90: 2073 6861 7065 6420 6172 7261 7973 2e5c   shaped arrays.\
-0000faa0: 6e45 7861 6d70 6c65 3a20 6461 315b 6461  nExample: da1[da
-0000fab0: 325d 203d 2064 6133 2022 0a20 2020 2020  2] = da3 ".     
-0000fac0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000fad0: 7768 6572 6520 6461 312e 7368 6170 6520  where da1.shape 
-0000fae0: 3d3d 2028 342c 292c 2064 6132 2e73 6861  == (4,), da2.sha
-0000faf0: 7065 203d 3d20 2834 2c29 2022 0a20 2020  pe == (4,) ".   
-0000fb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb10: 2022 616e 6420 6461 332e 7368 6170 6520   "and da3.shape 
-0000fb20: 3d3d 2028 342c 292e 5c6e 220a 2020 2020  == (4,).\n".    
-0000fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb40: 2241 6c74 6572 6e61 7469 7665 6c79 2c20  "Alternatively, 
-0000fb50: 796f 7520 6361 6e20 7573 6520 7468 6520  you can use the 
-0000fb60: 6578 7465 6e64 6564 2041 5049 2074 6861  extended API tha
-0000fb70: 7420 7375 7070 6f72 7473 220a 2020 2020  t supports".    
-0000fb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb90: 2269 6e64 6578 696e 6720 7769 7468 2074  "indexing with t
-0000fba0: 7570 6c65 732e 5c6e 4578 616d 706c 653a  uples.\nExample:
-0000fbb0: 2064 6131 5b28 6461 322c 295d 203d 2064   da1[(da2,)] = d
-0000fbc0: 6133 2e22 0a20 2020 2020 2020 2020 2020  a3.".           
-0000fbd0: 2020 2020 2029 2066 726f 6d20 650a 2020       ) from e.  
-0000fbe0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000fbf0: 6d65 7461 203d 2079 2e5f 6d65 7461 0a20  meta = y._meta. 
-0000fc00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000fc10: 6461 736b 203d 2079 2e64 6173 6b0a 2020  dask = y.dask.  
-0000fc20: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000fc30: 6e61 6d65 203d 2079 2e6e 616d 650a 2020  name = y.name.  
-0000fc40: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000fc50: 6368 756e 6b73 203d 2079 2e63 6875 6e6b  chunks = y.chunk
-0000fc60: 730a 2020 2020 2020 2020 2020 2020 7265  s.            re
-0000fc70: 7475 726e 0a0a 2020 2020 2020 2020 6966  turn..        if
-0000fc80: 206e 702e 6973 6e61 6e28 7365 6c66 2e73   np.isnan(self.s
-0000fc90: 6861 7065 292e 616e 7928 293a 0a20 2020  hape).any():.   
-0000fca0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0000fcb0: 616c 7565 4572 726f 7228 6622 4172 7261  alueError(f"Arra
-0000fcc0: 7973 2063 6875 6e6b 2073 697a 6573 2061  ys chunk sizes a
-0000fcd0: 7265 2075 6e6b 6e6f 776e 2e20 7b75 6e6b  re unknown. {unk
-0000fce0: 6e6f 776e 5f63 6875 6e6b 5f6d 6573 7361  nown_chunk_messa
-0000fcf0: 6765 7d22 290a 0a20 2020 2020 2020 2023  ge}")..        #
-0000fd00: 2053 7469 6c6c 2068 6572 653f 2054 6865   Still here? The
-0000fd10: 6e20 6170 706c 7920 7468 6520 6173 7369  n apply the assi
-0000fd20: 676e 6d65 6e74 2074 6f20 6f74 6865 7220  gnment to other 
-0000fd30: 7479 7065 206f 660a 2020 2020 2020 2020  type of.        
-0000fd40: 2320 696e 6469 6365 7320 7669 6120 7468  # indices via th
-0000fd50: 6520 6073 6574 6974 656d 5f61 7272 6179  e `setitem_array
-0000fd60: 6020 6675 6e63 7469 6f6e 2e0a 2020 2020  ` function..    
-0000fd70: 2020 2020 7661 6c75 6520 3d20 6173 616e      value = asan
-0000fd80: 7961 7272 6179 2876 616c 7565 290a 0a20  yarray(value).. 
-0000fd90: 2020 2020 2020 206f 7574 203d 2022 7365         out = "se
-0000fda0: 7469 7465 6d2d 2220 2b20 746f 6b65 6e69  titem-" + tokeni
-0000fdb0: 7a65 2873 656c 662c 206b 6579 2c20 7661  ze(self, key, va
-0000fdc0: 6c75 6529 0a20 2020 2020 2020 2064 736b  lue).        dsk
-0000fdd0: 203d 2073 6574 6974 656d 5f61 7272 6179   = setitem_array
-0000fde0: 286f 7574 2c20 7365 6c66 2c20 6b65 792c  (out, self, key,
-0000fdf0: 2076 616c 7565 290a 0a20 2020 2020 2020   value)..       
-0000fe00: 206d 6574 6120 3d20 6d65 7461 5f66 726f   meta = meta_fro
-0000fe10: 6d5f 6172 7261 7928 7365 6c66 2e5f 6d65  m_array(self._me
-0000fe20: 7461 290a 2020 2020 2020 2020 6966 206e  ta).        if n
-0000fe30: 702e 6973 7363 616c 6172 286d 6574 6129  p.isscalar(meta)
-0000fe40: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
-0000fe50: 7461 203d 206e 702e 6172 7261 7928 6d65  ta = np.array(me
-0000fe60: 7461 290a 0a20 2020 2020 2020 2067 7261  ta)..        gra
-0000fe70: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
-0000fe80: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
-0000fe90: 696f 6e73 286f 7574 2c20 6473 6b2c 2064  ions(out, dsk, d
-0000fea0: 6570 656e 6465 6e63 6965 733d 5b73 656c  ependencies=[sel
-0000feb0: 665d 290a 2020 2020 2020 2020 7920 3d20  f]).        y = 
-0000fec0: 4172 7261 7928 6772 6170 682c 206f 7574  Array(graph, out
-0000fed0: 2c20 6368 756e 6b73 3d73 656c 662e 6368  , chunks=self.ch
-0000fee0: 756e 6b73 2c20 6474 7970 653d 7365 6c66  unks, dtype=self
-0000fef0: 2e64 7479 7065 2c20 6d65 7461 3d6d 6574  .dtype, meta=met
-0000ff00: 6129 0a0a 2020 2020 2020 2020 7365 6c66  a)..        self
-0000ff10: 2e5f 6d65 7461 203d 2079 2e5f 6d65 7461  ._meta = y._meta
-0000ff20: 0a20 2020 2020 2020 2073 656c 662e 6461  .        self.da
-0000ff30: 736b 203d 2079 2e64 6173 6b0a 2020 2020  sk = y.dask.    
-0000ff40: 2020 2020 7365 6c66 2e5f 6e61 6d65 203d      self._name =
-0000ff50: 2079 2e6e 616d 650a 2020 2020 2020 2020   y.name.        
-0000ff60: 7365 6c66 2e5f 6368 756e 6b73 203d 2079  self._chunks = y
-0000ff70: 2e63 6875 6e6b 730a 0a20 2020 2064 6566  .chunks..    def
-0000ff80: 205f 5f67 6574 6974 656d 5f5f 2873 656c   __getitem__(sel
-0000ff90: 662c 2069 6e64 6578 293a 0a20 2020 2020  f, index):.     
-0000ffa0: 2020 2023 2046 6965 6c64 2061 6363 6573     # Field acces
-0000ffb0: 732c 2065 2e67 2e20 785b 2761 275d 206f  s, e.g. x['a'] o
-0000ffc0: 7220 785b 5b27 6127 2c20 2762 275d 5d0a  r x[['a', 'b']].
-0000ffd0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0000ffe0: 7461 6e63 6528 696e 6465 782c 2073 7472  tance(index, str
-0000fff0: 2920 6f72 2028 0a20 2020 2020 2020 2020  ) or (.         
-00010000: 2020 2069 7369 6e73 7461 6e63 6528 696e     isinstance(in
-00010010: 6465 782c 206c 6973 7429 2061 6e64 2069  dex, list) and i
-00010020: 6e64 6578 2061 6e64 2061 6c6c 2869 7369  ndex and all(isi
-00010030: 6e73 7461 6e63 6528 692c 2073 7472 2920  nstance(i, str) 
-00010040: 666f 7220 6920 696e 2069 6e64 6578 290a  for i in index).
-00010050: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-00010060: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00010070: 616e 6365 2869 6e64 6578 2c20 7374 7229  ance(index, str)
-00010080: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00010090: 2020 6474 203d 2073 656c 662e 6474 7970    dt = self.dtyp
-000100a0: 655b 696e 6465 785d 0a20 2020 2020 2020  e[index].       
-000100b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000100c0: 2020 2020 2020 2020 2020 2064 7420 3d20             dt = 
-000100d0: 6e70 2e64 7479 7065 280a 2020 2020 2020  np.dtype(.      
-000100e0: 2020 2020 2020 2020 2020 2020 2020 7b0a                {.
-000100f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010100: 2020 2020 2020 2020 226e 616d 6573 223a          "names":
-00010110: 2069 6e64 6578 2c0a 2020 2020 2020 2020   index,.        
+0000f610: 2829 2e69 7465 6d28 2929 0a0a 2020 2020  ().item())..    
+0000f620: 6465 6620 5f5f 696e 745f 5f28 7365 6c66  def __int__(self
+0000f630: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0000f640: 6e20 7365 6c66 2e5f 7363 616c 6172 6675  n self._scalarfu
+0000f650: 6e63 2869 6e74 290a 0a20 2020 205f 5f6c  nc(int)..    __l
+0000f660: 6f6e 675f 5f20 3d20 5f5f 696e 745f 5f20  ong__ = __int__ 
+0000f670: 2023 2070 7974 686f 6e20 320a 0a20 2020   # python 2..   
+0000f680: 2064 6566 205f 5f66 6c6f 6174 5f5f 2873   def __float__(s
+0000f690: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+0000f6a0: 7475 726e 2073 656c 662e 5f73 6361 6c61  turn self._scala
+0000f6b0: 7266 756e 6328 666c 6f61 7429 0a0a 2020  rfunc(float)..  
+0000f6c0: 2020 6465 6620 5f5f 636f 6d70 6c65 785f    def __complex_
+0000f6d0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+0000f6e0: 2072 6574 7572 6e20 7365 6c66 2e5f 7363   return self._sc
+0000f6f0: 616c 6172 6675 6e63 2863 6f6d 706c 6578  alarfunc(complex
+0000f700: 290a 0a20 2020 2064 6566 205f 5f69 6e64  )..    def __ind
+0000f710: 6578 5f5f 2873 656c 6629 3a0a 2020 2020  ex__(self):.    
+0000f720: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000f730: 5f73 6361 6c61 7266 756e 6328 6f70 6572  _scalarfunc(oper
+0000f740: 6174 6f72 2e69 6e64 6578 290a 0a20 2020  ator.index)..   
+0000f750: 2064 6566 205f 5f73 6574 6974 656d 5f5f   def __setitem__
+0000f760: 2873 656c 662c 206b 6579 2c20 7661 6c75  (self, key, valu
+0000f770: 6529 3a0a 2020 2020 2020 2020 6966 2076  e):.        if v
+0000f780: 616c 7565 2069 7320 6e70 2e6d 612e 6d61  alue is np.ma.ma
+0000f790: 736b 6564 3a0a 2020 2020 2020 2020 2020  sked:.          
+0000f7a0: 2020 7661 6c75 6520 3d20 6e70 2e6d 612e    value = np.ma.
+0000f7b0: 6d61 736b 6564 5f61 6c6c 2828 292c 2064  masked_all((), d
+0000f7c0: 7479 7065 3d73 656c 662e 6474 7970 6529  type=self.dtype)
+0000f7d0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0000f7e0: 2069 735f 6461 736b 5f63 6f6c 6c65 6374   is_dask_collect
+0000f7f0: 696f 6e28 7661 6c75 6529 2061 6e64 206e  ion(value) and n
+0000f800: 702e 6973 6e61 6e28 7661 6c75 6529 2e61  p.isnan(value).a
+0000f810: 6e79 2829 3a0a 2020 2020 2020 2020 2020  ny():.          
+0000f820: 2020 6966 2069 7373 7562 636c 6173 7328    if issubclass(
+0000f830: 7365 6c66 2e64 7479 7065 2e74 7970 652c  self.dtype.type,
+0000f840: 2049 6e74 6567 7261 6c29 3a0a 2020 2020   Integral):.    
+0000f850: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000f860: 6520 5661 6c75 6545 7272 6f72 2822 6361  e ValueError("ca
+0000f870: 6e6e 6f74 2063 6f6e 7665 7274 2066 6c6f  nnot convert flo
+0000f880: 6174 204e 614e 2074 6f20 696e 7465 6765  at NaN to intege
+0000f890: 7222 290a 0a20 2020 2020 2020 2023 2320  r")..        ## 
+0000f8a0: 5573 6520 7468 6520 2277 6865 7265 2220  Use the "where" 
+0000f8b0: 6d65 7468 6f64 2066 6f72 2063 6173 6573  method for cases
+0000f8c0: 2077 6865 6e20 6b65 7920 6973 2061 6e20   when key is an 
+0000f8d0: 4172 7261 790a 2020 2020 2020 2020 6966  Array.        if
+0000f8e0: 2069 7369 6e73 7461 6e63 6528 6b65 792c   isinstance(key,
+0000f8f0: 2041 7272 6179 293a 0a20 2020 2020 2020   Array):.       
+0000f900: 2020 2020 2066 726f 6d20 6461 736b 2e61       from dask.a
+0000f910: 7272 6179 2e72 6f75 7469 6e65 7320 696d  rray.routines im
+0000f920: 706f 7274 2077 6865 7265 0a0a 2020 2020  port where..    
+0000f930: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000f940: 7461 6e63 6528 7661 6c75 652c 2041 7272  tance(value, Arr
+0000f950: 6179 2920 616e 6420 7661 6c75 652e 6e64  ay) and value.nd
+0000f960: 696d 203e 2031 3a0a 2020 2020 2020 2020  im > 1:.        
+0000f970: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0000f980: 6c75 6545 7272 6f72 2822 626f 6f6c 6561  lueError("boolea
+0000f990: 6e20 696e 6465 7820 6172 7261 7920 7368  n index array sh
+0000f9a0: 6f75 6c64 2068 6176 6520 3120 6469 6d65  ould have 1 dime
+0000f9b0: 6e73 696f 6e22 290a 2020 2020 2020 2020  nsion").        
+0000f9c0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0000f9d0: 2020 2020 2020 2020 2079 203d 2077 6865           y = whe
+0000f9e0: 7265 286b 6579 2c20 7661 6c75 652c 2073  re(key, value, s
+0000f9f0: 656c 6629 0a20 2020 2020 2020 2020 2020  elf).           
+0000fa00: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
+0000fa10: 6f72 2061 7320 653a 0a20 2020 2020 2020  or as e:.       
+0000fa20: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0000fa30: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+0000fa40: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000fa50: 426f 6f6c 6561 6e20 696e 6465 7820 6173  Boolean index as
+0000fa60: 7369 676e 6d65 6e74 2069 6e20 4461 736b  signment in Dask
+0000fa70: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0000fa80: 2020 2020 2020 2022 6578 7065 6374 7320         "expects 
+0000fa90: 6571 7561 6c6c 7920 7368 6170 6564 2061  equally shaped a
+0000faa0: 7272 6179 732e 5c6e 4578 616d 706c 653a  rrays.\nExample:
+0000fab0: 2064 6131 5b64 6132 5d20 3d20 6461 3320   da1[da2] = da3 
+0000fac0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0000fad0: 2020 2020 2020 2277 6865 7265 2064 6131        "where da1
+0000fae0: 2e73 6861 7065 203d 3d20 2834 2c29 2c20  .shape == (4,), 
+0000faf0: 6461 322e 7368 6170 6520 3d3d 2028 342c  da2.shape == (4,
+0000fb00: 2920 220a 2020 2020 2020 2020 2020 2020  ) ".            
+0000fb10: 2020 2020 2020 2020 2261 6e64 2064 6133          "and da3
+0000fb20: 2e73 6861 7065 203d 3d20 2834 2c29 2e5c  .shape == (4,).\
+0000fb30: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
+0000fb40: 2020 2020 2020 2022 416c 7465 726e 6174         "Alternat
+0000fb50: 6976 656c 792c 2079 6f75 2063 616e 2075  ively, you can u
+0000fb60: 7365 2074 6865 2065 7874 656e 6465 6420  se the extended 
+0000fb70: 4150 4920 7468 6174 2073 7570 706f 7274  API that support
+0000fb80: 7322 0a20 2020 2020 2020 2020 2020 2020  s".             
+0000fb90: 2020 2020 2020 2022 696e 6465 7869 6e67         "indexing
+0000fba0: 2077 6974 6820 7475 706c 6573 2e5c 6e45   with tuples.\nE
+0000fbb0: 7861 6d70 6c65 3a20 6461 315b 2864 6132  xample: da1[(da2
+0000fbc0: 2c29 5d20 3d20 6461 332e 220a 2020 2020  ,)] = da3.".    
+0000fbd0: 2020 2020 2020 2020 2020 2020 2920 6672              ) fr
+0000fbe0: 6f6d 2065 0a20 2020 2020 2020 2020 2020  om e.           
+0000fbf0: 2073 656c 662e 5f6d 6574 6120 3d20 792e   self._meta = y.
+0000fc00: 5f6d 6574 610a 2020 2020 2020 2020 2020  _meta.          
+0000fc10: 2020 7365 6c66 2e64 6173 6b20 3d20 792e    self.dask = y.
+0000fc20: 6461 736b 0a20 2020 2020 2020 2020 2020  dask.           
+0000fc30: 2073 656c 662e 5f6e 616d 6520 3d20 792e   self._name = y.
+0000fc40: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+0000fc50: 2073 656c 662e 5f63 6875 6e6b 7320 3d20   self._chunks = 
+0000fc60: 792e 6368 756e 6b73 0a20 2020 2020 2020  y.chunks.       
+0000fc70: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
+0000fc80: 2020 2020 2069 6620 6e70 2e69 736e 616e       if np.isnan
+0000fc90: 2873 656c 662e 7368 6170 6529 2e61 6e79  (self.shape).any
+0000fca0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0000fcb0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0000fcc0: 2866 2241 7272 6179 7320 6368 756e 6b20  (f"Arrays chunk 
+0000fcd0: 7369 7a65 7320 6172 6520 756e 6b6e 6f77  sizes are unknow
+0000fce0: 6e2e 207b 756e 6b6e 6f77 6e5f 6368 756e  n. {unknown_chun
+0000fcf0: 6b5f 6d65 7373 6167 657d 2229 0a0a 2020  k_message}")..  
+0000fd00: 2020 2020 2020 2320 5374 696c 6c20 6865        # Still he
+0000fd10: 7265 3f20 5468 656e 2061 7070 6c79 2074  re? Then apply t
+0000fd20: 6865 2061 7373 6967 6e6d 656e 7420 746f  he assignment to
+0000fd30: 206f 7468 6572 2074 7970 6520 6f66 0a20   other type of. 
+0000fd40: 2020 2020 2020 2023 2069 6e64 6963 6573         # indices
+0000fd50: 2076 6961 2074 6865 2060 7365 7469 7465   via the `setite
+0000fd60: 6d5f 6172 7261 7960 2066 756e 6374 696f  m_array` functio
+0000fd70: 6e2e 0a20 2020 2020 2020 2076 616c 7565  n..        value
+0000fd80: 203d 2061 7361 6e79 6172 7261 7928 7661   = asanyarray(va
+0000fd90: 6c75 6529 0a0a 2020 2020 2020 2020 6f75  lue)..        ou
+0000fda0: 7420 3d20 2273 6574 6974 656d 2d22 202b  t = "setitem-" +
+0000fdb0: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
+0000fdc0: 6b65 792c 2076 616c 7565 290a 2020 2020  key, value).    
+0000fdd0: 2020 2020 6473 6b20 3d20 7365 7469 7465      dsk = setite
+0000fde0: 6d5f 6172 7261 7928 6f75 742c 2073 656c  m_array(out, sel
+0000fdf0: 662c 206b 6579 2c20 7661 6c75 6529 0a0a  f, key, value)..
+0000fe00: 2020 2020 2020 2020 6d65 7461 203d 206d          meta = m
+0000fe10: 6574 615f 6672 6f6d 5f61 7272 6179 2873  eta_from_array(s
+0000fe20: 656c 662e 5f6d 6574 6129 0a20 2020 2020  elf._meta).     
+0000fe30: 2020 2069 6620 6e70 2e69 7373 6361 6c61     if np.isscala
+0000fe40: 7228 6d65 7461 293a 0a20 2020 2020 2020  r(meta):.       
+0000fe50: 2020 2020 206d 6574 6120 3d20 6e70 2e61       meta = np.a
+0000fe60: 7272 6179 286d 6574 6129 0a0a 2020 2020  rray(meta)..    
+0000fe70: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+0000fe80: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+0000fe90: 636f 6c6c 6563 7469 6f6e 7328 6f75 742c  collections(out,
+0000fea0: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+0000feb0: 6573 3d5b 7365 6c66 5d29 0a20 2020 2020  es=[self]).     
+0000fec0: 2020 2079 203d 2041 7272 6179 2867 7261     y = Array(gra
+0000fed0: 7068 2c20 6f75 742c 2063 6875 6e6b 733d  ph, out, chunks=
+0000fee0: 7365 6c66 2e63 6875 6e6b 732c 2064 7479  self.chunks, dty
+0000fef0: 7065 3d73 656c 662e 6474 7970 652c 206d  pe=self.dtype, m
+0000ff00: 6574 613d 6d65 7461 290a 0a20 2020 2020  eta=meta)..     
+0000ff10: 2020 2073 656c 662e 5f6d 6574 6120 3d20     self._meta = 
+0000ff20: 792e 5f6d 6574 610a 2020 2020 2020 2020  y._meta.        
+0000ff30: 7365 6c66 2e64 6173 6b20 3d20 792e 6461  self.dask = y.da
+0000ff40: 736b 0a20 2020 2020 2020 2073 656c 662e  sk.        self.
+0000ff50: 5f6e 616d 6520 3d20 792e 6e61 6d65 0a20  _name = y.name. 
+0000ff60: 2020 2020 2020 2073 656c 662e 5f63 6875         self._chu
+0000ff70: 6e6b 7320 3d20 792e 6368 756e 6b73 0a0a  nks = y.chunks..
+0000ff80: 2020 2020 6465 6620 5f5f 6765 7469 7465      def __getite
+0000ff90: 6d5f 5f28 7365 6c66 2c20 696e 6465 7829  m__(self, index)
+0000ffa0: 3a0a 2020 2020 2020 2020 2320 4669 656c  :.        # Fiel
+0000ffb0: 6420 6163 6365 7373 2c20 652e 672e 2078  d access, e.g. x
+0000ffc0: 5b27 6127 5d20 6f72 2078 5b5b 2761 272c  ['a'] or x[['a',
+0000ffd0: 2027 6227 5d5d 0a20 2020 2020 2020 2069   'b']].        i
+0000ffe0: 6620 6973 696e 7374 616e 6365 2869 6e64  f isinstance(ind
+0000fff0: 6578 2c20 7374 7229 206f 7220 280a 2020  ex, str) or (.  
+00010000: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
+00010010: 616e 6365 2869 6e64 6578 2c20 6c69 7374  ance(index, list
+00010020: 2920 616e 6420 696e 6465 7820 616e 6420  ) and index and 
+00010030: 616c 6c28 6973 696e 7374 616e 6365 2869  all(isinstance(i
+00010040: 2c20 7374 7229 2066 6f72 2069 2069 6e20  , str) for i in 
+00010050: 696e 6465 7829 0a20 2020 2020 2020 2029  index).        )
+00010060: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00010070: 2069 7369 6e73 7461 6e63 6528 696e 6465   isinstance(inde
+00010080: 782c 2073 7472 293a 0a20 2020 2020 2020  x, str):.       
+00010090: 2020 2020 2020 2020 2064 7420 3d20 7365           dt = se
+000100a0: 6c66 2e64 7479 7065 5b69 6e64 6578 5d0a  lf.dtype[index].
+000100b0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000100c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000100d0: 2020 6474 203d 206e 702e 6474 7970 6528    dt = np.dtype(
+000100e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000100f0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+00010100: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00010110: 6e61 6d65 7322 3a20 696e 6465 782c 0a20  names": index,. 
 00010120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010130: 2266 6f72 6d61 7473 223a 205b 7365 6c66  "formats": [self
-00010140: 2e64 7479 7065 2e66 6965 6c64 735b 6e61  .dtype.fields[na
-00010150: 6d65 5d5b 305d 2066 6f72 206e 616d 6520  me][0] for name 
-00010160: 696e 2069 6e64 6578 5d2c 0a20 2020 2020  in index],.     
-00010170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010180: 2020 2022 6f66 6673 6574 7322 3a20 5b73     "offsets": [s
-00010190: 656c 662e 6474 7970 652e 6669 656c 6473  elf.dtype.fields
-000101a0: 5b6e 616d 655d 5b31 5d20 666f 7220 6e61  [name][1] for na
-000101b0: 6d65 2069 6e20 696e 6465 785d 2c0a 2020  me in index],.  
-000101c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000101d0: 2020 2020 2020 2269 7465 6d73 697a 6522        "itemsize"
-000101e0: 3a20 7365 6c66 2e64 7479 7065 2e69 7465  : self.dtype.ite
-000101f0: 6d73 697a 652c 0a20 2020 2020 2020 2020  msize,.         
-00010200: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-00010210: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-00010220: 2020 2020 2020 2020 2020 2020 6966 2064              if d
-00010230: 742e 7368 6170 653a 0a20 2020 2020 2020  t.shape:.       
-00010240: 2020 2020 2020 2020 206e 6577 5f61 7869           new_axi
-00010250: 7320 3d20 6c69 7374 2872 616e 6765 2873  s = list(range(s
-00010260: 656c 662e 6e64 696d 2c20 7365 6c66 2e6e  elf.ndim, self.n
-00010270: 6469 6d20 2b20 6c65 6e28 6474 2e73 6861  dim + len(dt.sha
-00010280: 7065 2929 290a 2020 2020 2020 2020 2020  pe))).          
-00010290: 2020 2020 2020 6368 756e 6b73 203d 2073        chunks = s
-000102a0: 656c 662e 6368 756e 6b73 202b 2074 7570  elf.chunks + tup
-000102b0: 6c65 2828 692c 2920 666f 7220 6920 696e  le((i,) for i in
-000102c0: 2064 742e 7368 6170 6529 0a20 2020 2020   dt.shape).     
-000102d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000102e0: 6e20 7365 6c66 2e6d 6170 5f62 6c6f 636b  n self.map_block
-000102f0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-00010300: 2020 2020 2020 2067 6574 6974 656d 2c20         getitem, 
-00010310: 696e 6465 782c 2064 7479 7065 3d64 742e  index, dtype=dt.
-00010320: 6261 7365 2c20 6368 756e 6b73 3d63 6875  base, chunks=chu
-00010330: 6e6b 732c 206e 6577 5f61 7869 733d 6e65  nks, new_axis=ne
-00010340: 775f 6178 6973 0a20 2020 2020 2020 2020  w_axis.         
-00010350: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00010360: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00010370: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00010380: 6e20 7365 6c66 2e6d 6170 5f62 6c6f 636b  n self.map_block
-00010390: 7328 6765 7469 7465 6d2c 2069 6e64 6578  s(getitem, index
-000103a0: 2c20 6474 7970 653d 6474 290a 0a20 2020  , dtype=dt)..   
-000103b0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-000103c0: 7374 616e 6365 2869 6e64 6578 2c20 7475  stance(index, tu
-000103d0: 706c 6529 3a0a 2020 2020 2020 2020 2020  ple):.          
-000103e0: 2020 696e 6465 7820 3d20 2869 6e64 6578    index = (index
-000103f0: 2c29 0a0a 2020 2020 2020 2020 6672 6f6d  ,)..        from
-00010400: 2064 6173 6b2e 6172 7261 792e 736c 6963   dask.array.slic
-00010410: 696e 6720 696d 706f 7274 2028 0a20 2020  ing import (.   
-00010420: 2020 2020 2020 2020 206e 6f72 6d61 6c69           normali
-00010430: 7a65 5f69 6e64 6578 2c0a 2020 2020 2020  ze_index,.      
-00010440: 2020 2020 2020 736c 6963 655f 7769 7468        slice_with
-00010450: 5f62 6f6f 6c5f 6461 736b 5f61 7272 6179  _bool_dask_array
-00010460: 2c0a 2020 2020 2020 2020 2020 2020 736c  ,.            sl
-00010470: 6963 655f 7769 7468 5f69 6e74 5f64 6173  ice_with_int_das
-00010480: 6b5f 6172 7261 792c 0a20 2020 2020 2020  k_array,.       
-00010490: 2029 0a0a 2020 2020 2020 2020 696e 6465   )..        inde
-000104a0: 7832 203d 206e 6f72 6d61 6c69 7a65 5f69  x2 = normalize_i
-000104b0: 6e64 6578 2869 6e64 6578 2c20 7365 6c66  ndex(index, self
-000104c0: 2e73 6861 7065 290a 2020 2020 2020 2020  .shape).        
-000104d0: 6465 7065 6e64 656e 6369 6573 203d 207b  dependencies = {
-000104e0: 7365 6c66 2e6e 616d 657d 0a20 2020 2020  self.name}.     
-000104f0: 2020 2066 6f72 2069 2069 6e20 696e 6465     for i in inde
-00010500: 7832 3a0a 2020 2020 2020 2020 2020 2020  x2:.            
-00010510: 6966 2069 7369 6e73 7461 6e63 6528 692c  if isinstance(i,
-00010520: 2041 7272 6179 293a 0a20 2020 2020 2020   Array):.       
-00010530: 2020 2020 2020 2020 2064 6570 656e 6465           depende
-00010540: 6e63 6965 732e 6164 6428 692e 6e61 6d65  ncies.add(i.name
-00010550: 290a 0a20 2020 2020 2020 2069 6620 616e  )..        if an
-00010560: 7928 6973 696e 7374 616e 6365 2869 2c20  y(isinstance(i, 
-00010570: 4172 7261 7929 2061 6e64 2069 2e64 7479  Array) and i.dty
-00010580: 7065 2e6b 696e 6420 696e 2022 6975 2220  pe.kind in "iu" 
-00010590: 666f 7220 6920 696e 2069 6e64 6578 3229  for i in index2)
-000105a0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-000105b0: 6c66 2c20 696e 6465 7832 203d 2073 6c69  lf, index2 = sli
-000105c0: 6365 5f77 6974 685f 696e 745f 6461 736b  ce_with_int_dask
-000105d0: 5f61 7272 6179 2873 656c 662c 2069 6e64  _array(self, ind
-000105e0: 6578 3229 0a20 2020 2020 2020 2069 6620  ex2).        if 
-000105f0: 616e 7928 6973 696e 7374 616e 6365 2869  any(isinstance(i
-00010600: 2c20 4172 7261 7929 2061 6e64 2069 2e64  , Array) and i.d
-00010610: 7479 7065 203d 3d20 626f 6f6c 2066 6f72  type == bool for
-00010620: 2069 2069 6e20 696e 6465 7832 293a 0a20   i in index2):. 
-00010630: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00010640: 2069 6e64 6578 3220 3d20 736c 6963 655f   index2 = slice_
-00010650: 7769 7468 5f62 6f6f 6c5f 6461 736b 5f61  with_bool_dask_a
-00010660: 7272 6179 2873 656c 662c 2069 6e64 6578  rray(self, index
-00010670: 3229 0a0a 2020 2020 2020 2020 6966 2061  2)..        if a
-00010680: 6c6c 2869 7369 6e73 7461 6e63 6528 692c  ll(isinstance(i,
-00010690: 2073 6c69 6365 2920 616e 6420 6920 3d3d   slice) and i ==
-000106a0: 2073 6c69 6365 284e 6f6e 6529 2066 6f72   slice(None) for
-000106b0: 2069 2069 6e20 696e 6465 7832 293a 0a20   i in index2):. 
-000106c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000106d0: 6e20 7365 6c66 0a0a 2020 2020 2020 2020  n self..        
-000106e0: 6f75 7420 3d20 2267 6574 6974 656d 2d22  out = "getitem-"
-000106f0: 202b 2074 6f6b 656e 697a 6528 7365 6c66   + tokenize(self
-00010700: 2c20 696e 6465 7832 290a 2020 2020 2020  , index2).      
-00010710: 2020 6473 6b2c 2063 6875 6e6b 7320 3d20    dsk, chunks = 
-00010720: 736c 6963 655f 6172 7261 7928 6f75 742c  slice_array(out,
-00010730: 2073 656c 662e 6e61 6d65 2c20 7365 6c66   self.name, self
-00010740: 2e63 6875 6e6b 732c 2069 6e64 6578 322c  .chunks, index2,
-00010750: 2073 656c 662e 6974 656d 7369 7a65 290a   self.itemsize).
-00010760: 0a20 2020 2020 2020 2067 7261 7068 203d  .        graph =
-00010770: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-00010780: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-00010790: 286f 7574 2c20 6473 6b2c 2064 6570 656e  (out, dsk, depen
-000107a0: 6465 6e63 6965 733d 5b73 656c 665d 290a  dencies=[self]).
-000107b0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
-000107c0: 6d65 7461 5f66 726f 6d5f 6172 7261 7928  meta_from_array(
-000107d0: 7365 6c66 2e5f 6d65 7461 2c20 6e64 696d  self._meta, ndim
-000107e0: 3d6c 656e 2863 6875 6e6b 7329 290a 2020  =len(chunks)).  
-000107f0: 2020 2020 2020 6966 206e 702e 6973 7363        if np.issc
-00010800: 616c 6172 286d 6574 6129 3a0a 2020 2020  alar(meta):.    
-00010810: 2020 2020 2020 2020 6d65 7461 203d 206e          meta = n
-00010820: 702e 6172 7261 7928 6d65 7461 290a 0a20  p.array(meta).. 
-00010830: 2020 2020 2020 2072 6574 7572 6e20 4172         return Ar
-00010840: 7261 7928 6772 6170 682c 206f 7574 2c20  ray(graph, out, 
-00010850: 6368 756e 6b73 2c20 6d65 7461 3d6d 6574  chunks, meta=met
-00010860: 6129 0a0a 2020 2020 6465 6620 5f76 696e  a)..    def _vin
-00010870: 6465 7828 7365 6c66 2c20 6b65 7929 3a0a  dex(self, key):.
-00010880: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-00010890: 7369 6e73 7461 6e63 6528 6b65 792c 2074  sinstance(key, t
-000108a0: 7570 6c65 293a 0a20 2020 2020 2020 2020  uple):.         
-000108b0: 2020 206b 6579 203d 2028 6b65 792c 290a     key = (key,).
-000108c0: 2020 2020 2020 2020 6966 2061 6e79 286b          if any(k
-000108d0: 2069 7320 4e6f 6e65 2066 6f72 206b 2069   is None for k i
-000108e0: 6e20 6b65 7929 3a0a 2020 2020 2020 2020  n key):.        
-000108f0: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
-00010900: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00010910: 2020 2020 2020 2276 696e 6465 7820 646f        "vindex do
-00010920: 6573 206e 6f74 2073 7570 706f 7274 2069  es not support i
-00010930: 6e64 6578 696e 6720 7769 7468 204e 6f6e  ndexing with Non
-00010940: 6520 286e 702e 6e65 7761 7869 7329 2c20  e (np.newaxis), 
-00010950: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00010960: 2020 2267 6f74 207b 7d22 2e66 6f72 6d61    "got {}".forma
-00010970: 7428 6b65 7929 0a20 2020 2020 2020 2020  t(key).         
-00010980: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-00010990: 616c 6c28 6973 696e 7374 616e 6365 286b  all(isinstance(k
-000109a0: 2c20 736c 6963 6529 2066 6f72 206b 2069  , slice) for k i
-000109b0: 6e20 6b65 7929 3a0a 2020 2020 2020 2020  n key):.        
-000109c0: 2020 2020 6966 2061 6c6c 280a 2020 2020      if all(.    
-000109d0: 2020 2020 2020 2020 2020 2020 6b2e 696e              k.in
-000109e0: 6469 6365 7328 6429 203d 3d20 736c 6963  dices(d) == slic
-000109f0: 6528 302c 2064 292e 696e 6469 6365 7328  e(0, d).indices(
-00010a00: 6429 2066 6f72 206b 2c20 6420 696e 207a  d) for k, d in z
-00010a10: 6970 286b 6579 2c20 7365 6c66 2e73 6861  ip(key, self.sha
-00010a20: 7065 290a 2020 2020 2020 2020 2020 2020  pe).            
-00010a30: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00010a40: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
-00010a50: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00010a60: 2049 6e64 6578 4572 726f 7228 0a20 2020   IndexError(.   
-00010a70: 2020 2020 2020 2020 2020 2020 2022 7669               "vi
-00010a80: 6e64 6578 2072 6571 7569 7265 7320 6174  ndex requires at
-00010a90: 206c 6561 7374 206f 6e65 206e 6f6e 2d73   least one non-s
-00010aa0: 6c69 6365 2074 6f20 7665 6374 6f72 697a  lice to vectoriz
-00010ab0: 6520 6f76 6572 2022 0a20 2020 2020 2020  e over ".       
-00010ac0: 2020 2020 2020 2020 2022 7768 656e 2074           "when t
-00010ad0: 6865 2073 6c69 6365 7320 6172 6520 6e6f  he slices are no
-00010ae0: 7420 6f76 6572 2074 6865 2065 6e74 6972  t over the entir
-00010af0: 6520 6172 7261 7920 2869 2e65 2c20 785b  e array (i.e, x[
-00010b00: 3a5d 292e 2022 0a20 2020 2020 2020 2020  :]). ".         
-00010b10: 2020 2020 2020 2022 5573 6520 6e6f 726d         "Use norm
-00010b20: 616c 2073 6c69 6369 6e67 2069 6e73 7465  al slicing inste
-00010b30: 6164 2077 6865 6e20 6f6e 6c79 2075 7369  ad when only usi
-00010b40: 6e67 2073 6c69 6365 732e 2047 6f74 3a20  ng slices. Got: 
-00010b50: 7b7d 222e 666f 726d 6174 286b 6579 290a  {}".format(key).
-00010b60: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00010b70: 2020 2020 2020 656c 6966 2061 6e79 2869        elif any(i
-00010b80: 735f 6461 736b 5f63 6f6c 6c65 6374 696f  s_dask_collectio
-00010b90: 6e28 6b29 2066 6f72 206b 2069 6e20 6b65  n(k) for k in ke
-00010ba0: 7929 3a0a 2020 2020 2020 2020 2020 2020  y):.            
-00010bb0: 7261 6973 6520 496e 6465 7845 7272 6f72  raise IndexError
-00010bc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00010bd0: 2020 2276 696e 6465 7820 646f 6573 206e    "vindex does n
-00010be0: 6f74 2073 7570 706f 7274 2069 6e64 6578  ot support index
-00010bf0: 696e 6720 7769 7468 2064 6173 6b20 6f62  ing with dask ob
-00010c00: 6a65 6374 732e 2043 616c 6c20 636f 6d70  jects. Call comp
-00010c10: 7574 6520 220a 2020 2020 2020 2020 2020  ute ".          
-00010c20: 2020 2020 2020 226f 6e20 7468 6520 696e        "on the in
-00010c30: 6465 7865 7220 6669 7273 7420 746f 2067  dexer first to g
-00010c40: 6574 2061 6e20 6576 616c 7572 6174 6564  et an evalurated
-00010c50: 2061 7272 6179 2e20 476f 743a 207b 7d22   array. Got: {}"
-00010c60: 2e66 6f72 6d61 7428 6b65 7929 0a20 2020  .format(key).   
-00010c70: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00010c80: 2020 2072 6574 7572 6e20 5f76 696e 6465     return _vinde
-00010c90: 7828 7365 6c66 2c20 2a6b 6579 290a 0a20  x(self, *key).. 
-00010ca0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00010cb0: 2064 6566 2076 696e 6465 7828 7365 6c66   def vindex(self
-00010cc0: 293a 0a20 2020 2020 2020 2022 2222 5665  ):.        """Ve
-00010cd0: 6374 6f72 697a 6564 2069 6e64 6578 696e  ctorized indexin
-00010ce0: 6720 7769 7468 2062 726f 6164 6361 7374  g with broadcast
-00010cf0: 696e 672e 0a0a 2020 2020 2020 2020 5468  ing...        Th
-00010d00: 6973 2069 7320 6571 7569 7661 6c65 6e74  is is equivalent
-00010d10: 2074 6f20 6e75 6d70 7927 7320 6164 7661   to numpy's adva
-00010d20: 6e63 6564 2069 6e64 6578 696e 672c 2075  nced indexing, u
-00010d30: 7369 6e67 2061 7272 6179 7320 7468 6174  sing arrays that
-00010d40: 2061 7265 0a20 2020 2020 2020 2062 726f   are.        bro
-00010d50: 6164 6361 7374 2061 6761 696e 7374 2065  adcast against e
-00010d60: 6163 6820 6f74 6865 722e 2054 6869 7320  ach other. This 
-00010d70: 616c 6c6f 7773 2066 6f72 2070 6f69 6e74  allows for point
-00010d80: 7769 7365 2069 6e64 6578 696e 673a 0a0a  wise indexing:..
-00010d90: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-00010da0: 7274 2064 6173 6b2e 6172 7261 7920 6173  rt dask.array as
-00010db0: 2064 610a 2020 2020 2020 2020 3e3e 3e20   da.        >>> 
-00010dc0: 7820 3d20 6e70 2e61 7272 6179 285b 5b31  x = np.array([[1
-00010dd0: 2c20 322c 2033 5d2c 205b 342c 2035 2c20  , 2, 3], [4, 5, 
-00010de0: 365d 2c20 5b37 2c20 382c 2039 5d5d 290a  6], [7, 8, 9]]).
-00010df0: 2020 2020 2020 2020 3e3e 3e20 7820 3d20          >>> x = 
-00010e00: 6461 2e66 726f 6d5f 6172 7261 7928 782c  da.from_array(x,
-00010e10: 2063 6875 6e6b 733d 3229 0a20 2020 2020   chunks=2).     
-00010e20: 2020 203e 3e3e 2078 2e76 696e 6465 785b     >>> x.vindex[
-00010e30: 5b30 2c20 312c 2032 5d2c 205b 302c 2031  [0, 1, 2], [0, 1
-00010e40: 2c20 325d 5d2e 636f 6d70 7574 6528 290a  , 2]].compute().
-00010e50: 2020 2020 2020 2020 6172 7261 7928 5b31          array([1
-00010e60: 2c20 352c 2039 5d29 0a0a 2020 2020 2020  , 5, 9])..      
-00010e70: 2020 4d69 7865 6420 6261 7369 632f 6164    Mixed basic/ad
-00010e80: 7661 6e63 6564 2069 6e64 6578 696e 6720  vanced indexing 
-00010e90: 7769 7468 2073 6c69 6365 732f 6172 7261  with slices/arra
-00010ea0: 7973 2069 7320 616c 736f 2073 7570 706f  ys is also suppo
-00010eb0: 7274 6564 2e20 5468 650a 2020 2020 2020  rted. The.      
-00010ec0: 2020 6f72 6465 7220 6f66 2064 696d 656e    order of dimen
-00010ed0: 7369 6f6e 7320 696e 2074 6865 2072 6573  sions in the res
-00010ee0: 756c 7420 666f 6c6c 6f77 7320 7468 6f73  ult follows thos
-00010ef0: 6520 7072 6f70 6f73 6564 2066 6f72 0a20  e proposed for. 
-00010f00: 2020 2020 2020 2060 6e64 6172 7261 792e         `ndarray.
-00010f10: 7669 6e64 6578 203c 6874 7470 733a 2f2f  vindex <https://
-00010f20: 6769 7468 7562 2e63 6f6d 2f6e 756d 7079  github.com/numpy
-00010f30: 2f6e 756d 7079 2f70 756c 6c2f 3632 3536  /numpy/pull/6256
-00010f40: 3e60 5f3a 0a20 2020 2020 2020 2074 6865  >`_:.        the
-00010f50: 2073 7562 7370 6163 6520 7370 616e 6e65   subspace spanne
-00010f60: 6420 6279 2061 7272 6179 7320 6973 2066  d by arrays is f
-00010f70: 6f6c 6c6f 7765 6420 6279 2061 6c6c 2073  ollowed by all s
-00010f80: 6c69 6365 732e 0a0a 2020 2020 2020 2020  lices...        
-00010f90: 4e6f 7465 3a20 6060 7669 6e64 6578 6060  Note: ``vindex``
-00010fa0: 2070 726f 7669 6465 7320 6d6f 7265 2067   provides more g
-00010fb0: 656e 6572 616c 2066 756e 6374 696f 6e61  eneral functiona
-00010fc0: 6c69 7479 2074 6861 6e20 7374 616e 6461  lity than standa
-00010fd0: 7264 0a20 2020 2020 2020 2069 6e64 6578  rd.        index
-00010fe0: 696e 672c 2062 7574 2069 7420 616c 736f  ing, but it also
-00010ff0: 2068 6173 2066 6577 6572 206f 7074 696d   has fewer optim
-00011000: 697a 6174 696f 6e73 2061 6e64 2063 616e  izations and can
-00011010: 2062 6520 7369 676e 6966 6963 616e 746c   be significantl
-00011020: 790a 2020 2020 2020 2020 736c 6f77 6572  y.        slower
-00011030: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00011040: 2020 2020 2020 7265 7475 726e 2049 6e64        return Ind
-00011050: 6578 4361 6c6c 6162 6c65 2873 656c 662e  exCallable(self.
-00011060: 5f76 696e 6465 7829 0a0a 2020 2020 4070  _vindex)..    @p
-00011070: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00011080: 626c 6f63 6b73 2873 656c 6629 3a0a 2020  blocks(self):.  
-00011090: 2020 2020 2020 2222 2241 6e20 6172 7261        """An arra
-000110a0: 792d 6c69 6b65 2069 6e74 6572 6661 6365  y-like interface
-000110b0: 2074 6f20 7468 6520 626c 6f63 6b73 206f   to the blocks o
-000110c0: 6620 616e 2061 7272 6179 2e0a 0a20 2020  f an array...   
-000110d0: 2020 2020 2054 6869 7320 7265 7475 726e       This return
-000110e0: 7320 6120 6060 426c 6f63 6b76 6965 7760  s a ``Blockview`
-000110f0: 6020 6f62 6a65 6374 2074 6861 7420 7072  ` object that pr
-00011100: 6f76 6964 6573 2061 6e20 6172 7261 792d  ovides an array-
-00011110: 6c69 6b65 2069 6e74 6572 6661 6365 0a20  like interface. 
-00011120: 2020 2020 2020 2074 6f20 7468 6520 626c         to the bl
-00011130: 6f63 6b73 206f 6620 6120 6461 736b 2061  ocks of a dask a
-00011140: 7272 6179 2e20 204e 756d 7079 2d73 7479  rray.  Numpy-sty
-00011150: 6c65 2069 6e64 6578 696e 6720 6f66 2061  le indexing of a
-00011160: 2060 6042 6c6f 636b 7669 6577 6060 206f   ``Blockview`` o
-00011170: 626a 6563 740a 2020 2020 2020 2020 7265  bject.        re
-00011180: 7475 726e 7320 6120 7365 6c65 6374 696f  turns a selectio
-00011190: 6e20 6f66 2062 6c6f 636b 7320 6173 2061  n of blocks as a
-000111a0: 206e 6577 2064 6173 6b20 6172 7261 792e   new dask array.
-000111b0: 0a0a 2020 2020 2020 2020 596f 7520 6361  ..        You ca
-000111c0: 6e20 696e 6465 7820 6060 6172 7261 792e  n index ``array.
-000111d0: 626c 6f63 6b73 6060 206c 696b 6520 6120  blocks`` like a 
-000111e0: 6e75 6d70 7920 6172 7261 7920 6f66 2073  numpy array of s
-000111f0: 6861 7065 0a20 2020 2020 2020 2065 7175  hape.        equ
-00011200: 616c 2074 6f20 7468 6520 6e75 6d62 6572  al to the number
-00011210: 206f 6620 626c 6f63 6b73 2069 6e20 6561   of blocks in ea
-00011220: 6368 2064 696d 656e 7369 6f6e 2c20 2861  ch dimension, (a
-00011230: 7661 696c 6162 6c65 2061 730a 2020 2020  vailable as.    
-00011240: 2020 2020 6172 7261 792e 626c 6f63 6b73      array.blocks
-00011250: 2e73 697a 6529 2e20 2054 6865 2064 696d  .size).  The dim
-00011260: 656e 7369 6f6e 616c 6974 7920 6f66 2074  ensionality of t
-00011270: 6865 206f 7574 7075 7420 6172 7261 7920  he output array 
-00011280: 6d61 7463 6865 730a 2020 2020 2020 2020  matches.        
-00011290: 7468 6520 6469 6d65 6e73 696f 6e20 6f66  the dimension of
-000112a0: 2074 6869 7320 6172 7261 792c 2065 7665   this array, eve
-000112b0: 6e20 6966 2069 6e74 6567 6572 2069 6e64  n if integer ind
-000112c0: 6963 6573 2061 7265 2070 6173 7365 642e  ices are passed.
-000112d0: 0a20 2020 2020 2020 2053 6c69 6369 6e67  .        Slicing
-000112e0: 2077 6974 6820 6060 6e70 2e6e 6577 6178   with ``np.newax
-000112f0: 6973 6060 206f 7220 6d75 6c74 6970 6c65  is`` or multiple
-00011300: 206c 6973 7473 2069 7320 6e6f 7420 7375   lists is not su
-00011310: 7070 6f72 7465 642e 0a0a 2020 2020 2020  pported...      
-00011320: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
-00011330: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00011340: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-00011350: 6173 6b2e 6172 7261 7920 6173 2064 610a  ask.array as da.
-00011360: 2020 2020 2020 2020 3e3e 3e20 7820 3d20          >>> x = 
-00011370: 6461 2e61 7261 6e67 6528 382c 2063 6875  da.arange(8, chu
-00011380: 6e6b 733d 3229 0a20 2020 2020 2020 203e  nks=2).        >
-00011390: 3e3e 2078 2e62 6c6f 636b 732e 7368 6170  >> x.blocks.shap
-000113a0: 6520 2320 616c 6961 7365 7320 782e 6e75  e # aliases x.nu
-000113b0: 6d62 6c6f 636b 730a 2020 2020 2020 2020  mblocks.        
-000113c0: 2834 2c29 0a20 2020 2020 2020 203e 3e3e  (4,).        >>>
-000113d0: 2078 2e62 6c6f 636b 735b 305d 2e63 6f6d   x.blocks[0].com
-000113e0: 7075 7465 2829 0a20 2020 2020 2020 2061  pute().        a
-000113f0: 7272 6179 285b 302c 2031 5d29 0a20 2020  rray([0, 1]).   
-00011400: 2020 2020 203e 3e3e 2078 2e62 6c6f 636b       >>> x.block
-00011410: 735b 3a33 5d2e 636f 6d70 7574 6528 290a  s[:3].compute().
-00011420: 2020 2020 2020 2020 6172 7261 7928 5b30          array([0
-00011430: 2c20 312c 2032 2c20 332c 2034 2c20 355d  , 1, 2, 3, 4, 5]
-00011440: 290a 2020 2020 2020 2020 3e3e 3e20 782e  ).        >>> x.
-00011450: 626c 6f63 6b73 5b3a 3a32 5d2e 636f 6d70  blocks[::2].comp
-00011460: 7574 6528 290a 2020 2020 2020 2020 6172  ute().        ar
-00011470: 7261 7928 5b30 2c20 312c 2034 2c20 355d  ray([0, 1, 4, 5]
-00011480: 290a 2020 2020 2020 2020 3e3e 3e20 782e  ).        >>> x.
-00011490: 626c 6f63 6b73 5b5b 2d31 2c20 305d 5d2e  blocks[[-1, 0]].
-000114a0: 636f 6d70 7574 6528 290a 2020 2020 2020  compute().      
-000114b0: 2020 6172 7261 7928 5b36 2c20 372c 2030    array([6, 7, 0
-000114c0: 2c20 315d 290a 2020 2020 2020 2020 3e3e  , 1]).        >>
-000114d0: 3e20 782e 626c 6f63 6b73 2e72 6176 656c  > x.blocks.ravel
-000114e0: 2829 2023 2064 6f63 7465 7374 3a20 2b4e  () # doctest: +N
-000114f0: 4f52 4d41 4c49 5a45 5f57 4849 5445 5350  ORMALIZE_WHITESP
-00011500: 4143 450a 2020 2020 2020 2020 5b64 6173  ACE.        [das
-00011510: 6b2e 6172 7261 793c 626c 6f63 6b73 2c20  k.array<blocks, 
-00011520: 7368 6170 653d 2832 2c29 2c20 6474 7970  shape=(2,), dtyp
-00011530: 653d 696e 7436 342c 2063 6875 6e6b 7369  e=int64, chunksi
-00011540: 7a65 3d28 322c 292c 2063 6875 6e6b 7479  ze=(2,), chunkty
-00011550: 7065 3d6e 756d 7079 2e6e 6461 7272 6179  pe=numpy.ndarray
-00011560: 3e2c 0a20 2020 2020 2020 2020 6461 736b  >,.         dask
-00011570: 2e61 7272 6179 3c62 6c6f 636b 732c 2073  .array<blocks, s
-00011580: 6861 7065 3d28 322c 292c 2064 7479 7065  hape=(2,), dtype
-00011590: 3d69 6e74 3634 2c20 6368 756e 6b73 697a  =int64, chunksiz
-000115a0: 653d 2832 2c29 2c20 6368 756e 6b74 7970  e=(2,), chunktyp
-000115b0: 653d 6e75 6d70 792e 6e64 6172 7261 793e  e=numpy.ndarray>
-000115c0: 2c0a 2020 2020 2020 2020 2064 6173 6b2e  ,.         dask.
-000115d0: 6172 7261 793c 626c 6f63 6b73 2c20 7368  array<blocks, sh
-000115e0: 6170 653d 2832 2c29 2c20 6474 7970 653d  ape=(2,), dtype=
-000115f0: 696e 7436 342c 2063 6875 6e6b 7369 7a65  int64, chunksize
-00011600: 3d28 322c 292c 2063 6875 6e6b 7479 7065  =(2,), chunktype
-00011610: 3d6e 756d 7079 2e6e 6461 7272 6179 3e2c  =numpy.ndarray>,
-00011620: 0a20 2020 2020 2020 2020 6461 736b 2e61  .         dask.a
-00011630: 7272 6179 3c62 6c6f 636b 732c 2073 6861  rray<blocks, sha
-00011640: 7065 3d28 322c 292c 2064 7479 7065 3d69  pe=(2,), dtype=i
-00011650: 6e74 3634 2c20 6368 756e 6b73 697a 653d  nt64, chunksize=
-00011660: 2832 2c29 2c20 6368 756e 6b74 7970 653d  (2,), chunktype=
-00011670: 6e75 6d70 792e 6e64 6172 7261 793e 5d0a  numpy.ndarray>].
-00011680: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00011690: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000116a0: 0a20 2020 2020 2020 2041 6e20 696e 7374  .        An inst
-000116b0: 616e 6365 206f 6620 6060 6461 736b 2e61  ance of ``dask.a
-000116c0: 7272 6179 2e42 6c6f 636b 7669 6577 6060  rray.Blockview``
-000116d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000116e0: 2020 2020 2072 6574 7572 6e20 426c 6f63       return Bloc
-000116f0: 6b56 6965 7728 7365 6c66 290a 0a20 2020  kView(self)..   
-00011700: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00011710: 6566 2070 6172 7469 7469 6f6e 7328 7365  ef partitions(se
-00011720: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00011730: 536c 6963 6520 616e 2061 7272 6179 2062  Slice an array b
-00011740: 7920 7061 7274 6974 696f 6e73 2e20 416c  y partitions. Al
-00011750: 6961 7320 6f66 2064 6173 6b20 6172 7261  ias of dask arra
-00011760: 7920 2e62 6c6f 636b 7320 6174 7472 6962  y .blocks attrib
-00011770: 7574 652e 0a0a 2020 2020 2020 2020 5468  ute...        Th
-00011780: 6973 2061 6c69 6173 2061 6c6c 6f77 7320  is alias allows 
-00011790: 796f 7520 746f 2077 7269 7465 2061 676e  you to write agn
-000117a0: 6f73 7469 6320 636f 6465 2074 6861 7420  ostic code that 
-000117b0: 776f 726b 7320 7769 7468 2062 6f74 680a  works with both.
-000117c0: 2020 2020 2020 2020 6461 736b 2061 7272          dask arr
-000117d0: 6179 7320 616e 6420 6461 736b 2064 6174  ays and dask dat
-000117e0: 6166 7261 6d65 732e 0a0a 2020 2020 2020  aframes...      
-000117f0: 2020 5468 6973 2072 6574 7572 6e73 2061    This returns a
-00011800: 2060 6042 6c6f 636b 7669 6577 6060 206f   ``Blockview`` o
-00011810: 626a 6563 7420 7468 6174 2070 726f 7669  bject that provi
-00011820: 6465 7320 616e 2061 7272 6179 2d6c 696b  des an array-lik
-00011830: 6520 696e 7465 7266 6163 650a 2020 2020  e interface.    
-00011840: 2020 2020 746f 2074 6865 2062 6c6f 636b      to the block
-00011850: 7320 6f66 2061 2064 6173 6b20 6172 7261  s of a dask arra
-00011860: 792e 2020 4e75 6d70 792d 7374 796c 6520  y.  Numpy-style 
-00011870: 696e 6465 7869 6e67 206f 6620 6120 6060  indexing of a ``
-00011880: 426c 6f63 6b76 6965 7760 6020 6f62 6a65  Blockview`` obje
-00011890: 6374 0a20 2020 2020 2020 2072 6574 7572  ct.        retur
-000118a0: 6e73 2061 2073 656c 6563 7469 6f6e 206f  ns a selection o
-000118b0: 6620 626c 6f63 6b73 2061 7320 6120 6e65  f blocks as a ne
-000118c0: 7720 6461 736b 2061 7272 6179 2e0a 0a20  w dask array... 
-000118d0: 2020 2020 2020 2059 6f75 2063 616e 2069         You can i
-000118e0: 6e64 6578 2060 6061 7272 6179 2e62 6c6f  ndex ``array.blo
-000118f0: 636b 7360 6020 6c69 6b65 2061 206e 756d  cks`` like a num
-00011900: 7079 2061 7272 6179 206f 6620 7368 6170  py array of shap
-00011910: 650a 2020 2020 2020 2020 6571 7561 6c20  e.        equal 
-00011920: 746f 2074 6865 206e 756d 6265 7220 6f66  to the number of
-00011930: 2062 6c6f 636b 7320 696e 2065 6163 6820   blocks in each 
-00011940: 6469 6d65 6e73 696f 6e2c 2028 6176 6169  dimension, (avai
-00011950: 6c61 626c 6520 6173 0a20 2020 2020 2020  lable as.       
-00011960: 2061 7272 6179 2e62 6c6f 636b 732e 7369   array.blocks.si
-00011970: 7a65 292e 2020 5468 6520 6469 6d65 6e73  ze).  The dimens
-00011980: 696f 6e61 6c69 7479 206f 6620 7468 6520  ionality of the 
-00011990: 6f75 7470 7574 2061 7272 6179 206d 6174  output array mat
-000119a0: 6368 6573 0a20 2020 2020 2020 2074 6865  ches.        the
-000119b0: 2064 696d 656e 7369 6f6e 206f 6620 7468   dimension of th
-000119c0: 6973 2061 7272 6179 2c20 6576 656e 2069  is array, even i
-000119d0: 6620 696e 7465 6765 7220 696e 6469 6365  f integer indice
-000119e0: 7320 6172 6520 7061 7373 6564 2e0a 2020  s are passed..  
-000119f0: 2020 2020 2020 536c 6963 696e 6720 7769        Slicing wi
-00011a00: 7468 2060 606e 702e 6e65 7761 7869 7360  th ``np.newaxis`
-00011a10: 6020 6f72 206d 756c 7469 706c 6520 6c69  ` or multiple li
-00011a20: 7374 7320 6973 206e 6f74 2073 7570 706f  sts is not suppo
-00011a30: 7274 6564 2e0a 0a20 2020 2020 2020 2045  rted...        E
-00011a40: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-00011a50: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00011a60: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
-00011a70: 2e61 7272 6179 2061 7320 6461 0a20 2020  .array as da.   
-00011a80: 2020 2020 203e 3e3e 2078 203d 2064 612e       >>> x = da.
-00011a90: 6172 616e 6765 2838 2c20 6368 756e 6b73  arange(8, chunks
-00011aa0: 3d32 290a 2020 2020 2020 2020 3e3e 3e20  =2).        >>> 
-00011ab0: 782e 7061 7274 6974 696f 6e73 2e73 6861  x.partitions.sha
-00011ac0: 7065 2023 2061 6c69 6173 6573 2078 2e6e  pe # aliases x.n
-00011ad0: 756d 626c 6f63 6b73 0a20 2020 2020 2020  umblocks.       
-00011ae0: 2028 342c 290a 2020 2020 2020 2020 3e3e   (4,).        >>
-00011af0: 3e20 782e 7061 7274 6974 696f 6e73 5b30  > x.partitions[0
-00011b00: 5d2e 636f 6d70 7574 6528 290a 2020 2020  ].compute().    
-00011b10: 2020 2020 6172 7261 7928 5b30 2c20 315d      array([0, 1]
-00011b20: 290a 2020 2020 2020 2020 3e3e 3e20 782e  ).        >>> x.
-00011b30: 7061 7274 6974 696f 6e73 5b3a 335d 2e63  partitions[:3].c
-00011b40: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
-00011b50: 2061 7272 6179 285b 302c 2031 2c20 322c   array([0, 1, 2,
-00011b60: 2033 2c20 342c 2035 5d29 0a20 2020 2020   3, 4, 5]).     
-00011b70: 2020 203e 3e3e 2078 2e70 6172 7469 7469     >>> x.partiti
-00011b80: 6f6e 735b 3a3a 325d 2e63 6f6d 7075 7465  ons[::2].compute
-00011b90: 2829 0a20 2020 2020 2020 2061 7272 6179  ().        array
-00011ba0: 285b 302c 2031 2c20 342c 2035 5d29 0a20  ([0, 1, 4, 5]). 
-00011bb0: 2020 2020 2020 203e 3e3e 2078 2e70 6172         >>> x.par
-00011bc0: 7469 7469 6f6e 735b 5b2d 312c 2030 5d5d  titions[[-1, 0]]
-00011bd0: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-00011be0: 2020 2061 7272 6179 285b 362c 2037 2c20     array([6, 7, 
-00011bf0: 302c 2031 5d29 0a20 2020 2020 2020 203e  0, 1]).        >
-00011c00: 3e3e 2078 2e70 6172 7469 7469 6f6e 732e  >> x.partitions.
-00011c10: 7261 7665 6c28 2920 2320 646f 6374 6573  ravel() # doctes
-00011c20: 743a 202b 4e4f 524d 414c 495a 455f 5748  t: +NORMALIZE_WH
-00011c30: 4954 4553 5041 4345 0a20 2020 2020 2020  ITESPACE.       
-00011c40: 205b 6461 736b 2e61 7272 6179 3c62 6c6f   [dask.array<blo
-00011c50: 636b 732c 2073 6861 7065 3d28 322c 292c  cks, shape=(2,),
-00011c60: 2064 7479 7065 3d69 6e74 3634 2c20 6368   dtype=int64, ch
-00011c70: 756e 6b73 697a 653d 2832 2c29 2c20 6368  unksize=(2,), ch
-00011c80: 756e 6b74 7970 653d 6e75 6d70 792e 6e64  unktype=numpy.nd
-00011c90: 6172 7261 793e 2c0a 2020 2020 2020 2020  array>,.        
-00011ca0: 2064 6173 6b2e 6172 7261 793c 626c 6f63   dask.array<bloc
-00011cb0: 6b73 2c20 7368 6170 653d 2832 2c29 2c20  ks, shape=(2,), 
-00011cc0: 6474 7970 653d 696e 7436 342c 2063 6875  dtype=int64, chu
-00011cd0: 6e6b 7369 7a65 3d28 322c 292c 2063 6875  nksize=(2,), chu
-00011ce0: 6e6b 7479 7065 3d6e 756d 7079 2e6e 6461  nktype=numpy.nda
-00011cf0: 7272 6179 3e2c 0a20 2020 2020 2020 2020  rray>,.         
-00011d00: 6461 736b 2e61 7272 6179 3c62 6c6f 636b  dask.array<block
-00011d10: 732c 2073 6861 7065 3d28 322c 292c 2064  s, shape=(2,), d
-00011d20: 7479 7065 3d69 6e74 3634 2c20 6368 756e  type=int64, chun
-00011d30: 6b73 697a 653d 2832 2c29 2c20 6368 756e  ksize=(2,), chun
-00011d40: 6b74 7970 653d 6e75 6d70 792e 6e64 6172  ktype=numpy.ndar
-00011d50: 7261 793e 2c0a 2020 2020 2020 2020 2064  ray>,.         d
-00011d60: 6173 6b2e 6172 7261 793c 626c 6f63 6b73  ask.array<blocks
-00011d70: 2c20 7368 6170 653d 2832 2c29 2c20 6474  , shape=(2,), dt
-00011d80: 7970 653d 696e 7436 342c 2063 6875 6e6b  ype=int64, chunk
-00011d90: 7369 7a65 3d28 322c 292c 2063 6875 6e6b  size=(2,), chunk
-00011da0: 7479 7065 3d6e 756d 7079 2e6e 6461 7272  type=numpy.ndarr
-00011db0: 6179 3e5d 0a0a 2020 2020 2020 2020 5265  ay>]..        Re
-00011dc0: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-00011dd0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 416e  -----.        An
-00011de0: 2069 6e73 7461 6e63 6520 6f66 2060 6064   instance of ``d
-00011df0: 612e 6172 7261 792e 426c 6f63 6b76 6965  a.array.Blockvie
-00011e00: 7760 600a 2020 2020 2020 2020 2222 220a  w``.        """.
-00011e10: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00011e20: 656c 662e 626c 6f63 6b73 0a0a 2020 2020  elf.blocks..    
-00011e30: 6465 6620 646f 7428 7365 6c66 2c20 6f74  def dot(self, ot
-00011e40: 6865 7229 3a0a 2020 2020 2020 2020 2222  her):.        ""
-00011e50: 2244 6f74 2070 726f 6475 6374 206f 6620  "Dot product of 
-00011e60: 7365 6c66 2061 6e64 206f 7468 6572 2e0a  self and other..
-00011e70: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
-00011e80: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
-00011e90: 7261 792e 7465 6e73 6f72 646f 7460 2066  ray.tensordot` f
-00011ea0: 6f72 2066 756c 6c20 646f 6375 6d65 6e74  or full document
-00011eb0: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00011ec0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-00011ed0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00011ee0: 2020 6461 736b 2e61 7272 6179 2e64 6f74    dask.array.dot
-00011ef0: 203a 2065 7175 6976 616c 656e 7420 6675   : equivalent fu
-00011f00: 6e63 7469 6f6e 0a20 2020 2020 2020 2022  nction.        "
-00011f10: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-00011f20: 6461 736b 2e61 7272 6179 2e72 6f75 7469  dask.array.routi
-00011f30: 6e65 7320 696d 706f 7274 2074 656e 736f  nes import tenso
-00011f40: 7264 6f74 0a0a 2020 2020 2020 2020 7265  rdot..        re
-00011f50: 7475 726e 2074 656e 736f 7264 6f74 2873  turn tensordot(s
-00011f60: 656c 662c 206f 7468 6572 2c20 6178 6573  elf, other, axes
-00011f70: 3d28 2873 656c 662e 6e64 696d 202d 2031  =((self.ndim - 1
-00011f80: 2c29 2c20 286f 7468 6572 2e6e 6469 6d20  ,), (other.ndim 
-00011f90: 2d20 322c 2929 290a 0a20 2020 2040 7072  - 2,)))..    @pr
-00011fa0: 6f70 6572 7479 0a20 2020 2064 6566 2041  operty.    def A
-00011fb0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00011fc0: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
-00011fd0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00011fe0: 6566 2054 2873 656c 6629 3a0a 2020 2020  ef T(self):.    
-00011ff0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00012000: 7472 616e 7370 6f73 6528 290a 0a20 2020  transpose()..   
-00012010: 2064 6566 2074 7261 6e73 706f 7365 2873   def transpose(s
-00012020: 656c 662c 202a 6178 6573 293a 0a20 2020  elf, *axes):.   
-00012030: 2020 2020 2022 2222 5265 7665 7273 6520       """Reverse 
-00012040: 6f72 2070 6572 6d75 7465 2074 6865 2061  or permute the a
-00012050: 7865 7320 6f66 2061 6e20 6172 7261 792e  xes of an array.
-00012060: 2052 6574 7572 6e20 7468 6520 6d6f 6469   Return the modi
-00012070: 6669 6564 2061 7272 6179 2e0a 0a20 2020  fied array...   
-00012080: 2020 2020 2052 6566 6572 2074 6f20 3a66       Refer to :f
-00012090: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
-000120a0: 7472 616e 7370 6f73 6560 2066 6f72 2066  transpose` for f
-000120b0: 756c 6c20 646f 6375 6d65 6e74 6174 696f  ull documentatio
-000120c0: 6e2e 0a0a 2020 2020 2020 2020 5365 6520  n...        See 
-000120d0: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
-000120e0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
-000120f0: 736b 2e61 7272 6179 2e74 7261 6e73 706f  sk.array.transpo
-00012100: 7365 203a 2065 7175 6976 616c 656e 7420  se : equivalent 
-00012110: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
-00012120: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-00012130: 6d20 6461 736b 2e61 7272 6179 2e72 6f75  m dask.array.rou
-00012140: 7469 6e65 7320 696d 706f 7274 2074 7261  tines import tra
-00012150: 6e73 706f 7365 0a0a 2020 2020 2020 2020  nspose..        
-00012160: 6966 206e 6f74 2061 7865 733a 0a20 2020  if not axes:.   
-00012170: 2020 2020 2020 2020 2061 7865 7320 3d20           axes = 
-00012180: 4e6f 6e65 0a20 2020 2020 2020 2065 6c69  None.        eli
-00012190: 6620 6c65 6e28 6178 6573 2920 3d3d 2031  f len(axes) == 1
-000121a0: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
-000121b0: 6178 6573 5b30 5d2c 2049 7465 7261 626c  axes[0], Iterabl
-000121c0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-000121d0: 6178 6573 203d 2061 7865 735b 305d 0a20  axes = axes[0]. 
-000121e0: 2020 2020 2020 2069 6620 2861 7865 7320         if (axes 
-000121f0: 3d3d 2074 7570 6c65 2872 616e 6765 2873  == tuple(range(s
-00012200: 656c 662e 6e64 696d 2929 2920 6f72 2028  elf.ndim))) or (
-00012210: 6178 6573 203d 3d20 7475 706c 6528 7261  axes == tuple(ra
-00012220: 6e67 6528 2d73 656c 662e 6e64 696d 2c20  nge(-self.ndim, 
-00012230: 3029 2929 3a0a 2020 2020 2020 2020 2020  0))):.          
-00012240: 2020 2320 6e6f 2074 7261 6e73 706f 7365    # no transpose
-00012250: 206e 6563 6573 7361 7279 0a20 2020 2020   necessary.     
-00012260: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00012270: 6c66 0a20 2020 2020 2020 2065 6c73 653a  lf.        else:
-00012280: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00012290: 7572 6e20 7472 616e 7370 6f73 6528 7365  urn transpose(se
-000122a0: 6c66 2c20 6178 6573 3d61 7865 7329 0a0a  lf, axes=axes)..
-000122b0: 2020 2020 6465 6620 7261 7665 6c28 7365      def ravel(se
-000122c0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000122d0: 5265 7475 726e 2061 2066 6c61 7474 656e  Return a flatten
-000122e0: 6564 2061 7272 6179 2e0a 0a20 2020 2020  ed array...     
-000122f0: 2020 2052 6566 6572 2074 6f20 3a66 756e     Refer to :fun
-00012300: 633a 6064 6173 6b2e 6172 7261 792e 7261  c:`dask.array.ra
-00012310: 7665 6c60 2066 6f72 2066 756c 6c20 646f  vel` for full do
-00012320: 6375 6d65 6e74 6174 696f 6e2e 0a0a 2020  cumentation...  
-00012330: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
-00012340: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00012350: 2020 2020 2020 2020 6461 736b 2e61 7272          dask.arr
-00012360: 6179 2e72 6176 656c 203a 2065 7175 6976  ay.ravel : equiv
-00012370: 616c 656e 7420 6675 6e63 7469 6f6e 0a20  alent function. 
-00012380: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00012390: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
-000123a0: 6179 2e72 6f75 7469 6e65 7320 696d 706f  ay.routines impo
-000123b0: 7274 2072 6176 656c 0a0a 2020 2020 2020  rt ravel..      
-000123c0: 2020 7265 7475 726e 2072 6176 656c 2873    return ravel(s
-000123d0: 656c 6629 0a0a 2020 2020 666c 6174 7465  elf)..    flatte
-000123e0: 6e20 3d20 7261 7665 6c0a 0a20 2020 2064  n = ravel..    d
-000123f0: 6566 2063 686f 6f73 6528 7365 6c66 2c20  ef choose(self, 
-00012400: 6368 6f69 6365 7329 3a0a 2020 2020 2020  choices):.      
-00012410: 2020 2222 2255 7365 2061 6e20 696e 6465    """Use an inde
-00012420: 7820 6172 7261 7920 746f 2063 6f6e 7374  x array to const
-00012430: 7275 6374 2061 206e 6577 2061 7272 6179  ruct a new array
-00012440: 2066 726f 6d20 6120 7365 7420 6f66 2063   from a set of c
-00012450: 686f 6963 6573 2e0a 0a20 2020 2020 2020  hoices...       
-00012460: 2052 6566 6572 2074 6f20 3a66 756e 633a   Refer to :func:
-00012470: 6064 6173 6b2e 6172 7261 792e 6368 6f6f  `dask.array.choo
-00012480: 7365 6020 666f 7220 6675 6c6c 2064 6f63  se` for full doc
-00012490: 756d 656e 7461 7469 6f6e 2e0a 0a20 2020  umentation...   
-000124a0: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-000124b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-000124c0: 2020 2020 2020 2064 6173 6b2e 6172 7261         dask.arra
-000124d0: 792e 6368 6f6f 7365 203a 2065 7175 6976  y.choose : equiv
-000124e0: 616c 656e 7420 6675 6e63 7469 6f6e 0a20  alent function. 
-000124f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00012500: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
-00012510: 6179 2e72 6f75 7469 6e65 7320 696d 706f  ay.routines impo
-00012520: 7274 2063 686f 6f73 650a 0a20 2020 2020  rt choose..     
-00012530: 2020 2072 6574 7572 6e20 6368 6f6f 7365     return choose
-00012540: 2873 656c 662c 2063 686f 6963 6573 290a  (self, choices).
-00012550: 0a20 2020 2064 6566 2072 6573 6861 7065  .    def reshape
-00012560: 2873 656c 662c 202a 7368 6170 652c 206d  (self, *shape, m
-00012570: 6572 6765 5f63 6875 6e6b 733d 5472 7565  erge_chunks=True
-00012580: 2c20 6c69 6d69 743d 4e6f 6e65 293a 0a20  , limit=None):. 
-00012590: 2020 2020 2020 2022 2222 5265 7368 6170         """Reshap
-000125a0: 6520 6172 7261 7920 746f 206e 6577 2073  e array to new s
-000125b0: 6861 7065 0a0a 2020 2020 2020 2020 5265  hape..        Re
-000125c0: 6665 7220 746f 203a 6675 6e63 3a60 6461  fer to :func:`da
-000125d0: 736b 2e61 7272 6179 2e72 6573 6861 7065  sk.array.reshape
-000125e0: 6020 666f 7220 6675 6c6c 2064 6f63 756d  ` for full docum
-000125f0: 656e 7461 7469 6f6e 2e0a 0a20 2020 2020  entation...     
-00012600: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-00012610: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00012620: 2020 2020 2064 6173 6b2e 6172 7261 792e       dask.array.
-00012630: 7265 7368 6170 6520 3a20 6571 7569 7661  reshape : equiva
-00012640: 6c65 6e74 2066 756e 6374 696f 6e0a 2020  lent function.  
-00012650: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00012660: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-00012670: 792e 7265 7368 6170 6520 696d 706f 7274  y.reshape import
-00012680: 2072 6573 6861 7065 0a0a 2020 2020 2020   reshape..      
-00012690: 2020 6966 206c 656e 2873 6861 7065 2920    if len(shape) 
-000126a0: 3d3d 2031 2061 6e64 206e 6f74 2069 7369  == 1 and not isi
-000126b0: 6e73 7461 6e63 6528 7368 6170 655b 305d  nstance(shape[0]
-000126c0: 2c20 4e75 6d62 6572 293a 0a20 2020 2020  , Number):.     
-000126d0: 2020 2020 2020 2073 6861 7065 203d 2073         shape = s
-000126e0: 6861 7065 5b30 5d0a 2020 2020 2020 2020  hape[0].        
-000126f0: 7265 7475 726e 2072 6573 6861 7065 2873  return reshape(s
-00012700: 656c 662c 2073 6861 7065 2c20 6d65 7267  elf, shape, merg
-00012710: 655f 6368 756e 6b73 3d6d 6572 6765 5f63  e_chunks=merge_c
-00012720: 6875 6e6b 732c 206c 696d 6974 3d6c 696d  hunks, limit=lim
-00012730: 6974 290a 0a20 2020 2064 6566 2074 6f70  it)..    def top
-00012740: 6b28 7365 6c66 2c20 6b2c 2061 7869 733d  k(self, k, axis=
-00012750: 2d31 2c20 7370 6c69 745f 6576 6572 793d  -1, split_every=
-00012760: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-00012770: 2222 5468 6520 746f 7020 6b20 656c 656d  ""The top k elem
-00012780: 656e 7473 206f 6620 616e 2061 7272 6179  ents of an array
-00012790: 2e0a 0a20 2020 2020 2020 2052 6566 6572  ...        Refer
-000127a0: 2074 6f20 3a66 756e 633a 6064 6173 6b2e   to :func:`dask.
-000127b0: 6172 7261 792e 746f 706b 6020 666f 7220  array.topk` for 
-000127c0: 6675 6c6c 2064 6f63 756d 656e 7461 7469  full documentati
-000127d0: 6f6e 2e0a 0a20 2020 2020 2020 2053 6565  on...        See
-000127e0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-000127f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
-00012800: 6173 6b2e 6172 7261 792e 746f 706b 203a  ask.array.topk :
-00012810: 2065 7175 6976 616c 656e 7420 6675 6e63   equivalent func
-00012820: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
-00012830: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-00012840: 736b 2e61 7272 6179 2e72 6564 7563 7469  sk.array.reducti
-00012850: 6f6e 7320 696d 706f 7274 2074 6f70 6b0a  ons import topk.
-00012860: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00012870: 746f 706b 2873 656c 662c 206b 2c20 6178  topk(self, k, ax
-00012880: 6973 3d61 7869 732c 2073 706c 6974 5f65  is=axis, split_e
-00012890: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-000128a0: 290a 0a20 2020 2064 6566 2061 7267 746f  )..    def argto
-000128b0: 706b 2873 656c 662c 206b 2c20 6178 6973  pk(self, k, axis
-000128c0: 3d2d 312c 2073 706c 6974 5f65 7665 7279  =-1, split_every
-000128d0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-000128e0: 2222 2254 6865 2069 6e64 6963 6573 206f  """The indices o
-000128f0: 6620 7468 6520 746f 7020 6b20 656c 656d  f the top k elem
-00012900: 656e 7473 206f 6620 616e 2061 7272 6179  ents of an array
-00012910: 2e0a 0a20 2020 2020 2020 2052 6566 6572  ...        Refer
-00012920: 2074 6f20 3a66 756e 633a 6064 6173 6b2e   to :func:`dask.
-00012930: 6172 7261 792e 6172 6774 6f70 6b60 2066  array.argtopk` f
-00012940: 6f72 2066 756c 6c20 646f 6375 6d65 6e74  or full document
-00012950: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00012960: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-00012970: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00012980: 2020 6461 736b 2e61 7272 6179 2e61 7267    dask.array.arg
-00012990: 746f 706b 203a 2065 7175 6976 616c 656e  topk : equivalen
-000129a0: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
-000129b0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-000129c0: 726f 6d20 6461 736b 2e61 7272 6179 2e72  rom dask.array.r
-000129d0: 6564 7563 7469 6f6e 7320 696d 706f 7274  eductions import
-000129e0: 2061 7267 746f 706b 0a0a 2020 2020 2020   argtopk..      
-000129f0: 2020 7265 7475 726e 2061 7267 746f 706b    return argtopk
-00012a00: 2873 656c 662c 206b 2c20 6178 6973 3d61  (self, k, axis=a
-00012a10: 7869 732c 2073 706c 6974 5f65 7665 7279  xis, split_every
-00012a20: 3d73 706c 6974 5f65 7665 7279 290a 0a20  =split_every).. 
-00012a30: 2020 2064 6566 2061 7374 7970 6528 7365     def astype(se
-00012a40: 6c66 2c20 6474 7970 652c 202a 2a6b 7761  lf, dtype, **kwa
-00012a50: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
-00012a60: 2243 6f70 7920 6f66 2074 6865 2061 7272  "Copy of the arr
-00012a70: 6179 2c20 6361 7374 2074 6f20 6120 7370  ay, cast to a sp
-00012a80: 6563 6966 6965 6420 7479 7065 2e0a 0a20  ecified type... 
-00012a90: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00012aa0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00012ab0: 2d2d 2d2d 0a20 2020 2020 2020 2064 7479  ----.        dty
-00012ac0: 7065 203a 2073 7472 206f 7220 6474 7970  pe : str or dtyp
-00012ad0: 650a 2020 2020 2020 2020 2020 2020 5479  e.            Ty
-00012ae0: 7065 636f 6465 206f 7220 6461 7461 2d74  pecode or data-t
-00012af0: 7970 6520 746f 2077 6869 6368 2074 6865  ype to which the
-00012b00: 2061 7272 6179 2069 7320 6361 7374 2e0a   array is cast..
-00012b10: 2020 2020 2020 2020 6361 7374 696e 6720          casting 
-00012b20: 3a20 7b27 6e6f 272c 2027 6571 7569 7627  : {'no', 'equiv'
-00012b30: 2c20 2773 6166 6527 2c20 2773 616d 655f  , 'safe', 'same_
-00012b40: 6b69 6e64 272c 2027 756e 7361 6665 277d  kind', 'unsafe'}
-00012b50: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00012b60: 2020 2020 2020 2043 6f6e 7472 6f6c 7320         Controls 
-00012b70: 7768 6174 206b 696e 6420 6f66 2064 6174  what kind of dat
-00012b80: 6120 6361 7374 696e 6720 6d61 7920 6f63  a casting may oc
-00012b90: 6375 722e 2044 6566 6175 6c74 7320 746f  cur. Defaults to
-00012ba0: 2027 756e 7361 6665 270a 2020 2020 2020   'unsafe'.      
-00012bb0: 2020 2020 2020 666f 7220 6261 636b 7761        for backwa
-00012bc0: 7264 7320 636f 6d70 6174 6962 696c 6974  rds compatibilit
-00012bd0: 792e 0a0a 2020 2020 2020 2020 2020 2020  y...            
-00012be0: 2a20 276e 6f27 206d 6561 6e73 2074 6865  * 'no' means the
-00012bf0: 2064 6174 6120 7479 7065 7320 7368 6f75   data types shou
-00012c00: 6c64 206e 6f74 2062 6520 6361 7374 2061  ld not be cast a
-00012c10: 7420 616c 6c2e 0a20 2020 2020 2020 2020  t all..         
-00012c20: 2020 202a 2027 6571 7569 7627 206d 6561     * 'equiv' mea
-00012c30: 6e73 206f 6e6c 7920 6279 7465 2d6f 7264  ns only byte-ord
-00012c40: 6572 2063 6861 6e67 6573 2061 7265 2061  er changes are a
-00012c50: 6c6c 6f77 6564 2e0a 2020 2020 2020 2020  llowed..        
-00012c60: 2020 2020 2a20 2773 6166 6527 206d 6561      * 'safe' mea
-00012c70: 6e73 206f 6e6c 7920 6361 7374 7320 7768  ns only casts wh
-00012c80: 6963 6820 6361 6e20 7072 6573 6572 7665  ich can preserve
-00012c90: 2076 616c 7565 7320 6172 6520 616c 6c6f   values are allo
-00012ca0: 7765 642e 0a20 2020 2020 2020 2020 2020  wed..           
-00012cb0: 202a 2027 7361 6d65 5f6b 696e 6427 206d   * 'same_kind' m
-00012cc0: 6561 6e73 206f 6e6c 7920 7361 6665 2063  eans only safe c
-00012cd0: 6173 7473 206f 7220 6361 7374 7320 7769  asts or casts wi
-00012ce0: 7468 696e 2061 206b 696e 642c 0a20 2020  thin a kind,.   
-00012cf0: 2020 2020 2020 2020 2020 2020 206c 696b               lik
-00012d00: 6520 666c 6f61 7436 3420 746f 2066 6c6f  e float64 to flo
-00012d10: 6174 3332 2c20 6172 6520 616c 6c6f 7765  at32, are allowe
-00012d20: 642e 0a20 2020 2020 2020 2020 2020 202a  d..            *
-00012d30: 2027 756e 7361 6665 2720 6d65 616e 7320   'unsafe' means 
-00012d40: 616e 7920 6461 7461 2063 6f6e 7665 7273  any data convers
-00012d50: 696f 6e73 206d 6179 2062 6520 646f 6e65  ions may be done
-00012d60: 2e0a 2020 2020 2020 2020 636f 7079 203a  ..        copy :
-00012d70: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
-00012d80: 2020 2020 2020 2020 2020 2020 4279 2064              By d
-00012d90: 6566 6175 6c74 2c20 6173 7479 7065 2061  efault, astype a
-00012da0: 6c77 6179 7320 7265 7475 726e 7320 6120  lways returns a 
-00012db0: 6e65 776c 7920 616c 6c6f 6361 7465 6420  newly allocated 
-00012dc0: 6172 7261 792e 2049 6620 7468 6973 0a20  array. If this. 
-00012dd0: 2020 2020 2020 2020 2020 2069 7320 7365             is se
-00012de0: 7420 746f 2046 616c 7365 2061 6e64 2074  t to False and t
-00012df0: 6865 2060 6474 7970 6560 2072 6571 7569  he `dtype` requi
-00012e00: 7265 6d65 6e74 2069 7320 7361 7469 7366  rement is satisf
-00012e10: 6965 642c 2074 6865 2069 6e70 7574 0a20  ied, the input. 
-00012e20: 2020 2020 2020 2020 2020 2061 7272 6179             array
-00012e30: 2069 7320 7265 7475 726e 6564 2069 6e73   is returned ins
-00012e40: 7465 6164 206f 6620 6120 636f 7079 2e0a  tead of a copy..
-00012e50: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
-00012e60: 6e6f 7465 3a3a 0a0a 2020 2020 2020 2020  note::..        
-00012e70: 2020 2020 2020 2020 4461 736b 2064 6f65          Dask doe
-00012e80: 7320 6e6f 7420 7265 7370 6563 7420 7468  s not respect th
-00012e90: 6520 636f 6e74 6967 756f 7573 206d 656d  e contiguous mem
-00012ea0: 6f72 7920 6c61 796f 7574 206f 6620 7468  ory layout of th
-00012eb0: 6520 6172 7261 792c 0a20 2020 2020 2020  e array,.       
-00012ec0: 2020 2020 2020 2020 2061 6e64 2077 696c           and wil
-00012ed0: 6c20 6967 6e6f 7265 2074 6865 2060 606f  l ignore the ``o
-00012ee0: 7264 6572 6060 206b 6579 776f 7264 2061  rder`` keyword a
-00012ef0: 7267 756d 656e 742e 0a20 2020 2020 2020  rgument..       
-00012f00: 2020 2020 2020 2020 2054 6865 2064 6566           The def
-00012f10: 6175 6c74 206f 7264 6572 2069 7320 2743  ault order is 'C
-00012f20: 2720 636f 6e74 6967 756f 7573 2e0a 2020  ' contiguous..  
-00012f30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00012f40: 2020 6b77 6172 6773 2e70 6f70 2822 6f72    kwargs.pop("or
-00012f50: 6465 7222 2c20 4e6f 6e65 2920 2023 2060  der", None)  # `
-00012f60: 6f72 6465 7260 2069 7320 6e6f 7420 7265  order` is not re
-00012f70: 7370 6563 7465 642c 2073 6f20 7765 2072  spected, so we r
-00012f80: 656d 6f76 6520 7468 6973 206b 7761 7267  emove this kwarg
-00012f90: 0a20 2020 2020 2020 2023 2053 6361 6c61  .        # Scala
-00012fa0: 7273 2064 6f6e 2774 2074 616b 6520 6063  rs don't take `c
-00012fb0: 6173 7469 6e67 6020 6f72 2060 636f 7079  asting` or `copy
-00012fc0: 6020 6b77 6172 6773 202d 2061 7320 7375  ` kwargs - as su
-00012fd0: 6368 2077 6520 6f6e 6c79 2070 6173 730a  ch we only pass.
-00012fe0: 2020 2020 2020 2020 2320 7468 656d 2074          # them t
-00012ff0: 6f20 606d 6170 5f62 6c6f 636b 7360 2069  o `map_blocks` i
-00013000: 6620 7370 6563 6966 6965 6420 6279 2075  f specified by u
-00013010: 7365 7220 2864 6966 6665 7265 6e74 2074  ser (different t
-00013020: 6861 6e20 6465 6661 756c 7473 292e 0a20  han defaults).. 
-00013030: 2020 2020 2020 2065 7874 7261 203d 2073         extra = s
-00013040: 6574 286b 7761 7267 7329 202d 207b 2263  et(kwargs) - {"c
-00013050: 6173 7469 6e67 222c 2022 636f 7079 227d  asting", "copy"}
-00013060: 0a20 2020 2020 2020 2069 6620 6578 7472  .        if extr
-00013070: 613a 0a20 2020 2020 2020 2020 2020 2072  a:.            r
-00013080: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
-00013090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000130a0: 6622 6173 7479 7065 2064 6f65 7320 6e6f  f"astype does no
-000130b0: 7420 7461 6b65 2074 6865 2066 6f6c 6c6f  t take the follo
-000130c0: 7769 6e67 206b 6579 776f 7264 2061 7267  wing keyword arg
-000130d0: 756d 656e 7473 3a20 7b6c 6973 7428 6578  uments: {list(ex
-000130e0: 7472 6129 7d22 0a20 2020 2020 2020 2020  tra)}".         
-000130f0: 2020 2029 0a20 2020 2020 2020 2063 6173     ).        cas
-00013100: 7469 6e67 203d 206b 7761 7267 732e 6765  ting = kwargs.ge
-00013110: 7428 2263 6173 7469 6e67 222c 2022 756e  t("casting", "un
-00013120: 7361 6665 2229 0a20 2020 2020 2020 2064  safe").        d
-00013130: 7479 7065 203d 206e 702e 6474 7970 6528  type = np.dtype(
-00013140: 6474 7970 6529 0a20 2020 2020 2020 2069  dtype).        i
-00013150: 6620 7365 6c66 2e64 7479 7065 203d 3d20  f self.dtype == 
-00013160: 6474 7970 653a 0a20 2020 2020 2020 2020  dtype:.         
-00013170: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
-00013180: 2020 2020 2020 2065 6c69 6620 6e6f 7420         elif not 
-00013190: 6e70 2e63 616e 5f63 6173 7428 7365 6c66  np.can_cast(self
-000131a0: 2e64 7479 7065 2c20 6474 7970 652c 2063  .dtype, dtype, c
-000131b0: 6173 7469 6e67 3d63 6173 7469 6e67 293a  asting=casting):
-000131c0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000131d0: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
-000131e0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-000131f0: 4361 6e6e 6f74 2063 6173 7420 6172 7261  Cannot cast arra
-00013200: 7920 6672 6f6d 207b 7365 6c66 2e64 7479  y from {self.dty
-00013210: 7065 2172 7d20 746f 207b 6474 7970 6521  pe!r} to {dtype!
-00013220: 727d 2022 0a20 2020 2020 2020 2020 2020  r} ".           
-00013230: 2020 2020 2066 2261 6363 6f72 6469 6e67       f"according
-00013240: 2074 6f20 7468 6520 7275 6c65 207b 6361   to the rule {ca
-00013250: 7374 696e 6721 727d 220a 2020 2020 2020  sting!r}".      
-00013260: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00013270: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-00013280: 626c 6f63 6b73 2863 6875 6e6b 2e61 7374  blocks(chunk.ast
-00013290: 7970 652c 2064 7479 7065 3d64 7479 7065  ype, dtype=dtype
-000132a0: 2c20 6173 7479 7065 5f64 7479 7065 3d64  , astype_dtype=d
-000132b0: 7479 7065 2c20 2a2a 6b77 6172 6773 290a  type, **kwargs).
-000132c0: 0a20 2020 2064 6566 205f 5f61 6273 5f5f  .    def __abs__
-000132d0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000132e0: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
-000132f0: 6f70 6572 6174 6f72 2e61 6273 2c20 7365  operator.abs, se
-00013300: 6c66 290a 0a20 2020 2040 6368 6563 6b5f  lf)..    @check_
-00013310: 6966 5f68 616e 646c 6564 5f67 6976 656e  if_handled_given
-00013320: 5f6f 7468 6572 0a20 2020 2064 6566 205f  _other.    def _
-00013330: 5f61 6464 5f5f 2873 656c 662c 206f 7468  _add__(self, oth
-00013340: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
-00013350: 7572 6e20 656c 656d 7769 7365 286f 7065  urn elemwise(ope
-00013360: 7261 746f 722e 6164 642c 2073 656c 662c  rator.add, self,
-00013370: 206f 7468 6572 290a 0a20 2020 2040 6368   other)..    @ch
-00013380: 6563 6b5f 6966 5f68 616e 646c 6564 5f67  eck_if_handled_g
-00013390: 6976 656e 5f6f 7468 6572 0a20 2020 2064  iven_other.    d
-000133a0: 6566 205f 5f72 6164 645f 5f28 7365 6c66  ef __radd__(self
-000133b0: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
-000133c0: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
-000133d0: 6528 6f70 6572 6174 6f72 2e61 6464 2c20  e(operator.add, 
-000133e0: 6f74 6865 722c 2073 656c 6629 0a0a 2020  other, self)..  
-000133f0: 2020 4063 6865 636b 5f69 665f 6861 6e64    @check_if_hand
-00013400: 6c65 645f 6769 7665 6e5f 6f74 6865 720a  led_given_other.
-00013410: 2020 2020 6465 6620 5f5f 616e 645f 5f28      def __and__(
-00013420: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-00013430: 2020 2020 2020 7265 7475 726e 2065 6c65        return ele
-00013440: 6d77 6973 6528 6f70 6572 6174 6f72 2e61  mwise(operator.a
-00013450: 6e64 5f2c 2073 656c 662c 206f 7468 6572  nd_, self, other
-00013460: 290a 0a20 2020 2040 6368 6563 6b5f 6966  )..    @check_if
-00013470: 5f68 616e 646c 6564 5f67 6976 656e 5f6f  _handled_given_o
-00013480: 7468 6572 0a20 2020 2064 6566 205f 5f72  ther.    def __r
-00013490: 616e 645f 5f28 7365 6c66 2c20 6f74 6865  and__(self, othe
-000134a0: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
-000134b0: 726e 2065 6c65 6d77 6973 6528 6f70 6572  rn elemwise(oper
-000134c0: 6174 6f72 2e61 6e64 5f2c 206f 7468 6572  ator.and_, other
-000134d0: 2c20 7365 6c66 290a 0a20 2020 2040 6368  , self)..    @ch
-000134e0: 6563 6b5f 6966 5f68 616e 646c 6564 5f67  eck_if_handled_g
-000134f0: 6976 656e 5f6f 7468 6572 0a20 2020 2064  iven_other.    d
-00013500: 6566 205f 5f64 6976 5f5f 2873 656c 662c  ef __div__(self,
-00013510: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
-00013520: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
-00013530: 286f 7065 7261 746f 722e 6469 762c 2073  (operator.div, s
-00013540: 656c 662c 206f 7468 6572 290a 0a20 2020  elf, other)..   
-00013550: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
-00013560: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
-00013570: 2020 2064 6566 205f 5f72 6469 765f 5f28     def __rdiv__(
-00013580: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-00013590: 2020 2020 2020 7265 7475 726e 2065 6c65        return ele
-000135a0: 6d77 6973 6528 6f70 6572 6174 6f72 2e64  mwise(operator.d
-000135b0: 6976 2c20 6f74 6865 722c 2073 656c 6629  iv, other, self)
-000135c0: 0a0a 2020 2020 4063 6865 636b 5f69 665f  ..    @check_if_
-000135d0: 6861 6e64 6c65 645f 6769 7665 6e5f 6f74  handled_given_ot
-000135e0: 6865 720a 2020 2020 6465 6620 5f5f 6571  her.    def __eq
-000135f0: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
-00013600: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013610: 656c 656d 7769 7365 286f 7065 7261 746f  elemwise(operato
-00013620: 722e 6571 2c20 7365 6c66 2c20 6f74 6865  r.eq, self, othe
-00013630: 7229 0a0a 2020 2020 4063 6865 636b 5f69  r)..    @check_i
-00013640: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
-00013650: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
-00013660: 6774 5f5f 2873 656c 662c 206f 7468 6572  gt__(self, other
-00013670: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00013680: 6e20 656c 656d 7769 7365 286f 7065 7261  n elemwise(opera
-00013690: 746f 722e 6774 2c20 7365 6c66 2c20 6f74  tor.gt, self, ot
-000136a0: 6865 7229 0a0a 2020 2020 4063 6865 636b  her)..    @check
-000136b0: 5f69 665f 6861 6e64 6c65 645f 6769 7665  _if_handled_give
-000136c0: 6e5f 6f74 6865 720a 2020 2020 6465 6620  n_other.    def 
-000136d0: 5f5f 6765 5f5f 2873 656c 662c 206f 7468  __ge__(self, oth
-000136e0: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
-000136f0: 7572 6e20 656c 656d 7769 7365 286f 7065  urn elemwise(ope
-00013700: 7261 746f 722e 6765 2c20 7365 6c66 2c20  rator.ge, self, 
-00013710: 6f74 6865 7229 0a0a 2020 2020 6465 6620  other)..    def 
-00013720: 5f5f 696e 7665 7274 5f5f 2873 656c 6629  __invert__(self)
-00013730: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00013740: 2065 6c65 6d77 6973 6528 6f70 6572 6174   elemwise(operat
-00013750: 6f72 2e69 6e76 6572 742c 2073 656c 6629  or.invert, self)
-00013760: 0a0a 2020 2020 4063 6865 636b 5f69 665f  ..    @check_if_
-00013770: 6861 6e64 6c65 645f 6769 7665 6e5f 6f74  handled_given_ot
-00013780: 6865 720a 2020 2020 6465 6620 5f5f 6c73  her.    def __ls
-00013790: 6869 6674 5f5f 2873 656c 662c 206f 7468  hift__(self, oth
-000137a0: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
-000137b0: 7572 6e20 656c 656d 7769 7365 286f 7065  urn elemwise(ope
-000137c0: 7261 746f 722e 6c73 6869 6674 2c20 7365  rator.lshift, se
-000137d0: 6c66 2c20 6f74 6865 7229 0a0a 2020 2020  lf, other)..    
-000137e0: 4063 6865 636b 5f69 665f 6861 6e64 6c65  @check_if_handle
-000137f0: 645f 6769 7665 6e5f 6f74 6865 720a 2020  d_given_other.  
-00013800: 2020 6465 6620 5f5f 726c 7368 6966 745f    def __rlshift_
-00013810: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
-00013820: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-00013830: 6c65 6d77 6973 6528 6f70 6572 6174 6f72  lemwise(operator
-00013840: 2e6c 7368 6966 742c 206f 7468 6572 2c20  .lshift, other, 
-00013850: 7365 6c66 290a 0a20 2020 2040 6368 6563  self)..    @chec
-00013860: 6b5f 6966 5f68 616e 646c 6564 5f67 6976  k_if_handled_giv
-00013870: 656e 5f6f 7468 6572 0a20 2020 2064 6566  en_other.    def
-00013880: 205f 5f6c 745f 5f28 7365 6c66 2c20 6f74   __lt__(self, ot
-00013890: 6865 7229 3a0a 2020 2020 2020 2020 7265  her):.        re
-000138a0: 7475 726e 2065 6c65 6d77 6973 6528 6f70  turn elemwise(op
-000138b0: 6572 6174 6f72 2e6c 742c 2073 656c 662c  erator.lt, self,
-000138c0: 206f 7468 6572 290a 0a20 2020 2040 6368   other)..    @ch
-000138d0: 6563 6b5f 6966 5f68 616e 646c 6564 5f67  eck_if_handled_g
-000138e0: 6976 656e 5f6f 7468 6572 0a20 2020 2064  iven_other.    d
-000138f0: 6566 205f 5f6c 655f 5f28 7365 6c66 2c20  ef __le__(self, 
-00013900: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-00013910: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
-00013920: 6f70 6572 6174 6f72 2e6c 652c 2073 656c  operator.le, sel
-00013930: 662c 206f 7468 6572 290a 0a20 2020 2040  f, other)..    @
-00013940: 6368 6563 6b5f 6966 5f68 616e 646c 6564  check_if_handled
-00013950: 5f67 6976 656e 5f6f 7468 6572 0a20 2020  _given_other.   
-00013960: 2064 6566 205f 5f6d 6f64 5f5f 2873 656c   def __mod__(sel
-00013970: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
-00013980: 2020 2072 6574 7572 6e20 656c 656d 7769     return elemwi
-00013990: 7365 286f 7065 7261 746f 722e 6d6f 642c  se(operator.mod,
-000139a0: 2073 656c 662c 206f 7468 6572 290a 0a20   self, other).. 
-000139b0: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
-000139c0: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
-000139d0: 0a20 2020 2064 6566 205f 5f72 6d6f 645f  .    def __rmod_
-000139e0: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
-000139f0: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-00013a00: 6c65 6d77 6973 6528 6f70 6572 6174 6f72  lemwise(operator
-00013a10: 2e6d 6f64 2c20 6f74 6865 722c 2073 656c  .mod, other, sel
-00013a20: 6629 0a0a 2020 2020 4063 6865 636b 5f69  f)..    @check_i
-00013a30: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
-00013a40: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
-00013a50: 6d75 6c5f 5f28 7365 6c66 2c20 6f74 6865  mul__(self, othe
-00013a60: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
-00013a70: 726e 2065 6c65 6d77 6973 6528 6f70 6572  rn elemwise(oper
-00013a80: 6174 6f72 2e6d 756c 2c20 7365 6c66 2c20  ator.mul, self, 
-00013a90: 6f74 6865 7229 0a0a 2020 2020 4063 6865  other)..    @che
-00013aa0: 636b 5f69 665f 6861 6e64 6c65 645f 6769  ck_if_handled_gi
-00013ab0: 7665 6e5f 6f74 6865 720a 2020 2020 6465  ven_other.    de
-00013ac0: 6620 5f5f 726d 756c 5f5f 2873 656c 662c  f __rmul__(self,
-00013ad0: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
-00013ae0: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
-00013af0: 286f 7065 7261 746f 722e 6d75 6c2c 206f  (operator.mul, o
-00013b00: 7468 6572 2c20 7365 6c66 290a 0a20 2020  ther, self)..   
-00013b10: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
-00013b20: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
-00013b30: 2020 2064 6566 205f 5f6e 655f 5f28 7365     def __ne__(se
-00013b40: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
-00013b50: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
-00013b60: 6973 6528 6f70 6572 6174 6f72 2e6e 652c  ise(operator.ne,
-00013b70: 2073 656c 662c 206f 7468 6572 290a 0a20   self, other).. 
-00013b80: 2020 2064 6566 205f 5f6e 6567 5f5f 2873     def __neg__(s
-00013b90: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00013ba0: 7475 726e 2065 6c65 6d77 6973 6528 6f70  turn elemwise(op
-00013bb0: 6572 6174 6f72 2e6e 6567 2c20 7365 6c66  erator.neg, self
-00013bc0: 290a 0a20 2020 2040 6368 6563 6b5f 6966  )..    @check_if
-00013bd0: 5f68 616e 646c 6564 5f67 6976 656e 5f6f  _handled_given_o
-00013be0: 7468 6572 0a20 2020 2064 6566 205f 5f6f  ther.    def __o
-00013bf0: 725f 5f28 7365 6c66 2c20 6f74 6865 7229  r__(self, other)
-00013c00: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00013c10: 2065 6c65 6d77 6973 6528 6f70 6572 6174   elemwise(operat
-00013c20: 6f72 2e6f 725f 2c20 7365 6c66 2c20 6f74  or.or_, self, ot
-00013c30: 6865 7229 0a0a 2020 2020 6465 6620 5f5f  her)..    def __
-00013c40: 706f 735f 5f28 7365 6c66 293a 0a20 2020  pos__(self):.   
-00013c50: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00013c60: 0a0a 2020 2020 4063 6865 636b 5f69 665f  ..    @check_if_
-00013c70: 6861 6e64 6c65 645f 6769 7665 6e5f 6f74  handled_given_ot
-00013c80: 6865 720a 2020 2020 6465 6620 5f5f 726f  her.    def __ro
-00013c90: 725f 5f28 7365 6c66 2c20 6f74 6865 7229  r__(self, other)
-00013ca0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00013cb0: 2065 6c65 6d77 6973 6528 6f70 6572 6174   elemwise(operat
-00013cc0: 6f72 2e6f 725f 2c20 6f74 6865 722c 2073  or.or_, other, s
-00013cd0: 656c 6629 0a0a 2020 2020 4063 6865 636b  elf)..    @check
-00013ce0: 5f69 665f 6861 6e64 6c65 645f 6769 7665  _if_handled_give
-00013cf0: 6e5f 6f74 6865 720a 2020 2020 6465 6620  n_other.    def 
-00013d00: 5f5f 706f 775f 5f28 7365 6c66 2c20 6f74  __pow__(self, ot
-00013d10: 6865 7229 3a0a 2020 2020 2020 2020 7265  her):.        re
-00013d20: 7475 726e 2065 6c65 6d77 6973 6528 6f70  turn elemwise(op
-00013d30: 6572 6174 6f72 2e70 6f77 2c20 7365 6c66  erator.pow, self
-00013d40: 2c20 6f74 6865 7229 0a0a 2020 2020 4063  , other)..    @c
-00013d50: 6865 636b 5f69 665f 6861 6e64 6c65 645f  heck_if_handled_
-00013d60: 6769 7665 6e5f 6f74 6865 720a 2020 2020  given_other.    
-00013d70: 6465 6620 5f5f 7270 6f77 5f5f 2873 656c  def __rpow__(sel
-00013d80: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
-00013d90: 2020 2072 6574 7572 6e20 656c 656d 7769     return elemwi
-00013da0: 7365 286f 7065 7261 746f 722e 706f 772c  se(operator.pow,
-00013db0: 206f 7468 6572 2c20 7365 6c66 290a 0a20   other, self).. 
-00013dc0: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
-00013dd0: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
-00013de0: 0a20 2020 2064 6566 205f 5f72 7368 6966  .    def __rshif
-00013df0: 745f 5f28 7365 6c66 2c20 6f74 6865 7229  t__(self, other)
-00013e00: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00013e10: 2065 6c65 6d77 6973 6528 6f70 6572 6174   elemwise(operat
-00013e20: 6f72 2e72 7368 6966 742c 2073 656c 662c  or.rshift, self,
-00013e30: 206f 7468 6572 290a 0a20 2020 2040 6368   other)..    @ch
-00013e40: 6563 6b5f 6966 5f68 616e 646c 6564 5f67  eck_if_handled_g
-00013e50: 6976 656e 5f6f 7468 6572 0a20 2020 2064  iven_other.    d
-00013e60: 6566 205f 5f72 7273 6869 6674 5f5f 2873  ef __rrshift__(s
-00013e70: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
-00013e80: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
-00013e90: 7769 7365 286f 7065 7261 746f 722e 7273  wise(operator.rs
-00013ea0: 6869 6674 2c20 6f74 6865 722c 2073 656c  hift, other, sel
-00013eb0: 6629 0a0a 2020 2020 4063 6865 636b 5f69  f)..    @check_i
-00013ec0: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
-00013ed0: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
-00013ee0: 7375 625f 5f28 7365 6c66 2c20 6f74 6865  sub__(self, othe
-00013ef0: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
-00013f00: 726e 2065 6c65 6d77 6973 6528 6f70 6572  rn elemwise(oper
-00013f10: 6174 6f72 2e73 7562 2c20 7365 6c66 2c20  ator.sub, self, 
-00013f20: 6f74 6865 7229 0a0a 2020 2020 4063 6865  other)..    @che
-00013f30: 636b 5f69 665f 6861 6e64 6c65 645f 6769  ck_if_handled_gi
-00013f40: 7665 6e5f 6f74 6865 720a 2020 2020 6465  ven_other.    de
-00013f50: 6620 5f5f 7273 7562 5f5f 2873 656c 662c  f __rsub__(self,
-00013f60: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
-00013f70: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
-00013f80: 286f 7065 7261 746f 722e 7375 622c 206f  (operator.sub, o
-00013f90: 7468 6572 2c20 7365 6c66 290a 0a20 2020  ther, self)..   
-00013fa0: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
-00013fb0: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
-00013fc0: 2020 2064 6566 205f 5f74 7275 6564 6976     def __truediv
-00013fd0: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
-00013fe0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013ff0: 656c 656d 7769 7365 286f 7065 7261 746f  elemwise(operato
-00014000: 722e 7472 7565 6469 762c 2073 656c 662c  r.truediv, self,
-00014010: 206f 7468 6572 290a 0a20 2020 2040 6368   other)..    @ch
-00014020: 6563 6b5f 6966 5f68 616e 646c 6564 5f67  eck_if_handled_g
-00014030: 6976 656e 5f6f 7468 6572 0a20 2020 2064  iven_other.    d
-00014040: 6566 205f 5f72 7472 7565 6469 765f 5f28  ef __rtruediv__(
-00014050: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-00014060: 2020 2020 2020 7265 7475 726e 2065 6c65        return ele
-00014070: 6d77 6973 6528 6f70 6572 6174 6f72 2e74  mwise(operator.t
-00014080: 7275 6564 6976 2c20 6f74 6865 722c 2073  ruediv, other, s
-00014090: 656c 6629 0a0a 2020 2020 4063 6865 636b  elf)..    @check
-000140a0: 5f69 665f 6861 6e64 6c65 645f 6769 7665  _if_handled_give
-000140b0: 6e5f 6f74 6865 720a 2020 2020 6465 6620  n_other.    def 
-000140c0: 5f5f 666c 6f6f 7264 6976 5f5f 2873 656c  __floordiv__(sel
-000140d0: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
-000140e0: 2020 2072 6574 7572 6e20 656c 656d 7769     return elemwi
-000140f0: 7365 286f 7065 7261 746f 722e 666c 6f6f  se(operator.floo
-00014100: 7264 6976 2c20 7365 6c66 2c20 6f74 6865  rdiv, self, othe
-00014110: 7229 0a0a 2020 2020 4063 6865 636b 5f69  r)..    @check_i
-00014120: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
-00014130: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
-00014140: 7266 6c6f 6f72 6469 765f 5f28 7365 6c66  rfloordiv__(self
-00014150: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
-00014160: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
-00014170: 6528 6f70 6572 6174 6f72 2e66 6c6f 6f72  e(operator.floor
-00014180: 6469 762c 206f 7468 6572 2c20 7365 6c66  div, other, self
-00014190: 290a 0a20 2020 2040 6368 6563 6b5f 6966  )..    @check_if
-000141a0: 5f68 616e 646c 6564 5f67 6976 656e 5f6f  _handled_given_o
-000141b0: 7468 6572 0a20 2020 2064 6566 205f 5f78  ther.    def __x
-000141c0: 6f72 5f5f 2873 656c 662c 206f 7468 6572  or__(self, other
-000141d0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-000141e0: 6e20 656c 656d 7769 7365 286f 7065 7261  n elemwise(opera
-000141f0: 746f 722e 786f 722c 2073 656c 662c 206f  tor.xor, self, o
-00014200: 7468 6572 290a 0a20 2020 2040 6368 6563  ther)..    @chec
-00014210: 6b5f 6966 5f68 616e 646c 6564 5f67 6976  k_if_handled_giv
-00014220: 656e 5f6f 7468 6572 0a20 2020 2064 6566  en_other.    def
-00014230: 205f 5f72 786f 725f 5f28 7365 6c66 2c20   __rxor__(self, 
-00014240: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-00014250: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
-00014260: 6f70 6572 6174 6f72 2e78 6f72 2c20 6f74  operator.xor, ot
-00014270: 6865 722c 2073 656c 6629 0a0a 2020 2020  her, self)..    
-00014280: 4063 6865 636b 5f69 665f 6861 6e64 6c65  @check_if_handle
-00014290: 645f 6769 7665 6e5f 6f74 6865 720a 2020  d_given_other.  
-000142a0: 2020 6465 6620 5f5f 6d61 746d 756c 5f5f    def __matmul__
-000142b0: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
-000142c0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-000142d0: 2e61 7272 6179 2e72 6f75 7469 6e65 7320  .array.routines 
-000142e0: 696d 706f 7274 206d 6174 6d75 6c0a 0a20  import matmul.. 
-000142f0: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
-00014300: 746d 756c 2873 656c 662c 206f 7468 6572  tmul(self, other
-00014310: 290a 0a20 2020 2040 6368 6563 6b5f 6966  )..    @check_if
-00014320: 5f68 616e 646c 6564 5f67 6976 656e 5f6f  _handled_given_o
-00014330: 7468 6572 0a20 2020 2064 6566 205f 5f72  ther.    def __r
-00014340: 6d61 746d 756c 5f5f 2873 656c 662c 206f  matmul__(self, o
-00014350: 7468 6572 293a 0a20 2020 2020 2020 2066  ther):.        f
-00014360: 726f 6d20 6461 736b 2e61 7272 6179 2e72  rom dask.array.r
-00014370: 6f75 7469 6e65 7320 696d 706f 7274 206d  outines import m
-00014380: 6174 6d75 6c0a 0a20 2020 2020 2020 2072  atmul..        r
-00014390: 6574 7572 6e20 6d61 746d 756c 286f 7468  eturn matmul(oth
-000143a0: 6572 2c20 7365 6c66 290a 0a20 2020 2040  er, self)..    @
-000143b0: 6368 6563 6b5f 6966 5f68 616e 646c 6564  check_if_handled
-000143c0: 5f67 6976 656e 5f6f 7468 6572 0a20 2020  _given_other.   
-000143d0: 2064 6566 205f 5f64 6976 6d6f 645f 5f28   def __divmod__(
-000143e0: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-000143f0: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00014400: 6172 7261 792e 7566 756e 6320 696d 706f  array.ufunc impo
-00014410: 7274 2064 6976 6d6f 640a 0a20 2020 2020  rt divmod..     
-00014420: 2020 2072 6574 7572 6e20 6469 766d 6f64     return divmod
-00014430: 2873 656c 662c 206f 7468 6572 290a 0a20  (self, other).. 
-00014440: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
-00014450: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
-00014460: 0a20 2020 2064 6566 205f 5f72 6469 766d  .    def __rdivm
-00014470: 6f64 5f5f 2873 656c 662c 206f 7468 6572  od__(self, other
-00014480: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
-00014490: 6461 736b 2e61 7272 6179 2e75 6675 6e63  dask.array.ufunc
-000144a0: 2069 6d70 6f72 7420 6469 766d 6f64 0a0a   import divmod..
-000144b0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-000144c0: 6976 6d6f 6428 6f74 6865 722c 2073 656c  ivmod(other, sel
-000144d0: 6629 0a0a 2020 2020 6465 6620 616e 7928  f)..    def any(
-000144e0: 7365 6c66 2c20 6178 6973 3d4e 6f6e 652c  self, axis=None,
-000144f0: 206b 6565 7064 696d 733d 4661 6c73 652c   keepdims=False,
-00014500: 2073 706c 6974 5f65 7665 7279 3d4e 6f6e   split_every=Non
-00014510: 652c 206f 7574 3d4e 6f6e 6529 3a0a 2020  e, out=None):.  
-00014520: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
-00014530: 2054 7275 6520 6966 2061 6e79 206f 6620   True if any of 
-00014540: 7468 6520 656c 656d 656e 7473 2065 7661  the elements eva
-00014550: 6c75 6174 6520 746f 2054 7275 652e 0a0a  luate to True...
-00014560: 2020 2020 2020 2020 5265 6665 7220 746f          Refer to
-00014570: 203a 6675 6e63 3a60 6461 736b 2e61 7272   :func:`dask.arr
-00014580: 6179 2e61 6e79 6020 666f 7220 6675 6c6c  ay.any` for full
-00014590: 2064 6f63 756d 656e 7461 7469 6f6e 2e0a   documentation..
-000145a0: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-000145b0: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-000145c0: 2d2d 0a20 2020 2020 2020 2064 6173 6b2e  --.        dask.
-000145d0: 6172 7261 792e 616e 7920 3a20 6571 7569  array.any : equi
-000145e0: 7661 6c65 6e74 2066 756e 6374 696f 6e0a  valent function.
-000145f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00014600: 2020 2020 6672 6f6d 2064 6173 6b2e 6172      from dask.ar
-00014610: 7261 792e 7265 6475 6374 696f 6e73 2069  ray.reductions i
-00014620: 6d70 6f72 7420 616e 790a 0a20 2020 2020  mport any..     
-00014630: 2020 2072 6574 7572 6e20 616e 7928 7365     return any(se
-00014640: 6c66 2c20 6178 6973 3d61 7869 732c 206b  lf, axis=axis, k
-00014650: 6565 7064 696d 733d 6b65 6570 6469 6d73  eepdims=keepdims
-00014660: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
-00014670: 6c69 745f 6576 6572 792c 206f 7574 3d6f  lit_every, out=o
-00014680: 7574 290a 0a20 2020 2064 6566 2061 6c6c  ut)..    def all
-00014690: 2873 656c 662c 2061 7869 733d 4e6f 6e65  (self, axis=None
-000146a0: 2c20 6b65 6570 6469 6d73 3d46 616c 7365  , keepdims=False
-000146b0: 2c20 7370 6c69 745f 6576 6572 793d 4e6f  , split_every=No
-000146c0: 6e65 2c20 6f75 743d 4e6f 6e65 293a 0a20  ne, out=None):. 
-000146d0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-000146e0: 7320 5472 7565 2069 6620 616c 6c20 656c  s True if all el
-000146f0: 656d 656e 7473 2065 7661 6c75 6174 6520  ements evaluate 
-00014700: 746f 2054 7275 652e 0a0a 2020 2020 2020  to True...      
-00014710: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
-00014720: 3a60 6461 736b 2e61 7272 6179 2e61 6c6c  :`dask.array.all
-00014730: 6020 666f 7220 6675 6c6c 2064 6f63 756d  ` for full docum
-00014740: 656e 7461 7469 6f6e 2e0a 0a20 2020 2020  entation...     
-00014750: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-00014760: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00014770: 2020 2020 2064 6173 6b2e 6172 7261 792e       dask.array.
-00014780: 616c 6c20 3a20 6571 7569 7661 6c65 6e74  all : equivalent
-00014790: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
-000147a0: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
-000147b0: 6f6d 2064 6173 6b2e 6172 7261 792e 7265  om dask.array.re
-000147c0: 6475 6374 696f 6e73 2069 6d70 6f72 7420  ductions import 
-000147d0: 616c 6c0a 0a20 2020 2020 2020 2072 6574  all..        ret
-000147e0: 7572 6e20 616c 6c28 7365 6c66 2c20 6178  urn all(self, ax
-000147f0: 6973 3d61 7869 732c 206b 6565 7064 696d  is=axis, keepdim
-00014800: 733d 6b65 6570 6469 6d73 2c20 7370 6c69  s=keepdims, spli
-00014810: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-00014820: 6572 792c 206f 7574 3d6f 7574 290a 0a20  ery, out=out).. 
-00014830: 2020 2064 6566 206d 696e 2873 656c 662c     def min(self,
-00014840: 2061 7869 733d 4e6f 6e65 2c20 6b65 6570   axis=None, keep
-00014850: 6469 6d73 3d46 616c 7365 2c20 7370 6c69  dims=False, spli
-00014860: 745f 6576 6572 793d 4e6f 6e65 2c20 6f75  t_every=None, ou
-00014870: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
-00014880: 2022 2222 5265 7475 726e 2074 6865 206d   """Return the m
-00014890: 696e 696d 756d 2061 6c6f 6e67 2061 2067  inimum along a g
-000148a0: 6976 656e 2061 7869 732e 0a0a 2020 2020  iven axis...    
-000148b0: 2020 2020 5265 6665 7220 746f 203a 6675      Refer to :fu
-000148c0: 6e63 3a60 6461 736b 2e61 7272 6179 2e6d  nc:`dask.array.m
-000148d0: 696e 6020 666f 7220 6675 6c6c 2064 6f63  in` for full doc
-000148e0: 756d 656e 7461 7469 6f6e 2e0a 0a20 2020  umentation...   
-000148f0: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-00014900: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-00014910: 2020 2020 2020 2064 6173 6b2e 6172 7261         dask.arra
-00014920: 792e 6d69 6e20 3a20 6571 7569 7661 6c65  y.min : equivale
-00014930: 6e74 2066 756e 6374 696f 6e0a 2020 2020  nt function.    
-00014940: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00014950: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
-00014960: 7265 6475 6374 696f 6e73 2069 6d70 6f72  reductions impor
-00014970: 7420 6d69 6e0a 0a20 2020 2020 2020 2072  t min..        r
-00014980: 6574 7572 6e20 6d69 6e28 7365 6c66 2c20  eturn min(self, 
-00014990: 6178 6973 3d61 7869 732c 206b 6565 7064  axis=axis, keepd
-000149a0: 696d 733d 6b65 6570 6469 6d73 2c20 7370  ims=keepdims, sp
-000149b0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-000149c0: 6576 6572 792c 206f 7574 3d6f 7574 290a  every, out=out).
-000149d0: 0a20 2020 2064 6566 206d 6178 2873 656c  .    def max(sel
-000149e0: 662c 2061 7869 733d 4e6f 6e65 2c20 6b65  f, axis=None, ke
-000149f0: 6570 6469 6d73 3d46 616c 7365 2c20 7370  epdims=False, sp
-00014a00: 6c69 745f 6576 6572 793d 4e6f 6e65 2c20  lit_every=None, 
-00014a10: 6f75 743d 4e6f 6e65 293a 0a20 2020 2020  out=None):.     
-00014a20: 2020 2022 2222 5265 7475 726e 2074 6865     """Return the
-00014a30: 206d 6178 696d 756d 2061 6c6f 6e67 2061   maximum along a
-00014a40: 2067 6976 656e 2061 7869 732e 0a0a 2020   given axis...  
-00014a50: 2020 2020 2020 5265 6665 7220 746f 203a        Refer to :
-00014a60: 6675 6e63 3a60 6461 736b 2e61 7272 6179  func:`dask.array
-00014a70: 2e6d 6178 6020 666f 7220 6675 6c6c 2064  .max` for full d
-00014a80: 6f63 756d 656e 7461 7469 6f6e 2e0a 0a20  ocumentation... 
-00014a90: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
-00014aa0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00014ab0: 0a20 2020 2020 2020 2064 6173 6b2e 6172  .        dask.ar
-00014ac0: 7261 792e 6d61 7820 3a20 6571 7569 7661  ray.max : equiva
-00014ad0: 6c65 6e74 2066 756e 6374 696f 6e0a 2020  lent function.  
-00014ae0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00014af0: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-00014b00: 792e 7265 6475 6374 696f 6e73 2069 6d70  y.reductions imp
-00014b10: 6f72 7420 6d61 780a 0a20 2020 2020 2020  ort max..       
-00014b20: 2072 6574 7572 6e20 6d61 7828 7365 6c66   return max(self
-00014b30: 2c20 6178 6973 3d61 7869 732c 206b 6565  , axis=axis, kee
-00014b40: 7064 696d 733d 6b65 6570 6469 6d73 2c20  pdims=keepdims, 
-00014b50: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00014b60: 745f 6576 6572 792c 206f 7574 3d6f 7574  t_every, out=out
-00014b70: 290a 0a20 2020 2064 6566 2061 7267 6d69  )..    def argmi
-00014b80: 6e28 7365 6c66 2c20 6178 6973 3d4e 6f6e  n(self, axis=Non
-00014b90: 652c 202a 2c20 6b65 6570 6469 6d73 3d46  e, *, keepdims=F
-00014ba0: 616c 7365 2c20 7370 6c69 745f 6576 6572  alse, split_ever
-00014bb0: 793d 4e6f 6e65 2c20 6f75 743d 4e6f 6e65  y=None, out=None
-00014bc0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-00014bd0: 7475 726e 2069 6e64 6963 6573 206f 6620  turn indices of 
-00014be0: 7468 6520 6d69 6e69 6d75 6d20 7661 6c75  the minimum valu
-00014bf0: 6573 2061 6c6f 6e67 2074 6865 2067 6976  es along the giv
-00014c00: 656e 2061 7869 732e 0a0a 2020 2020 2020  en axis...      
-00014c10: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
-00014c20: 3a60 6461 736b 2e61 7272 6179 2e61 7267  :`dask.array.arg
-00014c30: 6d69 6e60 2066 6f72 2066 756c 6c20 646f  min` for full do
-00014c40: 6375 6d65 6e74 6174 696f 6e2e 0a0a 2020  cumentation...  
-00014c50: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
-00014c60: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00014c70: 2020 2020 2020 2020 6461 736b 2e61 7272          dask.arr
-00014c80: 6179 2e61 7267 6d69 6e20 3a20 6571 7569  ay.argmin : equi
-00014c90: 7661 6c65 6e74 2066 756e 6374 696f 6e0a  valent function.
-00014ca0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00014cb0: 2020 2020 6672 6f6d 2064 6173 6b2e 6172      from dask.ar
-00014cc0: 7261 792e 7265 6475 6374 696f 6e73 2069  ray.reductions i
-00014cd0: 6d70 6f72 7420 6172 676d 696e 0a0a 2020  mport argmin..  
-00014ce0: 2020 2020 2020 7265 7475 726e 2061 7267        return arg
-00014cf0: 6d69 6e28 0a20 2020 2020 2020 2020 2020  min(.           
-00014d00: 2073 656c 662c 2061 7869 733d 6178 6973   self, axis=axis
-00014d10: 2c20 6b65 6570 6469 6d73 3d6b 6565 7064  , keepdims=keepd
-00014d20: 696d 732c 2073 706c 6974 5f65 7665 7279  ims, split_every
-00014d30: 3d73 706c 6974 5f65 7665 7279 2c20 6f75  =split_every, ou
-00014d40: 743d 6f75 740a 2020 2020 2020 2020 290a  t=out.        ).
-00014d50: 0a20 2020 2064 6566 2061 7267 6d61 7828  .    def argmax(
-00014d60: 7365 6c66 2c20 6178 6973 3d4e 6f6e 652c  self, axis=None,
-00014d70: 202a 2c20 6b65 6570 6469 6d73 3d46 616c   *, keepdims=Fal
-00014d80: 7365 2c20 7370 6c69 745f 6576 6572 793d  se, split_every=
-00014d90: 4e6f 6e65 2c20 6f75 743d 4e6f 6e65 293a  None, out=None):
-00014da0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00014db0: 726e 2069 6e64 6963 6573 206f 6620 7468  rn indices of th
-00014dc0: 6520 6d61 7869 6d75 6d20 7661 6c75 6573  e maximum values
-00014dd0: 2061 6c6f 6e67 2074 6865 2067 6976 656e   along the given
-00014de0: 2061 7869 732e 0a0a 2020 2020 2020 2020   axis...        
-00014df0: 5265 6665 7220 746f 203a 6675 6e63 3a60  Refer to :func:`
-00014e00: 6461 736b 2e61 7272 6179 2e61 7267 6d61  dask.array.argma
-00014e10: 7860 2066 6f72 2066 756c 6c20 646f 6375  x` for full docu
-00014e20: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
-00014e30: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-00014e40: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-00014e50: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
-00014e60: 2e61 7267 6d61 7820 3a20 6571 7569 7661  .argmax : equiva
-00014e70: 6c65 6e74 2066 756e 6374 696f 6e0a 2020  lent function.  
-00014e80: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00014e90: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-00014ea0: 792e 7265 6475 6374 696f 6e73 2069 6d70  y.reductions imp
-00014eb0: 6f72 7420 6172 676d 6178 0a0a 2020 2020  ort argmax..    
-00014ec0: 2020 2020 7265 7475 726e 2061 7267 6d61      return argma
-00014ed0: 7828 0a20 2020 2020 2020 2020 2020 2073  x(.            s
-00014ee0: 656c 662c 2061 7869 733d 6178 6973 2c20  elf, axis=axis, 
-00014ef0: 6b65 6570 6469 6d73 3d6b 6565 7064 696d  keepdims=keepdim
-00014f00: 732c 2073 706c 6974 5f65 7665 7279 3d73  s, split_every=s
-00014f10: 706c 6974 5f65 7665 7279 2c20 6f75 743d  plit_every, out=
-00014f20: 6f75 740a 2020 2020 2020 2020 290a 0a20  out.        ).. 
-00014f30: 2020 2064 6566 2073 756d 2873 656c 662c     def sum(self,
-00014f40: 2061 7869 733d 4e6f 6e65 2c20 6474 7970   axis=None, dtyp
-00014f50: 653d 4e6f 6e65 2c20 6b65 6570 6469 6d73  e=None, keepdims
-00014f60: 3d46 616c 7365 2c20 7370 6c69 745f 6576  =False, split_ev
-00014f70: 6572 793d 4e6f 6e65 2c20 6f75 743d 4e6f  ery=None, out=No
-00014f80: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-00014f90: 0a20 2020 2020 2020 2052 6574 7572 6e20  .        Return 
-00014fa0: 7468 6520 7375 6d20 6f66 2074 6865 2061  the sum of the a
-00014fb0: 7272 6179 2065 6c65 6d65 6e74 7320 6f76  rray elements ov
-00014fc0: 6572 2074 6865 2067 6976 656e 2061 7869  er the given axi
-00014fd0: 732e 0a0a 2020 2020 2020 2020 5265 6665  s...        Refe
-00014fe0: 7220 746f 203a 6675 6e63 3a60 6461 736b  r to :func:`dask
-00014ff0: 2e61 7272 6179 2e73 756d 6020 666f 7220  .array.sum` for 
-00015000: 6675 6c6c 2064 6f63 756d 656e 7461 7469  full documentati
-00015010: 6f6e 2e0a 0a20 2020 2020 2020 2053 6565  on...        See
-00015020: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-00015030: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
-00015040: 6173 6b2e 6172 7261 792e 7375 6d20 3a20  ask.array.sum : 
-00015050: 6571 7569 7661 6c65 6e74 2066 756e 6374  equivalent funct
-00015060: 696f 6e0a 2020 2020 2020 2020 2222 220a  ion.        """.
-00015070: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00015080: 6b2e 6172 7261 792e 7265 6475 6374 696f  k.array.reductio
-00015090: 6e73 2069 6d70 6f72 7420 7375 6d0a 0a20  ns import sum.. 
-000150a0: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
-000150b0: 6d28 0a20 2020 2020 2020 2020 2020 2073  m(.            s
-000150c0: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-000150d0: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
-000150e0: 2020 2020 2020 2020 6474 7970 653d 6474          dtype=dt
-000150f0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-00015100: 206b 6565 7064 696d 733d 6b65 6570 6469   keepdims=keepdi
-00015110: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
-00015120: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00015130: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
-00015140: 2020 2020 206f 7574 3d6f 7574 2c0a 2020       out=out,.  
-00015150: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00015160: 2074 7261 6365 2873 656c 662c 206f 6666   trace(self, off
-00015170: 7365 743d 302c 2061 7869 7331 3d30 2c20  set=0, axis1=0, 
-00015180: 6178 6973 323d 312c 2064 7479 7065 3d4e  axis2=1, dtype=N
-00015190: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
-000151a0: 2252 6574 7572 6e20 7468 6520 7375 6d20  "Return the sum 
-000151b0: 616c 6f6e 6720 6469 6167 6f6e 616c 7320  along diagonals 
-000151c0: 6f66 2074 6865 2061 7272 6179 2e0a 0a20  of the array... 
-000151d0: 2020 2020 2020 2052 6566 6572 2074 6f20         Refer to 
-000151e0: 3a66 756e 633a 6064 6173 6b2e 6172 7261  :func:`dask.arra
-000151f0: 792e 7472 6163 6560 2066 6f72 2066 756c  y.trace` for ful
-00015200: 6c20 646f 6375 6d65 6e74 6174 696f 6e2e  l documentation.
-00015210: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
-00015220: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
-00015230: 2d2d 2d0a 2020 2020 2020 2020 6461 736b  ---.        dask
-00015240: 2e61 7272 6179 2e74 7261 6365 203a 2065  .array.trace : e
-00015250: 7175 6976 616c 656e 7420 6675 6e63 7469  quivalent functi
-00015260: 6f6e 0a20 2020 2020 2020 2022 2222 0a20  on.        """. 
-00015270: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-00015280: 2e61 7272 6179 2e72 6564 7563 7469 6f6e  .array.reduction
-00015290: 7320 696d 706f 7274 2074 7261 6365 0a0a  s import trace..
-000152a0: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-000152b0: 7261 6365 2873 656c 662c 206f 6666 7365  race(self, offse
-000152c0: 743d 6f66 6673 6574 2c20 6178 6973 313d  t=offset, axis1=
-000152d0: 6178 6973 312c 2061 7869 7332 3d61 7869  axis1, axis2=axi
-000152e0: 7332 2c20 6474 7970 653d 6474 7970 6529  s2, dtype=dtype)
-000152f0: 0a0a 2020 2020 6465 6620 7072 6f64 2873  ..    def prod(s
-00015300: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
-00015310: 6474 7970 653d 4e6f 6e65 2c20 6b65 6570  dtype=None, keep
-00015320: 6469 6d73 3d46 616c 7365 2c20 7370 6c69  dims=False, spli
-00015330: 745f 6576 6572 793d 4e6f 6e65 2c20 6f75  t_every=None, ou
-00015340: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
-00015350: 2022 2222 5265 7475 726e 2074 6865 2070   """Return the p
-00015360: 726f 6475 6374 206f 6620 7468 6520 6172  roduct of the ar
-00015370: 7261 7920 656c 656d 656e 7473 206f 7665  ray elements ove
-00015380: 7220 7468 6520 6769 7665 6e20 6178 6973  r the given axis
-00015390: 0a0a 2020 2020 2020 2020 5265 6665 7220  ..        Refer 
-000153a0: 746f 203a 6675 6e63 3a60 6461 736b 2e61  to :func:`dask.a
-000153b0: 7272 6179 2e70 726f 6460 2066 6f72 2066  rray.prod` for f
-000153c0: 756c 6c20 646f 6375 6d65 6e74 6174 696f  ull documentatio
-000153d0: 6e2e 0a0a 2020 2020 2020 2020 5365 6520  n...        See 
-000153e0: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
-000153f0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
-00015400: 736b 2e61 7272 6179 2e70 726f 6420 3a20  sk.array.prod : 
-00015410: 6571 7569 7661 6c65 6e74 2066 756e 6374  equivalent funct
-00015420: 696f 6e0a 2020 2020 2020 2020 2222 220a  ion.        """.
-00015430: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00015440: 6b2e 6172 7261 792e 7265 6475 6374 696f  k.array.reductio
-00015450: 6e73 2069 6d70 6f72 7420 7072 6f64 0a0a  ns import prod..
-00015460: 2020 2020 2020 2020 7265 7475 726e 2070          return p
-00015470: 726f 6428 0a20 2020 2020 2020 2020 2020  rod(.           
-00015480: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-00015490: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
-000154a0: 2020 2020 2020 2020 2020 6474 7970 653d            dtype=
-000154b0: 6474 7970 652c 0a20 2020 2020 2020 2020  dtype,.         
-000154c0: 2020 206b 6565 7064 696d 733d 6b65 6570     keepdims=keep
-000154d0: 6469 6d73 2c0a 2020 2020 2020 2020 2020  dims,.          
-000154e0: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
-000154f0: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
-00015500: 2020 2020 2020 206f 7574 3d6f 7574 2c0a         out=out,.
-00015510: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00015520: 6566 206d 6561 6e28 7365 6c66 2c20 6178  ef mean(self, ax
-00015530: 6973 3d4e 6f6e 652c 2064 7479 7065 3d4e  is=None, dtype=N
-00015540: 6f6e 652c 206b 6565 7064 696d 733d 4661  one, keepdims=Fa
-00015550: 6c73 652c 2073 706c 6974 5f65 7665 7279  lse, split_every
-00015560: 3d4e 6f6e 652c 206f 7574 3d4e 6f6e 6529  =None, out=None)
-00015570: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00015580: 7572 6e73 2074 6865 2061 7665 7261 6765  urns the average
-00015590: 206f 6620 7468 6520 6172 7261 7920 656c   of the array el
-000155a0: 656d 656e 7473 2061 6c6f 6e67 2067 6976  ements along giv
-000155b0: 656e 2061 7869 732e 0a0a 2020 2020 2020  en axis...      
-000155c0: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
-000155d0: 3a60 6461 736b 2e61 7272 6179 2e6d 6561  :`dask.array.mea
-000155e0: 6e60 2066 6f72 2066 756c 6c20 646f 6375  n` for full docu
-000155f0: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
-00015600: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-00015610: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-00015620: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
-00015630: 2e6d 6561 6e20 3a20 6571 7569 7661 6c65  .mean : equivale
-00015640: 6e74 2066 756e 6374 696f 6e0a 2020 2020  nt function.    
-00015650: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00015660: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
-00015670: 7265 6475 6374 696f 6e73 2069 6d70 6f72  reductions impor
-00015680: 7420 6d65 616e 0a0a 2020 2020 2020 2020  t mean..        
-00015690: 7265 7475 726e 206d 6561 6e28 0a20 2020  return mean(.   
-000156a0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-000156b0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-000156c0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-000156d0: 2020 6474 7970 653d 6474 7970 652c 0a20    dtype=dtype,. 
-000156e0: 2020 2020 2020 2020 2020 206b 6565 7064             keepd
-000156f0: 696d 733d 6b65 6570 6469 6d73 2c0a 2020  ims=keepdims,.  
-00015700: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
-00015710: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-00015720: 792c 0a20 2020 2020 2020 2020 2020 206f  y,.            o
-00015730: 7574 3d6f 7574 2c0a 2020 2020 2020 2020  ut=out,.        
-00015740: 290a 0a20 2020 2064 6566 2073 7464 280a  )..    def std(.
-00015750: 2020 2020 2020 2020 7365 6c66 2c20 6178          self, ax
-00015760: 6973 3d4e 6f6e 652c 2064 7479 7065 3d4e  is=None, dtype=N
-00015770: 6f6e 652c 206b 6565 7064 696d 733d 4661  one, keepdims=Fa
-00015780: 6c73 652c 2064 646f 663d 302c 2073 706c  lse, ddof=0, spl
-00015790: 6974 5f65 7665 7279 3d4e 6f6e 652c 206f  it_every=None, o
-000157a0: 7574 3d4e 6f6e 650a 2020 2020 293a 0a20  ut=None.    ):. 
-000157b0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-000157c0: 7320 7468 6520 7374 616e 6461 7264 2064  s the standard d
-000157d0: 6576 6961 7469 6f6e 206f 6620 7468 6520  eviation of the 
-000157e0: 6172 7261 7920 656c 656d 656e 7473 2061  array elements a
-000157f0: 6c6f 6e67 2067 6976 656e 2061 7869 732e  long given axis.
-00015800: 0a0a 2020 2020 2020 2020 5265 6665 7220  ..        Refer 
-00015810: 746f 203a 6675 6e63 3a60 6461 736b 2e61  to :func:`dask.a
-00015820: 7272 6179 2e73 7464 6020 666f 7220 6675  rray.std` for fu
-00015830: 6c6c 2064 6f63 756d 656e 7461 7469 6f6e  ll documentation
-00015840: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
-00015850: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-00015860: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
-00015870: 6b2e 6172 7261 792e 7374 6420 3a20 6571  k.array.std : eq
-00015880: 7569 7661 6c65 6e74 2066 756e 6374 696f  uivalent functio
-00015890: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
-000158a0: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-000158b0: 6172 7261 792e 7265 6475 6374 696f 6e73  array.reductions
-000158c0: 2069 6d70 6f72 7420 7374 640a 0a20 2020   import std..   
-000158d0: 2020 2020 2072 6574 7572 6e20 7374 6428       return std(
-000158e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000158f0: 662c 0a20 2020 2020 2020 2020 2020 2061  f,.            a
-00015900: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
-00015910: 2020 2020 2020 6474 7970 653d 6474 7970        dtype=dtyp
-00015920: 652c 0a20 2020 2020 2020 2020 2020 206b  e,.            k
-00015930: 6565 7064 696d 733d 6b65 6570 6469 6d73  eepdims=keepdims
-00015940: 2c0a 2020 2020 2020 2020 2020 2020 6464  ,.            dd
-00015950: 6f66 3d64 646f 662c 0a20 2020 2020 2020  of=ddof,.       
-00015960: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-00015970: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
-00015980: 2020 2020 2020 2020 2020 6f75 743d 6f75            out=ou
-00015990: 742c 0a20 2020 2020 2020 2029 0a0a 2020  t,.        )..  
-000159a0: 2020 6465 6620 7661 7228 0a20 2020 2020    def var(.     
-000159b0: 2020 2073 656c 662c 2061 7869 733d 4e6f     self, axis=No
-000159c0: 6e65 2c20 6474 7970 653d 4e6f 6e65 2c20  ne, dtype=None, 
-000159d0: 6b65 6570 6469 6d73 3d46 616c 7365 2c20  keepdims=False, 
-000159e0: 6464 6f66 3d30 2c20 7370 6c69 745f 6576  ddof=0, split_ev
-000159f0: 6572 793d 4e6f 6e65 2c20 6f75 743d 4e6f  ery=None, out=No
-00015a00: 6e65 0a20 2020 2029 3a0a 2020 2020 2020  ne.    ):.      
-00015a10: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-00015a20: 2076 6172 6961 6e63 6520 6f66 2074 6865   variance of the
-00015a30: 2061 7272 6179 2065 6c65 6d65 6e74 732c   array elements,
-00015a40: 2061 6c6f 6e67 2067 6976 656e 2061 7869   along given axi
-00015a50: 732e 0a0a 2020 2020 2020 2020 5265 6665  s...        Refe
-00015a60: 7220 746f 203a 6675 6e63 3a60 6461 736b  r to :func:`dask
-00015a70: 2e61 7272 6179 2e76 6172 6020 666f 7220  .array.var` for 
-00015a80: 6675 6c6c 2064 6f63 756d 656e 7461 7469  full documentati
-00015a90: 6f6e 2e0a 0a20 2020 2020 2020 2053 6565  on...        See
-00015aa0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-00015ab0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
-00015ac0: 6173 6b2e 6172 7261 792e 7661 7220 3a20  ask.array.var : 
-00015ad0: 6571 7569 7661 6c65 6e74 2066 756e 6374  equivalent funct
-00015ae0: 696f 6e0a 2020 2020 2020 2020 2222 220a  ion.        """.
-00015af0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00015b00: 6b2e 6172 7261 792e 7265 6475 6374 696f  k.array.reductio
-00015b10: 6e73 2069 6d70 6f72 7420 7661 720a 0a20  ns import var.. 
-00015b20: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
-00015b30: 7228 0a20 2020 2020 2020 2020 2020 2073  r(.            s
-00015b40: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00015b50: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
-00015b60: 2020 2020 2020 2020 6474 7970 653d 6474          dtype=dt
-00015b70: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-00015b80: 206b 6565 7064 696d 733d 6b65 6570 6469   keepdims=keepdi
-00015b90: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
-00015ba0: 6464 6f66 3d64 646f 662c 0a20 2020 2020  ddof=ddof,.     
-00015bb0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-00015bc0: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
-00015bd0: 2020 2020 2020 2020 2020 2020 6f75 743d              out=
-00015be0: 6f75 742c 0a20 2020 2020 2020 2029 0a0a  out,.        )..
-00015bf0: 2020 2020 6465 6620 6d6f 6d65 6e74 280a      def moment(.
-00015c00: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00015c10: 2020 2020 2020 6f72 6465 722c 0a20 2020        order,.   
-00015c20: 2020 2020 2061 7869 733d 4e6f 6e65 2c0a       axis=None,.
-00015c30: 2020 2020 2020 2020 6474 7970 653d 4e6f          dtype=No
-00015c40: 6e65 2c0a 2020 2020 2020 2020 6b65 6570  ne,.        keep
-00015c50: 6469 6d73 3d46 616c 7365 2c0a 2020 2020  dims=False,.    
-00015c60: 2020 2020 6464 6f66 3d30 2c0a 2020 2020      ddof=0,.    
-00015c70: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
-00015c80: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f75  None,.        ou
-00015c90: 743d 4e6f 6e65 2c0a 2020 2020 293a 0a20  t=None,.    ):. 
-00015ca0: 2020 2020 2020 2022 2222 4361 6c63 756c         """Calcul
-00015cb0: 6174 6520 7468 6520 6e74 6820 6365 6e74  ate the nth cent
-00015cc0: 7261 6c69 7a65 6420 6d6f 6d65 6e74 2e0a  ralized moment..
-00015cd0: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
-00015ce0: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
-00015cf0: 7261 792e 6d6f 6d65 6e74 6020 666f 7220  ray.moment` for 
-00015d00: 7468 6520 6675 6c6c 2064 6f63 756d 656e  the full documen
-00015d10: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
-00015d20: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-00015d30: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00015d40: 2020 2064 6173 6b2e 6172 7261 792e 6d6f     dask.array.mo
-00015d50: 6d65 6e74 203a 2065 7175 6976 616c 656e  ment : equivalen
-00015d60: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
-00015d70: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-00015d80: 726f 6d20 6461 736b 2e61 7272 6179 2e72  rom dask.array.r
-00015d90: 6564 7563 7469 6f6e 7320 696d 706f 7274  eductions import
-00015da0: 206d 6f6d 656e 740a 0a20 2020 2020 2020   moment..       
-00015db0: 2072 6574 7572 6e20 6d6f 6d65 6e74 280a   return moment(.
-00015dc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00015dd0: 2c0a 2020 2020 2020 2020 2020 2020 6f72  ,.            or
-00015de0: 6465 722c 0a20 2020 2020 2020 2020 2020  der,.           
-00015df0: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
-00015e00: 2020 2020 2020 2020 6474 7970 653d 6474          dtype=dt
-00015e10: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-00015e20: 206b 6565 7064 696d 733d 6b65 6570 6469   keepdims=keepdi
-00015e30: 6d73 2c0a 2020 2020 2020 2020 2020 2020  ms,.            
-00015e40: 6464 6f66 3d64 646f 662c 0a20 2020 2020  ddof=ddof,.     
-00015e50: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-00015e60: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
-00015e70: 2020 2020 2020 2020 2020 2020 6f75 743d              out=
-00015e80: 6f75 742c 0a20 2020 2020 2020 2029 0a0a  out,.        )..
-00015e90: 2020 2020 4077 7261 7073 286d 6170 5f62      @wraps(map_b
-00015ea0: 6c6f 636b 7329 0a20 2020 2064 6566 206d  locks).    def m
-00015eb0: 6170 5f62 6c6f 636b 7328 7365 6c66 2c20  ap_blocks(self, 
-00015ec0: 6675 6e63 2c20 2a61 7267 732c 202a 2a6b  func, *args, **k
-00015ed0: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00015ee0: 7265 7475 726e 206d 6170 5f62 6c6f 636b  return map_block
-00015ef0: 7328 6675 6e63 2c20 7365 6c66 2c20 2a61  s(func, self, *a
-00015f00: 7267 732c 202a 2a6b 7761 7267 7329 0a0a  rgs, **kwargs)..
-00015f10: 2020 2020 6465 6620 6d61 705f 6f76 6572      def map_over
-00015f20: 6c61 7028 7365 6c66 2c20 6675 6e63 2c20  lap(self, func, 
-00015f30: 6465 7074 682c 2062 6f75 6e64 6172 793d  depth, boundary=
-00015f40: 4e6f 6e65 2c20 7472 696d 3d54 7275 652c  None, trim=True,
-00015f50: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00015f60: 2020 2020 2222 224d 6170 2061 2066 756e      """Map a fun
-00015f70: 6374 696f 6e20 6f76 6572 2062 6c6f 636b  ction over block
-00015f80: 7320 6f66 2074 6865 2061 7272 6179 2077  s of the array w
-00015f90: 6974 6820 736f 6d65 206f 7665 726c 6170  ith some overlap
-00015fa0: 0a0a 2020 2020 2020 2020 5265 6665 7220  ..        Refer 
-00015fb0: 746f 203a 6675 6e63 3a60 6461 736b 2e61  to :func:`dask.a
-00015fc0: 7272 6179 2e6d 6170 5f6f 7665 726c 6170  rray.map_overlap
-00015fd0: 6020 666f 7220 6675 6c6c 2064 6f63 756d  ` for full docum
-00015fe0: 656e 7461 7469 6f6e 2e0a 0a20 2020 2020  entation...     
-00015ff0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-00016000: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00016010: 2020 2020 2064 6173 6b2e 6172 7261 792e       dask.array.
-00016020: 6d61 705f 6f76 6572 6c61 7020 3a20 6571  map_overlap : eq
-00016030: 7569 7661 6c65 6e74 2066 756e 6374 696f  uivalent functio
-00016040: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
-00016050: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00016060: 6172 7261 792e 6f76 6572 6c61 7020 696d  array.overlap im
-00016070: 706f 7274 206d 6170 5f6f 7665 726c 6170  port map_overlap
-00016080: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00016090: 206d 6170 5f6f 7665 726c 6170 280a 2020   map_overlap(.  
-000160a0: 2020 2020 2020 2020 2020 6675 6e63 2c20            func, 
-000160b0: 7365 6c66 2c20 6465 7074 683d 6465 7074  self, depth=dept
-000160c0: 682c 2062 6f75 6e64 6172 793d 626f 756e  h, boundary=boun
-000160d0: 6461 7279 2c20 7472 696d 3d74 7269 6d2c  dary, trim=trim,
-000160e0: 202a 2a6b 7761 7267 730a 2020 2020 2020   **kwargs.      
-000160f0: 2020 290a 0a20 2020 2064 6566 2063 756d    )..    def cum
-00016100: 7375 6d28 7365 6c66 2c20 6178 6973 2c20  sum(self, axis, 
-00016110: 6474 7970 653d 4e6f 6e65 2c20 6f75 743d  dtype=None, out=
-00016120: 4e6f 6e65 2c20 2a2c 206d 6574 686f 643d  None, *, method=
-00016130: 2273 6571 7565 6e74 6961 6c22 293a 0a20  "sequential"):. 
-00016140: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00016150: 2074 6865 2063 756d 756c 6174 6976 6520   the cumulative 
-00016160: 7375 6d20 6f66 2074 6865 2065 6c65 6d65  sum of the eleme
-00016170: 6e74 7320 616c 6f6e 6720 7468 6520 6769  nts along the gi
-00016180: 7665 6e20 6178 6973 2e0a 0a20 2020 2020  ven axis...     
-00016190: 2020 2052 6566 6572 2074 6f20 3a66 756e     Refer to :fun
-000161a0: 633a 6064 6173 6b2e 6172 7261 792e 6375  c:`dask.array.cu
-000161b0: 6d73 756d 6020 666f 7220 6675 6c6c 2064  msum` for full d
-000161c0: 6f63 756d 656e 7461 7469 6f6e 2e0a 0a20  ocumentation... 
-000161d0: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
-000161e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000161f0: 0a20 2020 2020 2020 2064 6173 6b2e 6172  .        dask.ar
-00016200: 7261 792e 6375 6d73 756d 203a 2065 7175  ray.cumsum : equ
-00016210: 6976 616c 656e 7420 6675 6e63 7469 6f6e  ivalent function
-00016220: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00016230: 2020 2020 2066 726f 6d20 6461 736b 2e61       from dask.a
-00016240: 7272 6179 2e72 6564 7563 7469 6f6e 7320  rray.reductions 
-00016250: 696d 706f 7274 2063 756d 7375 6d0a 0a20  import cumsum.. 
-00016260: 2020 2020 2020 2072 6574 7572 6e20 6375         return cu
-00016270: 6d73 756d 2873 656c 662c 2061 7869 732c  msum(self, axis,
-00016280: 2064 7479 7065 2c20 6f75 743d 6f75 742c   dtype, out=out,
-00016290: 206d 6574 686f 643d 6d65 7468 6f64 290a   method=method).
-000162a0: 0a20 2020 2064 6566 2063 756d 7072 6f64  .    def cumprod
-000162b0: 2873 656c 662c 2061 7869 732c 2064 7479  (self, axis, dty
-000162c0: 7065 3d4e 6f6e 652c 206f 7574 3d4e 6f6e  pe=None, out=Non
-000162d0: 652c 202a 2c20 6d65 7468 6f64 3d22 7365  e, *, method="se
-000162e0: 7175 656e 7469 616c 2229 3a0a 2020 2020  quential"):.    
-000162f0: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
-00016300: 6520 6375 6d75 6c61 7469 7665 2070 726f  e cumulative pro
-00016310: 6475 6374 206f 6620 7468 6520 656c 656d  duct of the elem
-00016320: 656e 7473 2061 6c6f 6e67 2074 6865 2067  ents along the g
-00016330: 6976 656e 2061 7869 732e 0a0a 2020 2020  iven axis...    
-00016340: 2020 2020 5265 6665 7220 746f 203a 6675      Refer to :fu
-00016350: 6e63 3a60 6461 736b 2e61 7272 6179 2e63  nc:`dask.array.c
-00016360: 756d 7072 6f64 6020 666f 7220 6675 6c6c  umprod` for full
-00016370: 2064 6f63 756d 656e 7461 7469 6f6e 2e0a   documentation..
-00016380: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-00016390: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-000163a0: 2d2d 0a20 2020 2020 2020 2064 6173 6b2e  --.        dask.
-000163b0: 6172 7261 792e 6375 6d70 726f 6420 3a20  array.cumprod : 
-000163c0: 6571 7569 7661 6c65 6e74 2066 756e 6374  equivalent funct
-000163d0: 696f 6e0a 2020 2020 2020 2020 2222 220a  ion.        """.
-000163e0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-000163f0: 6b2e 6172 7261 792e 7265 6475 6374 696f  k.array.reductio
-00016400: 6e73 2069 6d70 6f72 7420 6375 6d70 726f  ns import cumpro
-00016410: 640a 0a20 2020 2020 2020 2072 6574 7572  d..        retur
-00016420: 6e20 6375 6d70 726f 6428 7365 6c66 2c20  n cumprod(self, 
-00016430: 6178 6973 2c20 6474 7970 652c 206f 7574  axis, dtype, out
-00016440: 3d6f 7574 2c20 6d65 7468 6f64 3d6d 6574  =out, method=met
-00016450: 686f 6429 0a0a 2020 2020 6465 6620 7371  hod)..    def sq
-00016460: 7565 657a 6528 7365 6c66 2c20 6178 6973  ueeze(self, axis
-00016470: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00016480: 2222 2252 656d 6f76 6520 6178 6573 206f  """Remove axes o
-00016490: 6620 6c65 6e67 7468 206f 6e65 2066 726f  f length one fro
-000164a0: 6d20 6172 7261 792e 0a0a 2020 2020 2020  m array...      
-000164b0: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
-000164c0: 3a60 6461 736b 2e61 7272 6179 2e73 7175  :`dask.array.squ
-000164d0: 6565 7a65 6020 666f 7220 6675 6c6c 2064  eeze` for full d
-000164e0: 6f63 756d 656e 7461 7469 6f6e 2e0a 0a20  ocumentation... 
-000164f0: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
-00016500: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00016510: 0a20 2020 2020 2020 2064 6173 6b2e 6172  .        dask.ar
-00016520: 7261 792e 7371 7565 657a 6520 3a20 6571  ray.squeeze : eq
-00016530: 7569 7661 6c65 6e74 2066 756e 6374 696f  uivalent functio
-00016540: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
-00016550: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00016560: 6172 7261 792e 726f 7574 696e 6573 2069  array.routines i
-00016570: 6d70 6f72 7420 7371 7565 657a 650a 0a20  mport squeeze.. 
-00016580: 2020 2020 2020 2072 6574 7572 6e20 7371         return sq
-00016590: 7565 657a 6528 7365 6c66 2c20 6178 6973  ueeze(self, axis
-000165a0: 290a 0a20 2020 2064 6566 2072 6563 6875  )..    def rechu
-000165b0: 6e6b 280a 2020 2020 2020 2020 7365 6c66  nk(.        self
-000165c0: 2c0a 2020 2020 2020 2020 6368 756e 6b73  ,.        chunks
-000165d0: 3d22 6175 746f 222c 0a20 2020 2020 2020  ="auto",.       
-000165e0: 2074 6872 6573 686f 6c64 3d4e 6f6e 652c   threshold=None,
-000165f0: 0a20 2020 2020 2020 2062 6c6f 636b 5f73  .        block_s
-00016600: 697a 655f 6c69 6d69 743d 4e6f 6e65 2c0a  ize_limit=None,.
-00016610: 2020 2020 2020 2020 6261 6c61 6e63 653d          balance=
-00016620: 4661 6c73 652c 0a20 2020 2020 2020 206d  False,.        m
-00016630: 6574 686f 643d 4e6f 6e65 2c0a 2020 2020  ethod=None,.    
-00016640: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
-00016650: 6e76 6572 7420 626c 6f63 6b73 2069 6e20  nvert blocks in 
-00016660: 6461 736b 2061 7272 6179 2078 2066 6f72  dask array x for
-00016670: 206e 6577 2063 6875 6e6b 732e 0a0a 2020   new chunks...  
-00016680: 2020 2020 2020 5265 6665 7220 746f 203a        Refer to :
-00016690: 6675 6e63 3a60 6461 736b 2e61 7272 6179  func:`dask.array
-000166a0: 2e72 6563 6875 6e6b 6020 666f 7220 6675  .rechunk` for fu
-000166b0: 6c6c 2064 6f63 756d 656e 7461 7469 6f6e  ll documentation
-000166c0: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
-000166d0: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-000166e0: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
-000166f0: 6b2e 6172 7261 792e 7265 6368 756e 6b20  k.array.rechunk 
-00016700: 3a20 6571 7569 7661 6c65 6e74 2066 756e  : equivalent fun
-00016710: 6374 696f 6e0a 2020 2020 2020 2020 2222  ction.        ""
-00016720: 220a 2020 2020 2020 2020 6672 6f6d 2064  ".        from d
-00016730: 6173 6b2e 6172 7261 792e 7265 6368 756e  ask.array.rechun
-00016740: 6b20 696d 706f 7274 2072 6563 6875 6e6b  k import rechunk
-00016750: 2020 2320 6176 6f69 6420 6369 7263 756c    # avoid circul
-00016760: 6172 2069 6d70 6f72 740a 0a20 2020 2020  ar import..     
-00016770: 2020 2072 6574 7572 6e20 7265 6368 756e     return rechun
-00016780: 6b28 7365 6c66 2c20 6368 756e 6b73 2c20  k(self, chunks, 
-00016790: 7468 7265 7368 6f6c 642c 2062 6c6f 636b  threshold, block
-000167a0: 5f73 697a 655f 6c69 6d69 742c 2062 616c  _size_limit, bal
-000167b0: 616e 6365 2c20 6d65 7468 6f64 290a 0a20  ance, method).. 
-000167c0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-000167d0: 2064 6566 2072 6561 6c28 7365 6c66 293a   def real(self):
-000167e0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-000167f0: 736b 2e61 7272 6179 2e75 6675 6e63 2069  sk.array.ufunc i
-00016800: 6d70 6f72 7420 7265 616c 0a0a 2020 2020  mport real..    
-00016810: 2020 2020 7265 7475 726e 2072 6561 6c28      return real(
-00016820: 7365 6c66 290a 0a20 2020 2040 7072 6f70  self)..    @prop
-00016830: 6572 7479 0a20 2020 2064 6566 2069 6d61  erty.    def ima
-00016840: 6728 7365 6c66 293a 0a20 2020 2020 2020  g(self):.       
-00016850: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-00016860: 2e75 6675 6e63 2069 6d70 6f72 7420 696d  .ufunc import im
-00016870: 6167 0a0a 2020 2020 2020 2020 7265 7475  ag..        retu
-00016880: 726e 2069 6d61 6728 7365 6c66 290a 0a20  rn imag(self).. 
-00016890: 2020 2064 6566 2063 6f6e 6a28 7365 6c66     def conj(self
-000168a0: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
-000168b0: 6d70 6c65 782d 636f 6e6a 7567 6174 6520  mplex-conjugate 
-000168c0: 616c 6c20 656c 656d 656e 7473 2e0a 0a20  all elements... 
-000168d0: 2020 2020 2020 2052 6566 6572 2074 6f20         Refer to 
-000168e0: 3a66 756e 633a 6064 6173 6b2e 6172 7261  :func:`dask.arra
-000168f0: 792e 636f 6e6a 6020 666f 7220 6675 6c6c  y.conj` for full
-00016900: 2064 6f63 756d 656e 7461 7469 6f6e 2e0a   documentation..
-00016910: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-00016920: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-00016930: 2d2d 0a20 2020 2020 2020 2064 6173 6b2e  --.        dask.
-00016940: 6172 7261 792e 636f 6e6a 203a 2065 7175  array.conj : equ
-00016950: 6976 616c 656e 7420 6675 6e63 7469 6f6e  ivalent function
-00016960: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00016970: 2020 2020 2066 726f 6d20 6461 736b 2e61       from dask.a
-00016980: 7272 6179 2e75 6675 6e63 2069 6d70 6f72  rray.ufunc impor
-00016990: 7420 636f 6e6a 0a0a 2020 2020 2020 2020  t conj..        
-000169a0: 7265 7475 726e 2063 6f6e 6a28 7365 6c66  return conj(self
-000169b0: 290a 0a20 2020 2064 6566 2063 6c69 7028  )..    def clip(
-000169c0: 7365 6c66 2c20 6d69 6e3d 4e6f 6e65 2c20  self, min=None, 
-000169d0: 6d61 783d 4e6f 6e65 293a 0a20 2020 2020  max=None):.     
-000169e0: 2020 2022 2222 5265 7475 726e 2061 6e20     """Return an 
-000169f0: 6172 7261 7920 7768 6f73 6520 7661 6c75  array whose valu
-00016a00: 6573 2061 7265 206c 696d 6974 6564 2074  es are limited t
-00016a10: 6f20 6060 5b6d 696e 2c20 6d61 785d 6060  o ``[min, max]``
-00016a20: 2e0a 2020 2020 2020 2020 4f6e 6520 6f66  ..        One of
-00016a30: 206d 6178 206f 7220 6d69 6e20 6d75 7374   max or min must
-00016a40: 2062 6520 6769 7665 6e2e 0a0a 2020 2020   be given...    
-00016a50: 2020 2020 5265 6665 7220 746f 203a 6675      Refer to :fu
-00016a60: 6e63 3a60 6461 736b 2e61 7272 6179 2e63  nc:`dask.array.c
-00016a70: 6c69 7060 2066 6f72 2066 756c 6c20 646f  lip` for full do
-00016a80: 6375 6d65 6e74 6174 696f 6e2e 0a0a 2020  cumentation...  
-00016a90: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
-00016aa0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00016ab0: 2020 2020 2020 2020 6461 736b 2e61 7272          dask.arr
-00016ac0: 6179 2e63 6c69 7020 3a20 6571 7569 7661  ay.clip : equiva
-00016ad0: 6c65 6e74 2066 756e 6374 696f 6e0a 2020  lent function.  
-00016ae0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00016af0: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-00016b00: 792e 7566 756e 6320 696d 706f 7274 2063  y.ufunc import c
-00016b10: 6c69 700a 0a20 2020 2020 2020 2072 6574  lip..        ret
-00016b20: 7572 6e20 636c 6970 2873 656c 662c 206d  urn clip(self, m
-00016b30: 696e 2c20 6d61 7829 0a0a 2020 2020 6465  in, max)..    de
-00016b40: 6620 7669 6577 2873 656c 662c 2064 7479  f view(self, dty
-00016b50: 7065 3d4e 6f6e 652c 206f 7264 6572 3d22  pe=None, order="
-00016b60: 4322 293a 0a20 2020 2020 2020 2022 2222  C"):.        """
-00016b70: 4765 7420 6120 7669 6577 206f 6620 7468  Get a view of th
-00016b80: 6520 6172 7261 7920 6173 2061 206e 6577  e array as a new
-00016b90: 2064 6174 6120 7479 7065 0a0a 2020 2020   data type..    
-00016ba0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00016bb0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00016bc0: 2d0a 2020 2020 2020 2020 6474 7970 653a  -.        dtype:
-00016bd0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00016be0: 2064 7479 7065 2062 7920 7768 6963 6820   dtype by which 
-00016bf0: 746f 2076 6965 7720 7468 6520 6172 7261  to view the arra
-00016c00: 792e 0a20 2020 2020 2020 2020 2020 2054  y..            T
-00016c10: 6865 2064 6566 6175 6c74 2c20 4e6f 6e65  he default, None
-00016c20: 2c20 7265 7375 6c74 7320 696e 2074 6865  , results in the
-00016c30: 2076 6965 7720 6861 7669 6e67 2074 6865   view having the
-00016c40: 2073 616d 6520 6461 7461 2d74 7970 650a   same data-type.
-00016c50: 2020 2020 2020 2020 2020 2020 6173 2074              as t
-00016c60: 6865 206f 7269 6769 6e61 6c20 6172 7261  he original arra
-00016c70: 792e 0a20 2020 2020 2020 206f 7264 6572  y..        order
-00016c80: 3a20 7374 7269 6e67 0a20 2020 2020 2020  : string.       
-00016c90: 2020 2020 2027 4327 206f 7220 2746 2720       'C' or 'F' 
-00016ca0: 2846 6f72 7472 616e 2920 6f72 6465 7269  (Fortran) orderi
-00016cb0: 6e67 0a0a 2020 2020 2020 2020 5468 6973  ng..        This
-00016cc0: 2072 6569 6e74 6572 7072 6574 7320 7468   reinterprets th
-00016cd0: 6520 6279 7465 7320 6f66 2074 6865 2061  e bytes of the a
-00016ce0: 7272 6179 2075 6e64 6572 2061 206e 6577  rray under a new
-00016cf0: 2064 7479 7065 2e20 2049 6620 7468 6174   dtype.  If that
-00016d00: 0a20 2020 2020 2020 2064 7479 7065 2064  .        dtype d
-00016d10: 6f65 7320 6e6f 7420 6861 7665 2074 6865  oes not have the
-00016d20: 2073 616d 6520 7369 7a65 2061 7320 7468   same size as th
-00016d30: 6520 6f72 6967 696e 616c 2061 7272 6179  e original array
-00016d40: 2074 6865 6e20 7468 6520 7368 6170 650a   then the shape.
-00016d50: 2020 2020 2020 2020 7769 6c6c 2063 6861          will cha
-00016d60: 6e67 652e 0a0a 2020 2020 2020 2020 4265  nge...        Be
-00016d70: 7761 7265 2074 6861 7420 626f 7468 206e  ware that both n
-00016d80: 756d 7079 2061 6e64 2064 6173 6b2e 6172  umpy and dask.ar
-00016d90: 7261 7920 6361 6e20 6265 6861 7665 206f  ray can behave o
-00016da0: 6464 6c79 2077 6865 6e20 7461 6b69 6e67  ddly when taking
-00016db0: 0a20 2020 2020 2020 2073 6861 7065 2d63  .        shape-c
-00016dc0: 6861 6e67 696e 6720 7669 6577 7320 6f66  hanging views of
-00016dd0: 2061 7272 6179 7320 756e 6465 7220 466f   arrays under Fo
-00016de0: 7274 7261 6e20 6f72 6465 7269 6e67 2e20  rtran ordering. 
-00016df0: 2055 6e64 6572 2073 6f6d 650a 2020 2020   Under some.    
-00016e00: 2020 2020 7665 7273 696f 6e73 206f 6620      versions of 
-00016e10: 4e75 6d50 7920 7468 6973 2066 756e 6374  NumPy this funct
-00016e20: 696f 6e20 7769 6c6c 2066 6169 6c20 7768  ion will fail wh
-00016e30: 656e 2074 616b 696e 6720 7368 6170 652d  en taking shape-
-00016e40: 6368 616e 6769 6e67 0a20 2020 2020 2020  changing.       
-00016e50: 2076 6965 7773 206f 6620 466f 7274 7261   views of Fortra
-00016e60: 6e20 6f72 6465 7265 6420 6172 7261 7973  n ordered arrays
-00016e70: 2069 6620 7468 6520 6669 7273 7420 6469   if the first di
-00016e80: 6d65 6e73 696f 6e20 6861 7320 6368 756e  mension has chun
-00016e90: 6b73 206f 660a 2020 2020 2020 2020 7369  ks of.        si
-00016ea0: 7a65 206f 6e65 2e0a 2020 2020 2020 2020  ze one..        
-00016eb0: 2222 220a 2020 2020 2020 2020 6966 2064  """.        if d
-00016ec0: 7479 7065 2069 7320 4e6f 6e65 3a0a 2020  type is None:.  
-00016ed0: 2020 2020 2020 2020 2020 6474 7970 6520            dtype 
-00016ee0: 3d20 7365 6c66 2e64 7479 7065 0a20 2020  = self.dtype.   
-00016ef0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00016f00: 2020 2020 2020 2064 7479 7065 203d 206e         dtype = n
-00016f10: 702e 6474 7970 6528 6474 7970 6529 0a20  p.dtype(dtype). 
-00016f20: 2020 2020 2020 206d 756c 7420 3d20 7365         mult = se
-00016f30: 6c66 2e64 7479 7065 2e69 7465 6d73 697a  lf.dtype.itemsiz
-00016f40: 6520 2f20 6474 7970 652e 6974 656d 7369  e / dtype.itemsi
-00016f50: 7a65 0a0a 2020 2020 2020 2020 6966 206f  ze..        if o
-00016f60: 7264 6572 203d 3d20 2243 223a 0a20 2020  rder == "C":.   
-00016f70: 2020 2020 2020 2020 2063 6875 6e6b 7320           chunks 
-00016f80: 3d20 7365 6c66 2e63 6875 6e6b 735b 3a2d  = self.chunks[:-
-00016f90: 315d 202b 2028 0a20 2020 2020 2020 2020  1] + (.         
-00016fa0: 2020 2020 2020 2074 7570 6c65 2865 6e73         tuple(ens
-00016fb0: 7572 655f 696e 7428 6320 2a20 6d75 6c74  ure_int(c * mult
-00016fc0: 2920 666f 7220 6320 696e 2073 656c 662e  ) for c in self.
-00016fd0: 6368 756e 6b73 5b2d 315d 292c 0a20 2020  chunks[-1]),.   
-00016fe0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00016ff0: 2020 2065 6c69 6620 6f72 6465 7220 3d3d     elif order ==
-00017000: 2022 4622 3a0a 2020 2020 2020 2020 2020   "F":.          
-00017010: 2020 6368 756e 6b73 203d 2028 0a20 2020    chunks = (.   
-00017020: 2020 2020 2020 2020 2020 2020 2074 7570               tup
-00017030: 6c65 2865 6e73 7572 655f 696e 7428 6320  le(ensure_int(c 
-00017040: 2a20 6d75 6c74 2920 666f 7220 6320 696e  * mult) for c in
-00017050: 2073 656c 662e 6368 756e 6b73 5b30 5d29   self.chunks[0])
-00017060: 2c0a 2020 2020 2020 2020 2020 2020 2920  ,.            ) 
-00017070: 2b20 7365 6c66 2e63 6875 6e6b 735b 313a  + self.chunks[1:
-00017080: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
-00017090: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000170a0: 6520 5661 6c75 6545 7272 6f72 2822 4f72  e ValueError("Or
-000170b0: 6465 7220 6d75 7374 2062 6520 6f6e 6520  der must be one 
-000170c0: 6f66 2027 4327 206f 7220 2746 2722 290a  of 'C' or 'F'").
-000170d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000170e0: 7365 6c66 2e6d 6170 5f62 6c6f 636b 7328  self.map_blocks(
-000170f0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-00017100: 6e6b 2e76 6965 772c 2064 7479 7065 2c20  nk.view, dtype, 
-00017110: 6f72 6465 723d 6f72 6465 722c 2064 7479  order=order, dty
-00017120: 7065 3d64 7479 7065 2c20 6368 756e 6b73  pe=dtype, chunks
-00017130: 3d63 6875 6e6b 730a 2020 2020 2020 2020  =chunks.        
-00017140: 290a 0a20 2020 2064 6566 2073 7761 7061  )..    def swapa
-00017150: 7865 7328 7365 6c66 2c20 6178 6973 312c  xes(self, axis1,
-00017160: 2061 7869 7332 293a 0a20 2020 2020 2020   axis2):.       
-00017170: 2022 2222 5265 7475 726e 2061 2076 6965   """Return a vie
-00017180: 7720 6f66 2074 6865 2061 7272 6179 2077  w of the array w
-00017190: 6974 6820 6060 6178 6973 3160 6020 616e  ith ``axis1`` an
-000171a0: 6420 6060 6178 6973 3260 6020 696e 7465  d ``axis2`` inte
-000171b0: 7263 6861 6e67 6564 2e0a 0a20 2020 2020  rchanged...     
-000171c0: 2020 2052 6566 6572 2074 6f20 3a66 756e     Refer to :fun
-000171d0: 633a 6064 6173 6b2e 6172 7261 792e 7377  c:`dask.array.sw
-000171e0: 6170 6178 6573 6020 666f 7220 6675 6c6c  apaxes` for full
-000171f0: 2064 6f63 756d 656e 7461 7469 6f6e 2e0a   documentation..
-00017200: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-00017210: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-00017220: 2d2d 0a20 2020 2020 2020 2064 6173 6b2e  --.        dask.
-00017230: 6172 7261 792e 7377 6170 6178 6573 203a  array.swapaxes :
-00017240: 2065 7175 6976 616c 656e 7420 6675 6e63   equivalent func
-00017250: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
-00017260: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-00017270: 736b 2e61 7272 6179 2e72 6f75 7469 6e65  sk.array.routine
-00017280: 7320 696d 706f 7274 2073 7761 7061 7865  s import swapaxe
-00017290: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
-000172a0: 6e20 7377 6170 6178 6573 2873 656c 662c  n swapaxes(self,
-000172b0: 2061 7869 7331 2c20 6178 6973 3229 0a0a   axis1, axis2)..
-000172c0: 2020 2020 6465 6620 726f 756e 6428 7365      def round(se
-000172d0: 6c66 2c20 6465 6369 6d61 6c73 3d30 293a  lf, decimals=0):
-000172e0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-000172f0: 726e 2061 7272 6179 2077 6974 6820 6561  rn array with ea
-00017300: 6368 2065 6c65 6d65 6e74 2072 6f75 6e64  ch element round
-00017310: 6564 2074 6f20 7468 6520 6769 7665 6e20  ed to the given 
-00017320: 6e75 6d62 6572 206f 6620 6465 6369 6d61  number of decima
-00017330: 6c73 2e0a 0a20 2020 2020 2020 2052 6566  ls...        Ref
-00017340: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
-00017350: 6b2e 6172 7261 792e 726f 756e 6460 2066  k.array.round` f
-00017360: 6f72 2066 756c 6c20 646f 6375 6d65 6e74  or full document
-00017370: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00017380: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-00017390: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-000173a0: 2020 6461 736b 2e61 7272 6179 2e72 6f75    dask.array.rou
-000173b0: 6e64 203a 2065 7175 6976 616c 656e 7420  nd : equivalent 
-000173c0: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
-000173d0: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-000173e0: 6d20 6461 736b 2e61 7272 6179 2e72 6f75  m dask.array.rou
-000173f0: 7469 6e65 7320 696d 706f 7274 2072 6f75  tines import rou
-00017400: 6e64 0a0a 2020 2020 2020 2020 7265 7475  nd..        retu
-00017410: 726e 2072 6f75 6e64 2873 656c 662c 2064  rn round(self, d
-00017420: 6563 696d 616c 733d 6465 6369 6d61 6c73  ecimals=decimals
-00017430: 290a 0a20 2020 2064 6566 2063 6f70 7928  )..    def copy(
-00017440: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00017450: 2222 0a20 2020 2020 2020 2043 6f70 7920  "".        Copy 
-00017460: 6172 7261 792e 2020 5468 6973 2069 7320  array.  This is 
-00017470: 6120 6e6f 2d6f 7020 666f 7220 6461 736b  a no-op for dask
-00017480: 2e61 7272 6179 732c 2077 6869 6368 2061  .arrays, which a
-00017490: 7265 2069 6d6d 7574 6162 6c65 0a20 2020  re immutable.   
-000174a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000174b0: 2072 6574 7572 6e20 4172 7261 7928 7365   return Array(se
-000174c0: 6c66 2e64 6173 6b2c 2073 656c 662e 6e61  lf.dask, self.na
-000174d0: 6d65 2c20 7365 6c66 2e63 6875 6e6b 732c  me, self.chunks,
-000174e0: 206d 6574 613d 7365 6c66 290a 0a20 2020   meta=self)..   
-000174f0: 2064 6566 205f 5f64 6565 7063 6f70 795f   def __deepcopy_
-00017500: 5f28 7365 6c66 2c20 6d65 6d6f 293a 0a20  _(self, memo):. 
-00017510: 2020 2020 2020 2063 203d 2073 656c 662e         c = self.
-00017520: 636f 7079 2829 0a20 2020 2020 2020 206d  copy().        m
-00017530: 656d 6f5b 6964 2873 656c 6629 5d20 3d20  emo[id(self)] = 
-00017540: 630a 2020 2020 2020 2020 7265 7475 726e  c.        return
-00017550: 2063 0a0a 2020 2020 6465 6620 746f 5f64   c..    def to_d
-00017560: 656c 6179 6564 2873 656c 662c 206f 7074  elayed(self, opt
-00017570: 696d 697a 655f 6772 6170 683d 5472 7565  imize_graph=True
-00017580: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
-00017590: 6e76 6572 7420 696e 746f 2061 6e20 6172  nvert into an ar
-000175a0: 7261 7920 6f66 203a 636c 6173 733a 6064  ray of :class:`d
-000175b0: 6173 6b2e 6465 6c61 7965 642e 4465 6c61  ask.delayed.Dela
-000175c0: 7965 6460 206f 626a 6563 7473 2c20 6f6e  yed` objects, on
-000175d0: 6520 7065 7220 6368 756e 6b2e 0a0a 2020  e per chunk...  
-000175e0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-000175f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00017600: 2d2d 2d0a 2020 2020 2020 2020 6f70 7469  ---.        opti
-00017610: 6d69 7a65 5f67 7261 7068 203a 2062 6f6f  mize_graph : boo
-00017620: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-00017630: 2020 2020 2020 2020 4966 2054 7275 6520          If True 
-00017640: 5b64 6566 6175 6c74 5d2c 2074 6865 2067  [default], the g
-00017650: 7261 7068 2069 7320 6f70 7469 6d69 7a65  raph is optimize
-00017660: 6420 6265 666f 7265 2063 6f6e 7665 7274  d before convert
-00017670: 696e 6720 696e 746f 0a20 2020 2020 2020  ing into.       
-00017680: 2020 2020 203a 636c 6173 733a 6064 6173       :class:`das
-00017690: 6b2e 6465 6c61 7965 642e 4465 6c61 7965  k.delayed.Delaye
-000176a0: 6460 206f 626a 6563 7473 2e0a 0a20 2020  d` objects...   
-000176b0: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-000176c0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-000176d0: 2020 2020 2020 2064 6173 6b2e 6172 7261         dask.arra
-000176e0: 792e 6672 6f6d 5f64 656c 6179 6564 0a20  y.from_delayed. 
-000176f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00017700: 2020 206b 6579 7320 3d20 7365 6c66 2e5f     keys = self._
-00017710: 5f64 6173 6b5f 6b65 7973 5f5f 2829 0a20  _dask_keys__(). 
-00017720: 2020 2020 2020 2067 7261 7068 203d 2073         graph = s
-00017730: 656c 662e 5f5f 6461 736b 5f67 7261 7068  elf.__dask_graph
-00017740: 5f5f 2829 0a20 2020 2020 2020 206c 6179  __().        lay
-00017750: 6572 203d 2073 656c 662e 5f5f 6461 736b  er = self.__dask
-00017760: 5f6c 6179 6572 735f 5f28 295b 305d 0a20  _layers__()[0]. 
-00017770: 2020 2020 2020 2069 6620 6f70 7469 6d69         if optimi
-00017780: 7a65 5f67 7261 7068 3a0a 2020 2020 2020  ze_graph:.      
-00017790: 2020 2020 2020 6772 6170 6820 3d20 7365        graph = se
-000177a0: 6c66 2e5f 5f64 6173 6b5f 6f70 7469 6d69  lf.__dask_optimi
-000177b0: 7a65 5f5f 2867 7261 7068 2c20 6b65 7973  ze__(graph, keys
-000177c0: 2920 2023 2054 4f44 4f2c 2064 6f6e 2774  )  # TODO, don't
-000177d0: 2063 6f6c 6c61 7065 2067 7261 7068 0a20   collape graph. 
-000177e0: 2020 2020 2020 2020 2020 206c 6179 6572             layer
-000177f0: 203d 2022 6465 6c61 7965 642d 2220 2b20   = "delayed-" + 
-00017800: 7365 6c66 2e6e 616d 650a 2020 2020 2020  self.name.      
-00017810: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-00017820: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-00017830: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6c61  m_collections(la
-00017840: 7965 722c 2067 7261 7068 2c20 6465 7065  yer, graph, depe
-00017850: 6e64 656e 6369 6573 3d28 2929 0a20 2020  ndencies=()).   
-00017860: 2020 2020 204c 203d 206e 6465 6570 6d61       L = ndeepma
-00017870: 7028 7365 6c66 2e6e 6469 6d2c 206c 616d  p(self.ndim, lam
-00017880: 6264 6120 6b3a 2044 656c 6179 6564 286b  bda k: Delayed(k
-00017890: 2c20 6772 6170 682c 206c 6179 6572 3d6c  , graph, layer=l
-000178a0: 6179 6572 292c 206b 6579 7329 0a20 2020  ayer), keys).   
-000178b0: 2020 2020 2072 6574 7572 6e20 6e70 2e61       return np.a
-000178c0: 7272 6179 284c 2c20 6474 7970 653d 6f62  rray(L, dtype=ob
-000178d0: 6a65 6374 290a 0a20 2020 2064 6566 2072  ject)..    def r
-000178e0: 6570 6561 7428 7365 6c66 2c20 7265 7065  epeat(self, repe
-000178f0: 6174 732c 2061 7869 733d 4e6f 6e65 293a  ats, axis=None):
-00017900: 0a20 2020 2020 2020 2022 2222 5265 7065  .        """Repe
-00017910: 6174 2065 6c65 6d65 6e74 7320 6f66 2061  at elements of a
-00017920: 6e20 6172 7261 792e 0a0a 2020 2020 2020  n array...      
-00017930: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
-00017940: 3a60 6461 736b 2e61 7272 6179 2e72 6570  :`dask.array.rep
-00017950: 6561 7460 2066 6f72 2066 756c 6c20 646f  eat` for full do
-00017960: 6375 6d65 6e74 6174 696f 6e2e 0a0a 2020  cumentation...  
-00017970: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
-00017980: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00017990: 2020 2020 2020 2020 6461 736b 2e61 7272          dask.arr
-000179a0: 6179 2e72 6570 6561 7420 3a20 6571 7569  ay.repeat : equi
-000179b0: 7661 6c65 6e74 2066 756e 6374 696f 6e0a  valent function.
-000179c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000179d0: 2020 2020 6672 6f6d 2064 6173 6b2e 6172      from dask.ar
-000179e0: 7261 792e 6372 6561 7469 6f6e 2069 6d70  ray.creation imp
-000179f0: 6f72 7420 7265 7065 6174 0a0a 2020 2020  ort repeat..    
-00017a00: 2020 2020 7265 7475 726e 2072 6570 6561      return repea
-00017a10: 7428 7365 6c66 2c20 7265 7065 6174 732c  t(self, repeats,
-00017a20: 2061 7869 733d 6178 6973 290a 0a20 2020   axis=axis)..   
-00017a30: 2064 6566 206e 6f6e 7a65 726f 2873 656c   def nonzero(sel
-00017a40: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-00017a50: 6574 7572 6e20 7468 6520 696e 6469 6365  eturn the indice
-00017a60: 7320 6f66 2074 6865 2065 6c65 6d65 6e74  s of the element
-00017a70: 7320 7468 6174 2061 7265 206e 6f6e 2d7a  s that are non-z
-00017a80: 6572 6f2e 0a0a 2020 2020 2020 2020 5265  ero...        Re
-00017a90: 6665 7220 746f 203a 6675 6e63 3a60 6461  fer to :func:`da
-00017aa0: 736b 2e61 7272 6179 2e6e 6f6e 7a65 726f  sk.array.nonzero
-00017ab0: 6020 666f 7220 6675 6c6c 2064 6f63 756d  ` for full docum
-00017ac0: 656e 7461 7469 6f6e 2e0a 0a20 2020 2020  entation...     
-00017ad0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-00017ae0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00017af0: 2020 2020 2064 6173 6b2e 6172 7261 792e       dask.array.
-00017b00: 6e6f 6e7a 6572 6f20 3a20 6571 7569 7661  nonzero : equiva
-00017b10: 6c65 6e74 2066 756e 6374 696f 6e0a 2020  lent function.  
-00017b20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00017b30: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-00017b40: 792e 726f 7574 696e 6573 2069 6d70 6f72  y.routines impor
-00017b50: 7420 6e6f 6e7a 6572 6f0a 0a20 2020 2020  t nonzero..     
-00017b60: 2020 2072 6574 7572 6e20 6e6f 6e7a 6572     return nonzer
-00017b70: 6f28 7365 6c66 290a 0a20 2020 2064 6566  o(self)..    def
-00017b80: 2074 6f5f 7a61 7272 2873 656c 662c 202a   to_zarr(self, *
-00017b90: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-00017ba0: 0a20 2020 2020 2020 2022 2222 5361 7665  .        """Save
-00017bb0: 2061 7272 6179 2074 6f20 7468 6520 7a61   array to the za
-00017bc0: 7272 2073 746f 7261 6765 2066 6f72 6d61  rr storage forma
-00017bd0: 740a 0a20 2020 2020 2020 2053 6565 2068  t..        See h
-00017be0: 7474 7073 3a2f 2f7a 6172 722e 7265 6164  ttps://zarr.read
-00017bf0: 7468 6564 6f63 732e 696f 2066 6f72 2064  thedocs.io for d
-00017c00: 6574 6169 6c73 2061 626f 7574 2074 6865  etails about the
-00017c10: 2066 6f72 6d61 742e 0a0a 2020 2020 2020   format...      
-00017c20: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
-00017c30: 3a60 6461 736b 2e61 7272 6179 2e74 6f5f  :`dask.array.to_
-00017c40: 7a61 7272 6020 666f 7220 6675 6c6c 2064  zarr` for full d
-00017c50: 6f63 756d 656e 7461 7469 6f6e 2e0a 0a20  ocumentation... 
-00017c60: 2020 2020 2020 2053 6565 2061 6c73 6f0a         See also.
-00017c70: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00017c80: 0a20 2020 2020 2020 2064 6173 6b2e 6172  .        dask.ar
-00017c90: 7261 792e 746f 5f7a 6172 7220 3a20 6571  ray.to_zarr : eq
-00017ca0: 7569 7661 6c65 6e74 2066 756e 6374 696f  uivalent functio
-00017cb0: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
-00017cc0: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
-00017cd0: 7a61 7272 2873 656c 662c 202a 6172 6773  zarr(self, *args
-00017ce0: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
-00017cf0: 2064 6566 2074 6f5f 7469 6c65 6462 2873   def to_tiledb(s
-00017d00: 656c 662c 2075 7269 2c20 2a61 7267 732c  elf, uri, *args,
-00017d10: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00017d20: 2020 2020 2222 2253 6176 6520 6172 7261      """Save arra
-00017d30: 7920 746f 2074 6865 2054 696c 6544 4220  y to the TileDB 
-00017d40: 7374 6f72 6167 6520 6d61 6e61 6765 720a  storage manager.
-00017d50: 0a20 2020 2020 2020 2053 6565 2068 7474  .        See htt
-00017d60: 7073 3a2f 2f64 6f63 732e 7469 6c65 6462  ps://docs.tiledb
-00017d70: 2e69 6f20 666f 7220 6465 7461 696c 7320  .io for details 
-00017d80: 6162 6f75 7420 7468 6520 666f 726d 6174  about the format
-00017d90: 2061 6e64 2065 6e67 696e 652e 0a0a 2020   and engine...  
-00017da0: 2020 2020 2020 5365 6520 6675 6e63 7469        See functi
-00017db0: 6f6e 203a 6675 6e63 3a60 6461 736b 2e61  on :func:`dask.a
-00017dc0: 7272 6179 2e74 6f5f 7469 6c65 6462 6020  rray.to_tiledb` 
-00017dd0: 666f 7220 6172 6775 6d65 6e74 2064 6f63  for argument doc
-00017de0: 756d 656e 7461 7469 6f6e 2e0a 0a20 2020  umentation...   
-00017df0: 2020 2020 2053 6565 2061 6c73 6f0a 2020       See also.  
-00017e00: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-00017e10: 2020 2020 2020 2064 6173 6b2e 6172 7261         dask.arra
-00017e20: 792e 746f 5f74 696c 6564 6220 3a20 6571  y.to_tiledb : eq
-00017e30: 7569 7661 6c65 6e74 2066 756e 6374 696f  uivalent functio
-00017e40: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
-00017e50: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00017e60: 6172 7261 792e 7469 6c65 6462 5f69 6f20  array.tiledb_io 
-00017e70: 696d 706f 7274 2074 6f5f 7469 6c65 6462  import to_tiledb
-00017e80: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00017e90: 2074 6f5f 7469 6c65 6462 2873 656c 662c   to_tiledb(self,
-00017ea0: 2075 7269 2c20 2a61 7267 732c 202a 2a6b   uri, *args, **k
-00017eb0: 7761 7267 7329 0a0a 0a64 6566 2065 6e73  wargs)...def ens
-00017ec0: 7572 655f 696e 7428 6629 3a0a 2020 2020  ure_int(f):.    
-00017ed0: 6920 3d20 696e 7428 6629 0a20 2020 2069  i = int(f).    i
-00017ee0: 6620 6920 213d 2066 3a0a 2020 2020 2020  f i != f:.      
-00017ef0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00017f00: 6f72 2822 436f 756c 6420 6e6f 7420 636f  or("Could not co
-00017f10: 6572 6365 2025 6620 746f 2069 6e74 6567  erce %f to integ
-00017f20: 6572 2220 2520 6629 0a20 2020 2072 6574  er" % f).    ret
-00017f30: 7572 6e20 690a 0a0a 6465 6620 6e6f 726d  urn i...def norm
-00017f40: 616c 697a 655f 6368 756e 6b73 2863 6875  alize_chunks(chu
-00017f50: 6e6b 732c 2073 6861 7065 3d4e 6f6e 652c  nks, shape=None,
-00017f60: 206c 696d 6974 3d4e 6f6e 652c 2064 7479   limit=None, dty
-00017f70: 7065 3d4e 6f6e 652c 2070 7265 7669 6f75  pe=None, previou
-00017f80: 735f 6368 756e 6b73 3d4e 6f6e 6529 3a0a  s_chunks=None):.
-00017f90: 2020 2020 2222 224e 6f72 6d61 6c69 7a65      """Normalize
-00017fa0: 2063 6875 6e6b 7320 746f 2074 7570 6c65   chunks to tuple
-00017fb0: 206f 6620 7475 706c 6573 0a0a 2020 2020   of tuples..    
-00017fc0: 5468 6973 2074 616b 6573 2069 6e20 6120  This takes in a 
-00017fd0: 7661 7269 6574 7920 6f66 2069 6e70 7574  variety of input
-00017fe0: 2074 7970 6573 2061 6e64 2069 6e66 6f72   types and infor
-00017ff0: 6d61 7469 6f6e 2061 6e64 2070 726f 6475  mation and produ
-00018000: 6365 7320 6120 6675 6c6c 0a20 2020 2074  ces a full.    t
-00018010: 7570 6c65 2d6f 662d 7475 706c 6573 2072  uple-of-tuples r
-00018020: 6573 756c 7420 666f 7220 6368 756e 6b73  esult for chunks
-00018030: 2c20 7375 6974 6162 6c65 2074 6f20 6265  , suitable to be
-00018040: 2070 6173 7365 6420 746f 2041 7272 6179   passed to Array
-00018050: 206f 720a 2020 2020 7265 6368 756e 6b20   or.    rechunk 
-00018060: 6f72 2061 6e79 206f 7468 6572 206f 7065  or any other ope
-00018070: 7261 7469 6f6e 2074 6861 7420 6372 6561  ration that crea
-00018080: 7465 7320 6120 4461 736b 2061 7272 6179  tes a Dask array
-00018090: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-000180a0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-000180b0: 0a20 2020 2063 6875 6e6b 733a 2074 7570  .    chunks: tup
-000180c0: 6c65 2c20 696e 742c 2064 6963 742c 206f  le, int, dict, o
-000180d0: 7220 7374 7269 6e67 0a20 2020 2020 2020  r string.       
-000180e0: 2054 6865 2063 6875 6e6b 7320 746f 2062   The chunks to b
-000180f0: 6520 6e6f 726d 616c 697a 6564 2e20 2053  e normalized.  S
-00018100: 6565 2065 7861 6d70 6c65 7320 6265 6c6f  ee examples belo
-00018110: 7720 666f 7220 6d6f 7265 2064 6574 6169  w for more detai
-00018120: 6c73 0a20 2020 2073 6861 7065 3a20 5475  ls.    shape: Tu
-00018130: 706c 655b 696e 745d 0a20 2020 2020 2020  ple[int].       
-00018140: 2054 6865 2073 6861 7065 206f 6620 7468   The shape of th
-00018150: 6520 6172 7261 790a 2020 2020 6c69 6d69  e array.    limi
-00018160: 743a 2069 6e74 2028 6f70 7469 6f6e 616c  t: int (optional
-00018170: 290a 2020 2020 2020 2020 5468 6520 6d61  ).        The ma
-00018180: 7869 6d75 6d20 626c 6f63 6b20 7369 7a65  ximum block size
-00018190: 2074 6f20 7461 7267 6574 2069 6e20 6279   to target in by
-000181a0: 7465 732c 0a20 2020 2020 2020 2069 6620  tes,.        if 
-000181b0: 6672 6565 646f 6d20 6973 2067 6976 656e  freedom is given
-000181c0: 2074 6f20 6368 6f6f 7365 0a20 2020 2064   to choose.    d
-000181d0: 7479 7065 3a20 6e70 2e64 7479 7065 0a20  type: np.dtype. 
-000181e0: 2020 2070 7265 7669 6f75 735f 6368 756e     previous_chun
-000181f0: 6b73 3a20 5475 706c 655b 5475 706c 655b  ks: Tuple[Tuple[
-00018200: 696e 745d 5d20 6f70 7469 6f6e 616c 0a20  int]] optional. 
-00018210: 2020 2020 2020 2043 6875 6e6b 7320 6672         Chunks fr
-00018220: 6f6d 2061 2070 7265 7669 6f75 7320 6172  om a previous ar
-00018230: 7261 7920 7468 6174 2077 6520 7368 6f75  ray that we shou
-00018240: 6c64 2075 7365 2066 6f72 2069 6e73 7069  ld use for inspi
-00018250: 7261 7469 6f6e 2077 6865 6e0a 2020 2020  ration when.    
-00018260: 2020 2020 7265 6368 756e 6b69 6e67 2061      rechunking a
-00018270: 7574 6f20 6469 6d65 6e73 696f 6e73 2e20  uto dimensions. 
-00018280: 2049 6620 6e6f 7420 7072 6f76 6964 6564   If not provided
-00018290: 2062 7574 2061 7574 6f2d 6368 756e 6b69   but auto-chunki
-000182a0: 6e67 2065 7869 7374 730a 2020 2020 2020  ng exists.      
-000182b0: 2020 7468 656e 2061 7574 6f2d 6469 6d65    then auto-dime
-000182c0: 6e73 696f 6e73 2077 696c 6c20 7072 6566  nsions will pref
-000182d0: 6572 2073 7175 6172 652d 6c69 6b65 2063  er square-like c
-000182e0: 6875 6e6b 2073 6861 7065 732e 0a0a 2020  hunk shapes...  
-000182f0: 2020 4578 616d 706c 6573 0a20 2020 202d    Examples.    -
-00018300: 2d2d 2d2d 2d2d 2d0a 2020 2020 5370 6563  -------.    Spec
-00018310: 6966 7920 756e 6966 6f72 6d20 6368 756e  ify uniform chun
-00018320: 6b20 7369 7a65 730a 0a20 2020 203e 3e3e  k sizes..    >>>
-00018330: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-00018340: 2e63 6f72 6520 696d 706f 7274 206e 6f72  .core import nor
-00018350: 6d61 6c69 7a65 5f63 6875 6e6b 730a 2020  malize_chunks.  
-00018360: 2020 3e3e 3e20 6e6f 726d 616c 697a 655f    >>> normalize_
-00018370: 6368 756e 6b73 2828 322c 2032 292c 2073  chunks((2, 2), s
-00018380: 6861 7065 3d28 352c 2036 2929 0a20 2020  hape=(5, 6)).   
-00018390: 2028 2832 2c20 322c 2031 292c 2028 322c   ((2, 2, 1), (2,
-000183a0: 2032 2c20 3229 290a 0a20 2020 2041 6c73   2, 2))..    Als
-000183b0: 6f20 7061 7373 6573 2074 6872 6f75 6768  o passes through
-000183c0: 2066 756c 6c79 2065 7870 6c69 6369 7420   fully explicit 
-000183d0: 7475 706c 652d 6f66 2d74 7570 6c65 730a  tuple-of-tuples.
-000183e0: 0a20 2020 203e 3e3e 206e 6f72 6d61 6c69  .    >>> normali
-000183f0: 7a65 5f63 6875 6e6b 7328 2828 322c 2032  ze_chunks(((2, 2
-00018400: 2c20 3129 2c20 2832 2c20 322c 2032 2929  , 1), (2, 2, 2))
-00018410: 2c20 7368 6170 653d 2835 2c20 3629 290a  , shape=(5, 6)).
-00018420: 2020 2020 2828 322c 2032 2c20 3129 2c20      ((2, 2, 1), 
-00018430: 2832 2c20 322c 2032 2929 0a0a 2020 2020  (2, 2, 2))..    
-00018440: 436c 6561 6e73 2075 7020 6c69 7374 7320  Cleans up lists 
-00018450: 746f 2074 7570 6c65 730a 0a20 2020 203e  to tuples..    >
-00018460: 3e3e 206e 6f72 6d61 6c69 7a65 5f63 6875  >> normalize_chu
-00018470: 6e6b 7328 5b5b 322c 2032 5d2c 205b 332c  nks([[2, 2], [3,
-00018480: 2033 5d5d 290a 2020 2020 2828 322c 2032   3]]).    ((2, 2
-00018490: 292c 2028 332c 2033 2929 0a0a 2020 2020  ), (3, 3))..    
-000184a0: 4578 7061 6e64 7320 696e 7465 6765 7220  Expands integer 
-000184b0: 696e 7075 7473 2031 3020 2d3e 2028 3130  inputs 10 -> (10
-000184c0: 2c20 3130 290a 0a20 2020 203e 3e3e 206e  , 10)..    >>> n
-000184d0: 6f72 6d61 6c69 7a65 5f63 6875 6e6b 7328  ormalize_chunks(
-000184e0: 3130 2c20 7368 6170 653d 2833 302c 2035  10, shape=(30, 5
-000184f0: 2929 0a20 2020 2028 2831 302c 2031 302c  )).    ((10, 10,
-00018500: 2031 3029 2c20 2835 2c29 290a 0a20 2020   10), (5,))..   
-00018510: 2045 7870 616e 6473 2064 6963 7420 696e   Expands dict in
-00018520: 7075 7473 0a0a 2020 2020 3e3e 3e20 6e6f  puts..    >>> no
-00018530: 726d 616c 697a 655f 6368 756e 6b73 287b  rmalize_chunks({
-00018540: 303a 2032 2c20 313a 2033 7d2c 2073 6861  0: 2, 1: 3}, sha
-00018550: 7065 3d28 362c 2036 2929 0a20 2020 2028  pe=(6, 6)).    (
-00018560: 2832 2c20 322c 2032 292c 2028 332c 2033  (2, 2, 2), (3, 3
-00018570: 2929 0a0a 2020 2020 5468 6520 7661 6c75  ))..    The valu
-00018580: 6573 202d 3120 616e 6420 4e6f 6e65 2067  es -1 and None g
-00018590: 6574 206d 6170 7065 6420 746f 2066 756c  et mapped to ful
-000185a0: 6c20 7369 7a65 0a0a 2020 2020 3e3e 3e20  l size..    >>> 
-000185b0: 6e6f 726d 616c 697a 655f 6368 756e 6b73  normalize_chunks
-000185c0: 2828 352c 202d 3129 2c20 7368 6170 653d  ((5, -1), shape=
-000185d0: 2831 302c 2031 3029 290a 2020 2020 2828  (10, 10)).    ((
-000185e0: 352c 2035 292c 2028 3130 2c29 290a 0a20  5, 5), (10,)).. 
-000185f0: 2020 2055 7365 2074 6865 2076 616c 7565     Use the value
-00018600: 2022 6175 746f 2220 746f 2061 7574 6f6d   "auto" to autom
-00018610: 6174 6963 616c 6c79 2064 6574 6572 6d69  atically determi
-00018620: 6e65 2063 6875 6e6b 2073 697a 6573 2061  ne chunk sizes a
-00018630: 6c6f 6e67 2063 6572 7461 696e 0a20 2020  long certain.   
-00018640: 2064 696d 656e 7369 6f6e 732e 2020 5468   dimensions.  Th
-00018650: 6973 2075 7365 7320 7468 6520 6060 6c69  is uses the ``li
-00018660: 6d69 743d 6060 2061 6e64 2060 6064 7479  mit=`` and ``dty
-00018670: 7065 3d60 6020 6b65 7977 6f72 6473 2074  pe=`` keywords t
-00018680: 6f0a 2020 2020 6465 7465 726d 696e 6520  o.    determine 
-00018690: 686f 7720 6c61 7267 6520 746f 206d 616b  how large to mak
-000186a0: 6520 7468 6520 6368 756e 6b73 2e20 2054  e the chunks.  T
-000186b0: 6865 2074 6572 6d20 2261 7574 6f22 2063  he term "auto" c
-000186c0: 616e 2062 6520 7573 6564 0a20 2020 2061  an be used.    a
-000186d0: 6e79 7768 6572 6520 616e 2069 6e74 6567  nywhere an integ
-000186e0: 6572 2063 616e 2062 6520 7573 6564 2e20  er can be used. 
-000186f0: 2053 6565 2061 7272 6179 2063 6875 6e6b   See array chunk
-00018700: 696e 6720 646f 6375 6d65 6e74 6174 696f  ing documentatio
-00018710: 6e20 666f 7220 6d6f 7265 0a20 2020 2069  n for more.    i
-00018720: 6e66 6f72 6d61 7469 6f6e 2e0a 0a20 2020  nformation...   
-00018730: 203e 3e3e 206e 6f72 6d61 6c69 7a65 5f63   >>> normalize_c
-00018740: 6875 6e6b 7328 2822 6175 746f 222c 292c  hunks(("auto",),
-00018750: 2073 6861 7065 3d28 3230 2c29 2c20 6c69   shape=(20,), li
-00018760: 6d69 743d 352c 2064 7479 7065 3d27 7569  mit=5, dtype='ui
-00018770: 6e74 3827 290a 2020 2020 2828 352c 2035  nt8').    ((5, 5
-00018780: 2c20 352c 2035 292c 290a 0a20 2020 2059  , 5, 5),)..    Y
-00018790: 6f75 2063 616e 2061 6c73 6f20 7573 6520  ou can also use 
-000187a0: 6279 7465 2073 697a 6573 2028 7365 6520  byte sizes (see 
-000187b0: 3a66 756e 633a 6064 6173 6b2e 7574 696c  :func:`dask.util
-000187c0: 732e 7061 7273 655f 6279 7465 7360 2920  s.parse_bytes`) 
-000187d0: 696e 2070 6c61 6365 206f 660a 2020 2020  in place of.    
-000187e0: 2261 7574 6f22 2074 6f20 6173 6b20 666f  "auto" to ask fo
-000187f0: 7220 6120 7061 7274 6963 756c 6172 2073  r a particular s
-00018800: 697a 650a 0a20 2020 203e 3e3e 206e 6f72  ize..    >>> nor
-00018810: 6d61 6c69 7a65 5f63 6875 6e6b 7328 2231  malize_chunks("1
-00018820: 6b69 4222 2c20 7368 6170 653d 2832 3030  kiB", shape=(200
-00018830: 302c 292c 2064 7479 7065 3d27 666c 6f61  0,), dtype='floa
-00018840: 7433 3227 290a 2020 2020 2828 3235 362c  t32').    ((256,
-00018850: 2032 3536 2c20 3235 362c 2032 3536 2c20   256, 256, 256, 
-00018860: 3235 362c 2032 3536 2c20 3235 362c 2032  256, 256, 256, 2
-00018870: 3038 292c 290a 0a20 2020 2052 6573 7065  08),)..    Respe
-00018880: 6374 7320 6e75 6c6c 2064 696d 656e 7369  cts null dimensi
-00018890: 6f6e 730a 0a20 2020 203e 3e3e 206e 6f72  ons..    >>> nor
-000188a0: 6d61 6c69 7a65 5f63 6875 6e6b 7328 2829  malize_chunks(()
-000188b0: 2c20 7368 6170 653d 2830 2c20 3029 290a  , shape=(0, 0)).
-000188c0: 2020 2020 2828 302c 292c 2028 302c 2929      ((0,), (0,))
-000188d0: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
-000188e0: 6474 7970 6520 616e 6420 6e6f 7420 6973  dtype and not is
-000188f0: 696e 7374 616e 6365 2864 7479 7065 2c20  instance(dtype, 
-00018900: 6e70 2e64 7479 7065 293a 0a20 2020 2020  np.dtype):.     
-00018910: 2020 2064 7479 7065 203d 206e 702e 6474     dtype = np.dt
-00018920: 7970 6528 6474 7970 6529 0a20 2020 2069  ype(dtype).    i
-00018930: 6620 6368 756e 6b73 2069 7320 4e6f 6e65  f chunks is None
-00018940: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-00018950: 5661 6c75 6545 7272 6f72 2843 4855 4e4b  ValueError(CHUNK
-00018960: 535f 4e4f 4e45 5f45 5252 4f52 5f4d 4553  S_NONE_ERROR_MES
-00018970: 5341 4745 290a 2020 2020 6966 2069 7369  SAGE).    if isi
-00018980: 6e73 7461 6e63 6528 6368 756e 6b73 2c20  nstance(chunks, 
-00018990: 6c69 7374 293a 0a20 2020 2020 2020 2063  list):.        c
-000189a0: 6875 6e6b 7320 3d20 7475 706c 6528 6368  hunks = tuple(ch
-000189b0: 756e 6b73 290a 2020 2020 6966 2069 7369  unks).    if isi
-000189c0: 6e73 7461 6e63 6528 6368 756e 6b73 2c20  nstance(chunks, 
-000189d0: 284e 756d 6265 722c 2073 7472 2929 3a0a  (Number, str)):.
-000189e0: 2020 2020 2020 2020 6368 756e 6b73 203d          chunks =
-000189f0: 2028 6368 756e 6b73 2c29 202a 206c 656e   (chunks,) * len
-00018a00: 2873 6861 7065 290a 2020 2020 6966 2069  (shape).    if i
-00018a10: 7369 6e73 7461 6e63 6528 6368 756e 6b73  sinstance(chunks
-00018a20: 2c20 6469 6374 293a 0a20 2020 2020 2020  , dict):.       
-00018a30: 2063 6875 6e6b 7320 3d20 7475 706c 6528   chunks = tuple(
-00018a40: 6368 756e 6b73 2e67 6574 2869 2c20 4e6f  chunks.get(i, No
-00018a50: 6e65 2920 666f 7220 6920 696e 2072 616e  ne) for i in ran
-00018a60: 6765 286c 656e 2873 6861 7065 2929 290a  ge(len(shape))).
-00018a70: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00018a80: 6528 6368 756e 6b73 2c20 6e70 2e6e 6461  e(chunks, np.nda
-00018a90: 7272 6179 293a 0a20 2020 2020 2020 2063  rray):.        c
-00018aa0: 6875 6e6b 7320 3d20 6368 756e 6b73 2e74  hunks = chunks.t
-00018ab0: 6f6c 6973 7428 290a 2020 2020 6966 206e  olist().    if n
-00018ac0: 6f74 2063 6875 6e6b 7320 616e 6420 7368  ot chunks and sh
-00018ad0: 6170 6520 616e 6420 616c 6c28 7320 3d3d  ape and all(s ==
-00018ae0: 2030 2066 6f72 2073 2069 6e20 7368 6170   0 for s in shap
-00018af0: 6529 3a0a 2020 2020 2020 2020 6368 756e  e):.        chun
-00018b00: 6b73 203d 2028 2830 2c29 2c29 202a 206c  ks = ((0,),) * l
-00018b10: 656e 2873 6861 7065 290a 0a20 2020 2069  en(shape)..    i
-00018b20: 6620 280a 2020 2020 2020 2020 7368 6170  f (.        shap
-00018b30: 650a 2020 2020 2020 2020 616e 6420 6c65  e.        and le
-00018b40: 6e28 7368 6170 6529 203d 3d20 310a 2020  n(shape) == 1.  
-00018b50: 2020 2020 2020 616e 6420 6c65 6e28 6368        and len(ch
-00018b60: 756e 6b73 2920 3e20 310a 2020 2020 2020  unks) > 1.      
-00018b70: 2020 616e 6420 616c 6c28 6973 696e 7374    and all(isinst
-00018b80: 616e 6365 2863 2c20 284e 756d 6265 722c  ance(c, (Number,
-00018b90: 2073 7472 2929 2066 6f72 2063 2069 6e20   str)) for c in 
-00018ba0: 6368 756e 6b73 290a 2020 2020 293a 0a20  chunks).    ):. 
-00018bb0: 2020 2020 2020 2063 6875 6e6b 7320 3d20         chunks = 
-00018bc0: 2863 6875 6e6b 732c 290a 0a20 2020 2069  (chunks,)..    i
-00018bd0: 6620 7368 6170 6520 616e 6420 6c65 6e28  f shape and len(
-00018be0: 6368 756e 6b73 2920 213d 206c 656e 2873  chunks) != len(s
-00018bf0: 6861 7065 293a 0a20 2020 2020 2020 2072  hape):.        r
-00018c00: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00018c10: 0a20 2020 2020 2020 2020 2020 2022 4368  .            "Ch
-00018c20: 756e 6b73 2061 6e64 2073 6861 7065 206d  unks and shape m
-00018c30: 7573 7420 6265 206f 6620 7468 6520 7361  ust be of the sa
-00018c40: 6d65 206c 656e 6774 682f 6469 6d65 6e73  me length/dimens
-00018c50: 696f 6e2e 2022 0a20 2020 2020 2020 2020  ion. ".         
-00018c60: 2020 2022 476f 7420 6368 756e 6b73 3d25     "Got chunks=%
-00018c70: 732c 2073 6861 7065 3d25 7322 2025 2028  s, shape=%s" % (
-00018c80: 6368 756e 6b73 2c20 7368 6170 6529 0a20  chunks, shape). 
-00018c90: 2020 2020 2020 2029 0a20 2020 2069 6620         ).    if 
-00018ca0: 2d31 2069 6e20 6368 756e 6b73 206f 7220  -1 in chunks or 
-00018cb0: 4e6f 6e65 2069 6e20 6368 756e 6b73 3a0a  None in chunks:.
-00018cc0: 2020 2020 2020 2020 6368 756e 6b73 203d          chunks =
-00018cd0: 2074 7570 6c65 2873 2069 6620 6320 3d3d   tuple(s if c ==
-00018ce0: 202d 3120 6f72 2063 2069 7320 4e6f 6e65   -1 or c is None
-00018cf0: 2065 6c73 6520 6320 666f 7220 632c 2073   else c for c, s
-00018d00: 2069 6e20 7a69 7028 6368 756e 6b73 2c20   in zip(chunks, 
-00018d10: 7368 6170 6529 290a 0a20 2020 2023 2049  shape))..    # I
-00018d20: 6620 7370 6563 6966 7969 6e67 2063 6875  f specifying chu
-00018d30: 6e6b 2073 697a 6520 696e 2062 7974 6573  nk size in bytes
-00018d40: 2c20 7573 6520 7468 6174 2076 616c 7565  , use that value
-00018d50: 2074 6f20 7365 7420 7468 6520 6c69 6d69   to set the limi
-00018d60: 742e 0a20 2020 2023 2056 6572 6966 7920  t..    # Verify 
-00018d70: 7468 6572 6520 6973 206f 6e6c 7920 6f6e  there is only on
-00018d80: 6520 636f 6e73 6973 7465 6e74 2076 616c  e consistent val
-00018d90: 7565 206f 6620 6c69 6d69 7420 6f72 2063  ue of limit or c
-00018da0: 6875 6e6b 2d62 7974 6573 2075 7365 642e  hunk-bytes used.
-00018db0: 0a20 2020 2066 6f72 2063 2069 6e20 6368  .    for c in ch
-00018dc0: 756e 6b73 3a0a 2020 2020 2020 2020 6966  unks:.        if
-00018dd0: 2069 7369 6e73 7461 6e63 6528 632c 2073   isinstance(c, s
-00018de0: 7472 2920 616e 6420 6320 213d 2022 6175  tr) and c != "au
-00018df0: 746f 223a 0a20 2020 2020 2020 2020 2020  to":.           
-00018e00: 2070 6172 7365 6420 3d20 7061 7273 655f   parsed = parse_
-00018e10: 6279 7465 7328 6329 0a20 2020 2020 2020  bytes(c).       
-00018e20: 2020 2020 2069 6620 6c69 6d69 7420 6973       if limit is
-00018e30: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00018e40: 2020 2020 2020 206c 696d 6974 203d 2070         limit = p
-00018e50: 6172 7365 640a 2020 2020 2020 2020 2020  arsed.          
-00018e60: 2020 656c 6966 2070 6172 7365 6420 213d    elif parsed !=
-00018e70: 206c 696d 6974 3a0a 2020 2020 2020 2020   limit:.        
-00018e80: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00018e90: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00018ea0: 2020 2020 2020 2020 2020 2020 2020 224f                "O
-00018eb0: 6e6c 7920 6f6e 6520 636f 6e73 6973 7465  nly one consiste
-00018ec0: 6e74 2076 616c 7565 206f 6620 6c69 6d69  nt value of limi
-00018ed0: 7420 6f72 2063 6875 6e6b 2069 7320 616c  t or chunk is al
-00018ee0: 6c6f 7765 642e 220a 2020 2020 2020 2020  lowed.".        
-00018ef0: 2020 2020 2020 2020 2020 2020 2255 7365              "Use
-00018f00: 6420 2573 2021 3d20 2573 2220 2520 2870  d %s != %s" % (p
-00018f10: 6172 7365 642c 206c 696d 6974 290a 2020  arsed, limit).  
-00018f20: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00018f30: 2020 2020 2320 5375 6273 7469 7475 7465      # Substitute
-00018f40: 2062 7974 6520 6c69 6d69 7473 2077 6974   byte limits wit
-00018f50: 6820 2761 7574 6f27 206e 6f77 2074 6861  h 'auto' now tha
-00018f60: 7420 6c69 6d69 7420 6973 2073 6574 2e0a  t limit is set..
-00018f70: 2020 2020 6368 756e 6b73 203d 2074 7570      chunks = tup
-00018f80: 6c65 2822 6175 746f 2220 6966 2069 7369  le("auto" if isi
-00018f90: 6e73 7461 6e63 6528 632c 2073 7472 2920  nstance(c, str) 
-00018fa0: 616e 6420 6320 213d 2022 6175 746f 2220  and c != "auto" 
-00018fb0: 656c 7365 2063 2066 6f72 2063 2069 6e20  else c for c in 
-00018fc0: 6368 756e 6b73 290a 0a20 2020 2069 6620  chunks)..    if 
-00018fd0: 616e 7928 6320 3d3d 2022 6175 746f 2220  any(c == "auto" 
-00018fe0: 666f 7220 6320 696e 2063 6875 6e6b 7329  for c in chunks)
-00018ff0: 3a0a 2020 2020 2020 2020 6368 756e 6b73  :.        chunks
-00019000: 203d 2061 7574 6f5f 6368 756e 6b73 2863   = auto_chunks(c
-00019010: 6875 6e6b 732c 2073 6861 7065 2c20 6c69  hunks, shape, li
-00019020: 6d69 742c 2064 7479 7065 2c20 7072 6576  mit, dtype, prev
-00019030: 696f 7573 5f63 6875 6e6b 7329 0a0a 2020  ious_chunks)..  
-00019040: 2020 6966 2073 6861 7065 2069 7320 6e6f    if shape is no
-00019050: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00019060: 6368 756e 6b73 203d 2074 7570 6c65 2863  chunks = tuple(c
-00019070: 2069 6620 6320 6e6f 7420 696e 207b 4e6f   if c not in {No
-00019080: 6e65 2c20 2d31 7d20 656c 7365 2073 2066  ne, -1} else s f
-00019090: 6f72 2063 2c20 7320 696e 207a 6970 2863  or c, s in zip(c
-000190a0: 6875 6e6b 732c 2073 6861 7065 2929 0a0a  hunks, shape))..
-000190b0: 2020 2020 6966 2063 6875 6e6b 7320 616e      if chunks an
-000190c0: 6420 7368 6170 6520 6973 206e 6f74 204e  d shape is not N
-000190d0: 6f6e 653a 0a20 2020 2020 2020 2063 6875  one:.        chu
-000190e0: 6e6b 7320 3d20 7375 6d28 0a20 2020 2020  nks = sum(.     
-000190f0: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
-00019100: 2020 2020 2020 2020 2062 6c6f 636b 6469           blockdi
-00019110: 6d73 5f66 726f 6d5f 626c 6f63 6b73 6861  ms_from_blocksha
-00019120: 7065 2828 732c 292c 2028 632c 2929 0a20  pe((s,), (c,)). 
-00019130: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00019140: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-00019150: 2863 2c20 2874 7570 6c65 2c20 6c69 7374  (c, (tuple, list
-00019160: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00019170: 2020 2065 6c73 6520 2863 2c29 0a20 2020     else (c,).   
-00019180: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00019190: 2073 2c20 6320 696e 207a 6970 2873 6861   s, c in zip(sha
-000191a0: 7065 2c20 6368 756e 6b73 290a 2020 2020  pe, chunks).    
-000191b0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-000191c0: 2020 2020 2020 2028 292c 0a20 2020 2020         (),.     
-000191d0: 2020 2029 0a20 2020 2066 6f72 2063 2069     ).    for c i
-000191e0: 6e20 6368 756e 6b73 3a0a 2020 2020 2020  n chunks:.      
-000191f0: 2020 6966 206e 6f74 2063 3a0a 2020 2020    if not c:.    
-00019200: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00019210: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00019220: 2020 2020 2020 2020 2020 2245 6d70 7479            "Empty
-00019230: 2074 7570 6c65 7320 6172 6520 6e6f 7420   tuples are not 
-00019240: 616c 6c6f 7765 6420 696e 2063 6875 6e6b  allowed in chunk
-00019250: 732e 2045 7870 7265 7373 2022 0a20 2020  s. Express ".   
-00019260: 2020 2020 2020 2020 2020 2020 2022 7a65               "ze
-00019270: 726f 206c 656e 6774 6820 6469 6d65 6e73  ro length dimens
-00019280: 696f 6e73 2077 6974 6820 3028 7329 2069  ions with 0(s) i
-00019290: 6e20 6368 756e 6b73 220a 2020 2020 2020  n chunks".      
-000192a0: 2020 2020 2020 290a 0a20 2020 2069 6620        )..    if 
-000192b0: 7368 6170 6520 6973 206e 6f74 204e 6f6e  shape is not Non
-000192c0: 653a 0a20 2020 2020 2020 2069 6620 6c65  e:.        if le
-000192d0: 6e28 6368 756e 6b73 2920 213d 206c 656e  n(chunks) != len
-000192e0: 2873 6861 7065 293a 0a20 2020 2020 2020  (shape):.       
-000192f0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00019300: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00019310: 2020 2020 2020 2022 496e 7075 7420 6172         "Input ar
-00019320: 7261 7920 6861 7320 2564 2064 696d 656e  ray has %d dimen
-00019330: 7369 6f6e 7320 6275 7420 7468 6520 7375  sions but the su
-00019340: 7070 6c69 6564 2022 0a20 2020 2020 2020  pplied ".       
-00019350: 2020 2020 2020 2020 2022 6368 756e 6b73           "chunks
-00019360: 2068 6173 206f 6e6c 7920 2564 2064 696d   has only %d dim
-00019370: 656e 7369 6f6e 7322 2025 2028 6c65 6e28  ensions" % (len(
-00019380: 7368 6170 6529 2c20 6c65 6e28 6368 756e  shape), len(chun
-00019390: 6b73 2929 0a20 2020 2020 2020 2020 2020  ks)).           
-000193a0: 2029 0a20 2020 2020 2020 2069 6620 6e6f   ).        if no
-000193b0: 7420 616c 6c28 0a20 2020 2020 2020 2020  t all(.         
-000193c0: 2020 2063 203d 3d20 7320 6f72 2028 6d61     c == s or (ma
-000193d0: 7468 2e69 736e 616e 2863 2920 6f72 206d  th.isnan(c) or m
-000193e0: 6174 682e 6973 6e61 6e28 7329 290a 2020  ath.isnan(s)).  
-000193f0: 2020 2020 2020 2020 2020 666f 7220 632c            for c,
-00019400: 2073 2069 6e20 7a69 7028 6d61 7028 7375   s in zip(map(su
-00019410: 6d2c 2063 6875 6e6b 7329 2c20 7368 6170  m, chunks), shap
-00019420: 6529 0a20 2020 2020 2020 2029 3a0a 2020  e).        ):.  
-00019430: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00019440: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00019450: 2020 2020 2020 2020 2020 2020 2243 6875              "Chu
-00019460: 6e6b 7320 646f 206e 6f74 2061 6464 2075  nks do not add u
-00019470: 7020 746f 2073 6861 7065 2e20 220a 2020  p to shape. ".  
-00019480: 2020 2020 2020 2020 2020 2020 2020 2247                "G
-00019490: 6f74 2063 6875 6e6b 733d 2573 2c20 7368  ot chunks=%s, sh
-000194a0: 6170 653d 2573 2220 2520 2863 6875 6e6b  ape=%s" % (chunk
-000194b0: 732c 2073 6861 7065 290a 2020 2020 2020  s, shape).      
-000194c0: 2020 2020 2020 290a 0a20 2020 2072 6574        )..    ret
-000194d0: 7572 6e20 7475 706c 6528 0a20 2020 2020  urn tuple(.     
-000194e0: 2020 2074 7570 6c65 2869 6e74 2878 2920     tuple(int(x) 
-000194f0: 6966 206e 6f74 206d 6174 682e 6973 6e61  if not math.isna
-00019500: 6e28 7829 2065 6c73 6520 6e70 2e6e 616e  n(x) else np.nan
-00019510: 2066 6f72 2078 2069 6e20 6329 2066 6f72   for x in c) for
-00019520: 2063 2069 6e20 6368 756e 6b73 0a20 2020   c in chunks.   
-00019530: 2029 0a0a 0a64 6566 205f 636f 6d70 7574   )...def _comput
-00019540: 655f 6d75 6c74 6970 6c69 6572 286c 696d  e_multiplier(lim
-00019550: 6974 3a20 696e 742c 2064 7479 7065 2c20  it: int, dtype, 
-00019560: 6c61 7267 6573 745f 626c 6f63 6b3a 2069  largest_block: i
-00019570: 6e74 2c20 7265 7375 6c74 293a 0a20 2020  nt, result):.   
-00019580: 2022 2222 0a20 2020 2055 7469 6c69 7479   """.    Utility
-00019590: 2066 756e 6374 696f 6e20 666f 7220 6175   function for au
-000195a0: 746f 5f63 6875 6e6b 2c20 746f 2066 696e  to_chunk, to fin
-000195b0: 2068 6f77 206d 7563 6820 6c61 7267 6572   how much larger
-000195c0: 206f 7220 736d 616c 6c65 7220 7468 6520   or smaller the 
-000195d0: 6964 6561 6c0a 2020 2020 6368 756e 6b20  ideal.    chunk 
-000195e0: 7369 7a65 2069 7320 7265 6c61 7469 7665  size is relative
-000195f0: 2074 6f20 7768 6174 2077 6520 6861 7665   to what we have
-00019600: 206e 6f77 2e0a 2020 2020 2222 220a 2020   now..    """.  
-00019610: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
-00019620: 2020 206c 696d 6974 0a20 2020 2020 2020     limit.       
-00019630: 202f 2064 7479 7065 2e69 7465 6d73 697a   / dtype.itemsiz
-00019640: 650a 2020 2020 2020 2020 2f20 6c61 7267  e.        / larg
-00019650: 6573 745f 626c 6f63 6b0a 2020 2020 2020  est_block.      
-00019660: 2020 2f20 6d61 7468 2e70 726f 6428 7220    / math.prod(r 
-00019670: 666f 7220 7220 696e 2072 6573 756c 742e  for r in result.
-00019680: 7661 6c75 6573 2829 2069 6620 7229 0a20  values() if r). 
-00019690: 2020 2029 0a0a 0a64 6566 2061 7574 6f5f     )...def auto_
-000196a0: 6368 756e 6b73 2863 6875 6e6b 732c 2073  chunks(chunks, s
-000196b0: 6861 7065 2c20 6c69 6d69 742c 2064 7479  hape, limit, dty
-000196c0: 7065 2c20 7072 6576 696f 7573 5f63 6875  pe, previous_chu
-000196d0: 6e6b 733d 4e6f 6e65 293a 0a20 2020 2022  nks=None):.    "
-000196e0: 2222 4465 7465 726d 696e 6520 6175 746f  ""Determine auto
-000196f0: 6d61 7469 6320 6368 756e 6b73 0a0a 2020  matic chunks..  
-00019700: 2020 5468 6973 2074 616b 6573 2069 6e20    This takes in 
-00019710: 6120 6368 756e 6b73 2076 616c 7565 2074  a chunks value t
-00019720: 6861 7420 636f 6e74 6169 6e73 2060 6022  hat contains ``"
-00019730: 6175 746f 2260 6020 7661 6c75 6573 2069  auto"`` values i
-00019740: 6e20 6365 7274 6169 6e0a 2020 2020 6469  n certain.    di
-00019750: 6d65 6e73 696f 6e73 2061 6e64 2072 6570  mensions and rep
-00019760: 6c61 6365 7320 7468 6f73 6520 7661 6c75  laces those valu
-00019770: 6573 2077 6974 6820 636f 6e63 7265 7465  es with concrete
-00019780: 2064 696d 656e 7369 6f6e 2073 697a 6573   dimension sizes
-00019790: 2074 6861 7420 7472 790a 2020 2020 746f   that try.    to
-000197a0: 2067 6574 2063 6875 6e6b 7320 746f 2062   get chunks to b
-000197b0: 6520 6f66 2061 2063 6572 7461 696e 2073  e of a certain s
-000197c0: 697a 6520 696e 2062 7974 6573 2c20 7072  ize in bytes, pr
-000197d0: 6f76 6964 6564 2062 7920 7468 6520 6060  ovided by the ``
-000197e0: 6c69 6d69 743d 6060 0a20 2020 206b 6579  limit=``.    key
-000197f0: 776f 7264 2e20 2049 6620 6d75 6c74 6970  word.  If multip
-00019800: 6c65 2064 696d 656e 7369 6f6e 7320 6172  le dimensions ar
-00019810: 6520 6d61 726b 6564 2061 7320 6060 2261  e marked as ``"a
-00019820: 7574 6f22 6060 2074 6865 6e20 7468 6579  uto"`` then they
-00019830: 2077 696c 6c0a 2020 2020 616c 6c20 7265   will.    all re
-00019840: 7370 6f6e 6420 746f 206d 6565 7420 7468  spond to meet th
-00019850: 6520 6465 7369 7265 6420 6279 7465 206c  e desired byte l
-00019860: 696d 6974 2c20 7472 7969 6e67 2074 6f20  imit, trying to 
-00019870: 7265 7370 6563 7420 7468 6520 6173 7065  respect the aspe
-00019880: 6374 0a20 2020 2072 6174 696f 206f 6620  ct.    ratio of 
-00019890: 7468 6569 7220 6469 6d65 6e73 696f 6e73  their dimensions
-000198a0: 2069 6e20 6060 7072 6576 696f 7573 5f63   in ``previous_c
-000198b0: 6875 6e6b 733d 6060 2c20 6966 2067 6976  hunks=``, if giv
-000198c0: 656e 2e0a 0a20 2020 2050 6172 616d 6574  en...    Paramet
-000198d0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-000198e0: 2d2d 0a20 2020 2063 6875 6e6b 733a 2054  --.    chunks: T
-000198f0: 7570 6c65 0a20 2020 2020 2020 2041 2074  uple.        A t
-00019900: 7570 6c65 206f 6620 6569 7468 6572 2064  uple of either d
-00019910: 696d 656e 7369 6f6e 7320 6f72 2074 7570  imensions or tup
-00019920: 6c65 7320 6f66 2065 7870 6c69 6369 7420  les of explicit 
-00019930: 6368 756e 6b20 6469 6d65 6e73 696f 6e73  chunk dimensions
-00019940: 0a20 2020 2020 2020 2053 6f6d 6520 656e  .        Some en
-00019950: 7472 6965 7320 7368 6f75 6c64 2062 6520  tries should be 
-00019960: 2261 7574 6f22 0a20 2020 2073 6861 7065  "auto".    shape
-00019970: 3a20 5475 706c 655b 696e 745d 0a20 2020  : Tuple[int].   
-00019980: 206c 696d 6974 3a20 696e 742c 2073 7472   limit: int, str
-00019990: 0a20 2020 2020 2020 2054 6865 206d 6178  .        The max
-000199a0: 696d 756d 2061 6c6c 6f77 6162 6c65 2073  imum allowable s
-000199b0: 697a 6520 6f66 2061 2063 6875 6e6b 2069  ize of a chunk i
-000199c0: 6e20 6279 7465 730a 2020 2020 7072 6576  n bytes.    prev
-000199d0: 696f 7573 5f63 6875 6e6b 733a 2054 7570  ious_chunks: Tup
-000199e0: 6c65 5b54 7570 6c65 5b69 6e74 5d5d 0a0a  le[Tuple[int]]..
-000199f0: 2020 2020 5365 6520 616c 736f 0a20 2020      See also.   
-00019a00: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 6e6f   --------.    no
-00019a10: 726d 616c 697a 655f 6368 756e 6b73 3a20  rmalize_chunks: 
-00019a20: 666f 7220 6675 6c6c 2064 6f63 7374 7269  for full docstri
-00019a30: 6e67 2061 6e64 2070 6172 616d 6574 6572  ng and parameter
-00019a40: 730a 2020 2020 2222 220a 2020 2020 6966  s.    """.    if
-00019a50: 2070 7265 7669 6f75 735f 6368 756e 6b73   previous_chunks
-00019a60: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00019a70: 2020 2020 2020 7072 6576 696f 7573 5f63        previous_c
-00019a80: 6875 6e6b 7320 3d20 7475 706c 6528 0a20  hunks = tuple(. 
-00019a90: 2020 2020 2020 2020 2020 2063 2069 6620             c if 
-00019aa0: 6973 696e 7374 616e 6365 2863 2c20 7475  isinstance(c, tu
-00019ab0: 706c 6529 2065 6c73 6520 2863 2c29 2066  ple) else (c,) f
-00019ac0: 6f72 2063 2069 6e20 7072 6576 696f 7573  or c in previous
-00019ad0: 5f63 6875 6e6b 730a 2020 2020 2020 2020  _chunks.        
-00019ae0: 290a 2020 2020 6368 756e 6b73 203d 206c  ).    chunks = l
-00019af0: 6973 7428 6368 756e 6b73 290a 0a20 2020  ist(chunks)..   
-00019b00: 2061 7574 6f73 203d 207b 6920 666f 7220   autos = {i for 
-00019b10: 692c 2063 2069 6e20 656e 756d 6572 6174  i, c in enumerat
-00019b20: 6528 6368 756e 6b73 2920 6966 2063 203d  e(chunks) if c =
-00019b30: 3d20 2261 7574 6f22 7d0a 2020 2020 6966  = "auto"}.    if
-00019b40: 206e 6f74 2061 7574 6f73 3a0a 2020 2020   not autos:.    
-00019b50: 2020 2020 7265 7475 726e 2074 7570 6c65      return tuple
-00019b60: 2863 6875 6e6b 7329 0a0a 2020 2020 6966  (chunks)..    if
-00019b70: 206c 696d 6974 2069 7320 4e6f 6e65 3a0a   limit is None:.
-00019b80: 2020 2020 2020 2020 6c69 6d69 7420 3d20          limit = 
-00019b90: 636f 6e66 6967 2e67 6574 2822 6172 7261  config.get("arra
-00019ba0: 792e 6368 756e 6b2d 7369 7a65 2229 0a20  y.chunk-size"). 
-00019bb0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00019bc0: 286c 696d 6974 2c20 7374 7229 3a0a 2020  (limit, str):.  
-00019bd0: 2020 2020 2020 6c69 6d69 7420 3d20 7061        limit = pa
-00019be0: 7273 655f 6279 7465 7328 6c69 6d69 7429  rse_bytes(limit)
-00019bf0: 0a0a 2020 2020 6966 2064 7479 7065 2069  ..    if dtype i
-00019c00: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00019c10: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-00019c20: 2264 7479 7065 206d 7573 7420 6265 206b  "dtype must be k
-00019c30: 6e6f 776e 2066 6f72 2061 7574 6f2d 6368  nown for auto-ch
-00019c40: 756e 6b69 6e67 2229 0a0a 2020 2020 6966  unking")..    if
-00019c50: 2064 7479 7065 2e68 6173 6f62 6a65 6374   dtype.hasobject
-00019c60: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-00019c70: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00019c80: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00019c90: 2022 4361 6e20 6e6f 7420 7573 6520 6175   "Can not use au
-00019ca0: 746f 2072 6563 6875 6e6b 696e 6720 7769  to rechunking wi
-00019cb0: 7468 206f 626a 6563 7420 6474 7970 652e  th object dtype.
-00019cc0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
-00019cd0: 5765 2061 7265 2075 6e61 626c 6520 746f  We are unable to
-00019ce0: 2065 7374 696d 6174 6520 7468 6520 7369   estimate the si
-00019cf0: 7a65 2069 6e20 6279 7465 7320 6f66 206f  ze in bytes of o
-00019d00: 626a 6563 7420 6461 7461 220a 2020 2020  bject data".    
-00019d10: 2020 2020 290a 0a20 2020 2066 6f72 2078      )..    for x
-00019d20: 2069 6e20 7475 706c 6528 6368 756e 6b73   in tuple(chunks
-00019d30: 2920 2b20 7475 706c 6528 7368 6170 6529  ) + tuple(shape)
-00019d40: 3a0a 2020 2020 2020 2020 6966 2028 0a20  :.        if (. 
-00019d50: 2020 2020 2020 2020 2020 2069 7369 6e73             isins
-00019d60: 7461 6e63 6528 782c 204e 756d 6265 7229  tance(x, Number)
-00019d70: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00019d80: 206e 702e 6973 6e61 6e28 7829 0a20 2020   np.isnan(x).   
-00019d90: 2020 2020 2020 2020 206f 7220 6973 696e           or isin
-00019da0: 7374 616e 6365 2878 2c20 7475 706c 6529  stance(x, tuple)
-00019db0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00019dc0: 206e 702e 6973 6e61 6e28 7829 2e61 6e79   np.isnan(x).any
-00019dd0: 2829 0a20 2020 2020 2020 2029 3a0a 2020  ().        ):.  
-00019de0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00019df0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00019e00: 2020 2020 2020 2020 2020 2020 2243 616e              "Can
-00019e10: 206e 6f74 2070 6572 666f 726d 2061 7574   not perform aut
-00019e20: 6f6d 6174 6963 2072 6563 6875 6e6b 696e  omatic rechunkin
-00019e30: 6720 7769 7468 2075 6e6b 6e6f 776e 2022  g with unknown "
-00019e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019e50: 2022 286e 616e 2920 6368 756e 6b20 7369   "(nan) chunk si
-00019e60: 7a65 732e 2573 2220 2520 756e 6b6e 6f77  zes.%s" % unknow
-00019e70: 6e5f 6368 756e 6b5f 6d65 7373 6167 650a  n_chunk_message.
-00019e80: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00019e90: 2020 206c 696d 6974 203d 206d 6178 2831     limit = max(1
-00019ea0: 2c20 6c69 6d69 7429 0a0a 2020 2020 6c61  , limit)..    la
-00019eb0: 7267 6573 745f 626c 6f63 6b20 3d20 6d61  rgest_block = ma
-00019ec0: 7468 2e70 726f 6428 0a20 2020 2020 2020  th.prod(.       
-00019ed0: 2063 7320 6966 2069 7369 6e73 7461 6e63   cs if isinstanc
-00019ee0: 6528 6373 2c20 4e75 6d62 6572 2920 656c  e(cs, Number) el
-00019ef0: 7365 206d 6178 2863 7329 2066 6f72 2063  se max(cs) for c
-00019f00: 7320 696e 2063 6875 6e6b 7320 6966 2063  s in chunks if c
-00019f10: 7320 213d 2022 6175 746f 220a 2020 2020  s != "auto".    
-00019f20: 290a 0a20 2020 2069 6620 7072 6576 696f  )..    if previo
-00019f30: 7573 5f63 6875 6e6b 733a 0a20 2020 2020  us_chunks:.     
-00019f40: 2020 2023 2042 6173 6520 6964 6561 6c20     # Base ideal 
-00019f50: 7261 7469 6f20 6f6e 2074 6865 206d 6564  ratio on the med
-00019f60: 6961 6e20 6368 756e 6b20 7369 7a65 206f  ian chunk size o
-00019f70: 6620 7468 6520 7072 6576 696f 7573 2063  f the previous c
-00019f80: 6875 6e6b 730a 2020 2020 2020 2020 7265  hunks.        re
-00019f90: 7375 6c74 203d 207b 613a 206e 702e 6d65  sult = {a: np.me
-00019fa0: 6469 616e 2870 7265 7669 6f75 735f 6368  dian(previous_ch
-00019fb0: 756e 6b73 5b61 5d29 2066 6f72 2061 2069  unks[a]) for a i
-00019fc0: 6e20 6175 746f 737d 0a0a 2020 2020 2020  n autos}..      
-00019fd0: 2020 6964 6561 6c5f 7368 6170 6520 3d20    ideal_shape = 
-00019fe0: 5b5d 0a20 2020 2020 2020 2066 6f72 2069  [].        for i
-00019ff0: 2c20 7320 696e 2065 6e75 6d65 7261 7465  , s in enumerate
-0001a000: 2873 6861 7065 293a 0a20 2020 2020 2020  (shape):.       
-0001a010: 2020 2020 2063 6875 6e6b 5f66 7265 7175       chunk_frequ
-0001a020: 656e 6369 6573 203d 2066 7265 7175 656e  encies = frequen
-0001a030: 6369 6573 2870 7265 7669 6f75 735f 6368  cies(previous_ch
-0001a040: 756e 6b73 5b69 5d29 0a20 2020 2020 2020  unks[i]).       
-0001a050: 2020 2020 206d 6f64 652c 2063 6f75 6e74       mode, count
-0001a060: 203d 206d 6178 2863 6875 6e6b 5f66 7265   = max(chunk_fre
-0001a070: 7175 656e 6369 6573 2e69 7465 6d73 2829  quencies.items()
-0001a080: 2c20 6b65 793d 6c61 6d62 6461 206b 763a  , key=lambda kv:
-0001a090: 206b 765b 315d 290a 2020 2020 2020 2020   kv[1]).        
-0001a0a0: 2020 2020 6966 206d 6f64 6520 3e20 3120      if mode > 1 
-0001a0b0: 616e 6420 636f 756e 7420 3e3d 206c 656e  and count >= len
-0001a0c0: 2870 7265 7669 6f75 735f 6368 756e 6b73  (previous_chunks
-0001a0d0: 5b69 5d29 202f 2032 3a0a 2020 2020 2020  [i]) / 2:.      
-0001a0e0: 2020 2020 2020 2020 2020 6964 6561 6c5f            ideal_
-0001a0f0: 7368 6170 652e 6170 7065 6e64 286d 6f64  shape.append(mod
-0001a100: 6529 0a20 2020 2020 2020 2020 2020 2065  e).            e
-0001a110: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001a120: 2020 2020 2069 6465 616c 5f73 6861 7065       ideal_shape
-0001a130: 2e61 7070 656e 6428 7329 0a0a 2020 2020  .append(s)..    
-0001a140: 2020 2020 2320 486f 7720 6d75 6368 206c      # How much l
-0001a150: 6172 6765 7220 6f72 2073 6d61 6c6c 6572  arger or smaller
-0001a160: 2074 6865 2069 6465 616c 2063 6875 6e6b   the ideal chunk
-0001a170: 2073 697a 6520 6973 2072 656c 6174 6976   size is relativ
-0001a180: 6520 746f 2077 6861 7420 7765 2068 6176  e to what we hav
-0001a190: 6520 6e6f 770a 2020 2020 2020 2020 6d75  e now.        mu
-0001a1a0: 6c74 6970 6c69 6572 203d 205f 636f 6d70  ltiplier = _comp
-0001a1b0: 7574 655f 6d75 6c74 6970 6c69 6572 286c  ute_multiplier(l
-0001a1c0: 696d 6974 2c20 6474 7970 652c 206c 6172  imit, dtype, lar
-0001a1d0: 6765 7374 5f62 6c6f 636b 2c20 7265 7375  gest_block, resu
-0001a1e0: 6c74 290a 0a20 2020 2020 2020 206c 6173  lt)..        las
-0001a1f0: 745f 6d75 6c74 6970 6c69 6572 203d 2030  t_multiplier = 0
-0001a200: 0a20 2020 2020 2020 206c 6173 745f 6175  .        last_au
-0001a210: 746f 7320 3d20 7365 7428 290a 2020 2020  tos = set().    
-0001a220: 2020 2020 7768 696c 6520 280a 2020 2020      while (.    
-0001a230: 2020 2020 2020 2020 6d75 6c74 6970 6c69          multipli
-0001a240: 6572 2021 3d20 6c61 7374 5f6d 756c 7469  er != last_multi
-0001a250: 706c 6965 7220 6f72 2061 7574 6f73 2021  plier or autos !
-0001a260: 3d20 6c61 7374 5f61 7574 6f73 0a20 2020  = last_autos.   
-0001a270: 2020 2020 2029 3a20 2023 2077 6869 6c65       ):  # while
-0001a280: 2074 6869 6e67 7320 6368 616e 6765 0a20   things change. 
-0001a290: 2020 2020 2020 2020 2020 206c 6173 745f             last_
-0001a2a0: 6d75 6c74 6970 6c69 6572 203d 206d 756c  multiplier = mul
-0001a2b0: 7469 706c 6965 7220 2023 2072 6563 6f72  tiplier  # recor
-0001a2c0: 6420 7072 6576 696f 7573 2076 616c 7565  d previous value
-0001a2d0: 730a 2020 2020 2020 2020 2020 2020 6c61  s.            la
-0001a2e0: 7374 5f61 7574 6f73 203d 2073 6574 2861  st_autos = set(a
-0001a2f0: 7574 6f73 2920 2023 2072 6563 6f72 6420  utos)  # record 
-0001a300: 7072 6576 696f 7573 2076 616c 7565 730a  previous values.
-0001a310: 0a20 2020 2020 2020 2020 2020 2023 2045  .            # E
-0001a320: 7870 616e 6420 6f72 2063 6f6e 7472 6163  xpand or contrac
-0001a330: 7420 6561 6368 206f 6620 7468 6520 6469  t each of the di
-0001a340: 6d65 6e73 696f 6e73 2061 7070 726f 7072  mensions appropr
-0001a350: 6961 7465 6c79 0a20 2020 2020 2020 2020  iately.         
-0001a360: 2020 2066 6f72 2061 2069 6e20 736f 7274     for a in sort
-0001a370: 6564 2861 7574 6f73 293a 0a20 2020 2020  ed(autos):.     
-0001a380: 2020 2020 2020 2020 2020 2069 6620 6964             if id
-0001a390: 6561 6c5f 7368 6170 655b 615d 203d 3d20  eal_shape[a] == 
-0001a3a0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0001a3b0: 2020 2020 2020 2072 6573 756c 745b 615d         result[a]
-0001a3c0: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
-0001a3d0: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-0001a3e0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0001a3f0: 2020 7072 6f70 6f73 6564 203d 2072 6573    proposed = res
-0001a400: 756c 745b 615d 202a 206d 756c 7469 706c  ult[a] * multipl
-0001a410: 6965 7220 2a2a 2028 3120 2f20 6c65 6e28  ier ** (1 / len(
-0001a420: 6175 746f 7329 290a 2020 2020 2020 2020  autos)).        
-0001a430: 2020 2020 2020 2020 6966 2070 726f 706f          if propo
-0001a440: 7365 6420 3e20 7368 6170 655b 615d 3a20  sed > shape[a]: 
-0001a450: 2023 2077 6527 7665 2068 6974 2074 6865   # we've hit the
-0001a460: 2073 6861 7065 2062 6f75 6e64 6172 790a   shape boundary.
-0001a470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a480: 2020 2020 6175 746f 732e 7265 6d6f 7665      autos.remove
-0001a490: 2861 290a 2020 2020 2020 2020 2020 2020  (a).            
-0001a4a0: 2020 2020 2020 2020 6c61 7267 6573 745f          largest_
-0001a4b0: 626c 6f63 6b20 2a3d 2073 6861 7065 5b61  block *= shape[a
-0001a4c0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0001a4d0: 2020 2020 2020 6368 756e 6b73 5b61 5d20        chunks[a] 
-0001a4e0: 3d20 7368 6170 655b 615d 0a20 2020 2020  = shape[a].     
-0001a4f0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0001a500: 656c 2072 6573 756c 745b 615d 0a20 2020  el result[a].   
-0001a510: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0001a520: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0001a530: 2020 2020 2020 2072 6573 756c 745b 615d         result[a]
-0001a540: 203d 2072 6f75 6e64 5f74 6f28 7072 6f70   = round_to(prop
-0001a550: 6f73 6564 2c20 6964 6561 6c5f 7368 6170  osed, ideal_shap
-0001a560: 655b 615d 290a 0a20 2020 2020 2020 2020  e[a])..         
-0001a570: 2020 2023 2072 6563 6f6d 7075 7465 2068     # recompute h
-0001a580: 6f77 206d 7563 6820 6d75 6c74 6970 6c69  ow much multipli
-0001a590: 6572 2077 6520 6861 7665 206c 6566 742c  er we have left,
-0001a5a0: 2072 6570 6561 740a 2020 2020 2020 2020   repeat.        
-0001a5b0: 2020 2020 6d75 6c74 6970 6c69 6572 203d      multiplier =
-0001a5c0: 205f 636f 6d70 7574 655f 6d75 6c74 6970   _compute_multip
-0001a5d0: 6c69 6572 286c 696d 6974 2c20 6474 7970  lier(limit, dtyp
-0001a5e0: 652c 206c 6172 6765 7374 5f62 6c6f 636b  e, largest_block
-0001a5f0: 2c20 7265 7375 6c74 290a 0a20 2020 2020  , result)..     
-0001a600: 2020 2066 6f72 206b 2c20 7620 696e 2072     for k, v in r
-0001a610: 6573 756c 742e 6974 656d 7328 293a 0a20  esult.items():. 
-0001a620: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
-0001a630: 735b 6b5d 203d 2076 0a20 2020 2020 2020  s[k] = v.       
-0001a640: 2072 6574 7572 6e20 7475 706c 6528 6368   return tuple(ch
-0001a650: 756e 6b73 290a 0a20 2020 2065 6c73 653a  unks)..    else:
-0001a660: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
-0001a670: 2069 6620 6474 7970 652e 6974 656d 7369   if dtype.itemsi
-0001a680: 7a65 2069 7320 6772 6561 7465 7220 7468  ze is greater th
-0001a690: 616e 2030 0a20 2020 2020 2020 2069 6620  an 0.        if 
-0001a6a0: 6474 7970 652e 6974 656d 7369 7a65 203d  dtype.itemsize =
-0001a6b0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0001a6c0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0001a6d0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0001a6e0: 2020 2022 6175 746f 2d63 6875 6e6b 696e     "auto-chunkin
-0001a6f0: 6720 7769 7468 2064 7479 7065 2e69 7465  g with dtype.ite
-0001a700: 6d73 697a 6520 3d3d 2030 2069 7320 6e6f  msize == 0 is no
-0001a710: 7420 7375 7070 6f72 7465 642c 2070 6c65  t supported, ple
-0001a720: 6173 6520 7061 7373 2069 6e20 6063 6875  ase pass in `chu
-0001a730: 6e6b 7360 2065 7870 6c69 6369 746c 7922  nks` explicitly"
-0001a740: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001a750: 2020 2020 2020 2073 697a 6520 3d20 286c         size = (l
-0001a760: 696d 6974 202f 2064 7479 7065 2e69 7465  imit / dtype.ite
-0001a770: 6d73 697a 6520 2f20 6c61 7267 6573 745f  msize / largest_
-0001a780: 626c 6f63 6b29 202a 2a20 2831 202f 206c  block) ** (1 / l
-0001a790: 656e 2861 7574 6f73 2929 0a20 2020 2020  en(autos)).     
-0001a7a0: 2020 2073 6d61 6c6c 203d 205b 6920 666f     small = [i fo
-0001a7b0: 7220 6920 696e 2061 7574 6f73 2069 6620  r i in autos if 
-0001a7c0: 7368 6170 655b 695d 203c 2073 697a 655d  shape[i] < size]
-0001a7d0: 0a20 2020 2020 2020 2069 6620 736d 616c  .        if smal
-0001a7e0: 6c3a 0a20 2020 2020 2020 2020 2020 2066  l:.            f
-0001a7f0: 6f72 2069 2069 6e20 736d 616c 6c3a 0a20  or i in small:. 
-0001a800: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001a810: 6875 6e6b 735b 695d 203d 2028 7368 6170  hunks[i] = (shap
-0001a820: 655b 695d 2c29 0a20 2020 2020 2020 2020  e[i],).         
-0001a830: 2020 2072 6574 7572 6e20 6175 746f 5f63     return auto_c
-0001a840: 6875 6e6b 7328 6368 756e 6b73 2c20 7368  hunks(chunks, sh
-0001a850: 6170 652c 206c 696d 6974 2c20 6474 7970  ape, limit, dtyp
-0001a860: 6529 0a0a 2020 2020 2020 2020 666f 7220  e)..        for 
-0001a870: 6920 696e 2061 7574 6f73 3a0a 2020 2020  i in autos:.    
-0001a880: 2020 2020 2020 2020 6368 756e 6b73 5b69          chunks[i
-0001a890: 5d20 3d20 726f 756e 645f 746f 2873 697a  ] = round_to(siz
-0001a8a0: 652c 2073 6861 7065 5b69 5d29 0a0a 2020  e, shape[i])..  
-0001a8b0: 2020 2020 2020 7265 7475 726e 2074 7570        return tup
-0001a8c0: 6c65 2863 6875 6e6b 7329 0a0a 0a64 6566  le(chunks)...def
-0001a8d0: 2072 6f75 6e64 5f74 6f28 632c 2073 293a   round_to(c, s):
-0001a8e0: 0a20 2020 2022 2222 5265 7475 726e 2061  .    """Return a
-0001a8f0: 2063 6875 6e6b 2064 696d 656e 7369 6f6e   chunk dimension
-0001a900: 2074 6861 7420 6973 2063 6c6f 7365 2074   that is close t
-0001a910: 6f20 616e 2065 7665 6e20 6d75 6c74 6970  o an even multip
-0001a920: 6c65 206f 7220 6661 6374 6f72 0a0a 2020  le or factor..  
-0001a930: 2020 5765 2077 616e 7420 7661 6c75 6573    We want values
-0001a940: 2066 6f72 2063 2074 6861 7420 6172 6520   for c that are 
-0001a950: 6e69 6365 6c79 2061 6c69 676e 6564 2077  nicely aligned w
-0001a960: 6974 6820 732e 0a0a 2020 2020 4966 2063  ith s...    If c
-0001a970: 2069 7320 736d 616c 6c65 7220 7468 616e   is smaller than
-0001a980: 2073 2077 6520 7573 6520 7468 6520 6f72   s we use the or
-0001a990: 6967 696e 616c 2063 6875 6e6b 2073 697a  iginal chunk siz
-0001a9a0: 6520 616e 6420 6163 6365 7074 2061 6e0a  e and accept an.
-0001a9b0: 2020 2020 756e 6576 656e 2063 6875 6e6b      uneven chunk
-0001a9c0: 2061 7420 7468 6520 656e 642e 0a0a 2020   at the end...  
-0001a9d0: 2020 4966 2063 2069 7320 6c61 7267 6572    If c is larger
-0001a9e0: 2074 6861 6e20 7320 7468 656e 2077 6520   than s then we 
-0001a9f0: 7761 6e74 2074 6865 206c 6172 6765 7374  want the largest
-0001aa00: 206d 756c 7469 706c 6520 6f66 2073 2074   multiple of s t
-0001aa10: 6861 7420 6973 2073 7469 6c6c 0a20 2020  hat is still.   
-0001aa20: 2073 6d61 6c6c 6572 2074 6861 6e20 632e   smaller than c.
-0001aa30: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
-0001aa40: 6320 3c3d 2073 3a0a 2020 2020 2020 2020  c <= s:.        
-0001aa50: 7265 7475 726e 206d 6178 2831 2c20 696e  return max(1, in
-0001aa60: 7428 6329 290a 2020 2020 656c 7365 3a0a  t(c)).    else:.
-0001aa70: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-0001aa80: 202f 2f20 7320 2a20 730a 0a0a 6465 6620   // s * s...def 
-0001aa90: 5f67 6574 5f63 6875 6e6b 5f73 6861 7065  _get_chunk_shape
-0001aaa0: 2861 293a 0a20 2020 2073 203d 206e 702e  (a):.    s = np.
-0001aab0: 6173 6172 7261 7928 612e 7368 6170 652c  asarray(a.shape,
-0001aac0: 2064 7479 7065 3d69 6e74 290a 2020 2020   dtype=int).    
-0001aad0: 7265 7475 726e 2073 5b6c 656e 2873 2920  return s[len(s) 
-0001aae0: 2a20 284e 6f6e 652c 2920 2b20 2873 6c69  * (None,) + (sli
-0001aaf0: 6365 284e 6f6e 6529 2c29 5d0a 0a0a 6465  ce(None),)]...de
-0001ab00: 6620 6672 6f6d 5f61 7272 6179 280a 2020  f from_array(.  
-0001ab10: 2020 782c 0a20 2020 2063 6875 6e6b 733d    x,.    chunks=
-0001ab20: 2261 7574 6f22 2c0a 2020 2020 6e61 6d65  "auto",.    name
-0001ab30: 3d4e 6f6e 652c 0a20 2020 206c 6f63 6b3d  =None,.    lock=
-0001ab40: 4661 6c73 652c 0a20 2020 2061 7361 7272  False,.    asarr
-0001ab50: 6179 3d4e 6f6e 652c 0a20 2020 2066 616e  ay=None,.    fan
-0001ab60: 6379 3d54 7275 652c 0a20 2020 2067 6574  cy=True,.    get
-0001ab70: 6974 656d 3d4e 6f6e 652c 0a20 2020 206d  item=None,.    m
-0001ab80: 6574 613d 4e6f 6e65 2c0a 2020 2020 696e  eta=None,.    in
-0001ab90: 6c69 6e65 5f61 7272 6179 3d46 616c 7365  line_array=False
-0001aba0: 2c0a 293a 0a20 2020 2022 2222 4372 6561  ,.):.    """Crea
-0001abb0: 7465 2064 6173 6b20 6172 7261 7920 6672  te dask array fr
-0001abc0: 6f6d 2073 6f6d 6574 6869 6e67 2074 6861  om something tha
-0001abd0: 7420 6c6f 6f6b 7320 6c69 6b65 2061 6e20  t looks like an 
-0001abe0: 6172 7261 792e 0a0a 2020 2020 496e 7075  array...    Inpu
-0001abf0: 7420 6d75 7374 2068 6176 6520 6120 6060  t must have a ``
-0001ac00: 2e73 6861 7065 6060 2c20 6060 2e6e 6469  .shape``, ``.ndi
-0001ac10: 6d60 602c 2060 602e 6474 7970 6560 6020  m``, ``.dtype`` 
-0001ac20: 616e 6420 7375 7070 6f72 7420 6e75 6d70  and support nump
-0001ac30: 792d 7374 796c 6520 736c 6963 696e 672e  y-style slicing.
-0001ac40: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-0001ac50: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-0001ac60: 2020 2020 7820 3a20 6172 7261 795f 6c69      x : array_li
-0001ac70: 6b65 0a20 2020 2063 6875 6e6b 7320 3a20  ke.    chunks : 
-0001ac80: 696e 742c 2074 7570 6c65 0a20 2020 2020  int, tuple.     
-0001ac90: 2020 2048 6f77 2074 6f20 6368 756e 6b20     How to chunk 
-0001aca0: 7468 6520 6172 7261 792e 204d 7573 7420  the array. Must 
-0001acb0: 6265 206f 6e65 206f 6620 7468 6520 666f  be one of the fo
-0001acc0: 6c6c 6f77 696e 6720 666f 726d 733a 0a0a  llowing forms:..
-0001acd0: 2020 2020 2020 2020 2d20 4120 626c 6f63          - A bloc
-0001ace0: 6b73 697a 6520 6c69 6b65 2031 3030 302e  ksize like 1000.
-0001acf0: 0a20 2020 2020 2020 202d 2041 2062 6c6f  .        - A blo
-0001ad00: 636b 7368 6170 6520 6c69 6b65 2028 3130  ckshape like (10
-0001ad10: 3030 2c20 3130 3030 292e 0a20 2020 2020  00, 1000)..     
-0001ad20: 2020 202d 2045 7870 6c69 6369 7420 7369     - Explicit si
-0001ad30: 7a65 7320 6f66 2061 6c6c 2062 6c6f 636b  zes of all block
-0001ad40: 7320 616c 6f6e 6720 616c 6c20 6469 6d65  s along all dime
-0001ad50: 6e73 696f 6e73 206c 696b 650a 2020 2020  nsions like.    
-0001ad60: 2020 2020 2020 2828 3130 3030 2c20 3130        ((1000, 10
-0001ad70: 3030 2c20 3530 3029 2c20 2834 3030 2c20  00, 500), (400, 
-0001ad80: 3430 3029 292e 0a20 2020 2020 2020 202d  400))..        -
-0001ad90: 2041 2073 697a 6520 696e 2062 7974 6573   A size in bytes
-0001ada0: 2c20 6c69 6b65 2022 3130 3020 4d69 4222  , like "100 MiB"
-0001adb0: 2077 6869 6368 2077 696c 6c20 6368 6f6f   which will choo
-0001adc0: 7365 2061 2075 6e69 666f 726d 0a20 2020  se a uniform.   
-0001add0: 2020 2020 2020 2062 6c6f 636b 2d6c 696b         block-lik
-0001ade0: 6520 7368 6170 650a 2020 2020 2020 2020  e shape.        
-0001adf0: 2d20 5468 6520 776f 7264 2022 6175 746f  - The word "auto
-0001ae00: 2220 7768 6963 6820 6163 7473 206c 696b  " which acts lik
-0001ae10: 6520 7468 6520 6162 6f76 652c 2062 7574  e the above, but
-0001ae20: 2075 7365 7320 6120 636f 6e66 6967 7572   uses a configur
-0001ae30: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
-0001ae40: 7661 6c75 6520 6060 6172 7261 792e 6368  value ``array.ch
-0001ae50: 756e 6b2d 7369 7a65 6060 2066 6f72 2074  unk-size`` for t
-0001ae60: 6865 2063 6875 6e6b 2073 697a 650a 0a20  he chunk size.. 
-0001ae70: 2020 2020 2020 202d 3120 6f72 204e 6f6e         -1 or Non
-0001ae80: 6520 6173 2061 2062 6c6f 636b 7369 7a65  e as a blocksize
-0001ae90: 2069 6e64 6963 6174 6520 7468 6520 7369   indicate the si
-0001aea0: 7a65 206f 6620 7468 6520 636f 7272 6573  ze of the corres
-0001aeb0: 706f 6e64 696e 670a 2020 2020 2020 2020  ponding.        
-0001aec0: 6469 6d65 6e73 696f 6e2e 0a20 2020 206e  dimension..    n
-0001aed0: 616d 6520 3a20 7374 7220 6f72 2062 6f6f  ame : str or boo
-0001aee0: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-0001aef0: 2020 2020 5468 6520 6b65 7920 6e61 6d65      The key name
-0001af00: 2074 6f20 7573 6520 666f 7220 7468 6520   to use for the 
-0001af10: 6172 7261 792e 2044 6566 6175 6c74 7320  array. Defaults 
-0001af20: 746f 2061 2068 6173 6820 6f66 2060 6078  to a hash of ``x
-0001af30: 6060 2e0a 0a20 2020 2020 2020 2048 6173  ``...        Has
-0001af40: 6869 6e67 2069 7320 7573 6566 756c 2069  hing is useful i
-0001af50: 6620 7468 6520 7361 6d65 2076 616c 7565  f the same value
-0001af60: 206f 6620 6060 7860 6020 6973 2075 7365   of ``x`` is use
-0001af70: 6420 746f 2063 7265 6174 6520 6d75 6c74  d to create mult
-0001af80: 6970 6c65 0a20 2020 2020 2020 2061 7272  iple.        arr
-0001af90: 6179 732c 2061 7320 4461 736b 2063 616e  ays, as Dask can
-0001afa0: 2074 6865 6e20 7265 636f 676e 6973 6520   then recognise 
-0001afb0: 7468 6174 2074 6865 7927 7265 2074 6865  that they're the
-0001afc0: 2073 616d 6520 616e 640a 2020 2020 2020   same and.      
-0001afd0: 2020 6176 6f69 6420 6475 706c 6963 6174    avoid duplicat
-0001afe0: 6520 636f 6d70 7574 6174 696f 6e73 2e20  e computations. 
-0001aff0: 486f 7765 7665 722c 2069 7420 6361 6e20  However, it can 
-0001b000: 616c 736f 2062 6520 736c 6f77 2c20 616e  also be slow, an
-0001b010: 6420 6966 2074 6865 0a20 2020 2020 2020  d if the.       
-0001b020: 2061 7272 6179 2069 7320 6e6f 7420 636f   array is not co
-0001b030: 6e74 6967 756f 7573 2069 7420 6973 2063  ntiguous it is c
-0001b040: 6f70 6965 6420 666f 7220 6861 7368 696e  opied for hashin
-0001b050: 672e 2049 6620 7468 6520 6172 7261 7920  g. If the array 
-0001b060: 7573 6573 0a20 2020 2020 2020 2073 7472  uses.        str
-0001b070: 6964 6520 7472 6963 6b73 2028 7375 6368  ide tricks (such
-0001b080: 2061 7320 3a66 756e 633a 606e 756d 7079   as :func:`numpy
-0001b090: 2e62 726f 6164 6361 7374 5f74 6f60 206f  .broadcast_to` o
-0001b0a0: 720a 2020 2020 2020 2020 3a66 756e 633a  r.        :func:
-0001b0b0: 6073 6b69 6d61 6765 2e75 7469 6c2e 7669  `skimage.util.vi
-0001b0c0: 6577 5f61 735f 7769 6e64 6f77 7360 2920  ew_as_windows`) 
-0001b0d0: 746f 2068 6176 6520 6120 6c61 7267 6572  to have a larger
-0001b0e0: 206c 6f67 6963 616c 0a20 2020 2020 2020   logical.       
-0001b0f0: 2074 6861 6e20 7068 7973 6963 616c 2073   than physical s
-0001b100: 697a 652c 2074 6869 7320 636f 7079 2063  ize, this copy c
-0001b110: 616e 2063 6175 7365 2065 7863 6573 7369  an cause excessi
-0001b120: 7665 206d 656d 6f72 7920 7573 6167 652e  ve memory usage.
-0001b130: 0a0a 2020 2020 2020 2020 4966 2079 6f75  ..        If you
-0001b140: 2064 6f6e 2774 206e 6565 6420 7468 6520   don't need the 
-0001b150: 6465 6475 706c 6963 6174 696f 6e20 7072  deduplication pr
-0001b160: 6f76 6964 6564 2062 7920 6861 7368 696e  ovided by hashin
-0001b170: 672c 2075 7365 0a20 2020 2020 2020 2060  g, use.        `
-0001b180: 606e 616d 653d 4661 6c73 6560 6020 746f  `name=False`` to
-0001b190: 2067 656e 6572 6174 6520 6120 7261 6e64   generate a rand
-0001b1a0: 6f6d 206e 616d 6520 696e 7374 6561 6420  om name instead 
-0001b1b0: 6f66 2068 6173 6869 6e67 2c20 7768 6963  of hashing, whic
-0001b1c0: 680a 2020 2020 2020 2020 6176 6f69 6473  h.        avoids
-0001b1d0: 2074 6865 2070 6974 6661 6c6c 7320 6465   the pitfalls de
-0001b1e0: 7363 7269 6265 6420 6162 6f76 652e 2055  scribed above. U
-0001b1f0: 7369 6e67 2060 606e 616d 653d 5472 7565  sing ``name=True
-0001b200: 6060 2069 730a 2020 2020 2020 2020 6571  `` is.        eq
-0001b210: 7569 7661 6c65 6e74 2074 6f20 7468 6520  uivalent to the 
-0001b220: 6465 6661 756c 742e 0a0a 2020 2020 2020  default...      
-0001b230: 2020 4279 2064 6566 6175 6c74 2c20 6861    By default, ha
-0001b240: 7368 696e 6720 7573 6573 2070 7974 686f  shing uses pytho
-0001b250: 6e27 7320 7374 616e 6461 7264 2073 6861  n's standard sha
-0001b260: 312e 2054 6869 7320 6265 6861 7669 6f75  1. This behaviou
-0001b270: 7220 6361 6e20 6265 0a20 2020 2020 2020  r can be.       
-0001b280: 2063 6861 6e67 6564 2062 7920 696e 7374   changed by inst
-0001b290: 616c 6c69 6e67 2063 6974 7968 6173 682c  alling cityhash,
-0001b2a0: 2078 7868 6173 6820 6f72 206d 7572 6d75   xxhash or murmu
-0001b2b0: 7268 6173 682e 2049 6620 696e 7374 616c  rhash. If instal
-0001b2c0: 6c65 642c 0a20 2020 2020 2020 2061 206c  led,.        a l
-0001b2d0: 6172 6765 2d66 6163 746f 7220 7370 6565  arge-factor spee
-0001b2e0: 6475 7020 6361 6e20 6265 206f 6274 6169  dup can be obtai
-0001b2f0: 6e65 6420 696e 2074 6865 2074 6f6b 656e  ned in the token
-0001b300: 6973 6174 696f 6e20 7374 6570 2e0a 0a20  isation step... 
-0001b310: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
-0001b320: 0a0a 2020 2020 2020 2020 2020 2042 6563  ..           Bec
-0001b330: 6175 7365 2074 6869 7320 6060 6e61 6d65  ause this ``name
-0001b340: 6060 2069 7320 7573 6564 2061 7320 7468  `` is used as th
-0001b350: 6520 6b65 7920 696e 2074 6173 6b20 6772  e key in task gr
-0001b360: 6170 6873 2c20 796f 7520 7368 6f75 6c64  aphs, you should
-0001b370: 0a20 2020 2020 2020 2020 2020 656e 7375  .           ensu
-0001b380: 7265 2074 6861 7420 6974 2075 6e69 7175  re that it uniqu
-0001b390: 656c 7920 6964 656e 7469 6669 6573 2074  ely identifies t
-0001b3a0: 6865 2064 6174 6120 636f 6e74 6169 6e65  he data containe
-0001b3b0: 6420 7769 7468 696e 2e20 4966 0a20 2020  d within. If.   
-0001b3c0: 2020 2020 2020 2020 796f 7527 6420 6c69          you'd li
-0001b3d0: 6b65 2074 6f20 7072 6f76 6964 6520 6120  ke to provide a 
-0001b3e0: 6465 7363 7269 7074 6976 6520 6e61 6d65  descriptive name
-0001b3f0: 2074 6861 7420 6973 2073 7469 6c6c 2075   that is still u
-0001b400: 6e69 7175 652c 2063 6f6d 6269 6e65 0a20  nique, combine. 
-0001b410: 2020 2020 2020 2020 2020 7468 6520 6465            the de
-0001b420: 7363 7269 7074 6976 6520 6e61 6d65 2077  scriptive name w
-0001b430: 6974 6820 3a66 756e 633a 6064 6173 6b2e  ith :func:`dask.
-0001b440: 6261 7365 2e74 6f6b 656e 697a 6560 206f  base.tokenize` o
-0001b450: 6620 7468 650a 2020 2020 2020 2020 2020  f the.          
-0001b460: 2060 6061 7272 6179 5f6c 696b 6560 602e   ``array_like``.
-0001b470: 2053 6565 203a 7265 663a 6067 7261 7068   See :ref:`graph
-0001b480: 7360 2066 6f72 206d 6f72 652e 0a0a 2020  s` for more...  
-0001b490: 2020 6c6f 636b 203a 2062 6f6f 6c20 6f72    lock : bool or
-0001b4a0: 204c 6f63 6b2c 206f 7074 696f 6e61 6c0a   Lock, optional.
-0001b4b0: 2020 2020 2020 2020 4966 2060 6078 6060          If ``x``
-0001b4c0: 2064 6f65 736e 2774 2073 7570 706f 7274   doesn't support
-0001b4d0: 2063 6f6e 6375 7272 656e 7420 7265 6164   concurrent read
-0001b4e0: 7320 7468 656e 2070 726f 7669 6465 2061  s then provide a
-0001b4f0: 206c 6f63 6b20 6865 7265 2c20 6f72 0a20   lock here, or. 
-0001b500: 2020 2020 2020 2070 6173 7320 696e 2054         pass in T
-0001b510: 7275 6520 746f 2068 6176 6520 6461 736b  rue to have dask
-0001b520: 2e61 7272 6179 2063 7265 6174 6520 6f6e  .array create on
-0001b530: 6520 666f 7220 796f 752e 0a20 2020 2061  e for you..    a
-0001b540: 7361 7272 6179 203a 2062 6f6f 6c2c 206f  sarray : bool, o
-0001b550: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0001b560: 4966 2054 7275 6520 7468 656e 2063 616c  If True then cal
-0001b570: 6c20 6e70 2e61 7361 7272 6179 206f 6e20  l np.asarray on 
-0001b580: 6368 756e 6b73 2074 6f20 636f 6e76 6572  chunks to conver
-0001b590: 7420 7468 656d 2074 6f20 6e75 6d70 7920  t them to numpy 
-0001b5a0: 6172 7261 7973 2e0a 2020 2020 2020 2020  arrays..        
-0001b5b0: 4966 2046 616c 7365 2074 6865 6e20 6368  If False then ch
-0001b5c0: 756e 6b73 2061 7265 2070 6173 7365 6420  unks are passed 
-0001b5d0: 7468 726f 7567 6820 756e 6368 616e 6765  through unchange
-0001b5e0: 642e 0a20 2020 2020 2020 2049 6620 4e6f  d..        If No
-0001b5f0: 6e65 2028 6465 6661 756c 7429 2074 6865  ne (default) the
-0001b600: 6e20 7765 2075 7365 2054 7275 6520 6966  n we use True if
-0001b610: 2074 6865 2060 605f 5f61 7272 6179 5f66   the ``__array_f
-0001b620: 756e 6374 696f 6e5f 5f60 6020 6d65 7468  unction__`` meth
-0001b630: 6f64 0a20 2020 2020 2020 2069 7320 756e  od.        is un
-0001b640: 6465 6669 6e65 642e 0a0a 2020 2020 2020  defined...      
-0001b650: 2020 2e2e 206e 6f74 653a 3a0a 0a20 2020    .. note::..   
-0001b660: 2020 2020 2020 2020 2044 6173 6b20 646f           Dask do
-0001b670: 6573 206e 6f74 2070 7265 7365 7276 6520  es not preserve 
-0001b680: 7468 6520 6d65 6d6f 7279 206c 6179 6f75  the memory layou
-0001b690: 7420 6f66 2074 6865 206f 7269 6769 6e61  t of the origina
-0001b6a0: 6c20 6172 7261 7920 7768 656e 0a20 2020  l array when.   
-0001b6b0: 2020 2020 2020 2020 2074 6865 2061 7272           the arr
-0001b6c0: 6179 2069 7320 6372 6561 7465 6420 7573  ay is created us
-0001b6d0: 696e 6720 466f 7274 7261 6e20 7261 7468  ing Fortran rath
-0001b6e0: 6572 2074 6861 6e20 4320 6f72 6465 7269  er than C orderi
-0001b6f0: 6e67 2e0a 0a20 2020 2066 616e 6379 203a  ng...    fancy :
-0001b700: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
-0001b710: 2020 2020 2020 2020 4966 2060 6078 6060          If ``x``
-0001b720: 2064 6f65 736e 2774 2073 7570 706f 7274   doesn't support
-0001b730: 2066 616e 6379 2069 6e64 6578 696e 6720   fancy indexing 
-0001b740: 2865 2e67 2e20 696e 6465 7869 6e67 2077  (e.g. indexing w
-0001b750: 6974 6820 6c69 7374 7320 6f72 0a20 2020  ith lists or.   
-0001b760: 2020 2020 2061 7272 6179 7329 2074 6865       arrays) the
-0001b770: 6e20 7365 7420 746f 2046 616c 7365 2e20  n set to False. 
-0001b780: 4465 6661 756c 7420 6973 2054 7275 652e  Default is True.
-0001b790: 0a20 2020 206d 6574 6120 3a20 4172 7261  .    meta : Arra
-0001b7a0: 792d 6c69 6b65 2c20 6f70 7469 6f6e 616c  y-like, optional
-0001b7b0: 0a20 2020 2020 2020 2054 6865 206d 6574  .        The met
-0001b7c0: 6164 6174 6120 666f 7220 7468 6520 7265  adata for the re
-0001b7d0: 7375 6c74 696e 6720 6461 736b 2061 7272  sulting dask arr
-0001b7e0: 6179 2e20 2054 6869 7320 6973 2074 6865  ay.  This is the
-0001b7f0: 206b 696e 6420 6f66 2061 7272 6179 0a20   kind of array. 
-0001b800: 2020 2020 2020 2074 6861 7420 7769 6c6c         that will
-0001b810: 2072 6573 756c 7420 6672 6f6d 2073 6c69   result from sli
-0001b820: 6369 6e67 2074 6865 2069 6e70 7574 2061  cing the input a
-0001b830: 7272 6179 2e0a 2020 2020 2020 2020 4465  rray..        De
-0001b840: 6661 756c 7473 2074 6f20 7468 6520 696e  faults to the in
-0001b850: 7075 7420 6172 7261 792e 0a20 2020 2069  put array..    i
-0001b860: 6e6c 696e 655f 6172 7261 7920 3a20 626f  nline_array : bo
-0001b870: 6f6c 2c20 6465 6661 756c 7420 4661 6c73  ol, default Fals
-0001b880: 650a 2020 2020 2020 2020 486f 7720 746f  e.        How to
-0001b890: 2069 6e63 6c75 6465 2074 6865 2061 7272   include the arr
-0001b8a0: 6179 2069 6e20 7468 6520 7461 736b 2067  ay in the task g
-0001b8b0: 7261 7068 2e20 4279 2064 6566 6175 6c74  raph. By default
-0001b8c0: 0a20 2020 2020 2020 2028 6060 696e 6c69  .        (``inli
-0001b8d0: 6e65 5f61 7272 6179 3d46 616c 7365 6060  ne_array=False``
-0001b8e0: 2920 7468 6520 6172 7261 7920 6973 2069  ) the array is i
-0001b8f0: 6e63 6c75 6465 6420 696e 2061 2074 6173  ncluded in a tas
-0001b900: 6b20 6279 2069 7473 656c 662c 0a20 2020  k by itself,.   
-0001b910: 2020 2020 2061 6e64 2065 6163 6820 6368       and each ch
-0001b920: 756e 6b20 7265 6665 7273 2074 6f20 7468  unk refers to th
-0001b930: 6174 2074 6173 6b20 6279 2069 7473 206b  at task by its k
-0001b940: 6579 2e0a 0a20 2020 2020 2020 202e 2e20  ey...        .. 
-0001b950: 636f 6465 2d62 6c6f 636b 3a3a 2070 7974  code-block:: pyt
-0001b960: 686f 6e0a 0a20 2020 2020 2020 2020 2020  hon..           
-0001b970: 3e3e 3e20 7820 3d20 6835 7079 2e46 696c  >>> x = h5py.Fil
-0001b980: 6528 2264 6174 612e 6835 2229 5b22 2f78  e("data.h5")["/x
-0001b990: 225d 2020 2320 646f 6374 6573 743a 202b  "]  # doctest: +
-0001b9a0: 534b 4950 0a20 2020 2020 2020 2020 2020  SKIP.           
-0001b9b0: 3e3e 3e20 6120 3d20 6461 2e66 726f 6d5f  >>> a = da.from_
-0001b9c0: 6172 7261 7928 782c 2063 6875 6e6b 733d  array(x, chunks=
-0001b9d0: 3530 3029 2020 2320 646f 6374 6573 743a  500)  # doctest:
-0001b9e0: 202b 534b 4950 0a20 2020 2020 2020 2020   +SKIP.         
-0001b9f0: 2020 3e3e 3e20 6469 6374 2861 2e64 6173    >>> dict(a.das
-0001ba00: 6b29 2020 2320 646f 6374 6573 743a 202b  k)  # doctest: +
-0001ba10: 534b 4950 0a20 2020 2020 2020 2020 2020  SKIP.           
-0001ba20: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-0001ba30: 2761 7272 6179 2d6f 7269 6769 6e61 6c2d  'array-original-
-0001ba40: 3c6e 616d 653e 273a 203c 4844 4635 2064  <name>': <HDF5 d
-0001ba50: 6174 6173 6574 202e 2e2e 3e2c 0a20 2020  ataset ...>,.   
-0001ba60: 2020 2020 2020 2020 2020 2028 2761 7272             ('arr
-0001ba70: 6179 2d3c 6e61 6d65 3e27 2c20 3029 3a20  ay-<name>', 0): 
-0001ba80: 2867 6574 6974 656d 2c20 2261 7272 6179  (getitem, "array
-0001ba90: 2d6f 7269 6769 6e61 6c2d 3c6e 616d 653e  -original-<name>
-0001baa0: 222c 202e 2e2e 292c 0a20 2020 2020 2020  ", ...),.       
-0001bab0: 2020 2020 2020 2028 2761 7272 6179 2d3c         ('array-<
-0001bac0: 6e61 6d65 3e27 2c20 3129 3a20 2867 6574  name>', 1): (get
-0001bad0: 6974 656d 2c20 2261 7272 6179 2d6f 7269  item, "array-ori
-0001bae0: 6769 6e61 6c2d 3c6e 616d 653e 222c 202e  ginal-<name>", .
-0001baf0: 2e2e 290a 2020 2020 2020 2020 2020 207d  ..).           }
-0001bb00: 0a0a 2020 2020 2020 2020 5769 7468 2060  ..        With `
-0001bb10: 6069 6e6c 696e 655f 6172 7261 793d 5472  `inline_array=Tr
-0001bb20: 7565 6060 2c20 4461 736b 2077 696c 6c20  ue``, Dask will 
-0001bb30: 696e 7374 6561 6420 696e 6c69 6e65 2074  instead inline t
-0001bb40: 6865 2061 7272 6179 2064 6972 6563 746c  he array directl
-0001bb50: 790a 2020 2020 2020 2020 696e 2074 6865  y.        in the
-0001bb60: 2076 616c 7565 7320 6f66 2074 6865 2074   values of the t
-0001bb70: 6173 6b20 6772 6170 682e 0a0a 2020 2020  ask graph...    
-0001bb80: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
-0001bb90: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
-0001bba0: 2020 2020 2020 203e 3e3e 2061 203d 2064         >>> a = d
-0001bbb0: 612e 6672 6f6d 5f61 7272 6179 2878 2c20  a.from_array(x, 
-0001bbc0: 6368 756e 6b73 3d35 3030 2c20 696e 6c69  chunks=500, inli
-0001bbd0: 6e65 5f61 7272 6179 3d54 7275 6529 2020  ne_array=True)  
-0001bbe0: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-0001bbf0: 0a20 2020 2020 2020 2020 2020 3e3e 3e20  .           >>> 
-0001bc00: 6469 6374 2861 2e64 6173 6b29 2020 2320  dict(a.dask)  # 
-0001bc10: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0001bc20: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-0001bc30: 2020 2020 2020 2020 2020 2827 6172 7261            ('arra
-0001bc40: 792d 3c6e 616d 653e 272c 2030 293a 2028  y-<name>', 0): (
-0001bc50: 6765 7469 7465 6d2c 203c 4844 4635 2064  getitem, <HDF5 d
-0001bc60: 6174 6173 6574 202e 2e2e 3e2c 202e 2e2e  ataset ...>, ...
-0001bc70: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0001bc80: 2028 2761 7272 6179 2d3c 6e61 6d65 3e27   ('array-<name>'
-0001bc90: 2c20 3129 3a20 2867 6574 6974 656d 2c20  , 1): (getitem, 
-0001bca0: 3c48 4446 3520 6461 7461 7365 7420 2e2e  <HDF5 dataset ..
-0001bcb0: 2e3e 2c20 2e2e 2e29 0a20 2020 2020 2020  .>, ...).       
-0001bcc0: 2020 2020 7d0a 0a20 2020 2020 2020 204e      }..        N
-0001bcd0: 6f74 6520 7468 6174 2074 6865 7265 2773  ote that there's
-0001bce0: 206e 6f20 6b65 7920 696e 2074 6865 2074   no key in the t
-0001bcf0: 6173 6b20 6772 6170 6820 7769 7468 206a  ask graph with j
-0001bd00: 7573 7420 7468 6520 6172 7261 7920 6078  ust the array `x
-0001bd10: 600a 2020 2020 2020 2020 616e 796d 6f72  `.        anymor
-0001bd20: 652e 2049 6e73 7465 6164 2069 7427 7320  e. Instead it's 
-0001bd30: 706c 6163 6564 2064 6972 6563 746c 7920  placed directly 
-0001bd40: 696e 2074 6865 2076 616c 7565 732e 0a0a  in the values...
-0001bd50: 2020 2020 2020 2020 5468 6520 7269 6768          The righ
-0001bd60: 7420 6368 6f69 6365 2066 6f72 2060 6069  t choice for ``i
-0001bd70: 6e6c 696e 655f 6172 7261 7960 6020 6465  nline_array`` de
-0001bd80: 7065 6e64 7320 6f6e 2073 6576 6572 616c  pends on several
-0001bd90: 2066 6163 746f 7273 2c0a 2020 2020 2020   factors,.      
-0001bda0: 2020 696e 636c 7564 696e 6720 7468 6520    including the 
-0001bdb0: 7369 7a65 206f 6620 6060 7860 602c 2068  size of ``x``, h
-0001bdc0: 6f77 2065 7870 656e 7369 7665 2069 7420  ow expensive it 
-0001bdd0: 6973 2074 6f20 6372 6561 7465 2c20 7768  is to create, wh
-0001bde0: 6963 680a 2020 2020 2020 2020 7363 6865  ich.        sche
-0001bdf0: 6475 6c65 7220 796f 7527 7265 2075 7369  duler you're usi
-0001be00: 6e67 2c20 616e 6420 7468 6520 7061 7474  ng, and the patt
-0001be10: 6572 6e20 6f66 2064 6f77 6e73 7472 6561  ern of downstrea
-0001be20: 6d20 636f 6d70 7574 6174 696f 6e73 2e0a  m computations..
-0001be30: 2020 2020 2020 2020 4173 2061 2068 6575          As a heu
-0001be40: 7269 7374 6963 2c20 6060 696e 6c69 6e65  ristic, ``inline
-0001be50: 5f61 7272 6179 3d54 7275 6560 6020 6d61  _array=True`` ma
-0001be60: 7920 6265 2074 6865 2072 6967 6874 2063  y be the right c
-0001be70: 686f 6963 6520 7768 656e 0a20 2020 2020  hoice when.     
-0001be80: 2020 2074 6865 2061 7272 6179 2060 6078     the array ``x
-0001be90: 6060 2069 7320 6368 6561 7020 746f 2073  `` is cheap to s
-0001bea0: 6572 6961 6c69 7a65 2061 6e64 2064 6573  erialize and des
-0001beb0: 6572 6961 6c69 7a65 2028 7369 6e63 6520  erialize (since 
-0001bec0: 6974 2773 0a20 2020 2020 2020 2069 6e63  it's.        inc
-0001bed0: 6c75 6465 6420 696e 2074 6865 2067 7261  luded in the gra
-0001bee0: 7068 206d 616e 7920 7469 6d65 7329 2061  ph many times) a
-0001bef0: 6e64 2069 6620 796f 7527 7265 2065 7870  nd if you're exp
-0001bf00: 6572 6965 6e63 696e 6720 6f72 6465 7269  eriencing orderi
-0001bf10: 6e67 0a20 2020 2020 2020 2069 7373 7565  ng.        issue
-0001bf20: 7320 2873 6565 203a 7265 663a 606f 7264  s (see :ref:`ord
-0001bf30: 6572 6020 666f 7220 6d6f 7265 292e 0a0a  er` for more)...
-0001bf40: 2020 2020 2020 2020 5468 6973 2068 6173          This has
-0001bf50: 206e 6f20 6566 6665 6374 2077 6865 6e20   no effect when 
-0001bf60: 6060 7860 6020 6973 2061 204e 756d 5079  ``x`` is a NumPy
-0001bf70: 2061 7272 6179 2e0a 0a20 2020 2045 7861   array...    Exa
-0001bf80: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
-0001bf90: 2d2d 0a0a 2020 2020 3e3e 3e20 7820 3d20  --..    >>> x = 
-0001bfa0: 6835 7079 2e46 696c 6528 272e 2e2e 2729  h5py.File('...')
-0001bfb0: 5b27 2f64 6174 612f 7061 7468 275d 2020  ['/data/path']  
-0001bfc0: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-0001bfd0: 0a20 2020 203e 3e3e 2061 203d 2064 612e  .    >>> a = da.
-0001bfe0: 6672 6f6d 5f61 7272 6179 2878 2c20 6368  from_array(x, ch
-0001bff0: 756e 6b73 3d28 3130 3030 2c20 3130 3030  unks=(1000, 1000
-0001c000: 2929 2020 2320 646f 6374 6573 743a 202b  ))  # doctest: +
-0001c010: 534b 4950 0a0a 2020 2020 4966 2079 6f75  SKIP..    If you
-0001c020: 7220 756e 6465 726c 7969 6e67 2064 6174  r underlying dat
-0001c030: 6173 746f 7265 2064 6f65 7320 6e6f 7420  astore does not 
-0001c040: 7375 7070 6f72 7420 636f 6e63 7572 7265  support concurre
-0001c050: 6e74 2072 6561 6473 2074 6865 6e20 696e  nt reads then in
-0001c060: 636c 7564 650a 2020 2020 7468 6520 6060  clude.    the ``
-0001c070: 6c6f 636b 3d54 7275 6560 6020 6b65 7977  lock=True`` keyw
-0001c080: 6f72 6420 6172 6775 6d65 6e74 206f 7220  ord argument or 
-0001c090: 6060 6c6f 636b 3d6d 796c 6f63 6b60 6020  ``lock=mylock`` 
-0001c0a0: 6966 2079 6f75 2077 616e 7420 6d75 6c74  if you want mult
-0001c0b0: 6970 6c65 0a20 2020 2061 7272 6179 7320  iple.    arrays 
-0001c0c0: 746f 2063 6f6f 7264 696e 6174 6520 6172  to coordinate ar
-0001c0d0: 6f75 6e64 2074 6865 2073 616d 6520 6c6f  ound the same lo
-0001c0e0: 636b 2e0a 0a20 2020 203e 3e3e 2061 203d  ck...    >>> a =
-0001c0f0: 2064 612e 6672 6f6d 5f61 7272 6179 2878   da.from_array(x
-0001c100: 2c20 6368 756e 6b73 3d28 3130 3030 2c20  , chunks=(1000, 
-0001c110: 3130 3030 292c 206c 6f63 6b3d 5472 7565  1000), lock=True
-0001c120: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-0001c130: 4b49 500a 0a20 2020 2049 6620 796f 7572  KIP..    If your
-0001c140: 2075 6e64 6572 6c79 696e 6720 6461 7461   underlying data
-0001c150: 7374 6f72 6520 6861 7320 6120 6060 2e63  store has a ``.c
-0001c160: 6875 6e6b 7360 6020 6174 7472 6962 7574  hunks`` attribut
-0001c170: 6520 2861 7320 6835 7079 2061 6e64 207a  e (as h5py and z
-0001c180: 6172 720a 2020 2020 6461 7461 7365 7473  arr.    datasets
-0001c190: 2064 6f29 2074 6865 6e20 6120 6d75 6c74   do) then a mult
-0001c1a0: 6970 6c65 206f 6620 7468 6174 2063 6875  iple of that chu
-0001c1b0: 6e6b 2073 6861 7065 2077 696c 6c20 6265  nk shape will be
-0001c1c0: 2075 7365 6420 6966 2079 6f75 0a20 2020   used if you.   
-0001c1d0: 2064 6f20 6e6f 7420 7072 6f76 6964 6520   do not provide 
-0001c1e0: 6120 6368 756e 6b20 7368 6170 652e 0a0a  a chunk shape...
-0001c1f0: 2020 2020 3e3e 3e20 6120 3d20 6461 2e66      >>> a = da.f
-0001c200: 726f 6d5f 6172 7261 7928 782c 2063 6875  rom_array(x, chu
-0001c210: 6e6b 733d 2761 7574 6f27 2920 2023 2064  nks='auto')  # d
-0001c220: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
-0001c230: 2020 3e3e 3e20 6120 3d20 6461 2e66 726f    >>> a = da.fro
-0001c240: 6d5f 6172 7261 7928 782c 2063 6875 6e6b  m_array(x, chunk
-0001c250: 733d 2731 3030 204d 6942 2729 2020 2320  s='100 MiB')  # 
-0001c260: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0001c270: 2020 203e 3e3e 2061 203d 2064 612e 6672     >>> a = da.fr
-0001c280: 6f6d 5f61 7272 6179 2878 2920 2023 2064  om_array(x)  # d
-0001c290: 6f63 7465 7374 3a20 2b53 4b49 500a 0a20  octest: +SKIP.. 
-0001c2a0: 2020 2049 6620 7072 6f76 6964 696e 6720     If providing 
-0001c2b0: 6120 6e61 6d65 2c20 656e 7375 7265 2074  a name, ensure t
-0001c2c0: 6861 7420 6974 2069 7320 756e 6971 7565  hat it is unique
-0001c2d0: 0a0a 2020 2020 3e3e 3e20 696d 706f 7274  ..    >>> import
-0001c2e0: 2064 6173 6b2e 6261 7365 0a20 2020 203e   dask.base.    >
-0001c2f0: 3e3e 2074 6f6b 656e 203d 2064 6173 6b2e  >> token = dask.
-0001c300: 6261 7365 2e74 6f6b 656e 697a 6528 7829  base.tokenize(x)
-0001c310: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0001c320: 4950 0a20 2020 203e 3e3e 2061 203d 2064  IP.    >>> a = d
-0001c330: 612e 6672 6f6d 5f61 7272 6179 2827 6d79  a.from_array('my
-0001c340: 6172 7261 792d 2720 2b20 746f 6b65 6e29  array-' + token)
-0001c350: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0001c360: 4950 0a0a 2020 2020 4e75 6d50 7920 6e64  IP..    NumPy nd
-0001c370: 6172 7261 7973 2061 7265 2065 6167 6572  arrays are eager
-0001c380: 6c79 2073 6c69 6365 6420 616e 6420 7468  ly sliced and th
-0001c390: 656e 2065 6d62 6564 6465 6420 696e 2074  en embedded in t
-0001c3a0: 6865 2067 7261 7068 2e0a 0a20 2020 203e  he graph...    >
-0001c3b0: 3e3e 2069 6d70 6f72 7420 6461 736b 2e61  >> import dask.a
-0001c3c0: 7272 6179 0a20 2020 203e 3e3e 2061 203d  rray.    >>> a =
-0001c3d0: 2064 6173 6b2e 6172 7261 792e 6672 6f6d   dask.array.from
-0001c3e0: 5f61 7272 6179 286e 702e 6172 7261 7928  _array(np.array(
-0001c3f0: 5b5b 312c 2032 5d2c 205b 332c 2034 5d5d  [[1, 2], [3, 4]]
-0001c400: 292c 2063 6875 6e6b 733d 2831 2c31 2929  ), chunks=(1,1))
-0001c410: 0a20 2020 203e 3e3e 2061 2e64 6173 6b5b  .    >>> a.dask[
-0001c420: 612e 6e61 6d65 2c20 302c 2030 5d5b 305d  a.name, 0, 0][0]
-0001c430: 0a20 2020 2061 7272 6179 285b 315d 290a  .    array([1]).
-0001c440: 0a20 2020 2043 6875 6e6b 7320 7769 7468  .    Chunks with
-0001c450: 2065 7861 6374 6c79 2d73 7065 6369 6669   exactly-specifi
-0001c460: 6564 2c20 6469 6666 6572 656e 7420 7369  ed, different si
-0001c470: 7a65 7320 6361 6e20 6265 2063 7265 6174  zes can be creat
-0001c480: 6564 2e0a 0a20 2020 203e 3e3e 2069 6d70  ed...    >>> imp
-0001c490: 6f72 7420 6e75 6d70 7920 6173 206e 700a  ort numpy as np.
-0001c4a0: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-0001c4b0: 6173 6b2e 6172 7261 7920 6173 2064 610a  ask.array as da.
-0001c4c0: 2020 2020 3e3e 3e20 726e 6720 3d20 6e70      >>> rng = np
-0001c4d0: 2e72 616e 646f 6d2e 6465 6661 756c 745f  .random.default_
-0001c4e0: 726e 6728 290a 2020 2020 3e3e 3e20 7820  rng().    >>> x 
-0001c4f0: 3d20 726e 672e 7261 6e64 6f6d 2828 3130  = rng.random((10
-0001c500: 302c 2036 2929 0a20 2020 203e 3e3e 2061  0, 6)).    >>> a
-0001c510: 203d 2064 612e 6672 6f6d 5f61 7272 6179   = da.from_array
-0001c520: 2878 2c20 6368 756e 6b73 3d28 2836 372c  (x, chunks=((67,
-0001c530: 2033 3329 2c20 2836 2c29 2929 0a20 2020   33), (6,))).   
-0001c540: 2022 2222 0a20 2020 2069 6620 6973 696e   """.    if isin
-0001c550: 7374 616e 6365 2878 2c20 4172 7261 7929  stance(x, Array)
-0001c560: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-0001c570: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-0001c580: 2020 2020 2020 2020 2241 7272 6179 2069          "Array i
-0001c590: 7320 616c 7265 6164 7920 6120 6461 736b  s already a dask
-0001c5a0: 2061 7272 6179 2e20 5573 6520 2761 7361   array. Use 'asa
-0001c5b0: 7272 6179 2720 6f72 2022 2022 2772 6563  rray' or " "'rec
-0001c5c0: 6875 6e6b 2720 696e 7374 6561 642e 220a  hunk' instead.".
-0001c5d0: 2020 2020 2020 2020 290a 2020 2020 656c          ).    el
-0001c5e0: 6966 2069 735f 6461 736b 5f63 6f6c 6c65  if is_dask_colle
-0001c5f0: 6374 696f 6e28 7829 3a0a 2020 2020 2020  ction(x):.      
-0001c600: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-0001c610: 0a20 2020 2020 2020 2020 2020 2022 5061  .            "Pa
-0001c620: 7373 696e 6720 616e 206f 626a 6563 7420  ssing an object 
-0001c630: 746f 2064 6173 6b2e 6172 7261 792e 6672  to dask.array.fr
-0001c640: 6f6d 5f61 7272 6179 2077 6869 6368 2069  om_array which i
-0001c650: 7320 616c 7265 6164 7920 6120 220a 2020  s already a ".  
-0001c660: 2020 2020 2020 2020 2020 2244 6173 6b20            "Dask 
-0001c670: 636f 6c6c 6563 7469 6f6e 2e20 5468 6973  collection. This
-0001c680: 2063 616e 206c 6561 6420 746f 2075 6e65   can lead to une
-0001c690: 7870 6563 7465 6420 6265 6861 7669 6f72  xpected behavior
-0001c6a0: 2e22 0a20 2020 2020 2020 2029 0a0a 2020  .".        )..  
-0001c6b0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001c6c0: 782c 2028 6c69 7374 2c20 7475 706c 652c  x, (list, tuple,
-0001c6d0: 206d 656d 6f72 7976 6965 7729 202b 206e   memoryview) + n
-0001c6e0: 702e 5363 616c 6172 5479 7065 293a 0a20  p.ScalarType):. 
-0001c6f0: 2020 2020 2020 2078 203d 206e 702e 6172         x = np.ar
-0001c700: 7261 7928 7829 0a0a 2020 2020 6966 2061  ray(x)..    if a
-0001c710: 7361 7272 6179 2069 7320 4e6f 6e65 3a0a  sarray is None:.
-0001c720: 2020 2020 2020 2020 6173 6172 7261 7920          asarray 
-0001c730: 3d20 6e6f 7420 6861 7361 7474 7228 782c  = not hasattr(x,
-0001c740: 2022 5f5f 6172 7261 795f 6675 6e63 7469   "__array_functi
-0001c750: 6f6e 5f5f 2229 0a0a 2020 2020 7072 6576  on__")..    prev
-0001c760: 696f 7573 5f63 6875 6e6b 7320 3d20 6765  ious_chunks = ge
-0001c770: 7461 7474 7228 782c 2022 6368 756e 6b73  tattr(x, "chunks
-0001c780: 222c 204e 6f6e 6529 0a0a 2020 2020 6368  ", None)..    ch
-0001c790: 756e 6b73 203d 206e 6f72 6d61 6c69 7a65  unks = normalize
-0001c7a0: 5f63 6875 6e6b 7328 0a20 2020 2020 2020  _chunks(.       
-0001c7b0: 2063 6875 6e6b 732c 2078 2e73 6861 7065   chunks, x.shape
-0001c7c0: 2c20 6474 7970 653d 782e 6474 7970 652c  , dtype=x.dtype,
-0001c7d0: 2070 7265 7669 6f75 735f 6368 756e 6b73   previous_chunks
-0001c7e0: 3d70 7265 7669 6f75 735f 6368 756e 6b73  =previous_chunks
-0001c7f0: 0a20 2020 2029 0a0a 2020 2020 6966 206e  .    )..    if n
-0001c800: 616d 6520 696e 2028 4e6f 6e65 2c20 5472  ame in (None, Tr
-0001c810: 7565 293a 0a20 2020 2020 2020 2074 6f6b  ue):.        tok
-0001c820: 656e 203d 2074 6f6b 656e 697a 6528 782c  en = tokenize(x,
-0001c830: 2063 6875 6e6b 732c 206c 6f63 6b2c 2061   chunks, lock, a
-0001c840: 7361 7272 6179 2c20 6661 6e63 792c 2067  sarray, fancy, g
-0001c850: 6574 6974 656d 2c20 696e 6c69 6e65 5f61  etitem, inline_a
-0001c860: 7272 6179 290a 2020 2020 2020 2020 6e61  rray).        na
-0001c870: 6d65 203d 206e 616d 6520 6f72 2022 6172  me = name or "ar
-0001c880: 7261 792d 2220 2b20 746f 6b65 6e0a 2020  ray-" + token.  
-0001c890: 2020 656c 6966 206e 616d 6520 6973 2046    elif name is F
-0001c8a0: 616c 7365 3a0a 2020 2020 2020 2020 6e61  alse:.        na
-0001c8b0: 6d65 203d 2022 6172 7261 792d 2220 2b20  me = "array-" + 
-0001c8c0: 7374 7228 7575 6964 2e75 7569 6431 2829  str(uuid.uuid1()
-0001c8d0: 290a 0a20 2020 2069 6620 6c6f 636b 2069  )..    if lock i
-0001c8e0: 7320 5472 7565 3a0a 2020 2020 2020 2020  s True:.        
-0001c8f0: 6c6f 636b 203d 2053 6572 6961 6c69 7a61  lock = Serializa
-0001c900: 626c 654c 6f63 6b28 290a 0a20 2020 2069  bleLock()..    i
-0001c910: 735f 6e64 6172 7261 7920 3d20 7479 7065  s_ndarray = type
-0001c920: 2878 2920 696e 2028 6e70 2e6e 6461 7272  (x) in (np.ndarr
-0001c930: 6179 2c20 6e70 2e6d 612e 636f 7265 2e4d  ay, np.ma.core.M
-0001c940: 6173 6b65 6441 7272 6179 290a 2020 2020  askedArray).    
-0001c950: 6973 5f73 696e 676c 655f 626c 6f63 6b20  is_single_block 
-0001c960: 3d20 616c 6c28 6c65 6e28 6329 203d 3d20  = all(len(c) == 
-0001c970: 3120 666f 7220 6320 696e 2063 6875 6e6b  1 for c in chunk
-0001c980: 7329 0a20 2020 2023 2041 6c77 6179 7320  s).    # Always 
-0001c990: 7573 6520 7468 6520 6765 7474 6572 2066  use the getter f
-0001c9a0: 6f72 2068 3570 7920 6574 632e 204e 6f74  or h5py etc. Not
-0001c9b0: 2075 7369 6e67 2069 7369 6e73 7461 6e63   using isinstanc
-0001c9c0: 6528 782c 206e 702e 6e64 6172 7261 7929  e(x, np.ndarray)
-0001c9d0: 0a20 2020 2023 2062 6563 6175 7365 206e  .    # because n
-0001c9e0: 702e 6d61 7472 6978 2069 7320 6120 7375  p.matrix is a su
-0001c9f0: 6263 6c61 7373 206f 6620 6e70 2e6e 6461  bclass of np.nda
-0001ca00: 7272 6179 2e0a 2020 2020 6966 2069 735f  rray..    if is_
-0001ca10: 6e64 6172 7261 7920 616e 6420 6e6f 7420  ndarray and not 
-0001ca20: 6973 5f73 696e 676c 655f 626c 6f63 6b20  is_single_block 
-0001ca30: 616e 6420 6e6f 7420 6c6f 636b 3a0a 2020  and not lock:.  
-0001ca40: 2020 2020 2020 2320 6561 6765 726c 7920        # eagerly 
-0001ca50: 736c 6963 6520 6e75 6d70 7920 6172 7261  slice numpy arra
-0001ca60: 7973 2074 6f20 7072 6576 656e 7420 6d65  ys to prevent me
-0001ca70: 6d6f 7279 2062 6c6f 7775 700a 2020 2020  mory blowup.    
-0001ca80: 2020 2020 2320 4748 3533 3637 2c20 4748      # GH5367, GH
-0001ca90: 3536 3031 0a20 2020 2020 2020 2073 6c69  5601.        sli
-0001caa0: 6365 7320 3d20 736c 6963 6573 5f66 726f  ces = slices_fro
-0001cab0: 6d5f 6368 756e 6b73 2863 6875 6e6b 7329  m_chunks(chunks)
-0001cac0: 0a20 2020 2020 2020 206b 6579 7320 3d20  .        keys = 
-0001cad0: 7072 6f64 7563 7428 5b6e 616d 655d 2c20  product([name], 
-0001cae0: 2a28 7261 6e67 6528 6c65 6e28 6264 7329  *(range(len(bds)
-0001caf0: 2920 666f 7220 6264 7320 696e 2063 6875  ) for bds in chu
-0001cb00: 6e6b 7329 290a 2020 2020 2020 2020 7661  nks)).        va
-0001cb10: 6c75 6573 203d 205b 785b 736c 635d 2066  lues = [x[slc] f
-0001cb20: 6f72 2073 6c63 2069 6e20 736c 6963 6573  or slc in slices
-0001cb30: 5d0a 2020 2020 2020 2020 6473 6b20 3d20  ].        dsk = 
-0001cb40: 6469 6374 287a 6970 286b 6579 732c 2076  dict(zip(keys, v
-0001cb50: 616c 7565 7329 290a 0a20 2020 2065 6c69  alues))..    eli
-0001cb60: 6620 6973 5f6e 6461 7272 6179 2061 6e64  f is_ndarray and
-0001cb70: 2069 735f 7369 6e67 6c65 5f62 6c6f 636b   is_single_block
-0001cb80: 3a0a 2020 2020 2020 2020 2320 4e6f 2073  :.        # No s
-0001cb90: 6c69 6369 6e67 206e 6565 6465 640a 2020  licing needed.  
-0001cba0: 2020 2020 2020 6473 6b20 3d20 7b28 6e61        dsk = {(na
-0001cbb0: 6d65 2c29 202b 2028 302c 2920 2a20 782e  me,) + (0,) * x.
-0001cbc0: 6e64 696d 3a20 787d 0a20 2020 2065 6c73  ndim: x}.    els
-0001cbd0: 653a 0a20 2020 2020 2020 2069 6620 6765  e:.        if ge
-0001cbe0: 7469 7465 6d20 6973 204e 6f6e 653a 0a20  titem is None:. 
-0001cbf0: 2020 2020 2020 2020 2020 2069 6620 6661             if fa
-0001cc00: 6e63 793a 0a20 2020 2020 2020 2020 2020  ncy:.           
-0001cc10: 2020 2020 2067 6574 6974 656d 203d 2067       getitem = g
-0001cc20: 6574 7465 720a 2020 2020 2020 2020 2020  etter.          
-0001cc30: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001cc40: 2020 2020 2020 2020 6765 7469 7465 6d20          getitem 
-0001cc50: 3d20 6765 7474 6572 5f6e 6f66 616e 6379  = getter_nofancy
-0001cc60: 0a0a 2020 2020 2020 2020 6473 6b20 3d20  ..        dsk = 
-0001cc70: 6772 6170 685f 6672 6f6d 5f61 7272 6179  graph_from_array
-0001cc80: 6c69 6b65 280a 2020 2020 2020 2020 2020  like(.          
-0001cc90: 2020 782c 0a20 2020 2020 2020 2020 2020    x,.           
-0001cca0: 2063 6875 6e6b 732c 0a20 2020 2020 2020   chunks,.       
-0001ccb0: 2020 2020 2078 2e73 6861 7065 2c0a 2020       x.shape,.  
-0001ccc0: 2020 2020 2020 2020 2020 6e61 6d65 2c0a            name,.
-0001ccd0: 2020 2020 2020 2020 2020 2020 6765 7469              geti
-0001cce0: 7465 6d3d 6765 7469 7465 6d2c 0a20 2020  tem=getitem,.   
-0001ccf0: 2020 2020 2020 2020 206c 6f63 6b3d 6c6f           lock=lo
-0001cd00: 636b 2c0a 2020 2020 2020 2020 2020 2020  ck,.            
-0001cd10: 6173 6172 7261 793d 6173 6172 7261 792c  asarray=asarray,
-0001cd20: 0a20 2020 2020 2020 2020 2020 2064 7479  .            dty
-0001cd30: 7065 3d78 2e64 7479 7065 2c0a 2020 2020  pe=x.dtype,.    
-0001cd40: 2020 2020 2020 2020 696e 6c69 6e65 5f61          inline_a
-0001cd50: 7272 6179 3d69 6e6c 696e 655f 6172 7261  rray=inline_arra
-0001cd60: 792c 0a20 2020 2020 2020 2029 0a0a 2020  y,.        )..  
-0001cd70: 2020 2320 576f 726b 6172 6f75 6e64 2066    # Workaround f
-0001cd80: 6f72 2054 696c 6544 422c 2069 7473 2069  or TileDB, its i
-0001cd90: 6e64 6578 696e 6720 6973 2031 2d62 6173  ndexing is 1-bas
-0001cda0: 6564 2c0a 2020 2020 2320 616e 6420 646f  ed,.    # and do
-0001cdb0: 6573 6e27 7420 7365 656d 7320 746f 2073  esn't seems to s
-0001cdc0: 7570 706f 7274 2030 2d6c 656e 6774 6820  upport 0-length 
-0001cdd0: 736c 6963 696e 670a 2020 2020 6966 2078  slicing.    if x
-0001cde0: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6d 6f64  .__class__.__mod
-0001cdf0: 756c 655f 5f2e 7370 6c69 7428 222e 2229  ule__.split(".")
-0001ce00: 5b30 5d20 3d3d 2022 7469 6c65 6462 2220  [0] == "tiledb" 
-0001ce10: 616e 6420 6861 7361 7474 7228 782c 2022  and hasattr(x, "
-0001ce20: 5f63 7478 5f22 293a 0a20 2020 2020 2020  _ctx_"):.       
-0001ce30: 2072 6574 7572 6e20 4172 7261 7928 6473   return Array(ds
-0001ce40: 6b2c 206e 616d 652c 2063 6875 6e6b 732c  k, name, chunks,
-0001ce50: 2064 7479 7065 3d78 2e64 7479 7065 290a   dtype=x.dtype).
-0001ce60: 0a20 2020 2069 6620 6d65 7461 2069 7320  .    if meta is 
-0001ce70: 4e6f 6e65 3a0a 2020 2020 2020 2020 6d65  None:.        me
-0001ce80: 7461 203d 2078 0a0a 2020 2020 7265 7475  ta = x..    retu
-0001ce90: 726e 2041 7272 6179 2864 736b 2c20 6e61  rn Array(dsk, na
-0001cea0: 6d65 2c20 6368 756e 6b73 2c20 6d65 7461  me, chunks, meta
-0001ceb0: 3d6d 6574 612c 2064 7479 7065 3d67 6574  =meta, dtype=get
-0001cec0: 6174 7472 2878 2c20 2264 7479 7065 222c  attr(x, "dtype",
-0001ced0: 204e 6f6e 6529 290a 0a0a 6465 6620 6672   None))...def fr
-0001cee0: 6f6d 5f7a 6172 7228 0a20 2020 2075 726c  om_zarr(.    url
-0001cef0: 2c0a 2020 2020 636f 6d70 6f6e 656e 743d  ,.    component=
-0001cf00: 4e6f 6e65 2c0a 2020 2020 7374 6f72 6167  None,.    storag
-0001cf10: 655f 6f70 7469 6f6e 733d 4e6f 6e65 2c0a  e_options=None,.
-0001cf20: 2020 2020 6368 756e 6b73 3d4e 6f6e 652c      chunks=None,
-0001cf30: 0a20 2020 206e 616d 653d 4e6f 6e65 2c0a  .    name=None,.
-0001cf40: 2020 2020 696e 6c69 6e65 5f61 7272 6179      inline_array
-0001cf50: 3d46 616c 7365 2c0a 2020 2020 2a2a 6b77  =False,.    **kw
-0001cf60: 6172 6773 2c0a 293a 0a20 2020 2022 2222  args,.):.    """
-0001cf70: 4c6f 6164 2061 7272 6179 2066 726f 6d20  Load array from 
-0001cf80: 7468 6520 7a61 7272 2073 746f 7261 6765  the zarr storage
-0001cf90: 2066 6f72 6d61 740a 0a20 2020 2053 6565   format..    See
-0001cfa0: 2068 7474 7073 3a2f 2f7a 6172 722e 7265   https://zarr.re
-0001cfb0: 6164 7468 6564 6f63 732e 696f 2066 6f72  adthedocs.io for
-0001cfc0: 2064 6574 6169 6c73 2061 626f 7574 2074   details about t
-0001cfd0: 6865 2066 6f72 6d61 742e 0a0a 2020 2020  he format...    
-0001cfe0: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-0001cff0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 7572  ---------.    ur
-0001d000: 6c3a 205a 6172 7220 4172 7261 7920 6f72  l: Zarr Array or
-0001d010: 2073 7472 206f 7220 4d75 7461 626c 654d   str or MutableM
-0001d020: 6170 7069 6e67 0a20 2020 2020 2020 204c  apping.        L
-0001d030: 6f63 6174 696f 6e20 6f66 2074 6865 2064  ocation of the d
-0001d040: 6174 612e 2041 2055 524c 2063 616e 2069  ata. A URL can i
-0001d050: 6e63 6c75 6465 2061 2070 726f 746f 636f  nclude a protoco
-0001d060: 6c20 7370 6563 6966 6965 7220 6c69 6b65  l specifier like
-0001d070: 2073 333a 2f2f 0a20 2020 2020 2020 2066   s3://.        f
-0001d080: 6f72 2072 656d 6f74 6520 6461 7461 2e20  or remote data. 
-0001d090: 4361 6e20 616c 736f 2062 6520 616e 7920  Can also be any 
-0001d0a0: 4d75 7461 626c 654d 6170 7069 6e67 2069  MutableMapping i
-0001d0b0: 6e73 7461 6e63 652c 2077 6869 6368 2073  nstance, which s
-0001d0c0: 686f 756c 640a 2020 2020 2020 2020 6265  hould.        be
-0001d0d0: 2073 6572 6961 6c69 7a61 626c 6520 6966   serializable if
-0001d0e0: 2075 7365 6420 696e 206d 756c 7469 706c   used in multipl
-0001d0f0: 6520 7072 6f63 6573 7365 732e 0a20 2020  e processes..   
-0001d100: 2063 6f6d 706f 6e65 6e74 3a20 7374 7220   component: str 
-0001d110: 6f72 204e 6f6e 650a 2020 2020 2020 2020  or None.        
-0001d120: 4966 2074 6865 206c 6f63 6174 696f 6e20  If the location 
-0001d130: 6973 2061 207a 6172 7220 6772 6f75 7020  is a zarr group 
-0001d140: 7261 7468 6572 2074 6861 6e20 616e 2061  rather than an a
-0001d150: 7272 6179 2c20 7468 6973 2069 7320 7468  rray, this is th
-0001d160: 650a 2020 2020 2020 2020 7375 6263 6f6d  e.        subcom
-0001d170: 706f 6e65 6e74 2074 6861 7420 7368 6f75  ponent that shou
-0001d180: 6c64 2062 6520 6c6f 6164 6564 2c20 736f  ld be loaded, so
-0001d190: 6d65 7468 696e 6720 6c69 6b65 2060 6027  mething like ``'
-0001d1a0: 666f 6f2f 6261 7227 6060 2e0a 2020 2020  foo/bar'``..    
-0001d1b0: 7374 6f72 6167 655f 6f70 7469 6f6e 733a  storage_options:
-0001d1c0: 2064 6963 740a 2020 2020 2020 2020 416e   dict.        An
-0001d1d0: 7920 6164 6469 7469 6f6e 616c 2070 6172  y additional par
-0001d1e0: 616d 6574 6572 7320 666f 7220 7468 6520  ameters for the 
-0001d1f0: 7374 6f72 6167 6520 6261 636b 656e 6420  storage backend 
-0001d200: 2869 676e 6f72 6564 2066 6f72 206c 6f63  (ignored for loc
-0001d210: 616c 0a20 2020 2020 2020 2070 6174 6873  al.        paths
-0001d220: 290a 2020 2020 6368 756e 6b73 3a20 7475  ).    chunks: tu
-0001d230: 706c 6520 6f66 2069 6e74 7320 6f72 2074  ple of ints or t
-0001d240: 7570 6c65 7320 6f66 2069 6e74 730a 2020  uples of ints.  
-0001d250: 2020 2020 2020 5061 7373 6564 2074 6f20        Passed to 
-0001d260: 3a66 756e 633a 6064 6173 6b2e 6172 7261  :func:`dask.arra
-0001d270: 792e 6672 6f6d 5f61 7272 6179 602c 2061  y.from_array`, a
-0001d280: 6c6c 6f77 7320 7365 7474 696e 6720 7468  llows setting th
-0001d290: 6520 6368 756e 6b73 206f 6e0a 2020 2020  e chunks on.    
-0001d2a0: 2020 2020 696e 6974 6961 6c69 7361 7469      initialisati
-0001d2b0: 6f6e 2c20 6966 2074 6865 2063 6875 6e6b  on, if the chunk
-0001d2c0: 696e 6720 7363 6865 6d65 2069 6e20 7468  ing scheme in th
-0001d2d0: 6520 6f6e 2d64 6973 6320 6461 7461 7365  e on-disc datase
-0001d2e0: 7420 6973 206e 6f74 0a20 2020 2020 2020  t is not.       
-0001d2f0: 206f 7074 696d 616c 2066 6f72 2074 6865   optimal for the
-0001d300: 2063 616c 6375 6c61 7469 6f6e 7320 746f   calculations to
-0001d310: 2066 6f6c 6c6f 772e 0a20 2020 206e 616d   follow..    nam
-0001d320: 6520 3a20 7374 722c 206f 7074 696f 6e61  e : str, optiona
-0001d330: 6c0a 2020 2020 2020 2020 2041 6e20 6f70  l.         An op
-0001d340: 7469 6f6e 616c 206b 6579 6e61 6d65 2066  tional keyname f
-0001d350: 6f72 2074 6865 2061 7272 6179 2e20 2044  or the array.  D
-0001d360: 6566 6175 6c74 7320 746f 2068 6173 6869  efaults to hashi
-0001d370: 6e67 2074 6865 2069 6e70 7574 0a20 2020  ng the input.   
-0001d380: 206b 7761 7267 733a 0a20 2020 2020 2020   kwargs:.       
-0001d390: 2050 6173 7365 6420 746f 203a 636c 6173   Passed to :clas
-0001d3a0: 733a 607a 6172 722e 636f 7265 2e41 7272  s:`zarr.core.Arr
-0001d3b0: 6179 602e 0a20 2020 2069 6e6c 696e 655f  ay`..    inline_
-0001d3c0: 6172 7261 7920 3a20 626f 6f6c 2c20 6465  array : bool, de
-0001d3d0: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
-0001d3e0: 2020 2020 5768 6574 6865 7220 746f 2069      Whether to i
-0001d3f0: 6e6c 696e 6520 7468 6520 7a61 7272 2041  nline the zarr A
-0001d400: 7272 6179 2069 6e20 7468 6520 7661 6c75  rray in the valu
-0001d410: 6573 206f 6620 7468 6520 7461 736b 2067  es of the task g
-0001d420: 7261 7068 2e0a 2020 2020 2020 2020 5365  raph..        Se
-0001d430: 6520 3a6d 6574 683a 6064 6173 6b2e 6172  e :meth:`dask.ar
-0001d440: 7261 792e 6672 6f6d 5f61 7272 6179 6020  ray.from_array` 
-0001d450: 666f 7220 616e 2065 7870 6c61 6e61 7469  for an explanati
-0001d460: 6f6e 2e0a 0a20 2020 2053 6565 2041 6c73  on...    See Als
-0001d470: 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  o.    --------. 
-0001d480: 2020 2066 726f 6d5f 6172 7261 790a 2020     from_array.  
-0001d490: 2020 2222 220a 2020 2020 696d 706f 7274    """.    import
-0001d4a0: 207a 6172 720a 0a20 2020 2073 746f 7261   zarr..    stora
-0001d4b0: 6765 5f6f 7074 696f 6e73 203d 2073 746f  ge_options = sto
-0001d4c0: 7261 6765 5f6f 7074 696f 6e73 206f 7220  rage_options or 
-0001d4d0: 7b7d 0a20 2020 2069 6620 6973 696e 7374  {}.    if isinst
-0001d4e0: 616e 6365 2875 726c 2c20 7a61 7272 2e41  ance(url, zarr.A
-0001d4f0: 7272 6179 293a 0a20 2020 2020 2020 207a  rray):.        z
-0001d500: 203d 2075 726c 0a20 2020 2065 6c69 6620   = url.    elif 
-0001d510: 6973 696e 7374 616e 6365 2875 726c 2c20  isinstance(url, 
-0001d520: 2873 7472 2c20 6f73 2e50 6174 684c 696b  (str, os.PathLik
-0001d530: 6529 293a 0a20 2020 2020 2020 2069 6620  e)):.        if 
-0001d540: 6973 696e 7374 616e 6365 2875 726c 2c20  isinstance(url, 
-0001d550: 6f73 2e50 6174 684c 696b 6529 3a0a 2020  os.PathLike):.  
-0001d560: 2020 2020 2020 2020 2020 7572 6c20 3d20            url = 
-0001d570: 6f73 2e66 7370 6174 6828 7572 6c29 0a20  os.fspath(url). 
-0001d580: 2020 2020 2020 2069 6620 7374 6f72 6167         if storag
-0001d590: 655f 6f70 7469 6f6e 733a 0a20 2020 2020  e_options:.     
-0001d5a0: 2020 2020 2020 2073 746f 7265 203d 207a         store = z
-0001d5b0: 6172 722e 7374 6f72 6167 652e 4653 5374  arr.storage.FSSt
-0001d5c0: 6f72 6528 7572 6c2c 202a 2a73 746f 7261  ore(url, **stora
-0001d5d0: 6765 5f6f 7074 696f 6e73 290a 2020 2020  ge_options).    
-0001d5e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001d5f0: 2020 2020 2020 7374 6f72 6520 3d20 7572        store = ur
-0001d600: 6c0a 2020 2020 2020 2020 7a20 3d20 7a61  l.        z = za
-0001d610: 7272 2e41 7272 6179 2873 746f 7265 2c20  rr.Array(store, 
-0001d620: 7265 6164 5f6f 6e6c 793d 5472 7565 2c20  read_only=True, 
-0001d630: 7061 7468 3d63 6f6d 706f 6e65 6e74 2c20  path=component, 
-0001d640: 2a2a 6b77 6172 6773 290a 2020 2020 656c  **kwargs).    el
-0001d650: 7365 3a0a 2020 2020 2020 2020 7a20 3d20  se:.        z = 
-0001d660: 7a61 7272 2e41 7272 6179 2875 726c 2c20  zarr.Array(url, 
-0001d670: 7265 6164 5f6f 6e6c 793d 5472 7565 2c20  read_only=True, 
-0001d680: 7061 7468 3d63 6f6d 706f 6e65 6e74 2c20  path=component, 
-0001d690: 2a2a 6b77 6172 6773 290a 2020 2020 6368  **kwargs).    ch
-0001d6a0: 756e 6b73 203d 2063 6875 6e6b 7320 6966  unks = chunks if
-0001d6b0: 2063 6875 6e6b 7320 6973 206e 6f74 204e   chunks is not N
-0001d6c0: 6f6e 6520 656c 7365 207a 2e63 6875 6e6b  one else z.chunk
-0001d6d0: 730a 2020 2020 6966 206e 616d 6520 6973  s.    if name is
-0001d6e0: 204e 6f6e 653a 0a20 2020 2020 2020 206e   None:.        n
-0001d6f0: 616d 6520 3d20 2266 726f 6d2d 7a61 7272  ame = "from-zarr
-0001d700: 2d22 202b 2074 6f6b 656e 697a 6528 7a2c  -" + tokenize(z,
-0001d710: 2063 6f6d 706f 6e65 6e74 2c20 7374 6f72   component, stor
-0001d720: 6167 655f 6f70 7469 6f6e 732c 2063 6875  age_options, chu
-0001d730: 6e6b 732c 202a 2a6b 7761 7267 7329 0a20  nks, **kwargs). 
-0001d740: 2020 2072 6574 7572 6e20 6672 6f6d 5f61     return from_a
-0001d750: 7272 6179 287a 2c20 6368 756e 6b73 2c20  rray(z, chunks, 
-0001d760: 6e61 6d65 3d6e 616d 652c 2069 6e6c 696e  name=name, inlin
-0001d770: 655f 6172 7261 793d 696e 6c69 6e65 5f61  e_array=inline_a
-0001d780: 7272 6179 290a 0a0a 6465 6620 746f 5f7a  rray)...def to_z
-0001d790: 6172 7228 0a20 2020 2061 7272 2c0a 2020  arr(.    arr,.  
-0001d7a0: 2020 7572 6c2c 0a20 2020 2063 6f6d 706f    url,.    compo
-0001d7b0: 6e65 6e74 3d4e 6f6e 652c 0a20 2020 2073  nent=None,.    s
-0001d7c0: 746f 7261 6765 5f6f 7074 696f 6e73 3d4e  torage_options=N
-0001d7d0: 6f6e 652c 0a20 2020 206f 7665 7277 7269  one,.    overwri
-0001d7e0: 7465 3d46 616c 7365 2c0a 2020 2020 7265  te=False,.    re
-0001d7f0: 6769 6f6e 3d4e 6f6e 652c 0a20 2020 2063  gion=None,.    c
-0001d800: 6f6d 7075 7465 3d54 7275 652c 0a20 2020  ompute=True,.   
-0001d810: 2072 6574 7572 6e5f 7374 6f72 6564 3d46   return_stored=F
-0001d820: 616c 7365 2c0a 2020 2020 2a2a 6b77 6172  alse,.    **kwar
-0001d830: 6773 2c0a 293a 0a20 2020 2022 2222 5361  gs,.):.    """Sa
-0001d840: 7665 2061 7272 6179 2074 6f20 7468 6520  ve array to the 
-0001d850: 7a61 7272 2073 746f 7261 6765 2066 6f72  zarr storage for
-0001d860: 6d61 740a 0a20 2020 2053 6565 2068 7474  mat..    See htt
-0001d870: 7073 3a2f 2f7a 6172 722e 7265 6164 7468  ps://zarr.readth
-0001d880: 6564 6f63 732e 696f 2066 6f72 2064 6574  edocs.io for det
-0001d890: 6169 6c73 2061 626f 7574 2074 6865 2066  ails about the f
-0001d8a0: 6f72 6d61 742e 0a0a 2020 2020 5061 7261  ormat...    Para
-0001d8b0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-0001d8c0: 2d2d 2d2d 2d0a 2020 2020 6172 723a 2064  -----.    arr: d
-0001d8d0: 6173 6b2e 6172 7261 790a 2020 2020 2020  ask.array.      
-0001d8e0: 2020 4461 7461 2074 6f20 7374 6f72 650a    Data to store.
-0001d8f0: 2020 2020 7572 6c3a 205a 6172 7220 4172      url: Zarr Ar
-0001d900: 7261 7920 6f72 2073 7472 206f 7220 4d75  ray or str or Mu
-0001d910: 7461 626c 654d 6170 7069 6e67 0a20 2020  tableMapping.   
-0001d920: 2020 2020 204c 6f63 6174 696f 6e20 6f66       Location of
-0001d930: 2074 6865 2064 6174 612e 2041 2055 524c   the data. A URL
-0001d940: 2063 616e 2069 6e63 6c75 6465 2061 2070   can include a p
-0001d950: 726f 746f 636f 6c20 7370 6563 6966 6965  rotocol specifie
-0001d960: 7220 6c69 6b65 2073 333a 2f2f 0a20 2020  r like s3://.   
-0001d970: 2020 2020 2066 6f72 2072 656d 6f74 6520       for remote 
-0001d980: 6461 7461 2e20 4361 6e20 616c 736f 2062  data. Can also b
-0001d990: 6520 616e 7920 4d75 7461 626c 654d 6170  e any MutableMap
-0001d9a0: 7069 6e67 2069 6e73 7461 6e63 652c 2077  ping instance, w
-0001d9b0: 6869 6368 2073 686f 756c 640a 2020 2020  hich should.    
-0001d9c0: 2020 2020 6265 2073 6572 6961 6c69 7a61      be serializa
-0001d9d0: 626c 6520 6966 2075 7365 6420 696e 206d  ble if used in m
-0001d9e0: 756c 7469 706c 6520 7072 6f63 6573 7365  ultiple processe
-0001d9f0: 732e 0a20 2020 2063 6f6d 706f 6e65 6e74  s..    component
-0001da00: 3a20 7374 7220 6f72 204e 6f6e 650a 2020  : str or None.  
-0001da10: 2020 2020 2020 4966 2074 6865 206c 6f63        If the loc
-0001da20: 6174 696f 6e20 6973 2061 207a 6172 7220  ation is a zarr 
-0001da30: 6772 6f75 7020 7261 7468 6572 2074 6861  group rather tha
-0001da40: 6e20 616e 2061 7272 6179 2c20 7468 6973  n an array, this
-0001da50: 2069 7320 7468 650a 2020 2020 2020 2020   is the.        
-0001da60: 7375 6263 6f6d 706f 6e65 6e74 2074 6861  subcomponent tha
-0001da70: 7420 7368 6f75 6c64 2062 6520 6372 6561  t should be crea
-0001da80: 7465 642f 6f76 6572 2d77 7269 7474 656e  ted/over-written
-0001da90: 2e0a 2020 2020 7374 6f72 6167 655f 6f70  ..    storage_op
-0001daa0: 7469 6f6e 733a 2064 6963 740a 2020 2020  tions: dict.    
-0001dab0: 2020 2020 416e 7920 6164 6469 7469 6f6e      Any addition
-0001dac0: 616c 2070 6172 616d 6574 6572 7320 666f  al parameters fo
-0001dad0: 7220 7468 6520 7374 6f72 6167 6520 6261  r the storage ba
-0001dae0: 636b 656e 6420 2869 676e 6f72 6564 2066  ckend (ignored f
-0001daf0: 6f72 206c 6f63 616c 0a20 2020 2020 2020  or local.       
-0001db00: 2070 6174 6873 290a 2020 2020 6f76 6572   paths).    over
-0001db10: 7772 6974 653a 2062 6f6f 6c0a 2020 2020  write: bool.    
-0001db20: 2020 2020 4966 2067 6976 656e 2061 7272      If given arr
-0001db30: 6179 2061 6c72 6561 6479 2065 7869 7374  ay already exist
-0001db40: 732c 206f 7665 7277 7269 7465 3d46 616c  s, overwrite=Fal
-0001db50: 7365 2077 696c 6c20 6361 7573 6520 616e  se will cause an
-0001db60: 2065 7272 6f72 2c0a 2020 2020 2020 2020   error,.        
-0001db70: 7768 6572 6520 6f76 6572 7772 6974 653d  where overwrite=
-0001db80: 5472 7565 2077 696c 6c20 7265 706c 6163  True will replac
-0001db90: 6520 7468 6520 6578 6973 7469 6e67 2064  e the existing d
-0001dba0: 6174 612e 0a20 2020 2072 6567 696f 6e3a  ata..    region:
-0001dbb0: 2074 7570 6c65 206f 6620 736c 6963 6573   tuple of slices
-0001dbc0: 206f 7220 4e6f 6e65 0a20 2020 2020 2020   or None.       
-0001dbd0: 2054 6865 2072 6567 696f 6e20 6f66 2064   The region of d
-0001dbe0: 6174 6120 7468 6174 2073 686f 756c 6420  ata that should 
-0001dbf0: 6265 2077 7269 7474 656e 2069 6620 6060  be written if ``
-0001dc00: 7572 6c60 6020 6973 2061 207a 6172 722e  url`` is a zarr.
-0001dc10: 4172 7261 792e 0a20 2020 2020 2020 204e  Array..        N
-0001dc20: 6f74 2074 6f20 6265 2075 7365 6420 7769  ot to be used wi
-0001dc30: 7468 206f 7468 6572 2074 7970 6573 206f  th other types o
-0001dc40: 6620 6060 7572 6c60 602e 0a20 2020 2063  f ``url``..    c
-0001dc50: 6f6d 7075 7465 3a20 626f 6f6c 0a20 2020  ompute: bool.   
-0001dc60: 2020 2020 2053 6565 203a 6675 6e63 3a60       See :func:`
-0001dc70: 7e64 6173 6b2e 6172 7261 792e 7374 6f72  ~dask.array.stor
-0001dc80: 6560 2066 6f72 206d 6f72 6520 6465 7461  e` for more deta
-0001dc90: 696c 732e 0a20 2020 2072 6574 7572 6e5f  ils..    return_
-0001dca0: 7374 6f72 6564 3a20 626f 6f6c 0a20 2020  stored: bool.   
-0001dcb0: 2020 2020 2053 6565 203a 6675 6e63 3a60       See :func:`
-0001dcc0: 7e64 6173 6b2e 6172 7261 792e 7374 6f72  ~dask.array.stor
-0001dcd0: 6560 2066 6f72 206d 6f72 6520 6465 7461  e` for more deta
-0001dce0: 696c 732e 0a20 2020 202a 2a6b 7761 7267  ils..    **kwarg
-0001dcf0: 733a 0a20 2020 2020 2020 2050 6173 7365  s:.        Passe
-0001dd00: 6420 746f 2074 6865 203a 6675 6e63 3a60  d to the :func:`
-0001dd10: 7a61 7272 2e63 7265 6174 696f 6e2e 6372  zarr.creation.cr
-0001dd20: 6561 7465 6020 6675 6e63 7469 6f6e 2c20  eate` function, 
-0001dd30: 652e 672e 2c20 636f 6d70 7265 7373 696f  e.g., compressio
-0001dd40: 6e20 6f70 7469 6f6e 732e 0a0a 2020 2020  n options...    
-0001dd50: 5261 6973 6573 0a20 2020 202d 2d2d 2d2d  Raises.    -----
-0001dd60: 2d0a 2020 2020 5661 6c75 6545 7272 6f72  -.    ValueError
-0001dd70: 0a20 2020 2020 2020 2049 6620 6060 6172  .        If ``ar
-0001dd80: 7260 6020 6861 7320 756e 6b6e 6f77 6e20  r`` has unknown 
-0001dd90: 6368 756e 6b20 7369 7a65 732c 2077 6869  chunk sizes, whi
-0001dda0: 6368 2069 7320 6e6f 7420 7375 7070 6f72  ch is not suppor
-0001ddb0: 7465 6420 6279 205a 6172 722e 0a20 2020  ted by Zarr..   
-0001ddc0: 2020 2020 2049 6620 6060 7265 6769 6f6e       If ``region
-0001ddd0: 6060 2069 7320 7370 6563 6966 6965 6420  `` is specified 
-0001dde0: 616e 6420 6060 7572 6c60 6020 6973 206e  and ``url`` is n
-0001ddf0: 6f74 2061 207a 6172 722e 4172 7261 790a  ot a zarr.Array.
-0001de00: 0a20 2020 2053 6565 2041 6c73 6f0a 2020  .    See Also.  
-0001de10: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064    --------.    d
-0001de20: 6173 6b2e 6172 7261 792e 7374 6f72 650a  ask.array.store.
-0001de30: 2020 2020 6461 736b 2e61 7272 6179 2e41      dask.array.A
-0001de40: 7272 6179 2e63 6f6d 7075 7465 5f63 6875  rray.compute_chu
-0001de50: 6e6b 5f73 697a 6573 0a0a 2020 2020 2222  nk_sizes..    ""
-0001de60: 220a 2020 2020 696d 706f 7274 207a 6172  ".    import zar
-0001de70: 720a 0a20 2020 2069 6620 6e70 2e69 736e  r..    if np.isn
-0001de80: 616e 2861 7272 2e73 6861 7065 292e 616e  an(arr.shape).an
-0001de90: 7928 293a 0a20 2020 2020 2020 2072 6169  y():.        rai
-0001dea0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0001deb0: 2020 2020 2020 2020 2020 2022 5361 7669             "Savi
-0001dec0: 6e67 2061 2064 6173 6b20 6172 7261 7920  ng a dask array 
-0001ded0: 7769 7468 2075 6e6b 6e6f 776e 2063 6875  with unknown chu
-0001dee0: 6e6b 2073 697a 6573 2069 7320 6e6f 7420  nk sizes is not 
-0001def0: 220a 2020 2020 2020 2020 2020 2020 2263  ".            "c
-0001df00: 7572 7265 6e74 6c79 2073 7570 706f 7274  urrently support
-0001df10: 6564 2062 7920 5a61 7272 2e25 7322 2025  ed by Zarr.%s" %
-0001df20: 2075 6e6b 6e6f 776e 5f63 6875 6e6b 5f6d   unknown_chunk_m
-0001df30: 6573 7361 6765 0a20 2020 2020 2020 2029  essage.        )
-0001df40: 0a0a 2020 2020 6966 2069 7369 6e73 7461  ..    if isinsta
-0001df50: 6e63 6528 7572 6c2c 207a 6172 722e 4172  nce(url, zarr.Ar
-0001df60: 7261 7929 3a0a 2020 2020 2020 2020 7a20  ray):.        z 
-0001df70: 3d20 7572 6c0a 2020 2020 2020 2020 6966  = url.        if
-0001df80: 2069 7369 6e73 7461 6e63 6528 7a2e 7374   isinstance(z.st
-0001df90: 6f72 652c 2028 6469 6374 2c20 4d75 7461  ore, (dict, Muta
-0001dfa0: 626c 654d 6170 7069 6e67 2929 3a0a 2020  bleMapping)):.  
-0001dfb0: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
-0001dfc0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001dfd0: 726f 6d20 6469 7374 7269 6275 7465 6420  rom distributed 
-0001dfe0: 696d 706f 7274 2064 6566 6175 6c74 5f63  import default_c
-0001dff0: 6c69 656e 740a 0a20 2020 2020 2020 2020  lient..         
-0001e000: 2020 2020 2020 2064 6566 6175 6c74 5f63         default_c
-0001e010: 6c69 656e 7428 290a 2020 2020 2020 2020  lient().        
-0001e020: 2020 2020 6578 6365 7074 2028 496d 706f      except (Impo
-0001e030: 7274 4572 726f 722c 2056 616c 7565 4572  rtError, ValueEr
-0001e040: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
-0001e050: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
-0001e060: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001e070: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001e080: 7365 2052 756e 7469 6d65 4572 726f 7228  se RuntimeError(
-0001e090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e0a0: 2020 2020 2022 4361 6e6e 6f74 2073 746f       "Cannot sto
-0001e0b0: 7265 2069 6e74 6f20 696e 206d 656d 6f72  re into in memor
-0001e0c0: 7920 5a61 7272 2041 7272 6179 2075 7369  y Zarr Array usi
-0001e0d0: 6e67 2022 0a20 2020 2020 2020 2020 2020  ng ".           
-0001e0e0: 2020 2020 2020 2020 2022 7468 6520 6469           "the di
-0001e0f0: 7374 7269 6275 7465 6420 7363 6865 6475  stributed schedu
-0001e100: 6c65 722e 220a 2020 2020 2020 2020 2020  ler.".          
-0001e110: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001e120: 2069 6620 7265 6769 6f6e 2069 7320 4e6f   if region is No
-0001e130: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0001e140: 6172 7220 3d20 6172 722e 7265 6368 756e  arr = arr.rechun
-0001e150: 6b28 7a2e 6368 756e 6b73 290a 2020 2020  k(z.chunks).    
-0001e160: 2020 2020 2020 2020 7265 6769 6f6e 7320          regions 
-0001e170: 3d20 4e6f 6e65 0a20 2020 2020 2020 2065  = None.        e
-0001e180: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001e190: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-0001e1a0: 2e73 6c69 6369 6e67 2069 6d70 6f72 7420  .slicing import 
-0001e1b0: 6e65 775f 626c 6f63 6b64 696d 2c20 6e6f  new_blockdim, no
-0001e1c0: 726d 616c 697a 655f 696e 6465 780a 0a20  rmalize_index.. 
-0001e1d0: 2020 2020 2020 2020 2020 206f 6c64 5f63             old_c
-0001e1e0: 6875 6e6b 7320 3d20 6e6f 726d 616c 697a  hunks = normaliz
-0001e1f0: 655f 6368 756e 6b73 287a 2e63 6875 6e6b  e_chunks(z.chunk
-0001e200: 732c 207a 2e73 6861 7065 290a 2020 2020  s, z.shape).    
-0001e210: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
-0001e220: 6e6f 726d 616c 697a 655f 696e 6465 7828  normalize_index(
-0001e230: 7265 6769 6f6e 2c20 7a2e 7368 6170 6529  region, z.shape)
-0001e240: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-0001e250: 6e6b 7320 3d20 7475 706c 6528 0a20 2020  nks = tuple(.   
-0001e260: 2020 2020 2020 2020 2020 2020 2074 7570               tup
-0001e270: 6c65 286e 6577 5f62 6c6f 636b 6469 6d28  le(new_blockdim(
-0001e280: 732c 2063 2c20 7229 290a 2020 2020 2020  s, c, r)).      
-0001e290: 2020 2020 2020 2020 2020 666f 7220 732c            for s,
-0001e2a0: 2063 2c20 7220 696e 207a 6970 287a 2e73   c, r in zip(z.s
-0001e2b0: 6861 7065 2c20 6f6c 645f 6368 756e 6b73  hape, old_chunks
-0001e2c0: 2c20 696e 6465 7829 0a20 2020 2020 2020  , index).       
-0001e2d0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0001e2e0: 2020 2061 7272 203d 2061 7272 2e72 6563     arr = arr.rec
-0001e2f0: 6875 6e6b 2863 6875 6e6b 7329 0a20 2020  hunk(chunks).   
-0001e300: 2020 2020 2020 2020 2072 6567 696f 6e73           regions
-0001e310: 203d 205b 7265 6769 6f6e 5d0a 2020 2020   = [region].    
-0001e320: 2020 2020 7265 7475 726e 2061 7272 2e73      return arr.s
-0001e330: 746f 7265 280a 2020 2020 2020 2020 2020  tore(.          
-0001e340: 2020 7a2c 206c 6f63 6b3d 4661 6c73 652c    z, lock=False,
-0001e350: 2072 6567 696f 6e73 3d72 6567 696f 6e73   regions=regions
-0001e360: 2c20 636f 6d70 7574 653d 636f 6d70 7574  , compute=comput
-0001e370: 652c 2072 6574 7572 6e5f 7374 6f72 6564  e, return_stored
-0001e380: 3d72 6574 7572 6e5f 7374 6f72 6564 0a20  =return_stored. 
-0001e390: 2020 2020 2020 2029 0a0a 2020 2020 6966         )..    if
-0001e3a0: 2072 6567 696f 6e20 6973 206e 6f74 204e   region is not N
-0001e3b0: 6f6e 653a 0a20 2020 2020 2020 2072 6169  one:.        rai
-0001e3c0: 7365 2056 616c 7565 4572 726f 7228 2243  se ValueError("C
-0001e3d0: 616e 6e6f 7420 7573 6520 6072 6567 696f  annot use `regio
-0001e3e0: 6e60 206b 6579 776f 7264 2077 6865 6e20  n` keyword when 
-0001e3f0: 7572 6c20 6973 206e 6f74 2061 2060 7a61  url is not a `za
-0001e400: 7272 2e41 7272 6179 602e 2229 0a0a 2020  rr.Array`.")..  
-0001e410: 2020 6966 206e 6f74 205f 6368 6563 6b5f    if not _check_
-0001e420: 7265 6775 6c61 725f 6368 756e 6b73 2861  regular_chunks(a
-0001e430: 7272 2e63 6875 6e6b 7329 3a0a 2020 2020  rr.chunks):.    
-0001e440: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001e450: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0001e460: 2020 2241 7474 656d 7074 2074 6f20 7361    "Attempt to sa
-0001e470: 7665 2061 7272 6179 2074 6f20 7a61 7272  ve array to zarr
-0001e480: 2077 6974 6820 6972 7265 6775 6c61 7220   with irregular 
-0001e490: 220a 2020 2020 2020 2020 2020 2020 2263  ".            "c
-0001e4a0: 6875 6e6b 696e 672c 2070 6c65 6173 6520  hunking, please 
-0001e4b0: 6361 6c6c 2060 6172 722e 7265 6368 756e  call `arr.rechun
-0001e4c0: 6b28 2e2e 2e29 6020 6669 7273 742e 220a  k(...)` first.".
-0001e4d0: 2020 2020 2020 2020 290a 0a20 2020 2073          )..    s
-0001e4e0: 746f 7261 6765 5f6f 7074 696f 6e73 203d  torage_options =
-0001e4f0: 2073 746f 7261 6765 5f6f 7074 696f 6e73   storage_options
-0001e500: 206f 7220 7b7d 0a0a 2020 2020 6966 2073   or {}..    if s
-0001e510: 746f 7261 6765 5f6f 7074 696f 6e73 3a0a  torage_options:.
-0001e520: 2020 2020 2020 2020 7374 6f72 6520 3d20          store = 
-0001e530: 7a61 7272 2e73 746f 7261 6765 2e46 5353  zarr.storage.FSS
-0001e540: 746f 7265 2875 726c 2c20 2a2a 7374 6f72  tore(url, **stor
-0001e550: 6167 655f 6f70 7469 6f6e 7329 0a20 2020  age_options).   
-0001e560: 2065 6c73 653a 0a20 2020 2020 2020 2073   else:.        s
-0001e570: 746f 7265 203d 2075 726c 0a0a 2020 2020  tore = url..    
-0001e580: 6368 756e 6b73 203d 205b 635b 305d 2066  chunks = [c[0] f
-0001e590: 6f72 2063 2069 6e20 6172 722e 6368 756e  or c in arr.chun
-0001e5a0: 6b73 5d0a 0a20 2020 207a 203d 207a 6172  ks]..    z = zar
-0001e5b0: 722e 6372 6561 7465 280a 2020 2020 2020  r.create(.      
-0001e5c0: 2020 7368 6170 653d 6172 722e 7368 6170    shape=arr.shap
-0001e5d0: 652c 0a20 2020 2020 2020 2063 6875 6e6b  e,.        chunk
-0001e5e0: 733d 6368 756e 6b73 2c0a 2020 2020 2020  s=chunks,.      
-0001e5f0: 2020 6474 7970 653d 6172 722e 6474 7970    dtype=arr.dtyp
-0001e600: 652c 0a20 2020 2020 2020 2073 746f 7265  e,.        store
-0001e610: 3d73 746f 7265 2c0a 2020 2020 2020 2020  =store,.        
-0001e620: 7061 7468 3d63 6f6d 706f 6e65 6e74 2c0a  path=component,.
-0001e630: 2020 2020 2020 2020 6f76 6572 7772 6974          overwrit
-0001e640: 653d 6f76 6572 7772 6974 652c 0a20 2020  e=overwrite,.   
-0001e650: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
-0001e660: 2020 2029 0a20 2020 2072 6574 7572 6e20     ).    return 
-0001e670: 6172 722e 7374 6f72 6528 7a2c 206c 6f63  arr.store(z, loc
-0001e680: 6b3d 4661 6c73 652c 2063 6f6d 7075 7465  k=False, compute
-0001e690: 3d63 6f6d 7075 7465 2c20 7265 7475 726e  =compute, return
-0001e6a0: 5f73 746f 7265 643d 7265 7475 726e 5f73  _stored=return_s
-0001e6b0: 746f 7265 6429 0a0a 0a64 6566 205f 6368  tored)...def _ch
-0001e6c0: 6563 6b5f 7265 6775 6c61 725f 6368 756e  eck_regular_chun
-0001e6d0: 6b73 2863 6875 6e6b 7365 7429 3a0a 2020  ks(chunkset):.  
-0001e6e0: 2020 2222 2243 6865 636b 2069 6620 7468    """Check if th
-0001e6f0: 6520 6368 756e 6b73 2061 7265 2072 6567  e chunks are reg
-0001e700: 756c 6172 0a0a 2020 2020 2252 6567 756c  ular..    "Regul
-0001e710: 6172 2220 696e 2074 6869 7320 636f 6e74  ar" in this cont
-0001e720: 6578 7420 6d65 616e 7320 7468 6174 2061  ext means that a
-0001e730: 6c6f 6e67 2065 7665 7279 2061 7869 732c  long every axis,
-0001e740: 2074 6865 2063 6875 6e6b 7320 616c 6c0a   the chunks all.
-0001e750: 2020 2020 6861 7665 2074 6865 2073 616d      have the sam
-0001e760: 6520 7369 7a65 2c20 6578 6365 7074 2074  e size, except t
-0001e770: 6865 206c 6173 7420 6f6e 652c 2077 6869  he last one, whi
-0001e780: 6368 206d 6179 2062 6520 736d 616c 6c65  ch may be smalle
-0001e790: 720a 0a20 2020 2050 6172 616d 6574 6572  r..    Parameter
-0001e7a0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-0001e7b0: 0a20 2020 2063 6875 6e6b 7365 743a 2074  .    chunkset: t
-0001e7c0: 7570 6c65 206f 6620 7475 706c 6573 206f  uple of tuples o
-0001e7d0: 6620 696e 7473 0a20 2020 2020 2020 2046  f ints.        F
-0001e7e0: 726f 6d20 7468 6520 6060 2e63 6875 6e6b  rom the ``.chunk
-0001e7f0: 7360 6020 6174 7472 6962 7574 6520 6f66  s`` attribute of
-0001e800: 2061 6e20 6060 4172 7261 7960 600a 0a20   an ``Array``.. 
-0001e810: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
-0001e820: 2d2d 2d2d 2d2d 0a20 2020 2054 7275 6520  ------.    True 
-0001e830: 6966 2063 6875 6e6b 7365 7420 7061 7373  if chunkset pass
-0001e840: 6573 2c20 656c 7365 2046 616c 7365 0a0a  es, else False..
-0001e850: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0001e860: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e   --------.    >>
-0001e870: 3e20 696d 706f 7274 2064 6173 6b2e 6172  > import dask.ar
-0001e880: 7261 7920 6173 2064 610a 2020 2020 3e3e  ray as da.    >>
-0001e890: 3e20 6172 7220 3d20 6461 2e7a 6572 6f73  > arr = da.zeros
-0001e8a0: 2831 302c 2063 6875 6e6b 733d 2835 2c20  (10, chunks=(5, 
-0001e8b0: 2929 0a20 2020 203e 3e3e 205f 6368 6563  )).    >>> _chec
-0001e8c0: 6b5f 7265 6775 6c61 725f 6368 756e 6b73  k_regular_chunks
-0001e8d0: 2861 7272 2e63 6875 6e6b 7329 0a20 2020  (arr.chunks).   
-0001e8e0: 2054 7275 650a 0a20 2020 203e 3e3e 2061   True..    >>> a
-0001e8f0: 7272 203d 2064 612e 7a65 726f 7328 3130  rr = da.zeros(10
-0001e900: 2c20 6368 756e 6b73 3d28 2833 2c20 332c  , chunks=((3, 3,
-0001e910: 2033 2c20 3129 2c20 2929 0a20 2020 203e   3, 1), )).    >
-0001e920: 3e3e 205f 6368 6563 6b5f 7265 6775 6c61  >> _check_regula
-0001e930: 725f 6368 756e 6b73 2861 7272 2e63 6875  r_chunks(arr.chu
-0001e940: 6e6b 7329 0a20 2020 2054 7275 650a 0a20  nks).    True.. 
-0001e950: 2020 203e 3e3e 2061 7272 203d 2064 612e     >>> arr = da.
-0001e960: 7a65 726f 7328 3130 2c20 6368 756e 6b73  zeros(10, chunks
-0001e970: 3d28 2833 2c20 312c 2033 2c20 3329 2c20  =((3, 1, 3, 3), 
-0001e980: 2929 0a20 2020 203e 3e3e 205f 6368 6563  )).    >>> _chec
-0001e990: 6b5f 7265 6775 6c61 725f 6368 756e 6b73  k_regular_chunks
-0001e9a0: 2861 7272 2e63 6875 6e6b 7329 0a20 2020  (arr.chunks).   
-0001e9b0: 2046 616c 7365 0a20 2020 2022 2222 0a20   False.    """. 
-0001e9c0: 2020 2066 6f72 2063 6875 6e6b 7320 696e     for chunks in
-0001e9d0: 2063 6875 6e6b 7365 743a 0a20 2020 2020   chunkset:.     
-0001e9e0: 2020 2069 6620 6c65 6e28 6368 756e 6b73     if len(chunks
-0001e9f0: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
-0001ea00: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
-0001ea10: 2020 2020 2069 6620 6c65 6e28 7365 7428       if len(set(
-0001ea20: 6368 756e 6b73 5b3a 2d31 5d29 2920 3e20  chunks[:-1])) > 
-0001ea30: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
-0001ea40: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
-0001ea50: 2020 2020 6966 2063 6875 6e6b 735b 2d31      if chunks[-1
-0001ea60: 5d20 3e20 6368 756e 6b73 5b30 5d3a 0a20  ] > chunks[0]:. 
-0001ea70: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001ea80: 6e20 4661 6c73 650a 2020 2020 7265 7475  n False.    retu
-0001ea90: 726e 2054 7275 650a 0a0a 6465 6620 6672  rn True...def fr
-0001eaa0: 6f6d 5f64 656c 6179 6564 2876 616c 7565  om_delayed(value
-0001eab0: 2c20 7368 6170 652c 2064 7479 7065 3d4e  , shape, dtype=N
-0001eac0: 6f6e 652c 206d 6574 613d 4e6f 6e65 2c20  one, meta=None, 
-0001ead0: 6e61 6d65 3d4e 6f6e 6529 3a0a 2020 2020  name=None):.    
-0001eae0: 2222 2243 7265 6174 6520 6120 6461 736b  """Create a dask
-0001eaf0: 2061 7272 6179 2066 726f 6d20 6120 6461   array from a da
-0001eb00: 736b 2064 656c 6179 6564 2076 616c 7565  sk delayed value
-0001eb10: 0a0a 2020 2020 5468 6973 2072 6f75 7469  ..    This routi
-0001eb20: 6e65 2069 7320 7573 6566 756c 2066 6f72  ne is useful for
-0001eb30: 2063 6f6e 7374 7275 6374 696e 6720 6461   constructing da
-0001eb40: 736b 2061 7272 6179 7320 696e 2061 6e20  sk arrays in an 
-0001eb50: 6164 2d68 6f63 2066 6173 6869 6f6e 0a20  ad-hoc fashion. 
-0001eb60: 2020 2075 7369 6e67 2064 6173 6b20 6465     using dask de
-0001eb70: 6c61 7965 642c 2070 6172 7469 6375 6c61  layed, particula
-0001eb80: 726c 7920 7768 656e 2063 6f6d 6269 6e65  rly when combine
-0001eb90: 6420 7769 7468 2073 7461 636b 2061 6e64  d with stack and
-0001eba0: 2063 6f6e 6361 7465 6e61 7465 2e0a 0a20   concatenate... 
-0001ebb0: 2020 2054 6865 2064 6173 6b20 6172 7261     The dask arra
-0001ebc0: 7920 7769 6c6c 2063 6f6e 7369 7374 206f  y will consist o
-0001ebd0: 6620 6120 7369 6e67 6c65 2063 6875 6e6b  f a single chunk
-0001ebe0: 2e0a 0a20 2020 2045 7861 6d70 6c65 730a  ...    Examples.
-0001ebf0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0001ec00: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
-0001ec10: 0a20 2020 203e 3e3e 2069 6d70 6f72 7420  .    >>> import 
-0001ec20: 6461 736b 2e61 7272 6179 2061 7320 6461  dask.array as da
-0001ec30: 0a20 2020 203e 3e3e 2069 6d70 6f72 7420  .    >>> import 
-0001ec40: 6e75 6d70 7920 6173 206e 700a 2020 2020  numpy as np.    
-0001ec50: 3e3e 3e20 7661 6c75 6520 3d20 6461 736b  >>> value = dask
-0001ec60: 2e64 656c 6179 6564 286e 702e 6f6e 6573  .delayed(np.ones
-0001ec70: 2928 3529 0a20 2020 203e 3e3e 2061 7272  )(5).    >>> arr
-0001ec80: 6179 203d 2064 612e 6672 6f6d 5f64 656c  ay = da.from_del
-0001ec90: 6179 6564 2876 616c 7565 2c20 2835 2c29  ayed(value, (5,)
-0001eca0: 2c20 6474 7970 653d 666c 6f61 7429 0a20  , dtype=float). 
-0001ecb0: 2020 203e 3e3e 2061 7272 6179 0a20 2020     >>> array.   
-0001ecc0: 2064 6173 6b2e 6172 7261 793c 6672 6f6d   dask.array<from
-0001ecd0: 2d76 616c 7565 2c20 7368 6170 653d 2835  -value, shape=(5
-0001ece0: 2c29 2c20 6474 7970 653d 666c 6f61 7436  ,), dtype=float6
-0001ecf0: 342c 2063 6875 6e6b 7369 7a65 3d28 352c  4, chunksize=(5,
-0001ed00: 292c 2063 6875 6e6b 7479 7065 3d6e 756d  ), chunktype=num
-0001ed10: 7079 2e6e 6461 7272 6179 3e0a 2020 2020  py.ndarray>.    
-0001ed20: 3e3e 3e20 6172 7261 792e 636f 6d70 7574  >>> array.comput
-0001ed30: 6528 290a 2020 2020 6172 7261 7928 5b31  e().    array([1
-0001ed40: 2e2c 2031 2e2c 2031 2e2c 2031 2e2c 2031  ., 1., 1., 1., 1
-0001ed50: 2e5d 290a 2020 2020 2222 220a 2020 2020  .]).    """.    
-0001ed60: 6672 6f6d 2064 6173 6b2e 6465 6c61 7965  from dask.delaye
-0001ed70: 6420 696d 706f 7274 2044 656c 6179 6564  d import Delayed
-0001ed80: 2c20 6465 6c61 7965 640a 0a20 2020 2069  , delayed..    i
-0001ed90: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-0001eda0: 2876 616c 7565 2c20 4465 6c61 7965 6429  (value, Delayed)
-0001edb0: 2061 6e64 2068 6173 6174 7472 2876 616c   and hasattr(val
-0001edc0: 7565 2c20 226b 6579 2229 3a0a 2020 2020  ue, "key"):.    
-0001edd0: 2020 2020 7661 6c75 6520 3d20 6465 6c61      value = dela
-0001ede0: 7965 6428 7661 6c75 6529 0a0a 2020 2020  yed(value)..    
-0001edf0: 6e61 6d65 203d 206e 616d 6520 6f72 2022  name = name or "
-0001ee00: 6672 6f6d 2d76 616c 7565 2d22 202b 2074  from-value-" + t
-0001ee10: 6f6b 656e 697a 6528 7661 6c75 652c 2073  okenize(value, s
-0001ee20: 6861 7065 2c20 6474 7970 652c 206d 6574  hape, dtype, met
-0001ee30: 6129 0a20 2020 2064 736b 203d 207b 286e  a).    dsk = {(n
-0001ee40: 616d 652c 2920 2b20 2830 2c29 202a 206c  ame,) + (0,) * l
-0001ee50: 656e 2873 6861 7065 293a 2076 616c 7565  en(shape): value
-0001ee60: 2e6b 6579 7d0a 2020 2020 6368 756e 6b73  .key}.    chunks
-0001ee70: 203d 2074 7570 6c65 2828 642c 2920 666f   = tuple((d,) fo
-0001ee80: 7220 6420 696e 2073 6861 7065 290a 2020  r d in shape).  
-0001ee90: 2020 2320 544f 444f 3a20 7661 6c75 652e    # TODO: value.
-0001eea0: 5f6b 6579 206d 6179 206e 6f74 2062 6520  _key may not be 
-0001eeb0: 7468 6520 6e61 6d65 206f 6620 7468 6520  the name of the 
-0001eec0: 6c61 7965 7220 696e 2076 616c 7565 2e64  layer in value.d
-0001eed0: 6173 6b0a 2020 2020 2320 5468 6973 2073  ask.    # This s
-0001eee0: 686f 756c 6420 6265 2066 6978 6564 2061  hould be fixed a
-0001eef0: 6674 6572 2077 6520 6275 696c 6420 6675  fter we build fu
-0001ef00: 6c6c 2065 7870 7265 7373 696f 6e20 6772  ll expression gr
-0001ef10: 6170 6873 0a20 2020 2067 7261 7068 203d  aphs.    graph =
-0001ef20: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-0001ef30: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-0001ef40: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
-0001ef50: 6e64 656e 6369 6573 3d5b 7661 6c75 655d  ndencies=[value]
-0001ef60: 290a 2020 2020 7265 7475 726e 2041 7272  ).    return Arr
-0001ef70: 6179 2867 7261 7068 2c20 6e61 6d65 2c20  ay(graph, name, 
-0001ef80: 6368 756e 6b73 2c20 6474 7970 653d 6474  chunks, dtype=dt
-0001ef90: 7970 652c 206d 6574 613d 6d65 7461 290a  ype, meta=meta).
-0001efa0: 0a0a 6465 6620 6672 6f6d 5f66 756e 6328  ..def from_func(
-0001efb0: 6675 6e63 2c20 7368 6170 652c 2064 7479  func, shape, dty
-0001efc0: 7065 3d4e 6f6e 652c 206e 616d 653d 4e6f  pe=None, name=No
-0001efd0: 6e65 2c20 6172 6773 3d28 292c 206b 7761  ne, args=(), kwa
-0001efe0: 7267 733d 4e6f 6e65 293a 0a20 2020 2022  rgs=None):.    "
-0001eff0: 2222 4372 6561 7465 2064 6173 6b20 6172  ""Create dask ar
-0001f000: 7261 7920 696e 2061 2073 696e 676c 6520  ray in a single 
-0001f010: 626c 6f63 6b20 6279 2063 616c 6c69 6e67  block by calling
-0001f020: 2061 2066 756e 6374 696f 6e0a 0a20 2020   a function..   
-0001f030: 2043 616c 6c69 6e67 2074 6865 2070 726f   Calling the pro
-0001f040: 7669 6465 6420 6675 6e63 7469 6f6e 2077  vided function w
-0001f050: 6974 6820 6675 6e63 282a 6172 6773 2c20  ith func(*args, 
-0001f060: 2a2a 6b77 6172 6773 2920 7368 6f75 6c64  **kwargs) should
-0001f070: 2072 6574 7572 6e20 610a 2020 2020 4e75   return a.    Nu
-0001f080: 6d50 7920 6172 7261 7920 6f66 2074 6865  mPy array of the
-0001f090: 2069 6e64 6963 6174 6564 2073 6861 7065   indicated shape
-0001f0a0: 2061 6e64 2064 7479 7065 2e0a 0a20 2020   and dtype...   
-0001f0b0: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
-0001f0c0: 2d2d 2d2d 2d2d 0a0a 2020 2020 3e3e 3e20  ------..    >>> 
-0001f0d0: 6120 3d20 6672 6f6d 5f66 756e 6328 6e70  a = from_func(np
-0001f0e0: 2e61 7261 6e67 652c 2028 332c 292c 2064  .arange, (3,), d
-0001f0f0: 7479 7065 3d27 6938 272c 2061 7267 733d  type='i8', args=
-0001f100: 2833 2c29 290a 2020 2020 3e3e 3e20 612e  (3,)).    >>> a.
-0001f110: 636f 6d70 7574 6528 290a 2020 2020 6172  compute().    ar
-0001f120: 7261 7928 5b30 2c20 312c 2032 5d29 0a0a  ray([0, 1, 2])..
-0001f130: 2020 2020 5468 6973 2077 6f72 6b73 2070      This works p
-0001f140: 6172 7469 6375 6c61 726c 7920 7765 6c6c  articularly well
-0001f150: 2077 6865 6e20 636f 7570 6c65 6420 7769   when coupled wi
-0001f160: 7468 2064 6173 6b2e 6172 7261 7920 6675  th dask.array fu
-0001f170: 6e63 7469 6f6e 7320 6c69 6b65 0a20 2020  nctions like.   
-0001f180: 2063 6f6e 6361 7465 6e61 7465 2061 6e64   concatenate and
-0001f190: 2073 7461 636b 3a0a 0a20 2020 203e 3e3e   stack:..    >>>
-0001f1a0: 2061 7272 6179 7320 3d20 5b66 726f 6d5f   arrays = [from_
-0001f1b0: 6675 6e63 286e 702e 6172 7261 792c 2028  func(np.array, (
-0001f1c0: 292c 2064 7479 7065 3d27 6938 272c 2061  ), dtype='i8', a
-0001f1d0: 7267 733d 286e 2c29 2920 666f 7220 6e20  rgs=(n,)) for n 
-0001f1e0: 696e 2072 616e 6765 2835 295d 0a20 2020  in range(5)].   
-0001f1f0: 203e 3e3e 2073 7461 636b 2861 7272 6179   >>> stack(array
-0001f200: 7329 2e63 6f6d 7075 7465 2829 0a20 2020  s).compute().   
-0001f210: 2061 7272 6179 285b 302c 2031 2c20 322c   array([0, 1, 2,
-0001f220: 2033 2c20 345d 290a 2020 2020 2222 220a   3, 4]).    """.
-0001f230: 2020 2020 6966 206b 7761 7267 7320 6973      if kwargs is
-0001f240: 204e 6f6e 653a 0a20 2020 2020 2020 206b   None:.        k
-0001f250: 7761 7267 7320 3d20 7b7d 0a0a 2020 2020  wargs = {}..    
-0001f260: 6e61 6d65 203d 206e 616d 6520 6f72 2022  name = name or "
-0001f270: 6672 6f6d 5f66 756e 632d 2220 2b20 746f  from_func-" + to
-0001f280: 6b65 6e69 7a65 2866 756e 632c 2073 6861  kenize(func, sha
-0001f290: 7065 2c20 6474 7970 652c 2061 7267 732c  pe, dtype, args,
-0001f2a0: 206b 7761 7267 7329 0a20 2020 2069 6620   kwargs).    if 
-0001f2b0: 6172 6773 206f 7220 6b77 6172 6773 3a0a  args or kwargs:.
-0001f2c0: 2020 2020 2020 2020 6675 6e63 203d 2070          func = p
-0001f2d0: 6172 7469 616c 2866 756e 632c 202a 6172  artial(func, *ar
-0001f2e0: 6773 2c20 2a2a 6b77 6172 6773 290a 2020  gs, **kwargs).  
-0001f2f0: 2020 6473 6b20 3d20 7b28 6e61 6d65 2c29    dsk = {(name,)
-0001f300: 202b 2028 302c 2920 2a20 6c65 6e28 7368   + (0,) * len(sh
-0001f310: 6170 6529 3a20 2866 756e 632c 297d 0a20  ape): (func,)}. 
-0001f320: 2020 2063 6875 6e6b 7320 3d20 7475 706c     chunks = tupl
-0001f330: 6528 2869 2c29 2066 6f72 2069 2069 6e20  e((i,) for i in 
-0001f340: 7368 6170 6529 0a20 2020 2072 6574 7572  shape).    retur
-0001f350: 6e20 4172 7261 7928 6473 6b2c 206e 616d  n Array(dsk, nam
-0001f360: 652c 2063 6875 6e6b 732c 2064 7479 7065  e, chunks, dtype
-0001f370: 290a 0a0a 6465 6620 636f 6d6d 6f6e 5f62  )...def common_b
-0001f380: 6c6f 636b 6469 6d28 626c 6f63 6b64 696d  lockdim(blockdim
-0001f390: 7329 3a0a 2020 2020 2222 2246 696e 6420  s):.    """Find 
-0001f3a0: 7468 6520 636f 6d6d 6f6e 2062 6c6f 636b  the common block
-0001f3b0: 2064 696d 656e 7369 6f6e 7320 6672 6f6d   dimensions from
-0001f3c0: 2074 6865 206c 6973 7420 6f66 2062 6c6f   the list of blo
-0001f3d0: 636b 2064 696d 656e 7369 6f6e 730a 0a20  ck dimensions.. 
-0001f3e0: 2020 2043 7572 7265 6e74 6c79 206f 6e6c     Currently onl
-0001f3f0: 7920 696d 706c 656d 656e 7473 2074 6865  y implements the
-0001f400: 2073 696d 706c 6573 7420 706f 7373 6962   simplest possib
-0001f410: 6c65 2068 6575 7269 7374 6963 3a20 7468  le heuristic: th
-0001f420: 6520 636f 6d6d 6f6e 0a20 2020 2062 6c6f  e common.    blo
-0001f430: 636b 2d64 696d 656e 7369 6f6e 2069 7320  ck-dimension is 
-0001f440: 7468 6520 6f6e 6c79 206f 6e65 2074 6861  the only one tha
-0001f450: 7420 646f 6573 206e 6f74 2073 7061 6e20  t does not span 
-0001f460: 6675 6c6c 7920 7370 616e 2061 2064 696d  fully span a dim
-0001f470: 656e 7369 6f6e 2e0a 2020 2020 5468 6973  ension..    This
-0001f480: 2069 7320 6120 636f 6e73 6572 7661 7469   is a conservati
-0001f490: 7665 2063 686f 6963 6520 7468 6174 2061  ve choice that a
-0001f4a0: 6c6c 6f77 7320 7573 2074 6f20 6176 6f69  llows us to avoi
-0001f4b0: 6420 706f 7465 6e74 6961 6c6c 7920 7665  d potentially ve
-0001f4c0: 7279 0a20 2020 2065 7870 656e 7369 7665  ry.    expensive
-0001f4d0: 2072 6563 6875 6e6b 696e 672e 0a0a 2020   rechunking...  
-0001f4e0: 2020 4173 7375 6d65 7320 7468 6174 2065    Assumes that e
-0001f4f0: 6163 6820 656c 656d 656e 7420 6f66 2074  ach element of t
-0001f500: 6865 2069 6e70 7574 2062 6c6f 636b 2064  he input block d
-0001f510: 696d 656e 7369 6f6e 7320 6861 7320 616c  imensions has al
-0001f520: 6c20 7468 6520 7361 6d65 0a20 2020 2073  l the same.    s
-0001f530: 756d 2028 692e 652e 2c20 7468 6174 2074  um (i.e., that t
-0001f540: 6865 7920 636f 7272 6573 706f 6e64 2074  hey correspond t
-0001f550: 6f20 6469 6d65 6e73 696f 6e73 206f 6620  o dimensions of 
-0001f560: 7468 6520 7361 6d65 2073 697a 6529 2e0a  the same size)..
-0001f570: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
-0001f580: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e    --------.    >
-0001f590: 3e3e 2063 6f6d 6d6f 6e5f 626c 6f63 6b64  >> common_blockd
-0001f5a0: 696d 285b 2833 2c29 2c20 2832 2c20 3129  im([(3,), (2, 1)
-0001f5b0: 5d29 0a20 2020 2028 322c 2031 290a 2020  ]).    (2, 1).  
-0001f5c0: 2020 3e3e 3e20 636f 6d6d 6f6e 5f62 6c6f    >>> common_blo
-0001f5d0: 636b 6469 6d28 5b28 312c 2032 292c 2028  ckdim([(1, 2), (
-0001f5e0: 322c 2031 295d 290a 2020 2020 2831 2c20  2, 1)]).    (1, 
-0001f5f0: 312c 2031 290a 2020 2020 3e3e 3e20 636f  1, 1).    >>> co
-0001f600: 6d6d 6f6e 5f62 6c6f 636b 6469 6d28 5b28  mmon_blockdim([(
-0001f610: 322c 2032 292c 2028 332c 2031 295d 2920  2, 2), (3, 1)]) 
-0001f620: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-0001f630: 500a 2020 2020 5472 6163 6562 6163 6b20  P.    Traceback 
-0001f640: 286d 6f73 7420 7265 6365 6e74 2063 616c  (most recent cal
-0001f650: 6c20 6c61 7374 293a 0a20 2020 2020 2020  l last):.       
-0001f660: 202e 2e2e 0a20 2020 2056 616c 7565 4572   ....    ValueEr
-0001f670: 726f 723a 2043 6875 6e6b 7320 646f 206e  ror: Chunks do n
-0001f680: 6f74 2061 6c69 676e 0a20 2020 2022 2222  ot align.    """
-0001f690: 0a20 2020 2069 6620 6e6f 7420 616e 7928  .    if not any(
-0001f6a0: 626c 6f63 6b64 696d 7329 3a0a 2020 2020  blockdims):.    
-0001f6b0: 2020 2020 7265 7475 726e 2028 290a 2020      return ().  
-0001f6c0: 2020 6e6f 6e5f 7472 6976 6961 6c5f 6469    non_trivial_di
-0001f6d0: 6d73 203d 207b 6420 666f 7220 6420 696e  ms = {d for d in
-0001f6e0: 2062 6c6f 636b 6469 6d73 2069 6620 6c65   blockdims if le
-0001f6f0: 6e28 6429 203e 2031 7d0a 2020 2020 6966  n(d) > 1}.    if
-0001f700: 206c 656e 286e 6f6e 5f74 7269 7669 616c   len(non_trivial
-0001f710: 5f64 696d 7329 203d 3d20 313a 0a20 2020  _dims) == 1:.   
-0001f720: 2020 2020 2072 6574 7572 6e20 6669 7273       return firs
-0001f730: 7428 6e6f 6e5f 7472 6976 6961 6c5f 6469  t(non_trivial_di
-0001f740: 6d73 290a 2020 2020 6966 206c 656e 286e  ms).    if len(n
-0001f750: 6f6e 5f74 7269 7669 616c 5f64 696d 7329  on_trivial_dims)
-0001f760: 203d 3d20 303a 0a20 2020 2020 2020 2072   == 0:.        r
-0001f770: 6574 7572 6e20 6d61 7828 626c 6f63 6b64  eturn max(blockd
-0001f780: 696d 732c 206b 6579 3d66 6972 7374 290a  ims, key=first).
-0001f790: 0a20 2020 2069 6620 6e70 2e69 736e 616e  .    if np.isnan
-0001f7a0: 2873 756d 286d 6170 2873 756d 2c20 626c  (sum(map(sum, bl
-0001f7b0: 6f63 6b64 696d 7329 2929 3a0a 2020 2020  ockdims))):.    
-0001f7c0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001f7d0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0001f7e0: 2020 2241 7272 6179 7327 2063 6875 6e6b    "Arrays' chunk
-0001f7f0: 2073 697a 6573 2028 2573 2920 6172 6520   sizes (%s) are 
-0001f800: 756e 6b6e 6f77 6e2e 5c6e 5c6e 220a 2020  unknown.\n\n".  
-0001f810: 2020 2020 2020 2020 2020 2241 2070 6f73            "A pos
-0001f820: 7369 626c 6520 736f 6c75 7469 6f6e 3a5c  sible solution:\
-0001f830: 6e22 0a20 2020 2020 2020 2020 2020 2022  n".            "
-0001f840: 2020 782e 636f 6d70 7574 655f 6368 756e    x.compute_chun
-0001f850: 6b5f 7369 7a65 7328 2922 2025 2062 6c6f  k_sizes()" % blo
-0001f860: 636b 6469 6d73 0a20 2020 2020 2020 2029  ckdims.        )
-0001f870: 0a0a 2020 2020 6966 206c 656e 2873 6574  ..    if len(set
-0001f880: 286d 6170 2873 756d 2c20 6e6f 6e5f 7472  (map(sum, non_tr
-0001f890: 6976 6961 6c5f 6469 6d73 2929 2920 3e20  ivial_dims))) > 
-0001f8a0: 313a 0a20 2020 2020 2020 2072 6169 7365  1:.        raise
-0001f8b0: 2056 616c 7565 4572 726f 7228 2243 6875   ValueError("Chu
-0001f8c0: 6e6b 7320 646f 206e 6f74 2061 6464 2075  nks do not add u
-0001f8d0: 7020 746f 2073 616d 6520 7661 6c75 6522  p to same value"
-0001f8e0: 2c20 626c 6f63 6b64 696d 7329 0a0a 2020  , blockdims)..  
-0001f8f0: 2020 2320 5765 2068 6176 6520 6d75 6c74    # We have mult
-0001f900: 6970 6c65 206e 6f6e 2d74 7269 7669 616c  iple non-trivial
-0001f910: 2063 6875 6e6b 7320 6f6e 2074 6869 7320   chunks on this 
-0001f920: 6178 6973 0a20 2020 2023 2065 2e67 2e20  axis.    # e.g. 
-0001f930: 2835 2c20 3229 2061 6e64 2028 342c 2033  (5, 2) and (4, 3
-0001f940: 290a 0a20 2020 2023 2057 6520 6372 6561  )..    # We crea
-0001f950: 7465 2061 2073 696e 676c 6520 6368 756e  te a single chun
-0001f960: 6b20 7475 706c 6520 7769 7468 2074 6865  k tuple with the
-0001f970: 2073 616d 6520 746f 7461 6c20 6c65 6e67   same total leng
-0001f980: 7468 0a20 2020 2023 2074 6861 7420 6576  th.    # that ev
-0001f990: 656e 6c79 2064 6976 6964 6573 2062 6f74  enly divides bot
-0001f9a0: 682c 2065 2e67 2e20 2834 2c20 312c 2032  h, e.g. (4, 1, 2
-0001f9b0: 290a 0a20 2020 2023 2054 6f20 6163 636f  )..    # To acco
-0001f9c0: 6d70 6c69 7368 2074 6869 7320 7765 2077  mplish this we w
-0001f9d0: 616c 6b20 646f 776e 2061 6c6c 2063 6875  alk down all chu
-0001f9e0: 6e6b 2074 7570 6c65 7320 746f 6765 7468  nk tuples togeth
-0001f9f0: 6572 2c20 6669 6e64 696e 6720 7468 650a  er, finding the.
-0001fa00: 2020 2020 2320 736d 616c 6c65 7374 2065      # smallest e
-0001fa10: 6c65 6d65 6e74 2c20 6164 6469 6e67 2069  lement, adding i
-0001fa20: 7420 746f 2074 6865 206f 7574 7075 742c  t to the output,
-0001fa30: 2061 6e64 2073 7562 7472 6163 7469 6e67   and subtracting
-0001fa40: 2069 7420 6672 6f6d 2061 6c6c 0a20 2020   it from all.   
-0001fa50: 2023 206f 7468 6572 2065 6c65 6d65 6e74   # other element
-0001fa60: 7320 616e 6420 7265 6d6f 7665 2074 6865  s and remove the
-0001fa70: 2065 6c65 6d65 6e74 2069 7473 656c 662e   element itself.
-0001fa80: 2020 5765 2073 746f 7020 6f6e 6365 2077    We stop once w
-0001fa90: 6520 6861 7665 0a20 2020 2023 2062 7572  e have.    # bur
-0001faa0: 6e65 6420 7468 726f 7567 6820 616c 6c20  ned through all 
-0001fab0: 6f66 2074 6865 2063 6875 6e6b 2074 7570  of the chunk tup
-0001fac0: 6c65 732e 0a20 2020 2023 2046 6f72 2065  les..    # For e
-0001fad0: 6666 6963 6965 6e63 7927 7320 7361 6b65  fficiency's sake
-0001fae0: 2077 6520 7265 7665 7273 6520 7468 6520   we reverse the 
-0001faf0: 6c69 7374 7320 736f 2074 6861 7420 7765  lists so that we
-0001fb00: 2063 616e 2070 6f70 206f 6666 2074 6865   can pop off the
-0001fb10: 2065 6e64 0a20 2020 2072 6368 756e 6b73   end.    rchunks
-0001fb20: 203d 205b 6c69 7374 286e 7464 295b 3a3a   = [list(ntd)[::
-0001fb30: 2d31 5d20 666f 7220 6e74 6420 696e 206e  -1] for ntd in n
-0001fb40: 6f6e 5f74 7269 7669 616c 5f64 696d 735d  on_trivial_dims]
-0001fb50: 0a20 2020 2074 6f74 616c 203d 2073 756d  .    total = sum
-0001fb60: 2866 6972 7374 286e 6f6e 5f74 7269 7669  (first(non_trivi
-0001fb70: 616c 5f64 696d 7329 290a 2020 2020 6920  al_dims)).    i 
-0001fb80: 3d20 300a 0a20 2020 206f 7574 203d 205b  = 0..    out = [
-0001fb90: 5d0a 2020 2020 7768 696c 6520 6920 3c20  ].    while i < 
-0001fba0: 746f 7461 6c3a 0a20 2020 2020 2020 206d  total:.        m
-0001fbb0: 203d 206d 696e 2863 5b2d 315d 2066 6f72   = min(c[-1] for
-0001fbc0: 2063 2069 6e20 7263 6875 6e6b 7329 0a20   c in rchunks). 
-0001fbd0: 2020 2020 2020 206f 7574 2e61 7070 656e         out.appen
-0001fbe0: 6428 6d29 0a20 2020 2020 2020 2066 6f72  d(m).        for
-0001fbf0: 2063 2069 6e20 7263 6875 6e6b 733a 0a20   c in rchunks:. 
-0001fc00: 2020 2020 2020 2020 2020 2063 5b2d 315d             c[-1]
-0001fc10: 202d 3d20 6d0a 2020 2020 2020 2020 2020   -= m.          
-0001fc20: 2020 6966 2063 5b2d 315d 203d 3d20 303a    if c[-1] == 0:
-0001fc30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fc40: 2063 2e70 6f70 2829 0a20 2020 2020 2020   c.pop().       
-0001fc50: 2069 202b 3d20 6d0a 0a20 2020 2072 6574   i += m..    ret
-0001fc60: 7572 6e20 7475 706c 6528 6f75 7429 0a0a  urn tuple(out)..
-0001fc70: 0a64 6566 2075 6e69 6679 5f63 6875 6e6b  .def unify_chunk
-0001fc80: 7328 2a61 7267 732c 202a 2a6b 7761 7267  s(*args, **kwarg
-0001fc90: 7329 3a0a 2020 2020 2222 220a 2020 2020  s):.    """.    
-0001fca0: 556e 6966 7920 6368 756e 6b73 2061 6372  Unify chunks acr
-0001fcb0: 6f73 7320 6120 7365 7175 656e 6365 206f  oss a sequence o
-0001fcc0: 6620 6172 7261 7973 0a0a 2020 2020 5468  f arrays..    Th
-0001fcd0: 6973 2075 7469 6c69 7479 2066 756e 6374  is utility funct
-0001fce0: 696f 6e20 6973 2075 7365 6420 7769 7468  ion is used with
-0001fcf0: 696e 206f 7468 6572 2063 6f6d 6d6f 6e20  in other common 
-0001fd00: 6f70 6572 6174 696f 6e73 206c 696b 650a  operations like.
-0001fd10: 2020 2020 3a66 756e 633a 6064 6173 6b2e      :func:`dask.
-0001fd20: 6172 7261 792e 636f 7265 2e6d 6170 5f62  array.core.map_b
-0001fd30: 6c6f 636b 7360 2061 6e64 203a 6675 6e63  locks` and :func
-0001fd40: 3a60 6461 736b 2e61 7272 6179 2e63 6f72  :`dask.array.cor
-0001fd50: 652e 626c 6f63 6b77 6973 6560 2e0a 2020  e.blockwise`..  
-0001fd60: 2020 4974 2069 7320 6e6f 7420 636f 6d6d    It is not comm
-0001fd70: 6f6e 6c79 2075 7365 6420 6279 2065 6e64  only used by end
-0001fd80: 2d75 7365 7273 2064 6972 6563 746c 792e  -users directly.
-0001fd90: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-0001fda0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-0001fdb0: 2020 2020 2a61 7267 733a 2073 6571 7565      *args: seque
-0001fdc0: 6e63 6520 6f66 2041 7272 6179 2c20 696e  nce of Array, in
-0001fdd0: 6465 7820 7061 6972 730a 2020 2020 2020  dex pairs.      
-0001fde0: 2020 5365 7175 656e 6365 206c 696b 6520    Sequence like 
-0001fdf0: 2878 2c20 2769 6a27 2c20 792c 2027 6a6b  (x, 'ij', y, 'jk
-0001fe00: 272c 207a 2c20 2769 2729 0a0a 2020 2020  ', z, 'i')..    
-0001fe10: 4578 616d 706c 6573 0a20 2020 202d 2d2d  Examples.    ---
-0001fe20: 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20 696d  -----.    >>> im
-0001fe30: 706f 7274 2064 6173 6b2e 6172 7261 7920  port dask.array 
-0001fe40: 6173 2064 610a 2020 2020 3e3e 3e20 7820  as da.    >>> x 
-0001fe50: 3d20 6461 2e6f 6e65 7328 3130 2c20 6368  = da.ones(10, ch
-0001fe60: 756e 6b73 3d28 2835 2c20 322c 2033 292c  unks=((5, 2, 3),
-0001fe70: 2929 0a20 2020 203e 3e3e 2079 203d 2064  )).    >>> y = d
-0001fe80: 612e 6f6e 6573 2831 302c 2063 6875 6e6b  a.ones(10, chunk
-0001fe90: 733d 2828 322c 2033 2c20 3529 2c29 290a  s=((2, 3, 5),)).
-0001fea0: 2020 2020 3e3e 3e20 6368 756e 6b73 732c      >>> chunkss,
-0001feb0: 2061 7272 6179 7320 3d20 756e 6966 795f   arrays = unify_
-0001fec0: 6368 756e 6b73 2878 2c20 2769 272c 2079  chunks(x, 'i', y
-0001fed0: 2c20 2769 2729 0a20 2020 203e 3e3e 2063  , 'i').    >>> c
-0001fee0: 6875 6e6b 7373 0a20 2020 207b 2769 273a  hunkss.    {'i':
-0001fef0: 2028 322c 2033 2c20 322c 2033 297d 0a0a   (2, 3, 2, 3)}..
-0001ff00: 2020 2020 3e3e 3e20 7820 3d20 6461 2e6f      >>> x = da.o
-0001ff10: 6e65 7328 2831 3030 2c20 3130 292c 2063  nes((100, 10), c
-0001ff20: 6875 6e6b 733d 2832 302c 2035 2929 0a20  hunks=(20, 5)). 
-0001ff30: 2020 203e 3e3e 2079 203d 2064 612e 6f6e     >>> y = da.on
-0001ff40: 6573 2828 3130 2c20 3130 3029 2c20 6368  es((10, 100), ch
-0001ff50: 756e 6b73 3d28 342c 2035 3029 290a 2020  unks=(4, 50)).  
-0001ff60: 2020 3e3e 3e20 6368 756e 6b73 732c 2061    >>> chunkss, a
-0001ff70: 7272 6179 7320 3d20 756e 6966 795f 6368  rrays = unify_ch
-0001ff80: 756e 6b73 2878 2c20 2769 6a27 2c20 792c  unks(x, 'ij', y,
-0001ff90: 2027 6a6b 272c 2027 636f 6e73 7461 6e74   'jk', 'constant
-0001ffa0: 272c 204e 6f6e 6529 0a20 2020 203e 3e3e  ', None).    >>>
-0001ffb0: 2063 6875 6e6b 7373 2020 2320 646f 6374   chunkss  # doct
-0001ffc0: 6573 743a 202b 534b 4950 0a20 2020 207b  est: +SKIP.    {
-0001ffd0: 276b 273a 2028 3530 2c20 3530 292c 2027  'k': (50, 50), '
-0001ffe0: 6927 3a20 2832 302c 2032 302c 2032 302c  i': (20, 20, 20,
-0001fff0: 2032 302c 2032 3029 2c20 276a 273a 2028   20, 20), 'j': (
-00020000: 342c 2031 2c20 332c 2032 297d 0a0a 2020  4, 1, 3, 2)}..  
-00020010: 2020 3e3e 3e20 756e 6966 795f 6368 756e    >>> unify_chun
-00020020: 6b73 2830 2c20 4e6f 6e65 290a 2020 2020  ks(0, None).    
-00020030: 287b 7d2c 205b 305d 290a 0a20 2020 2052  ({}, [0])..    R
-00020040: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-00020050: 2d2d 0a20 2020 2063 6875 6e6b 7373 203a  --.    chunkss :
-00020060: 2064 6963 740a 2020 2020 2020 2020 4d61   dict.        Ma
-00020070: 7020 6c69 6b65 207b 696e 6465 783a 2063  p like {index: c
-00020080: 6875 6e6b 737d 2e0a 2020 2020 6172 7261  hunks}..    arra
-00020090: 7973 203a 206c 6973 740a 2020 2020 2020  ys : list.      
-000200a0: 2020 4c69 7374 206f 6620 7265 6368 756e    List of rechun
-000200b0: 6b65 6420 6172 7261 7973 2e0a 0a20 2020  ked arrays...   
-000200c0: 2053 6565 2041 6c73 6f0a 2020 2020 2d2d   See Also.    --
-000200d0: 2d2d 2d2d 2d2d 0a20 2020 2063 6f6d 6d6f  ------.    commo
-000200e0: 6e5f 626c 6f63 6b64 696d 0a20 2020 2022  n_blockdim.    "
-000200f0: 2222 0a20 2020 2069 6620 6e6f 7420 6172  "".    if not ar
-00020100: 6773 3a0a 2020 2020 2020 2020 7265 7475  gs:.        retu
-00020110: 726e 207b 7d2c 205b 5d0a 0a20 2020 2061  rn {}, []..    a
-00020120: 7267 696e 6473 203d 205b 0a20 2020 2020  rginds = [.     
-00020130: 2020 2028 6173 616e 7961 7272 6179 2861     (asanyarray(a
-00020140: 2920 6966 2069 6e64 2069 7320 6e6f 7420  ) if ind is not 
-00020150: 4e6f 6e65 2065 6c73 6520 612c 2069 6e64  None else a, ind
-00020160: 2920 666f 7220 612c 2069 6e64 2069 6e20  ) for a, ind in 
-00020170: 7061 7274 6974 696f 6e28 322c 2061 7267  partition(2, arg
-00020180: 7329 0a20 2020 205d 2020 2320 5b78 2c20  s).    ]  # [x, 
-00020190: 696a 2c20 792c 206a 6b5d 0a20 2020 2077  ij, y, jk].    w
-000201a0: 6172 6e20 3d20 6b77 6172 6773 2e67 6574  arn = kwargs.get
-000201b0: 2822 7761 726e 222c 2054 7275 6529 0a0a  ("warn", True)..
-000201c0: 2020 2020 6172 7261 7973 2c20 696e 6473      arrays, inds
-000201d0: 203d 207a 6970 282a 6172 6769 6e64 7329   = zip(*arginds)
-000201e0: 0a20 2020 2069 6620 616c 6c28 696e 6420  .    if all(ind 
-000201f0: 6973 204e 6f6e 6520 666f 7220 696e 6420  is None for ind 
-00020200: 696e 2069 6e64 7329 3a0a 2020 2020 2020  in inds):.      
-00020210: 2020 7265 7475 726e 207b 7d2c 206c 6973    return {}, lis
-00020220: 7428 6172 7261 7973 290a 2020 2020 6966  t(arrays).    if
-00020230: 2061 6c6c 2869 6e64 203d 3d20 696e 6473   all(ind == inds
-00020240: 5b30 5d20 666f 7220 696e 6420 696e 2069  [0] for ind in i
-00020250: 6e64 7329 2061 6e64 2061 6c6c 280a 2020  nds) and all(.  
-00020260: 2020 2020 2020 612e 6368 756e 6b73 203d        a.chunks =
-00020270: 3d20 6172 7261 7973 5b30 5d2e 6368 756e  = arrays[0].chun
-00020280: 6b73 2066 6f72 2061 2069 6e20 6172 7261  ks for a in arra
-00020290: 7973 0a20 2020 2029 3a0a 2020 2020 2020  ys.    ):.      
-000202a0: 2020 7265 7475 726e 2064 6963 7428 7a69    return dict(zi
-000202b0: 7028 696e 6473 5b30 5d2c 2061 7272 6179  p(inds[0], array
-000202c0: 735b 305d 2e63 6875 6e6b 7329 292c 2061  s[0].chunks)), a
-000202d0: 7272 6179 730a 0a20 2020 206e 616d 6569  rrays..    namei
-000202e0: 6e64 7320 3d20 5b5d 0a20 2020 2062 6c6f  nds = [].    blo
-000202f0: 636b 6469 6d5f 6469 6374 203d 2064 6963  ckdim_dict = dic
-00020300: 7428 290a 2020 2020 6d61 785f 7061 7274  t().    max_part
-00020310: 7320 3d20 300a 2020 2020 666f 7220 612c  s = 0.    for a,
-00020320: 2069 6e64 2069 6e20 6172 6769 6e64 733a   ind in arginds:
-00020330: 0a20 2020 2020 2020 2069 6620 696e 6420  .        if ind 
-00020340: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00020350: 2020 2020 2020 2020 206e 616d 6569 6e64           nameind
-00020360: 732e 6170 7065 6e64 2828 612e 6e61 6d65  s.append((a.name
-00020370: 2c20 696e 6429 290a 2020 2020 2020 2020  , ind)).        
-00020380: 2020 2020 626c 6f63 6b64 696d 5f64 6963      blockdim_dic
-00020390: 745b 612e 6e61 6d65 5d20 3d20 612e 6368  t[a.name] = a.ch
-000203a0: 756e 6b73 0a20 2020 2020 2020 2020 2020  unks.           
-000203b0: 206d 6178 5f70 6172 7473 203d 206d 6178   max_parts = max
-000203c0: 286d 6178 5f70 6172 7473 2c20 612e 6e70  (max_parts, a.np
-000203d0: 6172 7469 7469 6f6e 7329 0a20 2020 2020  artitions).     
-000203e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000203f0: 2020 2020 206e 616d 6569 6e64 732e 6170       nameinds.ap
-00020400: 7065 6e64 2828 612c 2069 6e64 2929 0a0a  pend((a, ind))..
-00020410: 2020 2020 6368 756e 6b73 7320 3d20 6272      chunkss = br
-00020420: 6f61 6463 6173 745f 6469 6d65 6e73 696f  oadcast_dimensio
-00020430: 6e73 286e 616d 6569 6e64 732c 2062 6c6f  ns(nameinds, blo
-00020440: 636b 6469 6d5f 6469 6374 2c20 636f 6e73  ckdim_dict, cons
-00020450: 6f6c 6964 6174 653d 636f 6d6d 6f6e 5f62  olidate=common_b
-00020460: 6c6f 636b 6469 6d29 0a20 2020 206e 7061  lockdim).    npa
-00020470: 7274 7320 3d20 6d61 7468 2e70 726f 6428  rts = math.prod(
-00020480: 6d61 7028 6c65 6e2c 2063 6875 6e6b 7373  map(len, chunkss
-00020490: 2e76 616c 7565 7328 2929 290a 0a20 2020  .values()))..   
-000204a0: 2069 6620 7761 726e 2061 6e64 206e 7061   if warn and npa
-000204b0: 7274 7320 616e 6420 6e70 6172 7473 203e  rts and nparts >
-000204c0: 3d20 6d61 785f 7061 7274 7320 2a20 3130  = max_parts * 10
-000204d0: 3a0a 2020 2020 2020 2020 7761 726e 696e  :.        warnin
-000204e0: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
-000204f0: 2020 2020 2022 496e 6372 6561 7369 6e67       "Increasing
-00020500: 206e 756d 6265 7220 6f66 2063 6875 6e6b   number of chunk
-00020510: 7320 6279 2066 6163 746f 7220 6f66 2025  s by factor of %
-00020520: 6422 2025 2028 6e70 6172 7473 202f 206d  d" % (nparts / m
-00020530: 6178 5f70 6172 7473 292c 0a20 2020 2020  ax_parts),.     
-00020540: 2020 2020 2020 2050 6572 666f 726d 616e         Performan
-00020550: 6365 5761 726e 696e 672c 0a20 2020 2020  ceWarning,.     
-00020560: 2020 2020 2020 2073 7461 636b 6c65 7665         stackleve
-00020570: 6c3d 332c 0a20 2020 2020 2020 2029 0a0a  l=3,.        )..
-00020580: 2020 2020 6172 7261 7973 203d 205b 5d0a      arrays = [].
-00020590: 2020 2020 666f 7220 612c 2069 2069 6e20      for a, i in 
-000205a0: 6172 6769 6e64 733a 0a20 2020 2020 2020  arginds:.       
-000205b0: 2069 6620 6920 6973 204e 6f6e 653a 0a20   if i is None:. 
-000205c0: 2020 2020 2020 2020 2020 2061 7272 6179             array
-000205d0: 732e 6170 7065 6e64 2861 290a 2020 2020  s.append(a).    
-000205e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000205f0: 2020 2020 2020 6368 756e 6b73 203d 2074        chunks = t
-00020600: 7570 6c65 280a 2020 2020 2020 2020 2020  uple(.          
-00020610: 2020 2020 2020 6368 756e 6b73 735b 6a5d        chunkss[j]
-00020620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020630: 2069 6620 612e 7368 6170 655b 6e5d 203e   if a.shape[n] >
-00020640: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
-00020650: 2020 2065 6c73 6520 612e 7368 6170 655b     else a.shape[
-00020660: 6e5d 0a20 2020 2020 2020 2020 2020 2020  n].             
-00020670: 2020 2069 6620 6e6f 7420 6e70 2e69 736e     if not np.isn
-00020680: 616e 2873 756d 2863 6875 6e6b 7373 5b6a  an(sum(chunkss[j
-00020690: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
-000206a0: 2020 2020 656c 7365 204e 6f6e 650a 2020      else None.  
-000206b0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-000206c0: 7220 6e2c 206a 2069 6e20 656e 756d 6572  r n, j in enumer
-000206d0: 6174 6528 6929 0a20 2020 2020 2020 2020  ate(i).         
-000206e0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000206f0: 2069 6620 6368 756e 6b73 2021 3d20 612e   if chunks != a.
-00020700: 6368 756e 6b73 2061 6e64 2061 6c6c 2861  chunks and all(a
-00020710: 2e63 6875 6e6b 7329 3a0a 2020 2020 2020  .chunks):.      
-00020720: 2020 2020 2020 2020 2020 6172 7261 7973            arrays
-00020730: 2e61 7070 656e 6428 612e 7265 6368 756e  .append(a.rechun
-00020740: 6b28 6368 756e 6b73 2929 0a20 2020 2020  k(chunks)).     
-00020750: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00020760: 2020 2020 2020 2020 2020 2020 2061 7272               arr
-00020770: 6179 732e 6170 7065 6e64 2861 290a 2020  ays.append(a).  
-00020780: 2020 7265 7475 726e 2063 6875 6e6b 7373    return chunkss
-00020790: 2c20 6172 7261 7973 0a0a 0a64 6566 2075  , arrays...def u
-000207a0: 6e70 6163 6b5f 7369 6e67 6c65 746f 6e28  npack_singleton(
-000207b0: 7829 3a0a 2020 2020 2222 220a 0a20 2020  x):.    """..   
-000207c0: 203e 3e3e 2075 6e70 6163 6b5f 7369 6e67   >>> unpack_sing
-000207d0: 6c65 746f 6e28 5b5b 5b5b 315d 5d5d 5d29  leton([[[[1]]]])
-000207e0: 0a20 2020 2031 0a20 2020 203e 3e3e 2075  .    1.    >>> u
-000207f0: 6e70 6163 6b5f 7369 6e67 6c65 746f 6e28  npack_singleton(
-00020800: 6e70 2e61 7272 6179 286e 702e 6461 7465  np.array(np.date
-00020810: 7469 6d65 3634 2827 3230 3030 2d30 312d  time64('2000-01-
-00020820: 3031 2729 2929 0a20 2020 2061 7272 6179  01'))).    array
-00020830: 2827 3230 3030 2d30 312d 3031 272c 2064  ('2000-01-01', d
-00020840: 7479 7065 3d27 6461 7465 7469 6d65 3634  type='datetime64
-00020850: 5b44 5d27 290a 2020 2020 2222 220a 2020  [D]').    """.  
-00020860: 2020 7768 696c 6520 6973 696e 7374 616e    while isinstan
-00020870: 6365 2878 2c20 286c 6973 742c 2074 7570  ce(x, (list, tup
-00020880: 6c65 2929 3a0a 2020 2020 2020 2020 7472  le)):.        tr
-00020890: 793a 0a20 2020 2020 2020 2020 2020 2078  y:.            x
-000208a0: 203d 2078 5b30 5d0a 2020 2020 2020 2020   = x[0].        
-000208b0: 6578 6365 7074 2028 496e 6465 7845 7272  except (IndexErr
-000208c0: 6f72 2c20 5479 7065 4572 726f 722c 204b  or, TypeError, K
-000208d0: 6579 4572 726f 7229 3a0a 2020 2020 2020  eyError):.      
-000208e0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-000208f0: 7265 7475 726e 2078 0a0a 0a64 6566 2062  return x...def b
-00020900: 6c6f 636b 2861 7272 6179 732c 2061 6c6c  lock(arrays, all
-00020910: 6f77 5f75 6e6b 6e6f 776e 5f63 6875 6e6b  ow_unknown_chunk
-00020920: 7369 7a65 733d 4661 6c73 6529 3a0a 2020  sizes=False):.  
-00020930: 2020 2222 220a 2020 2020 4173 7365 6d62    """.    Assemb
-00020940: 6c65 2061 6e20 6e64 2d61 7272 6179 2066  le an nd-array f
-00020950: 726f 6d20 6e65 7374 6564 206c 6973 7473  rom nested lists
-00020960: 206f 6620 626c 6f63 6b73 2e0a 0a20 2020   of blocks...   
-00020970: 2042 6c6f 636b 7320 696e 2074 6865 2069   Blocks in the i
-00020980: 6e6e 6572 6d6f 7374 206c 6973 7473 2061  nnermost lists a
-00020990: 7265 2063 6f6e 6361 7465 6e61 7465 6420  re concatenated 
-000209a0: 616c 6f6e 6720 7468 6520 6c61 7374 0a20  along the last. 
-000209b0: 2020 2064 696d 656e 7369 6f6e 2028 2d31     dimension (-1
-000209c0: 292c 2074 6865 6e20 7468 6573 6520 6172  ), then these ar
-000209d0: 6520 636f 6e63 6174 656e 6174 6564 2061  e concatenated a
-000209e0: 6c6f 6e67 2074 6865 2073 6563 6f6e 642d  long the second-
-000209f0: 6c61 7374 0a20 2020 2064 696d 656e 7369  last.    dimensi
-00020a00: 6f6e 2028 2d32 292c 2061 6e64 2073 6f20  on (-2), and so 
-00020a10: 6f6e 2075 6e74 696c 2074 6865 206f 7574  on until the out
-00020a20: 6572 6d6f 7374 206c 6973 7420 6973 2072  ermost list is r
-00020a30: 6561 6368 6564 0a0a 2020 2020 426c 6f63  eached..    Bloc
-00020a40: 6b73 2063 616e 2062 6520 6f66 2061 6e79  ks can be of any
-00020a50: 2064 696d 656e 7369 6f6e 2c20 6275 7420   dimension, but 
-00020a60: 7769 6c6c 206e 6f74 2062 6520 6272 6f61  will not be broa
-00020a70: 6463 6173 7465 6420 7573 696e 6720 7468  dcasted using th
-00020a80: 6520 6e6f 726d 616c 0a20 2020 2072 756c  e normal.    rul
-00020a90: 6573 2e20 496e 7374 6561 642c 206c 6561  es. Instead, lea
-00020aa0: 6469 6e67 2061 7865 7320 6f66 2073 697a  ding axes of siz
-00020ab0: 6520 3120 6172 6520 696e 7365 7274 6564  e 1 are inserted
-00020ac0: 2c20 746f 206d 616b 6520 6060 626c 6f63  , to make ``bloc
-00020ad0: 6b2e 6e64 696d 6060 0a20 2020 2074 6865  k.ndim``.    the
-00020ae0: 2073 616d 6520 666f 7220 616c 6c20 626c   same for all bl
-00020af0: 6f63 6b73 2e20 5468 6973 2069 7320 7072  ocks. This is pr
-00020b00: 696d 6172 696c 7920 7573 6566 756c 2066  imarily useful f
-00020b10: 6f72 2077 6f72 6b69 6e67 2077 6974 6820  or working with 
-00020b20: 7363 616c 6172 732c 0a20 2020 2061 6e64  scalars,.    and
-00020b30: 206d 6561 6e73 2074 6861 7420 636f 6465   means that code
-00020b40: 206c 696b 6520 6060 626c 6f63 6b28 5b76   like ``block([v
-00020b50: 2c20 315d 2960 6020 6973 2076 616c 6964  , 1])`` is valid
-00020b60: 2c20 7768 6572 650a 2020 2020 6060 762e  , where.    ``v.
-00020b70: 6e64 696d 203d 3d20 3160 602e 0a0a 2020  ndim == 1``...  
-00020b80: 2020 5768 656e 2074 6865 206e 6573 7465    When the neste
-00020b90: 6420 6c69 7374 2069 7320 7477 6f20 6c65  d list is two le
-00020ba0: 7665 6c73 2064 6565 702c 2074 6869 7320  vels deep, this 
-00020bb0: 616c 6c6f 7773 2062 6c6f 636b 206d 6174  allows block mat
-00020bc0: 7269 6365 7320 746f 2062 650a 2020 2020  rices to be.    
-00020bd0: 636f 6e73 7472 7563 7465 6420 6672 6f6d  constructed from
-00020be0: 2074 6865 6972 2063 6f6d 706f 6e65 6e74   their component
-00020bf0: 732e 0a0a 2020 2020 5061 7261 6d65 7465  s...    Paramete
-00020c00: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00020c10: 2d0a 2020 2020 6172 7261 7973 203a 206e  -.    arrays : n
-00020c20: 6573 7465 6420 6c69 7374 206f 6620 6172  ested list of ar
-00020c30: 7261 795f 6c69 6b65 206f 7220 7363 616c  ray_like or scal
-00020c40: 6172 7320 2862 7574 206e 6f74 2074 7570  ars (but not tup
-00020c50: 6c65 7329 0a20 2020 2020 2020 2049 6620  les).        If 
-00020c60: 7061 7373 6564 2061 2073 696e 676c 6520  passed a single 
-00020c70: 6e64 6172 7261 7920 6f72 2073 6361 6c61  ndarray or scala
-00020c80: 7220 2861 206e 6573 7465 6420 6c69 7374  r (a nested list
-00020c90: 206f 6620 6465 7074 6820 3029 2c20 7468   of depth 0), th
-00020ca0: 6973 0a20 2020 2020 2020 2069 7320 7265  is.        is re
-00020cb0: 7475 726e 6564 2075 6e6d 6f64 6966 6965  turned unmodifie
-00020cc0: 6420 2861 6e64 206e 6f74 2063 6f70 6965  d (and not copie
-00020cd0: 6429 2e0a 0a20 2020 2020 2020 2045 6c65  d)...        Ele
-00020ce0: 6d65 6e74 7320 7368 6170 6573 206d 7573  ments shapes mus
-00020cf0: 7420 6d61 7463 6820 616c 6f6e 6720 7468  t match along th
-00020d00: 6520 6170 7072 6f70 7269 6174 6520 6178  e appropriate ax
-00020d10: 6573 2028 7769 7468 6f75 740a 2020 2020  es (without.    
-00020d20: 2020 2020 6272 6f61 6463 6173 7469 6e67      broadcasting
-00020d30: 292c 2062 7574 206c 6561 6469 6e67 2031  ), but leading 1
-00020d40: 7320 7769 6c6c 2062 6520 7072 6570 656e  s will be prepen
-00020d50: 6465 6420 746f 2074 6865 2073 6861 7065  ded to the shape
-00020d60: 2061 730a 2020 2020 2020 2020 6e65 6365   as.        nece
-00020d70: 7373 6172 7920 746f 206d 616b 6520 7468  ssary to make th
-00020d80: 6520 6469 6d65 6e73 696f 6e73 206d 6174  e dimensions mat
-00020d90: 6368 2e0a 0a20 2020 2061 6c6c 6f77 5f75  ch...    allow_u
-00020da0: 6e6b 6e6f 776e 5f63 6875 6e6b 7369 7a65  nknown_chunksize
-00020db0: 733a 2062 6f6f 6c0a 2020 2020 2020 2020  s: bool.        
-00020dc0: 416c 6c6f 7720 756e 6b6e 6f77 6e20 6368  Allow unknown ch
-00020dd0: 756e 6b73 697a 6573 2c20 7375 6368 2061  unksizes, such a
-00020de0: 7320 636f 6d65 2066 726f 6d20 636f 6e76  s come from conv
-00020df0: 6572 7469 6e67 2066 726f 6d20 6461 736b  erting from dask
-00020e00: 0a20 2020 2020 2020 2064 6174 6166 7261  .        datafra
-00020e10: 6d65 732e 2020 4461 736b 2e61 7272 6179  mes.  Dask.array
-00020e20: 2069 7320 756e 6162 6c65 2074 6f20 7665   is unable to ve
-00020e30: 7269 6679 2074 6861 7420 6368 756e 6b73  rify that chunks
-00020e40: 206c 696e 6520 7570 2e20 2049 660a 2020   line up.  If.  
-00020e50: 2020 2020 2020 6461 7461 2063 6f6d 6573        data comes
-00020e60: 2066 726f 6d20 6469 6666 6572 656e 746c   from differentl
-00020e70: 7920 616c 6967 6e65 6420 736f 7572 6365  y aligned source
-00020e80: 7320 7468 656e 2074 6869 7320 6361 6e20  s then this can 
-00020e90: 6361 7573 650a 2020 2020 2020 2020 756e  cause.        un
-00020ea0: 6578 7065 6374 6564 2072 6573 756c 7473  expected results
-00020eb0: 2e0a 0a20 2020 2052 6574 7572 6e73 0a20  ...    Returns. 
-00020ec0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2062     -------.    b
-00020ed0: 6c6f 636b 5f61 7272 6179 203a 206e 6461  lock_array : nda
-00020ee0: 7272 6179 0a20 2020 2020 2020 2054 6865  rray.        The
-00020ef0: 2061 7272 6179 2061 7373 656d 626c 6564   array assembled
-00020f00: 2066 726f 6d20 7468 6520 6769 7665 6e20   from the given 
-00020f10: 626c 6f63 6b73 2e0a 0a20 2020 2020 2020  blocks...       
-00020f20: 2054 6865 2064 696d 656e 7369 6f6e 616c   The dimensional
-00020f30: 6974 7920 6f66 2074 6865 206f 7574 7075  ity of the outpu
-00020f40: 7420 6973 2065 7175 616c 2074 6f20 7468  t is equal to th
-00020f50: 6520 6772 6561 7465 7374 206f 663a 0a20  e greatest of:. 
-00020f60: 2020 2020 2020 202a 2074 6865 2064 696d         * the dim
-00020f70: 656e 7369 6f6e 616c 6974 7920 6f66 2061  ensionality of a
-00020f80: 6c6c 2074 6865 2069 6e70 7574 730a 2020  ll the inputs.  
-00020f90: 2020 2020 2020 2a20 7468 6520 6465 7074        * the dept
-00020fa0: 6820 746f 2077 6869 6368 2074 6865 2069  h to which the i
-00020fb0: 6e70 7574 206c 6973 7420 6973 206e 6573  nput list is nes
-00020fc0: 7465 640a 0a20 2020 2052 6169 7365 730a  ted..    Raises.
-00020fd0: 2020 2020 2d2d 2d2d 2d2d 0a20 2020 2056      ------.    V
-00020fe0: 616c 7565 4572 726f 720a 2020 2020 2020  alueError.      
-00020ff0: 2020 2a20 4966 206c 6973 7420 6465 7074    * If list dept
-00021000: 6873 2061 7265 206d 6973 6d61 7463 6865  hs are mismatche
-00021010: 6420 2d20 666f 7220 696e 7374 616e 6365  d - for instance
-00021020: 2c20 6060 5b5b 612c 2062 5d2c 2063 5d60  , ``[[a, b], c]`
-00021030: 6020 6973 0a20 2020 2020 2020 2020 2069  ` is.          i
-00021040: 6c6c 6567 616c 2c20 616e 6420 7368 6f75  llegal, and shou
-00021050: 6c64 2062 6520 7370 656c 7420 6060 5b5b  ld be spelt ``[[
-00021060: 612c 2062 5d2c 205b 635d 5d60 600a 2020  a, b], [c]]``.  
-00021070: 2020 2020 2020 2a20 4966 206c 6973 7473        * If lists
-00021080: 2061 7265 2065 6d70 7479 202d 2066 6f72   are empty - for
-00021090: 2069 6e73 7461 6e63 652c 2060 605b 5b61   instance, ``[[a
-000210a0: 2c20 625d 2c20 5b5d 5d60 600a 0a20 2020  , b], []]``..   
-000210b0: 2053 6565 2041 6c73 6f0a 2020 2020 2d2d   See Also.    --
-000210c0: 2d2d 2d2d 2d2d 0a20 2020 2063 6f6e 6361  ------.    conca
-000210d0: 7465 6e61 7465 203a 204a 6f69 6e20 6120  tenate : Join a 
-000210e0: 7365 7175 656e 6365 206f 6620 6172 7261  sequence of arra
-000210f0: 7973 2074 6f67 6574 6865 722e 0a20 2020  ys together..   
-00021100: 2073 7461 636b 203a 2053 7461 636b 2061   stack : Stack a
-00021110: 7272 6179 7320 696e 2073 6571 7565 6e63  rrays in sequenc
-00021120: 6520 616c 6f6e 6720 6120 6e65 7720 6469  e along a new di
-00021130: 6d65 6e73 696f 6e2e 0a20 2020 2068 7374  mension..    hst
-00021140: 6163 6b20 3a20 5374 6163 6b20 6172 7261  ack : Stack arra
-00021150: 7973 2069 6e20 7365 7175 656e 6365 2068  ys in sequence h
-00021160: 6f72 697a 6f6e 7461 6c6c 7920 2863 6f6c  orizontally (col
-00021170: 756d 6e20 7769 7365 292e 0a20 2020 2076  umn wise)..    v
-00021180: 7374 6163 6b20 3a20 5374 6163 6b20 6172  stack : Stack ar
-00021190: 7261 7973 2069 6e20 7365 7175 656e 6365  rays in sequence
-000211a0: 2076 6572 7469 6361 6c6c 7920 2872 6f77   vertically (row
-000211b0: 2077 6973 6529 2e0a 2020 2020 6473 7461   wise)..    dsta
-000211c0: 636b 203a 2053 7461 636b 2061 7272 6179  ck : Stack array
-000211d0: 7320 696e 2073 6571 7565 6e63 6520 6465  s in sequence de
-000211e0: 7074 6820 7769 7365 2028 616c 6f6e 6720  pth wise (along 
-000211f0: 7468 6972 6420 6469 6d65 6e73 696f 6e29  third dimension)
-00021200: 2e0a 2020 2020 7673 706c 6974 203a 2053  ..    vsplit : S
-00021210: 706c 6974 2061 7272 6179 2069 6e74 6f20  plit array into 
-00021220: 6120 6c69 7374 206f 6620 6d75 6c74 6970  a list of multip
-00021230: 6c65 2073 7562 2d61 7272 6179 7320 7665  le sub-arrays ve
-00021240: 7274 6963 616c 6c79 2e0a 0a20 2020 204e  rtically...    N
-00021250: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a0a  otes.    -----..
-00021260: 2020 2020 5768 656e 2063 616c 6c65 6420      When called 
-00021270: 7769 7468 206f 6e6c 7920 7363 616c 6172  with only scalar
-00021280: 732c 2060 6062 6c6f 636b 6060 2069 7320  s, ``block`` is 
-00021290: 6571 7569 7661 6c65 6e74 2074 6f20 616e  equivalent to an
-000212a0: 206e 6461 7272 6179 0a20 2020 2063 616c   ndarray.    cal
-000212b0: 6c2e 2053 6f20 6060 626c 6f63 6b28 5b5b  l. So ``block([[
-000212c0: 312c 2032 5d2c 205b 332c 2034 5d5d 2960  1, 2], [3, 4]])`
-000212d0: 6020 6973 2065 7175 6976 616c 656e 7420  ` is equivalent 
-000212e0: 746f 0a20 2020 2060 6061 7272 6179 285b  to.    ``array([
-000212f0: 5b31 2c20 325d 2c20 5b33 2c20 345d 5d29  [1, 2], [3, 4]])
-00021300: 6060 2e0a 0a20 2020 2054 6869 7320 6675  ``...    This fu
-00021310: 6e63 7469 6f6e 2064 6f65 7320 6e6f 7420  nction does not 
-00021320: 656e 666f 7263 6520 7468 6174 2074 6865  enforce that the
-00021330: 2062 6c6f 636b 7320 6c69 6520 6f6e 2061   blocks lie on a
-00021340: 2066 6978 6564 2067 7269 642e 0a20 2020   fixed grid..   
-00021350: 2060 6062 6c6f 636b 285b 5b61 2c20 625d   ``block([[a, b]
-00021360: 2c20 5b63 2c20 645d 5d29 6060 2069 7320  , [c, d]])`` is 
-00021370: 6e6f 7420 7265 7374 7269 6374 6564 2074  not restricted t
-00021380: 6f20 6172 7261 7973 206f 6620 7468 6520  o arrays of the 
-00021390: 666f 726d 3a3a 0a0a 2020 2020 2020 2020  form::..        
-000213a0: 4141 4162 620a 2020 2020 2020 2020 4141  AAAbb.        AA
-000213b0: 4162 620a 2020 2020 2020 2020 6363 6344  Abb.        cccD
-000213c0: 440a 0a20 2020 2042 7574 2069 7320 616c  D..    But is al
-000213d0: 736f 2061 6c6c 6f77 6564 2074 6f20 7072  so allowed to pr
-000213e0: 6f64 7563 652c 2066 6f72 2073 6f6d 6520  oduce, for some 
-000213f0: 6060 612c 2062 2c20 632c 2064 6060 3a3a  ``a, b, c, d``::
-00021400: 0a0a 2020 2020 2020 2020 4141 4162 620a  ..        AAAbb.
-00021410: 2020 2020 2020 2020 4141 4162 620a 2020          AAAbb.  
-00021420: 2020 2020 2020 6344 4444 440a 0a20 2020        cDDDD..   
-00021430: 2053 696e 6365 2063 6f6e 6361 7465 6e61   Since concatena
-00021440: 7469 6f6e 2068 6170 7065 6e73 2061 6c6f  tion happens alo
-00021450: 6e67 2074 6865 206c 6173 7420 6178 6973  ng the last axis
-00021460: 2066 6972 7374 2c20 6062 6c6f 636b 6020   first, `block` 
-00021470: 6973 205f 6e6f 745f 0a20 2020 2063 6170  is _not_.    cap
-00021480: 6162 6c65 206f 6620 7072 6f64 7563 696e  able of producin
-00021490: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
-000214a0: 6469 7265 6374 6c79 3a3a 0a0a 2020 2020  directly::..    
-000214b0: 2020 2020 4141 4162 620a 2020 2020 2020      AAAbb.      
-000214c0: 2020 6363 6362 620a 2020 2020 2020 2020    cccbb.        
-000214d0: 6363 6344 440a 0a20 2020 204d 6174 6c61  cccDD..    Matla
-000214e0: 6227 7320 2273 7175 6172 6520 6272 6163  b's "square brac
-000214f0: 6b65 7420 7374 6163 6b69 6e67 222c 2060  ket stacking", `
-00021500: 605b 412c 2042 2c20 2e2e 2e3b 2070 2c20  `[A, B, ...; p, 
-00021510: 712c 202e 2e2e 5d60 602c 2069 730a 2020  q, ...]``, is.  
-00021520: 2020 6571 7569 7661 6c65 6e74 2074 6f20    equivalent to 
-00021530: 6060 626c 6f63 6b28 5b5b 412c 2042 2c20  ``block([[A, B, 
-00021540: 2e2e 2e5d 2c20 5b70 2c20 712c 202e 2e2e  ...], [p, q, ...
-00021550: 5d5d 2960 602e 0a20 2020 2022 2222 0a0a  ]])``..    """..
-00021560: 2020 2020 2320 5468 6973 2077 6173 2063      # This was c
-00021570: 6f70 6965 6420 616c 6d6f 7374 2076 6572  opied almost ver
-00021580: 6261 7469 6d20 6672 6f6d 206e 756d 7079  batim from numpy
-00021590: 2e63 6f72 652e 7368 6170 655f 6261 7365  .core.shape_base
-000215a0: 2e62 6c6f 636b 0a20 2020 2023 2053 6565  .block.    # See
-000215b0: 206e 756d 7079 206c 6963 656e 7365 2061   numpy license a
-000215c0: 7420 6874 7470 733a 2f2f 6769 7468 7562  t https://github
-000215d0: 2e63 6f6d 2f6e 756d 7079 2f6e 756d 7079  .com/numpy/numpy
-000215e0: 2f62 6c6f 622f 6d61 7374 6572 2f4c 4943  /blob/master/LIC
-000215f0: 454e 5345 2e74 7874 0a20 2020 2023 206f  ENSE.txt.    # o
-00021600: 7220 4e55 4d50 595f 4c49 4345 4e53 452e  r NUMPY_LICENSE.
-00021610: 7478 7420 7769 7468 696e 2074 6869 7320  txt within this 
-00021620: 6469 7265 6374 6f72 790a 0a20 2020 2064  directory..    d
-00021630: 6566 2061 746c 6561 7374 5f6e 6428 782c  ef atleast_nd(x,
-00021640: 206e 6469 6d29 3a0a 2020 2020 2020 2020   ndim):.        
-00021650: 7820 3d20 6173 616e 7961 7272 6179 2878  x = asanyarray(x
-00021660: 290a 2020 2020 2020 2020 6469 6666 203d  ).        diff =
-00021670: 206d 6178 286e 6469 6d20 2d20 782e 6e64   max(ndim - x.nd
-00021680: 696d 2c20 3029 0a20 2020 2020 2020 2069  im, 0).        i
-00021690: 6620 6469 6666 203d 3d20 303a 0a20 2020  f diff == 0:.   
-000216a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000216b0: 780a 2020 2020 2020 2020 656c 7365 3a0a  x.        else:.
-000216c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000216d0: 726e 2078 5b28 4e6f 6e65 2c29 202a 2064  rn x[(None,) * d
-000216e0: 6966 6620 2b20 2845 6c6c 6970 7369 732c  iff + (Ellipsis,
-000216f0: 295d 0a0a 2020 2020 6465 6620 666f 726d  )]..    def form
-00021700: 6174 5f69 6e64 6578 2869 6e64 6578 293a  at_index(index):
-00021710: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00021720: 2261 7272 6179 7322 202b 2022 222e 6a6f  "arrays" + "".jo
-00021730: 696e 2866 225b 7b69 7d5d 2220 666f 7220  in(f"[{i}]" for 
-00021740: 6920 696e 2069 6e64 6578 290a 0a20 2020  i in index)..   
-00021750: 2072 6563 203d 205f 5265 6375 7273 6572   rec = _Recurser
-00021760: 2872 6563 7572 7365 5f69 663d 6c61 6d62  (recurse_if=lamb
-00021770: 6461 2078 3a20 7479 7065 2878 2920 6973  da x: type(x) is
-00021780: 206c 6973 7429 0a0a 2020 2020 2320 656e   list)..    # en
-00021790: 7375 7265 2074 6861 7420 7468 6520 6c69  sure that the li
-000217a0: 7374 7320 6172 6520 616c 6c20 6d61 7463  sts are all matc
-000217b0: 6865 6420 696e 2064 6570 7468 0a20 2020  hed in depth.   
-000217c0: 206c 6973 745f 6e64 696d 203d 204e 6f6e   list_ndim = Non
-000217d0: 650a 2020 2020 616e 795f 656d 7074 7920  e.    any_empty 
-000217e0: 3d20 4661 6c73 650a 2020 2020 666f 7220  = False.    for 
-000217f0: 696e 6465 782c 2076 616c 7565 2c20 656e  index, value, en
-00021800: 7465 7269 6e67 2069 6e20 7265 632e 7761  tering in rec.wa
-00021810: 6c6b 2861 7272 6179 7329 3a0a 2020 2020  lk(arrays):.    
-00021820: 2020 2020 6966 2074 7970 6528 7661 6c75      if type(valu
-00021830: 6529 2069 7320 7475 706c 653a 0a20 2020  e) is tuple:.   
-00021840: 2020 2020 2020 2020 2023 206e 6f74 2073           # not s
-00021850: 7472 6963 746c 7920 6e65 6365 7373 6172  trictly necessar
-00021860: 792c 2062 7574 2073 6176 6573 2075 7320  y, but saves us 
-00021870: 6672 6f6d 3a0a 2020 2020 2020 2020 2020  from:.          
-00021880: 2020 2320 202d 206d 6f72 6520 7468 616e    #  - more than
-00021890: 206f 6e65 2077 6179 2074 6f20 646f 2074   one way to do t
-000218a0: 6869 6e67 7320 2d20 6e6f 2070 6f69 6e74  hings - no point
-000218b0: 2074 7265 6174 696e 6720 7475 706c 6573   treating tuples
-000218c0: 206c 696b 650a 2020 2020 2020 2020 2020   like.          
-000218d0: 2020 2320 2020 206c 6973 7473 0a20 2020    #    lists.   
-000218e0: 2020 2020 2020 2020 2023 2020 2d20 686f           #  - ho
-000218f0: 7272 6962 6c79 2063 6f6e 6675 7369 6e67  rribly confusing
-00021900: 2062 6568 6176 696f 7572 2074 6861 7420   behaviour that 
-00021910: 7265 7375 6c74 7320 7768 656e 2074 7570  results when tup
-00021920: 6c65 7320 6172 650a 2020 2020 2020 2020  les are.        
-00021930: 2020 2020 2320 2020 2074 7265 6174 6564      #    treated
-00021940: 206c 696b 6520 6e64 6172 7261 790a 2020   like ndarray.  
-00021950: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00021960: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
-00021970: 2020 2020 2020 2020 2020 2022 7b7d 2069             "{} i
-00021980: 7320 6120 7475 706c 652e 2022 0a20 2020  s a tuple. ".   
-00021990: 2020 2020 2020 2020 2020 2020 2022 4f6e               "On
-000219a0: 6c79 206c 6973 7473 2063 616e 2062 6520  ly lists can be 
-000219b0: 7573 6564 2074 6f20 6172 7261 6e67 6520  used to arrange 
-000219c0: 626c 6f63 6b73 2c20 616e 6420 6e70 2e62  blocks, and np.b
-000219d0: 6c6f 636b 2064 6f65 7320 220a 2020 2020  lock does ".    
-000219e0: 2020 2020 2020 2020 2020 2020 226e 6f74              "not
-000219f0: 2061 6c6c 6f77 2069 6d70 6c69 6369 7420   allow implicit 
-00021a00: 636f 6e76 6572 7369 6f6e 2066 726f 6d20  conversion from 
-00021a10: 7475 706c 6520 746f 206e 6461 7272 6179  tuple to ndarray
-00021a20: 2e22 2e66 6f72 6d61 7428 0a20 2020 2020  .".format(.     
-00021a30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00021a40: 6f72 6d61 745f 696e 6465 7828 696e 6465  ormat_index(inde
-00021a50: 7829 0a20 2020 2020 2020 2020 2020 2020  x).             
-00021a60: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00021a70: 2029 0a20 2020 2020 2020 2069 6620 6e6f   ).        if no
-00021a80: 7420 656e 7465 7269 6e67 3a0a 2020 2020  t entering:.    
-00021a90: 2020 2020 2020 2020 6375 7272 5f64 6570          curr_dep
-00021aa0: 7468 203d 206c 656e 2869 6e64 6578 290a  th = len(index).
-00021ab0: 2020 2020 2020 2020 656c 6966 206c 656e          elif len
-00021ac0: 2876 616c 7565 2920 3d3d 2030 3a0a 2020  (value) == 0:.  
-00021ad0: 2020 2020 2020 2020 2020 6375 7272 5f64            curr_d
-00021ae0: 6570 7468 203d 206c 656e 2869 6e64 6578  epth = len(index
-00021af0: 2920 2b20 310a 2020 2020 2020 2020 2020  ) + 1.          
-00021b00: 2020 616e 795f 656d 7074 7920 3d20 5472    any_empty = Tr
-00021b10: 7565 0a20 2020 2020 2020 2065 6c73 653a  ue.        else:
-00021b20: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00021b30: 7469 6e75 650a 0a20 2020 2020 2020 2069  tinue..        i
-00021b40: 6620 6c69 7374 5f6e 6469 6d20 6973 206e  f list_ndim is n
-00021b50: 6f74 204e 6f6e 6520 616e 6420 6c69 7374  ot None and list
-00021b60: 5f6e 6469 6d20 213d 2063 7572 725f 6465  _ndim != curr_de
-00021b70: 7074 683a 0a20 2020 2020 2020 2020 2020  pth:.           
-00021b80: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00021b90: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00021ba0: 2020 2022 4c69 7374 2064 6570 7468 7320     "List depths 
-00021bb0: 6172 6520 6d69 736d 6174 6368 6564 2e20  are mismatched. 
-00021bc0: 4669 7273 7420 656c 656d 656e 7420 7761  First element wa
-00021bd0: 7320 6174 2064 6570 7468 207b 7d2c 2022  s at depth {}, "
-00021be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021bf0: 2022 6275 7420 7468 6572 6520 6973 2061   "but there is a
-00021c00: 6e20 656c 656d 656e 7420 6174 2064 6570  n element at dep
-00021c10: 7468 207b 7d20 287b 7d29 222e 666f 726d  th {} ({})".form
-00021c20: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-00021c30: 2020 2020 2020 2020 6c69 7374 5f6e 6469          list_ndi
-00021c40: 6d2c 2063 7572 725f 6465 7074 682c 2066  m, curr_depth, f
-00021c50: 6f72 6d61 745f 696e 6465 7828 696e 6465  ormat_index(inde
-00021c60: 7829 0a20 2020 2020 2020 2020 2020 2020  x).             
-00021c70: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00021c80: 2029 0a20 2020 2020 2020 206c 6973 745f   ).        list_
-00021c90: 6e64 696d 203d 2063 7572 725f 6465 7074  ndim = curr_dept
-00021ca0: 680a 0a20 2020 2023 2064 6f20 7468 6973  h..    # do this
-00021cb0: 2068 6572 6520 736f 2077 6520 6361 7463   here so we catc
-00021cc0: 6820 6465 7074 6820 6d69 736d 6174 6368  h depth mismatch
-00021cd0: 6573 2066 6972 7374 0a20 2020 2069 6620  es first.    if 
-00021ce0: 616e 795f 656d 7074 793a 0a20 2020 2020  any_empty:.     
-00021cf0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00021d00: 726f 7228 224c 6973 7473 2063 616e 6e6f  ror("Lists canno
-00021d10: 7420 6265 2065 6d70 7479 2229 0a0a 2020  t be empty")..  
-00021d20: 2020 2320 636f 6e76 6572 7420 616c 6c20    # convert all 
-00021d30: 7468 6520 6172 7261 7973 2074 6f20 6e64  the arrays to nd
-00021d40: 6172 7261 7973 0a20 2020 2061 7272 6179  arrays.    array
-00021d50: 7320 3d20 7265 632e 6d61 705f 7265 6475  s = rec.map_redu
-00021d60: 6365 2861 7272 6179 732c 2066 5f6d 6170  ce(arrays, f_map
-00021d70: 3d61 7361 6e79 6172 7261 792c 2066 5f72  =asanyarray, f_r
-00021d80: 6564 7563 653d 6c69 7374 290a 0a20 2020  educe=list)..   
-00021d90: 2023 2064 6574 6572 6d69 6e65 2074 6865   # determine the
-00021da0: 206d 6178 696d 756d 2064 696d 656e 7369   maximum dimensi
-00021db0: 6f6e 206f 6620 7468 6520 656c 656d 656e  on of the elemen
-00021dc0: 7473 0a20 2020 2065 6c65 6d5f 6e64 696d  ts.    elem_ndim
-00021dd0: 203d 2072 6563 2e6d 6170 5f72 6564 7563   = rec.map_reduc
-00021de0: 6528 6172 7261 7973 2c20 665f 6d61 703d  e(arrays, f_map=
-00021df0: 6c61 6d62 6461 2078 693a 2078 692e 6e64  lambda xi: xi.nd
-00021e00: 696d 2c20 665f 7265 6475 6365 3d6d 6178  im, f_reduce=max
-00021e10: 290a 2020 2020 6e64 696d 203d 206d 6178  ).    ndim = max
-00021e20: 286c 6973 745f 6e64 696d 2c20 656c 656d  (list_ndim, elem
-00021e30: 5f6e 6469 6d29 0a0a 2020 2020 2320 6669  _ndim)..    # fi
-00021e40: 7273 7420 6178 6973 2074 6f20 636f 6e63  rst axis to conc
-00021e50: 6174 656e 6174 6520 616c 6f6e 670a 2020  atenate along.  
-00021e60: 2020 6669 7273 745f 6178 6973 203d 206e    first_axis = n
-00021e70: 6469 6d20 2d20 6c69 7374 5f6e 6469 6d0a  dim - list_ndim.
-00021e80: 0a20 2020 2023 204d 616b 6520 616c 6c20  .    # Make all 
-00021e90: 7468 6520 656c 656d 656e 7473 2074 6865  the elements the
-00021ea0: 2073 616d 6520 6469 6d65 6e73 696f 6e0a   same dimension.
-00021eb0: 2020 2020 6172 7261 7973 203d 2072 6563      arrays = rec
-00021ec0: 2e6d 6170 5f72 6564 7563 6528 0a20 2020  .map_reduce(.   
-00021ed0: 2020 2020 2061 7272 6179 732c 2066 5f6d       arrays, f_m
-00021ee0: 6170 3d6c 616d 6264 6120 7869 3a20 6174  ap=lambda xi: at
-00021ef0: 6c65 6173 745f 6e64 2878 692c 206e 6469  least_nd(xi, ndi
-00021f00: 6d29 2c20 665f 7265 6475 6365 3d6c 6973  m), f_reduce=lis
-00021f10: 740a 2020 2020 290a 0a20 2020 2023 2063  t.    )..    # c
-00021f20: 6f6e 6361 7465 6e61 7465 2069 6e6e 6572  oncatenate inner
-00021f30: 6d6f 7374 206c 6973 7473 206f 6e20 7468  most lists on th
-00021f40: 6520 7269 6768 742c 206f 7574 6572 6d6f  e right, outermo
-00021f50: 7374 206f 6e20 7468 6520 6c65 6674 0a20  st on the left. 
-00021f60: 2020 2072 6574 7572 6e20 7265 632e 6d61     return rec.ma
-00021f70: 705f 7265 6475 6365 280a 2020 2020 2020  p_reduce(.      
-00021f80: 2020 6172 7261 7973 2c0a 2020 2020 2020    arrays,.      
-00021f90: 2020 665f 7265 6475 6365 3d6c 616d 6264    f_reduce=lambd
-00021fa0: 6120 7873 2c20 6178 6973 3a20 636f 6e63  a xs, axis: conc
-00021fb0: 6174 656e 6174 6528 0a20 2020 2020 2020  atenate(.       
-00021fc0: 2020 2020 206c 6973 7428 7873 292c 2061       list(xs), a
-00021fd0: 7869 733d 6178 6973 2c20 616c 6c6f 775f  xis=axis, allow_
-00021fe0: 756e 6b6e 6f77 6e5f 6368 756e 6b73 697a  unknown_chunksiz
-00021ff0: 6573 3d61 6c6c 6f77 5f75 6e6b 6e6f 776e  es=allow_unknown
-00022000: 5f63 6875 6e6b 7369 7a65 730a 2020 2020  _chunksizes.    
-00022010: 2020 2020 292c 0a20 2020 2020 2020 2066      ),.        f
-00022020: 5f6b 7761 7267 733d 6c61 6d62 6461 2061  _kwargs=lambda a
-00022030: 7869 733a 2064 6963 7428 6178 6973 3d28  xis: dict(axis=(
-00022040: 6178 6973 202b 2031 2929 2c0a 2020 2020  axis + 1)),.    
-00022050: 2020 2020 6178 6973 3d66 6972 7374 5f61      axis=first_a
-00022060: 7869 732c 0a20 2020 2029 0a0a 0a64 6566  xis,.    )...def
-00022070: 2063 6f6e 6361 7465 6e61 7465 2873 6571   concatenate(seq
-00022080: 2c20 6178 6973 3d30 2c20 616c 6c6f 775f  , axis=0, allow_
-00022090: 756e 6b6e 6f77 6e5f 6368 756e 6b73 697a  unknown_chunksiz
-000220a0: 6573 3d46 616c 7365 293a 0a20 2020 2022  es=False):.    "
-000220b0: 2222 0a20 2020 2043 6f6e 6361 7465 6e61  "".    Concatena
-000220c0: 7465 2061 7272 6179 7320 616c 6f6e 6720  te arrays along 
-000220d0: 616e 2065 7869 7374 696e 6720 6178 6973  an existing axis
-000220e0: 0a0a 2020 2020 4769 7665 6e20 6120 7365  ..    Given a se
-000220f0: 7175 656e 6365 206f 6620 6461 736b 2041  quence of dask A
-00022100: 7272 6179 7320 666f 726d 2061 206e 6577  rrays form a new
-00022110: 2064 6173 6b20 4172 7261 7920 6279 2073   dask Array by s
-00022120: 7461 636b 696e 6720 7468 656d 0a20 2020  tacking them.   
-00022130: 2061 6c6f 6e67 2061 6e20 6578 6973 7469   along an existi
-00022140: 6e67 2064 696d 656e 7369 6f6e 2028 6178  ng dimension (ax
-00022150: 6973 3d30 2062 7920 6465 6661 756c 7429  is=0 by default)
-00022160: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00022170: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00022180: 2020 2020 7365 713a 206c 6973 7420 6f66      seq: list of
-00022190: 2064 6173 6b2e 6172 7261 7973 0a20 2020   dask.arrays.   
-000221a0: 2061 7869 733a 2069 6e74 0a20 2020 2020   axis: int.     
-000221b0: 2020 2044 696d 656e 7369 6f6e 2061 6c6f     Dimension alo
-000221c0: 6e67 2077 6869 6368 2074 6f20 616c 6967  ng which to alig
-000221d0: 6e20 616c 6c20 6f66 2074 6865 2061 7272  n all of the arr
-000221e0: 6179 732e 2049 6620 6178 6973 2069 7320  ays. If axis is 
-000221f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6172  None,.        ar
-00022200: 7261 7973 2061 7265 2066 6c61 7474 656e  rays are flatten
-00022210: 6564 2062 6566 6f72 6520 7573 652e 0a20  ed before use.. 
-00022220: 2020 2061 6c6c 6f77 5f75 6e6b 6e6f 776e     allow_unknown
-00022230: 5f63 6875 6e6b 7369 7a65 733a 2062 6f6f  _chunksizes: boo
-00022240: 6c0a 2020 2020 2020 2020 416c 6c6f 7720  l.        Allow 
-00022250: 756e 6b6e 6f77 6e20 6368 756e 6b73 697a  unknown chunksiz
-00022260: 6573 2c20 7375 6368 2061 7320 636f 6d65  es, such as come
-00022270: 2066 726f 6d20 636f 6e76 6572 7469 6e67   from converting
-00022280: 2066 726f 6d20 6461 736b 0a20 2020 2020   from dask.     
-00022290: 2020 2064 6174 6166 7261 6d65 732e 2020     dataframes.  
-000222a0: 4461 736b 2e61 7272 6179 2069 7320 756e  Dask.array is un
-000222b0: 6162 6c65 2074 6f20 7665 7269 6679 2074  able to verify t
-000222c0: 6861 7420 6368 756e 6b73 206c 696e 6520  hat chunks line 
-000222d0: 7570 2e20 2049 660a 2020 2020 2020 2020  up.  If.        
-000222e0: 6461 7461 2063 6f6d 6573 2066 726f 6d20  data comes from 
-000222f0: 6469 6666 6572 656e 746c 7920 616c 6967  differently alig
-00022300: 6e65 6420 736f 7572 6365 7320 7468 656e  ned sources then
-00022310: 2074 6869 7320 6361 6e20 6361 7573 650a   this can cause.
-00022320: 2020 2020 2020 2020 756e 6578 7065 6374          unexpect
-00022330: 6564 2072 6573 756c 7473 2e0a 0a20 2020  ed results...   
-00022340: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
-00022350: 2d2d 2d2d 2d2d 0a0a 2020 2020 4372 6561  ------..    Crea
-00022360: 7465 2073 6c69 6365 730a 0a20 2020 203e  te slices..    >
-00022370: 3e3e 2069 6d70 6f72 7420 6461 736b 2e61  >> import dask.a
-00022380: 7272 6179 2061 7320 6461 0a20 2020 203e  rray as da.    >
-00022390: 3e3e 2069 6d70 6f72 7420 6e75 6d70 7920  >> import numpy 
-000223a0: 6173 206e 700a 0a20 2020 203e 3e3e 2064  as np..    >>> d
-000223b0: 6174 6120 3d20 5b64 612e 6672 6f6d 5f61  ata = [da.from_a
-000223c0: 7272 6179 286e 702e 6f6e 6573 2828 342c  rray(np.ones((4,
-000223d0: 2034 2929 2c20 6368 756e 6b73 3d28 322c   4)), chunks=(2,
-000223e0: 2032 2929 0a20 2020 202e 2e2e 2020 2020   2)).    ...    
-000223f0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00022400: 616e 6765 2833 295d 0a0a 2020 2020 3e3e  ange(3)]..    >>
-00022410: 3e20 7820 3d20 6461 2e63 6f6e 6361 7465  > x = da.concate
-00022420: 6e61 7465 2864 6174 612c 2061 7869 733d  nate(data, axis=
-00022430: 3029 0a20 2020 203e 3e3e 2078 2e73 6861  0).    >>> x.sha
-00022440: 7065 0a20 2020 2028 3132 2c20 3429 0a0a  pe.    (12, 4)..
-00022450: 2020 2020 3e3e 3e20 6461 2e63 6f6e 6361      >>> da.conca
-00022460: 7465 6e61 7465 2864 6174 612c 2061 7869  tenate(data, axi
-00022470: 733d 3129 2e73 6861 7065 0a20 2020 2028  s=1).shape.    (
-00022480: 342c 2031 3229 0a0a 2020 2020 5265 7375  4, 12)..    Resu
-00022490: 6c74 2069 7320 6120 6e65 7720 6461 736b  lt is a new dask
-000224a0: 2041 7272 6179 0a0a 2020 2020 5365 6520   Array..    See 
-000224b0: 416c 736f 0a20 2020 202d 2d2d 2d2d 2d2d  Also.    -------
-000224c0: 2d0a 2020 2020 7374 6163 6b0a 2020 2020  -.    stack.    
-000224d0: 2222 220a 2020 2020 6672 6f6d 2064 6173  """.    from das
-000224e0: 6b2e 6172 7261 7920 696d 706f 7274 2077  k.array import w
-000224f0: 7261 700a 0a20 2020 2073 6571 203d 205b  rap..    seq = [
-00022500: 6173 6172 7261 7928 612c 2061 6c6c 6f77  asarray(a, allow
-00022510: 5f75 6e6b 6e6f 776e 5f63 6875 6e6b 7369  _unknown_chunksi
-00022520: 7a65 733d 616c 6c6f 775f 756e 6b6e 6f77  zes=allow_unknow
-00022530: 6e5f 6368 756e 6b73 697a 6573 2920 666f  n_chunksizes) fo
-00022540: 7220 6120 696e 2073 6571 5d0a 0a20 2020  r a in seq]..   
-00022550: 2069 6620 6e6f 7420 7365 713a 0a20 2020   if not seq:.   
-00022560: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00022570: 4572 726f 7228 224e 6565 6420 6172 7261  Error("Need arra
-00022580: 7928 7329 2074 6f20 636f 6e63 6174 656e  y(s) to concaten
-00022590: 6174 6522 290a 0a20 2020 2069 6620 6178  ate")..    if ax
-000225a0: 6973 2069 7320 4e6f 6e65 3a0a 2020 2020  is is None:.    
-000225b0: 2020 2020 7365 7120 3d20 5b61 2e66 6c61      seq = [a.fla
-000225c0: 7474 656e 2829 2066 6f72 2061 2069 6e20  tten() for a in 
-000225d0: 7365 715d 0a20 2020 2020 2020 2061 7869  seq].        axi
-000225e0: 7320 3d20 300a 0a20 2020 2073 6571 5f6d  s = 0..    seq_m
-000225f0: 6574 6173 203d 205b 6d65 7461 5f66 726f  etas = [meta_fro
-00022600: 6d5f 6172 7261 7928 7329 2066 6f72 2073  m_array(s) for s
-00022610: 2069 6e20 7365 715d 0a20 2020 205f 636f   in seq].    _co
-00022620: 6e63 6174 656e 6174 6520 3d20 636f 6e63  ncatenate = conc
-00022630: 6174 656e 6174 655f 6c6f 6f6b 7570 2e64  atenate_lookup.d
-00022640: 6973 7061 7463 6828 0a20 2020 2020 2020  ispatch(.       
-00022650: 2074 7970 6528 6d61 7828 7365 715f 6d65   type(max(seq_me
-00022660: 7461 732c 206b 6579 3d6c 616d 6264 6120  tas, key=lambda 
-00022670: 783a 2067 6574 6174 7472 2878 2c20 225f  x: getattr(x, "_
-00022680: 5f61 7272 6179 5f70 7269 6f72 6974 795f  _array_priority_
-00022690: 5f22 2c20 3029 2929 0a20 2020 2029 0a20  _", 0))).    ). 
-000226a0: 2020 206d 6574 6120 3d20 5f63 6f6e 6361     meta = _conca
-000226b0: 7465 6e61 7465 2873 6571 5f6d 6574 6173  tenate(seq_metas
-000226c0: 2c20 6178 6973 3d61 7869 7329 0a0a 2020  , axis=axis)..  
-000226d0: 2020 2320 5072 6f6d 6f74 6520 7479 7065    # Promote type
-000226e0: 7320 746f 206d 6174 6368 206d 6574 610a  s to match meta.
-000226f0: 2020 2020 7365 7120 3d20 5b61 2e61 7374      seq = [a.ast
-00022700: 7970 6528 6d65 7461 2e64 7479 7065 2920  ype(meta.dtype) 
-00022710: 666f 7220 6120 696e 2073 6571 5d0a 0a20  for a in seq].. 
-00022720: 2020 2023 2046 696e 6420 6f75 7470 7574     # Find output
-00022730: 2061 7272 6179 2073 6861 7065 0a20 2020   array shape.   
-00022740: 206e 6469 6d20 3d20 6c65 6e28 7365 715b   ndim = len(seq[
-00022750: 305d 2e73 6861 7065 290a 2020 2020 7368  0].shape).    sh
-00022760: 6170 6520 3d20 7475 706c 6528 0a20 2020  ape = tuple(.   
-00022770: 2020 2020 2073 756d 2861 2e73 6861 7065       sum(a.shape
-00022780: 5b69 5d20 666f 7220 6120 696e 2073 6571  [i] for a in seq
-00022790: 2920 6966 2069 203d 3d20 6178 6973 2065  ) if i == axis e
-000227a0: 6c73 6520 7365 715b 305d 2e73 6861 7065  lse seq[0].shape
-000227b0: 5b69 5d0a 2020 2020 2020 2020 666f 7220  [i].        for 
-000227c0: 6920 696e 2072 616e 6765 286e 6469 6d29  i in range(ndim)
-000227d0: 0a20 2020 2029 0a0a 2020 2020 2320 4472  .    )..    # Dr
-000227e0: 6f70 2065 6d70 7479 2061 7272 6179 730a  op empty arrays.
-000227f0: 2020 2020 7365 7132 203d 205b 6120 666f      seq2 = [a fo
-00022800: 7220 6120 696e 2073 6571 2069 6620 612e  r a in seq if a.
-00022810: 7369 7a65 5d0a 2020 2020 6966 206e 6f74  size].    if not
-00022820: 2073 6571 323a 0a20 2020 2020 2020 2073   seq2:.        s
-00022830: 6571 3220 3d20 7365 710a 0a20 2020 2069  eq2 = seq..    i
-00022840: 6620 6178 6973 203c 2030 3a0a 2020 2020  f axis < 0:.    
-00022850: 2020 2020 6178 6973 203d 206e 6469 6d20      axis = ndim 
-00022860: 2b20 6178 6973 0a20 2020 2069 6620 6178  + axis.    if ax
-00022870: 6973 203e 3d20 6e64 696d 3a0a 2020 2020  is >= ndim:.    
-00022880: 2020 2020 6d73 6720 3d20 280a 2020 2020      msg = (.    
-00022890: 2020 2020 2020 2020 2241 7869 7320 6d75          "Axis mu
-000228a0: 7374 2062 6520 6c65 7373 2074 6861 6e20  st be less than 
-000228b0: 7468 616e 206e 756d 6265 7220 6f66 2064  than number of d
-000228c0: 696d 656e 7369 6f6e 7322 0a20 2020 2020  imensions".     
-000228d0: 2020 2020 2020 2022 5c6e 4461 7461 2068         "\nData h
-000228e0: 6173 2025 6420 6469 6d65 6e73 696f 6e73  as %d dimensions
-000228f0: 2c20 6275 7420 676f 7420 6178 6973 3d25  , but got axis=%
-00022900: 6422 0a20 2020 2020 2020 2029 0a20 2020  d".        ).   
-00022910: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00022920: 4572 726f 7228 6d73 6720 2520 286e 6469  Error(msg % (ndi
-00022930: 6d2c 2061 7869 7329 290a 0a20 2020 206e  m, axis))..    n
-00022940: 203d 206c 656e 2873 6571 3229 0a20 2020   = len(seq2).   
-00022950: 2069 6620 6e20 3d3d 2030 3a0a 2020 2020   if n == 0:.    
-00022960: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00022970: 2020 2020 2072 6574 7572 6e20 7772 6170       return wrap
-00022980: 2e65 6d70 7479 5f6c 696b 6528 6d65 7461  .empty_like(meta
-00022990: 2c20 7368 6170 653d 7368 6170 652c 2063  , shape=shape, c
-000229a0: 6875 6e6b 733d 7368 6170 652c 2064 7479  hunks=shape, dty
-000229b0: 7065 3d6d 6574 612e 6474 7970 6529 0a20  pe=meta.dtype). 
-000229c0: 2020 2020 2020 2065 7863 6570 7420 5479         except Ty
-000229d0: 7065 4572 726f 723a 0a20 2020 2020 2020  peError:.       
-000229e0: 2020 2020 2072 6574 7572 6e20 7772 6170       return wrap
-000229f0: 2e65 6d70 7479 2873 6861 7065 2c20 6368  .empty(shape, ch
-00022a00: 756e 6b73 3d73 6861 7065 2c20 6474 7970  unks=shape, dtyp
-00022a10: 653d 6d65 7461 2e64 7479 7065 290a 2020  e=meta.dtype).  
-00022a20: 2020 656c 6966 206e 203d 3d20 313a 0a20    elif n == 1:. 
-00022a30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00022a40: 7132 5b30 5d0a 0a20 2020 2069 6620 6e6f  q2[0]..    if no
-00022a50: 7420 616c 6c6f 775f 756e 6b6e 6f77 6e5f  t allow_unknown_
-00022a60: 6368 756e 6b73 697a 6573 2061 6e64 206e  chunksizes and n
-00022a70: 6f74 2061 6c6c 280a 2020 2020 2020 2020  ot all(.        
-00022a80: 6920 3d3d 2061 7869 7320 6f72 2061 6c6c  i == axis or all
-00022a90: 2878 2e73 6861 7065 5b69 5d20 3d3d 2073  (x.shape[i] == s
-00022aa0: 6571 325b 305d 2e73 6861 7065 5b69 5d20  eq2[0].shape[i] 
-00022ab0: 666f 7220 7820 696e 2073 6571 3229 0a20  for x in seq2). 
-00022ac0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00022ad0: 7261 6e67 6528 6e64 696d 290a 2020 2020  range(ndim).    
-00022ae0: 293a 0a20 2020 2020 2020 2069 6620 616e  ):.        if an
-00022af0: 7928 6d61 7028 6e70 2e69 736e 616e 2c20  y(map(np.isnan, 
-00022b00: 7365 7132 5b30 5d2e 7368 6170 6529 293a  seq2[0].shape)):
-00022b10: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00022b20: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-00022b30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00022b40: 5472 6965 6420 746f 2063 6f6e 6361 7465  Tried to concate
-00022b50: 6e61 7465 2061 7272 6179 7320 7769 7468  nate arrays with
-00022b60: 2075 6e6b 6e6f 776e 220a 2020 2020 2020   unknown".      
-00022b70: 2020 2020 2020 2020 2020 2220 7368 6170            " shap
-00022b80: 6520 2573 2e5c 6e5c 6e54 776f 2073 6f6c  e %s.\n\nTwo sol
-00022b90: 7574 696f 6e73 3a5c 6e22 0a20 2020 2020  utions:\n".     
-00022ba0: 2020 2020 2020 2020 2020 2022 2020 312e             "  1.
-00022bb0: 2046 6f72 6365 2063 6f6e 6361 7465 6e61   Force concatena
-00022bc0: 7469 6f6e 2070 6173 7322 0a20 2020 2020  tion pass".     
-00022bd0: 2020 2020 2020 2020 2020 2022 2061 6c6c             " all
-00022be0: 6f77 5f75 6e6b 6e6f 776e 5f63 6875 6e6b  ow_unknown_chunk
-00022bf0: 7369 7a65 733d 5472 7565 2e5c 6e22 0a20  sizes=True.\n". 
-00022c00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00022c10: 2020 322e 2043 6f6d 7075 7465 2073 6861    2. Compute sha
-00022c20: 7065 7320 7769 7468 2022 0a20 2020 2020  pes with ".     
-00022c30: 2020 2020 2020 2020 2020 2022 5b78 2e63             "[x.c
-00022c40: 6f6d 7075 7465 5f63 6875 6e6b 5f73 697a  ompute_chunk_siz
-00022c50: 6573 2829 2066 6f72 2078 2069 6e20 7365  es() for x in se
-00022c60: 715d 2220 2520 7374 7228 7365 7132 5b30  q]" % str(seq2[0
-00022c70: 5d2e 7368 6170 6529 0a20 2020 2020 2020  ].shape).       
-00022c80: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-00022c90: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00022ca0: 2253 6861 7065 7320 646f 206e 6f74 2061  "Shapes do not a
-00022cb0: 6c69 676e 3a20 2573 222c 205b 782e 7368  lign: %s", [x.sh
-00022cc0: 6170 6520 666f 7220 7820 696e 2073 6571  ape for x in seq
-00022cd0: 325d 290a 0a20 2020 2069 6e64 7320 3d20  2])..    inds = 
-00022ce0: 5b6c 6973 7428 7261 6e67 6528 6e64 696d  [list(range(ndim
-00022cf0: 2929 2066 6f72 2069 2069 6e20 7261 6e67  )) for i in rang
-00022d00: 6528 6e29 5d0a 2020 2020 666f 7220 692c  e(n)].    for i,
-00022d10: 2069 6e64 2069 6e20 656e 756d 6572 6174   ind in enumerat
-00022d20: 6528 696e 6473 293a 0a20 2020 2020 2020  e(inds):.       
-00022d30: 2069 6e64 5b61 7869 735d 203d 202d 2869   ind[axis] = -(i
-00022d40: 202b 2031 290a 0a20 2020 2075 635f 6172   + 1)..    uc_ar
-00022d50: 6773 203d 206c 6973 7428 636f 6e63 6174  gs = list(concat
-00022d60: 287a 6970 2873 6571 322c 2069 6e64 7329  (zip(seq2, inds)
-00022d70: 2929 0a20 2020 205f 2c20 7365 7132 203d  )).    _, seq2 =
-00022d80: 2075 6e69 6679 5f63 6875 6e6b 7328 2a75   unify_chunks(*u
-00022d90: 635f 6172 6773 2c20 7761 726e 3d46 616c  c_args, warn=Fal
-00022da0: 7365 290a 0a20 2020 2062 6473 203d 205b  se)..    bds = [
-00022db0: 612e 6368 756e 6b73 2066 6f72 2061 2069  a.chunks for a i
-00022dc0: 6e20 7365 7132 5d0a 0a20 2020 2063 6875  n seq2]..    chu
-00022dd0: 6e6b 7320 3d20 280a 2020 2020 2020 2020  nks = (.        
-00022de0: 7365 7132 5b30 5d2e 6368 756e 6b73 5b3a  seq2[0].chunks[:
-00022df0: 6178 6973 5d0a 2020 2020 2020 2020 2b20  axis].        + 
-00022e00: 2873 756d 2828 6264 5b61 7869 735d 2066  (sum((bd[axis] f
-00022e10: 6f72 2062 6420 696e 2062 6473 292c 2028  or bd in bds), (
-00022e20: 2929 2c29 0a20 2020 2020 2020 202b 2073  )),).        + s
-00022e30: 6571 325b 305d 2e63 6875 6e6b 735b 6178  eq2[0].chunks[ax
-00022e40: 6973 202b 2031 203a 5d0a 2020 2020 290a  is + 1 :].    ).
-00022e50: 0a20 2020 2063 756d 5f64 696d 7320 3d20  .    cum_dims = 
-00022e60: 5b30 5d20 2b20 6c69 7374 2861 6363 756d  [0] + list(accum
-00022e70: 756c 6174 6528 6164 642c 205b 6c65 6e28  ulate(add, [len(
-00022e80: 612e 6368 756e 6b73 5b61 7869 735d 2920  a.chunks[axis]) 
-00022e90: 666f 7220 6120 696e 2073 6571 325d 2929  for a in seq2]))
-00022ea0: 0a0a 2020 2020 6e61 6d65 7320 3d20 5b61  ..    names = [a
-00022eb0: 2e6e 616d 6520 666f 7220 6120 696e 2073  .name for a in s
-00022ec0: 6571 325d 0a0a 2020 2020 6e61 6d65 203d  eq2]..    name =
-00022ed0: 2022 636f 6e63 6174 656e 6174 652d 2220   "concatenate-" 
-00022ee0: 2b20 746f 6b65 6e69 7a65 286e 616d 6573  + tokenize(names
-00022ef0: 2c20 6178 6973 290a 2020 2020 6b65 7973  , axis).    keys
-00022f00: 203d 206c 6973 7428 7072 6f64 7563 7428   = list(product(
-00022f10: 5b6e 616d 655d 2c20 2a5b 7261 6e67 6528  [name], *[range(
-00022f20: 6c65 6e28 6264 2929 2066 6f72 2062 6420  len(bd)) for bd 
-00022f30: 696e 2063 6875 6e6b 735d 2929 0a0a 2020  in chunks]))..  
-00022f40: 2020 7661 6c75 6573 203d 205b 0a20 2020    values = [.   
-00022f50: 2020 2020 2028 6e61 6d65 735b 6269 7365       (names[bise
-00022f60: 6374 2863 756d 5f64 696d 732c 206b 6579  ct(cum_dims, key
-00022f70: 5b61 7869 7320 2b20 315d 2920 2d20 315d  [axis + 1]) - 1]
-00022f80: 2c29 0a20 2020 2020 2020 202b 206b 6579  ,).        + key
-00022f90: 5b31 203a 2061 7869 7320 2b20 315d 0a20  [1 : axis + 1]. 
-00022fa0: 2020 2020 2020 202b 2028 6b65 795b 6178         + (key[ax
-00022fb0: 6973 202b 2031 5d20 2d20 6375 6d5f 6469  is + 1] - cum_di
-00022fc0: 6d73 5b62 6973 6563 7428 6375 6d5f 6469  ms[bisect(cum_di
-00022fd0: 6d73 2c20 6b65 795b 6178 6973 202b 2031  ms, key[axis + 1
-00022fe0: 5d29 202d 2031 5d2c 290a 2020 2020 2020  ]) - 1],).      
-00022ff0: 2020 2b20 6b65 795b 6178 6973 202b 2032    + key[axis + 2
-00023000: 203a 5d0a 2020 2020 2020 2020 666f 7220   :].        for 
-00023010: 6b65 7920 696e 206b 6579 730a 2020 2020  key in keys.    
-00023020: 5d0a 0a20 2020 2064 736b 203d 2064 6963  ]..    dsk = dic
-00023030: 7428 7a69 7028 6b65 7973 2c20 7661 6c75  t(zip(keys, valu
-00023040: 6573 2929 0a20 2020 2067 7261 7068 203d  es)).    graph =
-00023050: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-00023060: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-00023070: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
-00023080: 6e64 656e 6369 6573 3d73 6571 3229 0a0a  ndencies=seq2)..
-00023090: 2020 2020 7265 7475 726e 2041 7272 6179      return Array
-000230a0: 2867 7261 7068 2c20 6e61 6d65 2c20 6368  (graph, name, ch
-000230b0: 756e 6b73 2c20 6d65 7461 3d6d 6574 6129  unks, meta=meta)
-000230c0: 0a0a 0a64 6566 206c 6f61 645f 7374 6f72  ...def load_stor
-000230d0: 655f 6368 756e 6b28 0a20 2020 2078 3a20  e_chunk(.    x: 
-000230e0: 416e 792c 0a20 2020 206f 7574 3a20 416e  Any,.    out: An
-000230f0: 792c 0a20 2020 2069 6e64 6578 3a20 736c  y,.    index: sl
-00023100: 6963 652c 0a20 2020 206c 6f63 6b3a 2041  ice,.    lock: A
-00023110: 6e79 2c0a 2020 2020 7265 7475 726e 5f73  ny,.    return_s
-00023120: 746f 7265 643a 2062 6f6f 6c2c 0a20 2020  tored: bool,.   
-00023130: 206c 6f61 645f 7374 6f72 6564 3a20 626f   load_stored: bo
-00023140: 6f6c 2c0a 293a 0a20 2020 2022 2222 0a20  ol,.):.    """. 
-00023150: 2020 2041 2066 756e 6374 696f 6e20 696e     A function in
-00023160: 7365 7274 6564 2069 6e20 6120 4461 736b  serted in a Dask
-00023170: 2067 7261 7068 2066 6f72 2073 746f 7269   graph for stori
-00023180: 6e67 2061 2063 6875 6e6b 2e0a 0a20 2020  ng a chunk...   
-00023190: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-000231a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2078  ----------.    x
-000231b0: 3a20 6172 7261 792d 6c69 6b65 0a20 2020  : array-like.   
-000231c0: 2020 2020 2041 6e20 6172 7261 7920 2870       An array (p
-000231d0: 6f74 656e 7469 616c 6c79 2061 204e 756d  otentially a Num
-000231e0: 5079 206f 6e65 290a 2020 2020 6f75 743a  Py one).    out:
-000231f0: 2061 7272 6179 2d6c 696b 650a 2020 2020   array-like.    
-00023200: 2020 2020 5768 6572 6520 746f 2073 746f      Where to sto
-00023210: 7265 2072 6573 756c 7473 2e0a 2020 2020  re results..    
-00023220: 696e 6465 783a 2073 6c69 6365 2d6c 696b  index: slice-lik
-00023230: 650a 2020 2020 2020 2020 5768 6572 6520  e.        Where 
-00023240: 746f 2073 746f 7265 2072 6573 756c 7420  to store result 
-00023250: 6672 6f6d 2060 6078 6060 2069 6e20 6060  from ``x`` in ``
-00023260: 6f75 7460 602e 0a20 2020 206c 6f63 6b3a  out``..    lock:
-00023270: 204c 6f63 6b2d 6c69 6b65 206f 7220 4661   Lock-like or Fa
-00023280: 6c73 650a 2020 2020 2020 2020 4c6f 636b  lse.        Lock
-00023290: 2074 6f20 7573 6520 6265 666f 7265 2077   to use before w
-000232a0: 7269 7469 6e67 2074 6f20 6060 6f75 7460  riting to ``out`
-000232b0: 602e 0a20 2020 2072 6574 7572 6e5f 7374  `..    return_st
-000232c0: 6f72 6564 3a20 626f 6f6c 0a20 2020 2020  ored: bool.     
-000232d0: 2020 2057 6865 7468 6572 2074 6f20 7265     Whether to re
-000232e0: 7475 726e 2060 606f 7574 6060 2e0a 2020  turn ``out``..  
-000232f0: 2020 6c6f 6164 5f73 746f 7265 643a 2062    load_stored: b
-00023300: 6f6f 6c0a 2020 2020 2020 2020 5768 6574  ool.        Whet
-00023310: 6865 7220 746f 2072 6574 7572 6e20 7468  her to return th
-00023320: 6520 6172 7261 7920 7374 6f72 6564 2069  e array stored i
-00023330: 6e20 6060 6f75 7460 602e 0a20 2020 2020  n ``out``..     
-00023340: 2020 2049 676e 6f72 6564 2069 6620 6060     Ignored if ``
-00023350: 7265 7475 726e 5f73 746f 7265 6460 6020  return_stored`` 
-00023360: 6973 206e 6f74 2060 6054 7275 6560 602e  is not ``True``.
-00023370: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
-00023380: 2020 2d2d 2d2d 2d2d 2d0a 0a20 2020 2049    -------..    I
-00023390: 6620 7265 7475 726e 5f73 746f 7265 643d  f return_stored=
-000233a0: 5472 7565 2061 6e64 206c 6f61 645f 7374  True and load_st
-000233b0: 6f72 6564 3d46 616c 7365 0a20 2020 2020  ored=False.     
-000233c0: 2020 206f 7574 0a20 2020 2049 6620 7265     out.    If re
-000233d0: 7475 726e 5f73 746f 7265 643d 5472 7565  turn_stored=True
-000233e0: 2061 6e64 206c 6f61 645f 7374 6f72 6564   and load_stored
-000233f0: 3d54 7275 650a 2020 2020 2020 2020 6f75  =True.        ou
-00023400: 745b 696e 6465 785d 0a20 2020 2049 6620  t[index].    If 
-00023410: 7265 7475 726e 5f73 746f 7265 643d 4661  return_stored=Fa
-00023420: 6c73 6520 616e 6420 636f 6d70 7574 653d  lse and compute=
-00023430: 4661 6c73 650a 2020 2020 2020 2020 4e6f  False.        No
-00023440: 6e65 0a0a 2020 2020 4578 616d 706c 6573  ne..    Examples
-00023450: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20  .    --------.. 
-00023460: 2020 203e 3e3e 2061 203d 206e 702e 6f6e     >>> a = np.on
-00023470: 6573 2828 352c 2036 2929 0a20 2020 203e  es((5, 6)).    >
-00023480: 3e3e 2062 203d 206e 702e 656d 7074 7928  >> b = np.empty(
-00023490: 612e 7368 6170 6529 0a20 2020 203e 3e3e  a.shape).    >>>
-000234a0: 206c 6f61 645f 7374 6f72 655f 6368 756e   load_store_chun
-000234b0: 6b28 612c 2062 2c20 2873 6c69 6365 284e  k(a, b, (slice(N
-000234c0: 6f6e 6529 2c20 736c 6963 6528 4e6f 6e65  one), slice(None
-000234d0: 2929 2c20 4661 6c73 652c 2046 616c 7365  )), False, False
-000234e0: 2c20 4661 6c73 6529 0a20 2020 2022 2222  , False).    """
-000234f0: 0a20 2020 2069 6620 6c6f 636b 3a0a 2020  .    if lock:.  
-00023500: 2020 2020 2020 6c6f 636b 2e61 6371 7569        lock.acqui
-00023510: 7265 2829 0a20 2020 2074 7279 3a0a 2020  re().    try:.  
-00023520: 2020 2020 2020 6966 2078 2069 7320 6e6f        if x is no
-00023530: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00023540: 2020 2020 6966 2069 735f 6172 7261 796c      if is_arrayl
-00023550: 696b 6528 7829 3a0a 2020 2020 2020 2020  ike(x):.        
-00023560: 2020 2020 2020 2020 6f75 745b 696e 6465          out[inde
-00023570: 785d 203d 2078 0a20 2020 2020 2020 2020  x] = x.         
-00023580: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00023590: 2020 2020 2020 2020 206f 7574 5b69 6e64           out[ind
-000235a0: 6578 5d20 3d20 6e70 2e61 7361 6e79 6172  ex] = np.asanyar
-000235b0: 7261 7928 7829 0a0a 2020 2020 2020 2020  ray(x)..        
-000235c0: 6966 2072 6574 7572 6e5f 7374 6f72 6564  if return_stored
-000235d0: 2061 6e64 206c 6f61 645f 7374 6f72 6564   and load_stored
-000235e0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-000235f0: 7475 726e 206f 7574 5b69 6e64 6578 5d0a  turn out[index].
-00023600: 2020 2020 2020 2020 656c 6966 2072 6574          elif ret
-00023610: 7572 6e5f 7374 6f72 6564 2061 6e64 206e  urn_stored and n
-00023620: 6f74 206c 6f61 645f 7374 6f72 6564 3a0a  ot load_stored:.
-00023630: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00023640: 726e 206f 7574 0a20 2020 2020 2020 2065  rn out.        e
-00023650: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00023660: 2072 6574 7572 6e20 4e6f 6e65 0a20 2020   return None.   
-00023670: 2066 696e 616c 6c79 3a0a 2020 2020 2020   finally:.      
-00023680: 2020 6966 206c 6f63 6b3a 0a20 2020 2020    if lock:.     
-00023690: 2020 2020 2020 206c 6f63 6b2e 7265 6c65         lock.rele
-000236a0: 6173 6528 290a 0a0a 6465 6620 7374 6f72  ase()...def stor
-000236b0: 655f 6368 756e 6b28 0a20 2020 2078 3a20  e_chunk(.    x: 
-000236c0: 4172 7261 794c 696b 652c 206f 7574 3a20  ArrayLike, out: 
-000236d0: 4172 7261 794c 696b 652c 2069 6e64 6578  ArrayLike, index
-000236e0: 3a20 736c 6963 652c 206c 6f63 6b3a 2041  : slice, lock: A
-000236f0: 6e79 2c20 7265 7475 726e 5f73 746f 7265  ny, return_store
-00023700: 643a 2062 6f6f 6c0a 293a 0a20 2020 2072  d: bool.):.    r
-00023710: 6574 7572 6e20 6c6f 6164 5f73 746f 7265  eturn load_store
-00023720: 5f63 6875 6e6b 2878 2c20 6f75 742c 2069  _chunk(x, out, i
-00023730: 6e64 6578 2c20 6c6f 636b 2c20 7265 7475  ndex, lock, retu
-00023740: 726e 5f73 746f 7265 642c 2046 616c 7365  rn_stored, False
-00023750: 290a 0a0a 4120 3d20 5479 7065 5661 7228  )...A = TypeVar(
-00023760: 2241 222c 2062 6f75 6e64 3d41 7272 6179  "A", bound=Array
-00023770: 4c69 6b65 290a 0a0a 6465 6620 6c6f 6164  Like)...def load
-00023780: 5f63 6875 6e6b 286f 7574 3a20 412c 2069  _chunk(out: A, i
-00023790: 6e64 6578 3a20 736c 6963 652c 206c 6f63  ndex: slice, loc
-000237a0: 6b3a 2041 6e79 2920 2d3e 2041 3a0a 2020  k: Any) -> A:.  
-000237b0: 2020 7265 7475 726e 206c 6f61 645f 7374    return load_st
-000237c0: 6f72 655f 6368 756e 6b28 4e6f 6e65 2c20  ore_chunk(None, 
-000237d0: 6f75 742c 2069 6e64 6578 2c20 6c6f 636b  out, index, lock
-000237e0: 2c20 5472 7565 2c20 5472 7565 290a 0a0a  , True, True)...
-000237f0: 6465 6620 696e 7365 7274 5f74 6f5f 6f6f  def insert_to_oo
-00023800: 6328 0a20 2020 206b 6579 733a 206c 6973  c(.    keys: lis
-00023810: 742c 0a20 2020 2063 6875 6e6b 733a 2074  t,.    chunks: t
-00023820: 7570 6c65 5b74 7570 6c65 5b69 6e74 2c20  uple[tuple[int, 
-00023830: 2e2e 2e5d 2c20 2e2e 2e5d 2c0a 2020 2020  ...], ...],.    
-00023840: 6f75 743a 2041 7272 6179 4c69 6b65 2c0a  out: ArrayLike,.
-00023850: 2020 2020 6e61 6d65 3a20 7374 722c 0a20      name: str,. 
-00023860: 2020 202a 2c0a 2020 2020 6c6f 636b 3a20     *,.    lock: 
-00023870: 4c6f 636b 207c 2062 6f6f 6c20 3d20 5472  Lock | bool = Tr
-00023880: 7565 2c0a 2020 2020 7265 6769 6f6e 3a20  ue,.    region: 
-00023890: 7475 706c 655b 736c 6963 652c 202e 2e2e  tuple[slice, ...
-000238a0: 5d20 7c20 736c 6963 6520 7c20 4e6f 6e65  ] | slice | None
-000238b0: 203d 204e 6f6e 652c 0a20 2020 2072 6574   = None,.    ret
-000238c0: 7572 6e5f 7374 6f72 6564 3a20 626f 6f6c  urn_stored: bool
-000238d0: 203d 2046 616c 7365 2c0a 2020 2020 6c6f   = False,.    lo
-000238e0: 6164 5f73 746f 7265 643a 2062 6f6f 6c20  ad_stored: bool 
-000238f0: 3d20 4661 6c73 652c 0a29 202d 3e20 6469  = False,.) -> di
-00023900: 6374 3a0a 2020 2020 2222 220a 2020 2020  ct:.    """.    
-00023910: 4372 6561 7465 7320 6120 4461 736b 2067  Creates a Dask g
-00023920: 7261 7068 2066 6f72 2073 746f 7269 6e67  raph for storing
-00023930: 2063 6875 6e6b 7320 6672 6f6d 2060 6061   chunks from ``a
-00023940: 7272 6060 2069 6e20 6060 6f75 7460 602e  rr`` in ``out``.
-00023950: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00023960: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00023970: 2020 2020 6b65 7973 3a20 6c69 7374 0a20      keys: list. 
-00023980: 2020 2020 2020 2044 6173 6b20 6b65 7973         Dask keys
-00023990: 206f 6620 7468 6520 696e 7075 7420 6172   of the input ar
-000239a0: 7261 790a 2020 2020 6368 756e 6b73 3a20  ray.    chunks: 
-000239b0: 7475 706c 650a 2020 2020 2020 2020 4461  tuple.        Da
-000239c0: 736b 2063 6875 6e6b 7320 6f66 2074 6865  sk chunks of the
-000239d0: 2069 6e70 7574 2061 7272 6179 0a20 2020   input array.   
-000239e0: 206f 7574 3a20 6172 7261 792d 6c69 6b65   out: array-like
-000239f0: 0a20 2020 2020 2020 2057 6865 7265 2074  .        Where t
-00023a00: 6f20 7374 6f72 6520 7265 7375 6c74 7320  o store results 
-00023a10: 746f 0a20 2020 206e 616d 653a 2073 7472  to.    name: str
-00023a20: 0a20 2020 2020 2020 2046 6972 7374 2065  .        First e
-00023a30: 6c65 6d65 6e74 206f 6620 6461 736b 206b  lement of dask k
-00023a40: 6579 730a 2020 2020 6c6f 636b 3a20 4c6f  eys.    lock: Lo
-00023a50: 636b 2d6c 696b 6520 6f72 2062 6f6f 6c2c  ck-like or bool,
-00023a60: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00023a70: 2020 5768 6574 6865 7220 746f 206c 6f63    Whether to loc
-00023a80: 6b20 6f72 2077 6974 6820 7768 6174 2028  k or with what (
-00023a90: 6465 6661 756c 7420 6973 2060 6054 7275  default is ``Tru
-00023aa0: 6560 602c 0a20 2020 2020 2020 2077 6869  e``,.        whi
-00023ab0: 6368 206d 6561 6e73 2061 203a 636c 6173  ch means a :clas
-00023ac0: 733a 6074 6872 6561 6469 6e67 2e4c 6f63  s:`threading.Loc
-00023ad0: 6b60 2069 6e73 7461 6e63 6529 2e0a 2020  k` instance)..  
-00023ae0: 2020 7265 6769 6f6e 3a20 736c 6963 652d    region: slice-
-00023af0: 6c69 6b65 2c20 6f70 7469 6f6e 616c 0a20  like, optional. 
-00023b00: 2020 2020 2020 2057 6865 7265 2069 6e20         Where in 
-00023b10: 6060 6f75 7460 6020 746f 2073 746f 7265  ``out`` to store
-00023b20: 2060 6061 7272 6060 2773 2072 6573 756c   ``arr``'s resul
-00023b30: 7473 0a20 2020 2020 2020 2028 6465 6661  ts.        (defa
-00023b40: 756c 7420 6973 2060 604e 6f6e 6560 602c  ult is ``None``,
-00023b50: 206d 6561 6e69 6e67 2061 6c6c 206f 6620   meaning all of 
-00023b60: 6060 6f75 7460 6029 2e0a 2020 2020 7265  ``out``)..    re
-00023b70: 7475 726e 5f73 746f 7265 643a 2062 6f6f  turn_stored: boo
-00023b80: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-00023b90: 2020 2020 5768 6574 6865 7220 746f 2072      Whether to r
-00023ba0: 6574 7572 6e20 6060 6f75 7460 600a 2020  eturn ``out``.  
-00023bb0: 2020 2020 2020 2864 6566 6175 6c74 2069        (default i
-00023bc0: 7320 6060 4661 6c73 6560 602c 206d 6561  s ``False``, mea
-00023bd0: 6e69 6e67 2060 604e 6f6e 6560 6020 6973  ning ``None`` is
-00023be0: 2072 6574 7572 6e65 6429 2e0a 2020 2020   returned)..    
-00023bf0: 6c6f 6164 5f73 746f 7265 643a 2062 6f6f  load_stored: boo
-00023c00: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-00023c10: 2020 2020 5768 6574 6865 7220 746f 2068      Whether to h
-00023c20: 616e 646c 696e 6720 6c6f 6164 696e 6720  andling loading 
-00023c30: 6672 6f6d 2060 606f 7574 6060 2061 7420  from ``out`` at 
-00023c40: 7468 6520 7361 6d65 2074 696d 652e 0a20  the same time.. 
-00023c50: 2020 2020 2020 2049 676e 6f72 6564 2069         Ignored i
-00023c60: 6620 6060 7265 7475 726e 5f73 746f 7265  f ``return_store
-00023c70: 6460 6020 6973 206e 6f74 2060 6054 7275  d`` is not ``Tru
-00023c80: 6560 602e 0a20 2020 2020 2020 2028 6465  e``..        (de
-00023c90: 6661 756c 7420 6973 2060 6046 616c 7365  fault is ``False
-00023ca0: 6060 2c20 6d65 616e 696e 6720 6465 6665  ``, meaning defe
-00023cb0: 7220 746f 2060 6072 6574 7572 6e5f 7374  r to ``return_st
-00023cc0: 6f72 6564 6060 292e 0a0a 2020 2020 5265  ored``)...    Re
-00023cd0: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
-00023ce0: 2d0a 2020 2020 6461 736b 2067 7261 7068  -.    dask graph
-00023cf0: 206f 6620 7374 6f72 6520 6f70 6572 6174   of store operat
-00023d00: 696f 6e0a 0a20 2020 2045 7861 6d70 6c65  ion..    Example
-00023d10: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
-00023d20: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-00023d30: 736b 2e61 7272 6179 2061 7320 6461 0a20  sk.array as da. 
-00023d40: 2020 203e 3e3e 2064 203d 2064 612e 6f6e     >>> d = da.on
-00023d50: 6573 2828 352c 2036 292c 2063 6875 6e6b  es((5, 6), chunk
-00023d60: 733d 2832 2c20 3329 290a 2020 2020 3e3e  s=(2, 3)).    >>
-00023d70: 3e20 6120 3d20 6e70 2e65 6d70 7479 2864  > a = np.empty(d
-00023d80: 2e73 6861 7065 290a 2020 2020 3e3e 3e20  .shape).    >>> 
-00023d90: 696e 7365 7274 5f74 6f5f 6f6f 6328 642e  insert_to_ooc(d.
-00023da0: 5f5f 6461 736b 5f6b 6579 735f 5f28 292c  __dask_keys__(),
-00023db0: 2064 2e63 6875 6e6b 732c 2061 2c20 2273   d.chunks, a, "s
-00023dc0: 746f 7265 2d31 3233 2229 2020 2320 646f  tore-123")  # do
-00023dd0: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
-00023de0: 2022 2222 0a0a 2020 2020 6966 206c 6f63   """..    if loc
-00023df0: 6b20 6973 2054 7275 653a 0a20 2020 2020  k is True:.     
-00023e00: 2020 206c 6f63 6b20 3d20 4c6f 636b 2829     lock = Lock()
-00023e10: 0a0a 2020 2020 736c 6963 6573 203d 2073  ..    slices = s
-00023e20: 6c69 6365 735f 6672 6f6d 5f63 6875 6e6b  lices_from_chunk
-00023e30: 7328 6368 756e 6b73 290a 2020 2020 6966  s(chunks).    if
-00023e40: 2072 6567 696f 6e3a 0a20 2020 2020 2020   region:.       
-00023e50: 2073 6c69 6365 7320 3d20 5b66 7573 655f   slices = [fuse_
-00023e60: 736c 6963 6528 7265 6769 6f6e 2c20 736c  slice(region, sl
-00023e70: 6329 2066 6f72 2073 6c63 2069 6e20 736c  c) for slc in sl
-00023e80: 6963 6573 5d0a 0a20 2020 2069 6620 7265  ices]..    if re
-00023e90: 7475 726e 5f73 746f 7265 6420 616e 6420  turn_stored and 
-00023ea0: 6c6f 6164 5f73 746f 7265 643a 0a20 2020  load_stored:.   
-00023eb0: 2020 2020 2066 756e 6320 3d20 6c6f 6164       func = load
-00023ec0: 5f73 746f 7265 5f63 6875 6e6b 0a20 2020  _store_chunk.   
-00023ed0: 2020 2020 2061 7267 7320 3d20 286c 6f61       args = (loa
-00023ee0: 645f 7374 6f72 6564 2c29 0a20 2020 2065  d_stored,).    e
-00023ef0: 6c73 653a 0a20 2020 2020 2020 2066 756e  lse:.        fun
-00023f00: 6320 3d20 7374 6f72 655f 6368 756e 6b20  c = store_chunk 
-00023f10: 2023 2074 7970 653a 2069 676e 6f72 650a   # type: ignore.
-00023f20: 2020 2020 2020 2020 6172 6773 203d 2028          args = (
-00023f30: 2920 2023 2074 7970 653a 2069 676e 6f72  )  # type: ignor
-00023f40: 650a 0a20 2020 2064 736b 203d 207b 0a20  e..    dsk = {. 
-00023f50: 2020 2020 2020 2028 6e61 6d65 2c29 202b         (name,) +
-00023f60: 2074 5b31 3a5d 3a20 2866 756e 632c 2074   t[1:]: (func, t
-00023f70: 2c20 6f75 742c 2073 6c63 2c20 6c6f 636b  , out, slc, lock
-00023f80: 2c20 7265 7475 726e 5f73 746f 7265 6429  , return_stored)
-00023f90: 202b 2061 7267 730a 2020 2020 2020 2020   + args.        
-00023fa0: 666f 7220 742c 2073 6c63 2069 6e20 7a69  for t, slc in zi
-00023fb0: 7028 636f 7265 2e66 6c61 7474 656e 286b  p(core.flatten(k
-00023fc0: 6579 7329 2c20 736c 6963 6573 290a 2020  eys), slices).  
-00023fd0: 2020 7d0a 2020 2020 7265 7475 726e 2064    }.    return d
-00023fe0: 736b 0a0a 0a64 6566 2072 6574 7269 6576  sk...def retriev
-00023ff0: 655f 6672 6f6d 5f6f 6f63 280a 2020 2020  e_from_ooc(.    
-00024000: 6b65 7973 3a20 436f 6c6c 6563 7469 6f6e  keys: Collection
-00024010: 5b48 6173 6861 626c 655d 2c20 6473 6b5f  [Hashable], dsk_
-00024020: 7072 653a 204d 6170 7069 6e67 2c20 6473  pre: Mapping, ds
-00024030: 6b5f 706f 7374 3a20 4d61 7070 696e 670a  k_post: Mapping.
-00024040: 2920 2d3e 2064 6963 745b 7475 706c 652c  ) -> dict[tuple,
-00024050: 2041 6e79 5d3a 0a20 2020 2022 2222 0a20   Any]:.    """. 
-00024060: 2020 2043 7265 6174 6573 2061 2044 6173     Creates a Das
-00024070: 6b20 6772 6170 6820 666f 7220 6c6f 6164  k graph for load
-00024080: 696e 6720 7374 6f72 6564 2060 606b 6579  ing stored ``key
-00024090: 7360 6020 6672 6f6d 2060 6064 736b 6060  s`` from ``dsk``
-000240a0: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-000240b0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-000240c0: 0a20 2020 206b 6579 733a 2043 6f6c 6c65  .    keys: Colle
-000240d0: 6374 696f 6e0a 2020 2020 2020 2020 4120  ction.        A 
-000240e0: 7365 7175 656e 6365 2063 6f6e 7461 696e  sequence contain
-000240f0: 696e 6720 4461 736b 2067 7261 7068 206b  ing Dask graph k
-00024100: 6579 7320 746f 206c 6f61 640a 2020 2020  eys to load.    
-00024110: 6473 6b5f 7072 653a 204d 6170 7069 6e67  dsk_pre: Mapping
-00024120: 0a20 2020 2020 2020 2041 2044 6173 6b20  .        A Dask 
-00024130: 6772 6170 6820 636f 7272 6573 706f 6e64  graph correspond
-00024140: 696e 6720 746f 2061 2044 6173 6b20 4172  ing to a Dask Ar
-00024150: 7261 7920 6265 666f 7265 2063 6f6d 7075  ray before compu
-00024160: 7461 7469 6f6e 0a20 2020 2064 736b 5f70  tation.    dsk_p
-00024170: 6f73 743a 204d 6170 7069 6e67 0a20 2020  ost: Mapping.   
-00024180: 2020 2020 2041 2044 6173 6b20 6772 6170       A Dask grap
-00024190: 6820 636f 7272 6573 706f 6e64 696e 6720  h corresponding 
-000241a0: 746f 2061 2044 6173 6b20 4172 7261 7920  to a Dask Array 
-000241b0: 6166 7465 7220 636f 6d70 7574 6174 696f  after computatio
-000241c0: 6e0a 0a20 2020 2045 7861 6d70 6c65 730a  n..    Examples.
-000241d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-000241e0: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
-000241f0: 2e61 7272 6179 2061 7320 6461 0a20 2020  .array as da.   
-00024200: 203e 3e3e 2064 203d 2064 612e 6f6e 6573   >>> d = da.ones
-00024210: 2828 352c 2036 292c 2063 6875 6e6b 733d  ((5, 6), chunks=
-00024220: 2832 2c20 3329 290a 2020 2020 3e3e 3e20  (2, 3)).    >>> 
-00024230: 6120 3d20 6e70 2e65 6d70 7479 2864 2e73  a = np.empty(d.s
-00024240: 6861 7065 290a 2020 2020 3e3e 3e20 6720  hape).    >>> g 
-00024250: 3d20 696e 7365 7274 5f74 6f5f 6f6f 6328  = insert_to_ooc(
-00024260: 642e 5f5f 6461 736b 5f6b 6579 735f 5f28  d.__dask_keys__(
-00024270: 292c 2064 2e63 6875 6e6b 732c 2061 2c20  ), d.chunks, a, 
-00024280: 2273 746f 7265 2d31 3233 2229 0a20 2020  "store-123").   
-00024290: 203e 3e3e 2072 6574 7269 6576 655f 6672   >>> retrieve_fr
-000242a0: 6f6d 5f6f 6f63 2867 2e6b 6579 7328 292c  om_ooc(g.keys(),
-000242b0: 2067 2c20 7b6b 3a20 6b20 666f 7220 6b20   g, {k: k for k 
-000242c0: 696e 2067 2e6b 6579 7328 297d 2920 2023  in g.keys()})  #
-000242d0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-000242e0: 2020 2020 2222 220a 2020 2020 6c6f 6164      """.    load
-000242f0: 5f64 736b 203d 207b 0a20 2020 2020 2020  _dsk = {.       
-00024300: 2028 226c 6f61 642d 2220 2b20 6b5b 305d   ("load-" + k[0]
-00024310: 2c29 202b 206b 5b31 3a5d 3a20 286c 6f61  ,) + k[1:]: (loa
-00024320: 645f 6368 756e 6b2c 2064 736b 5f70 6f73  d_chunk, dsk_pos
-00024330: 745b 6b5d 2920 2b20 6473 6b5f 7072 655b  t[k]) + dsk_pre[
-00024340: 6b5d 5b33 3a2d 315d 2020 2320 7479 7065  k][3:-1]  # type
-00024350: 3a20 6967 6e6f 7265 0a20 2020 2020 2020  : ignore.       
-00024360: 2066 6f72 206b 2069 6e20 6b65 7973 0a20   for k in keys. 
-00024370: 2020 207d 0a0a 2020 2020 7265 7475 726e     }..    return
-00024380: 206c 6f61 645f 6473 6b0a 0a0a 6465 6620   load_dsk...def 
-00024390: 6173 6172 7261 7928 0a20 2020 2061 2c20  asarray(.    a, 
-000243a0: 616c 6c6f 775f 756e 6b6e 6f77 6e5f 6368  allow_unknown_ch
-000243b0: 756e 6b73 697a 6573 3d46 616c 7365 2c20  unksizes=False, 
-000243c0: 6474 7970 653d 4e6f 6e65 2c20 6f72 6465  dtype=None, orde
-000243d0: 723d 4e6f 6e65 2c20 2a2c 206c 696b 653d  r=None, *, like=
-000243e0: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 0a29  None, **kwargs.)
-000243f0: 3a0a 2020 2020 2222 2243 6f6e 7665 7274  :.    """Convert
-00024400: 2074 6865 2069 6e70 7574 2074 6f20 6120   the input to a 
-00024410: 6461 736b 2061 7272 6179 2e0a 0a20 2020  dask array...   
-00024420: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00024430: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2061  ----------.    a
-00024440: 203a 2061 7272 6179 2d6c 696b 650a 2020   : array-like.  
-00024450: 2020 2020 2020 496e 7075 7420 6461 7461        Input data
-00024460: 2c20 696e 2061 6e79 2066 6f72 6d20 7468  , in any form th
-00024470: 6174 2063 616e 2062 6520 636f 6e76 6572  at can be conver
-00024480: 7465 6420 746f 2061 2064 6173 6b20 6172  ted to a dask ar
-00024490: 7261 792e 2054 6869 730a 2020 2020 2020  ray. This.      
-000244a0: 2020 696e 636c 7564 6573 206c 6973 7473    includes lists
-000244b0: 2c20 6c69 7374 7320 6f66 2074 7570 6c65  , lists of tuple
-000244c0: 732c 2074 7570 6c65 732c 2074 7570 6c65  s, tuples, tuple
-000244d0: 7320 6f66 2074 7570 6c65 732c 2074 7570  s of tuples, tup
-000244e0: 6c65 7320 6f66 0a20 2020 2020 2020 206c  les of.        l
-000244f0: 6973 7473 2061 6e64 206e 6461 7272 6179  ists and ndarray
-00024500: 732e 0a20 2020 2061 6c6c 6f77 5f75 6e6b  s..    allow_unk
-00024510: 6e6f 776e 5f63 6875 6e6b 7369 7a65 733a  nown_chunksizes:
-00024520: 2062 6f6f 6c0a 2020 2020 2020 2020 416c   bool.        Al
-00024530: 6c6f 7720 756e 6b6e 6f77 6e20 6368 756e  low unknown chun
-00024540: 6b73 697a 6573 2c20 7375 6368 2061 7320  ksizes, such as 
-00024550: 636f 6d65 2066 726f 6d20 636f 6e76 6572  come from conver
-00024560: 7469 6e67 2066 726f 6d20 6461 736b 0a20  ting from dask. 
-00024570: 2020 2020 2020 2064 6174 6166 7261 6d65         dataframe
-00024580: 732e 2020 4461 736b 2e61 7272 6179 2069  s.  Dask.array i
-00024590: 7320 756e 6162 6c65 2074 6f20 7665 7269  s unable to veri
-000245a0: 6679 2074 6861 7420 6368 756e 6b73 206c  fy that chunks l
-000245b0: 696e 6520 7570 2e20 2049 660a 2020 2020  ine up.  If.    
-000245c0: 2020 2020 6461 7461 2063 6f6d 6573 2066      data comes f
-000245d0: 726f 6d20 6469 6666 6572 656e 746c 7920  rom differently 
-000245e0: 616c 6967 6e65 6420 736f 7572 6365 7320  aligned sources 
-000245f0: 7468 656e 2074 6869 7320 6361 6e20 6361  then this can ca
-00024600: 7573 650a 2020 2020 2020 2020 756e 6578  use.        unex
-00024610: 7065 6374 6564 2072 6573 756c 7473 2e0a  pected results..
-00024620: 2020 2020 6474 7970 6520 3a20 6461 7461      dtype : data
-00024630: 2d74 7970 652c 206f 7074 696f 6e61 6c0a  -type, optional.
-00024640: 2020 2020 2020 2020 4279 2064 6566 6175          By defau
-00024650: 6c74 2c20 7468 6520 6461 7461 2d74 7970  lt, the data-typ
-00024660: 6520 6973 2069 6e66 6572 7265 6420 6672  e is inferred fr
-00024670: 6f6d 2074 6865 2069 6e70 7574 2064 6174  om the input dat
-00024680: 612e 0a20 2020 206f 7264 6572 203a 207b  a..    order : {
-00024690: e280 9843 e280 992c 20e2 8098 46e2 8099  ...C..., ...F...
-000246a0: 2c20 e280 9841 e280 992c 20e2 8098 4be2  , ...A..., ...K.
-000246b0: 8099 7d2c 206f 7074 696f 6e61 6c0a 2020  ..}, optional.  
-000246c0: 2020 2020 2020 4d65 6d6f 7279 206c 6179        Memory lay
-000246d0: 6f75 742e 20e2 8098 41e2 8099 2061 6e64  out. ...A... and
-000246e0: 20e2 8098 4be2 8099 2064 6570 656e 6420   ...K... depend 
-000246f0: 6f6e 2074 6865 206f 7264 6572 206f 6620  on the order of 
-00024700: 696e 7075 7420 6172 7261 7920 612e 0a20  input array a.. 
-00024710: 2020 2020 2020 20e2 8098 43e2 8099 2072         ...C... r
-00024720: 6f77 2d6d 616a 6f72 2028 432d 7374 796c  ow-major (C-styl
-00024730: 6529 2c20 e280 9846 e280 9920 636f 6c75  e), ...F... colu
-00024740: 6d6e 2d6d 616a 6f72 2028 466f 7274 7261  mn-major (Fortra
-00024750: 6e2d 7374 796c 6529 206d 656d 6f72 790a  n-style) memory.
-00024760: 2020 2020 2020 2020 7265 7072 6573 656e          represen
-00024770: 7461 7469 6f6e 2e20 e280 9841 e280 9920  tation. ...A... 
-00024780: 2861 6e79 2920 6d65 616e 7320 e280 9846  (any) means ...F
-00024790: e280 9920 6966 2061 2069 7320 466f 7274  ... if a is Fort
-000247a0: 7261 6e20 636f 6e74 6967 756f 7573 2c20  ran contiguous, 
-000247b0: e280 9843 e280 990a 2020 2020 2020 2020  ...C....        
-000247c0: 6f74 6865 7277 6973 6520 e280 984b e280  otherwise ...K..
-000247d0: 9920 286b 6565 7029 2070 7265 7365 7276  . (keep) preserv
-000247e0: 6520 696e 7075 7420 6f72 6465 722e 2044  e input order. D
-000247f0: 6566 6175 6c74 7320 746f 20e2 8098 43e2  efaults to ...C.
-00024800: 8099 2e0a 2020 2020 6c69 6b65 3a20 6172  ....    like: ar
-00024810: 7261 792d 6c69 6b65 0a20 2020 2020 2020  ray-like.       
-00024820: 2052 6566 6572 656e 6365 206f 626a 6563   Reference objec
-00024830: 7420 746f 2061 6c6c 6f77 2074 6865 2063  t to allow the c
-00024840: 7265 6174 696f 6e20 6f66 2044 6173 6b20  reation of Dask 
-00024850: 6172 7261 7973 2077 6974 6820 6368 756e  arrays with chun
-00024860: 6b73 0a20 2020 2020 2020 2074 6861 7420  ks.        that 
-00024870: 6172 6520 6e6f 7420 4e75 6d50 7920 6172  are not NumPy ar
-00024880: 7261 7973 2e20 4966 2061 6e20 6172 7261  rays. If an arra
-00024890: 792d 6c69 6b65 2070 6173 7365 6420 696e  y-like passed in
-000248a0: 2061 7320 6060 6c69 6b65 6060 0a20 2020   as ``like``.   
-000248b0: 2020 2020 2073 7570 706f 7274 7320 7468       supports th
-000248c0: 6520 6060 5f5f 6172 7261 795f 6675 6e63  e ``__array_func
-000248d0: 7469 6f6e 5f5f 6060 2070 726f 746f 636f  tion__`` protoco
-000248e0: 6c2c 2074 6865 2063 6875 6e6b 2074 7970  l, the chunk typ
-000248f0: 6520 6f66 2074 6865 0a20 2020 2020 2020  e of the.       
-00024900: 2072 6573 756c 7469 6e67 2061 7272 6179   resulting array
-00024910: 2077 696c 6c20 6265 2064 6566 696e 6465   will be definde
-00024920: 2062 7920 6974 2e20 496e 2074 6869 7320   by it. In this 
-00024930: 6361 7365 2c20 6974 2065 6e73 7572 6573  case, it ensures
-00024940: 2074 6865 0a20 2020 2020 2020 2063 7265   the.        cre
-00024950: 6174 696f 6e20 6f66 2061 2044 6173 6b20  ation of a Dask 
-00024960: 6172 7261 7920 636f 6d70 6174 6962 6c65  array compatible
-00024970: 2077 6974 6820 7468 6174 2070 6173 7365   with that passe
-00024980: 6420 696e 2076 6961 2074 6869 730a 2020  d in via this.  
-00024990: 2020 2020 2020 6172 6775 6d65 6e74 2e20        argument. 
-000249a0: 4966 2060 606c 696b 6560 6020 6973 2061  If ``like`` is a
-000249b0: 2044 6173 6b20 6172 7261 792c 2074 6865   Dask array, the
-000249c0: 2063 6875 6e6b 2074 7970 6520 6f66 2074   chunk type of t
-000249d0: 6865 0a20 2020 2020 2020 2072 6573 756c  he.        resul
-000249e0: 7469 6e67 2061 7272 6179 2077 696c 6c20  ting array will 
-000249f0: 6265 2064 6566 696e 6564 2062 7920 7468  be defined by th
-00024a00: 6520 6368 756e 6b20 7479 7065 206f 6620  e chunk type of 
-00024a10: 6060 6c69 6b65 6060 2e0a 2020 2020 2020  ``like``..      
-00024a20: 2020 5265 7175 6972 6573 204e 756d 5079    Requires NumPy
-00024a30: 2031 2e32 302e 3020 6f72 2068 6967 6865   1.20.0 or highe
-00024a40: 722e 0a0a 2020 2020 5265 7475 726e 730a  r...    Returns.
-00024a50: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00024a60: 6f75 7420 3a20 6461 736b 2061 7272 6179  out : dask array
-00024a70: 0a20 2020 2020 2020 2044 6173 6b20 6172  .        Dask ar
-00024a80: 7261 7920 696e 7465 7270 7265 7461 7469  ray interpretati
-00024a90: 6f6e 206f 6620 612e 0a0a 2020 2020 4578  on of a...    Ex
-00024aa0: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
-00024ab0: 2d2d 2d0a 2020 2020 3e3e 3e20 696d 706f  ---.    >>> impo
-00024ac0: 7274 2064 6173 6b2e 6172 7261 7920 6173  rt dask.array as
-00024ad0: 2064 610a 2020 2020 3e3e 3e20 696d 706f   da.    >>> impo
-00024ae0: 7274 206e 756d 7079 2061 7320 6e70 0a20  rt numpy as np. 
-00024af0: 2020 203e 3e3e 2078 203d 206e 702e 6172     >>> x = np.ar
-00024b00: 616e 6765 2833 290a 2020 2020 3e3e 3e20  ange(3).    >>> 
-00024b10: 6461 2e61 7361 7272 6179 2878 290a 2020  da.asarray(x).  
-00024b20: 2020 6461 736b 2e61 7272 6179 3c61 7272    dask.array<arr
-00024b30: 6179 2c20 7368 6170 653d 2833 2c29 2c20  ay, shape=(3,), 
-00024b40: 6474 7970 653d 696e 7436 342c 2063 6875  dtype=int64, chu
-00024b50: 6e6b 7369 7a65 3d28 332c 292c 2063 6875  nksize=(3,), chu
-00024b60: 6e6b 7479 7065 3d6e 756d 7079 2e6e 6461  nktype=numpy.nda
-00024b70: 7272 6179 3e0a 0a20 2020 203e 3e3e 2079  rray>..    >>> y
-00024b80: 203d 205b 5b31 2c20 322c 2033 5d2c 205b   = [[1, 2, 3], [
-00024b90: 342c 2035 2c20 365d 5d0a 2020 2020 3e3e  4, 5, 6]].    >>
-00024ba0: 3e20 6461 2e61 7361 7272 6179 2879 290a  > da.asarray(y).
-00024bb0: 2020 2020 6461 736b 2e61 7272 6179 3c61      dask.array<a
-00024bc0: 7272 6179 2c20 7368 6170 653d 2832 2c20  rray, shape=(2, 
-00024bd0: 3329 2c20 6474 7970 653d 696e 7436 342c  3), dtype=int64,
-00024be0: 2063 6875 6e6b 7369 7a65 3d28 322c 2033   chunksize=(2, 3
-00024bf0: 292c 2063 6875 6e6b 7479 7065 3d6e 756d  ), chunktype=num
-00024c00: 7079 2e6e 6461 7272 6179 3e0a 2020 2020  py.ndarray>.    
-00024c10: 2222 220a 2020 2020 6966 206c 696b 6520  """.    if like 
-00024c20: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00024c30: 2069 6620 6973 696e 7374 616e 6365 2861   if isinstance(a
-00024c40: 2c20 4172 7261 7929 3a0a 2020 2020 2020  , Array):.      
-00024c50: 2020 2020 2020 7265 7475 726e 2061 0a20        return a. 
-00024c60: 2020 2020 2020 2065 6c69 6620 6861 7361         elif hasa
-00024c70: 7474 7228 612c 2022 746f 5f64 6173 6b5f  ttr(a, "to_dask_
-00024c80: 6172 7261 7922 293a 0a20 2020 2020 2020  array"):.       
-00024c90: 2020 2020 2072 6574 7572 6e20 612e 746f       return a.to
-00024ca0: 5f64 6173 6b5f 6172 7261 7928 290a 2020  _dask_array().  
-00024cb0: 2020 2020 2020 656c 6966 2074 7970 6528        elif type(
-00024cc0: 6129 2e5f 5f6d 6f64 756c 655f 5f2e 7370  a).__module__.sp
-00024cd0: 6c69 7428 222e 2229 5b30 5d20 3d3d 2022  lit(".")[0] == "
-00024ce0: 7861 7272 6179 2220 616e 6420 6861 7361  xarray" and hasa
-00024cf0: 7474 7228 612c 2022 6461 7461 2229 3a0a  ttr(a, "data"):.
-00024d00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00024d10: 726e 2061 7361 7272 6179 2861 2e64 6174  rn asarray(a.dat
-00024d20: 6129 0a20 2020 2020 2020 2065 6c69 6620  a).        elif 
-00024d30: 6973 696e 7374 616e 6365 2861 2c20 286c  isinstance(a, (l
-00024d40: 6973 742c 2074 7570 6c65 2929 2061 6e64  ist, tuple)) and
-00024d50: 2061 6e79 2869 7369 6e73 7461 6e63 6528   any(isinstance(
-00024d60: 692c 2041 7272 6179 2920 666f 7220 6920  i, Array) for i 
-00024d70: 696e 2061 293a 0a20 2020 2020 2020 2020  in a):.         
-00024d80: 2020 2072 6574 7572 6e20 7374 6163 6b28     return stack(
-00024d90: 612c 2061 6c6c 6f77 5f75 6e6b 6e6f 776e  a, allow_unknown
-00024da0: 5f63 6875 6e6b 7369 7a65 733d 616c 6c6f  _chunksizes=allo
-00024db0: 775f 756e 6b6e 6f77 6e5f 6368 756e 6b73  w_unknown_chunks
-00024dc0: 697a 6573 290a 2020 2020 2020 2020 656c  izes).        el
-00024dd0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00024de0: 6528 6765 7461 7474 7228 612c 2022 7368  e(getattr(a, "sh
-00024df0: 6170 6522 2c20 4e6f 6e65 292c 2049 7465  ape", None), Ite
-00024e00: 7261 626c 6529 3a0a 2020 2020 2020 2020  rable):.        
-00024e10: 2020 2020 6120 3d20 6e70 2e61 7361 7272      a = np.asarr
-00024e20: 6179 2861 2c20 6474 7970 653d 6474 7970  ay(a, dtype=dtyp
-00024e30: 652c 206f 7264 6572 3d6f 7264 6572 290a  e, order=order).
-00024e40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00024e50: 2020 6c69 6b65 5f6d 6574 6120 3d20 6d65    like_meta = me
-00024e60: 7461 5f66 726f 6d5f 6172 7261 7928 6c69  ta_from_array(li
-00024e70: 6b65 290a 2020 2020 2020 2020 6966 2069  ke).        if i
-00024e80: 7369 6e73 7461 6e63 6528 612c 2041 7272  sinstance(a, Arr
-00024e90: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
-00024ea0: 2072 6574 7572 6e20 612e 6d61 705f 626c   return a.map_bl
-00024eb0: 6f63 6b73 286e 702e 6173 6172 7261 792c  ocks(np.asarray,
-00024ec0: 206c 696b 653d 6c69 6b65 5f6d 6574 612c   like=like_meta,
-00024ed0: 2064 7479 7065 3d64 7479 7065 2c20 6f72   dtype=dtype, or
-00024ee0: 6465 723d 6f72 6465 7229 0a20 2020 2020  der=order).     
-00024ef0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00024f00: 2020 2020 2061 203d 206e 702e 6173 6172       a = np.asar
-00024f10: 7261 7928 612c 206c 696b 653d 6c69 6b65  ray(a, like=like
-00024f20: 5f6d 6574 612c 2064 7479 7065 3d64 7479  _meta, dtype=dty
-00024f30: 7065 2c20 6f72 6465 723d 6f72 6465 7229  pe, order=order)
-00024f40: 0a20 2020 2072 6574 7572 6e20 6672 6f6d  .    return from
-00024f50: 5f61 7272 6179 2861 2c20 6765 7469 7465  _array(a, getite
-00024f60: 6d3d 6765 7474 6572 5f69 6e6c 696e 652c  m=getter_inline,
-00024f70: 202a 2a6b 7761 7267 7329 0a0a 0a64 6566   **kwargs)...def
-00024f80: 2061 7361 6e79 6172 7261 7928 612c 2064   asanyarray(a, d
-00024f90: 7479 7065 3d4e 6f6e 652c 206f 7264 6572  type=None, order
-00024fa0: 3d4e 6f6e 652c 202a 2c20 6c69 6b65 3d4e  =None, *, like=N
-00024fb0: 6f6e 652c 2069 6e6c 696e 655f 6172 7261  one, inline_arra
-00024fc0: 793d 4661 6c73 6529 3a0a 2020 2020 2222  y=False):.    ""
-00024fd0: 2243 6f6e 7665 7274 2074 6865 2069 6e70  "Convert the inp
-00024fe0: 7574 2074 6f20 6120 6461 736b 2061 7272  ut to a dask arr
-00024ff0: 6179 2e0a 0a20 2020 2053 7562 636c 6173  ay...    Subclas
-00025000: 7365 7320 6f66 2060 606e 702e 6e64 6172  ses of ``np.ndar
-00025010: 7261 7960 6020 7769 6c6c 2062 6520 7061  ray`` will be pa
-00025020: 7373 6564 2074 6872 6f75 6768 2061 7320  ssed through as 
-00025030: 6368 756e 6b73 2075 6e63 6861 6e67 6564  chunks unchanged
-00025040: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-00025050: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00025060: 0a20 2020 2061 203a 2061 7272 6179 2d6c  .    a : array-l
-00025070: 696b 650a 2020 2020 2020 2020 496e 7075  ike.        Inpu
-00025080: 7420 6461 7461 2c20 696e 2061 6e79 2066  t data, in any f
-00025090: 6f72 6d20 7468 6174 2063 616e 2062 6520  orm that can be 
-000250a0: 636f 6e76 6572 7465 6420 746f 2061 2064  converted to a d
-000250b0: 6173 6b20 6172 7261 792e 2054 6869 730a  ask array. This.
-000250c0: 2020 2020 2020 2020 696e 636c 7564 6573          includes
-000250d0: 206c 6973 7473 2c20 6c69 7374 7320 6f66   lists, lists of
-000250e0: 2074 7570 6c65 732c 2074 7570 6c65 732c   tuples, tuples,
-000250f0: 2074 7570 6c65 7320 6f66 2074 7570 6c65   tuples of tuple
-00025100: 732c 2074 7570 6c65 7320 6f66 0a20 2020  s, tuples of.   
-00025110: 2020 2020 206c 6973 7473 2061 6e64 206e       lists and n
-00025120: 6461 7272 6179 732e 0a20 2020 2064 7479  darrays..    dty
-00025130: 7065 203a 2064 6174 612d 7479 7065 2c20  pe : data-type, 
-00025140: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00025150: 2042 7920 6465 6661 756c 742c 2074 6865   By default, the
-00025160: 2064 6174 612d 7479 7065 2069 7320 696e   data-type is in
-00025170: 6665 7272 6564 2066 726f 6d20 7468 6520  ferred from the 
-00025180: 696e 7075 7420 6461 7461 2e0a 2020 2020  input data..    
-00025190: 6f72 6465 7220 3a20 7be2 8098 43e2 8099  order : {...C...
-000251a0: 2c20 e280 9846 e280 992c 20e2 8098 41e2  , ...F..., ...A.
-000251b0: 8099 2c20 e280 984b e280 997d 2c20 6f70  .., ...K...}, op
-000251c0: 7469 6f6e 616c 0a20 2020 2020 2020 204d  tional.        M
-000251d0: 656d 6f72 7920 6c61 796f 7574 2e20 e280  emory layout. ..
-000251e0: 9841 e280 9920 616e 6420 e280 984b e280  .A... and ...K..
-000251f0: 9920 6465 7065 6e64 206f 6e20 7468 6520  . depend on the 
-00025200: 6f72 6465 7220 6f66 2069 6e70 7574 2061  order of input a
-00025210: 7272 6179 2061 2e0a 2020 2020 2020 2020  rray a..        
-00025220: e280 9843 e280 9920 726f 772d 6d61 6a6f  ...C... row-majo
-00025230: 7220 2843 2d73 7479 6c65 292c 20e2 8098  r (C-style), ...
-00025240: 46e2 8099 2063 6f6c 756d 6e2d 6d61 6a6f  F... column-majo
-00025250: 7220 2846 6f72 7472 616e 2d73 7479 6c65  r (Fortran-style
-00025260: 2920 6d65 6d6f 7279 0a20 2020 2020 2020  ) memory.       
-00025270: 2072 6570 7265 7365 6e74 6174 696f 6e2e   representation.
-00025280: 20e2 8098 41e2 8099 2028 616e 7929 206d   ...A... (any) m
-00025290: 6561 6e73 20e2 8098 46e2 8099 2069 6620  eans ...F... if 
-000252a0: 6120 6973 2046 6f72 7472 616e 2063 6f6e  a is Fortran con
-000252b0: 7469 6775 6f75 732c 20e2 8098 43e2 8099  tiguous, ...C...
-000252c0: 0a20 2020 2020 2020 206f 7468 6572 7769  .        otherwi
-000252d0: 7365 20e2 8098 4be2 8099 2028 6b65 6570  se ...K... (keep
-000252e0: 2920 7072 6573 6572 7665 2069 6e70 7574  ) preserve input
-000252f0: 206f 7264 6572 2e20 4465 6661 756c 7473   order. Defaults
-00025300: 2074 6f20 e280 9843 e280 992e 0a20 2020   to ...C.....   
-00025310: 206c 696b 653a 2061 7272 6179 2d6c 696b   like: array-lik
-00025320: 650a 2020 2020 2020 2020 5265 6665 7265  e.        Refere
-00025330: 6e63 6520 6f62 6a65 6374 2074 6f20 616c  nce object to al
-00025340: 6c6f 7720 7468 6520 6372 6561 7469 6f6e  low the creation
-00025350: 206f 6620 4461 736b 2061 7272 6179 7320   of Dask arrays 
-00025360: 7769 7468 2063 6875 6e6b 730a 2020 2020  with chunks.    
-00025370: 2020 2020 7468 6174 2061 7265 206e 6f74      that are not
-00025380: 204e 756d 5079 2061 7272 6179 732e 2049   NumPy arrays. I
-00025390: 6620 616e 2061 7272 6179 2d6c 696b 6520  f an array-like 
-000253a0: 7061 7373 6564 2069 6e20 6173 2060 606c  passed in as ``l
-000253b0: 696b 6560 600a 2020 2020 2020 2020 7375  ike``.        su
-000253c0: 7070 6f72 7473 2074 6865 2060 605f 5f61  pports the ``__a
-000253d0: 7272 6179 5f66 756e 6374 696f 6e5f 5f60  rray_function__`
-000253e0: 6020 7072 6f74 6f63 6f6c 2c20 7468 6520  ` protocol, the 
-000253f0: 6368 756e 6b20 7479 7065 206f 6620 7468  chunk type of th
-00025400: 650a 2020 2020 2020 2020 7265 7375 6c74  e.        result
-00025410: 696e 6720 6172 7261 7920 7769 6c6c 2062  ing array will b
-00025420: 6520 6465 6669 6e64 6520 6279 2069 742e  e definde by it.
-00025430: 2049 6e20 7468 6973 2063 6173 652c 2069   In this case, i
-00025440: 7420 656e 7375 7265 7320 7468 650a 2020  t ensures the.  
-00025450: 2020 2020 2020 6372 6561 7469 6f6e 206f        creation o
-00025460: 6620 6120 4461 736b 2061 7272 6179 2063  f a Dask array c
-00025470: 6f6d 7061 7469 626c 6520 7769 7468 2074  ompatible with t
-00025480: 6861 7420 7061 7373 6564 2069 6e20 7669  hat passed in vi
-00025490: 6120 7468 6973 0a20 2020 2020 2020 2061  a this.        a
-000254a0: 7267 756d 656e 742e 2049 6620 6060 6c69  rgument. If ``li
-000254b0: 6b65 6060 2069 7320 6120 4461 736b 2061  ke`` is a Dask a
-000254c0: 7272 6179 2c20 7468 6520 6368 756e 6b20  rray, the chunk 
-000254d0: 7479 7065 206f 6620 7468 650a 2020 2020  type of the.    
-000254e0: 2020 2020 7265 7375 6c74 696e 6720 6172      resulting ar
-000254f0: 7261 7920 7769 6c6c 2062 6520 6465 6669  ray will be defi
-00025500: 6e65 6420 6279 2074 6865 2063 6875 6e6b  ned by the chunk
-00025510: 2074 7970 6520 6f66 2060 606c 696b 6560   type of ``like`
-00025520: 602e 0a20 2020 2020 2020 2052 6571 7569  `..        Requi
-00025530: 7265 7320 4e75 6d50 7920 312e 3230 2e30  res NumPy 1.20.0
-00025540: 206f 7220 6869 6768 6572 2e0a 2020 2020   or higher..    
-00025550: 696e 6c69 6e65 5f61 7272 6179 3a0a 2020  inline_array:.  
-00025560: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
-00025570: 2069 6e6c 696e 6520 7468 6520 6172 7261   inline the arra
-00025580: 7920 696e 2074 6865 2072 6573 756c 7469  y in the resulti
-00025590: 6e67 2064 6173 6b20 6772 6170 682e 2046  ng dask graph. F
-000255a0: 6f72 206d 6f72 6520 696e 666f 726d 6174  or more informat
-000255b0: 696f 6e2c 0a20 2020 2020 2020 2073 6565  ion,.        see
-000255c0: 2074 6865 2064 6f63 756d 656e 7461 7469   the documentati
-000255d0: 6f6e 2066 6f72 2060 6064 6173 6b2e 6172  on for ``dask.ar
-000255e0: 7261 792e 6672 6f6d 5f61 7272 6179 2829  ray.from_array()
-000255f0: 6060 2e0a 0a20 2020 2052 6574 7572 6e73  ``...    Returns
-00025600: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-00025610: 206f 7574 203a 2064 6173 6b20 6172 7261   out : dask arra
-00025620: 790a 2020 2020 2020 2020 4461 736b 2061  y.        Dask a
-00025630: 7272 6179 2069 6e74 6572 7072 6574 6174  rray interpretat
-00025640: 696f 6e20 6f66 2061 2e0a 0a20 2020 2045  ion of a...    E
-00025650: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
-00025660: 2d2d 2d2d 0a20 2020 203e 3e3e 2069 6d70  ----.    >>> imp
-00025670: 6f72 7420 6461 736b 2e61 7272 6179 2061  ort dask.array a
-00025680: 7320 6461 0a20 2020 203e 3e3e 2069 6d70  s da.    >>> imp
-00025690: 6f72 7420 6e75 6d70 7920 6173 206e 700a  ort numpy as np.
-000256a0: 2020 2020 3e3e 3e20 7820 3d20 6e70 2e61      >>> x = np.a
-000256b0: 7261 6e67 6528 3329 0a20 2020 203e 3e3e  range(3).    >>>
-000256c0: 2064 612e 6173 616e 7961 7272 6179 2878   da.asanyarray(x
-000256d0: 290a 2020 2020 6461 736b 2e61 7272 6179  ).    dask.array
-000256e0: 3c61 7272 6179 2c20 7368 6170 653d 2833  <array, shape=(3
-000256f0: 2c29 2c20 6474 7970 653d 696e 7436 342c  ,), dtype=int64,
-00025700: 2063 6875 6e6b 7369 7a65 3d28 332c 292c   chunksize=(3,),
-00025710: 2063 6875 6e6b 7479 7065 3d6e 756d 7079   chunktype=numpy
-00025720: 2e6e 6461 7272 6179 3e0a 0a20 2020 203e  .ndarray>..    >
-00025730: 3e3e 2079 203d 205b 5b31 2c20 322c 2033  >> y = [[1, 2, 3
-00025740: 5d2c 205b 342c 2035 2c20 365d 5d0a 2020  ], [4, 5, 6]].  
-00025750: 2020 3e3e 3e20 6461 2e61 7361 6e79 6172    >>> da.asanyar
-00025760: 7261 7928 7929 0a20 2020 2064 6173 6b2e  ray(y).    dask.
-00025770: 6172 7261 793c 6172 7261 792c 2073 6861  array<array, sha
-00025780: 7065 3d28 322c 2033 292c 2064 7479 7065  pe=(2, 3), dtype
-00025790: 3d69 6e74 3634 2c20 6368 756e 6b73 697a  =int64, chunksiz
-000257a0: 653d 2832 2c20 3329 2c20 6368 756e 6b74  e=(2, 3), chunkt
-000257b0: 7970 653d 6e75 6d70 792e 6e64 6172 7261  ype=numpy.ndarra
-000257c0: 793e 0a20 2020 2022 2222 0a20 2020 2069  y>.    """.    i
-000257d0: 6620 6c69 6b65 2069 7320 4e6f 6e65 3a0a  f like is None:.
-000257e0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-000257f0: 7461 6e63 6528 612c 2041 7272 6179 293a  tance(a, Array):
-00025800: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00025810: 7572 6e20 610a 2020 2020 2020 2020 656c  urn a.        el
-00025820: 6966 2068 6173 6174 7472 2861 2c20 2274  if hasattr(a, "t
-00025830: 6f5f 6461 736b 5f61 7272 6179 2229 3a0a  o_dask_array"):.
-00025840: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00025850: 726e 2061 2e74 6f5f 6461 736b 5f61 7272  rn a.to_dask_arr
-00025860: 6179 2829 0a20 2020 2020 2020 2065 6c69  ay().        eli
-00025870: 6620 7479 7065 2861 292e 5f5f 6d6f 6475  f type(a).__modu
-00025880: 6c65 5f5f 2e73 706c 6974 2822 2e22 295b  le__.split(".")[
-00025890: 305d 203d 3d20 2278 6172 7261 7922 2061  0] == "xarray" a
-000258a0: 6e64 2068 6173 6174 7472 2861 2c20 2264  nd hasattr(a, "d
-000258b0: 6174 6122 293a 0a20 2020 2020 2020 2020  ata"):.         
-000258c0: 2020 2072 6574 7572 6e20 6173 616e 7961     return asanya
-000258d0: 7272 6179 2861 2e64 6174 6129 0a20 2020  rray(a.data).   
-000258e0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-000258f0: 616e 6365 2861 2c20 286c 6973 742c 2074  ance(a, (list, t
-00025900: 7570 6c65 2929 2061 6e64 2061 6e79 2869  uple)) and any(i
-00025910: 7369 6e73 7461 6e63 6528 692c 2041 7272  sinstance(i, Arr
-00025920: 6179 2920 666f 7220 6920 696e 2061 293a  ay) for i in a):
-00025930: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00025940: 7572 6e20 7374 6163 6b28 6129 0a20 2020  urn stack(a).   
-00025950: 2020 2020 2065 6c69 6620 6e6f 7420 6973       elif not is
-00025960: 696e 7374 616e 6365 2867 6574 6174 7472  instance(getattr
-00025970: 2861 2c20 2273 6861 7065 222c 204e 6f6e  (a, "shape", Non
-00025980: 6529 2c20 4974 6572 6162 6c65 293a 0a20  e), Iterable):. 
-00025990: 2020 2020 2020 2020 2020 2061 203d 206e             a = n
-000259a0: 702e 6173 616e 7961 7272 6179 2861 2c20  p.asanyarray(a, 
-000259b0: 6474 7970 653d 6474 7970 652c 206f 7264  dtype=dtype, ord
-000259c0: 6572 3d6f 7264 6572 290a 2020 2020 656c  er=order).    el
-000259d0: 7365 3a0a 2020 2020 2020 2020 6c69 6b65  se:.        like
-000259e0: 5f6d 6574 6120 3d20 6d65 7461 5f66 726f  _meta = meta_fro
-000259f0: 6d5f 6172 7261 7928 6c69 6b65 290a 2020  m_array(like).  
-00025a00: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00025a10: 6e63 6528 612c 2041 7272 6179 293a 0a20  nce(a, Array):. 
-00025a20: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00025a30: 6e20 612e 6d61 705f 626c 6f63 6b73 286e  n a.map_blocks(n
-00025a40: 702e 6173 616e 7961 7272 6179 2c20 6c69  p.asanyarray, li
-00025a50: 6b65 3d6c 696b 655f 6d65 7461 2c20 6474  ke=like_meta, dt
-00025a60: 7970 653d 6474 7970 652c 206f 7264 6572  ype=dtype, order
-00025a70: 3d6f 7264 6572 290a 2020 2020 2020 2020  =order).        
-00025a80: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00025a90: 2020 6120 3d20 6e70 2e61 7361 6e79 6172    a = np.asanyar
-00025aa0: 7261 7928 612c 206c 696b 653d 6c69 6b65  ray(a, like=like
-00025ab0: 5f6d 6574 612c 2064 7479 7065 3d64 7479  _meta, dtype=dty
-00025ac0: 7065 2c20 6f72 6465 723d 6f72 6465 7229  pe, order=order)
-00025ad0: 0a20 2020 2072 6574 7572 6e20 6672 6f6d  .    return from
-00025ae0: 5f61 7272 6179 280a 2020 2020 2020 2020  _array(.        
-00025af0: 612c 0a20 2020 2020 2020 2063 6875 6e6b  a,.        chunk
-00025b00: 733d 612e 7368 6170 652c 0a20 2020 2020  s=a.shape,.     
-00025b10: 2020 2067 6574 6974 656d 3d67 6574 7465     getitem=gette
-00025b20: 725f 696e 6c69 6e65 2c0a 2020 2020 2020  r_inline,.      
-00025b30: 2020 6173 6172 7261 793d 4661 6c73 652c    asarray=False,
-00025b40: 0a20 2020 2020 2020 2069 6e6c 696e 655f  .        inline_
-00025b50: 6172 7261 793d 696e 6c69 6e65 5f61 7272  array=inline_arr
-00025b60: 6179 2c0a 2020 2020 290a 0a0a 6465 6620  ay,.    )...def 
-00025b70: 6973 5f73 6361 6c61 725f 666f 725f 656c  is_scalar_for_el
-00025b80: 656d 7769 7365 2861 7267 293a 0a20 2020  emwise(arg):.   
-00025b90: 2022 2222 0a0a 2020 2020 3e3e 3e20 6973   """..    >>> is
-00025ba0: 5f73 6361 6c61 725f 666f 725f 656c 656d  _scalar_for_elem
-00025bb0: 7769 7365 2834 3229 0a20 2020 2054 7275  wise(42).    Tru
-00025bc0: 650a 2020 2020 3e3e 3e20 6973 5f73 6361  e.    >>> is_sca
-00025bd0: 6c61 725f 666f 725f 656c 656d 7769 7365  lar_for_elemwise
-00025be0: 2827 666f 6f27 290a 2020 2020 5472 7565  ('foo').    True
-00025bf0: 0a20 2020 203e 3e3e 2069 735f 7363 616c  .    >>> is_scal
-00025c00: 6172 5f66 6f72 5f65 6c65 6d77 6973 6528  ar_for_elemwise(
-00025c10: 5472 7565 290a 2020 2020 5472 7565 0a20  True).    True. 
-00025c20: 2020 203e 3e3e 2069 735f 7363 616c 6172     >>> is_scalar
-00025c30: 5f66 6f72 5f65 6c65 6d77 6973 6528 6e70  _for_elemwise(np
-00025c40: 2e61 7272 6179 2834 3229 290a 2020 2020  .array(42)).    
-00025c50: 5472 7565 0a20 2020 203e 3e3e 2069 735f  True.    >>> is_
-00025c60: 7363 616c 6172 5f66 6f72 5f65 6c65 6d77  scalar_for_elemw
-00025c70: 6973 6528 5b31 2c20 322c 2033 5d29 0a20  ise([1, 2, 3]). 
-00025c80: 2020 2054 7275 650a 2020 2020 3e3e 3e20     True.    >>> 
-00025c90: 6973 5f73 6361 6c61 725f 666f 725f 656c  is_scalar_for_el
-00025ca0: 656d 7769 7365 286e 702e 6172 7261 7928  emwise(np.array(
-00025cb0: 5b31 2c20 322c 2033 5d29 290a 2020 2020  [1, 2, 3])).    
-00025cc0: 4661 6c73 650a 2020 2020 3e3e 3e20 6973  False.    >>> is
-00025cd0: 5f73 6361 6c61 725f 666f 725f 656c 656d  _scalar_for_elem
-00025ce0: 7769 7365 2866 726f 6d5f 6172 7261 7928  wise(from_array(
-00025cf0: 6e70 2e61 7272 6179 2830 292c 2063 6875  np.array(0), chu
-00025d00: 6e6b 733d 2829 2929 0a20 2020 2046 616c  nks=())).    Fal
-00025d10: 7365 0a20 2020 203e 3e3e 2069 735f 7363  se.    >>> is_sc
-00025d20: 616c 6172 5f66 6f72 5f65 6c65 6d77 6973  alar_for_elemwis
-00025d30: 6528 6e70 2e64 7479 7065 2827 6934 2729  e(np.dtype('i4')
-00025d40: 290a 2020 2020 5472 7565 0a20 2020 2022  ).    True.    "
-00025d50: 2222 0a20 2020 2023 2074 6865 2073 6563  "".    # the sec
-00025d60: 6f6e 6420 6861 6c66 206f 6620 7368 6170  ond half of shap
-00025d70: 655f 636f 6e64 6974 696f 6e20 6973 2065  e_condition is e
-00025d80: 7373 656e 7469 616c 6c79 206a 7573 7420  ssentially just 
-00025d90: 746f 2065 6e73 7572 6520 7468 6174 0a20  to ensure that. 
-00025da0: 2020 2023 2064 6173 6b20 7365 7269 6573     # dask series
-00025db0: 202f 2066 7261 6d65 2061 7265 2074 7265   / frame are tre
-00025dc0: 6174 6564 2061 7320 7363 616c 6172 7320  ated as scalars 
-00025dd0: 696e 2065 6c65 6d77 6973 652e 0a20 2020  in elemwise..   
-00025de0: 206d 6179 6265 5f73 6861 7065 203d 2067   maybe_shape = g
-00025df0: 6574 6174 7472 2861 7267 2c20 2273 6861  etattr(arg, "sha
-00025e00: 7065 222c 204e 6f6e 6529 0a20 2020 2073  pe", None).    s
-00025e10: 6861 7065 5f63 6f6e 6469 7469 6f6e 203d  hape_condition =
-00025e20: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00025e30: 6d61 7962 655f 7368 6170 652c 2049 7465  maybe_shape, Ite
-00025e40: 7261 626c 6529 206f 7220 616e 7928 0a20  rable) or any(. 
-00025e50: 2020 2020 2020 2069 735f 6461 736b 5f63         is_dask_c
-00025e60: 6f6c 6c65 6374 696f 6e28 7829 2066 6f72  ollection(x) for
-00025e70: 2078 2069 6e20 6d61 7962 655f 7368 6170   x in maybe_shap
-00025e80: 650a 2020 2020 290a 0a20 2020 2072 6574  e.    )..    ret
-00025e90: 7572 6e20 280a 2020 2020 2020 2020 6e70  urn (.        np
-00025ea0: 2e69 7373 6361 6c61 7228 6172 6729 0a20  .isscalar(arg). 
-00025eb0: 2020 2020 2020 206f 7220 7368 6170 655f         or shape_
-00025ec0: 636f 6e64 6974 696f 6e0a 2020 2020 2020  condition.      
-00025ed0: 2020 6f72 2069 7369 6e73 7461 6e63 6528    or isinstance(
-00025ee0: 6172 672c 206e 702e 6474 7970 6529 0a20  arg, np.dtype). 
-00025ef0: 2020 2020 2020 206f 7220 2869 7369 6e73         or (isins
-00025f00: 7461 6e63 6528 6172 672c 206e 702e 6e64  tance(arg, np.nd
-00025f10: 6172 7261 7929 2061 6e64 2061 7267 2e6e  array) and arg.n
-00025f20: 6469 6d20 3d3d 2030 290a 2020 2020 290a  dim == 0).    ).
-00025f30: 0a0a 6465 6620 6272 6f61 6463 6173 745f  ..def broadcast_
-00025f40: 7368 6170 6573 282a 7368 6170 6573 293a  shapes(*shapes):
-00025f50: 0a20 2020 2022 2222 0a20 2020 2044 6574  .    """.    Det
-00025f60: 6572 6d69 6e65 7320 6f75 7470 7574 2073  ermines output s
-00025f70: 6861 7065 2066 726f 6d20 6272 6f61 6463  hape from broadc
-00025f80: 6173 7469 6e67 2061 7272 6179 732e 0a0a  asting arrays...
-00025f90: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00025fa0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00025fb0: 2020 7368 6170 6573 203a 2074 7570 6c65    shapes : tuple
-00025fc0: 730a 2020 2020 2020 2020 5468 6520 7368  s.        The sh
-00025fd0: 6170 6573 206f 6620 7468 6520 6172 6775  apes of the argu
-00025fe0: 6d65 6e74 732e 0a0a 2020 2020 5265 7475  ments...    Retu
-00025ff0: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
-00026000: 2020 2020 6f75 7470 7574 5f73 6861 7065      output_shape
-00026010: 203a 2074 7570 6c65 0a0a 2020 2020 5261   : tuple..    Ra
-00026020: 6973 6573 0a20 2020 202d 2d2d 2d2d 2d0a  ises.    ------.
-00026030: 2020 2020 5661 6c75 6545 7272 6f72 0a20      ValueError. 
-00026040: 2020 2020 2020 2049 6620 7468 6520 696e         If the in
-00026050: 7075 7420 7368 6170 6573 2063 616e 6e6f  put shapes canno
-00026060: 7420 6265 2073 7563 6365 7373 6675 6c6c  t be successfull
-00026070: 7920 6272 6f61 6463 6173 7420 746f 6765  y broadcast toge
-00026080: 7468 6572 2e0a 2020 2020 2222 220a 2020  ther..    """.  
-00026090: 2020 6966 206c 656e 2873 6861 7065 7329    if len(shapes)
-000260a0: 203d 3d20 313a 0a20 2020 2020 2020 2072   == 1:.        r
-000260b0: 6574 7572 6e20 7368 6170 6573 5b30 5d0a  eturn shapes[0].
-000260c0: 2020 2020 6f75 7420 3d20 5b5d 0a20 2020      out = [].   
-000260d0: 2066 6f72 2073 697a 6573 2069 6e20 7a69   for sizes in zi
-000260e0: 705f 6c6f 6e67 6573 7428 2a6d 6170 2872  p_longest(*map(r
-000260f0: 6576 6572 7365 642c 2073 6861 7065 7329  eversed, shapes)
-00026100: 2c20 6669 6c6c 7661 6c75 653d 2d31 293a  , fillvalue=-1):
-00026110: 0a20 2020 2020 2020 2069 6620 6e70 2e69  .        if np.i
-00026120: 736e 616e 2873 697a 6573 292e 616e 7928  snan(sizes).any(
-00026130: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-00026140: 696d 203d 206e 702e 6e61 6e0a 2020 2020  im = np.nan.    
-00026150: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00026160: 2020 2020 2020 6469 6d20 3d20 3020 6966        dim = 0 if
-00026170: 2030 2069 6e20 7369 7a65 7320 656c 7365   0 in sizes else
-00026180: 206e 702e 6d61 7828 7369 7a65 7329 0a20   np.max(sizes). 
-00026190: 2020 2020 2020 2069 6620 616e 7928 6920         if any(i 
-000261a0: 6e6f 7420 696e 205b 2d31 2c20 302c 2031  not in [-1, 0, 1
-000261b0: 2c20 6469 6d5d 2061 6e64 206e 6f74 206e  , dim] and not n
-000261c0: 702e 6973 6e61 6e28 6929 2066 6f72 2069  p.isnan(i) for i
-000261d0: 2069 6e20 7369 7a65 7329 3a0a 2020 2020   in sizes):.    
-000261e0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-000261f0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00026200: 2020 2020 2020 2020 2020 226f 7065 7261            "opera
-00026210: 6e64 7320 636f 756c 6420 6e6f 7420 6265  nds could not be
-00026220: 2062 726f 6164 6361 7374 2074 6f67 6574   broadcast toget
-00026230: 6865 7220 7769 7468 2022 0a20 2020 2020  her with ".     
-00026240: 2020 2020 2020 2020 2020 2022 7368 6170             "shap
-00026250: 6573 207b 7d22 2e66 6f72 6d61 7428 2220  es {}".format(" 
-00026260: 222e 6a6f 696e 286d 6170 2873 7472 2c20  ".join(map(str, 
-00026270: 7368 6170 6573 2929 290a 2020 2020 2020  shapes))).      
-00026280: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026290: 6f75 742e 6170 7065 6e64 2864 696d 290a  out.append(dim).
-000262a0: 2020 2020 7265 7475 726e 2074 7570 6c65      return tuple
-000262b0: 2872 6576 6572 7365 6428 6f75 7429 290a  (reversed(out)).
-000262c0: 0a0a 6465 6620 656c 656d 7769 7365 286f  ..def elemwise(o
-000262d0: 702c 202a 6172 6773 2c20 6f75 743d 4e6f  p, *args, out=No
-000262e0: 6e65 2c20 7768 6572 653d 5472 7565 2c20  ne, where=True, 
-000262f0: 6474 7970 653d 4e6f 6e65 2c20 6e61 6d65  dtype=None, name
-00026300: 3d4e 6f6e 652c 202a 2a6b 7761 7267 7329  =None, **kwargs)
-00026310: 3a0a 2020 2020 2222 2241 7070 6c79 2061  :.    """Apply a
-00026320: 6e20 656c 656d 656e 7477 6973 6520 7566  n elementwise uf
-00026330: 756e 632d 6c69 6b65 2066 756e 6374 696f  unc-like functio
-00026340: 6e20 626c 6f63 6b77 6973 6520 6163 726f  n blockwise acro
-00026350: 7373 2061 7267 756d 656e 7473 2e0a 0a20  ss arguments... 
-00026360: 2020 204c 696b 6520 6e75 6d70 7920 7566     Like numpy uf
-00026370: 756e 6373 2c20 6272 6f61 6463 6173 7469  uncs, broadcasti
-00026380: 6e67 2072 756c 6573 2061 7265 2072 6573  ng rules are res
-00026390: 7065 6374 6564 2e0a 0a20 2020 2050 6172  pected...    Par
-000263a0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-000263b0: 2d2d 2d2d 2d2d 0a20 2020 206f 7020 3a20  ------.    op : 
-000263c0: 6361 6c6c 6162 6c65 0a20 2020 2020 2020  callable.       
-000263d0: 2054 6865 2066 756e 6374 696f 6e20 746f   The function to
-000263e0: 2061 7070 6c79 2e20 5368 6f75 6c64 2062   apply. Should b
-000263f0: 6520 6e75 6d70 7920 7566 756e 632d 6c69  e numpy ufunc-li
-00026400: 6b65 2069 6e20 7468 6520 7061 7261 6d65  ke in the parame
-00026410: 7465 7273 0a20 2020 2020 2020 2074 6861  ters.        tha
-00026420: 7420 6974 2061 6363 6570 7473 2e0a 2020  t it accepts..  
-00026430: 2020 2a61 7267 7320 3a20 416e 790a 2020    *args : Any.  
-00026440: 2020 2020 2020 4172 6775 6d65 6e74 7320        Arguments 
-00026450: 746f 2070 6173 7320 746f 2060 6f70 602e  to pass to `op`.
-00026460: 204e 6f6e 2d64 6173 6b20 6172 7261 792d   Non-dask array-
-00026470: 6c69 6b65 206f 626a 6563 7473 2061 7265  like objects are
-00026480: 2066 6972 7374 0a20 2020 2020 2020 2063   first.        c
-00026490: 6f6e 7665 7274 6564 2074 6f20 6461 736b  onverted to dask
-000264a0: 2061 7272 6179 732c 2074 6865 6e20 616c   arrays, then al
-000264b0: 6c20 6172 7261 7973 2061 7265 2062 726f  l arrays are bro
-000264c0: 6164 6361 7374 2074 6f67 6574 6865 7220  adcast together 
-000264d0: 6265 666f 7265 0a20 2020 2020 2020 2061  before.        a
-000264e0: 7070 6c79 696e 6720 7468 6520 6675 6e63  pplying the func
-000264f0: 7469 6f6e 2062 6c6f 636b 7769 7365 2061  tion blockwise a
-00026500: 6372 6f73 7320 616c 6c20 6172 6775 6d65  cross all argume
-00026510: 6e74 732e 2041 6e79 2073 6361 6c61 720a  nts. Any scalar.
-00026520: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
-00026530: 7320 6172 6520 7061 7373 6564 2061 732d  s are passed as-
-00026540: 6973 2066 6f6c 6c6f 7769 6e67 206e 6f72  is following nor
-00026550: 6d61 6c20 6e75 6d70 7920 7566 756e 6320  mal numpy ufunc 
-00026560: 6265 6861 7669 6f72 2e0a 2020 2020 6f75  behavior..    ou
-00026570: 7420 3a20 6461 736b 2061 7272 6179 2c20  t : dask array, 
-00026580: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00026590: 2049 6620 6f75 7420 6973 2061 2064 6173   If out is a das
-000265a0: 6b2e 6172 7261 7920 7468 656e 2074 6869  k.array then thi
-000265b0: 7320 6f76 6572 7772 6974 6573 2074 6865  s overwrites the
-000265c0: 2063 6f6e 7465 6e74 7320 6f66 2074 6861   contents of tha
-000265d0: 7420 6172 7261 790a 2020 2020 2020 2020  t array.        
-000265e0: 7769 7468 2074 6865 2072 6573 756c 742e  with the result.
-000265f0: 0a20 2020 2077 6865 7265 203a 2061 7272  .    where : arr
-00026600: 6179 5f6c 696b 652c 206f 7074 696f 6e61  ay_like, optiona
-00026610: 6c0a 2020 2020 2020 2020 416e 206f 7074  l.        An opt
-00026620: 696f 6e61 6c20 626f 6f6c 6561 6e20 6d61  ional boolean ma
-00026630: 736b 206d 6172 6b69 6e67 206c 6f63 6174  sk marking locat
-00026640: 696f 6e73 2077 6865 7265 2074 6865 2075  ions where the u
-00026650: 6675 6e63 2073 686f 756c 6420 6265 0a20  func should be. 
-00026660: 2020 2020 2020 2061 7070 6c69 6564 2e20         applied. 
-00026670: 4361 6e20 6265 2061 2073 6361 6c61 722c  Can be a scalar,
-00026680: 2064 6173 6b20 6172 7261 792c 206f 7220   dask array, or 
-00026690: 616e 7920 6f74 6865 7220 6172 7261 792d  any other array-
-000266a0: 6c69 6b65 206f 626a 6563 742e 0a20 2020  like object..   
-000266b0: 2020 2020 204d 6972 726f 7273 2074 6865       Mirrors the
-000266c0: 2060 6077 6865 7265 6060 2061 7267 756d   ``where`` argum
-000266d0: 656e 7420 746f 206e 756d 7079 2075 6675  ent to numpy ufu
-000266e0: 6e63 732c 2073 6565 2065 2e67 2e20 6060  ncs, see e.g. ``
-000266f0: 6e75 6d70 792e 6164 6460 600a 2020 2020  numpy.add``.    
-00026700: 2020 2020 666f 7220 6d6f 7265 2069 6e66      for more inf
-00026710: 6f72 6d61 7469 6f6e 2e0a 2020 2020 6474  ormation..    dt
-00026720: 7970 6520 3a20 6474 7970 652c 206f 7074  ype : dtype, opt
-00026730: 696f 6e61 6c0a 2020 2020 2020 2020 4966  ional.        If
-00026740: 2070 726f 7669 6465 642c 206f 7665 7272   provided, overr
-00026750: 6964 6573 2074 6865 206f 7574 7075 7420  ides the output 
-00026760: 6172 7261 7920 6474 7970 652e 0a20 2020  array dtype..   
-00026770: 206e 616d 6520 3a20 7374 722c 206f 7074   name : str, opt
-00026780: 696f 6e61 6c0a 2020 2020 2020 2020 4120  ional.        A 
-00026790: 756e 6971 7565 206b 6579 206e 616d 6520  unique key name 
-000267a0: 746f 2075 7365 2077 6865 6e20 6275 696c  to use when buil
-000267b0: 6469 6e67 2074 6865 2062 6163 6b69 6e67  ding the backing
-000267c0: 2064 6173 6b20 6772 6170 682e 2049 6620   dask graph. If 
-000267d0: 6e6f 740a 2020 2020 2020 2020 7072 6f76  not.        prov
-000267e0: 6964 6564 2c20 6f6e 6520 7769 6c6c 2062  ided, one will b
-000267f0: 6520 6175 746f 6d61 7469 6361 6c6c 7920  e automatically 
-00026800: 6765 6e65 7261 7465 6420 6261 7365 6420  generated based 
-00026810: 6f6e 2074 6865 2069 6e70 7574 0a20 2020  on the input.   
-00026820: 2020 2020 2061 7267 756d 656e 7473 2e0a       arguments..
-00026830: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
-00026840: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e    --------.    >
-00026850: 3e3e 2065 6c65 6d77 6973 6528 6164 642c  >> elemwise(add,
-00026860: 2078 2c20 7929 2020 2320 646f 6374 6573   x, y)  # doctes
-00026870: 743a 202b 534b 4950 0a20 2020 203e 3e3e  t: +SKIP.    >>>
-00026880: 2065 6c65 6d77 6973 6528 7369 6e2c 2078   elemwise(sin, x
-00026890: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-000268a0: 4b49 500a 2020 2020 3e3e 3e20 656c 656d  KIP.    >>> elem
-000268b0: 7769 7365 2873 696e 2c20 782c 206f 7574  wise(sin, x, out
-000268c0: 3d64 6173 6b5f 6172 7261 7929 2020 2320  =dask_array)  # 
-000268d0: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
-000268e0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-000268f0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 626c   --------.    bl
-00026900: 6f63 6b77 6973 650a 2020 2020 2222 220a  ockwise.    """.
-00026910: 2020 2020 6966 206b 7761 7267 733a 0a20      if kwargs:. 
-00026920: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00026930: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00026940: 2020 2020 6622 7b6f 702e 5f5f 6e61 6d65      f"{op.__name
-00026950: 5f5f 7d20 646f 6573 206e 6f74 2074 616b  __} does not tak
-00026960: 6520 7468 6520 666f 6c6c 6f77 696e 6720  e the following 
-00026970: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00026980: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
-00026990: 6622 7b73 6f72 7465 6428 6b77 6172 6773  f"{sorted(kwargs
-000269a0: 297d 220a 2020 2020 2020 2020 290a 0a20  )}".        ).. 
-000269b0: 2020 206f 7574 203d 205f 656c 656d 7769     out = _elemwi
-000269c0: 7365 5f6e 6f72 6d61 6c69 7a65 5f6f 7574  se_normalize_out
-000269d0: 286f 7574 290a 2020 2020 7768 6572 6520  (out).    where 
-000269e0: 3d20 5f65 6c65 6d77 6973 655f 6e6f 726d  = _elemwise_norm
-000269f0: 616c 697a 655f 7768 6572 6528 7768 6572  alize_where(wher
-00026a00: 6529 0a20 2020 2061 7267 7320 3d20 5b6e  e).    args = [n
-00026a10: 702e 6173 6172 7261 7928 6129 2069 6620  p.asarray(a) if 
-00026a20: 6973 696e 7374 616e 6365 2861 2c20 286c  isinstance(a, (l
-00026a30: 6973 742c 2074 7570 6c65 2929 2065 6c73  ist, tuple)) els
-00026a40: 6520 6120 666f 7220 6120 696e 2061 7267  e a for a in arg
-00026a50: 735d 0a0a 2020 2020 7368 6170 6573 203d  s]..    shapes =
-00026a60: 205b 5d0a 2020 2020 666f 7220 6172 6720   [].    for arg 
-00026a70: 696e 2061 7267 733a 0a20 2020 2020 2020  in args:.       
-00026a80: 2073 6861 7065 203d 2067 6574 6174 7472   shape = getattr
-00026a90: 2861 7267 2c20 2273 6861 7065 222c 2028  (arg, "shape", (
-00026aa0: 2929 0a20 2020 2020 2020 2069 6620 616e  )).        if an
-00026ab0: 7928 6973 5f64 6173 6b5f 636f 6c6c 6563  y(is_dask_collec
-00026ac0: 7469 6f6e 2878 2920 666f 7220 7820 696e  tion(x) for x in
-00026ad0: 2073 6861 7065 293a 0a20 2020 2020 2020   shape):.       
-00026ae0: 2020 2020 2023 2057 616e 7420 746f 2065       # Want to e
-00026af0: 7863 6c75 6465 2044 656c 6179 6564 2073  xclude Delayed s
-00026b00: 6861 7065 7320 616e 6420 6464 2e53 6361  hapes and dd.Sca
-00026b10: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
-00026b20: 7368 6170 6520 3d20 2829 0a20 2020 2020  shape = ().     
-00026b30: 2020 2073 6861 7065 732e 6170 7065 6e64     shapes.append
-00026b40: 2873 6861 7065 290a 2020 2020 6966 2069  (shape).    if i
-00026b50: 7369 6e73 7461 6e63 6528 7768 6572 652c  sinstance(where,
-00026b60: 2041 7272 6179 293a 0a20 2020 2020 2020   Array):.       
-00026b70: 2073 6861 7065 732e 6170 7065 6e64 2877   shapes.append(w
-00026b80: 6865 7265 2e73 6861 7065 290a 2020 2020  here.shape).    
-00026b90: 6966 2069 7369 6e73 7461 6e63 6528 6f75  if isinstance(ou
-00026ba0: 742c 2041 7272 6179 293a 0a20 2020 2020  t, Array):.     
-00026bb0: 2020 2073 6861 7065 732e 6170 7065 6e64     shapes.append
-00026bc0: 286f 7574 2e73 6861 7065 290a 0a20 2020  (out.shape)..   
-00026bd0: 2073 6861 7065 7320 3d20 5b73 2069 6620   shapes = [s if 
-00026be0: 6973 696e 7374 616e 6365 2873 2c20 4974  isinstance(s, It
-00026bf0: 6572 6162 6c65 2920 656c 7365 2028 2920  erable) else () 
-00026c00: 666f 7220 7320 696e 2073 6861 7065 735d  for s in shapes]
-00026c10: 0a20 2020 206f 7574 5f6e 6469 6d20 3d20  .    out_ndim = 
-00026c20: 6c65 6e28 0a20 2020 2020 2020 2062 726f  len(.        bro
-00026c30: 6164 6361 7374 5f73 6861 7065 7328 2a73  adcast_shapes(*s
-00026c40: 6861 7065 7329 0a20 2020 2029 2020 2320  hapes).    )  # 
-00026c50: 5261 6973 6573 2056 616c 7565 4572 726f  Raises ValueErro
-00026c60: 7220 6966 2064 696d 656e 7369 6f6e 7320  r if dimensions 
-00026c70: 6d69 736d 6174 6368 0a20 2020 2065 7870  mismatch.    exp
-00026c80: 725f 696e 6473 203d 2074 7570 6c65 2872  r_inds = tuple(r
-00026c90: 616e 6765 286f 7574 5f6e 6469 6d29 295b  ange(out_ndim))[
-00026ca0: 3a3a 2d31 5d0a 0a20 2020 2069 6620 6474  ::-1]..    if dt
-00026cb0: 7970 6520 6973 206e 6f74 204e 6f6e 653a  ype is not None:
-00026cc0: 0a20 2020 2020 2020 206e 6565 645f 656e  .        need_en
-00026cd0: 666f 7263 655f 6474 7970 6520 3d20 5472  force_dtype = Tr
-00026ce0: 7565 0a20 2020 2065 6c73 653a 0a20 2020  ue.    else:.   
-00026cf0: 2020 2020 2023 2057 6520 666f 6c6c 6f77       # We follow
-00026d00: 204e 756d 5079 2773 2072 756c 6573 2066   NumPy's rules f
-00026d10: 6f72 2064 7479 7065 2070 726f 6d6f 7469  or dtype promoti
-00026d20: 6f6e 2c20 7768 6963 6820 7370 6563 6961  on, which specia
-00026d30: 6c20 6361 7365 730a 2020 2020 2020 2020  l cases.        
-00026d40: 2320 7363 616c 6172 7320 616e 6420 3064  # scalars and 0d
-00026d50: 206e 6461 7272 6179 7320 2877 6869 6368   ndarrays (which
-00026d60: 2069 7420 636f 6e73 6964 6572 7320 6571   it considers eq
-00026d70: 7569 7661 6c65 6e74 2920 6279 2075 7369  uivalent) by usi
-00026d80: 6e67 0a20 2020 2020 2020 2023 2074 6865  ng.        # the
-00026d90: 6972 2076 616c 7565 7320 746f 2063 6f6d  ir values to com
-00026da0: 7075 7465 2074 6865 2072 6573 756c 7420  pute the result 
-00026db0: 6474 7970 653a 0a20 2020 2020 2020 2023  dtype:.        #
-00026dc0: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
-00026dd0: 636f 6d2f 6e75 6d70 792f 6e75 6d70 792f  com/numpy/numpy/
-00026de0: 6973 7375 6573 2f36 3234 300a 2020 2020  issues/6240.    
-00026df0: 2020 2020 2320 5765 2064 6f6e 2774 2069      # We don't i
-00026e00: 6e73 7065 6374 2074 6865 2076 616c 7565  nspect the value
-00026e10: 7320 6f66 2030 6420 6461 736b 2061 7272  s of 0d dask arr
-00026e20: 6179 732c 2062 6563 6175 7365 2074 6865  ays, because the
-00026e30: 7365 2063 6f75 6c64 0a20 2020 2020 2020  se could.       
-00026e40: 2023 2068 6f6c 6420 706f 7465 6e74 6961   # hold potentia
-00026e50: 6c6c 7920 7665 7279 2065 7870 656e 7369  lly very expensi
-00026e60: 7665 2063 616c 6375 6c61 7469 6f6e 732e  ve calculations.
-00026e70: 2049 6e73 7465 6164 2c20 7765 2074 7265   Instead, we tre
-00026e80: 6174 0a20 2020 2020 2020 2023 2074 6865  at.        # the
-00026e90: 6d20 6a75 7374 206c 696b 6520 6f74 6865  m just like othe
-00026ea0: 7220 6172 7261 7973 2c20 616e 6420 6966  r arrays, and if
-00026eb0: 206e 6563 6573 7361 7279 2063 6173 7420   necessary cast 
-00026ec0: 7468 6520 7265 7375 6c74 206f 6620 6f70  the result of op
-00026ed0: 0a20 2020 2020 2020 2023 2074 6f20 6d61  .        # to ma
-00026ee0: 7463 682e 0a20 2020 2020 2020 2076 616c  tch..        val
-00026ef0: 7320 3d20 5b0a 2020 2020 2020 2020 2020  s = [.          
-00026f00: 2020 6e70 2e65 6d70 7479 2828 312c 2920    np.empty((1,) 
-00026f10: 2a20 6d61 7828 312c 2061 2e6e 6469 6d29  * max(1, a.ndim)
-00026f20: 2c20 6474 7970 653d 612e 6474 7970 6529  , dtype=a.dtype)
-00026f30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00026f40: 6e6f 7420 6973 5f73 6361 6c61 725f 666f  not is_scalar_fo
-00026f50: 725f 656c 656d 7769 7365 2861 290a 2020  r_elemwise(a).  
-00026f60: 2020 2020 2020 2020 2020 656c 7365 2061            else a
-00026f70: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00026f80: 2061 2069 6e20 6172 6773 0a20 2020 2020   a in args.     
-00026f90: 2020 205d 0a20 2020 2020 2020 2074 7279     ].        try
-00026fa0: 3a0a 2020 2020 2020 2020 2020 2020 6474  :.            dt
-00026fb0: 7970 6520 3d20 6170 706c 795f 696e 6665  ype = apply_infe
-00026fc0: 725f 6474 7970 6528 6f70 2c20 7661 6c73  r_dtype(op, vals
-00026fd0: 2c20 7b7d 2c20 2265 6c65 6d77 6973 6522  , {}, "elemwise"
-00026fe0: 2c20 7375 6767 6573 745f 6474 7970 653d  , suggest_dtype=
-00026ff0: 4661 6c73 6529 0a20 2020 2020 2020 2065  False).        e
-00027000: 7863 6570 7420 4578 6365 7074 696f 6e3a  xcept Exception:
-00027010: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00027020: 7572 6e20 4e6f 7449 6d70 6c65 6d65 6e74  urn NotImplement
-00027030: 6564 0a20 2020 2020 2020 206e 6565 645f  ed.        need_
-00027040: 656e 666f 7263 655f 6474 7970 6520 3d20  enforce_dtype = 
-00027050: 616e 7928 0a20 2020 2020 2020 2020 2020  any(.           
-00027060: 206e 6f74 2069 735f 7363 616c 6172 5f66   not is_scalar_f
-00027070: 6f72 5f65 6c65 6d77 6973 6528 6129 2061  or_elemwise(a) a
-00027080: 6e64 2061 2e6e 6469 6d20 3d3d 2030 2066  nd a.ndim == 0 f
-00027090: 6f72 2061 2069 6e20 6172 6773 0a20 2020  or a in args.   
-000270a0: 2020 2020 2029 0a0a 2020 2020 6966 206e       )..    if n
-000270b0: 6f74 206e 616d 653a 0a20 2020 2020 2020  ot name:.       
-000270c0: 206e 616d 6520 3d20 6622 7b66 756e 636e   name = f"{funcn
-000270d0: 616d 6528 6f70 297d 2d7b 746f 6b65 6e69  ame(op)}-{tokeni
-000270e0: 7a65 286f 702c 2064 7479 7065 2c20 2a61  ze(op, dtype, *a
-000270f0: 7267 732c 2077 6865 7265 297d 220a 0a20  rgs, where)}".. 
-00027100: 2020 2062 6c6f 636b 7769 7365 5f6b 7761     blockwise_kwa
-00027110: 7267 7320 3d20 6469 6374 2864 7479 7065  rgs = dict(dtype
-00027120: 3d64 7479 7065 2c20 6e61 6d65 3d6e 616d  =dtype, name=nam
-00027130: 652c 2074 6f6b 656e 3d66 756e 636e 616d  e, token=funcnam
-00027140: 6528 6f70 292e 7374 7269 7028 225f 2229  e(op).strip("_")
-00027150: 290a 0a20 2020 2069 6620 7768 6572 6520  )..    if where 
-00027160: 6973 206e 6f74 2054 7275 653a 0a20 2020  is not True:.   
-00027170: 2020 2020 2062 6c6f 636b 7769 7365 5f6b       blockwise_k
-00027180: 7761 7267 735b 2265 6c65 6d77 6973 655f  wargs["elemwise_
-00027190: 7768 6572 655f 6675 6e63 7469 6f6e 225d  where_function"]
-000271a0: 203d 206f 700a 2020 2020 2020 2020 6f70   = op.        op
-000271b0: 203d 205f 656c 656d 7769 7365 5f68 616e   = _elemwise_han
-000271c0: 646c 655f 7768 6572 650a 2020 2020 2020  dle_where.      
-000271d0: 2020 6172 6773 2e65 7874 656e 6428 5b77    args.extend([w
-000271e0: 6865 7265 2c20 6f75 745d 290a 0a20 2020  here, out])..   
-000271f0: 2069 6620 6e65 6564 5f65 6e66 6f72 6365   if need_enforce
-00027200: 5f64 7479 7065 3a0a 2020 2020 2020 2020  _dtype:.        
-00027210: 626c 6f63 6b77 6973 655f 6b77 6172 6773  blockwise_kwargs
-00027220: 5b22 656e 666f 7263 655f 6474 7970 6522  ["enforce_dtype"
-00027230: 5d20 3d20 6474 7970 650a 2020 2020 2020  ] = dtype.      
-00027240: 2020 626c 6f63 6b77 6973 655f 6b77 6172    blockwise_kwar
-00027250: 6773 5b22 656e 666f 7263 655f 6474 7970  gs["enforce_dtyp
-00027260: 655f 6675 6e63 7469 6f6e 225d 203d 206f  e_function"] = o
-00027270: 700a 2020 2020 2020 2020 6f70 203d 205f  p.        op = _
-00027280: 656e 666f 7263 655f 6474 7970 650a 0a20  enforce_dtype.. 
-00027290: 2020 2072 6573 756c 7420 3d20 626c 6f63     result = bloc
-000272a0: 6b77 6973 6528 0a20 2020 2020 2020 206f  kwise(.        o
-000272b0: 702c 0a20 2020 2020 2020 2065 7870 725f  p,.        expr_
-000272c0: 696e 6473 2c0a 2020 2020 2020 2020 2a63  inds,.        *c
-000272d0: 6f6e 6361 7428 0a20 2020 2020 2020 2020  oncat(.         
-000272e0: 2020 2028 612c 2074 7570 6c65 2872 616e     (a, tuple(ran
-000272f0: 6765 2861 2e6e 6469 6d29 5b3a 3a2d 315d  ge(a.ndim)[::-1]
-00027300: 2920 6966 206e 6f74 2069 735f 7363 616c  ) if not is_scal
-00027310: 6172 5f66 6f72 5f65 6c65 6d77 6973 6528  ar_for_elemwise(
-00027320: 6129 2065 6c73 6520 4e6f 6e65 290a 2020  a) else None).  
-00027330: 2020 2020 2020 2020 2020 666f 7220 6120            for a 
-00027340: 696e 2061 7267 730a 2020 2020 2020 2020  in args.        
-00027350: 292c 0a20 2020 2020 2020 202a 2a62 6c6f  ),.        **blo
-00027360: 636b 7769 7365 5f6b 7761 7267 732c 0a20  ckwise_kwargs,. 
-00027370: 2020 2029 0a0a 2020 2020 7265 7475 726e     )..    return
-00027380: 2068 616e 646c 655f 6f75 7428 6f75 742c   handle_out(out,
-00027390: 2072 6573 756c 7429 0a0a 0a64 6566 205f   result)...def _
-000273a0: 656c 656d 7769 7365 5f6e 6f72 6d61 6c69  elemwise_normali
-000273b0: 7a65 5f77 6865 7265 2877 6865 7265 293a  ze_where(where):
-000273c0: 0a20 2020 2069 6620 7768 6572 6520 6973  .    if where is
-000273d0: 2054 7275 653a 0a20 2020 2020 2020 2072   True:.        r
-000273e0: 6574 7572 6e20 5472 7565 0a20 2020 2065  eturn True.    e
-000273f0: 6c69 6620 7768 6572 6520 6973 2046 616c  lif where is Fal
-00027400: 7365 206f 7220 7768 6572 6520 6973 204e  se or where is N
-00027410: 6f6e 653a 0a20 2020 2020 2020 2072 6574  one:.        ret
-00027420: 7572 6e20 4661 6c73 650a 2020 2020 7265  urn False.    re
-00027430: 7475 726e 2061 7361 7272 6179 2877 6865  turn asarray(whe
-00027440: 7265 290a 0a0a 6465 6620 5f65 6c65 6d77  re)...def _elemw
-00027450: 6973 655f 6861 6e64 6c65 5f77 6865 7265  ise_handle_where
-00027460: 282a 6172 6773 2c20 2a2a 6b77 6172 6773  (*args, **kwargs
-00027470: 293a 0a20 2020 2066 756e 6374 696f 6e20  ):.    function 
-00027480: 3d20 6b77 6172 6773 2e70 6f70 2822 656c  = kwargs.pop("el
-00027490: 656d 7769 7365 5f77 6865 7265 5f66 756e  emwise_where_fun
-000274a0: 6374 696f 6e22 290a 2020 2020 2a61 7267  ction").    *arg
-000274b0: 732c 2077 6865 7265 2c20 6f75 7420 3d20  s, where, out = 
-000274c0: 6172 6773 0a20 2020 2069 6620 6861 7361  args.    if hasa
-000274d0: 7474 7228 6f75 742c 2022 636f 7079 2229  ttr(out, "copy")
-000274e0: 3a0a 2020 2020 2020 2020 6f75 7420 3d20  :.        out = 
-000274f0: 6f75 742e 636f 7079 2829 0a20 2020 2072  out.copy().    r
-00027500: 6574 7572 6e20 6675 6e63 7469 6f6e 282a  eturn function(*
-00027510: 6172 6773 2c20 7768 6572 653d 7768 6572  args, where=wher
-00027520: 652c 206f 7574 3d6f 7574 2c20 2a2a 6b77  e, out=out, **kw
-00027530: 6172 6773 290a 0a0a 6465 6620 5f65 6c65  args)...def _ele
-00027540: 6d77 6973 655f 6e6f 726d 616c 697a 655f  mwise_normalize_
-00027550: 6f75 7428 6f75 7429 3a0a 2020 2020 6966  out(out):.    if
-00027560: 2069 7369 6e73 7461 6e63 6528 6f75 742c   isinstance(out,
-00027570: 2074 7570 6c65 293a 0a20 2020 2020 2020   tuple):.       
-00027580: 2069 6620 6c65 6e28 6f75 7429 203d 3d20   if len(out) == 
-00027590: 313a 0a20 2020 2020 2020 2020 2020 206f  1:.            o
-000275a0: 7574 203d 206f 7574 5b30 5d0a 2020 2020  ut = out[0].    
-000275b0: 2020 2020 656c 6966 206c 656e 286f 7574      elif len(out
-000275c0: 2920 3e20 313a 0a20 2020 2020 2020 2020  ) > 1:.         
-000275d0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-000275e0: 656d 656e 7465 6445 7272 6f72 2822 5468  ementedError("Th
-000275f0: 6520 6f75 7420 7061 7261 6d65 7465 7220  e out parameter 
-00027600: 6973 206e 6f74 2066 756c 6c79 2073 7570  is not fully sup
-00027610: 706f 7274 6564 2229 0a20 2020 2020 2020  ported").       
-00027620: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00027630: 2020 206f 7574 203d 204e 6f6e 650a 2020     out = None.  
-00027640: 2020 6966 206e 6f74 2028 6f75 7420 6973    if not (out is
-00027650: 204e 6f6e 6520 6f72 2069 7369 6e73 7461   None or isinsta
-00027660: 6e63 6528 6f75 742c 2041 7272 6179 2929  nce(out, Array))
-00027670: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-00027680: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00027690: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000276a0: 2066 2254 6865 206f 7574 2070 6172 616d   f"The out param
-000276b0: 6574 6572 2069 7320 6e6f 7420 6675 6c6c  eter is not full
-000276c0: 7920 7375 7070 6f72 7465 642e 220a 2020  y supported.".  
-000276d0: 2020 2020 2020 2020 2020 6622 2052 6563            f" Rec
-000276e0: 6569 7665 6420 7479 7065 207b 7479 7065  eived type {type
-000276f0: 286f 7574 292e 5f5f 6e61 6d65 5f5f 7d2c  (out).__name__},
-00027700: 2065 7870 6563 7465 6420 4461 736b 2041   expected Dask A
-00027710: 7272 6179 220a 2020 2020 2020 2020 290a  rray".        ).
-00027720: 2020 2020 7265 7475 726e 206f 7574 0a0a      return out..
-00027730: 0a64 6566 2068 616e 646c 655f 6f75 7428  .def handle_out(
-00027740: 6f75 742c 2072 6573 756c 7429 3a0a 2020  out, result):.  
-00027750: 2020 2222 2248 616e 646c 6520 6f75 7420    """Handle out 
-00027760: 7061 7261 6d65 7465 7273 0a0a 2020 2020  parameters..    
-00027770: 4966 206f 7574 2069 7320 6120 6461 736b  If out is a dask
-00027780: 2e61 7272 6179 2074 6865 6e20 7468 6973  .array then this
-00027790: 206f 7665 7277 7269 7465 7320 7468 6520   overwrites the 
-000277a0: 636f 6e74 656e 7473 206f 6620 7468 6174  contents of that
-000277b0: 2061 7272 6179 2077 6974 680a 2020 2020   array with.    
-000277c0: 7468 6520 7265 7375 6c74 0a20 2020 2022  the result.    "
-000277d0: 2222 0a20 2020 206f 7574 203d 205f 656c  "".    out = _el
-000277e0: 656d 7769 7365 5f6e 6f72 6d61 6c69 7a65  emwise_normalize
-000277f0: 5f6f 7574 286f 7574 290a 2020 2020 6966  _out(out).    if
-00027800: 2069 7369 6e73 7461 6e63 6528 6f75 742c   isinstance(out,
-00027810: 2041 7272 6179 293a 0a20 2020 2020 2020   Array):.       
-00027820: 2069 6620 6f75 742e 7368 6170 6520 213d   if out.shape !=
-00027830: 2072 6573 756c 742e 7368 6170 653a 0a20   result.shape:. 
-00027840: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00027850: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00027860: 2020 2020 2020 2020 2020 2020 2022 4d69               "Mi
-00027870: 736d 6174 6368 6564 2073 6861 7065 7320  smatched shapes 
-00027880: 6265 7477 6565 6e20 7265 7375 6c74 2061  between result a
-00027890: 6e64 206f 7574 2070 6172 616d 6574 6572  nd out parameter
-000278a0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-000278b0: 2020 2020 226f 7574 3d25 732c 2072 6573      "out=%s, res
-000278c0: 756c 743d 2573 2220 2520 2873 7472 286f  ult=%s" % (str(o
-000278d0: 7574 2e73 6861 7065 292c 2073 7472 2872  ut.shape), str(r
-000278e0: 6573 756c 742e 7368 6170 6529 290a 2020  esult.shape)).  
-000278f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00027900: 2020 2020 6f75 742e 5f63 6875 6e6b 7320      out._chunks 
-00027910: 3d20 7265 7375 6c74 2e63 6875 6e6b 730a  = result.chunks.
-00027920: 2020 2020 2020 2020 6f75 742e 6461 736b          out.dask
-00027930: 203d 2072 6573 756c 742e 6461 736b 0a20   = result.dask. 
-00027940: 2020 2020 2020 206f 7574 2e5f 6d65 7461         out._meta
-00027950: 203d 2072 6573 756c 742e 5f6d 6574 610a   = result._meta.
-00027960: 2020 2020 2020 2020 6f75 742e 5f6e 616d          out._nam
-00027970: 6520 3d20 7265 7375 6c74 2e6e 616d 650a  e = result.name.
-00027980: 2020 2020 2020 2020 7265 7475 726e 206f          return o
-00027990: 7574 0a20 2020 2065 6c73 653a 0a20 2020  ut.    else:.   
-000279a0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-000279b0: 6c74 0a0a 0a64 6566 205f 656e 666f 7263  lt...def _enforc
-000279c0: 655f 6474 7970 6528 2a61 7267 732c 202a  e_dtype(*args, *
-000279d0: 2a6b 7761 7267 7329 3a0a 2020 2020 2222  *kwargs):.    ""
-000279e0: 2243 616c 6c73 2061 2066 756e 6374 696f  "Calls a functio
-000279f0: 6e20 616e 6420 636f 6e76 6572 7473 2069  n and converts i
-00027a00: 7473 2072 6573 756c 7420 746f 2074 6865  ts result to the
-00027a10: 2067 6976 656e 2064 7479 7065 2e0a 0a20   given dtype... 
-00027a20: 2020 2054 6865 2070 6172 616d 6574 6572     The parameter
-00027a30: 7320 6861 7665 2064 656c 6962 6572 6174  s have deliberat
-00027a40: 656c 7920 6265 656e 2067 6976 656e 2075  ely been given u
-00027a50: 6e77 6965 6c64 7920 6e61 6d65 7320 746f  nwieldy names to
-00027a60: 2061 766f 6964 0a20 2020 2063 6c61 7368   avoid.    clash
-00027a70: 6573 2077 6974 6820 6b65 7977 6f72 6420  es with keyword 
-00027a80: 6172 6775 6d65 6e74 7320 636f 6e73 756d  arguments consum
-00027a90: 6564 2062 7920 626c 6f63 6b77 6973 650a  ed by blockwise.
-00027aa0: 0a20 2020 2041 2064 7479 7065 206f 6620  .    A dtype of 
-00027ab0: 606f 626a 6563 7460 2069 7320 7472 6561  `object` is trea
-00027ac0: 7465 6420 6173 2061 2073 7065 6369 616c  ted as a special
-00027ad0: 2063 6173 6520 616e 6420 6e6f 7420 656e   case and not en
-00027ae0: 666f 7263 6564 2c0a 2020 2020 6265 6361  forced,.    beca
-00027af0: 7573 6520 6974 2069 7320 7573 6564 2061  use it is used a
-00027b00: 7320 6120 6475 6d6d 7920 7661 6c75 6520  s a dummy value 
-00027b10: 696e 2073 6f6d 6520 706c 6163 6573 2077  in some places w
-00027b20: 6865 6e20 7468 6520 7265 7375 6c74 2077  hen the result w
-00027b30: 696c 6c0a 2020 2020 6e6f 7420 6265 2061  ill.    not be a
-00027b40: 2062 6c6f 636b 2069 6e20 616e 2041 7272   block in an Arr
-00027b50: 6179 2e0a 0a20 2020 2050 6172 616d 6574  ay...    Paramet
-00027b60: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-00027b70: 2d2d 0a20 2020 2065 6e66 6f72 6365 5f64  --.    enforce_d
-00027b80: 7479 7065 203a 2064 7479 7065 0a20 2020  type : dtype.   
-00027b90: 2020 2020 2052 6573 756c 7420 6474 7970       Result dtyp
-00027ba0: 650a 2020 2020 656e 666f 7263 655f 6474  e.    enforce_dt
-00027bb0: 7970 655f 6675 6e63 7469 6f6e 203a 2063  ype_function : c
-00027bc0: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
-00027bd0: 5468 6520 7772 6170 7065 6420 6675 6e63  The wrapped func
-00027be0: 7469 6f6e 2c20 7768 6963 6820 7769 6c6c  tion, which will
-00027bf0: 2062 6520 7061 7373 6564 2074 6865 2072   be passed the r
-00027c00: 656d 6169 6e69 6e67 2061 7267 756d 656e  emaining argumen
-00027c10: 7473 0a20 2020 2022 2222 0a20 2020 2064  ts.    """.    d
-00027c20: 7479 7065 203d 206b 7761 7267 732e 706f  type = kwargs.po
-00027c30: 7028 2265 6e66 6f72 6365 5f64 7479 7065  p("enforce_dtype
-00027c40: 2229 0a20 2020 2066 756e 6374 696f 6e20  ").    function 
-00027c50: 3d20 6b77 6172 6773 2e70 6f70 2822 656e  = kwargs.pop("en
-00027c60: 666f 7263 655f 6474 7970 655f 6675 6e63  force_dtype_func
-00027c70: 7469 6f6e 2229 0a0a 2020 2020 7265 7375  tion")..    resu
-00027c80: 6c74 203d 2066 756e 6374 696f 6e28 2a61  lt = function(*a
-00027c90: 7267 732c 202a 2a6b 7761 7267 7329 0a20  rgs, **kwargs). 
-00027ca0: 2020 2069 6620 6861 7361 7474 7228 7265     if hasattr(re
-00027cb0: 7375 6c74 2c20 2264 7479 7065 2229 2061  sult, "dtype") a
-00027cc0: 6e64 2064 7479 7065 2021 3d20 7265 7375  nd dtype != resu
-00027cd0: 6c74 2e64 7479 7065 2061 6e64 2064 7479  lt.dtype and dty
-00027ce0: 7065 2021 3d20 6f62 6a65 6374 3a0a 2020  pe != object:.  
-00027cf0: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
-00027d00: 6361 6e5f 6361 7374 2872 6573 756c 742c  can_cast(result,
-00027d10: 2064 7479 7065 2c20 6361 7374 696e 673d   dtype, casting=
-00027d20: 2273 616d 655f 6b69 6e64 2229 3a0a 2020  "same_kind"):.  
-00027d30: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00027d40: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00027d50: 2020 2020 2020 2020 2020 2020 2249 6e66              "Inf
-00027d60: 6572 7265 6420 6474 7970 6520 6672 6f6d  erred dtype from
-00027d70: 2066 756e 6374 696f 6e20 2572 2077 6173   function %r was
-00027d80: 2025 7220 220a 2020 2020 2020 2020 2020   %r ".          
-00027d90: 2020 2020 2020 2262 7574 2067 6f74 2025        "but got %
-00027da0: 722c 2077 6869 6368 2063 616e 2774 2062  r, which can't b
-00027db0: 6520 6361 7374 2075 7369 6e67 2022 0a20  e cast using ". 
-00027dc0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00027dd0: 6361 7374 696e 673d 2773 616d 655f 6b69  casting='same_ki
-00027de0: 6e64 2722 0a20 2020 2020 2020 2020 2020  nd'".           
-00027df0: 2020 2020 2025 2028 6675 6e63 6e61 6d65       % (funcname
-00027e00: 2866 756e 6374 696f 6e29 2c20 7374 7228  (function), str(
-00027e10: 6474 7970 6529 2c20 7374 7228 7265 7375  dtype), str(resu
-00027e20: 6c74 2e64 7479 7065 2929 0a20 2020 2020  lt.dtype)).     
-00027e30: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00027e40: 2069 6620 6e70 2e69 7373 6361 6c61 7228   if np.isscalar(
-00027e50: 7265 7375 6c74 293a 0a20 2020 2020 2020  result):.       
-00027e60: 2020 2020 2023 2073 6361 6c61 7220 6173       # scalar as
-00027e70: 7479 7065 206d 6574 686f 6420 646f 6573  type method does
-00027e80: 6e27 7420 7461 6b65 2074 6865 206b 6579  n't take the key
-00027e90: 776f 7264 2061 7267 756d 656e 7473 2c20  word arguments, 
-00027ea0: 736f 0a20 2020 2020 2020 2020 2020 2023  so.            #
-00027eb0: 2068 6176 6520 746f 2063 6f6e 7665 7274   have to convert
-00027ec0: 2076 6961 2030 2d64 696d 656e 7369 6f6e   via 0-dimension
-00027ed0: 616c 2061 7272 6179 2061 6e64 2062 6163  al array and bac
-00027ee0: 6b2e 0a20 2020 2020 2020 2020 2020 2072  k..            r
-00027ef0: 6573 756c 7420 3d20 7265 7375 6c74 2e61  esult = result.a
-00027f00: 7374 7970 6528 6474 7970 6529 0a20 2020  stype(dtype).   
-00027f10: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00027f20: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00027f30: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00027f40: 6c74 203d 2072 6573 756c 742e 6173 7479  lt = result.asty
-00027f50: 7065 2864 7479 7065 2c20 636f 7079 3d46  pe(dtype, copy=F
-00027f60: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
-00027f70: 2020 6578 6365 7074 2054 7970 6545 7272    except TypeErr
-00027f80: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-00027f90: 2020 2020 2320 4d69 7373 696e 6720 636f      # Missing co
-00027fa0: 7079 206b 7761 7267 0a20 2020 2020 2020  py kwarg.       
-00027fb0: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-00027fc0: 3d20 7265 7375 6c74 2e61 7374 7970 6528  = result.astype(
-00027fd0: 6474 7970 6529 0a20 2020 2072 6574 7572  dtype).    retur
-00027fe0: 6e20 7265 7375 6c74 0a0a 0a64 6566 2062  n result...def b
-00027ff0: 726f 6164 6361 7374 5f74 6f28 782c 2073  roadcast_to(x, s
-00028000: 6861 7065 2c20 6368 756e 6b73 3d4e 6f6e  hape, chunks=Non
-00028010: 652c 206d 6574 613d 4e6f 6e65 293a 0a20  e, meta=None):. 
-00028020: 2020 2022 2222 4272 6f61 6463 6173 7420     """Broadcast 
-00028030: 616e 2061 7272 6179 2074 6f20 6120 6e65  an array to a ne
-00028040: 7720 7368 6170 652e 0a0a 2020 2020 5061  w shape...    Pa
-00028050: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-00028060: 2d2d 2d2d 2d2d 2d0a 2020 2020 7820 3a20  -------.    x : 
-00028070: 6172 7261 795f 6c69 6b65 0a20 2020 2020  array_like.     
-00028080: 2020 2054 6865 2061 7272 6179 2074 6f20     The array to 
-00028090: 6272 6f61 6463 6173 742e 0a20 2020 2073  broadcast..    s
-000280a0: 6861 7065 203a 2074 7570 6c65 0a20 2020  hape : tuple.   
-000280b0: 2020 2020 2054 6865 2073 6861 7065 206f       The shape o
-000280c0: 6620 7468 6520 6465 7369 7265 6420 6172  f the desired ar
-000280d0: 7261 792e 0a20 2020 2063 6875 6e6b 7320  ray..    chunks 
-000280e0: 3a20 7475 706c 652c 206f 7074 696f 6e61  : tuple, optiona
-000280f0: 6c0a 2020 2020 2020 2020 4966 2070 726f  l.        If pro
-00028100: 7669 6465 642c 2074 6865 6e20 7468 6520  vided, then the 
-00028110: 7265 7375 6c74 2077 696c 6c20 7573 6520  result will use 
-00028120: 7468 6573 6520 6368 756e 6b73 2069 6e73  these chunks ins
-00028130: 7465 6164 206f 6620 7468 6520 7361 6d65  tead of the same
-00028140: 0a20 2020 2020 2020 2063 6875 6e6b 7320  .        chunks 
-00028150: 6173 2074 6865 2073 6f75 7263 6520 6172  as the source ar
-00028160: 7261 792e 2053 6574 7469 6e67 2063 6875  ray. Setting chu
-00028170: 6e6b 7320 6578 706c 6963 6974 6c79 2061  nks explicitly a
-00028180: 7320 7061 7274 206f 660a 2020 2020 2020  s part of.      
-00028190: 2020 6272 6f61 6463 6173 745f 746f 2069    broadcast_to i
-000281a0: 7320 6d6f 7265 2065 6666 6963 6965 6e74  s more efficient
-000281b0: 2074 6861 6e20 7265 6368 756e 6b69 6e67   than rechunking
-000281c0: 2061 6674 6572 7761 7264 732e 2043 6875   afterwards. Chu
-000281d0: 6e6b 7320 6172 650a 2020 2020 2020 2020  nks are.        
-000281e0: 6f6e 6c79 2061 6c6c 6f77 6564 2074 6f20  only allowed to 
-000281f0: 6469 6666 6572 2066 726f 6d20 7468 6520  differ from the 
-00028200: 6f72 6967 696e 616c 2073 6861 7065 2061  original shape a
-00028210: 6c6f 6e67 2064 696d 656e 7369 6f6e 7320  long dimensions 
-00028220: 7468 6174 0a20 2020 2020 2020 2061 7265  that.        are
-00028230: 206e 6577 206f 6e20 7468 6520 7265 7375   new on the resu
-00028240: 6c74 206f 7220 6861 7665 2073 697a 6520  lt or have size 
-00028250: 3120 7468 6520 696e 7075 7420 6172 7261  1 the input arra
-00028260: 792e 0a20 2020 206d 6574 6120 3a20 656d  y..    meta : em
-00028270: 7074 7920 6e64 6172 7261 790a 2020 2020  pty ndarray.    
-00028280: 2020 2020 656d 7074 7920 6e64 6172 7261      empty ndarra
-00028290: 7920 6372 6561 7465 6420 7769 7468 2073  y created with s
-000282a0: 616d 6520 4e75 6d50 7920 6261 636b 656e  ame NumPy backen
-000282b0: 642c 206e 6469 6d20 616e 6420 6474 7970  d, ndim and dtyp
-000282c0: 6520 6173 2074 6865 0a20 2020 2020 2020  e as the.       
-000282d0: 2044 6173 6b20 4172 7261 7920 6265 696e   Dask Array bein
-000282e0: 6720 6372 6561 7465 6420 286f 7665 7272  g created (overr
-000282f0: 6964 6573 2064 7479 7065 290a 0a20 2020  ides dtype)..   
-00028300: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
-00028310: 2d2d 2d2d 0a20 2020 2062 726f 6164 6361  ----.    broadca
-00028320: 7374 203a 2064 6173 6b20 6172 7261 790a  st : dask array.
-00028330: 0a20 2020 2053 6565 2041 6c73 6f0a 2020  .    See Also.  
-00028340: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203a    --------.    :
-00028350: 6675 6e63 3a60 6e75 6d70 792e 6272 6f61  func:`numpy.broa
-00028360: 6463 6173 745f 746f 600a 2020 2020 2222  dcast_to`.    ""
-00028370: 220a 2020 2020 7820 3d20 6173 6172 7261  ".    x = asarra
-00028380: 7928 7829 0a20 2020 2073 6861 7065 203d  y(x).    shape =
-00028390: 2074 7570 6c65 2873 6861 7065 290a 0a20   tuple(shape).. 
-000283a0: 2020 2069 6620 6d65 7461 2069 7320 4e6f     if meta is No
-000283b0: 6e65 3a0a 2020 2020 2020 2020 6d65 7461  ne:.        meta
-000283c0: 203d 206d 6574 615f 6672 6f6d 5f61 7272   = meta_from_arr
-000283d0: 6179 2878 290a 0a20 2020 2069 6620 782e  ay(x)..    if x.
-000283e0: 7368 6170 6520 3d3d 2073 6861 7065 2061  shape == shape a
-000283f0: 6e64 2028 6368 756e 6b73 2069 7320 4e6f  nd (chunks is No
-00028400: 6e65 206f 7220 6368 756e 6b73 203d 3d20  ne or chunks == 
-00028410: 782e 6368 756e 6b73 293a 0a20 2020 2020  x.chunks):.     
-00028420: 2020 2072 6574 7572 6e20 780a 0a20 2020     return x..   
-00028430: 206e 6469 6d5f 6e65 7720 3d20 6c65 6e28   ndim_new = len(
-00028440: 7368 6170 6529 202d 2078 2e6e 6469 6d0a  shape) - x.ndim.
-00028450: 2020 2020 6966 206e 6469 6d5f 6e65 7720      if ndim_new 
-00028460: 3c20 3020 6f72 2061 6e79 280a 2020 2020  < 0 or any(.    
-00028470: 2020 2020 6e65 7720 213d 206f 6c64 2066      new != old f
-00028480: 6f72 206e 6577 2c20 6f6c 6420 696e 207a  or new, old in z
-00028490: 6970 2873 6861 7065 5b6e 6469 6d5f 6e65  ip(shape[ndim_ne
-000284a0: 773a 5d2c 2078 2e73 6861 7065 2920 6966  w:], x.shape) if
-000284b0: 206f 6c64 2021 3d20 310a 2020 2020 293a   old != 1.    ):
-000284c0: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
-000284d0: 616c 7565 4572 726f 7228 6622 6361 6e6e  alueError(f"cann
-000284e0: 6f74 2062 726f 6164 6361 7374 2073 6861  ot broadcast sha
-000284f0: 7065 207b 782e 7368 6170 657d 2074 6f20  pe {x.shape} to 
-00028500: 7368 6170 6520 7b73 6861 7065 7d22 290a  shape {shape}").
-00028510: 0a20 2020 2069 6620 6368 756e 6b73 2069  .    if chunks i
-00028520: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00028530: 6368 756e 6b73 203d 2074 7570 6c65 2828  chunks = tuple((
-00028540: 732c 2920 666f 7220 7320 696e 2073 6861  s,) for s in sha
-00028550: 7065 5b3a 6e64 696d 5f6e 6577 5d29 202b  pe[:ndim_new]) +
-00028560: 2074 7570 6c65 280a 2020 2020 2020 2020   tuple(.        
-00028570: 2020 2020 6264 2069 6620 6f6c 6420 3e20      bd if old > 
-00028580: 3120 656c 7365 2028 6e65 772c 290a 2020  1 else (new,).  
-00028590: 2020 2020 2020 2020 2020 666f 7220 6264            for bd
-000285a0: 2c20 6f6c 642c 206e 6577 2069 6e20 7a69  , old, new in zi
-000285b0: 7028 782e 6368 756e 6b73 2c20 782e 7368  p(x.chunks, x.sh
-000285c0: 6170 652c 2073 6861 7065 5b6e 6469 6d5f  ape, shape[ndim_
-000285d0: 6e65 773a 5d29 0a20 2020 2020 2020 2029  new:]).        )
-000285e0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-000285f0: 2020 2063 6875 6e6b 7320 3d20 6e6f 726d     chunks = norm
-00028600: 616c 697a 655f 6368 756e 6b73 280a 2020  alize_chunks(.  
-00028610: 2020 2020 2020 2020 2020 6368 756e 6b73            chunks
-00028620: 2c20 7368 6170 652c 2064 7479 7065 3d78  , shape, dtype=x
-00028630: 2e64 7479 7065 2c20 7072 6576 696f 7573  .dtype, previous
-00028640: 5f63 6875 6e6b 733d 782e 6368 756e 6b73  _chunks=x.chunks
-00028650: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00028660: 2020 2066 6f72 206f 6c64 5f62 642c 206e     for old_bd, n
-00028670: 6577 5f62 6420 696e 207a 6970 2878 2e63  ew_bd in zip(x.c
-00028680: 6875 6e6b 732c 2063 6875 6e6b 735b 6e64  hunks, chunks[nd
-00028690: 696d 5f6e 6577 3a5d 293a 0a20 2020 2020  im_new:]):.     
-000286a0: 2020 2020 2020 2069 6620 6f6c 645f 6264         if old_bd
-000286b0: 2021 3d20 6e65 775f 6264 2061 6e64 206f   != new_bd and o
-000286c0: 6c64 5f62 6420 213d 2028 312c 293a 0a20  ld_bd != (1,):. 
-000286d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000286e0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000286f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028700: 2020 2020 2022 6361 6e6e 6f74 2062 726f       "cannot bro
-00028710: 6164 6361 7374 2063 6875 6e6b 7320 2573  adcast chunks %s
-00028720: 2074 6f20 6368 756e 6b73 2025 733a 2022   to chunks %s: "
-00028730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028740: 2020 2020 2022 6e65 7720 6368 756e 6b73       "new chunks
-00028750: 206d 7573 7420 6569 7468 6572 2062 6520   must either be 
-00028760: 616c 6f6e 6720 6120 6e65 7720 220a 2020  along a new ".  
-00028770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028780: 2020 2264 696d 656e 7369 6f6e 206f 7220    "dimension or 
-00028790: 6120 6469 6d65 6e73 696f 6e20 6f66 2073  a dimension of s
-000287a0: 697a 6520 3122 2025 2028 782e 6368 756e  ize 1" % (x.chun
-000287b0: 6b73 2c20 6368 756e 6b73 290a 2020 2020  ks, chunks).    
-000287c0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-000287d0: 2020 206e 616d 6520 3d20 2262 726f 6164     name = "broad
-000287e0: 6361 7374 5f74 6f2d 2220 2b20 746f 6b65  cast_to-" + toke
-000287f0: 6e69 7a65 2878 2c20 7368 6170 652c 2063  nize(x, shape, c
-00028800: 6875 6e6b 7329 0a20 2020 2064 736b 203d  hunks).    dsk =
-00028810: 207b 7d0a 0a20 2020 2065 6e75 6d65 7261   {}..    enumera
-00028820: 7465 645f 6368 756e 6b73 203d 2070 726f  ted_chunks = pro
-00028830: 6475 6374 282a 2865 6e75 6d65 7261 7465  duct(*(enumerate
-00028840: 2862 6473 2920 666f 7220 6264 7320 696e  (bds) for bds in
-00028850: 2063 6875 6e6b 7329 290a 2020 2020 666f   chunks)).    fo
-00028860: 7220 6e65 775f 696e 6465 782c 2063 6875  r new_index, chu
-00028870: 6e6b 5f73 6861 7065 2069 6e20 287a 6970  nk_shape in (zip
-00028880: 282a 6563 2920 666f 7220 6563 2069 6e20  (*ec) for ec in 
-00028890: 656e 756d 6572 6174 6564 5f63 6875 6e6b  enumerated_chunk
-000288a0: 7329 3a0a 2020 2020 2020 2020 6f6c 645f  s):.        old_
-000288b0: 696e 6465 7820 3d20 7475 706c 6528 0a20  index = tuple(. 
-000288c0: 2020 2020 2020 2020 2020 2030 2069 6620             0 if 
-000288d0: 6264 203d 3d20 2831 2c29 2065 6c73 6520  bd == (1,) else 
-000288e0: 6920 666f 7220 6264 2c20 6920 696e 207a  i for bd, i in z
-000288f0: 6970 2878 2e63 6875 6e6b 732c 206e 6577  ip(x.chunks, new
-00028900: 5f69 6e64 6578 5b6e 6469 6d5f 6e65 773a  _index[ndim_new:
-00028910: 5d29 0a20 2020 2020 2020 2029 0a20 2020  ]).        ).   
-00028920: 2020 2020 206f 6c64 5f6b 6579 203d 2028       old_key = (
-00028930: 782e 6e61 6d65 2c29 202b 206f 6c64 5f69  x.name,) + old_i
-00028940: 6e64 6578 0a20 2020 2020 2020 206e 6577  ndex.        new
-00028950: 5f6b 6579 203d 2028 6e61 6d65 2c29 202b  _key = (name,) +
-00028960: 206e 6577 5f69 6e64 6578 0a20 2020 2020   new_index.     
-00028970: 2020 2064 736b 5b6e 6577 5f6b 6579 5d20     dsk[new_key] 
-00028980: 3d20 286e 702e 6272 6f61 6463 6173 745f  = (np.broadcast_
-00028990: 746f 2c20 6f6c 645f 6b65 792c 2071 756f  to, old_key, quo
-000289a0: 7465 2863 6875 6e6b 5f73 6861 7065 2929  te(chunk_shape))
-000289b0: 0a0a 2020 2020 6772 6170 6820 3d20 4869  ..    graph = Hi
-000289c0: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-000289d0: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
-000289e0: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
-000289f0: 6e63 6965 733d 5b78 5d29 0a20 2020 2072  ncies=[x]).    r
-00028a00: 6574 7572 6e20 4172 7261 7928 6772 6170  eturn Array(grap
-00028a10: 682c 206e 616d 652c 2063 6875 6e6b 732c  h, name, chunks,
-00028a20: 2064 7479 7065 3d78 2e64 7479 7065 2c20   dtype=x.dtype, 
-00028a30: 6d65 7461 3d6d 6574 6129 0a0a 0a40 6465  meta=meta)...@de
-00028a40: 7269 7665 645f 6672 6f6d 286e 7029 0a64  rived_from(np).d
-00028a50: 6566 2062 726f 6164 6361 7374 5f61 7272  ef broadcast_arr
-00028a60: 6179 7328 2a61 7267 732c 2073 7562 6f6b  ays(*args, subok
-00028a70: 3d46 616c 7365 293a 0a20 2020 2073 7562  =False):.    sub
-00028a80: 6f6b 203d 2062 6f6f 6c28 7375 626f 6b29  ok = bool(subok)
-00028a90: 0a0a 2020 2020 746f 5f61 7272 6179 203d  ..    to_array =
-00028aa0: 2061 7361 6e79 6172 7261 7920 6966 2073   asanyarray if s
-00028ab0: 7562 6f6b 2065 6c73 6520 6173 6172 7261  ubok else asarra
-00028ac0: 790a 2020 2020 6172 6773 203d 2074 7570  y.    args = tup
-00028ad0: 6c65 2874 6f5f 6172 7261 7928 6529 2066  le(to_array(e) f
-00028ae0: 6f72 2065 2069 6e20 6172 6773 290a 0a20  or e in args).. 
-00028af0: 2020 2023 2055 6e69 6679 2075 6e65 7665     # Unify uneve
-00028b00: 6e20 6368 756e 6b69 6e67 0a20 2020 2069  n chunking.    i
-00028b10: 6e64 7320 3d20 5b6c 6973 7428 7265 7665  nds = [list(reve
-00028b20: 7273 6564 2872 616e 6765 2878 2e6e 6469  rsed(range(x.ndi
-00028b30: 6d29 2929 2066 6f72 2078 2069 6e20 6172  m))) for x in ar
-00028b40: 6773 5d0a 2020 2020 7563 5f61 7267 7320  gs].    uc_args 
-00028b50: 3d20 636f 6e63 6174 287a 6970 2861 7267  = concat(zip(arg
-00028b60: 732c 2069 6e64 7329 290a 2020 2020 5f2c  s, inds)).    _,
-00028b70: 2061 7267 7320 3d20 756e 6966 795f 6368   args = unify_ch
-00028b80: 756e 6b73 282a 7563 5f61 7267 732c 2077  unks(*uc_args, w
-00028b90: 6172 6e3d 4661 6c73 6529 0a0a 2020 2020  arn=False)..    
-00028ba0: 7368 6170 6520 3d20 6272 6f61 6463 6173  shape = broadcas
-00028bb0: 745f 7368 6170 6573 282a 2865 2e73 6861  t_shapes(*(e.sha
-00028bc0: 7065 2066 6f72 2065 2069 6e20 6172 6773  pe for e in args
-00028bd0: 2929 0a20 2020 2063 6875 6e6b 7320 3d20  )).    chunks = 
-00028be0: 6272 6f61 6463 6173 745f 6368 756e 6b73  broadcast_chunks
-00028bf0: 282a 2865 2e63 6875 6e6b 7320 666f 7220  (*(e.chunks for 
-00028c00: 6520 696e 2061 7267 7329 290a 0a20 2020  e in args))..   
-00028c10: 2072 6573 756c 7420 3d20 5b62 726f 6164   result = [broad
-00028c20: 6361 7374 5f74 6f28 652c 2073 6861 7065  cast_to(e, shape
-00028c30: 3d73 6861 7065 2c20 6368 756e 6b73 3d63  =shape, chunks=c
-00028c40: 6875 6e6b 7329 2066 6f72 2065 2069 6e20  hunks) for e in 
-00028c50: 6172 6773 5d0a 0a20 2020 2072 6574 7572  args]..    retur
-00028c60: 6e20 7265 7375 6c74 0a0a 0a64 6566 206f  n result...def o
-00028c70: 6666 7365 745f 6675 6e63 2866 756e 632c  ffset_func(func,
-00028c80: 206f 6666 7365 742c 202a 6172 6773 293a   offset, *args):
-00028c90: 0a20 2020 2022 2222 4f66 6673 6574 7320  .    """Offsets 
-00028ca0: 696e 7075 7473 2062 7920 6f66 6673 6574  inputs by offset
-00028cb0: 0a0a 2020 2020 3e3e 3e20 646f 7562 6c65  ..    >>> double
-00028cc0: 203d 206c 616d 6264 6120 783a 2078 202a   = lambda x: x *
-00028cd0: 2032 0a20 2020 203e 3e3e 2066 203d 206f   2.    >>> f = o
-00028ce0: 6666 7365 745f 6675 6e63 2864 6f75 626c  ffset_func(doubl
-00028cf0: 652c 2028 3130 2c29 290a 2020 2020 3e3e  e, (10,)).    >>
-00028d00: 3e20 6628 3129 0a20 2020 2032 320a 2020  > f(1).    22.  
-00028d10: 2020 3e3e 3e20 6628 3330 3029 0a20 2020    >>> f(300).   
-00028d20: 2036 3230 0a20 2020 2022 2222 0a0a 2020   620.    """..  
-00028d30: 2020 6465 6620 5f6f 6666 7365 7428 2a61    def _offset(*a
-00028d40: 7267 7329 3a0a 2020 2020 2020 2020 6172  rgs):.        ar
-00028d50: 6773 3220 3d20 6c69 7374 286d 6170 2861  gs2 = list(map(a
-00028d60: 6464 2c20 6172 6773 2c20 6f66 6673 6574  dd, args, offset
-00028d70: 2929 0a20 2020 2020 2020 2072 6574 7572  )).        retur
-00028d80: 6e20 6675 6e63 282a 6172 6773 3229 0a0a  n func(*args2)..
-00028d90: 2020 2020 7769 7468 2063 6f6e 7465 7874      with context
-00028da0: 6c69 622e 7375 7070 7265 7373 2845 7863  lib.suppress(Exc
-00028db0: 6570 7469 6f6e 293a 0a20 2020 2020 2020  eption):.       
-00028dc0: 205f 6f66 6673 6574 2e5f 5f6e 616d 655f   _offset.__name_
-00028dd0: 5f20 3d20 226f 6666 7365 745f 2220 2b20  _ = "offset_" + 
-00028de0: 6675 6e63 2e5f 5f6e 616d 655f 5f0a 0a20  func.__name__.. 
-00028df0: 2020 2072 6574 7572 6e20 5f6f 6666 7365     return _offse
-00028e00: 740a 0a0a 6465 6620 6368 756e 6b73 5f66  t...def chunks_f
-00028e10: 726f 6d5f 6172 7261 7973 2861 7272 6179  rom_arrays(array
-00028e20: 7329 3a0a 2020 2020 2222 2243 6875 6e6b  s):.    """Chunk
-00028e30: 7320 7475 706c 6520 6672 6f6d 206e 6573  s tuple from nes
-00028e40: 7465 6420 6c69 7374 206f 6620 6172 7261  ted list of arra
-00028e50: 7973 0a0a 2020 2020 3e3e 3e20 7820 3d20  ys..    >>> x = 
-00028e60: 6e70 2e61 7272 6179 285b 312c 2032 5d29  np.array([1, 2])
-00028e70: 0a20 2020 203e 3e3e 2063 6875 6e6b 735f  .    >>> chunks_
-00028e80: 6672 6f6d 5f61 7272 6179 7328 5b78 2c20  from_arrays([x, 
-00028e90: 785d 290a 2020 2020 2828 322c 2032 292c  x]).    ((2, 2),
-00028ea0: 290a 0a20 2020 203e 3e3e 2078 203d 206e  )..    >>> x = n
-00028eb0: 702e 6172 7261 7928 5b5b 312c 2032 5d5d  p.array([[1, 2]]
-00028ec0: 290a 2020 2020 3e3e 3e20 6368 756e 6b73  ).    >>> chunks
-00028ed0: 5f66 726f 6d5f 6172 7261 7973 285b 5b78  _from_arrays([[x
-00028ee0: 5d2c 205b 785d 5d29 0a20 2020 2028 2831  ], [x]]).    ((1
-00028ef0: 2c20 3129 2c20 2832 2c29 290a 0a20 2020  , 1), (2,))..   
-00028f00: 203e 3e3e 2078 203d 206e 702e 6172 7261   >>> x = np.arra
-00028f10: 7928 5b5b 312c 2032 5d5d 290a 2020 2020  y([[1, 2]]).    
-00028f20: 3e3e 3e20 6368 756e 6b73 5f66 726f 6d5f  >>> chunks_from_
-00028f30: 6172 7261 7973 285b 5b78 2c20 785d 5d29  arrays([[x, x]])
-00028f40: 0a20 2020 2028 2831 2c29 2c20 2832 2c20  .    ((1,), (2, 
-00028f50: 3229 290a 0a20 2020 203e 3e3e 2063 6875  2))..    >>> chu
-00028f60: 6e6b 735f 6672 6f6d 5f61 7272 6179 7328  nks_from_arrays(
-00028f70: 5b31 2c20 315d 290a 2020 2020 2828 312c  [1, 1]).    ((1,
-00028f80: 2031 292c 290a 2020 2020 2222 220a 2020   1),).    """.  
-00028f90: 2020 6966 206e 6f74 2061 7272 6179 733a    if not arrays:
-00028fa0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00028fb0: 2829 0a20 2020 2072 6573 756c 7420 3d20  ().    result = 
-00028fc0: 5b5d 0a20 2020 2064 696d 203d 2030 0a0a  [].    dim = 0..
-00028fd0: 2020 2020 6465 6620 7368 6170 6528 7829      def shape(x)
-00028fe0: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
-00028ff0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00029000: 6e20 782e 7368 6170 6520 6966 2078 2e73  n x.shape if x.s
-00029010: 6861 7065 2065 6c73 6520 2831 2c29 0a20  hape else (1,). 
-00029020: 2020 2020 2020 2065 7863 6570 7420 4174         except At
-00029030: 7472 6962 7574 6545 7272 6f72 3a0a 2020  tributeError:.  
-00029040: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00029050: 2028 312c 290a 0a20 2020 2077 6869 6c65   (1,)..    while
-00029060: 2069 7369 6e73 7461 6e63 6528 6172 7261   isinstance(arra
-00029070: 7973 2c20 286c 6973 742c 2074 7570 6c65  ys, (list, tuple
-00029080: 2929 3a0a 2020 2020 2020 2020 7265 7375  )):.        resu
-00029090: 6c74 2e61 7070 656e 6428 7475 706c 6528  lt.append(tuple(
-000290a0: 7368 6170 6528 6465 6570 6669 7273 7428  shape(deepfirst(
-000290b0: 6129 295b 6469 6d5d 2066 6f72 2061 2069  a))[dim] for a i
-000290c0: 6e20 6172 7261 7973 2929 0a20 2020 2020  n arrays)).     
-000290d0: 2020 2061 7272 6179 7320 3d20 6172 7261     arrays = arra
-000290e0: 7973 5b30 5d0a 2020 2020 2020 2020 6469  ys[0].        di
-000290f0: 6d20 2b3d 2031 0a20 2020 2072 6574 7572  m += 1.    retur
-00029100: 6e20 7475 706c 6528 7265 7375 6c74 290a  n tuple(result).
-00029110: 0a0a 6465 6620 6465 6570 6669 7273 7428  ..def deepfirst(
-00029120: 7365 7129 3a0a 2020 2020 2222 2246 6972  seq):.    """Fir
-00029130: 7374 2065 6c65 6d65 6e74 2069 6e20 6120  st element in a 
-00029140: 6e65 7374 6564 206c 6973 740a 0a20 2020  nested list..   
-00029150: 203e 3e3e 2064 6565 7066 6972 7374 285b   >>> deepfirst([
-00029160: 5b5b 312c 2032 5d2c 205b 332c 2034 5d5d  [[1, 2], [3, 4]]
-00029170: 2c20 5b35 2c20 365d 2c20 5b37 2c20 385d  , [5, 6], [7, 8]
-00029180: 5d29 0a20 2020 2031 0a20 2020 2022 2222  ]).    1.    """
-00029190: 0a20 2020 2069 6620 6e6f 7420 6973 696e  .    if not isin
-000291a0: 7374 616e 6365 2873 6571 2c20 286c 6973  stance(seq, (lis
-000291b0: 742c 2074 7570 6c65 2929 3a0a 2020 2020  t, tuple)):.    
-000291c0: 2020 2020 7265 7475 726e 2073 6571 0a20      return seq. 
-000291d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000291e0: 2072 6574 7572 6e20 6465 6570 6669 7273   return deepfirs
-000291f0: 7428 7365 715b 305d 290a 0a0a 6465 6620  t(seq[0])...def 
-00029200: 7368 6170 656c 6973 7428 6129 3a0a 2020  shapelist(a):.  
-00029210: 2020 2222 2247 6574 2074 6865 2073 6861    """Get the sha
-00029220: 7065 206f 6620 6e65 7374 6564 206c 6973  pe of nested lis
-00029230: 7422 2222 0a20 2020 2069 6620 7479 7065  t""".    if type
-00029240: 2861 2920 6973 206c 6973 743a 0a20 2020  (a) is list:.   
-00029250: 2020 2020 2072 6574 7572 6e20 7475 706c       return tupl
-00029260: 6528 5b6c 656e 2861 295d 202b 206c 6973  e([len(a)] + lis
-00029270: 7428 7368 6170 656c 6973 7428 615b 305d  t(shapelist(a[0]
-00029280: 2929 290a 2020 2020 656c 7365 3a0a 2020  ))).    else:.  
-00029290: 2020 2020 2020 7265 7475 726e 2028 290a        return ().
-000292a0: 0a0a 6465 6620 7472 616e 7370 6f73 656c  ..def transposel
-000292b0: 6973 7428 6172 7261 7973 2c20 6178 6573  ist(arrays, axes
-000292c0: 2c20 6578 7472 6164 696d 733d 3029 3a0a  , extradims=0):.
-000292d0: 2020 2020 2222 2250 6572 6d75 7465 2061      """Permute a
-000292e0: 7865 7320 6f66 206e 6573 7465 6420 6c69  xes of nested li
-000292f0: 7374 0a0a 2020 2020 3e3e 3e20 7472 616e  st..    >>> tran
-00029300: 7370 6f73 656c 6973 7428 5b5b 312c 312c  sposelist([[1,1,
-00029310: 315d 2c5b 312c 312c 315d 5d2c 205b 322c  1],[1,1,1]], [2,
-00029320: 315d 290a 2020 2020 5b5b 5b31 2c20 315d  1]).    [[[1, 1]
-00029330: 2c20 5b31 2c20 315d 2c20 5b31 2c20 315d  , [1, 1], [1, 1]
-00029340: 5d5d 0a0a 2020 2020 3e3e 3e20 7472 616e  ]]..    >>> tran
-00029350: 7370 6f73 656c 6973 7428 5b5b 312c 312c  sposelist([[1,1,
-00029360: 315d 2c5b 312c 312c 315d 5d2c 205b 322c  1],[1,1,1]], [2,
-00029370: 315d 2c20 6578 7472 6164 696d 733d 3129  1], extradims=1)
-00029380: 0a20 2020 205b 5b5b 5b31 5d2c 205b 315d  .    [[[[1], [1]
-00029390: 5d2c 205b 5b31 5d2c 205b 315d 5d2c 205b  ], [[1], [1]], [
-000293a0: 5b31 5d2c 205b 315d 5d5d 5d0a 2020 2020  [1], [1]]]].    
-000293b0: 2222 220a 2020 2020 6966 206c 656e 2861  """.    if len(a
-000293c0: 7865 7329 2021 3d20 6e64 696d 6c69 7374  xes) != ndimlist
-000293d0: 2861 7272 6179 7329 3a0a 2020 2020 2020  (arrays):.      
-000293e0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000293f0: 6f72 2822 4c65 6e67 7468 206f 6620 6178  or("Length of ax
-00029400: 6573 2073 686f 756c 6420 6571 7561 6c20  es should equal 
-00029410: 6465 7074 6820 6f66 206e 6573 7465 6420  depth of nested 
-00029420: 6172 7261 7973 2229 0a20 2020 2069 6620  arrays").    if 
-00029430: 6578 7472 6164 696d 7320 3c20 303a 0a20  extradims < 0:. 
-00029440: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00029450: 7565 4572 726f 7228 2260 6e65 7764 696d  ueError("`newdim
-00029460: 7360 2073 686f 756c 6420 6265 2070 6f73  s` should be pos
-00029470: 6974 6976 6522 290a 2020 2020 6966 206c  itive").    if l
-00029480: 656e 2861 7865 7329 203e 206c 656e 2873  en(axes) > len(s
-00029490: 6574 2861 7865 7329 293a 0a20 2020 2020  et(axes)):.     
-000294a0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000294b0: 726f 7228 2260 6178 6573 6020 7368 6f75  ror("`axes` shou
-000294c0: 6c64 2062 6520 756e 6971 7565 2229 0a0a  ld be unique")..
-000294d0: 2020 2020 6e64 696d 203d 206d 6178 2861      ndim = max(a
-000294e0: 7865 7329 202b 2031 0a20 2020 2073 6861  xes) + 1.    sha
-000294f0: 7065 203d 2073 6861 7065 6c69 7374 2861  pe = shapelist(a
-00029500: 7272 6179 7329 0a20 2020 206e 6577 7368  rrays).    newsh
-00029510: 6170 6520 3d20 5b0a 2020 2020 2020 2020  ape = [.        
-00029520: 7368 6170 655b 6178 6573 2e69 6e64 6578  shape[axes.index
-00029530: 2869 295d 2069 6620 6920 696e 2061 7865  (i)] if i in axe
-00029540: 7320 656c 7365 2031 2066 6f72 2069 2069  s else 1 for i i
-00029550: 6e20 7261 6e67 6528 6e64 696d 202b 2065  n range(ndim + e
-00029560: 7874 7261 6469 6d73 290a 2020 2020 5d0a  xtradims).    ].
-00029570: 0a20 2020 2072 6573 756c 7420 3d20 6c69  .    result = li
-00029580: 7374 2863 6f72 652e 666c 6174 7465 6e28  st(core.flatten(
-00029590: 6172 7261 7973 2929 0a20 2020 2072 6574  arrays)).    ret
-000295a0: 7572 6e20 7265 7368 6170 656c 6973 7428  urn reshapelist(
-000295b0: 6e65 7773 6861 7065 2c20 7265 7375 6c74  newshape, result
-000295c0: 290a 0a0a 6465 6620 7374 6163 6b28 7365  )...def stack(se
-000295d0: 712c 2061 7869 733d 302c 2061 6c6c 6f77  q, axis=0, allow
-000295e0: 5f75 6e6b 6e6f 776e 5f63 6875 6e6b 7369  _unknown_chunksi
-000295f0: 7a65 733d 4661 6c73 6529 3a0a 2020 2020  zes=False):.    
-00029600: 2222 220a 2020 2020 5374 6163 6b20 6172  """.    Stack ar
-00029610: 7261 7973 2061 6c6f 6e67 2061 206e 6577  rays along a new
-00029620: 2061 7869 730a 0a20 2020 2047 6976 656e   axis..    Given
-00029630: 2061 2073 6571 7565 6e63 6520 6f66 2064   a sequence of d
-00029640: 6173 6b20 6172 7261 7973 2c20 666f 726d  ask arrays, form
-00029650: 2061 206e 6577 2064 6173 6b20 6172 7261   a new dask arra
-00029660: 7920 6279 2073 7461 636b 696e 6720 7468  y by stacking th
-00029670: 656d 0a20 2020 2061 6c6f 6e67 2061 206e  em.    along a n
-00029680: 6577 2064 696d 656e 7369 6f6e 2028 6178  ew dimension (ax
-00029690: 6973 3d30 2062 7920 6465 6661 756c 7429  is=0 by default)
-000296a0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-000296b0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-000296c0: 2020 2020 7365 713a 206c 6973 7420 6f66      seq: list of
-000296d0: 2064 6173 6b2e 6172 7261 7973 0a20 2020   dask.arrays.   
-000296e0: 2061 7869 733a 2069 6e74 0a20 2020 2020   axis: int.     
-000296f0: 2020 2044 696d 656e 7369 6f6e 2061 6c6f     Dimension alo
-00029700: 6e67 2077 6869 6368 2074 6f20 616c 6967  ng which to alig
-00029710: 6e20 616c 6c20 6f66 2074 6865 2061 7272  n all of the arr
-00029720: 6179 730a 2020 2020 616c 6c6f 775f 756e  ays.    allow_un
-00029730: 6b6e 6f77 6e5f 6368 756e 6b73 697a 6573  known_chunksizes
-00029740: 3a20 626f 6f6c 0a20 2020 2020 2020 2041  : bool.        A
-00029750: 6c6c 6f77 2075 6e6b 6e6f 776e 2063 6875  llow unknown chu
-00029760: 6e6b 7369 7a65 732c 2073 7563 6820 6173  nksizes, such as
-00029770: 2063 6f6d 6520 6672 6f6d 2063 6f6e 7665   come from conve
-00029780: 7274 696e 6720 6672 6f6d 2064 6173 6b0a  rting from dask.
-00029790: 2020 2020 2020 2020 6461 7461 6672 616d          datafram
-000297a0: 6573 2e20 2044 6173 6b2e 6172 7261 7920  es.  Dask.array 
-000297b0: 6973 2075 6e61 626c 6520 746f 2076 6572  is unable to ver
-000297c0: 6966 7920 7468 6174 2063 6875 6e6b 7320  ify that chunks 
-000297d0: 6c69 6e65 2075 702e 2020 4966 0a20 2020  line up.  If.   
-000297e0: 2020 2020 2064 6174 6120 636f 6d65 7320       data comes 
-000297f0: 6672 6f6d 2064 6966 6665 7265 6e74 6c79  from differently
-00029800: 2061 6c69 676e 6564 2073 6f75 7263 6573   aligned sources
-00029810: 2074 6865 6e20 7468 6973 2063 616e 2063   then this can c
-00029820: 6175 7365 0a20 2020 2020 2020 2075 6e65  ause.        une
-00029830: 7870 6563 7465 6420 7265 7375 6c74 732e  xpected results.
-00029840: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
-00029850: 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20 2020     --------..   
-00029860: 2043 7265 6174 6520 736c 6963 6573 0a0a   Create slices..
-00029870: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-00029880: 6173 6b2e 6172 7261 7920 6173 2064 610a  ask.array as da.
-00029890: 2020 2020 3e3e 3e20 696d 706f 7274 206e      >>> import n
-000298a0: 756d 7079 2061 7320 6e70 0a0a 2020 2020  umpy as np..    
-000298b0: 3e3e 3e20 6461 7461 203d 205b 6461 2e66  >>> data = [da.f
-000298c0: 726f 6d5f 6172 7261 7928 6e70 2e6f 6e65  rom_array(np.one
-000298d0: 7328 2834 2c20 3429 292c 2063 6875 6e6b  s((4, 4)), chunk
-000298e0: 733d 2832 2c20 3229 290a 2020 2020 2e2e  s=(2, 2)).    ..
-000298f0: 2e20 2020 2020 2020 2020 666f 7220 6920  .         for i 
-00029900: 696e 2072 616e 6765 2833 295d 0a0a 2020  in range(3)]..  
-00029910: 2020 3e3e 3e20 7820 3d20 6461 2e73 7461    >>> x = da.sta
-00029920: 636b 2864 6174 612c 2061 7869 733d 3029  ck(data, axis=0)
-00029930: 0a20 2020 203e 3e3e 2078 2e73 6861 7065  .    >>> x.shape
-00029940: 0a20 2020 2028 332c 2034 2c20 3429 0a0a  .    (3, 4, 4)..
-00029950: 2020 2020 3e3e 3e20 6461 2e73 7461 636b      >>> da.stack
-00029960: 2864 6174 612c 2061 7869 733d 3129 2e73  (data, axis=1).s
-00029970: 6861 7065 0a20 2020 2028 342c 2033 2c20  hape.    (4, 3, 
-00029980: 3429 0a0a 2020 2020 3e3e 3e20 6461 2e73  4)..    >>> da.s
-00029990: 7461 636b 2864 6174 612c 2061 7869 733d  tack(data, axis=
-000299a0: 2d31 292e 7368 6170 650a 2020 2020 2834  -1).shape.    (4
-000299b0: 2c20 342c 2033 290a 0a20 2020 2052 6573  , 4, 3)..    Res
-000299c0: 756c 7420 6973 2061 206e 6577 2064 6173  ult is a new das
-000299d0: 6b20 4172 7261 790a 0a20 2020 2053 6565  k Array..    See
-000299e0: 2041 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d   Also.    ------
-000299f0: 2d2d 0a20 2020 2063 6f6e 6361 7465 6e61  --.    concatena
-00029a00: 7465 0a20 2020 2022 2222 0a20 2020 2066  te.    """.    f
-00029a10: 726f 6d20 6461 736b 2e61 7272 6179 2069  rom dask.array i
-00029a20: 6d70 6f72 7420 7772 6170 0a0a 2020 2020  mport wrap..    
-00029a30: 7365 7120 3d20 5b61 7361 7272 6179 2861  seq = [asarray(a
-00029a40: 2c20 616c 6c6f 775f 756e 6b6e 6f77 6e5f  , allow_unknown_
-00029a50: 6368 756e 6b73 697a 6573 3d61 6c6c 6f77  chunksizes=allow
-00029a60: 5f75 6e6b 6e6f 776e 5f63 6875 6e6b 7369  _unknown_chunksi
-00029a70: 7a65 7329 2066 6f72 2061 2069 6e20 7365  zes) for a in se
-00029a80: 715d 0a0a 2020 2020 6966 206e 6f74 2073  q]..    if not s
-00029a90: 6571 3a0a 2020 2020 2020 2020 7261 6973  eq:.        rais
-00029aa0: 6520 5661 6c75 6545 7272 6f72 2822 4e65  e ValueError("Ne
-00029ab0: 6564 2061 7272 6179 2873 2920 746f 2073  ed array(s) to s
-00029ac0: 7461 636b 2229 0a20 2020 2069 6620 6e6f  tack").    if no
-00029ad0: 7420 616c 6c6f 775f 756e 6b6e 6f77 6e5f  t allow_unknown_
-00029ae0: 6368 756e 6b73 697a 6573 2061 6e64 206e  chunksizes and n
-00029af0: 6f74 2061 6c6c 2878 2e73 6861 7065 203d  ot all(x.shape =
-00029b00: 3d20 7365 715b 305d 2e73 6861 7065 2066  = seq[0].shape f
-00029b10: 6f72 2078 2069 6e20 7365 7129 3a0a 2020  or x in seq):.  
-00029b20: 2020 2020 2020 6964 7820 3d20 6669 7273        idx = firs
-00029b30: 7428 6920 666f 7220 6920 696e 2065 6e75  t(i for i in enu
-00029b40: 6d65 7261 7465 2873 6571 2920 6966 2069  merate(seq) if i
-00029b50: 5b31 5d2e 7368 6170 6520 213d 2073 6571  [1].shape != seq
-00029b60: 5b30 5d2e 7368 6170 6529 0a20 2020 2020  [0].shape).     
-00029b70: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00029b80: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00029b90: 2022 5374 6163 6b65 6420 6172 7261 7973   "Stacked arrays
-00029ba0: 206d 7573 7420 6861 7665 2074 6865 2073   must have the s
-00029bb0: 616d 6520 7368 6170 652e 2054 6865 2066  ame shape. The f
-00029bc0: 6972 7374 2061 7272 6179 2068 6164 2073  irst array had s
-00029bd0: 6861 7065 2022 0a20 2020 2020 2020 2020  hape ".         
-00029be0: 2020 2066 227b 7365 715b 305d 2e73 6861     f"{seq[0].sha
-00029bf0: 7065 7d2c 2077 6869 6c65 2061 7272 6179  pe}, while array
-00029c00: 207b 6964 785b 305d 202b 2031 7d20 6861   {idx[0] + 1} ha
-00029c10: 7320 7368 6170 6520 7b69 6478 5b31 5d2e  s shape {idx[1].
-00029c20: 7368 6170 657d 2e22 0a20 2020 2020 2020  shape}.".       
-00029c30: 2029 0a0a 2020 2020 6d65 7461 203d 206e   )..    meta = n
-00029c40: 702e 7374 6163 6b28 5b6d 6574 615f 6672  p.stack([meta_fr
-00029c50: 6f6d 5f61 7272 6179 2861 2920 666f 7220  om_array(a) for 
-00029c60: 6120 696e 2073 6571 5d2c 2061 7869 733d  a in seq], axis=
-00029c70: 6178 6973 290a 2020 2020 7365 7120 3d20  axis).    seq = 
-00029c80: 5b78 2e61 7374 7970 6528 6d65 7461 2e64  [x.astype(meta.d
-00029c90: 7479 7065 2920 666f 7220 7820 696e 2073  type) for x in s
-00029ca0: 6571 5d0a 0a20 2020 206e 6469 6d20 3d20  eq]..    ndim = 
-00029cb0: 6d65 7461 2e6e 6469 6d20 2d20 310a 2020  meta.ndim - 1.  
-00029cc0: 2020 6966 2061 7869 7320 3c20 303a 0a20    if axis < 0:. 
-00029cd0: 2020 2020 2020 2061 7869 7320 3d20 6e64         axis = nd
-00029ce0: 696d 202b 2061 7869 7320 2b20 310a 2020  im + axis + 1.  
-00029cf0: 2020 7368 6170 6520 3d20 7475 706c 6528    shape = tuple(
-00029d00: 0a20 2020 2020 2020 206c 656e 2873 6571  .        len(seq
-00029d10: 290a 2020 2020 2020 2020 6966 2069 203d  ).        if i =
-00029d20: 3d20 6178 6973 0a20 2020 2020 2020 2065  = axis.        e
-00029d30: 6c73 6520 2873 6571 5b30 5d2e 7368 6170  lse (seq[0].shap
-00029d40: 655b 695d 2069 6620 6920 3c20 6178 6973  e[i] if i < axis
-00029d50: 2065 6c73 6520 7365 715b 305d 2e73 6861   else seq[0].sha
-00029d60: 7065 5b69 202d 2031 5d29 0a20 2020 2020  pe[i - 1]).     
-00029d70: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-00029d80: 6528 6d65 7461 2e6e 6469 6d29 0a20 2020  e(meta.ndim).   
-00029d90: 2029 0a0a 2020 2020 7365 7132 203d 205b   )..    seq2 = [
-00029da0: 6120 666f 7220 6120 696e 2073 6571 2069  a for a in seq i
-00029db0: 6620 612e 7369 7a65 5d0a 2020 2020 6966  f a.size].    if
-00029dc0: 206e 6f74 2073 6571 323a 0a20 2020 2020   not seq2:.     
-00029dd0: 2020 2073 6571 3220 3d20 7365 710a 0a20     seq2 = seq.. 
-00029de0: 2020 206e 203d 206c 656e 2873 6571 3229     n = len(seq2)
-00029df0: 0a20 2020 2069 6620 6e20 3d3d 2030 3a0a  .    if n == 0:.
-00029e00: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00029e10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00029e20: 7772 6170 2e65 6d70 7479 5f6c 696b 6528  wrap.empty_like(
-00029e30: 6d65 7461 2c20 7368 6170 653d 7368 6170  meta, shape=shap
-00029e40: 652c 2063 6875 6e6b 733d 7368 6170 652c  e, chunks=shape,
-00029e50: 2064 7479 7065 3d6d 6574 612e 6474 7970   dtype=meta.dtyp
-00029e60: 6529 0a20 2020 2020 2020 2065 7863 6570  e).        excep
-00029e70: 7420 5479 7065 4572 726f 723a 0a20 2020  t TypeError:.   
-00029e80: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00029e90: 7772 6170 2e65 6d70 7479 2873 6861 7065  wrap.empty(shape
-00029ea0: 2c20 6368 756e 6b73 3d73 6861 7065 2c20  , chunks=shape, 
-00029eb0: 6474 7970 653d 6d65 7461 2e64 7479 7065  dtype=meta.dtype
-00029ec0: 290a 0a20 2020 2069 6e64 203d 206c 6973  )..    ind = lis
-00029ed0: 7428 7261 6e67 6528 6e64 696d 2929 0a20  t(range(ndim)). 
-00029ee0: 2020 2075 635f 6172 6773 203d 206c 6973     uc_args = lis
-00029ef0: 7428 636f 6e63 6174 2828 782c 2069 6e64  t(concat((x, ind
-00029f00: 2920 666f 7220 7820 696e 2073 6571 3229  ) for x in seq2)
-00029f10: 290a 2020 2020 5f2c 2073 6571 3220 3d20  ).    _, seq2 = 
-00029f20: 756e 6966 795f 6368 756e 6b73 282a 7563  unify_chunks(*uc
-00029f30: 5f61 7267 7329 0a0a 2020 2020 6173 7365  _args)..    asse
-00029f40: 7274 206c 656e 287b 612e 6368 756e 6b73  rt len({a.chunks
-00029f50: 2066 6f72 2061 2069 6e20 7365 7132 7d29   for a in seq2})
-00029f60: 203d 3d20 3120 2023 2073 616d 6520 6368   == 1  # same ch
-00029f70: 756e 6b73 0a20 2020 2063 6875 6e6b 7320  unks.    chunks 
-00029f80: 3d20 7365 7132 5b30 5d2e 6368 756e 6b73  = seq2[0].chunks
-00029f90: 5b3a 6178 6973 5d20 2b20 2828 312c 2920  [:axis] + ((1,) 
-00029fa0: 2a20 6e2c 2920 2b20 7365 7132 5b30 5d2e  * n,) + seq2[0].
-00029fb0: 6368 756e 6b73 5b61 7869 733a 5d0a 0a20  chunks[axis:].. 
-00029fc0: 2020 206e 616d 6573 203d 205b 612e 6e61     names = [a.na
-00029fd0: 6d65 2066 6f72 2061 2069 6e20 7365 7132  me for a in seq2
-00029fe0: 5d0a 2020 2020 6e61 6d65 203d 2022 7374  ].    name = "st
-00029ff0: 6163 6b2d 2220 2b20 746f 6b65 6e69 7a65  ack-" + tokenize
-0002a000: 286e 616d 6573 2c20 6178 6973 290a 2020  (names, axis).  
-0002a010: 2020 6b65 7973 203d 206c 6973 7428 7072    keys = list(pr
-0002a020: 6f64 7563 7428 5b6e 616d 655d 2c20 2a5b  oduct([name], *[
-0002a030: 7261 6e67 6528 6c65 6e28 6264 2929 2066  range(len(bd)) f
-0002a040: 6f72 2062 6420 696e 2063 6875 6e6b 735d  or bd in chunks]
-0002a050: 2929 0a0a 2020 2020 696e 7075 7473 203d  ))..    inputs =
-0002a060: 205b 0a20 2020 2020 2020 2028 6e61 6d65   [.        (name
-0002a070: 735b 6b65 795b 6178 6973 202b 2031 5d5d  s[key[axis + 1]]
-0002a080: 2c29 202b 206b 6579 5b31 203a 2061 7869  ,) + key[1 : axi
-0002a090: 7320 2b20 315d 202b 206b 6579 5b61 7869  s + 1] + key[axi
-0002a0a0: 7320 2b20 3220 3a5d 2066 6f72 206b 6579  s + 2 :] for key
-0002a0b0: 2069 6e20 6b65 7973 0a20 2020 205d 0a20   in keys.    ]. 
-0002a0c0: 2020 2076 616c 7565 7320 3d20 5b0a 2020     values = [.  
-0002a0d0: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-0002a0e0: 2020 2020 6765 7469 7465 6d2c 0a20 2020      getitem,.   
-0002a0f0: 2020 2020 2020 2020 2069 6e70 2c0a 2020           inp,.  
-0002a100: 2020 2020 2020 2020 2020 2873 6c69 6365            (slice
-0002a110: 284e 6f6e 652c 204e 6f6e 652c 204e 6f6e  (None, None, Non
-0002a120: 6529 2c29 202a 2061 7869 730a 2020 2020  e),) * axis.    
-0002a130: 2020 2020 2020 2020 2b20 284e 6f6e 652c          + (None,
-0002a140: 290a 2020 2020 2020 2020 2020 2020 2b20  ).            + 
-0002a150: 2873 6c69 6365 284e 6f6e 652c 204e 6f6e  (slice(None, Non
-0002a160: 652c 204e 6f6e 6529 2c29 202a 2028 6e64  e, None),) * (nd
-0002a170: 696d 202d 2061 7869 7329 2c0a 2020 2020  im - axis),.    
-0002a180: 2020 2020 290a 2020 2020 2020 2020 666f      ).        fo
-0002a190: 7220 696e 7020 696e 2069 6e70 7574 730a  r inp in inputs.
-0002a1a0: 2020 2020 5d0a 0a20 2020 206c 6179 6572      ]..    layer
-0002a1b0: 203d 2064 6963 7428 7a69 7028 6b65 7973   = dict(zip(keys
-0002a1c0: 2c20 7661 6c75 6573 2929 0a20 2020 2067  , values)).    g
-0002a1d0: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-0002a1e0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-0002a1f0: 6374 696f 6e73 286e 616d 652c 206c 6179  ctions(name, lay
-0002a200: 6572 2c20 6465 7065 6e64 656e 6369 6573  er, dependencies
-0002a210: 3d73 6571 3229 0a0a 2020 2020 7265 7475  =seq2)..    retu
-0002a220: 726e 2041 7272 6179 2867 7261 7068 2c20  rn Array(graph, 
-0002a230: 6e61 6d65 2c20 6368 756e 6b73 2c20 6d65  name, chunks, me
-0002a240: 7461 3d6d 6574 6129 0a0a 0a64 6566 2063  ta=meta)...def c
-0002a250: 6f6e 6361 7465 6e61 7465 3328 6172 7261  oncatenate3(arra
-0002a260: 7973 293a 0a20 2020 2022 2222 5265 6375  ys):.    """Recu
-0002a270: 7273 6976 6520 6e70 2e63 6f6e 6361 7465  rsive np.concate
-0002a280: 6e61 7465 0a0a 2020 2020 496e 7075 7420  nate..    Input 
-0002a290: 7368 6f75 6c64 2062 6520 6120 6e65 7374  should be a nest
-0002a2a0: 6564 206c 6973 7420 6f66 206e 756d 7079  ed list of numpy
-0002a2b0: 2061 7272 6179 7320 6172 7261 6e67 6564   arrays arranged
-0002a2c0: 2069 6e20 7468 6520 6f72 6465 7220 7468   in the order th
-0002a2d0: 6579 0a20 2020 2073 686f 756c 6420 6170  ey.    should ap
-0002a2e0: 7065 6172 2069 6e20 7468 6520 6172 7261  pear in the arra
-0002a2f0: 7920 6974 7365 6c66 2e20 2045 6163 6820  y itself.  Each 
-0002a300: 6172 7261 7920 7368 6f75 6c64 2068 6176  array should hav
-0002a310: 6520 7468 6520 7361 6d65 206e 756d 6265  e the same numbe
-0002a320: 720a 2020 2020 6f66 2064 696d 656e 7369  r.    of dimensi
-0002a330: 6f6e 7320 6173 2074 6865 2064 6573 6972  ons as the desir
-0002a340: 6564 206f 7574 7075 7420 616e 6420 7468  ed output and th
-0002a350: 6520 6e65 7374 696e 6720 6f66 2074 6865  e nesting of the
-0002a360: 206c 6973 7473 2e0a 0a20 2020 203e 3e3e   lists...    >>>
-0002a370: 2078 203d 206e 702e 6172 7261 7928 5b5b   x = np.array([[
-0002a380: 312c 2032 5d5d 290a 2020 2020 3e3e 3e20  1, 2]]).    >>> 
-0002a390: 636f 6e63 6174 656e 6174 6533 285b 5b78  concatenate3([[x
-0002a3a0: 2c20 782c 2078 5d2c 205b 782c 2078 2c20  , x, x], [x, x, 
-0002a3b0: 785d 5d29 0a20 2020 2061 7272 6179 285b  x]]).    array([
-0002a3c0: 5b31 2c20 322c 2031 2c20 322c 2031 2c20  [1, 2, 1, 2, 1, 
-0002a3d0: 325d 2c0a 2020 2020 2020 2020 2020 205b  2],.           [
-0002a3e0: 312c 2032 2c20 312c 2032 2c20 312c 2032  1, 2, 1, 2, 1, 2
-0002a3f0: 5d5d 290a 0a20 2020 203e 3e3e 2063 6f6e  ]])..    >>> con
-0002a400: 6361 7465 6e61 7465 3328 5b5b 782c 2078  catenate3([[x, x
-0002a410: 5d2c 205b 782c 2078 5d2c 205b 782c 2078  ], [x, x], [x, x
-0002a420: 5d5d 290a 2020 2020 6172 7261 7928 5b5b  ]]).    array([[
-0002a430: 312c 2032 2c20 312c 2032 5d2c 0a20 2020  1, 2, 1, 2],.   
-0002a440: 2020 2020 2020 2020 5b31 2c20 322c 2031          [1, 2, 1
-0002a450: 2c20 325d 2c0a 2020 2020 2020 2020 2020  , 2],.          
-0002a460: 205b 312c 2032 2c20 312c 2032 5d5d 290a   [1, 2, 1, 2]]).
-0002a470: 2020 2020 2222 220a 2020 2020 2320 5765      """.    # We
-0002a480: 206e 6565 6420 7468 6973 2061 7320 5f5f   need this as __
-0002a490: 6172 7261 795f 6675 6e63 7469 6f6e 5f5f  array_function__
-0002a4a0: 206d 6179 206e 6f74 2065 7869 7374 206f   may not exist o
-0002a4b0: 6e20 6f6c 6465 7220 4e75 6d50 7920 7665  n older NumPy ve
-0002a4c0: 7273 696f 6e73 2e0a 2020 2020 2320 416e  rsions..    # An
-0002a4d0: 6420 746f 2072 6564 7563 6520 7665 7262  d to reduce verb
-0002a4e0: 6f73 6974 792e 0a20 2020 204e 4441 5252  osity..    NDARR
-0002a4f0: 4159 5f41 5252 4159 5f46 554e 4354 494f  AY_ARRAY_FUNCTIO
-0002a500: 4e20 3d20 6765 7461 7474 7228 6e70 2e6e  N = getattr(np.n
-0002a510: 6461 7272 6179 2c20 225f 5f61 7272 6179  darray, "__array
-0002a520: 5f66 756e 6374 696f 6e5f 5f22 2c20 4e6f  _function__", No
-0002a530: 6e65 290a 0a20 2020 2061 7272 6179 7320  ne)..    arrays 
-0002a540: 3d20 636f 6e63 7265 7465 2861 7272 6179  = concrete(array
-0002a550: 7329 0a20 2020 2069 6620 6e6f 7420 6172  s).    if not ar
-0002a560: 7261 7973 3a0a 2020 2020 2020 2020 7265  rays:.        re
-0002a570: 7475 726e 206e 702e 656d 7074 7928 3029  turn np.empty(0)
-0002a580: 0a0a 2020 2020 6164 7661 6e63 6564 203d  ..    advanced =
-0002a590: 206d 6178 280a 2020 2020 2020 2020 636f   max(.        co
-0002a5a0: 7265 2e66 6c61 7474 656e 2861 7272 6179  re.flatten(array
-0002a5b0: 732c 2063 6f6e 7461 696e 6572 3d28 6c69  s, container=(li
-0002a5c0: 7374 2c20 7475 706c 6529 292c 0a20 2020  st, tuple)),.   
-0002a5d0: 2020 2020 206b 6579 3d6c 616d 6264 6120       key=lambda 
-0002a5e0: 783a 2067 6574 6174 7472 2878 2c20 225f  x: getattr(x, "_
-0002a5f0: 5f61 7272 6179 5f70 7269 6f72 6974 795f  _array_priority_
-0002a600: 5f22 2c20 3029 2c0a 2020 2020 290a 0a20  _", 0),.    ).. 
-0002a610: 2020 2069 6620 6e6f 7420 616c 6c28 0a20     if not all(. 
-0002a620: 2020 2020 2020 204e 4441 5252 4159 5f41         NDARRAY_A
-0002a630: 5252 4159 5f46 554e 4354 494f 4e0a 2020  RRAY_FUNCTION.  
-0002a640: 2020 2020 2020 6973 2067 6574 6174 7472        is getattr
-0002a650: 2874 7970 6528 6172 7229 2c20 225f 5f61  (type(arr), "__a
-0002a660: 7272 6179 5f66 756e 6374 696f 6e5f 5f22  rray_function__"
-0002a670: 2c20 4e44 4152 5241 595f 4152 5241 595f  , NDARRAY_ARRAY_
-0002a680: 4655 4e43 5449 4f4e 290a 2020 2020 2020  FUNCTION).      
-0002a690: 2020 666f 7220 6172 7220 696e 2063 6f72    for arr in cor
-0002a6a0: 652e 666c 6174 7465 6e28 6172 7261 7973  e.flatten(arrays
-0002a6b0: 2c20 636f 6e74 6169 6e65 723d 286c 6973  , container=(lis
-0002a6c0: 742c 2074 7570 6c65 2929 0a20 2020 2029  t, tuple)).    )
-0002a6d0: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
-0002a6e0: 2020 2020 2020 2020 2020 2078 203d 2075             x = u
-0002a6f0: 6e70 6163 6b5f 7369 6e67 6c65 746f 6e28  npack_singleton(
-0002a700: 6172 7261 7973 290a 2020 2020 2020 2020  arrays).        
-0002a710: 2020 2020 7265 7475 726e 205f 636f 6e63      return _conc
-0002a720: 6174 656e 6174 6532 2861 7272 6179 732c  atenate2(arrays,
-0002a730: 2061 7865 733d 7475 706c 6528 7261 6e67   axes=tuple(rang
-0002a740: 6528 782e 6e64 696d 2929 290a 2020 2020  e(x.ndim))).    
-0002a750: 2020 2020 6578 6365 7074 2054 7970 6545      except TypeE
-0002a760: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-0002a770: 2020 7061 7373 0a0a 2020 2020 6966 2063    pass..    if c
-0002a780: 6f6e 6361 7465 6e61 7465 5f6c 6f6f 6b75  oncatenate_looku
-0002a790: 702e 6469 7370 6174 6368 2874 7970 6528  p.dispatch(type(
-0002a7a0: 6164 7661 6e63 6564 2929 2069 7320 6e6f  advanced)) is no
-0002a7b0: 7420 6e70 2e63 6f6e 6361 7465 6e61 7465  t np.concatenate
-0002a7c0: 3a0a 2020 2020 2020 2020 7820 3d20 756e  :.        x = un
-0002a7d0: 7061 636b 5f73 696e 676c 6574 6f6e 2861  pack_singleton(a
-0002a7e0: 7272 6179 7329 0a20 2020 2020 2020 2072  rrays).        r
-0002a7f0: 6574 7572 6e20 5f63 6f6e 6361 7465 6e61  eturn _concatena
-0002a800: 7465 3228 6172 7261 7973 2c20 6178 6573  te2(arrays, axes
-0002a810: 3d6c 6973 7428 7261 6e67 6528 782e 6e64  =list(range(x.nd
-0002a820: 696d 2929 290a 0a20 2020 206e 6469 6d20  im)))..    ndim 
-0002a830: 3d20 6e64 696d 6c69 7374 2861 7272 6179  = ndimlist(array
-0002a840: 7329 0a20 2020 2069 6620 6e6f 7420 6e64  s).    if not nd
-0002a850: 696d 3a0a 2020 2020 2020 2020 7265 7475  im:.        retu
-0002a860: 726e 2061 7272 6179 730a 2020 2020 6368  rn arrays.    ch
-0002a870: 756e 6b73 203d 2063 6875 6e6b 735f 6672  unks = chunks_fr
-0002a880: 6f6d 5f61 7272 6179 7328 6172 7261 7973  om_arrays(arrays
-0002a890: 290a 2020 2020 7368 6170 6520 3d20 7475  ).    shape = tu
-0002a8a0: 706c 6528 6d61 7028 7375 6d2c 2063 6875  ple(map(sum, chu
-0002a8b0: 6e6b 7329 290a 0a20 2020 2064 6566 2064  nks))..    def d
-0002a8c0: 7479 7065 2878 293a 0a20 2020 2020 2020  type(x):.       
-0002a8d0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0002a8e0: 2020 7265 7475 726e 2078 2e64 7479 7065    return x.dtype
-0002a8f0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0002a900: 4174 7472 6962 7574 6545 7272 6f72 3a0a  AttributeError:.
-0002a910: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0002a920: 726e 2074 7970 6528 7829 0a0a 2020 2020  rn type(x)..    
-0002a930: 7265 7375 6c74 203d 206e 702e 656d 7074  result = np.empt
-0002a940: 7928 7368 6170 653d 7368 6170 652c 2064  y(shape=shape, d
-0002a950: 7479 7065 3d64 7479 7065 2864 6565 7066  type=dtype(deepf
-0002a960: 6972 7374 2861 7272 6179 7329 2929 0a0a  irst(arrays)))..
-0002a970: 2020 2020 666f 7220 6964 782c 2061 7272      for idx, arr
-0002a980: 2069 6e20 7a69 7028 0a20 2020 2020 2020   in zip(.       
-0002a990: 2073 6c69 6365 735f 6672 6f6d 5f63 6875   slices_from_chu
-0002a9a0: 6e6b 7328 6368 756e 6b73 292c 2063 6f72  nks(chunks), cor
-0002a9b0: 652e 666c 6174 7465 6e28 6172 7261 7973  e.flatten(arrays
-0002a9c0: 2c20 636f 6e74 6169 6e65 723d 286c 6973  , container=(lis
-0002a9d0: 742c 2074 7570 6c65 2929 0a20 2020 2029  t, tuple)).    )
-0002a9e0: 3a0a 2020 2020 2020 2020 6966 2068 6173  :.        if has
-0002a9f0: 6174 7472 2861 7272 2c20 226e 6469 6d22  attr(arr, "ndim"
-0002aa00: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-0002aa10: 6869 6c65 2061 7272 2e6e 6469 6d20 3c20  hile arr.ndim < 
-0002aa20: 6e64 696d 3a0a 2020 2020 2020 2020 2020  ndim:.          
-0002aa30: 2020 2020 2020 6172 7220 3d20 6172 725b        arr = arr[
-0002aa40: 4e6f 6e65 2c20 2e2e 2e5d 0a20 2020 2020  None, ...].     
-0002aa50: 2020 2072 6573 756c 745b 6964 785d 203d     result[idx] =
-0002aa60: 2061 7272 0a0a 2020 2020 7265 7475 726e   arr..    return
-0002aa70: 2072 6573 756c 740a 0a0a 6465 6620 636f   result...def co
-0002aa80: 6e63 6174 656e 6174 655f 6178 6573 2861  ncatenate_axes(a
-0002aa90: 7272 6179 732c 2061 7865 7329 3a0a 2020  rrays, axes):.  
-0002aaa0: 2020 2222 2252 6563 7572 7369 7665 6c79    """Recursively
-0002aab0: 2063 616c 6c20 6e70 2e63 6f6e 6361 7465   call np.concate
-0002aac0: 6e61 7465 2061 6c6f 6e67 2061 7865 7322  nate along axes"
-0002aad0: 2222 0a20 2020 2069 6620 6c65 6e28 6178  "".    if len(ax
-0002aae0: 6573 2920 213d 206e 6469 6d6c 6973 7428  es) != ndimlist(
-0002aaf0: 6172 7261 7973 293a 0a20 2020 2020 2020  arrays):.       
-0002ab00: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002ab10: 7228 224c 656e 6774 6820 6f66 2061 7865  r("Length of axe
-0002ab20: 7320 7368 6f75 6c64 2065 7175 616c 2064  s should equal d
-0002ab30: 6570 7468 206f 6620 6e65 7374 6564 2061  epth of nested a
-0002ab40: 7272 6179 7322 290a 0a20 2020 2065 7874  rrays")..    ext
-0002ab50: 7261 6469 6d73 203d 206d 6178 2830 2c20  radims = max(0, 
-0002ab60: 6465 6570 6669 7273 7428 6172 7261 7973  deepfirst(arrays
-0002ab70: 292e 6e64 696d 202d 2028 6d61 7828 6178  ).ndim - (max(ax
-0002ab80: 6573 2920 2b20 3129 290a 2020 2020 7265  es) + 1)).    re
-0002ab90: 7475 726e 2063 6f6e 6361 7465 6e61 7465  turn concatenate
-0002aba0: 3328 7472 616e 7370 6f73 656c 6973 7428  3(transposelist(
-0002abb0: 6172 7261 7973 2c20 6178 6573 2c20 6578  arrays, axes, ex
-0002abc0: 7472 6164 696d 733d 6578 7472 6164 696d  tradims=extradim
-0002abd0: 7329 290a 0a0a 6465 6620 746f 5f68 6466  s))...def to_hdf
-0002abe0: 3528 6669 6c65 6e61 6d65 2c20 2a61 7267  5(filename, *arg
-0002abf0: 732c 2063 6875 6e6b 733d 5472 7565 2c20  s, chunks=True, 
-0002ac00: 2a2a 6b77 6172 6773 293a 0a20 2020 2022  **kwargs):.    "
-0002ac10: 2222 5374 6f72 6520 6172 7261 7973 2069  ""Store arrays i
-0002ac20: 6e20 4844 4635 2066 696c 650a 0a20 2020  n HDF5 file..   
-0002ac30: 2054 6869 7320 7361 7665 7320 7365 7665   This saves seve
-0002ac40: 7261 6c20 6461 736b 2061 7272 6179 7320  ral dask arrays 
-0002ac50: 696e 746f 2073 6576 6572 616c 2064 6174  into several dat
-0002ac60: 6170 6174 6873 2069 6e20 616e 2048 4446  apaths in an HDF
-0002ac70: 3520 6669 6c65 2e0a 2020 2020 4974 2063  5 file..    It c
-0002ac80: 7265 6174 6573 2074 6865 206e 6563 6573  reates the neces
-0002ac90: 7361 7279 2064 6174 6173 6574 7320 616e  sary datasets an
-0002aca0: 6420 6861 6e64 6c65 7320 636c 6561 6e20  d handles clean 
-0002acb0: 6669 6c65 206f 7065 6e69 6e67 2f63 6c6f  file opening/clo
-0002acc0: 7369 6e67 2e0a 0a20 2020 2050 6172 616d  sing...    Param
-0002acd0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-0002ace0: 2d2d 2d2d 0a20 2020 2063 6875 6e6b 733a  ----.    chunks:
-0002acf0: 2074 7570 6c65 206f 7220 6060 5472 7565   tuple or ``True
-0002ad00: 6060 0a20 2020 2020 2020 2043 6875 6e6b  ``.        Chunk
-0002ad10: 2073 6861 7065 2c20 6f72 2060 6054 7275   shape, or ``Tru
-0002ad20: 6560 6020 746f 2070 6173 7320 7468 6520  e`` to pass the 
-0002ad30: 6368 756e 6b73 2066 726f 6d20 7468 6520  chunks from the 
-0002ad40: 6461 736b 2061 7272 6179 2e0a 2020 2020  dask array..    
-0002ad50: 2020 2020 4465 6661 756c 7473 2074 6f20      Defaults to 
-0002ad60: 6060 5472 7565 6060 2e0a 0a20 2020 2045  ``True``...    E
-0002ad70: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
-0002ad80: 2d2d 2d2d 0a0a 2020 2020 3e3e 3e20 6461  ----..    >>> da
-0002ad90: 2e74 6f5f 6864 6635 2827 6d79 6669 6c65  .to_hdf5('myfile
-0002ada0: 2e68 6466 3527 2c20 272f 7827 2c20 7829  .hdf5', '/x', x)
-0002adb0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0002adc0: 4950 0a0a 2020 2020 6f72 0a0a 2020 2020  IP..    or..    
-0002add0: 3e3e 3e20 6461 2e74 6f5f 6864 6635 2827  >>> da.to_hdf5('
-0002ade0: 6d79 6669 6c65 2e68 6466 3527 2c20 7b27  myfile.hdf5', {'
-0002adf0: 2f78 273a 2078 2c20 272f 7927 3a20 797d  /x': x, '/y': y}
-0002ae00: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-0002ae10: 4b49 500a 0a20 2020 204f 7074 696f 6e61  KIP..    Optiona
-0002ae20: 6c6c 7920 7072 6f76 6964 6520 6172 6775  lly provide argu
-0002ae30: 6d65 6e74 7320 6173 2074 686f 7567 6820  ments as though 
-0002ae40: 746f 2060 6068 3570 792e 4669 6c65 2e63  to ``h5py.File.c
-0002ae50: 7265 6174 655f 6461 7461 7365 7460 600a  reate_dataset``.
-0002ae60: 0a20 2020 203e 3e3e 2064 612e 746f 5f68  .    >>> da.to_h
-0002ae70: 6466 3528 276d 7966 696c 652e 6864 6635  df5('myfile.hdf5
-0002ae80: 272c 2027 2f78 272c 2078 2c20 636f 6d70  ', '/x', x, comp
-0002ae90: 7265 7373 696f 6e3d 276c 7a66 272c 2073  ression='lzf', s
-0002aea0: 6875 6666 6c65 3d54 7275 6529 2020 2320  huffle=True)  # 
-0002aeb0: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
-0002aec0: 2020 2020 3e3e 3e20 6461 2e74 6f5f 6864      >>> da.to_hd
-0002aed0: 6635 2827 6d79 6669 6c65 2e68 6466 3527  f5('myfile.hdf5'
-0002aee0: 2c20 272f 7827 2c20 782c 2063 6875 6e6b  , '/x', x, chunk
-0002aef0: 733d 2831 302c 3230 2c33 3029 2920 2023  s=(10,20,30))  #
-0002af00: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-0002af10: 0a20 2020 2054 6869 7320 6361 6e20 616c  .    This can al
-0002af20: 736f 2062 6520 7573 6564 2061 7320 6120  so be used as a 
-0002af30: 6d65 7468 6f64 206f 6e20 6120 7369 6e67  method on a sing
-0002af40: 6c65 2041 7272 6179 0a0a 2020 2020 3e3e  le Array..    >>
-0002af50: 3e20 782e 746f 5f68 6466 3528 276d 7966  > x.to_hdf5('myf
-0002af60: 696c 652e 6864 6635 272c 2027 2f78 2729  ile.hdf5', '/x')
-0002af70: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0002af80: 4950 0a0a 2020 2020 5365 6520 416c 736f  IP..    See Also
-0002af90: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-0002afa0: 2020 6461 2e73 746f 7265 0a20 2020 2068    da.store.    h
-0002afb0: 3570 792e 4669 6c65 2e63 7265 6174 655f  5py.File.create_
-0002afc0: 6461 7461 7365 740a 2020 2020 2222 220a  dataset.    """.
-0002afd0: 2020 2020 6966 206c 656e 2861 7267 7329      if len(args)
-0002afe0: 203d 3d20 3120 616e 6420 6973 696e 7374   == 1 and isinst
-0002aff0: 616e 6365 2861 7267 735b 305d 2c20 6469  ance(args[0], di
-0002b000: 6374 293a 0a20 2020 2020 2020 2064 6174  ct):.        dat
-0002b010: 6120 3d20 6172 6773 5b30 5d0a 2020 2020  a = args[0].    
-0002b020: 656c 6966 206c 656e 2861 7267 7329 203d  elif len(args) =
-0002b030: 3d20 3220 616e 6420 6973 696e 7374 616e  = 2 and isinstan
-0002b040: 6365 2861 7267 735b 305d 2c20 7374 7229  ce(args[0], str)
-0002b050: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
-0002b060: 6172 6773 5b31 5d2c 2041 7272 6179 293a  args[1], Array):
-0002b070: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-0002b080: 7b61 7267 735b 305d 3a20 6172 6773 5b31  {args[0]: args[1
-0002b090: 5d7d 0a20 2020 2065 6c73 653a 0a20 2020  ]}.    else:.   
-0002b0a0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002b0b0: 4572 726f 7228 2250 6c65 6173 6520 7072  Error("Please pr
-0002b0c0: 6f76 6964 6520 7b27 2f64 6174 612f 7061  ovide {'/data/pa
-0002b0d0: 7468 273a 2061 7272 6179 7d20 6469 6374  th': array} dict
-0002b0e0: 696f 6e61 7279 2229 0a0a 2020 2020 696d  ionary")..    im
-0002b0f0: 706f 7274 2068 3570 790a 0a20 2020 2077  port h5py..    w
-0002b100: 6974 6820 6835 7079 2e46 696c 6528 6669  ith h5py.File(fi
-0002b110: 6c65 6e61 6d65 2c20 6d6f 6465 3d22 6122  lename, mode="a"
-0002b120: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
-0002b130: 6473 6574 7320 3d20 5b0a 2020 2020 2020  dsets = [.      
-0002b140: 2020 2020 2020 662e 7265 7175 6972 655f        f.require_
-0002b150: 6461 7461 7365 7428 0a20 2020 2020 2020  dataset(.       
-0002b160: 2020 2020 2020 2020 2064 702c 0a20 2020           dp,.   
-0002b170: 2020 2020 2020 2020 2020 2020 2073 6861               sha
-0002b180: 7065 3d78 2e73 6861 7065 2c0a 2020 2020  pe=x.shape,.    
-0002b190: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-0002b1a0: 653d 782e 6474 7970 652c 0a20 2020 2020  e=x.dtype,.     
-0002b1b0: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
-0002b1c0: 733d 7475 706c 6528 635b 305d 2066 6f72  s=tuple(c[0] for
-0002b1d0: 2063 2069 6e20 782e 6368 756e 6b73 2920   c in x.chunks) 
-0002b1e0: 6966 2063 6875 6e6b 7320 6973 2054 7275  if chunks is Tru
-0002b1f0: 6520 656c 7365 2063 6875 6e6b 732c 0a20  e else chunks,. 
-0002b200: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-0002b210: 2a6b 7761 7267 732c 0a20 2020 2020 2020  *kwargs,.       
-0002b220: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0002b230: 2020 2066 6f72 2064 702c 2078 2069 6e20     for dp, x in 
-0002b240: 6461 7461 2e69 7465 6d73 2829 0a20 2020  data.items().   
-0002b250: 2020 2020 205d 0a20 2020 2020 2020 2073       ].        s
-0002b260: 746f 7265 286c 6973 7428 6461 7461 2e76  tore(list(data.v
-0002b270: 616c 7565 7328 2929 2c20 6473 6574 7329  alues()), dsets)
-0002b280: 0a0a 0a64 6566 2069 6e74 6572 6c65 6176  ...def interleav
-0002b290: 655f 6e6f 6e65 2861 2c20 6229 3a0a 2020  e_none(a, b):.  
-0002b2a0: 2020 2222 220a 0a20 2020 203e 3e3e 2069    """..    >>> i
-0002b2b0: 6e74 6572 6c65 6176 655f 6e6f 6e65 285b  nterleave_none([
-0002b2c0: 302c 204e 6f6e 652c 2032 2c20 4e6f 6e65  0, None, 2, None
-0002b2d0: 5d2c 205b 312c 2033 5d29 0a20 2020 2028  ], [1, 3]).    (
-0002b2e0: 302c 2031 2c20 322c 2033 290a 2020 2020  0, 1, 2, 3).    
-0002b2f0: 2222 220a 2020 2020 7265 7375 6c74 203d  """.    result =
-0002b300: 205b 5d0a 2020 2020 6920 3d20 6a20 3d20   [].    i = j = 
-0002b310: 300a 2020 2020 6e20 3d20 6c65 6e28 6129  0.    n = len(a)
-0002b320: 202b 206c 656e 2862 290a 2020 2020 7768   + len(b).    wh
-0002b330: 696c 6520 6920 2b20 6a20 3c20 6e3a 0a20  ile i + j < n:. 
-0002b340: 2020 2020 2020 2069 6620 615b 695d 2069         if a[i] i
-0002b350: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0002b360: 2020 2020 2020 2020 7265 7375 6c74 2e61          result.a
-0002b370: 7070 656e 6428 615b 695d 290a 2020 2020  ppend(a[i]).    
-0002b380: 2020 2020 2020 2020 6920 2b3d 2031 0a20          i += 1. 
-0002b390: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002b3a0: 2020 2020 2020 2020 2072 6573 756c 742e           result.
-0002b3b0: 6170 7065 6e64 2862 5b6a 5d29 0a20 2020  append(b[j]).   
-0002b3c0: 2020 2020 2020 2020 2069 202b 3d20 310a           i += 1.
-0002b3d0: 2020 2020 2020 2020 2020 2020 6a20 2b3d              j +=
-0002b3e0: 2031 0a20 2020 2072 6574 7572 6e20 7475   1.    return tu
-0002b3f0: 706c 6528 7265 7375 6c74 290a 0a0a 6465  ple(result)...de
-0002b400: 6620 6b65 796e 616d 6528 6e61 6d65 2c20  f keyname(name, 
-0002b410: 692c 206f 6b65 7929 3a0a 2020 2020 2222  i, okey):.    ""
-0002b420: 220a 0a20 2020 203e 3e3e 206b 6579 6e61  "..    >>> keyna
-0002b430: 6d65 2827 7827 2c20 332c 205b 4e6f 6e65  me('x', 3, [None
-0002b440: 2c20 4e6f 6e65 2c20 302c 2032 5d29 0a20  , None, 0, 2]). 
-0002b450: 2020 2028 2778 272c 2033 2c20 302c 2032     ('x', 3, 0, 2
-0002b460: 290a 2020 2020 2222 220a 2020 2020 7265  ).    """.    re
-0002b470: 7475 726e 2028 6e61 6d65 2c20 6929 202b  turn (name, i) +
-0002b480: 2074 7570 6c65 286b 2066 6f72 206b 2069   tuple(k for k i
-0002b490: 6e20 6f6b 6579 2069 6620 6b20 6973 206e  n okey if k is n
-0002b4a0: 6f74 204e 6f6e 6529 0a0a 0a64 6566 205f  ot None)...def _
-0002b4b0: 7669 6e64 6578 2878 2c20 2a69 6e64 6578  vindex(x, *index
-0002b4c0: 6573 293a 0a20 2020 2022 2222 506f 696e  es):.    """Poin
-0002b4d0: 7420 7769 7365 2069 6e64 6578 696e 6720  t wise indexing 
-0002b4e0: 7769 7468 2062 726f 6164 6361 7374 696e  with broadcastin
-0002b4f0: 672e 0a0a 2020 2020 3e3e 3e20 7820 3d20  g...    >>> x = 
-0002b500: 6e70 2e61 7261 6e67 6528 3536 292e 7265  np.arange(56).re
-0002b510: 7368 6170 6528 2837 2c20 3829 290a 2020  shape((7, 8)).  
-0002b520: 2020 3e3e 3e20 780a 2020 2020 6172 7261    >>> x.    arra
-0002b530: 7928 5b5b 2030 2c20 2031 2c20 2032 2c20  y([[ 0,  1,  2, 
-0002b540: 2033 2c20 2034 2c20 2035 2c20 2036 2c20   3,  4,  5,  6, 
-0002b550: 2037 5d2c 0a20 2020 2020 2020 2020 2020   7],.           
-0002b560: 5b20 382c 2020 392c 2031 302c 2031 312c  [ 8,  9, 10, 11,
-0002b570: 2031 322c 2031 332c 2031 342c 2031 355d   12, 13, 14, 15]
-0002b580: 2c0a 2020 2020 2020 2020 2020 205b 3136  ,.           [16
-0002b590: 2c20 3137 2c20 3138 2c20 3139 2c20 3230  , 17, 18, 19, 20
-0002b5a0: 2c20 3231 2c20 3232 2c20 3233 5d2c 0a20  , 21, 22, 23],. 
-0002b5b0: 2020 2020 2020 2020 2020 5b32 342c 2032            [24, 2
-0002b5c0: 352c 2032 362c 2032 372c 2032 382c 2032  5, 26, 27, 28, 2
-0002b5d0: 392c 2033 302c 2033 315d 2c0a 2020 2020  9, 30, 31],.    
-0002b5e0: 2020 2020 2020 205b 3332 2c20 3333 2c20         [32, 33, 
-0002b5f0: 3334 2c20 3335 2c20 3336 2c20 3337 2c20  34, 35, 36, 37, 
-0002b600: 3338 2c20 3339 5d2c 0a20 2020 2020 2020  38, 39],.       
-0002b610: 2020 2020 5b34 302c 2034 312c 2034 322c      [40, 41, 42,
-0002b620: 2034 332c 2034 342c 2034 352c 2034 362c   43, 44, 45, 46,
-0002b630: 2034 375d 2c0a 2020 2020 2020 2020 2020   47],.          
-0002b640: 205b 3438 2c20 3439 2c20 3530 2c20 3531   [48, 49, 50, 51
-0002b650: 2c20 3532 2c20 3533 2c20 3534 2c20 3535  , 52, 53, 54, 55
-0002b660: 5d5d 290a 0a20 2020 203e 3e3e 2064 203d  ]])..    >>> d =
-0002b670: 2066 726f 6d5f 6172 7261 7928 782c 2063   from_array(x, c
-0002b680: 6875 6e6b 733d 2833 2c20 3429 290a 2020  hunks=(3, 4)).  
-0002b690: 2020 3e3e 3e20 7265 7375 6c74 203d 205f    >>> result = _
-0002b6a0: 7669 6e64 6578 2864 2c20 5b30 2c20 312c  vindex(d, [0, 1,
-0002b6b0: 2036 2c20 305d 2c20 5b30 2c20 312c 2030   6, 0], [0, 1, 0
-0002b6c0: 2c20 375d 290a 2020 2020 3e3e 3e20 7265  , 7]).    >>> re
-0002b6d0: 7375 6c74 2e63 6f6d 7075 7465 2829 0a20  sult.compute(). 
-0002b6e0: 2020 2061 7272 6179 285b 2030 2c20 2039     array([ 0,  9
-0002b6f0: 2c20 3438 2c20 2037 5d29 0a20 2020 2022  , 48,  7]).    "
-0002b700: 2222 0a20 2020 2069 6e64 6578 6573 203d  "".    indexes =
-0002b710: 2072 6570 6c61 6365 5f65 6c6c 6970 7369   replace_ellipsi
-0002b720: 7328 782e 6e64 696d 2c20 696e 6465 7865  s(x.ndim, indexe
-0002b730: 7329 0a0a 2020 2020 6e6f 6e66 616e 6379  s)..    nonfancy
-0002b740: 5f69 6e64 6578 6573 203d 205b 5d0a 2020  _indexes = [].  
-0002b750: 2020 7265 6475 6365 645f 696e 6465 7865    reduced_indexe
-0002b760: 7320 3d20 5b5d 0a20 2020 2066 6f72 2069  s = [].    for i
-0002b770: 6e64 2069 6e20 696e 6465 7865 733a 0a20  nd in indexes:. 
-0002b780: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0002b790: 616e 6365 2869 6e64 2c20 4e75 6d62 6572  ance(ind, Number
-0002b7a0: 293a 0a20 2020 2020 2020 2020 2020 206e  ):.            n
-0002b7b0: 6f6e 6661 6e63 795f 696e 6465 7865 732e  onfancy_indexes.
-0002b7c0: 6170 7065 6e64 2869 6e64 290a 2020 2020  append(ind).    
-0002b7d0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0002b7e0: 6e63 6528 696e 642c 2073 6c69 6365 293a  nce(ind, slice):
-0002b7f0: 0a20 2020 2020 2020 2020 2020 206e 6f6e  .            non
-0002b800: 6661 6e63 795f 696e 6465 7865 732e 6170  fancy_indexes.ap
-0002b810: 7065 6e64 2869 6e64 290a 2020 2020 2020  pend(ind).      
-0002b820: 2020 2020 2020 7265 6475 6365 645f 696e        reduced_in
-0002b830: 6465 7865 732e 6170 7065 6e64 2873 6c69  dexes.append(sli
-0002b840: 6365 284e 6f6e 6529 290a 2020 2020 2020  ce(None)).      
-0002b850: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0002b860: 2020 2020 6e6f 6e66 616e 6379 5f69 6e64      nonfancy_ind
-0002b870: 6578 6573 2e61 7070 656e 6428 736c 6963  exes.append(slic
-0002b880: 6528 4e6f 6e65 2929 0a20 2020 2020 2020  e(None)).       
-0002b890: 2020 2020 2072 6564 7563 6564 5f69 6e64       reduced_ind
-0002b8a0: 6578 6573 2e61 7070 656e 6428 696e 6429  exes.append(ind)
-0002b8b0: 0a0a 2020 2020 6e6f 6e66 616e 6379 5f69  ..    nonfancy_i
-0002b8c0: 6e64 6578 6573 203d 2074 7570 6c65 286e  ndexes = tuple(n
-0002b8d0: 6f6e 6661 6e63 795f 696e 6465 7865 7329  onfancy_indexes)
-0002b8e0: 0a20 2020 2072 6564 7563 6564 5f69 6e64  .    reduced_ind
-0002b8f0: 6578 6573 203d 2074 7570 6c65 2872 6564  exes = tuple(red
-0002b900: 7563 6564 5f69 6e64 6578 6573 290a 0a20  uced_indexes).. 
-0002b910: 2020 2078 203d 2078 5b6e 6f6e 6661 6e63     x = x[nonfanc
-0002b920: 795f 696e 6465 7865 735d 0a0a 2020 2020  y_indexes]..    
-0002b930: 6172 7261 795f 696e 6465 7865 7320 3d20  array_indexes = 
-0002b940: 7b7d 0a20 2020 2066 6f72 2069 2c20 2869  {}.    for i, (i
-0002b950: 6e64 2c20 7369 7a65 2920 696e 2065 6e75  nd, size) in enu
-0002b960: 6d65 7261 7465 287a 6970 2872 6564 7563  merate(zip(reduc
-0002b970: 6564 5f69 6e64 6578 6573 2c20 782e 7368  ed_indexes, x.sh
-0002b980: 6170 6529 293a 0a20 2020 2020 2020 2069  ape)):.        i
-0002b990: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-0002b9a0: 2869 6e64 2c20 736c 6963 6529 3a0a 2020  (ind, slice):.  
-0002b9b0: 2020 2020 2020 2020 2020 696e 6420 3d20            ind = 
-0002b9c0: 6e70 2e61 7272 6179 2869 6e64 2c20 636f  np.array(ind, co
-0002b9d0: 7079 3d54 7275 6529 0a20 2020 2020 2020  py=True).       
-0002b9e0: 2020 2020 2069 6620 696e 642e 6474 7970       if ind.dtyp
-0002b9f0: 652e 6b69 6e64 203d 3d20 2262 223a 0a20  e.kind == "b":. 
-0002ba00: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0002ba10: 6169 7365 2049 6e64 6578 4572 726f 7228  aise IndexError(
-0002ba20: 2276 696e 6465 7820 646f 6573 206e 6f74  "vindex does not
-0002ba30: 2073 7570 706f 7274 2069 6e64 6578 696e   support indexin
-0002ba40: 6720 7769 7468 2062 6f6f 6c65 616e 2061  g with boolean a
-0002ba50: 7272 6179 7322 290a 2020 2020 2020 2020  rrays").        
-0002ba60: 2020 2020 6966 2028 2869 6e64 203e 3d20      if ((ind >= 
-0002ba70: 7369 7a65 2920 7c20 2869 6e64 203c 202d  size) | (ind < -
-0002ba80: 7369 7a65 2929 2e61 6e79 2829 3a0a 2020  size)).any():.  
-0002ba90: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0002baa0: 6973 6520 496e 6465 7845 7272 6f72 280a  ise IndexError(.
-0002bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bac0: 2020 2020 2276 696e 6465 7820 6b65 7920      "vindex key 
-0002bad0: 6861 7320 656e 7472 6965 7320 6f75 7420  has entries out 
-0002bae0: 6f66 2062 6f75 6e64 7320 666f 7220 220a  of bounds for ".
-0002baf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb00: 2020 2020 2269 6e64 6578 696e 6720 616c      "indexing al
-0002bb10: 6f6e 6720 6178 6973 2025 7320 6f66 2073  ong axis %s of s
-0002bb20: 697a 6520 2573 3a20 2572 2220 2520 2869  ize %s: %r" % (i
-0002bb30: 2c20 7369 7a65 2c20 696e 6429 0a20 2020  , size, ind).   
-0002bb40: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0002bb50: 2020 2020 2020 2020 2020 2069 6e64 2025             ind %
-0002bb60: 3d20 7369 7a65 0a20 2020 2020 2020 2020  = size.         
-0002bb70: 2020 2061 7272 6179 5f69 6e64 6578 6573     array_indexes
-0002bb80: 5b69 5d20 3d20 696e 640a 0a20 2020 2069  [i] = ind..    i
-0002bb90: 6620 6172 7261 795f 696e 6465 7865 733a  f array_indexes:
-0002bba0: 0a20 2020 2020 2020 2078 203d 205f 7669  .        x = _vi
-0002bbb0: 6e64 6578 5f61 7272 6179 2878 2c20 6172  ndex_array(x, ar
-0002bbc0: 7261 795f 696e 6465 7865 7329 0a0a 2020  ray_indexes)..  
-0002bbd0: 2020 7265 7475 726e 2078 0a0a 0a64 6566    return x...def
-0002bbe0: 205f 7669 6e64 6578 5f61 7272 6179 2878   _vindex_array(x
-0002bbf0: 2c20 6469 6374 5f69 6e64 6578 6573 293a  , dict_indexes):
-0002bc00: 0a20 2020 2022 2222 506f 696e 7420 7769  .    """Point wi
-0002bc10: 7365 2069 6e64 6578 696e 6720 7769 7468  se indexing with
-0002bc20: 206f 6e6c 7920 4e75 6d50 7920 4172 7261   only NumPy Arra
-0002bc30: 7973 2e22 2222 0a0a 2020 2020 7472 793a  ys."""..    try:
-0002bc40: 0a20 2020 2020 2020 2062 726f 6164 6361  .        broadca
-0002bc50: 7374 5f69 6e64 6578 6573 203d 206e 702e  st_indexes = np.
-0002bc60: 6272 6f61 6463 6173 745f 6172 7261 7973  broadcast_arrays
-0002bc70: 282a 6469 6374 5f69 6e64 6578 6573 2e76  (*dict_indexes.v
-0002bc80: 616c 7565 7328 2929 0a20 2020 2065 7863  alues()).    exc
-0002bc90: 6570 7420 5661 6c75 6545 7272 6f72 2061  ept ValueError a
-0002bca0: 7320 653a 0a20 2020 2020 2020 2023 206e  s e:.        # n
-0002bcb0: 6f74 653a 2065 7272 6f72 206d 6573 7361  ote: error messa
-0002bcc0: 6765 2065 7861 6374 6c79 206d 6174 6368  ge exactly match
-0002bcd0: 6573 206e 756d 7079 0a20 2020 2020 2020  es numpy.       
-0002bce0: 2073 6861 7065 735f 7374 7220 3d20 2220   shapes_str = " 
-0002bcf0: 222e 6a6f 696e 2873 7472 2861 2e73 6861  ".join(str(a.sha
-0002bd00: 7065 2920 666f 7220 6120 696e 2064 6963  pe) for a in dic
-0002bd10: 745f 696e 6465 7865 732e 7661 6c75 6573  t_indexes.values
-0002bd20: 2829 290a 2020 2020 2020 2020 7261 6973  ()).        rais
-0002bd30: 6520 496e 6465 7845 7272 6f72 280a 2020  e IndexError(.  
-0002bd40: 2020 2020 2020 2020 2020 2273 6861 7065            "shape
-0002bd50: 206d 6973 6d61 7463 683a 2069 6e64 6578   mismatch: index
-0002bd60: 696e 6720 6172 7261 7973 2063 6f75 6c64  ing arrays could
-0002bd70: 206e 6f74 2062 6520 220a 2020 2020 2020   not be ".      
-0002bd80: 2020 2020 2020 2262 726f 6164 6361 7374        "broadcast
-0002bd90: 2074 6f67 6574 6865 7220 7769 7468 2073   together with s
-0002bda0: 6861 7065 7320 2220 2b20 7368 6170 6573  hapes " + shapes
-0002bdb0: 5f73 7472 0a20 2020 2020 2020 2029 2066  _str.        ) f
-0002bdc0: 726f 6d20 650a 2020 2020 6272 6f61 6463  rom e.    broadc
-0002bdd0: 6173 745f 7368 6170 6520 3d20 6272 6f61  ast_shape = broa
-0002bde0: 6463 6173 745f 696e 6465 7865 735b 305d  dcast_indexes[0]
-0002bdf0: 2e73 6861 7065 0a0a 2020 2020 6c6f 6f6b  .shape..    look
-0002be00: 7570 203d 2064 6963 7428 7a69 7028 6469  up = dict(zip(di
-0002be10: 6374 5f69 6e64 6578 6573 2c20 6272 6f61  ct_indexes, broa
-0002be20: 6463 6173 745f 696e 6465 7865 7329 290a  dcast_indexes)).
-0002be30: 2020 2020 666c 6174 5f69 6e64 6578 6573      flat_indexes
-0002be40: 203d 205b 0a20 2020 2020 2020 206c 6f6f   = [.        loo
-0002be50: 6b75 705b 695d 2e72 6176 656c 2829 2e74  kup[i].ravel().t
-0002be60: 6f6c 6973 7428 2920 6966 2069 2069 6e20  olist() if i in 
-0002be70: 6c6f 6f6b 7570 2065 6c73 6520 4e6f 6e65  lookup else None
-0002be80: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0002be90: 782e 6e64 696d 290a 2020 2020 5d0a 2020  x.ndim).    ].  
-0002bea0: 2020 666c 6174 5f69 6e64 6578 6573 2e65    flat_indexes.e
-0002beb0: 7874 656e 6428 5b4e 6f6e 655d 202a 2028  xtend([None] * (
-0002bec0: 782e 6e64 696d 202d 206c 656e 2866 6c61  x.ndim - len(fla
-0002bed0: 745f 696e 6465 7865 7329 2929 0a0a 2020  t_indexes)))..  
-0002bee0: 2020 666c 6174 5f69 6e64 6578 6573 203d    flat_indexes =
-0002bef0: 205b 0a20 2020 2020 2020 206c 6973 7428   [.        list(
-0002bf00: 696e 6465 7829 2069 6620 696e 6465 7820  index) if index 
-0002bf10: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
-0002bf20: 2069 6e64 6578 2066 6f72 2069 6e64 6578   index for index
-0002bf30: 2069 6e20 666c 6174 5f69 6e64 6578 6573   in flat_indexes
-0002bf40: 0a20 2020 205d 0a20 2020 2062 6f75 6e64  .    ].    bound
-0002bf50: 7320 3d20 5b6c 6973 7428 6163 6375 6d75  s = [list(accumu
-0002bf60: 6c61 7465 2861 6464 2c20 2830 2c29 202b  late(add, (0,) +
-0002bf70: 2063 2929 2066 6f72 2063 2069 6e20 782e   c)) for c in x.
-0002bf80: 6368 756e 6b73 5d0a 2020 2020 626f 756e  chunks].    boun
-0002bf90: 6473 3220 3d20 5b62 2066 6f72 2069 2c20  ds2 = [b for i, 
-0002bfa0: 6220 696e 207a 6970 2866 6c61 745f 696e  b in zip(flat_in
-0002bfb0: 6465 7865 732c 2062 6f75 6e64 7329 2069  dexes, bounds) i
-0002bfc0: 6620 6920 6973 206e 6f74 204e 6f6e 655d  f i is not None]
-0002bfd0: 0a20 2020 2061 7869 7320 3d20 5f67 6574  .    axis = _get
-0002bfe0: 5f61 7869 7328 666c 6174 5f69 6e64 6578  _axis(flat_index
-0002bff0: 6573 290a 2020 2020 746f 6b65 6e20 3d20  es).    token = 
-0002c000: 746f 6b65 6e69 7a65 2878 2c20 666c 6174  tokenize(x, flat
-0002c010: 5f69 6e64 6578 6573 290a 2020 2020 6f75  _indexes).    ou
-0002c020: 745f 6e61 6d65 203d 2022 7669 6e64 6578  t_name = "vindex
-0002c030: 2d6d 6572 6765 2d22 202b 2074 6f6b 656e  -merge-" + token
-0002c040: 0a0a 2020 2020 706f 696e 7473 203d 206c  ..    points = l
-0002c050: 6973 7428 290a 2020 2020 666f 7220 692c  ist().    for i,
-0002c060: 2069 6478 2069 6e20 656e 756d 6572 6174   idx in enumerat
-0002c070: 6528 7a69 7028 2a5b 6920 666f 7220 6920  e(zip(*[i for i 
-0002c080: 696e 2066 6c61 745f 696e 6465 7865 7320  in flat_indexes 
-0002c090: 6966 2069 2069 7320 6e6f 7420 4e6f 6e65  if i is not None
-0002c0a0: 5d29 293a 0a20 2020 2020 2020 2062 6c6f  ])):.        blo
-0002c0b0: 636b 5f69 6478 203d 205b 6269 7365 6374  ck_idx = [bisect
-0002c0c0: 2862 2c20 696e 6429 202d 2031 2066 6f72  (b, ind) - 1 for
-0002c0d0: 2062 2c20 696e 6420 696e 207a 6970 2862   b, ind in zip(b
-0002c0e0: 6f75 6e64 7332 2c20 6964 7829 5d0a 2020  ounds2, idx)].  
-0002c0f0: 2020 2020 2020 696e 626c 6f63 6b5f 6964        inblock_id
-0002c100: 7820 3d20 5b0a 2020 2020 2020 2020 2020  x = [.          
-0002c110: 2020 696e 6420 2d20 626f 756e 6473 325b    ind - bounds2[
-0002c120: 6b5d 5b6a 5d20 666f 7220 6b2c 2028 696e  k][j] for k, (in
-0002c130: 642c 206a 2920 696e 2065 6e75 6d65 7261  d, j) in enumera
-0002c140: 7465 287a 6970 2869 6478 2c20 626c 6f63  te(zip(idx, bloc
-0002c150: 6b5f 6964 7829 290a 2020 2020 2020 2020  k_idx)).        
-0002c160: 5d0a 2020 2020 2020 2020 706f 696e 7473  ].        points
-0002c170: 2e61 7070 656e 6428 2869 2c20 7475 706c  .append((i, tupl
-0002c180: 6528 626c 6f63 6b5f 6964 7829 2c20 7475  e(block_idx), tu
-0002c190: 706c 6528 696e 626c 6f63 6b5f 6964 7829  ple(inblock_idx)
-0002c1a0: 2929 0a0a 2020 2020 6368 756e 6b73 203d  ))..    chunks =
-0002c1b0: 205b 6320 666f 7220 692c 2063 2069 6e20   [c for i, c in 
-0002c1c0: 7a69 7028 666c 6174 5f69 6e64 6578 6573  zip(flat_indexes
-0002c1d0: 2c20 782e 6368 756e 6b73 2920 6966 2069  , x.chunks) if i
-0002c1e0: 2069 7320 4e6f 6e65 5d0a 2020 2020 6368   is None].    ch
-0002c1f0: 756e 6b73 2e69 6e73 6572 7428 302c 2028  unks.insert(0, (
-0002c200: 6c65 6e28 706f 696e 7473 292c 2920 6966  len(points),) if
-0002c210: 2070 6f69 6e74 7320 656c 7365 2028 302c   points else (0,
-0002c220: 2929 0a20 2020 2063 6875 6e6b 7320 3d20  )).    chunks = 
-0002c230: 7475 706c 6528 6368 756e 6b73 290a 0a20  tuple(chunks).. 
-0002c240: 2020 2069 6620 706f 696e 7473 3a0a 2020     if points:.  
-0002c250: 2020 2020 2020 7065 725f 626c 6f63 6b20        per_block 
-0002c260: 3d20 6772 6f75 7062 7928 312c 2070 6f69  = groupby(1, poi
-0002c270: 6e74 7329 0a20 2020 2020 2020 2070 6572  nts).        per
-0002c280: 5f62 6c6f 636b 203d 207b 6b3a 2076 2066  _block = {k: v f
-0002c290: 6f72 206b 2c20 7620 696e 2070 6572 5f62  or k, v in per_b
-0002c2a0: 6c6f 636b 2e69 7465 6d73 2829 2069 6620  lock.items() if 
-0002c2b0: 767d 0a0a 2020 2020 2020 2020 6f74 6865  v}..        othe
-0002c2c0: 725f 626c 6f63 6b73 203d 206c 6973 7428  r_blocks = list(
-0002c2d0: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-0002c2e0: 6475 6374 280a 2020 2020 2020 2020 2020  duct(.          
-0002c2f0: 2020 2020 2020 2a5b 0a20 2020 2020 2020        *[.       
-0002c300: 2020 2020 2020 2020 2020 2020 206c 6973               lis
-0002c310: 7428 7261 6e67 6528 6c65 6e28 6329 2929  t(range(len(c)))
-0002c320: 2069 6620 6920 6973 204e 6f6e 6520 656c   if i is None el
-0002c330: 7365 205b 4e6f 6e65 5d0a 2020 2020 2020  se [None].      
-0002c340: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0002c350: 7220 692c 2063 2069 6e20 7a69 7028 666c  r i, c in zip(fl
-0002c360: 6174 5f69 6e64 6578 6573 2c20 782e 6368  at_indexes, x.ch
-0002c370: 756e 6b73 290a 2020 2020 2020 2020 2020  unks).          
-0002c380: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-0002c390: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
-0002c3a0: 0a20 2020 2020 2020 2066 756c 6c5f 736c  .        full_sl
-0002c3b0: 6963 6573 203d 205b 736c 6963 6528 4e6f  ices = [slice(No
-0002c3c0: 6e65 2c20 4e6f 6e65 2920 6966 2069 2069  ne, None) if i i
-0002c3d0: 7320 4e6f 6e65 2065 6c73 6520 4e6f 6e65  s None else None
-0002c3e0: 2066 6f72 2069 2069 6e20 666c 6174 5f69   for i in flat_i
-0002c3f0: 6e64 6578 6573 5d0a 0a20 2020 2020 2020  ndexes]..       
-0002c400: 206e 616d 6520 3d20 2276 696e 6465 782d   name = "vindex-
-0002c410: 736c 6963 652d 2220 2b20 746f 6b65 6e0a  slice-" + token.
-0002c420: 2020 2020 2020 2020 7669 6e64 6578 5f6d          vindex_m
-0002c430: 6572 6765 5f6e 616d 6520 3d20 2276 696e  erge_name = "vin
-0002c440: 6465 782d 6d65 7267 652d 2220 2b20 746f  dex-merge-" + to
-0002c450: 6b65 6e0a 2020 2020 2020 2020 6473 6b20  ken.        dsk 
-0002c460: 3d20 7b7d 0a20 2020 2020 2020 2066 6f72  = {}.        for
-0002c470: 206f 6b65 7920 696e 206f 7468 6572 5f62   okey in other_b
-0002c480: 6c6f 636b 733a 0a20 2020 2020 2020 2020  locks:.         
-0002c490: 2020 2066 6f72 2069 2c20 6b65 7920 696e     for i, key in
-0002c4a0: 2065 6e75 6d65 7261 7465 2870 6572 5f62   enumerate(per_b
-0002c4b0: 6c6f 636b 293a 0a20 2020 2020 2020 2020  lock):.         
-0002c4c0: 2020 2020 2020 2064 736b 5b6b 6579 6e61         dsk[keyna
-0002c4d0: 6d65 286e 616d 652c 2069 2c20 6f6b 6579  me(name, i, okey
-0002c4e0: 295d 203d 2028 0a20 2020 2020 2020 2020  )] = (.         
-0002c4f0: 2020 2020 2020 2020 2020 205f 7669 6e64             _vind
-0002c500: 6578 5f74 7261 6e73 706f 7365 2c0a 2020  ex_transpose,.  
-0002c510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c520: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-0002c530: 2020 2020 2020 2020 2020 2020 5f76 696e              _vin
-0002c540: 6465 785f 736c 6963 652c 0a20 2020 2020  dex_slice,.     
-0002c550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c560: 2020 2028 782e 6e61 6d65 2c29 202b 2069     (x.name,) + i
-0002c570: 6e74 6572 6c65 6176 655f 6e6f 6e65 286f  nterleave_none(o
-0002c580: 6b65 792c 206b 6579 292c 0a20 2020 2020  key, key),.     
-0002c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c5a0: 2020 2069 6e74 6572 6c65 6176 655f 6e6f     interleave_no
-0002c5b0: 6e65 280a 2020 2020 2020 2020 2020 2020  ne(.            
+00010130: 2020 2020 2020 2022 666f 726d 6174 7322         "formats"
+00010140: 3a20 5b73 656c 662e 6474 7970 652e 6669  : [self.dtype.fi
+00010150: 656c 6473 5b6e 616d 655d 5b30 5d20 666f  elds[name][0] fo
+00010160: 7220 6e61 6d65 2069 6e20 696e 6465 785d  r name in index]
+00010170: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00010180: 2020 2020 2020 2020 2020 226f 6666 7365            "offse
+00010190: 7473 223a 205b 7365 6c66 2e64 7479 7065  ts": [self.dtype
+000101a0: 2e66 6965 6c64 735b 6e61 6d65 5d5b 315d  .fields[name][1]
+000101b0: 2066 6f72 206e 616d 6520 696e 2069 6e64   for name in ind
+000101c0: 6578 5d2c 0a20 2020 2020 2020 2020 2020  ex],.           
+000101d0: 2020 2020 2020 2020 2020 2020 2022 6974               "it
+000101e0: 656d 7369 7a65 223a 2073 656c 662e 6474  emsize": self.dt
+000101f0: 7970 652e 6974 656d 7369 7a65 2c0a 2020  ype.itemsize,.  
+00010200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010210: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
+00010220: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00010230: 2020 2069 6620 6474 2e73 6861 7065 3a0a     if dt.shape:.
+00010240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010250: 6e65 775f 6178 6973 203d 206c 6973 7428  new_axis = list(
+00010260: 7261 6e67 6528 7365 6c66 2e6e 6469 6d2c  range(self.ndim,
+00010270: 2073 656c 662e 6e64 696d 202b 206c 656e   self.ndim + len
+00010280: 2864 742e 7368 6170 6529 2929 0a20 2020  (dt.shape))).   
+00010290: 2020 2020 2020 2020 2020 2020 2063 6875               chu
+000102a0: 6e6b 7320 3d20 7365 6c66 2e63 6875 6e6b  nks = self.chunk
+000102b0: 7320 2b20 7475 706c 6528 2869 2c29 2066  s + tuple((i,) f
+000102c0: 6f72 2069 2069 6e20 6474 2e73 6861 7065  or i in dt.shape
+000102d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000102e0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+000102f0: 705f 626c 6f63 6b73 280a 2020 2020 2020  p_blocks(.      
+00010300: 2020 2020 2020 2020 2020 2020 2020 6765                ge
+00010310: 7469 7465 6d2c 2069 6e64 6578 2c20 6474  titem, index, dt
+00010320: 7970 653d 6474 2e62 6173 652c 2063 6875  ype=dt.base, chu
+00010330: 6e6b 733d 6368 756e 6b73 2c20 6e65 775f  nks=chunks, new_
+00010340: 6178 6973 3d6e 6577 5f61 7869 730a 2020  axis=new_axis.  
+00010350: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00010360: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00010370: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00010380: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+00010390: 705f 626c 6f63 6b73 2867 6574 6974 656d  p_blocks(getitem
+000103a0: 2c20 696e 6465 782c 2064 7479 7065 3d64  , index, dtype=d
+000103b0: 7429 0a0a 2020 2020 2020 2020 6966 206e  t)..        if n
+000103c0: 6f74 2069 7369 6e73 7461 6e63 6528 696e  ot isinstance(in
+000103d0: 6465 782c 2074 7570 6c65 293a 0a20 2020  dex, tuple):.   
+000103e0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
+000103f0: 2028 696e 6465 782c 290a 0a20 2020 2020   (index,)..     
+00010400: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
+00010410: 6179 2e73 6c69 6369 6e67 2069 6d70 6f72  ay.slicing impor
+00010420: 7420 280a 2020 2020 2020 2020 2020 2020  t (.            
+00010430: 6e6f 726d 616c 697a 655f 696e 6465 782c  normalize_index,
+00010440: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
+00010450: 6365 5f77 6974 685f 626f 6f6c 5f64 6173  ce_with_bool_das
+00010460: 6b5f 6172 7261 792c 0a20 2020 2020 2020  k_array,.       
+00010470: 2020 2020 2073 6c69 6365 5f77 6974 685f       slice_with_
+00010480: 696e 745f 6461 736b 5f61 7272 6179 2c0a  int_dask_array,.
+00010490: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000104a0: 2020 2069 6e64 6578 3220 3d20 6e6f 726d     index2 = norm
+000104b0: 616c 697a 655f 696e 6465 7828 696e 6465  alize_index(inde
+000104c0: 782c 2073 656c 662e 7368 6170 6529 0a20  x, self.shape). 
+000104d0: 2020 2020 2020 2064 6570 656e 6465 6e63         dependenc
+000104e0: 6965 7320 3d20 7b73 656c 662e 6e61 6d65  ies = {self.name
+000104f0: 7d0a 2020 2020 2020 2020 666f 7220 6920  }.        for i 
+00010500: 696e 2069 6e64 6578 323a 0a20 2020 2020  in index2:.     
+00010510: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00010520: 616e 6365 2869 2c20 4172 7261 7929 3a0a  ance(i, Array):.
+00010530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010540: 6465 7065 6e64 656e 6369 6573 2e61 6464  dependencies.add
+00010550: 2869 2e6e 616d 6529 0a0a 2020 2020 2020  (i.name)..      
+00010560: 2020 6966 2061 6e79 2869 7369 6e73 7461    if any(isinsta
+00010570: 6e63 6528 692c 2041 7272 6179 2920 616e  nce(i, Array) an
+00010580: 6420 692e 6474 7970 652e 6b69 6e64 2069  d i.dtype.kind i
+00010590: 6e20 2269 7522 2066 6f72 2069 2069 6e20  n "iu" for i in 
+000105a0: 696e 6465 7832 293a 0a20 2020 2020 2020  index2):.       
+000105b0: 2020 2020 2073 656c 662c 2069 6e64 6578       self, index
+000105c0: 3220 3d20 736c 6963 655f 7769 7468 5f69  2 = slice_with_i
+000105d0: 6e74 5f64 6173 6b5f 6172 7261 7928 7365  nt_dask_array(se
+000105e0: 6c66 2c20 696e 6465 7832 290a 2020 2020  lf, index2).    
+000105f0: 2020 2020 6966 2061 6e79 2869 7369 6e73      if any(isins
+00010600: 7461 6e63 6528 692c 2041 7272 6179 2920  tance(i, Array) 
+00010610: 616e 6420 692e 6474 7970 6520 3d3d 2062  and i.dtype == b
+00010620: 6f6f 6c20 666f 7220 6920 696e 2069 6e64  ool for i in ind
+00010630: 6578 3229 3a0a 2020 2020 2020 2020 2020  ex2):.          
+00010640: 2020 7365 6c66 2c20 696e 6465 7832 203d    self, index2 =
+00010650: 2073 6c69 6365 5f77 6974 685f 626f 6f6c   slice_with_bool
+00010660: 5f64 6173 6b5f 6172 7261 7928 7365 6c66  _dask_array(self
+00010670: 2c20 696e 6465 7832 290a 0a20 2020 2020  , index2)..     
+00010680: 2020 2069 6620 616c 6c28 6973 696e 7374     if all(isinst
+00010690: 616e 6365 2869 2c20 736c 6963 6529 2061  ance(i, slice) a
+000106a0: 6e64 2069 203d 3d20 736c 6963 6528 4e6f  nd i == slice(No
+000106b0: 6e65 2920 666f 7220 6920 696e 2069 6e64  ne) for i in ind
+000106c0: 6578 3229 3a0a 2020 2020 2020 2020 2020  ex2):.          
+000106d0: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
+000106e0: 2020 2020 2020 206f 7574 203d 2022 6765         out = "ge
+000106f0: 7469 7465 6d2d 2220 2b20 746f 6b65 6e69  titem-" + tokeni
+00010700: 7a65 2873 656c 662c 2069 6e64 6578 3229  ze(self, index2)
+00010710: 0a20 2020 2020 2020 2064 736b 2c20 6368  .        dsk, ch
+00010720: 756e 6b73 203d 2073 6c69 6365 5f61 7272  unks = slice_arr
+00010730: 6179 286f 7574 2c20 7365 6c66 2e6e 616d  ay(out, self.nam
+00010740: 652c 2073 656c 662e 6368 756e 6b73 2c20  e, self.chunks, 
+00010750: 696e 6465 7832 2c20 7365 6c66 2e69 7465  index2, self.ite
+00010760: 6d73 697a 6529 0a0a 2020 2020 2020 2020  msize)..        
+00010770: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
+00010780: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
+00010790: 6563 7469 6f6e 7328 6f75 742c 2064 736b  ections(out, dsk
+000107a0: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
+000107b0: 7365 6c66 5d29 0a0a 2020 2020 2020 2020  self])..        
+000107c0: 6d65 7461 203d 206d 6574 615f 6672 6f6d  meta = meta_from
+000107d0: 5f61 7272 6179 2873 656c 662e 5f6d 6574  _array(self._met
+000107e0: 612c 206e 6469 6d3d 6c65 6e28 6368 756e  a, ndim=len(chun
+000107f0: 6b73 2929 0a20 2020 2020 2020 2069 6620  ks)).        if 
+00010800: 6e70 2e69 7373 6361 6c61 7228 6d65 7461  np.isscalar(meta
+00010810: 293a 0a20 2020 2020 2020 2020 2020 206d  ):.            m
+00010820: 6574 6120 3d20 6e70 2e61 7272 6179 286d  eta = np.array(m
+00010830: 6574 6129 0a0a 2020 2020 2020 2020 7265  eta)..        re
+00010840: 7475 726e 2041 7272 6179 2867 7261 7068  turn Array(graph
+00010850: 2c20 6f75 742c 2063 6875 6e6b 732c 206d  , out, chunks, m
+00010860: 6574 613d 6d65 7461 290a 0a20 2020 2064  eta=meta)..    d
+00010870: 6566 205f 7669 6e64 6578 2873 656c 662c  ef _vindex(self,
+00010880: 206b 6579 293a 0a20 2020 2020 2020 2069   key):.        i
+00010890: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+000108a0: 286b 6579 2c20 7475 706c 6529 3a0a 2020  (key, tuple):.  
+000108b0: 2020 2020 2020 2020 2020 6b65 7920 3d20            key = 
+000108c0: 286b 6579 2c29 0a20 2020 2020 2020 2069  (key,).        i
+000108d0: 6620 616e 7928 6b20 6973 204e 6f6e 6520  f any(k is None 
+000108e0: 666f 7220 6b20 696e 206b 6579 293a 0a20  for k in key):. 
+000108f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00010900: 2049 6e64 6578 4572 726f 7228 0a20 2020   IndexError(.   
+00010910: 2020 2020 2020 2020 2020 2020 2022 7669               "vi
+00010920: 6e64 6578 2064 6f65 7320 6e6f 7420 7375  ndex does not su
+00010930: 7070 6f72 7420 696e 6465 7869 6e67 2077  pport indexing w
+00010940: 6974 6820 4e6f 6e65 2028 6e70 2e6e 6577  ith None (np.new
+00010950: 6178 6973 292c 2022 0a20 2020 2020 2020  axis), ".       
+00010960: 2020 2020 2020 2020 2022 676f 7420 7b7d           "got {}
+00010970: 222e 666f 726d 6174 286b 6579 290a 2020  ".format(key).  
+00010980: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00010990: 2020 2020 6966 2061 6c6c 2869 7369 6e73      if all(isins
+000109a0: 7461 6e63 6528 6b2c 2073 6c69 6365 2920  tance(k, slice) 
+000109b0: 666f 7220 6b20 696e 206b 6579 293a 0a20  for k in key):. 
+000109c0: 2020 2020 2020 2020 2020 2069 6620 616c             if al
+000109d0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+000109e0: 2020 206b 2e69 6e64 6963 6573 2864 2920     k.indices(d) 
+000109f0: 3d3d 2073 6c69 6365 2830 2c20 6429 2e69  == slice(0, d).i
+00010a00: 6e64 6963 6573 2864 2920 666f 7220 6b2c  ndices(d) for k,
+00010a10: 2064 2069 6e20 7a69 7028 6b65 792c 2073   d in zip(key, s
+00010a20: 656c 662e 7368 6170 6529 0a20 2020 2020  elf.shape).     
+00010a30: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00010a40: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00010a50: 2073 656c 660a 2020 2020 2020 2020 2020   self.          
+00010a60: 2020 7261 6973 6520 496e 6465 7845 7272    raise IndexErr
+00010a70: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00010a80: 2020 2020 2276 696e 6465 7820 7265 7175      "vindex requ
+00010a90: 6972 6573 2061 7420 6c65 6173 7420 6f6e  ires at least on
+00010aa0: 6520 6e6f 6e2d 736c 6963 6520 746f 2076  e non-slice to v
+00010ab0: 6563 746f 7269 7a65 206f 7665 7220 220a  ectorize over ".
+00010ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ad0: 2277 6865 6e20 7468 6520 736c 6963 6573  "when the slices
+00010ae0: 2061 7265 206e 6f74 206f 7665 7220 7468   are not over th
+00010af0: 6520 656e 7469 7265 2061 7272 6179 2028  e entire array (
+00010b00: 692e 652c 2078 5b3a 5d29 2e20 220a 2020  i.e, x[:]). ".  
+00010b10: 2020 2020 2020 2020 2020 2020 2020 2255                "U
+00010b20: 7365 206e 6f72 6d61 6c20 736c 6963 696e  se normal slicin
+00010b30: 6720 696e 7374 6561 6420 7768 656e 206f  g instead when o
+00010b40: 6e6c 7920 7573 696e 6720 736c 6963 6573  nly using slices
+00010b50: 2e20 476f 743a 207b 7d22 2e66 6f72 6d61  . Got: {}".forma
+00010b60: 7428 6b65 7929 0a20 2020 2020 2020 2020  t(key).         
+00010b70: 2020 2029 0a20 2020 2020 2020 2065 6c69     ).        eli
+00010b80: 6620 616e 7928 6973 5f64 6173 6b5f 636f  f any(is_dask_co
+00010b90: 6c6c 6563 7469 6f6e 286b 2920 666f 7220  llection(k) for 
+00010ba0: 6b20 696e 206b 6579 293a 0a20 2020 2020  k in key):.     
+00010bb0: 2020 2020 2020 2072 6169 7365 2049 6e64         raise Ind
+00010bc0: 6578 4572 726f 7228 0a20 2020 2020 2020  exError(.       
+00010bd0: 2020 2020 2020 2020 2022 7669 6e64 6578           "vindex
+00010be0: 2064 6f65 7320 6e6f 7420 7375 7070 6f72   does not suppor
+00010bf0: 7420 696e 6465 7869 6e67 2077 6974 6820  t indexing with 
+00010c00: 6461 736b 206f 626a 6563 7473 2e20 4361  dask objects. Ca
+00010c10: 6c6c 2063 6f6d 7075 7465 2022 0a20 2020  ll compute ".   
+00010c20: 2020 2020 2020 2020 2020 2020 2022 6f6e               "on
+00010c30: 2074 6865 2069 6e64 6578 6572 2066 6972   the indexer fir
+00010c40: 7374 2074 6f20 6765 7420 616e 2065 7661  st to get an eva
+00010c50: 6c75 7261 7465 6420 6172 7261 792e 2047  lurated array. G
+00010c60: 6f74 3a20 7b7d 222e 666f 726d 6174 286b  ot: {}".format(k
+00010c70: 6579 290a 2020 2020 2020 2020 2020 2020  ey).            
+00010c80: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00010c90: 205f 7669 6e64 6578 2873 656c 662c 202a   _vindex(self, *
+00010ca0: 6b65 7929 0a0a 2020 2020 4070 726f 7065  key)..    @prope
+00010cb0: 7274 790a 2020 2020 6465 6620 7669 6e64  rty.    def vind
+00010cc0: 6578 2873 656c 6629 3a0a 2020 2020 2020  ex(self):.      
+00010cd0: 2020 2222 2256 6563 746f 7269 7a65 6420    """Vectorized 
+00010ce0: 696e 6465 7869 6e67 2077 6974 6820 6272  indexing with br
+00010cf0: 6f61 6463 6173 7469 6e67 2e0a 0a20 2020  oadcasting...   
+00010d00: 2020 2020 2054 6869 7320 6973 2065 7175       This is equ
+00010d10: 6976 616c 656e 7420 746f 206e 756d 7079  ivalent to numpy
+00010d20: 2773 2061 6476 616e 6365 6420 696e 6465  's advanced inde
+00010d30: 7869 6e67 2c20 7573 696e 6720 6172 7261  xing, using arra
+00010d40: 7973 2074 6861 7420 6172 650a 2020 2020  ys that are.    
+00010d50: 2020 2020 6272 6f61 6463 6173 7420 6167      broadcast ag
+00010d60: 6169 6e73 7420 6561 6368 206f 7468 6572  ainst each other
+00010d70: 2e20 5468 6973 2061 6c6c 6f77 7320 666f  . This allows fo
+00010d80: 7220 706f 696e 7477 6973 6520 696e 6465  r pointwise inde
+00010d90: 7869 6e67 3a0a 0a20 2020 2020 2020 203e  xing:..        >
+00010da0: 3e3e 2069 6d70 6f72 7420 6461 736b 2e61  >> import dask.a
+00010db0: 7272 6179 2061 7320 6461 0a20 2020 2020  rray as da.     
+00010dc0: 2020 203e 3e3e 2078 203d 206e 702e 6172     >>> x = np.ar
+00010dd0: 7261 7928 5b5b 312c 2032 2c20 335d 2c20  ray([[1, 2, 3], 
+00010de0: 5b34 2c20 352c 2036 5d2c 205b 372c 2038  [4, 5, 6], [7, 8
+00010df0: 2c20 395d 5d29 0a20 2020 2020 2020 203e  , 9]]).        >
+00010e00: 3e3e 2078 203d 2064 612e 6672 6f6d 5f61  >> x = da.from_a
+00010e10: 7272 6179 2878 2c20 6368 756e 6b73 3d32  rray(x, chunks=2
+00010e20: 290a 2020 2020 2020 2020 3e3e 3e20 782e  ).        >>> x.
+00010e30: 7669 6e64 6578 5b5b 302c 2031 2c20 325d  vindex[[0, 1, 2]
+00010e40: 2c20 5b30 2c20 312c 2032 5d5d 2e63 6f6d  , [0, 1, 2]].com
+00010e50: 7075 7465 2829 0a20 2020 2020 2020 2061  pute().        a
+00010e60: 7272 6179 285b 312c 2035 2c20 395d 290a  rray([1, 5, 9]).
+00010e70: 0a20 2020 2020 2020 204d 6978 6564 2062  .        Mixed b
+00010e80: 6173 6963 2f61 6476 616e 6365 6420 696e  asic/advanced in
+00010e90: 6465 7869 6e67 2077 6974 6820 736c 6963  dexing with slic
+00010ea0: 6573 2f61 7272 6179 7320 6973 2061 6c73  es/arrays is als
+00010eb0: 6f20 7375 7070 6f72 7465 642e 2054 6865  o supported. The
+00010ec0: 0a20 2020 2020 2020 206f 7264 6572 206f  .        order o
+00010ed0: 6620 6469 6d65 6e73 696f 6e73 2069 6e20  f dimensions in 
+00010ee0: 7468 6520 7265 7375 6c74 2066 6f6c 6c6f  the result follo
+00010ef0: 7773 2074 686f 7365 2070 726f 706f 7365  ws those propose
+00010f00: 6420 666f 720a 2020 2020 2020 2020 606e  d for.        `n
+00010f10: 6461 7272 6179 2e76 696e 6465 7820 3c68  darray.vindex <h
+00010f20: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00010f30: 6d2f 6e75 6d70 792f 6e75 6d70 792f 7075  m/numpy/numpy/pu
+00010f40: 6c6c 2f36 3235 363e 605f 3a0a 2020 2020  ll/6256>`_:.    
+00010f50: 2020 2020 7468 6520 7375 6273 7061 6365      the subspace
+00010f60: 2073 7061 6e6e 6564 2062 7920 6172 7261   spanned by arra
+00010f70: 7973 2069 7320 666f 6c6c 6f77 6564 2062  ys is followed b
+00010f80: 7920 616c 6c20 736c 6963 6573 2e0a 0a20  y all slices... 
+00010f90: 2020 2020 2020 204e 6f74 653a 2060 6076         Note: ``v
+00010fa0: 696e 6465 7860 6020 7072 6f76 6964 6573  index`` provides
+00010fb0: 206d 6f72 6520 6765 6e65 7261 6c20 6675   more general fu
+00010fc0: 6e63 7469 6f6e 616c 6974 7920 7468 616e  nctionality than
+00010fd0: 2073 7461 6e64 6172 640a 2020 2020 2020   standard.      
+00010fe0: 2020 696e 6465 7869 6e67 2c20 6275 7420    indexing, but 
+00010ff0: 6974 2061 6c73 6f20 6861 7320 6665 7765  it also has fewe
+00011000: 7220 6f70 7469 6d69 7a61 7469 6f6e 7320  r optimizations 
+00011010: 616e 6420 6361 6e20 6265 2073 6967 6e69  and can be signi
+00011020: 6669 6361 6e74 6c79 0a20 2020 2020 2020  ficantly.       
+00011030: 2073 6c6f 7765 722e 0a20 2020 2020 2020   slower..       
+00011040: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+00011050: 7572 6e20 496e 6465 7843 616c 6c61 626c  urn IndexCallabl
+00011060: 6528 7365 6c66 2e5f 7669 6e64 6578 290a  e(self._vindex).
+00011070: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00011080: 2020 2064 6566 2062 6c6f 636b 7328 7365     def blocks(se
+00011090: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+000110a0: 416e 2061 7272 6179 2d6c 696b 6520 696e  An array-like in
+000110b0: 7465 7266 6163 6520 746f 2074 6865 2062  terface to the b
+000110c0: 6c6f 636b 7320 6f66 2061 6e20 6172 7261  locks of an arra
+000110d0: 792e 0a0a 2020 2020 2020 2020 5468 6973  y...        This
+000110e0: 2072 6574 7572 6e73 2061 2060 6042 6c6f   returns a ``Blo
+000110f0: 636b 7669 6577 6060 206f 626a 6563 7420  ckview`` object 
+00011100: 7468 6174 2070 726f 7669 6465 7320 616e  that provides an
+00011110: 2061 7272 6179 2d6c 696b 6520 696e 7465   array-like inte
+00011120: 7266 6163 650a 2020 2020 2020 2020 746f  rface.        to
+00011130: 2074 6865 2062 6c6f 636b 7320 6f66 2061   the blocks of a
+00011140: 2064 6173 6b20 6172 7261 792e 2020 4e75   dask array.  Nu
+00011150: 6d70 792d 7374 796c 6520 696e 6465 7869  mpy-style indexi
+00011160: 6e67 206f 6620 6120 6060 426c 6f63 6b76  ng of a ``Blockv
+00011170: 6965 7760 6020 6f62 6a65 6374 0a20 2020  iew`` object.   
+00011180: 2020 2020 2072 6574 7572 6e73 2061 2073       returns a s
+00011190: 656c 6563 7469 6f6e 206f 6620 626c 6f63  election of bloc
+000111a0: 6b73 2061 7320 6120 6e65 7720 6461 736b  ks as a new dask
+000111b0: 2061 7272 6179 2e0a 0a20 2020 2020 2020   array...       
+000111c0: 2059 6f75 2063 616e 2069 6e64 6578 2060   You can index `
+000111d0: 6061 7272 6179 2e62 6c6f 636b 7360 6020  `array.blocks`` 
+000111e0: 6c69 6b65 2061 206e 756d 7079 2061 7272  like a numpy arr
+000111f0: 6179 206f 6620 7368 6170 650a 2020 2020  ay of shape.    
+00011200: 2020 2020 6571 7561 6c20 746f 2074 6865      equal to the
+00011210: 206e 756d 6265 7220 6f66 2062 6c6f 636b   number of block
+00011220: 7320 696e 2065 6163 6820 6469 6d65 6e73  s in each dimens
+00011230: 696f 6e2c 2028 6176 6169 6c61 626c 6520  ion, (available 
+00011240: 6173 0a20 2020 2020 2020 2061 7272 6179  as.        array
+00011250: 2e62 6c6f 636b 732e 7369 7a65 292e 2020  .blocks.size).  
+00011260: 5468 6520 6469 6d65 6e73 696f 6e61 6c69  The dimensionali
+00011270: 7479 206f 6620 7468 6520 6f75 7470 7574  ty of the output
+00011280: 2061 7272 6179 206d 6174 6368 6573 0a20   array matches. 
+00011290: 2020 2020 2020 2074 6865 2064 696d 656e         the dimen
+000112a0: 7369 6f6e 206f 6620 7468 6973 2061 7272  sion of this arr
+000112b0: 6179 2c20 6576 656e 2069 6620 696e 7465  ay, even if inte
+000112c0: 6765 7220 696e 6469 6365 7320 6172 6520  ger indices are 
+000112d0: 7061 7373 6564 2e0a 2020 2020 2020 2020  passed..        
+000112e0: 536c 6963 696e 6720 7769 7468 2060 606e  Slicing with ``n
+000112f0: 702e 6e65 7761 7869 7360 6020 6f72 206d  p.newaxis`` or m
+00011300: 756c 7469 706c 6520 6c69 7374 7320 6973  ultiple lists is
+00011310: 206e 6f74 2073 7570 706f 7274 6564 2e0a   not supported..
+00011320: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00011330: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00011340: 2d2d 0a20 2020 2020 2020 203e 3e3e 2069  --.        >>> i
+00011350: 6d70 6f72 7420 6461 736b 2e61 7272 6179  mport dask.array
+00011360: 2061 7320 6461 0a20 2020 2020 2020 203e   as da.        >
+00011370: 3e3e 2078 203d 2064 612e 6172 616e 6765  >> x = da.arange
+00011380: 2838 2c20 6368 756e 6b73 3d32 290a 2020  (8, chunks=2).  
+00011390: 2020 2020 2020 3e3e 3e20 782e 626c 6f63        >>> x.bloc
+000113a0: 6b73 2e73 6861 7065 2023 2061 6c69 6173  ks.shape # alias
+000113b0: 6573 2078 2e6e 756d 626c 6f63 6b73 0a20  es x.numblocks. 
+000113c0: 2020 2020 2020 2028 342c 290a 2020 2020         (4,).    
+000113d0: 2020 2020 3e3e 3e20 782e 626c 6f63 6b73      >>> x.blocks
+000113e0: 5b30 5d2e 636f 6d70 7574 6528 290a 2020  [0].compute().  
+000113f0: 2020 2020 2020 6172 7261 7928 5b30 2c20        array([0, 
+00011400: 315d 290a 2020 2020 2020 2020 3e3e 3e20  1]).        >>> 
+00011410: 782e 626c 6f63 6b73 5b3a 335d 2e63 6f6d  x.blocks[:3].com
+00011420: 7075 7465 2829 0a20 2020 2020 2020 2061  pute().        a
+00011430: 7272 6179 285b 302c 2031 2c20 322c 2033  rray([0, 1, 2, 3
+00011440: 2c20 342c 2035 5d29 0a20 2020 2020 2020  , 4, 5]).       
+00011450: 203e 3e3e 2078 2e62 6c6f 636b 735b 3a3a   >>> x.blocks[::
+00011460: 325d 2e63 6f6d 7075 7465 2829 0a20 2020  2].compute().   
+00011470: 2020 2020 2061 7272 6179 285b 302c 2031       array([0, 1
+00011480: 2c20 342c 2035 5d29 0a20 2020 2020 2020  , 4, 5]).       
+00011490: 203e 3e3e 2078 2e62 6c6f 636b 735b 5b2d   >>> x.blocks[[-
+000114a0: 312c 2030 5d5d 2e63 6f6d 7075 7465 2829  1, 0]].compute()
+000114b0: 0a20 2020 2020 2020 2061 7272 6179 285b  .        array([
+000114c0: 362c 2037 2c20 302c 2031 5d29 0a20 2020  6, 7, 0, 1]).   
+000114d0: 2020 2020 203e 3e3e 2078 2e62 6c6f 636b       >>> x.block
+000114e0: 732e 7261 7665 6c28 2920 2320 646f 6374  s.ravel() # doct
+000114f0: 6573 743a 202b 4e4f 524d 414c 495a 455f  est: +NORMALIZE_
+00011500: 5748 4954 4553 5041 4345 0a20 2020 2020  WHITESPACE.     
+00011510: 2020 205b 6461 736b 2e61 7272 6179 3c62     [dask.array<b
+00011520: 6c6f 636b 732c 2073 6861 7065 3d28 322c  locks, shape=(2,
+00011530: 292c 2064 7479 7065 3d69 6e74 3634 2c20  ), dtype=int64, 
+00011540: 6368 756e 6b73 697a 653d 2832 2c29 2c20  chunksize=(2,), 
+00011550: 6368 756e 6b74 7970 653d 6e75 6d70 792e  chunktype=numpy.
+00011560: 6e64 6172 7261 793e 2c0a 2020 2020 2020  ndarray>,.      
+00011570: 2020 2064 6173 6b2e 6172 7261 793c 626c     dask.array<bl
+00011580: 6f63 6b73 2c20 7368 6170 653d 2832 2c29  ocks, shape=(2,)
+00011590: 2c20 6474 7970 653d 696e 7436 342c 2063  , dtype=int64, c
+000115a0: 6875 6e6b 7369 7a65 3d28 322c 292c 2063  hunksize=(2,), c
+000115b0: 6875 6e6b 7479 7065 3d6e 756d 7079 2e6e  hunktype=numpy.n
+000115c0: 6461 7272 6179 3e2c 0a20 2020 2020 2020  darray>,.       
+000115d0: 2020 6461 736b 2e61 7272 6179 3c62 6c6f    dask.array<blo
+000115e0: 636b 732c 2073 6861 7065 3d28 322c 292c  cks, shape=(2,),
+000115f0: 2064 7479 7065 3d69 6e74 3634 2c20 6368   dtype=int64, ch
+00011600: 756e 6b73 697a 653d 2832 2c29 2c20 6368  unksize=(2,), ch
+00011610: 756e 6b74 7970 653d 6e75 6d70 792e 6e64  unktype=numpy.nd
+00011620: 6172 7261 793e 2c0a 2020 2020 2020 2020  array>,.        
+00011630: 2064 6173 6b2e 6172 7261 793c 626c 6f63   dask.array<bloc
+00011640: 6b73 2c20 7368 6170 653d 2832 2c29 2c20  ks, shape=(2,), 
+00011650: 6474 7970 653d 696e 7436 342c 2063 6875  dtype=int64, chu
+00011660: 6e6b 7369 7a65 3d28 322c 292c 2063 6875  nksize=(2,), chu
+00011670: 6e6b 7479 7065 3d6e 756d 7079 2e6e 6461  nktype=numpy.nda
+00011680: 7272 6179 3e5d 0a0a 2020 2020 2020 2020  rray>]..        
+00011690: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+000116a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000116b0: 416e 2069 6e73 7461 6e63 6520 6f66 2060  An instance of `
+000116c0: 6064 6173 6b2e 6172 7261 792e 426c 6f63  `dask.array.Bloc
+000116d0: 6b76 6965 7760 600a 2020 2020 2020 2020  kview``.        
+000116e0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+000116f0: 726e 2042 6c6f 636b 5669 6577 2873 656c  rn BlockView(sel
+00011700: 6629 0a0a 2020 2020 4070 726f 7065 7274  f)..    @propert
+00011710: 790a 2020 2020 6465 6620 7061 7274 6974  y.    def partit
+00011720: 696f 6e73 2873 656c 6629 3a0a 2020 2020  ions(self):.    
+00011730: 2020 2020 2222 2253 6c69 6365 2061 6e20      """Slice an 
+00011740: 6172 7261 7920 6279 2070 6172 7469 7469  array by partiti
+00011750: 6f6e 732e 2041 6c69 6173 206f 6620 6461  ons. Alias of da
+00011760: 736b 2061 7272 6179 202e 626c 6f63 6b73  sk array .blocks
+00011770: 2061 7474 7269 6275 7465 2e0a 0a20 2020   attribute...   
+00011780: 2020 2020 2054 6869 7320 616c 6961 7320       This alias 
+00011790: 616c 6c6f 7773 2079 6f75 2074 6f20 7772  allows you to wr
+000117a0: 6974 6520 6167 6e6f 7374 6963 2063 6f64  ite agnostic cod
+000117b0: 6520 7468 6174 2077 6f72 6b73 2077 6974  e that works wit
+000117c0: 6820 626f 7468 0a20 2020 2020 2020 2064  h both.        d
+000117d0: 6173 6b20 6172 7261 7973 2061 6e64 2064  ask arrays and d
+000117e0: 6173 6b20 6461 7461 6672 616d 6573 2e0a  ask dataframes..
+000117f0: 0a20 2020 2020 2020 2054 6869 7320 7265  .        This re
+00011800: 7475 726e 7320 6120 6060 426c 6f63 6b76  turns a ``Blockv
+00011810: 6965 7760 6020 6f62 6a65 6374 2074 6861  iew`` object tha
+00011820: 7420 7072 6f76 6964 6573 2061 6e20 6172  t provides an ar
+00011830: 7261 792d 6c69 6b65 2069 6e74 6572 6661  ray-like interfa
+00011840: 6365 0a20 2020 2020 2020 2074 6f20 7468  ce.        to th
+00011850: 6520 626c 6f63 6b73 206f 6620 6120 6461  e blocks of a da
+00011860: 736b 2061 7272 6179 2e20 204e 756d 7079  sk array.  Numpy
+00011870: 2d73 7479 6c65 2069 6e64 6578 696e 6720  -style indexing 
+00011880: 6f66 2061 2060 6042 6c6f 636b 7669 6577  of a ``Blockview
+00011890: 6060 206f 626a 6563 740a 2020 2020 2020  `` object.      
+000118a0: 2020 7265 7475 726e 7320 6120 7365 6c65    returns a sele
+000118b0: 6374 696f 6e20 6f66 2062 6c6f 636b 7320  ction of blocks 
+000118c0: 6173 2061 206e 6577 2064 6173 6b20 6172  as a new dask ar
+000118d0: 7261 792e 0a0a 2020 2020 2020 2020 596f  ray...        Yo
+000118e0: 7520 6361 6e20 696e 6465 7820 6060 6172  u can index ``ar
+000118f0: 7261 792e 626c 6f63 6b73 6060 206c 696b  ray.blocks`` lik
+00011900: 6520 6120 6e75 6d70 7920 6172 7261 7920  e a numpy array 
+00011910: 6f66 2073 6861 7065 0a20 2020 2020 2020  of shape.       
+00011920: 2065 7175 616c 2074 6f20 7468 6520 6e75   equal to the nu
+00011930: 6d62 6572 206f 6620 626c 6f63 6b73 2069  mber of blocks i
+00011940: 6e20 6561 6368 2064 696d 656e 7369 6f6e  n each dimension
+00011950: 2c20 2861 7661 696c 6162 6c65 2061 730a  , (available as.
+00011960: 2020 2020 2020 2020 6172 7261 792e 626c          array.bl
+00011970: 6f63 6b73 2e73 697a 6529 2e20 2054 6865  ocks.size).  The
+00011980: 2064 696d 656e 7369 6f6e 616c 6974 7920   dimensionality 
+00011990: 6f66 2074 6865 206f 7574 7075 7420 6172  of the output ar
+000119a0: 7261 7920 6d61 7463 6865 730a 2020 2020  ray matches.    
+000119b0: 2020 2020 7468 6520 6469 6d65 6e73 696f      the dimensio
+000119c0: 6e20 6f66 2074 6869 7320 6172 7261 792c  n of this array,
+000119d0: 2065 7665 6e20 6966 2069 6e74 6567 6572   even if integer
+000119e0: 2069 6e64 6963 6573 2061 7265 2070 6173   indices are pas
+000119f0: 7365 642e 0a20 2020 2020 2020 2053 6c69  sed..        Sli
+00011a00: 6369 6e67 2077 6974 6820 6060 6e70 2e6e  cing with ``np.n
+00011a10: 6577 6178 6973 6060 206f 7220 6d75 6c74  ewaxis`` or mult
+00011a20: 6970 6c65 206c 6973 7473 2069 7320 6e6f  iple lists is no
+00011a30: 7420 7375 7070 6f72 7465 642e 0a0a 2020  t supported...  
+00011a40: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
+00011a50: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+00011a60: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+00011a70: 7274 2064 6173 6b2e 6172 7261 7920 6173  rt dask.array as
+00011a80: 2064 610a 2020 2020 2020 2020 3e3e 3e20   da.        >>> 
+00011a90: 7820 3d20 6461 2e61 7261 6e67 6528 382c  x = da.arange(8,
+00011aa0: 2063 6875 6e6b 733d 3229 0a20 2020 2020   chunks=2).     
+00011ab0: 2020 203e 3e3e 2078 2e70 6172 7469 7469     >>> x.partiti
+00011ac0: 6f6e 732e 7368 6170 6520 2320 616c 6961  ons.shape # alia
+00011ad0: 7365 7320 782e 6e75 6d62 6c6f 636b 730a  ses x.numblocks.
+00011ae0: 2020 2020 2020 2020 2834 2c29 0a20 2020          (4,).   
+00011af0: 2020 2020 203e 3e3e 2078 2e70 6172 7469       >>> x.parti
+00011b00: 7469 6f6e 735b 305d 2e63 6f6d 7075 7465  tions[0].compute
+00011b10: 2829 0a20 2020 2020 2020 2061 7272 6179  ().        array
+00011b20: 285b 302c 2031 5d29 0a20 2020 2020 2020  ([0, 1]).       
+00011b30: 203e 3e3e 2078 2e70 6172 7469 7469 6f6e   >>> x.partition
+00011b40: 735b 3a33 5d2e 636f 6d70 7574 6528 290a  s[:3].compute().
+00011b50: 2020 2020 2020 2020 6172 7261 7928 5b30          array([0
+00011b60: 2c20 312c 2032 2c20 332c 2034 2c20 355d  , 1, 2, 3, 4, 5]
+00011b70: 290a 2020 2020 2020 2020 3e3e 3e20 782e  ).        >>> x.
+00011b80: 7061 7274 6974 696f 6e73 5b3a 3a32 5d2e  partitions[::2].
+00011b90: 636f 6d70 7574 6528 290a 2020 2020 2020  compute().      
+00011ba0: 2020 6172 7261 7928 5b30 2c20 312c 2034    array([0, 1, 4
+00011bb0: 2c20 355d 290a 2020 2020 2020 2020 3e3e  , 5]).        >>
+00011bc0: 3e20 782e 7061 7274 6974 696f 6e73 5b5b  > x.partitions[[
+00011bd0: 2d31 2c20 305d 5d2e 636f 6d70 7574 6528  -1, 0]].compute(
+00011be0: 290a 2020 2020 2020 2020 6172 7261 7928  ).        array(
+00011bf0: 5b36 2c20 372c 2030 2c20 315d 290a 2020  [6, 7, 0, 1]).  
+00011c00: 2020 2020 2020 3e3e 3e20 782e 7061 7274        >>> x.part
+00011c10: 6974 696f 6e73 2e72 6176 656c 2829 2023  itions.ravel() #
+00011c20: 2064 6f63 7465 7374 3a20 2b4e 4f52 4d41   doctest: +NORMA
+00011c30: 4c49 5a45 5f57 4849 5445 5350 4143 450a  LIZE_WHITESPACE.
+00011c40: 2020 2020 2020 2020 5b64 6173 6b2e 6172          [dask.ar
+00011c50: 7261 793c 626c 6f63 6b73 2c20 7368 6170  ray<blocks, shap
+00011c60: 653d 2832 2c29 2c20 6474 7970 653d 696e  e=(2,), dtype=in
+00011c70: 7436 342c 2063 6875 6e6b 7369 7a65 3d28  t64, chunksize=(
+00011c80: 322c 292c 2063 6875 6e6b 7479 7065 3d6e  2,), chunktype=n
+00011c90: 756d 7079 2e6e 6461 7272 6179 3e2c 0a20  umpy.ndarray>,. 
+00011ca0: 2020 2020 2020 2020 6461 736b 2e61 7272          dask.arr
+00011cb0: 6179 3c62 6c6f 636b 732c 2073 6861 7065  ay<blocks, shape
+00011cc0: 3d28 322c 292c 2064 7479 7065 3d69 6e74  =(2,), dtype=int
+00011cd0: 3634 2c20 6368 756e 6b73 697a 653d 2832  64, chunksize=(2
+00011ce0: 2c29 2c20 6368 756e 6b74 7970 653d 6e75  ,), chunktype=nu
+00011cf0: 6d70 792e 6e64 6172 7261 793e 2c0a 2020  mpy.ndarray>,.  
+00011d00: 2020 2020 2020 2064 6173 6b2e 6172 7261         dask.arra
+00011d10: 793c 626c 6f63 6b73 2c20 7368 6170 653d  y<blocks, shape=
+00011d20: 2832 2c29 2c20 6474 7970 653d 696e 7436  (2,), dtype=int6
+00011d30: 342c 2063 6875 6e6b 7369 7a65 3d28 322c  4, chunksize=(2,
+00011d40: 292c 2063 6875 6e6b 7479 7065 3d6e 756d  ), chunktype=num
+00011d50: 7079 2e6e 6461 7272 6179 3e2c 0a20 2020  py.ndarray>,.   
+00011d60: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
+00011d70: 3c62 6c6f 636b 732c 2073 6861 7065 3d28  <blocks, shape=(
+00011d80: 322c 292c 2064 7479 7065 3d69 6e74 3634  2,), dtype=int64
+00011d90: 2c20 6368 756e 6b73 697a 653d 2832 2c29  , chunksize=(2,)
+00011da0: 2c20 6368 756e 6b74 7970 653d 6e75 6d70  , chunktype=nump
+00011db0: 792e 6e64 6172 7261 793e 5d0a 0a20 2020  y.ndarray>]..   
+00011dc0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+00011dd0: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+00011de0: 2020 2020 2041 6e20 696e 7374 616e 6365       An instance
+00011df0: 206f 6620 6060 6461 2e61 7272 6179 2e42   of ``da.array.B
+00011e00: 6c6f 636b 7669 6577 6060 0a20 2020 2020  lockview``.     
+00011e10: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00011e20: 6574 7572 6e20 7365 6c66 2e62 6c6f 636b  eturn self.block
+00011e30: 730a 0a20 2020 2064 6566 2064 6f74 2873  s..    def dot(s
+00011e40: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
+00011e50: 2020 2020 2022 2222 446f 7420 7072 6f64       """Dot prod
+00011e60: 7563 7420 6f66 2073 656c 6620 616e 6420  uct of self and 
+00011e70: 6f74 6865 722e 0a0a 2020 2020 2020 2020  other...        
+00011e80: 5265 6665 7220 746f 203a 6675 6e63 3a60  Refer to :func:`
+00011e90: 6461 736b 2e61 7272 6179 2e74 656e 736f  dask.array.tenso
+00011ea0: 7264 6f74 6020 666f 7220 6675 6c6c 2064  rdot` for full d
+00011eb0: 6f63 756d 656e 7461 7469 6f6e 2e0a 0a20  ocumentation... 
+00011ec0: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+00011ed0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00011ee0: 0a20 2020 2020 2020 2064 6173 6b2e 6172  .        dask.ar
+00011ef0: 7261 792e 646f 7420 3a20 6571 7569 7661  ray.dot : equiva
+00011f00: 6c65 6e74 2066 756e 6374 696f 6e0a 2020  lent function.  
+00011f10: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00011f20: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
+00011f30: 792e 726f 7574 696e 6573 2069 6d70 6f72  y.routines impor
+00011f40: 7420 7465 6e73 6f72 646f 740a 0a20 2020  t tensordot..   
+00011f50: 2020 2020 2072 6574 7572 6e20 7465 6e73       return tens
+00011f60: 6f72 646f 7428 7365 6c66 2c20 6f74 6865  ordot(self, othe
+00011f70: 722c 2061 7865 733d 2828 7365 6c66 2e6e  r, axes=((self.n
+00011f80: 6469 6d20 2d20 312c 292c 2028 6f74 6865  dim - 1,), (othe
+00011f90: 722e 6e64 696d 202d 2032 2c29 2929 0a0a  r.ndim - 2,)))..
+00011fa0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00011fb0: 2020 6465 6620 4128 7365 6c66 293a 0a20    def A(self):. 
+00011fc0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00011fd0: 6c66 0a0a 2020 2020 4070 726f 7065 7274  lf..    @propert
+00011fe0: 790a 2020 2020 6465 6620 5428 7365 6c66  y.    def T(self
+00011ff0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00012000: 6e20 7365 6c66 2e74 7261 6e73 706f 7365  n self.transpose
+00012010: 2829 0a0a 2020 2020 6465 6620 7472 616e  ()..    def tran
+00012020: 7370 6f73 6528 7365 6c66 2c20 2a61 7865  spose(self, *axe
+00012030: 7329 3a0a 2020 2020 2020 2020 2222 2252  s):.        """R
+00012040: 6576 6572 7365 206f 7220 7065 726d 7574  everse or permut
+00012050: 6520 7468 6520 6178 6573 206f 6620 616e  e the axes of an
+00012060: 2061 7272 6179 2e20 5265 7475 726e 2074   array. Return t
+00012070: 6865 206d 6f64 6966 6965 6420 6172 7261  he modified arra
+00012080: 792e 0a0a 2020 2020 2020 2020 5265 6665  y...        Refe
+00012090: 7220 746f 203a 6675 6e63 3a60 6461 736b  r to :func:`dask
+000120a0: 2e61 7272 6179 2e74 7261 6e73 706f 7365  .array.transpose
+000120b0: 6020 666f 7220 6675 6c6c 2064 6f63 756d  ` for full docum
+000120c0: 656e 7461 7469 6f6e 2e0a 0a20 2020 2020  entation...     
+000120d0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+000120e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+000120f0: 2020 2020 2064 6173 6b2e 6172 7261 792e       dask.array.
+00012100: 7472 616e 7370 6f73 6520 3a20 6571 7569  transpose : equi
+00012110: 7661 6c65 6e74 2066 756e 6374 696f 6e0a  valent function.
+00012120: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00012130: 2020 2020 6672 6f6d 2064 6173 6b2e 6172      from dask.ar
+00012140: 7261 792e 726f 7574 696e 6573 2069 6d70  ray.routines imp
+00012150: 6f72 7420 7472 616e 7370 6f73 650a 0a20  ort transpose.. 
+00012160: 2020 2020 2020 2069 6620 6e6f 7420 6178         if not ax
+00012170: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00012180: 6178 6573 203d 204e 6f6e 650a 2020 2020  axes = None.    
+00012190: 2020 2020 656c 6966 206c 656e 2861 7865      elif len(axe
+000121a0: 7329 203d 3d20 3120 616e 6420 6973 696e  s) == 1 and isin
+000121b0: 7374 616e 6365 2861 7865 735b 305d 2c20  stance(axes[0], 
+000121c0: 4974 6572 6162 6c65 293a 0a20 2020 2020  Iterable):.     
+000121d0: 2020 2020 2020 2061 7865 7320 3d20 6178         axes = ax
+000121e0: 6573 5b30 5d0a 2020 2020 2020 2020 6966  es[0].        if
+000121f0: 2028 6178 6573 203d 3d20 7475 706c 6528   (axes == tuple(
+00012200: 7261 6e67 6528 7365 6c66 2e6e 6469 6d29  range(self.ndim)
+00012210: 2929 206f 7220 2861 7865 7320 3d3d 2074  )) or (axes == t
+00012220: 7570 6c65 2872 616e 6765 282d 7365 6c66  uple(range(-self
+00012230: 2e6e 6469 6d2c 2030 2929 293a 0a20 2020  .ndim, 0))):.   
+00012240: 2020 2020 2020 2020 2023 206e 6f20 7472           # no tr
+00012250: 616e 7370 6f73 6520 6e65 6365 7373 6172  anspose necessar
+00012260: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
+00012270: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
+00012280: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00012290: 2020 2020 7265 7475 726e 2074 7261 6e73      return trans
+000122a0: 706f 7365 2873 656c 662c 2061 7865 733d  pose(self, axes=
+000122b0: 6178 6573 290a 0a20 2020 2064 6566 2072  axes)..    def r
+000122c0: 6176 656c 2873 656c 6629 3a0a 2020 2020  avel(self):.    
+000122d0: 2020 2020 2222 2252 6574 7572 6e20 6120      """Return a 
+000122e0: 666c 6174 7465 6e65 6420 6172 7261 792e  flattened array.
+000122f0: 0a0a 2020 2020 2020 2020 5265 6665 7220  ..        Refer 
+00012300: 746f 203a 6675 6e63 3a60 6461 736b 2e61  to :func:`dask.a
+00012310: 7272 6179 2e72 6176 656c 6020 666f 7220  rray.ravel` for 
+00012320: 6675 6c6c 2064 6f63 756d 656e 7461 7469  full documentati
+00012330: 6f6e 2e0a 0a20 2020 2020 2020 2053 6565  on...        See
+00012340: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
+00012350: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+00012360: 6173 6b2e 6172 7261 792e 7261 7665 6c20  ask.array.ravel 
+00012370: 3a20 6571 7569 7661 6c65 6e74 2066 756e  : equivalent fun
+00012380: 6374 696f 6e0a 2020 2020 2020 2020 2222  ction.        ""
+00012390: 220a 2020 2020 2020 2020 6672 6f6d 2064  ".        from d
+000123a0: 6173 6b2e 6172 7261 792e 726f 7574 696e  ask.array.routin
+000123b0: 6573 2069 6d70 6f72 7420 7261 7665 6c0a  es import ravel.
+000123c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000123d0: 7261 7665 6c28 7365 6c66 290a 0a20 2020  ravel(self)..   
+000123e0: 2066 6c61 7474 656e 203d 2072 6176 656c   flatten = ravel
+000123f0: 0a0a 2020 2020 6465 6620 6368 6f6f 7365  ..    def choose
+00012400: 2873 656c 662c 2063 686f 6963 6573 293a  (self, choices):
+00012410: 0a20 2020 2020 2020 2022 2222 5573 6520  .        """Use 
+00012420: 616e 2069 6e64 6578 2061 7272 6179 2074  an index array t
+00012430: 6f20 636f 6e73 7472 7563 7420 6120 6e65  o construct a ne
+00012440: 7720 6172 7261 7920 6672 6f6d 2061 2073  w array from a s
+00012450: 6574 206f 6620 6368 6f69 6365 732e 0a0a  et of choices...
+00012460: 2020 2020 2020 2020 5265 6665 7220 746f          Refer to
+00012470: 203a 6675 6e63 3a60 6461 736b 2e61 7272   :func:`dask.arr
+00012480: 6179 2e63 686f 6f73 6560 2066 6f72 2066  ay.choose` for f
+00012490: 756c 6c20 646f 6375 6d65 6e74 6174 696f  ull documentatio
+000124a0: 6e2e 0a0a 2020 2020 2020 2020 5365 6520  n...        See 
+000124b0: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+000124c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
+000124d0: 736b 2e61 7272 6179 2e63 686f 6f73 6520  sk.array.choose 
+000124e0: 3a20 6571 7569 7661 6c65 6e74 2066 756e  : equivalent fun
+000124f0: 6374 696f 6e0a 2020 2020 2020 2020 2222  ction.        ""
+00012500: 220a 2020 2020 2020 2020 6672 6f6d 2064  ".        from d
+00012510: 6173 6b2e 6172 7261 792e 726f 7574 696e  ask.array.routin
+00012520: 6573 2069 6d70 6f72 7420 6368 6f6f 7365  es import choose
+00012530: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00012540: 2063 686f 6f73 6528 7365 6c66 2c20 6368   choose(self, ch
+00012550: 6f69 6365 7329 0a0a 2020 2020 6465 6620  oices)..    def 
+00012560: 7265 7368 6170 6528 7365 6c66 2c20 2a73  reshape(self, *s
+00012570: 6861 7065 2c20 6d65 7267 655f 6368 756e  hape, merge_chun
+00012580: 6b73 3d54 7275 652c 206c 696d 6974 3d4e  ks=True, limit=N
+00012590: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
+000125a0: 2252 6573 6861 7065 2061 7272 6179 2074  "Reshape array t
+000125b0: 6f20 6e65 7720 7368 6170 650a 0a20 2020  o new shape..   
+000125c0: 2020 2020 2052 6566 6572 2074 6f20 3a66       Refer to :f
+000125d0: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
+000125e0: 7265 7368 6170 6560 2066 6f72 2066 756c  reshape` for ful
+000125f0: 6c20 646f 6375 6d65 6e74 6174 696f 6e2e  l documentation.
+00012600: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+00012610: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+00012620: 2d2d 2d0a 2020 2020 2020 2020 6461 736b  ---.        dask
+00012630: 2e61 7272 6179 2e72 6573 6861 7065 203a  .array.reshape :
+00012640: 2065 7175 6976 616c 656e 7420 6675 6e63   equivalent func
+00012650: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
+00012660: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00012670: 736b 2e61 7272 6179 2e72 6573 6861 7065  sk.array.reshape
+00012680: 2069 6d70 6f72 7420 7265 7368 6170 650a   import reshape.
+00012690: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+000126a0: 7368 6170 6529 203d 3d20 3120 616e 6420  shape) == 1 and 
+000126b0: 6e6f 7420 6973 696e 7374 616e 6365 2873  not isinstance(s
+000126c0: 6861 7065 5b30 5d2c 204e 756d 6265 7229  hape[0], Number)
+000126d0: 3a0a 2020 2020 2020 2020 2020 2020 7368  :.            sh
+000126e0: 6170 6520 3d20 7368 6170 655b 305d 0a20  ape = shape[0]. 
+000126f0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00012700: 7368 6170 6528 7365 6c66 2c20 7368 6170  shape(self, shap
+00012710: 652c 206d 6572 6765 5f63 6875 6e6b 733d  e, merge_chunks=
+00012720: 6d65 7267 655f 6368 756e 6b73 2c20 6c69  merge_chunks, li
+00012730: 6d69 743d 6c69 6d69 7429 0a0a 2020 2020  mit=limit)..    
+00012740: 6465 6620 746f 706b 2873 656c 662c 206b  def topk(self, k
+00012750: 2c20 6178 6973 3d2d 312c 2073 706c 6974  , axis=-1, split
+00012760: 5f65 7665 7279 3d4e 6f6e 6529 3a0a 2020  _every=None):.  
+00012770: 2020 2020 2020 2222 2254 6865 2074 6f70        """The top
+00012780: 206b 2065 6c65 6d65 6e74 7320 6f66 2061   k elements of a
+00012790: 6e20 6172 7261 792e 0a0a 2020 2020 2020  n array...      
+000127a0: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
+000127b0: 3a60 6461 736b 2e61 7272 6179 2e74 6f70  :`dask.array.top
+000127c0: 6b60 2066 6f72 2066 756c 6c20 646f 6375  k` for full docu
+000127d0: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
+000127e0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+000127f0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00012800: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
+00012810: 2e74 6f70 6b20 3a20 6571 7569 7661 6c65  .topk : equivale
+00012820: 6e74 2066 756e 6374 696f 6e0a 2020 2020  nt function.    
+00012830: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00012840: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
+00012850: 7265 6475 6374 696f 6e73 2069 6d70 6f72  reductions impor
+00012860: 7420 746f 706b 0a0a 2020 2020 2020 2020  t topk..        
+00012870: 7265 7475 726e 2074 6f70 6b28 7365 6c66  return topk(self
+00012880: 2c20 6b2c 2061 7869 733d 6178 6973 2c20  , k, axis=axis, 
+00012890: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+000128a0: 745f 6576 6572 7929 0a0a 2020 2020 6465  t_every)..    de
+000128b0: 6620 6172 6774 6f70 6b28 7365 6c66 2c20  f argtopk(self, 
+000128c0: 6b2c 2061 7869 733d 2d31 2c20 7370 6c69  k, axis=-1, spli
+000128d0: 745f 6576 6572 793d 4e6f 6e65 293a 0a20  t_every=None):. 
+000128e0: 2020 2020 2020 2022 2222 5468 6520 696e         """The in
+000128f0: 6469 6365 7320 6f66 2074 6865 2074 6f70  dices of the top
+00012900: 206b 2065 6c65 6d65 6e74 7320 6f66 2061   k elements of a
+00012910: 6e20 6172 7261 792e 0a0a 2020 2020 2020  n array...      
+00012920: 2020 5265 6665 7220 746f 203a 6675 6e63    Refer to :func
+00012930: 3a60 6461 736b 2e61 7272 6179 2e61 7267  :`dask.array.arg
+00012940: 746f 706b 6020 666f 7220 6675 6c6c 2064  topk` for full d
+00012950: 6f63 756d 656e 7461 7469 6f6e 2e0a 0a20  ocumentation... 
+00012960: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+00012970: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00012980: 0a20 2020 2020 2020 2064 6173 6b2e 6172  .        dask.ar
+00012990: 7261 792e 6172 6774 6f70 6b20 3a20 6571  ray.argtopk : eq
+000129a0: 7569 7661 6c65 6e74 2066 756e 6374 696f  uivalent functio
+000129b0: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
+000129c0: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+000129d0: 6172 7261 792e 7265 6475 6374 696f 6e73  array.reductions
+000129e0: 2069 6d70 6f72 7420 6172 6774 6f70 6b0a   import argtopk.
+000129f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00012a00: 6172 6774 6f70 6b28 7365 6c66 2c20 6b2c  argtopk(self, k,
+00012a10: 2061 7869 733d 6178 6973 2c20 7370 6c69   axis=axis, spli
+00012a20: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00012a30: 6572 7929 0a0a 2020 2020 6465 6620 6173  ery)..    def as
+00012a40: 7479 7065 2873 656c 662c 2064 7479 7065  type(self, dtype
+00012a50: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00012a60: 2020 2020 2022 2222 436f 7079 206f 6620       """Copy of 
+00012a70: 7468 6520 6172 7261 792c 2063 6173 7420  the array, cast 
+00012a80: 746f 2061 2073 7065 6369 6669 6564 2074  to a specified t
+00012a90: 7970 652e 0a0a 2020 2020 2020 2020 5061  ype...        Pa
+00012aa0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00012ab0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00012ac0: 2020 2020 6474 7970 6520 3a20 7374 7220      dtype : str 
+00012ad0: 6f72 2064 7479 7065 0a20 2020 2020 2020  or dtype.       
+00012ae0: 2020 2020 2054 7970 6563 6f64 6520 6f72       Typecode or
+00012af0: 2064 6174 612d 7479 7065 2074 6f20 7768   data-type to wh
+00012b00: 6963 6820 7468 6520 6172 7261 7920 6973  ich the array is
+00012b10: 2063 6173 742e 0a20 2020 2020 2020 2063   cast..        c
+00012b20: 6173 7469 6e67 203a 207b 276e 6f27 2c20  asting : {'no', 
+00012b30: 2765 7175 6976 272c 2027 7361 6665 272c  'equiv', 'safe',
+00012b40: 2027 7361 6d65 5f6b 696e 6427 2c20 2775   'same_kind', 'u
+00012b50: 6e73 6166 6527 7d2c 206f 7074 696f 6e61  nsafe'}, optiona
+00012b60: 6c0a 2020 2020 2020 2020 2020 2020 436f  l.            Co
+00012b70: 6e74 726f 6c73 2077 6861 7420 6b69 6e64  ntrols what kind
+00012b80: 206f 6620 6461 7461 2063 6173 7469 6e67   of data casting
+00012b90: 206d 6179 206f 6363 7572 2e20 4465 6661   may occur. Defa
+00012ba0: 756c 7473 2074 6f20 2775 6e73 6166 6527  ults to 'unsafe'
+00012bb0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00012bc0: 2062 6163 6b77 6172 6473 2063 6f6d 7061   backwards compa
+00012bd0: 7469 6269 6c69 7479 2e0a 0a20 2020 2020  tibility...     
+00012be0: 2020 2020 2020 202a 2027 6e6f 2720 6d65         * 'no' me
+00012bf0: 616e 7320 7468 6520 6461 7461 2074 7970  ans the data typ
+00012c00: 6573 2073 686f 756c 6420 6e6f 7420 6265  es should not be
+00012c10: 2063 6173 7420 6174 2061 6c6c 2e0a 2020   cast at all..  
+00012c20: 2020 2020 2020 2020 2020 2a20 2765 7175            * 'equ
+00012c30: 6976 2720 6d65 616e 7320 6f6e 6c79 2062  iv' means only b
+00012c40: 7974 652d 6f72 6465 7220 6368 616e 6765  yte-order change
+00012c50: 7320 6172 6520 616c 6c6f 7765 642e 0a20  s are allowed.. 
+00012c60: 2020 2020 2020 2020 2020 202a 2027 7361             * 'sa
+00012c70: 6665 2720 6d65 616e 7320 6f6e 6c79 2063  fe' means only c
+00012c80: 6173 7473 2077 6869 6368 2063 616e 2070  asts which can p
+00012c90: 7265 7365 7276 6520 7661 6c75 6573 2061  reserve values a
+00012ca0: 7265 2061 6c6c 6f77 6564 2e0a 2020 2020  re allowed..    
+00012cb0: 2020 2020 2020 2020 2a20 2773 616d 655f          * 'same_
+00012cc0: 6b69 6e64 2720 6d65 616e 7320 6f6e 6c79  kind' means only
+00012cd0: 2073 6166 6520 6361 7374 7320 6f72 2063   safe casts or c
+00012ce0: 6173 7473 2077 6974 6869 6e20 6120 6b69  asts within a ki
+00012cf0: 6e64 2c0a 2020 2020 2020 2020 2020 2020  nd,.            
+00012d00: 2020 2020 6c69 6b65 2066 6c6f 6174 3634      like float64
+00012d10: 2074 6f20 666c 6f61 7433 322c 2061 7265   to float32, are
+00012d20: 2061 6c6c 6f77 6564 2e0a 2020 2020 2020   allowed..      
+00012d30: 2020 2020 2020 2a20 2775 6e73 6166 6527        * 'unsafe'
+00012d40: 206d 6561 6e73 2061 6e79 2064 6174 6120   means any data 
+00012d50: 636f 6e76 6572 7369 6f6e 7320 6d61 7920  conversions may 
+00012d60: 6265 2064 6f6e 652e 0a20 2020 2020 2020  be done..       
+00012d70: 2063 6f70 7920 3a20 626f 6f6c 2c20 6f70   copy : bool, op
+00012d80: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00012d90: 2020 2042 7920 6465 6661 756c 742c 2061     By default, a
+00012da0: 7374 7970 6520 616c 7761 7973 2072 6574  stype always ret
+00012db0: 7572 6e73 2061 206e 6577 6c79 2061 6c6c  urns a newly all
+00012dc0: 6f63 6174 6564 2061 7272 6179 2e20 4966  ocated array. If
+00012dd0: 2074 6869 730a 2020 2020 2020 2020 2020   this.          
+00012de0: 2020 6973 2073 6574 2074 6f20 4661 6c73    is set to Fals
+00012df0: 6520 616e 6420 7468 6520 6064 7479 7065  e and the `dtype
+00012e00: 6020 7265 7175 6972 656d 656e 7420 6973  ` requirement is
+00012e10: 2073 6174 6973 6669 6564 2c20 7468 6520   satisfied, the 
+00012e20: 696e 7075 740a 2020 2020 2020 2020 2020  input.          
+00012e30: 2020 6172 7261 7920 6973 2072 6574 7572    array is retur
+00012e40: 6e65 6420 696e 7374 6561 6420 6f66 2061  ned instead of a
+00012e50: 2063 6f70 792e 0a0a 2020 2020 2020 2020   copy...        
+00012e60: 2020 2020 2e2e 206e 6f74 653a 3a0a 0a20      .. note::.. 
+00012e70: 2020 2020 2020 2020 2020 2020 2020 2044                 D
+00012e80: 6173 6b20 646f 6573 206e 6f74 2072 6573  ask does not res
+00012e90: 7065 6374 2074 6865 2063 6f6e 7469 6775  pect the contigu
+00012ea0: 6f75 7320 6d65 6d6f 7279 206c 6179 6f75  ous memory layou
+00012eb0: 7420 6f66 2074 6865 2061 7272 6179 2c0a  t of the array,.
+00012ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012ed0: 616e 6420 7769 6c6c 2069 676e 6f72 6520  and will ignore 
+00012ee0: 7468 6520 6060 6f72 6465 7260 6020 6b65  the ``order`` ke
+00012ef0: 7977 6f72 6420 6172 6775 6d65 6e74 2e0a  yword argument..
+00012f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012f10: 5468 6520 6465 6661 756c 7420 6f72 6465  The default orde
+00012f20: 7220 6973 2027 4327 2063 6f6e 7469 6775  r is 'C' contigu
+00012f30: 6f75 732e 0a20 2020 2020 2020 2022 2222  ous..        """
+00012f40: 0a20 2020 2020 2020 206b 7761 7267 732e  .        kwargs.
+00012f50: 706f 7028 226f 7264 6572 222c 204e 6f6e  pop("order", Non
+00012f60: 6529 2020 2320 606f 7264 6572 6020 6973  e)  # `order` is
+00012f70: 206e 6f74 2072 6573 7065 6374 6564 2c20   not respected, 
+00012f80: 736f 2077 6520 7265 6d6f 7665 2074 6869  so we remove thi
+00012f90: 7320 6b77 6172 670a 2020 2020 2020 2020  s kwarg.        
+00012fa0: 2320 5363 616c 6172 7320 646f 6e27 7420  # Scalars don't 
+00012fb0: 7461 6b65 2060 6361 7374 696e 6760 206f  take `casting` o
+00012fc0: 7220 6063 6f70 7960 206b 7761 7267 7320  r `copy` kwargs 
+00012fd0: 2d20 6173 2073 7563 6820 7765 206f 6e6c  - as such we onl
+00012fe0: 7920 7061 7373 0a20 2020 2020 2020 2023  y pass.        #
+00012ff0: 2074 6865 6d20 746f 2060 6d61 705f 626c   them to `map_bl
+00013000: 6f63 6b73 6020 6966 2073 7065 6369 6669  ocks` if specifi
+00013010: 6564 2062 7920 7573 6572 2028 6469 6666  ed by user (diff
+00013020: 6572 656e 7420 7468 616e 2064 6566 6175  erent than defau
+00013030: 6c74 7329 2e0a 2020 2020 2020 2020 6578  lts)..        ex
+00013040: 7472 6120 3d20 7365 7428 6b77 6172 6773  tra = set(kwargs
+00013050: 2920 2d20 7b22 6361 7374 696e 6722 2c20  ) - {"casting", 
+00013060: 2263 6f70 7922 7d0a 2020 2020 2020 2020  "copy"}.        
+00013070: 6966 2065 7874 7261 3a0a 2020 2020 2020  if extra:.      
+00013080: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00013090: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000130a0: 2020 2020 2020 2066 2261 7374 7970 6520         f"astype 
+000130b0: 646f 6573 206e 6f74 2074 616b 6520 7468  does not take th
+000130c0: 6520 666f 6c6c 6f77 696e 6720 6b65 7977  e following keyw
+000130d0: 6f72 6420 6172 6775 6d65 6e74 733a 207b  ord arguments: {
+000130e0: 6c69 7374 2865 7874 7261 297d 220a 2020  list(extra)}".  
+000130f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00013100: 2020 2020 6361 7374 696e 6720 3d20 6b77      casting = kw
+00013110: 6172 6773 2e67 6574 2822 6361 7374 696e  args.get("castin
+00013120: 6722 2c20 2275 6e73 6166 6522 290a 2020  g", "unsafe").  
+00013130: 2020 2020 2020 6474 7970 6520 3d20 6e70        dtype = np
+00013140: 2e64 7479 7065 2864 7479 7065 290a 2020  .dtype(dtype).  
+00013150: 2020 2020 2020 6966 2073 656c 662e 6474        if self.dt
+00013160: 7970 6520 3d3d 2064 7479 7065 3a0a 2020  ype == dtype:.  
+00013170: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013180: 2073 656c 660a 2020 2020 2020 2020 656c   self.        el
+00013190: 6966 206e 6f74 206e 702e 6361 6e5f 6361  if not np.can_ca
+000131a0: 7374 2873 656c 662e 6474 7970 652c 2064  st(self.dtype, d
+000131b0: 7479 7065 2c20 6361 7374 696e 673d 6361  type, casting=ca
+000131c0: 7374 696e 6729 3a0a 2020 2020 2020 2020  sting):.        
+000131d0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+000131e0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+000131f0: 2020 2020 2066 2243 616e 6e6f 7420 6361       f"Cannot ca
+00013200: 7374 2061 7272 6179 2066 726f 6d20 7b73  st array from {s
+00013210: 656c 662e 6474 7970 6521 727d 2074 6f20  elf.dtype!r} to 
+00013220: 7b64 7479 7065 2172 7d20 220a 2020 2020  {dtype!r} ".    
+00013230: 2020 2020 2020 2020 2020 2020 6622 6163              f"ac
+00013240: 636f 7264 696e 6720 746f 2074 6865 2072  cording to the r
+00013250: 756c 6520 7b63 6173 7469 6e67 2172 7d22  ule {casting!r}"
+00013260: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00013270: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00013280: 6c66 2e6d 6170 5f62 6c6f 636b 7328 6368  lf.map_blocks(ch
+00013290: 756e 6b2e 6173 7479 7065 2c20 6474 7970  unk.astype, dtyp
+000132a0: 653d 6474 7970 652c 2061 7374 7970 655f  e=dtype, astype_
+000132b0: 6474 7970 653d 6474 7970 652c 202a 2a6b  dtype=dtype, **k
+000132c0: 7761 7267 7329 0a0a 2020 2020 6465 6620  wargs)..    def 
+000132d0: 5f5f 6162 735f 5f28 7365 6c66 293a 0a20  __abs__(self):. 
+000132e0: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
+000132f0: 656d 7769 7365 286f 7065 7261 746f 722e  emwise(operator.
+00013300: 6162 732c 2073 656c 6629 0a0a 2020 2020  abs, self)..    
+00013310: 4063 6865 636b 5f69 665f 6861 6e64 6c65  @check_if_handle
+00013320: 645f 6769 7665 6e5f 6f74 6865 720a 2020  d_given_other.  
+00013330: 2020 6465 6620 5f5f 6164 645f 5f28 7365    def __add__(se
+00013340: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+00013350: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
+00013360: 6973 6528 6f70 6572 6174 6f72 2e61 6464  ise(operator.add
+00013370: 2c20 7365 6c66 2c20 6f74 6865 7229 0a0a  , self, other)..
+00013380: 2020 2020 4063 6865 636b 5f69 665f 6861      @check_if_ha
+00013390: 6e64 6c65 645f 6769 7665 6e5f 6f74 6865  ndled_given_othe
+000133a0: 720a 2020 2020 6465 6620 5f5f 7261 6464  r.    def __radd
+000133b0: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
+000133c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000133d0: 656c 656d 7769 7365 286f 7065 7261 746f  elemwise(operato
+000133e0: 722e 6164 642c 206f 7468 6572 2c20 7365  r.add, other, se
+000133f0: 6c66 290a 0a20 2020 2040 6368 6563 6b5f  lf)..    @check_
+00013400: 6966 5f68 616e 646c 6564 5f67 6976 656e  if_handled_given
+00013410: 5f6f 7468 6572 0a20 2020 2064 6566 205f  _other.    def _
+00013420: 5f61 6e64 5f5f 2873 656c 662c 206f 7468  _and__(self, oth
+00013430: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
+00013440: 7572 6e20 656c 656d 7769 7365 286f 7065  urn elemwise(ope
+00013450: 7261 746f 722e 616e 645f 2c20 7365 6c66  rator.and_, self
+00013460: 2c20 6f74 6865 7229 0a0a 2020 2020 4063  , other)..    @c
+00013470: 6865 636b 5f69 665f 6861 6e64 6c65 645f  heck_if_handled_
+00013480: 6769 7665 6e5f 6f74 6865 720a 2020 2020  given_other.    
+00013490: 6465 6620 5f5f 7261 6e64 5f5f 2873 656c  def __rand__(sel
+000134a0: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
+000134b0: 2020 2072 6574 7572 6e20 656c 656d 7769     return elemwi
+000134c0: 7365 286f 7065 7261 746f 722e 616e 645f  se(operator.and_
+000134d0: 2c20 6f74 6865 722c 2073 656c 6629 0a0a  , other, self)..
+000134e0: 2020 2020 4063 6865 636b 5f69 665f 6861      @check_if_ha
+000134f0: 6e64 6c65 645f 6769 7665 6e5f 6f74 6865  ndled_given_othe
+00013500: 720a 2020 2020 6465 6620 5f5f 6469 765f  r.    def __div_
+00013510: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
+00013520: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+00013530: 6c65 6d77 6973 6528 6f70 6572 6174 6f72  lemwise(operator
+00013540: 2e64 6976 2c20 7365 6c66 2c20 6f74 6865  .div, self, othe
+00013550: 7229 0a0a 2020 2020 4063 6865 636b 5f69  r)..    @check_i
+00013560: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
+00013570: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
+00013580: 7264 6976 5f5f 2873 656c 662c 206f 7468  rdiv__(self, oth
+00013590: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
+000135a0: 7572 6e20 656c 656d 7769 7365 286f 7065  urn elemwise(ope
+000135b0: 7261 746f 722e 6469 762c 206f 7468 6572  rator.div, other
+000135c0: 2c20 7365 6c66 290a 0a20 2020 2040 6368  , self)..    @ch
+000135d0: 6563 6b5f 6966 5f68 616e 646c 6564 5f67  eck_if_handled_g
+000135e0: 6976 656e 5f6f 7468 6572 0a20 2020 2064  iven_other.    d
+000135f0: 6566 205f 5f65 715f 5f28 7365 6c66 2c20  ef __eq__(self, 
+00013600: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+00013610: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
+00013620: 6f70 6572 6174 6f72 2e65 712c 2073 656c  operator.eq, sel
+00013630: 662c 206f 7468 6572 290a 0a20 2020 2040  f, other)..    @
+00013640: 6368 6563 6b5f 6966 5f68 616e 646c 6564  check_if_handled
+00013650: 5f67 6976 656e 5f6f 7468 6572 0a20 2020  _given_other.   
+00013660: 2064 6566 205f 5f67 745f 5f28 7365 6c66   def __gt__(self
+00013670: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
+00013680: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
+00013690: 6528 6f70 6572 6174 6f72 2e67 742c 2073  e(operator.gt, s
+000136a0: 656c 662c 206f 7468 6572 290a 0a20 2020  elf, other)..   
+000136b0: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
+000136c0: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
+000136d0: 2020 2064 6566 205f 5f67 655f 5f28 7365     def __ge__(se
+000136e0: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+000136f0: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
+00013700: 6973 6528 6f70 6572 6174 6f72 2e67 652c  ise(operator.ge,
+00013710: 2073 656c 662c 206f 7468 6572 290a 0a20   self, other).. 
+00013720: 2020 2064 6566 205f 5f69 6e76 6572 745f     def __invert_
+00013730: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00013740: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
+00013750: 286f 7065 7261 746f 722e 696e 7665 7274  (operator.invert
+00013760: 2c20 7365 6c66 290a 0a20 2020 2040 6368  , self)..    @ch
+00013770: 6563 6b5f 6966 5f68 616e 646c 6564 5f67  eck_if_handled_g
+00013780: 6976 656e 5f6f 7468 6572 0a20 2020 2064  iven_other.    d
+00013790: 6566 205f 5f6c 7368 6966 745f 5f28 7365  ef __lshift__(se
+000137a0: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+000137b0: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
+000137c0: 6973 6528 6f70 6572 6174 6f72 2e6c 7368  ise(operator.lsh
+000137d0: 6966 742c 2073 656c 662c 206f 7468 6572  ift, self, other
+000137e0: 290a 0a20 2020 2040 6368 6563 6b5f 6966  )..    @check_if
+000137f0: 5f68 616e 646c 6564 5f67 6976 656e 5f6f  _handled_given_o
+00013800: 7468 6572 0a20 2020 2064 6566 205f 5f72  ther.    def __r
+00013810: 6c73 6869 6674 5f5f 2873 656c 662c 206f  lshift__(self, o
+00013820: 7468 6572 293a 0a20 2020 2020 2020 2072  ther):.        r
+00013830: 6574 7572 6e20 656c 656d 7769 7365 286f  eturn elemwise(o
+00013840: 7065 7261 746f 722e 6c73 6869 6674 2c20  perator.lshift, 
+00013850: 6f74 6865 722c 2073 656c 6629 0a0a 2020  other, self)..  
+00013860: 2020 4063 6865 636b 5f69 665f 6861 6e64    @check_if_hand
+00013870: 6c65 645f 6769 7665 6e5f 6f74 6865 720a  led_given_other.
+00013880: 2020 2020 6465 6620 5f5f 6c74 5f5f 2873      def __lt__(s
+00013890: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
+000138a0: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
+000138b0: 7769 7365 286f 7065 7261 746f 722e 6c74  wise(operator.lt
+000138c0: 2c20 7365 6c66 2c20 6f74 6865 7229 0a0a  , self, other)..
+000138d0: 2020 2020 4063 6865 636b 5f69 665f 6861      @check_if_ha
+000138e0: 6e64 6c65 645f 6769 7665 6e5f 6f74 6865  ndled_given_othe
+000138f0: 720a 2020 2020 6465 6620 5f5f 6c65 5f5f  r.    def __le__
+00013900: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
+00013910: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
+00013920: 656d 7769 7365 286f 7065 7261 746f 722e  emwise(operator.
+00013930: 6c65 2c20 7365 6c66 2c20 6f74 6865 7229  le, self, other)
+00013940: 0a0a 2020 2020 4063 6865 636b 5f69 665f  ..    @check_if_
+00013950: 6861 6e64 6c65 645f 6769 7665 6e5f 6f74  handled_given_ot
+00013960: 6865 720a 2020 2020 6465 6620 5f5f 6d6f  her.    def __mo
+00013970: 645f 5f28 7365 6c66 2c20 6f74 6865 7229  d__(self, other)
+00013980: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00013990: 2065 6c65 6d77 6973 6528 6f70 6572 6174   elemwise(operat
+000139a0: 6f72 2e6d 6f64 2c20 7365 6c66 2c20 6f74  or.mod, self, ot
+000139b0: 6865 7229 0a0a 2020 2020 4063 6865 636b  her)..    @check
+000139c0: 5f69 665f 6861 6e64 6c65 645f 6769 7665  _if_handled_give
+000139d0: 6e5f 6f74 6865 720a 2020 2020 6465 6620  n_other.    def 
+000139e0: 5f5f 726d 6f64 5f5f 2873 656c 662c 206f  __rmod__(self, o
+000139f0: 7468 6572 293a 0a20 2020 2020 2020 2072  ther):.        r
+00013a00: 6574 7572 6e20 656c 656d 7769 7365 286f  eturn elemwise(o
+00013a10: 7065 7261 746f 722e 6d6f 642c 206f 7468  perator.mod, oth
+00013a20: 6572 2c20 7365 6c66 290a 0a20 2020 2040  er, self)..    @
+00013a30: 6368 6563 6b5f 6966 5f68 616e 646c 6564  check_if_handled
+00013a40: 5f67 6976 656e 5f6f 7468 6572 0a20 2020  _given_other.   
+00013a50: 2064 6566 205f 5f6d 756c 5f5f 2873 656c   def __mul__(sel
+00013a60: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
+00013a70: 2020 2072 6574 7572 6e20 656c 656d 7769     return elemwi
+00013a80: 7365 286f 7065 7261 746f 722e 6d75 6c2c  se(operator.mul,
+00013a90: 2073 656c 662c 206f 7468 6572 290a 0a20   self, other).. 
+00013aa0: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
+00013ab0: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
+00013ac0: 0a20 2020 2064 6566 205f 5f72 6d75 6c5f  .    def __rmul_
+00013ad0: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
+00013ae0: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+00013af0: 6c65 6d77 6973 6528 6f70 6572 6174 6f72  lemwise(operator
+00013b00: 2e6d 756c 2c20 6f74 6865 722c 2073 656c  .mul, other, sel
+00013b10: 6629 0a0a 2020 2020 4063 6865 636b 5f69  f)..    @check_i
+00013b20: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
+00013b30: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
+00013b40: 6e65 5f5f 2873 656c 662c 206f 7468 6572  ne__(self, other
+00013b50: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00013b60: 6e20 656c 656d 7769 7365 286f 7065 7261  n elemwise(opera
+00013b70: 746f 722e 6e65 2c20 7365 6c66 2c20 6f74  tor.ne, self, ot
+00013b80: 6865 7229 0a0a 2020 2020 6465 6620 5f5f  her)..    def __
+00013b90: 6e65 675f 5f28 7365 6c66 293a 0a20 2020  neg__(self):.   
+00013ba0: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
+00013bb0: 7769 7365 286f 7065 7261 746f 722e 6e65  wise(operator.ne
+00013bc0: 672c 2073 656c 6629 0a0a 2020 2020 4063  g, self)..    @c
+00013bd0: 6865 636b 5f69 665f 6861 6e64 6c65 645f  heck_if_handled_
+00013be0: 6769 7665 6e5f 6f74 6865 720a 2020 2020  given_other.    
+00013bf0: 6465 6620 5f5f 6f72 5f5f 2873 656c 662c  def __or__(self,
+00013c00: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
+00013c10: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
+00013c20: 286f 7065 7261 746f 722e 6f72 5f2c 2073  (operator.or_, s
+00013c30: 656c 662c 206f 7468 6572 290a 0a20 2020  elf, other)..   
+00013c40: 2064 6566 205f 5f70 6f73 5f5f 2873 656c   def __pos__(sel
+00013c50: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00013c60: 726e 2073 656c 660a 0a20 2020 2040 6368  rn self..    @ch
+00013c70: 6563 6b5f 6966 5f68 616e 646c 6564 5f67  eck_if_handled_g
+00013c80: 6976 656e 5f6f 7468 6572 0a20 2020 2064  iven_other.    d
+00013c90: 6566 205f 5f72 6f72 5f5f 2873 656c 662c  ef __ror__(self,
+00013ca0: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
+00013cb0: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
+00013cc0: 286f 7065 7261 746f 722e 6f72 5f2c 206f  (operator.or_, o
+00013cd0: 7468 6572 2c20 7365 6c66 290a 0a20 2020  ther, self)..   
+00013ce0: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
+00013cf0: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
+00013d00: 2020 2064 6566 205f 5f70 6f77 5f5f 2873     def __pow__(s
+00013d10: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
+00013d20: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
+00013d30: 7769 7365 286f 7065 7261 746f 722e 706f  wise(operator.po
+00013d40: 772c 2073 656c 662c 206f 7468 6572 290a  w, self, other).
+00013d50: 0a20 2020 2040 6368 6563 6b5f 6966 5f68  .    @check_if_h
+00013d60: 616e 646c 6564 5f67 6976 656e 5f6f 7468  andled_given_oth
+00013d70: 6572 0a20 2020 2064 6566 205f 5f72 706f  er.    def __rpo
+00013d80: 775f 5f28 7365 6c66 2c20 6f74 6865 7229  w__(self, other)
+00013d90: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00013da0: 2065 6c65 6d77 6973 6528 6f70 6572 6174   elemwise(operat
+00013db0: 6f72 2e70 6f77 2c20 6f74 6865 722c 2073  or.pow, other, s
+00013dc0: 656c 6629 0a0a 2020 2020 4063 6865 636b  elf)..    @check
+00013dd0: 5f69 665f 6861 6e64 6c65 645f 6769 7665  _if_handled_give
+00013de0: 6e5f 6f74 6865 720a 2020 2020 6465 6620  n_other.    def 
+00013df0: 5f5f 7273 6869 6674 5f5f 2873 656c 662c  __rshift__(self,
+00013e00: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
+00013e10: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
+00013e20: 286f 7065 7261 746f 722e 7273 6869 6674  (operator.rshift
+00013e30: 2c20 7365 6c66 2c20 6f74 6865 7229 0a0a  , self, other)..
+00013e40: 2020 2020 4063 6865 636b 5f69 665f 6861      @check_if_ha
+00013e50: 6e64 6c65 645f 6769 7665 6e5f 6f74 6865  ndled_given_othe
+00013e60: 720a 2020 2020 6465 6620 5f5f 7272 7368  r.    def __rrsh
+00013e70: 6966 745f 5f28 7365 6c66 2c20 6f74 6865  ift__(self, othe
+00013e80: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
+00013e90: 726e 2065 6c65 6d77 6973 6528 6f70 6572  rn elemwise(oper
+00013ea0: 6174 6f72 2e72 7368 6966 742c 206f 7468  ator.rshift, oth
+00013eb0: 6572 2c20 7365 6c66 290a 0a20 2020 2040  er, self)..    @
+00013ec0: 6368 6563 6b5f 6966 5f68 616e 646c 6564  check_if_handled
+00013ed0: 5f67 6976 656e 5f6f 7468 6572 0a20 2020  _given_other.   
+00013ee0: 2064 6566 205f 5f73 7562 5f5f 2873 656c   def __sub__(sel
+00013ef0: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
+00013f00: 2020 2072 6574 7572 6e20 656c 656d 7769     return elemwi
+00013f10: 7365 286f 7065 7261 746f 722e 7375 622c  se(operator.sub,
+00013f20: 2073 656c 662c 206f 7468 6572 290a 0a20   self, other).. 
+00013f30: 2020 2040 6368 6563 6b5f 6966 5f68 616e     @check_if_han
+00013f40: 646c 6564 5f67 6976 656e 5f6f 7468 6572  dled_given_other
+00013f50: 0a20 2020 2064 6566 205f 5f72 7375 625f  .    def __rsub_
+00013f60: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
+00013f70: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+00013f80: 6c65 6d77 6973 6528 6f70 6572 6174 6f72  lemwise(operator
+00013f90: 2e73 7562 2c20 6f74 6865 722c 2073 656c  .sub, other, sel
+00013fa0: 6629 0a0a 2020 2020 4063 6865 636b 5f69  f)..    @check_i
+00013fb0: 665f 6861 6e64 6c65 645f 6769 7665 6e5f  f_handled_given_
+00013fc0: 6f74 6865 720a 2020 2020 6465 6620 5f5f  other.    def __
+00013fd0: 7472 7565 6469 765f 5f28 7365 6c66 2c20  truediv__(self, 
+00013fe0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+00013ff0: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
+00014000: 6f70 6572 6174 6f72 2e74 7275 6564 6976  operator.truediv
+00014010: 2c20 7365 6c66 2c20 6f74 6865 7229 0a0a  , self, other)..
+00014020: 2020 2020 4063 6865 636b 5f69 665f 6861      @check_if_ha
+00014030: 6e64 6c65 645f 6769 7665 6e5f 6f74 6865  ndled_given_othe
+00014040: 720a 2020 2020 6465 6620 5f5f 7274 7275  r.    def __rtru
+00014050: 6564 6976 5f5f 2873 656c 662c 206f 7468  ediv__(self, oth
+00014060: 6572 293a 0a20 2020 2020 2020 2072 6574  er):.        ret
+00014070: 7572 6e20 656c 656d 7769 7365 286f 7065  urn elemwise(ope
+00014080: 7261 746f 722e 7472 7565 6469 762c 206f  rator.truediv, o
+00014090: 7468 6572 2c20 7365 6c66 290a 0a20 2020  ther, self)..   
+000140a0: 2040 6368 6563 6b5f 6966 5f68 616e 646c   @check_if_handl
+000140b0: 6564 5f67 6976 656e 5f6f 7468 6572 0a20  ed_given_other. 
+000140c0: 2020 2064 6566 205f 5f66 6c6f 6f72 6469     def __floordi
+000140d0: 765f 5f28 7365 6c66 2c20 6f74 6865 7229  v__(self, other)
+000140e0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000140f0: 2065 6c65 6d77 6973 6528 6f70 6572 6174   elemwise(operat
+00014100: 6f72 2e66 6c6f 6f72 6469 762c 2073 656c  or.floordiv, sel
+00014110: 662c 206f 7468 6572 290a 0a20 2020 2040  f, other)..    @
+00014120: 6368 6563 6b5f 6966 5f68 616e 646c 6564  check_if_handled
+00014130: 5f67 6976 656e 5f6f 7468 6572 0a20 2020  _given_other.   
+00014140: 2064 6566 205f 5f72 666c 6f6f 7264 6976   def __rfloordiv
+00014150: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
+00014160: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00014170: 656c 656d 7769 7365 286f 7065 7261 746f  elemwise(operato
+00014180: 722e 666c 6f6f 7264 6976 2c20 6f74 6865  r.floordiv, othe
+00014190: 722c 2073 656c 6629 0a0a 2020 2020 4063  r, self)..    @c
+000141a0: 6865 636b 5f69 665f 6861 6e64 6c65 645f  heck_if_handled_
+000141b0: 6769 7665 6e5f 6f74 6865 720a 2020 2020  given_other.    
+000141c0: 6465 6620 5f5f 786f 725f 5f28 7365 6c66  def __xor__(self
+000141d0: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
+000141e0: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
+000141f0: 6528 6f70 6572 6174 6f72 2e78 6f72 2c20  e(operator.xor, 
+00014200: 7365 6c66 2c20 6f74 6865 7229 0a0a 2020  self, other)..  
+00014210: 2020 4063 6865 636b 5f69 665f 6861 6e64    @check_if_hand
+00014220: 6c65 645f 6769 7665 6e5f 6f74 6865 720a  led_given_other.
+00014230: 2020 2020 6465 6620 5f5f 7278 6f72 5f5f      def __rxor__
+00014240: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
+00014250: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
+00014260: 656d 7769 7365 286f 7065 7261 746f 722e  emwise(operator.
+00014270: 786f 722c 206f 7468 6572 2c20 7365 6c66  xor, other, self
+00014280: 290a 0a20 2020 2040 6368 6563 6b5f 6966  )..    @check_if
+00014290: 5f68 616e 646c 6564 5f67 6976 656e 5f6f  _handled_given_o
+000142a0: 7468 6572 0a20 2020 2064 6566 205f 5f6d  ther.    def __m
+000142b0: 6174 6d75 6c5f 5f28 7365 6c66 2c20 6f74  atmul__(self, ot
+000142c0: 6865 7229 3a0a 2020 2020 2020 2020 6672  her):.        fr
+000142d0: 6f6d 2064 6173 6b2e 6172 7261 792e 726f  om dask.array.ro
+000142e0: 7574 696e 6573 2069 6d70 6f72 7420 6d61  utines import ma
+000142f0: 746d 756c 0a0a 2020 2020 2020 2020 7265  tmul..        re
+00014300: 7475 726e 206d 6174 6d75 6c28 7365 6c66  turn matmul(self
+00014310: 2c20 6f74 6865 7229 0a0a 2020 2020 4063  , other)..    @c
+00014320: 6865 636b 5f69 665f 6861 6e64 6c65 645f  heck_if_handled_
+00014330: 6769 7665 6e5f 6f74 6865 720a 2020 2020  given_other.    
+00014340: 6465 6620 5f5f 726d 6174 6d75 6c5f 5f28  def __rmatmul__(
+00014350: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
+00014360: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00014370: 6172 7261 792e 726f 7574 696e 6573 2069  array.routines i
+00014380: 6d70 6f72 7420 6d61 746d 756c 0a0a 2020  mport matmul..  
+00014390: 2020 2020 2020 7265 7475 726e 206d 6174        return mat
+000143a0: 6d75 6c28 6f74 6865 722c 2073 656c 6629  mul(other, self)
+000143b0: 0a0a 2020 2020 4063 6865 636b 5f69 665f  ..    @check_if_
+000143c0: 6861 6e64 6c65 645f 6769 7665 6e5f 6f74  handled_given_ot
+000143d0: 6865 720a 2020 2020 6465 6620 5f5f 6469  her.    def __di
+000143e0: 766d 6f64 5f5f 2873 656c 662c 206f 7468  vmod__(self, oth
+000143f0: 6572 293a 0a20 2020 2020 2020 2066 726f  er):.        fro
+00014400: 6d20 6461 736b 2e61 7272 6179 2e75 6675  m dask.array.ufu
+00014410: 6e63 2069 6d70 6f72 7420 6469 766d 6f64  nc import divmod
+00014420: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00014430: 2064 6976 6d6f 6428 7365 6c66 2c20 6f74   divmod(self, ot
+00014440: 6865 7229 0a0a 2020 2020 4063 6865 636b  her)..    @check
+00014450: 5f69 665f 6861 6e64 6c65 645f 6769 7665  _if_handled_give
+00014460: 6e5f 6f74 6865 720a 2020 2020 6465 6620  n_other.    def 
+00014470: 5f5f 7264 6976 6d6f 645f 5f28 7365 6c66  __rdivmod__(self
+00014480: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
+00014490: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
+000144a0: 792e 7566 756e 6320 696d 706f 7274 2064  y.ufunc import d
+000144b0: 6976 6d6f 640a 0a20 2020 2020 2020 2072  ivmod..        r
+000144c0: 6574 7572 6e20 6469 766d 6f64 286f 7468  eturn divmod(oth
+000144d0: 6572 2c20 7365 6c66 290a 0a20 2020 2064  er, self)..    d
+000144e0: 6566 2061 6e79 2873 656c 662c 2061 7869  ef any(self, axi
+000144f0: 733d 4e6f 6e65 2c20 6b65 6570 6469 6d73  s=None, keepdims
+00014500: 3d46 616c 7365 2c20 7370 6c69 745f 6576  =False, split_ev
+00014510: 6572 793d 4e6f 6e65 2c20 6f75 743d 4e6f  ery=None, out=No
+00014520: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
+00014530: 5265 7475 726e 7320 5472 7565 2069 6620  Returns True if 
+00014540: 616e 7920 6f66 2074 6865 2065 6c65 6d65  any of the eleme
+00014550: 6e74 7320 6576 616c 7561 7465 2074 6f20  nts evaluate to 
+00014560: 5472 7565 2e0a 0a20 2020 2020 2020 2052  True...        R
+00014570: 6566 6572 2074 6f20 3a66 756e 633a 6064  efer to :func:`d
+00014580: 6173 6b2e 6172 7261 792e 616e 7960 2066  ask.array.any` f
+00014590: 6f72 2066 756c 6c20 646f 6375 6d65 6e74  or full document
+000145a0: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+000145b0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+000145c0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+000145d0: 2020 6461 736b 2e61 7272 6179 2e61 6e79    dask.array.any
+000145e0: 203a 2065 7175 6976 616c 656e 7420 6675   : equivalent fu
+000145f0: 6e63 7469 6f6e 0a20 2020 2020 2020 2022  nction.        "
+00014600: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+00014610: 6461 736b 2e61 7272 6179 2e72 6564 7563  dask.array.reduc
+00014620: 7469 6f6e 7320 696d 706f 7274 2061 6e79  tions import any
+00014630: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00014640: 2061 6e79 2873 656c 662c 2061 7869 733d   any(self, axis=
+00014650: 6178 6973 2c20 6b65 6570 6469 6d73 3d6b  axis, keepdims=k
+00014660: 6565 7064 696d 732c 2073 706c 6974 5f65  eepdims, split_e
+00014670: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+00014680: 2c20 6f75 743d 6f75 7429 0a0a 2020 2020  , out=out)..    
+00014690: 6465 6620 616c 6c28 7365 6c66 2c20 6178  def all(self, ax
+000146a0: 6973 3d4e 6f6e 652c 206b 6565 7064 696d  is=None, keepdim
+000146b0: 733d 4661 6c73 652c 2073 706c 6974 5f65  s=False, split_e
+000146c0: 7665 7279 3d4e 6f6e 652c 206f 7574 3d4e  very=None, out=N
+000146d0: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
+000146e0: 2252 6574 7572 6e73 2054 7275 6520 6966  "Returns True if
+000146f0: 2061 6c6c 2065 6c65 6d65 6e74 7320 6576   all elements ev
+00014700: 616c 7561 7465 2074 6f20 5472 7565 2e0a  aluate to True..
+00014710: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
+00014720: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
+00014730: 7261 792e 616c 6c60 2066 6f72 2066 756c  ray.all` for ful
+00014740: 6c20 646f 6375 6d65 6e74 6174 696f 6e2e  l documentation.
+00014750: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+00014760: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+00014770: 2d2d 2d0a 2020 2020 2020 2020 6461 736b  ---.        dask
+00014780: 2e61 7272 6179 2e61 6c6c 203a 2065 7175  .array.all : equ
+00014790: 6976 616c 656e 7420 6675 6e63 7469 6f6e  ivalent function
+000147a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000147b0: 2020 2020 2066 726f 6d20 6461 736b 2e61       from dask.a
+000147c0: 7272 6179 2e72 6564 7563 7469 6f6e 7320  rray.reductions 
+000147d0: 696d 706f 7274 2061 6c6c 0a0a 2020 2020  import all..    
+000147e0: 2020 2020 7265 7475 726e 2061 6c6c 2873      return all(s
+000147f0: 656c 662c 2061 7869 733d 6178 6973 2c20  elf, axis=axis, 
+00014800: 6b65 6570 6469 6d73 3d6b 6565 7064 696d  keepdims=keepdim
+00014810: 732c 2073 706c 6974 5f65 7665 7279 3d73  s, split_every=s
+00014820: 706c 6974 5f65 7665 7279 2c20 6f75 743d  plit_every, out=
+00014830: 6f75 7429 0a0a 2020 2020 6465 6620 6d69  out)..    def mi
+00014840: 6e28 7365 6c66 2c20 6178 6973 3d4e 6f6e  n(self, axis=Non
+00014850: 652c 206b 6565 7064 696d 733d 4661 6c73  e, keepdims=Fals
+00014860: 652c 2073 706c 6974 5f65 7665 7279 3d4e  e, split_every=N
+00014870: 6f6e 652c 206f 7574 3d4e 6f6e 6529 3a0a  one, out=None):.
+00014880: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00014890: 6e20 7468 6520 6d69 6e69 6d75 6d20 616c  n the minimum al
+000148a0: 6f6e 6720 6120 6769 7665 6e20 6178 6973  ong a given axis
+000148b0: 2e0a 0a20 2020 2020 2020 2052 6566 6572  ...        Refer
+000148c0: 2074 6f20 3a66 756e 633a 6064 6173 6b2e   to :func:`dask.
+000148d0: 6172 7261 792e 6d69 6e60 2066 6f72 2066  array.min` for f
+000148e0: 756c 6c20 646f 6375 6d65 6e74 6174 696f  ull documentatio
+000148f0: 6e2e 0a0a 2020 2020 2020 2020 5365 6520  n...        See 
+00014900: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+00014910: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
+00014920: 736b 2e61 7272 6179 2e6d 696e 203a 2065  sk.array.min : e
+00014930: 7175 6976 616c 656e 7420 6675 6e63 7469  quivalent functi
+00014940: 6f6e 0a20 2020 2020 2020 2022 2222 0a20  on.        """. 
+00014950: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00014960: 2e61 7272 6179 2e72 6564 7563 7469 6f6e  .array.reduction
+00014970: 7320 696d 706f 7274 206d 696e 0a0a 2020  s import min..  
+00014980: 2020 2020 2020 7265 7475 726e 206d 696e        return min
+00014990: 2873 656c 662c 2061 7869 733d 6178 6973  (self, axis=axis
+000149a0: 2c20 6b65 6570 6469 6d73 3d6b 6565 7064  , keepdims=keepd
+000149b0: 696d 732c 2073 706c 6974 5f65 7665 7279  ims, split_every
+000149c0: 3d73 706c 6974 5f65 7665 7279 2c20 6f75  =split_every, ou
+000149d0: 743d 6f75 7429 0a0a 2020 2020 6465 6620  t=out)..    def 
+000149e0: 6d61 7828 7365 6c66 2c20 6178 6973 3d4e  max(self, axis=N
+000149f0: 6f6e 652c 206b 6565 7064 696d 733d 4661  one, keepdims=Fa
+00014a00: 6c73 652c 2073 706c 6974 5f65 7665 7279  lse, split_every
+00014a10: 3d4e 6f6e 652c 206f 7574 3d4e 6f6e 6529  =None, out=None)
+00014a20: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+00014a30: 7572 6e20 7468 6520 6d61 7869 6d75 6d20  urn the maximum 
+00014a40: 616c 6f6e 6720 6120 6769 7665 6e20 6178  along a given ax
+00014a50: 6973 2e0a 0a20 2020 2020 2020 2052 6566  is...        Ref
+00014a60: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
+00014a70: 6b2e 6172 7261 792e 6d61 7860 2066 6f72  k.array.max` for
+00014a80: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
+00014a90: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
+00014aa0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+00014ab0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00014ac0: 6461 736b 2e61 7272 6179 2e6d 6178 203a  dask.array.max :
+00014ad0: 2065 7175 6976 616c 656e 7420 6675 6e63   equivalent func
+00014ae0: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
+00014af0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00014b00: 736b 2e61 7272 6179 2e72 6564 7563 7469  sk.array.reducti
+00014b10: 6f6e 7320 696d 706f 7274 206d 6178 0a0a  ons import max..
+00014b20: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+00014b30: 6178 2873 656c 662c 2061 7869 733d 6178  ax(self, axis=ax
+00014b40: 6973 2c20 6b65 6570 6469 6d73 3d6b 6565  is, keepdims=kee
+00014b50: 7064 696d 732c 2073 706c 6974 5f65 7665  pdims, split_eve
+00014b60: 7279 3d73 706c 6974 5f65 7665 7279 2c20  ry=split_every, 
+00014b70: 6f75 743d 6f75 7429 0a0a 2020 2020 6465  out=out)..    de
+00014b80: 6620 6172 676d 696e 2873 656c 662c 2061  f argmin(self, a
+00014b90: 7869 733d 4e6f 6e65 2c20 2a2c 206b 6565  xis=None, *, kee
+00014ba0: 7064 696d 733d 4661 6c73 652c 2073 706c  pdims=False, spl
+00014bb0: 6974 5f65 7665 7279 3d4e 6f6e 652c 206f  it_every=None, o
+00014bc0: 7574 3d4e 6f6e 6529 3a0a 2020 2020 2020  ut=None):.      
+00014bd0: 2020 2222 2252 6574 7572 6e20 696e 6469    """Return indi
+00014be0: 6365 7320 6f66 2074 6865 206d 696e 696d  ces of the minim
+00014bf0: 756d 2076 616c 7565 7320 616c 6f6e 6720  um values along 
+00014c00: 7468 6520 6769 7665 6e20 6178 6973 2e0a  the given axis..
+00014c10: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
+00014c20: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
+00014c30: 7261 792e 6172 676d 696e 6020 666f 7220  ray.argmin` for 
+00014c40: 6675 6c6c 2064 6f63 756d 656e 7461 7469  full documentati
+00014c50: 6f6e 2e0a 0a20 2020 2020 2020 2053 6565  on...        See
+00014c60: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
+00014c70: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+00014c80: 6173 6b2e 6172 7261 792e 6172 676d 696e  ask.array.argmin
+00014c90: 203a 2065 7175 6976 616c 656e 7420 6675   : equivalent fu
+00014ca0: 6e63 7469 6f6e 0a20 2020 2020 2020 2022  nction.        "
+00014cb0: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+00014cc0: 6461 736b 2e61 7272 6179 2e72 6564 7563  dask.array.reduc
+00014cd0: 7469 6f6e 7320 696d 706f 7274 2061 7267  tions import arg
+00014ce0: 6d69 6e0a 0a20 2020 2020 2020 2072 6574  min..        ret
+00014cf0: 7572 6e20 6172 676d 696e 280a 2020 2020  urn argmin(.    
+00014d00: 2020 2020 2020 2020 7365 6c66 2c20 6178          self, ax
+00014d10: 6973 3d61 7869 732c 206b 6565 7064 696d  is=axis, keepdim
+00014d20: 733d 6b65 6570 6469 6d73 2c20 7370 6c69  s=keepdims, spli
+00014d30: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00014d40: 6572 792c 206f 7574 3d6f 7574 0a20 2020  ery, out=out.   
+00014d50: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00014d60: 6172 676d 6178 2873 656c 662c 2061 7869  argmax(self, axi
+00014d70: 733d 4e6f 6e65 2c20 2a2c 206b 6565 7064  s=None, *, keepd
+00014d80: 696d 733d 4661 6c73 652c 2073 706c 6974  ims=False, split
+00014d90: 5f65 7665 7279 3d4e 6f6e 652c 206f 7574  _every=None, out
+00014da0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00014db0: 2222 2252 6574 7572 6e20 696e 6469 6365  """Return indice
+00014dc0: 7320 6f66 2074 6865 206d 6178 696d 756d  s of the maximum
+00014dd0: 2076 616c 7565 7320 616c 6f6e 6720 7468   values along th
+00014de0: 6520 6769 7665 6e20 6178 6973 2e0a 0a20  e given axis... 
+00014df0: 2020 2020 2020 2052 6566 6572 2074 6f20         Refer to 
+00014e00: 3a66 756e 633a 6064 6173 6b2e 6172 7261  :func:`dask.arra
+00014e10: 792e 6172 676d 6178 6020 666f 7220 6675  y.argmax` for fu
+00014e20: 6c6c 2064 6f63 756d 656e 7461 7469 6f6e  ll documentation
+00014e30: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
+00014e40: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+00014e50: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
+00014e60: 6b2e 6172 7261 792e 6172 676d 6178 203a  k.array.argmax :
+00014e70: 2065 7175 6976 616c 656e 7420 6675 6e63   equivalent func
+00014e80: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
+00014e90: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00014ea0: 736b 2e61 7272 6179 2e72 6564 7563 7469  sk.array.reducti
+00014eb0: 6f6e 7320 696d 706f 7274 2061 7267 6d61  ons import argma
+00014ec0: 780a 0a20 2020 2020 2020 2072 6574 7572  x..        retur
+00014ed0: 6e20 6172 676d 6178 280a 2020 2020 2020  n argmax(.      
+00014ee0: 2020 2020 2020 7365 6c66 2c20 6178 6973        self, axis
+00014ef0: 3d61 7869 732c 206b 6565 7064 696d 733d  =axis, keepdims=
+00014f00: 6b65 6570 6469 6d73 2c20 7370 6c69 745f  keepdims, split_
+00014f10: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00014f20: 792c 206f 7574 3d6f 7574 0a20 2020 2020  y, out=out.     
+00014f30: 2020 2029 0a0a 2020 2020 6465 6620 7375     )..    def su
+00014f40: 6d28 7365 6c66 2c20 6178 6973 3d4e 6f6e  m(self, axis=Non
+00014f50: 652c 2064 7479 7065 3d4e 6f6e 652c 206b  e, dtype=None, k
+00014f60: 6565 7064 696d 733d 4661 6c73 652c 2073  eepdims=False, s
+00014f70: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
+00014f80: 206f 7574 3d4e 6f6e 6529 3a0a 2020 2020   out=None):.    
+00014f90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00014fa0: 5265 7475 726e 2074 6865 2073 756d 206f  Return the sum o
+00014fb0: 6620 7468 6520 6172 7261 7920 656c 656d  f the array elem
+00014fc0: 656e 7473 206f 7665 7220 7468 6520 6769  ents over the gi
+00014fd0: 7665 6e20 6178 6973 2e0a 0a20 2020 2020  ven axis...     
+00014fe0: 2020 2052 6566 6572 2074 6f20 3a66 756e     Refer to :fun
+00014ff0: 633a 6064 6173 6b2e 6172 7261 792e 7375  c:`dask.array.su
+00015000: 6d60 2066 6f72 2066 756c 6c20 646f 6375  m` for full docu
+00015010: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
+00015020: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00015030: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00015040: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
+00015050: 2e73 756d 203a 2065 7175 6976 616c 656e  .sum : equivalen
+00015060: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
+00015070: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+00015080: 726f 6d20 6461 736b 2e61 7272 6179 2e72  rom dask.array.r
+00015090: 6564 7563 7469 6f6e 7320 696d 706f 7274  eductions import
+000150a0: 2073 756d 0a0a 2020 2020 2020 2020 7265   sum..        re
+000150b0: 7475 726e 2073 756d 280a 2020 2020 2020  turn sum(.      
+000150c0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+000150d0: 2020 2020 2020 2020 6178 6973 3d61 7869          axis=axi
+000150e0: 732c 0a20 2020 2020 2020 2020 2020 2064  s,.            d
+000150f0: 7479 7065 3d64 7479 7065 2c0a 2020 2020  type=dtype,.    
+00015100: 2020 2020 2020 2020 6b65 6570 6469 6d73          keepdims
+00015110: 3d6b 6565 7064 696d 732c 0a20 2020 2020  =keepdims,.     
+00015120: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+00015130: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
+00015140: 2020 2020 2020 2020 2020 2020 6f75 743d              out=
+00015150: 6f75 742c 0a20 2020 2020 2020 2029 0a0a  out,.        )..
+00015160: 2020 2020 6465 6620 7472 6163 6528 7365      def trace(se
+00015170: 6c66 2c20 6f66 6673 6574 3d30 2c20 6178  lf, offset=0, ax
+00015180: 6973 313d 302c 2061 7869 7332 3d31 2c20  is1=0, axis2=1, 
+00015190: 6474 7970 653d 4e6f 6e65 293a 0a20 2020  dtype=None):.   
+000151a0: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+000151b0: 6865 2073 756d 2061 6c6f 6e67 2064 6961  he sum along dia
+000151c0: 676f 6e61 6c73 206f 6620 7468 6520 6172  gonals of the ar
+000151d0: 7261 792e 0a0a 2020 2020 2020 2020 5265  ray...        Re
+000151e0: 6665 7220 746f 203a 6675 6e63 3a60 6461  fer to :func:`da
+000151f0: 736b 2e61 7272 6179 2e74 7261 6365 6020  sk.array.trace` 
+00015200: 666f 7220 6675 6c6c 2064 6f63 756d 656e  for full documen
+00015210: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
+00015220: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+00015230: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+00015240: 2020 2064 6173 6b2e 6172 7261 792e 7472     dask.array.tr
+00015250: 6163 6520 3a20 6571 7569 7661 6c65 6e74  ace : equivalent
+00015260: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
+00015270: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
+00015280: 6f6d 2064 6173 6b2e 6172 7261 792e 7265  om dask.array.re
+00015290: 6475 6374 696f 6e73 2069 6d70 6f72 7420  ductions import 
+000152a0: 7472 6163 650a 0a20 2020 2020 2020 2072  trace..        r
+000152b0: 6574 7572 6e20 7472 6163 6528 7365 6c66  eturn trace(self
+000152c0: 2c20 6f66 6673 6574 3d6f 6666 7365 742c  , offset=offset,
+000152d0: 2061 7869 7331 3d61 7869 7331 2c20 6178   axis1=axis1, ax
+000152e0: 6973 323d 6178 6973 322c 2064 7479 7065  is2=axis2, dtype
+000152f0: 3d64 7479 7065 290a 0a20 2020 2064 6566  =dtype)..    def
+00015300: 2070 726f 6428 7365 6c66 2c20 6178 6973   prod(self, axis
+00015310: 3d4e 6f6e 652c 2064 7479 7065 3d4e 6f6e  =None, dtype=Non
+00015320: 652c 206b 6565 7064 696d 733d 4661 6c73  e, keepdims=Fals
+00015330: 652c 2073 706c 6974 5f65 7665 7279 3d4e  e, split_every=N
+00015340: 6f6e 652c 206f 7574 3d4e 6f6e 6529 3a0a  one, out=None):.
+00015350: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00015360: 6e20 7468 6520 7072 6f64 7563 7420 6f66  n the product of
+00015370: 2074 6865 2061 7272 6179 2065 6c65 6d65   the array eleme
+00015380: 6e74 7320 6f76 6572 2074 6865 2067 6976  nts over the giv
+00015390: 656e 2061 7869 730a 0a20 2020 2020 2020  en axis..       
+000153a0: 2052 6566 6572 2074 6f20 3a66 756e 633a   Refer to :func:
+000153b0: 6064 6173 6b2e 6172 7261 792e 7072 6f64  `dask.array.prod
+000153c0: 6020 666f 7220 6675 6c6c 2064 6f63 756d  ` for full docum
+000153d0: 656e 7461 7469 6f6e 2e0a 0a20 2020 2020  entation...     
+000153e0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+000153f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+00015400: 2020 2020 2064 6173 6b2e 6172 7261 792e       dask.array.
+00015410: 7072 6f64 203a 2065 7175 6976 616c 656e  prod : equivalen
+00015420: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
+00015430: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+00015440: 726f 6d20 6461 736b 2e61 7272 6179 2e72  rom dask.array.r
+00015450: 6564 7563 7469 6f6e 7320 696d 706f 7274  eductions import
+00015460: 2070 726f 640a 0a20 2020 2020 2020 2072   prod..        r
+00015470: 6574 7572 6e20 7072 6f64 280a 2020 2020  eturn prod(.    
+00015480: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00015490: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
+000154a0: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
+000154b0: 2064 7479 7065 3d64 7479 7065 2c0a 2020   dtype=dtype,.  
+000154c0: 2020 2020 2020 2020 2020 6b65 6570 6469            keepdi
+000154d0: 6d73 3d6b 6565 7064 696d 732c 0a20 2020  ms=keepdims,.   
+000154e0: 2020 2020 2020 2020 2073 706c 6974 5f65           split_e
+000154f0: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+00015500: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
+00015510: 743d 6f75 742c 0a20 2020 2020 2020 2029  t=out,.        )
+00015520: 0a0a 2020 2020 6465 6620 6d65 616e 2873  ..    def mean(s
+00015530: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
+00015540: 6474 7970 653d 4e6f 6e65 2c20 6b65 6570  dtype=None, keep
+00015550: 6469 6d73 3d46 616c 7365 2c20 7370 6c69  dims=False, spli
+00015560: 745f 6576 6572 793d 4e6f 6e65 2c20 6f75  t_every=None, ou
+00015570: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
+00015580: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+00015590: 6176 6572 6167 6520 6f66 2074 6865 2061  average of the a
+000155a0: 7272 6179 2065 6c65 6d65 6e74 7320 616c  rray elements al
+000155b0: 6f6e 6720 6769 7665 6e20 6178 6973 2e0a  ong given axis..
+000155c0: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
+000155d0: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
+000155e0: 7261 792e 6d65 616e 6020 666f 7220 6675  ray.mean` for fu
+000155f0: 6c6c 2064 6f63 756d 656e 7461 7469 6f6e  ll documentation
+00015600: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
+00015610: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+00015620: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
+00015630: 6b2e 6172 7261 792e 6d65 616e 203a 2065  k.array.mean : e
+00015640: 7175 6976 616c 656e 7420 6675 6e63 7469  quivalent functi
+00015650: 6f6e 0a20 2020 2020 2020 2022 2222 0a20  on.        """. 
+00015660: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00015670: 2e61 7272 6179 2e72 6564 7563 7469 6f6e  .array.reduction
+00015680: 7320 696d 706f 7274 206d 6561 6e0a 0a20  s import mean.. 
+00015690: 2020 2020 2020 2072 6574 7572 6e20 6d65         return me
+000156a0: 616e 280a 2020 2020 2020 2020 2020 2020  an(.            
+000156b0: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+000156c0: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
+000156d0: 2020 2020 2020 2020 2064 7479 7065 3d64           dtype=d
+000156e0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+000156f0: 2020 6b65 6570 6469 6d73 3d6b 6565 7064    keepdims=keepd
+00015700: 696d 732c 0a20 2020 2020 2020 2020 2020  ims,.           
+00015710: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+00015720: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
+00015730: 2020 2020 2020 6f75 743d 6f75 742c 0a20        out=out,. 
+00015740: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00015750: 6620 7374 6428 0a20 2020 2020 2020 2073  f std(.        s
+00015760: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
+00015770: 6474 7970 653d 4e6f 6e65 2c20 6b65 6570  dtype=None, keep
+00015780: 6469 6d73 3d46 616c 7365 2c20 6464 6f66  dims=False, ddof
+00015790: 3d30 2c20 7370 6c69 745f 6576 6572 793d  =0, split_every=
+000157a0: 4e6f 6e65 2c20 6f75 743d 4e6f 6e65 0a20  None, out=None. 
+000157b0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+000157c0: 2252 6574 7572 6e73 2074 6865 2073 7461  "Returns the sta
+000157d0: 6e64 6172 6420 6465 7669 6174 696f 6e20  ndard deviation 
+000157e0: 6f66 2074 6865 2061 7272 6179 2065 6c65  of the array ele
+000157f0: 6d65 6e74 7320 616c 6f6e 6720 6769 7665  ments along give
+00015800: 6e20 6178 6973 2e0a 0a20 2020 2020 2020  n axis...       
+00015810: 2052 6566 6572 2074 6f20 3a66 756e 633a   Refer to :func:
+00015820: 6064 6173 6b2e 6172 7261 792e 7374 6460  `dask.array.std`
+00015830: 2066 6f72 2066 756c 6c20 646f 6375 6d65   for full docume
+00015840: 6e74 6174 696f 6e2e 0a0a 2020 2020 2020  ntation...      
+00015850: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+00015860: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00015870: 2020 2020 6461 736b 2e61 7272 6179 2e73      dask.array.s
+00015880: 7464 203a 2065 7175 6976 616c 656e 7420  td : equivalent 
+00015890: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+000158a0: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+000158b0: 6d20 6461 736b 2e61 7272 6179 2e72 6564  m dask.array.red
+000158c0: 7563 7469 6f6e 7320 696d 706f 7274 2073  uctions import s
+000158d0: 7464 0a0a 2020 2020 2020 2020 7265 7475  td..        retu
+000158e0: 726e 2073 7464 280a 2020 2020 2020 2020  rn std(.        
+000158f0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00015900: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
+00015910: 0a20 2020 2020 2020 2020 2020 2064 7479  .            dty
+00015920: 7065 3d64 7479 7065 2c0a 2020 2020 2020  pe=dtype,.      
+00015930: 2020 2020 2020 6b65 6570 6469 6d73 3d6b        keepdims=k
+00015940: 6565 7064 696d 732c 0a20 2020 2020 2020  eepdims,.       
+00015950: 2020 2020 2064 646f 663d 6464 6f66 2c0a       ddof=ddof,.
+00015960: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00015970: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00015980: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+00015990: 206f 7574 3d6f 7574 2c0a 2020 2020 2020   out=out,.      
+000159a0: 2020 290a 0a20 2020 2064 6566 2076 6172    )..    def var
+000159b0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+000159c0: 6178 6973 3d4e 6f6e 652c 2064 7479 7065  axis=None, dtype
+000159d0: 3d4e 6f6e 652c 206b 6565 7064 696d 733d  =None, keepdims=
+000159e0: 4661 6c73 652c 2064 646f 663d 302c 2073  False, ddof=0, s
+000159f0: 706c 6974 5f65 7665 7279 3d4e 6f6e 652c  plit_every=None,
+00015a00: 206f 7574 3d4e 6f6e 650a 2020 2020 293a   out=None.    ):
+00015a10: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00015a20: 726e 7320 7468 6520 7661 7269 616e 6365  rns the variance
+00015a30: 206f 6620 7468 6520 6172 7261 7920 656c   of the array el
+00015a40: 656d 656e 7473 2c20 616c 6f6e 6720 6769  ements, along gi
+00015a50: 7665 6e20 6178 6973 2e0a 0a20 2020 2020  ven axis...     
+00015a60: 2020 2052 6566 6572 2074 6f20 3a66 756e     Refer to :fun
+00015a70: 633a 6064 6173 6b2e 6172 7261 792e 7661  c:`dask.array.va
+00015a80: 7260 2066 6f72 2066 756c 6c20 646f 6375  r` for full docu
+00015a90: 6d65 6e74 6174 696f 6e2e 0a0a 2020 2020  mentation...    
+00015aa0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00015ab0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00015ac0: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
+00015ad0: 2e76 6172 203a 2065 7175 6976 616c 656e  .var : equivalen
+00015ae0: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
+00015af0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+00015b00: 726f 6d20 6461 736b 2e61 7272 6179 2e72  rom dask.array.r
+00015b10: 6564 7563 7469 6f6e 7320 696d 706f 7274  eductions import
+00015b20: 2076 6172 0a0a 2020 2020 2020 2020 7265   var..        re
+00015b30: 7475 726e 2076 6172 280a 2020 2020 2020  turn var(.      
+00015b40: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00015b50: 2020 2020 2020 2020 6178 6973 3d61 7869          axis=axi
+00015b60: 732c 0a20 2020 2020 2020 2020 2020 2064  s,.            d
+00015b70: 7479 7065 3d64 7479 7065 2c0a 2020 2020  type=dtype,.    
+00015b80: 2020 2020 2020 2020 6b65 6570 6469 6d73          keepdims
+00015b90: 3d6b 6565 7064 696d 732c 0a20 2020 2020  =keepdims,.     
+00015ba0: 2020 2020 2020 2064 646f 663d 6464 6f66         ddof=ddof
+00015bb0: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+00015bc0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00015bd0: 6576 6572 792c 0a20 2020 2020 2020 2020  every,.         
+00015be0: 2020 206f 7574 3d6f 7574 2c0a 2020 2020     out=out,.    
+00015bf0: 2020 2020 290a 0a20 2020 2064 6566 206d      )..    def m
+00015c00: 6f6d 656e 7428 0a20 2020 2020 2020 2073  oment(.        s
+00015c10: 656c 662c 0a20 2020 2020 2020 206f 7264  elf,.        ord
+00015c20: 6572 2c0a 2020 2020 2020 2020 6178 6973  er,.        axis
+00015c30: 3d4e 6f6e 652c 0a20 2020 2020 2020 2064  =None,.        d
+00015c40: 7479 7065 3d4e 6f6e 652c 0a20 2020 2020  type=None,.     
+00015c50: 2020 206b 6565 7064 696d 733d 4661 6c73     keepdims=Fals
+00015c60: 652c 0a20 2020 2020 2020 2064 646f 663d  e,.        ddof=
+00015c70: 302c 0a20 2020 2020 2020 2073 706c 6974  0,.        split
+00015c80: 5f65 7665 7279 3d4e 6f6e 652c 0a20 2020  _every=None,.   
+00015c90: 2020 2020 206f 7574 3d4e 6f6e 652c 0a20       out=None,. 
+00015ca0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+00015cb0: 2243 616c 6375 6c61 7465 2074 6865 206e  "Calculate the n
+00015cc0: 7468 2063 656e 7472 616c 697a 6564 206d  th centralized m
+00015cd0: 6f6d 656e 742e 0a0a 2020 2020 2020 2020  oment...        
+00015ce0: 5265 6665 7220 746f 203a 6675 6e63 3a60  Refer to :func:`
+00015cf0: 6461 736b 2e61 7272 6179 2e6d 6f6d 656e  dask.array.momen
+00015d00: 7460 2066 6f72 2074 6865 2066 756c 6c20  t` for the full 
+00015d10: 646f 6375 6d65 6e74 6174 696f 6e2e 0a0a  documentation...
+00015d20: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+00015d30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00015d40: 2d0a 2020 2020 2020 2020 6461 736b 2e61  -.        dask.a
+00015d50: 7272 6179 2e6d 6f6d 656e 7420 3a20 6571  rray.moment : eq
+00015d60: 7569 7661 6c65 6e74 2066 756e 6374 696f  uivalent functio
+00015d70: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
+00015d80: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00015d90: 6172 7261 792e 7265 6475 6374 696f 6e73  array.reductions
+00015da0: 2069 6d70 6f72 7420 6d6f 6d65 6e74 0a0a   import moment..
+00015db0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+00015dc0: 6f6d 656e 7428 0a20 2020 2020 2020 2020  oment(.         
+00015dd0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00015de0: 2020 2020 206f 7264 6572 2c0a 2020 2020       order,.    
+00015df0: 2020 2020 2020 2020 6178 6973 3d61 7869          axis=axi
+00015e00: 732c 0a20 2020 2020 2020 2020 2020 2064  s,.            d
+00015e10: 7479 7065 3d64 7479 7065 2c0a 2020 2020  type=dtype,.    
+00015e20: 2020 2020 2020 2020 6b65 6570 6469 6d73          keepdims
+00015e30: 3d6b 6565 7064 696d 732c 0a20 2020 2020  =keepdims,.     
+00015e40: 2020 2020 2020 2064 646f 663d 6464 6f66         ddof=ddof
+00015e50: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+00015e60: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00015e70: 6576 6572 792c 0a20 2020 2020 2020 2020  every,.         
+00015e80: 2020 206f 7574 3d6f 7574 2c0a 2020 2020     out=out,.    
+00015e90: 2020 2020 290a 0a20 2020 2040 7772 6170      )..    @wrap
+00015ea0: 7328 6d61 705f 626c 6f63 6b73 290a 2020  s(map_blocks).  
+00015eb0: 2020 6465 6620 6d61 705f 626c 6f63 6b73    def map_blocks
+00015ec0: 2873 656c 662c 2066 756e 632c 202a 6172  (self, func, *ar
+00015ed0: 6773 2c20 2a2a 6b77 6172 6773 293a 0a20  gs, **kwargs):. 
+00015ee0: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
+00015ef0: 705f 626c 6f63 6b73 2866 756e 632c 2073  p_blocks(func, s
+00015f00: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+00015f10: 6172 6773 290a 0a20 2020 2064 6566 206d  args)..    def m
+00015f20: 6170 5f6f 7665 726c 6170 2873 656c 662c  ap_overlap(self,
+00015f30: 2066 756e 632c 2064 6570 7468 2c20 626f   func, depth, bo
+00015f40: 756e 6461 7279 3d4e 6f6e 652c 2074 7269  undary=None, tri
+00015f50: 6d3d 5472 7565 2c20 2a2a 6b77 6172 6773  m=True, **kwargs
+00015f60: 293a 0a20 2020 2020 2020 2022 2222 4d61  ):.        """Ma
+00015f70: 7020 6120 6675 6e63 7469 6f6e 206f 7665  p a function ove
+00015f80: 7220 626c 6f63 6b73 206f 6620 7468 6520  r blocks of the 
+00015f90: 6172 7261 7920 7769 7468 2073 6f6d 6520  array with some 
+00015fa0: 6f76 6572 6c61 700a 0a20 2020 2020 2020  overlap..       
+00015fb0: 2052 6566 6572 2074 6f20 3a66 756e 633a   Refer to :func:
+00015fc0: 6064 6173 6b2e 6172 7261 792e 6d61 705f  `dask.array.map_
+00015fd0: 6f76 6572 6c61 7060 2066 6f72 2066 756c  overlap` for ful
+00015fe0: 6c20 646f 6375 6d65 6e74 6174 696f 6e2e  l documentation.
+00015ff0: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+00016000: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+00016010: 2d2d 2d0a 2020 2020 2020 2020 6461 736b  ---.        dask
+00016020: 2e61 7272 6179 2e6d 6170 5f6f 7665 726c  .array.map_overl
+00016030: 6170 203a 2065 7175 6976 616c 656e 7420  ap : equivalent 
+00016040: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+00016050: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00016060: 6d20 6461 736b 2e61 7272 6179 2e6f 7665  m dask.array.ove
+00016070: 726c 6170 2069 6d70 6f72 7420 6d61 705f  rlap import map_
+00016080: 6f76 6572 6c61 700a 0a20 2020 2020 2020  overlap..       
+00016090: 2072 6574 7572 6e20 6d61 705f 6f76 6572   return map_over
+000160a0: 6c61 7028 0a20 2020 2020 2020 2020 2020  lap(.           
+000160b0: 2066 756e 632c 2073 656c 662c 2064 6570   func, self, dep
+000160c0: 7468 3d64 6570 7468 2c20 626f 756e 6461  th=depth, bounda
+000160d0: 7279 3d62 6f75 6e64 6172 792c 2074 7269  ry=boundary, tri
+000160e0: 6d3d 7472 696d 2c20 2a2a 6b77 6172 6773  m=trim, **kwargs
+000160f0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00016100: 6465 6620 6375 6d73 756d 2873 656c 662c  def cumsum(self,
+00016110: 2061 7869 732c 2064 7479 7065 3d4e 6f6e   axis, dtype=Non
+00016120: 652c 206f 7574 3d4e 6f6e 652c 202a 2c20  e, out=None, *, 
+00016130: 6d65 7468 6f64 3d22 7365 7175 656e 7469  method="sequenti
+00016140: 616c 2229 3a0a 2020 2020 2020 2020 2222  al"):.        ""
+00016150: 2252 6574 7572 6e20 7468 6520 6375 6d75  "Return the cumu
+00016160: 6c61 7469 7665 2073 756d 206f 6620 7468  lative sum of th
+00016170: 6520 656c 656d 656e 7473 2061 6c6f 6e67  e elements along
+00016180: 2074 6865 2067 6976 656e 2061 7869 732e   the given axis.
+00016190: 0a0a 2020 2020 2020 2020 5265 6665 7220  ..        Refer 
+000161a0: 746f 203a 6675 6e63 3a60 6461 736b 2e61  to :func:`dask.a
+000161b0: 7272 6179 2e63 756d 7375 6d60 2066 6f72  rray.cumsum` for
+000161c0: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
+000161d0: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
+000161e0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+000161f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00016200: 6461 736b 2e61 7272 6179 2e63 756d 7375  dask.array.cumsu
+00016210: 6d20 3a20 6571 7569 7661 6c65 6e74 2066  m : equivalent f
+00016220: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
+00016230: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
+00016240: 2064 6173 6b2e 6172 7261 792e 7265 6475   dask.array.redu
+00016250: 6374 696f 6e73 2069 6d70 6f72 7420 6375  ctions import cu
+00016260: 6d73 756d 0a0a 2020 2020 2020 2020 7265  msum..        re
+00016270: 7475 726e 2063 756d 7375 6d28 7365 6c66  turn cumsum(self
+00016280: 2c20 6178 6973 2c20 6474 7970 652c 206f  , axis, dtype, o
+00016290: 7574 3d6f 7574 2c20 6d65 7468 6f64 3d6d  ut=out, method=m
+000162a0: 6574 686f 6429 0a0a 2020 2020 6465 6620  ethod)..    def 
+000162b0: 6375 6d70 726f 6428 7365 6c66 2c20 6178  cumprod(self, ax
+000162c0: 6973 2c20 6474 7970 653d 4e6f 6e65 2c20  is, dtype=None, 
+000162d0: 6f75 743d 4e6f 6e65 2c20 2a2c 206d 6574  out=None, *, met
+000162e0: 686f 643d 2273 6571 7565 6e74 6961 6c22  hod="sequential"
+000162f0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+00016300: 7475 726e 2074 6865 2063 756d 756c 6174  turn the cumulat
+00016310: 6976 6520 7072 6f64 7563 7420 6f66 2074  ive product of t
+00016320: 6865 2065 6c65 6d65 6e74 7320 616c 6f6e  he elements alon
+00016330: 6720 7468 6520 6769 7665 6e20 6178 6973  g the given axis
+00016340: 2e0a 0a20 2020 2020 2020 2052 6566 6572  ...        Refer
+00016350: 2074 6f20 3a66 756e 633a 6064 6173 6b2e   to :func:`dask.
+00016360: 6172 7261 792e 6375 6d70 726f 6460 2066  array.cumprod` f
+00016370: 6f72 2066 756c 6c20 646f 6375 6d65 6e74  or full document
+00016380: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+00016390: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+000163a0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+000163b0: 2020 6461 736b 2e61 7272 6179 2e63 756d    dask.array.cum
+000163c0: 7072 6f64 203a 2065 7175 6976 616c 656e  prod : equivalen
+000163d0: 7420 6675 6e63 7469 6f6e 0a20 2020 2020  t function.     
+000163e0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+000163f0: 726f 6d20 6461 736b 2e61 7272 6179 2e72  rom dask.array.r
+00016400: 6564 7563 7469 6f6e 7320 696d 706f 7274  eductions import
+00016410: 2063 756d 7072 6f64 0a0a 2020 2020 2020   cumprod..      
+00016420: 2020 7265 7475 726e 2063 756d 7072 6f64    return cumprod
+00016430: 2873 656c 662c 2061 7869 732c 2064 7479  (self, axis, dty
+00016440: 7065 2c20 6f75 743d 6f75 742c 206d 6574  pe, out=out, met
+00016450: 686f 643d 6d65 7468 6f64 290a 0a20 2020  hod=method)..   
+00016460: 2064 6566 2073 7175 6565 7a65 2873 656c   def squeeze(sel
+00016470: 662c 2061 7869 733d 4e6f 6e65 293a 0a20  f, axis=None):. 
+00016480: 2020 2020 2020 2022 2222 5265 6d6f 7665         """Remove
+00016490: 2061 7865 7320 6f66 206c 656e 6774 6820   axes of length 
+000164a0: 6f6e 6520 6672 6f6d 2061 7272 6179 2e0a  one from array..
+000164b0: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
+000164c0: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
+000164d0: 7261 792e 7371 7565 657a 6560 2066 6f72  ray.squeeze` for
+000164e0: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
+000164f0: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
+00016500: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+00016510: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00016520: 6461 736b 2e61 7272 6179 2e73 7175 6565  dask.array.squee
+00016530: 7a65 203a 2065 7175 6976 616c 656e 7420  ze : equivalent 
+00016540: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+00016550: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00016560: 6d20 6461 736b 2e61 7272 6179 2e72 6f75  m dask.array.rou
+00016570: 7469 6e65 7320 696d 706f 7274 2073 7175  tines import squ
+00016580: 6565 7a65 0a0a 2020 2020 2020 2020 7265  eeze..        re
+00016590: 7475 726e 2073 7175 6565 7a65 2873 656c  turn squeeze(sel
+000165a0: 662c 2061 7869 7329 0a0a 2020 2020 6465  f, axis)..    de
+000165b0: 6620 7265 6368 756e 6b28 0a20 2020 2020  f rechunk(.     
+000165c0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000165d0: 2063 6875 6e6b 733d 2261 7574 6f22 2c0a   chunks="auto",.
+000165e0: 2020 2020 2020 2020 7468 7265 7368 6f6c          threshol
+000165f0: 643d 4e6f 6e65 2c0a 2020 2020 2020 2020  d=None,.        
+00016600: 626c 6f63 6b5f 7369 7a65 5f6c 696d 6974  block_size_limit
+00016610: 3d4e 6f6e 652c 0a20 2020 2020 2020 2062  =None,.        b
+00016620: 616c 616e 6365 3d46 616c 7365 2c0a 2020  alance=False,.  
+00016630: 2020 2020 2020 6d65 7468 6f64 3d4e 6f6e        method=Non
+00016640: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00016650: 2020 2222 2243 6f6e 7665 7274 2062 6c6f    """Convert blo
+00016660: 636b 7320 696e 2064 6173 6b20 6172 7261  cks in dask arra
+00016670: 7920 7820 666f 7220 6e65 7720 6368 756e  y x for new chun
+00016680: 6b73 2e0a 0a20 2020 2020 2020 2052 6566  ks...        Ref
+00016690: 6572 2074 6f20 3a66 756e 633a 6064 6173  er to :func:`das
+000166a0: 6b2e 6172 7261 792e 7265 6368 756e 6b60  k.array.rechunk`
+000166b0: 2066 6f72 2066 756c 6c20 646f 6375 6d65   for full docume
+000166c0: 6e74 6174 696f 6e2e 0a0a 2020 2020 2020  ntation...      
+000166d0: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+000166e0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+000166f0: 2020 2020 6461 736b 2e61 7272 6179 2e72      dask.array.r
+00016700: 6563 6875 6e6b 203a 2065 7175 6976 616c  echunk : equival
+00016710: 656e 7420 6675 6e63 7469 6f6e 0a20 2020  ent function.   
+00016720: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00016730: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
+00016740: 2e72 6563 6875 6e6b 2069 6d70 6f72 7420  .rechunk import 
+00016750: 7265 6368 756e 6b20 2023 2061 766f 6964  rechunk  # avoid
+00016760: 2063 6972 6375 6c61 7220 696d 706f 7274   circular import
+00016770: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00016780: 2072 6563 6875 6e6b 2873 656c 662c 2063   rechunk(self, c
+00016790: 6875 6e6b 732c 2074 6872 6573 686f 6c64  hunks, threshold
+000167a0: 2c20 626c 6f63 6b5f 7369 7a65 5f6c 696d  , block_size_lim
+000167b0: 6974 2c20 6261 6c61 6e63 652c 206d 6574  it, balance, met
+000167c0: 686f 6429 0a0a 2020 2020 4070 726f 7065  hod)..    @prope
+000167d0: 7274 790a 2020 2020 6465 6620 7265 616c  rty.    def real
+000167e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000167f0: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
+00016800: 7566 756e 6320 696d 706f 7274 2072 6561  ufunc import rea
+00016810: 6c0a 0a20 2020 2020 2020 2072 6574 7572  l..        retur
+00016820: 6e20 7265 616c 2873 656c 6629 0a0a 2020  n real(self)..  
+00016830: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00016840: 6465 6620 696d 6167 2873 656c 6629 3a0a  def imag(self):.
+00016850: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+00016860: 6b2e 6172 7261 792e 7566 756e 6320 696d  k.array.ufunc im
+00016870: 706f 7274 2069 6d61 670a 0a20 2020 2020  port imag..     
+00016880: 2020 2072 6574 7572 6e20 696d 6167 2873     return imag(s
+00016890: 656c 6629 0a0a 2020 2020 6465 6620 636f  elf)..    def co
+000168a0: 6e6a 2873 656c 6629 3a0a 2020 2020 2020  nj(self):.      
+000168b0: 2020 2222 2243 6f6d 706c 6578 2d63 6f6e    """Complex-con
+000168c0: 6a75 6761 7465 2061 6c6c 2065 6c65 6d65  jugate all eleme
+000168d0: 6e74 732e 0a0a 2020 2020 2020 2020 5265  nts...        Re
+000168e0: 6665 7220 746f 203a 6675 6e63 3a60 6461  fer to :func:`da
+000168f0: 736b 2e61 7272 6179 2e63 6f6e 6a60 2066  sk.array.conj` f
+00016900: 6f72 2066 756c 6c20 646f 6375 6d65 6e74  or full document
+00016910: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+00016920: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+00016930: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00016940: 2020 6461 736b 2e61 7272 6179 2e63 6f6e    dask.array.con
+00016950: 6a20 3a20 6571 7569 7661 6c65 6e74 2066  j : equivalent f
+00016960: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
+00016970: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
+00016980: 2064 6173 6b2e 6172 7261 792e 7566 756e   dask.array.ufun
+00016990: 6320 696d 706f 7274 2063 6f6e 6a0a 0a20  c import conj.. 
+000169a0: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
+000169b0: 6e6a 2873 656c 6629 0a0a 2020 2020 6465  nj(self)..    de
+000169c0: 6620 636c 6970 2873 656c 662c 206d 696e  f clip(self, min
+000169d0: 3d4e 6f6e 652c 206d 6178 3d4e 6f6e 6529  =None, max=None)
+000169e0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+000169f0: 7572 6e20 616e 2061 7272 6179 2077 686f  urn an array who
+00016a00: 7365 2076 616c 7565 7320 6172 6520 6c69  se values are li
+00016a10: 6d69 7465 6420 746f 2060 605b 6d69 6e2c  mited to ``[min,
+00016a20: 206d 6178 5d60 602e 0a20 2020 2020 2020   max]``..       
+00016a30: 204f 6e65 206f 6620 6d61 7820 6f72 206d   One of max or m
+00016a40: 696e 206d 7573 7420 6265 2067 6976 656e  in must be given
+00016a50: 2e0a 0a20 2020 2020 2020 2052 6566 6572  ...        Refer
+00016a60: 2074 6f20 3a66 756e 633a 6064 6173 6b2e   to :func:`dask.
+00016a70: 6172 7261 792e 636c 6970 6020 666f 7220  array.clip` for 
+00016a80: 6675 6c6c 2064 6f63 756d 656e 7461 7469  full documentati
+00016a90: 6f6e 2e0a 0a20 2020 2020 2020 2053 6565  on...        See
+00016aa0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
+00016ab0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+00016ac0: 6173 6b2e 6172 7261 792e 636c 6970 203a  ask.array.clip :
+00016ad0: 2065 7175 6976 616c 656e 7420 6675 6e63   equivalent func
+00016ae0: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
+00016af0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00016b00: 736b 2e61 7272 6179 2e75 6675 6e63 2069  sk.array.ufunc i
+00016b10: 6d70 6f72 7420 636c 6970 0a0a 2020 2020  mport clip..    
+00016b20: 2020 2020 7265 7475 726e 2063 6c69 7028      return clip(
+00016b30: 7365 6c66 2c20 6d69 6e2c 206d 6178 290a  self, min, max).
+00016b40: 0a20 2020 2064 6566 2076 6965 7728 7365  .    def view(se
+00016b50: 6c66 2c20 6474 7970 653d 4e6f 6e65 2c20  lf, dtype=None, 
+00016b60: 6f72 6465 723d 2243 2229 3a0a 2020 2020  order="C"):.    
+00016b70: 2020 2020 2222 2247 6574 2061 2076 6965      """Get a vie
+00016b80: 7720 6f66 2074 6865 2061 7272 6179 2061  w of the array a
+00016b90: 7320 6120 6e65 7720 6461 7461 2074 7970  s a new data typ
+00016ba0: 650a 0a20 2020 2020 2020 2050 6172 616d  e..        Param
+00016bb0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00016bc0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00016bd0: 2064 7479 7065 3a0a 2020 2020 2020 2020   dtype:.        
+00016be0: 2020 2020 5468 6520 6474 7970 6520 6279      The dtype by
+00016bf0: 2077 6869 6368 2074 6f20 7669 6577 2074   which to view t
+00016c00: 6865 2061 7272 6179 2e0a 2020 2020 2020  he array..      
+00016c10: 2020 2020 2020 5468 6520 6465 6661 756c        The defaul
+00016c20: 742c 204e 6f6e 652c 2072 6573 756c 7473  t, None, results
+00016c30: 2069 6e20 7468 6520 7669 6577 2068 6176   in the view hav
+00016c40: 696e 6720 7468 6520 7361 6d65 2064 6174  ing the same dat
+00016c50: 612d 7479 7065 0a20 2020 2020 2020 2020  a-type.         
+00016c60: 2020 2061 7320 7468 6520 6f72 6967 696e     as the origin
+00016c70: 616c 2061 7272 6179 2e0a 2020 2020 2020  al array..      
+00016c80: 2020 6f72 6465 723a 2073 7472 696e 670a    order: string.
+00016c90: 2020 2020 2020 2020 2020 2020 2743 2720              'C' 
+00016ca0: 6f72 2027 4627 2028 466f 7274 7261 6e29  or 'F' (Fortran)
+00016cb0: 206f 7264 6572 696e 670a 0a20 2020 2020   ordering..     
+00016cc0: 2020 2054 6869 7320 7265 696e 7465 7270     This reinterp
+00016cd0: 7265 7473 2074 6865 2062 7974 6573 206f  rets the bytes o
+00016ce0: 6620 7468 6520 6172 7261 7920 756e 6465  f the array unde
+00016cf0: 7220 6120 6e65 7720 6474 7970 652e 2020  r a new dtype.  
+00016d00: 4966 2074 6861 740a 2020 2020 2020 2020  If that.        
+00016d10: 6474 7970 6520 646f 6573 206e 6f74 2068  dtype does not h
+00016d20: 6176 6520 7468 6520 7361 6d65 2073 697a  ave the same siz
+00016d30: 6520 6173 2074 6865 206f 7269 6769 6e61  e as the origina
+00016d40: 6c20 6172 7261 7920 7468 656e 2074 6865  l array then the
+00016d50: 2073 6861 7065 0a20 2020 2020 2020 2077   shape.        w
+00016d60: 696c 6c20 6368 616e 6765 2e0a 0a20 2020  ill change...   
+00016d70: 2020 2020 2042 6577 6172 6520 7468 6174       Beware that
+00016d80: 2062 6f74 6820 6e75 6d70 7920 616e 6420   both numpy and 
+00016d90: 6461 736b 2e61 7272 6179 2063 616e 2062  dask.array can b
+00016da0: 6568 6176 6520 6f64 646c 7920 7768 656e  ehave oddly when
+00016db0: 2074 616b 696e 670a 2020 2020 2020 2020   taking.        
+00016dc0: 7368 6170 652d 6368 616e 6769 6e67 2076  shape-changing v
+00016dd0: 6965 7773 206f 6620 6172 7261 7973 2075  iews of arrays u
+00016de0: 6e64 6572 2046 6f72 7472 616e 206f 7264  nder Fortran ord
+00016df0: 6572 696e 672e 2020 556e 6465 7220 736f  ering.  Under so
+00016e00: 6d65 0a20 2020 2020 2020 2076 6572 7369  me.        versi
+00016e10: 6f6e 7320 6f66 204e 756d 5079 2074 6869  ons of NumPy thi
+00016e20: 7320 6675 6e63 7469 6f6e 2077 696c 6c20  s function will 
+00016e30: 6661 696c 2077 6865 6e20 7461 6b69 6e67  fail when taking
+00016e40: 2073 6861 7065 2d63 6861 6e67 696e 670a   shape-changing.
+00016e50: 2020 2020 2020 2020 7669 6577 7320 6f66          views of
+00016e60: 2046 6f72 7472 616e 206f 7264 6572 6564   Fortran ordered
+00016e70: 2061 7272 6179 7320 6966 2074 6865 2066   arrays if the f
+00016e80: 6972 7374 2064 696d 656e 7369 6f6e 2068  irst dimension h
+00016e90: 6173 2063 6875 6e6b 7320 6f66 0a20 2020  as chunks of.   
+00016ea0: 2020 2020 2073 697a 6520 6f6e 652e 0a20       size one.. 
+00016eb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00016ec0: 2020 2069 6620 6474 7970 6520 6973 204e     if dtype is N
+00016ed0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00016ee0: 2064 7479 7065 203d 2073 656c 662e 6474   dtype = self.dt
+00016ef0: 7970 650a 2020 2020 2020 2020 656c 7365  ype.        else
+00016f00: 3a0a 2020 2020 2020 2020 2020 2020 6474  :.            dt
+00016f10: 7970 6520 3d20 6e70 2e64 7479 7065 2864  ype = np.dtype(d
+00016f20: 7479 7065 290a 2020 2020 2020 2020 6d75  type).        mu
+00016f30: 6c74 203d 2073 656c 662e 6474 7970 652e  lt = self.dtype.
+00016f40: 6974 656d 7369 7a65 202f 2064 7479 7065  itemsize / dtype
+00016f50: 2e69 7465 6d73 697a 650a 0a20 2020 2020  .itemsize..     
+00016f60: 2020 2069 6620 6f72 6465 7220 3d3d 2022     if order == "
+00016f70: 4322 3a0a 2020 2020 2020 2020 2020 2020  C":.            
+00016f80: 6368 756e 6b73 203d 2073 656c 662e 6368  chunks = self.ch
+00016f90: 756e 6b73 5b3a 2d31 5d20 2b20 280a 2020  unks[:-1] + (.  
+00016fa0: 2020 2020 2020 2020 2020 2020 2020 7475                tu
+00016fb0: 706c 6528 656e 7375 7265 5f69 6e74 2863  ple(ensure_int(c
+00016fc0: 202a 206d 756c 7429 2066 6f72 2063 2069   * mult) for c i
+00016fd0: 6e20 7365 6c66 2e63 6875 6e6b 735b 2d31  n self.chunks[-1
+00016fe0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+00016ff0: 290a 2020 2020 2020 2020 656c 6966 206f  ).        elif o
+00017000: 7264 6572 203d 3d20 2246 223a 0a20 2020  rder == "F":.   
+00017010: 2020 2020 2020 2020 2063 6875 6e6b 7320           chunks 
+00017020: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00017030: 2020 2020 7475 706c 6528 656e 7375 7265      tuple(ensure
+00017040: 5f69 6e74 2863 202a 206d 756c 7429 2066  _int(c * mult) f
+00017050: 6f72 2063 2069 6e20 7365 6c66 2e63 6875  or c in self.chu
+00017060: 6e6b 735b 305d 292c 0a20 2020 2020 2020  nks[0]),.       
+00017070: 2020 2020 2029 202b 2073 656c 662e 6368       ) + self.ch
+00017080: 756e 6b73 5b31 3a5d 0a20 2020 2020 2020  unks[1:].       
+00017090: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000170a0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000170b0: 726f 7228 224f 7264 6572 206d 7573 7420  ror("Order must 
+000170c0: 6265 206f 6e65 206f 6620 2743 2720 6f72  be one of 'C' or
+000170d0: 2027 4627 2229 0a0a 2020 2020 2020 2020   'F'")..        
+000170e0: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+000170f0: 626c 6f63 6b73 280a 2020 2020 2020 2020  blocks(.        
+00017100: 2020 2020 6368 756e 6b2e 7669 6577 2c20      chunk.view, 
+00017110: 6474 7970 652c 206f 7264 6572 3d6f 7264  dtype, order=ord
+00017120: 6572 2c20 6474 7970 653d 6474 7970 652c  er, dtype=dtype,
+00017130: 2063 6875 6e6b 733d 6368 756e 6b73 0a20   chunks=chunks. 
+00017140: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00017150: 6620 7377 6170 6178 6573 2873 656c 662c  f swapaxes(self,
+00017160: 2061 7869 7331 2c20 6178 6973 3229 3a0a   axis1, axis2):.
+00017170: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00017180: 6e20 6120 7669 6577 206f 6620 7468 6520  n a view of the 
+00017190: 6172 7261 7920 7769 7468 2060 6061 7869  array with ``axi
+000171a0: 7331 6060 2061 6e64 2060 6061 7869 7332  s1`` and ``axis2
+000171b0: 6060 2069 6e74 6572 6368 616e 6765 642e  `` interchanged.
+000171c0: 0a0a 2020 2020 2020 2020 5265 6665 7220  ..        Refer 
+000171d0: 746f 203a 6675 6e63 3a60 6461 736b 2e61  to :func:`dask.a
+000171e0: 7272 6179 2e73 7761 7061 7865 7360 2066  rray.swapaxes` f
+000171f0: 6f72 2066 756c 6c20 646f 6375 6d65 6e74  or full document
+00017200: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+00017210: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+00017220: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00017230: 2020 6461 736b 2e61 7272 6179 2e73 7761    dask.array.swa
+00017240: 7061 7865 7320 3a20 6571 7569 7661 6c65  paxes : equivale
+00017250: 6e74 2066 756e 6374 696f 6e0a 2020 2020  nt function.    
+00017260: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00017270: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
+00017280: 726f 7574 696e 6573 2069 6d70 6f72 7420  routines import 
+00017290: 7377 6170 6178 6573 0a0a 2020 2020 2020  swapaxes..      
+000172a0: 2020 7265 7475 726e 2073 7761 7061 7865    return swapaxe
+000172b0: 7328 7365 6c66 2c20 6178 6973 312c 2061  s(self, axis1, a
+000172c0: 7869 7332 290a 0a20 2020 2064 6566 2072  xis2)..    def r
+000172d0: 6f75 6e64 2873 656c 662c 2064 6563 696d  ound(self, decim
+000172e0: 616c 733d 3029 3a0a 2020 2020 2020 2020  als=0):.        
+000172f0: 2222 2252 6574 7572 6e20 6172 7261 7920  """Return array 
+00017300: 7769 7468 2065 6163 6820 656c 656d 656e  with each elemen
+00017310: 7420 726f 756e 6465 6420 746f 2074 6865  t rounded to the
+00017320: 2067 6976 656e 206e 756d 6265 7220 6f66   given number of
+00017330: 2064 6563 696d 616c 732e 0a0a 2020 2020   decimals...    
+00017340: 2020 2020 5265 6665 7220 746f 203a 6675      Refer to :fu
+00017350: 6e63 3a60 6461 736b 2e61 7272 6179 2e72  nc:`dask.array.r
+00017360: 6f75 6e64 6020 666f 7220 6675 6c6c 2064  ound` for full d
+00017370: 6f63 756d 656e 7461 7469 6f6e 2e0a 0a20  ocumentation... 
+00017380: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+00017390: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000173a0: 0a20 2020 2020 2020 2064 6173 6b2e 6172  .        dask.ar
+000173b0: 7261 792e 726f 756e 6420 3a20 6571 7569  ray.round : equi
+000173c0: 7661 6c65 6e74 2066 756e 6374 696f 6e0a  valent function.
+000173d0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000173e0: 2020 2020 6672 6f6d 2064 6173 6b2e 6172      from dask.ar
+000173f0: 7261 792e 726f 7574 696e 6573 2069 6d70  ray.routines imp
+00017400: 6f72 7420 726f 756e 640a 0a20 2020 2020  ort round..     
+00017410: 2020 2072 6574 7572 6e20 726f 756e 6428     return round(
+00017420: 7365 6c66 2c20 6465 6369 6d61 6c73 3d64  self, decimals=d
+00017430: 6563 696d 616c 7329 0a0a 2020 2020 6465  ecimals)..    de
+00017440: 6620 636f 7079 2873 656c 6629 3a0a 2020  f copy(self):.  
+00017450: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00017460: 2020 436f 7079 2061 7272 6179 2e20 2054    Copy array.  T
+00017470: 6869 7320 6973 2061 206e 6f2d 6f70 2066  his is a no-op f
+00017480: 6f72 2064 6173 6b2e 6172 7261 7973 2c20  or dask.arrays, 
+00017490: 7768 6963 6820 6172 6520 696d 6d75 7461  which are immuta
+000174a0: 626c 650a 2020 2020 2020 2020 2222 220a  ble.        """.
+000174b0: 2020 2020 2020 2020 7265 7475 726e 2041          return A
+000174c0: 7272 6179 2873 656c 662e 6461 736b 2c20  rray(self.dask, 
+000174d0: 7365 6c66 2e6e 616d 652c 2073 656c 662e  self.name, self.
+000174e0: 6368 756e 6b73 2c20 6d65 7461 3d73 656c  chunks, meta=sel
+000174f0: 6629 0a0a 2020 2020 6465 6620 5f5f 6465  f)..    def __de
+00017500: 6570 636f 7079 5f5f 2873 656c 662c 206d  epcopy__(self, m
+00017510: 656d 6f29 3a0a 2020 2020 2020 2020 6320  emo):.        c 
+00017520: 3d20 7365 6c66 2e63 6f70 7928 290a 2020  = self.copy().  
+00017530: 2020 2020 2020 6d65 6d6f 5b69 6428 7365        memo[id(se
+00017540: 6c66 295d 203d 2063 0a20 2020 2020 2020  lf)] = c.       
+00017550: 2072 6574 7572 6e20 630a 0a20 2020 2064   return c..    d
+00017560: 6566 2074 6f5f 6465 6c61 7965 6428 7365  ef to_delayed(se
+00017570: 6c66 2c20 6f70 7469 6d69 7a65 5f67 7261  lf, optimize_gra
+00017580: 7068 3d54 7275 6529 3a0a 2020 2020 2020  ph=True):.      
+00017590: 2020 2222 2243 6f6e 7665 7274 2069 6e74    """Convert int
+000175a0: 6f20 616e 2061 7272 6179 206f 6620 3a63  o an array of :c
+000175b0: 6c61 7373 3a60 6461 736b 2e64 656c 6179  lass:`dask.delay
+000175c0: 6564 2e44 656c 6179 6564 6020 6f62 6a65  ed.Delayed` obje
+000175d0: 6374 732c 206f 6e65 2070 6572 2063 6875  cts, one per chu
+000175e0: 6e6b 2e0a 0a20 2020 2020 2020 2050 6172  nk...        Par
+000175f0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00017600: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00017610: 2020 206f 7074 696d 697a 655f 6772 6170     optimize_grap
+00017620: 6820 3a20 626f 6f6c 2c20 6f70 7469 6f6e  h : bool, option
+00017630: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
+00017640: 6620 5472 7565 205b 6465 6661 756c 745d  f True [default]
+00017650: 2c20 7468 6520 6772 6170 6820 6973 206f  , the graph is o
+00017660: 7074 696d 697a 6564 2062 6566 6f72 6520  ptimized before 
+00017670: 636f 6e76 6572 7469 6e67 2069 6e74 6f0a  converting into.
+00017680: 2020 2020 2020 2020 2020 2020 3a63 6c61              :cla
+00017690: 7373 3a60 6461 736b 2e64 656c 6179 6564  ss:`dask.delayed
+000176a0: 2e44 656c 6179 6564 6020 6f62 6a65 6374  .Delayed` object
+000176b0: 732e 0a0a 2020 2020 2020 2020 5365 6520  s...        See 
+000176c0: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+000176d0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
+000176e0: 736b 2e61 7272 6179 2e66 726f 6d5f 6465  sk.array.from_de
+000176f0: 6c61 7965 640a 2020 2020 2020 2020 2222  layed.        ""
+00017700: 220a 2020 2020 2020 2020 6b65 7973 203d  ".        keys =
+00017710: 2073 656c 662e 5f5f 6461 736b 5f6b 6579   self.__dask_key
+00017720: 735f 5f28 290a 2020 2020 2020 2020 6772  s__().        gr
+00017730: 6170 6820 3d20 7365 6c66 2e5f 5f64 6173  aph = self.__das
+00017740: 6b5f 6772 6170 685f 5f28 290a 2020 2020  k_graph__().    
+00017750: 2020 2020 6c61 7965 7220 3d20 7365 6c66      layer = self
+00017760: 2e5f 5f64 6173 6b5f 6c61 7965 7273 5f5f  .__dask_layers__
+00017770: 2829 5b30 5d0a 2020 2020 2020 2020 6966  ()[0].        if
+00017780: 206f 7074 696d 697a 655f 6772 6170 683a   optimize_graph:
+00017790: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
+000177a0: 7068 203d 2073 656c 662e 5f5f 6461 736b  ph = self.__dask
+000177b0: 5f6f 7074 696d 697a 655f 5f28 6772 6170  _optimize__(grap
+000177c0: 682c 206b 6579 7329 2020 2320 544f 444f  h, keys)  # TODO
+000177d0: 2c20 646f 6e27 7420 636f 6c6c 6170 6520  , don't collape 
+000177e0: 6772 6170 680a 2020 2020 2020 2020 2020  graph.          
+000177f0: 2020 6c61 7965 7220 3d20 2264 656c 6179    layer = "delay
+00017800: 6564 2d22 202b 2073 656c 662e 6e61 6d65  ed-" + self.name
+00017810: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
+00017820: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+00017830: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+00017840: 696f 6e73 286c 6179 6572 2c20 6772 6170  ions(layer, grap
+00017850: 682c 2064 6570 656e 6465 6e63 6965 733d  h, dependencies=
+00017860: 2829 290a 2020 2020 2020 2020 4c20 3d20  ()).        L = 
+00017870: 6e64 6565 706d 6170 2873 656c 662e 6e64  ndeepmap(self.nd
+00017880: 696d 2c20 6c61 6d62 6461 206b 3a20 4465  im, lambda k: De
+00017890: 6c61 7965 6428 6b2c 2067 7261 7068 2c20  layed(k, graph, 
+000178a0: 6c61 7965 723d 6c61 7965 7229 2c20 6b65  layer=layer), ke
+000178b0: 7973 290a 2020 2020 2020 2020 7265 7475  ys).        retu
+000178c0: 726e 206e 702e 6172 7261 7928 4c2c 2064  rn np.array(L, d
+000178d0: 7479 7065 3d6f 626a 6563 7429 0a0a 2020  type=object)..  
+000178e0: 2020 6465 6620 7265 7065 6174 2873 656c    def repeat(sel
+000178f0: 662c 2072 6570 6561 7473 2c20 6178 6973  f, repeats, axis
+00017900: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00017910: 2222 2252 6570 6561 7420 656c 656d 656e  """Repeat elemen
+00017920: 7473 206f 6620 616e 2061 7272 6179 2e0a  ts of an array..
+00017930: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
+00017940: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
+00017950: 7261 792e 7265 7065 6174 6020 666f 7220  ray.repeat` for 
+00017960: 6675 6c6c 2064 6f63 756d 656e 7461 7469  full documentati
+00017970: 6f6e 2e0a 0a20 2020 2020 2020 2053 6565  on...        See
+00017980: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
+00017990: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+000179a0: 6173 6b2e 6172 7261 792e 7265 7065 6174  ask.array.repeat
+000179b0: 203a 2065 7175 6976 616c 656e 7420 6675   : equivalent fu
+000179c0: 6e63 7469 6f6e 0a20 2020 2020 2020 2022  nction.        "
+000179d0: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+000179e0: 6461 736b 2e61 7272 6179 2e63 7265 6174  dask.array.creat
+000179f0: 696f 6e20 696d 706f 7274 2072 6570 6561  ion import repea
+00017a00: 740a 0a20 2020 2020 2020 2072 6574 7572  t..        retur
+00017a10: 6e20 7265 7065 6174 2873 656c 662c 2072  n repeat(self, r
+00017a20: 6570 6561 7473 2c20 6178 6973 3d61 7869  epeats, axis=axi
+00017a30: 7329 0a0a 2020 2020 6465 6620 6e6f 6e7a  s)..    def nonz
+00017a40: 6572 6f28 7365 6c66 293a 0a20 2020 2020  ero(self):.     
+00017a50: 2020 2022 2222 5265 7475 726e 2074 6865     """Return the
+00017a60: 2069 6e64 6963 6573 206f 6620 7468 6520   indices of the 
+00017a70: 656c 656d 656e 7473 2074 6861 7420 6172  elements that ar
+00017a80: 6520 6e6f 6e2d 7a65 726f 2e0a 0a20 2020  e non-zero...   
+00017a90: 2020 2020 2052 6566 6572 2074 6f20 3a66       Refer to :f
+00017aa0: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
+00017ab0: 6e6f 6e7a 6572 6f60 2066 6f72 2066 756c  nonzero` for ful
+00017ac0: 6c20 646f 6375 6d65 6e74 6174 696f 6e2e  l documentation.
+00017ad0: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+00017ae0: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+00017af0: 2d2d 2d0a 2020 2020 2020 2020 6461 736b  ---.        dask
+00017b00: 2e61 7272 6179 2e6e 6f6e 7a65 726f 203a  .array.nonzero :
+00017b10: 2065 7175 6976 616c 656e 7420 6675 6e63   equivalent func
+00017b20: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
+00017b30: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00017b40: 736b 2e61 7272 6179 2e72 6f75 7469 6e65  sk.array.routine
+00017b50: 7320 696d 706f 7274 206e 6f6e 7a65 726f  s import nonzero
+00017b60: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00017b70: 206e 6f6e 7a65 726f 2873 656c 6629 0a0a   nonzero(self)..
+00017b80: 2020 2020 6465 6620 746f 5f7a 6172 7228      def to_zarr(
+00017b90: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+00017ba0: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00017bb0: 2222 2253 6176 6520 6172 7261 7920 746f  """Save array to
+00017bc0: 2074 6865 207a 6172 7220 7374 6f72 6167   the zarr storag
+00017bd0: 6520 666f 726d 6174 0a0a 2020 2020 2020  e format..      
+00017be0: 2020 5365 6520 6874 7470 733a 2f2f 7a61    See https://za
+00017bf0: 7272 2e72 6561 6474 6865 646f 6373 2e69  rr.readthedocs.i
+00017c00: 6f20 666f 7220 6465 7461 696c 7320 6162  o for details ab
+00017c10: 6f75 7420 7468 6520 666f 726d 6174 2e0a  out the format..
+00017c20: 0a20 2020 2020 2020 2052 6566 6572 2074  .        Refer t
+00017c30: 6f20 3a66 756e 633a 6064 6173 6b2e 6172  o :func:`dask.ar
+00017c40: 7261 792e 746f 5f7a 6172 7260 2066 6f72  ray.to_zarr` for
+00017c50: 2066 756c 6c20 646f 6375 6d65 6e74 6174   full documentat
+00017c60: 696f 6e2e 0a0a 2020 2020 2020 2020 5365  ion...        Se
+00017c70: 6520 616c 736f 0a20 2020 2020 2020 202d  e also.        -
+00017c80: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00017c90: 6461 736b 2e61 7272 6179 2e74 6f5f 7a61  dask.array.to_za
+00017ca0: 7272 203a 2065 7175 6976 616c 656e 7420  rr : equivalent 
+00017cb0: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+00017cc0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+00017cd0: 7572 6e20 746f 5f7a 6172 7228 7365 6c66  urn to_zarr(self
+00017ce0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+00017cf0: 7329 0a0a 2020 2020 6465 6620 746f 5f74  s)..    def to_t
+00017d00: 696c 6564 6228 7365 6c66 2c20 7572 692c  iledb(self, uri,
+00017d10: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+00017d20: 293a 0a20 2020 2020 2020 2022 2222 5361  ):.        """Sa
+00017d30: 7665 2061 7272 6179 2074 6f20 7468 6520  ve array to the 
+00017d40: 5469 6c65 4442 2073 746f 7261 6765 206d  TileDB storage m
+00017d50: 616e 6167 6572 0a0a 2020 2020 2020 2020  anager..        
+00017d60: 5365 6520 6874 7470 733a 2f2f 646f 6373  See https://docs
+00017d70: 2e74 696c 6564 622e 696f 2066 6f72 2064  .tiledb.io for d
+00017d80: 6574 6169 6c73 2061 626f 7574 2074 6865  etails about the
+00017d90: 2066 6f72 6d61 7420 616e 6420 656e 6769   format and engi
+00017da0: 6e65 2e0a 0a20 2020 2020 2020 2053 6565  ne...        See
+00017db0: 2066 756e 6374 696f 6e20 3a66 756e 633a   function :func:
+00017dc0: 6064 6173 6b2e 6172 7261 792e 746f 5f74  `dask.array.to_t
+00017dd0: 696c 6564 6260 2066 6f72 2061 7267 756d  iledb` for argum
+00017de0: 656e 7420 646f 6375 6d65 6e74 6174 696f  ent documentatio
+00017df0: 6e2e 0a0a 2020 2020 2020 2020 5365 6520  n...        See 
+00017e00: 616c 736f 0a20 2020 2020 2020 202d 2d2d  also.        ---
+00017e10: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6461  -----.        da
+00017e20: 736b 2e61 7272 6179 2e74 6f5f 7469 6c65  sk.array.to_tile
+00017e30: 6462 203a 2065 7175 6976 616c 656e 7420  db : equivalent 
+00017e40: 6675 6e63 7469 6f6e 0a20 2020 2020 2020  function.       
+00017e50: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00017e60: 6d20 6461 736b 2e61 7272 6179 2e74 696c  m dask.array.til
+00017e70: 6564 625f 696f 2069 6d70 6f72 7420 746f  edb_io import to
+00017e80: 5f74 696c 6564 620a 0a20 2020 2020 2020  _tiledb..       
+00017e90: 2072 6574 7572 6e20 746f 5f74 696c 6564   return to_tiled
+00017ea0: 6228 7365 6c66 2c20 7572 692c 202a 6172  b(self, uri, *ar
+00017eb0: 6773 2c20 2a2a 6b77 6172 6773 290a 0a0a  gs, **kwargs)...
+00017ec0: 6465 6620 656e 7375 7265 5f69 6e74 2866  def ensure_int(f
+00017ed0: 293a 0a20 2020 2069 203d 2069 6e74 2866  ):.    i = int(f
+00017ee0: 290a 2020 2020 6966 2069 2021 3d20 663a  ).    if i != f:
+00017ef0: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+00017f00: 616c 7565 4572 726f 7228 2243 6f75 6c64  alueError("Could
+00017f10: 206e 6f74 2063 6f65 7263 6520 2566 2074   not coerce %f t
+00017f20: 6f20 696e 7465 6765 7222 2025 2066 290a  o integer" % f).
+00017f30: 2020 2020 7265 7475 726e 2069 0a0a 0a64      return i...d
+00017f40: 6566 206e 6f72 6d61 6c69 7a65 5f63 6875  ef normalize_chu
+00017f50: 6e6b 7328 6368 756e 6b73 2c20 7368 6170  nks(chunks, shap
+00017f60: 653d 4e6f 6e65 2c20 6c69 6d69 743d 4e6f  e=None, limit=No
+00017f70: 6e65 2c20 6474 7970 653d 4e6f 6e65 2c20  ne, dtype=None, 
+00017f80: 7072 6576 696f 7573 5f63 6875 6e6b 733d  previous_chunks=
+00017f90: 4e6f 6e65 293a 0a20 2020 2022 2222 4e6f  None):.    """No
+00017fa0: 726d 616c 697a 6520 6368 756e 6b73 2074  rmalize chunks t
+00017fb0: 6f20 7475 706c 6520 6f66 2074 7570 6c65  o tuple of tuple
+00017fc0: 730a 0a20 2020 2054 6869 7320 7461 6b65  s..    This take
+00017fd0: 7320 696e 2061 2076 6172 6965 7479 206f  s in a variety o
+00017fe0: 6620 696e 7075 7420 7479 7065 7320 616e  f input types an
+00017ff0: 6420 696e 666f 726d 6174 696f 6e20 616e  d information an
+00018000: 6420 7072 6f64 7563 6573 2061 2066 756c  d produces a ful
+00018010: 6c0a 2020 2020 7475 706c 652d 6f66 2d74  l.    tuple-of-t
+00018020: 7570 6c65 7320 7265 7375 6c74 2066 6f72  uples result for
+00018030: 2063 6875 6e6b 732c 2073 7569 7461 626c   chunks, suitabl
+00018040: 6520 746f 2062 6520 7061 7373 6564 2074  e to be passed t
+00018050: 6f20 4172 7261 7920 6f72 0a20 2020 2072  o Array or.    r
+00018060: 6563 6875 6e6b 206f 7220 616e 7920 6f74  echunk or any ot
+00018070: 6865 7220 6f70 6572 6174 696f 6e20 7468  her operation th
+00018080: 6174 2063 7265 6174 6573 2061 2044 6173  at creates a Das
+00018090: 6b20 6172 7261 792e 0a0a 2020 2020 5061  k array...    Pa
+000180a0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+000180b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6368 756e  -------.    chun
+000180c0: 6b73 3a20 7475 706c 652c 2069 6e74 2c20  ks: tuple, int, 
+000180d0: 6469 6374 2c20 6f72 2073 7472 696e 670a  dict, or string.
+000180e0: 2020 2020 2020 2020 5468 6520 6368 756e          The chun
+000180f0: 6b73 2074 6f20 6265 206e 6f72 6d61 6c69  ks to be normali
+00018100: 7a65 642e 2020 5365 6520 6578 616d 706c  zed.  See exampl
+00018110: 6573 2062 656c 6f77 2066 6f72 206d 6f72  es below for mor
+00018120: 6520 6465 7461 696c 730a 2020 2020 7368  e details.    sh
+00018130: 6170 653a 2054 7570 6c65 5b69 6e74 5d0a  ape: Tuple[int].
+00018140: 2020 2020 2020 2020 5468 6520 7368 6170          The shap
+00018150: 6520 6f66 2074 6865 2061 7272 6179 0a20  e of the array. 
+00018160: 2020 206c 696d 6974 3a20 696e 7420 286f     limit: int (o
+00018170: 7074 696f 6e61 6c29 0a20 2020 2020 2020  ptional).       
+00018180: 2054 6865 206d 6178 696d 756d 2062 6c6f   The maximum blo
+00018190: 636b 2073 697a 6520 746f 2074 6172 6765  ck size to targe
+000181a0: 7420 696e 2062 7974 6573 2c0a 2020 2020  t in bytes,.    
+000181b0: 2020 2020 6966 2066 7265 6564 6f6d 2069      if freedom i
+000181c0: 7320 6769 7665 6e20 746f 2063 686f 6f73  s given to choos
+000181d0: 650a 2020 2020 6474 7970 653a 206e 702e  e.    dtype: np.
+000181e0: 6474 7970 650a 2020 2020 7072 6576 696f  dtype.    previo
+000181f0: 7573 5f63 6875 6e6b 733a 2054 7570 6c65  us_chunks: Tuple
+00018200: 5b54 7570 6c65 5b69 6e74 5d5d 206f 7074  [Tuple[int]] opt
+00018210: 696f 6e61 6c0a 2020 2020 2020 2020 4368  ional.        Ch
+00018220: 756e 6b73 2066 726f 6d20 6120 7072 6576  unks from a prev
+00018230: 696f 7573 2061 7272 6179 2074 6861 7420  ious array that 
+00018240: 7765 2073 686f 756c 6420 7573 6520 666f  we should use fo
+00018250: 7220 696e 7370 6972 6174 696f 6e20 7768  r inspiration wh
+00018260: 656e 0a20 2020 2020 2020 2072 6563 6875  en.        rechu
+00018270: 6e6b 696e 6720 6175 746f 2064 696d 656e  nking auto dimen
+00018280: 7369 6f6e 732e 2020 4966 206e 6f74 2070  sions.  If not p
+00018290: 726f 7669 6465 6420 6275 7420 6175 746f  rovided but auto
+000182a0: 2d63 6875 6e6b 696e 6720 6578 6973 7473  -chunking exists
+000182b0: 0a20 2020 2020 2020 2074 6865 6e20 6175  .        then au
+000182c0: 746f 2d64 696d 656e 7369 6f6e 7320 7769  to-dimensions wi
+000182d0: 6c6c 2070 7265 6665 7220 7371 7561 7265  ll prefer square
+000182e0: 2d6c 696b 6520 6368 756e 6b20 7368 6170  -like chunk shap
+000182f0: 6573 2e0a 0a20 2020 2045 7861 6d70 6c65  es...    Example
+00018300: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
+00018310: 2020 2053 7065 6369 6679 2075 6e69 666f     Specify unifo
+00018320: 726d 2063 6875 6e6b 2073 697a 6573 0a0a  rm chunk sizes..
+00018330: 2020 2020 3e3e 3e20 6672 6f6d 2064 6173      >>> from das
+00018340: 6b2e 6172 7261 792e 636f 7265 2069 6d70  k.array.core imp
+00018350: 6f72 7420 6e6f 726d 616c 697a 655f 6368  ort normalize_ch
+00018360: 756e 6b73 0a20 2020 203e 3e3e 206e 6f72  unks.    >>> nor
+00018370: 6d61 6c69 7a65 5f63 6875 6e6b 7328 2832  malize_chunks((2
+00018380: 2c20 3229 2c20 7368 6170 653d 2835 2c20  , 2), shape=(5, 
+00018390: 3629 290a 2020 2020 2828 322c 2032 2c20  6)).    ((2, 2, 
+000183a0: 3129 2c20 2832 2c20 322c 2032 2929 0a0a  1), (2, 2, 2))..
+000183b0: 2020 2020 416c 736f 2070 6173 7365 7320      Also passes 
+000183c0: 7468 726f 7567 6820 6675 6c6c 7920 6578  through fully ex
+000183d0: 706c 6963 6974 2074 7570 6c65 2d6f 662d  plicit tuple-of-
+000183e0: 7475 706c 6573 0a0a 2020 2020 3e3e 3e20  tuples..    >>> 
+000183f0: 6e6f 726d 616c 697a 655f 6368 756e 6b73  normalize_chunks
+00018400: 2828 2832 2c20 322c 2031 292c 2028 322c  (((2, 2, 1), (2,
+00018410: 2032 2c20 3229 292c 2073 6861 7065 3d28   2, 2)), shape=(
+00018420: 352c 2036 2929 0a20 2020 2028 2832 2c20  5, 6)).    ((2, 
+00018430: 322c 2031 292c 2028 322c 2032 2c20 3229  2, 1), (2, 2, 2)
+00018440: 290a 0a20 2020 2043 6c65 616e 7320 7570  )..    Cleans up
+00018450: 206c 6973 7473 2074 6f20 7475 706c 6573   lists to tuples
+00018460: 0a0a 2020 2020 3e3e 3e20 6e6f 726d 616c  ..    >>> normal
+00018470: 697a 655f 6368 756e 6b73 285b 5b32 2c20  ize_chunks([[2, 
+00018480: 325d 2c20 5b33 2c20 335d 5d29 0a20 2020  2], [3, 3]]).   
+00018490: 2028 2832 2c20 3229 2c20 2833 2c20 3329   ((2, 2), (3, 3)
+000184a0: 290a 0a20 2020 2045 7870 616e 6473 2069  )..    Expands i
+000184b0: 6e74 6567 6572 2069 6e70 7574 7320 3130  nteger inputs 10
+000184c0: 202d 3e20 2831 302c 2031 3029 0a0a 2020   -> (10, 10)..  
+000184d0: 2020 3e3e 3e20 6e6f 726d 616c 697a 655f    >>> normalize_
+000184e0: 6368 756e 6b73 2831 302c 2073 6861 7065  chunks(10, shape
+000184f0: 3d28 3330 2c20 3529 290a 2020 2020 2828  =(30, 5)).    ((
+00018500: 3130 2c20 3130 2c20 3130 292c 2028 352c  10, 10, 10), (5,
+00018510: 2929 0a0a 2020 2020 4578 7061 6e64 7320  ))..    Expands 
+00018520: 6469 6374 2069 6e70 7574 730a 0a20 2020  dict inputs..   
+00018530: 203e 3e3e 206e 6f72 6d61 6c69 7a65 5f63   >>> normalize_c
+00018540: 6875 6e6b 7328 7b30 3a20 322c 2031 3a20  hunks({0: 2, 1: 
+00018550: 337d 2c20 7368 6170 653d 2836 2c20 3629  3}, shape=(6, 6)
+00018560: 290a 2020 2020 2828 322c 2032 2c20 3229  ).    ((2, 2, 2)
+00018570: 2c20 2833 2c20 3329 290a 0a20 2020 2054  , (3, 3))..    T
+00018580: 6865 2076 616c 7565 7320 2d31 2061 6e64  he values -1 and
+00018590: 204e 6f6e 6520 6765 7420 6d61 7070 6564   None get mapped
+000185a0: 2074 6f20 6675 6c6c 2073 697a 650a 0a20   to full size.. 
+000185b0: 2020 203e 3e3e 206e 6f72 6d61 6c69 7a65     >>> normalize
+000185c0: 5f63 6875 6e6b 7328 2835 2c20 2d31 292c  _chunks((5, -1),
+000185d0: 2073 6861 7065 3d28 3130 2c20 3130 2929   shape=(10, 10))
+000185e0: 0a20 2020 2028 2835 2c20 3529 2c20 2831  .    ((5, 5), (1
+000185f0: 302c 2929 0a0a 2020 2020 5573 6520 7468  0,))..    Use th
+00018600: 6520 7661 6c75 6520 2261 7574 6f22 2074  e value "auto" t
+00018610: 6f20 6175 746f 6d61 7469 6361 6c6c 7920  o automatically 
+00018620: 6465 7465 726d 696e 6520 6368 756e 6b20  determine chunk 
+00018630: 7369 7a65 7320 616c 6f6e 6720 6365 7274  sizes along cert
+00018640: 6169 6e0a 2020 2020 6469 6d65 6e73 696f  ain.    dimensio
+00018650: 6e73 2e20 2054 6869 7320 7573 6573 2074  ns.  This uses t
+00018660: 6865 2060 606c 696d 6974 3d60 6020 616e  he ``limit=`` an
+00018670: 6420 6060 6474 7970 653d 6060 206b 6579  d ``dtype=`` key
+00018680: 776f 7264 7320 746f 0a20 2020 2064 6574  words to.    det
+00018690: 6572 6d69 6e65 2068 6f77 206c 6172 6765  ermine how large
+000186a0: 2074 6f20 6d61 6b65 2074 6865 2063 6875   to make the chu
+000186b0: 6e6b 732e 2020 5468 6520 7465 726d 2022  nks.  The term "
+000186c0: 6175 746f 2220 6361 6e20 6265 2075 7365  auto" can be use
+000186d0: 640a 2020 2020 616e 7977 6865 7265 2061  d.    anywhere a
+000186e0: 6e20 696e 7465 6765 7220 6361 6e20 6265  n integer can be
+000186f0: 2075 7365 642e 2020 5365 6520 6172 7261   used.  See arra
+00018700: 7920 6368 756e 6b69 6e67 2064 6f63 756d  y chunking docum
+00018710: 656e 7461 7469 6f6e 2066 6f72 206d 6f72  entation for mor
+00018720: 650a 2020 2020 696e 666f 726d 6174 696f  e.    informatio
+00018730: 6e2e 0a0a 2020 2020 3e3e 3e20 6e6f 726d  n...    >>> norm
+00018740: 616c 697a 655f 6368 756e 6b73 2828 2261  alize_chunks(("a
+00018750: 7574 6f22 2c29 2c20 7368 6170 653d 2832  uto",), shape=(2
+00018760: 302c 292c 206c 696d 6974 3d35 2c20 6474  0,), limit=5, dt
+00018770: 7970 653d 2775 696e 7438 2729 0a20 2020  ype='uint8').   
+00018780: 2028 2835 2c20 352c 2035 2c20 3529 2c29   ((5, 5, 5, 5),)
+00018790: 0a0a 2020 2020 596f 7520 6361 6e20 616c  ..    You can al
+000187a0: 736f 2075 7365 2062 7974 6520 7369 7a65  so use byte size
+000187b0: 7320 2873 6565 203a 6675 6e63 3a60 6461  s (see :func:`da
+000187c0: 736b 2e75 7469 6c73 2e70 6172 7365 5f62  sk.utils.parse_b
+000187d0: 7974 6573 6029 2069 6e20 706c 6163 6520  ytes`) in place 
+000187e0: 6f66 0a20 2020 2022 6175 746f 2220 746f  of.    "auto" to
+000187f0: 2061 736b 2066 6f72 2061 2070 6172 7469   ask for a parti
+00018800: 6375 6c61 7220 7369 7a65 0a0a 2020 2020  cular size..    
+00018810: 3e3e 3e20 6e6f 726d 616c 697a 655f 6368  >>> normalize_ch
+00018820: 756e 6b73 2822 316b 6942 222c 2073 6861  unks("1kiB", sha
+00018830: 7065 3d28 3230 3030 2c29 2c20 6474 7970  pe=(2000,), dtyp
+00018840: 653d 2766 6c6f 6174 3332 2729 0a20 2020  e='float32').   
+00018850: 2028 2832 3536 2c20 3235 362c 2032 3536   ((256, 256, 256
+00018860: 2c20 3235 362c 2032 3536 2c20 3235 362c  , 256, 256, 256,
+00018870: 2032 3536 2c20 3230 3829 2c29 0a0a 2020   256, 208),)..  
+00018880: 2020 5265 7370 6563 7473 206e 756c 6c20    Respects null 
+00018890: 6469 6d65 6e73 696f 6e73 0a0a 2020 2020  dimensions..    
+000188a0: 3e3e 3e20 6e6f 726d 616c 697a 655f 6368  >>> normalize_ch
+000188b0: 756e 6b73 2828 292c 2073 6861 7065 3d28  unks((), shape=(
+000188c0: 302c 2030 2929 0a20 2020 2028 2830 2c29  0, 0)).    ((0,)
+000188d0: 2c20 2830 2c29 290a 2020 2020 2222 220a  , (0,)).    """.
+000188e0: 2020 2020 6966 2064 7479 7065 2061 6e64      if dtype and
+000188f0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00018900: 6474 7970 652c 206e 702e 6474 7970 6529  dtype, np.dtype)
+00018910: 3a0a 2020 2020 2020 2020 6474 7970 6520  :.        dtype 
+00018920: 3d20 6e70 2e64 7479 7065 2864 7479 7065  = np.dtype(dtype
+00018930: 290a 2020 2020 6966 2063 6875 6e6b 7320  ).    if chunks 
+00018940: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00018950: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00018960: 7228 4348 554e 4b53 5f4e 4f4e 455f 4552  r(CHUNKS_NONE_ER
+00018970: 524f 525f 4d45 5353 4147 4529 0a20 2020  ROR_MESSAGE).   
+00018980: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
+00018990: 6875 6e6b 732c 206c 6973 7429 3a0a 2020  hunks, list):.  
+000189a0: 2020 2020 2020 6368 756e 6b73 203d 2074        chunks = t
+000189b0: 7570 6c65 2863 6875 6e6b 7329 0a20 2020  uple(chunks).   
+000189c0: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
+000189d0: 6875 6e6b 732c 2028 4e75 6d62 6572 2c20  hunks, (Number, 
+000189e0: 7374 7229 293a 0a20 2020 2020 2020 2063  str)):.        c
+000189f0: 6875 6e6b 7320 3d20 2863 6875 6e6b 732c  hunks = (chunks,
+00018a00: 2920 2a20 6c65 6e28 7368 6170 6529 0a20  ) * len(shape). 
+00018a10: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00018a20: 2863 6875 6e6b 732c 2064 6963 7429 3a0a  (chunks, dict):.
+00018a30: 2020 2020 2020 2020 6368 756e 6b73 203d          chunks =
+00018a40: 2074 7570 6c65 2863 6875 6e6b 732e 6765   tuple(chunks.ge
+00018a50: 7428 692c 204e 6f6e 6529 2066 6f72 2069  t(i, None) for i
+00018a60: 2069 6e20 7261 6e67 6528 6c65 6e28 7368   in range(len(sh
+00018a70: 6170 6529 2929 0a20 2020 2069 6620 6973  ape))).    if is
+00018a80: 696e 7374 616e 6365 2863 6875 6e6b 732c  instance(chunks,
+00018a90: 206e 702e 6e64 6172 7261 7929 3a0a 2020   np.ndarray):.  
+00018aa0: 2020 2020 2020 6368 756e 6b73 203d 2063        chunks = c
+00018ab0: 6875 6e6b 732e 746f 6c69 7374 2829 0a20  hunks.tolist(). 
+00018ac0: 2020 2069 6620 6e6f 7420 6368 756e 6b73     if not chunks
+00018ad0: 2061 6e64 2073 6861 7065 2061 6e64 2061   and shape and a
+00018ae0: 6c6c 2873 203d 3d20 3020 666f 7220 7320  ll(s == 0 for s 
+00018af0: 696e 2073 6861 7065 293a 0a20 2020 2020  in shape):.     
+00018b00: 2020 2063 6875 6e6b 7320 3d20 2828 302c     chunks = ((0,
+00018b10: 292c 2920 2a20 6c65 6e28 7368 6170 6529  ),) * len(shape)
+00018b20: 0a0a 2020 2020 6966 2028 0a20 2020 2020  ..    if (.     
+00018b30: 2020 2073 6861 7065 0a20 2020 2020 2020     shape.       
+00018b40: 2061 6e64 206c 656e 2873 6861 7065 2920   and len(shape) 
+00018b50: 3d3d 2031 0a20 2020 2020 2020 2061 6e64  == 1.        and
+00018b60: 206c 656e 2863 6875 6e6b 7329 203e 2031   len(chunks) > 1
+00018b70: 0a20 2020 2020 2020 2061 6e64 2061 6c6c  .        and all
+00018b80: 2869 7369 6e73 7461 6e63 6528 632c 2028  (isinstance(c, (
+00018b90: 4e75 6d62 6572 2c20 7374 7229 2920 666f  Number, str)) fo
+00018ba0: 7220 6320 696e 2063 6875 6e6b 7329 0a20  r c in chunks). 
+00018bb0: 2020 2029 3a0a 2020 2020 2020 2020 6368     ):.        ch
+00018bc0: 756e 6b73 203d 2028 6368 756e 6b73 2c29  unks = (chunks,)
+00018bd0: 0a0a 2020 2020 6966 2073 6861 7065 2061  ..    if shape a
+00018be0: 6e64 206c 656e 2863 6875 6e6b 7329 2021  nd len(chunks) !
+00018bf0: 3d20 6c65 6e28 7368 6170 6529 3a0a 2020  = len(shape):.  
+00018c00: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00018c10: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00018c20: 2020 2020 2243 6875 6e6b 7320 616e 6420      "Chunks and 
+00018c30: 7368 6170 6520 6d75 7374 2062 6520 6f66  shape must be of
+00018c40: 2074 6865 2073 616d 6520 6c65 6e67 7468   the same length
+00018c50: 2f64 696d 656e 7369 6f6e 2e20 220a 2020  /dimension. ".  
+00018c60: 2020 2020 2020 2020 2020 2247 6f74 2063            "Got c
+00018c70: 6875 6e6b 733d 2573 2c20 7368 6170 653d  hunks=%s, shape=
+00018c80: 2573 2220 2520 2863 6875 6e6b 732c 2073  %s" % (chunks, s
+00018c90: 6861 7065 290a 2020 2020 2020 2020 290a  hape).        ).
+00018ca0: 2020 2020 6966 202d 3120 696e 2063 6875      if -1 in chu
+00018cb0: 6e6b 7320 6f72 204e 6f6e 6520 696e 2063  nks or None in c
+00018cc0: 6875 6e6b 733a 0a20 2020 2020 2020 2063  hunks:.        c
+00018cd0: 6875 6e6b 7320 3d20 7475 706c 6528 7320  hunks = tuple(s 
+00018ce0: 6966 2063 203d 3d20 2d31 206f 7220 6320  if c == -1 or c 
+00018cf0: 6973 204e 6f6e 6520 656c 7365 2063 2066  is None else c f
+00018d00: 6f72 2063 2c20 7320 696e 207a 6970 2863  or c, s in zip(c
+00018d10: 6875 6e6b 732c 2073 6861 7065 2929 0a0a  hunks, shape))..
+00018d20: 2020 2020 2320 4966 2073 7065 6369 6679      # If specify
+00018d30: 696e 6720 6368 756e 6b20 7369 7a65 2069  ing chunk size i
+00018d40: 6e20 6279 7465 732c 2075 7365 2074 6861  n bytes, use tha
+00018d50: 7420 7661 6c75 6520 746f 2073 6574 2074  t value to set t
+00018d60: 6865 206c 696d 6974 2e0a 2020 2020 2320  he limit..    # 
+00018d70: 5665 7269 6679 2074 6865 7265 2069 7320  Verify there is 
+00018d80: 6f6e 6c79 206f 6e65 2063 6f6e 7369 7374  only one consist
+00018d90: 656e 7420 7661 6c75 6520 6f66 206c 696d  ent value of lim
+00018da0: 6974 206f 7220 6368 756e 6b2d 6279 7465  it or chunk-byte
+00018db0: 7320 7573 6564 2e0a 2020 2020 666f 7220  s used..    for 
+00018dc0: 6320 696e 2063 6875 6e6b 733a 0a20 2020  c in chunks:.   
+00018dd0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00018de0: 6365 2863 2c20 7374 7229 2061 6e64 2063  ce(c, str) and c
+00018df0: 2021 3d20 2261 7574 6f22 3a0a 2020 2020   != "auto":.    
+00018e00: 2020 2020 2020 2020 7061 7273 6564 203d          parsed =
+00018e10: 2070 6172 7365 5f62 7974 6573 2863 290a   parse_bytes(c).
+00018e20: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00018e30: 696d 6974 2069 7320 4e6f 6e65 3a0a 2020  imit is None:.  
+00018e40: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00018e50: 6d69 7420 3d20 7061 7273 6564 0a20 2020  mit = parsed.   
+00018e60: 2020 2020 2020 2020 2065 6c69 6620 7061           elif pa
+00018e70: 7273 6564 2021 3d20 6c69 6d69 743a 0a20  rsed != limit:. 
+00018e80: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00018e90: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00018ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018eb0: 2020 2020 2022 4f6e 6c79 206f 6e65 2063       "Only one c
+00018ec0: 6f6e 7369 7374 656e 7420 7661 6c75 6520  onsistent value 
+00018ed0: 6f66 206c 696d 6974 206f 7220 6368 756e  of limit or chun
+00018ee0: 6b20 6973 2061 6c6c 6f77 6564 2e22 0a20  k is allowed.". 
+00018ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f00: 2020 2022 5573 6564 2025 7320 213d 2025     "Used %s != %
+00018f10: 7322 2025 2028 7061 7273 6564 2c20 6c69  s" % (parsed, li
+00018f20: 6d69 7429 0a20 2020 2020 2020 2020 2020  mit).           
+00018f30: 2020 2020 2029 0a20 2020 2023 2053 7562       ).    # Sub
+00018f40: 7374 6974 7574 6520 6279 7465 206c 696d  stitute byte lim
+00018f50: 6974 7320 7769 7468 2027 6175 746f 2720  its with 'auto' 
+00018f60: 6e6f 7720 7468 6174 206c 696d 6974 2069  now that limit i
+00018f70: 7320 7365 742e 0a20 2020 2063 6875 6e6b  s set..    chunk
+00018f80: 7320 3d20 7475 706c 6528 2261 7574 6f22  s = tuple("auto"
+00018f90: 2069 6620 6973 696e 7374 616e 6365 2863   if isinstance(c
+00018fa0: 2c20 7374 7229 2061 6e64 2063 2021 3d20  , str) and c != 
+00018fb0: 2261 7574 6f22 2065 6c73 6520 6320 666f  "auto" else c fo
+00018fc0: 7220 6320 696e 2063 6875 6e6b 7329 0a0a  r c in chunks)..
+00018fd0: 2020 2020 6966 2061 6e79 2863 203d 3d20      if any(c == 
+00018fe0: 2261 7574 6f22 2066 6f72 2063 2069 6e20  "auto" for c in 
+00018ff0: 6368 756e 6b73 293a 0a20 2020 2020 2020  chunks):.       
+00019000: 2063 6875 6e6b 7320 3d20 6175 746f 5f63   chunks = auto_c
+00019010: 6875 6e6b 7328 6368 756e 6b73 2c20 7368  hunks(chunks, sh
+00019020: 6170 652c 206c 696d 6974 2c20 6474 7970  ape, limit, dtyp
+00019030: 652c 2070 7265 7669 6f75 735f 6368 756e  e, previous_chun
+00019040: 6b73 290a 0a20 2020 2069 6620 7368 6170  ks)..    if shap
+00019050: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00019060: 2020 2020 2020 2063 6875 6e6b 7320 3d20         chunks = 
+00019070: 7475 706c 6528 6320 6966 2063 206e 6f74  tuple(c if c not
+00019080: 2069 6e20 7b4e 6f6e 652c 202d 317d 2065   in {None, -1} e
+00019090: 6c73 6520 7320 666f 7220 632c 2073 2069  lse s for c, s i
+000190a0: 6e20 7a69 7028 6368 756e 6b73 2c20 7368  n zip(chunks, sh
+000190b0: 6170 6529 290a 0a20 2020 2069 6620 6368  ape))..    if ch
+000190c0: 756e 6b73 2061 6e64 2073 6861 7065 2069  unks and shape i
+000190d0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+000190e0: 2020 2020 6368 756e 6b73 203d 2073 756d      chunks = sum
+000190f0: 280a 2020 2020 2020 2020 2020 2020 280a  (.            (.
+00019100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019110: 626c 6f63 6b64 696d 735f 6672 6f6d 5f62  blockdims_from_b
+00019120: 6c6f 636b 7368 6170 6528 2873 2c29 2c20  lockshape((s,), 
+00019130: 2863 2c29 290a 2020 2020 2020 2020 2020  (c,)).          
+00019140: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00019150: 6e73 7461 6e63 6528 632c 2028 7475 706c  nstance(c, (tupl
+00019160: 652c 206c 6973 7429 290a 2020 2020 2020  e, list)).      
+00019170: 2020 2020 2020 2020 2020 656c 7365 2028            else (
+00019180: 632c 290a 2020 2020 2020 2020 2020 2020  c,).            
+00019190: 2020 2020 666f 7220 732c 2063 2069 6e20      for s, c in 
+000191a0: 7a69 7028 7368 6170 652c 2063 6875 6e6b  zip(shape, chunk
+000191b0: 7329 0a20 2020 2020 2020 2020 2020 2029  s).            )
+000191c0: 2c0a 2020 2020 2020 2020 2020 2020 2829  ,.            ()
+000191d0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+000191e0: 666f 7220 6320 696e 2063 6875 6e6b 733a  for c in chunks:
+000191f0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00019200: 633a 0a20 2020 2020 2020 2020 2020 2072  c:.            r
+00019210: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00019220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019230: 2022 456d 7074 7920 7475 706c 6573 2061   "Empty tuples a
+00019240: 7265 206e 6f74 2061 6c6c 6f77 6564 2069  re not allowed i
+00019250: 6e20 6368 756e 6b73 2e20 4578 7072 6573  n chunks. Expres
+00019260: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
+00019270: 2020 2020 227a 6572 6f20 6c65 6e67 7468      "zero length
+00019280: 2064 696d 656e 7369 6f6e 7320 7769 7468   dimensions with
+00019290: 2030 2873 2920 696e 2063 6875 6e6b 7322   0(s) in chunks"
+000192a0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+000192b0: 2020 2020 6966 2073 6861 7065 2069 7320      if shape is 
+000192c0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+000192d0: 2020 6966 206c 656e 2863 6875 6e6b 7329    if len(chunks)
+000192e0: 2021 3d20 6c65 6e28 7368 6170 6529 3a0a   != len(shape):.
+000192f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00019300: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+00019310: 2020 2020 2020 2020 2020 2020 2020 2249                "I
+00019320: 6e70 7574 2061 7272 6179 2068 6173 2025  nput array has %
+00019330: 6420 6469 6d65 6e73 696f 6e73 2062 7574  d dimensions but
+00019340: 2074 6865 2073 7570 706c 6965 6420 220a   the supplied ".
+00019350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019360: 2263 6875 6e6b 7320 6861 7320 6f6e 6c79  "chunks has only
+00019370: 2025 6420 6469 6d65 6e73 696f 6e73 2220   %d dimensions" 
+00019380: 2520 286c 656e 2873 6861 7065 292c 206c  % (len(shape), l
+00019390: 656e 2863 6875 6e6b 7329 290a 2020 2020  en(chunks)).    
+000193a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000193b0: 2020 6966 206e 6f74 2061 6c6c 280a 2020    if not all(.  
+000193c0: 2020 2020 2020 2020 2020 6320 3d3d 2073            c == s
+000193d0: 206f 7220 286d 6174 682e 6973 6e61 6e28   or (math.isnan(
+000193e0: 6329 206f 7220 6d61 7468 2e69 736e 616e  c) or math.isnan
+000193f0: 2873 2929 0a20 2020 2020 2020 2020 2020  (s)).           
+00019400: 2066 6f72 2063 2c20 7320 696e 207a 6970   for c, s in zip
+00019410: 286d 6170 2873 756d 2c20 6368 756e 6b73  (map(sum, chunks
+00019420: 292c 2073 6861 7065 290a 2020 2020 2020  ), shape).      
+00019430: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+00019440: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00019450: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00019460: 2020 2022 4368 756e 6b73 2064 6f20 6e6f     "Chunks do no
+00019470: 7420 6164 6420 7570 2074 6f20 7368 6170  t add up to shap
+00019480: 652e 2022 0a20 2020 2020 2020 2020 2020  e. ".           
+00019490: 2020 2020 2022 476f 7420 6368 756e 6b73       "Got chunks
+000194a0: 3d25 732c 2073 6861 7065 3d25 7322 2025  =%s, shape=%s" %
+000194b0: 2028 6368 756e 6b73 2c20 7368 6170 6529   (chunks, shape)
+000194c0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+000194d0: 2020 2020 7265 7475 726e 2074 7570 6c65      return tuple
+000194e0: 280a 2020 2020 2020 2020 7475 706c 6528  (.        tuple(
+000194f0: 696e 7428 7829 2069 6620 6e6f 7420 6d61  int(x) if not ma
+00019500: 7468 2e69 736e 616e 2878 2920 656c 7365  th.isnan(x) else
+00019510: 206e 702e 6e61 6e20 666f 7220 7820 696e   np.nan for x in
+00019520: 2063 2920 666f 7220 6320 696e 2063 6875   c) for c in chu
+00019530: 6e6b 730a 2020 2020 290a 0a0a 6465 6620  nks.    )...def 
+00019540: 5f63 6f6d 7075 7465 5f6d 756c 7469 706c  _compute_multipl
+00019550: 6965 7228 6c69 6d69 743a 2069 6e74 2c20  ier(limit: int, 
+00019560: 6474 7970 652c 206c 6172 6765 7374 5f62  dtype, largest_b
+00019570: 6c6f 636b 3a20 696e 742c 2072 6573 756c  lock: int, resul
+00019580: 7429 3a0a 2020 2020 2222 220a 2020 2020  t):.    """.    
+00019590: 5574 696c 6974 7920 6675 6e63 7469 6f6e  Utility function
+000195a0: 2066 6f72 2061 7574 6f5f 6368 756e 6b2c   for auto_chunk,
+000195b0: 2074 6f20 6669 6e20 686f 7720 6d75 6368   to fin how much
+000195c0: 206c 6172 6765 7220 6f72 2073 6d61 6c6c   larger or small
+000195d0: 6572 2074 6865 2069 6465 616c 0a20 2020  er the ideal.   
+000195e0: 2063 6875 6e6b 2073 697a 6520 6973 2072   chunk size is r
+000195f0: 656c 6174 6976 6520 746f 2077 6861 7420  elative to what 
+00019600: 7765 2068 6176 6520 6e6f 772e 0a20 2020  we have now..   
+00019610: 2022 2222 0a20 2020 2072 6574 7572 6e20   """.    return 
+00019620: 280a 2020 2020 2020 2020 6c69 6d69 740a  (.        limit.
+00019630: 2020 2020 2020 2020 2f20 6474 7970 652e          / dtype.
+00019640: 6974 656d 7369 7a65 0a20 2020 2020 2020  itemsize.       
+00019650: 202f 206c 6172 6765 7374 5f62 6c6f 636b   / largest_block
+00019660: 0a20 2020 2020 2020 202f 206d 6174 682e  .        / math.
+00019670: 7072 6f64 2872 2066 6f72 2072 2069 6e20  prod(r for r in 
+00019680: 7265 7375 6c74 2e76 616c 7565 7328 2920  result.values() 
+00019690: 6966 2072 290a 2020 2020 290a 0a0a 6465  if r).    )...de
+000196a0: 6620 6175 746f 5f63 6875 6e6b 7328 6368  f auto_chunks(ch
+000196b0: 756e 6b73 2c20 7368 6170 652c 206c 696d  unks, shape, lim
+000196c0: 6974 2c20 6474 7970 652c 2070 7265 7669  it, dtype, previ
+000196d0: 6f75 735f 6368 756e 6b73 3d4e 6f6e 6529  ous_chunks=None)
+000196e0: 3a0a 2020 2020 2222 2244 6574 6572 6d69  :.    """Determi
+000196f0: 6e65 2061 7574 6f6d 6174 6963 2063 6875  ne automatic chu
+00019700: 6e6b 730a 0a20 2020 2054 6869 7320 7461  nks..    This ta
+00019710: 6b65 7320 696e 2061 2063 6875 6e6b 7320  kes in a chunks 
+00019720: 7661 6c75 6520 7468 6174 2063 6f6e 7461  value that conta
+00019730: 696e 7320 6060 2261 7574 6f22 6060 2076  ins ``"auto"`` v
+00019740: 616c 7565 7320 696e 2063 6572 7461 696e  alues in certain
+00019750: 0a20 2020 2064 696d 656e 7369 6f6e 7320  .    dimensions 
+00019760: 616e 6420 7265 706c 6163 6573 2074 686f  and replaces tho
+00019770: 7365 2076 616c 7565 7320 7769 7468 2063  se values with c
+00019780: 6f6e 6372 6574 6520 6469 6d65 6e73 696f  oncrete dimensio
+00019790: 6e20 7369 7a65 7320 7468 6174 2074 7279  n sizes that try
+000197a0: 0a20 2020 2074 6f20 6765 7420 6368 756e  .    to get chun
+000197b0: 6b73 2074 6f20 6265 206f 6620 6120 6365  ks to be of a ce
+000197c0: 7274 6169 6e20 7369 7a65 2069 6e20 6279  rtain size in by
+000197d0: 7465 732c 2070 726f 7669 6465 6420 6279  tes, provided by
+000197e0: 2074 6865 2060 606c 696d 6974 3d60 600a   the ``limit=``.
+000197f0: 2020 2020 6b65 7977 6f72 642e 2020 4966      keyword.  If
+00019800: 206d 756c 7469 706c 6520 6469 6d65 6e73   multiple dimens
+00019810: 696f 6e73 2061 7265 206d 6172 6b65 6420  ions are marked 
+00019820: 6173 2060 6022 6175 746f 2260 6020 7468  as ``"auto"`` th
+00019830: 656e 2074 6865 7920 7769 6c6c 0a20 2020  en they will.   
+00019840: 2061 6c6c 2072 6573 706f 6e64 2074 6f20   all respond to 
+00019850: 6d65 6574 2074 6865 2064 6573 6972 6564  meet the desired
+00019860: 2062 7974 6520 6c69 6d69 742c 2074 7279   byte limit, try
+00019870: 696e 6720 746f 2072 6573 7065 6374 2074  ing to respect t
+00019880: 6865 2061 7370 6563 740a 2020 2020 7261  he aspect.    ra
+00019890: 7469 6f20 6f66 2074 6865 6972 2064 696d  tio of their dim
+000198a0: 656e 7369 6f6e 7320 696e 2060 6070 7265  ensions in ``pre
+000198b0: 7669 6f75 735f 6368 756e 6b73 3d60 602c  vious_chunks=``,
+000198c0: 2069 6620 6769 7665 6e2e 0a0a 2020 2020   if given...    
+000198d0: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
+000198e0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6368  ---------.    ch
+000198f0: 756e 6b73 3a20 5475 706c 650a 2020 2020  unks: Tuple.    
+00019900: 2020 2020 4120 7475 706c 6520 6f66 2065      A tuple of e
+00019910: 6974 6865 7220 6469 6d65 6e73 696f 6e73  ither dimensions
+00019920: 206f 7220 7475 706c 6573 206f 6620 6578   or tuples of ex
+00019930: 706c 6963 6974 2063 6875 6e6b 2064 696d  plicit chunk dim
+00019940: 656e 7369 6f6e 730a 2020 2020 2020 2020  ensions.        
+00019950: 536f 6d65 2065 6e74 7269 6573 2073 686f  Some entries sho
+00019960: 756c 6420 6265 2022 6175 746f 220a 2020  uld be "auto".  
+00019970: 2020 7368 6170 653a 2054 7570 6c65 5b69    shape: Tuple[i
+00019980: 6e74 5d0a 2020 2020 6c69 6d69 743a 2069  nt].    limit: i
+00019990: 6e74 2c20 7374 720a 2020 2020 2020 2020  nt, str.        
+000199a0: 5468 6520 6d61 7869 6d75 6d20 616c 6c6f  The maximum allo
+000199b0: 7761 626c 6520 7369 7a65 206f 6620 6120  wable size of a 
+000199c0: 6368 756e 6b20 696e 2062 7974 6573 0a20  chunk in bytes. 
+000199d0: 2020 2070 7265 7669 6f75 735f 6368 756e     previous_chun
+000199e0: 6b73 3a20 5475 706c 655b 5475 706c 655b  ks: Tuple[Tuple[
+000199f0: 696e 745d 5d0a 0a20 2020 2053 6565 2061  int]]..    See a
+00019a00: 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d  lso.    --------
+00019a10: 0a20 2020 206e 6f72 6d61 6c69 7a65 5f63  .    normalize_c
+00019a20: 6875 6e6b 733a 2066 6f72 2066 756c 6c20  hunks: for full 
+00019a30: 646f 6373 7472 696e 6720 616e 6420 7061  docstring and pa
+00019a40: 7261 6d65 7465 7273 0a20 2020 2022 2222  rameters.    """
+00019a50: 0a20 2020 2069 6620 7072 6576 696f 7573  .    if previous
+00019a60: 5f63 6875 6e6b 7320 6973 206e 6f74 204e  _chunks is not N
+00019a70: 6f6e 653a 0a20 2020 2020 2020 2070 7265  one:.        pre
+00019a80: 7669 6f75 735f 6368 756e 6b73 203d 2074  vious_chunks = t
+00019a90: 7570 6c65 280a 2020 2020 2020 2020 2020  uple(.          
+00019aa0: 2020 6320 6966 2069 7369 6e73 7461 6e63    c if isinstanc
+00019ab0: 6528 632c 2074 7570 6c65 2920 656c 7365  e(c, tuple) else
+00019ac0: 2028 632c 2920 666f 7220 6320 696e 2070   (c,) for c in p
+00019ad0: 7265 7669 6f75 735f 6368 756e 6b73 0a20  revious_chunks. 
+00019ae0: 2020 2020 2020 2029 0a20 2020 2063 6875         ).    chu
+00019af0: 6e6b 7320 3d20 6c69 7374 2863 6875 6e6b  nks = list(chunk
+00019b00: 7329 0a0a 2020 2020 6175 746f 7320 3d20  s)..    autos = 
+00019b10: 7b69 2066 6f72 2069 2c20 6320 696e 2065  {i for i, c in e
+00019b20: 6e75 6d65 7261 7465 2863 6875 6e6b 7329  numerate(chunks)
+00019b30: 2069 6620 6320 3d3d 2022 6175 746f 227d   if c == "auto"}
+00019b40: 0a20 2020 2069 6620 6e6f 7420 6175 746f  .    if not auto
+00019b50: 733a 0a20 2020 2020 2020 2072 6574 7572  s:.        retur
+00019b60: 6e20 7475 706c 6528 6368 756e 6b73 290a  n tuple(chunks).
+00019b70: 0a20 2020 2069 6620 6c69 6d69 7420 6973  .    if limit is
+00019b80: 204e 6f6e 653a 0a20 2020 2020 2020 206c   None:.        l
+00019b90: 696d 6974 203d 2063 6f6e 6669 672e 6765  imit = config.ge
+00019ba0: 7428 2261 7272 6179 2e63 6875 6e6b 2d73  t("array.chunk-s
+00019bb0: 697a 6522 290a 2020 2020 6966 2069 7369  ize").    if isi
+00019bc0: 6e73 7461 6e63 6528 6c69 6d69 742c 2073  nstance(limit, s
+00019bd0: 7472 293a 0a20 2020 2020 2020 206c 696d  tr):.        lim
+00019be0: 6974 203d 2070 6172 7365 5f62 7974 6573  it = parse_bytes
+00019bf0: 286c 696d 6974 290a 0a20 2020 2069 6620  (limit)..    if 
+00019c00: 6474 7970 6520 6973 204e 6f6e 653a 0a20  dtype is None:. 
+00019c10: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00019c20: 6545 7272 6f72 2822 6474 7970 6520 6d75  eError("dtype mu
+00019c30: 7374 2062 6520 6b6e 6f77 6e20 666f 7220  st be known for 
+00019c40: 6175 746f 2d63 6875 6e6b 696e 6722 290a  auto-chunking").
+00019c50: 0a20 2020 2069 6620 6474 7970 652e 6861  .    if dtype.ha
+00019c60: 736f 626a 6563 743a 0a20 2020 2020 2020  sobject:.       
+00019c70: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+00019c80: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
+00019c90: 2020 2020 2020 2020 2243 616e 206e 6f74          "Can not
+00019ca0: 2075 7365 2061 7574 6f20 7265 6368 756e   use auto rechun
+00019cb0: 6b69 6e67 2077 6974 6820 6f62 6a65 6374  king with object
+00019cc0: 2064 7479 7065 2e20 220a 2020 2020 2020   dtype. ".      
+00019cd0: 2020 2020 2020 2257 6520 6172 6520 756e        "We are un
+00019ce0: 6162 6c65 2074 6f20 6573 7469 6d61 7465  able to estimate
+00019cf0: 2074 6865 2073 697a 6520 696e 2062 7974   the size in byt
+00019d00: 6573 206f 6620 6f62 6a65 6374 2064 6174  es of object dat
+00019d10: 6122 0a20 2020 2020 2020 2029 0a0a 2020  a".        )..  
+00019d20: 2020 666f 7220 7820 696e 2074 7570 6c65    for x in tuple
+00019d30: 2863 6875 6e6b 7329 202b 2074 7570 6c65  (chunks) + tuple
+00019d40: 2873 6861 7065 293a 0a20 2020 2020 2020  (shape):.       
+00019d50: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
+00019d60: 2020 6973 696e 7374 616e 6365 2878 2c20    isinstance(x, 
+00019d70: 4e75 6d62 6572 290a 2020 2020 2020 2020  Number).        
+00019d80: 2020 2020 616e 6420 6e70 2e69 736e 616e      and np.isnan
+00019d90: 2878 290a 2020 2020 2020 2020 2020 2020  (x).            
+00019da0: 6f72 2069 7369 6e73 7461 6e63 6528 782c  or isinstance(x,
+00019db0: 2074 7570 6c65 290a 2020 2020 2020 2020   tuple).        
+00019dc0: 2020 2020 616e 6420 6e70 2e69 736e 616e      and np.isnan
+00019dd0: 2878 292e 616e 7928 290a 2020 2020 2020  (x).any().      
+00019de0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+00019df0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00019e00: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00019e10: 2020 2022 4361 6e20 6e6f 7420 7065 7266     "Can not perf
+00019e20: 6f72 6d20 6175 746f 6d61 7469 6320 7265  orm automatic re
+00019e30: 6368 756e 6b69 6e67 2077 6974 6820 756e  chunking with un
+00019e40: 6b6e 6f77 6e20 220a 2020 2020 2020 2020  known ".        
+00019e50: 2020 2020 2020 2020 2228 6e61 6e29 2063          "(nan) c
+00019e60: 6875 6e6b 2073 697a 6573 2e25 7322 2025  hunk sizes.%s" %
+00019e70: 2075 6e6b 6e6f 776e 5f63 6875 6e6b 5f6d   unknown_chunk_m
+00019e80: 6573 7361 6765 0a20 2020 2020 2020 2020  essage.         
+00019e90: 2020 2029 0a0a 2020 2020 6c69 6d69 7420     )..    limit 
+00019ea0: 3d20 6d61 7828 312c 206c 696d 6974 290a  = max(1, limit).
+00019eb0: 0a20 2020 206c 6172 6765 7374 5f62 6c6f  .    largest_blo
+00019ec0: 636b 203d 206d 6174 682e 7072 6f64 280a  ck = math.prod(.
+00019ed0: 2020 2020 2020 2020 6373 2069 6620 6973          cs if is
+00019ee0: 696e 7374 616e 6365 2863 732c 204e 756d  instance(cs, Num
+00019ef0: 6265 7229 2065 6c73 6520 6d61 7828 6373  ber) else max(cs
+00019f00: 2920 666f 7220 6373 2069 6e20 6368 756e  ) for cs in chun
+00019f10: 6b73 2069 6620 6373 2021 3d20 2261 7574  ks if cs != "aut
+00019f20: 6f22 0a20 2020 2029 0a0a 2020 2020 6966  o".    )..    if
+00019f30: 2070 7265 7669 6f75 735f 6368 756e 6b73   previous_chunks
+00019f40: 3a0a 2020 2020 2020 2020 2320 4261 7365  :.        # Base
+00019f50: 2069 6465 616c 2072 6174 696f 206f 6e20   ideal ratio on 
+00019f60: 7468 6520 6d65 6469 616e 2063 6875 6e6b  the median chunk
+00019f70: 2073 697a 6520 6f66 2074 6865 2070 7265   size of the pre
+00019f80: 7669 6f75 7320 6368 756e 6b73 0a20 2020  vious chunks.   
+00019f90: 2020 2020 2072 6573 756c 7420 3d20 7b61       result = {a
+00019fa0: 3a20 6e70 2e6d 6564 6961 6e28 7072 6576  : np.median(prev
+00019fb0: 696f 7573 5f63 6875 6e6b 735b 615d 2920  ious_chunks[a]) 
+00019fc0: 666f 7220 6120 696e 2061 7574 6f73 7d0a  for a in autos}.
+00019fd0: 0a20 2020 2020 2020 2069 6465 616c 5f73  .        ideal_s
+00019fe0: 6861 7065 203d 205b 5d0a 2020 2020 2020  hape = [].      
+00019ff0: 2020 666f 7220 692c 2073 2069 6e20 656e    for i, s in en
+0001a000: 756d 6572 6174 6528 7368 6170 6529 3a0a  umerate(shape):.
+0001a010: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+0001a020: 6b5f 6672 6571 7565 6e63 6965 7320 3d20  k_frequencies = 
+0001a030: 6672 6571 7565 6e63 6965 7328 7072 6576  frequencies(prev
+0001a040: 696f 7573 5f63 6875 6e6b 735b 695d 290a  ious_chunks[i]).
+0001a050: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+0001a060: 2c20 636f 756e 7420 3d20 6d61 7828 6368  , count = max(ch
+0001a070: 756e 6b5f 6672 6571 7565 6e63 6965 732e  unk_frequencies.
+0001a080: 6974 656d 7328 292c 206b 6579 3d6c 616d  items(), key=lam
+0001a090: 6264 6120 6b76 3a20 6b76 5b31 5d29 0a20  bda kv: kv[1]). 
+0001a0a0: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
+0001a0b0: 6465 203e 2031 2061 6e64 2063 6f75 6e74  de > 1 and count
+0001a0c0: 203e 3d20 6c65 6e28 7072 6576 696f 7573   >= len(previous
+0001a0d0: 5f63 6875 6e6b 735b 695d 2920 2f20 323a  _chunks[i]) / 2:
+0001a0e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a0f0: 2069 6465 616c 5f73 6861 7065 2e61 7070   ideal_shape.app
+0001a100: 656e 6428 6d6f 6465 290a 2020 2020 2020  end(mode).      
+0001a110: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001a120: 2020 2020 2020 2020 2020 2020 6964 6561              idea
+0001a130: 6c5f 7368 6170 652e 6170 7065 6e64 2873  l_shape.append(s
+0001a140: 290a 0a20 2020 2020 2020 2023 2048 6f77  )..        # How
+0001a150: 206d 7563 6820 6c61 7267 6572 206f 7220   much larger or 
+0001a160: 736d 616c 6c65 7220 7468 6520 6964 6561  smaller the idea
+0001a170: 6c20 6368 756e 6b20 7369 7a65 2069 7320  l chunk size is 
+0001a180: 7265 6c61 7469 7665 2074 6f20 7768 6174  relative to what
+0001a190: 2077 6520 6861 7665 206e 6f77 0a20 2020   we have now.   
+0001a1a0: 2020 2020 206d 756c 7469 706c 6965 7220       multiplier 
+0001a1b0: 3d20 5f63 6f6d 7075 7465 5f6d 756c 7469  = _compute_multi
+0001a1c0: 706c 6965 7228 6c69 6d69 742c 2064 7479  plier(limit, dty
+0001a1d0: 7065 2c20 6c61 7267 6573 745f 626c 6f63  pe, largest_bloc
+0001a1e0: 6b2c 2072 6573 756c 7429 0a0a 2020 2020  k, result)..    
+0001a1f0: 2020 2020 6c61 7374 5f6d 756c 7469 706c      last_multipl
+0001a200: 6965 7220 3d20 300a 2020 2020 2020 2020  ier = 0.        
+0001a210: 6c61 7374 5f61 7574 6f73 203d 2073 6574  last_autos = set
+0001a220: 2829 0a20 2020 2020 2020 2077 6869 6c65  ().        while
+0001a230: 2028 0a20 2020 2020 2020 2020 2020 206d   (.            m
+0001a240: 756c 7469 706c 6965 7220 213d 206c 6173  ultiplier != las
+0001a250: 745f 6d75 6c74 6970 6c69 6572 206f 7220  t_multiplier or 
+0001a260: 6175 746f 7320 213d 206c 6173 745f 6175  autos != last_au
+0001a270: 746f 730a 2020 2020 2020 2020 293a 2020  tos.        ):  
+0001a280: 2320 7768 696c 6520 7468 696e 6773 2063  # while things c
+0001a290: 6861 6e67 650a 2020 2020 2020 2020 2020  hange.          
+0001a2a0: 2020 6c61 7374 5f6d 756c 7469 706c 6965    last_multiplie
+0001a2b0: 7220 3d20 6d75 6c74 6970 6c69 6572 2020  r = multiplier  
+0001a2c0: 2320 7265 636f 7264 2070 7265 7669 6f75  # record previou
+0001a2d0: 7320 7661 6c75 6573 0a20 2020 2020 2020  s values.       
+0001a2e0: 2020 2020 206c 6173 745f 6175 746f 7320       last_autos 
+0001a2f0: 3d20 7365 7428 6175 746f 7329 2020 2320  = set(autos)  # 
+0001a300: 7265 636f 7264 2070 7265 7669 6f75 7320  record previous 
+0001a310: 7661 6c75 6573 0a0a 2020 2020 2020 2020  values..        
+0001a320: 2020 2020 2320 4578 7061 6e64 206f 7220      # Expand or 
+0001a330: 636f 6e74 7261 6374 2065 6163 6820 6f66  contract each of
+0001a340: 2074 6865 2064 696d 656e 7369 6f6e 7320   the dimensions 
+0001a350: 6170 7072 6f70 7269 6174 656c 790a 2020  appropriately.  
+0001a360: 2020 2020 2020 2020 2020 666f 7220 6120            for a 
+0001a370: 696e 2073 6f72 7465 6428 6175 746f 7329  in sorted(autos)
+0001a380: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001a390: 2020 6966 2069 6465 616c 5f73 6861 7065    if ideal_shape
+0001a3a0: 5b61 5d20 3d3d 2030 3a0a 2020 2020 2020  [a] == 0:.      
+0001a3b0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001a3c0: 7375 6c74 5b61 5d20 3d20 300a 2020 2020  sult[a] = 0.    
+0001a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a3e0: 636f 6e74 696e 7565 0a20 2020 2020 2020  continue.       
+0001a3f0: 2020 2020 2020 2020 2070 726f 706f 7365           propose
+0001a400: 6420 3d20 7265 7375 6c74 5b61 5d20 2a20  d = result[a] * 
+0001a410: 6d75 6c74 6970 6c69 6572 202a 2a20 2831  multiplier ** (1
+0001a420: 202f 206c 656e 2861 7574 6f73 2929 0a20   / len(autos)). 
+0001a430: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001a440: 6620 7072 6f70 6f73 6564 203e 2073 6861  f proposed > sha
+0001a450: 7065 5b61 5d3a 2020 2320 7765 2776 6520  pe[a]:  # we've 
+0001a460: 6869 7420 7468 6520 7368 6170 6520 626f  hit the shape bo
+0001a470: 756e 6461 7279 0a20 2020 2020 2020 2020  undary.         
+0001a480: 2020 2020 2020 2020 2020 2061 7574 6f73             autos
+0001a490: 2e72 656d 6f76 6528 6129 0a20 2020 2020  .remove(a).     
+0001a4a0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0001a4b0: 6172 6765 7374 5f62 6c6f 636b 202a 3d20  argest_block *= 
+0001a4c0: 7368 6170 655b 615d 0a20 2020 2020 2020  shape[a].       
+0001a4d0: 2020 2020 2020 2020 2020 2020 2063 6875               chu
+0001a4e0: 6e6b 735b 615d 203d 2073 6861 7065 5b61  nks[a] = shape[a
+0001a4f0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0001a500: 2020 2020 2020 6465 6c20 7265 7375 6c74        del result
+0001a510: 5b61 5d0a 2020 2020 2020 2020 2020 2020  [a].            
+0001a520: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001a530: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001a540: 7375 6c74 5b61 5d20 3d20 726f 756e 645f  sult[a] = round_
+0001a550: 746f 2870 726f 706f 7365 642c 2069 6465  to(proposed, ide
+0001a560: 616c 5f73 6861 7065 5b61 5d29 0a0a 2020  al_shape[a])..  
+0001a570: 2020 2020 2020 2020 2020 2320 7265 636f            # reco
+0001a580: 6d70 7574 6520 686f 7720 6d75 6368 206d  mpute how much m
+0001a590: 756c 7469 706c 6965 7220 7765 2068 6176  ultiplier we hav
+0001a5a0: 6520 6c65 6674 2c20 7265 7065 6174 0a20  e left, repeat. 
+0001a5b0: 2020 2020 2020 2020 2020 206d 756c 7469             multi
+0001a5c0: 706c 6965 7220 3d20 5f63 6f6d 7075 7465  plier = _compute
+0001a5d0: 5f6d 756c 7469 706c 6965 7228 6c69 6d69  _multiplier(limi
+0001a5e0: 742c 2064 7479 7065 2c20 6c61 7267 6573  t, dtype, larges
+0001a5f0: 745f 626c 6f63 6b2c 2072 6573 756c 7429  t_block, result)
+0001a600: 0a0a 2020 2020 2020 2020 666f 7220 6b2c  ..        for k,
+0001a610: 2076 2069 6e20 7265 7375 6c74 2e69 7465   v in result.ite
+0001a620: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
+0001a630: 2020 6368 756e 6b73 5b6b 5d20 3d20 760a    chunks[k] = v.
+0001a640: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+0001a650: 7570 6c65 2863 6875 6e6b 7329 0a0a 2020  uple(chunks)..  
+0001a660: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001a670: 2320 4368 6563 6b20 6966 2064 7479 7065  # Check if dtype
+0001a680: 2e69 7465 6d73 697a 6520 6973 2067 7265  .itemsize is gre
+0001a690: 6174 6572 2074 6861 6e20 300a 2020 2020  ater than 0.    
+0001a6a0: 2020 2020 6966 2064 7479 7065 2e69 7465      if dtype.ite
+0001a6b0: 6d73 697a 6520 3d3d 2030 3a0a 2020 2020  msize == 0:.    
+0001a6c0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001a6d0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+0001a6e0: 2020 2020 2020 2020 2020 2261 7574 6f2d            "auto-
+0001a6f0: 6368 756e 6b69 6e67 2077 6974 6820 6474  chunking with dt
+0001a700: 7970 652e 6974 656d 7369 7a65 203d 3d20  ype.itemsize == 
+0001a710: 3020 6973 206e 6f74 2073 7570 706f 7274  0 is not support
+0001a720: 6564 2c20 706c 6561 7365 2070 6173 7320  ed, please pass 
+0001a730: 696e 2060 6368 756e 6b73 6020 6578 706c  in `chunks` expl
+0001a740: 6963 6974 6c79 220a 2020 2020 2020 2020  icitly".        
+0001a750: 2020 2020 290a 2020 2020 2020 2020 7369      ).        si
+0001a760: 7a65 203d 2028 6c69 6d69 7420 2f20 6474  ze = (limit / dt
+0001a770: 7970 652e 6974 656d 7369 7a65 202f 206c  ype.itemsize / l
+0001a780: 6172 6765 7374 5f62 6c6f 636b 2920 2a2a  argest_block) **
+0001a790: 2028 3120 2f20 6c65 6e28 6175 746f 7329   (1 / len(autos)
+0001a7a0: 290a 2020 2020 2020 2020 736d 616c 6c20  ).        small 
+0001a7b0: 3d20 5b69 2066 6f72 2069 2069 6e20 6175  = [i for i in au
+0001a7c0: 746f 7320 6966 2073 6861 7065 5b69 5d20  tos if shape[i] 
+0001a7d0: 3c20 7369 7a65 5d0a 2020 2020 2020 2020  < size].        
+0001a7e0: 6966 2073 6d61 6c6c 3a0a 2020 2020 2020  if small:.      
+0001a7f0: 2020 2020 2020 666f 7220 6920 696e 2073        for i in s
+0001a800: 6d61 6c6c 3a0a 2020 2020 2020 2020 2020  mall:.          
+0001a810: 2020 2020 2020 6368 756e 6b73 5b69 5d20        chunks[i] 
+0001a820: 3d20 2873 6861 7065 5b69 5d2c 290a 2020  = (shape[i],).  
+0001a830: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001a840: 2061 7574 6f5f 6368 756e 6b73 2863 6875   auto_chunks(chu
+0001a850: 6e6b 732c 2073 6861 7065 2c20 6c69 6d69  nks, shape, limi
+0001a860: 742c 2064 7479 7065 290a 0a20 2020 2020  t, dtype)..     
+0001a870: 2020 2066 6f72 2069 2069 6e20 6175 746f     for i in auto
+0001a880: 733a 0a20 2020 2020 2020 2020 2020 2063  s:.            c
+0001a890: 6875 6e6b 735b 695d 203d 2072 6f75 6e64  hunks[i] = round
+0001a8a0: 5f74 6f28 7369 7a65 2c20 7368 6170 655b  _to(size, shape[
+0001a8b0: 695d 290a 0a20 2020 2020 2020 2072 6574  i])..        ret
+0001a8c0: 7572 6e20 7475 706c 6528 6368 756e 6b73  urn tuple(chunks
+0001a8d0: 290a 0a0a 6465 6620 726f 756e 645f 746f  )...def round_to
+0001a8e0: 2863 2c20 7329 3a0a 2020 2020 2222 2252  (c, s):.    """R
+0001a8f0: 6574 7572 6e20 6120 6368 756e 6b20 6469  eturn a chunk di
+0001a900: 6d65 6e73 696f 6e20 7468 6174 2069 7320  mension that is 
+0001a910: 636c 6f73 6520 746f 2061 6e20 6576 656e  close to an even
+0001a920: 206d 756c 7469 706c 6520 6f72 2066 6163   multiple or fac
+0001a930: 746f 720a 0a20 2020 2057 6520 7761 6e74  tor..    We want
+0001a940: 2076 616c 7565 7320 666f 7220 6320 7468   values for c th
+0001a950: 6174 2061 7265 206e 6963 656c 7920 616c  at are nicely al
+0001a960: 6967 6e65 6420 7769 7468 2073 2e0a 0a20  igned with s... 
+0001a970: 2020 2049 6620 6320 6973 2073 6d61 6c6c     If c is small
+0001a980: 6572 2074 6861 6e20 7320 7765 2075 7365  er than s we use
+0001a990: 2074 6865 206f 7269 6769 6e61 6c20 6368   the original ch
+0001a9a0: 756e 6b20 7369 7a65 2061 6e64 2061 6363  unk size and acc
+0001a9b0: 6570 7420 616e 0a20 2020 2075 6e65 7665  ept an.    uneve
+0001a9c0: 6e20 6368 756e 6b20 6174 2074 6865 2065  n chunk at the e
+0001a9d0: 6e64 2e0a 0a20 2020 2049 6620 6320 6973  nd...    If c is
+0001a9e0: 206c 6172 6765 7220 7468 616e 2073 2074   larger than s t
+0001a9f0: 6865 6e20 7765 2077 616e 7420 7468 6520  hen we want the 
+0001aa00: 6c61 7267 6573 7420 6d75 6c74 6970 6c65  largest multiple
+0001aa10: 206f 6620 7320 7468 6174 2069 7320 7374   of s that is st
+0001aa20: 696c 6c0a 2020 2020 736d 616c 6c65 7220  ill.    smaller 
+0001aa30: 7468 616e 2063 2e0a 2020 2020 2222 220a  than c..    """.
+0001aa40: 2020 2020 6966 2063 203c 3d20 733a 0a20      if c <= s:. 
+0001aa50: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
+0001aa60: 7828 312c 2069 6e74 2863 2929 0a20 2020  x(1, int(c)).   
+0001aa70: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
+0001aa80: 6574 7572 6e20 6320 2f2f 2073 202a 2073  eturn c // s * s
+0001aa90: 0a0a 0a64 6566 205f 6765 745f 6368 756e  ...def _get_chun
+0001aaa0: 6b5f 7368 6170 6528 6129 3a0a 2020 2020  k_shape(a):.    
+0001aab0: 7320 3d20 6e70 2e61 7361 7272 6179 2861  s = np.asarray(a
+0001aac0: 2e73 6861 7065 2c20 6474 7970 653d 696e  .shape, dtype=in
+0001aad0: 7429 0a20 2020 2072 6574 7572 6e20 735b  t).    return s[
+0001aae0: 6c65 6e28 7329 202a 2028 4e6f 6e65 2c29  len(s) * (None,)
+0001aaf0: 202b 2028 736c 6963 6528 4e6f 6e65 292c   + (slice(None),
+0001ab00: 295d 0a0a 0a64 6566 2066 726f 6d5f 6172  )]...def from_ar
+0001ab10: 7261 7928 0a20 2020 2078 2c0a 2020 2020  ray(.    x,.    
+0001ab20: 6368 756e 6b73 3d22 6175 746f 222c 0a20  chunks="auto",. 
+0001ab30: 2020 206e 616d 653d 4e6f 6e65 2c0a 2020     name=None,.  
+0001ab40: 2020 6c6f 636b 3d46 616c 7365 2c0a 2020    lock=False,.  
+0001ab50: 2020 6173 6172 7261 793d 4e6f 6e65 2c0a    asarray=None,.
+0001ab60: 2020 2020 6661 6e63 793d 5472 7565 2c0a      fancy=True,.
+0001ab70: 2020 2020 6765 7469 7465 6d3d 4e6f 6e65      getitem=None
+0001ab80: 2c0a 2020 2020 6d65 7461 3d4e 6f6e 652c  ,.    meta=None,
+0001ab90: 0a20 2020 2069 6e6c 696e 655f 6172 7261  .    inline_arra
+0001aba0: 793d 4661 6c73 652c 0a29 3a0a 2020 2020  y=False,.):.    
+0001abb0: 2222 2243 7265 6174 6520 6461 736b 2061  """Create dask a
+0001abc0: 7272 6179 2066 726f 6d20 736f 6d65 7468  rray from someth
+0001abd0: 696e 6720 7468 6174 206c 6f6f 6b73 206c  ing that looks l
+0001abe0: 696b 6520 616e 2061 7272 6179 2e0a 0a20  ike an array... 
+0001abf0: 2020 2049 6e70 7574 206d 7573 7420 6861     Input must ha
+0001ac00: 7665 2061 2060 602e 7368 6170 6560 602c  ve a ``.shape``,
+0001ac10: 2060 602e 6e64 696d 6060 2c20 6060 2e64   ``.ndim``, ``.d
+0001ac20: 7479 7065 6060 2061 6e64 2073 7570 706f  type`` and suppo
+0001ac30: 7274 206e 756d 7079 2d73 7479 6c65 2073  rt numpy-style s
+0001ac40: 6c69 6369 6e67 2e0a 0a20 2020 2050 6172  licing...    Par
+0001ac50: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+0001ac60: 2d2d 2d2d 2d2d 0a20 2020 2078 203a 2061  ------.    x : a
+0001ac70: 7272 6179 5f6c 696b 650a 2020 2020 6368  rray_like.    ch
+0001ac80: 756e 6b73 203a 2069 6e74 2c20 7475 706c  unks : int, tupl
+0001ac90: 650a 2020 2020 2020 2020 486f 7720 746f  e.        How to
+0001aca0: 2063 6875 6e6b 2074 6865 2061 7272 6179   chunk the array
+0001acb0: 2e20 4d75 7374 2062 6520 6f6e 6520 6f66  . Must be one of
+0001acc0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2066   the following f
+0001acd0: 6f72 6d73 3a0a 0a20 2020 2020 2020 202d  orms:..        -
+0001ace0: 2041 2062 6c6f 636b 7369 7a65 206c 696b   A blocksize lik
+0001acf0: 6520 3130 3030 2e0a 2020 2020 2020 2020  e 1000..        
+0001ad00: 2d20 4120 626c 6f63 6b73 6861 7065 206c  - A blockshape l
+0001ad10: 696b 6520 2831 3030 302c 2031 3030 3029  ike (1000, 1000)
+0001ad20: 2e0a 2020 2020 2020 2020 2d20 4578 706c  ..        - Expl
+0001ad30: 6963 6974 2073 697a 6573 206f 6620 616c  icit sizes of al
+0001ad40: 6c20 626c 6f63 6b73 2061 6c6f 6e67 2061  l blocks along a
+0001ad50: 6c6c 2064 696d 656e 7369 6f6e 7320 6c69  ll dimensions li
+0001ad60: 6b65 0a20 2020 2020 2020 2020 2028 2831  ke.          ((1
+0001ad70: 3030 302c 2031 3030 302c 2035 3030 292c  000, 1000, 500),
+0001ad80: 2028 3430 302c 2034 3030 2929 2e0a 2020   (400, 400))..  
+0001ad90: 2020 2020 2020 2d20 4120 7369 7a65 2069        - A size i
+0001ada0: 6e20 6279 7465 732c 206c 696b 6520 2231  n bytes, like "1
+0001adb0: 3030 204d 6942 2220 7768 6963 6820 7769  00 MiB" which wi
+0001adc0: 6c6c 2063 686f 6f73 6520 6120 756e 6966  ll choose a unif
+0001add0: 6f72 6d0a 2020 2020 2020 2020 2020 626c  orm.          bl
+0001ade0: 6f63 6b2d 6c69 6b65 2073 6861 7065 0a20  ock-like shape. 
+0001adf0: 2020 2020 2020 202d 2054 6865 2077 6f72         - The wor
+0001ae00: 6420 2261 7574 6f22 2077 6869 6368 2061  d "auto" which a
+0001ae10: 6374 7320 6c69 6b65 2074 6865 2061 626f  cts like the abo
+0001ae20: 7665 2c20 6275 7420 7573 6573 2061 2063  ve, but uses a c
+0001ae30: 6f6e 6669 6775 7261 7469 6f6e 0a20 2020  onfiguration.   
+0001ae40: 2020 2020 2020 2076 616c 7565 2060 6061         value ``a
+0001ae50: 7272 6179 2e63 6875 6e6b 2d73 697a 6560  rray.chunk-size`
+0001ae60: 6020 666f 7220 7468 6520 6368 756e 6b20  ` for the chunk 
+0001ae70: 7369 7a65 0a0a 2020 2020 2020 2020 2d31  size..        -1
+0001ae80: 206f 7220 4e6f 6e65 2061 7320 6120 626c   or None as a bl
+0001ae90: 6f63 6b73 697a 6520 696e 6469 6361 7465  ocksize indicate
+0001aea0: 2074 6865 2073 697a 6520 6f66 2074 6865   the size of the
+0001aeb0: 2063 6f72 7265 7370 6f6e 6469 6e67 0a20   corresponding. 
+0001aec0: 2020 2020 2020 2064 696d 656e 7369 6f6e         dimension
+0001aed0: 2e0a 2020 2020 6e61 6d65 203a 2073 7472  ..    name : str
+0001aee0: 206f 7220 626f 6f6c 2c20 6f70 7469 6f6e   or bool, option
+0001aef0: 616c 0a20 2020 2020 2020 2054 6865 206b  al.        The k
+0001af00: 6579 206e 616d 6520 746f 2075 7365 2066  ey name to use f
+0001af10: 6f72 2074 6865 2061 7272 6179 2e20 4465  or the array. De
+0001af20: 6661 756c 7473 2074 6f20 6120 6861 7368  faults to a hash
+0001af30: 206f 6620 6060 7860 602e 0a0a 2020 2020   of ``x``...    
+0001af40: 2020 2020 4861 7368 696e 6720 6973 2075      Hashing is u
+0001af50: 7365 6675 6c20 6966 2074 6865 2073 616d  seful if the sam
+0001af60: 6520 7661 6c75 6520 6f66 2060 6078 6060  e value of ``x``
+0001af70: 2069 7320 7573 6564 2074 6f20 6372 6561   is used to crea
+0001af80: 7465 206d 756c 7469 706c 650a 2020 2020  te multiple.    
+0001af90: 2020 2020 6172 7261 7973 2c20 6173 2044      arrays, as D
+0001afa0: 6173 6b20 6361 6e20 7468 656e 2072 6563  ask can then rec
+0001afb0: 6f67 6e69 7365 2074 6861 7420 7468 6579  ognise that they
+0001afc0: 2772 6520 7468 6520 7361 6d65 2061 6e64  're the same and
+0001afd0: 0a20 2020 2020 2020 2061 766f 6964 2064  .        avoid d
+0001afe0: 7570 6c69 6361 7465 2063 6f6d 7075 7461  uplicate computa
+0001aff0: 7469 6f6e 732e 2048 6f77 6576 6572 2c20  tions. However, 
+0001b000: 6974 2063 616e 2061 6c73 6f20 6265 2073  it can also be s
+0001b010: 6c6f 772c 2061 6e64 2069 6620 7468 650a  low, and if the.
+0001b020: 2020 2020 2020 2020 6172 7261 7920 6973          array is
+0001b030: 206e 6f74 2063 6f6e 7469 6775 6f75 7320   not contiguous 
+0001b040: 6974 2069 7320 636f 7069 6564 2066 6f72  it is copied for
+0001b050: 2068 6173 6869 6e67 2e20 4966 2074 6865   hashing. If the
+0001b060: 2061 7272 6179 2075 7365 730a 2020 2020   array uses.    
+0001b070: 2020 2020 7374 7269 6465 2074 7269 636b      stride trick
+0001b080: 7320 2873 7563 6820 6173 203a 6675 6e63  s (such as :func
+0001b090: 3a60 6e75 6d70 792e 6272 6f61 6463 6173  :`numpy.broadcas
+0001b0a0: 745f 746f 6020 6f72 0a20 2020 2020 2020  t_to` or.       
+0001b0b0: 203a 6675 6e63 3a60 736b 696d 6167 652e   :func:`skimage.
+0001b0c0: 7574 696c 2e76 6965 775f 6173 5f77 696e  util.view_as_win
+0001b0d0: 646f 7773 6029 2074 6f20 6861 7665 2061  dows`) to have a
+0001b0e0: 206c 6172 6765 7220 6c6f 6769 6361 6c0a   larger logical.
+0001b0f0: 2020 2020 2020 2020 7468 616e 2070 6879          than phy
+0001b100: 7369 6361 6c20 7369 7a65 2c20 7468 6973  sical size, this
+0001b110: 2063 6f70 7920 6361 6e20 6361 7573 6520   copy can cause 
+0001b120: 6578 6365 7373 6976 6520 6d65 6d6f 7279  excessive memory
+0001b130: 2075 7361 6765 2e0a 0a20 2020 2020 2020   usage...       
+0001b140: 2049 6620 796f 7520 646f 6e27 7420 6e65   If you don't ne
+0001b150: 6564 2074 6865 2064 6564 7570 6c69 6361  ed the deduplica
+0001b160: 7469 6f6e 2070 726f 7669 6465 6420 6279  tion provided by
+0001b170: 2068 6173 6869 6e67 2c20 7573 650a 2020   hashing, use.  
+0001b180: 2020 2020 2020 6060 6e61 6d65 3d46 616c        ``name=Fal
+0001b190: 7365 6060 2074 6f20 6765 6e65 7261 7465  se`` to generate
+0001b1a0: 2061 2072 616e 646f 6d20 6e61 6d65 2069   a random name i
+0001b1b0: 6e73 7465 6164 206f 6620 6861 7368 696e  nstead of hashin
+0001b1c0: 672c 2077 6869 6368 0a20 2020 2020 2020  g, which.       
+0001b1d0: 2061 766f 6964 7320 7468 6520 7069 7466   avoids the pitf
+0001b1e0: 616c 6c73 2064 6573 6372 6962 6564 2061  alls described a
+0001b1f0: 626f 7665 2e20 5573 696e 6720 6060 6e61  bove. Using ``na
+0001b200: 6d65 3d54 7275 6560 6020 6973 0a20 2020  me=True`` is.   
+0001b210: 2020 2020 2065 7175 6976 616c 656e 7420       equivalent 
+0001b220: 746f 2074 6865 2064 6566 6175 6c74 2e0a  to the default..
+0001b230: 0a20 2020 2020 2020 2042 7920 6465 6661  .        By defa
+0001b240: 756c 742c 2068 6173 6869 6e67 2075 7365  ult, hashing use
+0001b250: 7320 7079 7468 6f6e 2773 2073 7461 6e64  s python's stand
+0001b260: 6172 6420 7368 6131 2e20 5468 6973 2062  ard sha1. This b
+0001b270: 6568 6176 696f 7572 2063 616e 2062 650a  ehaviour can be.
+0001b280: 2020 2020 2020 2020 6368 616e 6765 6420          changed 
+0001b290: 6279 2069 6e73 7461 6c6c 696e 6720 6369  by installing ci
+0001b2a0: 7479 6861 7368 2c20 7878 6861 7368 206f  tyhash, xxhash o
+0001b2b0: 7220 6d75 726d 7572 6861 7368 2e20 4966  r murmurhash. If
+0001b2c0: 2069 6e73 7461 6c6c 6564 2c0a 2020 2020   installed,.    
+0001b2d0: 2020 2020 6120 6c61 7267 652d 6661 6374      a large-fact
+0001b2e0: 6f72 2073 7065 6564 7570 2063 616e 2062  or speedup can b
+0001b2f0: 6520 6f62 7461 696e 6564 2069 6e20 7468  e obtained in th
+0001b300: 6520 746f 6b65 6e69 7361 7469 6f6e 2073  e tokenisation s
+0001b310: 7465 702e 0a0a 2020 2020 2020 2020 2e2e  tep...        ..
+0001b320: 206e 6f74 653a 3a0a 0a20 2020 2020 2020   note::..       
+0001b330: 2020 2020 4265 6361 7573 6520 7468 6973      Because this
+0001b340: 2060 606e 616d 6560 6020 6973 2075 7365   ``name`` is use
+0001b350: 6420 6173 2074 6865 206b 6579 2069 6e20  d as the key in 
+0001b360: 7461 736b 2067 7261 7068 732c 2079 6f75  task graphs, you
+0001b370: 2073 686f 756c 640a 2020 2020 2020 2020   should.        
+0001b380: 2020 2065 6e73 7572 6520 7468 6174 2069     ensure that i
+0001b390: 7420 756e 6971 7565 6c79 2069 6465 6e74  t uniquely ident
+0001b3a0: 6966 6965 7320 7468 6520 6461 7461 2063  ifies the data c
+0001b3b0: 6f6e 7461 696e 6564 2077 6974 6869 6e2e  ontained within.
+0001b3c0: 2049 660a 2020 2020 2020 2020 2020 2079   If.           y
+0001b3d0: 6f75 2764 206c 696b 6520 746f 2070 726f  ou'd like to pro
+0001b3e0: 7669 6465 2061 2064 6573 6372 6970 7469  vide a descripti
+0001b3f0: 7665 206e 616d 6520 7468 6174 2069 7320  ve name that is 
+0001b400: 7374 696c 6c20 756e 6971 7565 2c20 636f  still unique, co
+0001b410: 6d62 696e 650a 2020 2020 2020 2020 2020  mbine.          
+0001b420: 2074 6865 2064 6573 6372 6970 7469 7665   the descriptive
+0001b430: 206e 616d 6520 7769 7468 203a 6675 6e63   name with :func
+0001b440: 3a60 6461 736b 2e62 6173 652e 746f 6b65  :`dask.base.toke
+0001b450: 6e69 7a65 6020 6f66 2074 6865 0a20 2020  nize` of the.   
+0001b460: 2020 2020 2020 2020 6060 6172 7261 795f          ``array_
+0001b470: 6c69 6b65 6060 2e20 5365 6520 3a72 6566  like``. See :ref
+0001b480: 3a60 6772 6170 6873 6020 666f 7220 6d6f  :`graphs` for mo
+0001b490: 7265 2e0a 0a20 2020 206c 6f63 6b20 3a20  re...    lock : 
+0001b4a0: 626f 6f6c 206f 7220 4c6f 636b 2c20 6f70  bool or Lock, op
+0001b4b0: 7469 6f6e 616c 0a20 2020 2020 2020 2049  tional.        I
+0001b4c0: 6620 6060 7860 6020 646f 6573 6e27 7420  f ``x`` doesn't 
+0001b4d0: 7375 7070 6f72 7420 636f 6e63 7572 7265  support concurre
+0001b4e0: 6e74 2072 6561 6473 2074 6865 6e20 7072  nt reads then pr
+0001b4f0: 6f76 6964 6520 6120 6c6f 636b 2068 6572  ovide a lock her
+0001b500: 652c 206f 720a 2020 2020 2020 2020 7061  e, or.        pa
+0001b510: 7373 2069 6e20 5472 7565 2074 6f20 6861  ss in True to ha
+0001b520: 7665 2064 6173 6b2e 6172 7261 7920 6372  ve dask.array cr
+0001b530: 6561 7465 206f 6e65 2066 6f72 2079 6f75  eate one for you
+0001b540: 2e0a 2020 2020 6173 6172 7261 7920 3a20  ..    asarray : 
+0001b550: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
+0001b560: 2020 2020 2020 2049 6620 5472 7565 2074         If True t
+0001b570: 6865 6e20 6361 6c6c 206e 702e 6173 6172  hen call np.asar
+0001b580: 7261 7920 6f6e 2063 6875 6e6b 7320 746f  ray on chunks to
+0001b590: 2063 6f6e 7665 7274 2074 6865 6d20 746f   convert them to
+0001b5a0: 206e 756d 7079 2061 7272 6179 732e 0a20   numpy arrays.. 
+0001b5b0: 2020 2020 2020 2049 6620 4661 6c73 6520         If False 
+0001b5c0: 7468 656e 2063 6875 6e6b 7320 6172 6520  then chunks are 
+0001b5d0: 7061 7373 6564 2074 6872 6f75 6768 2075  passed through u
+0001b5e0: 6e63 6861 6e67 6564 2e0a 2020 2020 2020  nchanged..      
+0001b5f0: 2020 4966 204e 6f6e 6520 2864 6566 6175    If None (defau
+0001b600: 6c74 2920 7468 656e 2077 6520 7573 6520  lt) then we use 
+0001b610: 5472 7565 2069 6620 7468 6520 6060 5f5f  True if the ``__
+0001b620: 6172 7261 795f 6675 6e63 7469 6f6e 5f5f  array_function__
+0001b630: 6060 206d 6574 686f 640a 2020 2020 2020  `` method.      
+0001b640: 2020 6973 2075 6e64 6566 696e 6564 2e0a    is undefined..
+0001b650: 0a20 2020 2020 2020 202e 2e20 6e6f 7465  .        .. note
+0001b660: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
+0001b670: 4461 736b 2064 6f65 7320 6e6f 7420 7072  Dask does not pr
+0001b680: 6573 6572 7665 2074 6865 206d 656d 6f72  eserve the memor
+0001b690: 7920 6c61 796f 7574 206f 6620 7468 6520  y layout of the 
+0001b6a0: 6f72 6967 696e 616c 2061 7272 6179 2077  original array w
+0001b6b0: 6865 6e0a 2020 2020 2020 2020 2020 2020  hen.            
+0001b6c0: 7468 6520 6172 7261 7920 6973 2063 7265  the array is cre
+0001b6d0: 6174 6564 2075 7369 6e67 2046 6f72 7472  ated using Fortr
+0001b6e0: 616e 2072 6174 6865 7220 7468 616e 2043  an rather than C
+0001b6f0: 206f 7264 6572 696e 672e 0a0a 2020 2020   ordering...    
+0001b700: 6661 6e63 7920 3a20 626f 6f6c 2c20 6f70  fancy : bool, op
+0001b710: 7469 6f6e 616c 0a20 2020 2020 2020 2049  tional.        I
+0001b720: 6620 6060 7860 6020 646f 6573 6e27 7420  f ``x`` doesn't 
+0001b730: 7375 7070 6f72 7420 6661 6e63 7920 696e  support fancy in
+0001b740: 6465 7869 6e67 2028 652e 672e 2069 6e64  dexing (e.g. ind
+0001b750: 6578 696e 6720 7769 7468 206c 6973 7473  exing with lists
+0001b760: 206f 720a 2020 2020 2020 2020 6172 7261   or.        arra
+0001b770: 7973 2920 7468 656e 2073 6574 2074 6f20  ys) then set to 
+0001b780: 4661 6c73 652e 2044 6566 6175 6c74 2069  False. Default i
+0001b790: 7320 5472 7565 2e0a 2020 2020 6d65 7461  s True..    meta
+0001b7a0: 203a 2041 7272 6179 2d6c 696b 652c 206f   : Array-like, o
+0001b7b0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0001b7c0: 5468 6520 6d65 7461 6461 7461 2066 6f72  The metadata for
+0001b7d0: 2074 6865 2072 6573 756c 7469 6e67 2064   the resulting d
+0001b7e0: 6173 6b20 6172 7261 792e 2020 5468 6973  ask array.  This
+0001b7f0: 2069 7320 7468 6520 6b69 6e64 206f 6620   is the kind of 
+0001b800: 6172 7261 790a 2020 2020 2020 2020 7468  array.        th
+0001b810: 6174 2077 696c 6c20 7265 7375 6c74 2066  at will result f
+0001b820: 726f 6d20 736c 6963 696e 6720 7468 6520  rom slicing the 
+0001b830: 696e 7075 7420 6172 7261 792e 0a20 2020  input array..   
+0001b840: 2020 2020 2044 6566 6175 6c74 7320 746f       Defaults to
+0001b850: 2074 6865 2069 6e70 7574 2061 7272 6179   the input array
+0001b860: 2e0a 2020 2020 696e 6c69 6e65 5f61 7272  ..    inline_arr
+0001b870: 6179 203a 2062 6f6f 6c2c 2064 6566 6175  ay : bool, defau
+0001b880: 6c74 2046 616c 7365 0a20 2020 2020 2020  lt False.       
+0001b890: 2048 6f77 2074 6f20 696e 636c 7564 6520   How to include 
+0001b8a0: 7468 6520 6172 7261 7920 696e 2074 6865  the array in the
+0001b8b0: 2074 6173 6b20 6772 6170 682e 2042 7920   task graph. By 
+0001b8c0: 6465 6661 756c 740a 2020 2020 2020 2020  default.        
+0001b8d0: 2860 6069 6e6c 696e 655f 6172 7261 793d  (``inline_array=
+0001b8e0: 4661 6c73 6560 6029 2074 6865 2061 7272  False``) the arr
+0001b8f0: 6179 2069 7320 696e 636c 7564 6564 2069  ay is included i
+0001b900: 6e20 6120 7461 736b 2062 7920 6974 7365  n a task by itse
+0001b910: 6c66 2c0a 2020 2020 2020 2020 616e 6420  lf,.        and 
+0001b920: 6561 6368 2063 6875 6e6b 2072 6566 6572  each chunk refer
+0001b930: 7320 746f 2074 6861 7420 7461 736b 2062  s to that task b
+0001b940: 7920 6974 7320 6b65 792e 0a0a 2020 2020  y its key...    
+0001b950: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
+0001b960: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
+0001b970: 2020 2020 2020 203e 3e3e 2078 203d 2068         >>> x = h
+0001b980: 3570 792e 4669 6c65 2822 6461 7461 2e68  5py.File("data.h
+0001b990: 3522 295b 222f 7822 5d20 2023 2064 6f63  5")["/x"]  # doc
+0001b9a0: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
+0001b9b0: 2020 2020 2020 203e 3e3e 2061 203d 2064         >>> a = d
+0001b9c0: 612e 6672 6f6d 5f61 7272 6179 2878 2c20  a.from_array(x, 
+0001b9d0: 6368 756e 6b73 3d35 3030 2920 2023 2064  chunks=500)  # d
+0001b9e0: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
+0001b9f0: 2020 2020 2020 2020 203e 3e3e 2064 6963           >>> dic
+0001ba00: 7428 612e 6461 736b 2920 2023 2064 6f63  t(a.dask)  # doc
+0001ba10: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
+0001ba20: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+0001ba30: 2020 2020 2020 2027 6172 7261 792d 6f72         'array-or
+0001ba40: 6967 696e 616c 2d3c 6e61 6d65 3e27 3a20  iginal-<name>': 
+0001ba50: 3c48 4446 3520 6461 7461 7365 7420 2e2e  <HDF5 dataset ..
+0001ba60: 2e3e 2c0a 2020 2020 2020 2020 2020 2020  .>,.            
+0001ba70: 2020 2827 6172 7261 792d 3c6e 616d 653e    ('array-<name>
+0001ba80: 272c 2030 293a 2028 6765 7469 7465 6d2c  ', 0): (getitem,
+0001ba90: 2022 6172 7261 792d 6f72 6967 696e 616c   "array-original
+0001baa0: 2d3c 6e61 6d65 3e22 2c20 2e2e 2e29 2c0a  -<name>", ...),.
+0001bab0: 2020 2020 2020 2020 2020 2020 2020 2827                ('
+0001bac0: 6172 7261 792d 3c6e 616d 653e 272c 2031  array-<name>', 1
+0001bad0: 293a 2028 6765 7469 7465 6d2c 2022 6172  ): (getitem, "ar
+0001bae0: 7261 792d 6f72 6967 696e 616c 2d3c 6e61  ray-original-<na
+0001baf0: 6d65 3e22 2c20 2e2e 2e29 0a20 2020 2020  me>", ...).     
+0001bb00: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
+0001bb10: 2057 6974 6820 6060 696e 6c69 6e65 5f61   With ``inline_a
+0001bb20: 7272 6179 3d54 7275 6560 602c 2044 6173  rray=True``, Das
+0001bb30: 6b20 7769 6c6c 2069 6e73 7465 6164 2069  k will instead i
+0001bb40: 6e6c 696e 6520 7468 6520 6172 7261 7920  nline the array 
+0001bb50: 6469 7265 6374 6c79 0a20 2020 2020 2020  directly.       
+0001bb60: 2069 6e20 7468 6520 7661 6c75 6573 206f   in the values o
+0001bb70: 6620 7468 6520 7461 736b 2067 7261 7068  f the task graph
+0001bb80: 2e0a 0a20 2020 2020 2020 202e 2e20 636f  ...        .. co
+0001bb90: 6465 2d62 6c6f 636b 3a3a 2070 7974 686f  de-block:: pytho
+0001bba0: 6e0a 0a20 2020 2020 2020 2020 2020 3e3e  n..           >>
+0001bbb0: 3e20 6120 3d20 6461 2e66 726f 6d5f 6172  > a = da.from_ar
+0001bbc0: 7261 7928 782c 2063 6875 6e6b 733d 3530  ray(x, chunks=50
+0001bbd0: 302c 2069 6e6c 696e 655f 6172 7261 793d  0, inline_array=
+0001bbe0: 5472 7565 2920 2023 2064 6f63 7465 7374  True)  # doctest
+0001bbf0: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
+0001bc00: 2020 203e 3e3e 2064 6963 7428 612e 6461     >>> dict(a.da
+0001bc10: 736b 2920 2023 2064 6f63 7465 7374 3a20  sk)  # doctest: 
+0001bc20: 2b53 4b49 500a 2020 2020 2020 2020 2020  +SKIP.          
+0001bc30: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0001bc40: 2028 2761 7272 6179 2d3c 6e61 6d65 3e27   ('array-<name>'
+0001bc50: 2c20 3029 3a20 2867 6574 6974 656d 2c20  , 0): (getitem, 
+0001bc60: 3c48 4446 3520 6461 7461 7365 7420 2e2e  <HDF5 dataset ..
+0001bc70: 2e3e 2c20 2e2e 2e29 2c0a 2020 2020 2020  .>, ...),.      
+0001bc80: 2020 2020 2020 2020 2827 6172 7261 792d          ('array-
+0001bc90: 3c6e 616d 653e 272c 2031 293a 2028 6765  <name>', 1): (ge
+0001bca0: 7469 7465 6d2c 203c 4844 4635 2064 6174  titem, <HDF5 dat
+0001bcb0: 6173 6574 202e 2e2e 3e2c 202e 2e2e 290a  aset ...>, ...).
+0001bcc0: 2020 2020 2020 2020 2020 207d 0a0a 2020             }..  
+0001bcd0: 2020 2020 2020 4e6f 7465 2074 6861 7420        Note that 
+0001bce0: 7468 6572 6527 7320 6e6f 206b 6579 2069  there's no key i
+0001bcf0: 6e20 7468 6520 7461 736b 2067 7261 7068  n the task graph
+0001bd00: 2077 6974 6820 6a75 7374 2074 6865 2061   with just the a
+0001bd10: 7272 6179 2060 7860 0a20 2020 2020 2020  rray `x`.       
+0001bd20: 2061 6e79 6d6f 7265 2e20 496e 7374 6561   anymore. Instea
+0001bd30: 6420 6974 2773 2070 6c61 6365 6420 6469  d it's placed di
+0001bd40: 7265 6374 6c79 2069 6e20 7468 6520 7661  rectly in the va
+0001bd50: 6c75 6573 2e0a 0a20 2020 2020 2020 2054  lues...        T
+0001bd60: 6865 2072 6967 6874 2063 686f 6963 6520  he right choice 
+0001bd70: 666f 7220 6060 696e 6c69 6e65 5f61 7272  for ``inline_arr
+0001bd80: 6179 6060 2064 6570 656e 6473 206f 6e20  ay`` depends on 
+0001bd90: 7365 7665 7261 6c20 6661 6374 6f72 732c  several factors,
+0001bda0: 0a20 2020 2020 2020 2069 6e63 6c75 6469  .        includi
+0001bdb0: 6e67 2074 6865 2073 697a 6520 6f66 2060  ng the size of `
+0001bdc0: 6078 6060 2c20 686f 7720 6578 7065 6e73  `x``, how expens
+0001bdd0: 6976 6520 6974 2069 7320 746f 2063 7265  ive it is to cre
+0001bde0: 6174 652c 2077 6869 6368 0a20 2020 2020  ate, which.     
+0001bdf0: 2020 2073 6368 6564 756c 6572 2079 6f75     scheduler you
+0001be00: 2772 6520 7573 696e 672c 2061 6e64 2074  're using, and t
+0001be10: 6865 2070 6174 7465 726e 206f 6620 646f  he pattern of do
+0001be20: 776e 7374 7265 616d 2063 6f6d 7075 7461  wnstream computa
+0001be30: 7469 6f6e 732e 0a20 2020 2020 2020 2041  tions..        A
+0001be40: 7320 6120 6865 7572 6973 7469 632c 2060  s a heuristic, `
+0001be50: 6069 6e6c 696e 655f 6172 7261 793d 5472  `inline_array=Tr
+0001be60: 7565 6060 206d 6179 2062 6520 7468 6520  ue`` may be the 
+0001be70: 7269 6768 7420 6368 6f69 6365 2077 6865  right choice whe
+0001be80: 6e0a 2020 2020 2020 2020 7468 6520 6172  n.        the ar
+0001be90: 7261 7920 6060 7860 6020 6973 2063 6865  ray ``x`` is che
+0001bea0: 6170 2074 6f20 7365 7269 616c 697a 6520  ap to serialize 
+0001beb0: 616e 6420 6465 7365 7269 616c 697a 6520  and deserialize 
+0001bec0: 2873 696e 6365 2069 7427 730a 2020 2020  (since it's.    
+0001bed0: 2020 2020 696e 636c 7564 6564 2069 6e20      included in 
+0001bee0: 7468 6520 6772 6170 6820 6d61 6e79 2074  the graph many t
+0001bef0: 696d 6573 2920 616e 6420 6966 2079 6f75  imes) and if you
+0001bf00: 2772 6520 6578 7065 7269 656e 6369 6e67  're experiencing
+0001bf10: 206f 7264 6572 696e 670a 2020 2020 2020   ordering.      
+0001bf20: 2020 6973 7375 6573 2028 7365 6520 3a72    issues (see :r
+0001bf30: 6566 3a60 6f72 6465 7260 2066 6f72 206d  ef:`order` for m
+0001bf40: 6f72 6529 2e0a 0a20 2020 2020 2020 2054  ore)...        T
+0001bf50: 6869 7320 6861 7320 6e6f 2065 6666 6563  his has no effec
+0001bf60: 7420 7768 656e 2060 6078 6060 2069 7320  t when ``x`` is 
+0001bf70: 6120 4e75 6d50 7920 6172 7261 792e 0a0a  a NumPy array...
+0001bf80: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+0001bf90: 202d 2d2d 2d2d 2d2d 2d0a 0a20 2020 203e   --------..    >
+0001bfa0: 3e3e 2078 203d 2068 3570 792e 4669 6c65  >> x = h5py.File
+0001bfb0: 2827 2e2e 2e27 295b 272f 6461 7461 2f70  ('...')['/data/p
+0001bfc0: 6174 6827 5d20 2023 2064 6f63 7465 7374  ath']  # doctest
+0001bfd0: 3a20 2b53 4b49 500a 2020 2020 3e3e 3e20  : +SKIP.    >>> 
+0001bfe0: 6120 3d20 6461 2e66 726f 6d5f 6172 7261  a = da.from_arra
+0001bff0: 7928 782c 2063 6875 6e6b 733d 2831 3030  y(x, chunks=(100
+0001c000: 302c 2031 3030 3029 2920 2023 2064 6f63  0, 1000))  # doc
+0001c010: 7465 7374 3a20 2b53 4b49 500a 0a20 2020  test: +SKIP..   
+0001c020: 2049 6620 796f 7572 2075 6e64 6572 6c79   If your underly
+0001c030: 696e 6720 6461 7461 7374 6f72 6520 646f  ing datastore do
+0001c040: 6573 206e 6f74 2073 7570 706f 7274 2063  es not support c
+0001c050: 6f6e 6375 7272 656e 7420 7265 6164 7320  oncurrent reads 
+0001c060: 7468 656e 2069 6e63 6c75 6465 0a20 2020  then include.   
+0001c070: 2074 6865 2060 606c 6f63 6b3d 5472 7565   the ``lock=True
+0001c080: 6060 206b 6579 776f 7264 2061 7267 756d  `` keyword argum
+0001c090: 656e 7420 6f72 2060 606c 6f63 6b3d 6d79  ent or ``lock=my
+0001c0a0: 6c6f 636b 6060 2069 6620 796f 7520 7761  lock`` if you wa
+0001c0b0: 6e74 206d 756c 7469 706c 650a 2020 2020  nt multiple.    
+0001c0c0: 6172 7261 7973 2074 6f20 636f 6f72 6469  arrays to coordi
+0001c0d0: 6e61 7465 2061 726f 756e 6420 7468 6520  nate around the 
+0001c0e0: 7361 6d65 206c 6f63 6b2e 0a0a 2020 2020  same lock...    
+0001c0f0: 3e3e 3e20 6120 3d20 6461 2e66 726f 6d5f  >>> a = da.from_
+0001c100: 6172 7261 7928 782c 2063 6875 6e6b 733d  array(x, chunks=
+0001c110: 2831 3030 302c 2031 3030 3029 2c20 6c6f  (1000, 1000), lo
+0001c120: 636b 3d54 7275 6529 2020 2320 646f 6374  ck=True)  # doct
+0001c130: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
+0001c140: 4966 2079 6f75 7220 756e 6465 726c 7969  If your underlyi
+0001c150: 6e67 2064 6174 6173 746f 7265 2068 6173  ng datastore has
+0001c160: 2061 2060 602e 6368 756e 6b73 6060 2061   a ``.chunks`` a
+0001c170: 7474 7269 6275 7465 2028 6173 2068 3570  ttribute (as h5p
+0001c180: 7920 616e 6420 7a61 7272 0a20 2020 2064  y and zarr.    d
+0001c190: 6174 6173 6574 7320 646f 2920 7468 656e  atasets do) then
+0001c1a0: 2061 206d 756c 7469 706c 6520 6f66 2074   a multiple of t
+0001c1b0: 6861 7420 6368 756e 6b20 7368 6170 6520  hat chunk shape 
+0001c1c0: 7769 6c6c 2062 6520 7573 6564 2069 6620  will be used if 
+0001c1d0: 796f 750a 2020 2020 646f 206e 6f74 2070  you.    do not p
+0001c1e0: 726f 7669 6465 2061 2063 6875 6e6b 2073  rovide a chunk s
+0001c1f0: 6861 7065 2e0a 0a20 2020 203e 3e3e 2061  hape...    >>> a
+0001c200: 203d 2064 612e 6672 6f6d 5f61 7272 6179   = da.from_array
+0001c210: 2878 2c20 6368 756e 6b73 3d27 6175 746f  (x, chunks='auto
+0001c220: 2729 2020 2320 646f 6374 6573 743a 202b  ')  # doctest: +
+0001c230: 534b 4950 0a20 2020 203e 3e3e 2061 203d  SKIP.    >>> a =
+0001c240: 2064 612e 6672 6f6d 5f61 7272 6179 2878   da.from_array(x
+0001c250: 2c20 6368 756e 6b73 3d27 3130 3020 4d69  , chunks='100 Mi
+0001c260: 4227 2920 2023 2064 6f63 7465 7374 3a20  B')  # doctest: 
+0001c270: 2b53 4b49 500a 2020 2020 3e3e 3e20 6120  +SKIP.    >>> a 
+0001c280: 3d20 6461 2e66 726f 6d5f 6172 7261 7928  = da.from_array(
+0001c290: 7829 2020 2320 646f 6374 6573 743a 202b  x)  # doctest: +
+0001c2a0: 534b 4950 0a0a 2020 2020 4966 2070 726f  SKIP..    If pro
+0001c2b0: 7669 6469 6e67 2061 206e 616d 652c 2065  viding a name, e
+0001c2c0: 6e73 7572 6520 7468 6174 2069 7420 6973  nsure that it is
+0001c2d0: 2075 6e69 7175 650a 0a20 2020 203e 3e3e   unique..    >>>
+0001c2e0: 2069 6d70 6f72 7420 6461 736b 2e62 6173   import dask.bas
+0001c2f0: 650a 2020 2020 3e3e 3e20 746f 6b65 6e20  e.    >>> token 
+0001c300: 3d20 6461 736b 2e62 6173 652e 746f 6b65  = dask.base.toke
+0001c310: 6e69 7a65 2878 2920 2023 2064 6f63 7465  nize(x)  # docte
+0001c320: 7374 3a20 2b53 4b49 500a 2020 2020 3e3e  st: +SKIP.    >>
+0001c330: 3e20 6120 3d20 6461 2e66 726f 6d5f 6172  > a = da.from_ar
+0001c340: 7261 7928 276d 7961 7272 6179 2d27 202b  ray('myarray-' +
+0001c350: 2074 6f6b 656e 2920 2023 2064 6f63 7465   token)  # docte
+0001c360: 7374 3a20 2b53 4b49 500a 0a20 2020 204e  st: +SKIP..    N
+0001c370: 756d 5079 206e 6461 7272 6179 7320 6172  umPy ndarrays ar
+0001c380: 6520 6561 6765 726c 7920 736c 6963 6564  e eagerly sliced
+0001c390: 2061 6e64 2074 6865 6e20 656d 6265 6464   and then embedd
+0001c3a0: 6564 2069 6e20 7468 6520 6772 6170 682e  ed in the graph.
+0001c3b0: 0a0a 2020 2020 3e3e 3e20 696d 706f 7274  ..    >>> import
+0001c3c0: 2064 6173 6b2e 6172 7261 790a 2020 2020   dask.array.    
+0001c3d0: 3e3e 3e20 6120 3d20 6461 736b 2e61 7272  >>> a = dask.arr
+0001c3e0: 6179 2e66 726f 6d5f 6172 7261 7928 6e70  ay.from_array(np
+0001c3f0: 2e61 7272 6179 285b 5b31 2c20 325d 2c20  .array([[1, 2], 
+0001c400: 5b33 2c20 345d 5d29 2c20 6368 756e 6b73  [3, 4]]), chunks
+0001c410: 3d28 312c 3129 290a 2020 2020 3e3e 3e20  =(1,1)).    >>> 
+0001c420: 612e 6461 736b 5b61 2e6e 616d 652c 2030  a.dask[a.name, 0
+0001c430: 2c20 305d 5b30 5d0a 2020 2020 6172 7261  , 0][0].    arra
+0001c440: 7928 5b31 5d29 0a0a 2020 2020 4368 756e  y([1])..    Chun
+0001c450: 6b73 2077 6974 6820 6578 6163 746c 792d  ks with exactly-
+0001c460: 7370 6563 6966 6965 642c 2064 6966 6665  specified, diffe
+0001c470: 7265 6e74 2073 697a 6573 2063 616e 2062  rent sizes can b
+0001c480: 6520 6372 6561 7465 642e 0a0a 2020 2020  e created...    
+0001c490: 3e3e 3e20 696d 706f 7274 206e 756d 7079  >>> import numpy
+0001c4a0: 2061 7320 6e70 0a20 2020 203e 3e3e 2069   as np.    >>> i
+0001c4b0: 6d70 6f72 7420 6461 736b 2e61 7272 6179  mport dask.array
+0001c4c0: 2061 7320 6461 0a20 2020 203e 3e3e 2072   as da.    >>> r
+0001c4d0: 6e67 203d 206e 702e 7261 6e64 6f6d 2e64  ng = np.random.d
+0001c4e0: 6566 6175 6c74 5f72 6e67 2829 0a20 2020  efault_rng().   
+0001c4f0: 203e 3e3e 2078 203d 2072 6e67 2e72 616e   >>> x = rng.ran
+0001c500: 646f 6d28 2831 3030 2c20 3629 290a 2020  dom((100, 6)).  
+0001c510: 2020 3e3e 3e20 6120 3d20 6461 2e66 726f    >>> a = da.fro
+0001c520: 6d5f 6172 7261 7928 782c 2063 6875 6e6b  m_array(x, chunk
+0001c530: 733d 2828 3637 2c20 3333 292c 2028 362c  s=((67, 33), (6,
+0001c540: 2929 290a 2020 2020 2222 220a 2020 2020  ))).    """.    
+0001c550: 6966 2069 7369 6e73 7461 6e63 6528 782c  if isinstance(x,
+0001c560: 2041 7272 6179 293a 0a20 2020 2020 2020   Array):.       
+0001c570: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001c580: 7228 0a20 2020 2020 2020 2020 2020 2022  r(.            "
+0001c590: 4172 7261 7920 6973 2061 6c72 6561 6479  Array is already
+0001c5a0: 2061 2064 6173 6b20 6172 7261 792e 2055   a dask array. U
+0001c5b0: 7365 2027 6173 6172 7261 7927 206f 7220  se 'asarray' or 
+0001c5c0: 2220 2227 7265 6368 756e 6b27 2069 6e73  " "'rechunk' ins
+0001c5d0: 7465 6164 2e22 0a20 2020 2020 2020 2029  tead.".        )
+0001c5e0: 0a20 2020 2065 6c69 6620 6973 5f64 6173  .    elif is_das
+0001c5f0: 6b5f 636f 6c6c 6563 7469 6f6e 2878 293a  k_collection(x):
+0001c600: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+0001c610: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+0001c620: 2020 2020 2250 6173 7369 6e67 2061 6e20      "Passing an 
+0001c630: 6f62 6a65 6374 2074 6f20 6461 736b 2e61  object to dask.a
+0001c640: 7272 6179 2e66 726f 6d5f 6172 7261 7920  rray.from_array 
+0001c650: 7768 6963 6820 6973 2061 6c72 6561 6479  which is already
+0001c660: 2061 2022 0a20 2020 2020 2020 2020 2020   a ".           
+0001c670: 2022 4461 736b 2063 6f6c 6c65 6374 696f   "Dask collectio
+0001c680: 6e2e 2054 6869 7320 6361 6e20 6c65 6164  n. This can lead
+0001c690: 2074 6f20 756e 6578 7065 6374 6564 2062   to unexpected b
+0001c6a0: 6568 6176 696f 722e 220a 2020 2020 2020  ehavior.".      
+0001c6b0: 2020 290a 0a20 2020 2069 6620 6973 696e    )..    if isin
+0001c6c0: 7374 616e 6365 2878 2c20 286c 6973 742c  stance(x, (list,
+0001c6d0: 2074 7570 6c65 2c20 6d65 6d6f 7279 7669   tuple, memoryvi
+0001c6e0: 6577 2920 2b20 6e70 2e53 6361 6c61 7254  ew) + np.ScalarT
+0001c6f0: 7970 6529 3a0a 2020 2020 2020 2020 7820  ype):.        x 
+0001c700: 3d20 6e70 2e61 7272 6179 2878 290a 0a20  = np.array(x).. 
+0001c710: 2020 2069 6620 6173 6172 7261 7920 6973     if asarray is
+0001c720: 204e 6f6e 653a 0a20 2020 2020 2020 2061   None:.        a
+0001c730: 7361 7272 6179 203d 206e 6f74 2068 6173  sarray = not has
+0001c740: 6174 7472 2878 2c20 225f 5f61 7272 6179  attr(x, "__array
+0001c750: 5f66 756e 6374 696f 6e5f 5f22 290a 0a20  _function__").. 
+0001c760: 2020 2070 7265 7669 6f75 735f 6368 756e     previous_chun
+0001c770: 6b73 203d 2067 6574 6174 7472 2878 2c20  ks = getattr(x, 
+0001c780: 2263 6875 6e6b 7322 2c20 4e6f 6e65 290a  "chunks", None).
+0001c790: 0a20 2020 2063 6875 6e6b 7320 3d20 6e6f  .    chunks = no
+0001c7a0: 726d 616c 697a 655f 6368 756e 6b73 280a  rmalize_chunks(.
+0001c7b0: 2020 2020 2020 2020 6368 756e 6b73 2c20          chunks, 
+0001c7c0: 782e 7368 6170 652c 2064 7479 7065 3d78  x.shape, dtype=x
+0001c7d0: 2e64 7479 7065 2c20 7072 6576 696f 7573  .dtype, previous
+0001c7e0: 5f63 6875 6e6b 733d 7072 6576 696f 7573  _chunks=previous
+0001c7f0: 5f63 6875 6e6b 730a 2020 2020 290a 0a20  _chunks.    ).. 
+0001c800: 2020 2069 6620 6e61 6d65 2069 6e20 284e     if name in (N
+0001c810: 6f6e 652c 2054 7275 6529 3a0a 2020 2020  one, True):.    
+0001c820: 2020 2020 746f 6b65 6e20 3d20 746f 6b65      token = toke
+0001c830: 6e69 7a65 2878 2c20 6368 756e 6b73 2c20  nize(x, chunks, 
+0001c840: 6c6f 636b 2c20 6173 6172 7261 792c 2066  lock, asarray, f
+0001c850: 616e 6379 2c20 6765 7469 7465 6d2c 2069  ancy, getitem, i
+0001c860: 6e6c 696e 655f 6172 7261 7929 0a20 2020  nline_array).   
+0001c870: 2020 2020 206e 616d 6520 3d20 6e61 6d65       name = name
+0001c880: 206f 7220 2261 7272 6179 2d22 202b 2074   or "array-" + t
+0001c890: 6f6b 656e 0a20 2020 2065 6c69 6620 6e61  oken.    elif na
+0001c8a0: 6d65 2069 7320 4661 6c73 653a 0a20 2020  me is False:.   
+0001c8b0: 2020 2020 206e 616d 6520 3d20 2261 7272       name = "arr
+0001c8c0: 6179 2d22 202b 2073 7472 2875 7569 642e  ay-" + str(uuid.
+0001c8d0: 7575 6964 3128 2929 0a0a 2020 2020 6966  uuid1())..    if
+0001c8e0: 206c 6f63 6b20 6973 2054 7275 653a 0a20   lock is True:. 
+0001c8f0: 2020 2020 2020 206c 6f63 6b20 3d20 5365         lock = Se
+0001c900: 7269 616c 697a 6162 6c65 4c6f 636b 2829  rializableLock()
+0001c910: 0a0a 2020 2020 6973 5f6e 6461 7272 6179  ..    is_ndarray
+0001c920: 203d 2074 7970 6528 7829 2069 6e20 286e   = type(x) in (n
+0001c930: 702e 6e64 6172 7261 792c 206e 702e 6d61  p.ndarray, np.ma
+0001c940: 2e63 6f72 652e 4d61 736b 6564 4172 7261  .core.MaskedArra
+0001c950: 7929 0a20 2020 2069 735f 7369 6e67 6c65  y).    is_single
+0001c960: 5f62 6c6f 636b 203d 2061 6c6c 286c 656e  _block = all(len
+0001c970: 2863 2920 3d3d 2031 2066 6f72 2063 2069  (c) == 1 for c i
+0001c980: 6e20 6368 756e 6b73 290a 2020 2020 2320  n chunks).    # 
+0001c990: 416c 7761 7973 2075 7365 2074 6865 2067  Always use the g
+0001c9a0: 6574 7465 7220 666f 7220 6835 7079 2065  etter for h5py e
+0001c9b0: 7463 2e20 4e6f 7420 7573 696e 6720 6973  tc. Not using is
+0001c9c0: 696e 7374 616e 6365 2878 2c20 6e70 2e6e  instance(x, np.n
+0001c9d0: 6461 7272 6179 290a 2020 2020 2320 6265  darray).    # be
+0001c9e0: 6361 7573 6520 6e70 2e6d 6174 7269 7820  cause np.matrix 
+0001c9f0: 6973 2061 2073 7562 636c 6173 7320 6f66  is a subclass of
+0001ca00: 206e 702e 6e64 6172 7261 792e 0a20 2020   np.ndarray..   
+0001ca10: 2069 6620 6973 5f6e 6461 7272 6179 2061   if is_ndarray a
+0001ca20: 6e64 206e 6f74 2069 735f 7369 6e67 6c65  nd not is_single
+0001ca30: 5f62 6c6f 636b 2061 6e64 206e 6f74 206c  _block and not l
+0001ca40: 6f63 6b3a 0a20 2020 2020 2020 2023 2065  ock:.        # e
+0001ca50: 6167 6572 6c79 2073 6c69 6365 206e 756d  agerly slice num
+0001ca60: 7079 2061 7272 6179 7320 746f 2070 7265  py arrays to pre
+0001ca70: 7665 6e74 206d 656d 6f72 7920 626c 6f77  vent memory blow
+0001ca80: 7570 0a20 2020 2020 2020 2023 2047 4835  up.        # GH5
+0001ca90: 3336 372c 2047 4835 3630 310a 2020 2020  367, GH5601.    
+0001caa0: 2020 2020 736c 6963 6573 203d 2073 6c69      slices = sli
+0001cab0: 6365 735f 6672 6f6d 5f63 6875 6e6b 7328  ces_from_chunks(
+0001cac0: 6368 756e 6b73 290a 2020 2020 2020 2020  chunks).        
+0001cad0: 6b65 7973 203d 2070 726f 6475 6374 285b  keys = product([
+0001cae0: 6e61 6d65 5d2c 202a 2872 616e 6765 286c  name], *(range(l
+0001caf0: 656e 2862 6473 2929 2066 6f72 2062 6473  en(bds)) for bds
+0001cb00: 2069 6e20 6368 756e 6b73 2929 0a20 2020   in chunks)).   
+0001cb10: 2020 2020 2076 616c 7565 7320 3d20 5b78       values = [x
+0001cb20: 5b73 6c63 5d20 666f 7220 736c 6320 696e  [slc] for slc in
+0001cb30: 2073 6c69 6365 735d 0a20 2020 2020 2020   slices].       
+0001cb40: 2064 736b 203d 2064 6963 7428 7a69 7028   dsk = dict(zip(
+0001cb50: 6b65 7973 2c20 7661 6c75 6573 2929 0a0a  keys, values))..
+0001cb60: 2020 2020 656c 6966 2069 735f 6e64 6172      elif is_ndar
+0001cb70: 7261 7920 616e 6420 6973 5f73 696e 676c  ray and is_singl
+0001cb80: 655f 626c 6f63 6b3a 0a20 2020 2020 2020  e_block:.       
+0001cb90: 2023 204e 6f20 736c 6963 696e 6720 6e65   # No slicing ne
+0001cba0: 6564 6564 0a20 2020 2020 2020 2064 736b  eded.        dsk
+0001cbb0: 203d 207b 286e 616d 652c 2920 2b20 2830   = {(name,) + (0
+0001cbc0: 2c29 202a 2078 2e6e 6469 6d3a 2078 7d0a  ,) * x.ndim: x}.
+0001cbd0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001cbe0: 2020 6966 2067 6574 6974 656d 2069 7320    if getitem is 
+0001cbf0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0001cc00: 2020 6966 2066 616e 6379 3a0a 2020 2020    if fancy:.    
+0001cc10: 2020 2020 2020 2020 2020 2020 6765 7469              geti
+0001cc20: 7465 6d20 3d20 6765 7474 6572 0a20 2020  tem = getter.   
+0001cc30: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0001cc40: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+0001cc50: 6574 6974 656d 203d 2067 6574 7465 725f  etitem = getter_
+0001cc60: 6e6f 6661 6e63 790a 0a20 2020 2020 2020  nofancy..       
+0001cc70: 2064 736b 203d 2067 7261 7068 5f66 726f   dsk = graph_fro
+0001cc80: 6d5f 6172 7261 796c 696b 6528 0a20 2020  m_arraylike(.   
+0001cc90: 2020 2020 2020 2020 2078 2c0a 2020 2020           x,.    
+0001cca0: 2020 2020 2020 2020 6368 756e 6b73 2c0a          chunks,.
+0001ccb0: 2020 2020 2020 2020 2020 2020 782e 7368              x.sh
+0001ccc0: 6170 652c 0a20 2020 2020 2020 2020 2020  ape,.           
+0001ccd0: 206e 616d 652c 0a20 2020 2020 2020 2020   name,.         
+0001cce0: 2020 2067 6574 6974 656d 3d67 6574 6974     getitem=getit
+0001ccf0: 656d 2c0a 2020 2020 2020 2020 2020 2020  em,.            
+0001cd00: 6c6f 636b 3d6c 6f63 6b2c 0a20 2020 2020  lock=lock,.     
+0001cd10: 2020 2020 2020 2061 7361 7272 6179 3d61         asarray=a
+0001cd20: 7361 7272 6179 2c0a 2020 2020 2020 2020  sarray,.        
+0001cd30: 2020 2020 6474 7970 653d 782e 6474 7970      dtype=x.dtyp
+0001cd40: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
+0001cd50: 6e6c 696e 655f 6172 7261 793d 696e 6c69  nline_array=inli
+0001cd60: 6e65 5f61 7272 6179 2c0a 2020 2020 2020  ne_array,.      
+0001cd70: 2020 290a 0a20 2020 2023 2057 6f72 6b61    )..    # Worka
+0001cd80: 726f 756e 6420 666f 7220 5469 6c65 4442  round for TileDB
+0001cd90: 2c20 6974 7320 696e 6465 7869 6e67 2069  , its indexing i
+0001cda0: 7320 312d 6261 7365 642c 0a20 2020 2023  s 1-based,.    #
+0001cdb0: 2061 6e64 2064 6f65 736e 2774 2073 6565   and doesn't see
+0001cdc0: 6d73 2074 6f20 7375 7070 6f72 7420 302d  ms to support 0-
+0001cdd0: 6c65 6e67 7468 2073 6c69 6369 6e67 0a20  length slicing. 
+0001cde0: 2020 2069 6620 782e 5f5f 636c 6173 735f     if x.__class_
+0001cdf0: 5f2e 5f5f 6d6f 6475 6c65 5f5f 2e73 706c  _.__module__.spl
+0001ce00: 6974 2822 2e22 295b 305d 203d 3d20 2274  it(".")[0] == "t
+0001ce10: 696c 6564 6222 2061 6e64 2068 6173 6174  iledb" and hasat
+0001ce20: 7472 2878 2c20 225f 6374 785f 2229 3a0a  tr(x, "_ctx_"):.
+0001ce30: 2020 2020 2020 2020 7265 7475 726e 2041          return A
+0001ce40: 7272 6179 2864 736b 2c20 6e61 6d65 2c20  rray(dsk, name, 
+0001ce50: 6368 756e 6b73 2c20 6474 7970 653d 782e  chunks, dtype=x.
+0001ce60: 6474 7970 6529 0a0a 2020 2020 6966 206d  dtype)..    if m
+0001ce70: 6574 6120 6973 204e 6f6e 653a 0a20 2020  eta is None:.   
+0001ce80: 2020 2020 206d 6574 6120 3d20 780a 0a20       meta = x.. 
+0001ce90: 2020 2072 6574 7572 6e20 4172 7261 7928     return Array(
+0001cea0: 6473 6b2c 206e 616d 652c 2063 6875 6e6b  dsk, name, chunk
+0001ceb0: 732c 206d 6574 613d 6d65 7461 2c20 6474  s, meta=meta, dt
+0001cec0: 7970 653d 6765 7461 7474 7228 782c 2022  ype=getattr(x, "
+0001ced0: 6474 7970 6522 2c20 4e6f 6e65 2929 0a0a  dtype", None))..
+0001cee0: 0a64 6566 2066 726f 6d5f 7a61 7272 280a  .def from_zarr(.
+0001cef0: 2020 2020 7572 6c2c 0a20 2020 2063 6f6d      url,.    com
+0001cf00: 706f 6e65 6e74 3d4e 6f6e 652c 0a20 2020  ponent=None,.   
+0001cf10: 2073 746f 7261 6765 5f6f 7074 696f 6e73   storage_options
+0001cf20: 3d4e 6f6e 652c 0a20 2020 2063 6875 6e6b  =None,.    chunk
+0001cf30: 733d 4e6f 6e65 2c0a 2020 2020 6e61 6d65  s=None,.    name
+0001cf40: 3d4e 6f6e 652c 0a20 2020 2069 6e6c 696e  =None,.    inlin
+0001cf50: 655f 6172 7261 793d 4661 6c73 652c 0a20  e_array=False,. 
+0001cf60: 2020 202a 2a6b 7761 7267 732c 0a29 3a0a     **kwargs,.):.
+0001cf70: 2020 2020 2222 224c 6f61 6420 6172 7261      """Load arra
+0001cf80: 7920 6672 6f6d 2074 6865 207a 6172 7220  y from the zarr 
+0001cf90: 7374 6f72 6167 6520 666f 726d 6174 0a0a  storage format..
+0001cfa0: 2020 2020 5365 6520 6874 7470 733a 2f2f      See https://
+0001cfb0: 7a61 7272 2e72 6561 6474 6865 646f 6373  zarr.readthedocs
+0001cfc0: 2e69 6f20 666f 7220 6465 7461 696c 7320  .io for details 
+0001cfd0: 6162 6f75 7420 7468 6520 666f 726d 6174  about the format
+0001cfe0: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+0001cff0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0001d000: 0a20 2020 2075 726c 3a20 5a61 7272 2041  .    url: Zarr A
+0001d010: 7272 6179 206f 7220 7374 7220 6f72 204d  rray or str or M
+0001d020: 7574 6162 6c65 4d61 7070 696e 670a 2020  utableMapping.  
+0001d030: 2020 2020 2020 4c6f 6361 7469 6f6e 206f        Location o
+0001d040: 6620 7468 6520 6461 7461 2e20 4120 5552  f the data. A UR
+0001d050: 4c20 6361 6e20 696e 636c 7564 6520 6120  L can include a 
+0001d060: 7072 6f74 6f63 6f6c 2073 7065 6369 6669  protocol specifi
+0001d070: 6572 206c 696b 6520 7333 3a2f 2f0a 2020  er like s3://.  
+0001d080: 2020 2020 2020 666f 7220 7265 6d6f 7465        for remote
+0001d090: 2064 6174 612e 2043 616e 2061 6c73 6f20   data. Can also 
+0001d0a0: 6265 2061 6e79 204d 7574 6162 6c65 4d61  be any MutableMa
+0001d0b0: 7070 696e 6720 696e 7374 616e 6365 2c20  pping instance, 
+0001d0c0: 7768 6963 6820 7368 6f75 6c64 0a20 2020  which should.   
+0001d0d0: 2020 2020 2062 6520 7365 7269 616c 697a       be serializ
+0001d0e0: 6162 6c65 2069 6620 7573 6564 2069 6e20  able if used in 
+0001d0f0: 6d75 6c74 6970 6c65 2070 726f 6365 7373  multiple process
+0001d100: 6573 2e0a 2020 2020 636f 6d70 6f6e 656e  es..    componen
+0001d110: 743a 2073 7472 206f 7220 4e6f 6e65 0a20  t: str or None. 
+0001d120: 2020 2020 2020 2049 6620 7468 6520 6c6f         If the lo
+0001d130: 6361 7469 6f6e 2069 7320 6120 7a61 7272  cation is a zarr
+0001d140: 2067 726f 7570 2072 6174 6865 7220 7468   group rather th
+0001d150: 616e 2061 6e20 6172 7261 792c 2074 6869  an an array, thi
+0001d160: 7320 6973 2074 6865 0a20 2020 2020 2020  s is the.       
+0001d170: 2073 7562 636f 6d70 6f6e 656e 7420 7468   subcomponent th
+0001d180: 6174 2073 686f 756c 6420 6265 206c 6f61  at should be loa
+0001d190: 6465 642c 2073 6f6d 6574 6869 6e67 206c  ded, something l
+0001d1a0: 696b 6520 6060 2766 6f6f 2f62 6172 2760  ike ``'foo/bar'`
+0001d1b0: 602e 0a20 2020 2073 746f 7261 6765 5f6f  `..    storage_o
+0001d1c0: 7074 696f 6e73 3a20 6469 6374 0a20 2020  ptions: dict.   
+0001d1d0: 2020 2020 2041 6e79 2061 6464 6974 696f       Any additio
+0001d1e0: 6e61 6c20 7061 7261 6d65 7465 7273 2066  nal parameters f
+0001d1f0: 6f72 2074 6865 2073 746f 7261 6765 2062  or the storage b
+0001d200: 6163 6b65 6e64 2028 6967 6e6f 7265 6420  ackend (ignored 
+0001d210: 666f 7220 6c6f 6361 6c0a 2020 2020 2020  for local.      
+0001d220: 2020 7061 7468 7329 0a20 2020 2063 6875    paths).    chu
+0001d230: 6e6b 733a 2074 7570 6c65 206f 6620 696e  nks: tuple of in
+0001d240: 7473 206f 7220 7475 706c 6573 206f 6620  ts or tuples of 
+0001d250: 696e 7473 0a20 2020 2020 2020 2050 6173  ints.        Pas
+0001d260: 7365 6420 746f 203a 6675 6e63 3a60 6461  sed to :func:`da
+0001d270: 736b 2e61 7272 6179 2e66 726f 6d5f 6172  sk.array.from_ar
+0001d280: 7261 7960 2c20 616c 6c6f 7773 2073 6574  ray`, allows set
+0001d290: 7469 6e67 2074 6865 2063 6875 6e6b 7320  ting the chunks 
+0001d2a0: 6f6e 0a20 2020 2020 2020 2069 6e69 7469  on.        initi
+0001d2b0: 616c 6973 6174 696f 6e2c 2069 6620 7468  alisation, if th
+0001d2c0: 6520 6368 756e 6b69 6e67 2073 6368 656d  e chunking schem
+0001d2d0: 6520 696e 2074 6865 206f 6e2d 6469 7363  e in the on-disc
+0001d2e0: 2064 6174 6173 6574 2069 7320 6e6f 740a   dataset is not.
+0001d2f0: 2020 2020 2020 2020 6f70 7469 6d61 6c20          optimal 
+0001d300: 666f 7220 7468 6520 6361 6c63 756c 6174  for the calculat
+0001d310: 696f 6e73 2074 6f20 666f 6c6c 6f77 2e0a  ions to follow..
+0001d320: 2020 2020 6e61 6d65 203a 2073 7472 2c20      name : str, 
+0001d330: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0001d340: 2020 416e 206f 7074 696f 6e61 6c20 6b65    An optional ke
+0001d350: 796e 616d 6520 666f 7220 7468 6520 6172  yname for the ar
+0001d360: 7261 792e 2020 4465 6661 756c 7473 2074  ray.  Defaults t
+0001d370: 6f20 6861 7368 696e 6720 7468 6520 696e  o hashing the in
+0001d380: 7075 740a 2020 2020 6b77 6172 6773 3a0a  put.    kwargs:.
+0001d390: 2020 2020 2020 2020 5061 7373 6564 2074          Passed t
+0001d3a0: 6f20 3a63 6c61 7373 3a60 7a61 7272 2e63  o :class:`zarr.c
+0001d3b0: 6f72 652e 4172 7261 7960 2e0a 2020 2020  ore.Array`..    
+0001d3c0: 696e 6c69 6e65 5f61 7272 6179 203a 2062  inline_array : b
+0001d3d0: 6f6f 6c2c 2064 6566 6175 6c74 2046 616c  ool, default Fal
+0001d3e0: 7365 0a20 2020 2020 2020 2057 6865 7468  se.        Wheth
+0001d3f0: 6572 2074 6f20 696e 6c69 6e65 2074 6865  er to inline the
+0001d400: 207a 6172 7220 4172 7261 7920 696e 2074   zarr Array in t
+0001d410: 6865 2076 616c 7565 7320 6f66 2074 6865  he values of the
+0001d420: 2074 6173 6b20 6772 6170 682e 0a20 2020   task graph..   
+0001d430: 2020 2020 2053 6565 203a 6d65 7468 3a60       See :meth:`
+0001d440: 6461 736b 2e61 7272 6179 2e66 726f 6d5f  dask.array.from_
+0001d450: 6172 7261 7960 2066 6f72 2061 6e20 6578  array` for an ex
+0001d460: 706c 616e 6174 696f 6e2e 0a0a 2020 2020  planation...    
+0001d470: 5365 6520 416c 736f 0a20 2020 202d 2d2d  See Also.    ---
+0001d480: 2d2d 2d2d 2d0a 2020 2020 6672 6f6d 5f61  -----.    from_a
+0001d490: 7272 6179 0a20 2020 2022 2222 0a20 2020  rray.    """.   
+0001d4a0: 2069 6d70 6f72 7420 7a61 7272 0a0a 2020   import zarr..  
+0001d4b0: 2020 7374 6f72 6167 655f 6f70 7469 6f6e    storage_option
+0001d4c0: 7320 3d20 7374 6f72 6167 655f 6f70 7469  s = storage_opti
+0001d4d0: 6f6e 7320 6f72 207b 7d0a 2020 2020 6966  ons or {}.    if
+0001d4e0: 2069 7369 6e73 7461 6e63 6528 7572 6c2c   isinstance(url,
+0001d4f0: 207a 6172 722e 4172 7261 7929 3a0a 2020   zarr.Array):.  
+0001d500: 2020 2020 2020 7a20 3d20 7572 6c0a 2020        z = url.  
+0001d510: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+0001d520: 6528 7572 6c2c 2028 7374 722c 206f 732e  e(url, (str, os.
+0001d530: 5061 7468 4c69 6b65 2929 3a0a 2020 2020  PathLike)):.    
+0001d540: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0001d550: 6528 7572 6c2c 206f 732e 5061 7468 4c69  e(url, os.PathLi
+0001d560: 6b65 293a 0a20 2020 2020 2020 2020 2020  ke):.           
+0001d570: 2075 726c 203d 206f 732e 6673 7061 7468   url = os.fspath
+0001d580: 2875 726c 290a 2020 2020 2020 2020 6966  (url).        if
+0001d590: 2073 746f 7261 6765 5f6f 7074 696f 6e73   storage_options
+0001d5a0: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
+0001d5b0: 6f72 6520 3d20 7a61 7272 2e73 746f 7261  ore = zarr.stora
+0001d5c0: 6765 2e46 5353 746f 7265 2875 726c 2c20  ge.FSStore(url, 
+0001d5d0: 2a2a 7374 6f72 6167 655f 6f70 7469 6f6e  **storage_option
+0001d5e0: 7329 0a20 2020 2020 2020 2065 6c73 653a  s).        else:
+0001d5f0: 0a20 2020 2020 2020 2020 2020 2073 746f  .            sto
+0001d600: 7265 203d 2075 726c 0a20 2020 2020 2020  re = url.       
+0001d610: 207a 203d 207a 6172 722e 4172 7261 7928   z = zarr.Array(
+0001d620: 7374 6f72 652c 2072 6561 645f 6f6e 6c79  store, read_only
+0001d630: 3d54 7275 652c 2070 6174 683d 636f 6d70  =True, path=comp
+0001d640: 6f6e 656e 742c 202a 2a6b 7761 7267 7329  onent, **kwargs)
+0001d650: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+0001d660: 2020 207a 203d 207a 6172 722e 4172 7261     z = zarr.Arra
+0001d670: 7928 7572 6c2c 2072 6561 645f 6f6e 6c79  y(url, read_only
+0001d680: 3d54 7275 652c 2070 6174 683d 636f 6d70  =True, path=comp
+0001d690: 6f6e 656e 742c 202a 2a6b 7761 7267 7329  onent, **kwargs)
+0001d6a0: 0a20 2020 2063 6875 6e6b 7320 3d20 6368  .    chunks = ch
+0001d6b0: 756e 6b73 2069 6620 6368 756e 6b73 2069  unks if chunks i
+0001d6c0: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
+0001d6d0: 7a2e 6368 756e 6b73 0a20 2020 2069 6620  z.chunks.    if 
+0001d6e0: 6e61 6d65 2069 7320 4e6f 6e65 3a0a 2020  name is None:.  
+0001d6f0: 2020 2020 2020 6e61 6d65 203d 2022 6672        name = "fr
+0001d700: 6f6d 2d7a 6172 722d 2220 2b20 746f 6b65  om-zarr-" + toke
+0001d710: 6e69 7a65 287a 2c20 636f 6d70 6f6e 656e  nize(z, componen
+0001d720: 742c 2073 746f 7261 6765 5f6f 7074 696f  t, storage_optio
+0001d730: 6e73 2c20 6368 756e 6b73 2c20 2a2a 6b77  ns, chunks, **kw
+0001d740: 6172 6773 290a 2020 2020 7265 7475 726e  args).    return
+0001d750: 2066 726f 6d5f 6172 7261 7928 7a2c 2063   from_array(z, c
+0001d760: 6875 6e6b 732c 206e 616d 653d 6e61 6d65  hunks, name=name
+0001d770: 2c20 696e 6c69 6e65 5f61 7272 6179 3d69  , inline_array=i
+0001d780: 6e6c 696e 655f 6172 7261 7929 0a0a 0a64  nline_array)...d
+0001d790: 6566 2074 6f5f 7a61 7272 280a 2020 2020  ef to_zarr(.    
+0001d7a0: 6172 722c 0a20 2020 2075 726c 2c0a 2020  arr,.    url,.  
+0001d7b0: 2020 636f 6d70 6f6e 656e 743d 4e6f 6e65    component=None
+0001d7c0: 2c0a 2020 2020 7374 6f72 6167 655f 6f70  ,.    storage_op
+0001d7d0: 7469 6f6e 733d 4e6f 6e65 2c0a 2020 2020  tions=None,.    
+0001d7e0: 6f76 6572 7772 6974 653d 4661 6c73 652c  overwrite=False,
+0001d7f0: 0a20 2020 2072 6567 696f 6e3d 4e6f 6e65  .    region=None
+0001d800: 2c0a 2020 2020 636f 6d70 7574 653d 5472  ,.    compute=Tr
+0001d810: 7565 2c0a 2020 2020 7265 7475 726e 5f73  ue,.    return_s
+0001d820: 746f 7265 643d 4661 6c73 652c 0a20 2020  tored=False,.   
+0001d830: 202a 2a6b 7761 7267 732c 0a29 3a0a 2020   **kwargs,.):.  
+0001d840: 2020 2222 2253 6176 6520 6172 7261 7920    """Save array 
+0001d850: 746f 2074 6865 207a 6172 7220 7374 6f72  to the zarr stor
+0001d860: 6167 6520 666f 726d 6174 0a0a 2020 2020  age format..    
+0001d870: 5365 6520 6874 7470 733a 2f2f 7a61 7272  See https://zarr
+0001d880: 2e72 6561 6474 6865 646f 6373 2e69 6f20  .readthedocs.io 
+0001d890: 666f 7220 6465 7461 696c 7320 6162 6f75  for details abou
+0001d8a0: 7420 7468 6520 666f 726d 6174 2e0a 0a20  t the format... 
+0001d8b0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0001d8c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0001d8d0: 2061 7272 3a20 6461 736b 2e61 7272 6179   arr: dask.array
+0001d8e0: 0a20 2020 2020 2020 2044 6174 6120 746f  .        Data to
+0001d8f0: 2073 746f 7265 0a20 2020 2075 726c 3a20   store.    url: 
+0001d900: 5a61 7272 2041 7272 6179 206f 7220 7374  Zarr Array or st
+0001d910: 7220 6f72 204d 7574 6162 6c65 4d61 7070  r or MutableMapp
+0001d920: 696e 670a 2020 2020 2020 2020 4c6f 6361  ing.        Loca
+0001d930: 7469 6f6e 206f 6620 7468 6520 6461 7461  tion of the data
+0001d940: 2e20 4120 5552 4c20 6361 6e20 696e 636c  . A URL can incl
+0001d950: 7564 6520 6120 7072 6f74 6f63 6f6c 2073  ude a protocol s
+0001d960: 7065 6369 6669 6572 206c 696b 6520 7333  pecifier like s3
+0001d970: 3a2f 2f0a 2020 2020 2020 2020 666f 7220  ://.        for 
+0001d980: 7265 6d6f 7465 2064 6174 612e 2043 616e  remote data. Can
+0001d990: 2061 6c73 6f20 6265 2061 6e79 204d 7574   also be any Mut
+0001d9a0: 6162 6c65 4d61 7070 696e 6720 696e 7374  ableMapping inst
+0001d9b0: 616e 6365 2c20 7768 6963 6820 7368 6f75  ance, which shou
+0001d9c0: 6c64 0a20 2020 2020 2020 2062 6520 7365  ld.        be se
+0001d9d0: 7269 616c 697a 6162 6c65 2069 6620 7573  rializable if us
+0001d9e0: 6564 2069 6e20 6d75 6c74 6970 6c65 2070  ed in multiple p
+0001d9f0: 726f 6365 7373 6573 2e0a 2020 2020 636f  rocesses..    co
+0001da00: 6d70 6f6e 656e 743a 2073 7472 206f 7220  mponent: str or 
+0001da10: 4e6f 6e65 0a20 2020 2020 2020 2049 6620  None.        If 
+0001da20: 7468 6520 6c6f 6361 7469 6f6e 2069 7320  the location is 
+0001da30: 6120 7a61 7272 2067 726f 7570 2072 6174  a zarr group rat
+0001da40: 6865 7220 7468 616e 2061 6e20 6172 7261  her than an arra
+0001da50: 792c 2074 6869 7320 6973 2074 6865 0a20  y, this is the. 
+0001da60: 2020 2020 2020 2073 7562 636f 6d70 6f6e         subcompon
+0001da70: 656e 7420 7468 6174 2073 686f 756c 6420  ent that should 
+0001da80: 6265 2063 7265 6174 6564 2f6f 7665 722d  be created/over-
+0001da90: 7772 6974 7465 6e2e 0a20 2020 2073 746f  written..    sto
+0001daa0: 7261 6765 5f6f 7074 696f 6e73 3a20 6469  rage_options: di
+0001dab0: 6374 0a20 2020 2020 2020 2041 6e79 2061  ct.        Any a
+0001dac0: 6464 6974 696f 6e61 6c20 7061 7261 6d65  dditional parame
+0001dad0: 7465 7273 2066 6f72 2074 6865 2073 746f  ters for the sto
+0001dae0: 7261 6765 2062 6163 6b65 6e64 2028 6967  rage backend (ig
+0001daf0: 6e6f 7265 6420 666f 7220 6c6f 6361 6c0a  nored for local.
+0001db00: 2020 2020 2020 2020 7061 7468 7329 0a20          paths). 
+0001db10: 2020 206f 7665 7277 7269 7465 3a20 626f     overwrite: bo
+0001db20: 6f6c 0a20 2020 2020 2020 2049 6620 6769  ol.        If gi
+0001db30: 7665 6e20 6172 7261 7920 616c 7265 6164  ven array alread
+0001db40: 7920 6578 6973 7473 2c20 6f76 6572 7772  y exists, overwr
+0001db50: 6974 653d 4661 6c73 6520 7769 6c6c 2063  ite=False will c
+0001db60: 6175 7365 2061 6e20 6572 726f 722c 0a20  ause an error,. 
+0001db70: 2020 2020 2020 2077 6865 7265 206f 7665         where ove
+0001db80: 7277 7269 7465 3d54 7275 6520 7769 6c6c  rwrite=True will
+0001db90: 2072 6570 6c61 6365 2074 6865 2065 7869   replace the exi
+0001dba0: 7374 696e 6720 6461 7461 2e0a 2020 2020  sting data..    
+0001dbb0: 7265 6769 6f6e 3a20 7475 706c 6520 6f66  region: tuple of
+0001dbc0: 2073 6c69 6365 7320 6f72 204e 6f6e 650a   slices or None.
+0001dbd0: 2020 2020 2020 2020 5468 6520 7265 6769          The regi
+0001dbe0: 6f6e 206f 6620 6461 7461 2074 6861 7420  on of data that 
+0001dbf0: 7368 6f75 6c64 2062 6520 7772 6974 7465  should be writte
+0001dc00: 6e20 6966 2060 6075 726c 6060 2069 7320  n if ``url`` is 
+0001dc10: 6120 7a61 7272 2e41 7272 6179 2e0a 2020  a zarr.Array..  
+0001dc20: 2020 2020 2020 4e6f 7420 746f 2062 6520        Not to be 
+0001dc30: 7573 6564 2077 6974 6820 6f74 6865 7220  used with other 
+0001dc40: 7479 7065 7320 6f66 2060 6075 726c 6060  types of ``url``
+0001dc50: 2e0a 2020 2020 636f 6d70 7574 653a 2062  ..    compute: b
+0001dc60: 6f6f 6c0a 2020 2020 2020 2020 5365 6520  ool.        See 
+0001dc70: 3a66 756e 633a 607e 6461 736b 2e61 7272  :func:`~dask.arr
+0001dc80: 6179 2e73 746f 7265 6020 666f 7220 6d6f  ay.store` for mo
+0001dc90: 7265 2064 6574 6169 6c73 2e0a 2020 2020  re details..    
+0001dca0: 7265 7475 726e 5f73 746f 7265 643a 2062  return_stored: b
+0001dcb0: 6f6f 6c0a 2020 2020 2020 2020 5365 6520  ool.        See 
+0001dcc0: 3a66 756e 633a 607e 6461 736b 2e61 7272  :func:`~dask.arr
+0001dcd0: 6179 2e73 746f 7265 6020 666f 7220 6d6f  ay.store` for mo
+0001dce0: 7265 2064 6574 6169 6c73 2e0a 2020 2020  re details..    
+0001dcf0: 2a2a 6b77 6172 6773 3a0a 2020 2020 2020  **kwargs:.      
+0001dd00: 2020 5061 7373 6564 2074 6f20 7468 6520    Passed to the 
+0001dd10: 3a66 756e 633a 607a 6172 722e 6372 6561  :func:`zarr.crea
+0001dd20: 7469 6f6e 2e63 7265 6174 6560 2066 756e  tion.create` fun
+0001dd30: 6374 696f 6e2c 2065 2e67 2e2c 2063 6f6d  ction, e.g., com
+0001dd40: 7072 6573 7369 6f6e 206f 7074 696f 6e73  pression options
+0001dd50: 2e0a 0a20 2020 2052 6169 7365 730a 2020  ...    Raises.  
+0001dd60: 2020 2d2d 2d2d 2d2d 0a20 2020 2056 616c    ------.    Val
+0001dd70: 7565 4572 726f 720a 2020 2020 2020 2020  ueError.        
+0001dd80: 4966 2060 6061 7272 6060 2068 6173 2075  If ``arr`` has u
+0001dd90: 6e6b 6e6f 776e 2063 6875 6e6b 2073 697a  nknown chunk siz
+0001dda0: 6573 2c20 7768 6963 6820 6973 206e 6f74  es, which is not
+0001ddb0: 2073 7570 706f 7274 6564 2062 7920 5a61   supported by Za
+0001ddc0: 7272 2e0a 2020 2020 2020 2020 4966 2060  rr..        If `
+0001ddd0: 6072 6567 696f 6e60 6020 6973 2073 7065  `region`` is spe
+0001dde0: 6369 6669 6564 2061 6e64 2060 6075 726c  cified and ``url
+0001ddf0: 6060 2069 7320 6e6f 7420 6120 7a61 7272  `` is not a zarr
+0001de00: 2e41 7272 6179 0a0a 2020 2020 5365 6520  .Array..    See 
+0001de10: 416c 736f 0a20 2020 202d 2d2d 2d2d 2d2d  Also.    -------
+0001de20: 2d0a 2020 2020 6461 736b 2e61 7272 6179  -.    dask.array
+0001de30: 2e73 746f 7265 0a20 2020 2064 6173 6b2e  .store.    dask.
+0001de40: 6172 7261 792e 4172 7261 792e 636f 6d70  array.Array.comp
+0001de50: 7574 655f 6368 756e 6b5f 7369 7a65 730a  ute_chunk_sizes.
+0001de60: 0a20 2020 2022 2222 0a20 2020 2069 6d70  .    """.    imp
+0001de70: 6f72 7420 7a61 7272 0a0a 2020 2020 6966  ort zarr..    if
+0001de80: 206e 702e 6973 6e61 6e28 6172 722e 7368   np.isnan(arr.sh
+0001de90: 6170 6529 2e61 6e79 2829 3a0a 2020 2020  ape).any():.    
+0001dea0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001deb0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0001dec0: 2020 2253 6176 696e 6720 6120 6461 736b    "Saving a dask
+0001ded0: 2061 7272 6179 2077 6974 6820 756e 6b6e   array with unkn
+0001dee0: 6f77 6e20 6368 756e 6b20 7369 7a65 7320  own chunk sizes 
+0001def0: 6973 206e 6f74 2022 0a20 2020 2020 2020  is not ".       
+0001df00: 2020 2020 2022 6375 7272 656e 746c 7920       "currently 
+0001df10: 7375 7070 6f72 7465 6420 6279 205a 6172  supported by Zar
+0001df20: 722e 2573 2220 2520 756e 6b6e 6f77 6e5f  r.%s" % unknown_
+0001df30: 6368 756e 6b5f 6d65 7373 6167 650a 2020  chunk_message.  
+0001df40: 2020 2020 2020 290a 0a20 2020 2069 6620        )..    if 
+0001df50: 6973 696e 7374 616e 6365 2875 726c 2c20  isinstance(url, 
+0001df60: 7a61 7272 2e41 7272 6179 293a 0a20 2020  zarr.Array):.   
+0001df70: 2020 2020 207a 203d 2075 726c 0a20 2020       z = url.   
+0001df80: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0001df90: 6365 287a 2e73 746f 7265 2c20 2864 6963  ce(z.store, (dic
+0001dfa0: 742c 204d 7574 6162 6c65 4d61 7070 696e  t, MutableMappin
+0001dfb0: 6729 293a 0a20 2020 2020 2020 2020 2020  g)):.           
+0001dfc0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0001dfd0: 2020 2020 2020 6672 6f6d 2064 6973 7472        from distr
+0001dfe0: 6962 7574 6564 2069 6d70 6f72 7420 6465  ibuted import de
+0001dff0: 6661 756c 745f 636c 6965 6e74 0a0a 2020  fault_client..  
+0001e000: 2020 2020 2020 2020 2020 2020 2020 6465                de
+0001e010: 6661 756c 745f 636c 6965 6e74 2829 0a20  fault_client(). 
+0001e020: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0001e030: 7420 2849 6d70 6f72 7445 7272 6f72 2c20  t (ImportError, 
+0001e040: 5661 6c75 6545 7272 6f72 293a 0a20 2020  ValueError):.   
+0001e050: 2020 2020 2020 2020 2020 2020 2070 6173               pas
+0001e060: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
+0001e070: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001e080: 2020 2020 7261 6973 6520 5275 6e74 696d      raise Runtim
+0001e090: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0001e0a0: 2020 2020 2020 2020 2020 2020 2243 616e              "Can
+0001e0b0: 6e6f 7420 7374 6f72 6520 696e 746f 2069  not store into i
+0001e0c0: 6e20 6d65 6d6f 7279 205a 6172 7220 4172  n memory Zarr Ar
+0001e0d0: 7261 7920 7573 696e 6720 220a 2020 2020  ray using ".    
+0001e0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e0f0: 2274 6865 2064 6973 7472 6962 7574 6564  "the distributed
+0001e100: 2073 6368 6564 756c 6572 2e22 0a20 2020   scheduler.".   
+0001e110: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0001e120: 2020 2020 2020 2020 6966 2072 6567 696f          if regio
+0001e130: 6e20 6973 204e 6f6e 653a 0a20 2020 2020  n is None:.     
+0001e140: 2020 2020 2020 2061 7272 203d 2061 7272         arr = arr
+0001e150: 2e72 6563 6875 6e6b 287a 2e63 6875 6e6b  .rechunk(z.chunk
+0001e160: 7329 0a20 2020 2020 2020 2020 2020 2072  s).            r
+0001e170: 6567 696f 6e73 203d 204e 6f6e 650a 2020  egions = None.  
+0001e180: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001e190: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+0001e1a0: 6b2e 6172 7261 792e 736c 6963 696e 6720  k.array.slicing 
+0001e1b0: 696d 706f 7274 206e 6577 5f62 6c6f 636b  import new_block
+0001e1c0: 6469 6d2c 206e 6f72 6d61 6c69 7a65 5f69  dim, normalize_i
+0001e1d0: 6e64 6578 0a0a 2020 2020 2020 2020 2020  ndex..          
+0001e1e0: 2020 6f6c 645f 6368 756e 6b73 203d 206e    old_chunks = n
+0001e1f0: 6f72 6d61 6c69 7a65 5f63 6875 6e6b 7328  ormalize_chunks(
+0001e200: 7a2e 6368 756e 6b73 2c20 7a2e 7368 6170  z.chunks, z.shap
+0001e210: 6529 0a20 2020 2020 2020 2020 2020 2069  e).            i
+0001e220: 6e64 6578 203d 206e 6f72 6d61 6c69 7a65  ndex = normalize
+0001e230: 5f69 6e64 6578 2872 6567 696f 6e2c 207a  _index(region, z
+0001e240: 2e73 6861 7065 290a 2020 2020 2020 2020  .shape).        
+0001e250: 2020 2020 6368 756e 6b73 203d 2074 7570      chunks = tup
+0001e260: 6c65 280a 2020 2020 2020 2020 2020 2020  le(.            
+0001e270: 2020 2020 7475 706c 6528 6e65 775f 626c      tuple(new_bl
+0001e280: 6f63 6b64 696d 2873 2c20 632c 2072 2929  ockdim(s, c, r))
+0001e290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e2a0: 2066 6f72 2073 2c20 632c 2072 2069 6e20   for s, c, r in 
+0001e2b0: 7a69 7028 7a2e 7368 6170 652c 206f 6c64  zip(z.shape, old
+0001e2c0: 5f63 6875 6e6b 732c 2069 6e64 6578 290a  _chunks, index).
+0001e2d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001e2e0: 2020 2020 2020 2020 2020 6172 7220 3d20            arr = 
+0001e2f0: 6172 722e 7265 6368 756e 6b28 6368 756e  arr.rechunk(chun
+0001e300: 6b73 290a 2020 2020 2020 2020 2020 2020  ks).            
+0001e310: 7265 6769 6f6e 7320 3d20 5b72 6567 696f  regions = [regio
+0001e320: 6e5d 0a20 2020 2020 2020 2072 6574 7572  n].        retur
+0001e330: 6e20 6172 722e 7374 6f72 6528 0a20 2020  n arr.store(.   
+0001e340: 2020 2020 2020 2020 207a 2c20 6c6f 636b           z, lock
+0001e350: 3d46 616c 7365 2c20 7265 6769 6f6e 733d  =False, regions=
+0001e360: 7265 6769 6f6e 732c 2063 6f6d 7075 7465  regions, compute
+0001e370: 3d63 6f6d 7075 7465 2c20 7265 7475 726e  =compute, return
+0001e380: 5f73 746f 7265 643d 7265 7475 726e 5f73  _stored=return_s
+0001e390: 746f 7265 640a 2020 2020 2020 2020 290a  tored.        ).
+0001e3a0: 0a20 2020 2069 6620 7265 6769 6f6e 2069  .    if region i
+0001e3b0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0001e3c0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001e3d0: 7272 6f72 2822 4361 6e6e 6f74 2075 7365  rror("Cannot use
+0001e3e0: 2060 7265 6769 6f6e 6020 6b65 7977 6f72   `region` keywor
+0001e3f0: 6420 7768 656e 2075 726c 2069 7320 6e6f  d when url is no
+0001e400: 7420 6120 607a 6172 722e 4172 7261 7960  t a `zarr.Array`
+0001e410: 2e22 290a 0a20 2020 2069 6620 6e6f 7420  .")..    if not 
+0001e420: 5f63 6865 636b 5f72 6567 756c 6172 5f63  _check_regular_c
+0001e430: 6875 6e6b 7328 6172 722e 6368 756e 6b73  hunks(arr.chunks
+0001e440: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+0001e450: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0001e460: 2020 2020 2020 2020 2022 4174 7465 6d70           "Attemp
+0001e470: 7420 746f 2073 6176 6520 6172 7261 7920  t to save array 
+0001e480: 746f 207a 6172 7220 7769 7468 2069 7272  to zarr with irr
+0001e490: 6567 756c 6172 2022 0a20 2020 2020 2020  egular ".       
+0001e4a0: 2020 2020 2022 6368 756e 6b69 6e67 2c20       "chunking, 
+0001e4b0: 706c 6561 7365 2063 616c 6c20 6061 7272  please call `arr
+0001e4c0: 2e72 6563 6875 6e6b 282e 2e2e 2960 2066  .rechunk(...)` f
+0001e4d0: 6972 7374 2e22 0a20 2020 2020 2020 2029  irst.".        )
+0001e4e0: 0a0a 2020 2020 7374 6f72 6167 655f 6f70  ..    storage_op
+0001e4f0: 7469 6f6e 7320 3d20 7374 6f72 6167 655f  tions = storage_
+0001e500: 6f70 7469 6f6e 7320 6f72 207b 7d0a 0a20  options or {}.. 
+0001e510: 2020 2069 6620 7374 6f72 6167 655f 6f70     if storage_op
+0001e520: 7469 6f6e 733a 0a20 2020 2020 2020 2073  tions:.        s
+0001e530: 746f 7265 203d 207a 6172 722e 7374 6f72  tore = zarr.stor
+0001e540: 6167 652e 4653 5374 6f72 6528 7572 6c2c  age.FSStore(url,
+0001e550: 202a 2a73 746f 7261 6765 5f6f 7074 696f   **storage_optio
+0001e560: 6e73 290a 2020 2020 656c 7365 3a0a 2020  ns).    else:.  
+0001e570: 2020 2020 2020 7374 6f72 6520 3d20 7572        store = ur
+0001e580: 6c0a 0a20 2020 2063 6875 6e6b 7320 3d20  l..    chunks = 
+0001e590: 5b63 5b30 5d20 666f 7220 6320 696e 2061  [c[0] for c in a
+0001e5a0: 7272 2e63 6875 6e6b 735d 0a0a 2020 2020  rr.chunks]..    
+0001e5b0: 7a20 3d20 7a61 7272 2e63 7265 6174 6528  z = zarr.create(
+0001e5c0: 0a20 2020 2020 2020 2073 6861 7065 3d61  .        shape=a
+0001e5d0: 7272 2e73 6861 7065 2c0a 2020 2020 2020  rr.shape,.      
+0001e5e0: 2020 6368 756e 6b73 3d63 6875 6e6b 732c    chunks=chunks,
+0001e5f0: 0a20 2020 2020 2020 2064 7479 7065 3d61  .        dtype=a
+0001e600: 7272 2e64 7479 7065 2c0a 2020 2020 2020  rr.dtype,.      
+0001e610: 2020 7374 6f72 653d 7374 6f72 652c 0a20    store=store,. 
+0001e620: 2020 2020 2020 2070 6174 683d 636f 6d70         path=comp
+0001e630: 6f6e 656e 742c 0a20 2020 2020 2020 206f  onent,.        o
+0001e640: 7665 7277 7269 7465 3d6f 7665 7277 7269  verwrite=overwri
+0001e650: 7465 2c0a 2020 2020 2020 2020 2a2a 6b77  te,.        **kw
+0001e660: 6172 6773 2c0a 2020 2020 290a 2020 2020  args,.    ).    
+0001e670: 7265 7475 726e 2061 7272 2e73 746f 7265  return arr.store
+0001e680: 287a 2c20 6c6f 636b 3d46 616c 7365 2c20  (z, lock=False, 
+0001e690: 636f 6d70 7574 653d 636f 6d70 7574 652c  compute=compute,
+0001e6a0: 2072 6574 7572 6e5f 7374 6f72 6564 3d72   return_stored=r
+0001e6b0: 6574 7572 6e5f 7374 6f72 6564 290a 0a0a  eturn_stored)...
+0001e6c0: 6465 6620 5f63 6865 636b 5f72 6567 756c  def _check_regul
+0001e6d0: 6172 5f63 6875 6e6b 7328 6368 756e 6b73  ar_chunks(chunks
+0001e6e0: 6574 293a 0a20 2020 2022 2222 4368 6563  et):.    """Chec
+0001e6f0: 6b20 6966 2074 6865 2063 6875 6e6b 7320  k if the chunks 
+0001e700: 6172 6520 7265 6775 6c61 720a 0a20 2020  are regular..   
+0001e710: 2022 5265 6775 6c61 7222 2069 6e20 7468   "Regular" in th
+0001e720: 6973 2063 6f6e 7465 7874 206d 6561 6e73  is context means
+0001e730: 2074 6861 7420 616c 6f6e 6720 6576 6572   that along ever
+0001e740: 7920 6178 6973 2c20 7468 6520 6368 756e  y axis, the chun
+0001e750: 6b73 2061 6c6c 0a20 2020 2068 6176 6520  ks all.    have 
+0001e760: 7468 6520 7361 6d65 2073 697a 652c 2065  the same size, e
+0001e770: 7863 6570 7420 7468 6520 6c61 7374 206f  xcept the last o
+0001e780: 6e65 2c20 7768 6963 6820 6d61 7920 6265  ne, which may be
+0001e790: 2073 6d61 6c6c 6572 0a0a 2020 2020 5061   smaller..    Pa
+0001e7a0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+0001e7b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6368 756e  -------.    chun
+0001e7c0: 6b73 6574 3a20 7475 706c 6520 6f66 2074  kset: tuple of t
+0001e7d0: 7570 6c65 7320 6f66 2069 6e74 730a 2020  uples of ints.  
+0001e7e0: 2020 2020 2020 4672 6f6d 2074 6865 2060        From the `
+0001e7f0: 602e 6368 756e 6b73 6060 2061 7474 7269  `.chunks`` attri
+0001e800: 6275 7465 206f 6620 616e 2060 6041 7272  bute of an ``Arr
+0001e810: 6179 6060 0a0a 2020 2020 5265 7475 726e  ay``..    Return
+0001e820: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+0001e830: 2020 5472 7565 2069 6620 6368 756e 6b73    True if chunks
+0001e840: 6574 2070 6173 7365 732c 2065 6c73 6520  et passes, else 
+0001e850: 4661 6c73 650a 0a20 2020 2045 7861 6d70  False..    Examp
+0001e860: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
+0001e870: 0a20 2020 203e 3e3e 2069 6d70 6f72 7420  .    >>> import 
+0001e880: 6461 736b 2e61 7272 6179 2061 7320 6461  dask.array as da
+0001e890: 0a20 2020 203e 3e3e 2061 7272 203d 2064  .    >>> arr = d
+0001e8a0: 612e 7a65 726f 7328 3130 2c20 6368 756e  a.zeros(10, chun
+0001e8b0: 6b73 3d28 352c 2029 290a 2020 2020 3e3e  ks=(5, )).    >>
+0001e8c0: 3e20 5f63 6865 636b 5f72 6567 756c 6172  > _check_regular
+0001e8d0: 5f63 6875 6e6b 7328 6172 722e 6368 756e  _chunks(arr.chun
+0001e8e0: 6b73 290a 2020 2020 5472 7565 0a0a 2020  ks).    True..  
+0001e8f0: 2020 3e3e 3e20 6172 7220 3d20 6461 2e7a    >>> arr = da.z
+0001e900: 6572 6f73 2831 302c 2063 6875 6e6b 733d  eros(10, chunks=
+0001e910: 2828 332c 2033 2c20 332c 2031 292c 2029  ((3, 3, 3, 1), )
+0001e920: 290a 2020 2020 3e3e 3e20 5f63 6865 636b  ).    >>> _check
+0001e930: 5f72 6567 756c 6172 5f63 6875 6e6b 7328  _regular_chunks(
+0001e940: 6172 722e 6368 756e 6b73 290a 2020 2020  arr.chunks).    
+0001e950: 5472 7565 0a0a 2020 2020 3e3e 3e20 6172  True..    >>> ar
+0001e960: 7220 3d20 6461 2e7a 6572 6f73 2831 302c  r = da.zeros(10,
+0001e970: 2063 6875 6e6b 733d 2828 332c 2031 2c20   chunks=((3, 1, 
+0001e980: 332c 2033 292c 2029 290a 2020 2020 3e3e  3, 3), )).    >>
+0001e990: 3e20 5f63 6865 636b 5f72 6567 756c 6172  > _check_regular
+0001e9a0: 5f63 6875 6e6b 7328 6172 722e 6368 756e  _chunks(arr.chun
+0001e9b0: 6b73 290a 2020 2020 4661 6c73 650a 2020  ks).    False.  
+0001e9c0: 2020 2222 220a 2020 2020 666f 7220 6368    """.    for ch
+0001e9d0: 756e 6b73 2069 6e20 6368 756e 6b73 6574  unks in chunkset
+0001e9e0: 3a0a 2020 2020 2020 2020 6966 206c 656e  :.        if len
+0001e9f0: 2863 6875 6e6b 7329 203d 3d20 313a 0a20  (chunks) == 1:. 
+0001ea00: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+0001ea10: 6e75 650a 2020 2020 2020 2020 6966 206c  nue.        if l
+0001ea20: 656e 2873 6574 2863 6875 6e6b 735b 3a2d  en(set(chunks[:-
+0001ea30: 315d 2929 203e 2031 3a0a 2020 2020 2020  1])) > 1:.      
+0001ea40: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+0001ea50: 7365 0a20 2020 2020 2020 2069 6620 6368  se.        if ch
+0001ea60: 756e 6b73 5b2d 315d 203e 2063 6875 6e6b  unks[-1] > chunk
+0001ea70: 735b 305d 3a0a 2020 2020 2020 2020 2020  s[0]:.          
+0001ea80: 2020 7265 7475 726e 2046 616c 7365 0a20    return False. 
+0001ea90: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
+0001eaa0: 0a64 6566 2066 726f 6d5f 6465 6c61 7965  .def from_delaye
+0001eab0: 6428 7661 6c75 652c 2073 6861 7065 2c20  d(value, shape, 
+0001eac0: 6474 7970 653d 4e6f 6e65 2c20 6d65 7461  dtype=None, meta
+0001ead0: 3d4e 6f6e 652c 206e 616d 653d 4e6f 6e65  =None, name=None
+0001eae0: 293a 0a20 2020 2022 2222 4372 6561 7465  ):.    """Create
+0001eaf0: 2061 2064 6173 6b20 6172 7261 7920 6672   a dask array fr
+0001eb00: 6f6d 2061 2064 6173 6b20 6465 6c61 7965  om a dask delaye
+0001eb10: 6420 7661 6c75 650a 0a20 2020 2054 6869  d value..    Thi
+0001eb20: 7320 726f 7574 696e 6520 6973 2075 7365  s routine is use
+0001eb30: 6675 6c20 666f 7220 636f 6e73 7472 7563  ful for construc
+0001eb40: 7469 6e67 2064 6173 6b20 6172 7261 7973  ting dask arrays
+0001eb50: 2069 6e20 616e 2061 642d 686f 6320 6661   in an ad-hoc fa
+0001eb60: 7368 696f 6e0a 2020 2020 7573 696e 6720  shion.    using 
+0001eb70: 6461 736b 2064 656c 6179 6564 2c20 7061  dask delayed, pa
+0001eb80: 7274 6963 756c 6172 6c79 2077 6865 6e20  rticularly when 
+0001eb90: 636f 6d62 696e 6564 2077 6974 6820 7374  combined with st
+0001eba0: 6163 6b20 616e 6420 636f 6e63 6174 656e  ack and concaten
+0001ebb0: 6174 652e 0a0a 2020 2020 5468 6520 6461  ate...    The da
+0001ebc0: 736b 2061 7272 6179 2077 696c 6c20 636f  sk array will co
+0001ebd0: 6e73 6973 7420 6f66 2061 2073 696e 676c  nsist of a singl
+0001ebe0: 6520 6368 756e 6b2e 0a0a 2020 2020 4578  e chunk...    Ex
+0001ebf0: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
+0001ec00: 2d2d 2d0a 2020 2020 3e3e 3e20 696d 706f  ---.    >>> impo
+0001ec10: 7274 2064 6173 6b0a 2020 2020 3e3e 3e20  rt dask.    >>> 
+0001ec20: 696d 706f 7274 2064 6173 6b2e 6172 7261  import dask.arra
+0001ec30: 7920 6173 2064 610a 2020 2020 3e3e 3e20  y as da.    >>> 
+0001ec40: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
+0001ec50: 6e70 0a20 2020 203e 3e3e 2076 616c 7565  np.    >>> value
+0001ec60: 203d 2064 6173 6b2e 6465 6c61 7965 6428   = dask.delayed(
+0001ec70: 6e70 2e6f 6e65 7329 2835 290a 2020 2020  np.ones)(5).    
+0001ec80: 3e3e 3e20 6172 7261 7920 3d20 6461 2e66  >>> array = da.f
+0001ec90: 726f 6d5f 6465 6c61 7965 6428 7661 6c75  rom_delayed(valu
+0001eca0: 652c 2028 352c 292c 2064 7479 7065 3d66  e, (5,), dtype=f
+0001ecb0: 6c6f 6174 290a 2020 2020 3e3e 3e20 6172  loat).    >>> ar
+0001ecc0: 7261 790a 2020 2020 6461 736b 2e61 7272  ray.    dask.arr
+0001ecd0: 6179 3c66 726f 6d2d 7661 6c75 652c 2073  ay<from-value, s
+0001ece0: 6861 7065 3d28 352c 292c 2064 7479 7065  hape=(5,), dtype
+0001ecf0: 3d66 6c6f 6174 3634 2c20 6368 756e 6b73  =float64, chunks
+0001ed00: 697a 653d 2835 2c29 2c20 6368 756e 6b74  ize=(5,), chunkt
+0001ed10: 7970 653d 6e75 6d70 792e 6e64 6172 7261  ype=numpy.ndarra
+0001ed20: 793e 0a20 2020 203e 3e3e 2061 7272 6179  y>.    >>> array
+0001ed30: 2e63 6f6d 7075 7465 2829 0a20 2020 2061  .compute().    a
+0001ed40: 7272 6179 285b 312e 2c20 312e 2c20 312e  rray([1., 1., 1.
+0001ed50: 2c20 312e 2c20 312e 5d29 0a20 2020 2022  , 1., 1.]).    "
+0001ed60: 2222 0a20 2020 2066 726f 6d20 6461 736b  "".    from dask
+0001ed70: 2e64 656c 6179 6564 2069 6d70 6f72 7420  .delayed import 
+0001ed80: 4465 6c61 7965 642c 2064 656c 6179 6564  Delayed, delayed
+0001ed90: 0a0a 2020 2020 6966 206e 6f74 2069 7369  ..    if not isi
+0001eda0: 6e73 7461 6e63 6528 7661 6c75 652c 2044  nstance(value, D
+0001edb0: 656c 6179 6564 2920 616e 6420 6861 7361  elayed) and hasa
+0001edc0: 7474 7228 7661 6c75 652c 2022 6b65 7922  ttr(value, "key"
+0001edd0: 293a 0a20 2020 2020 2020 2076 616c 7565  ):.        value
+0001ede0: 203d 2064 656c 6179 6564 2876 616c 7565   = delayed(value
+0001edf0: 290a 0a20 2020 206e 616d 6520 3d20 6e61  )..    name = na
+0001ee00: 6d65 206f 7220 2266 726f 6d2d 7661 6c75  me or "from-valu
+0001ee10: 652d 2220 2b20 746f 6b65 6e69 7a65 2876  e-" + tokenize(v
+0001ee20: 616c 7565 2c20 7368 6170 652c 2064 7479  alue, shape, dty
+0001ee30: 7065 2c20 6d65 7461 290a 2020 2020 6473  pe, meta).    ds
+0001ee40: 6b20 3d20 7b28 6e61 6d65 2c29 202b 2028  k = {(name,) + (
+0001ee50: 302c 2920 2a20 6c65 6e28 7368 6170 6529  0,) * len(shape)
+0001ee60: 3a20 7661 6c75 652e 6b65 797d 0a20 2020  : value.key}.   
+0001ee70: 2063 6875 6e6b 7320 3d20 7475 706c 6528   chunks = tuple(
+0001ee80: 2864 2c29 2066 6f72 2064 2069 6e20 7368  (d,) for d in sh
+0001ee90: 6170 6529 0a20 2020 2023 2054 4f44 4f3a  ape).    # TODO:
+0001eea0: 2076 616c 7565 2e5f 6b65 7920 6d61 7920   value._key may 
+0001eeb0: 6e6f 7420 6265 2074 6865 206e 616d 6520  not be the name 
+0001eec0: 6f66 2074 6865 206c 6179 6572 2069 6e20  of the layer in 
+0001eed0: 7661 6c75 652e 6461 736b 0a20 2020 2023  value.dask.    #
+0001eee0: 2054 6869 7320 7368 6f75 6c64 2062 6520   This should be 
+0001eef0: 6669 7865 6420 6166 7465 7220 7765 2062  fixed after we b
+0001ef00: 7569 6c64 2066 756c 6c20 6578 7072 6573  uild full expres
+0001ef10: 7369 6f6e 2067 7261 7068 730a 2020 2020  sion graphs.    
+0001ef20: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
+0001ef30: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
+0001ef40: 6563 7469 6f6e 7328 6e61 6d65 2c20 6473  ections(name, ds
+0001ef50: 6b2c 2064 6570 656e 6465 6e63 6965 733d  k, dependencies=
+0001ef60: 5b76 616c 7565 5d29 0a20 2020 2072 6574  [value]).    ret
+0001ef70: 7572 6e20 4172 7261 7928 6772 6170 682c  urn Array(graph,
+0001ef80: 206e 616d 652c 2063 6875 6e6b 732c 2064   name, chunks, d
+0001ef90: 7479 7065 3d64 7479 7065 2c20 6d65 7461  type=dtype, meta
+0001efa0: 3d6d 6574 6129 0a0a 0a64 6566 2066 726f  =meta)...def fro
+0001efb0: 6d5f 6675 6e63 2866 756e 632c 2073 6861  m_func(func, sha
+0001efc0: 7065 2c20 6474 7970 653d 4e6f 6e65 2c20  pe, dtype=None, 
+0001efd0: 6e61 6d65 3d4e 6f6e 652c 2061 7267 733d  name=None, args=
+0001efe0: 2829 2c20 6b77 6172 6773 3d4e 6f6e 6529  (), kwargs=None)
+0001eff0: 3a0a 2020 2020 2222 2243 7265 6174 6520  :.    """Create 
+0001f000: 6461 736b 2061 7272 6179 2069 6e20 6120  dask array in a 
+0001f010: 7369 6e67 6c65 2062 6c6f 636b 2062 7920  single block by 
+0001f020: 6361 6c6c 696e 6720 6120 6675 6e63 7469  calling a functi
+0001f030: 6f6e 0a0a 2020 2020 4361 6c6c 696e 6720  on..    Calling 
+0001f040: 7468 6520 7072 6f76 6964 6564 2066 756e  the provided fun
+0001f050: 6374 696f 6e20 7769 7468 2066 756e 6328  ction with func(
+0001f060: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+0001f070: 2073 686f 756c 6420 7265 7475 726e 2061   should return a
+0001f080: 0a20 2020 204e 756d 5079 2061 7272 6179  .    NumPy array
+0001f090: 206f 6620 7468 6520 696e 6469 6361 7465   of the indicate
+0001f0a0: 6420 7368 6170 6520 616e 6420 6474 7970  d shape and dtyp
+0001f0b0: 652e 0a0a 2020 2020 4578 616d 706c 6573  e...    Examples
+0001f0c0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20  .    --------.. 
+0001f0d0: 2020 203e 3e3e 2061 203d 2066 726f 6d5f     >>> a = from_
+0001f0e0: 6675 6e63 286e 702e 6172 616e 6765 2c20  func(np.arange, 
+0001f0f0: 2833 2c29 2c20 6474 7970 653d 2769 3827  (3,), dtype='i8'
+0001f100: 2c20 6172 6773 3d28 332c 2929 0a20 2020  , args=(3,)).   
+0001f110: 203e 3e3e 2061 2e63 6f6d 7075 7465 2829   >>> a.compute()
+0001f120: 0a20 2020 2061 7272 6179 285b 302c 2031  .    array([0, 1
+0001f130: 2c20 325d 290a 0a20 2020 2054 6869 7320  , 2])..    This 
+0001f140: 776f 726b 7320 7061 7274 6963 756c 6172  works particular
+0001f150: 6c79 2077 656c 6c20 7768 656e 2063 6f75  ly well when cou
+0001f160: 706c 6564 2077 6974 6820 6461 736b 2e61  pled with dask.a
+0001f170: 7272 6179 2066 756e 6374 696f 6e73 206c  rray functions l
+0001f180: 696b 650a 2020 2020 636f 6e63 6174 656e  ike.    concaten
+0001f190: 6174 6520 616e 6420 7374 6163 6b3a 0a0a  ate and stack:..
+0001f1a0: 2020 2020 3e3e 3e20 6172 7261 7973 203d      >>> arrays =
+0001f1b0: 205b 6672 6f6d 5f66 756e 6328 6e70 2e61   [from_func(np.a
+0001f1c0: 7272 6179 2c20 2829 2c20 6474 7970 653d  rray, (), dtype=
+0001f1d0: 2769 3827 2c20 6172 6773 3d28 6e2c 2929  'i8', args=(n,))
+0001f1e0: 2066 6f72 206e 2069 6e20 7261 6e67 6528   for n in range(
+0001f1f0: 3529 5d0a 2020 2020 3e3e 3e20 7374 6163  5)].    >>> stac
+0001f200: 6b28 6172 7261 7973 292e 636f 6d70 7574  k(arrays).comput
+0001f210: 6528 290a 2020 2020 6172 7261 7928 5b30  e().    array([0
+0001f220: 2c20 312c 2032 2c20 332c 2034 5d29 0a20  , 1, 2, 3, 4]). 
+0001f230: 2020 2022 2222 0a20 2020 2069 6620 6b77     """.    if kw
+0001f240: 6172 6773 2069 7320 4e6f 6e65 3a0a 2020  args is None:.  
+0001f250: 2020 2020 2020 6b77 6172 6773 203d 207b        kwargs = {
+0001f260: 7d0a 0a20 2020 206e 616d 6520 3d20 6e61  }..    name = na
+0001f270: 6d65 206f 7220 2266 726f 6d5f 6675 6e63  me or "from_func
+0001f280: 2d22 202b 2074 6f6b 656e 697a 6528 6675  -" + tokenize(fu
+0001f290: 6e63 2c20 7368 6170 652c 2064 7479 7065  nc, shape, dtype
+0001f2a0: 2c20 6172 6773 2c20 6b77 6172 6773 290a  , args, kwargs).
+0001f2b0: 2020 2020 6966 2061 7267 7320 6f72 206b      if args or k
+0001f2c0: 7761 7267 733a 0a20 2020 2020 2020 2066  wargs:.        f
+0001f2d0: 756e 6320 3d20 7061 7274 6961 6c28 6675  unc = partial(fu
+0001f2e0: 6e63 2c20 2a61 7267 732c 202a 2a6b 7761  nc, *args, **kwa
+0001f2f0: 7267 7329 0a20 2020 2064 736b 203d 207b  rgs).    dsk = {
+0001f300: 286e 616d 652c 2920 2b20 2830 2c29 202a  (name,) + (0,) *
+0001f310: 206c 656e 2873 6861 7065 293a 2028 6675   len(shape): (fu
+0001f320: 6e63 2c29 7d0a 2020 2020 6368 756e 6b73  nc,)}.    chunks
+0001f330: 203d 2074 7570 6c65 2828 692c 2920 666f   = tuple((i,) fo
+0001f340: 7220 6920 696e 2073 6861 7065 290a 2020  r i in shape).  
+0001f350: 2020 7265 7475 726e 2041 7272 6179 2864    return Array(d
+0001f360: 736b 2c20 6e61 6d65 2c20 6368 756e 6b73  sk, name, chunks
+0001f370: 2c20 6474 7970 6529 0a0a 0a64 6566 2063  , dtype)...def c
+0001f380: 6f6d 6d6f 6e5f 626c 6f63 6b64 696d 2862  ommon_blockdim(b
+0001f390: 6c6f 636b 6469 6d73 293a 0a20 2020 2022  lockdims):.    "
+0001f3a0: 2222 4669 6e64 2074 6865 2063 6f6d 6d6f  ""Find the commo
+0001f3b0: 6e20 626c 6f63 6b20 6469 6d65 6e73 696f  n block dimensio
+0001f3c0: 6e73 2066 726f 6d20 7468 6520 6c69 7374  ns from the list
+0001f3d0: 206f 6620 626c 6f63 6b20 6469 6d65 6e73   of block dimens
+0001f3e0: 696f 6e73 0a0a 2020 2020 4375 7272 656e  ions..    Curren
+0001f3f0: 746c 7920 6f6e 6c79 2069 6d70 6c65 6d65  tly only impleme
+0001f400: 6e74 7320 7468 6520 7369 6d70 6c65 7374  nts the simplest
+0001f410: 2070 6f73 7369 626c 6520 6865 7572 6973   possible heuris
+0001f420: 7469 633a 2074 6865 2063 6f6d 6d6f 6e0a  tic: the common.
+0001f430: 2020 2020 626c 6f63 6b2d 6469 6d65 6e73      block-dimens
+0001f440: 696f 6e20 6973 2074 6865 206f 6e6c 7920  ion is the only 
+0001f450: 6f6e 6520 7468 6174 2064 6f65 7320 6e6f  one that does no
+0001f460: 7420 7370 616e 2066 756c 6c79 2073 7061  t span fully spa
+0001f470: 6e20 6120 6469 6d65 6e73 696f 6e2e 0a20  n a dimension.. 
+0001f480: 2020 2054 6869 7320 6973 2061 2063 6f6e     This is a con
+0001f490: 7365 7276 6174 6976 6520 6368 6f69 6365  servative choice
+0001f4a0: 2074 6861 7420 616c 6c6f 7773 2075 7320   that allows us 
+0001f4b0: 746f 2061 766f 6964 2070 6f74 656e 7469  to avoid potenti
+0001f4c0: 616c 6c79 2076 6572 790a 2020 2020 6578  ally very.    ex
+0001f4d0: 7065 6e73 6976 6520 7265 6368 756e 6b69  pensive rechunki
+0001f4e0: 6e67 2e0a 0a20 2020 2041 7373 756d 6573  ng...    Assumes
+0001f4f0: 2074 6861 7420 6561 6368 2065 6c65 6d65   that each eleme
+0001f500: 6e74 206f 6620 7468 6520 696e 7075 7420  nt of the input 
+0001f510: 626c 6f63 6b20 6469 6d65 6e73 696f 6e73  block dimensions
+0001f520: 2068 6173 2061 6c6c 2074 6865 2073 616d   has all the sam
+0001f530: 650a 2020 2020 7375 6d20 2869 2e65 2e2c  e.    sum (i.e.,
+0001f540: 2074 6861 7420 7468 6579 2063 6f72 7265   that they corre
+0001f550: 7370 6f6e 6420 746f 2064 696d 656e 7369  spond to dimensi
+0001f560: 6f6e 7320 6f66 2074 6865 2073 616d 6520  ons of the same 
+0001f570: 7369 7a65 292e 0a0a 2020 2020 4578 616d  size)...    Exam
+0001f580: 706c 6573 0a20 2020 202d 2d2d 2d2d 2d2d  ples.    -------
+0001f590: 2d0a 2020 2020 3e3e 3e20 636f 6d6d 6f6e  -.    >>> common
+0001f5a0: 5f62 6c6f 636b 6469 6d28 5b28 332c 292c  _blockdim([(3,),
+0001f5b0: 2028 322c 2031 295d 290a 2020 2020 2832   (2, 1)]).    (2
+0001f5c0: 2c20 3129 0a20 2020 203e 3e3e 2063 6f6d  , 1).    >>> com
+0001f5d0: 6d6f 6e5f 626c 6f63 6b64 696d 285b 2831  mon_blockdim([(1
+0001f5e0: 2c20 3229 2c20 2832 2c20 3129 5d29 0a20  , 2), (2, 1)]). 
+0001f5f0: 2020 2028 312c 2031 2c20 3129 0a20 2020     (1, 1, 1).   
+0001f600: 203e 3e3e 2063 6f6d 6d6f 6e5f 626c 6f63   >>> common_bloc
+0001f610: 6b64 696d 285b 2832 2c20 3229 2c20 2833  kdim([(2, 2), (3
+0001f620: 2c20 3129 5d29 2020 2320 646f 6374 6573  , 1)])  # doctes
+0001f630: 743a 202b 534b 4950 0a20 2020 2054 7261  t: +SKIP.    Tra
+0001f640: 6365 6261 636b 2028 6d6f 7374 2072 6563  ceback (most rec
+0001f650: 656e 7420 6361 6c6c 206c 6173 7429 3a0a  ent call last):.
+0001f660: 2020 2020 2020 2020 2e2e 2e0a 2020 2020          ....    
+0001f670: 5661 6c75 6545 7272 6f72 3a20 4368 756e  ValueError: Chun
+0001f680: 6b73 2064 6f20 6e6f 7420 616c 6967 6e0a  ks do not align.
+0001f690: 2020 2020 2222 220a 2020 2020 6966 206e      """.    if n
+0001f6a0: 6f74 2061 6e79 2862 6c6f 636b 6469 6d73  ot any(blockdims
+0001f6b0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0001f6c0: 6e20 2829 0a20 2020 206e 6f6e 5f74 7269  n ().    non_tri
+0001f6d0: 7669 616c 5f64 696d 7320 3d20 7b64 2066  vial_dims = {d f
+0001f6e0: 6f72 2064 2069 6e20 626c 6f63 6b64 696d  or d in blockdim
+0001f6f0: 7320 6966 206c 656e 2864 2920 3e20 317d  s if len(d) > 1}
+0001f700: 0a20 2020 2069 6620 6c65 6e28 6e6f 6e5f  .    if len(non_
+0001f710: 7472 6976 6961 6c5f 6469 6d73 2920 3d3d  trivial_dims) ==
+0001f720: 2031 3a0a 2020 2020 2020 2020 7265 7475   1:.        retu
+0001f730: 726e 2066 6972 7374 286e 6f6e 5f74 7269  rn first(non_tri
+0001f740: 7669 616c 5f64 696d 7329 0a20 2020 2069  vial_dims).    i
+0001f750: 6620 6c65 6e28 6e6f 6e5f 7472 6976 6961  f len(non_trivia
+0001f760: 6c5f 6469 6d73 2920 3d3d 2030 3a0a 2020  l_dims) == 0:.  
+0001f770: 2020 2020 2020 7265 7475 726e 206d 6178        return max
+0001f780: 2862 6c6f 636b 6469 6d73 2c20 6b65 793d  (blockdims, key=
+0001f790: 6669 7273 7429 0a0a 2020 2020 6966 206e  first)..    if n
+0001f7a0: 702e 6973 6e61 6e28 7375 6d28 6d61 7028  p.isnan(sum(map(
+0001f7b0: 7375 6d2c 2062 6c6f 636b 6469 6d73 2929  sum, blockdims))
+0001f7c0: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+0001f7d0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0001f7e0: 2020 2020 2020 2020 2022 4172 7261 7973           "Arrays
+0001f7f0: 2720 6368 756e 6b20 7369 7a65 7320 2825  ' chunk sizes (%
+0001f800: 7329 2061 7265 2075 6e6b 6e6f 776e 2e5c  s) are unknown.\
+0001f810: 6e5c 6e22 0a20 2020 2020 2020 2020 2020  n\n".           
+0001f820: 2022 4120 706f 7373 6962 6c65 2073 6f6c   "A possible sol
+0001f830: 7574 696f 6e3a 5c6e 220a 2020 2020 2020  ution:\n".      
+0001f840: 2020 2020 2020 2220 2078 2e63 6f6d 7075        "  x.compu
+0001f850: 7465 5f63 6875 6e6b 5f73 697a 6573 2829  te_chunk_sizes()
+0001f860: 2220 2520 626c 6f63 6b64 696d 730a 2020  " % blockdims.  
+0001f870: 2020 2020 2020 290a 0a20 2020 2069 6620        )..    if 
+0001f880: 6c65 6e28 7365 7428 6d61 7028 7375 6d2c  len(set(map(sum,
+0001f890: 206e 6f6e 5f74 7269 7669 616c 5f64 696d   non_trivial_dim
+0001f8a0: 7329 2929 203e 2031 3a0a 2020 2020 2020  s))) > 1:.      
+0001f8b0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0001f8c0: 6f72 2822 4368 756e 6b73 2064 6f20 6e6f  or("Chunks do no
+0001f8d0: 7420 6164 6420 7570 2074 6f20 7361 6d65  t add up to same
+0001f8e0: 2076 616c 7565 222c 2062 6c6f 636b 6469   value", blockdi
+0001f8f0: 6d73 290a 0a20 2020 2023 2057 6520 6861  ms)..    # We ha
+0001f900: 7665 206d 756c 7469 706c 6520 6e6f 6e2d  ve multiple non-
+0001f910: 7472 6976 6961 6c20 6368 756e 6b73 206f  trivial chunks o
+0001f920: 6e20 7468 6973 2061 7869 730a 2020 2020  n this axis.    
+0001f930: 2320 652e 672e 2028 352c 2032 2920 616e  # e.g. (5, 2) an
+0001f940: 6420 2834 2c20 3329 0a0a 2020 2020 2320  d (4, 3)..    # 
+0001f950: 5765 2063 7265 6174 6520 6120 7369 6e67  We create a sing
+0001f960: 6c65 2063 6875 6e6b 2074 7570 6c65 2077  le chunk tuple w
+0001f970: 6974 6820 7468 6520 7361 6d65 2074 6f74  ith the same tot
+0001f980: 616c 206c 656e 6774 680a 2020 2020 2320  al length.    # 
+0001f990: 7468 6174 2065 7665 6e6c 7920 6469 7669  that evenly divi
+0001f9a0: 6465 7320 626f 7468 2c20 652e 672e 2028  des both, e.g. (
+0001f9b0: 342c 2031 2c20 3229 0a0a 2020 2020 2320  4, 1, 2)..    # 
+0001f9c0: 546f 2061 6363 6f6d 706c 6973 6820 7468  To accomplish th
+0001f9d0: 6973 2077 6520 7761 6c6b 2064 6f77 6e20  is we walk down 
+0001f9e0: 616c 6c20 6368 756e 6b20 7475 706c 6573  all chunk tuples
+0001f9f0: 2074 6f67 6574 6865 722c 2066 696e 6469   together, findi
+0001fa00: 6e67 2074 6865 0a20 2020 2023 2073 6d61  ng the.    # sma
+0001fa10: 6c6c 6573 7420 656c 656d 656e 742c 2061  llest element, a
+0001fa20: 6464 696e 6720 6974 2074 6f20 7468 6520  dding it to the 
+0001fa30: 6f75 7470 7574 2c20 616e 6420 7375 6274  output, and subt
+0001fa40: 7261 6374 696e 6720 6974 2066 726f 6d20  racting it from 
+0001fa50: 616c 6c0a 2020 2020 2320 6f74 6865 7220  all.    # other 
+0001fa60: 656c 656d 656e 7473 2061 6e64 2072 656d  elements and rem
+0001fa70: 6f76 6520 7468 6520 656c 656d 656e 7420  ove the element 
+0001fa80: 6974 7365 6c66 2e20 2057 6520 7374 6f70  itself.  We stop
+0001fa90: 206f 6e63 6520 7765 2068 6176 650a 2020   once we have.  
+0001faa0: 2020 2320 6275 726e 6564 2074 6872 6f75    # burned throu
+0001fab0: 6768 2061 6c6c 206f 6620 7468 6520 6368  gh all of the ch
+0001fac0: 756e 6b20 7475 706c 6573 2e0a 2020 2020  unk tuples..    
+0001fad0: 2320 466f 7220 6566 6669 6369 656e 6379  # For efficiency
+0001fae0: 2773 2073 616b 6520 7765 2072 6576 6572  's sake we rever
+0001faf0: 7365 2074 6865 206c 6973 7473 2073 6f20  se the lists so 
+0001fb00: 7468 6174 2077 6520 6361 6e20 706f 7020  that we can pop 
+0001fb10: 6f66 6620 7468 6520 656e 640a 2020 2020  off the end.    
+0001fb20: 7263 6875 6e6b 7320 3d20 5b6c 6973 7428  rchunks = [list(
+0001fb30: 6e74 6429 5b3a 3a2d 315d 2066 6f72 206e  ntd)[::-1] for n
+0001fb40: 7464 2069 6e20 6e6f 6e5f 7472 6976 6961  td in non_trivia
+0001fb50: 6c5f 6469 6d73 5d0a 2020 2020 746f 7461  l_dims].    tota
+0001fb60: 6c20 3d20 7375 6d28 6669 7273 7428 6e6f  l = sum(first(no
+0001fb70: 6e5f 7472 6976 6961 6c5f 6469 6d73 2929  n_trivial_dims))
+0001fb80: 0a20 2020 2069 203d 2030 0a0a 2020 2020  .    i = 0..    
+0001fb90: 6f75 7420 3d20 5b5d 0a20 2020 2077 6869  out = [].    whi
+0001fba0: 6c65 2069 203c 2074 6f74 616c 3a0a 2020  le i < total:.  
+0001fbb0: 2020 2020 2020 6d20 3d20 6d69 6e28 635b        m = min(c[
+0001fbc0: 2d31 5d20 666f 7220 6320 696e 2072 6368  -1] for c in rch
+0001fbd0: 756e 6b73 290a 2020 2020 2020 2020 6f75  unks).        ou
+0001fbe0: 742e 6170 7065 6e64 286d 290a 2020 2020  t.append(m).    
+0001fbf0: 2020 2020 666f 7220 6320 696e 2072 6368      for c in rch
+0001fc00: 756e 6b73 3a0a 2020 2020 2020 2020 2020  unks:.          
+0001fc10: 2020 635b 2d31 5d20 2d3d 206d 0a20 2020    c[-1] -= m.   
+0001fc20: 2020 2020 2020 2020 2069 6620 635b 2d31           if c[-1
+0001fc30: 5d20 3d3d 2030 3a0a 2020 2020 2020 2020  ] == 0:.        
+0001fc40: 2020 2020 2020 2020 632e 706f 7028 290a          c.pop().
+0001fc50: 2020 2020 2020 2020 6920 2b3d 206d 0a0a          i += m..
+0001fc60: 2020 2020 7265 7475 726e 2074 7570 6c65      return tuple
+0001fc70: 286f 7574 290a 0a0a 6465 6620 756e 6966  (out)...def unif
+0001fc80: 795f 6368 756e 6b73 282a 6172 6773 2c20  y_chunks(*args, 
+0001fc90: 2a2a 6b77 6172 6773 293a 0a20 2020 2022  **kwargs):.    "
+0001fca0: 2222 0a20 2020 2055 6e69 6679 2063 6875  "".    Unify chu
+0001fcb0: 6e6b 7320 6163 726f 7373 2061 2073 6571  nks across a seq
+0001fcc0: 7565 6e63 6520 6f66 2061 7272 6179 730a  uence of arrays.
+0001fcd0: 0a20 2020 2054 6869 7320 7574 696c 6974  .    This utilit
+0001fce0: 7920 6675 6e63 7469 6f6e 2069 7320 7573  y function is us
+0001fcf0: 6564 2077 6974 6869 6e20 6f74 6865 7220  ed within other 
+0001fd00: 636f 6d6d 6f6e 206f 7065 7261 7469 6f6e  common operation
+0001fd10: 7320 6c69 6b65 0a20 2020 203a 6675 6e63  s like.    :func
+0001fd20: 3a60 6461 736b 2e61 7272 6179 2e63 6f72  :`dask.array.cor
+0001fd30: 652e 6d61 705f 626c 6f63 6b73 6020 616e  e.map_blocks` an
+0001fd40: 6420 3a66 756e 633a 6064 6173 6b2e 6172  d :func:`dask.ar
+0001fd50: 7261 792e 636f 7265 2e62 6c6f 636b 7769  ray.core.blockwi
+0001fd60: 7365 602e 0a20 2020 2049 7420 6973 206e  se`..    It is n
+0001fd70: 6f74 2063 6f6d 6d6f 6e6c 7920 7573 6564  ot commonly used
+0001fd80: 2062 7920 656e 642d 7573 6572 7320 6469   by end-users di
+0001fd90: 7265 6374 6c79 2e0a 0a20 2020 2050 6172  rectly...    Par
+0001fda0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+0001fdb0: 2d2d 2d2d 2d2d 0a20 2020 202a 6172 6773  ------.    *args
+0001fdc0: 3a20 7365 7175 656e 6365 206f 6620 4172  : sequence of Ar
+0001fdd0: 7261 792c 2069 6e64 6578 2070 6169 7273  ray, index pairs
+0001fde0: 0a20 2020 2020 2020 2053 6571 7565 6e63  .        Sequenc
+0001fdf0: 6520 6c69 6b65 2028 782c 2027 696a 272c  e like (x, 'ij',
+0001fe00: 2079 2c20 276a 6b27 2c20 7a2c 2027 6927   y, 'jk', z, 'i'
+0001fe10: 290a 0a20 2020 2045 7861 6d70 6c65 730a  )..    Examples.
+0001fe20: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+0001fe30: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
+0001fe40: 2e61 7272 6179 2061 7320 6461 0a20 2020  .array as da.   
+0001fe50: 203e 3e3e 2078 203d 2064 612e 6f6e 6573   >>> x = da.ones
+0001fe60: 2831 302c 2063 6875 6e6b 733d 2828 352c  (10, chunks=((5,
+0001fe70: 2032 2c20 3329 2c29 290a 2020 2020 3e3e   2, 3),)).    >>
+0001fe80: 3e20 7920 3d20 6461 2e6f 6e65 7328 3130  > y = da.ones(10
+0001fe90: 2c20 6368 756e 6b73 3d28 2832 2c20 332c  , chunks=((2, 3,
+0001fea0: 2035 292c 2929 0a20 2020 203e 3e3e 2063   5),)).    >>> c
+0001feb0: 6875 6e6b 7373 2c20 6172 7261 7973 203d  hunkss, arrays =
+0001fec0: 2075 6e69 6679 5f63 6875 6e6b 7328 782c   unify_chunks(x,
+0001fed0: 2027 6927 2c20 792c 2027 6927 290a 2020   'i', y, 'i').  
+0001fee0: 2020 3e3e 3e20 6368 756e 6b73 730a 2020    >>> chunkss.  
+0001fef0: 2020 7b27 6927 3a20 2832 2c20 332c 2032    {'i': (2, 3, 2
+0001ff00: 2c20 3329 7d0a 0a20 2020 203e 3e3e 2078  , 3)}..    >>> x
+0001ff10: 203d 2064 612e 6f6e 6573 2828 3130 302c   = da.ones((100,
+0001ff20: 2031 3029 2c20 6368 756e 6b73 3d28 3230   10), chunks=(20
+0001ff30: 2c20 3529 290a 2020 2020 3e3e 3e20 7920  , 5)).    >>> y 
+0001ff40: 3d20 6461 2e6f 6e65 7328 2831 302c 2031  = da.ones((10, 1
+0001ff50: 3030 292c 2063 6875 6e6b 733d 2834 2c20  00), chunks=(4, 
+0001ff60: 3530 2929 0a20 2020 203e 3e3e 2063 6875  50)).    >>> chu
+0001ff70: 6e6b 7373 2c20 6172 7261 7973 203d 2075  nkss, arrays = u
+0001ff80: 6e69 6679 5f63 6875 6e6b 7328 782c 2027  nify_chunks(x, '
+0001ff90: 696a 272c 2079 2c20 276a 6b27 2c20 2763  ij', y, 'jk', 'c
+0001ffa0: 6f6e 7374 616e 7427 2c20 4e6f 6e65 290a  onstant', None).
+0001ffb0: 2020 2020 3e3e 3e20 6368 756e 6b73 7320      >>> chunkss 
+0001ffc0: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+0001ffd0: 500a 2020 2020 7b27 6b27 3a20 2835 302c  P.    {'k': (50,
+0001ffe0: 2035 3029 2c20 2769 273a 2028 3230 2c20   50), 'i': (20, 
+0001fff0: 3230 2c20 3230 2c20 3230 2c20 3230 292c  20, 20, 20, 20),
+00020000: 2027 6a27 3a20 2834 2c20 312c 2033 2c20   'j': (4, 1, 3, 
+00020010: 3229 7d0a 0a20 2020 203e 3e3e 2075 6e69  2)}..    >>> uni
+00020020: 6679 5f63 6875 6e6b 7328 302c 204e 6f6e  fy_chunks(0, Non
+00020030: 6529 0a20 2020 2028 7b7d 2c20 5b30 5d29  e).    ({}, [0])
+00020040: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+00020050: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6368    -------.    ch
+00020060: 756e 6b73 7320 3a20 6469 6374 0a20 2020  unkss : dict.   
+00020070: 2020 2020 204d 6170 206c 696b 6520 7b69       Map like {i
+00020080: 6e64 6578 3a20 6368 756e 6b73 7d2e 0a20  ndex: chunks}.. 
+00020090: 2020 2061 7272 6179 7320 3a20 6c69 7374     arrays : list
+000200a0: 0a20 2020 2020 2020 204c 6973 7420 6f66  .        List of
+000200b0: 2072 6563 6875 6e6b 6564 2061 7272 6179   rechunked array
+000200c0: 732e 0a0a 2020 2020 5365 6520 416c 736f  s...    See Also
+000200d0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
+000200e0: 2020 636f 6d6d 6f6e 5f62 6c6f 636b 6469    common_blockdi
+000200f0: 6d0a 2020 2020 2222 220a 2020 2020 6966  m.    """.    if
+00020100: 206e 6f74 2061 7267 733a 0a20 2020 2020   not args:.     
+00020110: 2020 2072 6574 7572 6e20 7b7d 2c20 5b5d     return {}, []
+00020120: 0a0a 2020 2020 6172 6769 6e64 7320 3d20  ..    arginds = 
+00020130: 5b0a 2020 2020 2020 2020 2861 7361 6e79  [.        (asany
+00020140: 6172 7261 7928 6129 2069 6620 696e 6420  array(a) if ind 
+00020150: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
+00020160: 2061 2c20 696e 6429 2066 6f72 2061 2c20   a, ind) for a, 
+00020170: 696e 6420 696e 2070 6172 7469 7469 6f6e  ind in partition
+00020180: 2832 2c20 6172 6773 290a 2020 2020 5d20  (2, args).    ] 
+00020190: 2023 205b 782c 2069 6a2c 2079 2c20 6a6b   # [x, ij, y, jk
+000201a0: 5d0a 2020 2020 7761 726e 203d 206b 7761  ].    warn = kwa
+000201b0: 7267 732e 6765 7428 2277 6172 6e22 2c20  rgs.get("warn", 
+000201c0: 5472 7565 290a 0a20 2020 2061 7272 6179  True)..    array
+000201d0: 732c 2069 6e64 7320 3d20 7a69 7028 2a61  s, inds = zip(*a
+000201e0: 7267 696e 6473 290a 2020 2020 6966 2061  rginds).    if a
+000201f0: 6c6c 2869 6e64 2069 7320 4e6f 6e65 2066  ll(ind is None f
+00020200: 6f72 2069 6e64 2069 6e20 696e 6473 293a  or ind in inds):
+00020210: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00020220: 7b7d 2c20 6c69 7374 2861 7272 6179 7329  {}, list(arrays)
+00020230: 0a20 2020 2069 6620 616c 6c28 696e 6420  .    if all(ind 
+00020240: 3d3d 2069 6e64 735b 305d 2066 6f72 2069  == inds[0] for i
+00020250: 6e64 2069 6e20 696e 6473 2920 616e 6420  nd in inds) and 
+00020260: 616c 6c28 0a20 2020 2020 2020 2061 2e63  all(.        a.c
+00020270: 6875 6e6b 7320 3d3d 2061 7272 6179 735b  hunks == arrays[
+00020280: 305d 2e63 6875 6e6b 7320 666f 7220 6120  0].chunks for a 
+00020290: 696e 2061 7272 6179 730a 2020 2020 293a  in arrays.    ):
+000202a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000202b0: 6469 6374 287a 6970 2869 6e64 735b 305d  dict(zip(inds[0]
+000202c0: 2c20 6172 7261 7973 5b30 5d2e 6368 756e  , arrays[0].chun
+000202d0: 6b73 2929 2c20 6172 7261 7973 0a0a 2020  ks)), arrays..  
+000202e0: 2020 6e61 6d65 696e 6473 203d 205b 5d0a    nameinds = [].
+000202f0: 2020 2020 626c 6f63 6b64 696d 5f64 6963      blockdim_dic
+00020300: 7420 3d20 6469 6374 2829 0a20 2020 206d  t = dict().    m
+00020310: 6178 5f70 6172 7473 203d 2030 0a20 2020  ax_parts = 0.   
+00020320: 2066 6f72 2061 2c20 696e 6420 696e 2061   for a, ind in a
+00020330: 7267 696e 6473 3a0a 2020 2020 2020 2020  rginds:.        
+00020340: 6966 2069 6e64 2069 7320 6e6f 7420 4e6f  if ind is not No
+00020350: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00020360: 6e61 6d65 696e 6473 2e61 7070 656e 6428  nameinds.append(
+00020370: 2861 2e6e 616d 652c 2069 6e64 2929 0a20  (a.name, ind)). 
+00020380: 2020 2020 2020 2020 2020 2062 6c6f 636b             block
+00020390: 6469 6d5f 6469 6374 5b61 2e6e 616d 655d  dim_dict[a.name]
+000203a0: 203d 2061 2e63 6875 6e6b 730a 2020 2020   = a.chunks.    
+000203b0: 2020 2020 2020 2020 6d61 785f 7061 7274          max_part
+000203c0: 7320 3d20 6d61 7828 6d61 785f 7061 7274  s = max(max_part
+000203d0: 732c 2061 2e6e 7061 7274 6974 696f 6e73  s, a.npartitions
+000203e0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+000203f0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00020400: 696e 6473 2e61 7070 656e 6428 2861 2c20  inds.append((a, 
+00020410: 696e 6429 290a 0a20 2020 2063 6875 6e6b  ind))..    chunk
+00020420: 7373 203d 2062 726f 6164 6361 7374 5f64  ss = broadcast_d
+00020430: 696d 656e 7369 6f6e 7328 6e61 6d65 696e  imensions(namein
+00020440: 6473 2c20 626c 6f63 6b64 696d 5f64 6963  ds, blockdim_dic
+00020450: 742c 2063 6f6e 736f 6c69 6461 7465 3d63  t, consolidate=c
+00020460: 6f6d 6d6f 6e5f 626c 6f63 6b64 696d 290a  ommon_blockdim).
+00020470: 2020 2020 6e70 6172 7473 203d 206d 6174      nparts = mat
+00020480: 682e 7072 6f64 286d 6170 286c 656e 2c20  h.prod(map(len, 
+00020490: 6368 756e 6b73 732e 7661 6c75 6573 2829  chunkss.values()
+000204a0: 2929 0a0a 2020 2020 6966 2077 6172 6e20  ))..    if warn 
+000204b0: 616e 6420 6e70 6172 7473 2061 6e64 206e  and nparts and n
+000204c0: 7061 7274 7320 3e3d 206d 6178 5f70 6172  parts >= max_par
+000204d0: 7473 202a 2031 303a 0a20 2020 2020 2020  ts * 10:.       
+000204e0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
+000204f0: 2020 2020 2020 2020 2020 2020 2249 6e63              "Inc
+00020500: 7265 6173 696e 6720 6e75 6d62 6572 206f  reasing number o
+00020510: 6620 6368 756e 6b73 2062 7920 6661 6374  f chunks by fact
+00020520: 6f72 206f 6620 2564 2220 2520 286e 7061  or of %d" % (npa
+00020530: 7274 7320 2f20 6d61 785f 7061 7274 7329  rts / max_parts)
+00020540: 2c0a 2020 2020 2020 2020 2020 2020 5065  ,.            Pe
+00020550: 7266 6f72 6d61 6e63 6557 6172 6e69 6e67  rformanceWarning
+00020560: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+00020570: 6163 6b6c 6576 656c 3d33 2c0a 2020 2020  acklevel=3,.    
+00020580: 2020 2020 290a 0a20 2020 2061 7272 6179      )..    array
+00020590: 7320 3d20 5b5d 0a20 2020 2066 6f72 2061  s = [].    for a
+000205a0: 2c20 6920 696e 2061 7267 696e 6473 3a0a  , i in arginds:.
+000205b0: 2020 2020 2020 2020 6966 2069 2069 7320          if i is 
+000205c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000205d0: 2020 6172 7261 7973 2e61 7070 656e 6428    arrays.append(
+000205e0: 6129 0a20 2020 2020 2020 2065 6c73 653a  a).        else:
+000205f0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+00020600: 6e6b 7320 3d20 7475 706c 6528 0a20 2020  nks = tuple(.   
+00020610: 2020 2020 2020 2020 2020 2020 2063 6875               chu
+00020620: 6e6b 7373 5b6a 5d0a 2020 2020 2020 2020  nkss[j].        
+00020630: 2020 2020 2020 2020 6966 2061 2e73 6861          if a.sha
+00020640: 7065 5b6e 5d20 3e20 310a 2020 2020 2020  pe[n] > 1.      
+00020650: 2020 2020 2020 2020 2020 656c 7365 2061            else a
+00020660: 2e73 6861 7065 5b6e 5d0a 2020 2020 2020  .shape[n].      
+00020670: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00020680: 206e 702e 6973 6e61 6e28 7375 6d28 6368   np.isnan(sum(ch
+00020690: 756e 6b73 735b 6a5d 2929 0a20 2020 2020  unkss[j])).     
+000206a0: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+000206b0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+000206c0: 2020 2020 2066 6f72 206e 2c20 6a20 696e       for n, j in
+000206d0: 2065 6e75 6d65 7261 7465 2869 290a 2020   enumerate(i).  
+000206e0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000206f0: 2020 2020 2020 2020 6966 2063 6875 6e6b          if chunk
+00020700: 7320 213d 2061 2e63 6875 6e6b 7320 616e  s != a.chunks an
+00020710: 6420 616c 6c28 612e 6368 756e 6b73 293a  d all(a.chunks):
+00020720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020730: 2061 7272 6179 732e 6170 7065 6e64 2861   arrays.append(a
+00020740: 2e72 6563 6875 6e6b 2863 6875 6e6b 7329  .rechunk(chunks)
+00020750: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00020760: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00020770: 2020 2020 6172 7261 7973 2e61 7070 656e      arrays.appen
+00020780: 6428 6129 0a20 2020 2072 6574 7572 6e20  d(a).    return 
+00020790: 6368 756e 6b73 732c 2061 7272 6179 730a  chunkss, arrays.
+000207a0: 0a0a 6465 6620 756e 7061 636b 5f73 696e  ..def unpack_sin
+000207b0: 676c 6574 6f6e 2878 293a 0a20 2020 2022  gleton(x):.    "
+000207c0: 2222 0a0a 2020 2020 3e3e 3e20 756e 7061  ""..    >>> unpa
+000207d0: 636b 5f73 696e 676c 6574 6f6e 285b 5b5b  ck_singleton([[[
+000207e0: 5b31 5d5d 5d5d 290a 2020 2020 310a 2020  [1]]]]).    1.  
+000207f0: 2020 3e3e 3e20 756e 7061 636b 5f73 696e    >>> unpack_sin
+00020800: 676c 6574 6f6e 286e 702e 6172 7261 7928  gleton(np.array(
+00020810: 6e70 2e64 6174 6574 696d 6536 3428 2732  np.datetime64('2
+00020820: 3030 302d 3031 2d30 3127 2929 290a 2020  000-01-01'))).  
+00020830: 2020 6172 7261 7928 2732 3030 302d 3031    array('2000-01
+00020840: 2d30 3127 2c20 6474 7970 653d 2764 6174  -01', dtype='dat
+00020850: 6574 696d 6536 345b 445d 2729 0a20 2020  etime64[D]').   
+00020860: 2022 2222 0a20 2020 2077 6869 6c65 2069   """.    while i
+00020870: 7369 6e73 7461 6e63 6528 782c 2028 6c69  sinstance(x, (li
+00020880: 7374 2c20 7475 706c 6529 293a 0a20 2020  st, tuple)):.   
+00020890: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+000208a0: 2020 2020 2020 7820 3d20 785b 305d 0a20        x = x[0]. 
+000208b0: 2020 2020 2020 2065 7863 6570 7420 2849         except (I
+000208c0: 6e64 6578 4572 726f 722c 2054 7970 6545  ndexError, TypeE
+000208d0: 7272 6f72 2c20 4b65 7945 7272 6f72 293a  rror, KeyError):
+000208e0: 0a20 2020 2020 2020 2020 2020 2062 7265  .            bre
+000208f0: 616b 0a20 2020 2072 6574 7572 6e20 780a  ak.    return x.
+00020900: 0a0a 6465 6620 626c 6f63 6b28 6172 7261  ..def block(arra
+00020910: 7973 2c20 616c 6c6f 775f 756e 6b6e 6f77  ys, allow_unknow
+00020920: 6e5f 6368 756e 6b73 697a 6573 3d46 616c  n_chunksizes=Fal
+00020930: 7365 293a 0a20 2020 2022 2222 0a20 2020  se):.    """.   
+00020940: 2041 7373 656d 626c 6520 616e 206e 642d   Assemble an nd-
+00020950: 6172 7261 7920 6672 6f6d 206e 6573 7465  array from neste
+00020960: 6420 6c69 7374 7320 6f66 2062 6c6f 636b  d lists of block
+00020970: 732e 0a0a 2020 2020 426c 6f63 6b73 2069  s...    Blocks i
+00020980: 6e20 7468 6520 696e 6e65 726d 6f73 7420  n the innermost 
+00020990: 6c69 7374 7320 6172 6520 636f 6e63 6174  lists are concat
+000209a0: 656e 6174 6564 2061 6c6f 6e67 2074 6865  enated along the
+000209b0: 206c 6173 740a 2020 2020 6469 6d65 6e73   last.    dimens
+000209c0: 696f 6e20 282d 3129 2c20 7468 656e 2074  ion (-1), then t
+000209d0: 6865 7365 2061 7265 2063 6f6e 6361 7465  hese are concate
+000209e0: 6e61 7465 6420 616c 6f6e 6720 7468 6520  nated along the 
+000209f0: 7365 636f 6e64 2d6c 6173 740a 2020 2020  second-last.    
+00020a00: 6469 6d65 6e73 696f 6e20 282d 3229 2c20  dimension (-2), 
+00020a10: 616e 6420 736f 206f 6e20 756e 7469 6c20  and so on until 
+00020a20: 7468 6520 6f75 7465 726d 6f73 7420 6c69  the outermost li
+00020a30: 7374 2069 7320 7265 6163 6865 640a 0a20  st is reached.. 
+00020a40: 2020 2042 6c6f 636b 7320 6361 6e20 6265     Blocks can be
+00020a50: 206f 6620 616e 7920 6469 6d65 6e73 696f   of any dimensio
+00020a60: 6e2c 2062 7574 2077 696c 6c20 6e6f 7420  n, but will not 
+00020a70: 6265 2062 726f 6164 6361 7374 6564 2075  be broadcasted u
+00020a80: 7369 6e67 2074 6865 206e 6f72 6d61 6c0a  sing the normal.
+00020a90: 2020 2020 7275 6c65 732e 2049 6e73 7465      rules. Inste
+00020aa0: 6164 2c20 6c65 6164 696e 6720 6178 6573  ad, leading axes
+00020ab0: 206f 6620 7369 7a65 2031 2061 7265 2069   of size 1 are i
+00020ac0: 6e73 6572 7465 642c 2074 6f20 6d61 6b65  nserted, to make
+00020ad0: 2060 6062 6c6f 636b 2e6e 6469 6d60 600a   ``block.ndim``.
+00020ae0: 2020 2020 7468 6520 7361 6d65 2066 6f72      the same for
+00020af0: 2061 6c6c 2062 6c6f 636b 732e 2054 6869   all blocks. Thi
+00020b00: 7320 6973 2070 7269 6d61 7269 6c79 2075  s is primarily u
+00020b10: 7365 6675 6c20 666f 7220 776f 726b 696e  seful for workin
+00020b20: 6720 7769 7468 2073 6361 6c61 7273 2c0a  g with scalars,.
+00020b30: 2020 2020 616e 6420 6d65 616e 7320 7468      and means th
+00020b40: 6174 2063 6f64 6520 6c69 6b65 2060 6062  at code like ``b
+00020b50: 6c6f 636b 285b 762c 2031 5d29 6060 2069  lock([v, 1])`` i
+00020b60: 7320 7661 6c69 642c 2077 6865 7265 0a20  s valid, where. 
+00020b70: 2020 2060 6076 2e6e 6469 6d20 3d3d 2031     ``v.ndim == 1
+00020b80: 6060 2e0a 0a20 2020 2057 6865 6e20 7468  ``...    When th
+00020b90: 6520 6e65 7374 6564 206c 6973 7420 6973  e nested list is
+00020ba0: 2074 776f 206c 6576 656c 7320 6465 6570   two levels deep
+00020bb0: 2c20 7468 6973 2061 6c6c 6f77 7320 626c  , this allows bl
+00020bc0: 6f63 6b20 6d61 7472 6963 6573 2074 6f20  ock matrices to 
+00020bd0: 6265 0a20 2020 2063 6f6e 7374 7275 6374  be.    construct
+00020be0: 6564 2066 726f 6d20 7468 6569 7220 636f  ed from their co
+00020bf0: 6d70 6f6e 656e 7473 2e0a 0a20 2020 2050  mponents...    P
+00020c00: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+00020c10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2061 7272  --------.    arr
+00020c20: 6179 7320 3a20 6e65 7374 6564 206c 6973  ays : nested lis
+00020c30: 7420 6f66 2061 7272 6179 5f6c 696b 6520  t of array_like 
+00020c40: 6f72 2073 6361 6c61 7273 2028 6275 7420  or scalars (but 
+00020c50: 6e6f 7420 7475 706c 6573 290a 2020 2020  not tuples).    
+00020c60: 2020 2020 4966 2070 6173 7365 6420 6120      If passed a 
+00020c70: 7369 6e67 6c65 206e 6461 7272 6179 206f  single ndarray o
+00020c80: 7220 7363 616c 6172 2028 6120 6e65 7374  r scalar (a nest
+00020c90: 6564 206c 6973 7420 6f66 2064 6570 7468  ed list of depth
+00020ca0: 2030 292c 2074 6869 730a 2020 2020 2020   0), this.      
+00020cb0: 2020 6973 2072 6574 7572 6e65 6420 756e    is returned un
+00020cc0: 6d6f 6469 6669 6564 2028 616e 6420 6e6f  modified (and no
+00020cd0: 7420 636f 7069 6564 292e 0a0a 2020 2020  t copied)...    
+00020ce0: 2020 2020 456c 656d 656e 7473 2073 6861      Elements sha
+00020cf0: 7065 7320 6d75 7374 206d 6174 6368 2061  pes must match a
+00020d00: 6c6f 6e67 2074 6865 2061 7070 726f 7072  long the appropr
+00020d10: 6961 7465 2061 7865 7320 2877 6974 686f  iate axes (witho
+00020d20: 7574 0a20 2020 2020 2020 2062 726f 6164  ut.        broad
+00020d30: 6361 7374 696e 6729 2c20 6275 7420 6c65  casting), but le
+00020d40: 6164 696e 6720 3173 2077 696c 6c20 6265  ading 1s will be
+00020d50: 2070 7265 7065 6e64 6564 2074 6f20 7468   prepended to th
+00020d60: 6520 7368 6170 6520 6173 0a20 2020 2020  e shape as.     
+00020d70: 2020 206e 6563 6573 7361 7279 2074 6f20     necessary to 
+00020d80: 6d61 6b65 2074 6865 2064 696d 656e 7369  make the dimensi
+00020d90: 6f6e 7320 6d61 7463 682e 0a0a 2020 2020  ons match...    
+00020da0: 616c 6c6f 775f 756e 6b6e 6f77 6e5f 6368  allow_unknown_ch
+00020db0: 756e 6b73 697a 6573 3a20 626f 6f6c 0a20  unksizes: bool. 
+00020dc0: 2020 2020 2020 2041 6c6c 6f77 2075 6e6b         Allow unk
+00020dd0: 6e6f 776e 2063 6875 6e6b 7369 7a65 732c  nown chunksizes,
+00020de0: 2073 7563 6820 6173 2063 6f6d 6520 6672   such as come fr
+00020df0: 6f6d 2063 6f6e 7665 7274 696e 6720 6672  om converting fr
+00020e00: 6f6d 2064 6173 6b0a 2020 2020 2020 2020  om dask.        
+00020e10: 6461 7461 6672 616d 6573 2e20 2044 6173  dataframes.  Das
+00020e20: 6b2e 6172 7261 7920 6973 2075 6e61 626c  k.array is unabl
+00020e30: 6520 746f 2076 6572 6966 7920 7468 6174  e to verify that
+00020e40: 2063 6875 6e6b 7320 6c69 6e65 2075 702e   chunks line up.
+00020e50: 2020 4966 0a20 2020 2020 2020 2064 6174    If.        dat
+00020e60: 6120 636f 6d65 7320 6672 6f6d 2064 6966  a comes from dif
+00020e70: 6665 7265 6e74 6c79 2061 6c69 676e 6564  ferently aligned
+00020e80: 2073 6f75 7263 6573 2074 6865 6e20 7468   sources then th
+00020e90: 6973 2063 616e 2063 6175 7365 0a20 2020  is can cause.   
+00020ea0: 2020 2020 2075 6e65 7870 6563 7465 6420       unexpected 
+00020eb0: 7265 7375 6c74 732e 0a0a 2020 2020 5265  results...    Re
+00020ec0: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+00020ed0: 2d0a 2020 2020 626c 6f63 6b5f 6172 7261  -.    block_arra
+00020ee0: 7920 3a20 6e64 6172 7261 790a 2020 2020  y : ndarray.    
+00020ef0: 2020 2020 5468 6520 6172 7261 7920 6173      The array as
+00020f00: 7365 6d62 6c65 6420 6672 6f6d 2074 6865  sembled from the
+00020f10: 2067 6976 656e 2062 6c6f 636b 732e 0a0a   given blocks...
+00020f20: 2020 2020 2020 2020 5468 6520 6469 6d65          The dime
+00020f30: 6e73 696f 6e61 6c69 7479 206f 6620 7468  nsionality of th
+00020f40: 6520 6f75 7470 7574 2069 7320 6571 7561  e output is equa
+00020f50: 6c20 746f 2074 6865 2067 7265 6174 6573  l to the greates
+00020f60: 7420 6f66 3a0a 2020 2020 2020 2020 2a20  t of:.        * 
+00020f70: 7468 6520 6469 6d65 6e73 696f 6e61 6c69  the dimensionali
+00020f80: 7479 206f 6620 616c 6c20 7468 6520 696e  ty of all the in
+00020f90: 7075 7473 0a20 2020 2020 2020 202a 2074  puts.        * t
+00020fa0: 6865 2064 6570 7468 2074 6f20 7768 6963  he depth to whic
+00020fb0: 6820 7468 6520 696e 7075 7420 6c69 7374  h the input list
+00020fc0: 2069 7320 6e65 7374 6564 0a0a 2020 2020   is nested..    
+00020fd0: 5261 6973 6573 0a20 2020 202d 2d2d 2d2d  Raises.    -----
+00020fe0: 2d0a 2020 2020 5661 6c75 6545 7272 6f72  -.    ValueError
+00020ff0: 0a20 2020 2020 2020 202a 2049 6620 6c69  .        * If li
+00021000: 7374 2064 6570 7468 7320 6172 6520 6d69  st depths are mi
+00021010: 736d 6174 6368 6564 202d 2066 6f72 2069  smatched - for i
+00021020: 6e73 7461 6e63 652c 2060 605b 5b61 2c20  nstance, ``[[a, 
+00021030: 625d 2c20 635d 6060 2069 730a 2020 2020  b], c]`` is.    
+00021040: 2020 2020 2020 696c 6c65 6761 6c2c 2061        illegal, a
+00021050: 6e64 2073 686f 756c 6420 6265 2073 7065  nd should be spe
+00021060: 6c74 2060 605b 5b61 2c20 625d 2c20 5b63  lt ``[[a, b], [c
+00021070: 5d5d 6060 0a20 2020 2020 2020 202a 2049  ]]``.        * I
+00021080: 6620 6c69 7374 7320 6172 6520 656d 7074  f lists are empt
+00021090: 7920 2d20 666f 7220 696e 7374 616e 6365  y - for instance
+000210a0: 2c20 6060 5b5b 612c 2062 5d2c 205b 5d5d  , ``[[a, b], []]
+000210b0: 6060 0a0a 2020 2020 5365 6520 416c 736f  ``..    See Also
+000210c0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
+000210d0: 2020 636f 6e63 6174 656e 6174 6520 3a20    concatenate : 
+000210e0: 4a6f 696e 2061 2073 6571 7565 6e63 6520  Join a sequence 
+000210f0: 6f66 2061 7272 6179 7320 746f 6765 7468  of arrays togeth
+00021100: 6572 2e0a 2020 2020 7374 6163 6b20 3a20  er..    stack : 
+00021110: 5374 6163 6b20 6172 7261 7973 2069 6e20  Stack arrays in 
+00021120: 7365 7175 656e 6365 2061 6c6f 6e67 2061  sequence along a
+00021130: 206e 6577 2064 696d 656e 7369 6f6e 2e0a   new dimension..
+00021140: 2020 2020 6873 7461 636b 203a 2053 7461      hstack : Sta
+00021150: 636b 2061 7272 6179 7320 696e 2073 6571  ck arrays in seq
+00021160: 7565 6e63 6520 686f 7269 7a6f 6e74 616c  uence horizontal
+00021170: 6c79 2028 636f 6c75 6d6e 2077 6973 6529  ly (column wise)
+00021180: 2e0a 2020 2020 7673 7461 636b 203a 2053  ..    vstack : S
+00021190: 7461 636b 2061 7272 6179 7320 696e 2073  tack arrays in s
+000211a0: 6571 7565 6e63 6520 7665 7274 6963 616c  equence vertical
+000211b0: 6c79 2028 726f 7720 7769 7365 292e 0a20  ly (row wise).. 
+000211c0: 2020 2064 7374 6163 6b20 3a20 5374 6163     dstack : Stac
+000211d0: 6b20 6172 7261 7973 2069 6e20 7365 7175  k arrays in sequ
+000211e0: 656e 6365 2064 6570 7468 2077 6973 6520  ence depth wise 
+000211f0: 2861 6c6f 6e67 2074 6869 7264 2064 696d  (along third dim
+00021200: 656e 7369 6f6e 292e 0a20 2020 2076 7370  ension)..    vsp
+00021210: 6c69 7420 3a20 5370 6c69 7420 6172 7261  lit : Split arra
+00021220: 7920 696e 746f 2061 206c 6973 7420 6f66  y into a list of
+00021230: 206d 756c 7469 706c 6520 7375 622d 6172   multiple sub-ar
+00021240: 7261 7973 2076 6572 7469 6361 6c6c 792e  rays vertically.
+00021250: 0a0a 2020 2020 4e6f 7465 730a 2020 2020  ..    Notes.    
+00021260: 2d2d 2d2d 2d0a 0a20 2020 2057 6865 6e20  -----..    When 
+00021270: 6361 6c6c 6564 2077 6974 6820 6f6e 6c79  called with only
+00021280: 2073 6361 6c61 7273 2c20 6060 626c 6f63   scalars, ``bloc
+00021290: 6b60 6020 6973 2065 7175 6976 616c 656e  k`` is equivalen
+000212a0: 7420 746f 2061 6e20 6e64 6172 7261 790a  t to an ndarray.
+000212b0: 2020 2020 6361 6c6c 2e20 536f 2060 6062      call. So ``b
+000212c0: 6c6f 636b 285b 5b31 2c20 325d 2c20 5b33  lock([[1, 2], [3
+000212d0: 2c20 345d 5d29 6060 2069 7320 6571 7569  , 4]])`` is equi
+000212e0: 7661 6c65 6e74 2074 6f0a 2020 2020 6060  valent to.    ``
+000212f0: 6172 7261 7928 5b5b 312c 2032 5d2c 205b  array([[1, 2], [
+00021300: 332c 2034 5d5d 2960 602e 0a0a 2020 2020  3, 4]])``...    
+00021310: 5468 6973 2066 756e 6374 696f 6e20 646f  This function do
+00021320: 6573 206e 6f74 2065 6e66 6f72 6365 2074  es not enforce t
+00021330: 6861 7420 7468 6520 626c 6f63 6b73 206c  hat the blocks l
+00021340: 6965 206f 6e20 6120 6669 7865 6420 6772  ie on a fixed gr
+00021350: 6964 2e0a 2020 2020 6060 626c 6f63 6b28  id..    ``block(
+00021360: 5b5b 612c 2062 5d2c 205b 632c 2064 5d5d  [[a, b], [c, d]]
+00021370: 2960 6020 6973 206e 6f74 2072 6573 7472  )`` is not restr
+00021380: 6963 7465 6420 746f 2061 7272 6179 7320  icted to arrays 
+00021390: 6f66 2074 6865 2066 6f72 6d3a 3a0a 0a20  of the form::.. 
+000213a0: 2020 2020 2020 2041 4141 6262 0a20 2020         AAAbb.   
+000213b0: 2020 2020 2041 4141 6262 0a20 2020 2020       AAAbb.     
+000213c0: 2020 2063 6363 4444 0a0a 2020 2020 4275     cccDD..    Bu
+000213d0: 7420 6973 2061 6c73 6f20 616c 6c6f 7765  t is also allowe
+000213e0: 6420 746f 2070 726f 6475 6365 2c20 666f  d to produce, fo
+000213f0: 7220 736f 6d65 2060 6061 2c20 622c 2063  r some ``a, b, c
+00021400: 2c20 6460 603a 3a0a 0a20 2020 2020 2020  , d``::..       
+00021410: 2041 4141 6262 0a20 2020 2020 2020 2041   AAAbb.        A
+00021420: 4141 6262 0a20 2020 2020 2020 2063 4444  AAbb.        cDD
+00021430: 4444 0a0a 2020 2020 5369 6e63 6520 636f  DD..    Since co
+00021440: 6e63 6174 656e 6174 696f 6e20 6861 7070  ncatenation happ
+00021450: 656e 7320 616c 6f6e 6720 7468 6520 6c61  ens along the la
+00021460: 7374 2061 7869 7320 6669 7273 742c 2060  st axis first, `
+00021470: 626c 6f63 6b60 2069 7320 5f6e 6f74 5f0a  block` is _not_.
+00021480: 2020 2020 6361 7061 626c 6520 6f66 2070      capable of p
+00021490: 726f 6475 6369 6e67 2074 6865 2066 6f6c  roducing the fol
+000214a0: 6c6f 7769 6e67 2064 6972 6563 746c 793a  lowing directly:
+000214b0: 3a0a 0a20 2020 2020 2020 2041 4141 6262  :..        AAAbb
+000214c0: 0a20 2020 2020 2020 2063 6363 6262 0a20  .        cccbb. 
+000214d0: 2020 2020 2020 2063 6363 4444 0a0a 2020         cccDD..  
+000214e0: 2020 4d61 746c 6162 2773 2022 7371 7561    Matlab's "squa
+000214f0: 7265 2062 7261 636b 6574 2073 7461 636b  re bracket stack
+00021500: 696e 6722 2c20 6060 5b41 2c20 422c 202e  ing", ``[A, B, .
+00021510: 2e2e 3b20 702c 2071 2c20 2e2e 2e5d 6060  ..; p, q, ...]``
+00021520: 2c20 6973 0a20 2020 2065 7175 6976 616c  , is.    equival
+00021530: 656e 7420 746f 2060 6062 6c6f 636b 285b  ent to ``block([
+00021540: 5b41 2c20 422c 202e 2e2e 5d2c 205b 702c  [A, B, ...], [p,
+00021550: 2071 2c20 2e2e 2e5d 5d29 6060 2e0a 2020   q, ...]])``..  
+00021560: 2020 2222 220a 0a20 2020 2023 2054 6869    """..    # Thi
+00021570: 7320 7761 7320 636f 7069 6564 2061 6c6d  s was copied alm
+00021580: 6f73 7420 7665 7262 6174 696d 2066 726f  ost verbatim fro
+00021590: 6d20 6e75 6d70 792e 636f 7265 2e73 6861  m numpy.core.sha
+000215a0: 7065 5f62 6173 652e 626c 6f63 6b0a 2020  pe_base.block.  
+000215b0: 2020 2320 5365 6520 6e75 6d70 7920 6c69    # See numpy li
+000215c0: 6365 6e73 6520 6174 2068 7474 7073 3a2f  cense at https:/
+000215d0: 2f67 6974 6875 622e 636f 6d2f 6e75 6d70  /github.com/nump
+000215e0: 792f 6e75 6d70 792f 626c 6f62 2f6d 6173  y/numpy/blob/mas
+000215f0: 7465 722f 4c49 4345 4e53 452e 7478 740a  ter/LICENSE.txt.
+00021600: 2020 2020 2320 6f72 204e 554d 5059 5f4c      # or NUMPY_L
+00021610: 4943 454e 5345 2e74 7874 2077 6974 6869  ICENSE.txt withi
+00021620: 6e20 7468 6973 2064 6972 6563 746f 7279  n this directory
+00021630: 0a0a 2020 2020 6465 6620 6174 6c65 6173  ..    def atleas
+00021640: 745f 6e64 2878 2c20 6e64 696d 293a 0a20  t_nd(x, ndim):. 
+00021650: 2020 2020 2020 2078 203d 2061 7361 6e79         x = asany
+00021660: 6172 7261 7928 7829 0a20 2020 2020 2020  array(x).       
+00021670: 2064 6966 6620 3d20 6d61 7828 6e64 696d   diff = max(ndim
+00021680: 202d 2078 2e6e 6469 6d2c 2030 290a 2020   - x.ndim, 0).  
+00021690: 2020 2020 2020 6966 2064 6966 6620 3d3d        if diff ==
+000216a0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000216b0: 7265 7475 726e 2078 0a20 2020 2020 2020  return x.       
+000216c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000216d0: 2020 2072 6574 7572 6e20 785b 284e 6f6e     return x[(Non
+000216e0: 652c 2920 2a20 6469 6666 202b 2028 456c  e,) * diff + (El
+000216f0: 6c69 7073 6973 2c29 5d0a 0a20 2020 2064  lipsis,)]..    d
+00021700: 6566 2066 6f72 6d61 745f 696e 6465 7828  ef format_index(
+00021710: 696e 6465 7829 3a0a 2020 2020 2020 2020  index):.        
+00021720: 7265 7475 726e 2022 6172 7261 7973 2220  return "arrays" 
+00021730: 2b20 2222 2e6a 6f69 6e28 6622 5b7b 697d  + "".join(f"[{i}
+00021740: 5d22 2066 6f72 2069 2069 6e20 696e 6465  ]" for i in inde
+00021750: 7829 0a0a 2020 2020 7265 6320 3d20 5f52  x)..    rec = _R
+00021760: 6563 7572 7365 7228 7265 6375 7273 655f  ecurser(recurse_
+00021770: 6966 3d6c 616d 6264 6120 783a 2074 7970  if=lambda x: typ
+00021780: 6528 7829 2069 7320 6c69 7374 290a 0a20  e(x) is list).. 
+00021790: 2020 2023 2065 6e73 7572 6520 7468 6174     # ensure that
+000217a0: 2074 6865 206c 6973 7473 2061 7265 2061   the lists are a
+000217b0: 6c6c 206d 6174 6368 6564 2069 6e20 6465  ll matched in de
+000217c0: 7074 680a 2020 2020 6c69 7374 5f6e 6469  pth.    list_ndi
+000217d0: 6d20 3d20 4e6f 6e65 0a20 2020 2061 6e79  m = None.    any
+000217e0: 5f65 6d70 7479 203d 2046 616c 7365 0a20  _empty = False. 
+000217f0: 2020 2066 6f72 2069 6e64 6578 2c20 7661     for index, va
+00021800: 6c75 652c 2065 6e74 6572 696e 6720 696e  lue, entering in
+00021810: 2072 6563 2e77 616c 6b28 6172 7261 7973   rec.walk(arrays
+00021820: 293a 0a20 2020 2020 2020 2069 6620 7479  ):.        if ty
+00021830: 7065 2876 616c 7565 2920 6973 2074 7570  pe(value) is tup
+00021840: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+00021850: 2320 6e6f 7420 7374 7269 6374 6c79 206e  # not strictly n
+00021860: 6563 6573 7361 7279 2c20 6275 7420 7361  ecessary, but sa
+00021870: 7665 7320 7573 2066 726f 6d3a 0a20 2020  ves us from:.   
+00021880: 2020 2020 2020 2020 2023 2020 2d20 6d6f           #  - mo
+00021890: 7265 2074 6861 6e20 6f6e 6520 7761 7920  re than one way 
+000218a0: 746f 2064 6f20 7468 696e 6773 202d 206e  to do things - n
+000218b0: 6f20 706f 696e 7420 7472 6561 7469 6e67  o point treating
+000218c0: 2074 7570 6c65 7320 6c69 6b65 0a20 2020   tuples like.   
+000218d0: 2020 2020 2020 2020 2023 2020 2020 6c69           #    li
+000218e0: 7374 730a 2020 2020 2020 2020 2020 2020  sts.            
+000218f0: 2320 202d 2068 6f72 7269 626c 7920 636f  #  - horribly co
+00021900: 6e66 7573 696e 6720 6265 6861 7669 6f75  nfusing behaviou
+00021910: 7220 7468 6174 2072 6573 756c 7473 2077  r that results w
+00021920: 6865 6e20 7475 706c 6573 2061 7265 0a20  hen tuples are. 
+00021930: 2020 2020 2020 2020 2020 2023 2020 2020             #    
+00021940: 7472 6561 7465 6420 6c69 6b65 206e 6461  treated like nda
+00021950: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+00021960: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00021970: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00021980: 2020 227b 7d20 6973 2061 2074 7570 6c65    "{} is a tuple
+00021990: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+000219a0: 2020 2020 224f 6e6c 7920 6c69 7374 7320      "Only lists 
+000219b0: 6361 6e20 6265 2075 7365 6420 746f 2061  can be used to a
+000219c0: 7272 616e 6765 2062 6c6f 636b 732c 2061  rrange blocks, a
+000219d0: 6e64 206e 702e 626c 6f63 6b20 646f 6573  nd np.block does
+000219e0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+000219f0: 2020 2022 6e6f 7420 616c 6c6f 7720 696d     "not allow im
+00021a00: 706c 6963 6974 2063 6f6e 7665 7273 696f  plicit conversio
+00021a10: 6e20 6672 6f6d 2074 7570 6c65 2074 6f20  n from tuple to 
+00021a20: 6e64 6172 7261 792e 222e 666f 726d 6174  ndarray.".format
+00021a30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00021a40: 2020 2020 2020 666f 726d 6174 5f69 6e64        format_ind
+00021a50: 6578 2869 6e64 6578 290a 2020 2020 2020  ex(index).      
+00021a60: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00021a70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00021a80: 2020 6966 206e 6f74 2065 6e74 6572 696e    if not enterin
+00021a90: 673a 0a20 2020 2020 2020 2020 2020 2063  g:.            c
+00021aa0: 7572 725f 6465 7074 6820 3d20 6c65 6e28  urr_depth = len(
+00021ab0: 696e 6465 7829 0a20 2020 2020 2020 2065  index).        e
+00021ac0: 6c69 6620 6c65 6e28 7661 6c75 6529 203d  lif len(value) =
+00021ad0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+00021ae0: 2063 7572 725f 6465 7074 6820 3d20 6c65   curr_depth = le
+00021af0: 6e28 696e 6465 7829 202b 2031 0a20 2020  n(index) + 1.   
+00021b00: 2020 2020 2020 2020 2061 6e79 5f65 6d70           any_emp
+00021b10: 7479 203d 2054 7275 650a 2020 2020 2020  ty = True.      
+00021b20: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00021b30: 2020 2020 636f 6e74 696e 7565 0a0a 2020      continue..  
+00021b40: 2020 2020 2020 6966 206c 6973 745f 6e64        if list_nd
+00021b50: 696d 2069 7320 6e6f 7420 4e6f 6e65 2061  im is not None a
+00021b60: 6e64 206c 6973 745f 6e64 696d 2021 3d20  nd list_ndim != 
+00021b70: 6375 7272 5f64 6570 7468 3a0a 2020 2020  curr_depth:.    
+00021b80: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00021b90: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00021ba0: 2020 2020 2020 2020 2020 224c 6973 7420            "List 
+00021bb0: 6465 7074 6873 2061 7265 206d 6973 6d61  depths are misma
+00021bc0: 7463 6865 642e 2046 6972 7374 2065 6c65  tched. First ele
+00021bd0: 6d65 6e74 2077 6173 2061 7420 6465 7074  ment was at dept
+00021be0: 6820 7b7d 2c20 220a 2020 2020 2020 2020  h {}, ".        
+00021bf0: 2020 2020 2020 2020 2262 7574 2074 6865          "but the
+00021c00: 7265 2069 7320 616e 2065 6c65 6d65 6e74  re is an element
+00021c10: 2061 7420 6465 7074 6820 7b7d 2028 7b7d   at depth {} ({}
+00021c20: 2922 2e66 6f72 6d61 7428 0a20 2020 2020  )".format(.     
+00021c30: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00021c40: 6973 745f 6e64 696d 2c20 6375 7272 5f64  ist_ndim, curr_d
+00021c50: 6570 7468 2c20 666f 726d 6174 5f69 6e64  epth, format_ind
+00021c60: 6578 2869 6e64 6578 290a 2020 2020 2020  ex(index).      
+00021c70: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00021c80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00021c90: 2020 6c69 7374 5f6e 6469 6d20 3d20 6375    list_ndim = cu
+00021ca0: 7272 5f64 6570 7468 0a0a 2020 2020 2320  rr_depth..    # 
+00021cb0: 646f 2074 6869 7320 6865 7265 2073 6f20  do this here so 
+00021cc0: 7765 2063 6174 6368 2064 6570 7468 206d  we catch depth m
+00021cd0: 6973 6d61 7463 6865 7320 6669 7273 740a  ismatches first.
+00021ce0: 2020 2020 6966 2061 6e79 5f65 6d70 7479      if any_empty
+00021cf0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+00021d00: 5661 6c75 6545 7272 6f72 2822 4c69 7374  ValueError("List
+00021d10: 7320 6361 6e6e 6f74 2062 6520 656d 7074  s cannot be empt
+00021d20: 7922 290a 0a20 2020 2023 2063 6f6e 7665  y")..    # conve
+00021d30: 7274 2061 6c6c 2074 6865 2061 7272 6179  rt all the array
+00021d40: 7320 746f 206e 6461 7272 6179 730a 2020  s to ndarrays.  
+00021d50: 2020 6172 7261 7973 203d 2072 6563 2e6d    arrays = rec.m
+00021d60: 6170 5f72 6564 7563 6528 6172 7261 7973  ap_reduce(arrays
+00021d70: 2c20 665f 6d61 703d 6173 616e 7961 7272  , f_map=asanyarr
+00021d80: 6179 2c20 665f 7265 6475 6365 3d6c 6973  ay, f_reduce=lis
+00021d90: 7429 0a0a 2020 2020 2320 6465 7465 726d  t)..    # determ
+00021da0: 696e 6520 7468 6520 6d61 7869 6d75 6d20  ine the maximum 
+00021db0: 6469 6d65 6e73 696f 6e20 6f66 2074 6865  dimension of the
+00021dc0: 2065 6c65 6d65 6e74 730a 2020 2020 656c   elements.    el
+00021dd0: 656d 5f6e 6469 6d20 3d20 7265 632e 6d61  em_ndim = rec.ma
+00021de0: 705f 7265 6475 6365 2861 7272 6179 732c  p_reduce(arrays,
+00021df0: 2066 5f6d 6170 3d6c 616d 6264 6120 7869   f_map=lambda xi
+00021e00: 3a20 7869 2e6e 6469 6d2c 2066 5f72 6564  : xi.ndim, f_red
+00021e10: 7563 653d 6d61 7829 0a20 2020 206e 6469  uce=max).    ndi
+00021e20: 6d20 3d20 6d61 7828 6c69 7374 5f6e 6469  m = max(list_ndi
+00021e30: 6d2c 2065 6c65 6d5f 6e64 696d 290a 0a20  m, elem_ndim).. 
+00021e40: 2020 2023 2066 6972 7374 2061 7869 7320     # first axis 
+00021e50: 746f 2063 6f6e 6361 7465 6e61 7465 2061  to concatenate a
+00021e60: 6c6f 6e67 0a20 2020 2066 6972 7374 5f61  long.    first_a
+00021e70: 7869 7320 3d20 6e64 696d 202d 206c 6973  xis = ndim - lis
+00021e80: 745f 6e64 696d 0a0a 2020 2020 2320 4d61  t_ndim..    # Ma
+00021e90: 6b65 2061 6c6c 2074 6865 2065 6c65 6d65  ke all the eleme
+00021ea0: 6e74 7320 7468 6520 7361 6d65 2064 696d  nts the same dim
+00021eb0: 656e 7369 6f6e 0a20 2020 2061 7272 6179  ension.    array
+00021ec0: 7320 3d20 7265 632e 6d61 705f 7265 6475  s = rec.map_redu
+00021ed0: 6365 280a 2020 2020 2020 2020 6172 7261  ce(.        arra
+00021ee0: 7973 2c20 665f 6d61 703d 6c61 6d62 6461  ys, f_map=lambda
+00021ef0: 2078 693a 2061 746c 6561 7374 5f6e 6428   xi: atleast_nd(
+00021f00: 7869 2c20 6e64 696d 292c 2066 5f72 6564  xi, ndim), f_red
+00021f10: 7563 653d 6c69 7374 0a20 2020 2029 0a0a  uce=list.    )..
+00021f20: 2020 2020 2320 636f 6e63 6174 656e 6174      # concatenat
+00021f30: 6520 696e 6e65 726d 6f73 7420 6c69 7374  e innermost list
+00021f40: 7320 6f6e 2074 6865 2072 6967 6874 2c20  s on the right, 
+00021f50: 6f75 7465 726d 6f73 7420 6f6e 2074 6865  outermost on the
+00021f60: 206c 6566 740a 2020 2020 7265 7475 726e   left.    return
+00021f70: 2072 6563 2e6d 6170 5f72 6564 7563 6528   rec.map_reduce(
+00021f80: 0a20 2020 2020 2020 2061 7272 6179 732c  .        arrays,
+00021f90: 0a20 2020 2020 2020 2066 5f72 6564 7563  .        f_reduc
+00021fa0: 653d 6c61 6d62 6461 2078 732c 2061 7869  e=lambda xs, axi
+00021fb0: 733a 2063 6f6e 6361 7465 6e61 7465 280a  s: concatenate(.
+00021fc0: 2020 2020 2020 2020 2020 2020 6c69 7374              list
+00021fd0: 2878 7329 2c20 6178 6973 3d61 7869 732c  (xs), axis=axis,
+00021fe0: 2061 6c6c 6f77 5f75 6e6b 6e6f 776e 5f63   allow_unknown_c
+00021ff0: 6875 6e6b 7369 7a65 733d 616c 6c6f 775f  hunksizes=allow_
+00022000: 756e 6b6e 6f77 6e5f 6368 756e 6b73 697a  unknown_chunksiz
+00022010: 6573 0a20 2020 2020 2020 2029 2c0a 2020  es.        ),.  
+00022020: 2020 2020 2020 665f 6b77 6172 6773 3d6c        f_kwargs=l
+00022030: 616d 6264 6120 6178 6973 3a20 6469 6374  ambda axis: dict
+00022040: 2861 7869 733d 2861 7869 7320 2b20 3129  (axis=(axis + 1)
+00022050: 292c 0a20 2020 2020 2020 2061 7869 733d  ),.        axis=
+00022060: 6669 7273 745f 6178 6973 2c0a 2020 2020  first_axis,.    
+00022070: 290a 0a0a 6465 6620 636f 6e63 6174 656e  )...def concaten
+00022080: 6174 6528 7365 712c 2061 7869 733d 302c  ate(seq, axis=0,
+00022090: 2061 6c6c 6f77 5f75 6e6b 6e6f 776e 5f63   allow_unknown_c
+000220a0: 6875 6e6b 7369 7a65 733d 4661 6c73 6529  hunksizes=False)
+000220b0: 3a0a 2020 2020 2222 220a 2020 2020 436f  :.    """.    Co
+000220c0: 6e63 6174 656e 6174 6520 6172 7261 7973  ncatenate arrays
+000220d0: 2061 6c6f 6e67 2061 6e20 6578 6973 7469   along an existi
+000220e0: 6e67 2061 7869 730a 0a20 2020 2047 6976  ng axis..    Giv
+000220f0: 656e 2061 2073 6571 7565 6e63 6520 6f66  en a sequence of
+00022100: 2064 6173 6b20 4172 7261 7973 2066 6f72   dask Arrays for
+00022110: 6d20 6120 6e65 7720 6461 736b 2041 7272  m a new dask Arr
+00022120: 6179 2062 7920 7374 6163 6b69 6e67 2074  ay by stacking t
+00022130: 6865 6d0a 2020 2020 616c 6f6e 6720 616e  hem.    along an
+00022140: 2065 7869 7374 696e 6720 6469 6d65 6e73   existing dimens
+00022150: 696f 6e20 2861 7869 733d 3020 6279 2064  ion (axis=0 by d
+00022160: 6566 6175 6c74 290a 0a20 2020 2050 6172  efault)..    Par
+00022170: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00022180: 2d2d 2d2d 2d2d 0a20 2020 2073 6571 3a20  ------.    seq: 
+00022190: 6c69 7374 206f 6620 6461 736b 2e61 7272  list of dask.arr
+000221a0: 6179 730a 2020 2020 6178 6973 3a20 696e  ays.    axis: in
+000221b0: 740a 2020 2020 2020 2020 4469 6d65 6e73  t.        Dimens
+000221c0: 696f 6e20 616c 6f6e 6720 7768 6963 6820  ion along which 
+000221d0: 746f 2061 6c69 676e 2061 6c6c 206f 6620  to align all of 
+000221e0: 7468 6520 6172 7261 7973 2e20 4966 2061  the arrays. If a
+000221f0: 7869 7320 6973 204e 6f6e 652c 0a20 2020  xis is None,.   
+00022200: 2020 2020 2061 7272 6179 7320 6172 6520       arrays are 
+00022210: 666c 6174 7465 6e65 6420 6265 666f 7265  flattened before
+00022220: 2075 7365 2e0a 2020 2020 616c 6c6f 775f   use..    allow_
+00022230: 756e 6b6e 6f77 6e5f 6368 756e 6b73 697a  unknown_chunksiz
+00022240: 6573 3a20 626f 6f6c 0a20 2020 2020 2020  es: bool.       
+00022250: 2041 6c6c 6f77 2075 6e6b 6e6f 776e 2063   Allow unknown c
+00022260: 6875 6e6b 7369 7a65 732c 2073 7563 6820  hunksizes, such 
+00022270: 6173 2063 6f6d 6520 6672 6f6d 2063 6f6e  as come from con
+00022280: 7665 7274 696e 6720 6672 6f6d 2064 6173  verting from das
+00022290: 6b0a 2020 2020 2020 2020 6461 7461 6672  k.        datafr
+000222a0: 616d 6573 2e20 2044 6173 6b2e 6172 7261  ames.  Dask.arra
+000222b0: 7920 6973 2075 6e61 626c 6520 746f 2076  y is unable to v
+000222c0: 6572 6966 7920 7468 6174 2063 6875 6e6b  erify that chunk
+000222d0: 7320 6c69 6e65 2075 702e 2020 4966 0a20  s line up.  If. 
+000222e0: 2020 2020 2020 2064 6174 6120 636f 6d65         data come
+000222f0: 7320 6672 6f6d 2064 6966 6665 7265 6e74  s from different
+00022300: 6c79 2061 6c69 676e 6564 2073 6f75 7263  ly aligned sourc
+00022310: 6573 2074 6865 6e20 7468 6973 2063 616e  es then this can
+00022320: 2063 6175 7365 0a20 2020 2020 2020 2075   cause.        u
+00022330: 6e65 7870 6563 7465 6420 7265 7375 6c74  nexpected result
+00022340: 732e 0a0a 2020 2020 4578 616d 706c 6573  s...    Examples
+00022350: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20  .    --------.. 
+00022360: 2020 2043 7265 6174 6520 736c 6963 6573     Create slices
+00022370: 0a0a 2020 2020 3e3e 3e20 696d 706f 7274  ..    >>> import
+00022380: 2064 6173 6b2e 6172 7261 7920 6173 2064   dask.array as d
+00022390: 610a 2020 2020 3e3e 3e20 696d 706f 7274  a.    >>> import
+000223a0: 206e 756d 7079 2061 7320 6e70 0a0a 2020   numpy as np..  
+000223b0: 2020 3e3e 3e20 6461 7461 203d 205b 6461    >>> data = [da
+000223c0: 2e66 726f 6d5f 6172 7261 7928 6e70 2e6f  .from_array(np.o
+000223d0: 6e65 7328 2834 2c20 3429 292c 2063 6875  nes((4, 4)), chu
+000223e0: 6e6b 733d 2832 2c20 3229 290a 2020 2020  nks=(2, 2)).    
+000223f0: 2e2e 2e20 2020 2020 2020 2020 2066 6f72  ...          for
+00022400: 2069 2069 6e20 7261 6e67 6528 3329 5d0a   i in range(3)].
+00022410: 0a20 2020 203e 3e3e 2078 203d 2064 612e  .    >>> x = da.
+00022420: 636f 6e63 6174 656e 6174 6528 6461 7461  concatenate(data
+00022430: 2c20 6178 6973 3d30 290a 2020 2020 3e3e  , axis=0).    >>
+00022440: 3e20 782e 7368 6170 650a 2020 2020 2831  > x.shape.    (1
+00022450: 322c 2034 290a 0a20 2020 203e 3e3e 2064  2, 4)..    >>> d
+00022460: 612e 636f 6e63 6174 656e 6174 6528 6461  a.concatenate(da
+00022470: 7461 2c20 6178 6973 3d31 292e 7368 6170  ta, axis=1).shap
+00022480: 650a 2020 2020 2834 2c20 3132 290a 0a20  e.    (4, 12).. 
+00022490: 2020 2052 6573 756c 7420 6973 2061 206e     Result is a n
+000224a0: 6577 2064 6173 6b20 4172 7261 790a 0a20  ew dask Array.. 
+000224b0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+000224c0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2073 7461  --------.    sta
+000224d0: 636b 0a20 2020 2022 2222 0a20 2020 2066  ck.    """.    f
+000224e0: 726f 6d20 6461 736b 2e61 7272 6179 2069  rom dask.array i
+000224f0: 6d70 6f72 7420 7772 6170 0a0a 2020 2020  mport wrap..    
+00022500: 7365 7120 3d20 5b61 7361 7272 6179 2861  seq = [asarray(a
+00022510: 2c20 616c 6c6f 775f 756e 6b6e 6f77 6e5f  , allow_unknown_
+00022520: 6368 756e 6b73 697a 6573 3d61 6c6c 6f77  chunksizes=allow
+00022530: 5f75 6e6b 6e6f 776e 5f63 6875 6e6b 7369  _unknown_chunksi
+00022540: 7a65 7329 2066 6f72 2061 2069 6e20 7365  zes) for a in se
+00022550: 715d 0a0a 2020 2020 6966 206e 6f74 2073  q]..    if not s
+00022560: 6571 3a0a 2020 2020 2020 2020 7261 6973  eq:.        rais
+00022570: 6520 5661 6c75 6545 7272 6f72 2822 4e65  e ValueError("Ne
+00022580: 6564 2061 7272 6179 2873 2920 746f 2063  ed array(s) to c
+00022590: 6f6e 6361 7465 6e61 7465 2229 0a0a 2020  oncatenate")..  
+000225a0: 2020 6966 2061 7869 7320 6973 204e 6f6e    if axis is Non
+000225b0: 653a 0a20 2020 2020 2020 2073 6571 203d  e:.        seq =
+000225c0: 205b 612e 666c 6174 7465 6e28 2920 666f   [a.flatten() fo
+000225d0: 7220 6120 696e 2073 6571 5d0a 2020 2020  r a in seq].    
+000225e0: 2020 2020 6178 6973 203d 2030 0a0a 2020      axis = 0..  
+000225f0: 2020 7365 715f 6d65 7461 7320 3d20 5b6d    seq_metas = [m
+00022600: 6574 615f 6672 6f6d 5f61 7272 6179 2873  eta_from_array(s
+00022610: 2920 666f 7220 7320 696e 2073 6571 5d0a  ) for s in seq].
+00022620: 2020 2020 5f63 6f6e 6361 7465 6e61 7465      _concatenate
+00022630: 203d 2063 6f6e 6361 7465 6e61 7465 5f6c   = concatenate_l
+00022640: 6f6f 6b75 702e 6469 7370 6174 6368 280a  ookup.dispatch(.
+00022650: 2020 2020 2020 2020 7479 7065 286d 6178          type(max
+00022660: 2873 6571 5f6d 6574 6173 2c20 6b65 793d  (seq_metas, key=
+00022670: 6c61 6d62 6461 2078 3a20 6765 7461 7474  lambda x: getatt
+00022680: 7228 782c 2022 5f5f 6172 7261 795f 7072  r(x, "__array_pr
+00022690: 696f 7269 7479 5f5f 222c 2030 2929 290a  iority__", 0))).
+000226a0: 2020 2020 290a 2020 2020 6d65 7461 203d      ).    meta =
+000226b0: 205f 636f 6e63 6174 656e 6174 6528 7365   _concatenate(se
+000226c0: 715f 6d65 7461 732c 2061 7869 733d 6178  q_metas, axis=ax
+000226d0: 6973 290a 0a20 2020 2023 2050 726f 6d6f  is)..    # Promo
+000226e0: 7465 2074 7970 6573 2074 6f20 6d61 7463  te types to matc
+000226f0: 6820 6d65 7461 0a20 2020 2073 6571 203d  h meta.    seq =
+00022700: 205b 612e 6173 7479 7065 286d 6574 612e   [a.astype(meta.
+00022710: 6474 7970 6529 2066 6f72 2061 2069 6e20  dtype) for a in 
+00022720: 7365 715d 0a0a 2020 2020 2320 4669 6e64  seq]..    # Find
+00022730: 206f 7574 7075 7420 6172 7261 7920 7368   output array sh
+00022740: 6170 650a 2020 2020 6e64 696d 203d 206c  ape.    ndim = l
+00022750: 656e 2873 6571 5b30 5d2e 7368 6170 6529  en(seq[0].shape)
+00022760: 0a20 2020 2073 6861 7065 203d 2074 7570  .    shape = tup
+00022770: 6c65 280a 2020 2020 2020 2020 7375 6d28  le(.        sum(
+00022780: 612e 7368 6170 655b 695d 2066 6f72 2061  a.shape[i] for a
+00022790: 2069 6e20 7365 7129 2069 6620 6920 3d3d   in seq) if i ==
+000227a0: 2061 7869 7320 656c 7365 2073 6571 5b30   axis else seq[0
+000227b0: 5d2e 7368 6170 655b 695d 0a20 2020 2020  ].shape[i].     
+000227c0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+000227d0: 6528 6e64 696d 290a 2020 2020 290a 0a20  e(ndim).    ).. 
+000227e0: 2020 2023 2044 726f 7020 656d 7074 7920     # Drop empty 
+000227f0: 6172 7261 7973 0a20 2020 2073 6571 3220  arrays.    seq2 
+00022800: 3d20 5b61 2066 6f72 2061 2069 6e20 7365  = [a for a in se
+00022810: 7120 6966 2061 2e73 697a 655d 0a20 2020  q if a.size].   
+00022820: 2069 6620 6e6f 7420 7365 7132 3a0a 2020   if not seq2:.  
+00022830: 2020 2020 2020 7365 7132 203d 2073 6571        seq2 = seq
+00022840: 0a0a 2020 2020 6966 2061 7869 7320 3c20  ..    if axis < 
+00022850: 303a 0a20 2020 2020 2020 2061 7869 7320  0:.        axis 
+00022860: 3d20 6e64 696d 202b 2061 7869 730a 2020  = ndim + axis.  
+00022870: 2020 6966 2061 7869 7320 3e3d 206e 6469    if axis >= ndi
+00022880: 6d3a 0a20 2020 2020 2020 206d 7367 203d  m:.        msg =
+00022890: 2028 0a20 2020 2020 2020 2020 2020 2022   (.            "
+000228a0: 4178 6973 206d 7573 7420 6265 206c 6573  Axis must be les
+000228b0: 7320 7468 616e 2074 6861 6e20 6e75 6d62  s than than numb
+000228c0: 6572 206f 6620 6469 6d65 6e73 696f 6e73  er of dimensions
+000228d0: 220a 2020 2020 2020 2020 2020 2020 225c  ".            "\
+000228e0: 6e44 6174 6120 6861 7320 2564 2064 696d  nData has %d dim
+000228f0: 656e 7369 6f6e 732c 2062 7574 2067 6f74  ensions, but got
+00022900: 2061 7869 733d 2564 220a 2020 2020 2020   axis=%d".      
+00022910: 2020 290a 2020 2020 2020 2020 7261 6973    ).        rais
+00022920: 6520 5661 6c75 6545 7272 6f72 286d 7367  e ValueError(msg
+00022930: 2025 2028 6e64 696d 2c20 6178 6973 2929   % (ndim, axis))
+00022940: 0a0a 2020 2020 6e20 3d20 6c65 6e28 7365  ..    n = len(se
+00022950: 7132 290a 2020 2020 6966 206e 203d 3d20  q2).    if n == 
+00022960: 303a 0a20 2020 2020 2020 2074 7279 3a0a  0:.        try:.
+00022970: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00022980: 726e 2077 7261 702e 656d 7074 795f 6c69  rn wrap.empty_li
+00022990: 6b65 286d 6574 612c 2073 6861 7065 3d73  ke(meta, shape=s
+000229a0: 6861 7065 2c20 6368 756e 6b73 3d73 6861  hape, chunks=sha
+000229b0: 7065 2c20 6474 7970 653d 6d65 7461 2e64  pe, dtype=meta.d
+000229c0: 7479 7065 290a 2020 2020 2020 2020 6578  type).        ex
+000229d0: 6365 7074 2054 7970 6545 7272 6f72 3a0a  cept TypeError:.
+000229e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000229f0: 726e 2077 7261 702e 656d 7074 7928 7368  rn wrap.empty(sh
+00022a00: 6170 652c 2063 6875 6e6b 733d 7368 6170  ape, chunks=shap
+00022a10: 652c 2064 7479 7065 3d6d 6574 612e 6474  e, dtype=meta.dt
+00022a20: 7970 6529 0a20 2020 2065 6c69 6620 6e20  ype).    elif n 
+00022a30: 3d3d 2031 3a0a 2020 2020 2020 2020 7265  == 1:.        re
+00022a40: 7475 726e 2073 6571 325b 305d 0a0a 2020  turn seq2[0]..  
+00022a50: 2020 6966 206e 6f74 2061 6c6c 6f77 5f75    if not allow_u
+00022a60: 6e6b 6e6f 776e 5f63 6875 6e6b 7369 7a65  nknown_chunksize
+00022a70: 7320 616e 6420 6e6f 7420 616c 6c28 0a20  s and not all(. 
+00022a80: 2020 2020 2020 2069 203d 3d20 6178 6973         i == axis
+00022a90: 206f 7220 616c 6c28 782e 7368 6170 655b   or all(x.shape[
+00022aa0: 695d 203d 3d20 7365 7132 5b30 5d2e 7368  i] == seq2[0].sh
+00022ab0: 6170 655b 695d 2066 6f72 2078 2069 6e20  ape[i] for x in 
+00022ac0: 7365 7132 290a 2020 2020 2020 2020 666f  seq2).        fo
+00022ad0: 7220 6920 696e 2072 616e 6765 286e 6469  r i in range(ndi
+00022ae0: 6d29 0a20 2020 2029 3a0a 2020 2020 2020  m).    ):.      
+00022af0: 2020 6966 2061 6e79 286d 6170 286e 702e    if any(map(np.
+00022b00: 6973 6e61 6e2c 2073 6571 325b 305d 2e73  isnan, seq2[0].s
+00022b10: 6861 7065 2929 3a0a 2020 2020 2020 2020  hape)):.        
+00022b20: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00022b30: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00022b40: 2020 2020 2020 2254 7269 6564 2074 6f20        "Tried to 
+00022b50: 636f 6e63 6174 656e 6174 6520 6172 7261  concatenate arra
+00022b60: 7973 2077 6974 6820 756e 6b6e 6f77 6e22  ys with unknown"
+00022b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022b80: 2022 2073 6861 7065 2025 732e 5c6e 5c6e   " shape %s.\n\n
+00022b90: 5477 6f20 736f 6c75 7469 6f6e 733a 5c6e  Two solutions:\n
+00022ba0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00022bb0: 2020 2220 2031 2e20 466f 7263 6520 636f    "  1. Force co
+00022bc0: 6e63 6174 656e 6174 696f 6e20 7061 7373  ncatenation pass
+00022bd0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00022be0: 2020 2220 616c 6c6f 775f 756e 6b6e 6f77    " allow_unknow
+00022bf0: 6e5f 6368 756e 6b73 697a 6573 3d54 7275  n_chunksizes=Tru
+00022c00: 652e 5c6e 220a 2020 2020 2020 2020 2020  e.\n".          
+00022c10: 2020 2020 2020 2220 2032 2e20 436f 6d70        "  2. Comp
+00022c20: 7574 6520 7368 6170 6573 2077 6974 6820  ute shapes with 
+00022c30: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00022c40: 2020 225b 782e 636f 6d70 7574 655f 6368    "[x.compute_ch
+00022c50: 756e 6b5f 7369 7a65 7328 2920 666f 7220  unk_sizes() for 
+00022c60: 7820 696e 2073 6571 5d22 2025 2073 7472  x in seq]" % str
+00022c70: 2873 6571 325b 305d 2e73 6861 7065 290a  (seq2[0].shape).
+00022c80: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00022c90: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00022ca0: 6545 7272 6f72 2822 5368 6170 6573 2064  eError("Shapes d
+00022cb0: 6f20 6e6f 7420 616c 6967 6e3a 2025 7322  o not align: %s"
+00022cc0: 2c20 5b78 2e73 6861 7065 2066 6f72 2078  , [x.shape for x
+00022cd0: 2069 6e20 7365 7132 5d29 0a0a 2020 2020   in seq2])..    
+00022ce0: 696e 6473 203d 205b 6c69 7374 2872 616e  inds = [list(ran
+00022cf0: 6765 286e 6469 6d29 2920 666f 7220 6920  ge(ndim)) for i 
+00022d00: 696e 2072 616e 6765 286e 295d 0a20 2020  in range(n)].   
+00022d10: 2066 6f72 2069 2c20 696e 6420 696e 2065   for i, ind in e
+00022d20: 6e75 6d65 7261 7465 2869 6e64 7329 3a0a  numerate(inds):.
+00022d30: 2020 2020 2020 2020 696e 645b 6178 6973          ind[axis
+00022d40: 5d20 3d20 2d28 6920 2b20 3129 0a0a 2020  ] = -(i + 1)..  
+00022d50: 2020 7563 5f61 7267 7320 3d20 6c69 7374    uc_args = list
+00022d60: 2863 6f6e 6361 7428 7a69 7028 7365 7132  (concat(zip(seq2
+00022d70: 2c20 696e 6473 2929 290a 2020 2020 5f2c  , inds))).    _,
+00022d80: 2073 6571 3220 3d20 756e 6966 795f 6368   seq2 = unify_ch
+00022d90: 756e 6b73 282a 7563 5f61 7267 732c 2077  unks(*uc_args, w
+00022da0: 6172 6e3d 4661 6c73 6529 0a0a 2020 2020  arn=False)..    
+00022db0: 6264 7320 3d20 5b61 2e63 6875 6e6b 7320  bds = [a.chunks 
+00022dc0: 666f 7220 6120 696e 2073 6571 325d 0a0a  for a in seq2]..
+00022dd0: 2020 2020 6368 756e 6b73 203d 2028 0a20      chunks = (. 
+00022de0: 2020 2020 2020 2073 6571 325b 305d 2e63         seq2[0].c
+00022df0: 6875 6e6b 735b 3a61 7869 735d 0a20 2020  hunks[:axis].   
+00022e00: 2020 2020 202b 2028 7375 6d28 2862 645b       + (sum((bd[
+00022e10: 6178 6973 5d20 666f 7220 6264 2069 6e20  axis] for bd in 
+00022e20: 6264 7329 2c20 2829 292c 290a 2020 2020  bds), ()),).    
+00022e30: 2020 2020 2b20 7365 7132 5b30 5d2e 6368      + seq2[0].ch
+00022e40: 756e 6b73 5b61 7869 7320 2b20 3120 3a5d  unks[axis + 1 :]
+00022e50: 0a20 2020 2029 0a0a 2020 2020 6375 6d5f  .    )..    cum_
+00022e60: 6469 6d73 203d 205b 305d 202b 206c 6973  dims = [0] + lis
+00022e70: 7428 6163 6375 6d75 6c61 7465 2861 6464  t(accumulate(add
+00022e80: 2c20 5b6c 656e 2861 2e63 6875 6e6b 735b  , [len(a.chunks[
+00022e90: 6178 6973 5d29 2066 6f72 2061 2069 6e20  axis]) for a in 
+00022ea0: 7365 7132 5d29 290a 0a20 2020 206e 616d  seq2]))..    nam
+00022eb0: 6573 203d 205b 612e 6e61 6d65 2066 6f72  es = [a.name for
+00022ec0: 2061 2069 6e20 7365 7132 5d0a 0a20 2020   a in seq2]..   
+00022ed0: 206e 616d 6520 3d20 2263 6f6e 6361 7465   name = "concate
+00022ee0: 6e61 7465 2d22 202b 2074 6f6b 656e 697a  nate-" + tokeniz
+00022ef0: 6528 6e61 6d65 732c 2061 7869 7329 0a20  e(names, axis). 
+00022f00: 2020 206b 6579 7320 3d20 6c69 7374 2870     keys = list(p
+00022f10: 726f 6475 6374 285b 6e61 6d65 5d2c 202a  roduct([name], *
+00022f20: 5b72 616e 6765 286c 656e 2862 6429 2920  [range(len(bd)) 
+00022f30: 666f 7220 6264 2069 6e20 6368 756e 6b73  for bd in chunks
+00022f40: 5d29 290a 0a20 2020 2076 616c 7565 7320  ]))..    values 
+00022f50: 3d20 5b0a 2020 2020 2020 2020 286e 616d  = [.        (nam
+00022f60: 6573 5b62 6973 6563 7428 6375 6d5f 6469  es[bisect(cum_di
+00022f70: 6d73 2c20 6b65 795b 6178 6973 202b 2031  ms, key[axis + 1
+00022f80: 5d29 202d 2031 5d2c 290a 2020 2020 2020  ]) - 1],).      
+00022f90: 2020 2b20 6b65 795b 3120 3a20 6178 6973    + key[1 : axis
+00022fa0: 202b 2031 5d0a 2020 2020 2020 2020 2b20   + 1].        + 
+00022fb0: 286b 6579 5b61 7869 7320 2b20 315d 202d  (key[axis + 1] -
+00022fc0: 2063 756d 5f64 696d 735b 6269 7365 6374   cum_dims[bisect
+00022fd0: 2863 756d 5f64 696d 732c 206b 6579 5b61  (cum_dims, key[a
+00022fe0: 7869 7320 2b20 315d 2920 2d20 315d 2c29  xis + 1]) - 1],)
+00022ff0: 0a20 2020 2020 2020 202b 206b 6579 5b61  .        + key[a
+00023000: 7869 7320 2b20 3220 3a5d 0a20 2020 2020  xis + 2 :].     
+00023010: 2020 2066 6f72 206b 6579 2069 6e20 6b65     for key in ke
+00023020: 7973 0a20 2020 205d 0a0a 2020 2020 6473  ys.    ]..    ds
+00023030: 6b20 3d20 6469 6374 287a 6970 286b 6579  k = dict(zip(key
+00023040: 732c 2076 616c 7565 7329 290a 2020 2020  s, values)).    
+00023050: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
+00023060: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
+00023070: 6563 7469 6f6e 7328 6e61 6d65 2c20 6473  ections(name, ds
+00023080: 6b2c 2064 6570 656e 6465 6e63 6965 733d  k, dependencies=
+00023090: 7365 7132 290a 0a20 2020 2072 6574 7572  seq2)..    retur
+000230a0: 6e20 4172 7261 7928 6772 6170 682c 206e  n Array(graph, n
+000230b0: 616d 652c 2063 6875 6e6b 732c 206d 6574  ame, chunks, met
+000230c0: 613d 6d65 7461 290a 0a0a 6465 6620 6c6f  a=meta)...def lo
+000230d0: 6164 5f73 746f 7265 5f63 6875 6e6b 280a  ad_store_chunk(.
+000230e0: 2020 2020 783a 2041 6e79 2c0a 2020 2020      x: Any,.    
+000230f0: 6f75 743a 2041 6e79 2c0a 2020 2020 696e  out: Any,.    in
+00023100: 6465 783a 2073 6c69 6365 2c0a 2020 2020  dex: slice,.    
+00023110: 6c6f 636b 3a20 416e 792c 0a20 2020 2072  lock: Any,.    r
+00023120: 6574 7572 6e5f 7374 6f72 6564 3a20 626f  eturn_stored: bo
+00023130: 6f6c 2c0a 2020 2020 6c6f 6164 5f73 746f  ol,.    load_sto
+00023140: 7265 643a 2062 6f6f 6c2c 0a29 3a0a 2020  red: bool,.):.  
+00023150: 2020 2222 220a 2020 2020 4120 6675 6e63    """.    A func
+00023160: 7469 6f6e 2069 6e73 6572 7465 6420 696e  tion inserted in
+00023170: 2061 2044 6173 6b20 6772 6170 6820 666f   a Dask graph fo
+00023180: 7220 7374 6f72 696e 6720 6120 6368 756e  r storing a chun
+00023190: 6b2e 0a0a 2020 2020 5061 7261 6d65 7465  k...    Paramete
+000231a0: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+000231b0: 2d0a 2020 2020 783a 2061 7272 6179 2d6c  -.    x: array-l
+000231c0: 696b 650a 2020 2020 2020 2020 416e 2061  ike.        An a
+000231d0: 7272 6179 2028 706f 7465 6e74 6961 6c6c  rray (potentiall
+000231e0: 7920 6120 4e75 6d50 7920 6f6e 6529 0a20  y a NumPy one). 
+000231f0: 2020 206f 7574 3a20 6172 7261 792d 6c69     out: array-li
+00023200: 6b65 0a20 2020 2020 2020 2057 6865 7265  ke.        Where
+00023210: 2074 6f20 7374 6f72 6520 7265 7375 6c74   to store result
+00023220: 732e 0a20 2020 2069 6e64 6578 3a20 736c  s..    index: sl
+00023230: 6963 652d 6c69 6b65 0a20 2020 2020 2020  ice-like.       
+00023240: 2057 6865 7265 2074 6f20 7374 6f72 6520   Where to store 
+00023250: 7265 7375 6c74 2066 726f 6d20 6060 7860  result from ``x`
+00023260: 6020 696e 2060 606f 7574 6060 2e0a 2020  ` in ``out``..  
+00023270: 2020 6c6f 636b 3a20 4c6f 636b 2d6c 696b    lock: Lock-lik
+00023280: 6520 6f72 2046 616c 7365 0a20 2020 2020  e or False.     
+00023290: 2020 204c 6f63 6b20 746f 2075 7365 2062     Lock to use b
+000232a0: 6566 6f72 6520 7772 6974 696e 6720 746f  efore writing to
+000232b0: 2060 606f 7574 6060 2e0a 2020 2020 7265   ``out``..    re
+000232c0: 7475 726e 5f73 746f 7265 643a 2062 6f6f  turn_stored: boo
+000232d0: 6c0a 2020 2020 2020 2020 5768 6574 6865  l.        Whethe
+000232e0: 7220 746f 2072 6574 7572 6e20 6060 6f75  r to return ``ou
+000232f0: 7460 602e 0a20 2020 206c 6f61 645f 7374  t``..    load_st
+00023300: 6f72 6564 3a20 626f 6f6c 0a20 2020 2020  ored: bool.     
+00023310: 2020 2057 6865 7468 6572 2074 6f20 7265     Whether to re
+00023320: 7475 726e 2074 6865 2061 7272 6179 2073  turn the array s
+00023330: 746f 7265 6420 696e 2060 606f 7574 6060  tored in ``out``
+00023340: 2e0a 2020 2020 2020 2020 4967 6e6f 7265  ..        Ignore
+00023350: 6420 6966 2060 6072 6574 7572 6e5f 7374  d if ``return_st
+00023360: 6f72 6564 6060 2069 7320 6e6f 7420 6060  ored`` is not ``
+00023370: 5472 7565 6060 2e0a 0a20 2020 2052 6574  True``...    Ret
+00023380: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
+00023390: 0a0a 2020 2020 4966 2072 6574 7572 6e5f  ..    If return_
+000233a0: 7374 6f72 6564 3d54 7275 6520 616e 6420  stored=True and 
+000233b0: 6c6f 6164 5f73 746f 7265 643d 4661 6c73  load_stored=Fals
+000233c0: 650a 2020 2020 2020 2020 6f75 740a 2020  e.        out.  
+000233d0: 2020 4966 2072 6574 7572 6e5f 7374 6f72    If return_stor
+000233e0: 6564 3d54 7275 6520 616e 6420 6c6f 6164  ed=True and load
+000233f0: 5f73 746f 7265 643d 5472 7565 0a20 2020  _stored=True.   
+00023400: 2020 2020 206f 7574 5b69 6e64 6578 5d0a       out[index].
+00023410: 2020 2020 4966 2072 6574 7572 6e5f 7374      If return_st
+00023420: 6f72 6564 3d46 616c 7365 2061 6e64 2063  ored=False and c
+00023430: 6f6d 7075 7465 3d46 616c 7365 0a20 2020  ompute=False.   
+00023440: 2020 2020 204e 6f6e 650a 0a20 2020 2045       None..    E
+00023450: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
+00023460: 2d2d 2d2d 0a0a 2020 2020 3e3e 3e20 6120  ----..    >>> a 
+00023470: 3d20 6e70 2e6f 6e65 7328 2835 2c20 3629  = np.ones((5, 6)
+00023480: 290a 2020 2020 3e3e 3e20 6220 3d20 6e70  ).    >>> b = np
+00023490: 2e65 6d70 7479 2861 2e73 6861 7065 290a  .empty(a.shape).
+000234a0: 2020 2020 3e3e 3e20 6c6f 6164 5f73 746f      >>> load_sto
+000234b0: 7265 5f63 6875 6e6b 2861 2c20 622c 2028  re_chunk(a, b, (
+000234c0: 736c 6963 6528 4e6f 6e65 292c 2073 6c69  slice(None), sli
+000234d0: 6365 284e 6f6e 6529 292c 2046 616c 7365  ce(None)), False
+000234e0: 2c20 4661 6c73 652c 2046 616c 7365 290a  , False, False).
+000234f0: 2020 2020 2222 220a 2020 2020 6966 206c      """.    if l
+00023500: 6f63 6b3a 0a20 2020 2020 2020 206c 6f63  ock:.        loc
+00023510: 6b2e 6163 7175 6972 6528 290a 2020 2020  k.acquire().    
+00023520: 7472 793a 0a20 2020 2020 2020 2069 6620  try:.        if 
+00023530: 7820 6973 206e 6f74 204e 6f6e 653a 0a20  x is not None:. 
+00023540: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00023550: 5f61 7272 6179 6c69 6b65 2878 293a 0a20  _arraylike(x):. 
+00023560: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00023570: 7574 5b69 6e64 6578 5d20 3d20 780a 2020  ut[index] = x.  
+00023580: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00023590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000235a0: 6f75 745b 696e 6465 785d 203d 206e 702e  out[index] = np.
+000235b0: 6173 616e 7961 7272 6179 2878 290a 0a20  asanyarray(x).. 
+000235c0: 2020 2020 2020 2069 6620 7265 7475 726e         if return
+000235d0: 5f73 746f 7265 6420 616e 6420 6c6f 6164  _stored and load
+000235e0: 5f73 746f 7265 643a 0a20 2020 2020 2020  _stored:.       
+000235f0: 2020 2020 2072 6574 7572 6e20 6f75 745b       return out[
+00023600: 696e 6465 785d 0a20 2020 2020 2020 2065  index].        e
+00023610: 6c69 6620 7265 7475 726e 5f73 746f 7265  lif return_store
+00023620: 6420 616e 6420 6e6f 7420 6c6f 6164 5f73  d and not load_s
+00023630: 746f 7265 643a 0a20 2020 2020 2020 2020  tored:.         
+00023640: 2020 2072 6574 7572 6e20 6f75 740a 2020     return out.  
+00023650: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00023660: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+00023670: 6f6e 650a 2020 2020 6669 6e61 6c6c 793a  one.    finally:
+00023680: 0a20 2020 2020 2020 2069 6620 6c6f 636b  .        if lock
+00023690: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
+000236a0: 636b 2e72 656c 6561 7365 2829 0a0a 0a64  ck.release()...d
+000236b0: 6566 2073 746f 7265 5f63 6875 6e6b 280a  ef store_chunk(.
+000236c0: 2020 2020 783a 2041 7272 6179 4c69 6b65      x: ArrayLike
+000236d0: 2c20 6f75 743a 2041 7272 6179 4c69 6b65  , out: ArrayLike
+000236e0: 2c20 696e 6465 783a 2073 6c69 6365 2c20  , index: slice, 
+000236f0: 6c6f 636b 3a20 416e 792c 2072 6574 7572  lock: Any, retur
+00023700: 6e5f 7374 6f72 6564 3a20 626f 6f6c 0a29  n_stored: bool.)
+00023710: 3a0a 2020 2020 7265 7475 726e 206c 6f61  :.    return loa
+00023720: 645f 7374 6f72 655f 6368 756e 6b28 782c  d_store_chunk(x,
+00023730: 206f 7574 2c20 696e 6465 782c 206c 6f63   out, index, loc
+00023740: 6b2c 2072 6574 7572 6e5f 7374 6f72 6564  k, return_stored
+00023750: 2c20 4661 6c73 6529 0a0a 0a41 203d 2054  , False)...A = T
+00023760: 7970 6556 6172 2822 4122 2c20 626f 756e  ypeVar("A", boun
+00023770: 643d 4172 7261 794c 696b 6529 0a0a 0a64  d=ArrayLike)...d
+00023780: 6566 206c 6f61 645f 6368 756e 6b28 6f75  ef load_chunk(ou
+00023790: 743a 2041 2c20 696e 6465 783a 2073 6c69  t: A, index: sli
+000237a0: 6365 2c20 6c6f 636b 3a20 416e 7929 202d  ce, lock: Any) -
+000237b0: 3e20 413a 0a20 2020 2072 6574 7572 6e20  > A:.    return 
+000237c0: 6c6f 6164 5f73 746f 7265 5f63 6875 6e6b  load_store_chunk
+000237d0: 284e 6f6e 652c 206f 7574 2c20 696e 6465  (None, out, inde
+000237e0: 782c 206c 6f63 6b2c 2054 7275 652c 2054  x, lock, True, T
+000237f0: 7275 6529 0a0a 0a64 6566 2069 6e73 6572  rue)...def inser
+00023800: 745f 746f 5f6f 6f63 280a 2020 2020 6b65  t_to_ooc(.    ke
+00023810: 7973 3a20 6c69 7374 2c0a 2020 2020 6368  ys: list,.    ch
+00023820: 756e 6b73 3a20 7475 706c 655b 7475 706c  unks: tuple[tupl
+00023830: 655b 696e 742c 202e 2e2e 5d2c 202e 2e2e  e[int, ...], ...
+00023840: 5d2c 0a20 2020 206f 7574 3a20 4172 7261  ],.    out: Arra
+00023850: 794c 696b 652c 0a20 2020 206e 616d 653a  yLike,.    name:
+00023860: 2073 7472 2c0a 2020 2020 2a2c 0a20 2020   str,.    *,.   
+00023870: 206c 6f63 6b3a 204c 6f63 6b20 7c20 626f   lock: Lock | bo
+00023880: 6f6c 203d 2054 7275 652c 0a20 2020 2072  ol = True,.    r
+00023890: 6567 696f 6e3a 2074 7570 6c65 5b73 6c69  egion: tuple[sli
+000238a0: 6365 2c20 2e2e 2e5d 207c 2073 6c69 6365  ce, ...] | slice
+000238b0: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
+000238c0: 2020 2020 7265 7475 726e 5f73 746f 7265      return_store
+000238d0: 643a 2062 6f6f 6c20 3d20 4661 6c73 652c  d: bool = False,
+000238e0: 0a20 2020 206c 6f61 645f 7374 6f72 6564  .    load_stored
+000238f0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+00023900: 2920 2d3e 2064 6963 743a 0a20 2020 2022  ) -> dict:.    "
+00023910: 2222 0a20 2020 2043 7265 6174 6573 2061  "".    Creates a
+00023920: 2044 6173 6b20 6772 6170 6820 666f 7220   Dask graph for 
+00023930: 7374 6f72 696e 6720 6368 756e 6b73 2066  storing chunks f
+00023940: 726f 6d20 6060 6172 7260 6020 696e 2060  rom ``arr`` in `
+00023950: 606f 7574 6060 2e0a 0a20 2020 2050 6172  `out``...    Par
+00023960: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00023970: 2d2d 2d2d 2d2d 0a20 2020 206b 6579 733a  ------.    keys:
+00023980: 206c 6973 740a 2020 2020 2020 2020 4461   list.        Da
+00023990: 736b 206b 6579 7320 6f66 2074 6865 2069  sk keys of the i
+000239a0: 6e70 7574 2061 7272 6179 0a20 2020 2063  nput array.    c
+000239b0: 6875 6e6b 733a 2074 7570 6c65 0a20 2020  hunks: tuple.   
+000239c0: 2020 2020 2044 6173 6b20 6368 756e 6b73       Dask chunks
+000239d0: 206f 6620 7468 6520 696e 7075 7420 6172   of the input ar
+000239e0: 7261 790a 2020 2020 6f75 743a 2061 7272  ray.    out: arr
+000239f0: 6179 2d6c 696b 650a 2020 2020 2020 2020  ay-like.        
+00023a00: 5768 6572 6520 746f 2073 746f 7265 2072  Where to store r
+00023a10: 6573 756c 7473 2074 6f0a 2020 2020 6e61  esults to.    na
+00023a20: 6d65 3a20 7374 720a 2020 2020 2020 2020  me: str.        
+00023a30: 4669 7273 7420 656c 656d 656e 7420 6f66  First element of
+00023a40: 2064 6173 6b20 6b65 7973 0a20 2020 206c   dask keys.    l
+00023a50: 6f63 6b3a 204c 6f63 6b2d 6c69 6b65 206f  ock: Lock-like o
+00023a60: 7220 626f 6f6c 2c20 6f70 7469 6f6e 616c  r bool, optional
+00023a70: 0a20 2020 2020 2020 2057 6865 7468 6572  .        Whether
+00023a80: 2074 6f20 6c6f 636b 206f 7220 7769 7468   to lock or with
+00023a90: 2077 6861 7420 2864 6566 6175 6c74 2069   what (default i
+00023aa0: 7320 6060 5472 7565 6060 2c0a 2020 2020  s ``True``,.    
+00023ab0: 2020 2020 7768 6963 6820 6d65 616e 7320      which means 
+00023ac0: 6120 3a63 6c61 7373 3a60 7468 7265 6164  a :class:`thread
+00023ad0: 696e 672e 4c6f 636b 6020 696e 7374 616e  ing.Lock` instan
+00023ae0: 6365 292e 0a20 2020 2072 6567 696f 6e3a  ce)..    region:
+00023af0: 2073 6c69 6365 2d6c 696b 652c 206f 7074   slice-like, opt
+00023b00: 696f 6e61 6c0a 2020 2020 2020 2020 5768  ional.        Wh
+00023b10: 6572 6520 696e 2060 606f 7574 6060 2074  ere in ``out`` t
+00023b20: 6f20 7374 6f72 6520 6060 6172 7260 6027  o store ``arr``'
+00023b30: 7320 7265 7375 6c74 730a 2020 2020 2020  s results.      
+00023b40: 2020 2864 6566 6175 6c74 2069 7320 6060    (default is ``
+00023b50: 4e6f 6e65 6060 2c20 6d65 616e 696e 6720  None``, meaning 
+00023b60: 616c 6c20 6f66 2060 606f 7574 6060 292e  all of ``out``).
+00023b70: 0a20 2020 2072 6574 7572 6e5f 7374 6f72  .    return_stor
+00023b80: 6564 3a20 626f 6f6c 2c20 6f70 7469 6f6e  ed: bool, option
+00023b90: 616c 0a20 2020 2020 2020 2057 6865 7468  al.        Wheth
+00023ba0: 6572 2074 6f20 7265 7475 726e 2060 606f  er to return ``o
+00023bb0: 7574 6060 0a20 2020 2020 2020 2028 6465  ut``.        (de
+00023bc0: 6661 756c 7420 6973 2060 6046 616c 7365  fault is ``False
+00023bd0: 6060 2c20 6d65 616e 696e 6720 6060 4e6f  ``, meaning ``No
+00023be0: 6e65 6060 2069 7320 7265 7475 726e 6564  ne`` is returned
+00023bf0: 292e 0a20 2020 206c 6f61 645f 7374 6f72  )..    load_stor
+00023c00: 6564 3a20 626f 6f6c 2c20 6f70 7469 6f6e  ed: bool, option
+00023c10: 616c 0a20 2020 2020 2020 2057 6865 7468  al.        Wheth
+00023c20: 6572 2074 6f20 6861 6e64 6c69 6e67 206c  er to handling l
+00023c30: 6f61 6469 6e67 2066 726f 6d20 6060 6f75  oading from ``ou
+00023c40: 7460 6020 6174 2074 6865 2073 616d 6520  t`` at the same 
+00023c50: 7469 6d65 2e0a 2020 2020 2020 2020 4967  time..        Ig
+00023c60: 6e6f 7265 6420 6966 2060 6072 6574 7572  nored if ``retur
+00023c70: 6e5f 7374 6f72 6564 6060 2069 7320 6e6f  n_stored`` is no
+00023c80: 7420 6060 5472 7565 6060 2e0a 2020 2020  t ``True``..    
+00023c90: 2020 2020 2864 6566 6175 6c74 2069 7320      (default is 
+00023ca0: 6060 4661 6c73 6560 602c 206d 6561 6e69  ``False``, meani
+00023cb0: 6e67 2064 6566 6572 2074 6f20 6060 7265  ng defer to ``re
+00023cc0: 7475 726e 5f73 746f 7265 6460 6029 2e0a  turn_stored``)..
+00023cd0: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
+00023ce0: 202d 2d2d 2d2d 2d2d 0a20 2020 2064 6173   -------.    das
+00023cf0: 6b20 6772 6170 6820 6f66 2073 746f 7265  k graph of store
+00023d00: 206f 7065 7261 7469 6f6e 0a0a 2020 2020   operation..    
+00023d10: 4578 616d 706c 6573 0a20 2020 202d 2d2d  Examples.    ---
+00023d20: 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20 696d  -----.    >>> im
+00023d30: 706f 7274 2064 6173 6b2e 6172 7261 7920  port dask.array 
+00023d40: 6173 2064 610a 2020 2020 3e3e 3e20 6420  as da.    >>> d 
+00023d50: 3d20 6461 2e6f 6e65 7328 2835 2c20 3629  = da.ones((5, 6)
+00023d60: 2c20 6368 756e 6b73 3d28 322c 2033 2929  , chunks=(2, 3))
+00023d70: 0a20 2020 203e 3e3e 2061 203d 206e 702e  .    >>> a = np.
+00023d80: 656d 7074 7928 642e 7368 6170 6529 0a20  empty(d.shape). 
+00023d90: 2020 203e 3e3e 2069 6e73 6572 745f 746f     >>> insert_to
+00023da0: 5f6f 6f63 2864 2e5f 5f64 6173 6b5f 6b65  _ooc(d.__dask_ke
+00023db0: 7973 5f5f 2829 2c20 642e 6368 756e 6b73  ys__(), d.chunks
+00023dc0: 2c20 612c 2022 7374 6f72 652d 3132 3322  , a, "store-123"
+00023dd0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+00023de0: 4b49 500a 2020 2020 2222 220a 0a20 2020  KIP.    """..   
+00023df0: 2069 6620 6c6f 636b 2069 7320 5472 7565   if lock is True
+00023e00: 3a0a 2020 2020 2020 2020 6c6f 636b 203d  :.        lock =
+00023e10: 204c 6f63 6b28 290a 0a20 2020 2073 6c69   Lock()..    sli
+00023e20: 6365 7320 3d20 736c 6963 6573 5f66 726f  ces = slices_fro
+00023e30: 6d5f 6368 756e 6b73 2863 6875 6e6b 7329  m_chunks(chunks)
+00023e40: 0a20 2020 2069 6620 7265 6769 6f6e 3a0a  .    if region:.
+00023e50: 2020 2020 2020 2020 736c 6963 6573 203d          slices =
+00023e60: 205b 6675 7365 5f73 6c69 6365 2872 6567   [fuse_slice(reg
+00023e70: 696f 6e2c 2073 6c63 2920 666f 7220 736c  ion, slc) for sl
+00023e80: 6320 696e 2073 6c69 6365 735d 0a0a 2020  c in slices]..  
+00023e90: 2020 6966 2072 6574 7572 6e5f 7374 6f72    if return_stor
+00023ea0: 6564 2061 6e64 206c 6f61 645f 7374 6f72  ed and load_stor
+00023eb0: 6564 3a0a 2020 2020 2020 2020 6675 6e63  ed:.        func
+00023ec0: 203d 206c 6f61 645f 7374 6f72 655f 6368   = load_store_ch
+00023ed0: 756e 6b0a 2020 2020 2020 2020 6172 6773  unk.        args
+00023ee0: 203d 2028 6c6f 6164 5f73 746f 7265 642c   = (load_stored,
+00023ef0: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+00023f00: 2020 2020 6675 6e63 203d 2073 746f 7265      func = store
+00023f10: 5f63 6875 6e6b 2020 2320 7479 7065 3a20  _chunk  # type: 
+00023f20: 6967 6e6f 7265 0a20 2020 2020 2020 2061  ignore.        a
+00023f30: 7267 7320 3d20 2829 2020 2320 7479 7065  rgs = ()  # type
+00023f40: 3a20 6967 6e6f 7265 0a0a 2020 2020 6473  : ignore..    ds
+00023f50: 6b20 3d20 7b0a 2020 2020 2020 2020 286e  k = {.        (n
+00023f60: 616d 652c 2920 2b20 745b 313a 5d3a 2028  ame,) + t[1:]: (
+00023f70: 6675 6e63 2c20 742c 206f 7574 2c20 736c  func, t, out, sl
+00023f80: 632c 206c 6f63 6b2c 2072 6574 7572 6e5f  c, lock, return_
+00023f90: 7374 6f72 6564 2920 2b20 6172 6773 0a20  stored) + args. 
+00023fa0: 2020 2020 2020 2066 6f72 2074 2c20 736c         for t, sl
+00023fb0: 6320 696e 207a 6970 2863 6f72 652e 666c  c in zip(core.fl
+00023fc0: 6174 7465 6e28 6b65 7973 292c 2073 6c69  atten(keys), sli
+00023fd0: 6365 7329 0a20 2020 207d 0a20 2020 2072  ces).    }.    r
+00023fe0: 6574 7572 6e20 6473 6b0a 0a0a 6465 6620  eturn dsk...def 
+00023ff0: 7265 7472 6965 7665 5f66 726f 6d5f 6f6f  retrieve_from_oo
+00024000: 6328 0a20 2020 206b 6579 733a 2043 6f6c  c(.    keys: Col
+00024010: 6c65 6374 696f 6e5b 4861 7368 6162 6c65  lection[Hashable
+00024020: 5d2c 2064 736b 5f70 7265 3a20 4d61 7070  ], dsk_pre: Mapp
+00024030: 696e 672c 2064 736b 5f70 6f73 743a 204d  ing, dsk_post: M
+00024040: 6170 7069 6e67 0a29 202d 3e20 6469 6374  apping.) -> dict
+00024050: 5b74 7570 6c65 2c20 416e 795d 3a0a 2020  [tuple, Any]:.  
+00024060: 2020 2222 220a 2020 2020 4372 6561 7465    """.    Create
+00024070: 7320 6120 4461 736b 2067 7261 7068 2066  s a Dask graph f
+00024080: 6f72 206c 6f61 6469 6e67 2073 746f 7265  or loading store
+00024090: 6420 6060 6b65 7973 6060 2066 726f 6d20  d ``keys`` from 
+000240a0: 6060 6473 6b60 602e 0a0a 2020 2020 5061  ``dsk``...    Pa
+000240b0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+000240c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6b65 7973  -------.    keys
+000240d0: 3a20 436f 6c6c 6563 7469 6f6e 0a20 2020  : Collection.   
+000240e0: 2020 2020 2041 2073 6571 7565 6e63 6520       A sequence 
+000240f0: 636f 6e74 6169 6e69 6e67 2044 6173 6b20  containing Dask 
+00024100: 6772 6170 6820 6b65 7973 2074 6f20 6c6f  graph keys to lo
+00024110: 6164 0a20 2020 2064 736b 5f70 7265 3a20  ad.    dsk_pre: 
+00024120: 4d61 7070 696e 670a 2020 2020 2020 2020  Mapping.        
+00024130: 4120 4461 736b 2067 7261 7068 2063 6f72  A Dask graph cor
+00024140: 7265 7370 6f6e 6469 6e67 2074 6f20 6120  responding to a 
+00024150: 4461 736b 2041 7272 6179 2062 6566 6f72  Dask Array befor
+00024160: 6520 636f 6d70 7574 6174 696f 6e0a 2020  e computation.  
+00024170: 2020 6473 6b5f 706f 7374 3a20 4d61 7070    dsk_post: Mapp
+00024180: 696e 670a 2020 2020 2020 2020 4120 4461  ing.        A Da
+00024190: 736b 2067 7261 7068 2063 6f72 7265 7370  sk graph corresp
+000241a0: 6f6e 6469 6e67 2074 6f20 6120 4461 736b  onding to a Dask
+000241b0: 2041 7272 6179 2061 6674 6572 2063 6f6d   Array after com
+000241c0: 7075 7461 7469 6f6e 0a0a 2020 2020 4578  putation..    Ex
+000241d0: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
+000241e0: 2d2d 2d0a 2020 2020 3e3e 3e20 696d 706f  ---.    >>> impo
+000241f0: 7274 2064 6173 6b2e 6172 7261 7920 6173  rt dask.array as
+00024200: 2064 610a 2020 2020 3e3e 3e20 6420 3d20   da.    >>> d = 
+00024210: 6461 2e6f 6e65 7328 2835 2c20 3629 2c20  da.ones((5, 6), 
+00024220: 6368 756e 6b73 3d28 322c 2033 2929 0a20  chunks=(2, 3)). 
+00024230: 2020 203e 3e3e 2061 203d 206e 702e 656d     >>> a = np.em
+00024240: 7074 7928 642e 7368 6170 6529 0a20 2020  pty(d.shape).   
+00024250: 203e 3e3e 2067 203d 2069 6e73 6572 745f   >>> g = insert_
+00024260: 746f 5f6f 6f63 2864 2e5f 5f64 6173 6b5f  to_ooc(d.__dask_
+00024270: 6b65 7973 5f5f 2829 2c20 642e 6368 756e  keys__(), d.chun
+00024280: 6b73 2c20 612c 2022 7374 6f72 652d 3132  ks, a, "store-12
+00024290: 3322 290a 2020 2020 3e3e 3e20 7265 7472  3").    >>> retr
+000242a0: 6965 7665 5f66 726f 6d5f 6f6f 6328 672e  ieve_from_ooc(g.
+000242b0: 6b65 7973 2829 2c20 672c 207b 6b3a 206b  keys(), g, {k: k
+000242c0: 2066 6f72 206b 2069 6e20 672e 6b65 7973   for k in g.keys
+000242d0: 2829 7d29 2020 2320 646f 6374 6573 743a  ()})  # doctest:
+000242e0: 202b 534b 4950 0a20 2020 2022 2222 0a20   +SKIP.    """. 
+000242f0: 2020 206c 6f61 645f 6473 6b20 3d20 7b0a     load_dsk = {.
+00024300: 2020 2020 2020 2020 2822 6c6f 6164 2d22          ("load-"
+00024310: 202b 206b 5b30 5d2c 2920 2b20 6b5b 313a   + k[0],) + k[1:
+00024320: 5d3a 2028 6c6f 6164 5f63 6875 6e6b 2c20  ]: (load_chunk, 
+00024330: 6473 6b5f 706f 7374 5b6b 5d29 202b 2064  dsk_post[k]) + d
+00024340: 736b 5f70 7265 5b6b 5d5b 333a 2d31 5d20  sk_pre[k][3:-1] 
+00024350: 2023 2074 7970 653a 2069 676e 6f72 650a   # type: ignore.
+00024360: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
+00024370: 206b 6579 730a 2020 2020 7d0a 0a20 2020   keys.    }..   
+00024380: 2072 6574 7572 6e20 6c6f 6164 5f64 736b   return load_dsk
+00024390: 0a0a 0a64 6566 2061 7361 7272 6179 280a  ...def asarray(.
+000243a0: 2020 2020 612c 2061 6c6c 6f77 5f75 6e6b      a, allow_unk
+000243b0: 6e6f 776e 5f63 6875 6e6b 7369 7a65 733d  nown_chunksizes=
+000243c0: 4661 6c73 652c 2064 7479 7065 3d4e 6f6e  False, dtype=Non
+000243d0: 652c 206f 7264 6572 3d4e 6f6e 652c 202a  e, order=None, *
+000243e0: 2c20 6c69 6b65 3d4e 6f6e 652c 202a 2a6b  , like=None, **k
+000243f0: 7761 7267 730a 293a 0a20 2020 2022 2222  wargs.):.    """
+00024400: 436f 6e76 6572 7420 7468 6520 696e 7075  Convert the inpu
+00024410: 7420 746f 2061 2064 6173 6b20 6172 7261  t to a dask arra
+00024420: 792e 0a0a 2020 2020 5061 7261 6d65 7465  y...    Paramete
+00024430: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+00024440: 2d0a 2020 2020 6120 3a20 6172 7261 792d  -.    a : array-
+00024450: 6c69 6b65 0a20 2020 2020 2020 2049 6e70  like.        Inp
+00024460: 7574 2064 6174 612c 2069 6e20 616e 7920  ut data, in any 
+00024470: 666f 726d 2074 6861 7420 6361 6e20 6265  form that can be
+00024480: 2063 6f6e 7665 7274 6564 2074 6f20 6120   converted to a 
+00024490: 6461 736b 2061 7272 6179 2e20 5468 6973  dask array. This
+000244a0: 0a20 2020 2020 2020 2069 6e63 6c75 6465  .        include
+000244b0: 7320 6c69 7374 732c 206c 6973 7473 206f  s lists, lists o
+000244c0: 6620 7475 706c 6573 2c20 7475 706c 6573  f tuples, tuples
+000244d0: 2c20 7475 706c 6573 206f 6620 7475 706c  , tuples of tupl
+000244e0: 6573 2c20 7475 706c 6573 206f 660a 2020  es, tuples of.  
+000244f0: 2020 2020 2020 6c69 7374 7320 616e 6420        lists and 
+00024500: 6e64 6172 7261 7973 2e0a 2020 2020 616c  ndarrays..    al
+00024510: 6c6f 775f 756e 6b6e 6f77 6e5f 6368 756e  low_unknown_chun
+00024520: 6b73 697a 6573 3a20 626f 6f6c 0a20 2020  ksizes: bool.   
+00024530: 2020 2020 2041 6c6c 6f77 2075 6e6b 6e6f       Allow unkno
+00024540: 776e 2063 6875 6e6b 7369 7a65 732c 2073  wn chunksizes, s
+00024550: 7563 6820 6173 2063 6f6d 6520 6672 6f6d  uch as come from
+00024560: 2063 6f6e 7665 7274 696e 6720 6672 6f6d   converting from
+00024570: 2064 6173 6b0a 2020 2020 2020 2020 6461   dask.        da
+00024580: 7461 6672 616d 6573 2e20 2044 6173 6b2e  taframes.  Dask.
+00024590: 6172 7261 7920 6973 2075 6e61 626c 6520  array is unable 
+000245a0: 746f 2076 6572 6966 7920 7468 6174 2063  to verify that c
+000245b0: 6875 6e6b 7320 6c69 6e65 2075 702e 2020  hunks line up.  
+000245c0: 4966 0a20 2020 2020 2020 2064 6174 6120  If.        data 
+000245d0: 636f 6d65 7320 6672 6f6d 2064 6966 6665  comes from diffe
+000245e0: 7265 6e74 6c79 2061 6c69 676e 6564 2073  rently aligned s
+000245f0: 6f75 7263 6573 2074 6865 6e20 7468 6973  ources then this
+00024600: 2063 616e 2063 6175 7365 0a20 2020 2020   can cause.     
+00024610: 2020 2075 6e65 7870 6563 7465 6420 7265     unexpected re
+00024620: 7375 6c74 732e 0a20 2020 2064 7479 7065  sults..    dtype
+00024630: 203a 2064 6174 612d 7479 7065 2c20 6f70   : data-type, op
+00024640: 7469 6f6e 616c 0a20 2020 2020 2020 2042  tional.        B
+00024650: 7920 6465 6661 756c 742c 2074 6865 2064  y default, the d
+00024660: 6174 612d 7479 7065 2069 7320 696e 6665  ata-type is infe
+00024670: 7272 6564 2066 726f 6d20 7468 6520 696e  rred from the in
+00024680: 7075 7420 6461 7461 2e0a 2020 2020 6f72  put data..    or
+00024690: 6465 7220 3a20 7be2 8098 43e2 8099 2c20  der : {...C..., 
+000246a0: e280 9846 e280 992c 20e2 8098 41e2 8099  ...F..., ...A...
+000246b0: 2c20 e280 984b e280 997d 2c20 6f70 7469  , ...K...}, opti
+000246c0: 6f6e 616c 0a20 2020 2020 2020 204d 656d  onal.        Mem
+000246d0: 6f72 7920 6c61 796f 7574 2e20 e280 9841  ory layout. ...A
+000246e0: e280 9920 616e 6420 e280 984b e280 9920  ... and ...K... 
+000246f0: 6465 7065 6e64 206f 6e20 7468 6520 6f72  depend on the or
+00024700: 6465 7220 6f66 2069 6e70 7574 2061 7272  der of input arr
+00024710: 6179 2061 2e0a 2020 2020 2020 2020 e280  ay a..        ..
+00024720: 9843 e280 9920 726f 772d 6d61 6a6f 7220  .C... row-major 
+00024730: 2843 2d73 7479 6c65 292c 20e2 8098 46e2  (C-style), ...F.
+00024740: 8099 2063 6f6c 756d 6e2d 6d61 6a6f 7220  .. column-major 
+00024750: 2846 6f72 7472 616e 2d73 7479 6c65 2920  (Fortran-style) 
+00024760: 6d65 6d6f 7279 0a20 2020 2020 2020 2072  memory.        r
+00024770: 6570 7265 7365 6e74 6174 696f 6e2e 20e2  epresentation. .
+00024780: 8098 41e2 8099 2028 616e 7929 206d 6561  ..A... (any) mea
+00024790: 6e73 20e2 8098 46e2 8099 2069 6620 6120  ns ...F... if a 
+000247a0: 6973 2046 6f72 7472 616e 2063 6f6e 7469  is Fortran conti
+000247b0: 6775 6f75 732c 20e2 8098 43e2 8099 0a20  guous, ...C.... 
+000247c0: 2020 2020 2020 206f 7468 6572 7769 7365         otherwise
+000247d0: 20e2 8098 4be2 8099 2028 6b65 6570 2920   ...K... (keep) 
+000247e0: 7072 6573 6572 7665 2069 6e70 7574 206f  preserve input o
+000247f0: 7264 6572 2e20 4465 6661 756c 7473 2074  rder. Defaults t
+00024800: 6f20 e280 9843 e280 992e 0a20 2020 206c  o ...C.....    l
+00024810: 696b 653a 2061 7272 6179 2d6c 696b 650a  ike: array-like.
+00024820: 2020 2020 2020 2020 5265 6665 7265 6e63          Referenc
+00024830: 6520 6f62 6a65 6374 2074 6f20 616c 6c6f  e object to allo
+00024840: 7720 7468 6520 6372 6561 7469 6f6e 206f  w the creation o
+00024850: 6620 4461 736b 2061 7272 6179 7320 7769  f Dask arrays wi
+00024860: 7468 2063 6875 6e6b 730a 2020 2020 2020  th chunks.      
+00024870: 2020 7468 6174 2061 7265 206e 6f74 204e    that are not N
+00024880: 756d 5079 2061 7272 6179 732e 2049 6620  umPy arrays. If 
+00024890: 616e 2061 7272 6179 2d6c 696b 6520 7061  an array-like pa
+000248a0: 7373 6564 2069 6e20 6173 2060 606c 696b  ssed in as ``lik
+000248b0: 6560 600a 2020 2020 2020 2020 7375 7070  e``.        supp
+000248c0: 6f72 7473 2074 6865 2060 605f 5f61 7272  orts the ``__arr
+000248d0: 6179 5f66 756e 6374 696f 6e5f 5f60 6020  ay_function__`` 
+000248e0: 7072 6f74 6f63 6f6c 2c20 7468 6520 6368  protocol, the ch
+000248f0: 756e 6b20 7479 7065 206f 6620 7468 650a  unk type of the.
+00024900: 2020 2020 2020 2020 7265 7375 6c74 696e          resultin
+00024910: 6720 6172 7261 7920 7769 6c6c 2062 6520  g array will be 
+00024920: 6465 6669 6e64 6520 6279 2069 742e 2049  definde by it. I
+00024930: 6e20 7468 6973 2063 6173 652c 2069 7420  n this case, it 
+00024940: 656e 7375 7265 7320 7468 650a 2020 2020  ensures the.    
+00024950: 2020 2020 6372 6561 7469 6f6e 206f 6620      creation of 
+00024960: 6120 4461 736b 2061 7272 6179 2063 6f6d  a Dask array com
+00024970: 7061 7469 626c 6520 7769 7468 2074 6861  patible with tha
+00024980: 7420 7061 7373 6564 2069 6e20 7669 6120  t passed in via 
+00024990: 7468 6973 0a20 2020 2020 2020 2061 7267  this.        arg
+000249a0: 756d 656e 742e 2049 6620 6060 6c69 6b65  ument. If ``like
+000249b0: 6060 2069 7320 6120 4461 736b 2061 7272  `` is a Dask arr
+000249c0: 6179 2c20 7468 6520 6368 756e 6b20 7479  ay, the chunk ty
+000249d0: 7065 206f 6620 7468 650a 2020 2020 2020  pe of the.      
+000249e0: 2020 7265 7375 6c74 696e 6720 6172 7261    resulting arra
+000249f0: 7920 7769 6c6c 2062 6520 6465 6669 6e65  y will be define
+00024a00: 6420 6279 2074 6865 2063 6875 6e6b 2074  d by the chunk t
+00024a10: 7970 6520 6f66 2060 606c 696b 6560 602e  ype of ``like``.
+00024a20: 0a20 2020 2020 2020 2052 6571 7569 7265  .        Require
+00024a30: 7320 4e75 6d50 7920 312e 3230 2e30 206f  s NumPy 1.20.0 o
+00024a40: 7220 6869 6768 6572 2e0a 0a20 2020 2052  r higher...    R
+00024a50: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
+00024a60: 2d2d 0a20 2020 206f 7574 203a 2064 6173  --.    out : das
+00024a70: 6b20 6172 7261 790a 2020 2020 2020 2020  k array.        
+00024a80: 4461 736b 2061 7272 6179 2069 6e74 6572  Dask array inter
+00024a90: 7072 6574 6174 696f 6e20 6f66 2061 2e0a  pretation of a..
+00024aa0: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
+00024ab0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e    --------.    >
+00024ac0: 3e3e 2069 6d70 6f72 7420 6461 736b 2e61  >> import dask.a
+00024ad0: 7272 6179 2061 7320 6461 0a20 2020 203e  rray as da.    >
+00024ae0: 3e3e 2069 6d70 6f72 7420 6e75 6d70 7920  >> import numpy 
+00024af0: 6173 206e 700a 2020 2020 3e3e 3e20 7820  as np.    >>> x 
+00024b00: 3d20 6e70 2e61 7261 6e67 6528 3329 0a20  = np.arange(3). 
+00024b10: 2020 203e 3e3e 2064 612e 6173 6172 7261     >>> da.asarra
+00024b20: 7928 7829 0a20 2020 2064 6173 6b2e 6172  y(x).    dask.ar
+00024b30: 7261 793c 6172 7261 792c 2073 6861 7065  ray<array, shape
+00024b40: 3d28 332c 292c 2064 7479 7065 3d69 6e74  =(3,), dtype=int
+00024b50: 3634 2c20 6368 756e 6b73 697a 653d 2833  64, chunksize=(3
+00024b60: 2c29 2c20 6368 756e 6b74 7970 653d 6e75  ,), chunktype=nu
+00024b70: 6d70 792e 6e64 6172 7261 793e 0a0a 2020  mpy.ndarray>..  
+00024b80: 2020 3e3e 3e20 7920 3d20 5b5b 312c 2032    >>> y = [[1, 2
+00024b90: 2c20 335d 2c20 5b34 2c20 352c 2036 5d5d  , 3], [4, 5, 6]]
+00024ba0: 0a20 2020 203e 3e3e 2064 612e 6173 6172  .    >>> da.asar
+00024bb0: 7261 7928 7929 0a20 2020 2064 6173 6b2e  ray(y).    dask.
+00024bc0: 6172 7261 793c 6172 7261 792c 2073 6861  array<array, sha
+00024bd0: 7065 3d28 322c 2033 292c 2064 7479 7065  pe=(2, 3), dtype
+00024be0: 3d69 6e74 3634 2c20 6368 756e 6b73 697a  =int64, chunksiz
+00024bf0: 653d 2832 2c20 3329 2c20 6368 756e 6b74  e=(2, 3), chunkt
+00024c00: 7970 653d 6e75 6d70 792e 6e64 6172 7261  ype=numpy.ndarra
+00024c10: 793e 0a20 2020 2022 2222 0a20 2020 2069  y>.    """.    i
+00024c20: 6620 6c69 6b65 2069 7320 4e6f 6e65 3a0a  f like is None:.
+00024c30: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00024c40: 7461 6e63 6528 612c 2041 7272 6179 293a  tance(a, Array):
+00024c50: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00024c60: 7572 6e20 610a 2020 2020 2020 2020 656c  urn a.        el
+00024c70: 6966 2068 6173 6174 7472 2861 2c20 2274  if hasattr(a, "t
+00024c80: 6f5f 6461 736b 5f61 7272 6179 2229 3a0a  o_dask_array"):.
+00024c90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00024ca0: 726e 2061 2e74 6f5f 6461 736b 5f61 7272  rn a.to_dask_arr
+00024cb0: 6179 2829 0a20 2020 2020 2020 2065 6c69  ay().        eli
+00024cc0: 6620 7479 7065 2861 292e 5f5f 6d6f 6475  f type(a).__modu
+00024cd0: 6c65 5f5f 2e73 706c 6974 2822 2e22 295b  le__.split(".")[
+00024ce0: 305d 203d 3d20 2278 6172 7261 7922 2061  0] == "xarray" a
+00024cf0: 6e64 2068 6173 6174 7472 2861 2c20 2264  nd hasattr(a, "d
+00024d00: 6174 6122 293a 0a20 2020 2020 2020 2020  ata"):.         
+00024d10: 2020 2072 6574 7572 6e20 6173 6172 7261     return asarra
+00024d20: 7928 612e 6461 7461 290a 2020 2020 2020  y(a.data).      
+00024d30: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00024d40: 6528 612c 2028 6c69 7374 2c20 7475 706c  e(a, (list, tupl
+00024d50: 6529 2920 616e 6420 616e 7928 6973 696e  e)) and any(isin
+00024d60: 7374 616e 6365 2869 2c20 4172 7261 7929  stance(i, Array)
+00024d70: 2066 6f72 2069 2069 6e20 6129 3a0a 2020   for i in a):.  
+00024d80: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00024d90: 2073 7461 636b 2861 2c20 616c 6c6f 775f   stack(a, allow_
+00024da0: 756e 6b6e 6f77 6e5f 6368 756e 6b73 697a  unknown_chunksiz
+00024db0: 6573 3d61 6c6c 6f77 5f75 6e6b 6e6f 776e  es=allow_unknown
+00024dc0: 5f63 6875 6e6b 7369 7a65 7329 0a20 2020  _chunksizes).   
+00024dd0: 2020 2020 2065 6c69 6620 6e6f 7420 6973       elif not is
+00024de0: 696e 7374 616e 6365 2867 6574 6174 7472  instance(getattr
+00024df0: 2861 2c20 2273 6861 7065 222c 204e 6f6e  (a, "shape", Non
+00024e00: 6529 2c20 4974 6572 6162 6c65 293a 0a20  e), Iterable):. 
+00024e10: 2020 2020 2020 2020 2020 2061 203d 206e             a = n
+00024e20: 702e 6173 6172 7261 7928 612c 2064 7479  p.asarray(a, dty
+00024e30: 7065 3d64 7479 7065 2c20 6f72 6465 723d  pe=dtype, order=
+00024e40: 6f72 6465 7229 0a20 2020 2065 6c73 653a  order).    else:
+00024e50: 0a20 2020 2020 2020 206c 696b 655f 6d65  .        like_me
+00024e60: 7461 203d 206d 6574 615f 6672 6f6d 5f61  ta = meta_from_a
+00024e70: 7272 6179 286c 696b 6529 0a20 2020 2020  rray(like).     
+00024e80: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00024e90: 2861 2c20 4172 7261 7929 3a0a 2020 2020  (a, Array):.    
+00024ea0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00024eb0: 2e6d 6170 5f62 6c6f 636b 7328 6e70 2e61  .map_blocks(np.a
+00024ec0: 7361 7272 6179 2c20 6c69 6b65 3d6c 696b  sarray, like=lik
+00024ed0: 655f 6d65 7461 2c20 6474 7970 653d 6474  e_meta, dtype=dt
+00024ee0: 7970 652c 206f 7264 6572 3d6f 7264 6572  ype, order=order
+00024ef0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00024f00: 2020 2020 2020 2020 2020 2020 6120 3d20              a = 
+00024f10: 6e70 2e61 7361 7272 6179 2861 2c20 6c69  np.asarray(a, li
+00024f20: 6b65 3d6c 696b 655f 6d65 7461 2c20 6474  ke=like_meta, dt
+00024f30: 7970 653d 6474 7970 652c 206f 7264 6572  ype=dtype, order
+00024f40: 3d6f 7264 6572 290a 2020 2020 7265 7475  =order).    retu
+00024f50: 726e 2066 726f 6d5f 6172 7261 7928 612c  rn from_array(a,
+00024f60: 2067 6574 6974 656d 3d67 6574 7465 725f   getitem=getter_
+00024f70: 696e 6c69 6e65 2c20 2a2a 6b77 6172 6773  inline, **kwargs
+00024f80: 290a 0a0a 6465 6620 6173 616e 7961 7272  )...def asanyarr
+00024f90: 6179 2861 2c20 6474 7970 653d 4e6f 6e65  ay(a, dtype=None
+00024fa0: 2c20 6f72 6465 723d 4e6f 6e65 2c20 2a2c  , order=None, *,
+00024fb0: 206c 696b 653d 4e6f 6e65 2c20 696e 6c69   like=None, inli
+00024fc0: 6e65 5f61 7272 6179 3d46 616c 7365 293a  ne_array=False):
+00024fd0: 0a20 2020 2022 2222 436f 6e76 6572 7420  .    """Convert 
+00024fe0: 7468 6520 696e 7075 7420 746f 2061 2064  the input to a d
+00024ff0: 6173 6b20 6172 7261 792e 0a0a 2020 2020  ask array...    
+00025000: 5375 6263 6c61 7373 6573 206f 6620 6060  Subclasses of ``
+00025010: 6e70 2e6e 6461 7272 6179 6060 2077 696c  np.ndarray`` wil
+00025020: 6c20 6265 2070 6173 7365 6420 7468 726f  l be passed thro
+00025030: 7567 6820 6173 2063 6875 6e6b 7320 756e  ugh as chunks un
+00025040: 6368 616e 6765 642e 0a0a 2020 2020 5061  changed...    Pa
+00025050: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+00025060: 2d2d 2d2d 2d2d 2d0a 2020 2020 6120 3a20  -------.    a : 
+00025070: 6172 7261 792d 6c69 6b65 0a20 2020 2020  array-like.     
+00025080: 2020 2049 6e70 7574 2064 6174 612c 2069     Input data, i
+00025090: 6e20 616e 7920 666f 726d 2074 6861 7420  n any form that 
+000250a0: 6361 6e20 6265 2063 6f6e 7665 7274 6564  can be converted
+000250b0: 2074 6f20 6120 6461 736b 2061 7272 6179   to a dask array
+000250c0: 2e20 5468 6973 0a20 2020 2020 2020 2069  . This.        i
+000250d0: 6e63 6c75 6465 7320 6c69 7374 732c 206c  ncludes lists, l
+000250e0: 6973 7473 206f 6620 7475 706c 6573 2c20  ists of tuples, 
+000250f0: 7475 706c 6573 2c20 7475 706c 6573 206f  tuples, tuples o
+00025100: 6620 7475 706c 6573 2c20 7475 706c 6573  f tuples, tuples
+00025110: 206f 660a 2020 2020 2020 2020 6c69 7374   of.        list
+00025120: 7320 616e 6420 6e64 6172 7261 7973 2e0a  s and ndarrays..
+00025130: 2020 2020 6474 7970 6520 3a20 6461 7461      dtype : data
+00025140: 2d74 7970 652c 206f 7074 696f 6e61 6c0a  -type, optional.
+00025150: 2020 2020 2020 2020 4279 2064 6566 6175          By defau
+00025160: 6c74 2c20 7468 6520 6461 7461 2d74 7970  lt, the data-typ
+00025170: 6520 6973 2069 6e66 6572 7265 6420 6672  e is inferred fr
+00025180: 6f6d 2074 6865 2069 6e70 7574 2064 6174  om the input dat
+00025190: 612e 0a20 2020 206f 7264 6572 203a 207b  a..    order : {
+000251a0: e280 9843 e280 992c 20e2 8098 46e2 8099  ...C..., ...F...
+000251b0: 2c20 e280 9841 e280 992c 20e2 8098 4be2  , ...A..., ...K.
+000251c0: 8099 7d2c 206f 7074 696f 6e61 6c0a 2020  ..}, optional.  
+000251d0: 2020 2020 2020 4d65 6d6f 7279 206c 6179        Memory lay
+000251e0: 6f75 742e 20e2 8098 41e2 8099 2061 6e64  out. ...A... and
+000251f0: 20e2 8098 4be2 8099 2064 6570 656e 6420   ...K... depend 
+00025200: 6f6e 2074 6865 206f 7264 6572 206f 6620  on the order of 
+00025210: 696e 7075 7420 6172 7261 7920 612e 0a20  input array a.. 
+00025220: 2020 2020 2020 20e2 8098 43e2 8099 2072         ...C... r
+00025230: 6f77 2d6d 616a 6f72 2028 432d 7374 796c  ow-major (C-styl
+00025240: 6529 2c20 e280 9846 e280 9920 636f 6c75  e), ...F... colu
+00025250: 6d6e 2d6d 616a 6f72 2028 466f 7274 7261  mn-major (Fortra
+00025260: 6e2d 7374 796c 6529 206d 656d 6f72 790a  n-style) memory.
+00025270: 2020 2020 2020 2020 7265 7072 6573 656e          represen
+00025280: 7461 7469 6f6e 2e20 e280 9841 e280 9920  tation. ...A... 
+00025290: 2861 6e79 2920 6d65 616e 7320 e280 9846  (any) means ...F
+000252a0: e280 9920 6966 2061 2069 7320 466f 7274  ... if a is Fort
+000252b0: 7261 6e20 636f 6e74 6967 756f 7573 2c20  ran contiguous, 
+000252c0: e280 9843 e280 990a 2020 2020 2020 2020  ...C....        
+000252d0: 6f74 6865 7277 6973 6520 e280 984b e280  otherwise ...K..
+000252e0: 9920 286b 6565 7029 2070 7265 7365 7276  . (keep) preserv
+000252f0: 6520 696e 7075 7420 6f72 6465 722e 2044  e input order. D
+00025300: 6566 6175 6c74 7320 746f 20e2 8098 43e2  efaults to ...C.
+00025310: 8099 2e0a 2020 2020 6c69 6b65 3a20 6172  ....    like: ar
+00025320: 7261 792d 6c69 6b65 0a20 2020 2020 2020  ray-like.       
+00025330: 2052 6566 6572 656e 6365 206f 626a 6563   Reference objec
+00025340: 7420 746f 2061 6c6c 6f77 2074 6865 2063  t to allow the c
+00025350: 7265 6174 696f 6e20 6f66 2044 6173 6b20  reation of Dask 
+00025360: 6172 7261 7973 2077 6974 6820 6368 756e  arrays with chun
+00025370: 6b73 0a20 2020 2020 2020 2074 6861 7420  ks.        that 
+00025380: 6172 6520 6e6f 7420 4e75 6d50 7920 6172  are not NumPy ar
+00025390: 7261 7973 2e20 4966 2061 6e20 6172 7261  rays. If an arra
+000253a0: 792d 6c69 6b65 2070 6173 7365 6420 696e  y-like passed in
+000253b0: 2061 7320 6060 6c69 6b65 6060 0a20 2020   as ``like``.   
+000253c0: 2020 2020 2073 7570 706f 7274 7320 7468       supports th
+000253d0: 6520 6060 5f5f 6172 7261 795f 6675 6e63  e ``__array_func
+000253e0: 7469 6f6e 5f5f 6060 2070 726f 746f 636f  tion__`` protoco
+000253f0: 6c2c 2074 6865 2063 6875 6e6b 2074 7970  l, the chunk typ
+00025400: 6520 6f66 2074 6865 0a20 2020 2020 2020  e of the.       
+00025410: 2072 6573 756c 7469 6e67 2061 7272 6179   resulting array
+00025420: 2077 696c 6c20 6265 2064 6566 696e 6465   will be definde
+00025430: 2062 7920 6974 2e20 496e 2074 6869 7320   by it. In this 
+00025440: 6361 7365 2c20 6974 2065 6e73 7572 6573  case, it ensures
+00025450: 2074 6865 0a20 2020 2020 2020 2063 7265   the.        cre
+00025460: 6174 696f 6e20 6f66 2061 2044 6173 6b20  ation of a Dask 
+00025470: 6172 7261 7920 636f 6d70 6174 6962 6c65  array compatible
+00025480: 2077 6974 6820 7468 6174 2070 6173 7365   with that passe
+00025490: 6420 696e 2076 6961 2074 6869 730a 2020  d in via this.  
+000254a0: 2020 2020 2020 6172 6775 6d65 6e74 2e20        argument. 
+000254b0: 4966 2060 606c 696b 6560 6020 6973 2061  If ``like`` is a
+000254c0: 2044 6173 6b20 6172 7261 792c 2074 6865   Dask array, the
+000254d0: 2063 6875 6e6b 2074 7970 6520 6f66 2074   chunk type of t
+000254e0: 6865 0a20 2020 2020 2020 2072 6573 756c  he.        resul
+000254f0: 7469 6e67 2061 7272 6179 2077 696c 6c20  ting array will 
+00025500: 6265 2064 6566 696e 6564 2062 7920 7468  be defined by th
+00025510: 6520 6368 756e 6b20 7479 7065 206f 6620  e chunk type of 
+00025520: 6060 6c69 6b65 6060 2e0a 2020 2020 2020  ``like``..      
+00025530: 2020 5265 7175 6972 6573 204e 756d 5079    Requires NumPy
+00025540: 2031 2e32 302e 3020 6f72 2068 6967 6865   1.20.0 or highe
+00025550: 722e 0a20 2020 2069 6e6c 696e 655f 6172  r..    inline_ar
+00025560: 7261 793a 0a20 2020 2020 2020 2057 6865  ray:.        Whe
+00025570: 7468 6572 2074 6f20 696e 6c69 6e65 2074  ther to inline t
+00025580: 6865 2061 7272 6179 2069 6e20 7468 6520  he array in the 
+00025590: 7265 7375 6c74 696e 6720 6461 736b 2067  resulting dask g
+000255a0: 7261 7068 2e20 466f 7220 6d6f 7265 2069  raph. For more i
+000255b0: 6e66 6f72 6d61 7469 6f6e 2c0a 2020 2020  nformation,.    
+000255c0: 2020 2020 7365 6520 7468 6520 646f 6375      see the docu
+000255d0: 6d65 6e74 6174 696f 6e20 666f 7220 6060  mentation for ``
+000255e0: 6461 736b 2e61 7272 6179 2e66 726f 6d5f  dask.array.from_
+000255f0: 6172 7261 7928 2960 602e 0a0a 2020 2020  array()``...    
+00025600: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
+00025610: 2d2d 2d0a 2020 2020 6f75 7420 3a20 6461  ---.    out : da
+00025620: 736b 2061 7272 6179 0a20 2020 2020 2020  sk array.       
+00025630: 2044 6173 6b20 6172 7261 7920 696e 7465   Dask array inte
+00025640: 7270 7265 7461 7469 6f6e 206f 6620 612e  rpretation of a.
+00025650: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
+00025660: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00025670: 3e3e 3e20 696d 706f 7274 2064 6173 6b2e  >>> import dask.
+00025680: 6172 7261 7920 6173 2064 610a 2020 2020  array as da.    
+00025690: 3e3e 3e20 696d 706f 7274 206e 756d 7079  >>> import numpy
+000256a0: 2061 7320 6e70 0a20 2020 203e 3e3e 2078   as np.    >>> x
+000256b0: 203d 206e 702e 6172 616e 6765 2833 290a   = np.arange(3).
+000256c0: 2020 2020 3e3e 3e20 6461 2e61 7361 6e79      >>> da.asany
+000256d0: 6172 7261 7928 7829 0a20 2020 2064 6173  array(x).    das
+000256e0: 6b2e 6172 7261 793c 6172 7261 792c 2073  k.array<array, s
+000256f0: 6861 7065 3d28 332c 292c 2064 7479 7065  hape=(3,), dtype
+00025700: 3d69 6e74 3634 2c20 6368 756e 6b73 697a  =int64, chunksiz
+00025710: 653d 2833 2c29 2c20 6368 756e 6b74 7970  e=(3,), chunktyp
+00025720: 653d 6e75 6d70 792e 6e64 6172 7261 793e  e=numpy.ndarray>
+00025730: 0a0a 2020 2020 3e3e 3e20 7920 3d20 5b5b  ..    >>> y = [[
+00025740: 312c 2032 2c20 335d 2c20 5b34 2c20 352c  1, 2, 3], [4, 5,
+00025750: 2036 5d5d 0a20 2020 203e 3e3e 2064 612e   6]].    >>> da.
+00025760: 6173 616e 7961 7272 6179 2879 290a 2020  asanyarray(y).  
+00025770: 2020 6461 736b 2e61 7272 6179 3c61 7272    dask.array<arr
+00025780: 6179 2c20 7368 6170 653d 2832 2c20 3329  ay, shape=(2, 3)
+00025790: 2c20 6474 7970 653d 696e 7436 342c 2063  , dtype=int64, c
+000257a0: 6875 6e6b 7369 7a65 3d28 322c 2033 292c  hunksize=(2, 3),
+000257b0: 2063 6875 6e6b 7479 7065 3d6e 756d 7079   chunktype=numpy
+000257c0: 2e6e 6461 7272 6179 3e0a 2020 2020 2222  .ndarray>.    ""
+000257d0: 220a 2020 2020 6966 206c 696b 6520 6973  ".    if like is
+000257e0: 204e 6f6e 653a 0a20 2020 2020 2020 2069   None:.        i
+000257f0: 6620 6973 696e 7374 616e 6365 2861 2c20  f isinstance(a, 
+00025800: 4172 7261 7929 3a0a 2020 2020 2020 2020  Array):.        
+00025810: 2020 2020 7265 7475 726e 2061 0a20 2020      return a.   
+00025820: 2020 2020 2065 6c69 6620 6861 7361 7474       elif hasatt
+00025830: 7228 612c 2022 746f 5f64 6173 6b5f 6172  r(a, "to_dask_ar
+00025840: 7261 7922 293a 0a20 2020 2020 2020 2020  ray"):.         
+00025850: 2020 2072 6574 7572 6e20 612e 746f 5f64     return a.to_d
+00025860: 6173 6b5f 6172 7261 7928 290a 2020 2020  ask_array().    
+00025870: 2020 2020 656c 6966 2074 7970 6528 6129      elif type(a)
+00025880: 2e5f 5f6d 6f64 756c 655f 5f2e 7370 6c69  .__module__.spli
+00025890: 7428 222e 2229 5b30 5d20 3d3d 2022 7861  t(".")[0] == "xa
+000258a0: 7272 6179 2220 616e 6420 6861 7361 7474  rray" and hasatt
+000258b0: 7228 612c 2022 6461 7461 2229 3a0a 2020  r(a, "data"):.  
+000258c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000258d0: 2061 7361 6e79 6172 7261 7928 612e 6461   asanyarray(a.da
+000258e0: 7461 290a 2020 2020 2020 2020 656c 6966  ta).        elif
+000258f0: 2069 7369 6e73 7461 6e63 6528 612c 2028   isinstance(a, (
+00025900: 6c69 7374 2c20 7475 706c 6529 2920 616e  list, tuple)) an
+00025910: 6420 616e 7928 6973 696e 7374 616e 6365  d any(isinstance
+00025920: 2869 2c20 4172 7261 7929 2066 6f72 2069  (i, Array) for i
+00025930: 2069 6e20 6129 3a0a 2020 2020 2020 2020   in a):.        
+00025940: 2020 2020 7265 7475 726e 2073 7461 636b      return stack
+00025950: 2861 290a 2020 2020 2020 2020 656c 6966  (a).        elif
+00025960: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00025970: 6765 7461 7474 7228 612c 2022 7368 6170  getattr(a, "shap
+00025980: 6522 2c20 4e6f 6e65 292c 2049 7465 7261  e", None), Itera
+00025990: 626c 6529 3a0a 2020 2020 2020 2020 2020  ble):.          
+000259a0: 2020 6120 3d20 6e70 2e61 7361 6e79 6172    a = np.asanyar
+000259b0: 7261 7928 612c 2064 7479 7065 3d64 7479  ray(a, dtype=dty
+000259c0: 7065 2c20 6f72 6465 723d 6f72 6465 7229  pe, order=order)
+000259d0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+000259e0: 2020 206c 696b 655f 6d65 7461 203d 206d     like_meta = m
+000259f0: 6574 615f 6672 6f6d 5f61 7272 6179 286c  eta_from_array(l
+00025a00: 696b 6529 0a20 2020 2020 2020 2069 6620  ike).        if 
+00025a10: 6973 696e 7374 616e 6365 2861 2c20 4172  isinstance(a, Ar
+00025a20: 7261 7929 3a0a 2020 2020 2020 2020 2020  ray):.          
+00025a30: 2020 7265 7475 726e 2061 2e6d 6170 5f62    return a.map_b
+00025a40: 6c6f 636b 7328 6e70 2e61 7361 6e79 6172  locks(np.asanyar
+00025a50: 7261 792c 206c 696b 653d 6c69 6b65 5f6d  ray, like=like_m
+00025a60: 6574 612c 2064 7479 7065 3d64 7479 7065  eta, dtype=dtype
+00025a70: 2c20 6f72 6465 723d 6f72 6465 7229 0a20  , order=order). 
+00025a80: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00025a90: 2020 2020 2020 2020 2061 203d 206e 702e           a = np.
+00025aa0: 6173 616e 7961 7272 6179 2861 2c20 6c69  asanyarray(a, li
+00025ab0: 6b65 3d6c 696b 655f 6d65 7461 2c20 6474  ke=like_meta, dt
+00025ac0: 7970 653d 6474 7970 652c 206f 7264 6572  ype=dtype, order
+00025ad0: 3d6f 7264 6572 290a 2020 2020 7265 7475  =order).    retu
+00025ae0: 726e 2066 726f 6d5f 6172 7261 7928 0a20  rn from_array(. 
+00025af0: 2020 2020 2020 2061 2c0a 2020 2020 2020         a,.      
+00025b00: 2020 6368 756e 6b73 3d61 2e73 6861 7065    chunks=a.shape
+00025b10: 2c0a 2020 2020 2020 2020 6765 7469 7465  ,.        getite
+00025b20: 6d3d 6765 7474 6572 5f69 6e6c 696e 652c  m=getter_inline,
+00025b30: 0a20 2020 2020 2020 2061 7361 7272 6179  .        asarray
+00025b40: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00025b50: 696e 6c69 6e65 5f61 7272 6179 3d69 6e6c  inline_array=inl
+00025b60: 696e 655f 6172 7261 792c 0a20 2020 2029  ine_array,.    )
+00025b70: 0a0a 0a64 6566 2069 735f 7363 616c 6172  ...def is_scalar
+00025b80: 5f66 6f72 5f65 6c65 6d77 6973 6528 6172  _for_elemwise(ar
+00025b90: 6729 3a0a 2020 2020 2222 220a 0a20 2020  g):.    """..   
+00025ba0: 203e 3e3e 2069 735f 7363 616c 6172 5f66   >>> is_scalar_f
+00025bb0: 6f72 5f65 6c65 6d77 6973 6528 3432 290a  or_elemwise(42).
+00025bc0: 2020 2020 5472 7565 0a20 2020 203e 3e3e      True.    >>>
+00025bd0: 2069 735f 7363 616c 6172 5f66 6f72 5f65   is_scalar_for_e
+00025be0: 6c65 6d77 6973 6528 2766 6f6f 2729 0a20  lemwise('foo'). 
+00025bf0: 2020 2054 7275 650a 2020 2020 3e3e 3e20     True.    >>> 
+00025c00: 6973 5f73 6361 6c61 725f 666f 725f 656c  is_scalar_for_el
+00025c10: 656d 7769 7365 2854 7275 6529 0a20 2020  emwise(True).   
+00025c20: 2054 7275 650a 2020 2020 3e3e 3e20 6973   True.    >>> is
+00025c30: 5f73 6361 6c61 725f 666f 725f 656c 656d  _scalar_for_elem
+00025c40: 7769 7365 286e 702e 6172 7261 7928 3432  wise(np.array(42
+00025c50: 2929 0a20 2020 2054 7275 650a 2020 2020  )).    True.    
+00025c60: 3e3e 3e20 6973 5f73 6361 6c61 725f 666f  >>> is_scalar_fo
+00025c70: 725f 656c 656d 7769 7365 285b 312c 2032  r_elemwise([1, 2
+00025c80: 2c20 335d 290a 2020 2020 5472 7565 0a20  , 3]).    True. 
+00025c90: 2020 203e 3e3e 2069 735f 7363 616c 6172     >>> is_scalar
+00025ca0: 5f66 6f72 5f65 6c65 6d77 6973 6528 6e70  _for_elemwise(np
+00025cb0: 2e61 7272 6179 285b 312c 2032 2c20 335d  .array([1, 2, 3]
+00025cc0: 2929 0a20 2020 2046 616c 7365 0a20 2020  )).    False.   
+00025cd0: 203e 3e3e 2069 735f 7363 616c 6172 5f66   >>> is_scalar_f
+00025ce0: 6f72 5f65 6c65 6d77 6973 6528 6672 6f6d  or_elemwise(from
+00025cf0: 5f61 7272 6179 286e 702e 6172 7261 7928  _array(np.array(
+00025d00: 3029 2c20 6368 756e 6b73 3d28 2929 290a  0), chunks=())).
+00025d10: 2020 2020 4661 6c73 650a 2020 2020 3e3e      False.    >>
+00025d20: 3e20 6973 5f73 6361 6c61 725f 666f 725f  > is_scalar_for_
+00025d30: 656c 656d 7769 7365 286e 702e 6474 7970  elemwise(np.dtyp
+00025d40: 6528 2769 3427 2929 0a20 2020 2054 7275  e('i4')).    Tru
+00025d50: 650a 2020 2020 2222 220a 2020 2020 2320  e.    """.    # 
+00025d60: 7468 6520 7365 636f 6e64 2068 616c 6620  the second half 
+00025d70: 6f66 2073 6861 7065 5f63 6f6e 6469 7469  of shape_conditi
+00025d80: 6f6e 2069 7320 6573 7365 6e74 6961 6c6c  on is essentiall
+00025d90: 7920 6a75 7374 2074 6f20 656e 7375 7265  y just to ensure
+00025da0: 2074 6861 740a 2020 2020 2320 6461 736b   that.    # dask
+00025db0: 2073 6572 6965 7320 2f20 6672 616d 6520   series / frame 
+00025dc0: 6172 6520 7472 6561 7465 6420 6173 2073  are treated as s
+00025dd0: 6361 6c61 7273 2069 6e20 656c 656d 7769  calars in elemwi
+00025de0: 7365 2e0a 2020 2020 6d61 7962 655f 7368  se..    maybe_sh
+00025df0: 6170 6520 3d20 6765 7461 7474 7228 6172  ape = getattr(ar
+00025e00: 672c 2022 7368 6170 6522 2c20 4e6f 6e65  g, "shape", None
+00025e10: 290a 2020 2020 7368 6170 655f 636f 6e64  ).    shape_cond
+00025e20: 6974 696f 6e20 3d20 6e6f 7420 6973 696e  ition = not isin
+00025e30: 7374 616e 6365 286d 6179 6265 5f73 6861  stance(maybe_sha
+00025e40: 7065 2c20 4974 6572 6162 6c65 2920 6f72  pe, Iterable) or
+00025e50: 2061 6e79 280a 2020 2020 2020 2020 6973   any(.        is
+00025e60: 5f64 6173 6b5f 636f 6c6c 6563 7469 6f6e  _dask_collection
+00025e70: 2878 2920 666f 7220 7820 696e 206d 6179  (x) for x in may
+00025e80: 6265 5f73 6861 7065 0a20 2020 2029 0a0a  be_shape.    )..
+00025e90: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
+00025ea0: 2020 2020 206e 702e 6973 7363 616c 6172       np.isscalar
+00025eb0: 2861 7267 290a 2020 2020 2020 2020 6f72  (arg).        or
+00025ec0: 2073 6861 7065 5f63 6f6e 6469 7469 6f6e   shape_condition
+00025ed0: 0a20 2020 2020 2020 206f 7220 6973 696e  .        or isin
+00025ee0: 7374 616e 6365 2861 7267 2c20 6e70 2e64  stance(arg, np.d
+00025ef0: 7479 7065 290a 2020 2020 2020 2020 6f72  type).        or
+00025f00: 2028 6973 696e 7374 616e 6365 2861 7267   (isinstance(arg
+00025f10: 2c20 6e70 2e6e 6461 7272 6179 2920 616e  , np.ndarray) an
+00025f20: 6420 6172 672e 6e64 696d 203d 3d20 3029  d arg.ndim == 0)
+00025f30: 0a20 2020 2029 0a0a 0a64 6566 2062 726f  .    )...def bro
+00025f40: 6164 6361 7374 5f73 6861 7065 7328 2a73  adcast_shapes(*s
+00025f50: 6861 7065 7329 3a0a 2020 2020 2222 220a  hapes):.    """.
+00025f60: 2020 2020 4465 7465 726d 696e 6573 206f      Determines o
+00025f70: 7574 7075 7420 7368 6170 6520 6672 6f6d  utput shape from
+00025f80: 2062 726f 6164 6361 7374 696e 6720 6172   broadcasting ar
+00025f90: 7261 7973 2e0a 0a20 2020 2050 6172 616d  rays...    Param
+00025fa0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+00025fb0: 2d2d 2d2d 0a20 2020 2073 6861 7065 7320  ----.    shapes 
+00025fc0: 3a20 7475 706c 6573 0a20 2020 2020 2020  : tuples.       
+00025fd0: 2054 6865 2073 6861 7065 7320 6f66 2074   The shapes of t
+00025fe0: 6865 2061 7267 756d 656e 7473 2e0a 0a20  he arguments... 
+00025ff0: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
+00026000: 2d2d 2d2d 2d2d 0a20 2020 206f 7574 7075  ------.    outpu
+00026010: 745f 7368 6170 6520 3a20 7475 706c 650a  t_shape : tuple.
+00026020: 0a20 2020 2052 6169 7365 730a 2020 2020  .    Raises.    
+00026030: 2d2d 2d2d 2d2d 0a20 2020 2056 616c 7565  ------.    Value
+00026040: 4572 726f 720a 2020 2020 2020 2020 4966  Error.        If
+00026050: 2074 6865 2069 6e70 7574 2073 6861 7065   the input shape
+00026060: 7320 6361 6e6e 6f74 2062 6520 7375 6363  s cannot be succ
+00026070: 6573 7366 756c 6c79 2062 726f 6164 6361  essfully broadca
+00026080: 7374 2074 6f67 6574 6865 722e 0a20 2020  st together..   
+00026090: 2022 2222 0a20 2020 2069 6620 6c65 6e28   """.    if len(
+000260a0: 7368 6170 6573 2920 3d3d 2031 3a0a 2020  shapes) == 1:.  
+000260b0: 2020 2020 2020 7265 7475 726e 2073 6861        return sha
+000260c0: 7065 735b 305d 0a20 2020 206f 7574 203d  pes[0].    out =
+000260d0: 205b 5d0a 2020 2020 666f 7220 7369 7a65   [].    for size
+000260e0: 7320 696e 207a 6970 5f6c 6f6e 6765 7374  s in zip_longest
+000260f0: 282a 6d61 7028 7265 7665 7273 6564 2c20  (*map(reversed, 
+00026100: 7368 6170 6573 292c 2066 696c 6c76 616c  shapes), fillval
+00026110: 7565 3d2d 3129 3a0a 2020 2020 2020 2020  ue=-1):.        
+00026120: 6966 206e 702e 6973 6e61 6e28 7369 7a65  if np.isnan(size
+00026130: 7329 2e61 6e79 2829 3a0a 2020 2020 2020  s).any():.      
+00026140: 2020 2020 2020 6469 6d20 3d20 6e70 2e6e        dim = np.n
+00026150: 616e 0a20 2020 2020 2020 2065 6c73 653a  an.        else:
+00026160: 0a20 2020 2020 2020 2020 2020 2064 696d  .            dim
+00026170: 203d 2030 2069 6620 3020 696e 2073 697a   = 0 if 0 in siz
+00026180: 6573 2065 6c73 6520 6e70 2e6d 6178 2873  es else np.max(s
+00026190: 697a 6573 290a 2020 2020 2020 2020 6966  izes).        if
+000261a0: 2061 6e79 2869 206e 6f74 2069 6e20 5b2d   any(i not in [-
+000261b0: 312c 2030 2c20 312c 2064 696d 5d20 616e  1, 0, 1, dim] an
+000261c0: 6420 6e6f 7420 6e70 2e69 736e 616e 2869  d not np.isnan(i
+000261d0: 2920 666f 7220 6920 696e 2073 697a 6573  ) for i in sizes
+000261e0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+000261f0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00026200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026210: 2022 6f70 6572 616e 6473 2063 6f75 6c64   "operands could
+00026220: 206e 6f74 2062 6520 6272 6f61 6463 6173   not be broadcas
+00026230: 7420 746f 6765 7468 6572 2077 6974 6820  t together with 
+00026240: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00026250: 2020 2273 6861 7065 7320 7b7d 222e 666f    "shapes {}".fo
+00026260: 726d 6174 2822 2022 2e6a 6f69 6e28 6d61  rmat(" ".join(ma
+00026270: 7028 7374 722c 2073 6861 7065 7329 2929  p(str, shapes)))
+00026280: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00026290: 2020 2020 2020 206f 7574 2e61 7070 656e         out.appen
+000262a0: 6428 6469 6d29 0a20 2020 2072 6574 7572  d(dim).    retur
+000262b0: 6e20 7475 706c 6528 7265 7665 7273 6564  n tuple(reversed
+000262c0: 286f 7574 2929 0a0a 0a64 6566 2065 6c65  (out))...def ele
+000262d0: 6d77 6973 6528 6f70 2c20 2a61 7267 732c  mwise(op, *args,
+000262e0: 206f 7574 3d4e 6f6e 652c 2077 6865 7265   out=None, where
+000262f0: 3d54 7275 652c 2064 7479 7065 3d4e 6f6e  =True, dtype=Non
+00026300: 652c 206e 616d 653d 4e6f 6e65 2c20 2a2a  e, name=None, **
+00026310: 6b77 6172 6773 293a 0a20 2020 2022 2222  kwargs):.    """
+00026320: 4170 706c 7920 616e 2065 6c65 6d65 6e74  Apply an element
+00026330: 7769 7365 2075 6675 6e63 2d6c 696b 6520  wise ufunc-like 
+00026340: 6675 6e63 7469 6f6e 2062 6c6f 636b 7769  function blockwi
+00026350: 7365 2061 6372 6f73 7320 6172 6775 6d65  se across argume
+00026360: 6e74 732e 0a0a 2020 2020 4c69 6b65 206e  nts...    Like n
+00026370: 756d 7079 2075 6675 6e63 732c 2062 726f  umpy ufuncs, bro
+00026380: 6164 6361 7374 696e 6720 7275 6c65 7320  adcasting rules 
+00026390: 6172 6520 7265 7370 6563 7465 642e 0a0a  are respected...
+000263a0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+000263b0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+000263c0: 2020 6f70 203a 2063 616c 6c61 626c 650a    op : callable.
+000263d0: 2020 2020 2020 2020 5468 6520 6675 6e63          The func
+000263e0: 7469 6f6e 2074 6f20 6170 706c 792e 2053  tion to apply. S
+000263f0: 686f 756c 6420 6265 206e 756d 7079 2075  hould be numpy u
+00026400: 6675 6e63 2d6c 696b 6520 696e 2074 6865  func-like in the
+00026410: 2070 6172 616d 6574 6572 730a 2020 2020   parameters.    
+00026420: 2020 2020 7468 6174 2069 7420 6163 6365      that it acce
+00026430: 7074 732e 0a20 2020 202a 6172 6773 203a  pts..    *args :
+00026440: 2041 6e79 0a20 2020 2020 2020 2041 7267   Any.        Arg
+00026450: 756d 656e 7473 2074 6f20 7061 7373 2074  uments to pass t
+00026460: 6f20 606f 7060 2e20 4e6f 6e2d 6461 736b  o `op`. Non-dask
+00026470: 2061 7272 6179 2d6c 696b 6520 6f62 6a65   array-like obje
+00026480: 6374 7320 6172 6520 6669 7273 740a 2020  cts are first.  
+00026490: 2020 2020 2020 636f 6e76 6572 7465 6420        converted 
+000264a0: 746f 2064 6173 6b20 6172 7261 7973 2c20  to dask arrays, 
+000264b0: 7468 656e 2061 6c6c 2061 7272 6179 7320  then all arrays 
+000264c0: 6172 6520 6272 6f61 6463 6173 7420 746f  are broadcast to
+000264d0: 6765 7468 6572 2062 6566 6f72 650a 2020  gether before.  
+000264e0: 2020 2020 2020 6170 706c 7969 6e67 2074        applying t
+000264f0: 6865 2066 756e 6374 696f 6e20 626c 6f63  he function bloc
+00026500: 6b77 6973 6520 6163 726f 7373 2061 6c6c  kwise across all
+00026510: 2061 7267 756d 656e 7473 2e20 416e 7920   arguments. Any 
+00026520: 7363 616c 6172 0a20 2020 2020 2020 2061  scalar.        a
+00026530: 7267 756d 656e 7473 2061 7265 2070 6173  rguments are pas
+00026540: 7365 6420 6173 2d69 7320 666f 6c6c 6f77  sed as-is follow
+00026550: 696e 6720 6e6f 726d 616c 206e 756d 7079  ing normal numpy
+00026560: 2075 6675 6e63 2062 6568 6176 696f 722e   ufunc behavior.
+00026570: 0a20 2020 206f 7574 203a 2064 6173 6b20  .    out : dask 
+00026580: 6172 7261 792c 206f 7074 696f 6e61 6c0a  array, optional.
+00026590: 2020 2020 2020 2020 4966 206f 7574 2069          If out i
+000265a0: 7320 6120 6461 736b 2e61 7272 6179 2074  s a dask.array t
+000265b0: 6865 6e20 7468 6973 206f 7665 7277 7269  hen this overwri
+000265c0: 7465 7320 7468 6520 636f 6e74 656e 7473  tes the contents
+000265d0: 206f 6620 7468 6174 2061 7272 6179 0a20   of that array. 
+000265e0: 2020 2020 2020 2077 6974 6820 7468 6520         with the 
+000265f0: 7265 7375 6c74 2e0a 2020 2020 7768 6572  result..    wher
+00026600: 6520 3a20 6172 7261 795f 6c69 6b65 2c20  e : array_like, 
+00026610: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00026620: 2041 6e20 6f70 7469 6f6e 616c 2062 6f6f   An optional boo
+00026630: 6c65 616e 206d 6173 6b20 6d61 726b 696e  lean mask markin
+00026640: 6720 6c6f 6361 7469 6f6e 7320 7768 6572  g locations wher
+00026650: 6520 7468 6520 7566 756e 6320 7368 6f75  e the ufunc shou
+00026660: 6c64 2062 650a 2020 2020 2020 2020 6170  ld be.        ap
+00026670: 706c 6965 642e 2043 616e 2062 6520 6120  plied. Can be a 
+00026680: 7363 616c 6172 2c20 6461 736b 2061 7272  scalar, dask arr
+00026690: 6179 2c20 6f72 2061 6e79 206f 7468 6572  ay, or any other
+000266a0: 2061 7272 6179 2d6c 696b 6520 6f62 6a65   array-like obje
+000266b0: 6374 2e0a 2020 2020 2020 2020 4d69 7272  ct..        Mirr
+000266c0: 6f72 7320 7468 6520 6060 7768 6572 6560  ors the ``where`
+000266d0: 6020 6172 6775 6d65 6e74 2074 6f20 6e75  ` argument to nu
+000266e0: 6d70 7920 7566 756e 6373 2c20 7365 6520  mpy ufuncs, see 
+000266f0: 652e 672e 2060 606e 756d 7079 2e61 6464  e.g. ``numpy.add
+00026700: 6060 0a20 2020 2020 2020 2066 6f72 206d  ``.        for m
+00026710: 6f72 6520 696e 666f 726d 6174 696f 6e2e  ore information.
+00026720: 0a20 2020 2064 7479 7065 203a 2064 7479  .    dtype : dty
+00026730: 7065 2c20 6f70 7469 6f6e 616c 0a20 2020  pe, optional.   
+00026740: 2020 2020 2049 6620 7072 6f76 6964 6564       If provided
+00026750: 2c20 6f76 6572 7269 6465 7320 7468 6520  , overrides the 
+00026760: 6f75 7470 7574 2061 7272 6179 2064 7479  output array dty
+00026770: 7065 2e0a 2020 2020 6e61 6d65 203a 2073  pe..    name : s
+00026780: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
+00026790: 2020 2020 2041 2075 6e69 7175 6520 6b65       A unique ke
+000267a0: 7920 6e61 6d65 2074 6f20 7573 6520 7768  y name to use wh
+000267b0: 656e 2062 7569 6c64 696e 6720 7468 6520  en building the 
+000267c0: 6261 636b 696e 6720 6461 736b 2067 7261  backing dask gra
+000267d0: 7068 2e20 4966 206e 6f74 0a20 2020 2020  ph. If not.     
+000267e0: 2020 2070 726f 7669 6465 642c 206f 6e65     provided, one
+000267f0: 2077 696c 6c20 6265 2061 7574 6f6d 6174   will be automat
+00026800: 6963 616c 6c79 2067 656e 6572 6174 6564  ically generated
+00026810: 2062 6173 6564 206f 6e20 7468 6520 696e   based on the in
+00026820: 7075 740a 2020 2020 2020 2020 6172 6775  put.        argu
+00026830: 6d65 6e74 732e 0a0a 2020 2020 4578 616d  ments...    Exam
+00026840: 706c 6573 0a20 2020 202d 2d2d 2d2d 2d2d  ples.    -------
+00026850: 2d0a 2020 2020 3e3e 3e20 656c 656d 7769  -.    >>> elemwi
+00026860: 7365 2861 6464 2c20 782c 2079 2920 2023  se(add, x, y)  #
+00026870: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
+00026880: 2020 2020 3e3e 3e20 656c 656d 7769 7365      >>> elemwise
+00026890: 2873 696e 2c20 7829 2020 2320 646f 6374  (sin, x)  # doct
+000268a0: 6573 743a 202b 534b 4950 0a20 2020 203e  est: +SKIP.    >
+000268b0: 3e3e 2065 6c65 6d77 6973 6528 7369 6e2c  >> elemwise(sin,
+000268c0: 2078 2c20 6f75 743d 6461 736b 5f61 7272   x, out=dask_arr
+000268d0: 6179 2920 2023 2064 6f63 7465 7374 3a20  ay)  # doctest: 
+000268e0: 2b53 4b49 500a 0a20 2020 2053 6565 2041  +SKIP..    See A
+000268f0: 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d  lso.    --------
+00026900: 0a20 2020 2062 6c6f 636b 7769 7365 0a20  .    blockwise. 
+00026910: 2020 2022 2222 0a20 2020 2069 6620 6b77     """.    if kw
+00026920: 6172 6773 3a0a 2020 2020 2020 2020 7261  args:.        ra
+00026930: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
+00026940: 2020 2020 2020 2020 2020 2066 227b 6f70             f"{op
+00026950: 2e5f 5f6e 616d 655f 5f7d 2064 6f65 7320  .__name__} does 
+00026960: 6e6f 7420 7461 6b65 2074 6865 2066 6f6c  not take the fol
+00026970: 6c6f 7769 6e67 206b 6579 776f 7264 2061  lowing keyword a
+00026980: 7267 756d 656e 7473 2022 0a20 2020 2020  rguments ".     
+00026990: 2020 2020 2020 2066 227b 736f 7274 6564         f"{sorted
+000269a0: 286b 7761 7267 7329 7d22 0a20 2020 2020  (kwargs)}".     
+000269b0: 2020 2029 0a0a 2020 2020 6f75 7420 3d20     )..    out = 
+000269c0: 5f65 6c65 6d77 6973 655f 6e6f 726d 616c  _elemwise_normal
+000269d0: 697a 655f 6f75 7428 6f75 7429 0a20 2020  ize_out(out).   
+000269e0: 2077 6865 7265 203d 205f 656c 656d 7769   where = _elemwi
+000269f0: 7365 5f6e 6f72 6d61 6c69 7a65 5f77 6865  se_normalize_whe
+00026a00: 7265 2877 6865 7265 290a 2020 2020 6172  re(where).    ar
+00026a10: 6773 203d 205b 6e70 2e61 7361 7272 6179  gs = [np.asarray
+00026a20: 2861 2920 6966 2069 7369 6e73 7461 6e63  (a) if isinstanc
+00026a30: 6528 612c 2028 6c69 7374 2c20 7475 706c  e(a, (list, tupl
+00026a40: 6529 2920 656c 7365 2061 2066 6f72 2061  e)) else a for a
+00026a50: 2069 6e20 6172 6773 5d0a 0a20 2020 2073   in args]..    s
+00026a60: 6861 7065 7320 3d20 5b5d 0a20 2020 2066  hapes = [].    f
+00026a70: 6f72 2061 7267 2069 6e20 6172 6773 3a0a  or arg in args:.
+00026a80: 2020 2020 2020 2020 7368 6170 6520 3d20          shape = 
+00026a90: 6765 7461 7474 7228 6172 672c 2022 7368  getattr(arg, "sh
+00026aa0: 6170 6522 2c20 2829 290a 2020 2020 2020  ape", ()).      
+00026ab0: 2020 6966 2061 6e79 2869 735f 6461 736b    if any(is_dask
+00026ac0: 5f63 6f6c 6c65 6374 696f 6e28 7829 2066  _collection(x) f
+00026ad0: 6f72 2078 2069 6e20 7368 6170 6529 3a0a  or x in shape):.
+00026ae0: 2020 2020 2020 2020 2020 2020 2320 5761              # Wa
+00026af0: 6e74 2074 6f20 6578 636c 7564 6520 4465  nt to exclude De
+00026b00: 6c61 7965 6420 7368 6170 6573 2061 6e64  layed shapes and
+00026b10: 2064 642e 5363 616c 6172 0a20 2020 2020   dd.Scalar.     
+00026b20: 2020 2020 2020 2073 6861 7065 203d 2028         shape = (
+00026b30: 290a 2020 2020 2020 2020 7368 6170 6573  ).        shapes
+00026b40: 2e61 7070 656e 6428 7368 6170 6529 0a20  .append(shape). 
+00026b50: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00026b60: 2877 6865 7265 2c20 4172 7261 7929 3a0a  (where, Array):.
+00026b70: 2020 2020 2020 2020 7368 6170 6573 2e61          shapes.a
+00026b80: 7070 656e 6428 7768 6572 652e 7368 6170  ppend(where.shap
+00026b90: 6529 0a20 2020 2069 6620 6973 696e 7374  e).    if isinst
+00026ba0: 616e 6365 286f 7574 2c20 4172 7261 7929  ance(out, Array)
+00026bb0: 3a0a 2020 2020 2020 2020 7368 6170 6573  :.        shapes
+00026bc0: 2e61 7070 656e 6428 6f75 742e 7368 6170  .append(out.shap
+00026bd0: 6529 0a0a 2020 2020 7368 6170 6573 203d  e)..    shapes =
+00026be0: 205b 7320 6966 2069 7369 6e73 7461 6e63   [s if isinstanc
+00026bf0: 6528 732c 2049 7465 7261 626c 6529 2065  e(s, Iterable) e
+00026c00: 6c73 6520 2829 2066 6f72 2073 2069 6e20  lse () for s in 
+00026c10: 7368 6170 6573 5d0a 2020 2020 6f75 745f  shapes].    out_
+00026c20: 6e64 696d 203d 206c 656e 280a 2020 2020  ndim = len(.    
+00026c30: 2020 2020 6272 6f61 6463 6173 745f 7368      broadcast_sh
+00026c40: 6170 6573 282a 7368 6170 6573 290a 2020  apes(*shapes).  
+00026c50: 2020 2920 2023 2052 6169 7365 7320 5661    )  # Raises Va
+00026c60: 6c75 6545 7272 6f72 2069 6620 6469 6d65  lueError if dime
+00026c70: 6e73 696f 6e73 206d 6973 6d61 7463 680a  nsions mismatch.
+00026c80: 2020 2020 6578 7072 5f69 6e64 7320 3d20      expr_inds = 
+00026c90: 7475 706c 6528 7261 6e67 6528 6f75 745f  tuple(range(out_
+00026ca0: 6e64 696d 2929 5b3a 3a2d 315d 0a0a 2020  ndim))[::-1]..  
+00026cb0: 2020 6966 2064 7479 7065 2069 7320 6e6f    if dtype is no
+00026cc0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00026cd0: 6e65 6564 5f65 6e66 6f72 6365 5f64 7479  need_enforce_dty
+00026ce0: 7065 203d 2054 7275 650a 2020 2020 656c  pe = True.    el
+00026cf0: 7365 3a0a 2020 2020 2020 2020 2320 5765  se:.        # We
+00026d00: 2066 6f6c 6c6f 7720 4e75 6d50 7927 7320   follow NumPy's 
+00026d10: 7275 6c65 7320 666f 7220 6474 7970 6520  rules for dtype 
+00026d20: 7072 6f6d 6f74 696f 6e2c 2077 6869 6368  promotion, which
+00026d30: 2073 7065 6369 616c 2063 6173 6573 0a20   special cases. 
+00026d40: 2020 2020 2020 2023 2073 6361 6c61 7273         # scalars
+00026d50: 2061 6e64 2030 6420 6e64 6172 7261 7973   and 0d ndarrays
+00026d60: 2028 7768 6963 6820 6974 2063 6f6e 7369   (which it consi
+00026d70: 6465 7273 2065 7175 6976 616c 656e 7429  ders equivalent)
+00026d80: 2062 7920 7573 696e 670a 2020 2020 2020   by using.      
+00026d90: 2020 2320 7468 6569 7220 7661 6c75 6573    # their values
+00026da0: 2074 6f20 636f 6d70 7574 6520 7468 6520   to compute the 
+00026db0: 7265 7375 6c74 2064 7479 7065 3a0a 2020  result dtype:.  
+00026dc0: 2020 2020 2020 2320 6874 7470 733a 2f2f        # https://
+00026dd0: 6769 7468 7562 2e63 6f6d 2f6e 756d 7079  github.com/numpy
+00026de0: 2f6e 756d 7079 2f69 7373 7565 732f 3632  /numpy/issues/62
+00026df0: 3430 0a20 2020 2020 2020 2023 2057 6520  40.        # We 
+00026e00: 646f 6e27 7420 696e 7370 6563 7420 7468  don't inspect th
+00026e10: 6520 7661 6c75 6573 206f 6620 3064 2064  e values of 0d d
+00026e20: 6173 6b20 6172 7261 7973 2c20 6265 6361  ask arrays, beca
+00026e30: 7573 6520 7468 6573 6520 636f 756c 640a  use these could.
+00026e40: 2020 2020 2020 2020 2320 686f 6c64 2070          # hold p
+00026e50: 6f74 656e 7469 616c 6c79 2076 6572 7920  otentially very 
+00026e60: 6578 7065 6e73 6976 6520 6361 6c63 756c  expensive calcul
+00026e70: 6174 696f 6e73 2e20 496e 7374 6561 642c  ations. Instead,
+00026e80: 2077 6520 7472 6561 740a 2020 2020 2020   we treat.      
+00026e90: 2020 2320 7468 656d 206a 7573 7420 6c69    # them just li
+00026ea0: 6b65 206f 7468 6572 2061 7272 6179 732c  ke other arrays,
+00026eb0: 2061 6e64 2069 6620 6e65 6365 7373 6172   and if necessar
+00026ec0: 7920 6361 7374 2074 6865 2072 6573 756c  y cast the resul
+00026ed0: 7420 6f66 206f 700a 2020 2020 2020 2020  t of op.        
+00026ee0: 2320 746f 206d 6174 6368 2e0a 2020 2020  # to match..    
+00026ef0: 2020 2020 7661 6c73 203d 205b 0a20 2020      vals = [.   
+00026f00: 2020 2020 2020 2020 206e 702e 656d 7074           np.empt
+00026f10: 7928 2831 2c29 202a 206d 6178 2831 2c20  y((1,) * max(1, 
+00026f20: 612e 6e64 696d 292c 2064 7479 7065 3d61  a.ndim), dtype=a
+00026f30: 2e64 7479 7065 290a 2020 2020 2020 2020  .dtype).        
+00026f40: 2020 2020 6966 206e 6f74 2069 735f 7363      if not is_sc
+00026f50: 616c 6172 5f66 6f72 5f65 6c65 6d77 6973  alar_for_elemwis
+00026f60: 6528 6129 0a20 2020 2020 2020 2020 2020  e(a).           
+00026f70: 2065 6c73 6520 610a 2020 2020 2020 2020   else a.        
+00026f80: 2020 2020 666f 7220 6120 696e 2061 7267      for a in arg
+00026f90: 730a 2020 2020 2020 2020 5d0a 2020 2020  s.        ].    
+00026fa0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00026fb0: 2020 2020 2064 7479 7065 203d 2061 7070       dtype = app
+00026fc0: 6c79 5f69 6e66 6572 5f64 7479 7065 286f  ly_infer_dtype(o
+00026fd0: 702c 2076 616c 732c 207b 7d2c 2022 656c  p, vals, {}, "el
+00026fe0: 656d 7769 7365 222c 2073 7567 6765 7374  emwise", suggest
+00026ff0: 5f64 7479 7065 3d46 616c 7365 290a 2020  _dtype=False).  
+00027000: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
+00027010: 6570 7469 6f6e 3a0a 2020 2020 2020 2020  eption:.        
+00027020: 2020 2020 7265 7475 726e 204e 6f74 496d      return NotIm
+00027030: 706c 656d 656e 7465 640a 2020 2020 2020  plemented.      
+00027040: 2020 6e65 6564 5f65 6e66 6f72 6365 5f64    need_enforce_d
+00027050: 7479 7065 203d 2061 6e79 280a 2020 2020  type = any(.    
+00027060: 2020 2020 2020 2020 6e6f 7420 6973 5f73          not is_s
+00027070: 6361 6c61 725f 666f 725f 656c 656d 7769  calar_for_elemwi
+00027080: 7365 2861 2920 616e 6420 612e 6e64 696d  se(a) and a.ndim
+00027090: 203d 3d20 3020 666f 7220 6120 696e 2061   == 0 for a in a
+000270a0: 7267 730a 2020 2020 2020 2020 290a 0a20  rgs.        ).. 
+000270b0: 2020 2069 6620 6e6f 7420 6e61 6d65 3a0a     if not name:.
+000270c0: 2020 2020 2020 2020 6e61 6d65 203d 2066          name = f
+000270d0: 227b 6675 6e63 6e61 6d65 286f 7029 7d2d  "{funcname(op)}-
+000270e0: 7b74 6f6b 656e 697a 6528 6f70 2c20 6474  {tokenize(op, dt
+000270f0: 7970 652c 202a 6172 6773 2c20 7768 6572  ype, *args, wher
+00027100: 6529 7d22 0a0a 2020 2020 626c 6f63 6b77  e)}"..    blockw
+00027110: 6973 655f 6b77 6172 6773 203d 2064 6963  ise_kwargs = dic
+00027120: 7428 6474 7970 653d 6474 7970 652c 206e  t(dtype=dtype, n
+00027130: 616d 653d 6e61 6d65 2c20 746f 6b65 6e3d  ame=name, token=
+00027140: 6675 6e63 6e61 6d65 286f 7029 2e73 7472  funcname(op).str
+00027150: 6970 2822 5f22 2929 0a0a 2020 2020 6966  ip("_"))..    if
+00027160: 2077 6865 7265 2069 7320 6e6f 7420 5472   where is not Tr
+00027170: 7565 3a0a 2020 2020 2020 2020 626c 6f63  ue:.        bloc
+00027180: 6b77 6973 655f 6b77 6172 6773 5b22 656c  kwise_kwargs["el
+00027190: 656d 7769 7365 5f77 6865 7265 5f66 756e  emwise_where_fun
+000271a0: 6374 696f 6e22 5d20 3d20 6f70 0a20 2020  ction"] = op.   
+000271b0: 2020 2020 206f 7020 3d20 5f65 6c65 6d77       op = _elemw
+000271c0: 6973 655f 6861 6e64 6c65 5f77 6865 7265  ise_handle_where
+000271d0: 0a20 2020 2020 2020 2061 7267 732e 6578  .        args.ex
+000271e0: 7465 6e64 285b 7768 6572 652c 206f 7574  tend([where, out
+000271f0: 5d29 0a0a 2020 2020 6966 206e 6565 645f  ])..    if need_
+00027200: 656e 666f 7263 655f 6474 7970 653a 0a20  enforce_dtype:. 
+00027210: 2020 2020 2020 2062 6c6f 636b 7769 7365         blockwise
+00027220: 5f6b 7761 7267 735b 2265 6e66 6f72 6365  _kwargs["enforce
+00027230: 5f64 7479 7065 225d 203d 2064 7479 7065  _dtype"] = dtype
+00027240: 0a20 2020 2020 2020 2062 6c6f 636b 7769  .        blockwi
+00027250: 7365 5f6b 7761 7267 735b 2265 6e66 6f72  se_kwargs["enfor
+00027260: 6365 5f64 7479 7065 5f66 756e 6374 696f  ce_dtype_functio
+00027270: 6e22 5d20 3d20 6f70 0a20 2020 2020 2020  n"] = op.       
+00027280: 206f 7020 3d20 5f65 6e66 6f72 6365 5f64   op = _enforce_d
+00027290: 7479 7065 0a0a 2020 2020 7265 7375 6c74  type..    result
+000272a0: 203d 2062 6c6f 636b 7769 7365 280a 2020   = blockwise(.  
+000272b0: 2020 2020 2020 6f70 2c0a 2020 2020 2020        op,.      
+000272c0: 2020 6578 7072 5f69 6e64 732c 0a20 2020    expr_inds,.   
+000272d0: 2020 2020 202a 636f 6e63 6174 280a 2020       *concat(.  
+000272e0: 2020 2020 2020 2020 2020 2861 2c20 7475            (a, tu
+000272f0: 706c 6528 7261 6e67 6528 612e 6e64 696d  ple(range(a.ndim
+00027300: 295b 3a3a 2d31 5d29 2069 6620 6e6f 7420  )[::-1]) if not 
+00027310: 6973 5f73 6361 6c61 725f 666f 725f 656c  is_scalar_for_el
+00027320: 656d 7769 7365 2861 2920 656c 7365 204e  emwise(a) else N
+00027330: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
+00027340: 2066 6f72 2061 2069 6e20 6172 6773 0a20   for a in args. 
+00027350: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+00027360: 2020 2a2a 626c 6f63 6b77 6973 655f 6b77    **blockwise_kw
+00027370: 6172 6773 2c0a 2020 2020 290a 0a20 2020  args,.    )..   
+00027380: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+00027390: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+000273a0: 0a0a 6465 6620 5f65 6c65 6d77 6973 655f  ..def _elemwise_
+000273b0: 6e6f 726d 616c 697a 655f 7768 6572 6528  normalize_where(
+000273c0: 7768 6572 6529 3a0a 2020 2020 6966 2077  where):.    if w
+000273d0: 6865 7265 2069 7320 5472 7565 3a0a 2020  here is True:.  
+000273e0: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+000273f0: 650a 2020 2020 656c 6966 2077 6865 7265  e.    elif where
+00027400: 2069 7320 4661 6c73 6520 6f72 2077 6865   is False or whe
+00027410: 7265 2069 7320 4e6f 6e65 3a0a 2020 2020  re is None:.    
+00027420: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+00027430: 0a20 2020 2072 6574 7572 6e20 6173 6172  .    return asar
+00027440: 7261 7928 7768 6572 6529 0a0a 0a64 6566  ray(where)...def
+00027450: 205f 656c 656d 7769 7365 5f68 616e 646c   _elemwise_handl
+00027460: 655f 7768 6572 6528 2a61 7267 732c 202a  e_where(*args, *
+00027470: 2a6b 7761 7267 7329 3a0a 2020 2020 6675  *kwargs):.    fu
+00027480: 6e63 7469 6f6e 203d 206b 7761 7267 732e  nction = kwargs.
+00027490: 706f 7028 2265 6c65 6d77 6973 655f 7768  pop("elemwise_wh
+000274a0: 6572 655f 6675 6e63 7469 6f6e 2229 0a20  ere_function"). 
+000274b0: 2020 202a 6172 6773 2c20 7768 6572 652c     *args, where,
+000274c0: 206f 7574 203d 2061 7267 730a 2020 2020   out = args.    
+000274d0: 6966 2068 6173 6174 7472 286f 7574 2c20  if hasattr(out, 
+000274e0: 2263 6f70 7922 293a 0a20 2020 2020 2020  "copy"):.       
+000274f0: 206f 7574 203d 206f 7574 2e63 6f70 7928   out = out.copy(
+00027500: 290a 2020 2020 7265 7475 726e 2066 756e  ).    return fun
+00027510: 6374 696f 6e28 2a61 7267 732c 2077 6865  ction(*args, whe
+00027520: 7265 3d77 6865 7265 2c20 6f75 743d 6f75  re=where, out=ou
+00027530: 742c 202a 2a6b 7761 7267 7329 0a0a 0a64  t, **kwargs)...d
+00027540: 6566 205f 656c 656d 7769 7365 5f6e 6f72  ef _elemwise_nor
+00027550: 6d61 6c69 7a65 5f6f 7574 286f 7574 293a  malize_out(out):
+00027560: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+00027570: 6365 286f 7574 2c20 7475 706c 6529 3a0a  ce(out, tuple):.
+00027580: 2020 2020 2020 2020 6966 206c 656e 286f          if len(o
+00027590: 7574 2920 3d3d 2031 3a0a 2020 2020 2020  ut) == 1:.      
+000275a0: 2020 2020 2020 6f75 7420 3d20 6f75 745b        out = out[
+000275b0: 305d 0a20 2020 2020 2020 2065 6c69 6620  0].        elif 
+000275c0: 6c65 6e28 6f75 7429 203e 2031 3a0a 2020  len(out) > 1:.  
+000275d0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000275e0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+000275f0: 726f 7228 2254 6865 206f 7574 2070 6172  ror("The out par
+00027600: 616d 6574 6572 2069 7320 6e6f 7420 6675  ameter is not fu
+00027610: 6c6c 7920 7375 7070 6f72 7465 6422 290a  lly supported").
+00027620: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00027630: 2020 2020 2020 2020 2020 6f75 7420 3d20            out = 
+00027640: 4e6f 6e65 0a20 2020 2069 6620 6e6f 7420  None.    if not 
+00027650: 286f 7574 2069 7320 4e6f 6e65 206f 7220  (out is None or 
+00027660: 6973 696e 7374 616e 6365 286f 7574 2c20  isinstance(out, 
+00027670: 4172 7261 7929 293a 0a20 2020 2020 2020  Array)):.       
+00027680: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+00027690: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
+000276a0: 2020 2020 2020 2020 6622 5468 6520 6f75          f"The ou
+000276b0: 7420 7061 7261 6d65 7465 7220 6973 206e  t parameter is n
+000276c0: 6f74 2066 756c 6c79 2073 7570 706f 7274  ot fully support
+000276d0: 6564 2e22 0a20 2020 2020 2020 2020 2020  ed.".           
+000276e0: 2066 2220 5265 6365 6976 6564 2074 7970   f" Received typ
+000276f0: 6520 7b74 7970 6528 6f75 7429 2e5f 5f6e  e {type(out).__n
+00027700: 616d 655f 5f7d 2c20 6578 7065 6374 6564  ame__}, expected
+00027710: 2044 6173 6b20 4172 7261 7922 0a20 2020   Dask Array".   
+00027720: 2020 2020 2029 0a20 2020 2072 6574 7572       ).    retur
+00027730: 6e20 6f75 740a 0a0a 6465 6620 6861 6e64  n out...def hand
+00027740: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
+00027750: 6c74 293a 0a20 2020 2022 2222 4861 6e64  lt):.    """Hand
+00027760: 6c65 206f 7574 2070 6172 616d 6574 6572  le out parameter
+00027770: 730a 0a20 2020 2049 6620 6f75 7420 6973  s..    If out is
+00027780: 2061 2064 6173 6b2e 6172 7261 7920 7468   a dask.array th
+00027790: 656e 2074 6869 7320 6f76 6572 7772 6974  en this overwrit
+000277a0: 6573 2074 6865 2063 6f6e 7465 6e74 7320  es the contents 
+000277b0: 6f66 2074 6861 7420 6172 7261 7920 7769  of that array wi
+000277c0: 7468 0a20 2020 2074 6865 2072 6573 756c  th.    the resul
+000277d0: 740a 2020 2020 2222 220a 2020 2020 6f75  t.    """.    ou
+000277e0: 7420 3d20 5f65 6c65 6d77 6973 655f 6e6f  t = _elemwise_no
+000277f0: 726d 616c 697a 655f 6f75 7428 6f75 7429  rmalize_out(out)
+00027800: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+00027810: 6365 286f 7574 2c20 4172 7261 7929 3a0a  ce(out, Array):.
+00027820: 2020 2020 2020 2020 6966 206f 7574 2e73          if out.s
+00027830: 6861 7065 2021 3d20 7265 7375 6c74 2e73  hape != result.s
+00027840: 6861 7065 3a0a 2020 2020 2020 2020 2020  hape:.          
+00027850: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00027860: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00027870: 2020 2020 224d 6973 6d61 7463 6865 6420      "Mismatched 
+00027880: 7368 6170 6573 2062 6574 7765 656e 2072  shapes between r
+00027890: 6573 756c 7420 616e 6420 6f75 7420 7061  esult and out pa
+000278a0: 7261 6d65 7465 722e 2022 0a20 2020 2020  rameter. ".     
+000278b0: 2020 2020 2020 2020 2020 2022 6f75 743d             "out=
+000278c0: 2573 2c20 7265 7375 6c74 3d25 7322 2025  %s, result=%s" %
+000278d0: 2028 7374 7228 6f75 742e 7368 6170 6529   (str(out.shape)
+000278e0: 2c20 7374 7228 7265 7375 6c74 2e73 6861  , str(result.sha
+000278f0: 7065 2929 0a20 2020 2020 2020 2020 2020  pe)).           
+00027900: 2029 0a20 2020 2020 2020 206f 7574 2e5f   ).        out._
+00027910: 6368 756e 6b73 203d 2072 6573 756c 742e  chunks = result.
+00027920: 6368 756e 6b73 0a20 2020 2020 2020 206f  chunks.        o
+00027930: 7574 2e64 6173 6b20 3d20 7265 7375 6c74  ut.dask = result
+00027940: 2e64 6173 6b0a 2020 2020 2020 2020 6f75  .dask.        ou
+00027950: 742e 5f6d 6574 6120 3d20 7265 7375 6c74  t._meta = result
+00027960: 2e5f 6d65 7461 0a20 2020 2020 2020 206f  ._meta.        o
+00027970: 7574 2e5f 6e61 6d65 203d 2072 6573 756c  ut._name = resul
+00027980: 742e 6e61 6d65 0a20 2020 2020 2020 2072  t.name.        r
+00027990: 6574 7572 6e20 6f75 740a 2020 2020 656c  eturn out.    el
+000279a0: 7365 3a0a 2020 2020 2020 2020 7265 7475  se:.        retu
+000279b0: 726e 2072 6573 756c 740a 0a0a 6465 6620  rn result...def 
+000279c0: 5f65 6e66 6f72 6365 5f64 7479 7065 282a  _enforce_dtype(*
+000279d0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+000279e0: 0a20 2020 2022 2222 4361 6c6c 7320 6120  .    """Calls a 
+000279f0: 6675 6e63 7469 6f6e 2061 6e64 2063 6f6e  function and con
+00027a00: 7665 7274 7320 6974 7320 7265 7375 6c74  verts its result
+00027a10: 2074 6f20 7468 6520 6769 7665 6e20 6474   to the given dt
+00027a20: 7970 652e 0a0a 2020 2020 5468 6520 7061  ype...    The pa
+00027a30: 7261 6d65 7465 7273 2068 6176 6520 6465  rameters have de
+00027a40: 6c69 6265 7261 7465 6c79 2062 6565 6e20  liberately been 
+00027a50: 6769 7665 6e20 756e 7769 656c 6479 206e  given unwieldy n
+00027a60: 616d 6573 2074 6f20 6176 6f69 640a 2020  ames to avoid.  
+00027a70: 2020 636c 6173 6865 7320 7769 7468 206b    clashes with k
+00027a80: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
+00027a90: 2063 6f6e 7375 6d65 6420 6279 2062 6c6f   consumed by blo
+00027aa0: 636b 7769 7365 0a0a 2020 2020 4120 6474  ckwise..    A dt
+00027ab0: 7970 6520 6f66 2060 6f62 6a65 6374 6020  ype of `object` 
+00027ac0: 6973 2074 7265 6174 6564 2061 7320 6120  is treated as a 
+00027ad0: 7370 6563 6961 6c20 6361 7365 2061 6e64  special case and
+00027ae0: 206e 6f74 2065 6e66 6f72 6365 642c 0a20   not enforced,. 
+00027af0: 2020 2062 6563 6175 7365 2069 7420 6973     because it is
+00027b00: 2075 7365 6420 6173 2061 2064 756d 6d79   used as a dummy
+00027b10: 2076 616c 7565 2069 6e20 736f 6d65 2070   value in some p
+00027b20: 6c61 6365 7320 7768 656e 2074 6865 2072  laces when the r
+00027b30: 6573 756c 7420 7769 6c6c 0a20 2020 206e  esult will.    n
+00027b40: 6f74 2062 6520 6120 626c 6f63 6b20 696e  ot be a block in
+00027b50: 2061 6e20 4172 7261 792e 0a0a 2020 2020   an Array...    
+00027b60: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
+00027b70: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 656e  ---------.    en
+00027b80: 666f 7263 655f 6474 7970 6520 3a20 6474  force_dtype : dt
+00027b90: 7970 650a 2020 2020 2020 2020 5265 7375  ype.        Resu
+00027ba0: 6c74 2064 7479 7065 0a20 2020 2065 6e66  lt dtype.    enf
+00027bb0: 6f72 6365 5f64 7479 7065 5f66 756e 6374  orce_dtype_funct
+00027bc0: 696f 6e20 3a20 6361 6c6c 6162 6c65 0a20  ion : callable. 
+00027bd0: 2020 2020 2020 2054 6865 2077 7261 7070         The wrapp
+00027be0: 6564 2066 756e 6374 696f 6e2c 2077 6869  ed function, whi
+00027bf0: 6368 2077 696c 6c20 6265 2070 6173 7365  ch will be passe
+00027c00: 6420 7468 6520 7265 6d61 696e 696e 6720  d the remaining 
+00027c10: 6172 6775 6d65 6e74 730a 2020 2020 2222  arguments.    ""
+00027c20: 220a 2020 2020 6474 7970 6520 3d20 6b77  ".    dtype = kw
+00027c30: 6172 6773 2e70 6f70 2822 656e 666f 7263  args.pop("enforc
+00027c40: 655f 6474 7970 6522 290a 2020 2020 6675  e_dtype").    fu
+00027c50: 6e63 7469 6f6e 203d 206b 7761 7267 732e  nction = kwargs.
+00027c60: 706f 7028 2265 6e66 6f72 6365 5f64 7479  pop("enforce_dty
+00027c70: 7065 5f66 756e 6374 696f 6e22 290a 0a20  pe_function").. 
+00027c80: 2020 2072 6573 756c 7420 3d20 6675 6e63     result = func
+00027c90: 7469 6f6e 282a 6172 6773 2c20 2a2a 6b77  tion(*args, **kw
+00027ca0: 6172 6773 290a 2020 2020 6966 2068 6173  args).    if has
+00027cb0: 6174 7472 2872 6573 756c 742c 2022 6474  attr(result, "dt
+00027cc0: 7970 6522 2920 616e 6420 6474 7970 6520  ype") and dtype 
+00027cd0: 213d 2072 6573 756c 742e 6474 7970 6520  != result.dtype 
+00027ce0: 616e 6420 6474 7970 6520 213d 206f 626a  and dtype != obj
+00027cf0: 6563 743a 0a20 2020 2020 2020 2069 6620  ect:.        if 
+00027d00: 6e6f 7420 6e70 2e63 616e 5f63 6173 7428  not np.can_cast(
+00027d10: 7265 7375 6c74 2c20 6474 7970 652c 2063  result, dtype, c
+00027d20: 6173 7469 6e67 3d22 7361 6d65 5f6b 696e  asting="same_kin
+00027d30: 6422 293a 0a20 2020 2020 2020 2020 2020  d"):.           
+00027d40: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00027d50: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00027d60: 2020 2022 496e 6665 7272 6564 2064 7479     "Inferred dty
+00027d70: 7065 2066 726f 6d20 6675 6e63 7469 6f6e  pe from function
+00027d80: 2025 7220 7761 7320 2572 2022 0a20 2020   %r was %r ".   
+00027d90: 2020 2020 2020 2020 2020 2020 2022 6275               "bu
+00027da0: 7420 676f 7420 2572 2c20 7768 6963 6820  t got %r, which 
+00027db0: 6361 6e27 7420 6265 2063 6173 7420 7573  can't be cast us
+00027dc0: 696e 6720 220a 2020 2020 2020 2020 2020  ing ".          
+00027dd0: 2020 2020 2020 2263 6173 7469 6e67 3d27        "casting='
+00027de0: 7361 6d65 5f6b 696e 6427 220a 2020 2020  same_kind'".    
+00027df0: 2020 2020 2020 2020 2020 2020 2520 2866              % (f
+00027e00: 756e 636e 616d 6528 6675 6e63 7469 6f6e  uncname(function
+00027e10: 292c 2073 7472 2864 7479 7065 292c 2073  ), str(dtype), s
+00027e20: 7472 2872 6573 756c 742e 6474 7970 6529  tr(result.dtype)
+00027e30: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+00027e40: 2020 2020 2020 2020 6966 206e 702e 6973          if np.is
+00027e50: 7363 616c 6172 2872 6573 756c 7429 3a0a  scalar(result):.
+00027e60: 2020 2020 2020 2020 2020 2020 2320 7363              # sc
+00027e70: 616c 6172 2061 7374 7970 6520 6d65 7468  alar astype meth
+00027e80: 6f64 2064 6f65 736e 2774 2074 616b 6520  od doesn't take 
+00027e90: 7468 6520 6b65 7977 6f72 6420 6172 6775  the keyword argu
+00027ea0: 6d65 6e74 732c 2073 6f0a 2020 2020 2020  ments, so.      
+00027eb0: 2020 2020 2020 2320 6861 7665 2074 6f20        # have to 
+00027ec0: 636f 6e76 6572 7420 7669 6120 302d 6469  convert via 0-di
+00027ed0: 6d65 6e73 696f 6e61 6c20 6172 7261 7920  mensional array 
+00027ee0: 616e 6420 6261 636b 2e0a 2020 2020 2020  and back..      
+00027ef0: 2020 2020 2020 7265 7375 6c74 203d 2072        result = r
+00027f00: 6573 756c 742e 6173 7479 7065 2864 7479  esult.astype(dty
+00027f10: 7065 290a 2020 2020 2020 2020 656c 7365  pe).        else
+00027f20: 3a0a 2020 2020 2020 2020 2020 2020 7472  :.            tr
+00027f30: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00027f40: 2020 2072 6573 756c 7420 3d20 7265 7375     result = resu
+00027f50: 6c74 2e61 7374 7970 6528 6474 7970 652c  lt.astype(dtype,
+00027f60: 2063 6f70 793d 4661 6c73 6529 0a20 2020   copy=False).   
+00027f70: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+00027f80: 5479 7065 4572 726f 723a 0a20 2020 2020  TypeError:.     
+00027f90: 2020 2020 2020 2020 2020 2023 204d 6973             # Mis
+00027fa0: 7369 6e67 2063 6f70 7920 6b77 6172 670a  sing copy kwarg.
+00027fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027fc0: 7265 7375 6c74 203d 2072 6573 756c 742e  result = result.
+00027fd0: 6173 7479 7065 2864 7479 7065 290a 2020  astype(dtype).  
+00027fe0: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
+00027ff0: 0a0a 6465 6620 6272 6f61 6463 6173 745f  ..def broadcast_
+00028000: 746f 2878 2c20 7368 6170 652c 2063 6875  to(x, shape, chu
+00028010: 6e6b 733d 4e6f 6e65 2c20 6d65 7461 3d4e  nks=None, meta=N
+00028020: 6f6e 6529 3a0a 2020 2020 2222 2242 726f  one):.    """Bro
+00028030: 6164 6361 7374 2061 6e20 6172 7261 7920  adcast an array 
+00028040: 746f 2061 206e 6577 2073 6861 7065 2e0a  to a new shape..
+00028050: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00028060: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00028070: 2020 2078 203a 2061 7272 6179 5f6c 696b     x : array_lik
+00028080: 650a 2020 2020 2020 2020 5468 6520 6172  e.        The ar
+00028090: 7261 7920 746f 2062 726f 6164 6361 7374  ray to broadcast
+000280a0: 2e0a 2020 2020 7368 6170 6520 3a20 7475  ..    shape : tu
+000280b0: 706c 650a 2020 2020 2020 2020 5468 6520  ple.        The 
+000280c0: 7368 6170 6520 6f66 2074 6865 2064 6573  shape of the des
+000280d0: 6972 6564 2061 7272 6179 2e0a 2020 2020  ired array..    
+000280e0: 6368 756e 6b73 203a 2074 7570 6c65 2c20  chunks : tuple, 
+000280f0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00028100: 2049 6620 7072 6f76 6964 6564 2c20 7468   If provided, th
+00028110: 656e 2074 6865 2072 6573 756c 7420 7769  en the result wi
+00028120: 6c6c 2075 7365 2074 6865 7365 2063 6875  ll use these chu
+00028130: 6e6b 7320 696e 7374 6561 6420 6f66 2074  nks instead of t
+00028140: 6865 2073 616d 650a 2020 2020 2020 2020  he same.        
+00028150: 6368 756e 6b73 2061 7320 7468 6520 736f  chunks as the so
+00028160: 7572 6365 2061 7272 6179 2e20 5365 7474  urce array. Sett
+00028170: 696e 6720 6368 756e 6b73 2065 7870 6c69  ing chunks expli
+00028180: 6369 746c 7920 6173 2070 6172 7420 6f66  citly as part of
+00028190: 0a20 2020 2020 2020 2062 726f 6164 6361  .        broadca
+000281a0: 7374 5f74 6f20 6973 206d 6f72 6520 6566  st_to is more ef
+000281b0: 6669 6369 656e 7420 7468 616e 2072 6563  ficient than rec
+000281c0: 6875 6e6b 696e 6720 6166 7465 7277 6172  hunking afterwar
+000281d0: 6473 2e20 4368 756e 6b73 2061 7265 0a20  ds. Chunks are. 
+000281e0: 2020 2020 2020 206f 6e6c 7920 616c 6c6f         only allo
+000281f0: 7765 6420 746f 2064 6966 6665 7220 6672  wed to differ fr
+00028200: 6f6d 2074 6865 206f 7269 6769 6e61 6c20  om the original 
+00028210: 7368 6170 6520 616c 6f6e 6720 6469 6d65  shape along dime
+00028220: 6e73 696f 6e73 2074 6861 740a 2020 2020  nsions that.    
+00028230: 2020 2020 6172 6520 6e65 7720 6f6e 2074      are new on t
+00028240: 6865 2072 6573 756c 7420 6f72 2068 6176  he result or hav
+00028250: 6520 7369 7a65 2031 2074 6865 2069 6e70  e size 1 the inp
+00028260: 7574 2061 7272 6179 2e0a 2020 2020 6d65  ut array..    me
+00028270: 7461 203a 2065 6d70 7479 206e 6461 7272  ta : empty ndarr
+00028280: 6179 0a20 2020 2020 2020 2065 6d70 7479  ay.        empty
+00028290: 206e 6461 7272 6179 2063 7265 6174 6564   ndarray created
+000282a0: 2077 6974 6820 7361 6d65 204e 756d 5079   with same NumPy
+000282b0: 2062 6163 6b65 6e64 2c20 6e64 696d 2061   backend, ndim a
+000282c0: 6e64 2064 7479 7065 2061 7320 7468 650a  nd dtype as the.
+000282d0: 2020 2020 2020 2020 4461 736b 2041 7272          Dask Arr
+000282e0: 6179 2062 6569 6e67 2063 7265 6174 6564  ay being created
+000282f0: 2028 6f76 6572 7269 6465 7320 6474 7970   (overrides dtyp
+00028300: 6529 0a0a 2020 2020 5265 7475 726e 730a  e)..    Returns.
+00028310: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00028320: 6272 6f61 6463 6173 7420 3a20 6461 736b  broadcast : dask
+00028330: 2061 7272 6179 0a0a 2020 2020 5365 6520   array..    See 
+00028340: 416c 736f 0a20 2020 202d 2d2d 2d2d 2d2d  Also.    -------
+00028350: 2d0a 2020 2020 3a66 756e 633a 606e 756d  -.    :func:`num
+00028360: 7079 2e62 726f 6164 6361 7374 5f74 6f60  py.broadcast_to`
+00028370: 0a20 2020 2022 2222 0a20 2020 2078 203d  .    """.    x =
+00028380: 2061 7361 7272 6179 2878 290a 2020 2020   asarray(x).    
+00028390: 7368 6170 6520 3d20 7475 706c 6528 7368  shape = tuple(sh
+000283a0: 6170 6529 0a0a 2020 2020 6966 206d 6574  ape)..    if met
+000283b0: 6120 6973 204e 6f6e 653a 0a20 2020 2020  a is None:.     
+000283c0: 2020 206d 6574 6120 3d20 6d65 7461 5f66     meta = meta_f
+000283d0: 726f 6d5f 6172 7261 7928 7829 0a0a 2020  rom_array(x)..  
+000283e0: 2020 6966 2078 2e73 6861 7065 203d 3d20    if x.shape == 
+000283f0: 7368 6170 6520 616e 6420 2863 6875 6e6b  shape and (chunk
+00028400: 7320 6973 204e 6f6e 6520 6f72 2063 6875  s is None or chu
+00028410: 6e6b 7320 3d3d 2078 2e63 6875 6e6b 7329  nks == x.chunks)
+00028420: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00028430: 2078 0a0a 2020 2020 6e64 696d 5f6e 6577   x..    ndim_new
+00028440: 203d 206c 656e 2873 6861 7065 2920 2d20   = len(shape) - 
+00028450: 782e 6e64 696d 0a20 2020 2069 6620 6e64  x.ndim.    if nd
+00028460: 696d 5f6e 6577 203c 2030 206f 7220 616e  im_new < 0 or an
+00028470: 7928 0a20 2020 2020 2020 206e 6577 2021  y(.        new !
+00028480: 3d20 6f6c 6420 666f 7220 6e65 772c 206f  = old for new, o
+00028490: 6c64 2069 6e20 7a69 7028 7368 6170 655b  ld in zip(shape[
+000284a0: 6e64 696d 5f6e 6577 3a5d 2c20 782e 7368  ndim_new:], x.sh
+000284b0: 6170 6529 2069 6620 6f6c 6420 213d 2031  ape) if old != 1
+000284c0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000284d0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+000284e0: 2866 2263 616e 6e6f 7420 6272 6f61 6463  (f"cannot broadc
+000284f0: 6173 7420 7368 6170 6520 7b78 2e73 6861  ast shape {x.sha
+00028500: 7065 7d20 746f 2073 6861 7065 207b 7368  pe} to shape {sh
+00028510: 6170 657d 2229 0a0a 2020 2020 6966 2063  ape}")..    if c
+00028520: 6875 6e6b 7320 6973 204e 6f6e 653a 0a20  hunks is None:. 
+00028530: 2020 2020 2020 2063 6875 6e6b 7320 3d20         chunks = 
+00028540: 7475 706c 6528 2873 2c29 2066 6f72 2073  tuple((s,) for s
+00028550: 2069 6e20 7368 6170 655b 3a6e 6469 6d5f   in shape[:ndim_
+00028560: 6e65 775d 2920 2b20 7475 706c 6528 0a20  new]) + tuple(. 
+00028570: 2020 2020 2020 2020 2020 2062 6420 6966             bd if
+00028580: 206f 6c64 203e 2031 2065 6c73 6520 286e   old > 1 else (n
+00028590: 6577 2c29 0a20 2020 2020 2020 2020 2020  ew,).           
+000285a0: 2066 6f72 2062 642c 206f 6c64 2c20 6e65   for bd, old, ne
+000285b0: 7720 696e 207a 6970 2878 2e63 6875 6e6b  w in zip(x.chunk
+000285c0: 732c 2078 2e73 6861 7065 2c20 7368 6170  s, x.shape, shap
+000285d0: 655b 6e64 696d 5f6e 6577 3a5d 290a 2020  e[ndim_new:]).  
+000285e0: 2020 2020 2020 290a 2020 2020 656c 7365        ).    else
+000285f0: 3a0a 2020 2020 2020 2020 6368 756e 6b73  :.        chunks
+00028600: 203d 206e 6f72 6d61 6c69 7a65 5f63 6875   = normalize_chu
+00028610: 6e6b 7328 0a20 2020 2020 2020 2020 2020  nks(.           
+00028620: 2063 6875 6e6b 732c 2073 6861 7065 2c20   chunks, shape, 
+00028630: 6474 7970 653d 782e 6474 7970 652c 2070  dtype=x.dtype, p
+00028640: 7265 7669 6f75 735f 6368 756e 6b73 3d78  revious_chunks=x
+00028650: 2e63 6875 6e6b 730a 2020 2020 2020 2020  .chunks.        
+00028660: 290a 2020 2020 2020 2020 666f 7220 6f6c  ).        for ol
+00028670: 645f 6264 2c20 6e65 775f 6264 2069 6e20  d_bd, new_bd in 
+00028680: 7a69 7028 782e 6368 756e 6b73 2c20 6368  zip(x.chunks, ch
+00028690: 756e 6b73 5b6e 6469 6d5f 6e65 773a 5d29  unks[ndim_new:])
+000286a0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000286b0: 206f 6c64 5f62 6420 213d 206e 6577 5f62   old_bd != new_b
+000286c0: 6420 616e 6420 6f6c 645f 6264 2021 3d20  d and old_bd != 
+000286d0: 2831 2c29 3a0a 2020 2020 2020 2020 2020  (1,):.          
+000286e0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+000286f0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00028700: 2020 2020 2020 2020 2020 2020 2263 616e              "can
+00028710: 6e6f 7420 6272 6f61 6463 6173 7420 6368  not broadcast ch
+00028720: 756e 6b73 2025 7320 746f 2063 6875 6e6b  unks %s to chunk
+00028730: 7320 2573 3a20 220a 2020 2020 2020 2020  s %s: ".        
+00028740: 2020 2020 2020 2020 2020 2020 226e 6577              "new
+00028750: 2063 6875 6e6b 7320 6d75 7374 2065 6974   chunks must eit
+00028760: 6865 7220 6265 2061 6c6f 6e67 2061 206e  her be along a n
+00028770: 6577 2022 0a20 2020 2020 2020 2020 2020  ew ".           
+00028780: 2020 2020 2020 2020 2022 6469 6d65 6e73           "dimens
+00028790: 696f 6e20 6f72 2061 2064 696d 656e 7369  ion or a dimensi
+000287a0: 6f6e 206f 6620 7369 7a65 2031 2220 2520  on of size 1" % 
+000287b0: 2878 2e63 6875 6e6b 732c 2063 6875 6e6b  (x.chunks, chunk
+000287c0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+000287d0: 2020 2029 0a0a 2020 2020 6e61 6d65 203d     )..    name =
+000287e0: 2022 6272 6f61 6463 6173 745f 746f 2d22   "broadcast_to-"
+000287f0: 202b 2074 6f6b 656e 697a 6528 782c 2073   + tokenize(x, s
+00028800: 6861 7065 2c20 6368 756e 6b73 290a 2020  hape, chunks).  
+00028810: 2020 6473 6b20 3d20 7b7d 0a0a 2020 2020    dsk = {}..    
+00028820: 656e 756d 6572 6174 6564 5f63 6875 6e6b  enumerated_chunk
+00028830: 7320 3d20 7072 6f64 7563 7428 2a28 656e  s = product(*(en
+00028840: 756d 6572 6174 6528 6264 7329 2066 6f72  umerate(bds) for
+00028850: 2062 6473 2069 6e20 6368 756e 6b73 2929   bds in chunks))
+00028860: 0a20 2020 2066 6f72 206e 6577 5f69 6e64  .    for new_ind
+00028870: 6578 2c20 6368 756e 6b5f 7368 6170 6520  ex, chunk_shape 
+00028880: 696e 2028 7a69 7028 2a65 6329 2066 6f72  in (zip(*ec) for
+00028890: 2065 6320 696e 2065 6e75 6d65 7261 7465   ec in enumerate
+000288a0: 645f 6368 756e 6b73 293a 0a20 2020 2020  d_chunks):.     
+000288b0: 2020 206f 6c64 5f69 6e64 6578 203d 2074     old_index = t
+000288c0: 7570 6c65 280a 2020 2020 2020 2020 2020  uple(.          
+000288d0: 2020 3020 6966 2062 6420 3d3d 2028 312c    0 if bd == (1,
+000288e0: 2920 656c 7365 2069 2066 6f72 2062 642c  ) else i for bd,
+000288f0: 2069 2069 6e20 7a69 7028 782e 6368 756e   i in zip(x.chun
+00028900: 6b73 2c20 6e65 775f 696e 6465 785b 6e64  ks, new_index[nd
+00028910: 696d 5f6e 6577 3a5d 290a 2020 2020 2020  im_new:]).      
+00028920: 2020 290a 2020 2020 2020 2020 6f6c 645f    ).        old_
+00028930: 6b65 7920 3d20 2878 2e6e 616d 652c 2920  key = (x.name,) 
+00028940: 2b20 6f6c 645f 696e 6465 780a 2020 2020  + old_index.    
+00028950: 2020 2020 6e65 775f 6b65 7920 3d20 286e      new_key = (n
+00028960: 616d 652c 2920 2b20 6e65 775f 696e 6465  ame,) + new_inde
+00028970: 780a 2020 2020 2020 2020 6473 6b5b 6e65  x.        dsk[ne
+00028980: 775f 6b65 795d 203d 2028 6e70 2e62 726f  w_key] = (np.bro
+00028990: 6164 6361 7374 5f74 6f2c 206f 6c64 5f6b  adcast_to, old_k
+000289a0: 6579 2c20 7175 6f74 6528 6368 756e 6b5f  ey, quote(chunk_
+000289b0: 7368 6170 6529 290a 0a20 2020 2067 7261  shape))..    gra
+000289c0: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+000289d0: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+000289e0: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
+000289f0: 6465 7065 6e64 656e 6369 6573 3d5b 785d  dependencies=[x]
+00028a00: 290a 2020 2020 7265 7475 726e 2041 7272  ).    return Arr
+00028a10: 6179 2867 7261 7068 2c20 6e61 6d65 2c20  ay(graph, name, 
+00028a20: 6368 756e 6b73 2c20 6474 7970 653d 782e  chunks, dtype=x.
+00028a30: 6474 7970 652c 206d 6574 613d 6d65 7461  dtype, meta=meta
+00028a40: 290a 0a0a 4064 6572 6976 6564 5f66 726f  )...@derived_fro
+00028a50: 6d28 6e70 290a 6465 6620 6272 6f61 6463  m(np).def broadc
+00028a60: 6173 745f 6172 7261 7973 282a 6172 6773  ast_arrays(*args
+00028a70: 2c20 7375 626f 6b3d 4661 6c73 6529 3a0a  , subok=False):.
+00028a80: 2020 2020 7375 626f 6b20 3d20 626f 6f6c      subok = bool
+00028a90: 2873 7562 6f6b 290a 0a20 2020 2074 6f5f  (subok)..    to_
+00028aa0: 6172 7261 7920 3d20 6173 616e 7961 7272  array = asanyarr
+00028ab0: 6179 2069 6620 7375 626f 6b20 656c 7365  ay if subok else
+00028ac0: 2061 7361 7272 6179 0a20 2020 2061 7267   asarray.    arg
+00028ad0: 7320 3d20 7475 706c 6528 746f 5f61 7272  s = tuple(to_arr
+00028ae0: 6179 2865 2920 666f 7220 6520 696e 2061  ay(e) for e in a
+00028af0: 7267 7329 0a0a 2020 2020 2320 556e 6966  rgs)..    # Unif
+00028b00: 7920 756e 6576 656e 2063 6875 6e6b 696e  y uneven chunkin
+00028b10: 670a 2020 2020 696e 6473 203d 205b 6c69  g.    inds = [li
+00028b20: 7374 2872 6576 6572 7365 6428 7261 6e67  st(reversed(rang
+00028b30: 6528 782e 6e64 696d 2929 2920 666f 7220  e(x.ndim))) for 
+00028b40: 7820 696e 2061 7267 735d 0a20 2020 2075  x in args].    u
+00028b50: 635f 6172 6773 203d 2063 6f6e 6361 7428  c_args = concat(
+00028b60: 7a69 7028 6172 6773 2c20 696e 6473 2929  zip(args, inds))
+00028b70: 0a20 2020 205f 2c20 6172 6773 203d 2075  .    _, args = u
+00028b80: 6e69 6679 5f63 6875 6e6b 7328 2a75 635f  nify_chunks(*uc_
+00028b90: 6172 6773 2c20 7761 726e 3d46 616c 7365  args, warn=False
+00028ba0: 290a 0a20 2020 2073 6861 7065 203d 2062  )..    shape = b
+00028bb0: 726f 6164 6361 7374 5f73 6861 7065 7328  roadcast_shapes(
+00028bc0: 2a28 652e 7368 6170 6520 666f 7220 6520  *(e.shape for e 
+00028bd0: 696e 2061 7267 7329 290a 2020 2020 6368  in args)).    ch
+00028be0: 756e 6b73 203d 2062 726f 6164 6361 7374  unks = broadcast
+00028bf0: 5f63 6875 6e6b 7328 2a28 652e 6368 756e  _chunks(*(e.chun
+00028c00: 6b73 2066 6f72 2065 2069 6e20 6172 6773  ks for e in args
+00028c10: 2929 0a0a 2020 2020 7265 7375 6c74 203d  ))..    result =
+00028c20: 205b 6272 6f61 6463 6173 745f 746f 2865   [broadcast_to(e
+00028c30: 2c20 7368 6170 653d 7368 6170 652c 2063  , shape=shape, c
+00028c40: 6875 6e6b 733d 6368 756e 6b73 2920 666f  hunks=chunks) fo
+00028c50: 7220 6520 696e 2061 7267 735d 0a0a 2020  r e in args]..  
+00028c60: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
+00028c70: 0a0a 6465 6620 6f66 6673 6574 5f66 756e  ..def offset_fun
+00028c80: 6328 6675 6e63 2c20 6f66 6673 6574 2c20  c(func, offset, 
+00028c90: 2a61 7267 7329 3a0a 2020 2020 2222 224f  *args):.    """O
+00028ca0: 6666 7365 7473 2069 6e70 7574 7320 6279  ffsets inputs by
+00028cb0: 206f 6666 7365 740a 0a20 2020 203e 3e3e   offset..    >>>
+00028cc0: 2064 6f75 626c 6520 3d20 6c61 6d62 6461   double = lambda
+00028cd0: 2078 3a20 7820 2a20 320a 2020 2020 3e3e   x: x * 2.    >>
+00028ce0: 3e20 6620 3d20 6f66 6673 6574 5f66 756e  > f = offset_fun
+00028cf0: 6328 646f 7562 6c65 2c20 2831 302c 2929  c(double, (10,))
+00028d00: 0a20 2020 203e 3e3e 2066 2831 290a 2020  .    >>> f(1).  
+00028d10: 2020 3232 0a20 2020 203e 3e3e 2066 2833    22.    >>> f(3
+00028d20: 3030 290a 2020 2020 3632 300a 2020 2020  00).    620.    
+00028d30: 2222 220a 0a20 2020 2064 6566 205f 6f66  """..    def _of
+00028d40: 6673 6574 282a 6172 6773 293a 0a20 2020  fset(*args):.   
+00028d50: 2020 2020 2061 7267 7332 203d 206c 6973       args2 = lis
+00028d60: 7428 6d61 7028 6164 642c 2061 7267 732c  t(map(add, args,
+00028d70: 206f 6666 7365 7429 290a 2020 2020 2020   offset)).      
+00028d80: 2020 7265 7475 726e 2066 756e 6328 2a61    return func(*a
+00028d90: 7267 7332 290a 0a20 2020 2077 6974 6820  rgs2)..    with 
+00028da0: 636f 6e74 6578 746c 6962 2e73 7570 7072  contextlib.suppr
+00028db0: 6573 7328 4578 6365 7074 696f 6e29 3a0a  ess(Exception):.
+00028dc0: 2020 2020 2020 2020 5f6f 6666 7365 742e          _offset.
+00028dd0: 5f5f 6e61 6d65 5f5f 203d 2022 6f66 6673  __name__ = "offs
+00028de0: 6574 5f22 202b 2066 756e 632e 5f5f 6e61  et_" + func.__na
+00028df0: 6d65 5f5f 0a0a 2020 2020 7265 7475 726e  me__..    return
+00028e00: 205f 6f66 6673 6574 0a0a 0a64 6566 2063   _offset...def c
+00028e10: 6875 6e6b 735f 6672 6f6d 5f61 7272 6179  hunks_from_array
+00028e20: 7328 6172 7261 7973 293a 0a20 2020 2022  s(arrays):.    "
+00028e30: 2222 4368 756e 6b73 2074 7570 6c65 2066  ""Chunks tuple f
+00028e40: 726f 6d20 6e65 7374 6564 206c 6973 7420  rom nested list 
+00028e50: 6f66 2061 7272 6179 730a 0a20 2020 203e  of arrays..    >
+00028e60: 3e3e 2078 203d 206e 702e 6172 7261 7928  >> x = np.array(
+00028e70: 5b31 2c20 325d 290a 2020 2020 3e3e 3e20  [1, 2]).    >>> 
+00028e80: 6368 756e 6b73 5f66 726f 6d5f 6172 7261  chunks_from_arra
+00028e90: 7973 285b 782c 2078 5d29 0a20 2020 2028  ys([x, x]).    (
+00028ea0: 2832 2c20 3229 2c29 0a0a 2020 2020 3e3e  (2, 2),)..    >>
+00028eb0: 3e20 7820 3d20 6e70 2e61 7272 6179 285b  > x = np.array([
+00028ec0: 5b31 2c20 325d 5d29 0a20 2020 203e 3e3e  [1, 2]]).    >>>
+00028ed0: 2063 6875 6e6b 735f 6672 6f6d 5f61 7272   chunks_from_arr
+00028ee0: 6179 7328 5b5b 785d 2c20 5b78 5d5d 290a  ays([[x], [x]]).
+00028ef0: 2020 2020 2828 312c 2031 292c 2028 322c      ((1, 1), (2,
+00028f00: 2929 0a0a 2020 2020 3e3e 3e20 7820 3d20  ))..    >>> x = 
+00028f10: 6e70 2e61 7272 6179 285b 5b31 2c20 325d  np.array([[1, 2]
+00028f20: 5d29 0a20 2020 203e 3e3e 2063 6875 6e6b  ]).    >>> chunk
+00028f30: 735f 6672 6f6d 5f61 7272 6179 7328 5b5b  s_from_arrays([[
+00028f40: 782c 2078 5d5d 290a 2020 2020 2828 312c  x, x]]).    ((1,
+00028f50: 292c 2028 322c 2032 2929 0a0a 2020 2020  ), (2, 2))..    
+00028f60: 3e3e 3e20 6368 756e 6b73 5f66 726f 6d5f  >>> chunks_from_
+00028f70: 6172 7261 7973 285b 312c 2031 5d29 0a20  arrays([1, 1]). 
+00028f80: 2020 2028 2831 2c20 3129 2c29 0a20 2020     ((1, 1),).   
+00028f90: 2022 2222 0a20 2020 2069 6620 6e6f 7420   """.    if not 
+00028fa0: 6172 7261 7973 3a0a 2020 2020 2020 2020  arrays:.        
+00028fb0: 7265 7475 726e 2028 290a 2020 2020 7265  return ().    re
+00028fc0: 7375 6c74 203d 205b 5d0a 2020 2020 6469  sult = [].    di
+00028fd0: 6d20 3d20 300a 0a20 2020 2064 6566 2073  m = 0..    def s
+00028fe0: 6861 7065 2878 293a 0a20 2020 2020 2020  hape(x):.       
+00028ff0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00029000: 2020 7265 7475 726e 2078 2e73 6861 7065    return x.shape
+00029010: 2069 6620 782e 7368 6170 6520 656c 7365   if x.shape else
+00029020: 2028 312c 290a 2020 2020 2020 2020 6578   (1,).        ex
+00029030: 6365 7074 2041 7474 7269 6275 7465 4572  cept AttributeEr
+00029040: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+00029050: 2072 6574 7572 6e20 2831 2c29 0a0a 2020   return (1,)..  
+00029060: 2020 7768 696c 6520 6973 696e 7374 616e    while isinstan
+00029070: 6365 2861 7272 6179 732c 2028 6c69 7374  ce(arrays, (list
+00029080: 2c20 7475 706c 6529 293a 0a20 2020 2020  , tuple)):.     
+00029090: 2020 2072 6573 756c 742e 6170 7065 6e64     result.append
+000290a0: 2874 7570 6c65 2873 6861 7065 2864 6565  (tuple(shape(dee
+000290b0: 7066 6972 7374 2861 2929 5b64 696d 5d20  pfirst(a))[dim] 
+000290c0: 666f 7220 6120 696e 2061 7272 6179 7329  for a in arrays)
+000290d0: 290a 2020 2020 2020 2020 6172 7261 7973  ).        arrays
+000290e0: 203d 2061 7272 6179 735b 305d 0a20 2020   = arrays[0].   
+000290f0: 2020 2020 2064 696d 202b 3d20 310a 2020       dim += 1.  
+00029100: 2020 7265 7475 726e 2074 7570 6c65 2872    return tuple(r
+00029110: 6573 756c 7429 0a0a 0a64 6566 2064 6565  esult)...def dee
+00029120: 7066 6972 7374 2873 6571 293a 0a20 2020  pfirst(seq):.   
+00029130: 2022 2222 4669 7273 7420 656c 656d 656e   """First elemen
+00029140: 7420 696e 2061 206e 6573 7465 6420 6c69  t in a nested li
+00029150: 7374 0a0a 2020 2020 3e3e 3e20 6465 6570  st..    >>> deep
+00029160: 6669 7273 7428 5b5b 5b31 2c20 325d 2c20  first([[[1, 2], 
+00029170: 5b33 2c20 345d 5d2c 205b 352c 2036 5d2c  [3, 4]], [5, 6],
+00029180: 205b 372c 2038 5d5d 290a 2020 2020 310a   [7, 8]]).    1.
+00029190: 2020 2020 2222 220a 2020 2020 6966 206e      """.    if n
+000291a0: 6f74 2069 7369 6e73 7461 6e63 6528 7365  ot isinstance(se
+000291b0: 712c 2028 6c69 7374 2c20 7475 706c 6529  q, (list, tuple)
+000291c0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000291d0: 6e20 7365 710a 2020 2020 656c 7365 3a0a  n seq.    else:.
+000291e0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+000291f0: 6565 7066 6972 7374 2873 6571 5b30 5d29  eepfirst(seq[0])
+00029200: 0a0a 0a64 6566 2073 6861 7065 6c69 7374  ...def shapelist
+00029210: 2861 293a 0a20 2020 2022 2222 4765 7420  (a):.    """Get 
+00029220: 7468 6520 7368 6170 6520 6f66 206e 6573  the shape of nes
+00029230: 7465 6420 6c69 7374 2222 220a 2020 2020  ted list""".    
+00029240: 6966 2074 7970 6528 6129 2069 7320 6c69  if type(a) is li
+00029250: 7374 3a0a 2020 2020 2020 2020 7265 7475  st:.        retu
+00029260: 726e 2074 7570 6c65 285b 6c65 6e28 6129  rn tuple([len(a)
+00029270: 5d20 2b20 6c69 7374 2873 6861 7065 6c69  ] + list(shapeli
+00029280: 7374 2861 5b30 5d29 2929 0a20 2020 2065  st(a[0]))).    e
+00029290: 6c73 653a 0a20 2020 2020 2020 2072 6574  lse:.        ret
+000292a0: 7572 6e20 2829 0a0a 0a64 6566 2074 7261  urn ()...def tra
+000292b0: 6e73 706f 7365 6c69 7374 2861 7272 6179  nsposelist(array
+000292c0: 732c 2061 7865 732c 2065 7874 7261 6469  s, axes, extradi
+000292d0: 6d73 3d30 293a 0a20 2020 2022 2222 5065  ms=0):.    """Pe
+000292e0: 726d 7574 6520 6178 6573 206f 6620 6e65  rmute axes of ne
+000292f0: 7374 6564 206c 6973 740a 0a20 2020 203e  sted list..    >
+00029300: 3e3e 2074 7261 6e73 706f 7365 6c69 7374  >> transposelist
+00029310: 285b 5b31 2c31 2c31 5d2c 5b31 2c31 2c31  ([[1,1,1],[1,1,1
+00029320: 5d5d 2c20 5b32 2c31 5d29 0a20 2020 205b  ]], [2,1]).    [
+00029330: 5b5b 312c 2031 5d2c 205b 312c 2031 5d2c  [[1, 1], [1, 1],
+00029340: 205b 312c 2031 5d5d 5d0a 0a20 2020 203e   [1, 1]]]..    >
+00029350: 3e3e 2074 7261 6e73 706f 7365 6c69 7374  >> transposelist
+00029360: 285b 5b31 2c31 2c31 5d2c 5b31 2c31 2c31  ([[1,1,1],[1,1,1
+00029370: 5d5d 2c20 5b32 2c31 5d2c 2065 7874 7261  ]], [2,1], extra
+00029380: 6469 6d73 3d31 290a 2020 2020 5b5b 5b5b  dims=1).    [[[[
+00029390: 315d 2c20 5b31 5d5d 2c20 5b5b 315d 2c20  1], [1]], [[1], 
+000293a0: 5b31 5d5d 2c20 5b5b 315d 2c20 5b31 5d5d  [1]], [[1], [1]]
+000293b0: 5d5d 0a20 2020 2022 2222 0a20 2020 2069  ]].    """.    i
+000293c0: 6620 6c65 6e28 6178 6573 2920 213d 206e  f len(axes) != n
+000293d0: 6469 6d6c 6973 7428 6172 7261 7973 293a  dimlist(arrays):
+000293e0: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+000293f0: 616c 7565 4572 726f 7228 224c 656e 6774  alueError("Lengt
+00029400: 6820 6f66 2061 7865 7320 7368 6f75 6c64  h of axes should
+00029410: 2065 7175 616c 2064 6570 7468 206f 6620   equal depth of 
+00029420: 6e65 7374 6564 2061 7272 6179 7322 290a  nested arrays").
+00029430: 2020 2020 6966 2065 7874 7261 6469 6d73      if extradims
+00029440: 203c 2030 3a0a 2020 2020 2020 2020 7261   < 0:.        ra
+00029450: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00029460: 606e 6577 6469 6d73 6020 7368 6f75 6c64  `newdims` should
+00029470: 2062 6520 706f 7369 7469 7665 2229 0a20   be positive"). 
+00029480: 2020 2069 6620 6c65 6e28 6178 6573 2920     if len(axes) 
+00029490: 3e20 6c65 6e28 7365 7428 6178 6573 2929  > len(set(axes))
+000294a0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+000294b0: 5661 6c75 6545 7272 6f72 2822 6061 7865  ValueError("`axe
+000294c0: 7360 2073 686f 756c 6420 6265 2075 6e69  s` should be uni
+000294d0: 7175 6522 290a 0a20 2020 206e 6469 6d20  que")..    ndim 
+000294e0: 3d20 6d61 7828 6178 6573 2920 2b20 310a  = max(axes) + 1.
+000294f0: 2020 2020 7368 6170 6520 3d20 7368 6170      shape = shap
+00029500: 656c 6973 7428 6172 7261 7973 290a 2020  elist(arrays).  
+00029510: 2020 6e65 7773 6861 7065 203d 205b 0a20    newshape = [. 
+00029520: 2020 2020 2020 2073 6861 7065 5b61 7865         shape[axe
+00029530: 732e 696e 6465 7828 6929 5d20 6966 2069  s.index(i)] if i
+00029540: 2069 6e20 6178 6573 2065 6c73 6520 3120   in axes else 1 
+00029550: 666f 7220 6920 696e 2072 616e 6765 286e  for i in range(n
+00029560: 6469 6d20 2b20 6578 7472 6164 696d 7329  dim + extradims)
+00029570: 0a20 2020 205d 0a0a 2020 2020 7265 7375  .    ]..    resu
+00029580: 6c74 203d 206c 6973 7428 636f 7265 2e66  lt = list(core.f
+00029590: 6c61 7474 656e 2861 7272 6179 7329 290a  latten(arrays)).
+000295a0: 2020 2020 7265 7475 726e 2072 6573 6861      return resha
+000295b0: 7065 6c69 7374 286e 6577 7368 6170 652c  pelist(newshape,
+000295c0: 2072 6573 756c 7429 0a0a 0a64 6566 2073   result)...def s
+000295d0: 7461 636b 2873 6571 2c20 6178 6973 3d30  tack(seq, axis=0
+000295e0: 2c20 616c 6c6f 775f 756e 6b6e 6f77 6e5f  , allow_unknown_
+000295f0: 6368 756e 6b73 697a 6573 3d46 616c 7365  chunksizes=False
+00029600: 293a 0a20 2020 2022 2222 0a20 2020 2053  ):.    """.    S
+00029610: 7461 636b 2061 7272 6179 7320 616c 6f6e  tack arrays alon
+00029620: 6720 6120 6e65 7720 6178 6973 0a0a 2020  g a new axis..  
+00029630: 2020 4769 7665 6e20 6120 7365 7175 656e    Given a sequen
+00029640: 6365 206f 6620 6461 736b 2061 7272 6179  ce of dask array
+00029650: 732c 2066 6f72 6d20 6120 6e65 7720 6461  s, form a new da
+00029660: 736b 2061 7272 6179 2062 7920 7374 6163  sk array by stac
+00029670: 6b69 6e67 2074 6865 6d0a 2020 2020 616c  king them.    al
+00029680: 6f6e 6720 6120 6e65 7720 6469 6d65 6e73  ong a new dimens
+00029690: 696f 6e20 2861 7869 733d 3020 6279 2064  ion (axis=0 by d
+000296a0: 6566 6175 6c74 290a 0a20 2020 2050 6172  efault)..    Par
+000296b0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+000296c0: 2d2d 2d2d 2d2d 0a20 2020 2073 6571 3a20  ------.    seq: 
+000296d0: 6c69 7374 206f 6620 6461 736b 2e61 7272  list of dask.arr
+000296e0: 6179 730a 2020 2020 6178 6973 3a20 696e  ays.    axis: in
+000296f0: 740a 2020 2020 2020 2020 4469 6d65 6e73  t.        Dimens
+00029700: 696f 6e20 616c 6f6e 6720 7768 6963 6820  ion along which 
+00029710: 746f 2061 6c69 676e 2061 6c6c 206f 6620  to align all of 
+00029720: 7468 6520 6172 7261 7973 0a20 2020 2061  the arrays.    a
+00029730: 6c6c 6f77 5f75 6e6b 6e6f 776e 5f63 6875  llow_unknown_chu
+00029740: 6e6b 7369 7a65 733a 2062 6f6f 6c0a 2020  nksizes: bool.  
+00029750: 2020 2020 2020 416c 6c6f 7720 756e 6b6e        Allow unkn
+00029760: 6f77 6e20 6368 756e 6b73 697a 6573 2c20  own chunksizes, 
+00029770: 7375 6368 2061 7320 636f 6d65 2066 726f  such as come fro
+00029780: 6d20 636f 6e76 6572 7469 6e67 2066 726f  m converting fro
+00029790: 6d20 6461 736b 0a20 2020 2020 2020 2064  m dask.        d
+000297a0: 6174 6166 7261 6d65 732e 2020 4461 736b  ataframes.  Dask
+000297b0: 2e61 7272 6179 2069 7320 756e 6162 6c65  .array is unable
+000297c0: 2074 6f20 7665 7269 6679 2074 6861 7420   to verify that 
+000297d0: 6368 756e 6b73 206c 696e 6520 7570 2e20  chunks line up. 
+000297e0: 2049 660a 2020 2020 2020 2020 6461 7461   If.        data
+000297f0: 2063 6f6d 6573 2066 726f 6d20 6469 6666   comes from diff
+00029800: 6572 656e 746c 7920 616c 6967 6e65 6420  erently aligned 
+00029810: 736f 7572 6365 7320 7468 656e 2074 6869  sources then thi
+00029820: 7320 6361 6e20 6361 7573 650a 2020 2020  s can cause.    
+00029830: 2020 2020 756e 6578 7065 6374 6564 2072      unexpected r
+00029840: 6573 756c 7473 2e0a 0a20 2020 2045 7861  esults...    Exa
+00029850: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
+00029860: 2d2d 0a0a 2020 2020 4372 6561 7465 2073  --..    Create s
+00029870: 6c69 6365 730a 0a20 2020 203e 3e3e 2069  lices..    >>> i
+00029880: 6d70 6f72 7420 6461 736b 2e61 7272 6179  mport dask.array
+00029890: 2061 7320 6461 0a20 2020 203e 3e3e 2069   as da.    >>> i
+000298a0: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
+000298b0: 700a 0a20 2020 203e 3e3e 2064 6174 6120  p..    >>> data 
+000298c0: 3d20 5b64 612e 6672 6f6d 5f61 7272 6179  = [da.from_array
+000298d0: 286e 702e 6f6e 6573 2828 342c 2034 2929  (np.ones((4, 4))
+000298e0: 2c20 6368 756e 6b73 3d28 322c 2032 2929  , chunks=(2, 2))
+000298f0: 0a20 2020 202e 2e2e 2020 2020 2020 2020  .    ...        
+00029900: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00029910: 3329 5d0a 0a20 2020 203e 3e3e 2078 203d  3)]..    >>> x =
+00029920: 2064 612e 7374 6163 6b28 6461 7461 2c20   da.stack(data, 
+00029930: 6178 6973 3d30 290a 2020 2020 3e3e 3e20  axis=0).    >>> 
+00029940: 782e 7368 6170 650a 2020 2020 2833 2c20  x.shape.    (3, 
+00029950: 342c 2034 290a 0a20 2020 203e 3e3e 2064  4, 4)..    >>> d
+00029960: 612e 7374 6163 6b28 6461 7461 2c20 6178  a.stack(data, ax
+00029970: 6973 3d31 292e 7368 6170 650a 2020 2020  is=1).shape.    
+00029980: 2834 2c20 332c 2034 290a 0a20 2020 203e  (4, 3, 4)..    >
+00029990: 3e3e 2064 612e 7374 6163 6b28 6461 7461  >> da.stack(data
+000299a0: 2c20 6178 6973 3d2d 3129 2e73 6861 7065  , axis=-1).shape
+000299b0: 0a20 2020 2028 342c 2034 2c20 3329 0a0a  .    (4, 4, 3)..
+000299c0: 2020 2020 5265 7375 6c74 2069 7320 6120      Result is a 
+000299d0: 6e65 7720 6461 736b 2041 7272 6179 0a0a  new dask Array..
+000299e0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+000299f0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 636f   --------.    co
+00029a00: 6e63 6174 656e 6174 650a 2020 2020 2222  ncatenate.    ""
+00029a10: 220a 2020 2020 6672 6f6d 2064 6173 6b2e  ".    from dask.
+00029a20: 6172 7261 7920 696d 706f 7274 2077 7261  array import wra
+00029a30: 700a 0a20 2020 2073 6571 203d 205b 6173  p..    seq = [as
+00029a40: 6172 7261 7928 612c 2061 6c6c 6f77 5f75  array(a, allow_u
+00029a50: 6e6b 6e6f 776e 5f63 6875 6e6b 7369 7a65  nknown_chunksize
+00029a60: 733d 616c 6c6f 775f 756e 6b6e 6f77 6e5f  s=allow_unknown_
+00029a70: 6368 756e 6b73 697a 6573 2920 666f 7220  chunksizes) for 
+00029a80: 6120 696e 2073 6571 5d0a 0a20 2020 2069  a in seq]..    i
+00029a90: 6620 6e6f 7420 7365 713a 0a20 2020 2020  f not seq:.     
+00029aa0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00029ab0: 726f 7228 224e 6565 6420 6172 7261 7928  ror("Need array(
+00029ac0: 7329 2074 6f20 7374 6163 6b22 290a 2020  s) to stack").  
+00029ad0: 2020 6966 206e 6f74 2061 6c6c 6f77 5f75    if not allow_u
+00029ae0: 6e6b 6e6f 776e 5f63 6875 6e6b 7369 7a65  nknown_chunksize
+00029af0: 7320 616e 6420 6e6f 7420 616c 6c28 782e  s and not all(x.
+00029b00: 7368 6170 6520 3d3d 2073 6571 5b30 5d2e  shape == seq[0].
+00029b10: 7368 6170 6520 666f 7220 7820 696e 2073  shape for x in s
+00029b20: 6571 293a 0a20 2020 2020 2020 2069 6478  eq):.        idx
+00029b30: 203d 2066 6972 7374 2869 2066 6f72 2069   = first(i for i
+00029b40: 2069 6e20 656e 756d 6572 6174 6528 7365   in enumerate(se
+00029b50: 7129 2069 6620 695b 315d 2e73 6861 7065  q) if i[1].shape
+00029b60: 2021 3d20 7365 715b 305d 2e73 6861 7065   != seq[0].shape
+00029b70: 290a 2020 2020 2020 2020 7261 6973 6520  ).        raise 
+00029b80: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00029b90: 2020 2020 2020 2020 2253 7461 636b 6564          "Stacked
+00029ba0: 2061 7272 6179 7320 6d75 7374 2068 6176   arrays must hav
+00029bb0: 6520 7468 6520 7361 6d65 2073 6861 7065  e the same shape
+00029bc0: 2e20 5468 6520 6669 7273 7420 6172 7261  . The first arra
+00029bd0: 7920 6861 6420 7368 6170 6520 220a 2020  y had shape ".  
+00029be0: 2020 2020 2020 2020 2020 6622 7b73 6571            f"{seq
+00029bf0: 5b30 5d2e 7368 6170 657d 2c20 7768 696c  [0].shape}, whil
+00029c00: 6520 6172 7261 7920 7b69 6478 5b30 5d20  e array {idx[0] 
+00029c10: 2b20 317d 2068 6173 2073 6861 7065 207b  + 1} has shape {
+00029c20: 6964 785b 315d 2e73 6861 7065 7d2e 220a  idx[1].shape}.".
+00029c30: 2020 2020 2020 2020 290a 0a20 2020 206d          )..    m
+00029c40: 6574 6120 3d20 6e70 2e73 7461 636b 285b  eta = np.stack([
+00029c50: 6d65 7461 5f66 726f 6d5f 6172 7261 7928  meta_from_array(
+00029c60: 6129 2066 6f72 2061 2069 6e20 7365 715d  a) for a in seq]
+00029c70: 2c20 6178 6973 3d61 7869 7329 0a20 2020  , axis=axis).   
+00029c80: 2073 6571 203d 205b 782e 6173 7479 7065   seq = [x.astype
+00029c90: 286d 6574 612e 6474 7970 6529 2066 6f72  (meta.dtype) for
+00029ca0: 2078 2069 6e20 7365 715d 0a0a 2020 2020   x in seq]..    
+00029cb0: 6e64 696d 203d 206d 6574 612e 6e64 696d  ndim = meta.ndim
+00029cc0: 202d 2031 0a20 2020 2069 6620 6178 6973   - 1.    if axis
+00029cd0: 203c 2030 3a0a 2020 2020 2020 2020 6178   < 0:.        ax
+00029ce0: 6973 203d 206e 6469 6d20 2b20 6178 6973  is = ndim + axis
+00029cf0: 202b 2031 0a20 2020 2073 6861 7065 203d   + 1.    shape =
+00029d00: 2074 7570 6c65 280a 2020 2020 2020 2020   tuple(.        
+00029d10: 6c65 6e28 7365 7129 0a20 2020 2020 2020  len(seq).       
+00029d20: 2069 6620 6920 3d3d 2061 7869 730a 2020   if i == axis.  
+00029d30: 2020 2020 2020 656c 7365 2028 7365 715b        else (seq[
+00029d40: 305d 2e73 6861 7065 5b69 5d20 6966 2069  0].shape[i] if i
+00029d50: 203c 2061 7869 7320 656c 7365 2073 6571   < axis else seq
+00029d60: 5b30 5d2e 7368 6170 655b 6920 2d20 315d  [0].shape[i - 1]
+00029d70: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
+00029d80: 696e 2072 616e 6765 286d 6574 612e 6e64  in range(meta.nd
+00029d90: 696d 290a 2020 2020 290a 0a20 2020 2073  im).    )..    s
+00029da0: 6571 3220 3d20 5b61 2066 6f72 2061 2069  eq2 = [a for a i
+00029db0: 6e20 7365 7120 6966 2061 2e73 697a 655d  n seq if a.size]
+00029dc0: 0a20 2020 2069 6620 6e6f 7420 7365 7132  .    if not seq2
+00029dd0: 3a0a 2020 2020 2020 2020 7365 7132 203d  :.        seq2 =
+00029de0: 2073 6571 0a0a 2020 2020 6e20 3d20 6c65   seq..    n = le
+00029df0: 6e28 7365 7132 290a 2020 2020 6966 206e  n(seq2).    if n
+00029e00: 203d 3d20 303a 0a20 2020 2020 2020 2074   == 0:.        t
+00029e10: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+00029e20: 7265 7475 726e 2077 7261 702e 656d 7074  return wrap.empt
+00029e30: 795f 6c69 6b65 286d 6574 612c 2073 6861  y_like(meta, sha
+00029e40: 7065 3d73 6861 7065 2c20 6368 756e 6b73  pe=shape, chunks
+00029e50: 3d73 6861 7065 2c20 6474 7970 653d 6d65  =shape, dtype=me
+00029e60: 7461 2e64 7479 7065 290a 2020 2020 2020  ta.dtype).      
+00029e70: 2020 6578 6365 7074 2054 7970 6545 7272    except TypeErr
+00029e80: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00029e90: 7265 7475 726e 2077 7261 702e 656d 7074  return wrap.empt
+00029ea0: 7928 7368 6170 652c 2063 6875 6e6b 733d  y(shape, chunks=
+00029eb0: 7368 6170 652c 2064 7479 7065 3d6d 6574  shape, dtype=met
+00029ec0: 612e 6474 7970 6529 0a0a 2020 2020 696e  a.dtype)..    in
+00029ed0: 6420 3d20 6c69 7374 2872 616e 6765 286e  d = list(range(n
+00029ee0: 6469 6d29 290a 2020 2020 7563 5f61 7267  dim)).    uc_arg
+00029ef0: 7320 3d20 6c69 7374 2863 6f6e 6361 7428  s = list(concat(
+00029f00: 2878 2c20 696e 6429 2066 6f72 2078 2069  (x, ind) for x i
+00029f10: 6e20 7365 7132 2929 0a20 2020 205f 2c20  n seq2)).    _, 
+00029f20: 7365 7132 203d 2075 6e69 6679 5f63 6875  seq2 = unify_chu
+00029f30: 6e6b 7328 2a75 635f 6172 6773 290a 0a20  nks(*uc_args).. 
+00029f40: 2020 2061 7373 6572 7420 6c65 6e28 7b61     assert len({a
+00029f50: 2e63 6875 6e6b 7320 666f 7220 6120 696e  .chunks for a in
+00029f60: 2073 6571 327d 2920 3d3d 2031 2020 2320   seq2}) == 1  # 
+00029f70: 7361 6d65 2063 6875 6e6b 730a 2020 2020  same chunks.    
+00029f80: 6368 756e 6b73 203d 2073 6571 325b 305d  chunks = seq2[0]
+00029f90: 2e63 6875 6e6b 735b 3a61 7869 735d 202b  .chunks[:axis] +
+00029fa0: 2028 2831 2c29 202a 206e 2c29 202b 2073   ((1,) * n,) + s
+00029fb0: 6571 325b 305d 2e63 6875 6e6b 735b 6178  eq2[0].chunks[ax
+00029fc0: 6973 3a5d 0a0a 2020 2020 6e61 6d65 7320  is:]..    names 
+00029fd0: 3d20 5b61 2e6e 616d 6520 666f 7220 6120  = [a.name for a 
+00029fe0: 696e 2073 6571 325d 0a20 2020 206e 616d  in seq2].    nam
+00029ff0: 6520 3d20 2273 7461 636b 2d22 202b 2074  e = "stack-" + t
+0002a000: 6f6b 656e 697a 6528 6e61 6d65 732c 2061  okenize(names, a
+0002a010: 7869 7329 0a20 2020 206b 6579 7320 3d20  xis).    keys = 
+0002a020: 6c69 7374 2870 726f 6475 6374 285b 6e61  list(product([na
+0002a030: 6d65 5d2c 202a 5b72 616e 6765 286c 656e  me], *[range(len
+0002a040: 2862 6429 2920 666f 7220 6264 2069 6e20  (bd)) for bd in 
+0002a050: 6368 756e 6b73 5d29 290a 0a20 2020 2069  chunks]))..    i
+0002a060: 6e70 7574 7320 3d20 5b0a 2020 2020 2020  nputs = [.      
+0002a070: 2020 286e 616d 6573 5b6b 6579 5b61 7869    (names[key[axi
+0002a080: 7320 2b20 315d 5d2c 2920 2b20 6b65 795b  s + 1]],) + key[
+0002a090: 3120 3a20 6178 6973 202b 2031 5d20 2b20  1 : axis + 1] + 
+0002a0a0: 6b65 795b 6178 6973 202b 2032 203a 5d20  key[axis + 2 :] 
+0002a0b0: 666f 7220 6b65 7920 696e 206b 6579 730a  for key in keys.
+0002a0c0: 2020 2020 5d0a 2020 2020 7661 6c75 6573      ].    values
+0002a0d0: 203d 205b 0a20 2020 2020 2020 2028 0a20   = [.        (. 
+0002a0e0: 2020 2020 2020 2020 2020 2067 6574 6974             getit
+0002a0f0: 656d 2c0a 2020 2020 2020 2020 2020 2020  em,.            
+0002a100: 696e 702c 0a20 2020 2020 2020 2020 2020  inp,.           
+0002a110: 2028 736c 6963 6528 4e6f 6e65 2c20 4e6f   (slice(None, No
+0002a120: 6e65 2c20 4e6f 6e65 292c 2920 2a20 6178  ne, None),) * ax
+0002a130: 6973 0a20 2020 2020 2020 2020 2020 202b  is.            +
+0002a140: 2028 4e6f 6e65 2c29 0a20 2020 2020 2020   (None,).       
+0002a150: 2020 2020 202b 2028 736c 6963 6528 4e6f       + (slice(No
+0002a160: 6e65 2c20 4e6f 6e65 2c20 4e6f 6e65 292c  ne, None, None),
+0002a170: 2920 2a20 286e 6469 6d20 2d20 6178 6973  ) * (ndim - axis
+0002a180: 292c 0a20 2020 2020 2020 2029 0a20 2020  ),.        ).   
+0002a190: 2020 2020 2066 6f72 2069 6e70 2069 6e20       for inp in 
+0002a1a0: 696e 7075 7473 0a20 2020 205d 0a0a 2020  inputs.    ]..  
+0002a1b0: 2020 6c61 7965 7220 3d20 6469 6374 287a    layer = dict(z
+0002a1c0: 6970 286b 6579 732c 2076 616c 7565 7329  ip(keys, values)
+0002a1d0: 290a 2020 2020 6772 6170 6820 3d20 4869  ).    graph = Hi
+0002a1e0: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+0002a1f0: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
+0002a200: 6d65 2c20 6c61 7965 722c 2064 6570 656e  me, layer, depen
+0002a210: 6465 6e63 6965 733d 7365 7132 290a 0a20  dencies=seq2).. 
+0002a220: 2020 2072 6574 7572 6e20 4172 7261 7928     return Array(
+0002a230: 6772 6170 682c 206e 616d 652c 2063 6875  graph, name, chu
+0002a240: 6e6b 732c 206d 6574 613d 6d65 7461 290a  nks, meta=meta).
+0002a250: 0a0a 6465 6620 636f 6e63 6174 656e 6174  ..def concatenat
+0002a260: 6533 2861 7272 6179 7329 3a0a 2020 2020  e3(arrays):.    
+0002a270: 2222 2252 6563 7572 7369 7665 206e 702e  """Recursive np.
+0002a280: 636f 6e63 6174 656e 6174 650a 0a20 2020  concatenate..   
+0002a290: 2049 6e70 7574 2073 686f 756c 6420 6265   Input should be
+0002a2a0: 2061 206e 6573 7465 6420 6c69 7374 206f   a nested list o
+0002a2b0: 6620 6e75 6d70 7920 6172 7261 7973 2061  f numpy arrays a
+0002a2c0: 7272 616e 6765 6420 696e 2074 6865 206f  rranged in the o
+0002a2d0: 7264 6572 2074 6865 790a 2020 2020 7368  rder they.    sh
+0002a2e0: 6f75 6c64 2061 7070 6561 7220 696e 2074  ould appear in t
+0002a2f0: 6865 2061 7272 6179 2069 7473 656c 662e  he array itself.
+0002a300: 2020 4561 6368 2061 7272 6179 2073 686f    Each array sho
+0002a310: 756c 6420 6861 7665 2074 6865 2073 616d  uld have the sam
+0002a320: 6520 6e75 6d62 6572 0a20 2020 206f 6620  e number.    of 
+0002a330: 6469 6d65 6e73 696f 6e73 2061 7320 7468  dimensions as th
+0002a340: 6520 6465 7369 7265 6420 6f75 7470 7574  e desired output
+0002a350: 2061 6e64 2074 6865 206e 6573 7469 6e67   and the nesting
+0002a360: 206f 6620 7468 6520 6c69 7374 732e 0a0a   of the lists...
+0002a370: 2020 2020 3e3e 3e20 7820 3d20 6e70 2e61      >>> x = np.a
+0002a380: 7272 6179 285b 5b31 2c20 325d 5d29 0a20  rray([[1, 2]]). 
+0002a390: 2020 203e 3e3e 2063 6f6e 6361 7465 6e61     >>> concatena
+0002a3a0: 7465 3328 5b5b 782c 2078 2c20 785d 2c20  te3([[x, x, x], 
+0002a3b0: 5b78 2c20 782c 2078 5d5d 290a 2020 2020  [x, x, x]]).    
+0002a3c0: 6172 7261 7928 5b5b 312c 2032 2c20 312c  array([[1, 2, 1,
+0002a3d0: 2032 2c20 312c 2032 5d2c 0a20 2020 2020   2, 1, 2],.     
+0002a3e0: 2020 2020 2020 5b31 2c20 322c 2031 2c20        [1, 2, 1, 
+0002a3f0: 322c 2031 2c20 325d 5d29 0a0a 2020 2020  2, 1, 2]])..    
+0002a400: 3e3e 3e20 636f 6e63 6174 656e 6174 6533  >>> concatenate3
+0002a410: 285b 5b78 2c20 785d 2c20 5b78 2c20 785d  ([[x, x], [x, x]
+0002a420: 2c20 5b78 2c20 785d 5d29 0a20 2020 2061  , [x, x]]).    a
+0002a430: 7272 6179 285b 5b31 2c20 322c 2031 2c20  rray([[1, 2, 1, 
+0002a440: 325d 2c0a 2020 2020 2020 2020 2020 205b  2],.           [
+0002a450: 312c 2032 2c20 312c 2032 5d2c 0a20 2020  1, 2, 1, 2],.   
+0002a460: 2020 2020 2020 2020 5b31 2c20 322c 2031          [1, 2, 1
+0002a470: 2c20 325d 5d29 0a20 2020 2022 2222 0a20  , 2]]).    """. 
+0002a480: 2020 2023 2057 6520 6e65 6564 2074 6869     # We need thi
+0002a490: 7320 6173 205f 5f61 7272 6179 5f66 756e  s as __array_fun
+0002a4a0: 6374 696f 6e5f 5f20 6d61 7920 6e6f 7420  ction__ may not 
+0002a4b0: 6578 6973 7420 6f6e 206f 6c64 6572 204e  exist on older N
+0002a4c0: 756d 5079 2076 6572 7369 6f6e 732e 0a20  umPy versions.. 
+0002a4d0: 2020 2023 2041 6e64 2074 6f20 7265 6475     # And to redu
+0002a4e0: 6365 2076 6572 626f 7369 7479 2e0a 2020  ce verbosity..  
+0002a4f0: 2020 4e44 4152 5241 595f 4152 5241 595f    NDARRAY_ARRAY_
+0002a500: 4655 4e43 5449 4f4e 203d 2067 6574 6174  FUNCTION = getat
+0002a510: 7472 286e 702e 6e64 6172 7261 792c 2022  tr(np.ndarray, "
+0002a520: 5f5f 6172 7261 795f 6675 6e63 7469 6f6e  __array_function
+0002a530: 5f5f 222c 204e 6f6e 6529 0a0a 2020 2020  __", None)..    
+0002a540: 6172 7261 7973 203d 2063 6f6e 6372 6574  arrays = concret
+0002a550: 6528 6172 7261 7973 290a 2020 2020 6966  e(arrays).    if
+0002a560: 206e 6f74 2061 7272 6179 733a 0a20 2020   not arrays:.   
+0002a570: 2020 2020 2072 6574 7572 6e20 6e70 2e65       return np.e
+0002a580: 6d70 7479 2830 290a 0a20 2020 2061 6476  mpty(0)..    adv
+0002a590: 616e 6365 6420 3d20 6d61 7828 0a20 2020  anced = max(.   
+0002a5a0: 2020 2020 2063 6f72 652e 666c 6174 7465       core.flatte
+0002a5b0: 6e28 6172 7261 7973 2c20 636f 6e74 6169  n(arrays, contai
+0002a5c0: 6e65 723d 286c 6973 742c 2074 7570 6c65  ner=(list, tuple
+0002a5d0: 2929 2c0a 2020 2020 2020 2020 6b65 793d  )),.        key=
+0002a5e0: 6c61 6d62 6461 2078 3a20 6765 7461 7474  lambda x: getatt
+0002a5f0: 7228 782c 2022 5f5f 6172 7261 795f 7072  r(x, "__array_pr
+0002a600: 696f 7269 7479 5f5f 222c 2030 292c 0a20  iority__", 0),. 
+0002a610: 2020 2029 0a0a 2020 2020 6966 206e 6f74     )..    if not
+0002a620: 2061 6c6c 280a 2020 2020 2020 2020 4e44   all(.        ND
+0002a630: 4152 5241 595f 4152 5241 595f 4655 4e43  ARRAY_ARRAY_FUNC
+0002a640: 5449 4f4e 0a20 2020 2020 2020 2069 7320  TION.        is 
+0002a650: 6765 7461 7474 7228 7479 7065 2861 7272  getattr(type(arr
+0002a660: 292c 2022 5f5f 6172 7261 795f 6675 6e63  ), "__array_func
+0002a670: 7469 6f6e 5f5f 222c 204e 4441 5252 4159  tion__", NDARRAY
+0002a680: 5f41 5252 4159 5f46 554e 4354 494f 4e29  _ARRAY_FUNCTION)
+0002a690: 0a20 2020 2020 2020 2066 6f72 2061 7272  .        for arr
+0002a6a0: 2069 6e20 636f 7265 2e66 6c61 7474 656e   in core.flatten
+0002a6b0: 2861 7272 6179 732c 2063 6f6e 7461 696e  (arrays, contain
+0002a6c0: 6572 3d28 6c69 7374 2c20 7475 706c 6529  er=(list, tuple)
+0002a6d0: 290a 2020 2020 293a 0a20 2020 2020 2020  ).    ):.       
+0002a6e0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0002a6f0: 2020 7820 3d20 756e 7061 636b 5f73 696e    x = unpack_sin
+0002a700: 676c 6574 6f6e 2861 7272 6179 7329 0a20  gleton(arrays). 
+0002a710: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0002a720: 6e20 5f63 6f6e 6361 7465 6e61 7465 3228  n _concatenate2(
+0002a730: 6172 7261 7973 2c20 6178 6573 3d74 7570  arrays, axes=tup
+0002a740: 6c65 2872 616e 6765 2878 2e6e 6469 6d29  le(range(x.ndim)
+0002a750: 2929 0a20 2020 2020 2020 2065 7863 6570  )).        excep
+0002a760: 7420 5479 7065 4572 726f 723a 0a20 2020  t TypeError:.   
+0002a770: 2020 2020 2020 2020 2070 6173 730a 0a20           pass.. 
+0002a780: 2020 2069 6620 636f 6e63 6174 656e 6174     if concatenat
+0002a790: 655f 6c6f 6f6b 7570 2e64 6973 7061 7463  e_lookup.dispatc
+0002a7a0: 6828 7479 7065 2861 6476 616e 6365 6429  h(type(advanced)
+0002a7b0: 2920 6973 206e 6f74 206e 702e 636f 6e63  ) is not np.conc
+0002a7c0: 6174 656e 6174 653a 0a20 2020 2020 2020  atenate:.       
+0002a7d0: 2078 203d 2075 6e70 6163 6b5f 7369 6e67   x = unpack_sing
+0002a7e0: 6c65 746f 6e28 6172 7261 7973 290a 2020  leton(arrays).  
+0002a7f0: 2020 2020 2020 7265 7475 726e 205f 636f        return _co
+0002a800: 6e63 6174 656e 6174 6532 2861 7272 6179  ncatenate2(array
+0002a810: 732c 2061 7865 733d 6c69 7374 2872 616e  s, axes=list(ran
+0002a820: 6765 2878 2e6e 6469 6d29 2929 0a0a 2020  ge(x.ndim)))..  
+0002a830: 2020 6e64 696d 203d 206e 6469 6d6c 6973    ndim = ndimlis
+0002a840: 7428 6172 7261 7973 290a 2020 2020 6966  t(arrays).    if
+0002a850: 206e 6f74 206e 6469 6d3a 0a20 2020 2020   not ndim:.     
+0002a860: 2020 2072 6574 7572 6e20 6172 7261 7973     return arrays
+0002a870: 0a20 2020 2063 6875 6e6b 7320 3d20 6368  .    chunks = ch
+0002a880: 756e 6b73 5f66 726f 6d5f 6172 7261 7973  unks_from_arrays
+0002a890: 2861 7272 6179 7329 0a20 2020 2073 6861  (arrays).    sha
+0002a8a0: 7065 203d 2074 7570 6c65 286d 6170 2873  pe = tuple(map(s
+0002a8b0: 756d 2c20 6368 756e 6b73 2929 0a0a 2020  um, chunks))..  
+0002a8c0: 2020 6465 6620 6474 7970 6528 7829 3a0a    def dtype(x):.
+0002a8d0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0002a8e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0002a8f0: 782e 6474 7970 650a 2020 2020 2020 2020  x.dtype.        
+0002a900: 6578 6365 7074 2041 7474 7269 6275 7465  except Attribute
+0002a910: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
+0002a920: 2020 2072 6574 7572 6e20 7479 7065 2878     return type(x
+0002a930: 290a 0a20 2020 2072 6573 756c 7420 3d20  )..    result = 
+0002a940: 6e70 2e65 6d70 7479 2873 6861 7065 3d73  np.empty(shape=s
+0002a950: 6861 7065 2c20 6474 7970 653d 6474 7970  hape, dtype=dtyp
+0002a960: 6528 6465 6570 6669 7273 7428 6172 7261  e(deepfirst(arra
+0002a970: 7973 2929 290a 0a20 2020 2066 6f72 2069  ys)))..    for i
+0002a980: 6478 2c20 6172 7220 696e 207a 6970 280a  dx, arr in zip(.
+0002a990: 2020 2020 2020 2020 736c 6963 6573 5f66          slices_f
+0002a9a0: 726f 6d5f 6368 756e 6b73 2863 6875 6e6b  rom_chunks(chunk
+0002a9b0: 7329 2c20 636f 7265 2e66 6c61 7474 656e  s), core.flatten
+0002a9c0: 2861 7272 6179 732c 2063 6f6e 7461 696e  (arrays, contain
+0002a9d0: 6572 3d28 6c69 7374 2c20 7475 706c 6529  er=(list, tuple)
+0002a9e0: 290a 2020 2020 293a 0a20 2020 2020 2020  ).    ):.       
+0002a9f0: 2069 6620 6861 7361 7474 7228 6172 722c   if hasattr(arr,
+0002aa00: 2022 6e64 696d 2229 3a0a 2020 2020 2020   "ndim"):.      
+0002aa10: 2020 2020 2020 7768 696c 6520 6172 722e        while arr.
+0002aa20: 6e64 696d 203c 206e 6469 6d3a 0a20 2020  ndim < ndim:.   
+0002aa30: 2020 2020 2020 2020 2020 2020 2061 7272               arr
+0002aa40: 203d 2061 7272 5b4e 6f6e 652c 202e 2e2e   = arr[None, ...
+0002aa50: 5d0a 2020 2020 2020 2020 7265 7375 6c74  ].        result
+0002aa60: 5b69 6478 5d20 3d20 6172 720a 0a20 2020  [idx] = arr..   
+0002aa70: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
+0002aa80: 0a64 6566 2063 6f6e 6361 7465 6e61 7465  .def concatenate
+0002aa90: 5f61 7865 7328 6172 7261 7973 2c20 6178  _axes(arrays, ax
+0002aaa0: 6573 293a 0a20 2020 2022 2222 5265 6375  es):.    """Recu
+0002aab0: 7273 6976 656c 7920 6361 6c6c 206e 702e  rsively call np.
+0002aac0: 636f 6e63 6174 656e 6174 6520 616c 6f6e  concatenate alon
+0002aad0: 6720 6178 6573 2222 220a 2020 2020 6966  g axes""".    if
+0002aae0: 206c 656e 2861 7865 7329 2021 3d20 6e64   len(axes) != nd
+0002aaf0: 696d 6c69 7374 2861 7272 6179 7329 3a0a  imlist(arrays):.
+0002ab00: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0002ab10: 6c75 6545 7272 6f72 2822 4c65 6e67 7468  lueError("Length
+0002ab20: 206f 6620 6178 6573 2073 686f 756c 6420   of axes should 
+0002ab30: 6571 7561 6c20 6465 7074 6820 6f66 206e  equal depth of n
+0002ab40: 6573 7465 6420 6172 7261 7973 2229 0a0a  ested arrays")..
+0002ab50: 2020 2020 6578 7472 6164 696d 7320 3d20      extradims = 
+0002ab60: 6d61 7828 302c 2064 6565 7066 6972 7374  max(0, deepfirst
+0002ab70: 2861 7272 6179 7329 2e6e 6469 6d20 2d20  (arrays).ndim - 
+0002ab80: 286d 6178 2861 7865 7329 202b 2031 2929  (max(axes) + 1))
+0002ab90: 0a20 2020 2072 6574 7572 6e20 636f 6e63  .    return conc
+0002aba0: 6174 656e 6174 6533 2874 7261 6e73 706f  atenate3(transpo
+0002abb0: 7365 6c69 7374 2861 7272 6179 732c 2061  selist(arrays, a
+0002abc0: 7865 732c 2065 7874 7261 6469 6d73 3d65  xes, extradims=e
+0002abd0: 7874 7261 6469 6d73 2929 0a0a 0a64 6566  xtradims))...def
+0002abe0: 2074 6f5f 6864 6635 2866 696c 656e 616d   to_hdf5(filenam
+0002abf0: 652c 202a 6172 6773 2c20 6368 756e 6b73  e, *args, chunks
+0002ac00: 3d54 7275 652c 202a 2a6b 7761 7267 7329  =True, **kwargs)
+0002ac10: 3a0a 2020 2020 2222 2253 746f 7265 2061  :.    """Store a
+0002ac20: 7272 6179 7320 696e 2048 4446 3520 6669  rrays in HDF5 fi
+0002ac30: 6c65 0a0a 2020 2020 5468 6973 2073 6176  le..    This sav
+0002ac40: 6573 2073 6576 6572 616c 2064 6173 6b20  es several dask 
+0002ac50: 6172 7261 7973 2069 6e74 6f20 7365 7665  arrays into seve
+0002ac60: 7261 6c20 6461 7461 7061 7468 7320 696e  ral datapaths in
+0002ac70: 2061 6e20 4844 4635 2066 696c 652e 0a20   an HDF5 file.. 
+0002ac80: 2020 2049 7420 6372 6561 7465 7320 7468     It creates th
+0002ac90: 6520 6e65 6365 7373 6172 7920 6461 7461  e necessary data
+0002aca0: 7365 7473 2061 6e64 2068 616e 646c 6573  sets and handles
+0002acb0: 2063 6c65 616e 2066 696c 6520 6f70 656e   clean file open
+0002acc0: 696e 672f 636c 6f73 696e 672e 0a0a 2020  ing/closing...  
+0002acd0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0002ace0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0002acf0: 6368 756e 6b73 3a20 7475 706c 6520 6f72  chunks: tuple or
+0002ad00: 2060 6054 7275 6560 600a 2020 2020 2020   ``True``.      
+0002ad10: 2020 4368 756e 6b20 7368 6170 652c 206f    Chunk shape, o
+0002ad20: 7220 6060 5472 7565 6060 2074 6f20 7061  r ``True`` to pa
+0002ad30: 7373 2074 6865 2063 6875 6e6b 7320 6672  ss the chunks fr
+0002ad40: 6f6d 2074 6865 2064 6173 6b20 6172 7261  om the dask arra
+0002ad50: 792e 0a20 2020 2020 2020 2044 6566 6175  y..        Defau
+0002ad60: 6c74 7320 746f 2060 6054 7275 6560 602e  lts to ``True``.
+0002ad70: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
+0002ad80: 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20 2020     --------..   
+0002ad90: 203e 3e3e 2064 612e 746f 5f68 6466 3528   >>> da.to_hdf5(
+0002ada0: 276d 7966 696c 652e 6864 6635 272c 2027  'myfile.hdf5', '
+0002adb0: 2f78 272c 2078 2920 2023 2064 6f63 7465  /x', x)  # docte
+0002adc0: 7374 3a20 2b53 4b49 500a 0a20 2020 206f  st: +SKIP..    o
+0002add0: 720a 0a20 2020 203e 3e3e 2064 612e 746f  r..    >>> da.to
+0002ade0: 5f68 6466 3528 276d 7966 696c 652e 6864  _hdf5('myfile.hd
+0002adf0: 6635 272c 207b 272f 7827 3a20 782c 2027  f5', {'/x': x, '
+0002ae00: 2f79 273a 2079 7d29 2020 2320 646f 6374  /y': y})  # doct
+0002ae10: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
+0002ae20: 4f70 7469 6f6e 616c 6c79 2070 726f 7669  Optionally provi
+0002ae30: 6465 2061 7267 756d 656e 7473 2061 7320  de arguments as 
+0002ae40: 7468 6f75 6768 2074 6f20 6060 6835 7079  though to ``h5py
+0002ae50: 2e46 696c 652e 6372 6561 7465 5f64 6174  .File.create_dat
+0002ae60: 6173 6574 6060 0a0a 2020 2020 3e3e 3e20  aset``..    >>> 
+0002ae70: 6461 2e74 6f5f 6864 6635 2827 6d79 6669  da.to_hdf5('myfi
+0002ae80: 6c65 2e68 6466 3527 2c20 272f 7827 2c20  le.hdf5', '/x', 
+0002ae90: 782c 2063 6f6d 7072 6573 7369 6f6e 3d27  x, compression='
+0002aea0: 6c7a 6627 2c20 7368 7566 666c 653d 5472  lzf', shuffle=Tr
+0002aeb0: 7565 2920 2023 2064 6f63 7465 7374 3a20  ue)  # doctest: 
+0002aec0: 2b53 4b49 500a 0a20 2020 203e 3e3e 2064  +SKIP..    >>> d
+0002aed0: 612e 746f 5f68 6466 3528 276d 7966 696c  a.to_hdf5('myfil
+0002aee0: 652e 6864 6635 272c 2027 2f78 272c 2078  e.hdf5', '/x', x
+0002aef0: 2c20 6368 756e 6b73 3d28 3130 2c32 302c  , chunks=(10,20,
+0002af00: 3330 2929 2020 2320 646f 6374 6573 743a  30))  # doctest:
+0002af10: 202b 534b 4950 0a0a 2020 2020 5468 6973   +SKIP..    This
+0002af20: 2063 616e 2061 6c73 6f20 6265 2075 7365   can also be use
+0002af30: 6420 6173 2061 206d 6574 686f 6420 6f6e  d as a method on
+0002af40: 2061 2073 696e 676c 6520 4172 7261 790a   a single Array.
+0002af50: 0a20 2020 203e 3e3e 2078 2e74 6f5f 6864  .    >>> x.to_hd
+0002af60: 6635 2827 6d79 6669 6c65 2e68 6466 3527  f5('myfile.hdf5'
+0002af70: 2c20 272f 7827 2920 2023 2064 6f63 7465  , '/x')  # docte
+0002af80: 7374 3a20 2b53 4b49 500a 0a20 2020 2053  st: +SKIP..    S
+0002af90: 6565 2041 6c73 6f0a 2020 2020 2d2d 2d2d  ee Also.    ----
+0002afa0: 2d2d 2d2d 0a20 2020 2064 612e 7374 6f72  ----.    da.stor
+0002afb0: 650a 2020 2020 6835 7079 2e46 696c 652e  e.    h5py.File.
+0002afc0: 6372 6561 7465 5f64 6174 6173 6574 0a20  create_dataset. 
+0002afd0: 2020 2022 2222 0a20 2020 2069 6620 6c65     """.    if le
+0002afe0: 6e28 6172 6773 2920 3d3d 2031 2061 6e64  n(args) == 1 and
+0002aff0: 2069 7369 6e73 7461 6e63 6528 6172 6773   isinstance(args
+0002b000: 5b30 5d2c 2064 6963 7429 3a0a 2020 2020  [0], dict):.    
+0002b010: 2020 2020 6461 7461 203d 2061 7267 735b      data = args[
+0002b020: 305d 0a20 2020 2065 6c69 6620 6c65 6e28  0].    elif len(
+0002b030: 6172 6773 2920 3d3d 2032 2061 6e64 2069  args) == 2 and i
+0002b040: 7369 6e73 7461 6e63 6528 6172 6773 5b30  sinstance(args[0
+0002b050: 5d2c 2073 7472 2920 616e 6420 6973 696e  ], str) and isin
+0002b060: 7374 616e 6365 2861 7267 735b 315d 2c20  stance(args[1], 
+0002b070: 4172 7261 7929 3a0a 2020 2020 2020 2020  Array):.        
+0002b080: 6461 7461 203d 207b 6172 6773 5b30 5d3a  data = {args[0]:
+0002b090: 2061 7267 735b 315d 7d0a 2020 2020 656c   args[1]}.    el
+0002b0a0: 7365 3a0a 2020 2020 2020 2020 7261 6973  se:.        rais
+0002b0b0: 6520 5661 6c75 6545 7272 6f72 2822 506c  e ValueError("Pl
+0002b0c0: 6561 7365 2070 726f 7669 6465 207b 272f  ease provide {'/
+0002b0d0: 6461 7461 2f70 6174 6827 3a20 6172 7261  data/path': arra
+0002b0e0: 797d 2064 6963 7469 6f6e 6172 7922 290a  y} dictionary").
+0002b0f0: 0a20 2020 2069 6d70 6f72 7420 6835 7079  .    import h5py
+0002b100: 0a0a 2020 2020 7769 7468 2068 3570 792e  ..    with h5py.
+0002b110: 4669 6c65 2866 696c 656e 616d 652c 206d  File(filename, m
+0002b120: 6f64 653d 2261 2229 2061 7320 663a 0a20  ode="a") as f:. 
+0002b130: 2020 2020 2020 2064 7365 7473 203d 205b         dsets = [
+0002b140: 0a20 2020 2020 2020 2020 2020 2066 2e72  .            f.r
+0002b150: 6571 7569 7265 5f64 6174 6173 6574 280a  equire_dataset(.
+0002b160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b170: 6470 2c0a 2020 2020 2020 2020 2020 2020  dp,.            
+0002b180: 2020 2020 7368 6170 653d 782e 7368 6170      shape=x.shap
+0002b190: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0002b1a0: 2020 2064 7479 7065 3d78 2e64 7479 7065     dtype=x.dtype
+0002b1b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002b1c0: 2020 6368 756e 6b73 3d74 7570 6c65 2863    chunks=tuple(c
+0002b1d0: 5b30 5d20 666f 7220 6320 696e 2078 2e63  [0] for c in x.c
+0002b1e0: 6875 6e6b 7329 2069 6620 6368 756e 6b73  hunks) if chunks
+0002b1f0: 2069 7320 5472 7565 2065 6c73 6520 6368   is True else ch
+0002b200: 756e 6b73 2c0a 2020 2020 2020 2020 2020  unks,.          
+0002b210: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
+0002b220: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0002b230: 2020 2020 2020 2020 2020 666f 7220 6470            for dp
+0002b240: 2c20 7820 696e 2064 6174 612e 6974 656d  , x in data.item
+0002b250: 7328 290a 2020 2020 2020 2020 5d0a 2020  s().        ].  
+0002b260: 2020 2020 2020 7374 6f72 6528 6c69 7374        store(list
+0002b270: 2864 6174 612e 7661 6c75 6573 2829 292c  (data.values()),
+0002b280: 2064 7365 7473 290a 0a0a 6465 6620 696e   dsets)...def in
+0002b290: 7465 726c 6561 7665 5f6e 6f6e 6528 612c  terleave_none(a,
+0002b2a0: 2062 293a 0a20 2020 2022 2222 0a0a 2020   b):.    """..  
+0002b2b0: 2020 3e3e 3e20 696e 7465 726c 6561 7665    >>> interleave
+0002b2c0: 5f6e 6f6e 6528 5b30 2c20 4e6f 6e65 2c20  _none([0, None, 
+0002b2d0: 322c 204e 6f6e 655d 2c20 5b31 2c20 335d  2, None], [1, 3]
+0002b2e0: 290a 2020 2020 2830 2c20 312c 2032 2c20  ).    (0, 1, 2, 
+0002b2f0: 3329 0a20 2020 2022 2222 0a20 2020 2072  3).    """.    r
+0002b300: 6573 756c 7420 3d20 5b5d 0a20 2020 2069  esult = [].    i
+0002b310: 203d 206a 203d 2030 0a20 2020 206e 203d   = j = 0.    n =
+0002b320: 206c 656e 2861 2920 2b20 6c65 6e28 6229   len(a) + len(b)
+0002b330: 0a20 2020 2077 6869 6c65 2069 202b 206a  .    while i + j
+0002b340: 203c 206e 3a0a 2020 2020 2020 2020 6966   < n:.        if
+0002b350: 2061 5b69 5d20 6973 206e 6f74 204e 6f6e   a[i] is not Non
+0002b360: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0002b370: 6573 756c 742e 6170 7065 6e64 2861 5b69  esult.append(a[i
+0002b380: 5d29 0a20 2020 2020 2020 2020 2020 2069  ]).            i
+0002b390: 202b 3d20 310a 2020 2020 2020 2020 656c   += 1.        el
+0002b3a0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0002b3b0: 7265 7375 6c74 2e61 7070 656e 6428 625b  result.append(b[
+0002b3c0: 6a5d 290a 2020 2020 2020 2020 2020 2020  j]).            
+0002b3d0: 6920 2b3d 2031 0a20 2020 2020 2020 2020  i += 1.         
+0002b3e0: 2020 206a 202b 3d20 310a 2020 2020 7265     j += 1.    re
+0002b3f0: 7475 726e 2074 7570 6c65 2872 6573 756c  turn tuple(resul
+0002b400: 7429 0a0a 0a64 6566 206b 6579 6e61 6d65  t)...def keyname
+0002b410: 286e 616d 652c 2069 2c20 6f6b 6579 293a  (name, i, okey):
+0002b420: 0a20 2020 2022 2222 0a0a 2020 2020 3e3e  .    """..    >>
+0002b430: 3e20 6b65 796e 616d 6528 2778 272c 2033  > keyname('x', 3
+0002b440: 2c20 5b4e 6f6e 652c 204e 6f6e 652c 2030  , [None, None, 0
+0002b450: 2c20 325d 290a 2020 2020 2827 7827 2c20  , 2]).    ('x', 
+0002b460: 332c 2030 2c20 3229 0a20 2020 2022 2222  3, 0, 2).    """
+0002b470: 0a20 2020 2072 6574 7572 6e20 286e 616d  .    return (nam
+0002b480: 652c 2069 2920 2b20 7475 706c 6528 6b20  e, i) + tuple(k 
+0002b490: 666f 7220 6b20 696e 206f 6b65 7920 6966  for k in okey if
+0002b4a0: 206b 2069 7320 6e6f 7420 4e6f 6e65 290a   k is not None).
+0002b4b0: 0a0a 6465 6620 5f76 696e 6465 7828 782c  ..def _vindex(x,
+0002b4c0: 202a 696e 6465 7865 7329 3a0a 2020 2020   *indexes):.    
+0002b4d0: 2222 2250 6f69 6e74 2077 6973 6520 696e  """Point wise in
+0002b4e0: 6465 7869 6e67 2077 6974 6820 6272 6f61  dexing with broa
+0002b4f0: 6463 6173 7469 6e67 2e0a 0a20 2020 203e  dcasting...    >
+0002b500: 3e3e 2078 203d 206e 702e 6172 616e 6765  >> x = np.arange
+0002b510: 2835 3629 2e72 6573 6861 7065 2828 372c  (56).reshape((7,
+0002b520: 2038 2929 0a20 2020 203e 3e3e 2078 0a20   8)).    >>> x. 
+0002b530: 2020 2061 7272 6179 285b 5b20 302c 2020     array([[ 0,  
+0002b540: 312c 2020 322c 2020 332c 2020 342c 2020  1,  2,  3,  4,  
+0002b550: 352c 2020 362c 2020 375d 2c0a 2020 2020  5,  6,  7],.    
+0002b560: 2020 2020 2020 205b 2038 2c20 2039 2c20         [ 8,  9, 
+0002b570: 3130 2c20 3131 2c20 3132 2c20 3133 2c20  10, 11, 12, 13, 
+0002b580: 3134 2c20 3135 5d2c 0a20 2020 2020 2020  14, 15],.       
+0002b590: 2020 2020 5b31 362c 2031 372c 2031 382c      [16, 17, 18,
+0002b5a0: 2031 392c 2032 302c 2032 312c 2032 322c   19, 20, 21, 22,
+0002b5b0: 2032 335d 2c0a 2020 2020 2020 2020 2020   23],.          
+0002b5c0: 205b 3234 2c20 3235 2c20 3236 2c20 3237   [24, 25, 26, 27
+0002b5d0: 2c20 3238 2c20 3239 2c20 3330 2c20 3331  , 28, 29, 30, 31
+0002b5e0: 5d2c 0a20 2020 2020 2020 2020 2020 5b33  ],.           [3
+0002b5f0: 322c 2033 332c 2033 342c 2033 352c 2033  2, 33, 34, 35, 3
+0002b600: 362c 2033 372c 2033 382c 2033 395d 2c0a  6, 37, 38, 39],.
+0002b610: 2020 2020 2020 2020 2020 205b 3430 2c20             [40, 
+0002b620: 3431 2c20 3432 2c20 3433 2c20 3434 2c20  41, 42, 43, 44, 
+0002b630: 3435 2c20 3436 2c20 3437 5d2c 0a20 2020  45, 46, 47],.   
+0002b640: 2020 2020 2020 2020 5b34 382c 2034 392c          [48, 49,
+0002b650: 2035 302c 2035 312c 2035 322c 2035 332c   50, 51, 52, 53,
+0002b660: 2035 342c 2035 355d 5d29 0a0a 2020 2020   54, 55]])..    
+0002b670: 3e3e 3e20 6420 3d20 6672 6f6d 5f61 7272  >>> d = from_arr
+0002b680: 6179 2878 2c20 6368 756e 6b73 3d28 332c  ay(x, chunks=(3,
+0002b690: 2034 2929 0a20 2020 203e 3e3e 2072 6573   4)).    >>> res
+0002b6a0: 756c 7420 3d20 5f76 696e 6465 7828 642c  ult = _vindex(d,
+0002b6b0: 205b 302c 2031 2c20 362c 2030 5d2c 205b   [0, 1, 6, 0], [
+0002b6c0: 302c 2031 2c20 302c 2037 5d29 0a20 2020  0, 1, 0, 7]).   
+0002b6d0: 203e 3e3e 2072 6573 756c 742e 636f 6d70   >>> result.comp
+0002b6e0: 7574 6528 290a 2020 2020 6172 7261 7928  ute().    array(
+0002b6f0: 5b20 302c 2020 392c 2034 382c 2020 375d  [ 0,  9, 48,  7]
+0002b700: 290a 2020 2020 2222 220a 2020 2020 696e  ).    """.    in
+0002b710: 6465 7865 7320 3d20 7265 706c 6163 655f  dexes = replace_
+0002b720: 656c 6c69 7073 6973 2878 2e6e 6469 6d2c  ellipsis(x.ndim,
+0002b730: 2069 6e64 6578 6573 290a 0a20 2020 206e   indexes)..    n
+0002b740: 6f6e 6661 6e63 795f 696e 6465 7865 7320  onfancy_indexes 
+0002b750: 3d20 5b5d 0a20 2020 2072 6564 7563 6564  = [].    reduced
+0002b760: 5f69 6e64 6578 6573 203d 205b 5d0a 2020  _indexes = [].  
+0002b770: 2020 666f 7220 696e 6420 696e 2069 6e64    for ind in ind
+0002b780: 6578 6573 3a0a 2020 2020 2020 2020 6966  exes:.        if
+0002b790: 2069 7369 6e73 7461 6e63 6528 696e 642c   isinstance(ind,
+0002b7a0: 204e 756d 6265 7229 3a0a 2020 2020 2020   Number):.      
+0002b7b0: 2020 2020 2020 6e6f 6e66 616e 6379 5f69        nonfancy_i
+0002b7c0: 6e64 6578 6573 2e61 7070 656e 6428 696e  ndexes.append(in
+0002b7d0: 6429 0a20 2020 2020 2020 2065 6c69 6620  d).        elif 
+0002b7e0: 6973 696e 7374 616e 6365 2869 6e64 2c20  isinstance(ind, 
+0002b7f0: 736c 6963 6529 3a0a 2020 2020 2020 2020  slice):.        
+0002b800: 2020 2020 6e6f 6e66 616e 6379 5f69 6e64      nonfancy_ind
+0002b810: 6578 6573 2e61 7070 656e 6428 696e 6429  exes.append(ind)
+0002b820: 0a20 2020 2020 2020 2020 2020 2072 6564  .            red
+0002b830: 7563 6564 5f69 6e64 6578 6573 2e61 7070  uced_indexes.app
+0002b840: 656e 6428 736c 6963 6528 4e6f 6e65 2929  end(slice(None))
+0002b850: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0002b860: 2020 2020 2020 2020 2020 206e 6f6e 6661             nonfa
+0002b870: 6e63 795f 696e 6465 7865 732e 6170 7065  ncy_indexes.appe
+0002b880: 6e64 2873 6c69 6365 284e 6f6e 6529 290a  nd(slice(None)).
+0002b890: 2020 2020 2020 2020 2020 2020 7265 6475              redu
+0002b8a0: 6365 645f 696e 6465 7865 732e 6170 7065  ced_indexes.appe
+0002b8b0: 6e64 2869 6e64 290a 0a20 2020 206e 6f6e  nd(ind)..    non
+0002b8c0: 6661 6e63 795f 696e 6465 7865 7320 3d20  fancy_indexes = 
+0002b8d0: 7475 706c 6528 6e6f 6e66 616e 6379 5f69  tuple(nonfancy_i
+0002b8e0: 6e64 6578 6573 290a 2020 2020 7265 6475  ndexes).    redu
+0002b8f0: 6365 645f 696e 6465 7865 7320 3d20 7475  ced_indexes = tu
+0002b900: 706c 6528 7265 6475 6365 645f 696e 6465  ple(reduced_inde
+0002b910: 7865 7329 0a0a 2020 2020 7820 3d20 785b  xes)..    x = x[
+0002b920: 6e6f 6e66 616e 6379 5f69 6e64 6578 6573  nonfancy_indexes
+0002b930: 5d0a 0a20 2020 2061 7272 6179 5f69 6e64  ]..    array_ind
+0002b940: 6578 6573 203d 207b 7d0a 2020 2020 666f  exes = {}.    fo
+0002b950: 7220 692c 2028 696e 642c 2073 697a 6529  r i, (ind, size)
+0002b960: 2069 6e20 656e 756d 6572 6174 6528 7a69   in enumerate(zi
+0002b970: 7028 7265 6475 6365 645f 696e 6465 7865  p(reduced_indexe
+0002b980: 732c 2078 2e73 6861 7065 2929 3a0a 2020  s, x.shape)):.  
+0002b990: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+0002b9a0: 6e73 7461 6e63 6528 696e 642c 2073 6c69  nstance(ind, sli
+0002b9b0: 6365 293a 0a20 2020 2020 2020 2020 2020  ce):.           
+0002b9c0: 2069 6e64 203d 206e 702e 6172 7261 7928   ind = np.array(
+0002b9d0: 696e 642c 2063 6f70 793d 5472 7565 290a  ind, copy=True).
+0002b9e0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0002b9f0: 6e64 2e64 7479 7065 2e6b 696e 6420 3d3d  nd.dtype.kind ==
+0002ba00: 2022 6222 3a0a 2020 2020 2020 2020 2020   "b":.          
+0002ba10: 2020 2020 2020 7261 6973 6520 496e 6465        raise Inde
+0002ba20: 7845 7272 6f72 2822 7669 6e64 6578 2064  xError("vindex d
+0002ba30: 6f65 7320 6e6f 7420 7375 7070 6f72 7420  oes not support 
+0002ba40: 696e 6465 7869 6e67 2077 6974 6820 626f  indexing with bo
+0002ba50: 6f6c 6561 6e20 6172 7261 7973 2229 0a20  olean arrays"). 
+0002ba60: 2020 2020 2020 2020 2020 2069 6620 2828             if ((
+0002ba70: 696e 6420 3e3d 2073 697a 6529 207c 2028  ind >= size) | (
+0002ba80: 696e 6420 3c20 2d73 697a 6529 292e 616e  ind < -size)).an
+0002ba90: 7928 293a 0a20 2020 2020 2020 2020 2020  y():.           
+0002baa0: 2020 2020 2072 6169 7365 2049 6e64 6578       raise Index
+0002bab0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0002bac0: 2020 2020 2020 2020 2020 2022 7669 6e64             "vind
+0002bad0: 6578 206b 6579 2068 6173 2065 6e74 7269  ex key has entri
+0002bae0: 6573 206f 7574 206f 6620 626f 756e 6473  es out of bounds
+0002baf0: 2066 6f72 2022 0a20 2020 2020 2020 2020   for ".         
+0002bb00: 2020 2020 2020 2020 2020 2022 696e 6465             "inde
+0002bb10: 7869 6e67 2061 6c6f 6e67 2061 7869 7320  xing along axis 
+0002bb20: 2573 206f 6620 7369 7a65 2025 733a 2025  %s of size %s: %
+0002bb30: 7222 2025 2028 692c 2073 697a 652c 2069  r" % (i, size, i
+0002bb40: 6e64 290a 2020 2020 2020 2020 2020 2020  nd).            
+0002bb50: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0002bb60: 2020 696e 6420 253d 2073 697a 650a 2020    ind %= size.  
+0002bb70: 2020 2020 2020 2020 2020 6172 7261 795f            array_
+0002bb80: 696e 6465 7865 735b 695d 203d 2069 6e64  indexes[i] = ind
+0002bb90: 0a0a 2020 2020 6966 2061 7272 6179 5f69  ..    if array_i
+0002bba0: 6e64 6578 6573 3a0a 2020 2020 2020 2020  ndexes:.        
+0002bbb0: 7820 3d20 5f76 696e 6465 785f 6172 7261  x = _vindex_arra
+0002bbc0: 7928 782c 2061 7272 6179 5f69 6e64 6578  y(x, array_index
+0002bbd0: 6573 290a 0a20 2020 2072 6574 7572 6e20  es)..    return 
+0002bbe0: 780a 0a0a 6465 6620 5f76 696e 6465 785f  x...def _vindex_
+0002bbf0: 6172 7261 7928 782c 2064 6963 745f 696e  array(x, dict_in
+0002bc00: 6465 7865 7329 3a0a 2020 2020 2222 2250  dexes):.    """P
+0002bc10: 6f69 6e74 2077 6973 6520 696e 6465 7869  oint wise indexi
+0002bc20: 6e67 2077 6974 6820 6f6e 6c79 204e 756d  ng with only Num
+0002bc30: 5079 2041 7272 6179 732e 2222 220a 0a20  Py Arrays.""".. 
+0002bc40: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+0002bc50: 6272 6f61 6463 6173 745f 696e 6465 7865  broadcast_indexe
+0002bc60: 7320 3d20 6e70 2e62 726f 6164 6361 7374  s = np.broadcast
+0002bc70: 5f61 7272 6179 7328 2a64 6963 745f 696e  _arrays(*dict_in
+0002bc80: 6465 7865 732e 7661 6c75 6573 2829 290a  dexes.values()).
+0002bc90: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
+0002bca0: 4572 726f 7220 6173 2065 3a0a 2020 2020  Error as e:.    
+0002bcb0: 2020 2020 2320 6e6f 7465 3a20 6572 726f      # note: erro
+0002bcc0: 7220 6d65 7373 6167 6520 6578 6163 746c  r message exactl
+0002bcd0: 7920 6d61 7463 6865 7320 6e75 6d70 790a  y matches numpy.
+0002bce0: 2020 2020 2020 2020 7368 6170 6573 5f73          shapes_s
+0002bcf0: 7472 203d 2022 2022 2e6a 6f69 6e28 7374  tr = " ".join(st
+0002bd00: 7228 612e 7368 6170 6529 2066 6f72 2061  r(a.shape) for a
+0002bd10: 2069 6e20 6469 6374 5f69 6e64 6578 6573   in dict_indexes
+0002bd20: 2e76 616c 7565 7328 2929 0a20 2020 2020  .values()).     
+0002bd30: 2020 2072 6169 7365 2049 6e64 6578 4572     raise IndexEr
+0002bd40: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0002bd50: 2022 7368 6170 6520 6d69 736d 6174 6368   "shape mismatch
+0002bd60: 3a20 696e 6465 7869 6e67 2061 7272 6179  : indexing array
+0002bd70: 7320 636f 756c 6420 6e6f 7420 6265 2022  s could not be "
+0002bd80: 0a20 2020 2020 2020 2020 2020 2022 6272  .            "br
+0002bd90: 6f61 6463 6173 7420 746f 6765 7468 6572  oadcast together
+0002bda0: 2077 6974 6820 7368 6170 6573 2022 202b   with shapes " +
+0002bdb0: 2073 6861 7065 735f 7374 720a 2020 2020   shapes_str.    
+0002bdc0: 2020 2020 2920 6672 6f6d 2065 0a20 2020      ) from e.   
+0002bdd0: 2062 726f 6164 6361 7374 5f73 6861 7065   broadcast_shape
+0002bde0: 203d 2062 726f 6164 6361 7374 5f69 6e64   = broadcast_ind
+0002bdf0: 6578 6573 5b30 5d2e 7368 6170 650a 0a20  exes[0].shape.. 
+0002be00: 2020 206c 6f6f 6b75 7020 3d20 6469 6374     lookup = dict
+0002be10: 287a 6970 2864 6963 745f 696e 6465 7865  (zip(dict_indexe
+0002be20: 732c 2062 726f 6164 6361 7374 5f69 6e64  s, broadcast_ind
+0002be30: 6578 6573 2929 0a20 2020 2066 6c61 745f  exes)).    flat_
+0002be40: 696e 6465 7865 7320 3d20 5b0a 2020 2020  indexes = [.    
+0002be50: 2020 2020 6c6f 6f6b 7570 5b69 5d2e 7261      lookup[i].ra
+0002be60: 7665 6c28 292e 746f 6c69 7374 2829 2069  vel().tolist() i
+0002be70: 6620 6920 696e 206c 6f6f 6b75 7020 656c  f i in lookup el
+0002be80: 7365 204e 6f6e 6520 666f 7220 6920 696e  se None for i in
+0002be90: 2072 616e 6765 2878 2e6e 6469 6d29 0a20   range(x.ndim). 
+0002bea0: 2020 205d 0a20 2020 2066 6c61 745f 696e     ].    flat_in
+0002beb0: 6465 7865 732e 6578 7465 6e64 285b 4e6f  dexes.extend([No
+0002bec0: 6e65 5d20 2a20 2878 2e6e 6469 6d20 2d20  ne] * (x.ndim - 
+0002bed0: 6c65 6e28 666c 6174 5f69 6e64 6578 6573  len(flat_indexes
+0002bee0: 2929 290a 0a20 2020 2066 6c61 745f 696e  )))..    flat_in
+0002bef0: 6465 7865 7320 3d20 5b0a 2020 2020 2020  dexes = [.      
+0002bf00: 2020 6c69 7374 2869 6e64 6578 2920 6966    list(index) if
+0002bf10: 2069 6e64 6578 2069 7320 6e6f 7420 4e6f   index is not No
+0002bf20: 6e65 2065 6c73 6520 696e 6465 7820 666f  ne else index fo
+0002bf30: 7220 696e 6465 7820 696e 2066 6c61 745f  r index in flat_
+0002bf40: 696e 6465 7865 730a 2020 2020 5d0a 2020  indexes.    ].  
+0002bf50: 2020 626f 756e 6473 203d 205b 6c69 7374    bounds = [list
+0002bf60: 2861 6363 756d 756c 6174 6528 6164 642c  (accumulate(add,
+0002bf70: 2028 302c 2920 2b20 6329 2920 666f 7220   (0,) + c)) for 
+0002bf80: 6320 696e 2078 2e63 6875 6e6b 735d 0a20  c in x.chunks]. 
+0002bf90: 2020 2062 6f75 6e64 7332 203d 205b 6220     bounds2 = [b 
+0002bfa0: 666f 7220 692c 2062 2069 6e20 7a69 7028  for i, b in zip(
+0002bfb0: 666c 6174 5f69 6e64 6578 6573 2c20 626f  flat_indexes, bo
+0002bfc0: 756e 6473 2920 6966 2069 2069 7320 6e6f  unds) if i is no
+0002bfd0: 7420 4e6f 6e65 5d0a 2020 2020 6178 6973  t None].    axis
+0002bfe0: 203d 205f 6765 745f 6178 6973 2866 6c61   = _get_axis(fla
+0002bff0: 745f 696e 6465 7865 7329 0a20 2020 2074  t_indexes).    t
+0002c000: 6f6b 656e 203d 2074 6f6b 656e 697a 6528  oken = tokenize(
+0002c010: 782c 2066 6c61 745f 696e 6465 7865 7329  x, flat_indexes)
+0002c020: 0a20 2020 206f 7574 5f6e 616d 6520 3d20  .    out_name = 
+0002c030: 2276 696e 6465 782d 6d65 7267 652d 2220  "vindex-merge-" 
+0002c040: 2b20 746f 6b65 6e0a 0a20 2020 2070 6f69  + token..    poi
+0002c050: 6e74 7320 3d20 6c69 7374 2829 0a20 2020  nts = list().   
+0002c060: 2066 6f72 2069 2c20 6964 7820 696e 2065   for i, idx in e
+0002c070: 6e75 6d65 7261 7465 287a 6970 282a 5b69  numerate(zip(*[i
+0002c080: 2066 6f72 2069 2069 6e20 666c 6174 5f69   for i in flat_i
+0002c090: 6e64 6578 6573 2069 6620 6920 6973 206e  ndexes if i is n
+0002c0a0: 6f74 204e 6f6e 655d 2929 3a0a 2020 2020  ot None])):.    
+0002c0b0: 2020 2020 626c 6f63 6b5f 6964 7820 3d20      block_idx = 
+0002c0c0: 5b62 6973 6563 7428 622c 2069 6e64 2920  [bisect(b, ind) 
+0002c0d0: 2d20 3120 666f 7220 622c 2069 6e64 2069  - 1 for b, ind i
+0002c0e0: 6e20 7a69 7028 626f 756e 6473 322c 2069  n zip(bounds2, i
+0002c0f0: 6478 295d 0a20 2020 2020 2020 2069 6e62  dx)].        inb
+0002c100: 6c6f 636b 5f69 6478 203d 205b 0a20 2020  lock_idx = [.   
+0002c110: 2020 2020 2020 2020 2069 6e64 202d 2062           ind - b
+0002c120: 6f75 6e64 7332 5b6b 5d5b 6a5d 2066 6f72  ounds2[k][j] for
+0002c130: 206b 2c20 2869 6e64 2c20 6a29 2069 6e20   k, (ind, j) in 
+0002c140: 656e 756d 6572 6174 6528 7a69 7028 6964  enumerate(zip(id
+0002c150: 782c 2062 6c6f 636b 5f69 6478 2929 0a20  x, block_idx)). 
+0002c160: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+0002c170: 2070 6f69 6e74 732e 6170 7065 6e64 2828   points.append((
+0002c180: 692c 2074 7570 6c65 2862 6c6f 636b 5f69  i, tuple(block_i
+0002c190: 6478 292c 2074 7570 6c65 2869 6e62 6c6f  dx), tuple(inblo
+0002c1a0: 636b 5f69 6478 2929 290a 0a20 2020 2063  ck_idx)))..    c
+0002c1b0: 6875 6e6b 7320 3d20 5b63 2066 6f72 2069  hunks = [c for i
+0002c1c0: 2c20 6320 696e 207a 6970 2866 6c61 745f  , c in zip(flat_
+0002c1d0: 696e 6465 7865 732c 2078 2e63 6875 6e6b  indexes, x.chunk
+0002c1e0: 7329 2069 6620 6920 6973 204e 6f6e 655d  s) if i is None]
+0002c1f0: 0a20 2020 2063 6875 6e6b 732e 696e 7365  .    chunks.inse
+0002c200: 7274 2830 2c20 286c 656e 2870 6f69 6e74  rt(0, (len(point
+0002c210: 7329 2c29 2069 6620 706f 696e 7473 2065  s),) if points e
+0002c220: 6c73 6520 2830 2c29 290a 2020 2020 6368  lse (0,)).    ch
+0002c230: 756e 6b73 203d 2074 7570 6c65 2863 6875  unks = tuple(chu
+0002c240: 6e6b 7329 0a0a 2020 2020 6966 2070 6f69  nks)..    if poi
+0002c250: 6e74 733a 0a20 2020 2020 2020 2070 6572  nts:.        per
+0002c260: 5f62 6c6f 636b 203d 2067 726f 7570 6279  _block = groupby
+0002c270: 2831 2c20 706f 696e 7473 290a 2020 2020  (1, points).    
+0002c280: 2020 2020 7065 725f 626c 6f63 6b20 3d20      per_block = 
+0002c290: 7b6b 3a20 7620 666f 7220 6b2c 2076 2069  {k: v for k, v i
+0002c2a0: 6e20 7065 725f 626c 6f63 6b2e 6974 656d  n per_block.item
+0002c2b0: 7328 2920 6966 2076 7d0a 0a20 2020 2020  s() if v}..     
+0002c2c0: 2020 206f 7468 6572 5f62 6c6f 636b 7320     other_blocks 
+0002c2d0: 3d20 6c69 7374 280a 2020 2020 2020 2020  = list(.        
+0002c2e0: 2020 2020 7072 6f64 7563 7428 0a20 2020      product(.   
+0002c2f0: 2020 2020 2020 2020 2020 2020 202a 5b0a               *[.
+0002c300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c310: 2020 2020 6c69 7374 2872 616e 6765 286c      list(range(l
+0002c320: 656e 2863 2929 2920 6966 2069 2069 7320  en(c))) if i is 
+0002c330: 4e6f 6e65 2065 6c73 6520 5b4e 6f6e 655d  None else [None]
+0002c340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c350: 2020 2020 2066 6f72 2069 2c20 6320 696e       for i, c in
+0002c360: 207a 6970 2866 6c61 745f 696e 6465 7865   zip(flat_indexe
+0002c370: 732c 2078 2e63 6875 6e6b 7329 0a20 2020  s, x.chunks).   
+0002c380: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0002c390: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0002c3a0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0002c3b0: 6675 6c6c 5f73 6c69 6365 7320 3d20 5b73  full_slices = [s
+0002c3c0: 6c69 6365 284e 6f6e 652c 204e 6f6e 6529  lice(None, None)
+0002c3d0: 2069 6620 6920 6973 204e 6f6e 6520 656c   if i is None el
+0002c3e0: 7365 204e 6f6e 6520 666f 7220 6920 696e  se None for i in
+0002c3f0: 2066 6c61 745f 696e 6465 7865 735d 0a0a   flat_indexes]..
+0002c400: 2020 2020 2020 2020 6e61 6d65 203d 2022          name = "
+0002c410: 7669 6e64 6578 2d73 6c69 6365 2d22 202b  vindex-slice-" +
+0002c420: 2074 6f6b 656e 0a20 2020 2020 2020 2076   token.        v
+0002c430: 696e 6465 785f 6d65 7267 655f 6e61 6d65  index_merge_name
+0002c440: 203d 2022 7669 6e64 6578 2d6d 6572 6765   = "vindex-merge
+0002c450: 2d22 202b 2074 6f6b 656e 0a20 2020 2020  -" + token.     
+0002c460: 2020 2064 736b 203d 207b 7d0a 2020 2020     dsk = {}.    
+0002c470: 2020 2020 666f 7220 6f6b 6579 2069 6e20      for okey in 
+0002c480: 6f74 6865 725f 626c 6f63 6b73 3a0a 2020  other_blocks:.  
+0002c490: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
+0002c4a0: 206b 6579 2069 6e20 656e 756d 6572 6174   key in enumerat
+0002c4b0: 6528 7065 725f 626c 6f63 6b29 3a0a 2020  e(per_block):.  
+0002c4c0: 2020 2020 2020 2020 2020 2020 2020 6473                ds
+0002c4d0: 6b5b 6b65 796e 616d 6528 6e61 6d65 2c20  k[keyname(name, 
+0002c4e0: 692c 206f 6b65 7929 5d20 3d20 280a 2020  i, okey)] = (.  
+0002c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c500: 2020 5f76 696e 6465 785f 7472 616e 7370    _vindex_transp
+0002c510: 6f73 652c 0a20 2020 2020 2020 2020 2020  ose,.           
+0002c520: 2020 2020 2020 2020 2028 0a20 2020 2020           (.     
+0002c530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c540: 2020 205f 7669 6e64 6578 5f73 6c69 6365     _vindex_slice
+0002c550: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002c560: 2020 2020 2020 2020 2020 2878 2e6e 616d            (x.nam
+0002c570: 652c 2920 2b20 696e 7465 726c 6561 7665  e,) + interleave
+0002c580: 5f6e 6f6e 6528 6f6b 6579 2c20 6b65 7929  _none(okey, key)
+0002c590: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002c5a0: 2020 2020 2020 2020 2020 696e 7465 726c            interl
+0002c5b0: 6561 7665 5f6e 6f6e 6528 0a20 2020 2020  eave_none(.     
 0002c5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c5d0: 6675 6c6c 5f73 6c69 6365 732c 206c 6973  full_slices, lis
-0002c5e0: 7428 7a69 7028 2a70 6c75 636b 2832 2c20  t(zip(*pluck(2, 
-0002c5f0: 7065 725f 626c 6f63 6b5b 6b65 795d 2929  per_block[key]))
-0002c600: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002c610: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-0002c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c630: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-0002c640: 2020 2020 2020 2020 6178 6973 2c0a 2020          axis,.  
-0002c650: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0002c660: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
-0002c670: 6b65 796e 616d 6528 7669 6e64 6578 5f6d  keyname(vindex_m
-0002c680: 6572 6765 5f6e 616d 652c 2030 2c20 6f6b  erge_name, 0, ok
-0002c690: 6579 295d 203d 2028 0a20 2020 2020 2020  ey)] = (.       
-0002c6a0: 2020 2020 2020 2020 205f 7669 6e64 6578           _vindex
-0002c6b0: 5f6d 6572 6765 2c0a 2020 2020 2020 2020  _merge,.        
-0002c6c0: 2020 2020 2020 2020 5b6c 6973 7428 706c          [list(pl
-0002c6d0: 7563 6b28 302c 2070 6572 5f62 6c6f 636b  uck(0, per_block
-0002c6e0: 5b6b 6579 5d29 2920 666f 7220 6b65 7920  [key])) for key 
-0002c6f0: 696e 2070 6572 5f62 6c6f 636b 5d2c 0a20  in per_block],. 
-0002c700: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0002c710: 6b65 796e 616d 6528 6e61 6d65 2c20 692c  keyname(name, i,
-0002c720: 206f 6b65 7929 2066 6f72 2069 2069 6e20   okey) for i in 
-0002c730: 7261 6e67 6528 6c65 6e28 7065 725f 626c  range(len(per_bl
-0002c740: 6f63 6b29 295d 2c0a 2020 2020 2020 2020  ock))],.        
-0002c750: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
-0002c760: 6573 756c 745f 3164 203d 2041 7272 6179  esult_1d = Array
-0002c770: 280a 2020 2020 2020 2020 2020 2020 4869  (.            Hi
-0002c780: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-0002c790: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6f75  m_collections(ou
-0002c7a0: 745f 6e61 6d65 2c20 6473 6b2c 2064 6570  t_name, dsk, dep
-0002c7b0: 656e 6465 6e63 6965 733d 5b78 5d29 2c0a  endencies=[x]),.
-0002c7c0: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
-0002c7d0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-0002c7e0: 2020 6368 756e 6b73 2c0a 2020 2020 2020    chunks,.      
-0002c7f0: 2020 2020 2020 782e 6474 7970 652c 0a20        x.dtype,. 
-0002c800: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
-0002c810: 782e 5f6d 6574 612c 0a20 2020 2020 2020  x._meta,.       
-0002c820: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-0002c830: 6e20 7265 7375 6c74 5f31 642e 7265 7368  n result_1d.resh
-0002c840: 6170 6528 6272 6f61 6463 6173 745f 7368  ape(broadcast_sh
-0002c850: 6170 6520 2b20 7265 7375 6c74 5f31 642e  ape + result_1d.
-0002c860: 7368 6170 655b 313a 5d29 0a0a 2020 2020  shape[1:])..    
-0002c870: 2320 6f75 7470 7574 2068 6173 2061 207a  # output has a z
-0002c880: 6572 6f20 6469 6d65 6e73 696f 6e2c 206a  ero dimension, j
-0002c890: 7573 7420 6372 6561 7465 2061 206e 6577  ust create a new
-0002c8a0: 207a 6572 6f2d 7368 6170 6520 6172 7261   zero-shape arra
-0002c8b0: 7920 7769 7468 2074 6865 0a20 2020 2023  y with the.    #
-0002c8c0: 2073 616d 6520 6474 7970 650a 2020 2020   same dtype.    
-0002c8d0: 6672 6f6d 2064 6173 6b2e 6172 7261 792e  from dask.array.
-0002c8e0: 7772 6170 2069 6d70 6f72 7420 656d 7074  wrap import empt
-0002c8f0: 790a 0a20 2020 2072 6573 756c 745f 3164  y..    result_1d
-0002c900: 203d 2065 6d70 7479 280a 2020 2020 2020   = empty(.      
-0002c910: 2020 7475 706c 6528 6d61 7028 7375 6d2c    tuple(map(sum,
-0002c920: 2063 6875 6e6b 7329 292c 2063 6875 6e6b   chunks)), chunk
-0002c930: 733d 6368 756e 6b73 2c20 6474 7970 653d  s=chunks, dtype=
-0002c940: 782e 6474 7970 652c 206e 616d 653d 6f75  x.dtype, name=ou
-0002c950: 745f 6e61 6d65 0a20 2020 2029 0a20 2020  t_name.    ).   
-0002c960: 2072 6574 7572 6e20 7265 7375 6c74 5f31   return result_1
-0002c970: 642e 7265 7368 6170 6528 6272 6f61 6463  d.reshape(broadc
-0002c980: 6173 745f 7368 6170 6520 2b20 7265 7375  ast_shape + resu
-0002c990: 6c74 5f31 642e 7368 6170 655b 313a 5d29  lt_1d.shape[1:])
-0002c9a0: 0a0a 0a64 6566 205f 6765 745f 6178 6973  ...def _get_axis
-0002c9b0: 2869 6e64 6578 6573 293a 0a20 2020 2022  (indexes):.    "
-0002c9c0: 2222 4765 7420 6178 6973 2061 6c6f 6e67  ""Get axis along
-0002c9d0: 2077 6869 6368 2070 6f69 6e74 2d77 6973   which point-wis
-0002c9e0: 6520 736c 6963 696e 6720 7265 7375 6c74  e slicing result
-0002c9f0: 7320 6c69 650a 0a20 2020 2054 6869 7320  s lie..    This 
-0002ca00: 6973 206d 6f73 746c 7920 6120 6861 636b  is mostly a hack
-0002ca10: 2062 6563 6175 7365 2049 2063 616e 2774   because I can't
-0002ca20: 2066 6967 7572 6520 6f75 7420 4e75 6d50   figure out NumP
-0002ca30: 7927 7320 7275 6c65 206f 6e20 7468 6973  y's rule on this
-0002ca40: 2061 6e64 0a20 2020 2063 616e 2774 2062   and.    can't b
-0002ca50: 6520 626f 7468 6572 6564 2074 6f20 676f  e bothered to go
-0002ca60: 2072 6561 6469 6e67 2e0a 0a20 2020 203e   reading...    >
-0002ca70: 3e3e 205f 6765 745f 6178 6973 285b 5b31  >> _get_axis([[1
-0002ca80: 2c20 325d 2c20 4e6f 6e65 2c20 5b31 2c20  , 2], None, [1, 
-0002ca90: 325d 2c20 4e6f 6e65 5d29 0a20 2020 2030  2], None]).    0
-0002caa0: 0a20 2020 203e 3e3e 205f 6765 745f 6178  .    >>> _get_ax
-0002cab0: 6973 285b 4e6f 6e65 2c20 5b31 2c20 325d  is([None, [1, 2]
-0002cac0: 2c20 5b31 2c20 325d 2c20 4e6f 6e65 5d29  , [1, 2], None])
-0002cad0: 0a20 2020 2031 0a20 2020 203e 3e3e 205f  .    1.    >>> _
-0002cae0: 6765 745f 6178 6973 285b 4e6f 6e65 2c20  get_axis([None, 
-0002caf0: 4e6f 6e65 2c20 5b31 2c20 325d 2c20 5b31  None, [1, 2], [1
-0002cb00: 2c20 325d 5d29 0a20 2020 2032 0a20 2020  , 2]]).    2.   
-0002cb10: 2022 2222 0a20 2020 206e 6469 6d20 3d20   """.    ndim = 
-0002cb20: 6c65 6e28 696e 6465 7865 7329 0a20 2020  len(indexes).   
-0002cb30: 2069 6e64 6578 6573 203d 205b 736c 6963   indexes = [slic
-0002cb40: 6528 4e6f 6e65 2c20 4e6f 6e65 2920 6966  e(None, None) if
-0002cb50: 2069 2069 7320 4e6f 6e65 2065 6c73 6520   i is None else 
-0002cb60: 5b30 5d20 666f 7220 6920 696e 2069 6e64  [0] for i in ind
-0002cb70: 6578 6573 5d0a 2020 2020 7820 3d20 6e70  exes].    x = np
-0002cb80: 2e65 6d70 7479 2828 322c 2920 2a20 6e64  .empty((2,) * nd
-0002cb90: 696d 290a 2020 2020 7832 203d 2078 5b74  im).    x2 = x[t
-0002cba0: 7570 6c65 2869 6e64 6578 6573 295d 0a20  uple(indexes)]. 
-0002cbb0: 2020 2072 6574 7572 6e20 7832 2e73 6861     return x2.sha
-0002cbc0: 7065 2e69 6e64 6578 2831 290a 0a0a 6465  pe.index(1)...de
-0002cbd0: 6620 5f76 696e 6465 785f 736c 6963 6528  f _vindex_slice(
-0002cbe0: 626c 6f63 6b2c 2070 6f69 6e74 7329 3a0a  block, points):.
-0002cbf0: 2020 2020 2222 2250 756c 6c20 6f75 7420      """Pull out 
-0002cc00: 706f 696e 742d 7769 7365 2073 6c69 6365  point-wise slice
-0002cc10: 7320 6672 6f6d 2062 6c6f 636b 2222 220a  s from block""".
-0002cc20: 2020 2020 706f 696e 7473 203d 205b 7020      points = [p 
-0002cc30: 6966 2069 7369 6e73 7461 6e63 6528 702c  if isinstance(p,
-0002cc40: 2073 6c69 6365 2920 656c 7365 206c 6973   slice) else lis
-0002cc50: 7428 7029 2066 6f72 2070 2069 6e20 706f  t(p) for p in po
-0002cc60: 696e 7473 5d0a 2020 2020 7265 7475 726e  ints].    return
-0002cc70: 2062 6c6f 636b 5b74 7570 6c65 2870 6f69   block[tuple(poi
-0002cc80: 6e74 7329 5d0a 0a0a 6465 6620 5f76 696e  nts)]...def _vin
-0002cc90: 6465 785f 7472 616e 7370 6f73 6528 626c  dex_transpose(bl
-0002cca0: 6f63 6b2c 2061 7869 7329 3a0a 2020 2020  ock, axis):.    
-0002ccb0: 2222 2252 6f74 6174 6520 626c 6f63 6b20  """Rotate block 
-0002ccc0: 736f 2074 6861 7420 706f 696e 7473 2061  so that points a
-0002ccd0: 7265 206f 6e20 7468 6520 6669 7273 7420  re on the first 
-0002cce0: 6469 6d65 6e73 696f 6e22 2222 0a20 2020  dimension""".   
-0002ccf0: 2061 7865 7320 3d20 5b61 7869 735d 202b   axes = [axis] +
-0002cd00: 206c 6973 7428 7261 6e67 6528 6178 6973   list(range(axis
-0002cd10: 2929 202b 206c 6973 7428 7261 6e67 6528  )) + list(range(
-0002cd20: 6178 6973 202b 2031 2c20 626c 6f63 6b2e  axis + 1, block.
-0002cd30: 6e64 696d 2929 0a20 2020 2072 6574 7572  ndim)).    retur
-0002cd40: 6e20 626c 6f63 6b2e 7472 616e 7370 6f73  n block.transpos
-0002cd50: 6528 6178 6573 290a 0a0a 6465 6620 5f76  e(axes)...def _v
-0002cd60: 696e 6465 785f 6d65 7267 6528 6c6f 6361  index_merge(loca
-0002cd70: 7469 6f6e 732c 2076 616c 7565 7329 3a0a  tions, values):.
-0002cd80: 2020 2020 2222 220a 0a20 2020 203e 3e3e      """..    >>>
-0002cd90: 206c 6f63 6174 696f 6e73 203d 205b 305d   locations = [0]
-0002cda0: 2c20 5b32 2c20 315d 0a20 2020 203e 3e3e  , [2, 1].    >>>
-0002cdb0: 2076 616c 7565 7320 3d20 5b6e 702e 6172   values = [np.ar
-0002cdc0: 7261 7928 5b5b 312c 2032 2c20 335d 5d29  ray([[1, 2, 3]])
-0002cdd0: 2c0a 2020 2020 2e2e 2e20 2020 2020 2020  ,.    ...       
-0002cde0: 2020 2020 6e70 2e61 7272 6179 285b 5b31      np.array([[1
-0002cdf0: 302c 2032 302c 2033 305d 2c20 5b34 302c  0, 20, 30], [40,
-0002ce00: 2035 302c 2036 305d 5d29 5d0a 0a20 2020   50, 60]])]..   
-0002ce10: 203e 3e3e 205f 7669 6e64 6578 5f6d 6572   >>> _vindex_mer
-0002ce20: 6765 286c 6f63 6174 696f 6e73 2c20 7661  ge(locations, va
-0002ce30: 6c75 6573 290a 2020 2020 6172 7261 7928  lues).    array(
-0002ce40: 5b5b 2031 2c20 2032 2c20 2033 5d2c 0a20  [[ 1,  2,  3],. 
-0002ce50: 2020 2020 2020 2020 2020 5b34 302c 2035            [40, 5
-0002ce60: 302c 2036 305d 2c0a 2020 2020 2020 2020  0, 60],.        
-0002ce70: 2020 205b 3130 2c20 3230 2c20 3330 5d5d     [10, 20, 30]]
-0002ce80: 290a 2020 2020 2222 220a 2020 2020 6c6f  ).    """.    lo
-0002ce90: 6361 7469 6f6e 7320 3d20 6c69 7374 286d  cations = list(m
-0002cea0: 6170 286c 6973 742c 206c 6f63 6174 696f  ap(list, locatio
-0002ceb0: 6e73 2929 0a20 2020 2076 616c 7565 7320  ns)).    values 
-0002cec0: 3d20 6c69 7374 2876 616c 7565 7329 0a0a  = list(values)..
-0002ced0: 2020 2020 6e20 3d20 7375 6d28 6d61 7028      n = sum(map(
-0002cee0: 6c65 6e2c 206c 6f63 6174 696f 6e73 2929  len, locations))
-0002cef0: 0a0a 2020 2020 7368 6170 6520 3d20 6c69  ..    shape = li
-0002cf00: 7374 2876 616c 7565 735b 305d 2e73 6861  st(values[0].sha
-0002cf10: 7065 290a 2020 2020 7368 6170 655b 305d  pe).    shape[0]
-0002cf20: 203d 206e 0a20 2020 2073 6861 7065 203d   = n.    shape =
-0002cf30: 2074 7570 6c65 2873 6861 7065 290a 0a20   tuple(shape).. 
-0002cf40: 2020 2064 7479 7065 203d 2076 616c 7565     dtype = value
-0002cf50: 735b 305d 2e64 7479 7065 0a0a 2020 2020  s[0].dtype..    
-0002cf60: 7820 3d20 6e70 2e65 6d70 7479 5f6c 696b  x = np.empty_lik
-0002cf70: 6528 7661 6c75 6573 5b30 5d2c 2064 7479  e(values[0], dty
-0002cf80: 7065 3d64 7479 7065 2c20 7368 6170 653d  pe=dtype, shape=
-0002cf90: 7368 6170 6529 0a0a 2020 2020 696e 6420  shape)..    ind 
-0002cfa0: 3d20 5b73 6c69 6365 284e 6f6e 652c 204e  = [slice(None, N
-0002cfb0: 6f6e 6529 2066 6f72 2069 2069 6e20 7261  one) for i in ra
-0002cfc0: 6e67 6528 782e 6e64 696d 295d 0a20 2020  nge(x.ndim)].   
-0002cfd0: 2066 6f72 206c 6f63 2c20 7661 6c20 696e   for loc, val in
-0002cfe0: 207a 6970 286c 6f63 6174 696f 6e73 2c20   zip(locations, 
-0002cff0: 7661 6c75 6573 293a 0a20 2020 2020 2020  values):.       
-0002d000: 2069 6e64 5b30 5d20 3d20 6c6f 630a 2020   ind[0] = loc.  
-0002d010: 2020 2020 2020 785b 7475 706c 6528 696e        x[tuple(in
-0002d020: 6429 5d20 3d20 7661 6c0a 0a20 2020 2072  d)] = val..    r
-0002d030: 6574 7572 6e20 780a 0a0a 6465 6620 746f  eturn x...def to
-0002d040: 5f6e 7079 5f73 7461 636b 2864 6972 6e61  _npy_stack(dirna
-0002d050: 6d65 2c20 782c 2061 7869 733d 3029 3a0a  me, x, axis=0):.
-0002d060: 2020 2020 2222 2257 7269 7465 2064 6173      """Write das
-0002d070: 6b20 6172 7261 7920 746f 2061 2073 7461  k array to a sta
-0002d080: 636b 206f 6620 2e6e 7079 2066 696c 6573  ck of .npy files
-0002d090: 0a0a 2020 2020 5468 6973 2070 6172 7469  ..    This parti
-0002d0a0: 7469 6f6e 7320 7468 6520 6461 736b 2e61  tions the dask.a
-0002d0b0: 7272 6179 2061 6c6f 6e67 206f 6e65 2061  rray along one a
-0002d0c0: 7869 7320 616e 6420 7374 6f72 6573 2065  xis and stores e
-0002d0d0: 6163 6820 626c 6f63 6b20 616c 6f6e 670a  ach block along.
-0002d0e0: 2020 2020 7468 6174 2061 7869 7320 6173      that axis as
-0002d0f0: 2061 2073 696e 676c 6520 2e6e 7079 2066   a single .npy f
-0002d100: 696c 6520 696e 2074 6865 2073 7065 6369  ile in the speci
-0002d110: 6669 6564 2064 6972 6563 746f 7279 0a0a  fied directory..
-0002d120: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0002d130: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e   --------.    >>
-0002d140: 3e20 7820 3d20 6461 2e6f 6e65 7328 2835  > x = da.ones((5
-0002d150: 2c20 3130 2c20 3130 292c 2063 6875 6e6b  , 10, 10), chunk
-0002d160: 733d 2832 2c20 342c 2034 2929 2020 2320  s=(2, 4, 4))  # 
-0002d170: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0002d180: 2020 203e 3e3e 2064 612e 746f 5f6e 7079     >>> da.to_npy
-0002d190: 5f73 7461 636b 2827 6461 7461 2f27 2c20  _stack('data/', 
-0002d1a0: 782c 2061 7869 733d 3029 2020 2320 646f  x, axis=0)  # do
-0002d1b0: 6374 6573 743a 202b 534b 4950 0a0a 2020  ctest: +SKIP..  
-0002d1c0: 2020 5468 6520 6060 2e6e 7079 6060 2066    The ``.npy`` f
-0002d1d0: 696c 6573 2073 746f 7265 206e 756d 7079  iles store numpy
-0002d1e0: 2061 7272 6179 7320 666f 7220 6060 785b   arrays for ``x[
-0002d1f0: 303a 325d 2c20 785b 323a 345d 2c20 616e  0:2], x[2:4], an
-0002d200: 6420 785b 343a 355d 6060 0a20 2020 2072  d x[4:5]``.    r
-0002d210: 6573 7065 6374 6976 656c 792c 2061 7320  espectively, as 
-0002d220: 6973 2073 7065 6369 6669 6564 2062 7920  is specified by 
-0002d230: 7468 6520 6368 756e 6b20 7369 7a65 2061  the chunk size a
-0002d240: 6c6f 6e67 2074 6865 207a 6572 6f74 6820  long the zeroth 
-0002d250: 6178 6973 3a3a 0a0a 2020 2020 2020 2020  axis::..        
-0002d260: 2420 7472 6565 2064 6174 612f 0a20 2020  $ tree data/.   
-0002d270: 2020 2020 2064 6174 612f 0a20 2020 2020       data/.     
-0002d280: 2020 207c 2d2d 2030 2e6e 7079 0a20 2020     |-- 0.npy.   
-0002d290: 2020 2020 207c 2d2d 2031 2e6e 7079 0a20       |-- 1.npy. 
-0002d2a0: 2020 2020 2020 207c 2d2d 2032 2e6e 7079         |-- 2.npy
-0002d2b0: 0a20 2020 2020 2020 207c 2d2d 2069 6e66  .        |-- inf
-0002d2c0: 6f0a 0a20 2020 2054 6865 2060 6069 6e66  o..    The ``inf
-0002d2d0: 6f60 6020 6669 6c65 2073 746f 7265 7320  o`` file stores 
-0002d2e0: 7468 6520 6474 7970 652c 2063 6875 6e6b  the dtype, chunk
-0002d2f0: 732c 2061 6e64 2061 7869 7320 696e 666f  s, and axis info
-0002d300: 726d 6174 696f 6e20 6f66 2074 6865 2061  rmation of the a
-0002d310: 7272 6179 2e0a 2020 2020 596f 7520 6361  rray..    You ca
-0002d320: 6e20 6c6f 6164 2074 6865 7365 2073 7461  n load these sta
-0002d330: 636b 7320 7769 7468 2074 6865 203a 6675  cks with the :fu
-0002d340: 6e63 3a60 6461 736b 2e61 7272 6179 2e66  nc:`dask.array.f
-0002d350: 726f 6d5f 6e70 795f 7374 6163 6b60 2066  rom_npy_stack` f
-0002d360: 756e 6374 696f 6e2e 0a0a 2020 2020 3e3e  unction...    >>
-0002d370: 3e20 7920 3d20 6461 2e66 726f 6d5f 6e70  > y = da.from_np
-0002d380: 795f 7374 6163 6b28 2764 6174 612f 2729  y_stack('data/')
-0002d390: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0002d3a0: 4950 0a0a 2020 2020 5365 6520 416c 736f  IP..    See Also
-0002d3b0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-0002d3c0: 2020 6672 6f6d 5f6e 7079 5f73 7461 636b    from_npy_stack
-0002d3d0: 0a20 2020 2022 2222 0a0a 2020 2020 6368  .    """..    ch
-0002d3e0: 756e 6b73 203d 2074 7570 6c65 2828 6320  unks = tuple((c 
-0002d3f0: 6966 2069 203d 3d20 6178 6973 2065 6c73  if i == axis els
-0002d400: 6520 2873 756d 2863 292c 2929 2066 6f72  e (sum(c),)) for
-0002d410: 2069 2c20 6320 696e 2065 6e75 6d65 7261   i, c in enumera
-0002d420: 7465 2878 2e63 6875 6e6b 7329 290a 2020  te(x.chunks)).  
-0002d430: 2020 7878 203d 2078 2e72 6563 6875 6e6b    xx = x.rechunk
-0002d440: 2863 6875 6e6b 7329 0a0a 2020 2020 6966  (chunks)..    if
-0002d450: 206e 6f74 206f 732e 7061 7468 2e65 7869   not os.path.exi
-0002d460: 7374 7328 6469 726e 616d 6529 3a0a 2020  sts(dirname):.  
-0002d470: 2020 2020 2020 6f73 2e6d 6b64 6972 2864        os.mkdir(d
-0002d480: 6972 6e61 6d65 290a 0a20 2020 206d 6574  irname)..    met
-0002d490: 6120 3d20 7b22 6368 756e 6b73 223a 2063  a = {"chunks": c
-0002d4a0: 6875 6e6b 732c 2022 6474 7970 6522 3a20  hunks, "dtype": 
-0002d4b0: 782e 6474 7970 652c 2022 6178 6973 223a  x.dtype, "axis":
-0002d4c0: 2061 7869 737d 0a0a 2020 2020 7769 7468   axis}..    with
-0002d4d0: 206f 7065 6e28 6f73 2e70 6174 682e 6a6f   open(os.path.jo
-0002d4e0: 696e 2864 6972 6e61 6d65 2c20 2269 6e66  in(dirname, "inf
-0002d4f0: 6f22 292c 2022 7762 2229 2061 7320 663a  o"), "wb") as f:
-0002d500: 0a20 2020 2020 2020 2070 6963 6b6c 652e  .        pickle.
-0002d510: 6475 6d70 286d 6574 612c 2066 290a 0a20  dump(meta, f).. 
-0002d520: 2020 206e 616d 6520 3d20 2274 6f2d 6e70     name = "to-np
-0002d530: 792d 7374 6163 6b2d 2220 2b20 7374 7228  y-stack-" + str(
-0002d540: 7575 6964 2e75 7569 6431 2829 290a 2020  uuid.uuid1()).  
-0002d550: 2020 6473 6b20 3d20 7b0a 2020 2020 2020    dsk = {.      
-0002d560: 2020 286e 616d 652c 2069 293a 2028 6e70    (name, i): (np
-0002d570: 2e73 6176 652c 206f 732e 7061 7468 2e6a  .save, os.path.j
-0002d580: 6f69 6e28 6469 726e 616d 652c 2022 2564  oin(dirname, "%d
-0002d590: 2e6e 7079 2220 2520 6929 2c20 6b65 7929  .npy" % i), key)
-0002d5a0: 0a20 2020 2020 2020 2066 6f72 2069 2c20  .        for i, 
-0002d5b0: 6b65 7920 696e 2065 6e75 6d65 7261 7465  key in enumerate
-0002d5c0: 2863 6f72 652e 666c 6174 7465 6e28 7878  (core.flatten(xx
-0002d5d0: 2e5f 5f64 6173 6b5f 6b65 7973 5f5f 2829  .__dask_keys__()
-0002d5e0: 2929 0a20 2020 207d 0a0a 2020 2020 6772  )).    }..    gr
-0002d5f0: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-0002d600: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-0002d610: 7469 6f6e 7328 6e61 6d65 2c20 6473 6b2c  tions(name, dsk,
-0002d620: 2064 6570 656e 6465 6e63 6965 733d 5b78   dependencies=[x
-0002d630: 785d 290a 2020 2020 636f 6d70 7574 655f  x]).    compute_
-0002d640: 6173 5f69 665f 636f 6c6c 6563 7469 6f6e  as_if_collection
-0002d650: 2841 7272 6179 2c20 6772 6170 682c 206c  (Array, graph, l
-0002d660: 6973 7428 6473 6b29 290a 0a0a 6465 6620  ist(dsk))...def 
-0002d670: 6672 6f6d 5f6e 7079 5f73 7461 636b 2864  from_npy_stack(d
-0002d680: 6972 6e61 6d65 2c20 6d6d 6170 5f6d 6f64  irname, mmap_mod
-0002d690: 653d 2272 2229 3a0a 2020 2020 2222 224c  e="r"):.    """L
-0002d6a0: 6f61 6420 6461 736b 2061 7272 6179 2066  oad dask array f
-0002d6b0: 726f 6d20 7374 6163 6b20 6f66 206e 7079  rom stack of npy
-0002d6c0: 2066 696c 6573 0a0a 2020 2020 5061 7261   files..    Para
-0002d6d0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-0002d6e0: 2d2d 2d2d 2d0a 2020 2020 6469 726e 616d  -----.    dirnam
-0002d6f0: 653a 2073 7472 696e 670a 2020 2020 2020  e: string.      
-0002d700: 2020 4469 7265 6374 6f72 7920 6f66 202e    Directory of .
-0002d710: 6e70 7920 6669 6c65 730a 2020 2020 6d6d  npy files.    mm
-0002d720: 6170 5f6d 6f64 653a 2028 4e6f 6e65 206f  ap_mode: (None o
-0002d730: 7220 2772 2729 0a20 2020 2020 2020 2052  r 'r').        R
-0002d740: 6561 6420 6461 7461 2069 6e20 6d65 6d6f  ead data in memo
-0002d750: 7279 206d 6170 206d 6f64 650a 0a20 2020  ry map mode..   
-0002d760: 2053 6565 2041 6c73 6f0a 2020 2020 2d2d   See Also.    --
-0002d770: 2d2d 2d2d 2d2d 0a20 2020 2074 6f5f 6e70  ------.    to_np
-0002d780: 795f 7374 6163 6b0a 2020 2020 2222 220a  y_stack.    """.
-0002d790: 2020 2020 7769 7468 206f 7065 6e28 6f73      with open(os
-0002d7a0: 2e70 6174 682e 6a6f 696e 2864 6972 6e61  .path.join(dirna
-0002d7b0: 6d65 2c20 2269 6e66 6f22 292c 2022 7262  me, "info"), "rb
-0002d7c0: 2229 2061 7320 663a 0a20 2020 2020 2020  ") as f:.       
-0002d7d0: 2069 6e66 6f20 3d20 7069 636b 6c65 2e6c   info = pickle.l
-0002d7e0: 6f61 6428 6629 0a0a 2020 2020 6474 7970  oad(f)..    dtyp
-0002d7f0: 6520 3d20 696e 666f 5b22 6474 7970 6522  e = info["dtype"
-0002d800: 5d0a 2020 2020 6368 756e 6b73 203d 2069  ].    chunks = i
-0002d810: 6e66 6f5b 2263 6875 6e6b 7322 5d0a 2020  nfo["chunks"].  
-0002d820: 2020 6178 6973 203d 2069 6e66 6f5b 2261    axis = info["a
-0002d830: 7869 7322 5d0a 0a20 2020 206e 616d 6520  xis"]..    name 
-0002d840: 3d20 2266 726f 6d2d 6e70 792d 7374 6163  = "from-npy-stac
-0002d850: 6b2d 2573 2220 2520 6469 726e 616d 650a  k-%s" % dirname.
-0002d860: 2020 2020 6b65 7973 203d 206c 6973 7428      keys = list(
-0002d870: 7072 6f64 7563 7428 5b6e 616d 655d 2c20  product([name], 
-0002d880: 2a5b 7261 6e67 6528 6c65 6e28 6329 2920  *[range(len(c)) 
-0002d890: 666f 7220 6320 696e 2063 6875 6e6b 735d  for c in chunks]
-0002d8a0: 2929 0a20 2020 2076 616c 7565 7320 3d20  )).    values = 
-0002d8b0: 5b0a 2020 2020 2020 2020 286e 702e 6c6f  [.        (np.lo
-0002d8c0: 6164 2c20 6f73 2e70 6174 682e 6a6f 696e  ad, os.path.join
-0002d8d0: 2864 6972 6e61 6d65 2c20 2225 642e 6e70  (dirname, "%d.np
-0002d8e0: 7922 2025 2069 292c 206d 6d61 705f 6d6f  y" % i), mmap_mo
-0002d8f0: 6465 290a 2020 2020 2020 2020 666f 7220  de).        for 
-0002d900: 6920 696e 2072 616e 6765 286c 656e 2863  i in range(len(c
-0002d910: 6875 6e6b 735b 6178 6973 5d29 290a 2020  hunks[axis])).  
-0002d920: 2020 5d0a 2020 2020 6473 6b20 3d20 6469    ].    dsk = di
-0002d930: 6374 287a 6970 286b 6579 732c 2076 616c  ct(zip(keys, val
-0002d940: 7565 7329 290a 0a20 2020 2072 6574 7572  ues))..    retur
-0002d950: 6e20 4172 7261 7928 6473 6b2c 206e 616d  n Array(dsk, nam
-0002d960: 652c 2063 6875 6e6b 732c 2064 7479 7065  e, chunks, dtype
-0002d970: 290a 0a0a 6465 6620 6e65 775f 6461 5f6f  )...def new_da_o
-0002d980: 626a 6563 7428 6473 6b2c 206e 616d 652c  bject(dsk, name,
-0002d990: 2063 6875 6e6b 732c 206d 6574 613d 4e6f   chunks, meta=No
-0002d9a0: 6e65 2c20 6474 7970 653d 4e6f 6e65 293a  ne, dtype=None):
-0002d9b0: 0a20 2020 2022 2222 4765 6e65 7269 6320  .    """Generic 
-0002d9c0: 636f 6e73 7472 7563 746f 7220 666f 7220  constructor for 
-0002d9d0: 6461 736b 2e61 7272 6179 206f 7220 6461  dask.array or da
-0002d9e0: 736b 2e64 6174 6166 7261 6d65 206f 626a  sk.dataframe obj
-0002d9f0: 6563 7473 2e0a 0a20 2020 2044 6563 6964  ects...    Decid
-0002da00: 6573 2074 6865 2061 7070 726f 7072 6961  es the appropria
-0002da10: 7465 206f 7574 7075 7420 636c 6173 7320  te output class 
-0002da20: 6261 7365 6420 6f6e 2074 6865 2074 7970  based on the typ
-0002da30: 6520 6f66 2060 6d65 7461 6020 7072 6f76  e of `meta` prov
-0002da40: 6964 6564 2e0a 2020 2020 2222 220a 2020  ided..    """.  
-0002da50: 2020 6966 2069 735f 6461 7461 6672 616d    if is_datafram
-0002da60: 655f 6c69 6b65 286d 6574 6129 206f 7220  e_like(meta) or 
-0002da70: 6973 5f73 6572 6965 735f 6c69 6b65 286d  is_series_like(m
-0002da80: 6574 6129 206f 7220 6973 5f69 6e64 6578  eta) or is_index
-0002da90: 5f6c 696b 6528 6d65 7461 293a 0a20 2020  _like(meta):.   
-0002daa0: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-0002dab0: 6174 6166 7261 6d65 2e63 6f72 6520 696d  ataframe.core im
-0002dac0: 706f 7274 206e 6577 5f64 645f 6f62 6a65  port new_dd_obje
-0002dad0: 6374 0a0a 2020 2020 2020 2020 6173 7365  ct..        asse
-0002dae0: 7274 2061 6c6c 286c 656e 2863 2920 3d3d  rt all(len(c) ==
-0002daf0: 2031 2066 6f72 2063 2069 6e20 6368 756e   1 for c in chun
-0002db00: 6b73 5b31 3a5d 290a 2020 2020 2020 2020  ks[1:]).        
-0002db10: 6469 7669 7369 6f6e 7320 3d20 5b4e 6f6e  divisions = [Non
-0002db20: 655d 202a 2028 6c65 6e28 6368 756e 6b73  e] * (len(chunks
-0002db30: 5b30 5d29 202b 2031 290a 2020 2020 2020  [0]) + 1).      
-0002db40: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
-0002db50: 6f62 6a65 6374 2864 736b 2c20 6e61 6d65  object(dsk, name
-0002db60: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
-0002db70: 7329 0a20 2020 2065 6c73 653a 0a20 2020  s).    else:.   
-0002db80: 2020 2020 2072 6574 7572 6e20 4172 7261       return Arra
-0002db90: 7928 6473 6b2c 206e 616d 653d 6e61 6d65  y(dsk, name=name
-0002dba0: 2c20 6368 756e 6b73 3d63 6875 6e6b 732c  , chunks=chunks,
-0002dbb0: 206d 6574 613d 6d65 7461 2c20 6474 7970   meta=meta, dtyp
-0002dbc0: 653d 6474 7970 6529 0a0a 0a63 6c61 7373  e=dtype)...class
-0002dbd0: 2042 6c6f 636b 5669 6577 3a0a 2020 2020   BlockView:.    
-0002dbe0: 2222 2241 6e20 6172 7261 792d 6c69 6b65  """An array-like
-0002dbf0: 2069 6e74 6572 6661 6365 2074 6f20 7468   interface to th
-0002dc00: 6520 626c 6f63 6b73 206f 6620 616e 2061  e blocks of an a
-0002dc10: 7272 6179 2e0a 0a20 2020 2060 6042 6c6f  rray...    ``Blo
-0002dc20: 636b 5669 6577 6060 2070 726f 7669 6465  ckView`` provide
-0002dc30: 7320 616e 2061 7272 6179 2d6c 696b 6520  s an array-like 
-0002dc40: 696e 7465 7266 6163 650a 2020 2020 746f  interface.    to
-0002dc50: 2074 6865 2062 6c6f 636b 7320 6f66 2061   the blocks of a
-0002dc60: 2064 6173 6b20 6172 7261 792e 2020 4e75   dask array.  Nu
-0002dc70: 6d70 792d 7374 796c 6520 696e 6465 7869  mpy-style indexi
-0002dc80: 6e67 206f 6620 610a 2020 2020 2060 6042  ng of a.     ``B
-0002dc90: 6c6f 636b 5669 6577 6060 2072 6574 7572  lockView`` retur
-0002dca0: 6e73 2061 2073 656c 6563 7469 6f6e 206f  ns a selection o
-0002dcb0: 6620 626c 6f63 6b73 2061 7320 6120 6e65  f blocks as a ne
-0002dcc0: 7720 6461 736b 2061 7272 6179 2e0a 0a20  w dask array... 
-0002dcd0: 2020 2059 6f75 2063 616e 2069 6e64 6578     You can index
-0002dce0: 2060 6042 6c6f 636b 5669 6577 6060 206c   ``BlockView`` l
-0002dcf0: 696b 6520 6120 6e75 6d70 7920 6172 7261  ike a numpy arra
-0002dd00: 7920 6f66 2073 6861 7065 0a20 2020 2065  y of shape.    e
-0002dd10: 7175 616c 2074 6f20 7468 6520 6e75 6d62  qual to the numb
-0002dd20: 6572 206f 6620 626c 6f63 6b73 2069 6e20  er of blocks in 
-0002dd30: 6561 6368 2064 696d 656e 7369 6f6e 2c20  each dimension, 
-0002dd40: 2861 7661 696c 6162 6c65 2061 730a 2020  (available as.  
-0002dd50: 2020 6172 7261 792e 626c 6f63 6b73 2e73    array.blocks.s
-0002dd60: 697a 6529 2e20 2054 6865 2064 696d 656e  ize).  The dimen
-0002dd70: 7369 6f6e 616c 6974 7920 6f66 2074 6865  sionality of the
-0002dd80: 206f 7574 7075 7420 6172 7261 7920 6d61   output array ma
-0002dd90: 7463 6865 730a 2020 2020 7468 6520 6469  tches.    the di
-0002dda0: 6d65 6e73 696f 6e20 6f66 2074 6869 7320  mension of this 
-0002ddb0: 6172 7261 792c 2065 7665 6e20 6966 2069  array, even if i
-0002ddc0: 6e74 6567 6572 2069 6e64 6963 6573 2061  nteger indices a
-0002ddd0: 7265 2070 6173 7365 642e 0a20 2020 2053  re passed..    S
-0002dde0: 6c69 6369 6e67 2077 6974 6820 6060 6e70  licing with ``np
-0002ddf0: 2e6e 6577 6178 6973 6060 206f 7220 6d75  .newaxis`` or mu
-0002de00: 6c74 6970 6c65 206c 6973 7473 2069 7320  ltiple lists is 
-0002de10: 6e6f 7420 7375 7070 6f72 7465 642e 0a0a  not supported...
-0002de20: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0002de30: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e   --------.    >>
-0002de40: 3e20 696d 706f 7274 2064 6173 6b2e 6172  > import dask.ar
-0002de50: 7261 7920 6173 2064 610a 2020 2020 3e3e  ray as da.    >>
-0002de60: 3e20 6672 6f6d 2064 6173 6b2e 6172 7261  > from dask.arra
-0002de70: 792e 636f 7265 2069 6d70 6f72 7420 426c  y.core import Bl
-0002de80: 6f63 6b56 6965 770a 2020 2020 3e3e 3e20  ockView.    >>> 
-0002de90: 7820 3d20 6461 2e61 7261 6e67 6528 382c  x = da.arange(8,
-0002dea0: 2063 6875 6e6b 733d 3229 0a20 2020 203e   chunks=2).    >
-0002deb0: 3e3e 2062 7620 3d20 426c 6f63 6b56 6965  >> bv = BlockVie
-0002dec0: 7728 7829 0a20 2020 203e 3e3e 2062 762e  w(x).    >>> bv.
-0002ded0: 7368 6170 6520 2320 616c 6961 7365 7320  shape # aliases 
-0002dee0: 782e 6e75 6d62 6c6f 636b 730a 2020 2020  x.numblocks.    
-0002def0: 2834 2c29 0a20 2020 203e 3e3e 2062 762e  (4,).    >>> bv.
-0002df00: 7369 7a65 0a20 2020 2034 0a20 2020 203e  size.    4.    >
-0002df10: 3e3e 2062 765b 305d 2e63 6f6d 7075 7465  >> bv[0].compute
-0002df20: 2829 0a20 2020 2061 7272 6179 285b 302c  ().    array([0,
-0002df30: 2031 5d29 0a20 2020 203e 3e3e 2062 765b   1]).    >>> bv[
-0002df40: 3a33 5d2e 636f 6d70 7574 6528 290a 2020  :3].compute().  
-0002df50: 2020 6172 7261 7928 5b30 2c20 312c 2032    array([0, 1, 2
-0002df60: 2c20 332c 2034 2c20 355d 290a 2020 2020  , 3, 4, 5]).    
-0002df70: 3e3e 3e20 6276 5b3a 3a32 5d2e 636f 6d70  >>> bv[::2].comp
-0002df80: 7574 6528 290a 2020 2020 6172 7261 7928  ute().    array(
-0002df90: 5b30 2c20 312c 2034 2c20 355d 290a 2020  [0, 1, 4, 5]).  
-0002dfa0: 2020 3e3e 3e20 6276 5b5b 2d31 2c20 305d    >>> bv[[-1, 0]
-0002dfb0: 5d2e 636f 6d70 7574 6528 290a 2020 2020  ].compute().    
-0002dfc0: 6172 7261 7928 5b36 2c20 372c 2030 2c20  array([6, 7, 0, 
-0002dfd0: 315d 290a 2020 2020 3e3e 3e20 6276 2e72  1]).    >>> bv.r
-0002dfe0: 6176 656c 2829 2020 2320 646f 6374 6573  avel()  # doctes
-0002dff0: 743a 202b 4e4f 524d 414c 495a 455f 5748  t: +NORMALIZE_WH
-0002e000: 4954 4553 5041 4345 0a20 2020 205b 6461  ITESPACE.    [da
-0002e010: 736b 2e61 7272 6179 3c62 6c6f 636b 732c  sk.array<blocks,
-0002e020: 2073 6861 7065 3d28 322c 292c 2064 7479   shape=(2,), dty
-0002e030: 7065 3d69 6e74 3634 2c20 6368 756e 6b73  pe=int64, chunks
-0002e040: 697a 653d 2832 2c29 2c20 6368 756e 6b74  ize=(2,), chunkt
-0002e050: 7970 653d 6e75 6d70 792e 6e64 6172 7261  ype=numpy.ndarra
-0002e060: 793e 2c0a 2020 2020 2064 6173 6b2e 6172  y>,.     dask.ar
-0002e070: 7261 793c 626c 6f63 6b73 2c20 7368 6170  ray<blocks, shap
-0002e080: 653d 2832 2c29 2c20 6474 7970 653d 696e  e=(2,), dtype=in
-0002e090: 7436 342c 2063 6875 6e6b 7369 7a65 3d28  t64, chunksize=(
-0002e0a0: 322c 292c 2063 6875 6e6b 7479 7065 3d6e  2,), chunktype=n
-0002e0b0: 756d 7079 2e6e 6461 7272 6179 3e2c 0a20  umpy.ndarray>,. 
-0002e0c0: 2020 2020 6461 736b 2e61 7272 6179 3c62      dask.array<b
-0002e0d0: 6c6f 636b 732c 2073 6861 7065 3d28 322c  locks, shape=(2,
-0002e0e0: 292c 2064 7479 7065 3d69 6e74 3634 2c20  ), dtype=int64, 
-0002e0f0: 6368 756e 6b73 697a 653d 2832 2c29 2c20  chunksize=(2,), 
-0002e100: 6368 756e 6b74 7970 653d 6e75 6d70 792e  chunktype=numpy.
-0002e110: 6e64 6172 7261 793e 2c0a 2020 2020 2064  ndarray>,.     d
-0002e120: 6173 6b2e 6172 7261 793c 626c 6f63 6b73  ask.array<blocks
-0002e130: 2c20 7368 6170 653d 2832 2c29 2c20 6474  , shape=(2,), dt
-0002e140: 7970 653d 696e 7436 342c 2063 6875 6e6b  ype=int64, chunk
-0002e150: 7369 7a65 3d28 322c 292c 2063 6875 6e6b  size=(2,), chunk
-0002e160: 7479 7065 3d6e 756d 7079 2e6e 6461 7272  type=numpy.ndarr
-0002e170: 6179 3e5d 0a0a 2020 2020 5265 7475 726e  ay>]..    Return
-0002e180: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
-0002e190: 2020 416e 2069 6e73 7461 6e63 6520 6f66    An instance of
-0002e1a0: 2060 6064 612e 6172 7261 792e 426c 6f63   ``da.array.Bloc
-0002e1b0: 6b76 6965 7760 600a 2020 2020 2222 220a  kview``.    """.
-0002e1c0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-0002e1d0: 5f28 7365 6c66 2c20 6172 7261 793a 2041  _(self, array: A
-0002e1e0: 7272 6179 293a 0a20 2020 2020 2020 2073  rray):.        s
-0002e1f0: 656c 662e 5f61 7272 6179 203d 2061 7272  elf._array = arr
-0002e200: 6179 0a0a 2020 2020 6465 6620 5f5f 6765  ay..    def __ge
-0002e210: 7469 7465 6d5f 5f28 7365 6c66 2c20 696e  titem__(self, in
-0002e220: 6465 783a 2041 6e79 2920 2d3e 2041 7272  dex: Any) -> Arr
-0002e230: 6179 3a0a 2020 2020 2020 2020 6672 6f6d  ay:.        from
-0002e240: 2064 6173 6b2e 6172 7261 792e 736c 6963   dask.array.slic
-0002e250: 696e 6720 696d 706f 7274 206e 6f72 6d61  ing import norma
-0002e260: 6c69 7a65 5f69 6e64 6578 0a0a 2020 2020  lize_index..    
-0002e270: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-0002e280: 7461 6e63 6528 696e 6465 782c 2074 7570  tance(index, tup
-0002e290: 6c65 293a 0a20 2020 2020 2020 2020 2020  le):.           
-0002e2a0: 2069 6e64 6578 203d 2028 696e 6465 782c   index = (index,
-0002e2b0: 290a 2020 2020 2020 2020 6966 2073 756d  ).        if sum
-0002e2c0: 2869 7369 6e73 7461 6e63 6528 696e 642c  (isinstance(ind,
-0002e2d0: 2028 6e70 2e6e 6461 7272 6179 2c20 6c69   (np.ndarray, li
-0002e2e0: 7374 2929 2066 6f72 2069 6e64 2069 6e20  st)) for ind in 
-0002e2f0: 696e 6465 7829 203e 2031 3a0a 2020 2020  index) > 1:.    
-0002e300: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002e310: 6c75 6545 7272 6f72 2822 4361 6e20 6f6e  lueError("Can on
-0002e320: 6c79 2073 6c69 6365 2077 6974 6820 6120  ly slice with a 
-0002e330: 7369 6e67 6c65 206c 6973 7422 290a 2020  single list").  
-0002e340: 2020 2020 2020 6966 2061 6e79 2869 6e64        if any(ind
-0002e350: 2069 7320 4e6f 6e65 2066 6f72 2069 6e64   is None for ind
-0002e360: 2069 6e20 696e 6465 7829 3a0a 2020 2020   in index):.    
-0002e370: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0002e380: 6c75 6545 7272 6f72 2822 536c 6963 696e  lueError("Slicin
-0002e390: 6720 7769 7468 206e 702e 6e65 7761 7869  g with np.newaxi
-0002e3a0: 7320 6f72 204e 6f6e 6520 6973 206e 6f74  s or None is not
-0002e3b0: 2073 7570 706f 7274 6564 2229 0a20 2020   supported").   
-0002e3c0: 2020 2020 2069 6e64 6578 203d 206e 6f72       index = nor
-0002e3d0: 6d61 6c69 7a65 5f69 6e64 6578 2869 6e64  malize_index(ind
-0002e3e0: 6578 2c20 7365 6c66 2e5f 6172 7261 792e  ex, self._array.
-0002e3f0: 6e75 6d62 6c6f 636b 7329 0a20 2020 2020  numblocks).     
-0002e400: 2020 2069 6e64 6578 203d 2074 7570 6c65     index = tuple
-0002e410: 280a 2020 2020 2020 2020 2020 2020 736c  (.            sl
-0002e420: 6963 6528 6b2c 206b 202b 2031 2920 6966  ice(k, k + 1) if
-0002e430: 2069 7369 6e73 7461 6e63 6528 6b2c 204e   isinstance(k, N
-0002e440: 756d 6265 7229 2065 6c73 6520 6b20 2023  umber) else k  #
-0002e450: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
-0002e460: 2020 2020 2020 2020 2020 666f 7220 6b20            for k 
-0002e470: 696e 2069 6e64 6578 0a20 2020 2020 2020  in index.       
-0002e480: 2029 0a0a 2020 2020 2020 2020 6e61 6d65   )..        name
-0002e490: 203d 2022 626c 6f63 6b73 2d22 202b 2074   = "blocks-" + t
-0002e4a0: 6f6b 656e 697a 6528 7365 6c66 2e5f 6172  okenize(self._ar
-0002e4b0: 7261 792c 2069 6e64 6578 290a 0a20 2020  ray, index)..   
-0002e4c0: 2020 2020 206e 6577 5f6b 6579 7320 3d20       new_keys = 
-0002e4d0: 7365 6c66 2e5f 6172 7261 792e 5f6b 6579  self._array._key
-0002e4e0: 5f61 7272 6179 5b69 6e64 6578 5d0a 0a20  _array[index].. 
-0002e4f0: 2020 2020 2020 2063 6875 6e6b 7320 3d20         chunks = 
-0002e500: 7475 706c 6528 0a20 2020 2020 2020 2020  tuple(.         
-0002e510: 2020 2074 7570 6c65 286e 702e 6172 7261     tuple(np.arra
-0002e520: 7928 6329 5b69 5d2e 746f 6c69 7374 2829  y(c)[i].tolist()
-0002e530: 2920 666f 7220 632c 2069 2069 6e20 7a69  ) for c, i in zi
-0002e540: 7028 7365 6c66 2e5f 6172 7261 792e 6368  p(self._array.ch
-0002e550: 756e 6b73 2c20 696e 6465 7829 0a20 2020  unks, index).   
-0002e560: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0002e570: 6b65 7973 203d 2070 726f 6475 6374 282a  keys = product(*
-0002e580: 2872 616e 6765 286c 656e 2863 2929 2066  (range(len(c)) f
-0002e590: 6f72 2063 2069 6e20 6368 756e 6b73 2929  or c in chunks))
-0002e5a0: 0a0a 2020 2020 2020 2020 6c61 7965 7220  ..        layer 
-0002e5b0: 3d20 7b28 6e61 6d65 2c29 202b 206b 6579  = {(name,) + key
-0002e5c0: 3a20 7475 706c 6528 6e65 775f 6b65 7973  : tuple(new_keys
-0002e5d0: 5b6b 6579 5d2e 746f 6c69 7374 2829 2920  [key].tolist()) 
-0002e5e0: 666f 7220 6b65 7920 696e 206b 6579 737d  for key in keys}
-0002e5f0: 0a0a 2020 2020 2020 2020 6772 6170 6820  ..        graph 
-0002e600: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-0002e610: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-0002e620: 7328 6e61 6d65 2c20 6c61 7965 722c 2064  s(name, layer, d
-0002e630: 6570 656e 6465 6e63 6965 733d 5b73 656c  ependencies=[sel
-0002e640: 662e 5f61 7272 6179 5d29 0a20 2020 2020  f._array]).     
-0002e650: 2020 2072 6574 7572 6e20 4172 7261 7928     return Array(
-0002e660: 6772 6170 682c 206e 616d 652c 2063 6875  graph, name, chu
-0002e670: 6e6b 732c 206d 6574 613d 7365 6c66 2e5f  nks, meta=self._
-0002e680: 6172 7261 7929 0a0a 2020 2020 6465 6620  array)..    def 
-0002e690: 5f5f 6571 5f5f 2873 656c 662c 206f 7468  __eq__(self, oth
-0002e6a0: 6572 3a20 416e 7929 202d 3e20 626f 6f6c  er: Any) -> bool
-0002e6b0: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
-0002e6c0: 6e73 7461 6e63 6528 6f74 6865 722c 2042  nstance(other, B
-0002e6d0: 6c6f 636b 5669 6577 293a 0a20 2020 2020  lockView):.     
-0002e6e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002e6f0: 6c66 2e5f 6172 7261 7920 6973 206f 7468  lf._array is oth
-0002e700: 6572 2e5f 6172 7261 790a 2020 2020 2020  er._array.      
-0002e710: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0002e720: 2020 2020 7265 7475 726e 204e 6f74 496d      return NotIm
-0002e730: 706c 656d 656e 7465 640a 0a20 2020 2040  plemented..    @
-0002e740: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0002e750: 2073 697a 6528 7365 6c66 2920 2d3e 2069   size(self) -> i
-0002e760: 6e74 3a0a 2020 2020 2020 2020 2222 220a  nt:.        """.
-0002e770: 2020 2020 2020 2020 5468 6520 746f 7461          The tota
-0002e780: 6c20 6e75 6d62 6572 206f 6620 626c 6f63  l number of bloc
-0002e790: 6b73 2069 6e20 7468 6520 6172 7261 792e  ks in the array.
-0002e7a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0002e7b0: 2020 2020 2072 6574 7572 6e20 6d61 7468       return math
-0002e7c0: 2e70 726f 6428 7365 6c66 2e73 6861 7065  .prod(self.shape
-0002e7d0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0002e7e0: 0a20 2020 2064 6566 2073 6861 7065 2873  .    def shape(s
-0002e7f0: 656c 6629 202d 3e20 7475 706c 655b 696e  elf) -> tuple[in
-0002e800: 742c 202e 2e2e 5d3a 0a20 2020 2020 2020  t, ...]:.       
-0002e810: 2022 2222 0a20 2020 2020 2020 2054 6865   """.        The
-0002e820: 206e 756d 6265 7220 6f66 2062 6c6f 636b   number of block
-0002e830: 7320 7065 7220 6178 6973 2e20 416c 6961  s per axis. Alia
-0002e840: 7320 6f66 2060 6064 6173 6b2e 6172 7261  s of ``dask.arra
-0002e850: 792e 6e75 6d62 6c6f 636b 7360 602e 0a20  y.numblocks``.. 
-0002e860: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002e870: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0002e880: 6172 7261 792e 6e75 6d62 6c6f 636b 730a  array.numblocks.
-0002e890: 0a20 2020 2064 6566 2072 6176 656c 2873  .    def ravel(s
-0002e8a0: 656c 6629 202d 3e20 6c69 7374 5b41 7272  elf) -> list[Arr
-0002e8b0: 6179 5d3a 0a20 2020 2020 2020 2022 2222  ay]:.        """
-0002e8c0: 0a20 2020 2020 2020 2052 6574 7572 6e20  .        Return 
-0002e8d0: 6120 666c 6174 7465 6e65 6420 6c69 7374  a flattened list
-0002e8e0: 206f 6620 616c 6c20 7468 6520 626c 6f63   of all the bloc
-0002e8f0: 6b73 2069 6e20 7468 6520 6172 7261 7920  ks in the array 
-0002e900: 696e 2043 206f 7264 6572 2e0a 2020 2020  in C order..    
-0002e910: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002e920: 7265 7475 726e 205b 7365 6c66 5b69 6478  return [self[idx
-0002e930: 5d20 666f 7220 6964 7820 696e 206e 702e  ] for idx in np.
-0002e940: 6e64 696e 6465 7828 7365 6c66 2e73 6861  ndindex(self.sha
-0002e950: 7065 295d 0a0a 0a66 726f 6d20 6461 736b  pe)]...from dask
-0002e960: 2e61 7272 6179 2e62 6c6f 636b 7769 7365  .array.blockwise
-0002e970: 2069 6d70 6f72 7420 626c 6f63 6b77 6973   import blockwis
-0002e980: 650a 6672 6f6d 2064 6173 6b2e 6172 7261  e.from dask.arra
-0002e990: 792e 7574 696c 7320 696d 706f 7274 2063  y.utils import c
-0002e9a0: 6f6d 7075 7465 5f6d 6574 612c 206d 6574  ompute_meta, met
-0002e9b0: 615f 6672 6f6d 5f61 7272 6179 0a         a_from_array.
+0002c5d0: 2020 2020 2020 2066 756c 6c5f 736c 6963         full_slic
+0002c5e0: 6573 2c20 6c69 7374 287a 6970 282a 706c  es, list(zip(*pl
+0002c5f0: 7563 6b28 322c 2070 6572 5f62 6c6f 636b  uck(2, per_block
+0002c600: 5b6b 6579 5d29 2929 0a20 2020 2020 2020  [key]))).       
+0002c610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c620: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+0002c630: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+0002c640: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0002c650: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
+0002c660: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0002c670: 2020 2064 736b 5b6b 6579 6e61 6d65 2876     dsk[keyname(v
+0002c680: 696e 6465 785f 6d65 7267 655f 6e61 6d65  index_merge_name
+0002c690: 2c20 302c 206f 6b65 7929 5d20 3d20 280a  , 0, okey)] = (.
+0002c6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c6b0: 5f76 696e 6465 785f 6d65 7267 652c 0a20  _vindex_merge,. 
+0002c6c0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0002c6d0: 6c69 7374 2870 6c75 636b 2830 2c20 7065  list(pluck(0, pe
+0002c6e0: 725f 626c 6f63 6b5b 6b65 795d 2929 2066  r_block[key])) f
+0002c6f0: 6f72 206b 6579 2069 6e20 7065 725f 626c  or key in per_bl
+0002c700: 6f63 6b5d 2c0a 2020 2020 2020 2020 2020  ock],.          
+0002c710: 2020 2020 2020 5b6b 6579 6e61 6d65 286e        [keyname(n
+0002c720: 616d 652c 2069 2c20 6f6b 6579 2920 666f  ame, i, okey) fo
+0002c730: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+0002c740: 2870 6572 5f62 6c6f 636b 2929 5d2c 0a20  (per_block))],. 
+0002c750: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0002c760: 2020 2020 2020 7265 7375 6c74 5f31 6420        result_1d 
+0002c770: 3d20 4172 7261 7928 0a20 2020 2020 2020  = Array(.       
+0002c780: 2020 2020 2048 6967 684c 6576 656c 4772       HighLevelGr
+0002c790: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+0002c7a0: 696f 6e73 286f 7574 5f6e 616d 652c 2064  ions(out_name, d
+0002c7b0: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
+0002c7c0: 3d5b 785d 292c 0a20 2020 2020 2020 2020  =[x]),.         
+0002c7d0: 2020 206f 7574 5f6e 616d 652c 0a20 2020     out_name,.   
+0002c7e0: 2020 2020 2020 2020 2063 6875 6e6b 732c           chunks,
+0002c7f0: 0a20 2020 2020 2020 2020 2020 2078 2e64  .            x.d
+0002c800: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+0002c810: 2020 6d65 7461 3d78 2e5f 6d65 7461 2c0a    meta=x._meta,.
+0002c820: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0002c830: 2020 7265 7475 726e 2072 6573 756c 745f    return result_
+0002c840: 3164 2e72 6573 6861 7065 2862 726f 6164  1d.reshape(broad
+0002c850: 6361 7374 5f73 6861 7065 202b 2072 6573  cast_shape + res
+0002c860: 756c 745f 3164 2e73 6861 7065 5b31 3a5d  ult_1d.shape[1:]
+0002c870: 290a 0a20 2020 2023 206f 7574 7075 7420  )..    # output 
+0002c880: 6861 7320 6120 7a65 726f 2064 696d 656e  has a zero dimen
+0002c890: 7369 6f6e 2c20 6a75 7374 2063 7265 6174  sion, just creat
+0002c8a0: 6520 6120 6e65 7720 7a65 726f 2d73 6861  e a new zero-sha
+0002c8b0: 7065 2061 7272 6179 2077 6974 6820 7468  pe array with th
+0002c8c0: 650a 2020 2020 2320 7361 6d65 2064 7479  e.    # same dty
+0002c8d0: 7065 0a20 2020 2066 726f 6d20 6461 736b  pe.    from dask
+0002c8e0: 2e61 7272 6179 2e77 7261 7020 696d 706f  .array.wrap impo
+0002c8f0: 7274 2065 6d70 7479 0a0a 2020 2020 7265  rt empty..    re
+0002c900: 7375 6c74 5f31 6420 3d20 656d 7074 7928  sult_1d = empty(
+0002c910: 0a20 2020 2020 2020 2074 7570 6c65 286d  .        tuple(m
+0002c920: 6170 2873 756d 2c20 6368 756e 6b73 2929  ap(sum, chunks))
+0002c930: 2c20 6368 756e 6b73 3d63 6875 6e6b 732c  , chunks=chunks,
+0002c940: 2064 7479 7065 3d78 2e64 7479 7065 2c20   dtype=x.dtype, 
+0002c950: 6e61 6d65 3d6f 7574 5f6e 616d 650a 2020  name=out_name.  
+0002c960: 2020 290a 2020 2020 7265 7475 726e 2072    ).    return r
+0002c970: 6573 756c 745f 3164 2e72 6573 6861 7065  esult_1d.reshape
+0002c980: 2862 726f 6164 6361 7374 5f73 6861 7065  (broadcast_shape
+0002c990: 202b 2072 6573 756c 745f 3164 2e73 6861   + result_1d.sha
+0002c9a0: 7065 5b31 3a5d 290a 0a0a 6465 6620 5f67  pe[1:])...def _g
+0002c9b0: 6574 5f61 7869 7328 696e 6465 7865 7329  et_axis(indexes)
+0002c9c0: 3a0a 2020 2020 2222 2247 6574 2061 7869  :.    """Get axi
+0002c9d0: 7320 616c 6f6e 6720 7768 6963 6820 706f  s along which po
+0002c9e0: 696e 742d 7769 7365 2073 6c69 6369 6e67  int-wise slicing
+0002c9f0: 2072 6573 756c 7473 206c 6965 0a0a 2020   results lie..  
+0002ca00: 2020 5468 6973 2069 7320 6d6f 7374 6c79    This is mostly
+0002ca10: 2061 2068 6163 6b20 6265 6361 7573 6520   a hack because 
+0002ca20: 4920 6361 6e27 7420 6669 6775 7265 206f  I can't figure o
+0002ca30: 7574 204e 756d 5079 2773 2072 756c 6520  ut NumPy's rule 
+0002ca40: 6f6e 2074 6869 7320 616e 640a 2020 2020  on this and.    
+0002ca50: 6361 6e27 7420 6265 2062 6f74 6865 7265  can't be bothere
+0002ca60: 6420 746f 2067 6f20 7265 6164 696e 672e  d to go reading.
+0002ca70: 0a0a 2020 2020 3e3e 3e20 5f67 6574 5f61  ..    >>> _get_a
+0002ca80: 7869 7328 5b5b 312c 2032 5d2c 204e 6f6e  xis([[1, 2], Non
+0002ca90: 652c 205b 312c 2032 5d2c 204e 6f6e 655d  e, [1, 2], None]
+0002caa0: 290a 2020 2020 300a 2020 2020 3e3e 3e20  ).    0.    >>> 
+0002cab0: 5f67 6574 5f61 7869 7328 5b4e 6f6e 652c  _get_axis([None,
+0002cac0: 205b 312c 2032 5d2c 205b 312c 2032 5d2c   [1, 2], [1, 2],
+0002cad0: 204e 6f6e 655d 290a 2020 2020 310a 2020   None]).    1.  
+0002cae0: 2020 3e3e 3e20 5f67 6574 5f61 7869 7328    >>> _get_axis(
+0002caf0: 5b4e 6f6e 652c 204e 6f6e 652c 205b 312c  [None, None, [1,
+0002cb00: 2032 5d2c 205b 312c 2032 5d5d 290a 2020   2], [1, 2]]).  
+0002cb10: 2020 320a 2020 2020 2222 220a 2020 2020    2.    """.    
+0002cb20: 6e64 696d 203d 206c 656e 2869 6e64 6578  ndim = len(index
+0002cb30: 6573 290a 2020 2020 696e 6465 7865 7320  es).    indexes 
+0002cb40: 3d20 5b73 6c69 6365 284e 6f6e 652c 204e  = [slice(None, N
+0002cb50: 6f6e 6529 2069 6620 6920 6973 204e 6f6e  one) if i is Non
+0002cb60: 6520 656c 7365 205b 305d 2066 6f72 2069  e else [0] for i
+0002cb70: 2069 6e20 696e 6465 7865 735d 0a20 2020   in indexes].   
+0002cb80: 2078 203d 206e 702e 656d 7074 7928 2832   x = np.empty((2
+0002cb90: 2c29 202a 206e 6469 6d29 0a20 2020 2078  ,) * ndim).    x
+0002cba0: 3220 3d20 785b 7475 706c 6528 696e 6465  2 = x[tuple(inde
+0002cbb0: 7865 7329 5d0a 2020 2020 7265 7475 726e  xes)].    return
+0002cbc0: 2078 322e 7368 6170 652e 696e 6465 7828   x2.shape.index(
+0002cbd0: 3129 0a0a 0a64 6566 205f 7669 6e64 6578  1)...def _vindex
+0002cbe0: 5f73 6c69 6365 2862 6c6f 636b 2c20 706f  _slice(block, po
+0002cbf0: 696e 7473 293a 0a20 2020 2022 2222 5075  ints):.    """Pu
+0002cc00: 6c6c 206f 7574 2070 6f69 6e74 2d77 6973  ll out point-wis
+0002cc10: 6520 736c 6963 6573 2066 726f 6d20 626c  e slices from bl
+0002cc20: 6f63 6b22 2222 0a20 2020 2070 6f69 6e74  ock""".    point
+0002cc30: 7320 3d20 5b70 2069 6620 6973 696e 7374  s = [p if isinst
+0002cc40: 616e 6365 2870 2c20 736c 6963 6529 2065  ance(p, slice) e
+0002cc50: 6c73 6520 6c69 7374 2870 2920 666f 7220  lse list(p) for 
+0002cc60: 7020 696e 2070 6f69 6e74 735d 0a20 2020  p in points].   
+0002cc70: 2072 6574 7572 6e20 626c 6f63 6b5b 7475   return block[tu
+0002cc80: 706c 6528 706f 696e 7473 295d 0a0a 0a64  ple(points)]...d
+0002cc90: 6566 205f 7669 6e64 6578 5f74 7261 6e73  ef _vindex_trans
+0002cca0: 706f 7365 2862 6c6f 636b 2c20 6178 6973  pose(block, axis
+0002ccb0: 293a 0a20 2020 2022 2222 526f 7461 7465  ):.    """Rotate
+0002ccc0: 2062 6c6f 636b 2073 6f20 7468 6174 2070   block so that p
+0002ccd0: 6f69 6e74 7320 6172 6520 6f6e 2074 6865  oints are on the
+0002cce0: 2066 6972 7374 2064 696d 656e 7369 6f6e   first dimension
+0002ccf0: 2222 220a 2020 2020 6178 6573 203d 205b  """.    axes = [
+0002cd00: 6178 6973 5d20 2b20 6c69 7374 2872 616e  axis] + list(ran
+0002cd10: 6765 2861 7869 7329 2920 2b20 6c69 7374  ge(axis)) + list
+0002cd20: 2872 616e 6765 2861 7869 7320 2b20 312c  (range(axis + 1,
+0002cd30: 2062 6c6f 636b 2e6e 6469 6d29 290a 2020   block.ndim)).  
+0002cd40: 2020 7265 7475 726e 2062 6c6f 636b 2e74    return block.t
+0002cd50: 7261 6e73 706f 7365 2861 7865 7329 0a0a  ranspose(axes)..
+0002cd60: 0a64 6566 205f 7669 6e64 6578 5f6d 6572  .def _vindex_mer
+0002cd70: 6765 286c 6f63 6174 696f 6e73 2c20 7661  ge(locations, va
+0002cd80: 6c75 6573 293a 0a20 2020 2022 2222 0a0a  lues):.    """..
+0002cd90: 2020 2020 3e3e 3e20 6c6f 6361 7469 6f6e      >>> location
+0002cda0: 7320 3d20 5b30 5d2c 205b 322c 2031 5d0a  s = [0], [2, 1].
+0002cdb0: 2020 2020 3e3e 3e20 7661 6c75 6573 203d      >>> values =
+0002cdc0: 205b 6e70 2e61 7272 6179 285b 5b31 2c20   [np.array([[1, 
+0002cdd0: 322c 2033 5d5d 292c 0a20 2020 202e 2e2e  2, 3]]),.    ...
+0002cde0: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
+0002cdf0: 7261 7928 5b5b 3130 2c20 3230 2c20 3330  ray([[10, 20, 30
+0002ce00: 5d2c 205b 3430 2c20 3530 2c20 3630 5d5d  ], [40, 50, 60]]
+0002ce10: 295d 0a0a 2020 2020 3e3e 3e20 5f76 696e  )]..    >>> _vin
+0002ce20: 6465 785f 6d65 7267 6528 6c6f 6361 7469  dex_merge(locati
+0002ce30: 6f6e 732c 2076 616c 7565 7329 0a20 2020  ons, values).   
+0002ce40: 2061 7272 6179 285b 5b20 312c 2020 322c   array([[ 1,  2,
+0002ce50: 2020 335d 2c0a 2020 2020 2020 2020 2020    3],.          
+0002ce60: 205b 3430 2c20 3530 2c20 3630 5d2c 0a20   [40, 50, 60],. 
+0002ce70: 2020 2020 2020 2020 2020 5b31 302c 2032            [10, 2
+0002ce80: 302c 2033 305d 5d29 0a20 2020 2022 2222  0, 30]]).    """
+0002ce90: 0a20 2020 206c 6f63 6174 696f 6e73 203d  .    locations =
+0002cea0: 206c 6973 7428 6d61 7028 6c69 7374 2c20   list(map(list, 
+0002ceb0: 6c6f 6361 7469 6f6e 7329 290a 2020 2020  locations)).    
+0002cec0: 7661 6c75 6573 203d 206c 6973 7428 7661  values = list(va
+0002ced0: 6c75 6573 290a 0a20 2020 206e 203d 2073  lues)..    n = s
+0002cee0: 756d 286d 6170 286c 656e 2c20 6c6f 6361  um(map(len, loca
+0002cef0: 7469 6f6e 7329 290a 0a20 2020 2073 6861  tions))..    sha
+0002cf00: 7065 203d 206c 6973 7428 7661 6c75 6573  pe = list(values
+0002cf10: 5b30 5d2e 7368 6170 6529 0a20 2020 2073  [0].shape).    s
+0002cf20: 6861 7065 5b30 5d20 3d20 6e0a 2020 2020  hape[0] = n.    
+0002cf30: 7368 6170 6520 3d20 7475 706c 6528 7368  shape = tuple(sh
+0002cf40: 6170 6529 0a0a 2020 2020 6474 7970 6520  ape)..    dtype 
+0002cf50: 3d20 7661 6c75 6573 5b30 5d2e 6474 7970  = values[0].dtyp
+0002cf60: 650a 0a20 2020 2078 203d 206e 702e 656d  e..    x = np.em
+0002cf70: 7074 795f 6c69 6b65 2876 616c 7565 735b  pty_like(values[
+0002cf80: 305d 2c20 6474 7970 653d 6474 7970 652c  0], dtype=dtype,
+0002cf90: 2073 6861 7065 3d73 6861 7065 290a 0a20   shape=shape).. 
+0002cfa0: 2020 2069 6e64 203d 205b 736c 6963 6528     ind = [slice(
+0002cfb0: 4e6f 6e65 2c20 4e6f 6e65 2920 666f 7220  None, None) for 
+0002cfc0: 6920 696e 2072 616e 6765 2878 2e6e 6469  i in range(x.ndi
+0002cfd0: 6d29 5d0a 2020 2020 666f 7220 6c6f 632c  m)].    for loc,
+0002cfe0: 2076 616c 2069 6e20 7a69 7028 6c6f 6361   val in zip(loca
+0002cff0: 7469 6f6e 732c 2076 616c 7565 7329 3a0a  tions, values):.
+0002d000: 2020 2020 2020 2020 696e 645b 305d 203d          ind[0] =
+0002d010: 206c 6f63 0a20 2020 2020 2020 2078 5b74   loc.        x[t
+0002d020: 7570 6c65 2869 6e64 295d 203d 2076 616c  uple(ind)] = val
+0002d030: 0a0a 2020 2020 7265 7475 726e 2078 0a0a  ..    return x..
+0002d040: 0a64 6566 2074 6f5f 6e70 795f 7374 6163  .def to_npy_stac
+0002d050: 6b28 6469 726e 616d 652c 2078 2c20 6178  k(dirname, x, ax
+0002d060: 6973 3d30 293a 0a20 2020 2022 2222 5772  is=0):.    """Wr
+0002d070: 6974 6520 6461 736b 2061 7272 6179 2074  ite dask array t
+0002d080: 6f20 6120 7374 6163 6b20 6f66 202e 6e70  o a stack of .np
+0002d090: 7920 6669 6c65 730a 0a20 2020 2054 6869  y files..    Thi
+0002d0a0: 7320 7061 7274 6974 696f 6e73 2074 6865  s partitions the
+0002d0b0: 2064 6173 6b2e 6172 7261 7920 616c 6f6e   dask.array alon
+0002d0c0: 6720 6f6e 6520 6178 6973 2061 6e64 2073  g one axis and s
+0002d0d0: 746f 7265 7320 6561 6368 2062 6c6f 636b  tores each block
+0002d0e0: 2061 6c6f 6e67 0a20 2020 2074 6861 7420   along.    that 
+0002d0f0: 6178 6973 2061 7320 6120 7369 6e67 6c65  axis as a single
+0002d100: 202e 6e70 7920 6669 6c65 2069 6e20 7468   .npy file in th
+0002d110: 6520 7370 6563 6966 6965 6420 6469 7265  e specified dire
+0002d120: 6374 6f72 790a 0a20 2020 2045 7861 6d70  ctory..    Examp
+0002d130: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
+0002d140: 0a20 2020 203e 3e3e 2078 203d 2064 612e  .    >>> x = da.
+0002d150: 6f6e 6573 2828 352c 2031 302c 2031 3029  ones((5, 10, 10)
+0002d160: 2c20 6368 756e 6b73 3d28 322c 2034 2c20  , chunks=(2, 4, 
+0002d170: 3429 2920 2023 2064 6f63 7465 7374 3a20  4))  # doctest: 
+0002d180: 2b53 4b49 500a 2020 2020 3e3e 3e20 6461  +SKIP.    >>> da
+0002d190: 2e74 6f5f 6e70 795f 7374 6163 6b28 2764  .to_npy_stack('d
+0002d1a0: 6174 612f 272c 2078 2c20 6178 6973 3d30  ata/', x, axis=0
+0002d1b0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+0002d1c0: 4b49 500a 0a20 2020 2054 6865 2060 602e  KIP..    The ``.
+0002d1d0: 6e70 7960 6020 6669 6c65 7320 7374 6f72  npy`` files stor
+0002d1e0: 6520 6e75 6d70 7920 6172 7261 7973 2066  e numpy arrays f
+0002d1f0: 6f72 2060 6078 5b30 3a32 5d2c 2078 5b32  or ``x[0:2], x[2
+0002d200: 3a34 5d2c 2061 6e64 2078 5b34 3a35 5d60  :4], and x[4:5]`
+0002d210: 600a 2020 2020 7265 7370 6563 7469 7665  `.    respective
+0002d220: 6c79 2c20 6173 2069 7320 7370 6563 6966  ly, as is specif
+0002d230: 6965 6420 6279 2074 6865 2063 6875 6e6b  ied by the chunk
+0002d240: 2073 697a 6520 616c 6f6e 6720 7468 6520   size along the 
+0002d250: 7a65 726f 7468 2061 7869 733a 3a0a 0a20  zeroth axis::.. 
+0002d260: 2020 2020 2020 2024 2074 7265 6520 6461         $ tree da
+0002d270: 7461 2f0a 2020 2020 2020 2020 6461 7461  ta/.        data
+0002d280: 2f0a 2020 2020 2020 2020 7c2d 2d20 302e  /.        |-- 0.
+0002d290: 6e70 790a 2020 2020 2020 2020 7c2d 2d20  npy.        |-- 
+0002d2a0: 312e 6e70 790a 2020 2020 2020 2020 7c2d  1.npy.        |-
+0002d2b0: 2d20 322e 6e70 790a 2020 2020 2020 2020  - 2.npy.        
+0002d2c0: 7c2d 2d20 696e 666f 0a0a 2020 2020 5468  |-- info..    Th
+0002d2d0: 6520 6060 696e 666f 6060 2066 696c 6520  e ``info`` file 
+0002d2e0: 7374 6f72 6573 2074 6865 2064 7479 7065  stores the dtype
+0002d2f0: 2c20 6368 756e 6b73 2c20 616e 6420 6178  , chunks, and ax
+0002d300: 6973 2069 6e66 6f72 6d61 7469 6f6e 206f  is information o
+0002d310: 6620 7468 6520 6172 7261 792e 0a20 2020  f the array..   
+0002d320: 2059 6f75 2063 616e 206c 6f61 6420 7468   You can load th
+0002d330: 6573 6520 7374 6163 6b73 2077 6974 6820  ese stacks with 
+0002d340: 7468 6520 3a66 756e 633a 6064 6173 6b2e  the :func:`dask.
+0002d350: 6172 7261 792e 6672 6f6d 5f6e 7079 5f73  array.from_npy_s
+0002d360: 7461 636b 6020 6675 6e63 7469 6f6e 2e0a  tack` function..
+0002d370: 0a20 2020 203e 3e3e 2079 203d 2064 612e  .    >>> y = da.
+0002d380: 6672 6f6d 5f6e 7079 5f73 7461 636b 2827  from_npy_stack('
+0002d390: 6461 7461 2f27 2920 2023 2064 6f63 7465  data/')  # docte
+0002d3a0: 7374 3a20 2b53 4b49 500a 0a20 2020 2053  st: +SKIP..    S
+0002d3b0: 6565 2041 6c73 6f0a 2020 2020 2d2d 2d2d  ee Also.    ----
+0002d3c0: 2d2d 2d2d 0a20 2020 2066 726f 6d5f 6e70  ----.    from_np
+0002d3d0: 795f 7374 6163 6b0a 2020 2020 2222 220a  y_stack.    """.
+0002d3e0: 0a20 2020 2063 6875 6e6b 7320 3d20 7475  .    chunks = tu
+0002d3f0: 706c 6528 2863 2069 6620 6920 3d3d 2061  ple((c if i == a
+0002d400: 7869 7320 656c 7365 2028 7375 6d28 6329  xis else (sum(c)
+0002d410: 2c29 2920 666f 7220 692c 2063 2069 6e20  ,)) for i, c in 
+0002d420: 656e 756d 6572 6174 6528 782e 6368 756e  enumerate(x.chun
+0002d430: 6b73 2929 0a20 2020 2078 7820 3d20 782e  ks)).    xx = x.
+0002d440: 7265 6368 756e 6b28 6368 756e 6b73 290a  rechunk(chunks).
+0002d450: 0a20 2020 2069 6620 6e6f 7420 6f73 2e70  .    if not os.p
+0002d460: 6174 682e 6578 6973 7473 2864 6972 6e61  ath.exists(dirna
+0002d470: 6d65 293a 0a20 2020 2020 2020 206f 732e  me):.        os.
+0002d480: 6d6b 6469 7228 6469 726e 616d 6529 0a0a  mkdir(dirname)..
+0002d490: 2020 2020 6d65 7461 203d 207b 2263 6875      meta = {"chu
+0002d4a0: 6e6b 7322 3a20 6368 756e 6b73 2c20 2264  nks": chunks, "d
+0002d4b0: 7479 7065 223a 2078 2e64 7479 7065 2c20  type": x.dtype, 
+0002d4c0: 2261 7869 7322 3a20 6178 6973 7d0a 0a20  "axis": axis}.. 
+0002d4d0: 2020 2077 6974 6820 6f70 656e 286f 732e     with open(os.
+0002d4e0: 7061 7468 2e6a 6f69 6e28 6469 726e 616d  path.join(dirnam
+0002d4f0: 652c 2022 696e 666f 2229 2c20 2277 6222  e, "info"), "wb"
+0002d500: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
+0002d510: 7069 636b 6c65 2e64 756d 7028 6d65 7461  pickle.dump(meta
+0002d520: 2c20 6629 0a0a 2020 2020 6e61 6d65 203d  , f)..    name =
+0002d530: 2022 746f 2d6e 7079 2d73 7461 636b 2d22   "to-npy-stack-"
+0002d540: 202b 2073 7472 2875 7569 642e 7575 6964   + str(uuid.uuid
+0002d550: 3128 2929 0a20 2020 2064 736b 203d 207b  1()).    dsk = {
+0002d560: 0a20 2020 2020 2020 2028 6e61 6d65 2c20  .        (name, 
+0002d570: 6929 3a20 286e 702e 7361 7665 2c20 6f73  i): (np.save, os
+0002d580: 2e70 6174 682e 6a6f 696e 2864 6972 6e61  .path.join(dirna
+0002d590: 6d65 2c20 2225 642e 6e70 7922 2025 2069  me, "%d.npy" % i
+0002d5a0: 292c 206b 6579 290a 2020 2020 2020 2020  ), key).        
+0002d5b0: 666f 7220 692c 206b 6579 2069 6e20 656e  for i, key in en
+0002d5c0: 756d 6572 6174 6528 636f 7265 2e66 6c61  umerate(core.fla
+0002d5d0: 7474 656e 2878 782e 5f5f 6461 736b 5f6b  tten(xx.__dask_k
+0002d5e0: 6579 735f 5f28 2929 290a 2020 2020 7d0a  eys__())).    }.
+0002d5f0: 0a20 2020 2067 7261 7068 203d 2048 6967  .    graph = Hig
+0002d600: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+0002d610: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+0002d620: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
+0002d630: 6369 6573 3d5b 7878 5d29 0a20 2020 2063  cies=[xx]).    c
+0002d640: 6f6d 7075 7465 5f61 735f 6966 5f63 6f6c  ompute_as_if_col
+0002d650: 6c65 6374 696f 6e28 4172 7261 792c 2067  lection(Array, g
+0002d660: 7261 7068 2c20 6c69 7374 2864 736b 2929  raph, list(dsk))
+0002d670: 0a0a 0a64 6566 2066 726f 6d5f 6e70 795f  ...def from_npy_
+0002d680: 7374 6163 6b28 6469 726e 616d 652c 206d  stack(dirname, m
+0002d690: 6d61 705f 6d6f 6465 3d22 7222 293a 0a20  map_mode="r"):. 
+0002d6a0: 2020 2022 2222 4c6f 6164 2064 6173 6b20     """Load dask 
+0002d6b0: 6172 7261 7920 6672 6f6d 2073 7461 636b  array from stack
+0002d6c0: 206f 6620 6e70 7920 6669 6c65 730a 0a20   of npy files.. 
+0002d6d0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0002d6e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0002d6f0: 2064 6972 6e61 6d65 3a20 7374 7269 6e67   dirname: string
+0002d700: 0a20 2020 2020 2020 2044 6972 6563 746f  .        Directo
+0002d710: 7279 206f 6620 2e6e 7079 2066 696c 6573  ry of .npy files
+0002d720: 0a20 2020 206d 6d61 705f 6d6f 6465 3a20  .    mmap_mode: 
+0002d730: 284e 6f6e 6520 6f72 2027 7227 290a 2020  (None or 'r').  
+0002d740: 2020 2020 2020 5265 6164 2064 6174 6120        Read data 
+0002d750: 696e 206d 656d 6f72 7920 6d61 7020 6d6f  in memory map mo
+0002d760: 6465 0a0a 2020 2020 5365 6520 416c 736f  de..    See Also
+0002d770: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
+0002d780: 2020 746f 5f6e 7079 5f73 7461 636b 0a20    to_npy_stack. 
+0002d790: 2020 2022 2222 0a20 2020 2077 6974 6820     """.    with 
+0002d7a0: 6f70 656e 286f 732e 7061 7468 2e6a 6f69  open(os.path.joi
+0002d7b0: 6e28 6469 726e 616d 652c 2022 696e 666f  n(dirname, "info
+0002d7c0: 2229 2c20 2272 6222 2920 6173 2066 3a0a  "), "rb") as f:.
+0002d7d0: 2020 2020 2020 2020 696e 666f 203d 2070          info = p
+0002d7e0: 6963 6b6c 652e 6c6f 6164 2866 290a 0a20  ickle.load(f).. 
+0002d7f0: 2020 2064 7479 7065 203d 2069 6e66 6f5b     dtype = info[
+0002d800: 2264 7479 7065 225d 0a20 2020 2063 6875  "dtype"].    chu
+0002d810: 6e6b 7320 3d20 696e 666f 5b22 6368 756e  nks = info["chun
+0002d820: 6b73 225d 0a20 2020 2061 7869 7320 3d20  ks"].    axis = 
+0002d830: 696e 666f 5b22 6178 6973 225d 0a0a 2020  info["axis"]..  
+0002d840: 2020 6e61 6d65 203d 2022 6672 6f6d 2d6e    name = "from-n
+0002d850: 7079 2d73 7461 636b 2d25 7322 2025 2064  py-stack-%s" % d
+0002d860: 6972 6e61 6d65 0a20 2020 206b 6579 7320  irname.    keys 
+0002d870: 3d20 6c69 7374 2870 726f 6475 6374 285b  = list(product([
+0002d880: 6e61 6d65 5d2c 202a 5b72 616e 6765 286c  name], *[range(l
+0002d890: 656e 2863 2929 2066 6f72 2063 2069 6e20  en(c)) for c in 
+0002d8a0: 6368 756e 6b73 5d29 290a 2020 2020 7661  chunks])).    va
+0002d8b0: 6c75 6573 203d 205b 0a20 2020 2020 2020  lues = [.       
+0002d8c0: 2028 6e70 2e6c 6f61 642c 206f 732e 7061   (np.load, os.pa
+0002d8d0: 7468 2e6a 6f69 6e28 6469 726e 616d 652c  th.join(dirname,
+0002d8e0: 2022 2564 2e6e 7079 2220 2520 6929 2c20   "%d.npy" % i), 
+0002d8f0: 6d6d 6170 5f6d 6f64 6529 0a20 2020 2020  mmap_mode).     
+0002d900: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+0002d910: 6528 6c65 6e28 6368 756e 6b73 5b61 7869  e(len(chunks[axi
+0002d920: 735d 2929 0a20 2020 205d 0a20 2020 2064  s])).    ].    d
+0002d930: 736b 203d 2064 6963 7428 7a69 7028 6b65  sk = dict(zip(ke
+0002d940: 7973 2c20 7661 6c75 6573 2929 0a0a 2020  ys, values))..  
+0002d950: 2020 7265 7475 726e 2041 7272 6179 2864    return Array(d
+0002d960: 736b 2c20 6e61 6d65 2c20 6368 756e 6b73  sk, name, chunks
+0002d970: 2c20 6474 7970 6529 0a0a 0a64 6566 206e  , dtype)...def n
+0002d980: 6577 5f64 615f 6f62 6a65 6374 2864 736b  ew_da_object(dsk
+0002d990: 2c20 6e61 6d65 2c20 6368 756e 6b73 2c20  , name, chunks, 
+0002d9a0: 6d65 7461 3d4e 6f6e 652c 2064 7479 7065  meta=None, dtype
+0002d9b0: 3d4e 6f6e 6529 3a0a 2020 2020 2222 2247  =None):.    """G
+0002d9c0: 656e 6572 6963 2063 6f6e 7374 7275 6374  eneric construct
+0002d9d0: 6f72 2066 6f72 2064 6173 6b2e 6172 7261  or for dask.arra
+0002d9e0: 7920 6f72 2064 6173 6b2e 6461 7461 6672  y or dask.datafr
+0002d9f0: 616d 6520 6f62 6a65 6374 732e 0a0a 2020  ame objects...  
+0002da00: 2020 4465 6369 6465 7320 7468 6520 6170    Decides the ap
+0002da10: 7072 6f70 7269 6174 6520 6f75 7470 7574  propriate output
+0002da20: 2063 6c61 7373 2062 6173 6564 206f 6e20   class based on 
+0002da30: 7468 6520 7479 7065 206f 6620 606d 6574  the type of `met
+0002da40: 6160 2070 726f 7669 6465 642e 0a20 2020  a` provided..   
+0002da50: 2022 2222 0a20 2020 2069 6620 6973 5f64   """.    if is_d
+0002da60: 6174 6166 7261 6d65 5f6c 696b 6528 6d65  ataframe_like(me
+0002da70: 7461 2920 6f72 2069 735f 7365 7269 6573  ta) or is_series
+0002da80: 5f6c 696b 6528 6d65 7461 2920 6f72 2069  _like(meta) or i
+0002da90: 735f 696e 6465 785f 6c69 6b65 286d 6574  s_index_like(met
+0002daa0: 6129 3a0a 2020 2020 2020 2020 6672 6f6d  a):.        from
+0002dab0: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+0002dac0: 636f 7265 2069 6d70 6f72 7420 6e65 775f  core import new_
+0002dad0: 6464 5f6f 626a 6563 740a 0a20 2020 2020  dd_object..     
+0002dae0: 2020 2061 7373 6572 7420 616c 6c28 6c65     assert all(le
+0002daf0: 6e28 6329 203d 3d20 3120 666f 7220 6320  n(c) == 1 for c 
+0002db00: 696e 2063 6875 6e6b 735b 313a 5d29 0a20  in chunks[1:]). 
+0002db10: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+0002db20: 203d 205b 4e6f 6e65 5d20 2a20 286c 656e   = [None] * (len
+0002db30: 2863 6875 6e6b 735b 305d 2920 2b20 3129  (chunks[0]) + 1)
+0002db40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002db50: 6e65 775f 6464 5f6f 626a 6563 7428 6473  new_dd_object(ds
+0002db60: 6b2c 206e 616d 652c 206d 6574 612c 2064  k, name, meta, d
+0002db70: 6976 6973 696f 6e73 290a 2020 2020 656c  ivisions).    el
+0002db80: 7365 3a0a 2020 2020 2020 2020 7265 7475  se:.        retu
+0002db90: 726e 2041 7272 6179 2864 736b 2c20 6e61  rn Array(dsk, na
+0002dba0: 6d65 3d6e 616d 652c 2063 6875 6e6b 733d  me=name, chunks=
+0002dbb0: 6368 756e 6b73 2c20 6d65 7461 3d6d 6574  chunks, meta=met
+0002dbc0: 612c 2064 7479 7065 3d64 7479 7065 290a  a, dtype=dtype).
+0002dbd0: 0a0a 636c 6173 7320 426c 6f63 6b56 6965  ..class BlockVie
+0002dbe0: 773a 0a20 2020 2022 2222 416e 2061 7272  w:.    """An arr
+0002dbf0: 6179 2d6c 696b 6520 696e 7465 7266 6163  ay-like interfac
+0002dc00: 6520 746f 2074 6865 2062 6c6f 636b 7320  e to the blocks 
+0002dc10: 6f66 2061 6e20 6172 7261 792e 0a0a 2020  of an array...  
+0002dc20: 2020 6060 426c 6f63 6b56 6965 7760 6020    ``BlockView`` 
+0002dc30: 7072 6f76 6964 6573 2061 6e20 6172 7261  provides an arra
+0002dc40: 792d 6c69 6b65 2069 6e74 6572 6661 6365  y-like interface
+0002dc50: 0a20 2020 2074 6f20 7468 6520 626c 6f63  .    to the bloc
+0002dc60: 6b73 206f 6620 6120 6461 736b 2061 7272  ks of a dask arr
+0002dc70: 6179 2e20 204e 756d 7079 2d73 7479 6c65  ay.  Numpy-style
+0002dc80: 2069 6e64 6578 696e 6720 6f66 2061 0a20   indexing of a. 
+0002dc90: 2020 2020 6060 426c 6f63 6b56 6965 7760      ``BlockView`
+0002dca0: 6020 7265 7475 726e 7320 6120 7365 6c65  ` returns a sele
+0002dcb0: 6374 696f 6e20 6f66 2062 6c6f 636b 7320  ction of blocks 
+0002dcc0: 6173 2061 206e 6577 2064 6173 6b20 6172  as a new dask ar
+0002dcd0: 7261 792e 0a0a 2020 2020 596f 7520 6361  ray...    You ca
+0002dce0: 6e20 696e 6465 7820 6060 426c 6f63 6b56  n index ``BlockV
+0002dcf0: 6965 7760 6020 6c69 6b65 2061 206e 756d  iew`` like a num
+0002dd00: 7079 2061 7272 6179 206f 6620 7368 6170  py array of shap
+0002dd10: 650a 2020 2020 6571 7561 6c20 746f 2074  e.    equal to t
+0002dd20: 6865 206e 756d 6265 7220 6f66 2062 6c6f  he number of blo
+0002dd30: 636b 7320 696e 2065 6163 6820 6469 6d65  cks in each dime
+0002dd40: 6e73 696f 6e2c 2028 6176 6169 6c61 626c  nsion, (availabl
+0002dd50: 6520 6173 0a20 2020 2061 7272 6179 2e62  e as.    array.b
+0002dd60: 6c6f 636b 732e 7369 7a65 292e 2020 5468  locks.size).  Th
+0002dd70: 6520 6469 6d65 6e73 696f 6e61 6c69 7479  e dimensionality
+0002dd80: 206f 6620 7468 6520 6f75 7470 7574 2061   of the output a
+0002dd90: 7272 6179 206d 6174 6368 6573 0a20 2020  rray matches.   
+0002dda0: 2074 6865 2064 696d 656e 7369 6f6e 206f   the dimension o
+0002ddb0: 6620 7468 6973 2061 7272 6179 2c20 6576  f this array, ev
+0002ddc0: 656e 2069 6620 696e 7465 6765 7220 696e  en if integer in
+0002ddd0: 6469 6365 7320 6172 6520 7061 7373 6564  dices are passed
+0002dde0: 2e0a 2020 2020 536c 6963 696e 6720 7769  ..    Slicing wi
+0002ddf0: 7468 2060 606e 702e 6e65 7761 7869 7360  th ``np.newaxis`
+0002de00: 6020 6f72 206d 756c 7469 706c 6520 6c69  ` or multiple li
+0002de10: 7374 7320 6973 206e 6f74 2073 7570 706f  sts is not suppo
+0002de20: 7274 6564 2e0a 0a20 2020 2045 7861 6d70  rted...    Examp
+0002de30: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
+0002de40: 0a20 2020 203e 3e3e 2069 6d70 6f72 7420  .    >>> import 
+0002de50: 6461 736b 2e61 7272 6179 2061 7320 6461  dask.array as da
+0002de60: 0a20 2020 203e 3e3e 2066 726f 6d20 6461  .    >>> from da
+0002de70: 736b 2e61 7272 6179 2e63 6f72 6520 696d  sk.array.core im
+0002de80: 706f 7274 2042 6c6f 636b 5669 6577 0a20  port BlockView. 
+0002de90: 2020 203e 3e3e 2078 203d 2064 612e 6172     >>> x = da.ar
+0002dea0: 616e 6765 2838 2c20 6368 756e 6b73 3d32  ange(8, chunks=2
+0002deb0: 290a 2020 2020 3e3e 3e20 6276 203d 2042  ).    >>> bv = B
+0002dec0: 6c6f 636b 5669 6577 2878 290a 2020 2020  lockView(x).    
+0002ded0: 3e3e 3e20 6276 2e73 6861 7065 2023 2061  >>> bv.shape # a
+0002dee0: 6c69 6173 6573 2078 2e6e 756d 626c 6f63  liases x.numbloc
+0002def0: 6b73 0a20 2020 2028 342c 290a 2020 2020  ks.    (4,).    
+0002df00: 3e3e 3e20 6276 2e73 697a 650a 2020 2020  >>> bv.size.    
+0002df10: 340a 2020 2020 3e3e 3e20 6276 5b30 5d2e  4.    >>> bv[0].
+0002df20: 636f 6d70 7574 6528 290a 2020 2020 6172  compute().    ar
+0002df30: 7261 7928 5b30 2c20 315d 290a 2020 2020  ray([0, 1]).    
+0002df40: 3e3e 3e20 6276 5b3a 335d 2e63 6f6d 7075  >>> bv[:3].compu
+0002df50: 7465 2829 0a20 2020 2061 7272 6179 285b  te().    array([
+0002df60: 302c 2031 2c20 322c 2033 2c20 342c 2035  0, 1, 2, 3, 4, 5
+0002df70: 5d29 0a20 2020 203e 3e3e 2062 765b 3a3a  ]).    >>> bv[::
+0002df80: 325d 2e63 6f6d 7075 7465 2829 0a20 2020  2].compute().   
+0002df90: 2061 7272 6179 285b 302c 2031 2c20 342c   array([0, 1, 4,
+0002dfa0: 2035 5d29 0a20 2020 203e 3e3e 2062 765b   5]).    >>> bv[
+0002dfb0: 5b2d 312c 2030 5d5d 2e63 6f6d 7075 7465  [-1, 0]].compute
+0002dfc0: 2829 0a20 2020 2061 7272 6179 285b 362c  ().    array([6,
+0002dfd0: 2037 2c20 302c 2031 5d29 0a20 2020 203e   7, 0, 1]).    >
+0002dfe0: 3e3e 2062 762e 7261 7665 6c28 2920 2023  >> bv.ravel()  #
+0002dff0: 2064 6f63 7465 7374 3a20 2b4e 4f52 4d41   doctest: +NORMA
+0002e000: 4c49 5a45 5f57 4849 5445 5350 4143 450a  LIZE_WHITESPACE.
+0002e010: 2020 2020 5b64 6173 6b2e 6172 7261 793c      [dask.array<
+0002e020: 626c 6f63 6b73 2c20 7368 6170 653d 2832  blocks, shape=(2
+0002e030: 2c29 2c20 6474 7970 653d 696e 7436 342c  ,), dtype=int64,
+0002e040: 2063 6875 6e6b 7369 7a65 3d28 322c 292c   chunksize=(2,),
+0002e050: 2063 6875 6e6b 7479 7065 3d6e 756d 7079   chunktype=numpy
+0002e060: 2e6e 6461 7272 6179 3e2c 0a20 2020 2020  .ndarray>,.     
+0002e070: 6461 736b 2e61 7272 6179 3c62 6c6f 636b  dask.array<block
+0002e080: 732c 2073 6861 7065 3d28 322c 292c 2064  s, shape=(2,), d
+0002e090: 7479 7065 3d69 6e74 3634 2c20 6368 756e  type=int64, chun
+0002e0a0: 6b73 697a 653d 2832 2c29 2c20 6368 756e  ksize=(2,), chun
+0002e0b0: 6b74 7970 653d 6e75 6d70 792e 6e64 6172  ktype=numpy.ndar
+0002e0c0: 7261 793e 2c0a 2020 2020 2064 6173 6b2e  ray>,.     dask.
+0002e0d0: 6172 7261 793c 626c 6f63 6b73 2c20 7368  array<blocks, sh
+0002e0e0: 6170 653d 2832 2c29 2c20 6474 7970 653d  ape=(2,), dtype=
+0002e0f0: 696e 7436 342c 2063 6875 6e6b 7369 7a65  int64, chunksize
+0002e100: 3d28 322c 292c 2063 6875 6e6b 7479 7065  =(2,), chunktype
+0002e110: 3d6e 756d 7079 2e6e 6461 7272 6179 3e2c  =numpy.ndarray>,
+0002e120: 0a20 2020 2020 6461 736b 2e61 7272 6179  .     dask.array
+0002e130: 3c62 6c6f 636b 732c 2073 6861 7065 3d28  <blocks, shape=(
+0002e140: 322c 292c 2064 7479 7065 3d69 6e74 3634  2,), dtype=int64
+0002e150: 2c20 6368 756e 6b73 697a 653d 2832 2c29  , chunksize=(2,)
+0002e160: 2c20 6368 756e 6b74 7970 653d 6e75 6d70  , chunktype=nump
+0002e170: 792e 6e64 6172 7261 793e 5d0a 0a20 2020  y.ndarray>]..   
+0002e180: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
+0002e190: 2d2d 2d2d 0a20 2020 2041 6e20 696e 7374  ----.    An inst
+0002e1a0: 616e 6365 206f 6620 6060 6461 2e61 7272  ance of ``da.arr
+0002e1b0: 6179 2e42 6c6f 636b 7669 6577 6060 0a20  ay.Blockview``. 
+0002e1c0: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
+0002e1d0: 5f5f 696e 6974 5f5f 2873 656c 662c 2061  __init__(self, a
+0002e1e0: 7272 6179 3a20 4172 7261 7929 3a0a 2020  rray: Array):.  
+0002e1f0: 2020 2020 2020 7365 6c66 2e5f 6172 7261        self._arra
+0002e200: 7920 3d20 6172 7261 790a 0a20 2020 2064  y = array..    d
+0002e210: 6566 205f 5f67 6574 6974 656d 5f5f 2873  ef __getitem__(s
+0002e220: 656c 662c 2069 6e64 6578 3a20 416e 7929  elf, index: Any)
+0002e230: 202d 3e20 4172 7261 793a 0a20 2020 2020   -> Array:.     
+0002e240: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
+0002e250: 6179 2e73 6c69 6369 6e67 2069 6d70 6f72  ay.slicing impor
+0002e260: 7420 6e6f 726d 616c 697a 655f 696e 6465  t normalize_inde
+0002e270: 780a 0a20 2020 2020 2020 2069 6620 6e6f  x..        if no
+0002e280: 7420 6973 696e 7374 616e 6365 2869 6e64  t isinstance(ind
+0002e290: 6578 2c20 7475 706c 6529 3a0a 2020 2020  ex, tuple):.    
+0002e2a0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
+0002e2b0: 2869 6e64 6578 2c29 0a20 2020 2020 2020  (index,).       
+0002e2c0: 2069 6620 7375 6d28 6973 696e 7374 616e   if sum(isinstan
+0002e2d0: 6365 2869 6e64 2c20 286e 702e 6e64 6172  ce(ind, (np.ndar
+0002e2e0: 7261 792c 206c 6973 7429 2920 666f 7220  ray, list)) for 
+0002e2f0: 696e 6420 696e 2069 6e64 6578 2920 3e20  ind in index) > 
+0002e300: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
+0002e310: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0002e320: 2243 616e 206f 6e6c 7920 736c 6963 6520  "Can only slice 
+0002e330: 7769 7468 2061 2073 696e 676c 6520 6c69  with a single li
+0002e340: 7374 2229 0a20 2020 2020 2020 2069 6620  st").        if 
+0002e350: 616e 7928 696e 6420 6973 204e 6f6e 6520  any(ind is None 
+0002e360: 666f 7220 696e 6420 696e 2069 6e64 6578  for ind in index
+0002e370: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0002e380: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0002e390: 2253 6c69 6369 6e67 2077 6974 6820 6e70  "Slicing with np
+0002e3a0: 2e6e 6577 6178 6973 206f 7220 4e6f 6e65  .newaxis or None
+0002e3b0: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
+0002e3c0: 6422 290a 2020 2020 2020 2020 696e 6465  d").        inde
+0002e3d0: 7820 3d20 6e6f 726d 616c 697a 655f 696e  x = normalize_in
+0002e3e0: 6465 7828 696e 6465 782c 2073 656c 662e  dex(index, self.
+0002e3f0: 5f61 7272 6179 2e6e 756d 626c 6f63 6b73  _array.numblocks
+0002e400: 290a 2020 2020 2020 2020 696e 6465 7820  ).        index 
+0002e410: 3d20 7475 706c 6528 0a20 2020 2020 2020  = tuple(.       
+0002e420: 2020 2020 2073 6c69 6365 286b 2c20 6b20       slice(k, k 
+0002e430: 2b20 3129 2069 6620 6973 696e 7374 616e  + 1) if isinstan
+0002e440: 6365 286b 2c20 4e75 6d62 6572 2920 656c  ce(k, Number) el
+0002e450: 7365 206b 2020 2320 7479 7065 3a20 6967  se k  # type: ig
+0002e460: 6e6f 7265 0a20 2020 2020 2020 2020 2020  nore.           
+0002e470: 2066 6f72 206b 2069 6e20 696e 6465 780a   for k in index.
+0002e480: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0002e490: 2020 206e 616d 6520 3d20 2262 6c6f 636b     name = "block
+0002e4a0: 732d 2220 2b20 746f 6b65 6e69 7a65 2873  s-" + tokenize(s
+0002e4b0: 656c 662e 5f61 7272 6179 2c20 696e 6465  elf._array, inde
+0002e4c0: 7829 0a0a 2020 2020 2020 2020 6e65 775f  x)..        new_
+0002e4d0: 6b65 7973 203d 2073 656c 662e 5f61 7272  keys = self._arr
+0002e4e0: 6179 2e5f 6b65 795f 6172 7261 795b 696e  ay._key_array[in
+0002e4f0: 6465 785d 0a0a 2020 2020 2020 2020 6368  dex]..        ch
+0002e500: 756e 6b73 203d 2074 7570 6c65 280a 2020  unks = tuple(.  
+0002e510: 2020 2020 2020 2020 2020 7475 706c 6528            tuple(
+0002e520: 6e70 2e61 7272 6179 2863 295b 695d 2e74  np.array(c)[i].t
+0002e530: 6f6c 6973 7428 2929 2066 6f72 2063 2c20  olist()) for c, 
+0002e540: 6920 696e 207a 6970 2873 656c 662e 5f61  i in zip(self._a
+0002e550: 7272 6179 2e63 6875 6e6b 732c 2069 6e64  rray.chunks, ind
+0002e560: 6578 290a 2020 2020 2020 2020 290a 0a20  ex).        ).. 
+0002e570: 2020 2020 2020 206b 6579 7320 3d20 7072         keys = pr
+0002e580: 6f64 7563 7428 2a28 7261 6e67 6528 6c65  oduct(*(range(le
+0002e590: 6e28 6329 2920 666f 7220 6320 696e 2063  n(c)) for c in c
+0002e5a0: 6875 6e6b 7329 290a 0a20 2020 2020 2020  hunks))..       
+0002e5b0: 206c 6179 6572 203d 207b 286e 616d 652c   layer = {(name,
+0002e5c0: 2920 2b20 6b65 793a 2074 7570 6c65 286e  ) + key: tuple(n
+0002e5d0: 6577 5f6b 6579 735b 6b65 795d 2e74 6f6c  ew_keys[key].tol
+0002e5e0: 6973 7428 2929 2066 6f72 206b 6579 2069  ist()) for key i
+0002e5f0: 6e20 6b65 7973 7d0a 0a20 2020 2020 2020  n keys}..       
+0002e600: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+0002e610: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+0002e620: 6c65 6374 696f 6e73 286e 616d 652c 206c  lections(name, l
+0002e630: 6179 6572 2c20 6465 7065 6e64 656e 6369  ayer, dependenci
+0002e640: 6573 3d5b 7365 6c66 2e5f 6172 7261 795d  es=[self._array]
+0002e650: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0002e660: 2041 7272 6179 2867 7261 7068 2c20 6e61   Array(graph, na
+0002e670: 6d65 2c20 6368 756e 6b73 2c20 6d65 7461  me, chunks, meta
+0002e680: 3d73 656c 662e 5f61 7272 6179 290a 0a20  =self._array).. 
+0002e690: 2020 2064 6566 205f 5f65 715f 5f28 7365     def __eq__(se
+0002e6a0: 6c66 2c20 6f74 6865 723a 2041 6e79 2920  lf, other: Any) 
+0002e6b0: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+0002e6c0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
+0002e6d0: 7468 6572 2c20 426c 6f63 6b56 6965 7729  ther, BlockView)
+0002e6e0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0002e6f0: 7475 726e 2073 656c 662e 5f61 7272 6179  turn self._array
+0002e700: 2069 7320 6f74 6865 722e 5f61 7272 6179   is other._array
+0002e710: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0002e720: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0002e730: 6e20 4e6f 7449 6d70 6c65 6d65 6e74 6564  n NotImplemented
+0002e740: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0002e750: 2020 2020 6465 6620 7369 7a65 2873 656c      def size(sel
+0002e760: 6629 202d 3e20 696e 743a 0a20 2020 2020  f) -> int:.     
+0002e770: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
+0002e780: 6865 2074 6f74 616c 206e 756d 6265 7220  he total number 
+0002e790: 6f66 2062 6c6f 636b 7320 696e 2074 6865  of blocks in the
+0002e7a0: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
+0002e7b0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0002e7c0: 726e 206d 6174 682e 7072 6f64 2873 656c  rn math.prod(sel
+0002e7d0: 662e 7368 6170 6529 0a0a 2020 2020 4070  f.shape)..    @p
+0002e7e0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0002e7f0: 7368 6170 6528 7365 6c66 2920 2d3e 2074  shape(self) -> t
+0002e800: 7570 6c65 5b69 6e74 2c20 2e2e 2e5d 3a0a  uple[int, ...]:.
+0002e810: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002e820: 2020 2020 5468 6520 6e75 6d62 6572 206f      The number o
+0002e830: 6620 626c 6f63 6b73 2070 6572 2061 7869  f blocks per axi
+0002e840: 732e 2041 6c69 6173 206f 6620 6060 6461  s. Alias of ``da
+0002e850: 736b 2e61 7272 6179 2e6e 756d 626c 6f63  sk.array.numbloc
+0002e860: 6b73 6060 2e0a 2020 2020 2020 2020 2222  ks``..        ""
+0002e870: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0002e880: 2073 656c 662e 5f61 7272 6179 2e6e 756d   self._array.num
+0002e890: 626c 6f63 6b73 0a0a 2020 2020 6465 6620  blocks..    def 
+0002e8a0: 7261 7665 6c28 7365 6c66 2920 2d3e 206c  ravel(self) -> l
+0002e8b0: 6973 745b 4172 7261 795d 3a0a 2020 2020  ist[Array]:.    
+0002e8c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0002e8d0: 5265 7475 726e 2061 2066 6c61 7474 656e  Return a flatten
+0002e8e0: 6564 206c 6973 7420 6f66 2061 6c6c 2074  ed list of all t
+0002e8f0: 6865 2062 6c6f 636b 7320 696e 2074 6865  he blocks in the
+0002e900: 2061 7272 6179 2069 6e20 4320 6f72 6465   array in C orde
+0002e910: 722e 0a20 2020 2020 2020 2022 2222 0a20  r..        """. 
+0002e920: 2020 2020 2020 2072 6574 7572 6e20 5b73         return [s
+0002e930: 656c 665b 6964 785d 2066 6f72 2069 6478  elf[idx] for idx
+0002e940: 2069 6e20 6e70 2e6e 6469 6e64 6578 2873   in np.ndindex(s
+0002e950: 656c 662e 7368 6170 6529 5d0a 0a0a 6672  elf.shape)]...fr
+0002e960: 6f6d 2064 6173 6b2e 6172 7261 792e 626c  om dask.array.bl
+0002e970: 6f63 6b77 6973 6520 696d 706f 7274 2062  ockwise import b
+0002e980: 6c6f 636b 7769 7365 0a66 726f 6d20 6461  lockwise.from da
+0002e990: 736b 2e61 7272 6179 2e75 7469 6c73 2069  sk.array.utils i
+0002e9a0: 6d70 6f72 7420 636f 6d70 7574 655f 6d65  mport compute_me
+0002e9b0: 7461 2c20 6d65 7461 5f66 726f 6d5f 6172  ta, meta_from_ar
+0002e9c0: 7261 790a                                ray.
```

### Comparing `dask-2023.4.1/dask/array/creation.py` & `dask-2023.5.0/dask/array/creation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/cupy_entry_point.py` & `dask-2023.5.0/dask/array/cupy_entry_point.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/einsumfuncs.py` & `dask-2023.5.0/dask/array/einsumfuncs.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/fft.py` & `dask-2023.5.0/dask/array/fft.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/gufunc.py` & `dask-2023.5.0/dask/array/gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/image.py` & `dask-2023.5.0/dask/array/image.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/linalg.py` & `dask-2023.5.0/dask/array/linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/ma.py` & `dask-2023.5.0/dask/array/ma.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/numpy_compat.py` & `dask-2023.5.0/dask/array/numpy_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/optimization.py` & `dask-2023.5.0/dask/array/optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/overlap.py` & `dask-2023.5.0/dask/array/overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/percentile.py` & `dask-2023.5.0/dask/array/percentile.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/random.py` & `dask-2023.5.0/dask/array/random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/rechunk.py` & `dask-2023.5.0/dask/array/rechunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/reductions.py` & `dask-2023.5.0/dask/array/reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/reshape.py` & `dask-2023.5.0/dask/array/reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/routines.py` & `dask-2023.5.0/dask/array/routines.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/slicing.py` & `dask-2023.5.0/dask/array/slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/stats.py` & `dask-2023.5.0/dask/array/stats.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/svg.py` & `dask-2023.5.0/dask/array/svg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_array_core.py` & `dask-2023.5.0/dask/array/tests/test_array_core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_array_function.py` & `dask-2023.5.0/dask/array/tests/test_array_function.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_array_utils.py` & `dask-2023.5.0/dask/array/tests/test_array_utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_atop.py` & `dask-2023.5.0/dask/array/tests/test_atop.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_chunk.py` & `dask-2023.5.0/dask/array/tests/test_chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_creation.py` & `dask-2023.5.0/dask/array/tests/test_creation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_cupy_core.py` & `dask-2023.5.0/dask/array/tests/test_cupy_core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_cupy_creation.py` & `dask-2023.5.0/dask/array/tests/test_cupy_creation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_cupy_gufunc.py` & `dask-2023.5.0/dask/array/tests/test_cupy_gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_cupy_linalg.py` & `dask-2023.5.0/dask/array/tests/test_cupy_linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_cupy_overlap.py` & `dask-2023.5.0/dask/array/tests/test_cupy_overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_cupy_percentile.py` & `dask-2023.5.0/dask/array/tests/test_cupy_percentile.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_cupy_random.py` & `dask-2023.5.0/dask/array/tests/test_cupy_random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_cupy_reductions.py` & `dask-2023.5.0/dask/array/tests/test_cupy_reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_cupy_routines.py` & `dask-2023.5.0/dask/array/tests/test_cupy_routines.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_cupy_slicing.py` & `dask-2023.5.0/dask/array/tests/test_cupy_slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_cupy_sparse.py` & `dask-2023.5.0/dask/array/tests/test_cupy_sparse.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_dispatch.py` & `dask-2023.5.0/dask/array/tests/test_dispatch.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_fft.py` & `dask-2023.5.0/dask/array/tests/test_fft.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_gufunc.py` & `dask-2023.5.0/dask/array/tests/test_gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_image.py` & `dask-2023.5.0/dask/array/tests/test_image.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_linalg.py` & `dask-2023.5.0/dask/array/tests/test_linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_masked.py` & `dask-2023.5.0/dask/array/tests/test_masked.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_numpy_compat.py` & `dask-2023.5.0/dask/array/tests/test_numpy_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_optimization.py` & `dask-2023.5.0/dask/array/tests/test_optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_overlap.py` & `dask-2023.5.0/dask/array/tests/test_overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_percentiles.py` & `dask-2023.5.0/dask/array/tests/test_percentiles.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_random.py` & `dask-2023.5.0/dask/array/tests/test_random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_rechunk.py` & `dask-2023.5.0/dask/array/tests/test_rechunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_reductions.py` & `dask-2023.5.0/dask/array/tests/test_reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_reshape.py` & `dask-2023.5.0/dask/array/tests/test_reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_routines.py` & `dask-2023.5.0/dask/array/tests/test_routines.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_slicing.py` & `dask-2023.5.0/dask/array/tests/test_slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_sparse.py` & `dask-2023.5.0/dask/array/tests/test_sparse.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_stats.py` & `dask-2023.5.0/dask/array/tests/test_stats.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_svg.py` & `dask-2023.5.0/dask/array/tests/test_svg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_ufunc.py` & `dask-2023.5.0/dask/array/tests/test_ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_wrap.py` & `dask-2023.5.0/dask/array/tests/test_wrap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tests/test_xarray.py` & `dask-2023.5.0/dask/array/tests/test_xarray.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/tiledb_io.py` & `dask-2023.5.0/dask/array/tiledb_io.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/ufunc.py` & `dask-2023.5.0/dask/array/ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/utils.py` & `dask-2023.5.0/dask/array/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/array/wrap.py` & `dask-2023.5.0/dask/array/wrap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/backends.py` & `dask-2023.5.0/dask/backends.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bag/__init__.py` & `dask-2023.5.0/dask/bag/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bag/avro.py` & `dask-2023.5.0/dask/bag/avro.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bag/chunk.py` & `dask-2023.5.0/dask/bag/chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bag/core.py` & `dask-2023.5.0/dask/bag/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bag/random.py` & `dask-2023.5.0/dask/bag/random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bag/tests/test_avro.py` & `dask-2023.5.0/dask/bag/tests/test_avro.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bag/tests/test_bag.py` & `dask-2023.5.0/dask/bag/tests/test_bag.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bag/tests/test_random.py` & `dask-2023.5.0/dask/bag/tests/test_random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bag/tests/test_text.py` & `dask-2023.5.0/dask/bag/tests/test_text.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bag/text.py` & `dask-2023.5.0/dask/bag/text.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/base.py` & `dask-2023.5.0/dask/base.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/blockwise.py` & `dask-2023.5.0/dask/blockwise.py`

 * *Files 0% similar despite different names*

```diff
@@ -7,15 +7,15 @@
 from math import prod
 from typing import Any
 
 import tlz as toolz
 
 import dask
 from dask.base import clone_key, get_name_from_key, tokenize
-from dask.core import flatten, keys_in_tasks, reverse_dict
+from dask.core import flatten, ishashable, keys_in_tasks, reverse_dict
 from dask.highlevelgraph import HighLevelGraph, Layer
 from dask.optimization import SubgraphCallable, fuse
 from dask.utils import (
     _deprecated,
     apply,
     ensure_dict,
     homogeneous_deepmap,
@@ -613,17 +613,22 @@
                     for block in product(*(list(range(nbi)) for nbi in nb)):
                         assert (name, *block) in keys
 
         is_leaf = True
 
         indices = []
         for k, idxv in self.indices:
-            if idxv is not None and k in names:
+            # Note: k may not be a key and thus not be hashable in the case where
+            # one or more args of blockwise() are sequences of literals;
+            # e.g. k = (list, [0, 1, 2])
+            # See https://github.com/dask/dask/issues/8978
+            if ishashable(k) and k in names:
                 is_leaf = False
                 k = clone_key(k, seed)
+
             indices.append((k, idxv))
 
         numblocks = {}
         for k, nbv in self.numblocks.items():
             if k in names:
                 is_leaf = False
                 k = clone_key(k, seed)
```

### Comparing `dask-2023.4.1/dask/bytes/core.py` & `dask-2023.5.0/dask/bytes/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bytes/tests/test_bytes_utils.py` & `dask-2023.5.0/dask/bytes/tests/test_bytes_utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bytes/tests/test_http.py` & `dask-2023.5.0/dask/bytes/tests/test_http.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bytes/tests/test_local.py` & `dask-2023.5.0/dask/bytes/tests/test_local.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/bytes/tests/test_s3.py` & `dask-2023.5.0/dask/bytes/tests/test_s3.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/cache.py` & `dask-2023.5.0/dask/cache.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/callbacks.py` & `dask-2023.5.0/dask/callbacks.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/cli.py` & `dask-2023.5.0/dask/cli.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/config.py` & `dask-2023.5.0/dask/config.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/context.py` & `dask-2023.5.0/dask/context.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/core.py` & `dask-2023.5.0/dask/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dask-schema.yaml` & `dask-2023.5.0/dask/dask-schema.yaml`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dask.yaml` & `dask-2023.5.0/dask/dask.yaml`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/__init__.py` & `dask-2023.5.0/dask/dataframe/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/_compat.py` & `dask-2023.5.0/dask/dataframe/_compat.py`

 * *Files 4% similar despite different names*

```diff
@@ -79,15 +79,15 @@
         }
     )
     return df
 
 
 @contextlib.contextmanager
 def check_numeric_only_deprecation(name=None, show_nuisance_warning: bool = False):
-    supported_funcs = ["sum"]
+    supported_funcs = ["sum", "median", "prod", "min", "max", "var"]
     if name not in supported_funcs and PANDAS_GT_150 and not PANDAS_GT_200:
         with warnings.catch_warnings():
             warnings.filterwarnings(
                 "ignore",
                 message="The default value of numeric_only",
                 category=FutureWarning,
             )
@@ -171,14 +171,28 @@
             )
             yield
     else:
         yield
 
 
 @contextlib.contextmanager
+def check_reductions_runtime_warning():
+    if PANDAS_GT_200 and not PANDAS_GT_201:
+        with warnings.catch_warnings():
+            warnings.filterwarnings(
+                "ignore",
+                message="invalid value encountered in double_scalars|Degrees of freedom <= 0 for slice",
+                category=RuntimeWarning,
+            )
+            yield
+    else:
+        yield
+
+
+@contextlib.contextmanager
 def check_to_pydatetime_deprecation(catch_deprecation_warnings: bool):
     if PANDAS_GT_210 and catch_deprecation_warnings:
         with warnings.catch_warnings():
             warnings.filterwarnings(
                 "ignore",
                 message=".*DatetimeProperties.to_pydatetime is deprecated",
                 category=FutureWarning,
@@ -198,14 +212,28 @@
                 category=FutureWarning,
             )
             yield
     else:
         yield
 
 
+@contextlib.contextmanager
+def check_applymap_dataframe_deprecation():
+    if PANDAS_GT_210:
+        with warnings.catch_warnings():
+            warnings.filterwarnings(
+                "ignore",
+                message="DataFrame.applymap has been deprecated",
+                category=FutureWarning,
+            )
+            yield
+    else:
+        yield
+
+
 if PANDAS_GT_150:
     IndexingError = pd.errors.IndexingError
 else:
     IndexingError = pd.core.indexing.IndexingError
 
 
 def is_any_real_numeric_dtype(arr_or_dtype) -> bool:
```

### Comparing `dask-2023.4.1/dask/dataframe/_dtypes.py` & `dask-2023.5.0/dask/dataframe/_dtypes.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/_pyarrow.py` & `dask-2023.5.0/dask/dataframe/_pyarrow.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/_pyarrow_compat.py` & `dask-2023.5.0/dask/dataframe/_pyarrow_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/accessor.py` & `dask-2023.5.0/dask/dataframe/accessor.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/backends.py` & `dask-2023.5.0/dask/dataframe/backends.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/categorical.py` & `dask-2023.5.0/dask/dataframe/categorical.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/core.py` & `dask-2023.5.0/dask/dataframe/core.py`

 * *Files 1% similar despite different names*

```diff
@@ -64,18563 +64,18629 @@
 000003f0: 706f 7274 206d 6574 686f 6473 0a66 726f  port methods.fro
 00000400: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
 00000410: 2e5f 636f 6d70 6174 2069 6d70 6f72 7420  ._compat import 
 00000420: 280a 2020 2020 5041 4e44 4153 5f47 545f  (.    PANDAS_GT_
 00000430: 3134 302c 0a20 2020 2050 414e 4441 535f  140,.    PANDAS_
 00000440: 4754 5f31 3530 2c0a 2020 2020 5041 4e44  GT_150,.    PAND
 00000450: 4153 5f47 545f 3230 302c 0a20 2020 2050  AS_GT_200,.    P
-00000460: 414e 4441 535f 5645 5253 494f 4e2c 0a20  ANDAS_VERSION,. 
-00000470: 2020 2063 6865 636b 5f63 6f6e 7665 7274     check_convert
-00000480: 5f64 7479 7065 5f64 6570 7265 6361 7469  _dtype_deprecati
-00000490: 6f6e 2c0a 2020 2020 6368 6563 6b5f 6e75  on,.    check_nu
-000004a0: 6973 616e 6365 5f63 6f6c 756d 6e73 5f77  isance_columns_w
-000004b0: 6172 6e69 6e67 2c0a 2020 2020 6368 6563  arning,.    chec
-000004c0: 6b5f 6e75 6d65 7269 635f 6f6e 6c79 5f64  k_numeric_only_d
-000004d0: 6570 7265 6361 7469 6f6e 2c0a 290a 6672  eprecation,.).fr
-000004e0: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
-000004f0: 652e 6163 6365 7373 6f72 2069 6d70 6f72  e.accessor impor
-00000500: 7420 4361 6368 6564 4163 6365 7373 6f72  t CachedAccessor
-00000510: 2c20 4461 7465 7469 6d65 4163 6365 7373  , DatetimeAccess
-00000520: 6f72 2c20 5374 7269 6e67 4163 6365 7373  or, StringAccess
-00000530: 6f72 0a66 726f 6d20 6461 736b 2e64 6174  or.from dask.dat
-00000540: 6166 7261 6d65 2e63 6174 6567 6f72 6963  aframe.categoric
-00000550: 616c 2069 6d70 6f72 7420 4361 7465 676f  al import Catego
-00000560: 7269 6361 6c41 6363 6573 736f 722c 2063  ricalAccessor, c
-00000570: 6174 6567 6f72 697a 650a 6672 6f6d 2064  ategorize.from d
-00000580: 6173 6b2e 6461 7461 6672 616d 652e 6469  ask.dataframe.di
-00000590: 7370 6174 6368 2069 6d70 6f72 7420 280a  spatch import (.
-000005a0: 2020 2020 6765 745f 7061 7261 6c6c 656c      get_parallel
-000005b0: 5f74 7970 652c 0a20 2020 2067 726f 7570  _type,.    group
-000005c0: 5f73 706c 6974 5f64 6973 7061 7463 682c  _split_dispatch,
-000005d0: 0a20 2020 2068 6173 685f 6f62 6a65 6374  .    hash_object
-000005e0: 5f64 6973 7061 7463 682c 0a20 2020 206d  _dispatch,.    m
-000005f0: 6574 615f 6e6f 6e65 6d70 7479 2c0a 290a  eta_nonempty,.).
-00000600: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
-00000610: 616d 652e 6f70 7469 6d69 7a65 2069 6d70  ame.optimize imp
-00000620: 6f72 7420 6f70 7469 6d69 7a65 0a66 726f  ort optimize.fro
-00000630: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-00000640: 2e75 7469 6c73 2069 6d70 6f72 7420 280a  .utils import (.
-00000650: 2020 2020 4174 7472 6962 7574 654e 6f74      AttributeNot
-00000660: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-00000670: 2c0a 2020 2020 6368 6563 6b5f 6d61 7463  ,.    check_matc
-00000680: 6869 6e67 5f63 6f6c 756d 6e73 2c0a 2020  hing_columns,.  
-00000690: 2020 636c 6561 725f 6b6e 6f77 6e5f 6361    clear_known_ca
-000006a0: 7465 676f 7269 6573 2c0a 2020 2020 6472  tegories,.    dr
-000006b0: 6f70 5f62 795f 7368 616c 6c6f 775f 636f  op_by_shallow_co
-000006c0: 7079 2c0a 2020 2020 6861 735f 6b6e 6f77  py,.    has_know
-000006d0: 6e5f 6361 7465 676f 7269 6573 2c0a 2020  n_categories,.  
-000006e0: 2020 696e 6465 785f 7375 6d6d 6172 792c    index_summary,
-000006f0: 0a20 2020 2069 6e73 6572 745f 6d65 7461  .    insert_meta
-00000700: 5f70 6172 616d 5f64 6573 6372 6970 7469  _param_descripti
-00000710: 6f6e 2c0a 2020 2020 6973 5f64 6174 6166  on,.    is_dataf
-00000720: 7261 6d65 5f6c 696b 652c 0a20 2020 2069  rame_like,.    i
-00000730: 735f 696e 6465 785f 6c69 6b65 2c0a 2020  s_index_like,.  
-00000740: 2020 6973 5f73 6572 6965 735f 6c69 6b65    is_series_like
-00000750: 2c0a 2020 2020 6d61 6b65 5f6d 6574 612c  ,.    make_meta,
-00000760: 0a20 2020 206d 6574 615f 6672 616d 655f  .    meta_frame_
-00000770: 636f 6e73 7472 7563 746f 722c 0a20 2020  constructor,.   
-00000780: 206d 6574 615f 7365 7269 6573 5f63 6f6e   meta_series_con
-00000790: 7374 7275 6374 6f72 2c0a 2020 2020 7261  structor,.    ra
-000007a0: 6973 655f 6f6e 5f6d 6574 615f 6572 726f  ise_on_meta_erro
-000007b0: 722c 0a20 2020 2076 616c 6964 5f64 6976  r,.    valid_div
-000007c0: 6973 696f 6e73 2c0a 290a 6672 6f6d 2064  isions,.).from d
-000007d0: 6173 6b2e 6465 6c61 7965 6420 696d 706f  ask.delayed impo
-000007e0: 7274 2044 656c 6179 6564 2c20 6465 6c61  rt Delayed, dela
-000007f0: 7965 642c 2075 6e70 6163 6b5f 636f 6c6c  yed, unpack_coll
-00000800: 6563 7469 6f6e 730a 6672 6f6d 2064 6173  ections.from das
-00000810: 6b2e 6869 6768 6c65 7665 6c67 7261 7068  k.highlevelgraph
-00000820: 2069 6d70 6f72 7420 4869 6768 4c65 7665   import HighLeve
-00000830: 6c47 7261 7068 0a66 726f 6d20 6461 736b  lGraph.from dask
-00000840: 2e6c 6179 6572 7320 696d 706f 7274 2044  .layers import D
-00000850: 6174 6146 7261 6d65 5472 6565 5265 6475  ataFrameTreeRedu
-00000860: 6374 696f 6e0a 6672 6f6d 2064 6173 6b2e  ction.from dask.
-00000870: 7574 696c 7320 696d 706f 7274 2028 0a20  utils import (. 
-00000880: 2020 2049 6e64 6578 4361 6c6c 6162 6c65     IndexCallable
-00000890: 2c0a 2020 2020 4d2c 0a20 2020 204f 7065  ,.    M,.    Ope
-000008a0: 7261 746f 724d 6574 686f 644d 6978 696e  ratorMethodMixin
-000008b0: 2c0a 2020 2020 5f64 6570 7265 6361 7465  ,.    _deprecate
-000008c0: 642c 0a20 2020 2061 7070 6c79 2c0a 2020  d,.    apply,.  
-000008d0: 2020 6465 7269 7665 645f 6672 6f6d 2c0a    derived_from,.
-000008e0: 2020 2020 6675 6e63 6e61 6d65 2c0a 2020      funcname,.  
-000008f0: 2020 6861 735f 6b65 7977 6f72 642c 0a20    has_keyword,. 
-00000900: 2020 2069 735f 6172 7261 796c 696b 652c     is_arraylike,
-00000910: 0a20 2020 2069 7465 725f 6368 756e 6b73  .    iter_chunks
-00000920: 2c0a 2020 2020 6b65 795f 7370 6c69 742c  ,.    key_split,
-00000930: 0a20 2020 206d 6179 6265 5f70 6c75 7261  .    maybe_plura
-00000940: 6c69 7a65 2c0a 2020 2020 6d65 6d6f 7279  lize,.    memory
-00000950: 5f72 6570 722c 0a20 2020 2070 6172 7365  _repr,.    parse
-00000960: 5f62 7974 6573 2c0a 2020 2020 7061 7274  _bytes,.    part
-00000970: 6961 6c5f 6279 5f6f 7264 6572 2c0a 2020  ial_by_order,.  
-00000980: 2020 7073 6575 646f 7261 6e64 6f6d 2c0a    pseudorandom,.
-00000990: 2020 2020 7075 745f 6c69 6e65 732c 0a20      put_lines,. 
-000009a0: 2020 2072 616e 646f 6d5f 7374 6174 655f     random_state_
-000009b0: 6461 7461 2c0a 2020 2020 7479 7065 6e61  data,.    typena
-000009c0: 6d65 2c0a 290a 6672 6f6d 2064 6173 6b2e  me,.).from dask.
-000009d0: 7769 6467 6574 7320 696d 706f 7274 2067  widgets import g
-000009e0: 6574 5f74 656d 706c 6174 650a 0a44 4546  et_template..DEF
-000009f0: 4155 4c54 5f47 4554 203d 206e 616d 6564  AULT_GET = named
-00000a00: 5f73 6368 6564 756c 6572 732e 6765 7428  _schedulers.get(
-00000a10: 2274 6872 6561 6473 222c 206e 616d 6564  "threads", named
-00000a20: 5f73 6368 6564 756c 6572 735b 2273 796e  _schedulers["syn
-00000a30: 6322 5d29 0a0a 6e6f 5f64 6566 6175 6c74  c"])..no_default
-00000a40: 203d 2022 5f5f 6e6f 5f64 6566 6175 6c74   = "__no_default
-00000a50: 5f5f 220a 0a47 524f 5550 5f4b 4559 535f  __"..GROUP_KEYS_
-00000a60: 4445 4641 554c 543a 2062 6f6f 6c20 7c20  DEFAULT: bool | 
-00000a70: 4e6f 6e65 203d 2054 7275 650a 6966 2050  None = True.if P
-00000a80: 414e 4441 535f 4754 5f31 3530 2061 6e64  ANDAS_GT_150 and
-00000a90: 206e 6f74 2050 414e 4441 535f 4754 5f32   not PANDAS_GT_2
-00000aa0: 3030 3a0a 2020 2020 4752 4f55 505f 4b45  00:.    GROUP_KE
-00000ab0: 5953 5f44 4546 4155 4c54 203d 204e 6f6e  YS_DEFAULT = Non
-00000ac0: 650a 0a70 642e 7365 745f 6f70 7469 6f6e  e..pd.set_option
-00000ad0: 2822 636f 6d70 7574 652e 7573 655f 6e75  ("compute.use_nu
-00000ae0: 6d65 7870 7222 2c20 4661 6c73 6529 0a0a  mexpr", False)..
-00000af0: 0a64 6566 205f 6e75 6d65 7269 635f 6f6e  .def _numeric_on
-00000b00: 6c79 2866 756e 6329 3a0a 2020 2020 2222  ly(func):.    ""
-00000b10: 2244 6563 6f72 6174 6f72 2066 6f72 206d  "Decorator for m
-00000b20: 6574 686f 6473 2074 6861 7420 6163 6365  ethods that acce
-00000b30: 7074 2061 206e 756d 6572 6963 5f6f 6e6c  pt a numeric_onl
-00000b40: 7920 6b77 6172 6722 2222 0a0a 2020 2020  y kwarg"""..    
-00000b50: 4077 7261 7073 2866 756e 6329 0a20 2020  @wraps(func).   
-00000b60: 2064 6566 2077 7261 7070 6572 2873 656c   def wrapper(sel
-00000b70: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
-00000b80: 6773 293a 0a20 2020 2020 2020 2023 206e  gs):.        # n
-00000b90: 756d 6572 6963 5f6f 6e6c 7920 6973 204e  umeric_only is N
-00000ba0: 6f6e 6520 6279 2064 6566 6175 6c74 202d  one by default -
-00000bb0: 2069 6e20 7468 6174 2063 6173 6520 7365   in that case se
-00000bc0: 6c66 203d 2073 656c 662e 0a20 2020 2020  lf = self..     
-00000bd0: 2020 2069 6620 6b77 6172 6773 2e67 6574     if kwargs.get
-00000be0: 2822 6e75 6d65 7269 635f 6f6e 6c79 2229  ("numeric_only")
-00000bf0: 2069 7320 4661 6c73 653a 0a20 2020 2020   is False:.     
-00000c00: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-00000c10: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-00000c20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00000c30: 2020 2227 6e75 6d65 7269 635f 6f6e 6c79    "'numeric_only
-00000c40: 3d46 616c 7365 2720 6973 206e 6f74 2069  =False' is not i
-00000c50: 6d70 6c65 6d65 6e74 6564 2069 6e20 4461  mplemented in Da
-00000c60: 736b 2e22 0a20 2020 2020 2020 2020 2020  sk.".           
-00000c70: 2029 0a20 2020 2020 2020 2065 6c69 6620   ).        elif 
-00000c80: 6b77 6172 6773 2e67 6574 2822 6e75 6d65  kwargs.get("nume
-00000c90: 7269 635f 6f6e 6c79 2229 2069 7320 5472  ric_only") is Tr
-00000ca0: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
-00000cb0: 7365 6c66 203d 2073 656c 662e 5f67 6574  self = self._get
-00000cc0: 5f6e 756d 6572 6963 5f64 6174 6128 290a  _numeric_data().
-00000cd0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-00000ce0: 756e 6328 7365 6c66 2c20 2a61 7267 732c  unc(self, *args,
-00000cf0: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
-00000d00: 7265 7475 726e 2077 7261 7070 6572 0a0a  return wrapper..
-00000d10: 0a64 6566 205f 6e75 6d65 7269 635f 6461  .def _numeric_da
-00000d20: 7461 2866 756e 6329 3a0a 2020 2020 2222  ta(func):.    ""
-00000d30: 224d 6f64 6966 6965 6420 7665 7273 696f  "Modified versio
-00000d40: 6e20 6f66 2074 6865 2061 626f 7665 2064  n of the above d
-00000d50: 6563 6f72 6174 6f72 2c20 7269 6768 7420  ecorator, right 
-00000d60: 6e6f 7720 6f6e 6c79 2075 7365 6420 7769  now only used wi
-00000d70: 7468 2073 7464 2e20 5765 2064 6f6e 2774  th std. We don't
-00000d80: 0a20 2020 206e 6565 6420 7261 6973 696e  .    need raisin
-00000d90: 6720 4e6f 7449 6d70 6c65 6d65 6e74 6564  g NotImplemented
-00000da0: 4572 726f 7220 7468 6572 652c 2062 6563  Error there, bec
-00000db0: 6175 7365 2069 7427 7320 6861 6e64 6c65  ause it's handle
-00000dc0: 6420 6279 0a20 2020 205f 6e75 6d65 7269  d by.    _numeri
-00000dd0: 635f 6f6e 6c79 5f6d 6179 6265 5f77 6172  c_only_maybe_war
-00000de0: 6e20 696e 7374 6561 642e 2054 6869 7320  n instead. This 
-00000df0: 6973 2061 2074 656d 706f 7261 7279 2073  is a temporary s
-00000e00: 6f6c 7574 696f 6e20 7468 6174 206e 6565  olution that nee
-00000e10: 6473 0a20 2020 206d 6f72 6520 7469 6d65  ds.    more time
-00000e20: 2074 6f20 6265 2067 656e 6572 616c 697a   to be generaliz
-00000e30: 6564 2e22 2222 0a0a 2020 2020 4077 7261  ed."""..    @wra
-00000e40: 7073 2866 756e 6329 0a20 2020 2064 6566  ps(func).    def
-00000e50: 2077 7261 7070 6572 2873 656c 662c 202a   wrapper(self, *
-00000e60: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-00000e70: 0a20 2020 2020 2020 2069 6620 6b77 6172  .        if kwar
-00000e80: 6773 2e67 6574 2822 6e75 6d65 7269 635f  gs.get("numeric_
-00000e90: 6f6e 6c79 2229 2069 7320 5472 7565 3a0a  only") is True:.
-00000ea0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00000eb0: 203d 2073 656c 662e 5f67 6574 5f6e 756d   = self._get_num
-00000ec0: 6572 6963 5f64 6174 6128 290a 2020 2020  eric_data().    
-00000ed0: 2020 2020 7265 7475 726e 2066 756e 6328      return func(
-00000ee0: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
-00000ef0: 7761 7267 7329 0a0a 2020 2020 7265 7475  wargs)..    retu
-00000f00: 726e 2077 7261 7070 6572 0a0a 0a64 6566  rn wrapper...def
-00000f10: 205f 6e75 6d65 7269 635f 6f6e 6c79 5f6d   _numeric_only_m
-00000f20: 6179 6265 5f77 6172 6e28 6466 2c20 6e75  aybe_warn(df, nu
-00000f30: 6d65 7269 635f 6f6e 6c79 2c20 6465 6661  meric_only, defa
-00000f40: 756c 743d 4e6f 6e65 293a 0a20 2020 2022  ult=None):.    "
-00000f50: 2222 5570 6461 7465 206e 756d 6572 6963  ""Update numeric
-00000f60: 5f6f 6e6c 7920 746f 2067 6574 2072 6964  _only to get rid
-00000f70: 206f 6620 6e6f 5f64 6566 6175 6c74 2c20   of no_default, 
-00000f80: 616e 6420 706f 7373 6962 6c79 2077 6172  and possibly war
-00000f90: 6e20 6162 6f75 7420 6465 6661 756c 7420  n about default 
-00000fa0: 7661 6c75 652e 0a20 2020 2054 4f44 4f3a  value..    TODO:
-00000fb0: 2073 686f 756c 6420 6d6f 7665 2074 6f20   should move to 
-00000fc0: 6e75 6d65 7269 635f 6f6e 6c79 2064 6563  numeric_only dec
-00000fd0: 6f72 6174 6f72 2e20 5365 6520 6874 7470  orator. See http
-00000fe0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f64  s://github.com/d
-00000ff0: 6173 6b2f 6461 736b 2f70 756c 6c2f 3939  ask/dask/pull/99
-00001000: 3532 0a20 2020 2022 2222 0a20 2020 2069  52.    """.    i
-00001010: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
-00001020: 696b 6528 6466 293a 0a20 2020 2020 2020  ike(df):.       
-00001030: 2077 6172 6e5f 6e75 6d65 7269 635f 6f6e   warn_numeric_on
-00001040: 6c79 203d 2046 616c 7365 0a20 2020 2020  ly = False.     
-00001050: 2020 2069 6620 6e75 6d65 7269 635f 6f6e     if numeric_on
-00001060: 6c79 2069 7320 6e6f 5f64 6566 6175 6c74  ly is no_default
-00001070: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00001080: 2050 414e 4441 535f 4754 5f32 3030 3a0a   PANDAS_GT_200:.
-00001090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000010a0: 6e75 6d65 7269 635f 6f6e 6c79 203d 2046  numeric_only = F
-000010b0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-000010c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000010d0: 2020 2020 2020 2077 6172 6e5f 6e75 6d65         warn_nume
-000010e0: 7269 635f 6f6e 6c79 203d 2054 7275 650a  ric_only = True.
-000010f0: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
-00001100: 7320 3d20 6466 2e5f 6d65 7461 2e5f 6765  s = df._meta._ge
-00001110: 745f 6e75 6d65 7269 635f 6461 7461 2829  t_numeric_data()
-00001120: 0a20 2020 2020 2020 2068 6173 5f6e 6f6e  .        has_non
-00001130: 5f6e 756d 6572 6963 7320 3d20 6c65 6e28  _numerics = len(
-00001140: 6e75 6d65 7269 6373 2e63 6f6c 756d 6e73  numerics.columns
-00001150: 2920 3c20 6c65 6e28 6466 2e5f 6d65 7461  ) < len(df._meta
-00001160: 2e63 6f6c 756d 6e73 290a 2020 2020 2020  .columns).      
-00001170: 2020 6966 2068 6173 5f6e 6f6e 5f6e 756d    if has_non_num
-00001180: 6572 6963 733a 0a20 2020 2020 2020 2020  erics:.         
-00001190: 2020 2069 6620 6e75 6d65 7269 635f 6f6e     if numeric_on
-000011a0: 6c79 2069 7320 4661 6c73 653a 0a20 2020  ly is False:.   
-000011b0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-000011c0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-000011d0: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
-000011e0: 2020 2020 2020 2020 2020 2020 2227 6e75              "'nu
-000011f0: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
-00001200: 2720 6973 206e 6f74 2069 6d70 6c65 6d65  ' is not impleme
-00001210: 6e74 6564 2069 6e20 4461 736b 2e22 0a20  nted in Dask.". 
-00001220: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00001230: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00001240: 6620 7761 726e 5f6e 756d 6572 6963 5f6f  f warn_numeric_o
-00001250: 6e6c 793a 0a20 2020 2020 2020 2020 2020  nly:.           
-00001260: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00001270: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
-00001280: 2020 2020 2020 2020 2254 6865 2064 6566          "The def
-00001290: 6175 6c74 2076 616c 7565 206f 6620 6e75  ault value of nu
-000012a0: 6d65 7269 635f 6f6e 6c79 2069 6e20 6461  meric_only in da
-000012b0: 736b 2077 696c 6c20 6265 2063 6861 6e67  sk will be chang
-000012c0: 6564 2074 6f20 4661 6c73 6520 696e 2022  ed to False in "
-000012d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000012e0: 2020 2020 2022 7468 6520 6675 7475 7265       "the future
-000012f0: 2077 6865 6e20 7573 696e 6720 6461 736b   when using dask
-00001300: 2077 6974 6820 7061 6e64 6173 2032 2e30   with pandas 2.0
-00001310: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00001320: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
-00001330: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
-00001340: 2020 2020 2020 290a 2020 2020 6966 206e        ).    if n
-00001350: 756d 6572 6963 5f6f 6e6c 7920 6973 206e  umeric_only is n
-00001360: 6f5f 6465 6661 756c 7420 616e 6420 6465  o_default and de
-00001370: 6661 756c 7420 6973 206e 6f74 204e 6f6e  fault is not Non
-00001380: 653a 0a20 2020 2020 2020 206e 756d 6572  e:.        numer
-00001390: 6963 5f6f 6e6c 7920 3d20 6465 6661 756c  ic_only = defaul
-000013a0: 740a 2020 2020 7265 7475 726e 207b 7d20  t.    return {} 
-000013b0: 6966 206e 756d 6572 6963 5f6f 6e6c 7920  if numeric_only 
-000013c0: 6973 206e 6f5f 6465 6661 756c 7420 656c  is no_default el
-000013d0: 7365 207b 226e 756d 6572 6963 5f6f 6e6c  se {"numeric_onl
-000013e0: 7922 3a20 6e75 6d65 7269 635f 6f6e 6c79  y": numeric_only
-000013f0: 7d0a 0a0a 6465 6620 5f63 6f6e 6361 7428  }...def _concat(
-00001400: 6172 6773 2c20 6967 6e6f 7265 5f69 6e64  args, ignore_ind
-00001410: 6578 3d46 616c 7365 293a 0a20 2020 2069  ex=False):.    i
-00001420: 6620 6e6f 7420 6172 6773 3a0a 2020 2020  f not args:.    
-00001430: 2020 2020 7265 7475 726e 2061 7267 730a      return args.
-00001440: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00001450: 6528 6669 7273 7428 636f 7265 2e66 6c61  e(first(core.fla
-00001460: 7474 656e 2861 7267 7329 292c 206e 702e  tten(args)), np.
-00001470: 6e64 6172 7261 7929 3a0a 2020 2020 2020  ndarray):.      
-00001480: 2020 7265 7475 726e 2064 612e 636f 7265    return da.core
-00001490: 2e63 6f6e 6361 7465 6e61 7465 3328 6172  .concatenate3(ar
-000014a0: 6773 290a 2020 2020 6966 206e 6f74 2068  gs).    if not h
-000014b0: 6173 5f70 6172 616c 6c65 6c5f 7479 7065  as_parallel_type
-000014c0: 2861 7267 735b 305d 293a 0a20 2020 2020  (args[0]):.     
-000014d0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-000014e0: 2020 2020 7265 7475 726e 2070 642e 5365      return pd.Se
-000014f0: 7269 6573 2861 7267 7329 0a20 2020 2020  ries(args).     
-00001500: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-00001510: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
-00001520: 2072 6574 7572 6e20 6172 6773 0a20 2020   return args.   
-00001530: 2023 2057 6520 6669 6c74 6572 206f 7574   # We filter out
-00001540: 2065 6d70 7479 2070 6172 7469 7469 6f6e   empty partition
-00001550: 7320 6865 7265 2062 6563 6175 7365 2070  s here because p
-00001560: 616e 6461 7320 6672 6571 7565 6e74 6c79  andas frequently
-00001570: 2068 6173 0a20 2020 2023 2069 6e63 6f6e   has.    # incon
-00001580: 7369 7374 656e 7420 6474 7970 6573 2069  sistent dtypes i
-00001590: 6e20 7265 7375 6c74 7320 6265 7477 6565  n results betwee
-000015a0: 6e20 656d 7074 7920 616e 6420 6e6f 6e2d  n empty and non-
-000015b0: 656d 7074 7920 6672 616d 6573 2e0a 2020  empty frames..  
-000015c0: 2020 2320 4964 6561 6c6c 7920 7468 6973    # Ideally this
-000015d0: 2077 6f75 6c64 2062 6520 6861 6e64 6c65   would be handle
-000015e0: 6420 6c6f 6361 6c6c 7920 666f 7220 6561  d locally for ea
-000015f0: 6368 206f 7065 7261 7469 6f6e 2c20 6275  ch operation, bu
-00001600: 7420 696e 2070 7261 6374 6963 650a 2020  t in practice.  
-00001610: 2020 2320 7468 6973 2073 6565 6d73 2065    # this seems e
-00001620: 6173 6965 722e 2054 4f44 4f3a 2064 6f6e  asier. TODO: don
-00001630: 2774 2064 6f20 7468 6973 2e0a 2020 2020  't do this..    
-00001640: 6172 6773 3220 3d20 5b69 2066 6f72 2069  args2 = [i for i
-00001650: 2069 6e20 6172 6773 2069 6620 6c65 6e28   in args if len(
-00001660: 6929 5d0a 2020 2020 7265 7475 726e 2028  i)].    return (
-00001670: 0a20 2020 2020 2020 2061 7267 735b 305d  .        args[0]
-00001680: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00001690: 6172 6773 320a 2020 2020 2020 2020 656c  args2.        el
-000016a0: 7365 206d 6574 686f 6473 2e63 6f6e 6361  se methods.conca
-000016b0: 7428 6172 6773 322c 2075 6e69 666f 726d  t(args2, uniform
-000016c0: 3d54 7275 652c 2069 676e 6f72 655f 696e  =True, ignore_in
-000016d0: 6465 783d 6967 6e6f 7265 5f69 6e64 6578  dex=ignore_index
-000016e0: 290a 2020 2020 290a 0a0a 6465 6620 6669  ).    )...def fi
-000016f0: 6e61 6c69 7a65 2872 6573 756c 7473 293a  nalize(results):
-00001700: 0a20 2020 2072 6574 7572 6e20 5f63 6f6e  .    return _con
-00001710: 6361 7428 7265 7375 6c74 7329 0a0a 0a63  cat(results)...c
-00001720: 6c61 7373 2053 6361 6c61 7228 4461 736b  lass Scalar(Dask
-00001730: 4d65 7468 6f64 734d 6978 696e 2c20 4f70  MethodsMixin, Op
-00001740: 6572 6174 6f72 4d65 7468 6f64 4d69 7869  eratorMethodMixi
-00001750: 6e29 3a0a 2020 2020 2222 2241 2044 6173  n):.    """A Das
-00001760: 6b20 6f62 6a65 6374 2074 6f20 7265 7072  k object to repr
-00001770: 6573 656e 7420 6120 7061 6e64 6173 2073  esent a pandas s
-00001780: 6361 6c61 7222 2222 0a0a 2020 2020 6465  calar"""..    de
-00001790: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-000017a0: 2064 736b 2c20 6e61 6d65 2c20 6d65 7461   dsk, name, meta
-000017b0: 2c20 6469 7669 7369 6f6e 733d 4e6f 6e65  , divisions=None
-000017c0: 293a 0a20 2020 2020 2020 2023 2064 6976  ):.        # div
-000017d0: 6973 696f 6e73 2069 7320 6967 6e6f 7265  isions is ignore
-000017e0: 642c 206f 6e6c 7920 7072 6573 656e 7420  d, only present 
-000017f0: 746f 2062 6520 636f 6d70 6174 6962 6c65  to be compatible
-00001800: 2077 6974 6820 6f74 6865 720a 2020 2020   with other.    
-00001810: 2020 2020 2320 6f62 6a65 6374 732e 0a20      # objects.. 
-00001820: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-00001830: 696e 7374 616e 6365 2864 736b 2c20 4869  instance(dsk, Hi
-00001840: 6768 4c65 7665 6c47 7261 7068 293a 0a20  ghLevelGraph):. 
-00001850: 2020 2020 2020 2020 2020 2064 736b 203d             dsk =
-00001860: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-00001870: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-00001880: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
-00001890: 6e64 656e 6369 6573 3d5b 5d29 0a20 2020  ndencies=[]).   
-000018a0: 2020 2020 2073 656c 662e 6461 736b 203d       self.dask =
-000018b0: 2064 736b 0a20 2020 2020 2020 2073 656c   dsk.        sel
-000018c0: 662e 5f6e 616d 6520 3d20 6e61 6d65 0a20  f._name = name. 
-000018d0: 2020 2020 2020 2073 656c 662e 5f70 6172         self._par
-000018e0: 656e 745f 6d65 7461 203d 2070 642e 5365  ent_meta = pd.Se
-000018f0: 7269 6573 2864 7479 7065 3d22 666c 6f61  ries(dtype="floa
-00001900: 7436 3422 290a 0a20 2020 2020 2020 206d  t64")..        m
-00001910: 6574 6120 3d20 6d61 6b65 5f6d 6574 6128  eta = make_meta(
-00001920: 6d65 7461 2c20 7061 7265 6e74 5f6d 6574  meta, parent_met
-00001930: 613d 7365 6c66 2e5f 7061 7265 6e74 5f6d  a=self._parent_m
-00001940: 6574 6129 0a20 2020 2020 2020 2069 6620  eta).        if 
-00001950: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-00001960: 6528 6d65 7461 2920 6f72 2069 735f 7365  e(meta) or is_se
-00001970: 7269 6573 5f6c 696b 6528 6d65 7461 2920  ries_like(meta) 
-00001980: 6f72 2069 735f 696e 6465 785f 6c69 6b65  or is_index_like
-00001990: 286d 6574 6129 3a0a 2020 2020 2020 2020  (meta):.        
-000019a0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-000019b0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000019c0: 2020 2020 2066 2245 7870 6563 7465 6420       f"Expected 
-000019d0: 6d65 7461 2074 6f20 7370 6563 6966 7920  meta to specify 
-000019e0: 7363 616c 6172 2c20 676f 7420 7b74 7970  scalar, got {typ
-000019f0: 656e 616d 6528 7479 7065 286d 6574 6129  ename(type(meta)
-00001a00: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
-00001a10: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
-00001a20: 6d65 7461 203d 206d 6574 610a 0a20 2020  meta = meta..   
-00001a30: 2064 6566 205f 5f64 6173 6b5f 6772 6170   def __dask_grap
-00001a40: 685f 5f28 7365 6c66 293a 0a20 2020 2020  h__(self):.     
-00001a50: 2020 2072 6574 7572 6e20 7365 6c66 2e64     return self.d
-00001a60: 6173 6b0a 0a20 2020 2064 6566 205f 5f64  ask..    def __d
-00001a70: 6173 6b5f 6b65 7973 5f5f 2873 656c 6629  ask_keys__(self)
-00001a80: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00001a90: 205b 7365 6c66 2e6b 6579 5d0a 0a20 2020   [self.key]..   
-00001aa0: 2064 6566 205f 5f64 6173 6b5f 746f 6b65   def __dask_toke
-00001ab0: 6e69 7a65 5f5f 2873 656c 6629 3a0a 2020  nize__(self):.  
-00001ac0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00001ad0: 662e 5f6e 616d 650a 0a20 2020 2064 6566  f._name..    def
-00001ae0: 205f 5f64 6173 6b5f 6c61 7965 7273 5f5f   __dask_layers__
-00001af0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00001b00: 7265 7475 726e 2028 7365 6c66 2e5f 6e61  return (self._na
-00001b10: 6d65 2c29 0a0a 2020 2020 5f5f 6461 736b  me,)..    __dask
-00001b20: 5f6f 7074 696d 697a 655f 5f20 3d20 676c  _optimize__ = gl
-00001b30: 6f62 616c 6d65 7468 6f64 280a 2020 2020  obalmethod(.    
-00001b40: 2020 2020 6f70 7469 6d69 7a65 2c20 6b65      optimize, ke
-00001b50: 793d 2264 6174 6166 7261 6d65 5f6f 7074  y="dataframe_opt
-00001b60: 696d 697a 6522 2c20 6661 6c73 6579 3d64  imize", falsey=d
-00001b70: 6f6e 745f 6f70 7469 6d69 7a65 0a20 2020  ont_optimize.   
-00001b80: 2029 0a20 2020 205f 5f64 6173 6b5f 7363   ).    __dask_sc
-00001b90: 6865 6475 6c65 725f 5f20 3d20 7374 6174  heduler__ = stat
-00001ba0: 6963 6d65 7468 6f64 2844 4546 4155 4c54  icmethod(DEFAULT
-00001bb0: 5f47 4554 290a 0a20 2020 2064 6566 205f  _GET)..    def _
-00001bc0: 5f64 6173 6b5f 706f 7374 636f 6d70 7574  _dask_postcomput
-00001bd0: 655f 5f28 7365 6c66 293a 0a20 2020 2020  e__(self):.     
-00001be0: 2020 2072 6574 7572 6e20 6669 7273 742c     return first,
-00001bf0: 2028 290a 0a20 2020 2064 6566 205f 5f64   ()..    def __d
-00001c00: 6173 6b5f 706f 7374 7065 7273 6973 745f  ask_postpersist_
-00001c10: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00001c20: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
-00001c30: 6275 696c 642c 2028 290a 0a20 2020 2064  build, ()..    d
-00001c40: 6566 205f 7265 6275 696c 6428 7365 6c66  ef _rebuild(self
-00001c50: 2c20 6473 6b2c 202a 2c20 7265 6e61 6d65  , dsk, *, rename
-00001c60: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00001c70: 6e61 6d65 203d 2073 656c 662e 5f6e 616d  name = self._nam
-00001c80: 650a 2020 2020 2020 2020 6966 2072 656e  e.        if ren
-00001c90: 616d 653a 0a20 2020 2020 2020 2020 2020  ame:.           
-00001ca0: 206e 616d 6520 3d20 7265 6e61 6d65 2e67   name = rename.g
-00001cb0: 6574 286e 616d 652c 206e 616d 6529 0a20  et(name, name). 
-00001cc0: 2020 2020 2020 2072 6574 7572 6e20 5363         return Sc
-00001cd0: 616c 6172 2864 736b 2c20 6e61 6d65 2c20  alar(dsk, name, 
-00001ce0: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
-00001cf0: 2e64 6976 6973 696f 6e73 290a 0a20 2020  .divisions)..   
-00001d00: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00001d10: 6566 205f 6d65 7461 5f6e 6f6e 656d 7074  ef _meta_nonempt
-00001d20: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
-00001d30: 2072 6574 7572 6e20 7365 6c66 2e5f 6d65   return self._me
-00001d40: 7461 0a0a 2020 2020 4070 726f 7065 7274  ta..    @propert
-00001d50: 790a 2020 2020 6465 6620 6474 7970 6528  y.    def dtype(
-00001d60: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00001d70: 6574 7572 6e20 7365 6c66 2e5f 6d65 7461  eturn self._meta
-00001d80: 2e64 7479 7065 0a0a 2020 2020 6465 6620  .dtype..    def 
-00001d90: 5f5f 6469 725f 5f28 7365 6c66 293a 0a20  __dir__(self):. 
-00001da0: 2020 2020 2020 206f 203d 2073 6574 2864         o = set(d
-00001db0: 6972 2874 7970 6528 7365 6c66 2929 290a  ir(type(self))).
-00001dc0: 2020 2020 2020 2020 6f2e 7570 6461 7465          o.update
-00001dd0: 2873 656c 662e 5f5f 6469 6374 5f5f 290a  (self.__dict__).
-00001de0: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
-00001df0: 6173 6174 7472 2873 656c 662e 5f6d 6574  asattr(self._met
-00001e00: 612c 2022 6474 7970 6522 293a 0a20 2020  a, "dtype"):.   
-00001e10: 2020 2020 2020 2020 206f 2e72 656d 6f76           o.remov
-00001e20: 6528 2264 7479 7065 2229 2020 2320 6474  e("dtype")  # dt
-00001e30: 7970 6520 6f6e 6c79 2069 6e20 6064 6972  ype only in `dir
-00001e40: 6020 6966 2061 7661 696c 6162 6c65 0a20  ` if available. 
-00001e50: 2020 2020 2020 2072 6574 7572 6e20 6c69         return li
-00001e60: 7374 286f 290a 0a20 2020 2040 7072 6f70  st(o)..    @prop
-00001e70: 6572 7479 0a20 2020 2064 6566 2064 6976  erty.    def div
-00001e80: 6973 696f 6e73 2873 656c 6629 3a0a 2020  isions(self):.  
-00001e90: 2020 2020 2020 2222 2244 756d 6d79 2064        """Dummy d
-00001ea0: 6976 6973 696f 6e73 2074 6f20 6265 2063  ivisions to be c
-00001eb0: 6f6d 7061 7420 7769 7468 2053 6572 6965  ompat with Serie
-00001ec0: 7320 616e 6420 4461 7461 4672 616d 6522  s and DataFrame"
-00001ed0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00001ee0: 6e20 284e 6f6e 652c 204e 6f6e 6529 0a0a  n (None, None)..
-00001ef0: 2020 2020 6465 6620 5f5f 7265 7072 5f5f      def __repr__
-00001f00: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00001f10: 6e61 6d65 203d 2073 656c 662e 5f6e 616d  name = self._nam
-00001f20: 6520 6966 206c 656e 2873 656c 662e 5f6e  e if len(self._n
-00001f30: 616d 6529 203c 2031 3020 656c 7365 2073  ame) < 10 else s
-00001f40: 656c 662e 5f6e 616d 655b 3a37 5d20 2b20  elf._name[:7] + 
-00001f50: 222e 2e2e 220a 2020 2020 2020 2020 6966  "...".        if
-00001f60: 2068 6173 6174 7472 2873 656c 662e 5f6d   hasattr(self._m
-00001f70: 6574 612c 2022 6474 7970 6522 293a 0a20  eta, "dtype"):. 
-00001f80: 2020 2020 2020 2020 2020 2065 7874 7261             extra
-00001f90: 203d 2022 2c20 6474 7970 653d 2573 2220   = ", dtype=%s" 
-00001fa0: 2520 7365 6c66 2e5f 6d65 7461 2e64 7479  % self._meta.dty
-00001fb0: 7065 0a20 2020 2020 2020 2065 6c73 653a  pe.        else:
-00001fc0: 0a20 2020 2020 2020 2020 2020 2065 7874  .            ext
-00001fd0: 7261 203d 2022 2c20 7479 7065 3d25 7322  ra = ", type=%s"
-00001fe0: 2025 2074 7970 6528 7365 6c66 2e5f 6d65   % type(self._me
-00001ff0: 7461 292e 5f5f 6e61 6d65 5f5f 0a20 2020  ta).__name__.   
-00002000: 2020 2020 2072 6574 7572 6e20 6622 6464       return f"dd
-00002010: 2e53 6361 6c61 723c 7b6e 616d 657d 7b65  .Scalar<{name}{e
-00002020: 7874 7261 7d3e 220a 0a20 2020 2064 6566  xtra}>"..    def
-00002030: 205f 5f61 7272 6179 5f5f 2873 656c 6629   __array__(self)
-00002040: 3a0a 2020 2020 2020 2020 2320 6172 7261  :.        # arra
-00002050: 7920 696e 7465 7266 6163 6520 6973 2072  y interface is r
-00002060: 6571 7569 7265 6420 746f 2073 7570 706f  equired to suppo
-00002070: 7274 2070 616e 6461 7320 696e 7374 616e  rt pandas instan
-00002080: 6365 202b 2053 6361 6c61 720a 2020 2020  ce + Scalar.    
-00002090: 2020 2020 2320 4f74 6865 7277 6973 652c      # Otherwise,
-000020a0: 2061 626f 7665 206f 7020 7265 7375 6c74   above op result
-000020b0: 7320 696e 2070 642e 5365 7269 6573 206f  s in pd.Series o
-000020c0: 6620 5363 616c 6172 2028 6f62 6a65 6374  f Scalar (object
-000020d0: 2064 7479 7065 290a 2020 2020 2020 2020   dtype).        
-000020e0: 7265 7475 726e 206e 702e 6173 6172 7261  return np.asarra
-000020f0: 7928 7365 6c66 2e63 6f6d 7075 7465 2829  y(self.compute()
-00002100: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-00002110: 0a20 2020 2064 6566 205f 6172 6773 2873  .    def _args(s
-00002120: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00002130: 7475 726e 2028 7365 6c66 2e64 6173 6b2c  turn (self.dask,
-00002140: 2073 656c 662e 5f6e 616d 652c 2073 656c   self._name, sel
-00002150: 662e 5f6d 6574 6129 0a0a 2020 2020 6465  f._meta)..    de
-00002160: 6620 5f5f 6765 7473 7461 7465 5f5f 2873  f __getstate__(s
-00002170: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00002180: 7475 726e 2073 656c 662e 5f61 7267 730a  turn self._args.
-00002190: 0a20 2020 2064 6566 205f 5f73 6574 7374  .    def __setst
-000021a0: 6174 655f 5f28 7365 6c66 2c20 7374 6174  ate__(self, stat
-000021b0: 6529 3a0a 2020 2020 2020 2020 7365 6c66  e):.        self
-000021c0: 2e64 6173 6b2c 2073 656c 662e 5f6e 616d  .dask, self._nam
-000021d0: 652c 2073 656c 662e 5f6d 6574 6120 3d20  e, self._meta = 
-000021e0: 7374 6174 650a 0a20 2020 2064 6566 205f  state..    def _
-000021f0: 5f62 6f6f 6c5f 5f28 7365 6c66 293a 0a20  _bool__(self):. 
-00002200: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00002210: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00002220: 2020 2020 6622 5472 7969 6e67 2074 6f20      f"Trying to 
-00002230: 636f 6e76 6572 7420 7b73 656c 667d 2074  convert {self} t
-00002240: 6f20 6120 626f 6f6c 6561 6e20 7661 6c75  o a boolean valu
-00002250: 652e 2042 6563 6175 7365 2044 6173 6b20  e. Because Dask 
-00002260: 6f62 6a65 6374 7320 6172 6520 220a 2020  objects are ".  
-00002270: 2020 2020 2020 2020 2020 226c 617a 696c            "lazil
-00002280: 7920 6576 616c 7561 7465 642c 2074 6865  y evaluated, the
-00002290: 7920 6361 6e6e 6f74 2062 6520 636f 6e76  y cannot be conv
-000022a0: 6572 7465 6420 746f 2061 2062 6f6f 6c65  erted to a boole
-000022b0: 616e 2076 616c 7565 206f 7220 7573 6564  an value or used
-000022c0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
-000022d0: 696e 2062 6f6f 6c65 616e 2063 6f6e 6469  in boolean condi
-000022e0: 7469 6f6e 7320 6c69 6b65 2069 6620 7374  tions like if st
-000022f0: 6174 656d 656e 7473 2e20 5472 7920 6361  atements. Try ca
-00002300: 6c6c 696e 6720 2e63 6f6d 7075 7465 2829  lling .compute()
-00002310: 2074 6f20 220a 2020 2020 2020 2020 2020   to ".          
-00002320: 2020 2266 6f72 6365 2063 6f6d 7075 7461    "force computa
-00002330: 7469 6f6e 2070 7269 6f72 2074 6f20 636f  tion prior to co
-00002340: 6e76 6572 7469 6e67 2074 6f20 6120 626f  nverting to a bo
-00002350: 6f6c 6561 6e20 7661 6c75 6520 6f72 2075  olean value or u
-00002360: 7369 6e67 2069 6e20 220a 2020 2020 2020  sing in ".      
-00002370: 2020 2020 2020 2261 2063 6f6e 6469 7469        "a conditi
-00002380: 6f6e 616c 2073 7461 7465 6d65 6e74 2e22  onal statement."
-00002390: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000023a0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-000023b0: 6620 6b65 7928 7365 6c66 293a 0a20 2020  f key(self):.   
-000023c0: 2020 2020 2072 6574 7572 6e20 2873 656c       return (sel
-000023d0: 662e 5f6e 616d 652c 2030 290a 0a20 2020  f._name, 0)..   
-000023e0: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
-000023f0: 2020 6465 6620 5f67 6574 5f75 6e61 7279    def _get_unary
-00002400: 5f6f 7065 7261 746f 7228 636c 732c 206f  _operator(cls, o
-00002410: 7029 3a0a 2020 2020 2020 2020 6465 6620  p):.        def 
-00002420: 6628 7365 6c66 293a 0a20 2020 2020 2020  f(self):.       
-00002430: 2020 2020 206e 616d 6520 3d20 6675 6e63       name = func
-00002440: 6e61 6d65 286f 7029 202b 2022 2d22 202b  name(op) + "-" +
-00002450: 2074 6f6b 656e 697a 6528 7365 6c66 290a   tokenize(self).
-00002460: 2020 2020 2020 2020 2020 2020 6473 6b20              dsk 
-00002470: 3d20 7b28 6e61 6d65 2c20 3029 3a20 286f  = {(name, 0): (o
-00002480: 702c 2028 7365 6c66 2e5f 6e61 6d65 2c20  p, (self._name, 
-00002490: 3029 297d 0a20 2020 2020 2020 2020 2020  0))}.           
-000024a0: 206d 6574 6120 3d20 6f70 2873 656c 662e   meta = op(self.
-000024b0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 290a  _meta_nonempty).
-000024c0: 2020 2020 2020 2020 2020 2020 6772 6170              grap
-000024d0: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
-000024e0: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
-000024f0: 6f6e 7328 6e61 6d65 2c20 6473 6b2c 2064  ons(name, dsk, d
-00002500: 6570 656e 6465 6e63 6965 733d 5b73 656c  ependencies=[sel
-00002510: 665d 290a 2020 2020 2020 2020 2020 2020  f]).            
-00002520: 7265 7475 726e 2053 6361 6c61 7228 6772  return Scalar(gr
-00002530: 6170 682c 206e 616d 652c 206d 6574 6129  aph, name, meta)
-00002540: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00002550: 2066 0a0a 2020 2020 4063 6c61 7373 6d65   f..    @classme
-00002560: 7468 6f64 0a20 2020 2064 6566 205f 6765  thod.    def _ge
-00002570: 745f 6269 6e61 7279 5f6f 7065 7261 746f  t_binary_operato
-00002580: 7228 636c 732c 206f 702c 2069 6e76 3d46  r(cls, op, inv=F
-00002590: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
-000025a0: 6574 7572 6e20 6c61 6d62 6461 2073 656c  eturn lambda sel
-000025b0: 662c 206f 7468 6572 3a20 5f73 6361 6c61  f, other: _scala
-000025c0: 725f 6269 6e61 7279 286f 702c 2073 656c  r_binary(op, sel
-000025d0: 662c 206f 7468 6572 2c20 696e 763d 696e  f, other, inv=in
-000025e0: 7629 0a0a 2020 2020 6465 6620 746f 5f64  v)..    def to_d
-000025f0: 656c 6179 6564 2873 656c 662c 206f 7074  elayed(self, opt
-00002600: 696d 697a 655f 6772 6170 683d 5472 7565  imize_graph=True
-00002610: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
-00002620: 6e76 6572 7420 696e 746f 2061 2060 6064  nvert into a ``d
-00002630: 6173 6b2e 6465 6c61 7965 6460 6020 6f62  ask.delayed`` ob
-00002640: 6a65 6374 2e0a 0a20 2020 2020 2020 2050  ject...        P
-00002650: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00002660: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00002670: 2020 2020 206f 7074 696d 697a 655f 6772       optimize_gr
-00002680: 6170 6820 3a20 626f 6f6c 2c20 6f70 7469  aph : bool, opti
-00002690: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-000026a0: 2049 6620 5472 7565 205b 6465 6661 756c   If True [defaul
-000026b0: 745d 2c20 7468 6520 6772 6170 6820 6973  t], the graph is
-000026c0: 206f 7074 696d 697a 6564 2062 6566 6f72   optimized befor
-000026d0: 6520 636f 6e76 6572 7469 6e67 2069 6e74  e converting int
-000026e0: 6f0a 2020 2020 2020 2020 2020 2020 6060  o.            ``
-000026f0: 6461 736b 2e64 656c 6179 6564 6060 206f  dask.delayed`` o
-00002700: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
-00002710: 2222 220a 2020 2020 2020 2020 6473 6b20  """.        dsk 
-00002720: 3d20 7365 6c66 2e5f 5f64 6173 6b5f 6772  = self.__dask_gr
-00002730: 6170 685f 5f28 290a 2020 2020 2020 2020  aph__().        
-00002740: 6c61 7965 7220 3d20 7365 6c66 2e5f 5f64  layer = self.__d
-00002750: 6173 6b5f 6c61 7965 7273 5f5f 2829 5b30  ask_layers__()[0
-00002760: 5d0a 2020 2020 2020 2020 6966 206f 7074  ].        if opt
-00002770: 696d 697a 655f 6772 6170 683a 0a20 2020  imize_graph:.   
-00002780: 2020 2020 2020 2020 2064 736b 203d 2073           dsk = s
-00002790: 656c 662e 5f5f 6461 736b 5f6f 7074 696d  elf.__dask_optim
-000027a0: 697a 655f 5f28 6473 6b2c 2073 656c 662e  ize__(dsk, self.
-000027b0: 5f5f 6461 736b 5f6b 6579 735f 5f28 2929  __dask_keys__())
-000027c0: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
-000027d0: 6572 203d 2022 6465 6c61 7965 642d 2220  er = "delayed-" 
-000027e0: 2b20 7365 6c66 2e5f 6e61 6d65 0a20 2020  + self._name.   
-000027f0: 2020 2020 2020 2020 2064 736b 203d 2048           dsk = H
-00002800: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-00002810: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286c  om_collections(l
-00002820: 6179 6572 2c20 6473 6b2c 2064 6570 656e  ayer, dsk, depen
-00002830: 6465 6e63 6965 733d 2829 290a 2020 2020  dencies=()).    
-00002840: 2020 2020 7265 7475 726e 2044 656c 6179      return Delay
-00002850: 6564 2873 656c 662e 6b65 792c 2064 736b  ed(self.key, dsk
-00002860: 2c20 6c61 7965 723d 6c61 7965 7229 0a0a  , layer=layer)..
-00002870: 0a64 6566 205f 7363 616c 6172 5f62 696e  .def _scalar_bin
-00002880: 6172 7928 6f70 2c20 7365 6c66 2c20 6f74  ary(op, self, ot
-00002890: 6865 722c 2069 6e76 3d46 616c 7365 293a  her, inv=False):
-000028a0: 0a20 2020 206e 616d 6520 3d20 6622 7b66  .    name = f"{f
-000028b0: 756e 636e 616d 6528 6f70 297d 2d7b 746f  uncname(op)}-{to
-000028c0: 6b65 6e69 7a65 2873 656c 662c 206f 7468  kenize(self, oth
-000028d0: 6572 297d 220a 2020 2020 6465 7065 6e64  er)}".    depend
-000028e0: 656e 6369 6573 203d 205b 7365 6c66 5d0a  encies = [self].
-000028f0: 0a20 2020 2064 736b 203d 207b 7d0a 2020  .    dsk = {}.  
-00002900: 2020 7265 7475 726e 5f74 7970 6520 3d20    return_type = 
-00002910: 6765 745f 7061 7261 6c6c 656c 5f74 7970  get_parallel_typ
-00002920: 6528 6f74 6865 7229 0a0a 2020 2020 6966  e(other)..    if
-00002930: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
-00002940: 722c 2053 6361 6c61 7229 3a0a 2020 2020  r, Scalar):.    
-00002950: 2020 2020 6465 7065 6e64 656e 6369 6573      dependencies
-00002960: 2e61 7070 656e 6428 6f74 6865 7229 0a20  .append(other). 
-00002970: 2020 2020 2020 206f 7468 6572 5f6b 6579         other_key
-00002980: 203d 2028 6f74 6865 722e 5f6e 616d 652c   = (other._name,
-00002990: 2030 290a 2020 2020 656c 6966 2069 735f   0).    elif is_
-000029a0: 6461 736b 5f63 6f6c 6c65 6374 696f 6e28  dask_collection(
-000029b0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-000029c0: 7265 7475 726e 204e 6f74 496d 706c 656d  return NotImplem
-000029d0: 656e 7465 640a 2020 2020 656c 7365 3a0a  ented.    else:.
-000029e0: 2020 2020 2020 2020 6f74 6865 725f 6b65          other_ke
-000029f0: 7920 3d20 6f74 6865 720a 0a20 2020 2064  y = other..    d
-00002a00: 736b 5b28 6e61 6d65 2c20 3029 5d20 3d20  sk[(name, 0)] = 
-00002a10: 280a 2020 2020 2020 2020 286f 702c 206f  (.        (op, o
-00002a20: 7468 6572 5f6b 6579 2c20 2873 656c 662e  ther_key, (self.
-00002a30: 5f6e 616d 652c 2030 2929 2069 6620 696e  _name, 0)) if in
-00002a40: 7620 656c 7365 2028 6f70 2c20 2873 656c  v else (op, (sel
-00002a50: 662e 5f6e 616d 652c 2030 292c 206f 7468  f._name, 0), oth
-00002a60: 6572 5f6b 6579 290a 2020 2020 290a 0a20  er_key).    ).. 
-00002a70: 2020 206f 7468 6572 5f6d 6574 6120 3d20     other_meta = 
-00002a80: 6d61 6b65 5f6d 6574 6128 6f74 6865 722c  make_meta(other,
-00002a90: 2070 6172 656e 745f 6d65 7461 3d73 656c   parent_meta=sel
-00002aa0: 662e 5f70 6172 656e 745f 6d65 7461 290a  f._parent_meta).
-00002ab0: 2020 2020 6f74 6865 725f 6d65 7461 5f6e      other_meta_n
-00002ac0: 6f6e 656d 7074 7920 3d20 6d65 7461 5f6e  onempty = meta_n
-00002ad0: 6f6e 656d 7074 7928 6f74 6865 725f 6d65  onempty(other_me
-00002ae0: 7461 290a 2020 2020 6966 2069 6e76 3a0a  ta).    if inv:.
-00002af0: 2020 2020 2020 2020 6d65 7461 203d 206f          meta = o
-00002b00: 7028 6f74 6865 725f 6d65 7461 5f6e 6f6e  p(other_meta_non
-00002b10: 656d 7074 792c 2073 656c 662e 5f6d 6574  empty, self._met
-00002b20: 615f 6e6f 6e65 6d70 7479 290a 2020 2020  a_nonempty).    
-00002b30: 656c 7365 3a0a 2020 2020 2020 2020 6d65  else:.        me
-00002b40: 7461 203d 206f 7028 7365 6c66 2e5f 6d65  ta = op(self._me
-00002b50: 7461 5f6e 6f6e 656d 7074 792c 206f 7468  ta_nonempty, oth
-00002b60: 6572 5f6d 6574 615f 6e6f 6e65 6d70 7479  er_meta_nonempty
-00002b70: 290a 0a20 2020 2067 7261 7068 203d 2048  )..    graph = H
-00002b80: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-00002b90: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
-00002ba0: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
-00002bb0: 656e 6369 6573 3d64 6570 656e 6465 6e63  encies=dependenc
-00002bc0: 6965 7329 0a20 2020 2069 6620 7265 7475  ies).    if retu
-00002bd0: 726e 5f74 7970 6520 6973 206e 6f74 2053  rn_type is not S
-00002be0: 6361 6c61 723a 0a20 2020 2020 2020 2072  calar:.        r
-00002bf0: 6574 7572 6e20 7265 7475 726e 5f74 7970  eturn return_typ
-00002c00: 6528 6772 6170 682c 206e 616d 652c 206d  e(graph, name, m
-00002c10: 6574 612c 205b 6f74 6865 722e 696e 6465  eta, [other.inde
-00002c20: 782e 6d69 6e28 292c 206f 7468 6572 2e69  x.min(), other.i
-00002c30: 6e64 6578 2e6d 6178 2829 5d29 0a20 2020  ndex.max()]).   
-00002c40: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
-00002c50: 6574 7572 6e20 5363 616c 6172 2867 7261  eturn Scalar(gra
-00002c60: 7068 2c20 6e61 6d65 2c20 6d65 7461 290a  ph, name, meta).
-00002c70: 0a0a 636c 6173 7320 5f46 7261 6d65 2844  ..class _Frame(D
-00002c80: 6173 6b4d 6574 686f 6473 4d69 7869 6e2c  askMethodsMixin,
-00002c90: 204f 7065 7261 746f 724d 6574 686f 644d   OperatorMethodM
-00002ca0: 6978 696e 293a 0a20 2020 2022 2222 5375  ixin):.    """Su
-00002cb0: 7065 7263 6c61 7373 2066 6f72 2044 6174  perclass for Dat
-00002cc0: 6146 7261 6d65 2061 6e64 2053 6572 6965  aFrame and Serie
-00002cd0: 730a 0a20 2020 2050 6172 616d 6574 6572  s..    Parameter
-00002ce0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00002cf0: 0a20 2020 2064 736b 3a20 6469 6374 0a20  .    dsk: dict. 
-00002d00: 2020 2020 2020 2054 6865 2064 6173 6b20         The dask 
-00002d10: 6772 6170 6820 746f 2063 6f6d 7075 7465  graph to compute
-00002d20: 2074 6869 7320 4461 7461 4672 616d 650a   this DataFrame.
-00002d30: 2020 2020 6e61 6d65 3a20 7374 720a 2020      name: str.  
-00002d40: 2020 2020 2020 5468 6520 6b65 7920 7072        The key pr
-00002d50: 6566 6978 2074 6861 7420 7370 6563 6966  efix that specif
-00002d60: 6965 7320 7768 6963 6820 6b65 7973 2069  ies which keys i
-00002d70: 6e20 7468 6520 6461 736b 2063 6f6d 7072  n the dask compr
-00002d80: 6973 6520 7468 6973 0a20 2020 2020 2020  ise this.       
-00002d90: 2070 6172 7469 6375 6c61 7220 4461 7461   particular Data
-00002da0: 4672 616d 6520 2f20 5365 7269 6573 0a20  Frame / Series. 
-00002db0: 2020 206d 6574 613a 2070 616e 6461 732e     meta: pandas.
-00002dc0: 4461 7461 4672 616d 652c 2070 616e 6461  DataFrame, panda
-00002dd0: 732e 5365 7269 6573 2c20 6f72 2070 616e  s.Series, or pan
-00002de0: 6461 732e 496e 6465 780a 2020 2020 2020  das.Index.      
-00002df0: 2020 416e 2065 6d70 7479 2070 616e 6461    An empty panda
-00002e00: 7320 6f62 6a65 6374 2077 6974 6820 6e61  s object with na
-00002e10: 6d65 732c 2064 7479 7065 732c 2061 6e64  mes, dtypes, and
-00002e20: 2069 6e64 6963 6573 206d 6174 6368 696e   indices matchin
-00002e30: 6720 7468 650a 2020 2020 2020 2020 6578  g the.        ex
-00002e40: 7065 6374 6564 206f 7574 7075 742e 0a20  pected output.. 
-00002e50: 2020 2064 6976 6973 696f 6e73 3a20 7475     divisions: tu
-00002e60: 706c 6520 6f66 2069 6e64 6578 2076 616c  ple of index val
-00002e70: 7565 730a 2020 2020 2020 2020 5661 6c75  ues.        Valu
-00002e80: 6573 2061 6c6f 6e67 2077 6869 6368 2077  es along which w
-00002e90: 6520 7061 7274 6974 696f 6e20 6f75 7220  e partition our 
-00002ea0: 626c 6f63 6b73 206f 6e20 7468 6520 696e  blocks on the in
-00002eb0: 6465 780a 2020 2020 2222 220a 0a20 2020  dex.    """..   
-00002ec0: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-00002ed0: 6c66 2c20 6473 6b2c 206e 616d 652c 206d  lf, dsk, name, m
-00002ee0: 6574 612c 2064 6976 6973 696f 6e73 293a  eta, divisions):
-00002ef0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00002f00: 6973 696e 7374 616e 6365 2864 736b 2c20  isinstance(dsk, 
-00002f10: 4869 6768 4c65 7665 6c47 7261 7068 293a  HighLevelGraph):
-00002f20: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
-00002f30: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
-00002f40: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
-00002f50: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
-00002f60: 7065 6e64 656e 6369 6573 3d5b 5d29 0a20  pendencies=[]). 
-00002f70: 2020 2020 2020 2073 656c 662e 6461 736b         self.dask
-00002f80: 203d 2064 736b 0a20 2020 2020 2020 2073   = dsk.        s
-00002f90: 656c 662e 5f6e 616d 6520 3d20 6e61 6d65  elf._name = name
-00002fa0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
-00002fb0: 6d61 6b65 5f6d 6574 6128 6d65 7461 290a  make_meta(meta).
-00002fc0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00002fd0: 656c 662e 5f69 735f 7061 7274 6974 696f  elf._is_partitio
-00002fe0: 6e5f 7479 7065 286d 6574 6129 3a0a 2020  n_type(meta):.  
-00002ff0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00003000: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
-00003010: 2020 2020 2020 2020 2020 2066 2245 7870             f"Exp
-00003020: 6563 7465 6420 6d65 7461 2074 6f20 7370  ected meta to sp
-00003030: 6563 6966 7920 7479 7065 207b 7479 7065  ecify type {type
-00003040: 2873 656c 6629 2e5f 5f6e 616d 655f 5f7d  (self).__name__}
-00003050: 2c20 676f 7420 7479 7065 2022 0a20 2020  , got type ".   
-00003060: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-00003070: 7479 7065 6e61 6d65 2874 7970 6528 6d65  typename(type(me
-00003080: 7461 2929 7d22 0a20 2020 2020 2020 2020  ta))}".         
-00003090: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-000030a0: 662e 5f6d 6574 6120 3d20 6d65 7461 0a20  f._meta = meta. 
-000030b0: 2020 2020 2020 2073 656c 662e 6469 7669         self.divi
-000030c0: 7369 6f6e 7320 3d20 7475 706c 6528 6469  sions = tuple(di
-000030d0: 7669 7369 6f6e 7329 0a0a 2020 2020 2020  visions)..      
-000030e0: 2020 2320 4f70 7469 6f6e 616c 6c79 2063    # Optionally c
-000030f0: 6173 7420 6f62 6a65 6374 2064 7479 7065  ast object dtype
-00003100: 7320 746f 2060 7079 6172 726f 7760 2073  s to `pyarrow` s
-00003110: 7472 696e 6773 0a20 2020 2020 2020 2069  trings.        i
-00003120: 6620 6461 736b 2e63 6f6e 6669 672e 6765  f dask.config.ge
-00003130: 7428 2264 6174 6166 7261 6d65 2e63 6f6e  t("dataframe.con
-00003140: 7665 7274 2d73 7472 696e 6722 293a 0a20  vert-string"):. 
-00003150: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-00003160: 6461 736b 2e64 6174 6166 7261 6d65 2e5f  dask.dataframe._
-00003170: 7079 6172 726f 7720 696d 706f 7274 2063  pyarrow import c
-00003180: 6865 636b 5f70 7961 7272 6f77 5f73 7472  heck_pyarrow_str
-00003190: 696e 675f 7375 7070 6f72 7465 640a 0a20  ing_supported.. 
-000031a0: 2020 2020 2020 2020 2020 2063 6865 636b             check
-000031b0: 5f70 7961 7272 6f77 5f73 7472 696e 675f  _pyarrow_string_
-000031c0: 7375 7070 6f72 7465 6428 290a 0a20 2020  supported()..   
-000031d0: 2020 2020 2020 2020 2066 726f 6d20 6461           from da
-000031e0: 736b 2e64 6174 6166 7261 6d65 2e5f 7079  sk.dataframe._py
-000031f0: 6172 726f 7720 696d 706f 7274 2028 0a20  arrow import (. 
-00003200: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00003210: 735f 6f62 6a65 6374 5f73 7472 696e 675f  s_object_string_
-00003220: 6461 7461 6672 616d 652c 0a20 2020 2020  dataframe,.     
-00003230: 2020 2020 2020 2020 2020 2069 735f 6f62             is_ob
-00003240: 6a65 6374 5f73 7472 696e 675f 6474 7970  ject_string_dtyp
-00003250: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00003260: 2020 2069 735f 6f62 6a65 6374 5f73 7472     is_object_str
-00003270: 696e 675f 696e 6465 782c 0a20 2020 2020  ing_index,.     
-00003280: 2020 2020 2020 2020 2020 2069 735f 6f62             is_ob
-00003290: 6a65 6374 5f73 7472 696e 675f 7365 7269  ject_string_seri
-000032a0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-000032b0: 2020 2020 746f 5f70 7961 7272 6f77 5f73      to_pyarrow_s
-000032c0: 7472 696e 672c 0a20 2020 2020 2020 2020  tring,.         
-000032d0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-000032e0: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
-000032f0: 2020 2020 2020 2069 735f 6f62 6a65 6374         is_object
-00003300: 5f73 7472 696e 675f 6461 7461 6672 616d  _string_datafram
-00003310: 6528 6d65 7461 290a 2020 2020 2020 2020  e(meta).        
-00003320: 2020 2020 2020 2020 6f72 2069 735f 6f62          or is_ob
-00003330: 6a65 6374 5f73 7472 696e 675f 7365 7269  ject_string_seri
-00003340: 6573 286d 6574 6129 0a20 2020 2020 2020  es(meta).       
-00003350: 2020 2020 2020 2020 206f 7220 6973 5f6f           or is_o
-00003360: 626a 6563 745f 7374 7269 6e67 5f69 6e64  bject_string_ind
-00003370: 6578 286d 6574 6129 0a20 2020 2020 2020  ex(meta).       
-00003380: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-00003390: 2020 2020 2020 2020 2320 5072 696f 7220          # Prior 
-000033a0: 746f 2070 616e 6461 733d 312e 342c 2060  to pandas=1.4, `
-000033b0: 7064 2e49 6e64 6578 6020 636f 756c 646e  pd.Index` couldn
-000033c0: 2774 2063 6f6e 7461 696e 2065 7874 656e  't contain exten
-000033d0: 7369 6f6e 2064 7479 7065 732e 0a20 2020  sion dtypes..   
-000033e0: 2020 2020 2020 2020 2020 2020 2023 2048               # H
-000033f0: 6572 6520 7765 2064 6f6e 2774 2063 6173  ere we don't cas
-00003400: 7420 6f62 6a65 6374 7320 746f 2070 7961  t objects to pya
-00003410: 7272 6f77 2073 7472 696e 6773 2077 6865  rrow strings whe
-00003420: 7265 206f 6e6c 7920 7468 6520 696e 6465  re only the inde
-00003430: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
-00003440: 2020 2320 636f 6e74 6169 6e73 206e 6f6e    # contains non
-00003450: 2d70 7961 7272 6f77 2073 7472 696e 6720  -pyarrow string 
-00003460: 6461 7461 2e0a 2020 2020 2020 2020 2020  data..          
-00003470: 2020 2020 2020 6966 206e 6f74 2050 414e        if not PAN
-00003480: 4441 535f 4754 5f31 3430 2061 6e64 2028  DAS_GT_140 and (
-00003490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000034a0: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-000034b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000034c0: 735f 6f62 6a65 6374 5f73 7472 696e 675f  s_object_string_
-000034d0: 6461 7461 6672 616d 6528 6d65 7461 290a  dataframe(meta).
-000034e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000034f0: 2020 2020 2020 2020 616e 6420 6e6f 7420          and not 
-00003500: 616e 7928 6973 5f6f 626a 6563 745f 7374  any(is_object_st
-00003510: 7269 6e67 5f64 7479 7065 2864 2920 666f  ring_dtype(d) fo
-00003520: 7220 6420 696e 206d 6574 612e 6474 7970  r d in meta.dtyp
-00003530: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
-00003540: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00003550: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00003560: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00003570: 2020 2020 2020 2020 2020 2069 735f 6f62             is_ob
-00003580: 6a65 6374 5f73 7472 696e 675f 7365 7269  ject_string_seri
-00003590: 6573 286d 6574 6129 0a20 2020 2020 2020  es(meta).       
+00000460: 414e 4441 535f 4754 5f32 3130 2c0a 2020  ANDAS_GT_210,.  
+00000470: 2020 5041 4e44 4153 5f56 4552 5349 4f4e    PANDAS_VERSION
+00000480: 2c0a 2020 2020 6368 6563 6b5f 636f 6e76  ,.    check_conv
+00000490: 6572 745f 6474 7970 655f 6465 7072 6563  ert_dtype_deprec
+000004a0: 6174 696f 6e2c 0a20 2020 2063 6865 636b  ation,.    check
+000004b0: 5f6e 7569 7361 6e63 655f 636f 6c75 6d6e  _nuisance_column
+000004c0: 735f 7761 726e 696e 672c 0a20 2020 2063  s_warning,.    c
+000004d0: 6865 636b 5f6e 756d 6572 6963 5f6f 6e6c  heck_numeric_onl
+000004e0: 795f 6465 7072 6563 6174 696f 6e2c 0a20  y_deprecation,. 
+000004f0: 2020 2063 6865 636b 5f72 6564 7563 7469     check_reducti
+00000500: 6f6e 735f 7275 6e74 696d 655f 7761 726e  ons_runtime_warn
+00000510: 696e 672c 0a29 0a66 726f 6d20 6461 736b  ing,.).from dask
+00000520: 2e64 6174 6166 7261 6d65 2e61 6363 6573  .dataframe.acces
+00000530: 736f 7220 696d 706f 7274 2043 6163 6865  sor import Cache
+00000540: 6441 6363 6573 736f 722c 2044 6174 6574  dAccessor, Datet
+00000550: 696d 6541 6363 6573 736f 722c 2053 7472  imeAccessor, Str
+00000560: 696e 6741 6363 6573 736f 720a 6672 6f6d  ingAccessor.from
+00000570: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+00000580: 6361 7465 676f 7269 6361 6c20 696d 706f  categorical impo
+00000590: 7274 2043 6174 6567 6f72 6963 616c 4163  rt CategoricalAc
+000005a0: 6365 7373 6f72 2c20 6361 7465 676f 7269  cessor, categori
+000005b0: 7a65 0a66 726f 6d20 6461 736b 2e64 6174  ze.from dask.dat
+000005c0: 6166 7261 6d65 2e64 6973 7061 7463 6820  aframe.dispatch 
+000005d0: 696d 706f 7274 2028 0a20 2020 2067 6574  import (.    get
+000005e0: 5f70 6172 616c 6c65 6c5f 7479 7065 2c0a  _parallel_type,.
+000005f0: 2020 2020 6772 6f75 705f 7370 6c69 745f      group_split_
+00000600: 6469 7370 6174 6368 2c0a 2020 2020 6861  dispatch,.    ha
+00000610: 7368 5f6f 626a 6563 745f 6469 7370 6174  sh_object_dispat
+00000620: 6368 2c0a 2020 2020 6d65 7461 5f6e 6f6e  ch,.    meta_non
+00000630: 656d 7074 792c 0a29 0a66 726f 6d20 6461  empty,.).from da
+00000640: 736b 2e64 6174 6166 7261 6d65 2e6f 7074  sk.dataframe.opt
+00000650: 696d 697a 6520 696d 706f 7274 206f 7074  imize import opt
+00000660: 696d 697a 650a 6672 6f6d 2064 6173 6b2e  imize.from dask.
+00000670: 6461 7461 6672 616d 652e 7574 696c 7320  dataframe.utils 
+00000680: 696d 706f 7274 2028 0a20 2020 2041 7474  import (.    Att
+00000690: 7269 6275 7465 4e6f 7449 6d70 6c65 6d65  ributeNotImpleme
+000006a0: 6e74 6564 4572 726f 722c 0a20 2020 2063  ntedError,.    c
+000006b0: 6865 636b 5f6d 6174 6368 696e 675f 636f  heck_matching_co
+000006c0: 6c75 6d6e 732c 0a20 2020 2063 6c65 6172  lumns,.    clear
+000006d0: 5f6b 6e6f 776e 5f63 6174 6567 6f72 6965  _known_categorie
+000006e0: 732c 0a20 2020 2064 726f 705f 6279 5f73  s,.    drop_by_s
+000006f0: 6861 6c6c 6f77 5f63 6f70 792c 0a20 2020  hallow_copy,.   
+00000700: 2067 6574 5f6e 756d 6572 6963 5f6f 6e6c   get_numeric_onl
+00000710: 795f 6b77 6172 6773 2c0a 2020 2020 6861  y_kwargs,.    ha
+00000720: 735f 6b6e 6f77 6e5f 6361 7465 676f 7269  s_known_categori
+00000730: 6573 2c0a 2020 2020 696e 6465 785f 7375  es,.    index_su
+00000740: 6d6d 6172 792c 0a20 2020 2069 6e73 6572  mmary,.    inser
+00000750: 745f 6d65 7461 5f70 6172 616d 5f64 6573  t_meta_param_des
+00000760: 6372 6970 7469 6f6e 2c0a 2020 2020 6973  cription,.    is
+00000770: 5f64 6174 6166 7261 6d65 5f6c 696b 652c  _dataframe_like,
+00000780: 0a20 2020 2069 735f 696e 6465 785f 6c69  .    is_index_li
+00000790: 6b65 2c0a 2020 2020 6973 5f73 6572 6965  ke,.    is_serie
+000007a0: 735f 6c69 6b65 2c0a 2020 2020 6d61 6b65  s_like,.    make
+000007b0: 5f6d 6574 612c 0a20 2020 206d 6574 615f  _meta,.    meta_
+000007c0: 6672 616d 655f 636f 6e73 7472 7563 746f  frame_constructo
+000007d0: 722c 0a20 2020 206d 6574 615f 7365 7269  r,.    meta_seri
+000007e0: 6573 5f63 6f6e 7374 7275 6374 6f72 2c0a  es_constructor,.
+000007f0: 2020 2020 7261 6973 655f 6f6e 5f6d 6574      raise_on_met
+00000800: 615f 6572 726f 722c 0a20 2020 2076 616c  a_error,.    val
+00000810: 6964 5f64 6976 6973 696f 6e73 2c0a 290a  id_divisions,.).
+00000820: 6672 6f6d 2064 6173 6b2e 6465 6c61 7965  from dask.delaye
+00000830: 6420 696d 706f 7274 2044 656c 6179 6564  d import Delayed
+00000840: 2c20 6465 6c61 7965 642c 2075 6e70 6163  , delayed, unpac
+00000850: 6b5f 636f 6c6c 6563 7469 6f6e 730a 6672  k_collections.fr
+00000860: 6f6d 2064 6173 6b2e 6869 6768 6c65 7665  om dask.highleve
+00000870: 6c67 7261 7068 2069 6d70 6f72 7420 4869  lgraph import Hi
+00000880: 6768 4c65 7665 6c47 7261 7068 0a66 726f  ghLevelGraph.fro
+00000890: 6d20 6461 736b 2e6c 6179 6572 7320 696d  m dask.layers im
+000008a0: 706f 7274 2044 6174 6146 7261 6d65 5472  port DataFrameTr
+000008b0: 6565 5265 6475 6374 696f 6e0a 6672 6f6d  eeReduction.from
+000008c0: 2064 6173 6b2e 7574 696c 7320 696d 706f   dask.utils impo
+000008d0: 7274 2028 0a20 2020 2049 6e64 6578 4361  rt (.    IndexCa
+000008e0: 6c6c 6162 6c65 2c0a 2020 2020 4d2c 0a20  llable,.    M,. 
+000008f0: 2020 204f 7065 7261 746f 724d 6574 686f     OperatorMetho
+00000900: 644d 6978 696e 2c0a 2020 2020 5f64 6570  dMixin,.    _dep
+00000910: 7265 6361 7465 642c 0a20 2020 2061 7070  recated,.    app
+00000920: 6c79 2c0a 2020 2020 6465 7269 7665 645f  ly,.    derived_
+00000930: 6672 6f6d 2c0a 2020 2020 6675 6e63 6e61  from,.    funcna
+00000940: 6d65 2c0a 2020 2020 6861 735f 6b65 7977  me,.    has_keyw
+00000950: 6f72 642c 0a20 2020 2069 735f 6172 7261  ord,.    is_arra
+00000960: 796c 696b 652c 0a20 2020 2069 7465 725f  ylike,.    iter_
+00000970: 6368 756e 6b73 2c0a 2020 2020 6b65 795f  chunks,.    key_
+00000980: 7370 6c69 742c 0a20 2020 206d 6179 6265  split,.    maybe
+00000990: 5f70 6c75 7261 6c69 7a65 2c0a 2020 2020  _pluralize,.    
+000009a0: 6d65 6d6f 7279 5f72 6570 722c 0a20 2020  memory_repr,.   
+000009b0: 2070 6172 7365 5f62 7974 6573 2c0a 2020   parse_bytes,.  
+000009c0: 2020 7061 7274 6961 6c5f 6279 5f6f 7264    partial_by_ord
+000009d0: 6572 2c0a 2020 2020 7073 6575 646f 7261  er,.    pseudora
+000009e0: 6e64 6f6d 2c0a 2020 2020 7075 745f 6c69  ndom,.    put_li
+000009f0: 6e65 732c 0a20 2020 2072 616e 646f 6d5f  nes,.    random_
+00000a00: 7374 6174 655f 6461 7461 2c0a 2020 2020  state_data,.    
+00000a10: 7479 7065 6e61 6d65 2c0a 290a 6672 6f6d  typename,.).from
+00000a20: 2064 6173 6b2e 7769 6467 6574 7320 696d   dask.widgets im
+00000a30: 706f 7274 2067 6574 5f74 656d 706c 6174  port get_templat
+00000a40: 650a 0a44 4546 4155 4c54 5f47 4554 203d  e..DEFAULT_GET =
+00000a50: 206e 616d 6564 5f73 6368 6564 756c 6572   named_scheduler
+00000a60: 732e 6765 7428 2274 6872 6561 6473 222c  s.get("threads",
+00000a70: 206e 616d 6564 5f73 6368 6564 756c 6572   named_scheduler
+00000a80: 735b 2273 796e 6322 5d29 0a0a 6e6f 5f64  s["sync"])..no_d
+00000a90: 6566 6175 6c74 203d 2022 5f5f 6e6f 5f64  efault = "__no_d
+00000aa0: 6566 6175 6c74 5f5f 220a 0a47 524f 5550  efault__"..GROUP
+00000ab0: 5f4b 4559 535f 4445 4641 554c 543a 2062  _KEYS_DEFAULT: b
+00000ac0: 6f6f 6c20 7c20 4e6f 6e65 203d 2054 7275  ool | None = Tru
+00000ad0: 650a 6966 2050 414e 4441 535f 4754 5f31  e.if PANDAS_GT_1
+00000ae0: 3530 2061 6e64 206e 6f74 2050 414e 4441  50 and not PANDA
+00000af0: 535f 4754 5f32 3030 3a0a 2020 2020 4752  S_GT_200:.    GR
+00000b00: 4f55 505f 4b45 5953 5f44 4546 4155 4c54  OUP_KEYS_DEFAULT
+00000b10: 203d 204e 6f6e 650a 0a70 642e 7365 745f   = None..pd.set_
+00000b20: 6f70 7469 6f6e 2822 636f 6d70 7574 652e  option("compute.
+00000b30: 7573 655f 6e75 6d65 7870 7222 2c20 4661  use_numexpr", Fa
+00000b40: 6c73 6529 0a0a 0a64 6566 205f 6e75 6d65  lse)...def _nume
+00000b50: 7269 635f 6f6e 6c79 2866 756e 6329 3a0a  ric_only(func):.
+00000b60: 2020 2020 2222 2244 6563 6f72 6174 6f72      """Decorator
+00000b70: 2066 6f72 206d 6574 686f 6473 2074 6861   for methods tha
+00000b80: 7420 6163 6365 7074 2061 206e 756d 6572  t accept a numer
+00000b90: 6963 5f6f 6e6c 7920 6b77 6172 6722 2222  ic_only kwarg"""
+00000ba0: 0a0a 2020 2020 4077 7261 7073 2866 756e  ..    @wraps(fun
+00000bb0: 6329 0a20 2020 2064 6566 2077 7261 7070  c).    def wrapp
+00000bc0: 6572 2873 656c 662c 202a 6172 6773 2c20  er(self, *args, 
+00000bd0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+00000be0: 2020 2023 206e 756d 6572 6963 5f6f 6e6c     # numeric_onl
+00000bf0: 7920 6973 204e 6f6e 6520 6279 2064 6566  y is None by def
+00000c00: 6175 6c74 202d 2069 6e20 7468 6174 2063  ault - in that c
+00000c10: 6173 6520 7365 6c66 203d 2073 656c 662e  ase self = self.
+00000c20: 0a20 2020 2020 2020 2069 6620 6b77 6172  .        if kwar
+00000c30: 6773 2e67 6574 2822 6e75 6d65 7269 635f  gs.get("numeric_
+00000c40: 6f6e 6c79 2229 2069 7320 4661 6c73 653a  only") is False:
+00000c50: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00000c60: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00000c70: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
+00000c80: 2020 2020 2020 2020 2227 6e75 6d65 7269          "'numeri
+00000c90: 635f 6f6e 6c79 3d46 616c 7365 2720 6973  c_only=False' is
+00000ca0: 206e 6f74 2069 6d70 6c65 6d65 6e74 6564   not implemented
+00000cb0: 2069 6e20 4461 736b 2e22 0a20 2020 2020   in Dask.".     
+00000cc0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00000cd0: 2065 6c69 6620 6b77 6172 6773 2e67 6574   elif kwargs.get
+00000ce0: 2822 6e75 6d65 7269 635f 6f6e 6c79 2229  ("numeric_only")
+00000cf0: 2069 7320 5472 7565 3a0a 2020 2020 2020   is True:.      
+00000d00: 2020 2020 2020 7365 6c66 203d 2073 656c        self = sel
+00000d10: 662e 5f67 6574 5f6e 756d 6572 6963 5f64  f._get_numeric_d
+00000d20: 6174 6128 290a 2020 2020 2020 2020 7265  ata().        re
+00000d30: 7475 726e 2066 756e 6328 7365 6c66 2c20  turn func(self, 
+00000d40: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00000d50: 0a0a 2020 2020 7265 7475 726e 2077 7261  ..    return wra
+00000d60: 7070 6572 0a0a 0a64 6566 205f 6e75 6d65  pper...def _nume
+00000d70: 7269 635f 6461 7461 2866 756e 6329 3a0a  ric_data(func):.
+00000d80: 2020 2020 2222 224d 6f64 6966 6965 6420      """Modified 
+00000d90: 7665 7273 696f 6e20 6f66 2074 6865 2061  version of the a
+00000da0: 626f 7665 2064 6563 6f72 6174 6f72 2c20  bove decorator, 
+00000db0: 7269 6768 7420 6e6f 7720 6f6e 6c79 2075  right now only u
+00000dc0: 7365 6420 7769 7468 2073 7464 2e20 5765  sed with std. We
+00000dd0: 2064 6f6e 2774 0a20 2020 206e 6565 6420   don't.    need 
+00000de0: 7261 6973 696e 6720 4e6f 7449 6d70 6c65  raising NotImple
+00000df0: 6d65 6e74 6564 4572 726f 7220 7468 6572  mentedError ther
+00000e00: 652c 2062 6563 6175 7365 2069 7427 7320  e, because it's 
+00000e10: 6861 6e64 6c65 6420 6279 0a20 2020 205f  handled by.    _
+00000e20: 6e75 6d65 7269 635f 6f6e 6c79 5f6d 6179  numeric_only_may
+00000e30: 6265 5f77 6172 6e20 696e 7374 6561 642e  be_warn instead.
+00000e40: 2054 6869 7320 6973 2061 2074 656d 706f   This is a tempo
+00000e50: 7261 7279 2073 6f6c 7574 696f 6e20 7468  rary solution th
+00000e60: 6174 206e 6565 6473 0a20 2020 206d 6f72  at needs.    mor
+00000e70: 6520 7469 6d65 2074 6f20 6265 2067 656e  e time to be gen
+00000e80: 6572 616c 697a 6564 2e22 2222 0a0a 2020  eralized."""..  
+00000e90: 2020 4077 7261 7073 2866 756e 6329 0a20    @wraps(func). 
+00000ea0: 2020 2064 6566 2077 7261 7070 6572 2873     def wrapper(s
+00000eb0: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
+00000ec0: 6172 6773 293a 0a20 2020 2020 2020 2069  args):.        i
+00000ed0: 6620 6b77 6172 6773 2e67 6574 2822 6e75  f kwargs.get("nu
+00000ee0: 6d65 7269 635f 6f6e 6c79 2229 2069 7320  meric_only") is 
+00000ef0: 5472 7565 3a0a 2020 2020 2020 2020 2020  True:.          
+00000f00: 2020 7365 6c66 203d 2073 656c 662e 5f67    self = self._g
+00000f10: 6574 5f6e 756d 6572 6963 5f64 6174 6128  et_numeric_data(
+00000f20: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00000f30: 2066 756e 6328 7365 6c66 2c20 2a61 7267   func(self, *arg
+00000f40: 732c 202a 2a6b 7761 7267 7329 0a0a 2020  s, **kwargs)..  
+00000f50: 2020 7265 7475 726e 2077 7261 7070 6572    return wrapper
+00000f60: 0a0a 0a64 6566 205f 6e75 6d65 7269 635f  ...def _numeric_
+00000f70: 6f6e 6c79 5f6d 6179 6265 5f77 6172 6e28  only_maybe_warn(
+00000f80: 6466 2c20 6e75 6d65 7269 635f 6f6e 6c79  df, numeric_only
+00000f90: 2c20 6465 6661 756c 743d 4e6f 6e65 293a  , default=None):
+00000fa0: 0a20 2020 2022 2222 5570 6461 7465 206e  .    """Update n
+00000fb0: 756d 6572 6963 5f6f 6e6c 7920 746f 2067  umeric_only to g
+00000fc0: 6574 2072 6964 206f 6620 6e6f 5f64 6566  et rid of no_def
+00000fd0: 6175 6c74 2c20 616e 6420 706f 7373 6962  ault, and possib
+00000fe0: 6c79 2077 6172 6e20 6162 6f75 7420 6465  ly warn about de
+00000ff0: 6661 756c 7420 7661 6c75 652e 0a20 2020  fault value..   
+00001000: 2054 4f44 4f3a 2073 686f 756c 6420 6d6f   TODO: should mo
+00001010: 7665 2074 6f20 6e75 6d65 7269 635f 6f6e  ve to numeric_on
+00001020: 6c79 2064 6563 6f72 6174 6f72 2e20 5365  ly decorator. Se
+00001030: 6520 6874 7470 733a 2f2f 6769 7468 7562  e https://github
+00001040: 2e63 6f6d 2f64 6173 6b2f 6461 736b 2f70  .com/dask/dask/p
+00001050: 756c 6c2f 3939 3532 0a20 2020 2022 2222  ull/9952.    """
+00001060: 0a20 2020 2069 6620 6973 5f64 6174 6166  .    if is_dataf
+00001070: 7261 6d65 5f6c 696b 6528 6466 293a 0a20  rame_like(df):. 
+00001080: 2020 2020 2020 2077 6172 6e5f 6e75 6d65         warn_nume
+00001090: 7269 635f 6f6e 6c79 203d 2046 616c 7365  ric_only = False
+000010a0: 0a20 2020 2020 2020 2069 6620 6e75 6d65  .        if nume
+000010b0: 7269 635f 6f6e 6c79 2069 7320 6e6f 5f64  ric_only is no_d
+000010c0: 6566 6175 6c74 3a0a 2020 2020 2020 2020  efault:.        
+000010d0: 2020 2020 6966 2050 414e 4441 535f 4754      if PANDAS_GT
+000010e0: 5f32 3030 3a0a 2020 2020 2020 2020 2020  _200:.          
+000010f0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+00001100: 6c79 203d 2046 616c 7365 0a20 2020 2020  ly = False.     
+00001110: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00001120: 2020 2020 2020 2020 2020 2020 2077 6172               war
+00001130: 6e5f 6e75 6d65 7269 635f 6f6e 6c79 203d  n_numeric_only =
+00001140: 2054 7275 650a 0a20 2020 2020 2020 206e   True..        n
+00001150: 756d 6572 6963 7320 3d20 6466 2e5f 6d65  umerics = df._me
+00001160: 7461 2e5f 6765 745f 6e75 6d65 7269 635f  ta._get_numeric_
+00001170: 6461 7461 2829 0a20 2020 2020 2020 2068  data().        h
+00001180: 6173 5f6e 6f6e 5f6e 756d 6572 6963 7320  as_non_numerics 
+00001190: 3d20 6c65 6e28 6e75 6d65 7269 6373 2e63  = len(numerics.c
+000011a0: 6f6c 756d 6e73 2920 3c20 6c65 6e28 6466  olumns) < len(df
+000011b0: 2e5f 6d65 7461 2e63 6f6c 756d 6e73 290a  ._meta.columns).
+000011c0: 2020 2020 2020 2020 6966 2068 6173 5f6e          if has_n
+000011d0: 6f6e 5f6e 756d 6572 6963 733a 0a20 2020  on_numerics:.   
+000011e0: 2020 2020 2020 2020 2069 6620 6e75 6d65           if nume
+000011f0: 7269 635f 6f6e 6c79 2069 7320 4661 6c73  ric_only is Fals
+00001200: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00001210: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00001220: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+00001230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001240: 2020 2227 6e75 6d65 7269 635f 6f6e 6c79    "'numeric_only
+00001250: 3d46 616c 7365 2720 6973 206e 6f74 2069  =False' is not i
+00001260: 6d70 6c65 6d65 6e74 6564 2069 6e20 4461  mplemented in Da
+00001270: 736b 2e22 0a20 2020 2020 2020 2020 2020  sk.".           
+00001280: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00001290: 2020 2065 6c69 6620 7761 726e 5f6e 756d     elif warn_num
+000012a0: 6572 6963 5f6f 6e6c 793a 0a20 2020 2020  eric_only:.     
+000012b0: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+000012c0: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
+000012d0: 2020 2020 2020 2020 2020 2020 2020 2254                "T
+000012e0: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
+000012f0: 206f 6620 6e75 6d65 7269 635f 6f6e 6c79   of numeric_only
+00001300: 2069 6e20 6461 736b 2077 696c 6c20 6265   in dask will be
+00001310: 2063 6861 6e67 6564 2074 6f20 4661 6c73   changed to Fals
+00001320: 6520 696e 2022 0a20 2020 2020 2020 2020  e in ".         
+00001330: 2020 2020 2020 2020 2020 2022 7468 6520             "the 
+00001340: 6675 7475 7265 2077 6865 6e20 7573 696e  future when usin
+00001350: 6720 6461 736b 2077 6974 6820 7061 6e64  g dask with pand
+00001360: 6173 2032 2e30 222c 0a20 2020 2020 2020  as 2.0",.       
+00001370: 2020 2020 2020 2020 2020 2020 2046 7574               Fut
+00001380: 7572 6557 6172 6e69 6e67 2c0a 2020 2020  ureWarning,.    
+00001390: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000013a0: 2020 6966 206e 756d 6572 6963 5f6f 6e6c    if numeric_onl
+000013b0: 7920 6973 206e 6f5f 6465 6661 756c 7420  y is no_default 
+000013c0: 616e 6420 6465 6661 756c 7420 6973 206e  and default is n
+000013d0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+000013e0: 206e 756d 6572 6963 5f6f 6e6c 7920 3d20   numeric_only = 
+000013f0: 6465 6661 756c 740a 2020 2020 7265 7475  default.    retu
+00001400: 726e 207b 7d20 6966 206e 756d 6572 6963  rn {} if numeric
+00001410: 5f6f 6e6c 7920 6973 206e 6f5f 6465 6661  _only is no_defa
+00001420: 756c 7420 656c 7365 207b 226e 756d 6572  ult else {"numer
+00001430: 6963 5f6f 6e6c 7922 3a20 6e75 6d65 7269  ic_only": numeri
+00001440: 635f 6f6e 6c79 7d0a 0a0a 6465 6620 5f63  c_only}...def _c
+00001450: 6f6e 6361 7428 6172 6773 2c20 6967 6e6f  oncat(args, igno
+00001460: 7265 5f69 6e64 6578 3d46 616c 7365 293a  re_index=False):
+00001470: 0a20 2020 2069 6620 6e6f 7420 6172 6773  .    if not args
+00001480: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00001490: 2061 7267 730a 2020 2020 6966 2069 7369   args.    if isi
+000014a0: 6e73 7461 6e63 6528 6669 7273 7428 636f  nstance(first(co
+000014b0: 7265 2e66 6c61 7474 656e 2861 7267 7329  re.flatten(args)
+000014c0: 292c 206e 702e 6e64 6172 7261 7929 3a0a  ), np.ndarray):.
+000014d0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+000014e0: 612e 636f 7265 2e63 6f6e 6361 7465 6e61  a.core.concatena
+000014f0: 7465 3328 6172 6773 290a 2020 2020 6966  te3(args).    if
+00001500: 206e 6f74 2068 6173 5f70 6172 616c 6c65   not has_paralle
+00001510: 6c5f 7479 7065 2861 7267 735b 305d 293a  l_type(args[0]):
+00001520: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00001530: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00001540: 2070 642e 5365 7269 6573 2861 7267 7329   pd.Series(args)
+00001550: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+00001560: 4578 6365 7074 696f 6e3a 0a20 2020 2020  Exception:.     
+00001570: 2020 2020 2020 2072 6574 7572 6e20 6172         return ar
+00001580: 6773 0a20 2020 2023 2057 6520 6669 6c74  gs.    # We filt
+00001590: 6572 206f 7574 2065 6d70 7479 2070 6172  er out empty par
+000015a0: 7469 7469 6f6e 7320 6865 7265 2062 6563  titions here bec
+000015b0: 6175 7365 2070 616e 6461 7320 6672 6571  ause pandas freq
+000015c0: 7565 6e74 6c79 2068 6173 0a20 2020 2023  uently has.    #
+000015d0: 2069 6e63 6f6e 7369 7374 656e 7420 6474   inconsistent dt
+000015e0: 7970 6573 2069 6e20 7265 7375 6c74 7320  ypes in results 
+000015f0: 6265 7477 6565 6e20 656d 7074 7920 616e  between empty an
+00001600: 6420 6e6f 6e2d 656d 7074 7920 6672 616d  d non-empty fram
+00001610: 6573 2e0a 2020 2020 2320 4964 6561 6c6c  es..    # Ideall
+00001620: 7920 7468 6973 2077 6f75 6c64 2062 6520  y this would be 
+00001630: 6861 6e64 6c65 6420 6c6f 6361 6c6c 7920  handled locally 
+00001640: 666f 7220 6561 6368 206f 7065 7261 7469  for each operati
+00001650: 6f6e 2c20 6275 7420 696e 2070 7261 6374  on, but in pract
+00001660: 6963 650a 2020 2020 2320 7468 6973 2073  ice.    # this s
+00001670: 6565 6d73 2065 6173 6965 722e 2054 4f44  eems easier. TOD
+00001680: 4f3a 2064 6f6e 2774 2064 6f20 7468 6973  O: don't do this
+00001690: 2e0a 2020 2020 6172 6773 3220 3d20 5b69  ..    args2 = [i
+000016a0: 2066 6f72 2069 2069 6e20 6172 6773 2069   for i in args i
+000016b0: 6620 6c65 6e28 6929 5d0a 2020 2020 7265  f len(i)].    re
+000016c0: 7475 726e 2028 0a20 2020 2020 2020 2061  turn (.        a
+000016d0: 7267 735b 305d 0a20 2020 2020 2020 2069  rgs[0].        i
+000016e0: 6620 6e6f 7420 6172 6773 320a 2020 2020  f not args2.    
+000016f0: 2020 2020 656c 7365 206d 6574 686f 6473      else methods
+00001700: 2e63 6f6e 6361 7428 6172 6773 322c 2075  .concat(args2, u
+00001710: 6e69 666f 726d 3d54 7275 652c 2069 676e  niform=True, ign
+00001720: 6f72 655f 696e 6465 783d 6967 6e6f 7265  ore_index=ignore
+00001730: 5f69 6e64 6578 290a 2020 2020 290a 0a0a  _index).    )...
+00001740: 6465 6620 6669 6e61 6c69 7a65 2872 6573  def finalize(res
+00001750: 756c 7473 293a 0a20 2020 2072 6574 7572  ults):.    retur
+00001760: 6e20 5f63 6f6e 6361 7428 7265 7375 6c74  n _concat(result
+00001770: 7329 0a0a 0a63 6c61 7373 2053 6361 6c61  s)...class Scala
+00001780: 7228 4461 736b 4d65 7468 6f64 734d 6978  r(DaskMethodsMix
+00001790: 696e 2c20 4f70 6572 6174 6f72 4d65 7468  in, OperatorMeth
+000017a0: 6f64 4d69 7869 6e29 3a0a 2020 2020 2222  odMixin):.    ""
+000017b0: 2241 2044 6173 6b20 6f62 6a65 6374 2074  "A Dask object t
+000017c0: 6f20 7265 7072 6573 656e 7420 6120 7061  o represent a pa
+000017d0: 6e64 6173 2073 6361 6c61 7222 2222 0a0a  ndas scalar"""..
+000017e0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+000017f0: 2873 656c 662c 2064 736b 2c20 6e61 6d65  (self, dsk, name
+00001800: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
+00001810: 733d 4e6f 6e65 293a 0a20 2020 2020 2020  s=None):.       
+00001820: 2023 2064 6976 6973 696f 6e73 2069 7320   # divisions is 
+00001830: 6967 6e6f 7265 642c 206f 6e6c 7920 7072  ignored, only pr
+00001840: 6573 656e 7420 746f 2062 6520 636f 6d70  esent to be comp
+00001850: 6174 6962 6c65 2077 6974 6820 6f74 6865  atible with othe
+00001860: 720a 2020 2020 2020 2020 2320 6f62 6a65  r.        # obje
+00001870: 6374 732e 0a20 2020 2020 2020 2069 6620  cts..        if 
+00001880: 6e6f 7420 6973 696e 7374 616e 6365 2864  not isinstance(d
+00001890: 736b 2c20 4869 6768 4c65 7665 6c47 7261  sk, HighLevelGra
+000018a0: 7068 293a 0a20 2020 2020 2020 2020 2020  ph):.           
+000018b0: 2064 736b 203d 2048 6967 684c 6576 656c   dsk = HighLevel
+000018c0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+000018d0: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
+000018e0: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
+000018f0: 5d29 0a20 2020 2020 2020 2073 656c 662e  ]).        self.
+00001900: 6461 736b 203d 2064 736b 0a20 2020 2020  dask = dsk.     
+00001910: 2020 2073 656c 662e 5f6e 616d 6520 3d20     self._name = 
+00001920: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
+00001930: 662e 5f70 6172 656e 745f 6d65 7461 203d  f._parent_meta =
+00001940: 2070 642e 5365 7269 6573 2864 7479 7065   pd.Series(dtype
+00001950: 3d22 666c 6f61 7436 3422 290a 0a20 2020  ="float64")..   
+00001960: 2020 2020 206d 6574 6120 3d20 6d61 6b65       meta = make
+00001970: 5f6d 6574 6128 6d65 7461 2c20 7061 7265  _meta(meta, pare
+00001980: 6e74 5f6d 6574 613d 7365 6c66 2e5f 7061  nt_meta=self._pa
+00001990: 7265 6e74 5f6d 6574 6129 0a20 2020 2020  rent_meta).     
+000019a0: 2020 2069 6620 6973 5f64 6174 6166 7261     if is_datafra
+000019b0: 6d65 5f6c 696b 6528 6d65 7461 2920 6f72  me_like(meta) or
+000019c0: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
+000019d0: 6d65 7461 2920 6f72 2069 735f 696e 6465  meta) or is_inde
+000019e0: 785f 6c69 6b65 286d 6574 6129 3a0a 2020  x_like(meta):.  
+000019f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00001a00: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+00001a10: 2020 2020 2020 2020 2020 2066 2245 7870             f"Exp
+00001a20: 6563 7465 6420 6d65 7461 2074 6f20 7370  ected meta to sp
+00001a30: 6563 6966 7920 7363 616c 6172 2c20 676f  ecify scalar, go
+00001a40: 7420 7b74 7970 656e 616d 6528 7479 7065  t {typename(type
+00001a50: 286d 6574 6129 297d 220a 2020 2020 2020  (meta))}".      
+00001a60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00001a70: 7365 6c66 2e5f 6d65 7461 203d 206d 6574  self._meta = met
+00001a80: 610a 0a20 2020 2064 6566 205f 5f64 6173  a..    def __das
+00001a90: 6b5f 6772 6170 685f 5f28 7365 6c66 293a  k_graph__(self):
+00001aa0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00001ab0: 7365 6c66 2e64 6173 6b0a 0a20 2020 2064  self.dask..    d
+00001ac0: 6566 205f 5f64 6173 6b5f 6b65 7973 5f5f  ef __dask_keys__
+00001ad0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00001ae0: 7265 7475 726e 205b 7365 6c66 2e6b 6579  return [self.key
+00001af0: 5d0a 0a20 2020 2064 6566 205f 5f64 6173  ]..    def __das
+00001b00: 6b5f 746f 6b65 6e69 7a65 5f5f 2873 656c  k_tokenize__(sel
+00001b10: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00001b20: 726e 2073 656c 662e 5f6e 616d 650a 0a20  rn self._name.. 
+00001b30: 2020 2064 6566 205f 5f64 6173 6b5f 6c61     def __dask_la
+00001b40: 7965 7273 5f5f 2873 656c 6629 3a0a 2020  yers__(self):.  
+00001b50: 2020 2020 2020 7265 7475 726e 2028 7365        return (se
+00001b60: 6c66 2e5f 6e61 6d65 2c29 0a0a 2020 2020  lf._name,)..    
+00001b70: 5f5f 6461 736b 5f6f 7074 696d 697a 655f  __dask_optimize_
+00001b80: 5f20 3d20 676c 6f62 616c 6d65 7468 6f64  _ = globalmethod
+00001b90: 280a 2020 2020 2020 2020 6f70 7469 6d69  (.        optimi
+00001ba0: 7a65 2c20 6b65 793d 2264 6174 6166 7261  ze, key="datafra
+00001bb0: 6d65 5f6f 7074 696d 697a 6522 2c20 6661  me_optimize", fa
+00001bc0: 6c73 6579 3d64 6f6e 745f 6f70 7469 6d69  lsey=dont_optimi
+00001bd0: 7a65 0a20 2020 2029 0a20 2020 205f 5f64  ze.    ).    __d
+00001be0: 6173 6b5f 7363 6865 6475 6c65 725f 5f20  ask_scheduler__ 
+00001bf0: 3d20 7374 6174 6963 6d65 7468 6f64 2844  = staticmethod(D
+00001c00: 4546 4155 4c54 5f47 4554 290a 0a20 2020  EFAULT_GET)..   
+00001c10: 2064 6566 205f 5f64 6173 6b5f 706f 7374   def __dask_post
+00001c20: 636f 6d70 7574 655f 5f28 7365 6c66 293a  compute__(self):
+00001c30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00001c40: 6669 7273 742c 2028 290a 0a20 2020 2064  first, ()..    d
+00001c50: 6566 205f 5f64 6173 6b5f 706f 7374 7065  ef __dask_postpe
+00001c60: 7273 6973 745f 5f28 7365 6c66 293a 0a20  rsist__(self):. 
+00001c70: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00001c80: 6c66 2e5f 7265 6275 696c 642c 2028 290a  lf._rebuild, ().
+00001c90: 0a20 2020 2064 6566 205f 7265 6275 696c  .    def _rebuil
+00001ca0: 6428 7365 6c66 2c20 6473 6b2c 202a 2c20  d(self, dsk, *, 
+00001cb0: 7265 6e61 6d65 3d4e 6f6e 6529 3a0a 2020  rename=None):.  
+00001cc0: 2020 2020 2020 6e61 6d65 203d 2073 656c        name = sel
+00001cd0: 662e 5f6e 616d 650a 2020 2020 2020 2020  f._name.        
+00001ce0: 6966 2072 656e 616d 653a 0a20 2020 2020  if rename:.     
+00001cf0: 2020 2020 2020 206e 616d 6520 3d20 7265         name = re
+00001d00: 6e61 6d65 2e67 6574 286e 616d 652c 206e  name.get(name, n
+00001d10: 616d 6529 0a20 2020 2020 2020 2072 6574  ame).        ret
+00001d20: 7572 6e20 5363 616c 6172 2864 736b 2c20  urn Scalar(dsk, 
+00001d30: 6e61 6d65 2c20 7365 6c66 2e5f 6d65 7461  name, self._meta
+00001d40: 2c20 7365 6c66 2e64 6976 6973 696f 6e73  , self.divisions
+00001d50: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00001d60: 0a20 2020 2064 6566 205f 6d65 7461 5f6e  .    def _meta_n
+00001d70: 6f6e 656d 7074 7928 7365 6c66 293a 0a20  onempty(self):. 
+00001d80: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00001d90: 6c66 2e5f 6d65 7461 0a0a 2020 2020 4070  lf._meta..    @p
+00001da0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00001db0: 6474 7970 6528 7365 6c66 293a 0a20 2020  dtype(self):.   
+00001dc0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00001dd0: 2e5f 6d65 7461 2e64 7479 7065 0a0a 2020  ._meta.dtype..  
+00001de0: 2020 6465 6620 5f5f 6469 725f 5f28 7365    def __dir__(se
+00001df0: 6c66 293a 0a20 2020 2020 2020 206f 203d  lf):.        o =
+00001e00: 2073 6574 2864 6972 2874 7970 6528 7365   set(dir(type(se
+00001e10: 6c66 2929 290a 2020 2020 2020 2020 6f2e  lf))).        o.
+00001e20: 7570 6461 7465 2873 656c 662e 5f5f 6469  update(self.__di
+00001e30: 6374 5f5f 290a 2020 2020 2020 2020 6966  ct__).        if
+00001e40: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
+00001e50: 662e 5f6d 6574 612c 2022 6474 7970 6522  f._meta, "dtype"
+00001e60: 293a 0a20 2020 2020 2020 2020 2020 206f  ):.            o
+00001e70: 2e72 656d 6f76 6528 2264 7479 7065 2229  .remove("dtype")
+00001e80: 2020 2320 6474 7970 6520 6f6e 6c79 2069    # dtype only i
+00001e90: 6e20 6064 6972 6020 6966 2061 7661 696c  n `dir` if avail
+00001ea0: 6162 6c65 0a20 2020 2020 2020 2072 6574  able.        ret
+00001eb0: 7572 6e20 6c69 7374 286f 290a 0a20 2020  urn list(o)..   
+00001ec0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00001ed0: 6566 2064 6976 6973 696f 6e73 2873 656c  ef divisions(sel
+00001ee0: 6629 3a0a 2020 2020 2020 2020 2222 2244  f):.        """D
+00001ef0: 756d 6d79 2064 6976 6973 696f 6e73 2074  ummy divisions t
+00001f00: 6f20 6265 2063 6f6d 7061 7420 7769 7468  o be compat with
+00001f10: 2053 6572 6965 7320 616e 6420 4461 7461   Series and Data
+00001f20: 4672 616d 6522 2222 0a20 2020 2020 2020  Frame""".       
+00001f30: 2072 6574 7572 6e20 284e 6f6e 652c 204e   return (None, N
+00001f40: 6f6e 6529 0a0a 2020 2020 6465 6620 5f5f  one)..    def __
+00001f50: 7265 7072 5f5f 2873 656c 6629 3a0a 2020  repr__(self):.  
+00001f60: 2020 2020 2020 6e61 6d65 203d 2073 656c        name = sel
+00001f70: 662e 5f6e 616d 6520 6966 206c 656e 2873  f._name if len(s
+00001f80: 656c 662e 5f6e 616d 6529 203c 2031 3020  elf._name) < 10 
+00001f90: 656c 7365 2073 656c 662e 5f6e 616d 655b  else self._name[
+00001fa0: 3a37 5d20 2b20 222e 2e2e 220a 2020 2020  :7] + "...".    
+00001fb0: 2020 2020 6966 2068 6173 6174 7472 2873      if hasattr(s
+00001fc0: 656c 662e 5f6d 6574 612c 2022 6474 7970  elf._meta, "dtyp
+00001fd0: 6522 293a 0a20 2020 2020 2020 2020 2020  e"):.           
+00001fe0: 2065 7874 7261 203d 2022 2c20 6474 7970   extra = ", dtyp
+00001ff0: 653d 2573 2220 2520 7365 6c66 2e5f 6d65  e=%s" % self._me
+00002000: 7461 2e64 7479 7065 0a20 2020 2020 2020  ta.dtype.       
+00002010: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00002020: 2020 2065 7874 7261 203d 2022 2c20 7479     extra = ", ty
+00002030: 7065 3d25 7322 2025 2074 7970 6528 7365  pe=%s" % type(se
+00002040: 6c66 2e5f 6d65 7461 292e 5f5f 6e61 6d65  lf._meta).__name
+00002050: 5f5f 0a20 2020 2020 2020 2072 6574 7572  __.        retur
+00002060: 6e20 6622 6464 2e53 6361 6c61 723c 7b6e  n f"dd.Scalar<{n
+00002070: 616d 657d 7b65 7874 7261 7d3e 220a 0a20  ame}{extra}>".. 
+00002080: 2020 2064 6566 205f 5f61 7272 6179 5f5f     def __array__
+00002090: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000020a0: 2320 6172 7261 7920 696e 7465 7266 6163  # array interfac
+000020b0: 6520 6973 2072 6571 7569 7265 6420 746f  e is required to
+000020c0: 2073 7570 706f 7274 2070 616e 6461 7320   support pandas 
+000020d0: 696e 7374 616e 6365 202b 2053 6361 6c61  instance + Scala
+000020e0: 720a 2020 2020 2020 2020 2320 4f74 6865  r.        # Othe
+000020f0: 7277 6973 652c 2061 626f 7665 206f 7020  rwise, above op 
+00002100: 7265 7375 6c74 7320 696e 2070 642e 5365  results in pd.Se
+00002110: 7269 6573 206f 6620 5363 616c 6172 2028  ries of Scalar (
+00002120: 6f62 6a65 6374 2064 7479 7065 290a 2020  object dtype).  
+00002130: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
+00002140: 6173 6172 7261 7928 7365 6c66 2e63 6f6d  asarray(self.com
+00002150: 7075 7465 2829 290a 0a20 2020 2040 7072  pute())..    @pr
+00002160: 6f70 6572 7479 0a20 2020 2064 6566 205f  operty.    def _
+00002170: 6172 6773 2873 656c 6629 3a0a 2020 2020  args(self):.    
+00002180: 2020 2020 7265 7475 726e 2028 7365 6c66      return (self
+00002190: 2e64 6173 6b2c 2073 656c 662e 5f6e 616d  .dask, self._nam
+000021a0: 652c 2073 656c 662e 5f6d 6574 6129 0a0a  e, self._meta)..
+000021b0: 2020 2020 6465 6620 5f5f 6765 7473 7461      def __getsta
+000021c0: 7465 5f5f 2873 656c 6629 3a0a 2020 2020  te__(self):.    
+000021d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000021e0: 5f61 7267 730a 0a20 2020 2064 6566 205f  _args..    def _
+000021f0: 5f73 6574 7374 6174 655f 5f28 7365 6c66  _setstate__(self
+00002200: 2c20 7374 6174 6529 3a0a 2020 2020 2020  , state):.      
+00002210: 2020 7365 6c66 2e64 6173 6b2c 2073 656c    self.dask, sel
+00002220: 662e 5f6e 616d 652c 2073 656c 662e 5f6d  f._name, self._m
+00002230: 6574 6120 3d20 7374 6174 650a 0a20 2020  eta = state..   
+00002240: 2064 6566 205f 5f62 6f6f 6c5f 5f28 7365   def __bool__(se
+00002250: 6c66 293a 0a20 2020 2020 2020 2072 6169  lf):.        rai
+00002260: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
+00002270: 2020 2020 2020 2020 2020 6622 5472 7969            f"Tryi
+00002280: 6e67 2074 6f20 636f 6e76 6572 7420 7b73  ng to convert {s
+00002290: 656c 667d 2074 6f20 6120 626f 6f6c 6561  elf} to a boolea
+000022a0: 6e20 7661 6c75 652e 2042 6563 6175 7365  n value. Because
+000022b0: 2044 6173 6b20 6f62 6a65 6374 7320 6172   Dask objects ar
+000022c0: 6520 220a 2020 2020 2020 2020 2020 2020  e ".            
+000022d0: 226c 617a 696c 7920 6576 616c 7561 7465  "lazily evaluate
+000022e0: 642c 2074 6865 7920 6361 6e6e 6f74 2062  d, they cannot b
+000022f0: 6520 636f 6e76 6572 7465 6420 746f 2061  e converted to a
+00002300: 2062 6f6f 6c65 616e 2076 616c 7565 206f   boolean value o
+00002310: 7220 7573 6564 2022 0a20 2020 2020 2020  r used ".       
+00002320: 2020 2020 2022 696e 2062 6f6f 6c65 616e       "in boolean
+00002330: 2063 6f6e 6469 7469 6f6e 7320 6c69 6b65   conditions like
+00002340: 2069 6620 7374 6174 656d 656e 7473 2e20   if statements. 
+00002350: 5472 7920 6361 6c6c 696e 6720 2e63 6f6d  Try calling .com
+00002360: 7075 7465 2829 2074 6f20 220a 2020 2020  pute() to ".    
+00002370: 2020 2020 2020 2020 2266 6f72 6365 2063          "force c
+00002380: 6f6d 7075 7461 7469 6f6e 2070 7269 6f72  omputation prior
+00002390: 2074 6f20 636f 6e76 6572 7469 6e67 2074   to converting t
+000023a0: 6f20 6120 626f 6f6c 6561 6e20 7661 6c75  o a boolean valu
+000023b0: 6520 6f72 2075 7369 6e67 2069 6e20 220a  e or using in ".
+000023c0: 2020 2020 2020 2020 2020 2020 2261 2063              "a c
+000023d0: 6f6e 6469 7469 6f6e 616c 2073 7461 7465  onditional state
+000023e0: 6d65 6e74 2e22 0a20 2020 2020 2020 2029  ment.".        )
+000023f0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00002400: 2020 2020 6465 6620 6b65 7928 7365 6c66      def key(self
+00002410: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00002420: 6e20 2873 656c 662e 5f6e 616d 652c 2030  n (self._name, 0
+00002430: 290a 0a20 2020 2040 636c 6173 736d 6574  )..    @classmet
+00002440: 686f 640a 2020 2020 6465 6620 5f67 6574  hod.    def _get
+00002450: 5f75 6e61 7279 5f6f 7065 7261 746f 7228  _unary_operator(
+00002460: 636c 732c 206f 7029 3a0a 2020 2020 2020  cls, op):.      
+00002470: 2020 6465 6620 6628 7365 6c66 293a 0a20    def f(self):. 
+00002480: 2020 2020 2020 2020 2020 206e 616d 6520             name 
+00002490: 3d20 6675 6e63 6e61 6d65 286f 7029 202b  = funcname(op) +
+000024a0: 2022 2d22 202b 2074 6f6b 656e 697a 6528   "-" + tokenize(
+000024b0: 7365 6c66 290a 2020 2020 2020 2020 2020  self).          
+000024c0: 2020 6473 6b20 3d20 7b28 6e61 6d65 2c20    dsk = {(name, 
+000024d0: 3029 3a20 286f 702c 2028 7365 6c66 2e5f  0): (op, (self._
+000024e0: 6e61 6d65 2c20 3029 297d 0a20 2020 2020  name, 0))}.     
+000024f0: 2020 2020 2020 206d 6574 6120 3d20 6f70         meta = op
+00002500: 2873 656c 662e 5f6d 6574 615f 6e6f 6e65  (self._meta_none
+00002510: 6d70 7479 290a 2020 2020 2020 2020 2020  mpty).          
+00002520: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+00002530: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+00002540: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
+00002550: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
+00002560: 733d 5b73 656c 665d 290a 2020 2020 2020  s=[self]).      
+00002570: 2020 2020 2020 7265 7475 726e 2053 6361        return Sca
+00002580: 6c61 7228 6772 6170 682c 206e 616d 652c  lar(graph, name,
+00002590: 206d 6574 6129 0a0a 2020 2020 2020 2020   meta)..        
+000025a0: 7265 7475 726e 2066 0a0a 2020 2020 4063  return f..    @c
+000025b0: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
+000025c0: 6566 205f 6765 745f 6269 6e61 7279 5f6f  ef _get_binary_o
+000025d0: 7065 7261 746f 7228 636c 732c 206f 702c  perator(cls, op,
+000025e0: 2069 6e76 3d46 616c 7365 293a 0a20 2020   inv=False):.   
+000025f0: 2020 2020 2072 6574 7572 6e20 6c61 6d62       return lamb
+00002600: 6461 2073 656c 662c 206f 7468 6572 3a20  da self, other: 
+00002610: 5f73 6361 6c61 725f 6269 6e61 7279 286f  _scalar_binary(o
+00002620: 702c 2073 656c 662c 206f 7468 6572 2c20  p, self, other, 
+00002630: 696e 763d 696e 7629 0a0a 2020 2020 6465  inv=inv)..    de
+00002640: 6620 746f 5f64 656c 6179 6564 2873 656c  f to_delayed(sel
+00002650: 662c 206f 7074 696d 697a 655f 6772 6170  f, optimize_grap
+00002660: 683d 5472 7565 293a 0a20 2020 2020 2020  h=True):.       
+00002670: 2022 2222 436f 6e76 6572 7420 696e 746f   """Convert into
+00002680: 2061 2060 6064 6173 6b2e 6465 6c61 7965   a ``dask.delaye
+00002690: 6460 6020 6f62 6a65 6374 2e0a 0a20 2020  d`` object...   
+000026a0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+000026b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000026c0: 2d2d 0a20 2020 2020 2020 206f 7074 696d  --.        optim
+000026d0: 697a 655f 6772 6170 6820 3a20 626f 6f6c  ize_graph : bool
+000026e0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+000026f0: 2020 2020 2020 2049 6620 5472 7565 205b         If True [
+00002700: 6465 6661 756c 745d 2c20 7468 6520 6772  default], the gr
+00002710: 6170 6820 6973 206f 7074 696d 697a 6564  aph is optimized
+00002720: 2062 6566 6f72 6520 636f 6e76 6572 7469   before converti
+00002730: 6e67 2069 6e74 6f0a 2020 2020 2020 2020  ng into.        
+00002740: 2020 2020 6060 6461 736b 2e64 656c 6179      ``dask.delay
+00002750: 6564 6060 206f 626a 6563 7473 2e0a 2020  ed`` objects..  
+00002760: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00002770: 2020 6473 6b20 3d20 7365 6c66 2e5f 5f64    dsk = self.__d
+00002780: 6173 6b5f 6772 6170 685f 5f28 290a 2020  ask_graph__().  
+00002790: 2020 2020 2020 6c61 7965 7220 3d20 7365        layer = se
+000027a0: 6c66 2e5f 5f64 6173 6b5f 6c61 7965 7273  lf.__dask_layers
+000027b0: 5f5f 2829 5b30 5d0a 2020 2020 2020 2020  __()[0].        
+000027c0: 6966 206f 7074 696d 697a 655f 6772 6170  if optimize_grap
+000027d0: 683a 0a20 2020 2020 2020 2020 2020 2064  h:.            d
+000027e0: 736b 203d 2073 656c 662e 5f5f 6461 736b  sk = self.__dask
+000027f0: 5f6f 7074 696d 697a 655f 5f28 6473 6b2c  _optimize__(dsk,
+00002800: 2073 656c 662e 5f5f 6461 736b 5f6b 6579   self.__dask_key
+00002810: 735f 5f28 2929 0a20 2020 2020 2020 2020  s__()).         
+00002820: 2020 206c 6179 6572 203d 2022 6465 6c61     layer = "dela
+00002830: 7965 642d 2220 2b20 7365 6c66 2e5f 6e61  yed-" + self._na
+00002840: 6d65 0a20 2020 2020 2020 2020 2020 2064  me.            d
+00002850: 736b 203d 2048 6967 684c 6576 656c 4772  sk = HighLevelGr
+00002860: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+00002870: 696f 6e73 286c 6179 6572 2c20 6473 6b2c  ions(layer, dsk,
+00002880: 2064 6570 656e 6465 6e63 6965 733d 2829   dependencies=()
+00002890: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000028a0: 2044 656c 6179 6564 2873 656c 662e 6b65   Delayed(self.ke
+000028b0: 792c 2064 736b 2c20 6c61 7965 723d 6c61  y, dsk, layer=la
+000028c0: 7965 7229 0a0a 0a64 6566 205f 7363 616c  yer)...def _scal
+000028d0: 6172 5f62 696e 6172 7928 6f70 2c20 7365  ar_binary(op, se
+000028e0: 6c66 2c20 6f74 6865 722c 2069 6e76 3d46  lf, other, inv=F
+000028f0: 616c 7365 293a 0a20 2020 206e 616d 6520  alse):.    name 
+00002900: 3d20 6622 7b66 756e 636e 616d 6528 6f70  = f"{funcname(op
+00002910: 297d 2d7b 746f 6b65 6e69 7a65 2873 656c  )}-{tokenize(sel
+00002920: 662c 206f 7468 6572 297d 220a 2020 2020  f, other)}".    
+00002930: 6465 7065 6e64 656e 6369 6573 203d 205b  dependencies = [
+00002940: 7365 6c66 5d0a 0a20 2020 2064 736b 203d  self]..    dsk =
+00002950: 207b 7d0a 2020 2020 7265 7475 726e 5f74   {}.    return_t
+00002960: 7970 6520 3d20 6765 745f 7061 7261 6c6c  ype = get_parall
+00002970: 656c 5f74 7970 6528 6f74 6865 7229 0a0a  el_type(other)..
+00002980: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00002990: 6528 6f74 6865 722c 2053 6361 6c61 7229  e(other, Scalar)
+000029a0: 3a0a 2020 2020 2020 2020 6465 7065 6e64  :.        depend
+000029b0: 656e 6369 6573 2e61 7070 656e 6428 6f74  encies.append(ot
+000029c0: 6865 7229 0a20 2020 2020 2020 206f 7468  her).        oth
+000029d0: 6572 5f6b 6579 203d 2028 6f74 6865 722e  er_key = (other.
+000029e0: 5f6e 616d 652c 2030 290a 2020 2020 656c  _name, 0).    el
+000029f0: 6966 2069 735f 6461 736b 5f63 6f6c 6c65  if is_dask_colle
+00002a00: 6374 696f 6e28 6f74 6865 7229 3a0a 2020  ction(other):.  
+00002a10: 2020 2020 2020 7265 7475 726e 204e 6f74        return Not
+00002a20: 496d 706c 656d 656e 7465 640a 2020 2020  Implemented.    
+00002a30: 656c 7365 3a0a 2020 2020 2020 2020 6f74  else:.        ot
+00002a40: 6865 725f 6b65 7920 3d20 6f74 6865 720a  her_key = other.
+00002a50: 0a20 2020 2064 736b 5b28 6e61 6d65 2c20  .    dsk[(name, 
+00002a60: 3029 5d20 3d20 280a 2020 2020 2020 2020  0)] = (.        
+00002a70: 286f 702c 206f 7468 6572 5f6b 6579 2c20  (op, other_key, 
+00002a80: 2873 656c 662e 5f6e 616d 652c 2030 2929  (self._name, 0))
+00002a90: 2069 6620 696e 7620 656c 7365 2028 6f70   if inv else (op
+00002aa0: 2c20 2873 656c 662e 5f6e 616d 652c 2030  , (self._name, 0
+00002ab0: 292c 206f 7468 6572 5f6b 6579 290a 2020  ), other_key).  
+00002ac0: 2020 290a 0a20 2020 206f 7468 6572 5f6d    )..    other_m
+00002ad0: 6574 6120 3d20 6d61 6b65 5f6d 6574 6128  eta = make_meta(
+00002ae0: 6f74 6865 722c 2070 6172 656e 745f 6d65  other, parent_me
+00002af0: 7461 3d73 656c 662e 5f70 6172 656e 745f  ta=self._parent_
+00002b00: 6d65 7461 290a 2020 2020 6f74 6865 725f  meta).    other_
+00002b10: 6d65 7461 5f6e 6f6e 656d 7074 7920 3d20  meta_nonempty = 
+00002b20: 6d65 7461 5f6e 6f6e 656d 7074 7928 6f74  meta_nonempty(ot
+00002b30: 6865 725f 6d65 7461 290a 2020 2020 6966  her_meta).    if
+00002b40: 2069 6e76 3a0a 2020 2020 2020 2020 6d65   inv:.        me
+00002b50: 7461 203d 206f 7028 6f74 6865 725f 6d65  ta = op(other_me
+00002b60: 7461 5f6e 6f6e 656d 7074 792c 2073 656c  ta_nonempty, sel
+00002b70: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
+00002b80: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+00002b90: 2020 2020 6d65 7461 203d 206f 7028 7365      meta = op(se
+00002ba0: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
+00002bb0: 792c 206f 7468 6572 5f6d 6574 615f 6e6f  y, other_meta_no
+00002bc0: 6e65 6d70 7479 290a 0a20 2020 2067 7261  nempty)..    gra
+00002bd0: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+00002be0: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+00002bf0: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
+00002c00: 6465 7065 6e64 656e 6369 6573 3d64 6570  dependencies=dep
+00002c10: 656e 6465 6e63 6965 7329 0a20 2020 2069  endencies).    i
+00002c20: 6620 7265 7475 726e 5f74 7970 6520 6973  f return_type is
+00002c30: 206e 6f74 2053 6361 6c61 723a 0a20 2020   not Scalar:.   
+00002c40: 2020 2020 2072 6574 7572 6e20 7265 7475       return retu
+00002c50: 726e 5f74 7970 6528 6772 6170 682c 206e  rn_type(graph, n
+00002c60: 616d 652c 206d 6574 612c 205b 6f74 6865  ame, meta, [othe
+00002c70: 722e 696e 6465 782e 6d69 6e28 292c 206f  r.index.min(), o
+00002c80: 7468 6572 2e69 6e64 6578 2e6d 6178 2829  ther.index.max()
+00002c90: 5d29 0a20 2020 2065 6c73 653a 0a20 2020  ]).    else:.   
+00002ca0: 2020 2020 2072 6574 7572 6e20 5363 616c       return Scal
+00002cb0: 6172 2867 7261 7068 2c20 6e61 6d65 2c20  ar(graph, name, 
+00002cc0: 6d65 7461 290a 0a0a 636c 6173 7320 5f46  meta)...class _F
+00002cd0: 7261 6d65 2844 6173 6b4d 6574 686f 6473  rame(DaskMethods
+00002ce0: 4d69 7869 6e2c 204f 7065 7261 746f 724d  Mixin, OperatorM
+00002cf0: 6574 686f 644d 6978 696e 293a 0a20 2020  ethodMixin):.   
+00002d00: 2022 2222 5375 7065 7263 6c61 7373 2066   """Superclass f
+00002d10: 6f72 2044 6174 6146 7261 6d65 2061 6e64  or DataFrame and
+00002d20: 2053 6572 6965 730a 0a20 2020 2050 6172   Series..    Par
+00002d30: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00002d40: 2d2d 2d2d 2d2d 0a20 2020 2064 736b 3a20  ------.    dsk: 
+00002d50: 6469 6374 0a20 2020 2020 2020 2054 6865  dict.        The
+00002d60: 2064 6173 6b20 6772 6170 6820 746f 2063   dask graph to c
+00002d70: 6f6d 7075 7465 2074 6869 7320 4461 7461  ompute this Data
+00002d80: 4672 616d 650a 2020 2020 6e61 6d65 3a20  Frame.    name: 
+00002d90: 7374 720a 2020 2020 2020 2020 5468 6520  str.        The 
+00002da0: 6b65 7920 7072 6566 6978 2074 6861 7420  key prefix that 
+00002db0: 7370 6563 6966 6965 7320 7768 6963 6820  specifies which 
+00002dc0: 6b65 7973 2069 6e20 7468 6520 6461 736b  keys in the dask
+00002dd0: 2063 6f6d 7072 6973 6520 7468 6973 0a20   comprise this. 
+00002de0: 2020 2020 2020 2070 6172 7469 6375 6c61         particula
+00002df0: 7220 4461 7461 4672 616d 6520 2f20 5365  r DataFrame / Se
+00002e00: 7269 6573 0a20 2020 206d 6574 613a 2070  ries.    meta: p
+00002e10: 616e 6461 732e 4461 7461 4672 616d 652c  andas.DataFrame,
+00002e20: 2070 616e 6461 732e 5365 7269 6573 2c20   pandas.Series, 
+00002e30: 6f72 2070 616e 6461 732e 496e 6465 780a  or pandas.Index.
+00002e40: 2020 2020 2020 2020 416e 2065 6d70 7479          An empty
+00002e50: 2070 616e 6461 7320 6f62 6a65 6374 2077   pandas object w
+00002e60: 6974 6820 6e61 6d65 732c 2064 7479 7065  ith names, dtype
+00002e70: 732c 2061 6e64 2069 6e64 6963 6573 206d  s, and indices m
+00002e80: 6174 6368 696e 6720 7468 650a 2020 2020  atching the.    
+00002e90: 2020 2020 6578 7065 6374 6564 206f 7574      expected out
+00002ea0: 7075 742e 0a20 2020 2064 6976 6973 696f  put..    divisio
+00002eb0: 6e73 3a20 7475 706c 6520 6f66 2069 6e64  ns: tuple of ind
+00002ec0: 6578 2076 616c 7565 730a 2020 2020 2020  ex values.      
+00002ed0: 2020 5661 6c75 6573 2061 6c6f 6e67 2077    Values along w
+00002ee0: 6869 6368 2077 6520 7061 7274 6974 696f  hich we partitio
+00002ef0: 6e20 6f75 7220 626c 6f63 6b73 206f 6e20  n our blocks on 
+00002f00: 7468 6520 696e 6465 780a 2020 2020 2222  the index.    ""
+00002f10: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
+00002f20: 745f 5f28 7365 6c66 2c20 6473 6b2c 206e  t__(self, dsk, n
+00002f30: 616d 652c 206d 6574 612c 2064 6976 6973  ame, meta, divis
+00002f40: 696f 6e73 293a 0a20 2020 2020 2020 2069  ions):.        i
+00002f50: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00002f60: 2864 736b 2c20 4869 6768 4c65 7665 6c47  (dsk, HighLevelG
+00002f70: 7261 7068 293a 0a20 2020 2020 2020 2020  raph):.         
+00002f80: 2020 2064 736b 203d 2048 6967 684c 6576     dsk = HighLev
+00002f90: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+00002fa0: 6c65 6374 696f 6e73 286e 616d 652c 2064  lections(name, d
+00002fb0: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
+00002fc0: 3d5b 5d29 0a20 2020 2020 2020 2073 656c  =[]).        sel
+00002fd0: 662e 6461 736b 203d 2064 736b 0a20 2020  f.dask = dsk.   
+00002fe0: 2020 2020 2073 656c 662e 5f6e 616d 6520       self._name 
+00002ff0: 3d20 6e61 6d65 0a20 2020 2020 2020 206d  = name.        m
+00003000: 6574 6120 3d20 6d61 6b65 5f6d 6574 6128  eta = make_meta(
+00003010: 6d65 7461 290a 2020 2020 2020 2020 6966  meta).        if
+00003020: 206e 6f74 2073 656c 662e 5f69 735f 7061   not self._is_pa
+00003030: 7274 6974 696f 6e5f 7479 7065 286d 6574  rtition_type(met
+00003040: 6129 3a0a 2020 2020 2020 2020 2020 2020  a):.            
+00003050: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00003060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003070: 2066 2245 7870 6563 7465 6420 6d65 7461   f"Expected meta
+00003080: 2074 6f20 7370 6563 6966 7920 7479 7065   to specify type
+00003090: 207b 7479 7065 2873 656c 6629 2e5f 5f6e   {type(self).__n
+000030a0: 616d 655f 5f7d 2c20 676f 7420 7479 7065  ame__}, got type
+000030b0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+000030c0: 2020 2066 227b 7479 7065 6e61 6d65 2874     f"{typename(t
+000030d0: 7970 6528 6d65 7461 2929 7d22 0a20 2020  ype(meta))}".   
+000030e0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000030f0: 2020 2073 656c 662e 5f6d 6574 6120 3d20     self._meta = 
+00003100: 6d65 7461 0a20 2020 2020 2020 2073 656c  meta.        sel
+00003110: 662e 6469 7669 7369 6f6e 7320 3d20 7475  f.divisions = tu
+00003120: 706c 6528 6469 7669 7369 6f6e 7329 0a0a  ple(divisions)..
+00003130: 2020 2020 2020 2020 2320 4f70 7469 6f6e          # Option
+00003140: 616c 6c79 2063 6173 7420 6f62 6a65 6374  ally cast object
+00003150: 2064 7479 7065 7320 746f 2060 7079 6172   dtypes to `pyar
+00003160: 726f 7760 2073 7472 696e 6773 0a20 2020  row` strings.   
+00003170: 2020 2020 2069 6620 6461 736b 2e63 6f6e       if dask.con
+00003180: 6669 672e 6765 7428 2264 6174 6166 7261  fig.get("datafra
+00003190: 6d65 2e63 6f6e 7665 7274 2d73 7472 696e  me.convert-strin
+000031a0: 6722 293a 0a20 2020 2020 2020 2020 2020  g"):.           
+000031b0: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+000031c0: 7261 6d65 2e5f 7079 6172 726f 7720 696d  rame._pyarrow im
+000031d0: 706f 7274 2063 6865 636b 5f70 7961 7272  port check_pyarr
+000031e0: 6f77 5f73 7472 696e 675f 7375 7070 6f72  ow_string_suppor
+000031f0: 7465 640a 0a20 2020 2020 2020 2020 2020  ted..           
+00003200: 2063 6865 636b 5f70 7961 7272 6f77 5f73   check_pyarrow_s
+00003210: 7472 696e 675f 7375 7070 6f72 7465 6428  tring_supported(
+00003220: 290a 0a20 2020 2020 2020 2020 2020 2066  )..            f
+00003230: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+00003240: 6d65 2e5f 7079 6172 726f 7720 696d 706f  me._pyarrow impo
+00003250: 7274 2028 0a20 2020 2020 2020 2020 2020  rt (.           
+00003260: 2020 2020 2069 735f 6f62 6a65 6374 5f73       is_object_s
+00003270: 7472 696e 675f 6461 7461 6672 616d 652c  tring_dataframe,
+00003280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003290: 2069 735f 6f62 6a65 6374 5f73 7472 696e   is_object_strin
+000032a0: 675f 6474 7970 652c 0a20 2020 2020 2020  g_dtype,.       
+000032b0: 2020 2020 2020 2020 2069 735f 6f62 6a65           is_obje
+000032c0: 6374 5f73 7472 696e 675f 696e 6465 782c  ct_string_index,
+000032d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000032e0: 2069 735f 6f62 6a65 6374 5f73 7472 696e   is_object_strin
+000032f0: 675f 7365 7269 6573 2c0a 2020 2020 2020  g_series,.      
+00003300: 2020 2020 2020 2020 2020 746f 5f70 7961            to_pya
+00003310: 7272 6f77 5f73 7472 696e 672c 0a20 2020  rrow_string,.   
+00003320: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00003330: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
+00003340: 2020 2020 2020 2020 2020 2020 2069 735f               is_
+00003350: 6f62 6a65 6374 5f73 7472 696e 675f 6461  object_string_da
+00003360: 7461 6672 616d 6528 6d65 7461 290a 2020  taframe(meta).  
+00003370: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+00003380: 2069 735f 6f62 6a65 6374 5f73 7472 696e   is_object_strin
+00003390: 675f 7365 7269 6573 286d 6574 6129 0a20  g_series(meta). 
+000033a0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000033b0: 7220 6973 5f6f 626a 6563 745f 7374 7269  r is_object_stri
+000033c0: 6e67 5f69 6e64 6578 286d 6574 6129 0a20  ng_index(meta). 
+000033d0: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+000033e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000033f0: 5072 696f 7220 746f 2070 616e 6461 733d  Prior to pandas=
+00003400: 312e 342c 2060 7064 2e49 6e64 6578 6020  1.4, `pd.Index` 
+00003410: 636f 756c 646e 2774 2063 6f6e 7461 696e  couldn't contain
+00003420: 2065 7874 656e 7369 6f6e 2064 7479 7065   extension dtype
+00003430: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
+00003440: 2020 2023 2048 6572 6520 7765 2064 6f6e     # Here we don
+00003450: 2774 2063 6173 7420 6f62 6a65 6374 7320  't cast objects 
+00003460: 746f 2070 7961 7272 6f77 2073 7472 696e  to pyarrow strin
+00003470: 6773 2077 6865 7265 206f 6e6c 7920 7468  gs where only th
+00003480: 6520 696e 6465 780a 2020 2020 2020 2020  e index.        
+00003490: 2020 2020 2020 2020 2320 636f 6e74 6169          # contai
+000034a0: 6e73 206e 6f6e 2d70 7961 7272 6f77 2073  ns non-pyarrow s
+000034b0: 7472 696e 6720 6461 7461 2e0a 2020 2020  tring data..    
+000034c0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+000034d0: 6f74 2050 414e 4441 535f 4754 5f31 3430  ot PANDAS_GT_140
+000034e0: 2061 6e64 2028 0a20 2020 2020 2020 2020   and (.         
+000034f0: 2020 2020 2020 2020 2020 2028 0a20 2020             (.   
+00003500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003510: 2020 2020 2069 735f 6f62 6a65 6374 5f73       is_object_s
+00003520: 7472 696e 675f 6461 7461 6672 616d 6528  tring_dataframe(
+00003530: 6d65 7461 290a 2020 2020 2020 2020 2020  meta).          
+00003540: 2020 2020 2020 2020 2020 2020 2020 616e                an
+00003550: 6420 6e6f 7420 616e 7928 6973 5f6f 626a  d not any(is_obj
+00003560: 6563 745f 7374 7269 6e67 5f64 7479 7065  ect_string_dtype
+00003570: 2864 2920 666f 7220 6420 696e 206d 6574  (d) for d in met
+00003580: 612e 6474 7970 6573 290a 2020 2020 2020  a.dtypes).      
+00003590: 2020 2020 2020 2020 2020 2020 2020 290a                ).
 000035a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000035b0: 2061 6e64 206e 6f74 2069 735f 6f62 6a65   and not is_obje
-000035c0: 6374 5f73 7472 696e 675f 6474 7970 6528  ct_string_dtype(
-000035d0: 6d65 7461 2e64 7479 7065 290a 2020 2020  meta.dtype).    
-000035e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000035f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00003600: 2020 2020 2020 6f72 2069 735f 6f62 6a65        or is_obje
-00003610: 6374 5f73 7472 696e 675f 696e 6465 7828  ct_string_index(
-00003620: 6d65 7461 290a 2020 2020 2020 2020 2020  meta).          
-00003630: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00003640: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00003650: 7572 6e0a 0a20 2020 2020 2020 2020 2020  urn..           
-00003660: 2020 2020 2023 2074 6869 7320 6973 2061       # this is a
-00003670: 6e20 696e 7465 726e 616c 2063 616c 6c2c  n internal call,
-00003680: 2061 6e64 2069 6620 7765 2065 6e66 6f72   and if we enfor
-00003690: 6365 206d 6574 6164 6174 612c 0a20 2020  ce metadata,.   
-000036a0: 2020 2020 2020 2020 2020 2020 2023 2069               # i
-000036b0: 7420 6d61 7920 696e 7465 7266 6572 6520  t may interfere 
-000036c0: 7768 656e 2072 6561 6469 6e67 2063 7376  when reading csv
-000036d0: 2077 6974 6820 656e 666f 7263 653d 4661   with enforce=Fa
-000036e0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-000036f0: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
-00003700: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-00003710: 2874 6f5f 7079 6172 726f 775f 7374 7269  (to_pyarrow_stri
-00003720: 6e67 2c20 656e 666f 7263 655f 6d65 7461  ng, enforce_meta
-00003730: 6461 7461 3d46 616c 7365 290a 2020 2020  data=False).    
-00003740: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00003750: 2e64 6173 6b20 3d20 7265 7375 6c74 2e64  .dask = result.d
-00003760: 6173 6b0a 2020 2020 2020 2020 2020 2020  ask.            
-00003770: 2020 2020 7365 6c66 2e5f 6e61 6d65 203d      self._name =
-00003780: 2072 6573 756c 742e 5f6e 616d 650a 2020   result._name.  
-00003790: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000037a0: 6c66 2e5f 6d65 7461 203d 2072 6573 756c  lf._meta = resul
-000037b0: 742e 5f6d 6574 610a 2020 2020 2020 2020  t._meta.        
-000037c0: 2020 2020 2020 2020 7365 6c66 2e64 6976          self.div
-000037d0: 6973 696f 6e73 203d 2072 6573 756c 742e  isions = result.
-000037e0: 6469 7669 7369 6f6e 730a 0a20 2020 2064  divisions..    d
-000037f0: 6566 205f 5f64 6173 6b5f 6772 6170 685f  ef __dask_graph_
-00003800: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00003810: 2072 6574 7572 6e20 7365 6c66 2e64 6173   return self.das
-00003820: 6b0a 0a20 2020 2064 6566 205f 5f64 6173  k..    def __das
-00003830: 6b5f 6b65 7973 5f5f 2873 656c 6629 202d  k_keys__(self) -
-00003840: 3e20 6c69 7374 5b48 6173 6861 626c 655d  > list[Hashable]
-00003850: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00003860: 205b 2873 656c 662e 5f6e 616d 652c 2069   [(self._name, i
-00003870: 2920 666f 7220 6920 696e 2072 616e 6765  ) for i in range
-00003880: 2873 656c 662e 6e70 6172 7469 7469 6f6e  (self.npartition
-00003890: 7329 5d0a 0a20 2020 2064 6566 205f 5f64  s)]..    def __d
-000038a0: 6173 6b5f 6c61 7965 7273 5f5f 2873 656c  ask_layers__(sel
-000038b0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-000038c0: 726e 2028 7365 6c66 2e5f 6e61 6d65 2c29  rn (self._name,)
-000038d0: 0a0a 2020 2020 6465 6620 5f5f 6461 736b  ..    def __dask
-000038e0: 5f74 6f6b 656e 697a 655f 5f28 7365 6c66  _tokenize__(self
-000038f0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00003900: 6e20 7365 6c66 2e5f 6e61 6d65 0a0a 2020  n self._name..  
-00003910: 2020 5f5f 6461 736b 5f6f 7074 696d 697a    __dask_optimiz
-00003920: 655f 5f20 3d20 676c 6f62 616c 6d65 7468  e__ = globalmeth
-00003930: 6f64 280a 2020 2020 2020 2020 6f70 7469  od(.        opti
-00003940: 6d69 7a65 2c20 6b65 793d 2264 6174 6166  mize, key="dataf
-00003950: 7261 6d65 5f6f 7074 696d 697a 6522 2c20  rame_optimize", 
-00003960: 6661 6c73 6579 3d64 6f6e 745f 6f70 7469  falsey=dont_opti
-00003970: 6d69 7a65 0a20 2020 2029 0a20 2020 205f  mize.    ).    _
-00003980: 5f64 6173 6b5f 7363 6865 6475 6c65 725f  _dask_scheduler_
-00003990: 5f20 3d20 7374 6174 6963 6d65 7468 6f64  _ = staticmethod
-000039a0: 2844 4546 4155 4c54 5f47 4554 290a 0a20  (DEFAULT_GET).. 
-000039b0: 2020 2064 6566 205f 5f64 6173 6b5f 706f     def __dask_po
-000039c0: 7374 636f 6d70 7574 655f 5f28 7365 6c66  stcompute__(self
-000039d0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-000039e0: 6e20 6669 6e61 6c69 7a65 2c20 2829 0a0a  n finalize, ()..
-000039f0: 2020 2020 6465 6620 5f5f 6461 736b 5f70      def __dask_p
-00003a00: 6f73 7470 6572 7369 7374 5f5f 2873 656c  ostpersist__(sel
-00003a10: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00003a20: 726e 2073 656c 662e 5f72 6562 7569 6c64  rn self._rebuild
-00003a30: 2c20 2829 0a0a 2020 2020 6465 6620 5f72  , ()..    def _r
-00003a40: 6562 7569 6c64 2873 656c 662c 2064 736b  ebuild(self, dsk
-00003a50: 2c20 2a2c 2072 656e 616d 653d 4e6f 6e65  , *, rename=None
-00003a60: 293a 0a20 2020 2020 2020 206e 616d 6520  ):.        name 
-00003a70: 3d20 7365 6c66 2e5f 6e61 6d65 0a20 2020  = self._name.   
-00003a80: 2020 2020 2069 6620 7265 6e61 6d65 3a0a       if rename:.
-00003a90: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00003aa0: 203d 2072 656e 616d 652e 6765 7428 6e61   = rename.get(na
-00003ab0: 6d65 2c20 6e61 6d65 290a 2020 2020 2020  me, name).      
-00003ac0: 2020 7265 7475 726e 2074 7970 6528 7365    return type(se
-00003ad0: 6c66 2928 6473 6b2c 206e 616d 652c 2073  lf)(dsk, name, s
-00003ae0: 656c 662e 5f6d 6574 612c 2073 656c 662e  elf._meta, self.
-00003af0: 6469 7669 7369 6f6e 7329 0a0a 2020 2020  divisions)..    
-00003b00: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00003b10: 6620 5f63 6f6e 7374 7275 6374 6f72 2873  f _constructor(s
-00003b20: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00003b30: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
-00003b40: 6374 0a0a 2020 2020 4070 726f 7065 7274  ct..    @propert
-00003b50: 790a 2020 2020 6465 6620 6469 7669 7369  y.    def divisi
-00003b60: 6f6e 7328 7365 6c66 293a 0a20 2020 2020  ons(self):.     
-00003b70: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
-00003b80: 7570 6c65 206f 6620 6060 6e70 6172 7469  uple of ``nparti
-00003b90: 7469 6f6e 7320 2b20 3160 6020 7661 6c75  tions + 1`` valu
-00003ba0: 6573 2c20 696e 2061 7363 656e 6469 6e67  es, in ascending
-00003bb0: 206f 7264 6572 2c20 6d61 726b 696e 6720   order, marking 
-00003bc0: 7468 650a 2020 2020 2020 2020 6c6f 7765  the.        lowe
-00003bd0: 722f 7570 7065 7220 626f 756e 6473 206f  r/upper bounds o
-00003be0: 6620 6561 6368 2070 6172 7469 7469 6f6e  f each partition
-00003bf0: 2773 2069 6e64 6578 2e20 4469 7669 7369  's index. Divisi
-00003c00: 6f6e 7320 616c 6c6f 7720 4461 736b 0a20  ons allow Dask. 
-00003c10: 2020 2020 2020 2074 6f20 6b6e 6f77 2077         to know w
-00003c20: 6869 6368 2070 6172 7469 7469 6f6e 2077  hich partition w
-00003c30: 696c 6c20 636f 6e74 6169 6e20 6120 6769  ill contain a gi
-00003c40: 7665 6e20 7661 6c75 652c 2073 6967 6e69  ven value, signi
-00003c50: 6669 6361 6e74 6c79 0a20 2020 2020 2020  ficantly.       
-00003c60: 2073 7065 6564 696e 6720 7570 206f 7065   speeding up ope
-00003c70: 7261 7469 6f6e 7320 6c69 6b65 2060 6c6f  rations like `lo
-00003c80: 6360 2c20 606d 6572 6765 602c 2061 6e64  c`, `merge`, and
-00003c90: 2060 6772 6f75 7062 7960 2062 7920 6e6f   `groupby` by no
-00003ca0: 740a 2020 2020 2020 2020 6861 7669 6e67  t.        having
-00003cb0: 2074 6f20 7365 6172 6368 2074 6865 2066   to search the f
-00003cc0: 756c 6c20 6461 7461 7365 742e 0a0a 2020  ull dataset...  
-00003cd0: 2020 2020 2020 4578 616d 706c 653a 2066        Example: f
-00003ce0: 6f72 2060 6064 6976 6973 696f 6e73 203d  or ``divisions =
-00003cf0: 2028 302c 2031 302c 2035 302c 2031 3030   (0, 10, 50, 100
-00003d00: 2960 602c 2074 6865 7265 2061 7265 2074  )``, there are t
-00003d10: 6872 6565 2070 6172 7469 7469 6f6e 732c  hree partitions,
-00003d20: 0a20 2020 2020 2020 2077 6865 7265 2074  .        where t
-00003d30: 6865 2069 6e64 6578 2069 6e20 6561 6368  he index in each
-00003d40: 2070 6172 7469 7469 6f6e 2063 6f6e 7461   partition conta
-00003d50: 696e 7320 7661 6c75 6573 205b 302c 2031  ins values [0, 1
-00003d60: 3029 2c20 5b31 302c 2035 3029 2c0a 2020  0), [10, 50),.  
-00003d70: 2020 2020 2020 616e 6420 5b35 302c 2031        and [50, 1
-00003d80: 3030 5d2c 2072 6573 7065 6374 6976 656c  00], respectivel
-00003d90: 792e 2044 6173 6b20 7468 6572 6566 6f72  y. Dask therefor
-00003da0: 6520 6b6e 6f77 7320 6060 6466 2e6c 6f63  e knows ``df.loc
-00003db0: 5b34 355d 6060 0a20 2020 2020 2020 2077  [45]``.        w
-00003dc0: 696c 6c20 6265 2069 6e20 7468 6520 7365  ill be in the se
-00003dd0: 636f 6e64 2070 6172 7469 7469 6f6e 2e0a  cond partition..
-00003de0: 0a20 2020 2020 2020 2057 6865 6e20 6576  .        When ev
-00003df0: 6572 7920 6974 656d 2069 6e20 6060 6469  ery item in ``di
-00003e00: 7669 7369 6f6e 7360 6020 6973 2060 604e  visions`` is ``N
-00003e10: 6f6e 6560 602c 2074 6865 2064 6976 6973  one``, the divis
-00003e20: 696f 6e73 2061 7265 2075 6e6b 6e6f 776e  ions are unknown
-00003e30: 2e0a 2020 2020 2020 2020 4d6f 7374 206f  ..        Most o
-00003e40: 7065 7261 7469 6f6e 7320 6361 6e20 7374  perations can st
-00003e50: 696c 6c20 6265 2070 6572 666f 726d 6564  ill be performed
-00003e60: 2c20 6275 7420 736f 6d65 2077 696c 6c20  , but some will 
-00003e70: 6265 206d 7563 6820 736c 6f77 6572 2c0a  be much slower,.
-00003e80: 2020 2020 2020 2020 616e 6420 6120 6665          and a fe
-00003e90: 7720 6d61 7920 6661 696c 2e0a 0a20 2020  w may fail...   
-00003ea0: 2020 2020 2049 7420 6973 2075 6e63 6f6d       It is uncom
-00003eb0: 6d6f 6e20 746f 2073 6574 2060 6064 6976  mon to set ``div
-00003ec0: 6973 696f 6e73 6060 2064 6972 6563 746c  isions`` directl
-00003ed0: 792e 2049 6e73 7465 6164 2c20 7573 6520  y. Instead, use 
-00003ee0: 6060 7365 745f 696e 6465 7860 602c 0a20  ``set_index``,. 
-00003ef0: 2020 2020 2020 2077 6869 6368 2073 6f72         which sor
-00003f00: 7473 2061 6e64 2073 706c 6974 7320 7468  ts and splits th
-00003f10: 6520 6461 7461 2061 7320 6e65 6564 6564  e data as needed
-00003f20: 2e0a 2020 2020 2020 2020 5365 6520 6874  ..        See ht
-00003f30: 7470 733a 2f2f 646f 6373 2e64 6173 6b2e  tps://docs.dask.
-00003f40: 6f72 672f 656e 2f6c 6174 6573 742f 6461  org/en/latest/da
-00003f50: 7461 6672 616d 652d 6465 7369 676e 2e68  taframe-design.h
-00003f60: 746d 6c23 7061 7274 6974 696f 6e73 2e0a  tml#partitions..
-00003f70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00003f80: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00003f90: 5f64 6976 6973 696f 6e73 0a0a 2020 2020  _divisions..    
-00003fa0: 4064 6976 6973 696f 6e73 2e73 6574 7465  @divisions.sette
-00003fb0: 720a 2020 2020 6465 6620 6469 7669 7369  r.    def divisi
-00003fc0: 6f6e 7328 7365 6c66 2c20 7661 6c75 6529  ons(self, value)
-00003fd0: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
-00003fe0: 2069 7369 6e73 7461 6e63 6528 7661 6c75   isinstance(valu
-00003ff0: 652c 2074 7570 6c65 293a 0a20 2020 2020  e, tuple):.     
-00004000: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00004010: 6545 7272 6f72 2822 6469 7669 7369 6f6e  eError("division
-00004020: 7320 6d75 7374 2062 6520 6120 7475 706c  s must be a tupl
-00004030: 6522 290a 0a20 2020 2020 2020 2069 6620  e")..        if 
-00004040: 6861 7361 7474 7228 7365 6c66 2c20 225f  hasattr(self, "_
-00004050: 6469 7669 7369 6f6e 7322 2920 616e 6420  divisions") and 
-00004060: 6c65 6e28 7661 6c75 6529 2021 3d20 6c65  len(value) != le
-00004070: 6e28 7365 6c66 2e5f 6469 7669 7369 6f6e  n(self._division
-00004080: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00004090: 6e20 3d20 6c65 6e28 7365 6c66 2e5f 6469  n = len(self._di
-000040a0: 7669 7369 6f6e 7329 0a20 2020 2020 2020  visions).       
-000040b0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000040c0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-000040d0: 2020 2020 2020 2066 2254 6869 7320 6461         f"This da
-000040e0: 7461 6672 616d 6520 6861 7320 6e70 6172  taframe has npar
-000040f0: 7469 7469 6f6e 733d 7b6e 202d 2031 7d2c  titions={n - 1},
-00004100: 2064 6976 6973 696f 6e73 2073 686f 756c   divisions shoul
-00004110: 6420 6265 2061 2022 0a20 2020 2020 2020  d be a ".       
-00004120: 2020 2020 2020 2020 2066 2274 7570 6c65           f"tuple
-00004130: 206f 6620 6c65 6e67 7468 3d7b 6e7d 2c20   of length={n}, 
-00004140: 676f 7420 7b6c 656e 2876 616c 7565 297d  got {len(value)}
-00004150: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00004160: 0a20 2020 2020 2020 2069 6620 4e6f 6e65  .        if None
-00004170: 2069 6e20 7661 6c75 653a 0a20 2020 2020   in value:.     
-00004180: 2020 2020 2020 2069 6620 616e 7928 7620         if any(v 
-00004190: 6973 206e 6f74 204e 6f6e 6520 666f 7220  is not None for 
-000041a0: 7620 696e 2076 616c 7565 293a 0a20 2020  v in value):.   
-000041b0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-000041c0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-000041d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000041e0: 2020 2022 6469 7669 7369 6f6e 7320 6d61     "divisions ma
-000041f0: 7920 6e6f 7420 636f 6e74 6169 6e20 6120  y not contain a 
-00004200: 6d69 7820 6f66 204e 6f6e 6520 616e 6420  mix of None and 
-00004210: 6e6f 6e2d 4e6f 6e65 2076 616c 7565 7322  non-None values"
-00004220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004230: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
-00004240: 0a20 2020 2020 2020 2020 2020 2023 204b  .            # K
-00004250: 6e6f 776e 2064 6976 6973 696f 6e73 2c20  nown divisions, 
-00004260: 6368 6563 6b20 6d6f 6e6f 746f 6e69 6361  check monotonica
-00004270: 6c6c 7920 696e 6372 6561 7369 6e67 0a0a  lly increasing..
-00004280: 2020 2020 2020 2020 2020 2020 2320 5858              # XX
-00004290: 583a 2069 6620 7468 6520 696e 6465 7820  X: if the index 
-000042a0: 6474 7970 6520 6973 2061 6e20 6f72 6465  dtype is an orde
-000042b0: 7265 6420 6361 7465 676f 7269 6361 6c20  red categorical 
-000042c0: 6474 7970 652c 2074 6865 6e20 7765 2073  dtype, then we s
-000042d0: 6b69 7020 7468 650a 2020 2020 2020 2020  kip the.        
-000042e0: 2020 2020 2320 736f 7274 6564 6e65 7373      # sortedness
-000042f0: 2063 6865 636b 2c20 7369 6e63 6520 7468   check, since th
-00004300: 6520 6f72 6465 7220 6973 2064 7479 7065  e order is dtype
-00004310: 2064 6570 656e 6465 6e74 0a20 2020 2020   dependent.     
-00004320: 2020 2020 2020 2069 6e64 6578 5f64 7479         index_dty
-00004330: 7065 203d 2067 6574 6174 7472 2873 656c  pe = getattr(sel
-00004340: 662e 5f6d 6574 612c 2022 696e 6465 7822  f._meta, "index"
-00004350: 2c20 7365 6c66 2e5f 6d65 7461 292e 6474  , self._meta).dt
-00004360: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
-00004370: 6966 206e 6f74 2028 0a20 2020 2020 2020  if not (.       
-00004380: 2020 2020 2020 2020 2069 7369 6e73 7461           isinsta
-00004390: 6e63 6528 696e 6465 785f 6474 7970 652c  nce(index_dtype,
-000043a0: 2070 642e 4361 7465 676f 7269 6361 6c44   pd.CategoricalD
-000043b0: 7479 7065 2920 616e 6420 696e 6465 785f  type) and index_
-000043c0: 6474 7970 652e 6f72 6465 7265 640a 2020  dtype.ordered.  
-000043d0: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
-000043e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000043f0: 7661 6c75 6520 213d 2074 7570 6c65 2873  value != tuple(s
-00004400: 6f72 7465 6428 7661 6c75 6529 293a 0a20  orted(value)):. 
-00004410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004420: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00004430: 726f 7228 2264 6976 6973 696f 6e73 206d  ror("divisions m
-00004440: 7573 7420 6265 2073 6f72 7465 6422 290a  ust be sorted").
-00004450: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
-00004460: 6976 6973 696f 6e73 203d 2076 616c 7565  ivisions = value
-00004470: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00004480: 2020 2020 6465 6620 6e70 6172 7469 7469      def npartiti
-00004490: 6f6e 7328 7365 6c66 2920 2d3e 2069 6e74  ons(self) -> int
-000044a0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-000044b0: 7572 6e20 6e75 6d62 6572 206f 6620 7061  urn number of pa
-000044c0: 7274 6974 696f 6e73 2222 220a 2020 2020  rtitions""".    
-000044d0: 2020 2020 7265 7475 726e 206c 656e 2873      return len(s
-000044e0: 656c 662e 6469 7669 7369 6f6e 7329 202d  elf.divisions) -
-000044f0: 2031 0a0a 2020 2020 4070 726f 7065 7274   1..    @propert
-00004500: 790a 2020 2020 4064 6572 6976 6564 5f66  y.    @derived_f
-00004510: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-00004520: 290a 2020 2020 6465 6620 6174 7472 7328  ).    def attrs(
-00004530: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00004540: 6574 7572 6e20 7365 6c66 2e5f 6d65 7461  eturn self._meta
-00004550: 2e61 7474 7273 0a0a 2020 2020 4061 7474  .attrs..    @att
-00004560: 7273 2e73 6574 7465 720a 2020 2020 6465  rs.setter.    de
-00004570: 6620 6174 7472 7328 7365 6c66 2c20 7661  f attrs(self, va
-00004580: 6c75 6529 3a0a 2020 2020 2020 2020 7365  lue):.        se
-00004590: 6c66 2e5f 6d65 7461 2e61 7474 7273 203d  lf._meta.attrs =
-000045a0: 2064 6963 7428 7661 6c75 6529 0a0a 2020   dict(value)..  
-000045b0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-000045c0: 6465 6620 7369 7a65 2873 656c 6629 3a0a  def size(self):.
-000045d0: 2020 2020 2020 2020 2222 2253 697a 6520          """Size 
-000045e0: 6f66 2074 6865 2053 6572 6965 7320 6f72  of the Series or
-000045f0: 2044 6174 6146 7261 6d65 2061 7320 6120   DataFrame as a 
-00004600: 4465 6c61 7965 6420 6f62 6a65 6374 2e0a  Delayed object..
-00004610: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-00004620: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00004630: 2d2d 0a20 2020 2020 2020 203e 3e3e 2073  --.        >>> s
-00004640: 6572 6965 732e 7369 7a65 2020 2320 646f  eries.size  # do
-00004650: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
-00004660: 2020 2020 2064 642e 5363 616c 6172 3c73       dd.Scalar<s
-00004670: 697a 652d 6167 2e2e 2e2c 2064 7479 7065  ize-ag..., dtype
-00004680: 3d69 6e74 3634 3e0a 2020 2020 2020 2020  =int64>.        
-00004690: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-000046a0: 726e 2073 656c 662e 7265 6475 6374 696f  rn self.reductio
-000046b0: 6e28 0a20 2020 2020 2020 2020 2020 206d  n(.            m
-000046c0: 6574 686f 6473 2e73 697a 652c 206e 702e  ethods.size, np.
-000046d0: 7375 6d2c 2074 6f6b 656e 3d22 7369 7a65  sum, token="size
-000046e0: 222c 206d 6574 613d 696e 742c 2073 706c  ", meta=int, spl
-000046f0: 6974 5f65 7665 7279 3d46 616c 7365 0a20  it_every=False. 
-00004700: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
-00004710: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00004720: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2873  _meta_nonempty(s
-00004730: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00004740: 2241 206e 6f6e 2d65 6d70 7479 2076 6572  "A non-empty ver
-00004750: 7369 6f6e 206f 6620 605f 6d65 7461 6020  sion of `_meta` 
-00004760: 7769 7468 2066 616b 6520 6461 7461 2e22  with fake data."
-00004770: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00004780: 6e20 6d65 7461 5f6e 6f6e 656d 7074 7928  n meta_nonempty(
-00004790: 7365 6c66 2e5f 6d65 7461 290a 0a20 2020  self._meta)..   
-000047a0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-000047b0: 6566 205f 6172 6773 2873 656c 6629 3a0a  ef _args(self):.
-000047c0: 2020 2020 2020 2020 7265 7475 726e 2028          return (
-000047d0: 7365 6c66 2e64 6173 6b2c 2073 656c 662e  self.dask, self.
-000047e0: 5f6e 616d 652c 2073 656c 662e 5f6d 6574  _name, self._met
-000047f0: 612c 2073 656c 662e 6469 7669 7369 6f6e  a, self.division
-00004800: 7329 0a0a 2020 2020 6465 6620 5f5f 6765  s)..    def __ge
-00004810: 7473 7461 7465 5f5f 2873 656c 6629 3a0a  tstate__(self):.
-00004820: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00004830: 656c 662e 5f61 7267 730a 0a20 2020 2064  elf._args..    d
-00004840: 6566 205f 5f73 6574 7374 6174 655f 5f28  ef __setstate__(
-00004850: 7365 6c66 2c20 7374 6174 6529 3a0a 2020  self, state):.  
-00004860: 2020 2020 2020 7365 6c66 2e64 6173 6b2c        self.dask,
-00004870: 2073 656c 662e 5f6e 616d 652c 2073 656c   self._name, sel
-00004880: 662e 5f6d 6574 612c 2073 656c 662e 5f64  f._meta, self._d
-00004890: 6976 6973 696f 6e73 203d 2073 7461 7465  ivisions = state
-000048a0: 0a0a 2020 2020 6465 6620 636f 7079 2873  ..    def copy(s
-000048b0: 656c 662c 2064 6565 703d 4661 6c73 6529  elf, deep=False)
-000048c0: 3a0a 2020 2020 2020 2020 2222 224d 616b  :.        """Mak
-000048d0: 6520 6120 636f 7079 206f 6620 7468 6520  e a copy of the 
-000048e0: 6461 7461 6672 616d 650a 0a20 2020 2020  dataframe..     
-000048f0: 2020 2054 6869 7320 6973 2073 7472 6963     This is stric
-00004900: 746c 7920 6120 7368 616c 6c6f 7720 636f  tly a shallow co
-00004910: 7079 206f 6620 7468 6520 756e 6465 726c  py of the underl
-00004920: 7969 6e67 2063 6f6d 7075 7461 7469 6f6e  ying computation
-00004930: 616c 2067 7261 7068 2e0a 2020 2020 2020  al graph..      
-00004940: 2020 4974 2064 6f65 7320 6e6f 7420 6166    It does not af
-00004950: 6665 6374 2074 6865 2075 6e64 6572 6c79  fect the underly
-00004960: 696e 6720 6461 7461 0a0a 2020 2020 2020  ing data..      
-00004970: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00004980: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00004990: 2020 2020 2020 2020 6465 6570 203a 2062          deep : b
-000049a0: 6f6f 6c65 616e 2c20 6465 6661 756c 7420  oolean, default 
-000049b0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-000049c0: 2020 5468 6520 6465 6570 2076 616c 7565    The deep value
-000049d0: 206d 7573 7420 6265 2060 4661 6c73 6560   must be `False`
-000049e0: 2061 6e64 2069 7420 6973 2064 6563 6c61   and it is decla
-000049f0: 7265 6420 6173 2061 2070 6172 616d 6574  red as a paramet
-00004a00: 6572 206a 7573 7420 666f 720a 2020 2020  er just for.    
-00004a10: 2020 2020 2020 2020 636f 6d70 6174 6962          compatib
-00004a20: 696c 6974 7920 7769 7468 2074 6869 7264  ility with third
-00004a30: 2d70 6172 7479 206c 6962 7261 7269 6573  -party libraries
-00004a40: 206c 696b 6520 6375 4446 0a20 2020 2020   like cuDF.     
-00004a50: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00004a60: 6620 6465 6570 2069 7320 6e6f 7420 4661  f deep is not Fa
-00004a70: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00004a80: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00004a90: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00004aa0: 2020 2022 5468 6520 6064 6565 7060 2076     "The `deep` v
-00004ab0: 616c 7565 206d 7573 7420 6265 2046 616c  alue must be Fal
-00004ac0: 7365 2e20 5468 6973 2069 7320 7374 7269  se. This is stri
-00004ad0: 6374 6c79 2061 2073 6861 6c6c 6f77 2063  ctly a shallow c
-00004ae0: 6f70 7920 220a 2020 2020 2020 2020 2020  opy ".          
-00004af0: 2020 2020 2020 226f 6620 7468 6520 756e        "of the un
-00004b00: 6465 726c 7969 6e67 2063 6f6d 7075 7461  derlying computa
-00004b10: 7469 6f6e 616c 2067 7261 7068 2e22 0a20  tional graph.". 
-00004b20: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00004b30: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-00004b40: 6464 5f6f 626a 6563 7428 7365 6c66 2e64  dd_object(self.d
-00004b50: 6173 6b2c 2073 656c 662e 5f6e 616d 652c  ask, self._name,
-00004b60: 2073 656c 662e 5f6d 6574 612c 2073 656c   self._meta, sel
-00004b70: 662e 6469 7669 7369 6f6e 7329 0a0a 2020  f.divisions)..  
-00004b80: 2020 6465 6620 5f5f 6172 7261 795f 5f28    def __array__(
-00004b90: 7365 6c66 2c20 6474 7970 653d 4e6f 6e65  self, dtype=None
-00004ba0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00004bb0: 2020 2020 2073 656c 662e 5f63 6f6d 7075       self._compu
-00004bc0: 7465 6420 3d20 7365 6c66 2e63 6f6d 7075  ted = self.compu
-00004bd0: 7465 2829 0a20 2020 2020 2020 2078 203d  te().        x =
-00004be0: 206e 702e 6172 7261 7928 7365 6c66 2e5f   np.array(self._
-00004bf0: 636f 6d70 7574 6564 290a 2020 2020 2020  computed).      
-00004c00: 2020 7265 7475 726e 2078 0a0a 2020 2020    return x..    
-00004c10: 6465 6620 5f5f 6172 7261 795f 7772 6170  def __array_wrap
-00004c20: 5f5f 2873 656c 662c 2061 7272 6179 2c20  __(self, array, 
-00004c30: 636f 6e74 6578 743d 4e6f 6e65 293a 0a20  context=None):. 
-00004c40: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-00004c50: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+000035b0: 2020 2020 6f72 2028 0a20 2020 2020 2020      or (.       
+000035c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000035d0: 2069 735f 6f62 6a65 6374 5f73 7472 696e   is_object_strin
+000035e0: 675f 7365 7269 6573 286d 6574 6129 0a20  g_series(meta). 
+000035f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003600: 2020 2020 2020 2061 6e64 206e 6f74 2069         and not i
+00003610: 735f 6f62 6a65 6374 5f73 7472 696e 675f  s_object_string_
+00003620: 6474 7970 6528 6d65 7461 2e64 7479 7065  dtype(meta.dtype
+00003630: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00003640: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00003650: 2020 2020 2020 2020 2020 2020 6f72 2069              or i
+00003660: 735f 6f62 6a65 6374 5f73 7472 696e 675f  s_object_string_
+00003670: 696e 6465 7828 6d65 7461 290a 2020 2020  index(meta).    
+00003680: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
+00003690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000036a0: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+000036b0: 2020 2020 2020 2020 2020 2023 2074 6869             # thi
+000036c0: 7320 6973 2061 6e20 696e 7465 726e 616c  s is an internal
+000036d0: 2063 616c 6c2c 2061 6e64 2069 6620 7765   call, and if we
+000036e0: 2065 6e66 6f72 6365 206d 6574 6164 6174   enforce metadat
+000036f0: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+00003700: 2020 2023 2069 7420 6d61 7920 696e 7465     # it may inte
+00003710: 7266 6572 6520 7768 656e 2072 6561 6469  rfere when readi
+00003720: 6e67 2063 7376 2077 6974 6820 656e 666f  ng csv with enfo
+00003730: 7263 653d 4661 6c73 650a 2020 2020 2020  rce=False.      
+00003740: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00003750: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
+00003760: 6974 696f 6e73 2874 6f5f 7079 6172 726f  itions(to_pyarro
+00003770: 775f 7374 7269 6e67 2c20 656e 666f 7263  w_string, enforc
+00003780: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+00003790: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000037a0: 2020 7365 6c66 2e64 6173 6b20 3d20 7265    self.dask = re
+000037b0: 7375 6c74 2e64 6173 6b0a 2020 2020 2020  sult.dask.      
+000037c0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000037d0: 6e61 6d65 203d 2072 6573 756c 742e 5f6e  name = result._n
+000037e0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
+000037f0: 2020 2020 7365 6c66 2e5f 6d65 7461 203d      self._meta =
+00003800: 2072 6573 756c 742e 5f6d 6574 610a 2020   result._meta.  
+00003810: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00003820: 6c66 2e64 6976 6973 696f 6e73 203d 2072  lf.divisions = r
+00003830: 6573 756c 742e 6469 7669 7369 6f6e 730a  esult.divisions.
+00003840: 0a20 2020 2064 6566 205f 5f64 6173 6b5f  .    def __dask_
+00003850: 6772 6170 685f 5f28 7365 6c66 293a 0a20  graph__(self):. 
+00003860: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00003870: 6c66 2e64 6173 6b0a 0a20 2020 2064 6566  lf.dask..    def
+00003880: 205f 5f64 6173 6b5f 6b65 7973 5f5f 2873   __dask_keys__(s
+00003890: 656c 6629 202d 3e20 6c69 7374 5b48 6173  elf) -> list[Has
+000038a0: 6861 626c 655d 3a0a 2020 2020 2020 2020  hable]:.        
+000038b0: 7265 7475 726e 205b 2873 656c 662e 5f6e  return [(self._n
+000038c0: 616d 652c 2069 2920 666f 7220 6920 696e  ame, i) for i in
+000038d0: 2072 616e 6765 2873 656c 662e 6e70 6172   range(self.npar
+000038e0: 7469 7469 6f6e 7329 5d0a 0a20 2020 2064  titions)]..    d
+000038f0: 6566 205f 5f64 6173 6b5f 6c61 7965 7273  ef __dask_layers
+00003900: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+00003910: 2020 7265 7475 726e 2028 7365 6c66 2e5f    return (self._
+00003920: 6e61 6d65 2c29 0a0a 2020 2020 6465 6620  name,)..    def 
+00003930: 5f5f 6461 736b 5f74 6f6b 656e 697a 655f  __dask_tokenize_
+00003940: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00003950: 2072 6574 7572 6e20 7365 6c66 2e5f 6e61   return self._na
+00003960: 6d65 0a0a 2020 2020 5f5f 6461 736b 5f6f  me..    __dask_o
+00003970: 7074 696d 697a 655f 5f20 3d20 676c 6f62  ptimize__ = glob
+00003980: 616c 6d65 7468 6f64 280a 2020 2020 2020  almethod(.      
+00003990: 2020 6f70 7469 6d69 7a65 2c20 6b65 793d    optimize, key=
+000039a0: 2264 6174 6166 7261 6d65 5f6f 7074 696d  "dataframe_optim
+000039b0: 697a 6522 2c20 6661 6c73 6579 3d64 6f6e  ize", falsey=don
+000039c0: 745f 6f70 7469 6d69 7a65 0a20 2020 2029  t_optimize.    )
+000039d0: 0a20 2020 205f 5f64 6173 6b5f 7363 6865  .    __dask_sche
+000039e0: 6475 6c65 725f 5f20 3d20 7374 6174 6963  duler__ = static
+000039f0: 6d65 7468 6f64 2844 4546 4155 4c54 5f47  method(DEFAULT_G
+00003a00: 4554 290a 0a20 2020 2064 6566 205f 5f64  ET)..    def __d
+00003a10: 6173 6b5f 706f 7374 636f 6d70 7574 655f  ask_postcompute_
+00003a20: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00003a30: 2072 6574 7572 6e20 6669 6e61 6c69 7a65   return finalize
+00003a40: 2c20 2829 0a0a 2020 2020 6465 6620 5f5f  , ()..    def __
+00003a50: 6461 736b 5f70 6f73 7470 6572 7369 7374  dask_postpersist
+00003a60: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+00003a70: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
+00003a80: 6562 7569 6c64 2c20 2829 0a0a 2020 2020  ebuild, ()..    
+00003a90: 6465 6620 5f72 6562 7569 6c64 2873 656c  def _rebuild(sel
+00003aa0: 662c 2064 736b 2c20 2a2c 2072 656e 616d  f, dsk, *, renam
+00003ab0: 653d 4e6f 6e65 293a 0a20 2020 2020 2020  e=None):.       
+00003ac0: 206e 616d 6520 3d20 7365 6c66 2e5f 6e61   name = self._na
+00003ad0: 6d65 0a20 2020 2020 2020 2069 6620 7265  me.        if re
+00003ae0: 6e61 6d65 3a0a 2020 2020 2020 2020 2020  name:.          
+00003af0: 2020 6e61 6d65 203d 2072 656e 616d 652e    name = rename.
+00003b00: 6765 7428 6e61 6d65 2c20 6e61 6d65 290a  get(name, name).
+00003b10: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+00003b20: 7970 6528 7365 6c66 2928 6473 6b2c 206e  ype(self)(dsk, n
+00003b30: 616d 652c 2073 656c 662e 5f6d 6574 612c  ame, self._meta,
+00003b40: 2073 656c 662e 6469 7669 7369 6f6e 7329   self.divisions)
+00003b50: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00003b60: 2020 2020 6465 6620 5f63 6f6e 7374 7275      def _constru
+00003b70: 6374 6f72 2873 656c 6629 3a0a 2020 2020  ctor(self):.    
+00003b80: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
+00003b90: 645f 6f62 6a65 6374 0a0a 2020 2020 4070  d_object..    @p
+00003ba0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00003bb0: 6469 7669 7369 6f6e 7328 7365 6c66 293a  divisions(self):
+00003bc0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00003bd0: 2020 2020 2054 7570 6c65 206f 6620 6060       Tuple of ``
+00003be0: 6e70 6172 7469 7469 6f6e 7320 2b20 3160  npartitions + 1`
+00003bf0: 6020 7661 6c75 6573 2c20 696e 2061 7363  ` values, in asc
+00003c00: 656e 6469 6e67 206f 7264 6572 2c20 6d61  ending order, ma
+00003c10: 726b 696e 6720 7468 650a 2020 2020 2020  rking the.      
+00003c20: 2020 6c6f 7765 722f 7570 7065 7220 626f    lower/upper bo
+00003c30: 756e 6473 206f 6620 6561 6368 2070 6172  unds of each par
+00003c40: 7469 7469 6f6e 2773 2069 6e64 6578 2e20  tition's index. 
+00003c50: 4469 7669 7369 6f6e 7320 616c 6c6f 7720  Divisions allow 
+00003c60: 4461 736b 0a20 2020 2020 2020 2074 6f20  Dask.        to 
+00003c70: 6b6e 6f77 2077 6869 6368 2070 6172 7469  know which parti
+00003c80: 7469 6f6e 2077 696c 6c20 636f 6e74 6169  tion will contai
+00003c90: 6e20 6120 6769 7665 6e20 7661 6c75 652c  n a given value,
+00003ca0: 2073 6967 6e69 6669 6361 6e74 6c79 0a20   significantly. 
+00003cb0: 2020 2020 2020 2073 7065 6564 696e 6720         speeding 
+00003cc0: 7570 206f 7065 7261 7469 6f6e 7320 6c69  up operations li
+00003cd0: 6b65 2060 6c6f 6360 2c20 606d 6572 6765  ke `loc`, `merge
+00003ce0: 602c 2061 6e64 2060 6772 6f75 7062 7960  `, and `groupby`
+00003cf0: 2062 7920 6e6f 740a 2020 2020 2020 2020   by not.        
+00003d00: 6861 7669 6e67 2074 6f20 7365 6172 6368  having to search
+00003d10: 2074 6865 2066 756c 6c20 6461 7461 7365   the full datase
+00003d20: 742e 0a0a 2020 2020 2020 2020 4578 616d  t...        Exam
+00003d30: 706c 653a 2066 6f72 2060 6064 6976 6973  ple: for ``divis
+00003d40: 696f 6e73 203d 2028 302c 2031 302c 2035  ions = (0, 10, 5
+00003d50: 302c 2031 3030 2960 602c 2074 6865 7265  0, 100)``, there
+00003d60: 2061 7265 2074 6872 6565 2070 6172 7469   are three parti
+00003d70: 7469 6f6e 732c 0a20 2020 2020 2020 2077  tions,.        w
+00003d80: 6865 7265 2074 6865 2069 6e64 6578 2069  here the index i
+00003d90: 6e20 6561 6368 2070 6172 7469 7469 6f6e  n each partition
+00003da0: 2063 6f6e 7461 696e 7320 7661 6c75 6573   contains values
+00003db0: 205b 302c 2031 3029 2c20 5b31 302c 2035   [0, 10), [10, 5
+00003dc0: 3029 2c0a 2020 2020 2020 2020 616e 6420  0),.        and 
+00003dd0: 5b35 302c 2031 3030 5d2c 2072 6573 7065  [50, 100], respe
+00003de0: 6374 6976 656c 792e 2044 6173 6b20 7468  ctively. Dask th
+00003df0: 6572 6566 6f72 6520 6b6e 6f77 7320 6060  erefore knows ``
+00003e00: 6466 2e6c 6f63 5b34 355d 6060 0a20 2020  df.loc[45]``.   
+00003e10: 2020 2020 2077 696c 6c20 6265 2069 6e20       will be in 
+00003e20: 7468 6520 7365 636f 6e64 2070 6172 7469  the second parti
+00003e30: 7469 6f6e 2e0a 0a20 2020 2020 2020 2057  tion...        W
+00003e40: 6865 6e20 6576 6572 7920 6974 656d 2069  hen every item i
+00003e50: 6e20 6060 6469 7669 7369 6f6e 7360 6020  n ``divisions`` 
+00003e60: 6973 2060 604e 6f6e 6560 602c 2074 6865  is ``None``, the
+00003e70: 2064 6976 6973 696f 6e73 2061 7265 2075   divisions are u
+00003e80: 6e6b 6e6f 776e 2e0a 2020 2020 2020 2020  nknown..        
+00003e90: 4d6f 7374 206f 7065 7261 7469 6f6e 7320  Most operations 
+00003ea0: 6361 6e20 7374 696c 6c20 6265 2070 6572  can still be per
+00003eb0: 666f 726d 6564 2c20 6275 7420 736f 6d65  formed, but some
+00003ec0: 2077 696c 6c20 6265 206d 7563 6820 736c   will be much sl
+00003ed0: 6f77 6572 2c0a 2020 2020 2020 2020 616e  ower,.        an
+00003ee0: 6420 6120 6665 7720 6d61 7920 6661 696c  d a few may fail
+00003ef0: 2e0a 0a20 2020 2020 2020 2049 7420 6973  ...        It is
+00003f00: 2075 6e63 6f6d 6d6f 6e20 746f 2073 6574   uncommon to set
+00003f10: 2060 6064 6976 6973 696f 6e73 6060 2064   ``divisions`` d
+00003f20: 6972 6563 746c 792e 2049 6e73 7465 6164  irectly. Instead
+00003f30: 2c20 7573 6520 6060 7365 745f 696e 6465  , use ``set_inde
+00003f40: 7860 602c 0a20 2020 2020 2020 2077 6869  x``,.        whi
+00003f50: 6368 2073 6f72 7473 2061 6e64 2073 706c  ch sorts and spl
+00003f60: 6974 7320 7468 6520 6461 7461 2061 7320  its the data as 
+00003f70: 6e65 6564 6564 2e0a 2020 2020 2020 2020  needed..        
+00003f80: 5365 6520 6874 7470 733a 2f2f 646f 6373  See https://docs
+00003f90: 2e64 6173 6b2e 6f72 672f 656e 2f6c 6174  .dask.org/en/lat
+00003fa0: 6573 742f 6461 7461 6672 616d 652d 6465  est/dataframe-de
+00003fb0: 7369 676e 2e68 746d 6c23 7061 7274 6974  sign.html#partit
+00003fc0: 696f 6e73 2e0a 2020 2020 2020 2020 2222  ions..        ""
+00003fd0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00003fe0: 2073 656c 662e 5f64 6976 6973 696f 6e73   self._divisions
+00003ff0: 0a0a 2020 2020 4064 6976 6973 696f 6e73  ..    @divisions
+00004000: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
+00004010: 6469 7669 7369 6f6e 7328 7365 6c66 2c20  divisions(self, 
+00004020: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
+00004030: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00004040: 6528 7661 6c75 652c 2074 7570 6c65 293a  e(value, tuple):
+00004050: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00004060: 7365 2054 7970 6545 7272 6f72 2822 6469  se TypeError("di
+00004070: 7669 7369 6f6e 7320 6d75 7374 2062 6520  visions must be 
+00004080: 6120 7475 706c 6522 290a 0a20 2020 2020  a tuple")..     
+00004090: 2020 2069 6620 6861 7361 7474 7228 7365     if hasattr(se
+000040a0: 6c66 2c20 225f 6469 7669 7369 6f6e 7322  lf, "_divisions"
+000040b0: 2920 616e 6420 6c65 6e28 7661 6c75 6529  ) and len(value)
+000040c0: 2021 3d20 6c65 6e28 7365 6c66 2e5f 6469   != len(self._di
+000040d0: 7669 7369 6f6e 7329 3a0a 2020 2020 2020  visions):.      
+000040e0: 2020 2020 2020 6e20 3d20 6c65 6e28 7365        n = len(se
+000040f0: 6c66 2e5f 6469 7669 7369 6f6e 7329 0a20  lf._divisions). 
+00004100: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00004110: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+00004120: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
+00004130: 6869 7320 6461 7461 6672 616d 6520 6861  his dataframe ha
+00004140: 7320 6e70 6172 7469 7469 6f6e 733d 7b6e  s npartitions={n
+00004150: 202d 2031 7d2c 2064 6976 6973 696f 6e73   - 1}, divisions
+00004160: 2073 686f 756c 6420 6265 2061 2022 0a20   should be a ". 
+00004170: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00004180: 2274 7570 6c65 206f 6620 6c65 6e67 7468  "tuple of length
+00004190: 3d7b 6e7d 2c20 676f 7420 7b6c 656e 2876  ={n}, got {len(v
+000041a0: 616c 7565 297d 220a 2020 2020 2020 2020  alue)}".        
+000041b0: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
+000041c0: 6620 4e6f 6e65 2069 6e20 7661 6c75 653a  f None in value:
+000041d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000041e0: 616e 7928 7620 6973 206e 6f74 204e 6f6e  any(v is not Non
+000041f0: 6520 666f 7220 7620 696e 2076 616c 7565  e for v in value
+00004200: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00004210: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00004220: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00004230: 2020 2020 2020 2020 2022 6469 7669 7369           "divisi
+00004240: 6f6e 7320 6d61 7920 6e6f 7420 636f 6e74  ons may not cont
+00004250: 6169 6e20 6120 6d69 7820 6f66 204e 6f6e  ain a mix of Non
+00004260: 6520 616e 6420 6e6f 6e2d 4e6f 6e65 2076  e and non-None v
+00004270: 616c 7565 7322 0a20 2020 2020 2020 2020  alues".         
+00004280: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00004290: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000042a0: 2020 2023 204b 6e6f 776e 2064 6976 6973     # Known divis
+000042b0: 696f 6e73 2c20 6368 6563 6b20 6d6f 6e6f  ions, check mono
+000042c0: 746f 6e69 6361 6c6c 7920 696e 6372 6561  tonically increa
+000042d0: 7369 6e67 0a0a 2020 2020 2020 2020 2020  sing..          
+000042e0: 2020 2320 5858 583a 2069 6620 7468 6520    # XXX: if the 
+000042f0: 696e 6465 7820 6474 7970 6520 6973 2061  index dtype is a
+00004300: 6e20 6f72 6465 7265 6420 6361 7465 676f  n ordered catego
+00004310: 7269 6361 6c20 6474 7970 652c 2074 6865  rical dtype, the
+00004320: 6e20 7765 2073 6b69 7020 7468 650a 2020  n we skip the.  
+00004330: 2020 2020 2020 2020 2020 2320 736f 7274            # sort
+00004340: 6564 6e65 7373 2063 6865 636b 2c20 7369  edness check, si
+00004350: 6e63 6520 7468 6520 6f72 6465 7220 6973  nce the order is
+00004360: 2064 7479 7065 2064 6570 656e 6465 6e74   dtype dependent
+00004370: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00004380: 6578 5f64 7479 7065 203d 2067 6574 6174  ex_dtype = getat
+00004390: 7472 2873 656c 662e 5f6d 6574 612c 2022  tr(self._meta, "
+000043a0: 696e 6465 7822 2c20 7365 6c66 2e5f 6d65  index", self._me
+000043b0: 7461 292e 6474 7970 650a 2020 2020 2020  ta).dtype.      
+000043c0: 2020 2020 2020 6966 206e 6f74 2028 0a20        if not (. 
+000043d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000043e0: 7369 6e73 7461 6e63 6528 696e 6465 785f  sinstance(index_
+000043f0: 6474 7970 652c 2070 642e 4361 7465 676f  dtype, pd.Catego
+00004400: 7269 6361 6c44 7479 7065 2920 616e 6420  ricalDtype) and 
+00004410: 696e 6465 785f 6474 7970 652e 6f72 6465  index_dtype.orde
+00004420: 7265 640a 2020 2020 2020 2020 2020 2020  red.            
+00004430: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00004440: 2020 2069 6620 7661 6c75 6520 213d 2074     if value != t
+00004450: 7570 6c65 2873 6f72 7465 6428 7661 6c75  uple(sorted(valu
+00004460: 6529 293a 0a20 2020 2020 2020 2020 2020  e)):.           
+00004470: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00004480: 616c 7565 4572 726f 7228 2264 6976 6973  alueError("divis
+00004490: 696f 6e73 206d 7573 7420 6265 2073 6f72  ions must be sor
+000044a0: 7465 6422 290a 0a20 2020 2020 2020 2073  ted")..        s
+000044b0: 656c 662e 5f64 6976 6973 696f 6e73 203d  elf._divisions =
+000044c0: 2076 616c 7565 0a0a 2020 2020 4070 726f   value..    @pro
+000044d0: 7065 7274 790a 2020 2020 6465 6620 6e70  perty.    def np
+000044e0: 6172 7469 7469 6f6e 7328 7365 6c66 2920  artitions(self) 
+000044f0: 2d3e 2069 6e74 3a0a 2020 2020 2020 2020  -> int:.        
+00004500: 2222 2252 6574 7572 6e20 6e75 6d62 6572  """Return number
+00004510: 206f 6620 7061 7274 6974 696f 6e73 2222   of partitions""
+00004520: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00004530: 206c 656e 2873 656c 662e 6469 7669 7369   len(self.divisi
+00004540: 6f6e 7329 202d 2031 0a0a 2020 2020 4070  ons) - 1..    @p
+00004550: 726f 7065 7274 790a 2020 2020 4064 6572  roperty.    @der
+00004560: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00004570: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00004580: 6174 7472 7328 7365 6c66 293a 0a20 2020  attrs(self):.   
+00004590: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000045a0: 2e5f 6d65 7461 2e61 7474 7273 0a0a 2020  ._meta.attrs..  
+000045b0: 2020 4061 7474 7273 2e73 6574 7465 720a    @attrs.setter.
+000045c0: 2020 2020 6465 6620 6174 7472 7328 7365      def attrs(se
+000045d0: 6c66 2c20 7661 6c75 6529 3a0a 2020 2020  lf, value):.    
+000045e0: 2020 2020 7365 6c66 2e5f 6d65 7461 2e61      self._meta.a
+000045f0: 7474 7273 203d 2064 6963 7428 7661 6c75  ttrs = dict(valu
+00004600: 6529 0a0a 2020 2020 4070 726f 7065 7274  e)..    @propert
+00004610: 790a 2020 2020 6465 6620 7369 7a65 2873  y.    def size(s
+00004620: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00004630: 2253 697a 6520 6f66 2074 6865 2053 6572  "Size of the Ser
+00004640: 6965 7320 6f72 2044 6174 6146 7261 6d65  ies or DataFrame
+00004650: 2061 7320 6120 4465 6c61 7965 6420 6f62   as a Delayed ob
+00004660: 6a65 6374 2e0a 0a20 2020 2020 2020 2045  ject...        E
+00004670: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+00004680: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00004690: 203e 3e3e 2073 6572 6965 732e 7369 7a65   >>> series.size
+000046a0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+000046b0: 4950 0a20 2020 2020 2020 2064 642e 5363  IP.        dd.Sc
+000046c0: 616c 6172 3c73 697a 652d 6167 2e2e 2e2c  alar<size-ag...,
+000046d0: 2064 7479 7065 3d69 6e74 3634 3e0a 2020   dtype=int64>.  
+000046e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000046f0: 2020 7265 7475 726e 2073 656c 662e 7265    return self.re
+00004700: 6475 6374 696f 6e28 0a20 2020 2020 2020  duction(.       
+00004710: 2020 2020 206d 6574 686f 6473 2e73 697a       methods.siz
+00004720: 652c 206e 702e 7375 6d2c 2074 6f6b 656e  e, np.sum, token
+00004730: 3d22 7369 7a65 222c 206d 6574 613d 696e  ="size", meta=in
+00004740: 742c 2073 706c 6974 5f65 7665 7279 3d46  t, split_every=F
+00004750: 616c 7365 0a20 2020 2020 2020 2029 0a0a  alse.        )..
+00004760: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00004770: 2020 6465 6620 5f6d 6574 615f 6e6f 6e65    def _meta_none
+00004780: 6d70 7479 2873 656c 6629 3a0a 2020 2020  mpty(self):.    
+00004790: 2020 2020 2222 2241 206e 6f6e 2d65 6d70      """A non-emp
+000047a0: 7479 2076 6572 7369 6f6e 206f 6620 605f  ty version of `_
+000047b0: 6d65 7461 6020 7769 7468 2066 616b 6520  meta` with fake 
+000047c0: 6461 7461 2e22 2222 0a20 2020 2020 2020  data.""".       
+000047d0: 2072 6574 7572 6e20 6d65 7461 5f6e 6f6e   return meta_non
+000047e0: 656d 7074 7928 7365 6c66 2e5f 6d65 7461  empty(self._meta
+000047f0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00004800: 0a20 2020 2064 6566 205f 6172 6773 2873  .    def _args(s
+00004810: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00004820: 7475 726e 2028 7365 6c66 2e64 6173 6b2c  turn (self.dask,
+00004830: 2073 656c 662e 5f6e 616d 652c 2073 656c   self._name, sel
+00004840: 662e 5f6d 6574 612c 2073 656c 662e 6469  f._meta, self.di
+00004850: 7669 7369 6f6e 7329 0a0a 2020 2020 6465  visions)..    de
+00004860: 6620 5f5f 6765 7473 7461 7465 5f5f 2873  f __getstate__(s
+00004870: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00004880: 7475 726e 2073 656c 662e 5f61 7267 730a  turn self._args.
+00004890: 0a20 2020 2064 6566 205f 5f73 6574 7374  .    def __setst
+000048a0: 6174 655f 5f28 7365 6c66 2c20 7374 6174  ate__(self, stat
+000048b0: 6529 3a0a 2020 2020 2020 2020 7365 6c66  e):.        self
+000048c0: 2e64 6173 6b2c 2073 656c 662e 5f6e 616d  .dask, self._nam
+000048d0: 652c 2073 656c 662e 5f6d 6574 612c 2073  e, self._meta, s
+000048e0: 656c 662e 5f64 6976 6973 696f 6e73 203d  elf._divisions =
+000048f0: 2073 7461 7465 0a0a 2020 2020 6465 6620   state..    def 
+00004900: 636f 7079 2873 656c 662c 2064 6565 703d  copy(self, deep=
+00004910: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00004920: 2222 224d 616b 6520 6120 636f 7079 206f  """Make a copy o
+00004930: 6620 7468 6520 6461 7461 6672 616d 650a  f the dataframe.
+00004940: 0a20 2020 2020 2020 2054 6869 7320 6973  .        This is
+00004950: 2073 7472 6963 746c 7920 6120 7368 616c   strictly a shal
+00004960: 6c6f 7720 636f 7079 206f 6620 7468 6520  low copy of the 
+00004970: 756e 6465 726c 7969 6e67 2063 6f6d 7075  underlying compu
+00004980: 7461 7469 6f6e 616c 2067 7261 7068 2e0a  tational graph..
+00004990: 2020 2020 2020 2020 4974 2064 6f65 7320          It does 
+000049a0: 6e6f 7420 6166 6665 6374 2074 6865 2075  not affect the u
+000049b0: 6e64 6572 6c79 696e 6720 6461 7461 0a0a  nderlying data..
+000049c0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+000049d0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+000049e0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6465  -----.        de
+000049f0: 6570 203a 2062 6f6f 6c65 616e 2c20 6465  ep : boolean, de
+00004a00: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
+00004a10: 2020 2020 2020 2020 5468 6520 6465 6570          The deep
+00004a20: 2076 616c 7565 206d 7573 7420 6265 2060   value must be `
+00004a30: 4661 6c73 6560 2061 6e64 2069 7420 6973  False` and it is
+00004a40: 2064 6563 6c61 7265 6420 6173 2061 2070   declared as a p
+00004a50: 6172 616d 6574 6572 206a 7573 7420 666f  arameter just fo
+00004a60: 720a 2020 2020 2020 2020 2020 2020 636f  r.            co
+00004a70: 6d70 6174 6962 696c 6974 7920 7769 7468  mpatibility with
+00004a80: 2074 6869 7264 2d70 6172 7479 206c 6962   third-party lib
+00004a90: 7261 7269 6573 206c 696b 6520 6375 4446  raries like cuDF
+00004aa0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00004ab0: 2020 2020 2069 6620 6465 6570 2069 7320       if deep is 
+00004ac0: 6e6f 7420 4661 6c73 653a 0a20 2020 2020  not False:.     
+00004ad0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00004ae0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+00004af0: 2020 2020 2020 2020 2022 5468 6520 6064           "The `d
+00004b00: 6565 7060 2076 616c 7565 206d 7573 7420  eep` value must 
+00004b10: 6265 2046 616c 7365 2e20 5468 6973 2069  be False. This i
+00004b20: 7320 7374 7269 6374 6c79 2061 2073 6861  s strictly a sha
+00004b30: 6c6c 6f77 2063 6f70 7920 220a 2020 2020  llow copy ".    
+00004b40: 2020 2020 2020 2020 2020 2020 226f 6620              "of 
+00004b50: 7468 6520 756e 6465 726c 7969 6e67 2063  the underlying c
+00004b60: 6f6d 7075 7461 7469 6f6e 616c 2067 7261  omputational gra
+00004b70: 7068 2e22 0a20 2020 2020 2020 2020 2020  ph.".           
+00004b80: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+00004b90: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+00004ba0: 7365 6c66 2e64 6173 6b2c 2073 656c 662e  self.dask, self.
+00004bb0: 5f6e 616d 652c 2073 656c 662e 5f6d 6574  _name, self._met
+00004bc0: 612c 2073 656c 662e 6469 7669 7369 6f6e  a, self.division
+00004bd0: 7329 0a0a 2020 2020 6465 6620 5f5f 6172  s)..    def __ar
+00004be0: 7261 795f 5f28 7365 6c66 2c20 6474 7970  ray__(self, dtyp
+00004bf0: 653d 4e6f 6e65 2c20 2a2a 6b77 6172 6773  e=None, **kwargs
+00004c00: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+00004c10: 5f63 6f6d 7075 7465 6420 3d20 7365 6c66  _computed = self
+00004c20: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+00004c30: 2020 2078 203d 206e 702e 6172 7261 7928     x = np.array(
+00004c40: 7365 6c66 2e5f 636f 6d70 7574 6564 290a  self._computed).
+00004c50: 2020 2020 2020 2020 7265 7475 726e 2078          return x
 00004c60: 0a0a 2020 2020 6465 6620 5f5f 6172 7261  ..    def __arra
-00004c70: 795f 7566 756e 635f 5f28 7365 6c66 2c20  y_ufunc__(self, 
-00004c80: 6e75 6d70 795f 7566 756e 632c 206d 6574  numpy_ufunc, met
-00004c90: 686f 642c 202a 696e 7075 7473 2c20 2a2a  hod, *inputs, **
-00004ca0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-00004cb0: 206f 7574 203d 206b 7761 7267 732e 6765   out = kwargs.ge
-00004cc0: 7428 226f 7574 222c 2028 2929 0a20 2020  t("out", ()).   
-00004cd0: 2020 2020 2066 6f72 2078 2069 6e20 696e       for x in in
-00004ce0: 7075 7473 202b 206f 7574 3a0a 2020 2020  puts + out:.    
-00004cf0: 2020 2020 2020 2020 2320 7566 756e 6373          # ufuncs
-00004d00: 2077 6f72 6b20 7769 7468 2030 2d64 696d   work with 0-dim
-00004d10: 656e 7369 6f6e 616c 204e 756d 5079 206e  ensional NumPy n
-00004d20: 6461 7272 6179 730a 2020 2020 2020 2020  darrays.        
-00004d30: 2020 2020 2320 736f 2077 6520 646f 6e27      # so we don'
-00004d40: 7420 7761 6e74 2074 6f20 7261 6973 6520  t want to raise 
-00004d50: 4e6f 7449 6d70 6c65 6d65 6e74 6564 0a20  NotImplemented. 
-00004d60: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00004d70: 696e 7374 616e 6365 2878 2c20 6e70 2e6e  instance(x, np.n
-00004d80: 6461 7272 6179 2920 616e 6420 782e 7368  darray) and x.sh
-00004d90: 6170 6520 3d3d 2028 293a 0a20 2020 2020  ape == ():.     
-00004da0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-00004db0: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
-00004dc0: 656c 6966 206e 6f74 2069 7369 6e73 7461  elif not isinsta
-00004dd0: 6e63 6528 0a20 2020 2020 2020 2020 2020  nce(.           
-00004de0: 2020 2020 2078 2c20 284e 756d 6265 722c       x, (Number,
-00004df0: 2053 6361 6c61 722c 205f 4672 616d 652c   Scalar, _Frame,
-00004e00: 2041 7272 6179 2c20 7064 2e44 6174 6146   Array, pd.DataF
-00004e10: 7261 6d65 2c20 7064 2e53 6572 6965 732c  rame, pd.Series,
-00004e20: 2070 642e 496e 6465 7829 0a20 2020 2020   pd.Index).     
-00004e30: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00004e40: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00004e50: 204e 6f74 496d 706c 656d 656e 7465 640a   NotImplemented.
-00004e60: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
-00004e70: 6f64 203d 3d20 225f 5f63 616c 6c5f 5f22  od == "__call__"
-00004e80: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00004e90: 206e 756d 7079 5f75 6675 6e63 2e73 6967   numpy_ufunc.sig
-00004ea0: 6e61 7475 7265 2069 7320 6e6f 7420 4e6f  nature is not No
-00004eb0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00004ec0: 2020 2020 7265 7475 726e 204e 6f74 496d      return NotIm
-00004ed0: 706c 656d 656e 7465 640a 2020 2020 2020  plemented.      
-00004ee0: 2020 2020 2020 6966 206e 756d 7079 5f75        if numpy_u
-00004ef0: 6675 6e63 2e6e 6f75 7420 3e20 313a 0a20  func.nout > 1:. 
-00004f00: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00004f10: 2075 6675 6e63 7320 7769 7468 206d 756c   ufuncs with mul
-00004f20: 7469 706c 6520 6f75 7470 7574 2076 616c  tiple output val
-00004f30: 7565 730a 2020 2020 2020 2020 2020 2020  ues.            
-00004f40: 2020 2020 2320 6172 6520 6e6f 7420 7965      # are not ye
-00004f50: 7420 7375 7070 6f72 7465 6420 666f 7220  t supported for 
-00004f60: 6672 616d 6573 0a20 2020 2020 2020 2020  frames.         
-00004f70: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-00004f80: 7449 6d70 6c65 6d65 6e74 6564 0a20 2020  tImplemented.   
-00004f90: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00004fa0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00004fb0: 6574 7572 6e20 656c 656d 7769 7365 286e  eturn elemwise(n
-00004fc0: 756d 7079 5f75 6675 6e63 2c20 2a69 6e70  umpy_ufunc, *inp
-00004fd0: 7574 732c 202a 2a6b 7761 7267 7329 0a20  uts, **kwargs). 
-00004fe0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00004ff0: 2020 2020 2020 2020 2023 2075 6675 6e63           # ufunc
-00005000: 206d 6574 686f 6473 2061 7265 206e 6f74   methods are not
-00005010: 2079 6574 2073 7570 706f 7274 6564 2066   yet supported f
-00005020: 6f72 2066 7261 6d65 730a 2020 2020 2020  or frames.      
-00005030: 2020 2020 2020 7265 7475 726e 204e 6f74        return Not
-00005040: 496d 706c 656d 656e 7465 640a 0a20 2020  Implemented..   
-00005050: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00005060: 6566 205f 656c 656d 7769 7365 2873 656c  ef _elemwise(sel
-00005070: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00005080: 726e 2065 6c65 6d77 6973 650a 0a20 2020  rn elemwise..   
-00005090: 2064 6566 205f 7265 7072 5f64 6174 6128   def _repr_data(
-000050a0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-000050b0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-000050c0: 7465 6445 7272 6f72 0a0a 2020 2020 4070  tedError..    @p
-000050d0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000050e0: 5f72 6570 725f 6469 7669 7369 6f6e 7328  _repr_divisions(
-000050f0: 7365 6c66 293a 0a20 2020 2020 2020 206e  self):.        n
-00005100: 616d 6520 3d20 6622 6e70 6172 7469 7469  ame = f"npartiti
-00005110: 6f6e 733d 7b73 656c 662e 6e70 6172 7469  ons={self.nparti
-00005120: 7469 6f6e 737d 220a 2020 2020 2020 2020  tions}".        
-00005130: 6966 2073 656c 662e 6b6e 6f77 6e5f 6469  if self.known_di
-00005140: 7669 7369 6f6e 733a 0a20 2020 2020 2020  visions:.       
-00005150: 2020 2020 2064 6976 6973 696f 6e73 203d       divisions =
-00005160: 2070 642e 496e 6465 7828 7365 6c66 2e64   pd.Index(self.d
-00005170: 6976 6973 696f 6e73 2c20 6e61 6d65 3d6e  ivisions, name=n
-00005180: 616d 6529 0a20 2020 2020 2020 2065 6c73  ame).        els
-00005190: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
-000051a0: 2061 766f 6964 2074 6f20 6265 2063 6f6e   avoid to be con
-000051b0: 7665 7274 6564 2074 6f20 4e61 4e0a 2020  verted to NaN.  
-000051c0: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
-000051d0: 6f6e 7320 3d20 7064 2e49 6e64 6578 285b  ons = pd.Index([
-000051e0: 2222 5d20 2a20 2873 656c 662e 6e70 6172  ""] * (self.npar
-000051f0: 7469 7469 6f6e 7320 2b20 3129 2c20 6e61  titions + 1), na
-00005200: 6d65 3d6e 616d 6529 0a20 2020 2020 2020  me=name).       
-00005210: 2072 6574 7572 6e20 6469 7669 7369 6f6e   return division
-00005220: 730a 0a20 2020 2064 6566 205f 5f72 6570  s..    def __rep
-00005230: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
-00005240: 2020 2064 6174 6120 3d20 7365 6c66 2e5f     data = self._
-00005250: 7265 7072 5f64 6174 6128 292e 746f 5f73  repr_data().to_s
-00005260: 7472 696e 6728 6d61 785f 726f 7773 3d35  tring(max_rows=5
-00005270: 2c20 7368 6f77 5f64 696d 656e 7369 6f6e  , show_dimension
-00005280: 733d 4661 6c73 6529 0a20 2020 2020 2020  s=False).       
-00005290: 205f 7374 725f 666d 7420 3d20 2222 2244   _str_fmt = """D
-000052a0: 6173 6b20 7b6b 6c61 7373 7d20 5374 7275  ask {klass} Stru
-000052b0: 6374 7572 653a 0a7b 6461 7461 7d0a 4461  cture:.{data}.Da
-000052c0: 736b 204e 616d 653a 207b 6e61 6d65 7d2c  sk Name: {name},
-000052d0: 207b 6c61 7965 7273 7d22 2222 0a20 2020   {layers}""".   
-000052e0: 2020 2020 2069 6620 6c65 6e28 7365 6c66       if len(self
-000052f0: 2e63 6f6c 756d 6e73 2920 3d3d 2030 3a0a  .columns) == 0:.
-00005300: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00005310: 203d 2064 6174 612e 7061 7274 6974 696f   = data.partitio
-00005320: 6e28 225c 6e22 295b 2d31 5d2e 7265 706c  n("\n")[-1].repl
-00005330: 6163 6528 2249 6e64 6578 222c 2022 4469  ace("Index", "Di
-00005340: 7669 7369 6f6e 7322 290a 2020 2020 2020  visions").      
-00005350: 2020 2020 2020 5f73 7472 5f66 6d74 203d        _str_fmt =
-00005360: 2066 2245 6d70 7479 207b 5f73 7472 5f66   f"Empty {_str_f
-00005370: 6d74 7d22 0a20 2020 2020 2020 2072 6574  mt}".        ret
-00005380: 7572 6e20 5f73 7472 5f66 6d74 2e66 6f72  urn _str_fmt.for
-00005390: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
-000053a0: 206b 6c61 7373 3d73 656c 662e 5f5f 636c   klass=self.__cl
-000053b0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2c0a  ass__.__name__,.
-000053c0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-000053d0: 3d64 6174 612c 0a20 2020 2020 2020 2020  =data,.         
-000053e0: 2020 206e 616d 653d 6b65 795f 7370 6c69     name=key_spli
-000053f0: 7428 7365 6c66 2e5f 6e61 6d65 292c 0a20  t(self._name),. 
-00005400: 2020 2020 2020 2020 2020 206c 6179 6572             layer
-00005410: 733d 6d61 7962 655f 706c 7572 616c 697a  s=maybe_pluraliz
-00005420: 6528 6c65 6e28 7365 6c66 2e64 6173 6b2e  e(len(self.dask.
-00005430: 6c61 7965 7273 292c 2022 6772 6170 6820  layers), "graph 
-00005440: 6c61 7965 7222 292c 0a20 2020 2020 2020  layer"),.       
-00005450: 2029 0a0a 2020 2020 4070 726f 7065 7274   )..    @propert
-00005460: 790a 2020 2020 6465 6620 696e 6465 7828  y.    def index(
-00005470: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00005480: 2222 5265 7475 726e 2064 6173 6b20 496e  ""Return dask In
-00005490: 6465 7820 696e 7374 616e 6365 2222 220a  dex instance""".
-000054a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000054b0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-000054c0: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-000054d0: 6765 7461 7474 722c 0a20 2020 2020 2020  getattr,.       
-000054e0: 2020 2020 2022 696e 6465 7822 2c0a 2020       "index",.  
-000054f0: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-00005500: 6b65 795f 7370 6c69 7428 7365 6c66 2e5f  key_split(self._
-00005510: 6e61 6d65 2920 2b20 222d 696e 6465 7822  name) + "-index"
-00005520: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-00005530: 7461 3d73 656c 662e 5f6d 6574 612e 696e  ta=self._meta.in
-00005540: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
-00005550: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-00005560: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
-00005570: 2029 0a0a 2020 2020 4069 6e64 6578 2e73   )..    @index.s
-00005580: 6574 7465 720a 2020 2020 6465 6620 696e  etter.    def in
-00005590: 6465 7828 7365 6c66 2c20 7661 6c75 6529  dex(self, value)
-000055a0: 3a0a 2020 2020 2020 2020 7365 6c66 2e64  :.        self.d
-000055b0: 6976 6973 696f 6e73 203d 2076 616c 7565  ivisions = value
-000055c0: 2e64 6976 6973 696f 6e73 0a20 2020 2020  .divisions.     
-000055d0: 2020 2072 6573 756c 7420 3d20 6d61 705f     result = map_
-000055e0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-000055f0: 2020 2020 2020 2020 6d65 7468 6f64 732e          methods.
-00005600: 6173 7369 676e 5f69 6e64 6578 2c20 7365  assign_index, se
-00005610: 6c66 2c20 7661 6c75 652c 2065 6e66 6f72  lf, value, enfor
-00005620: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-00005630: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
-00005640: 2020 2020 7365 6c66 2e64 6173 6b20 3d20      self.dask = 
-00005650: 7265 7375 6c74 2e64 6173 6b0a 2020 2020  result.dask.    
-00005660: 2020 2020 7365 6c66 2e5f 6e61 6d65 203d      self._name =
-00005670: 2072 6573 756c 742e 5f6e 616d 650a 2020   result._name.  
-00005680: 2020 2020 2020 7365 6c66 2e5f 6d65 7461        self._meta
-00005690: 203d 2072 6573 756c 742e 5f6d 6574 610a   = result._meta.
-000056a0: 0a20 2020 2064 6566 2072 6573 6574 5f69  .    def reset_i
-000056b0: 6e64 6578 2873 656c 662c 2064 726f 703d  ndex(self, drop=
-000056c0: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-000056d0: 2222 2252 6573 6574 2074 6865 2069 6e64  """Reset the ind
-000056e0: 6578 2074 6f20 7468 6520 6465 6661 756c  ex to the defaul
-000056f0: 7420 696e 6465 782e 0a0a 2020 2020 2020  t index...      
-00005700: 2020 4e6f 7465 2074 6861 7420 756e 6c69    Note that unli
-00005710: 6b65 2069 6e20 6060 7061 6e64 6173 6060  ke in ``pandas``
-00005720: 2c20 7468 6520 7265 7365 7420 6060 6461  , the reset ``da
-00005730: 736b 2e64 6174 6166 7261 6d65 6060 2069  sk.dataframe`` i
-00005740: 6e64 6578 2077 696c 6c0a 2020 2020 2020  ndex will.      
-00005750: 2020 6e6f 7420 6265 206d 6f6e 6f74 6f6e    not be monoton
-00005760: 6963 616c 6c79 2069 6e63 7265 6173 696e  ically increasin
-00005770: 6720 6672 6f6d 2030 2e20 496e 7374 6561  g from 0. Instea
-00005780: 642c 2069 7420 7769 6c6c 2072 6573 7461  d, it will resta
-00005790: 7274 2061 7420 300a 2020 2020 2020 2020  rt at 0.        
-000057a0: 666f 7220 6561 6368 2070 6172 7469 7469  for each partiti
-000057b0: 6f6e 2028 652e 672e 2060 6069 6e64 6578  on (e.g. ``index
-000057c0: 3120 3d20 5b30 2c20 2e2e 2e2c 2031 305d  1 = [0, ..., 10]
-000057d0: 2c20 696e 6465 7832 203d 205b 302c 202e  , index2 = [0, .
-000057e0: 2e2e 5d60 6029 2e0a 2020 2020 2020 2020  ..]``)..        
-000057f0: 5468 6973 2069 7320 6475 6520 746f 2074  This is due to t
-00005800: 6865 2069 6e61 6269 6c69 7479 2074 6f20  he inability to 
-00005810: 7374 6174 6963 616c 6c79 206b 6e6f 7720  statically know 
-00005820: 7468 6520 6675 6c6c 206c 656e 6774 6820  the full length 
-00005830: 6f66 2074 6865 0a20 2020 2020 2020 2069  of the.        i
-00005840: 6e64 6578 2e0a 0a20 2020 2020 2020 2046  ndex...        F
-00005850: 6f72 2044 6174 6146 7261 6d65 2077 6974  or DataFrame wit
-00005860: 6820 6d75 6c74 692d 6c65 7665 6c20 696e  h multi-level in
-00005870: 6465 782c 2072 6574 7572 6e73 2061 206e  dex, returns a n
-00005880: 6577 2044 6174 6146 7261 6d65 2077 6974  ew DataFrame wit
-00005890: 680a 2020 2020 2020 2020 6c61 6265 6c69  h.        labeli
-000058a0: 6e67 2069 6e66 6f72 6d61 7469 6f6e 2069  ng information i
-000058b0: 6e20 7468 6520 636f 6c75 6d6e 7320 756e  n the columns un
-000058c0: 6465 7220 7468 6520 696e 6465 7820 6e61  der the index na
-000058d0: 6d65 732c 2064 6566 6175 6c74 696e 670a  mes, defaulting.
-000058e0: 2020 2020 2020 2020 746f 2027 6c65 7665          to 'leve
-000058f0: 6c5f 3027 2c20 276c 6576 656c 5f31 272c  l_0', 'level_1',
-00005900: 2065 7463 2e20 6966 2061 6e79 2061 7265   etc. if any are
-00005910: 204e 6f6e 652e 2046 6f72 2061 2073 7461   None. For a sta
-00005920: 6e64 6172 6420 696e 6465 782c 0a20 2020  ndard index,.   
-00005930: 2020 2020 2074 6865 2069 6e64 6578 206e       the index n
-00005940: 616d 6520 7769 6c6c 2062 6520 7573 6564  ame will be used
-00005950: 2028 6966 2073 6574 292c 206f 7468 6572   (if set), other
-00005960: 7769 7365 2061 2064 6566 6175 6c74 2027  wise a default '
-00005970: 696e 6465 7827 206f 720a 2020 2020 2020  index' or.      
-00005980: 2020 276c 6576 656c 5f30 2720 2869 6620    'level_0' (if 
-00005990: 2769 6e64 6578 2720 6973 2061 6c72 6561  'index' is alrea
-000059a0: 6479 2074 616b 656e 2920 7769 6c6c 2062  dy taken) will b
-000059b0: 6520 7573 6564 2e0a 0a20 2020 2020 2020  e used...       
-000059c0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-000059d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-000059e0: 2020 2020 2020 2064 726f 7020 3a20 626f         drop : bo
-000059f0: 6f6c 6561 6e2c 2064 6566 6175 6c74 2046  olean, default F
-00005a00: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00005a10: 2044 6f20 6e6f 7420 7472 7920 746f 2069   Do not try to i
-00005a20: 6e73 6572 7420 696e 6465 7820 696e 746f  nsert index into
-00005a30: 2064 6174 6166 7261 6d65 2063 6f6c 756d   dataframe colum
-00005a40: 6e73 2e0a 2020 2020 2020 2020 2222 220a  ns..        """.
-00005a50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00005a60: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-00005a70: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-00005a80: 4d2e 7265 7365 745f 696e 6465 782c 2064  M.reset_index, d
-00005a90: 726f 703d 6472 6f70 2c20 656e 666f 7263  rop=drop, enforc
-00005aa0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-00005ab0: 0a20 2020 2020 2020 2029 2e63 6c65 6172  .        ).clear
-00005ac0: 5f64 6976 6973 696f 6e73 2829 0a0a 2020  _divisions()..  
-00005ad0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00005ae0: 6465 6620 6b6e 6f77 6e5f 6469 7669 7369  def known_divisi
-00005af0: 6f6e 7328 7365 6c66 293a 0a20 2020 2020  ons(self):.     
-00005b00: 2020 2022 2222 5768 6574 6865 7220 6469     """Whether di
-00005b10: 7669 7369 6f6e 7320 6172 6520 616c 7265  visions are alre
-00005b20: 6164 7920 6b6e 6f77 6e22 2222 0a20 2020  ady known""".   
-00005b30: 2020 2020 2072 6574 7572 6e20 6c65 6e28       return len(
-00005b40: 7365 6c66 2e64 6976 6973 696f 6e73 2920  self.divisions) 
-00005b50: 3e20 3020 616e 6420 7365 6c66 2e64 6976  > 0 and self.div
-00005b60: 6973 696f 6e73 5b30 5d20 6973 206e 6f74  isions[0] is not
-00005b70: 204e 6f6e 650a 0a20 2020 2064 6566 2063   None..    def c
-00005b80: 6c65 6172 5f64 6976 6973 696f 6e73 2873  lear_divisions(s
-00005b90: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00005ba0: 2246 6f72 6765 7420 6469 7669 7369 6f6e  "Forget division
-00005bb0: 2069 6e66 6f72 6d61 7469 6f6e 2222 220a   information""".
-00005bc0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-00005bd0: 7320 3d20 284e 6f6e 652c 2920 2a20 2873  s = (None,) * (s
-00005be0: 656c 662e 6e70 6172 7469 7469 6f6e 7320  elf.npartitions 
-00005bf0: 2b20 3129 0a20 2020 2020 2020 2072 6574  + 1).        ret
-00005c00: 7572 6e20 7479 7065 2873 656c 6629 2873  urn type(self)(s
-00005c10: 656c 662e 6461 736b 2c20 7365 6c66 2e5f  elf.dask, self._
-00005c20: 6e61 6d65 2c20 7365 6c66 2e5f 6d65 7461  name, self._meta
-00005c30: 2c20 6469 7669 7369 6f6e 7329 0a0a 2020  , divisions)..  
-00005c40: 2020 6465 6620 636f 6d70 7574 655f 6375    def compute_cu
-00005c50: 7272 656e 745f 6469 7669 7369 6f6e 7328  rrent_divisions(
-00005c60: 7365 6c66 2c20 636f 6c3d 4e6f 6e65 293a  self, col=None):
-00005c70: 0a20 2020 2020 2020 2022 2222 436f 6d70  .        """Comp
-00005c80: 7574 6520 7468 6520 6375 7272 656e 7420  ute the current 
-00005c90: 6469 7669 7369 6f6e 7320 6f66 2074 6865  divisions of the
-00005ca0: 2044 6174 6146 7261 6d65 2e0a 0a20 2020   DataFrame...   
-00005cb0: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
-00005cc0: 2074 7269 6767 6572 7320 696d 6d65 6469   triggers immedi
-00005cd0: 6174 6520 636f 6d70 7574 6174 696f 6e2e  ate computation.
-00005ce0: 2049 6620 796f 7520 6669 6e64 2079 6f75   If you find you
-00005cf0: 7273 656c 6620 7275 6e6e 696e 6720 7468  rself running th
-00005d00: 6973 2063 6f6d 6d61 6e64 0a20 2020 2020  is command.     
-00005d10: 2020 2072 6570 6561 7465 646c 7920 666f     repeatedly fo
-00005d20: 7220 7468 6520 7361 6d65 2064 6174 6166  r the same dataf
-00005d30: 7261 6d65 2c20 7765 2072 6563 6f6d 6d65  rame, we recomme
-00005d40: 6e64 2073 746f 7269 6e67 2074 6865 2072  nd storing the r
-00005d50: 6573 756c 740a 2020 2020 2020 2020 736f  esult.        so
-00005d60: 2079 6f75 2064 6f6e 2774 2068 6176 6520   you don't have 
-00005d70: 746f 2072 6572 756e 2069 742e 0a0a 2020  to rerun it...  
-00005d80: 2020 2020 2020 4966 2074 6865 2063 6f6c        If the col
-00005d90: 756d 6e20 6f72 2069 6e64 6578 2076 616c  umn or index val
-00005da0: 7565 7320 6f76 6572 6c61 7020 6265 7477  ues overlap betw
-00005db0: 6565 6e20 7061 7274 6974 696f 6e73 2c20  een partitions, 
-00005dc0: 7261 6973 6573 2060 6056 616c 7565 4572  raises ``ValueEr
-00005dd0: 726f 7260 602e 0a20 2020 2020 2020 2054  ror``..        T
-00005de0: 6f20 7072 6576 656e 7420 7468 6973 2c20  o prevent this, 
-00005df0: 6d61 6b65 2073 7572 6520 7468 6520 6461  make sure the da
-00005e00: 7461 2061 7265 2073 6f72 7465 6420 6279  ta are sorted by
-00005e10: 2074 6865 2063 6f6c 756d 6e20 6f72 2069   the column or i
-00005e20: 6e64 6578 2e0a 0a20 2020 2020 2020 2050  ndex...        P
-00005e30: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00005e40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00005e50: 2020 2020 2063 6f6c 203a 2073 7472 696e       col : strin
-00005e60: 672c 206f 7074 696f 6e61 6c0a 2020 2020  g, optional.    
-00005e70: 2020 2020 2020 2020 4361 6c63 756c 6174          Calculat
-00005e80: 6520 7468 6520 6469 7669 7369 6f6e 7320  e the divisions 
-00005e90: 666f 7220 6120 6e6f 6e2d 696e 6465 7820  for a non-index 
-00005ea0: 636f 6c75 6d6e 2062 7920 7061 7373 696e  column by passin
-00005eb0: 6720 696e 2074 6865 206e 616d 6520 6f66  g in the name of
-00005ec0: 2074 6865 2063 6f6c 756d 6e2e 0a20 2020   the column..   
-00005ed0: 2020 2020 2020 2020 2049 6620 636f 6c20           If col 
-00005ee0: 6973 206e 6f74 2073 7065 6369 6669 6564  is not specified
-00005ef0: 2c20 7468 6520 696e 6465 7820 7769 6c6c  , the index will
-00005f00: 2062 6520 7573 6564 2074 6f20 6361 6c63   be used to calc
-00005f10: 756c 6174 6520 6469 7669 7369 6f6e 732e  ulate divisions.
-00005f20: 0a20 2020 2020 2020 2020 2020 2049 6e20  .            In 
-00005f30: 7468 6973 2063 6173 652c 2069 6620 7468  this case, if th
-00005f40: 6520 6469 7669 7369 6f6e 7320 6172 6520  e divisions are 
-00005f50: 616c 7265 6164 7920 6b6e 6f77 6e2c 2074  already known, t
-00005f60: 6865 7920 7769 6c6c 2062 6520 7265 7475  hey will be retu
-00005f70: 726e 6564 0a20 2020 2020 2020 2020 2020  rned.           
-00005f80: 2069 6d6d 6564 6961 7465 6c79 2077 6974   immediately wit
-00005f90: 686f 7574 2063 6f6d 7075 7469 6e67 2e0a  hout computing..
-00005fa0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-00005fb0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00005fc0: 2d2d 0a20 2020 2020 2020 203e 3e3e 2069  --.        >>> i
-00005fd0: 6d70 6f72 7420 6461 736b 0a20 2020 2020  mport dask.     
-00005fe0: 2020 203e 3e3e 2064 6466 203d 2064 6173     >>> ddf = das
-00005ff0: 6b2e 6461 7461 7365 7473 2e74 696d 6573  k.datasets.times
-00006000: 6572 6965 7328 7374 6172 743d 2232 3032  eries(start="202
-00006010: 312d 3031 2d30 3122 2c20 656e 643d 2232  1-01-01", end="2
-00006020: 3032 312d 3031 2d30 3722 2c20 6672 6571  021-01-07", freq
-00006030: 3d22 3148 2229 2e63 6c65 6172 5f64 6976  ="1H").clear_div
-00006040: 6973 696f 6e73 2829 0a20 2020 2020 2020  isions().       
-00006050: 203e 3e3e 2064 6976 6973 696f 6e73 203d   >>> divisions =
-00006060: 2064 6466 2e63 6f6d 7075 7465 5f63 7572   ddf.compute_cur
-00006070: 7265 6e74 5f64 6976 6973 696f 6e73 2829  rent_divisions()
-00006080: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00006090: 6e74 2864 6976 6973 696f 6e73 2920 2023  nt(divisions)  #
-000060a0: 2064 6f63 7465 7374 3a20 2b4e 4f52 4d41   doctest: +NORMA
-000060b0: 4c49 5a45 5f57 4849 5445 5350 4143 450a  LIZE_WHITESPACE.
-000060c0: 2020 2020 2020 2020 2854 696d 6573 7461          (Timesta
-000060d0: 6d70 2827 3230 3231 2d30 312d 3031 2030  mp('2021-01-01 0
-000060e0: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
-000060f0: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
-00006100: 3032 312d 3031 2d30 3220 3030 3a30 303a  021-01-02 00:00:
-00006110: 3030 2729 2c0a 2020 2020 2020 2020 2054  00'),.         T
+00004c70: 795f 7772 6170 5f5f 2873 656c 662c 2061  y_wrap__(self, a
+00004c80: 7272 6179 2c20 636f 6e74 6578 743d 4e6f  rray, context=No
+00004c90: 6e65 293a 0a20 2020 2020 2020 2072 6169  ne):.        rai
+00004ca0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00004cb0: 6445 7272 6f72 0a0a 2020 2020 6465 6620  dError..    def 
+00004cc0: 5f5f 6172 7261 795f 7566 756e 635f 5f28  __array_ufunc__(
+00004cd0: 7365 6c66 2c20 6e75 6d70 795f 7566 756e  self, numpy_ufun
+00004ce0: 632c 206d 6574 686f 642c 202a 696e 7075  c, method, *inpu
+00004cf0: 7473 2c20 2a2a 6b77 6172 6773 293a 0a20  ts, **kwargs):. 
+00004d00: 2020 2020 2020 206f 7574 203d 206b 7761         out = kwa
+00004d10: 7267 732e 6765 7428 226f 7574 222c 2028  rgs.get("out", (
+00004d20: 2929 0a20 2020 2020 2020 2066 6f72 2078  )).        for x
+00004d30: 2069 6e20 696e 7075 7473 202b 206f 7574   in inputs + out
+00004d40: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00004d50: 7566 756e 6373 2077 6f72 6b20 7769 7468  ufuncs work with
+00004d60: 2030 2d64 696d 656e 7369 6f6e 616c 204e   0-dimensional N
+00004d70: 756d 5079 206e 6461 7272 6179 730a 2020  umPy ndarrays.  
+00004d80: 2020 2020 2020 2020 2020 2320 736f 2077            # so w
+00004d90: 6520 646f 6e27 7420 7761 6e74 2074 6f20  e don't want to 
+00004da0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+00004db0: 6e74 6564 0a20 2020 2020 2020 2020 2020  nted.           
+00004dc0: 2069 6620 6973 696e 7374 616e 6365 2878   if isinstance(x
+00004dd0: 2c20 6e70 2e6e 6461 7272 6179 2920 616e  , np.ndarray) an
+00004de0: 6420 782e 7368 6170 6520 3d3d 2028 293a  d x.shape == ():
+00004df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004e00: 2063 6f6e 7469 6e75 650a 2020 2020 2020   continue.      
+00004e10: 2020 2020 2020 656c 6966 206e 6f74 2069        elif not i
+00004e20: 7369 6e73 7461 6e63 6528 0a20 2020 2020  sinstance(.     
+00004e30: 2020 2020 2020 2020 2020 2078 2c20 284e             x, (N
+00004e40: 756d 6265 722c 2053 6361 6c61 722c 205f  umber, Scalar, _
+00004e50: 4672 616d 652c 2041 7272 6179 2c20 7064  Frame, Array, pd
+00004e60: 2e44 6174 6146 7261 6d65 2c20 7064 2e53  .DataFrame, pd.S
+00004e70: 6572 6965 732c 2070 642e 496e 6465 7829  eries, pd.Index)
+00004e80: 0a20 2020 2020 2020 2020 2020 2029 3a0a  .            ):.
+00004e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ea0: 7265 7475 726e 204e 6f74 496d 706c 656d  return NotImplem
+00004eb0: 656e 7465 640a 0a20 2020 2020 2020 2069  ented..        i
+00004ec0: 6620 6d65 7468 6f64 203d 3d20 225f 5f63  f method == "__c
+00004ed0: 616c 6c5f 5f22 3a0a 2020 2020 2020 2020  all__":.        
+00004ee0: 2020 2020 6966 206e 756d 7079 5f75 6675      if numpy_ufu
+00004ef0: 6e63 2e73 6967 6e61 7475 7265 2069 7320  nc.signature is 
+00004f00: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00004f10: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00004f20: 204e 6f74 496d 706c 656d 656e 7465 640a   NotImplemented.
+00004f30: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00004f40: 756d 7079 5f75 6675 6e63 2e6e 6f75 7420  umpy_ufunc.nout 
+00004f50: 3e20 313a 0a20 2020 2020 2020 2020 2020  > 1:.           
+00004f60: 2020 2020 2023 2075 6675 6e63 7320 7769       # ufuncs wi
+00004f70: 7468 206d 756c 7469 706c 6520 6f75 7470  th multiple outp
+00004f80: 7574 2076 616c 7565 730a 2020 2020 2020  ut values.      
+00004f90: 2020 2020 2020 2020 2020 2320 6172 6520            # are 
+00004fa0: 6e6f 7420 7965 7420 7375 7070 6f72 7465  not yet supporte
+00004fb0: 6420 666f 7220 6672 616d 6573 0a20 2020  d for frames.   
+00004fc0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00004fd0: 7572 6e20 4e6f 7449 6d70 6c65 6d65 6e74  urn NotImplement
+00004fe0: 6564 0a20 2020 2020 2020 2020 2020 2065  ed.            e
+00004ff0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00005000: 2020 2020 2072 6574 7572 6e20 656c 656d       return elem
+00005010: 7769 7365 286e 756d 7079 5f75 6675 6e63  wise(numpy_ufunc
+00005020: 2c20 2a69 6e70 7574 732c 202a 2a6b 7761  , *inputs, **kwa
+00005030: 7267 7329 0a20 2020 2020 2020 2065 6c73  rgs).        els
+00005040: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+00005050: 2075 6675 6e63 206d 6574 686f 6473 2061   ufunc methods a
+00005060: 7265 206e 6f74 2079 6574 2073 7570 706f  re not yet suppo
+00005070: 7274 6564 2066 6f72 2066 7261 6d65 730a  rted for frames.
+00005080: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00005090: 726e 204e 6f74 496d 706c 656d 656e 7465  rn NotImplemente
+000050a0: 640a 0a20 2020 2040 7072 6f70 6572 7479  d..    @property
+000050b0: 0a20 2020 2064 6566 205f 656c 656d 7769  .    def _elemwi
+000050c0: 7365 2873 656c 6629 3a0a 2020 2020 2020  se(self):.      
+000050d0: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
+000050e0: 650a 0a20 2020 2064 6566 205f 7265 7072  e..    def _repr
+000050f0: 5f64 6174 6128 7365 6c66 293a 0a20 2020  _data(self):.   
+00005100: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00005110: 706c 656d 656e 7465 6445 7272 6f72 0a0a  plementedError..
+00005120: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00005130: 2020 6465 6620 5f72 6570 725f 6469 7669    def _repr_divi
+00005140: 7369 6f6e 7328 7365 6c66 293a 0a20 2020  sions(self):.   
+00005150: 2020 2020 206e 616d 6520 3d20 6622 6e70       name = f"np
+00005160: 6172 7469 7469 6f6e 733d 7b73 656c 662e  artitions={self.
+00005170: 6e70 6172 7469 7469 6f6e 737d 220a 2020  npartitions}".  
+00005180: 2020 2020 2020 6966 2073 656c 662e 6b6e        if self.kn
+00005190: 6f77 6e5f 6469 7669 7369 6f6e 733a 0a20  own_divisions:. 
+000051a0: 2020 2020 2020 2020 2020 2064 6976 6973             divis
+000051b0: 696f 6e73 203d 2070 642e 496e 6465 7828  ions = pd.Index(
+000051c0: 7365 6c66 2e64 6976 6973 696f 6e73 2c20  self.divisions, 
+000051d0: 6e61 6d65 3d6e 616d 6529 0a20 2020 2020  name=name).     
+000051e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000051f0: 2020 2020 2023 2061 766f 6964 2074 6f20       # avoid to 
+00005200: 6265 2063 6f6e 7665 7274 6564 2074 6f20  be converted to 
+00005210: 4e61 4e0a 2020 2020 2020 2020 2020 2020  NaN.            
+00005220: 6469 7669 7369 6f6e 7320 3d20 7064 2e49  divisions = pd.I
+00005230: 6e64 6578 285b 2222 5d20 2a20 2873 656c  ndex([""] * (sel
+00005240: 662e 6e70 6172 7469 7469 6f6e 7320 2b20  f.npartitions + 
+00005250: 3129 2c20 6e61 6d65 3d6e 616d 6529 0a20  1), name=name). 
+00005260: 2020 2020 2020 2072 6574 7572 6e20 6469         return di
+00005270: 7669 7369 6f6e 730a 0a20 2020 2064 6566  visions..    def
+00005280: 205f 5f72 6570 725f 5f28 7365 6c66 293a   __repr__(self):
+00005290: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
+000052a0: 7365 6c66 2e5f 7265 7072 5f64 6174 6128  self._repr_data(
+000052b0: 292e 746f 5f73 7472 696e 6728 6d61 785f  ).to_string(max_
+000052c0: 726f 7773 3d35 2c20 7368 6f77 5f64 696d  rows=5, show_dim
+000052d0: 656e 7369 6f6e 733d 4661 6c73 6529 0a20  ensions=False). 
+000052e0: 2020 2020 2020 205f 7374 725f 666d 7420         _str_fmt 
+000052f0: 3d20 2222 2244 6173 6b20 7b6b 6c61 7373  = """Dask {klass
+00005300: 7d20 5374 7275 6374 7572 653a 0a7b 6461  } Structure:.{da
+00005310: 7461 7d0a 4461 736b 204e 616d 653a 207b  ta}.Dask Name: {
+00005320: 6e61 6d65 7d2c 207b 6c61 7965 7273 7d22  name}, {layers}"
+00005330: 2222 0a20 2020 2020 2020 2069 6620 6c65  "".        if le
+00005340: 6e28 7365 6c66 2e63 6f6c 756d 6e73 2920  n(self.columns) 
+00005350: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+00005360: 2020 6461 7461 203d 2064 6174 612e 7061    data = data.pa
+00005370: 7274 6974 696f 6e28 225c 6e22 295b 2d31  rtition("\n")[-1
+00005380: 5d2e 7265 706c 6163 6528 2249 6e64 6578  ].replace("Index
+00005390: 222c 2022 4469 7669 7369 6f6e 7322 290a  ", "Divisions").
+000053a0: 2020 2020 2020 2020 2020 2020 5f73 7472              _str
+000053b0: 5f66 6d74 203d 2066 2245 6d70 7479 207b  _fmt = f"Empty {
+000053c0: 5f73 7472 5f66 6d74 7d22 0a20 2020 2020  _str_fmt}".     
+000053d0: 2020 2072 6574 7572 6e20 5f73 7472 5f66     return _str_f
+000053e0: 6d74 2e66 6f72 6d61 7428 0a20 2020 2020  mt.format(.     
+000053f0: 2020 2020 2020 206b 6c61 7373 3d73 656c         klass=sel
+00005400: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+00005410: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+00005420: 2020 6461 7461 3d64 6174 612c 0a20 2020    data=data,.   
+00005430: 2020 2020 2020 2020 206e 616d 653d 6b65           name=ke
+00005440: 795f 7370 6c69 7428 7365 6c66 2e5f 6e61  y_split(self._na
+00005450: 6d65 292c 0a20 2020 2020 2020 2020 2020  me),.           
+00005460: 206c 6179 6572 733d 6d61 7962 655f 706c   layers=maybe_pl
+00005470: 7572 616c 697a 6528 6c65 6e28 7365 6c66  uralize(len(self
+00005480: 2e64 6173 6b2e 6c61 7965 7273 292c 2022  .dask.layers), "
+00005490: 6772 6170 6820 6c61 7965 7222 292c 0a20  graph layer"),. 
+000054a0: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
+000054b0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+000054c0: 696e 6465 7828 7365 6c66 293a 0a20 2020  index(self):.   
+000054d0: 2020 2020 2022 2222 5265 7475 726e 2064       """Return d
+000054e0: 6173 6b20 496e 6465 7820 696e 7374 616e  ask Index instan
+000054f0: 6365 2222 220a 2020 2020 2020 2020 7265  ce""".        re
+00005500: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+00005510: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00005520: 2020 2020 2020 6765 7461 7474 722c 0a20        getattr,. 
+00005530: 2020 2020 2020 2020 2020 2022 696e 6465             "inde
+00005540: 7822 2c0a 2020 2020 2020 2020 2020 2020  x",.            
+00005550: 746f 6b65 6e3d 6b65 795f 7370 6c69 7428  token=key_split(
+00005560: 7365 6c66 2e5f 6e61 6d65 2920 2b20 222d  self._name) + "-
+00005570: 696e 6465 7822 2c0a 2020 2020 2020 2020  index",.        
+00005580: 2020 2020 6d65 7461 3d73 656c 662e 5f6d      meta=self._m
+00005590: 6574 612e 696e 6465 782c 0a20 2020 2020  eta.index,.     
+000055a0: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
+000055b0: 6574 6164 6174 613d 4661 6c73 652c 0a20  etadata=False,. 
+000055c0: 2020 2020 2020 2029 0a0a 2020 2020 4069         )..    @i
+000055d0: 6e64 6578 2e73 6574 7465 720a 2020 2020  ndex.setter.    
+000055e0: 6465 6620 696e 6465 7828 7365 6c66 2c20  def index(self, 
+000055f0: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
+00005600: 7365 6c66 2e64 6976 6973 696f 6e73 203d  self.divisions =
+00005610: 2076 616c 7565 2e64 6976 6973 696f 6e73   value.divisions
+00005620: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
+00005630: 3d20 6d61 705f 7061 7274 6974 696f 6e73  = map_partitions
+00005640: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
+00005650: 7468 6f64 732e 6173 7369 676e 5f69 6e64  thods.assign_ind
+00005660: 6578 2c20 7365 6c66 2c20 7661 6c75 652c  ex, self, value,
+00005670: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+00005680: 613d 4661 6c73 650a 2020 2020 2020 2020  a=False.        
+00005690: 290a 2020 2020 2020 2020 7365 6c66 2e64  ).        self.d
+000056a0: 6173 6b20 3d20 7265 7375 6c74 2e64 6173  ask = result.das
+000056b0: 6b0a 2020 2020 2020 2020 7365 6c66 2e5f  k.        self._
+000056c0: 6e61 6d65 203d 2072 6573 756c 742e 5f6e  name = result._n
+000056d0: 616d 650a 2020 2020 2020 2020 7365 6c66  ame.        self
+000056e0: 2e5f 6d65 7461 203d 2072 6573 756c 742e  ._meta = result.
+000056f0: 5f6d 6574 610a 0a20 2020 2064 6566 2072  _meta..    def r
+00005700: 6573 6574 5f69 6e64 6578 2873 656c 662c  eset_index(self,
+00005710: 2064 726f 703d 4661 6c73 6529 3a0a 2020   drop=False):.  
+00005720: 2020 2020 2020 2222 2252 6573 6574 2074        """Reset t
+00005730: 6865 2069 6e64 6578 2074 6f20 7468 6520  he index to the 
+00005740: 6465 6661 756c 7420 696e 6465 782e 0a0a  default index...
+00005750: 2020 2020 2020 2020 4e6f 7465 2074 6861          Note tha
+00005760: 7420 756e 6c69 6b65 2069 6e20 6060 7061  t unlike in ``pa
+00005770: 6e64 6173 6060 2c20 7468 6520 7265 7365  ndas``, the rese
+00005780: 7420 6060 6461 736b 2e64 6174 6166 7261  t ``dask.datafra
+00005790: 6d65 6060 2069 6e64 6578 2077 696c 6c0a  me`` index will.
+000057a0: 2020 2020 2020 2020 6e6f 7420 6265 206d          not be m
+000057b0: 6f6e 6f74 6f6e 6963 616c 6c79 2069 6e63  onotonically inc
+000057c0: 7265 6173 696e 6720 6672 6f6d 2030 2e20  reasing from 0. 
+000057d0: 496e 7374 6561 642c 2069 7420 7769 6c6c  Instead, it will
+000057e0: 2072 6573 7461 7274 2061 7420 300a 2020   restart at 0.  
+000057f0: 2020 2020 2020 666f 7220 6561 6368 2070        for each p
+00005800: 6172 7469 7469 6f6e 2028 652e 672e 2060  artition (e.g. `
+00005810: 6069 6e64 6578 3120 3d20 5b30 2c20 2e2e  `index1 = [0, ..
+00005820: 2e2c 2031 305d 2c20 696e 6465 7832 203d  ., 10], index2 =
+00005830: 205b 302c 202e 2e2e 5d60 6029 2e0a 2020   [0, ...]``)..  
+00005840: 2020 2020 2020 5468 6973 2069 7320 6475        This is du
+00005850: 6520 746f 2074 6865 2069 6e61 6269 6c69  e to the inabili
+00005860: 7479 2074 6f20 7374 6174 6963 616c 6c79  ty to statically
+00005870: 206b 6e6f 7720 7468 6520 6675 6c6c 206c   know the full l
+00005880: 656e 6774 6820 6f66 2074 6865 0a20 2020  ength of the.   
+00005890: 2020 2020 2069 6e64 6578 2e0a 0a20 2020       index...   
+000058a0: 2020 2020 2046 6f72 2044 6174 6146 7261       For DataFra
+000058b0: 6d65 2077 6974 6820 6d75 6c74 692d 6c65  me with multi-le
+000058c0: 7665 6c20 696e 6465 782c 2072 6574 7572  vel index, retur
+000058d0: 6e73 2061 206e 6577 2044 6174 6146 7261  ns a new DataFra
+000058e0: 6d65 2077 6974 680a 2020 2020 2020 2020  me with.        
+000058f0: 6c61 6265 6c69 6e67 2069 6e66 6f72 6d61  labeling informa
+00005900: 7469 6f6e 2069 6e20 7468 6520 636f 6c75  tion in the colu
+00005910: 6d6e 7320 756e 6465 7220 7468 6520 696e  mns under the in
+00005920: 6465 7820 6e61 6d65 732c 2064 6566 6175  dex names, defau
+00005930: 6c74 696e 670a 2020 2020 2020 2020 746f  lting.        to
+00005940: 2027 6c65 7665 6c5f 3027 2c20 276c 6576   'level_0', 'lev
+00005950: 656c 5f31 272c 2065 7463 2e20 6966 2061  el_1', etc. if a
+00005960: 6e79 2061 7265 204e 6f6e 652e 2046 6f72  ny are None. For
+00005970: 2061 2073 7461 6e64 6172 6420 696e 6465   a standard inde
+00005980: 782c 0a20 2020 2020 2020 2074 6865 2069  x,.        the i
+00005990: 6e64 6578 206e 616d 6520 7769 6c6c 2062  ndex name will b
+000059a0: 6520 7573 6564 2028 6966 2073 6574 292c  e used (if set),
+000059b0: 206f 7468 6572 7769 7365 2061 2064 6566   otherwise a def
+000059c0: 6175 6c74 2027 696e 6465 7827 206f 720a  ault 'index' or.
+000059d0: 2020 2020 2020 2020 276c 6576 656c 5f30          'level_0
+000059e0: 2720 2869 6620 2769 6e64 6578 2720 6973  ' (if 'index' is
+000059f0: 2061 6c72 6561 6479 2074 616b 656e 2920   already taken) 
+00005a00: 7769 6c6c 2062 6520 7573 6564 2e0a 0a20  will be used... 
+00005a10: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00005a20: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00005a30: 2d2d 2d2d 0a20 2020 2020 2020 2064 726f  ----.        dro
+00005a40: 7020 3a20 626f 6f6c 6561 6e2c 2064 6566  p : boolean, def
+00005a50: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
+00005a60: 2020 2020 2020 2044 6f20 6e6f 7420 7472         Do not tr
+00005a70: 7920 746f 2069 6e73 6572 7420 696e 6465  y to insert inde
+00005a80: 7820 696e 746f 2064 6174 6166 7261 6d65  x into dataframe
+00005a90: 2063 6f6c 756d 6e73 2e0a 2020 2020 2020   columns..      
+00005aa0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00005ab0: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+00005ac0: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00005ad0: 2020 2020 2020 4d2e 7265 7365 745f 696e        M.reset_in
+00005ae0: 6465 782c 2064 726f 703d 6472 6f70 2c20  dex, drop=drop, 
+00005af0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00005b00: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
+00005b10: 2e63 6c65 6172 5f64 6976 6973 696f 6e73  .clear_divisions
+00005b20: 2829 0a0a 2020 2020 4070 726f 7065 7274  ()..    @propert
+00005b30: 790a 2020 2020 6465 6620 6b6e 6f77 6e5f  y.    def known_
+00005b40: 6469 7669 7369 6f6e 7328 7365 6c66 293a  divisions(self):
+00005b50: 0a20 2020 2020 2020 2022 2222 5768 6574  .        """Whet
+00005b60: 6865 7220 6469 7669 7369 6f6e 7320 6172  her divisions ar
+00005b70: 6520 616c 7265 6164 7920 6b6e 6f77 6e22  e already known"
+00005b80: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00005b90: 6e20 6c65 6e28 7365 6c66 2e64 6976 6973  n len(self.divis
+00005ba0: 696f 6e73 2920 3e20 3020 616e 6420 7365  ions) > 0 and se
+00005bb0: 6c66 2e64 6976 6973 696f 6e73 5b30 5d20  lf.divisions[0] 
+00005bc0: 6973 206e 6f74 204e 6f6e 650a 0a20 2020  is not None..   
+00005bd0: 2064 6566 2063 6c65 6172 5f64 6976 6973   def clear_divis
+00005be0: 696f 6e73 2873 656c 6629 3a0a 2020 2020  ions(self):.    
+00005bf0: 2020 2020 2222 2246 6f72 6765 7420 6469      """Forget di
+00005c00: 7669 7369 6f6e 2069 6e66 6f72 6d61 7469  vision informati
+00005c10: 6f6e 2222 220a 2020 2020 2020 2020 6469  on""".        di
+00005c20: 7669 7369 6f6e 7320 3d20 284e 6f6e 652c  visions = (None,
+00005c30: 2920 2a20 2873 656c 662e 6e70 6172 7469  ) * (self.nparti
+00005c40: 7469 6f6e 7320 2b20 3129 0a20 2020 2020  tions + 1).     
+00005c50: 2020 2072 6574 7572 6e20 7479 7065 2873     return type(s
+00005c60: 656c 6629 2873 656c 662e 6461 736b 2c20  elf)(self.dask, 
+00005c70: 7365 6c66 2e5f 6e61 6d65 2c20 7365 6c66  self._name, self
+00005c80: 2e5f 6d65 7461 2c20 6469 7669 7369 6f6e  ._meta, division
+00005c90: 7329 0a0a 2020 2020 6465 6620 636f 6d70  s)..    def comp
+00005ca0: 7574 655f 6375 7272 656e 745f 6469 7669  ute_current_divi
+00005cb0: 7369 6f6e 7328 7365 6c66 2c20 636f 6c3d  sions(self, col=
+00005cc0: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+00005cd0: 2222 436f 6d70 7574 6520 7468 6520 6375  ""Compute the cu
+00005ce0: 7272 656e 7420 6469 7669 7369 6f6e 7320  rrent divisions 
+00005cf0: 6f66 2074 6865 2044 6174 6146 7261 6d65  of the DataFrame
+00005d00: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
+00005d10: 6d65 7468 6f64 2074 7269 6767 6572 7320  method triggers 
+00005d20: 696d 6d65 6469 6174 6520 636f 6d70 7574  immediate comput
+00005d30: 6174 696f 6e2e 2049 6620 796f 7520 6669  ation. If you fi
+00005d40: 6e64 2079 6f75 7273 656c 6620 7275 6e6e  nd yourself runn
+00005d50: 696e 6720 7468 6973 2063 6f6d 6d61 6e64  ing this command
+00005d60: 0a20 2020 2020 2020 2072 6570 6561 7465  .        repeate
+00005d70: 646c 7920 666f 7220 7468 6520 7361 6d65  dly for the same
+00005d80: 2064 6174 6166 7261 6d65 2c20 7765 2072   dataframe, we r
+00005d90: 6563 6f6d 6d65 6e64 2073 746f 7269 6e67  ecommend storing
+00005da0: 2074 6865 2072 6573 756c 740a 2020 2020   the result.    
+00005db0: 2020 2020 736f 2079 6f75 2064 6f6e 2774      so you don't
+00005dc0: 2068 6176 6520 746f 2072 6572 756e 2069   have to rerun i
+00005dd0: 742e 0a0a 2020 2020 2020 2020 4966 2074  t...        If t
+00005de0: 6865 2063 6f6c 756d 6e20 6f72 2069 6e64  he column or ind
+00005df0: 6578 2076 616c 7565 7320 6f76 6572 6c61  ex values overla
+00005e00: 7020 6265 7477 6565 6e20 7061 7274 6974  p between partit
+00005e10: 696f 6e73 2c20 7261 6973 6573 2060 6056  ions, raises ``V
+00005e20: 616c 7565 4572 726f 7260 602e 0a20 2020  alueError``..   
+00005e30: 2020 2020 2054 6f20 7072 6576 656e 7420       To prevent 
+00005e40: 7468 6973 2c20 6d61 6b65 2073 7572 6520  this, make sure 
+00005e50: 7468 6520 6461 7461 2061 7265 2073 6f72  the data are sor
+00005e60: 7465 6420 6279 2074 6865 2063 6f6c 756d  ted by the colum
+00005e70: 6e20 6f72 2069 6e64 6578 2e0a 0a20 2020  n or index...   
+00005e80: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00005e90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00005ea0: 2d2d 0a20 2020 2020 2020 2063 6f6c 203a  --.        col :
+00005eb0: 2073 7472 696e 672c 206f 7074 696f 6e61   string, optiona
+00005ec0: 6c0a 2020 2020 2020 2020 2020 2020 4361  l.            Ca
+00005ed0: 6c63 756c 6174 6520 7468 6520 6469 7669  lculate the divi
+00005ee0: 7369 6f6e 7320 666f 7220 6120 6e6f 6e2d  sions for a non-
+00005ef0: 696e 6465 7820 636f 6c75 6d6e 2062 7920  index column by 
+00005f00: 7061 7373 696e 6720 696e 2074 6865 206e  passing in the n
+00005f10: 616d 6520 6f66 2074 6865 2063 6f6c 756d  ame of the colum
+00005f20: 6e2e 0a20 2020 2020 2020 2020 2020 2049  n..            I
+00005f30: 6620 636f 6c20 6973 206e 6f74 2073 7065  f col is not spe
+00005f40: 6369 6669 6564 2c20 7468 6520 696e 6465  cified, the inde
+00005f50: 7820 7769 6c6c 2062 6520 7573 6564 2074  x will be used t
+00005f60: 6f20 6361 6c63 756c 6174 6520 6469 7669  o calculate divi
+00005f70: 7369 6f6e 732e 0a20 2020 2020 2020 2020  sions..         
+00005f80: 2020 2049 6e20 7468 6973 2063 6173 652c     In this case,
+00005f90: 2069 6620 7468 6520 6469 7669 7369 6f6e   if the division
+00005fa0: 7320 6172 6520 616c 7265 6164 7920 6b6e  s are already kn
+00005fb0: 6f77 6e2c 2074 6865 7920 7769 6c6c 2062  own, they will b
+00005fc0: 6520 7265 7475 726e 6564 0a20 2020 2020  e returned.     
+00005fd0: 2020 2020 2020 2069 6d6d 6564 6961 7465         immediate
+00005fe0: 6c79 2077 6974 686f 7574 2063 6f6d 7075  ly without compu
+00005ff0: 7469 6e67 2e0a 0a20 2020 2020 2020 2045  ting...        E
+00006000: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+00006010: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00006020: 203e 3e3e 2069 6d70 6f72 7420 6461 736b   >>> import dask
+00006030: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
+00006040: 203d 2064 6173 6b2e 6461 7461 7365 7473   = dask.datasets
+00006050: 2e74 696d 6573 6572 6965 7328 7374 6172  .timeseries(star
+00006060: 743d 2232 3032 312d 3031 2d30 3122 2c20  t="2021-01-01", 
+00006070: 656e 643d 2232 3032 312d 3031 2d30 3722  end="2021-01-07"
+00006080: 2c20 6672 6571 3d22 3148 2229 2e63 6c65  , freq="1H").cle
+00006090: 6172 5f64 6976 6973 696f 6e73 2829 0a20  ar_divisions(). 
+000060a0: 2020 2020 2020 203e 3e3e 2064 6976 6973         >>> divis
+000060b0: 696f 6e73 203d 2064 6466 2e63 6f6d 7075  ions = ddf.compu
+000060c0: 7465 5f63 7572 7265 6e74 5f64 6976 6973  te_current_divis
+000060d0: 696f 6e73 2829 0a20 2020 2020 2020 203e  ions().        >
+000060e0: 3e3e 2070 7269 6e74 2864 6976 6973 696f  >> print(divisio
+000060f0: 6e73 2920 2023 2064 6f63 7465 7374 3a20  ns)  # doctest: 
+00006100: 2b4e 4f52 4d41 4c49 5a45 5f57 4849 5445  +NORMALIZE_WHITE
+00006110: 5350 4143 450a 2020 2020 2020 2020 2854  SPACE.        (T
 00006120: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
-00006130: 312d 3033 2030 303a 3030 3a30 3027 292c  1-03 00:00:00'),
+00006130: 312d 3031 2030 303a 3030 3a30 3027 292c  1-01 00:00:00'),
 00006140: 0a20 2020 2020 2020 2020 5469 6d65 7374  .         Timest
-00006150: 616d 7028 2732 3032 312d 3031 2d30 3420  amp('2021-01-04 
+00006150: 616d 7028 2732 3032 312d 3031 2d30 3220  amp('2021-01-02 
 00006160: 3030 3a30 303a 3030 2729 2c0a 2020 2020  00:00:00'),.    
 00006170: 2020 2020 2054 696d 6573 7461 6d70 2827       Timestamp('
-00006180: 3230 3231 2d30 312d 3035 2030 303a 3030  2021-01-05 00:00
+00006180: 3230 3231 2d30 312d 3033 2030 303a 3030  2021-01-03 00:00
 00006190: 3a30 3027 292c 0a20 2020 2020 2020 2020  :00'),.         
 000061a0: 5469 6d65 7374 616d 7028 2732 3032 312d  Timestamp('2021-
-000061b0: 3031 2d30 3620 3030 3a30 303a 3030 2729  01-06 00:00:00')
+000061b0: 3031 2d30 3420 3030 3a30 303a 3030 2729  01-04 00:00:00')
 000061c0: 2c0a 2020 2020 2020 2020 2054 696d 6573  ,.         Times
-000061d0: 7461 6d70 2827 3230 3231 2d30 312d 3036  tamp('2021-01-06
-000061e0: 2032 333a 3030 3a30 3027 2929 0a0a 2020   23:00:00'))..  
-000061f0: 2020 2020 2020 3e3e 3e20 6464 662e 6469        >>> ddf.di
-00006200: 7669 7369 6f6e 7320 3d20 6469 7669 7369  visions = divisi
-00006210: 6f6e 730a 2020 2020 2020 2020 3e3e 3e20  ons.        >>> 
-00006220: 6464 662e 6b6e 6f77 6e5f 6469 7669 7369  ddf.known_divisi
-00006230: 6f6e 730a 2020 2020 2020 2020 5472 7565  ons.        True
-00006240: 0a0a 2020 2020 2020 2020 3e3e 3e20 6464  ..        >>> dd
-00006250: 6620 3d20 6464 662e 7265 7365 745f 696e  f = ddf.reset_in
-00006260: 6465 7828 292e 636c 6561 725f 6469 7669  dex().clear_divi
-00006270: 7369 6f6e 7328 290a 2020 2020 2020 2020  sions().        
-00006280: 3e3e 3e20 6469 7669 7369 6f6e 7320 3d20  >>> divisions = 
-00006290: 6464 662e 636f 6d70 7574 655f 6375 7272  ddf.compute_curr
-000062a0: 656e 745f 6469 7669 7369 6f6e 7328 2274  ent_divisions("t
-000062b0: 696d 6573 7461 6d70 2229 0a20 2020 2020  imestamp").     
-000062c0: 2020 203e 3e3e 2070 7269 6e74 2864 6976     >>> print(div
-000062d0: 6973 696f 6e73 2920 2023 2064 6f63 7465  isions)  # docte
-000062e0: 7374 3a20 2b4e 4f52 4d41 4c49 5a45 5f57  st: +NORMALIZE_W
-000062f0: 4849 5445 5350 4143 450a 2020 2020 2020  HITESPACE.      
-00006300: 2020 2854 696d 6573 7461 6d70 2827 3230    (Timestamp('20
-00006310: 3231 2d30 312d 3031 2030 303a 3030 3a30  21-01-01 00:00:0
-00006320: 3027 292c 0a20 2020 2020 2020 2020 5469  0'),.         Ti
-00006330: 6d65 7374 616d 7028 2732 3032 312d 3031  mestamp('2021-01
-00006340: 2d30 3220 3030 3a30 303a 3030 2729 2c0a  -02 00:00:00'),.
-00006350: 2020 2020 2020 2020 2054 696d 6573 7461           Timesta
-00006360: 6d70 2827 3230 3231 2d30 312d 3033 2030  mp('2021-01-03 0
+000061d0: 7461 6d70 2827 3230 3231 2d30 312d 3035  tamp('2021-01-05
+000061e0: 2030 303a 3030 3a30 3027 292c 0a20 2020   00:00:00'),.   
+000061f0: 2020 2020 2020 5469 6d65 7374 616d 7028        Timestamp(
+00006200: 2732 3032 312d 3031 2d30 3620 3030 3a30  '2021-01-06 00:0
+00006210: 303a 3030 2729 2c0a 2020 2020 2020 2020  0:00'),.        
+00006220: 2054 696d 6573 7461 6d70 2827 3230 3231   Timestamp('2021
+00006230: 2d30 312d 3036 2032 333a 3030 3a30 3027  -01-06 23:00:00'
+00006240: 2929 0a0a 2020 2020 2020 2020 3e3e 3e20  ))..        >>> 
+00006250: 6464 662e 6469 7669 7369 6f6e 7320 3d20  ddf.divisions = 
+00006260: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
+00006270: 2020 3e3e 3e20 6464 662e 6b6e 6f77 6e5f    >>> ddf.known_
+00006280: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
+00006290: 2020 5472 7565 0a0a 2020 2020 2020 2020    True..        
+000062a0: 3e3e 3e20 6464 6620 3d20 6464 662e 7265  >>> ddf = ddf.re
+000062b0: 7365 745f 696e 6465 7828 292e 636c 6561  set_index().clea
+000062c0: 725f 6469 7669 7369 6f6e 7328 290a 2020  r_divisions().  
+000062d0: 2020 2020 2020 3e3e 3e20 6469 7669 7369        >>> divisi
+000062e0: 6f6e 7320 3d20 6464 662e 636f 6d70 7574  ons = ddf.comput
+000062f0: 655f 6375 7272 656e 745f 6469 7669 7369  e_current_divisi
+00006300: 6f6e 7328 2274 696d 6573 7461 6d70 2229  ons("timestamp")
+00006310: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00006320: 6e74 2864 6976 6973 696f 6e73 2920 2023  nt(divisions)  #
+00006330: 2064 6f63 7465 7374 3a20 2b4e 4f52 4d41   doctest: +NORMA
+00006340: 4c49 5a45 5f57 4849 5445 5350 4143 450a  LIZE_WHITESPACE.
+00006350: 2020 2020 2020 2020 2854 696d 6573 7461          (Timesta
+00006360: 6d70 2827 3230 3231 2d30 312d 3031 2030  mp('2021-01-01 0
 00006370: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
 00006380: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
-00006390: 3032 312d 3031 2d30 3420 3030 3a30 303a  021-01-04 00:00:
+00006390: 3032 312d 3031 2d30 3220 3030 3a30 303a  021-01-02 00:00:
 000063a0: 3030 2729 2c0a 2020 2020 2020 2020 2054  00'),.         T
 000063b0: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
-000063c0: 312d 3035 2030 303a 3030 3a30 3027 292c  1-05 00:00:00'),
+000063c0: 312d 3033 2030 303a 3030 3a30 3027 292c  1-03 00:00:00'),
 000063d0: 0a20 2020 2020 2020 2020 5469 6d65 7374  .         Timest
-000063e0: 616d 7028 2732 3032 312d 3031 2d30 3620  amp('2021-01-06 
+000063e0: 616d 7028 2732 3032 312d 3031 2d30 3420  amp('2021-01-04 
 000063f0: 3030 3a30 303a 3030 2729 2c0a 2020 2020  00:00:00'),.    
 00006400: 2020 2020 2054 696d 6573 7461 6d70 2827       Timestamp('
-00006410: 3230 3231 2d30 312d 3036 2032 333a 3030  2021-01-06 23:00
-00006420: 3a30 3027 2929 0a0a 2020 2020 2020 2020  :00'))..        
-00006430: 3e3e 3e20 6464 6620 3d20 6464 662e 7365  >>> ddf = ddf.se
-00006440: 745f 696e 6465 7828 2274 696d 6573 7461  t_index("timesta
-00006450: 6d70 222c 2064 6976 6973 696f 6e73 3d64  mp", divisions=d
-00006460: 6976 6973 696f 6e73 2c20 736f 7274 6564  ivisions, sorted
-00006470: 3d54 7275 6529 0a20 2020 2020 2020 2022  =True).        "
-00006480: 2222 0a20 2020 2020 2020 2069 6620 636f  "".        if co
-00006490: 6c20 6973 204e 6f6e 6520 616e 6420 7365  l is None and se
-000064a0: 6c66 2e6b 6e6f 776e 5f64 6976 6973 696f  lf.known_divisio
-000064b0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-000064c0: 7265 7475 726e 2073 656c 662e 6469 7669  return self.divi
-000064d0: 7369 6f6e 730a 0a20 2020 2020 2020 2066  sions..        f
-000064e0: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-000064f0: 6d65 2e73 6875 6666 6c65 2069 6d70 6f72  me.shuffle impor
-00006500: 7420 636f 6d70 7574 655f 6469 7669 7369  t compute_divisi
-00006510: 6f6e 730a 0a20 2020 2020 2020 2072 6574  ons..        ret
-00006520: 7572 6e20 636f 6d70 7574 655f 6469 7669  urn compute_divi
-00006530: 7369 6f6e 7328 7365 6c66 2c20 636f 6c3d  sions(self, col=
-00006540: 636f 6c29 0a0a 2020 2020 6465 6620 6765  col)..    def ge
-00006550: 745f 7061 7274 6974 696f 6e28 7365 6c66  t_partition(self
-00006560: 2c20 6e29 3a0a 2020 2020 2020 2020 2222  , n):.        ""
-00006570: 220a 2020 2020 2020 2020 4765 7420 6120  ".        Get a 
-00006580: 6461 736b 2044 6174 6146 7261 6d65 2f53  dask DataFrame/S
-00006590: 6572 6965 7320 7265 7072 6573 656e 7469  eries representi
-000065a0: 6e67 2074 6865 2060 6e74 6860 2070 6172  ng the `nth` par
-000065b0: 7469 7469 6f6e 2e0a 0a20 2020 2020 2020  tition...       
-000065c0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-000065d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-000065e0: 2020 2020 2020 206e 203a 2069 6e74 0a20         n : int. 
-000065f0: 2020 2020 2020 2020 2020 2054 6865 2030             The 0
-00006600: 2d69 6e64 6578 6564 2070 6172 7469 7469  -indexed partiti
-00006610: 6f6e 206e 756d 6265 7220 746f 2073 656c  on number to sel
-00006620: 6563 742e 0a0a 2020 2020 2020 2020 5265  ect...        Re
-00006630: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-00006640: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
-00006650: 736b 2044 6174 6146 7261 6d65 206f 7220  sk DataFrame or 
-00006660: 5365 7269 6573 0a20 2020 2020 2020 2020  Series.         
-00006670: 2020 2054 6865 2073 616d 6520 7479 7065     The same type
-00006680: 2061 7320 7468 6520 6f72 6967 696e 616c   as the original
-00006690: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
-000066a0: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
-000066b0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-000066c0: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-000066d0: 6173 6b0a 2020 2020 2020 2020 3e3e 3e20  ask.        >>> 
-000066e0: 6464 6620 3d20 6461 736b 2e64 6174 6173  ddf = dask.datas
-000066f0: 6574 732e 7469 6d65 7365 7269 6573 2873  ets.timeseries(s
-00006700: 7461 7274 3d22 3230 3231 2d30 312d 3031  tart="2021-01-01
-00006710: 222c 2065 6e64 3d22 3230 3231 2d30 312d  ", end="2021-01-
-00006720: 3037 222c 2066 7265 713d 2231 4822 290a  07", freq="1H").
-00006730: 2020 2020 2020 2020 3e3e 3e20 6464 662e          >>> ddf.
-00006740: 6765 745f 7061 7274 6974 696f 6e28 3029  get_partition(0)
-00006750: 2020 2320 646f 6374 6573 743a 202b 4e4f    # doctest: +NO
-00006760: 524d 414c 495a 455f 5748 4954 4553 5041  RMALIZE_WHITESPA
-00006770: 4345 0a20 2020 2020 2020 2044 6173 6b20  CE.        Dask 
-00006780: 4461 7461 4672 616d 6520 5374 7275 6374  DataFrame Struct
-00006790: 7572 653a 0a20 2020 2020 2020 2020 2020  ure:.           
-000067a0: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-000067b0: 6d65 2020 2020 2069 6420 2020 2020 2020  me     id       
-000067c0: 2078 2020 2020 2020 2020 790a 2020 2020   x        y.    
-000067d0: 2020 2020 6e70 6172 7469 7469 6f6e 733d      npartitions=
-000067e0: 310a 2020 2020 2020 2020 3230 3231 2d30  1.        2021-0
-000067f0: 312d 3031 2020 2020 206f 626a 6563 7420  1-01     object 
-00006800: 2069 6e74 3634 2020 666c 6f61 7436 3420   int64  float64 
-00006810: 2066 6c6f 6174 3634 0a20 2020 2020 2020   float64.       
-00006820: 2032 3032 312d 3031 2d30 3220 2020 2020   2021-01-02     
-00006830: 2020 202e 2e2e 2020 2020 2e2e 2e20 2020     ...    ...   
-00006840: 2020 202e 2e2e 2020 2020 2020 2e2e 2e0a     ...      ....
-00006850: 2020 2020 2020 2020 4461 736b 204e 616d          Dask Nam
-00006860: 653a 2067 6574 2d70 6172 7469 7469 6f6e  e: get-partition
-00006870: 2c20 3220 6772 6170 6820 6c61 7965 7273  , 2 graph layers
-00006880: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
-00006890: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
-000068a0: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
-000068b0: 4672 616d 652e 7061 7274 6974 696f 6e73  Frame.partitions
-000068c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000068d0: 2020 2020 2069 6620 3020 3c3d 206e 203c       if 0 <= n <
-000068e0: 2073 656c 662e 6e70 6172 7469 7469 6f6e   self.npartition
-000068f0: 733a 0a20 2020 2020 2020 2020 2020 206e  s:.            n
-00006900: 616d 6520 3d20 6622 6765 742d 7061 7274  ame = f"get-part
-00006910: 6974 696f 6e2d 7b73 7472 286e 297d 2d7b  ition-{str(n)}-{
-00006920: 7365 6c66 2e5f 6e61 6d65 7d22 0a20 2020  self._name}".   
-00006930: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
-00006940: 6e73 203d 2073 656c 662e 6469 7669 7369  ns = self.divisi
-00006950: 6f6e 735b 6e20 3a20 6e20 2b20 325d 0a20  ons[n : n + 2]. 
-00006960: 2020 2020 2020 2020 2020 206c 6179 6572             layer
-00006970: 203d 207b 286e 616d 652c 2030 293a 2028   = {(name, 0): (
-00006980: 7365 6c66 2e5f 6e61 6d65 2c20 6e29 7d0a  self._name, n)}.
-00006990: 2020 2020 2020 2020 2020 2020 6772 6170              grap
-000069a0: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
-000069b0: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
-000069c0: 6f6e 7328 6e61 6d65 2c20 6c61 7965 722c  ons(name, layer,
-000069d0: 2064 6570 656e 6465 6e63 6965 733d 5b73   dependencies=[s
-000069e0: 656c 665d 290a 2020 2020 2020 2020 2020  elf]).          
-000069f0: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
-00006a00: 6f62 6a65 6374 2867 7261 7068 2c20 6e61  object(graph, na
-00006a10: 6d65 2c20 7365 6c66 2e5f 6d65 7461 2c20  me, self._meta, 
-00006a20: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
-00006a30: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00006a40: 2020 2020 206d 7367 203d 2066 226e 206d       msg = f"n m
-00006a50: 7573 7420 6265 2030 203c 3d20 6e20 3c20  ust be 0 <= n < 
-00006a60: 7b73 656c 662e 6e70 6172 7469 7469 6f6e  {self.npartition
-00006a70: 737d 220a 2020 2020 2020 2020 2020 2020  s}".            
-00006a80: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00006a90: 286d 7367 290a 0a20 2020 2040 6465 7269  (msg)..    @deri
-00006aa0: 7665 645f 6672 6f6d 280a 2020 2020 2020  ved_from(.      
-00006ab0: 2020 7064 2e44 6174 6146 7261 6d65 2c0a    pd.DataFrame,.
-00006ac0: 2020 2020 2020 2020 696e 636f 6e73 6973          inconsis
-00006ad0: 7465 6e63 6965 733d 226b 6565 703d 4661  tencies="keep=Fa
-00006ae0: 6c73 6520 7769 6c6c 2072 6169 7365 2061  lse will raise a
-00006af0: 2060 604e 6f74 496d 706c 656d 656e 7465   ``NotImplemente
-00006b00: 6445 7272 6f72 6060 222c 0a20 2020 2029  dError``",.    )
-00006b10: 0a20 2020 2064 6566 2064 726f 705f 6475  .    def drop_du
-00006b20: 706c 6963 6174 6573 280a 2020 2020 2020  plicates(.      
-00006b30: 2020 7365 6c66 2c20 7375 6273 6574 3d4e    self, subset=N
-00006b40: 6f6e 652c 2073 706c 6974 5f65 7665 7279  one, split_every
-00006b50: 3d4e 6f6e 652c 2073 706c 6974 5f6f 7574  =None, split_out
-00006b60: 3d31 2c20 6967 6e6f 7265 5f69 6e64 6578  =1, ignore_index
-00006b70: 3d46 616c 7365 2c20 2a2a 6b77 6172 6773  =False, **kwargs
-00006b80: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00006b90: 6966 2073 7562 7365 7420 6973 206e 6f74  if subset is not
-00006ba0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00006bb0: 2020 2023 204c 6574 2070 616e 6461 7320     # Let pandas 
-00006bc0: 6572 726f 7220 6f6e 2062 6164 2069 6e70  error on bad inp
-00006bd0: 7574 730a 2020 2020 2020 2020 2020 2020  uts.            
-00006be0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-00006bf0: 7074 792e 6472 6f70 5f64 7570 6c69 6361  pty.drop_duplica
-00006c00: 7465 7328 7375 6273 6574 3d73 7562 7365  tes(subset=subse
-00006c10: 742c 202a 2a6b 7761 7267 7329 0a20 2020  t, **kwargs).   
-00006c20: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
-00006c30: 2273 7562 7365 7422 5d20 3d20 7375 6273  "subset"] = subs
-00006c40: 6574 0a20 2020 2020 2020 2020 2020 2073  et.            s
-00006c50: 706c 6974 5f6f 7574 5f73 6574 7570 203d  plit_out_setup =
-00006c60: 2073 706c 6974 5f6f 7574 5f6f 6e5f 636f   split_out_on_co
-00006c70: 6c73 0a20 2020 2020 2020 2020 2020 2073  ls.            s
-00006c80: 706c 6974 5f6f 7574 5f73 6574 7570 5f6b  plit_out_setup_k
-00006c90: 7761 7267 7320 3d20 7b22 636f 6c73 223a  wargs = {"cols":
-00006ca0: 2073 7562 7365 747d 0a20 2020 2020 2020   subset}.       
-00006cb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00006cc0: 2020 2073 656c 662e 5f6d 6574 615f 6e6f     self._meta_no
-00006cd0: 6e65 6d70 7479 2e64 726f 705f 6475 706c  nempty.drop_dupl
-00006ce0: 6963 6174 6573 282a 2a6b 7761 7267 7329  icates(**kwargs)
-00006cf0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-00006d00: 6974 5f6f 7574 5f73 6574 7570 203d 2073  it_out_setup = s
-00006d10: 706c 6974 5f6f 7574 5f73 6574 7570 5f6b  plit_out_setup_k
-00006d20: 7761 7267 7320 3d20 4e6f 6e65 0a0a 2020  wargs = None..  
-00006d30: 2020 2020 2020 6966 206b 7761 7267 732e        if kwargs.
-00006d40: 6765 7428 226b 6565 7022 2c20 5472 7565  get("keep", True
-00006d50: 2920 6973 2046 616c 7365 3a0a 2020 2020  ) is False:.    
-00006d60: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-00006d70: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-00006d80: 7228 2264 726f 705f 6475 706c 6963 6174  r("drop_duplicat
-00006d90: 6573 2077 6974 6820 6b65 6570 3d46 616c  es with keep=Fal
-00006da0: 7365 2229 0a0a 2020 2020 2020 2020 6368  se")..        ch
-00006db0: 756e 6b20 3d20 4d2e 6472 6f70 5f64 7570  unk = M.drop_dup
-00006dc0: 6c69 6361 7465 730a 2020 2020 2020 2020  licates.        
-00006dd0: 7265 7475 726e 2061 6361 280a 2020 2020  return aca(.    
-00006de0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00006df0: 2020 2020 2020 2020 2020 6368 756e 6b3d            chunk=
-00006e00: 6368 756e 6b2c 0a20 2020 2020 2020 2020  chunk,.         
-00006e10: 2020 2061 6767 7265 6761 7465 3d63 6875     aggregate=chu
-00006e20: 6e6b 2c0a 2020 2020 2020 2020 2020 2020  nk,.            
-00006e30: 6d65 7461 3d73 656c 662e 5f6d 6574 612c  meta=self._meta,
-00006e40: 0a20 2020 2020 2020 2020 2020 2074 6f6b  .            tok
-00006e50: 656e 3d22 6472 6f70 2d64 7570 6c69 6361  en="drop-duplica
-00006e60: 7465 7322 2c0a 2020 2020 2020 2020 2020  tes",.          
-00006e70: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
-00006e80: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
-00006e90: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
-00006ea0: 3d73 706c 6974 5f6f 7574 2c0a 2020 2020  =split_out,.    
-00006eb0: 2020 2020 2020 2020 7370 6c69 745f 6f75          split_ou
-00006ec0: 745f 7365 7475 703d 7370 6c69 745f 6f75  t_setup=split_ou
-00006ed0: 745f 7365 7475 702c 0a20 2020 2020 2020  t_setup,.       
-00006ee0: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
-00006ef0: 6574 7570 5f6b 7761 7267 733d 7370 6c69  etup_kwargs=spli
-00006f00: 745f 6f75 745f 7365 7475 705f 6b77 6172  t_out_setup_kwar
-00006f10: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-00006f20: 6967 6e6f 7265 5f69 6e64 6578 3d69 676e  ignore_index=ign
-00006f30: 6f72 655f 696e 6465 782c 0a20 2020 2020  ore_index,.     
-00006f40: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-00006f50: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00006f60: 6465 6620 5f5f 6c65 6e5f 5f28 7365 6c66  def __len__(self
-00006f70: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00006f80: 6e20 7365 6c66 2e72 6564 7563 7469 6f6e  n self.reduction
-00006f90: 280a 2020 2020 2020 2020 2020 2020 6c65  (.            le
-00006fa0: 6e2c 206e 702e 7375 6d2c 2074 6f6b 656e  n, np.sum, token
-00006fb0: 3d22 6c65 6e22 2c20 6d65 7461 3d69 6e74  ="len", meta=int
-00006fc0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
-00006fd0: 6c73 650a 2020 2020 2020 2020 292e 636f  lse.        ).co
-00006fe0: 6d70 7574 6528 290a 0a20 2020 2064 6566  mpute()..    def
-00006ff0: 205f 5f62 6f6f 6c5f 5f28 7365 6c66 293a   __bool__(self):
-00007000: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
-00007010: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00007020: 2020 2020 2020 2066 2254 6865 2074 7275         f"The tru
-00007030: 7468 2076 616c 7565 206f 6620 6120 7b73  th value of a {s
-00007040: 656c 662e 5f5f 636c 6173 735f 5f2e 5f5f  elf.__class__.__
-00007050: 6e61 6d65 5f5f 7d20 6973 2061 6d62 6967  name__} is ambig
-00007060: 756f 7573 2e20 220a 2020 2020 2020 2020  uous. ".        
-00007070: 2020 2020 2255 7365 2061 2e61 6e79 2829      "Use a.any()
-00007080: 206f 7220 612e 616c 6c28 292e 220a 2020   or a.all().".  
-00007090: 2020 2020 2020 290a 0a20 2020 205f 5f6e        )..    __n
-000070a0: 6f6e 7a65 726f 5f5f 203d 205f 5f62 6f6f  onzero__ = __boo
-000070b0: 6c5f 5f20 2023 2070 7974 686f 6e20 320a  l__  # python 2.
-000070c0: 0a20 2020 2064 6566 205f 7363 616c 6172  .    def _scalar
-000070d0: 6675 6e63 2873 656c 662c 2063 6173 745f  func(self, cast_
-000070e0: 7479 7065 293a 0a20 2020 2020 2020 2064  type):.        d
-000070f0: 6566 2077 7261 7070 6572 2829 3a0a 2020  ef wrapper():.  
-00007100: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00007110: 5479 7065 4572 726f 7228 6622 6361 6e6e  TypeError(f"cann
-00007120: 6f74 2063 6f6e 7665 7274 2074 6865 2073  ot convert the s
-00007130: 6572 6965 7320 746f 207b 6361 7374 5f74  eries to {cast_t
-00007140: 7970 657d 2229 0a0a 2020 2020 2020 2020  ype}")..        
-00007150: 7265 7475 726e 2077 7261 7070 6572 0a0a  return wrapper..
-00007160: 2020 2020 6465 6620 5f5f 666c 6f61 745f      def __float_
-00007170: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00007180: 2072 6574 7572 6e20 7365 6c66 2e5f 7363   return self._sc
-00007190: 616c 6172 6675 6e63 2866 6c6f 6174 290a  alarfunc(float).
-000071a0: 0a20 2020 2064 6566 205f 5f69 6e74 5f5f  .    def __int__
-000071b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000071c0: 7265 7475 726e 2073 656c 662e 5f73 6361  return self._sca
-000071d0: 6c61 7266 756e 6328 696e 7429 0a0a 2020  larfunc(int)..  
-000071e0: 2020 5f5f 6c6f 6e67 5f5f 203d 205f 5f69    __long__ = __i
-000071f0: 6e74 5f5f 2020 2320 7079 7468 6f6e 2032  nt__  # python 2
-00007200: 0a0a 2020 2020 6465 6620 5f5f 636f 6d70  ..    def __comp
-00007210: 6c65 785f 5f28 7365 6c66 293a 0a20 2020  lex__(self):.   
-00007220: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00007230: 2e5f 7363 616c 6172 6675 6e63 2863 6f6d  ._scalarfunc(com
-00007240: 706c 6578 290a 0a20 2020 2040 696e 7365  plex)..    @inse
-00007250: 7274 5f6d 6574 615f 7061 7261 6d5f 6465  rt_meta_param_de
-00007260: 7363 7269 7074 696f 6e28 7061 643d 3132  scription(pad=12
-00007270: 290a 2020 2020 6465 6620 6d61 705f 7061  ).    def map_pa
-00007280: 7274 6974 696f 6e73 2873 656c 662c 2066  rtitions(self, f
-00007290: 756e 632c 202a 6172 6773 2c20 2a2a 6b77  unc, *args, **kw
-000072a0: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-000072b0: 2222 4170 706c 7920 5079 7468 6f6e 2066  ""Apply Python f
-000072c0: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
-000072d0: 4461 7461 4672 616d 6520 7061 7274 6974  DataFrame partit
-000072e0: 696f 6e2e 0a0a 2020 2020 2020 2020 4e6f  ion...        No
-000072f0: 7465 2074 6861 7420 7468 6520 696e 6465  te that the inde
-00007300: 7820 616e 6420 6469 7669 7369 6f6e 7320  x and divisions 
-00007310: 6172 6520 6173 7375 6d65 6420 746f 2072  are assumed to r
-00007320: 656d 6169 6e20 756e 6368 616e 6765 642e  emain unchanged.
-00007330: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00007340: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00007350: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00007360: 6675 6e63 203a 2066 756e 6374 696f 6e0a  func : function.
-00007370: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00007380: 6675 6e63 7469 6f6e 2061 7070 6c69 6564  function applied
-00007390: 2074 6f20 6561 6368 2070 6172 7469 7469   to each partiti
-000073a0: 6f6e 2e20 4966 2074 6869 7320 6675 6e63  on. If this func
-000073b0: 7469 6f6e 2061 6363 6570 7473 0a20 2020  tion accepts.   
-000073c0: 2020 2020 2020 2020 2074 6865 2073 7065           the spe
-000073d0: 6369 616c 2060 6070 6172 7469 7469 6f6e  cial ``partition
-000073e0: 5f69 6e66 6f60 6020 6b65 7977 6f72 6420  _info`` keyword 
-000073f0: 6172 6775 6d65 6e74 2c20 6974 2077 696c  argument, it wil
-00007400: 6c20 7265 6365 6976 650a 2020 2020 2020  l receive.      
-00007410: 2020 2020 2020 696e 666f 726d 6174 696f        informatio
-00007420: 6e20 6f6e 2074 6865 2070 6172 7469 7469  n on the partiti
-00007430: 6f6e 2773 2072 656c 6174 6976 6520 6c6f  on's relative lo
-00007440: 6361 7469 6f6e 2077 6974 6869 6e20 7468  cation within th
-00007450: 650a 2020 2020 2020 2020 2020 2020 6461  e.            da
-00007460: 7461 6672 616d 652e 0a20 2020 2020 2020  taframe..       
-00007470: 2061 7267 732c 206b 7761 7267 7320 3a0a   args, kwargs :.
-00007480: 2020 2020 2020 2020 2020 2020 506f 7369              Posi
-00007490: 7469 6f6e 616c 2061 6e64 206b 6579 776f  tional and keywo
-000074a0: 7264 2061 7267 756d 656e 7473 2074 6f20  rd arguments to 
-000074b0: 7061 7373 2074 6f20 7468 6520 6675 6e63  pass to the func
-000074c0: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
-000074d0: 2020 506f 7369 7469 6f6e 616c 2061 7267    Positional arg
-000074e0: 756d 656e 7473 2061 7265 2063 6f6d 7075  uments are compu
-000074f0: 7465 6420 6f6e 2061 2070 6572 2d70 6172  ted on a per-par
-00007500: 7469 7469 6f6e 2062 6173 6973 2c20 7768  tition basis, wh
-00007510: 696c 650a 2020 2020 2020 2020 2020 2020  ile.            
-00007520: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00007530: 7320 6172 6520 7368 6172 6564 2061 6372  s are shared acr
-00007540: 6f73 7320 616c 6c20 7061 7274 6974 696f  oss all partitio
-00007550: 6e73 2e20 5468 6520 7061 7274 6974 696f  ns. The partitio
-00007560: 6e0a 2020 2020 2020 2020 2020 2020 6974  n.            it
-00007570: 7365 6c66 2077 696c 6c20 6265 2074 6865  self will be the
-00007580: 2066 6972 7374 2070 6f73 6974 696f 6e61   first positiona
-00007590: 6c20 6172 6775 6d65 6e74 2c20 7769 7468  l argument, with
-000075a0: 2061 6c6c 206f 7468 6572 0a20 2020 2020   all other.     
-000075b0: 2020 2020 2020 2061 7267 756d 656e 7473         arguments
-000075c0: 2070 6173 7365 6420 2a61 6674 6572 2a2e   passed *after*.
-000075d0: 2041 7267 756d 656e 7473 2063 616e 2062   Arguments can b
-000075e0: 6520 6060 5363 616c 6172 6060 2c20 6060  e ``Scalar``, ``
-000075f0: 4465 6c61 7965 6460 602c 0a20 2020 2020  Delayed``,.     
-00007600: 2020 2020 2020 206f 7220 7265 6775 6c61         or regula
-00007610: 7220 5079 7468 6f6e 206f 626a 6563 7473  r Python objects
-00007620: 2e20 4461 7461 4672 616d 652d 6c69 6b65  . DataFrame-like
-00007630: 2061 7267 7320 2862 6f74 6820 6461 736b   args (both dask
-00007640: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-00007650: 2070 616e 6461 7329 2077 696c 6c20 6265   pandas) will be
-00007660: 2072 6570 6172 7469 7469 6f6e 6564 2074   repartitioned t
-00007670: 6f20 616c 6967 6e20 2869 6620 6e65 6365  o align (if nece
-00007680: 7373 6172 7929 2062 6566 6f72 650a 2020  ssary) before.  
-00007690: 2020 2020 2020 2020 2020 6170 706c 7969            applyi
-000076a0: 6e67 2074 6865 2066 756e 6374 696f 6e3b  ng the function;
-000076b0: 2073 6565 2060 6061 6c69 676e 5f64 6174   see ``align_dat
-000076c0: 6166 7261 6d65 7360 6020 746f 2063 6f6e  aframes`` to con
-000076d0: 7472 6f6c 2074 6869 730a 2020 2020 2020  trol this.      
-000076e0: 2020 2020 2020 6265 6861 7669 6f72 2e0a        behavior..
-000076f0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
-00007700: 6d65 7461 6461 7461 203a 2062 6f6f 6c2c  metadata : bool,
-00007710: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
-00007720: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
-00007730: 7220 746f 2065 6e66 6f72 6365 2061 7420  r to enforce at 
-00007740: 7275 6e74 696d 6520 7468 6174 2074 6865  runtime that the
-00007750: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
-00007760: 6520 4461 7461 4672 616d 650a 2020 2020  e DataFrame.    
-00007770: 2020 2020 2020 2020 7072 6f64 7563 6564          produced
-00007780: 2062 7920 6060 6675 6e63 6060 2061 6374   by ``func`` act
-00007790: 7561 6c6c 7920 6d61 7463 6865 7320 7468  ually matches th
-000077a0: 6520 7374 7275 6374 7572 6520 6f66 2060  e structure of `
-000077b0: 606d 6574 6160 602e 0a20 2020 2020 2020  `meta``..       
-000077c0: 2020 2020 2054 6869 7320 7769 6c6c 2072       This will r
-000077d0: 656e 616d 6520 616e 6420 7265 6f72 6465  ename and reorde
-000077e0: 7220 636f 6c75 6d6e 7320 666f 7220 6561  r columns for ea
-000077f0: 6368 2070 6172 7469 7469 6f6e 2c0a 2020  ch partition,.  
-00007800: 2020 2020 2020 2020 2020 616e 6420 7769            and wi
-00007810: 6c6c 2072 6169 7365 2061 6e20 6572 726f  ll raise an erro
-00007820: 7220 6966 2074 6869 7320 646f 6573 6e27  r if this doesn'
-00007830: 7420 776f 726b 2c0a 2020 2020 2020 2020  t work,.        
-00007840: 2020 2020 6275 7420 6974 2077 6f6e 2774      but it won't
-00007850: 2072 6169 7365 2069 6620 6474 7970 6573   raise if dtypes
-00007860: 2064 6f6e 2774 206d 6174 6368 2e0a 2020   don't match..  
-00007870: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
-00007880: 6469 7669 7369 6f6e 7320 3a20 626f 6f6c  divisions : bool
-00007890: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
-000078a0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-000078b0: 6572 2074 6f20 6170 706c 7920 7468 6520  er to apply the 
-000078c0: 6675 6e63 7469 6f6e 206f 6e74 6f20 7468  function onto th
-000078d0: 6520 6469 7669 7369 6f6e 7320 616e 6420  e divisions and 
-000078e0: 6170 706c 7920 7468 6f73 650a 2020 2020  apply those.    
-000078f0: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
-00007900: 6d65 6420 6469 7669 7369 6f6e 7320 746f  med divisions to
-00007910: 2074 6865 206f 7574 7075 742e 0a20 2020   the output..   
-00007920: 2020 2020 2061 6c69 676e 5f64 6174 6166       align_dataf
-00007930: 7261 6d65 7320 3a20 626f 6f6c 2c20 6465  rames : bool, de
-00007940: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
-00007950: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-00007960: 6f20 7265 7061 7274 6974 696f 6e20 4461  o repartition Da
-00007970: 7461 4672 616d 652d 206f 7220 5365 7269  taFrame- or Seri
-00007980: 6573 2d6c 696b 6520 6172 6773 0a20 2020  es-like args.   
-00007990: 2020 2020 2020 2020 2028 626f 7468 2064           (both d
-000079a0: 6173 6b20 616e 6420 7061 6e64 6173 2920  ask and pandas) 
-000079b0: 736f 2074 6865 6972 2064 6976 6973 696f  so their divisio
-000079c0: 6e73 2061 6c69 676e 2062 6566 6f72 6520  ns align before 
-000079d0: 6170 706c 7969 6e67 0a20 2020 2020 2020  applying.       
-000079e0: 2020 2020 2074 6865 2066 756e 6374 696f       the functio
-000079f0: 6e2e 2054 6869 7320 7265 7175 6972 6573  n. This requires
-00007a00: 2061 6c6c 2069 6e70 7574 7320 746f 2068   all inputs to h
-00007a10: 6176 6520 6b6e 6f77 6e20 6469 7669 7369  ave known divisi
-00007a20: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
-00007a30: 2053 696e 676c 652d 7061 7274 6974 696f   Single-partitio
-00007a40: 6e20 696e 7075 7473 2077 696c 6c20 6265  n inputs will be
-00007a50: 2073 706c 6974 2069 6e74 6f20 6d75 6c74   split into mult
-00007a60: 6970 6c65 2070 6172 7469 7469 6f6e 732e  iple partitions.
-00007a70: 0a0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00007a80: 2046 616c 7365 2c20 616c 6c20 696e 7075   False, all inpu
-00007a90: 7473 206d 7573 7420 6861 7665 2065 6974  ts must have eit
-00007aa0: 6865 7220 7468 6520 7361 6d65 206e 756d  her the same num
-00007ab0: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
-00007ac0: 730a 2020 2020 2020 2020 2020 2020 6f72  s.            or
-00007ad0: 2061 2073 696e 676c 6520 7061 7274 6974   a single partit
-00007ae0: 696f 6e2e 2053 696e 676c 652d 7061 7274  ion. Single-part
-00007af0: 6974 696f 6e20 696e 7075 7473 2077 696c  ition inputs wil
-00007b00: 6c20 6265 2062 726f 6164 6361 7374 2074  l be broadcast t
-00007b10: 6f0a 2020 2020 2020 2020 2020 2020 6576  o.            ev
-00007b20: 6572 7920 7061 7274 6974 696f 6e20 6f66  ery partition of
-00007b30: 206d 756c 7469 2d70 6172 7469 7469 6f6e   multi-partition
-00007b40: 2069 6e70 7574 732e 0a20 2020 2020 2020   inputs..       
-00007b50: 2024 4d45 5441 0a0a 2020 2020 2020 2020   $META..        
-00007b60: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-00007b70: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00007b80: 2020 4769 7665 6e20 6120 4461 7461 4672    Given a DataFr
-00007b90: 616d 652c 2053 6572 6965 732c 206f 7220  ame, Series, or 
-00007ba0: 496e 6465 782c 2073 7563 6820 6173 3a0a  Index, such as:.
-00007bb0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-00007bc0: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
-00007bd0: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
-00007be0: 6f72 7420 6461 736b 2e64 6174 6166 7261  ort dask.datafra
-00007bf0: 6d65 2061 7320 6464 0a20 2020 2020 2020  me as dd.       
-00007c00: 203e 3e3e 2064 6620 3d20 7064 2e44 6174   >>> df = pd.Dat
-00007c10: 6146 7261 6d65 287b 2778 273a 205b 312c  aFrame({'x': [1,
-00007c20: 2032 2c20 332c 2034 2c20 355d 2c0a 2020   2, 3, 4, 5],.  
-00007c30: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-00007c40: 2020 2020 2020 2020 2020 2020 2027 7927               'y'
-00007c50: 3a20 5b31 2e2c 2032 2e2c 2033 2e2c 2034  : [1., 2., 3., 4
-00007c60: 2e2c 2035 2e5d 7d29 0a20 2020 2020 2020  ., 5.]}).       
-00007c70: 203e 3e3e 2064 6466 203d 2064 642e 6672   >>> ddf = dd.fr
-00007c80: 6f6d 5f70 616e 6461 7328 6466 2c20 6e70  om_pandas(df, np
-00007c90: 6172 7469 7469 6f6e 733d 3229 0a0a 2020  artitions=2)..  
-00007ca0: 2020 2020 2020 4f6e 6520 6361 6e20 7573        One can us
-00007cb0: 6520 6060 6d61 705f 7061 7274 6974 696f  e ``map_partitio
-00007cc0: 6e73 6060 2074 6f20 6170 706c 7920 6120  ns`` to apply a 
-00007cd0: 6675 6e63 7469 6f6e 206f 6e20 6561 6368  function on each
-00007ce0: 2070 6172 7469 7469 6f6e 2e0a 2020 2020   partition..    
-00007cf0: 2020 2020 4578 7472 6120 6172 6775 6d65      Extra argume
-00007d00: 6e74 7320 616e 6420 6b65 7977 6f72 6473  nts and keywords
-00007d10: 2063 616e 206f 7074 696f 6e61 6c6c 7920   can optionally 
-00007d20: 6265 2070 726f 7669 6465 642c 2061 6e64  be provided, and
-00007d30: 2077 696c 6c20 6265 0a20 2020 2020 2020   will be.       
-00007d40: 2070 6173 7365 6420 746f 2074 6865 2066   passed to the f
-00007d50: 756e 6374 696f 6e20 6166 7465 7220 7468  unction after th
-00007d60: 6520 7061 7274 6974 696f 6e2e 0a0a 2020  e partition...  
-00007d70: 2020 2020 2020 4865 7265 2077 6520 6170        Here we ap
-00007d80: 706c 7920 6120 6675 6e63 7469 6f6e 2077  ply a function w
-00007d90: 6974 6820 6172 6775 6d65 6e74 7320 616e  ith arguments an
-00007da0: 6420 6b65 7977 6f72 6473 2074 6f20 6120  d keywords to a 
-00007db0: 4461 7461 4672 616d 652c 0a20 2020 2020  DataFrame,.     
-00007dc0: 2020 2072 6573 756c 7469 6e67 2069 6e20     resulting in 
-00007dd0: 6120 5365 7269 6573 3a0a 0a20 2020 2020  a Series:..     
-00007de0: 2020 203e 3e3e 2064 6566 206d 7961 6464     >>> def myadd
-00007df0: 2864 662c 2061 2c20 623d 3129 3a0a 2020  (df, a, b=1):.  
-00007e00: 2020 2020 2020 2e2e 2e20 2020 2020 7265        ...     re
-00007e10: 7475 726e 2064 662e 7820 2b20 6466 2e79  turn df.x + df.y
-00007e20: 202b 2061 202b 2062 0a20 2020 2020 2020   + a + b.       
-00007e30: 203e 3e3e 2072 6573 203d 2064 6466 2e6d   >>> res = ddf.m
-00007e40: 6170 5f70 6172 7469 7469 6f6e 7328 6d79  ap_partitions(my
-00007e50: 6164 642c 2031 2c20 623d 3229 0a20 2020  add, 1, b=2).   
-00007e60: 2020 2020 203e 3e3e 2072 6573 2e64 7479       >>> res.dty
-00007e70: 7065 0a20 2020 2020 2020 2064 7479 7065  pe.        dtype
-00007e80: 2827 666c 6f61 7436 3427 290a 0a20 2020  ('float64')..   
-00007e90: 2020 2020 2048 6572 6520 7765 2061 7070       Here we app
-00007ea0: 6c79 2061 2066 756e 6374 696f 6e20 746f  ly a function to
-00007eb0: 2061 2053 6572 6965 7320 7265 7375 6c74   a Series result
-00007ec0: 696e 6720 696e 2061 2053 6572 6965 733a  ing in a Series:
-00007ed0: 0a0a 2020 2020 2020 2020 3e3e 3e20 7265  ..        >>> re
-00007ee0: 7320 3d20 6464 662e 782e 6d61 705f 7061  s = ddf.x.map_pa
-00007ef0: 7274 6974 696f 6e73 286c 616d 6264 6120  rtitions(lambda 
-00007f00: 783a 206c 656e 2878 2929 2023 2064 6466  x: len(x)) # ddf
-00007f10: 2e78 2069 7320 6120 4461 736b 2053 6572  .x is a Dask Ser
-00007f20: 6965 7320 5374 7275 6374 7572 650a 2020  ies Structure.  
-00007f30: 2020 2020 2020 3e3e 3e20 7265 732e 6474        >>> res.dt
-00007f40: 7970 650a 2020 2020 2020 2020 6474 7970  ype.        dtyp
-00007f50: 6528 2769 6e74 3634 2729 0a0a 2020 2020  e('int64')..    
-00007f60: 2020 2020 4279 2064 6566 6175 6c74 2c20      By default, 
-00007f70: 6461 736b 2074 7269 6573 2074 6f20 696e  dask tries to in
-00007f80: 6665 7220 7468 6520 6f75 7470 7574 206d  fer the output m
-00007f90: 6574 6164 6174 6120 6279 2072 756e 6e69  etadata by runni
-00007fa0: 6e67 2079 6f75 720a 2020 2020 2020 2020  ng your.        
-00007fb0: 7072 6f76 6964 6564 2066 756e 6374 696f  provided functio
-00007fc0: 6e20 6f6e 2073 6f6d 6520 6661 6b65 2064  n on some fake d
-00007fd0: 6174 612e 2054 6869 7320 776f 726b 7320  ata. This works 
-00007fe0: 7765 6c6c 2069 6e20 6d61 6e79 2063 6173  well in many cas
-00007ff0: 6573 2c20 6275 740a 2020 2020 2020 2020  es, but.        
-00008000: 6361 6e20 736f 6d65 7469 6d65 7320 6265  can sometimes be
-00008010: 2065 7870 656e 7369 7665 2c20 6f72 2065   expensive, or e
-00008020: 7665 6e20 6661 696c 2e20 546f 2061 766f  ven fail. To avo
-00008030: 6964 2074 6869 732c 2079 6f75 2063 616e  id this, you can
-00008040: 0a20 2020 2020 2020 206d 616e 7561 6c6c  .        manuall
-00008050: 7920 7370 6563 6966 7920 7468 6520 6f75  y specify the ou
-00008060: 7470 7574 206d 6574 6164 6174 6120 7769  tput metadata wi
-00008070: 7468 2074 6865 2060 606d 6574 6160 6020  th the ``meta`` 
-00008080: 6b65 7977 6f72 642e 2054 6869 730a 2020  keyword. This.  
-00008090: 2020 2020 2020 6361 6e20 6265 2073 7065        can be spe
-000080a0: 6369 6669 6564 2069 6e20 6d61 6e79 2066  cified in many f
-000080b0: 6f72 6d73 2c20 666f 7220 6d6f 7265 2069  orms, for more i
-000080c0: 6e66 6f72 6d61 7469 6f6e 2073 6565 0a20  nformation see. 
-000080d0: 2020 2020 2020 2060 6064 6173 6b2e 6461         ``dask.da
-000080e0: 7461 6672 616d 652e 7574 696c 732e 6d61  taframe.utils.ma
-000080f0: 6b65 5f6d 6574 6160 602e 0a0a 2020 2020  ke_meta``...    
-00008100: 2020 2020 4865 7265 2077 6520 7370 6563      Here we spec
-00008110: 6966 7920 7468 6520 6f75 7470 7574 2069  ify the output i
-00008120: 7320 6120 5365 7269 6573 2077 6974 6820  s a Series with 
-00008130: 6e6f 206e 616d 652c 2061 6e64 2064 7479  no name, and dty
-00008140: 7065 0a20 2020 2020 2020 2060 6066 6c6f  pe.        ``flo
-00008150: 6174 3634 6060 3a0a 0a20 2020 2020 2020  at64``:..       
-00008160: 203e 3e3e 2072 6573 203d 2064 6466 2e6d   >>> res = ddf.m
-00008170: 6170 5f70 6172 7469 7469 6f6e 7328 6d79  ap_partitions(my
-00008180: 6164 642c 2031 2c20 623d 322c 206d 6574  add, 1, b=2, met
-00008190: 613d 284e 6f6e 652c 2027 6638 2729 290a  a=(None, 'f8')).
-000081a0: 0a20 2020 2020 2020 2048 6572 6520 7765  .        Here we
-000081b0: 206d 6170 2061 2066 756e 6374 696f 6e20   map a function 
-000081c0: 7468 6174 2074 616b 6573 2069 6e20 6120  that takes in a 
-000081d0: 4461 7461 4672 616d 652c 2061 6e64 2072  DataFrame, and r
-000081e0: 6574 7572 6e73 2061 0a20 2020 2020 2020  eturns a.       
-000081f0: 2044 6174 6146 7261 6d65 2077 6974 6820   DataFrame with 
-00008200: 6120 6e65 7720 636f 6c75 6d6e 3a0a 0a20  a new column:.. 
-00008210: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
-00008220: 2064 6466 2e6d 6170 5f70 6172 7469 7469   ddf.map_partiti
-00008230: 6f6e 7328 6c61 6d62 6461 2064 663a 2064  ons(lambda df: d
-00008240: 662e 6173 7369 676e 287a 3d64 662e 7820  f.assign(z=df.x 
-00008250: 2a20 6466 2e79 2929 0a20 2020 2020 2020  * df.y)).       
-00008260: 203e 3e3e 2072 6573 2e64 7479 7065 730a   >>> res.dtypes.
-00008270: 2020 2020 2020 2020 7820 2020 2020 2069          x      i
-00008280: 6e74 3634 0a20 2020 2020 2020 2079 2020  nt64.        y  
-00008290: 2020 666c 6f61 7436 340a 2020 2020 2020    float64.      
-000082a0: 2020 7a20 2020 2066 6c6f 6174 3634 0a20    z    float64. 
-000082b0: 2020 2020 2020 2064 7479 7065 3a20 6f62         dtype: ob
-000082c0: 6a65 6374 0a0a 2020 2020 2020 2020 4173  ject..        As
-000082d0: 2062 6566 6f72 652c 2074 6865 206f 7574   before, the out
-000082e0: 7075 7420 6d65 7461 6461 7461 2063 616e  put metadata can
-000082f0: 2061 6c73 6f20 6265 2073 7065 6369 6669   also be specifi
-00008300: 6564 206d 616e 7561 6c6c 792e 2054 6869  ed manually. Thi
-00008310: 730a 2020 2020 2020 2020 7469 6d65 2077  s.        time w
-00008320: 6520 7061 7373 2069 6e20 6120 6060 6469  e pass in a ``di
-00008330: 6374 6060 2c20 6173 2074 6865 206f 7574  ct``, as the out
-00008340: 7075 7420 6973 2061 2044 6174 6146 7261  put is a DataFra
-00008350: 6d65 3a0a 0a20 2020 2020 2020 203e 3e3e  me:..        >>>
-00008360: 2072 6573 203d 2064 6466 2e6d 6170 5f70   res = ddf.map_p
-00008370: 6172 7469 7469 6f6e 7328 6c61 6d62 6461  artitions(lambda
-00008380: 2064 663a 2064 662e 6173 7369 676e 287a   df: df.assign(z
-00008390: 3d64 662e 7820 2a20 6466 2e79 292c 0a20  =df.x * df.y),. 
-000083a0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-000083b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083c0: 2020 2020 6d65 7461 3d7b 2778 273a 2027      meta={'x': '
-000083d0: 6938 272c 2027 7927 3a20 2766 3827 2c20  i8', 'y': 'f8', 
-000083e0: 277a 273a 2027 6638 277d 290a 0a20 2020  'z': 'f8'})..   
-000083f0: 2020 2020 2049 6e20 7468 6520 6361 7365       In the case
-00008400: 2077 6865 7265 2074 6865 206d 6574 6164   where the metad
-00008410: 6174 6120 646f 6573 6e27 7420 6368 616e  ata doesn't chan
-00008420: 6765 2c20 796f 7520 6361 6e20 616c 736f  ge, you can also
-00008430: 2070 6173 7320 696e 0a20 2020 2020 2020   pass in.       
-00008440: 2074 6865 206f 626a 6563 7420 6974 7365   the object itse
-00008450: 6c66 2064 6972 6563 746c 793a 0a0a 2020  lf directly:..  
-00008460: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
-00008470: 6464 662e 6d61 705f 7061 7274 6974 696f  ddf.map_partitio
-00008480: 6e73 286c 616d 6264 6120 6466 3a20 6466  ns(lambda df: df
-00008490: 2e68 6561 6428 292c 206d 6574 613d 6464  .head(), meta=dd
-000084a0: 6629 0a0a 2020 2020 2020 2020 416c 736f  f)..        Also
-000084b0: 206e 6f74 6520 7468 6174 2074 6865 2069   note that the i
-000084c0: 6e64 6578 2061 6e64 2064 6976 6973 696f  ndex and divisio
-000084d0: 6e73 2061 7265 2061 7373 756d 6564 2074  ns are assumed t
-000084e0: 6f20 7265 6d61 696e 2075 6e63 6861 6e67  o remain unchang
-000084f0: 6564 2e0a 2020 2020 2020 2020 4966 2074  ed..        If t
-00008500: 6865 2066 756e 6374 696f 6e20 796f 7527  he function you'
-00008510: 7265 206d 6170 7069 6e67 2063 6861 6e67  re mapping chang
-00008520: 6573 2074 6865 2069 6e64 6578 2f64 6976  es the index/div
-00008530: 6973 696f 6e73 2c20 796f 7527 6c6c 206e  isions, you'll n
-00008540: 6565 640a 2020 2020 2020 2020 746f 2063  eed.        to c
-00008550: 6c65 6172 2074 6865 6d20 6166 7465 7277  lear them afterw
-00008560: 6172 6473 3a0a 0a20 2020 2020 2020 203e  ards:..        >
-00008570: 3e3e 2064 6466 2e6d 6170 5f70 6172 7469  >> ddf.map_parti
-00008580: 7469 6f6e 7328 6675 6e63 292e 636c 6561  tions(func).clea
-00008590: 725f 6469 7669 7369 6f6e 7328 2920 2023  r_divisions()  #
-000085a0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-000085b0: 0a20 2020 2020 2020 2059 6f75 7220 6d61  .        Your ma
-000085c0: 7020 6675 6e63 7469 6f6e 2067 6574 7320  p function gets 
-000085d0: 696e 666f 726d 6174 696f 6e20 6162 6f75  information abou
-000085e0: 7420 7768 6572 6520 6974 2069 7320 696e  t where it is in
-000085f0: 2074 6865 2064 6174 6166 7261 6d65 2062   the dataframe b
-00008600: 790a 2020 2020 2020 2020 6163 6365 7074  y.        accept
-00008610: 696e 6720 6120 7370 6563 6961 6c20 6060  ing a special ``
-00008620: 7061 7274 6974 696f 6e5f 696e 666f 6060  partition_info``
-00008630: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
-00008640: 742e 0a0a 2020 2020 2020 2020 3e3e 3e20  t...        >>> 
-00008650: 6465 6620 6675 6e63 2870 6172 7469 7469  def func(partiti
-00008660: 6f6e 2c20 7061 7274 6974 696f 6e5f 696e  on, partition_in
-00008670: 666f 3d4e 6f6e 6529 3a0a 2020 2020 2020  fo=None):.      
-00008680: 2020 2e2e 2e20 2020 2020 7061 7373 0a0a    ...     pass..
-00008690: 2020 2020 2020 2020 5468 6973 2077 696c          This wil
-000086a0: 6c20 7265 6365 6976 6520 7468 6520 666f  l receive the fo
-000086b0: 6c6c 6f77 696e 6720 696e 666f 726d 6174  llowing informat
-000086c0: 696f 6e3a 0a0a 2020 2020 2020 2020 3e3e  ion:..        >>
-000086d0: 3e20 7061 7274 6974 696f 6e5f 696e 666f  > partition_info
-000086e0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-000086f0: 4950 0a20 2020 2020 2020 207b 276e 756d  IP.        {'num
-00008700: 6265 7227 3a20 312c 2027 6469 7669 7369  ber': 1, 'divisi
-00008710: 6f6e 273a 2033 7d0a 0a20 2020 2020 2020  on': 3}..       
-00008720: 2046 6f72 2065 6163 6820 6172 6775 6d65   For each argume
-00008730: 6e74 2061 6e64 206b 6579 776f 7264 2061  nt and keyword a
-00008740: 7267 756d 656e 7473 2074 6861 7420 6172  rguments that ar
-00008750: 6520 6461 736b 2064 6174 6166 7261 6d65  e dask dataframe
-00008760: 7320 796f 7520 7769 6c6c 0a20 2020 2020  s you will.     
-00008770: 2020 2072 6563 6569 7665 2074 6865 206e     receive the n
-00008780: 756d 6265 7220 286e 2920 7768 6963 6820  umber (n) which 
-00008790: 7265 7072 6573 656e 7473 2074 6865 206e  represents the n
-000087a0: 7468 2070 6172 7469 7469 6f6e 206f 6620  th partition of 
-000087b0: 7468 6520 6461 7461 6672 616d 650a 2020  the dataframe.  
-000087c0: 2020 2020 2020 616e 6420 7468 6520 6469        and the di
-000087d0: 7669 7369 6f6e 2028 7468 6520 6669 7273  vision (the firs
-000087e0: 7420 696e 6465 7820 7661 6c75 6520 696e  t index value in
-000087f0: 2074 6865 2070 6172 7469 7469 6f6e 292e   the partition).
-00008800: 2049 6620 6469 7669 7369 6f6e 730a 2020   If divisions.  
-00008810: 2020 2020 2020 6172 6520 6e6f 7420 6b6e        are not kn
-00008820: 6f77 6e20 2866 6f72 2069 6e73 7461 6e63  own (for instanc
-00008830: 6520 6966 2074 6865 2069 6e64 6578 2069  e if the index i
-00008840: 7320 6e6f 7420 736f 7274 6564 2920 7468  s not sorted) th
-00008850: 656e 2079 6f75 2077 696c 6c20 6765 740a  en you will get.
-00008860: 2020 2020 2020 2020 4e6f 6e65 2061 7320          None as 
-00008870: 7468 6520 6469 7669 7369 6f6e 2e0a 2020  the division..  
-00008880: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00008890: 2020 7265 7475 726e 206d 6170 5f70 6172    return map_par
-000088a0: 7469 7469 6f6e 7328 6675 6e63 2c20 7365  titions(func, se
-000088b0: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
-000088c0: 7267 7329 0a0a 2020 2020 4069 6e73 6572  rgs)..    @inser
-000088d0: 745f 6d65 7461 5f70 6172 616d 5f64 6573  t_meta_param_des
-000088e0: 6372 6970 7469 6f6e 2870 6164 3d31 3229  cription(pad=12)
-000088f0: 0a20 2020 2064 6566 206d 6170 5f6f 7665  .    def map_ove
-00008900: 726c 6170 2873 656c 662c 2066 756e 632c  rlap(self, func,
-00008910: 2062 6566 6f72 652c 2061 6674 6572 2c20   before, after, 
-00008920: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00008930: 3a0a 2020 2020 2020 2020 2222 2241 7070  :.        """App
-00008940: 6c79 2061 2066 756e 6374 696f 6e20 746f  ly a function to
-00008950: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
-00008960: 2073 6861 7269 6e67 2072 6f77 7320 7769   sharing rows wi
-00008970: 7468 2061 646a 6163 656e 7420 7061 7274  th adjacent part
-00008980: 6974 696f 6e73 2e0a 0a20 2020 2020 2020  itions...       
-00008990: 2054 6869 7320 6361 6e20 6265 2075 7365   This can be use
-000089a0: 6675 6c20 666f 7220 696d 706c 656d 656e  ful for implemen
-000089b0: 7469 6e67 2077 696e 646f 7769 6e67 2066  ting windowing f
-000089c0: 756e 6374 696f 6e73 2073 7563 6820 6173  unctions such as
-000089d0: 0a20 2020 2020 2020 2060 6064 662e 726f  .        ``df.ro
-000089e0: 6c6c 696e 6728 2e2e 2e29 2e6d 6561 6e28  lling(...).mean(
-000089f0: 2960 6020 6f72 2060 6064 662e 6469 6666  )`` or ``df.diff
-00008a00: 2829 6060 2e0a 0a20 2020 2020 2020 2050  ()``...        P
-00008a10: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00008a20: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00008a30: 2020 2020 2066 756e 6320 3a20 6675 6e63       func : func
-00008a40: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-00008a50: 2046 756e 6374 696f 6e20 6170 706c 6965   Function applie
-00008a60: 6420 746f 2065 6163 6820 7061 7274 6974  d to each partit
-00008a70: 696f 6e2e 0a20 2020 2020 2020 2062 6566  ion..        bef
-00008a80: 6f72 6520 3a20 696e 742c 2074 696d 6564  ore : int, timed
-00008a90: 656c 7461 206f 7220 7374 7269 6e67 2074  elta or string t
-00008aa0: 696d 6564 656c 7461 0a20 2020 2020 2020  imedelta.       
-00008ab0: 2020 2020 2054 6865 2072 6f77 7320 746f       The rows to
-00008ac0: 2070 7265 7065 6e64 2074 6f20 7061 7274   prepend to part
-00008ad0: 6974 696f 6e20 6060 6960 6020 6672 6f6d  ition ``i`` from
-00008ae0: 2074 6865 2065 6e64 206f 660a 2020 2020   the end of.    
-00008af0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-00008b00: 6e20 6060 6920 2d20 3160 602e 0a20 2020  n ``i - 1``..   
-00008b10: 2020 2020 2061 6674 6572 203a 2069 6e74       after : int
-00008b20: 2c20 7469 6d65 6465 6c74 6120 6f72 2073  , timedelta or s
-00008b30: 7472 696e 6720 7469 6d65 6465 6c74 610a  tring timedelta.
-00008b40: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00008b50: 726f 7773 2074 6f20 6170 7065 6e64 2074  rows to append t
-00008b60: 6f20 7061 7274 6974 696f 6e20 6060 6960  o partition ``i`
-00008b70: 6020 6672 6f6d 2074 6865 2062 6567 696e  ` from the begin
-00008b80: 6e69 6e67 0a20 2020 2020 2020 2020 2020  ning.           
-00008b90: 206f 6620 7061 7274 6974 696f 6e20 6060   of partition ``
-00008ba0: 6920 2b20 3160 602e 0a20 2020 2020 2020  i + 1``..       
-00008bb0: 2061 7267 732c 206b 7761 7267 7320 3a0a   args, kwargs :.
-00008bc0: 2020 2020 2020 2020 2020 2020 506f 7369              Posi
-00008bd0: 7469 6f6e 616c 2061 6e64 206b 6579 776f  tional and keywo
-00008be0: 7264 2061 7267 756d 656e 7473 2074 6f20  rd arguments to 
-00008bf0: 7061 7373 2074 6f20 7468 6520 6675 6e63  pass to the func
-00008c00: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
-00008c10: 2020 506f 7369 7469 6f6e 616c 2061 7267    Positional arg
-00008c20: 756d 656e 7473 2061 7265 2063 6f6d 7075  uments are compu
-00008c30: 7465 6420 6f6e 2061 2070 6572 2d70 6172  ted on a per-par
-00008c40: 7469 7469 6f6e 2062 6173 6973 2c20 7768  tition basis, wh
-00008c50: 696c 650a 2020 2020 2020 2020 2020 2020  ile.            
-00008c60: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00008c70: 7320 6172 6520 7368 6172 6564 2061 6372  s are shared acr
-00008c80: 6f73 7320 616c 6c20 7061 7274 6974 696f  oss all partitio
-00008c90: 6e73 2e20 5468 6520 7061 7274 6974 696f  ns. The partitio
-00008ca0: 6e0a 2020 2020 2020 2020 2020 2020 6974  n.            it
-00008cb0: 7365 6c66 2077 696c 6c20 6265 2074 6865  self will be the
-00008cc0: 2066 6972 7374 2070 6f73 6974 696f 6e61   first positiona
-00008cd0: 6c20 6172 6775 6d65 6e74 2c20 7769 7468  l argument, with
-00008ce0: 2061 6c6c 206f 7468 6572 0a20 2020 2020   all other.     
-00008cf0: 2020 2020 2020 2061 7267 756d 656e 7473         arguments
-00008d00: 2070 6173 7365 6420 2a61 6674 6572 2a2e   passed *after*.
-00008d10: 2041 7267 756d 656e 7473 2063 616e 2062   Arguments can b
-00008d20: 6520 6060 5363 616c 6172 6060 2c20 6060  e ``Scalar``, ``
-00008d30: 4465 6c61 7965 6460 602c 0a20 2020 2020  Delayed``,.     
-00008d40: 2020 2020 2020 206f 7220 7265 6775 6c61         or regula
-00008d50: 7220 5079 7468 6f6e 206f 626a 6563 7473  r Python objects
-00008d60: 2e20 4461 7461 4672 616d 652d 6c69 6b65  . DataFrame-like
-00008d70: 2061 7267 7320 2862 6f74 6820 6461 736b   args (both dask
-00008d80: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-00008d90: 2070 616e 6461 7329 2077 696c 6c20 6265   pandas) will be
-00008da0: 2072 6570 6172 7469 7469 6f6e 6564 2074   repartitioned t
-00008db0: 6f20 616c 6967 6e20 2869 6620 6e65 6365  o align (if nece
-00008dc0: 7373 6172 7929 2062 6566 6f72 650a 2020  ssary) before.  
-00008dd0: 2020 2020 2020 2020 2020 6170 706c 7969            applyi
-00008de0: 6e67 2074 6865 2066 756e 6374 696f 6e3b  ng the function;
-00008df0: 2073 6565 2060 6061 6c69 676e 5f64 6174   see ``align_dat
-00008e00: 6166 7261 6d65 7360 6020 746f 2063 6f6e  aframes`` to con
-00008e10: 7472 6f6c 2074 6869 730a 2020 2020 2020  trol this.      
-00008e20: 2020 2020 2020 6265 6861 7669 6f72 2e0a        behavior..
-00008e30: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
-00008e40: 6d65 7461 6461 7461 203a 2062 6f6f 6c2c  metadata : bool,
-00008e50: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
-00008e60: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
-00008e70: 7220 746f 2065 6e66 6f72 6365 2061 7420  r to enforce at 
-00008e80: 7275 6e74 696d 6520 7468 6174 2074 6865  runtime that the
-00008e90: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
-00008ea0: 6520 4461 7461 4672 616d 650a 2020 2020  e DataFrame.    
-00008eb0: 2020 2020 2020 2020 7072 6f64 7563 6564          produced
-00008ec0: 2062 7920 6060 6675 6e63 6060 2061 6374   by ``func`` act
-00008ed0: 7561 6c6c 7920 6d61 7463 6865 7320 7468  ually matches th
-00008ee0: 6520 7374 7275 6374 7572 6520 6f66 2060  e structure of `
-00008ef0: 606d 6574 6160 602e 0a20 2020 2020 2020  `meta``..       
-00008f00: 2020 2020 2054 6869 7320 7769 6c6c 2072       This will r
-00008f10: 656e 616d 6520 616e 6420 7265 6f72 6465  ename and reorde
-00008f20: 7220 636f 6c75 6d6e 7320 666f 7220 6561  r columns for ea
-00008f30: 6368 2070 6172 7469 7469 6f6e 2c0a 2020  ch partition,.  
-00008f40: 2020 2020 2020 2020 2020 616e 6420 7769            and wi
-00008f50: 6c6c 2072 6169 7365 2061 6e20 6572 726f  ll raise an erro
-00008f60: 7220 6966 2074 6869 7320 646f 6573 6e27  r if this doesn'
-00008f70: 7420 776f 726b 2c0a 2020 2020 2020 2020  t work,.        
-00008f80: 2020 2020 6275 7420 6974 2077 6f6e 2774      but it won't
-00008f90: 2072 6169 7365 2069 6620 6474 7970 6573   raise if dtypes
-00008fa0: 2064 6f6e 2774 206d 6174 6368 2e0a 2020   don't match..  
-00008fb0: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
-00008fc0: 6469 7669 7369 6f6e 7320 3a20 626f 6f6c  divisions : bool
-00008fd0: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
-00008fe0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-00008ff0: 6572 2074 6f20 6170 706c 7920 7468 6520  er to apply the 
-00009000: 6675 6e63 7469 6f6e 206f 6e74 6f20 7468  function onto th
-00009010: 6520 6469 7669 7369 6f6e 7320 616e 6420  e divisions and 
-00009020: 6170 706c 7920 7468 6f73 650a 2020 2020  apply those.    
-00009030: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
-00009040: 6d65 6420 6469 7669 7369 6f6e 7320 746f  med divisions to
-00009050: 2074 6865 206f 7574 7075 742e 0a20 2020   the output..   
-00009060: 2020 2020 2061 6c69 676e 5f64 6174 6166       align_dataf
-00009070: 7261 6d65 7320 3a20 626f 6f6c 2c20 6465  rames : bool, de
-00009080: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
-00009090: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-000090a0: 6f20 7265 7061 7274 6974 696f 6e20 4461  o repartition Da
-000090b0: 7461 4672 616d 652d 206f 7220 5365 7269  taFrame- or Seri
-000090c0: 6573 2d6c 696b 6520 6172 6773 0a20 2020  es-like args.   
-000090d0: 2020 2020 2020 2020 2028 626f 7468 2064           (both d
-000090e0: 6173 6b20 616e 6420 7061 6e64 6173 2920  ask and pandas) 
-000090f0: 736f 2074 6865 6972 2064 6976 6973 696f  so their divisio
-00009100: 6e73 2061 6c69 676e 2062 6566 6f72 6520  ns align before 
-00009110: 6170 706c 7969 6e67 0a20 2020 2020 2020  applying.       
-00009120: 2020 2020 2074 6865 2066 756e 6374 696f       the functio
-00009130: 6e2e 2054 6869 7320 7265 7175 6972 6573  n. This requires
-00009140: 2061 6c6c 2069 6e70 7574 7320 746f 2068   all inputs to h
-00009150: 6176 6520 6b6e 6f77 6e20 6469 7669 7369  ave known divisi
-00009160: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
-00009170: 2053 696e 676c 652d 7061 7274 6974 696f   Single-partitio
-00009180: 6e20 696e 7075 7473 2077 696c 6c20 6265  n inputs will be
-00009190: 2073 706c 6974 2069 6e74 6f20 6d75 6c74   split into mult
-000091a0: 6970 6c65 2070 6172 7469 7469 6f6e 732e  iple partitions.
-000091b0: 0a0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-000091c0: 2046 616c 7365 2c20 616c 6c20 696e 7075   False, all inpu
-000091d0: 7473 206d 7573 7420 6861 7665 2065 6974  ts must have eit
-000091e0: 6865 7220 7468 6520 7361 6d65 206e 756d  her the same num
-000091f0: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
-00009200: 730a 2020 2020 2020 2020 2020 2020 6f72  s.            or
-00009210: 2061 2073 696e 676c 6520 7061 7274 6974   a single partit
-00009220: 696f 6e2e 2053 696e 676c 652d 7061 7274  ion. Single-part
-00009230: 6974 696f 6e20 696e 7075 7473 2077 696c  ition inputs wil
-00009240: 6c20 6265 2062 726f 6164 6361 7374 2074  l be broadcast t
-00009250: 6f0a 2020 2020 2020 2020 2020 2020 6576  o.            ev
-00009260: 6572 7920 7061 7274 6974 696f 6e20 6f66  ery partition of
-00009270: 206d 756c 7469 2d70 6172 7469 7469 6f6e   multi-partition
-00009280: 2069 6e70 7574 732e 0a20 2020 2020 2020   inputs..       
-00009290: 2024 4d45 5441 0a0a 2020 2020 2020 2020   $META..        
-000092a0: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
-000092b0: 2d2d 2d0a 2020 2020 2020 2020 4769 7665  ---.        Give
-000092c0: 6e20 706f 7369 7469 7665 2069 6e74 6567  n positive integ
-000092d0: 6572 7320 6060 6265 666f 7265 6060 2061  ers ``before`` a
-000092e0: 6e64 2060 6061 6674 6572 6060 2c20 616e  nd ``after``, an
-000092f0: 6420 6120 6675 6e63 7469 6f6e 0a20 2020  d a function.   
-00009300: 2020 2020 2060 6066 756e 6360 602c 2060       ``func``, `
-00009310: 606d 6170 5f6f 7665 726c 6170 6060 2064  `map_overlap`` d
-00009320: 6f65 7320 7468 6520 666f 6c6c 6f77 696e  oes the followin
-00009330: 673a 0a0a 2020 2020 2020 2020 312e 2050  g:..        1. P
-00009340: 7265 7065 6e64 2060 6062 6566 6f72 6560  repend ``before`
-00009350: 6020 726f 7773 2074 6f20 6561 6368 2070  ` rows to each p
-00009360: 6172 7469 7469 6f6e 2060 6069 6060 2066  artition ``i`` f
-00009370: 726f 6d20 7468 6520 656e 6420 6f66 0a20  rom the end of. 
-00009380: 2020 2020 2020 2020 2020 7061 7274 6974            partit
-00009390: 696f 6e20 6060 6920 2d20 3160 602e 2054  ion ``i - 1``. T
-000093a0: 6865 2066 6972 7374 2070 6172 7469 7469  he first partiti
-000093b0: 6f6e 2068 6173 206e 6f20 726f 7773 2070  on has no rows p
-000093c0: 7265 7065 6e64 6564 2e0a 0a20 2020 2020  repended...     
-000093d0: 2020 2032 2e20 4170 7065 6e64 2060 6061     2. Append ``a
-000093e0: 6674 6572 6060 2072 6f77 7320 746f 2065  fter`` rows to e
-000093f0: 6163 6820 7061 7274 6974 696f 6e20 6060  ach partition ``
-00009400: 6960 6020 6672 6f6d 2074 6865 2062 6567  i`` from the beg
-00009410: 696e 6e69 6e67 206f 660a 2020 2020 2020  inning of.      
-00009420: 2020 2020 2070 6172 7469 7469 6f6e 2060       partition `
-00009430: 6069 202b 2031 6060 2e20 5468 6520 6c61  `i + 1``. The la
-00009440: 7374 2070 6172 7469 7469 6f6e 2068 6173  st partition has
-00009450: 206e 6f20 726f 7773 2061 7070 656e 6465   no rows appende
-00009460: 642e 0a0a 2020 2020 2020 2020 332e 2041  d...        3. A
-00009470: 7070 6c79 2060 6066 756e 6360 6020 746f  pply ``func`` to
-00009480: 2065 6163 6820 7061 7274 6974 696f 6e2c   each partition,
-00009490: 2070 6173 7369 6e67 2069 6e20 616e 7920   passing in any 
-000094a0: 6578 7472 6120 6060 6172 6773 6060 2061  extra ``args`` a
-000094b0: 6e64 0a20 2020 2020 2020 2020 2020 6060  nd.           ``
-000094c0: 6b77 6172 6773 6060 2069 6620 7072 6f76  kwargs`` if prov
-000094d0: 6964 6564 2e0a 0a20 2020 2020 2020 2034  ided...        4
-000094e0: 2e20 5472 696d 2060 6062 6566 6f72 6560  . Trim ``before`
-000094f0: 6020 726f 7773 2066 726f 6d20 7468 6520  ` rows from the 
-00009500: 6265 6769 6e6e 696e 6720 6f66 2061 6c6c  beginning of all
-00009510: 2062 7574 2074 6865 2066 6972 7374 0a20   but the first. 
-00009520: 2020 2020 2020 2020 2020 7061 7274 6974            partit
-00009530: 696f 6e2e 0a0a 2020 2020 2020 2020 352e  ion...        5.
-00009540: 2054 7269 6d20 6060 6166 7465 7260 6020   Trim ``after`` 
-00009550: 726f 7773 2066 726f 6d20 7468 6520 656e  rows from the en
-00009560: 6420 6f66 2061 6c6c 2062 7574 2074 6865  d of all but the
-00009570: 206c 6173 7420 7061 7274 6974 696f 6e2e   last partition.
-00009580: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00009590: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-000095a0: 2d2d 2d0a 2020 2020 2020 2020 4769 7665  ---.        Give
-000095b0: 6e20 6120 4461 7461 4672 616d 652c 2053  n a DataFrame, S
-000095c0: 6572 6965 732c 206f 7220 496e 6465 782c  eries, or Index,
-000095d0: 2073 7563 6820 6173 3a0a 0a20 2020 2020   such as:..     
-000095e0: 2020 203e 3e3e 2069 6d70 6f72 7420 7061     >>> import pa
-000095f0: 6e64 6173 2061 7320 7064 0a20 2020 2020  ndas as pd.     
-00009600: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-00009610: 736b 2e64 6174 6166 7261 6d65 2061 7320  sk.dataframe as 
-00009620: 6464 0a20 2020 2020 2020 203e 3e3e 2064  dd.        >>> d
-00009630: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
-00009640: 287b 2778 273a 205b 312c 2032 2c20 342c  ({'x': [1, 2, 4,
-00009650: 2037 2c20 3131 5d2c 0a20 2020 2020 2020   7, 11],.       
-00009660: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-00009670: 2020 2020 2020 2020 2779 273a 205b 312e          'y': [1.
-00009680: 2c20 322e 2c20 332e 2c20 342e 2c20 352e  , 2., 3., 4., 5.
-00009690: 5d7d 290a 2020 2020 2020 2020 3e3e 3e20  ]}).        >>> 
-000096a0: 6464 6620 3d20 6464 2e66 726f 6d5f 7061  ddf = dd.from_pa
-000096b0: 6e64 6173 2864 662c 206e 7061 7274 6974  ndas(df, npartit
-000096c0: 696f 6e73 3d32 290a 0a20 2020 2020 2020  ions=2)..       
-000096d0: 2041 2072 6f6c 6c69 6e67 2073 756d 2077   A rolling sum w
-000096e0: 6974 6820 6120 7472 6169 6c69 6e67 206d  ith a trailing m
-000096f0: 6f76 696e 6720 7769 6e64 6f77 206f 6620  oving window of 
-00009700: 7369 7a65 2032 2063 616e 2062 6520 636f  size 2 can be co
-00009710: 6d70 7574 6564 2062 790a 2020 2020 2020  mputed by.      
-00009720: 2020 6f76 6572 6c61 7070 696e 6720 3220    overlapping 2 
-00009730: 726f 7773 2062 6566 6f72 6520 6561 6368  rows before each
-00009740: 2070 6172 7469 7469 6f6e 2c20 616e 6420   partition, and 
-00009750: 7468 656e 206d 6170 7069 6e67 2063 616c  then mapping cal
-00009760: 6c73 2074 6f0a 2020 2020 2020 2020 6060  ls to.        ``
-00009770: 6466 2e72 6f6c 6c69 6e67 2832 292e 7375  df.rolling(2).su
-00009780: 6d28 2960 603a 0a0a 2020 2020 2020 2020  m()``:..        
-00009790: 3e3e 3e20 6464 662e 636f 6d70 7574 6528  >>> ddf.compute(
-000097a0: 290a 2020 2020 2020 2020 2020 2020 7820  ).            x 
-000097b0: 2020 2079 0a20 2020 2020 2020 2030 2020     y.        0  
-000097c0: 2031 2020 312e 300a 2020 2020 2020 2020   1  1.0.        
-000097d0: 3120 2020 3220 2032 2e30 0a20 2020 2020  1   2  2.0.     
-000097e0: 2020 2032 2020 2034 2020 332e 300a 2020     2   4  3.0.  
-000097f0: 2020 2020 2020 3320 2020 3720 2034 2e30        3   7  4.0
-00009800: 0a20 2020 2020 2020 2034 2020 3131 2020  .        4  11  
-00009810: 352e 300a 2020 2020 2020 2020 3e3e 3e20  5.0.        >>> 
-00009820: 6464 662e 6d61 705f 6f76 6572 6c61 7028  ddf.map_overlap(
-00009830: 6c61 6d62 6461 2064 663a 2064 662e 726f  lambda df: df.ro
-00009840: 6c6c 696e 6728 3229 2e73 756d 2829 2c20  lling(2).sum(), 
-00009850: 322c 2030 292e 636f 6d70 7574 6528 290a  2, 0).compute().
-00009860: 2020 2020 2020 2020 2020 2020 2020 7820                x 
-00009870: 2020 2079 0a20 2020 2020 2020 2030 2020     y.        0  
-00009880: 204e 614e 2020 4e61 4e0a 2020 2020 2020   NaN  NaN.      
-00009890: 2020 3120 2020 332e 3020 2033 2e30 0a20    1   3.0  3.0. 
-000098a0: 2020 2020 2020 2032 2020 2036 2e30 2020         2   6.0  
-000098b0: 352e 300a 2020 2020 2020 2020 3320 2031  5.0.        3  1
-000098c0: 312e 3020 2037 2e30 0a20 2020 2020 2020  1.0  7.0.       
-000098d0: 2034 2020 3138 2e30 2020 392e 300a 0a20   4  18.0  9.0.. 
-000098e0: 2020 2020 2020 2054 6865 2070 616e 6461         The panda
-000098f0: 7320 6060 6469 6666 6060 206d 6574 686f  s ``diff`` metho
-00009900: 6420 636f 6d70 7574 6573 2061 2064 6973  d computes a dis
-00009910: 6372 6574 6520 6469 6666 6572 656e 6365  crete difference
-00009920: 2073 6869 6674 6564 2062 7920 610a 2020   shifted by a.  
-00009930: 2020 2020 2020 6e75 6d62 6572 206f 6620        number of 
-00009940: 7065 7269 6f64 7320 2863 616e 2062 6520  periods (can be 
-00009950: 706f 7369 7469 7665 206f 7220 6e65 6761  positive or nega
-00009960: 7469 7665 292e 2054 6869 7320 6361 6e20  tive). This can 
-00009970: 6265 0a20 2020 2020 2020 2069 6d70 6c65  be.        imple
-00009980: 6d65 6e74 6564 2062 7920 6d61 7070 696e  mented by mappin
-00009990: 6720 6361 6c6c 7320 746f 2060 6064 662e  g calls to ``df.
-000099a0: 6469 6666 6060 2074 6f20 6561 6368 2070  diff`` to each p
-000099b0: 6172 7469 7469 6f6e 2061 6674 6572 0a20  artition after. 
-000099c0: 2020 2020 2020 2070 7265 7065 6e64 696e         prependin
-000099d0: 672f 6170 7065 6e64 696e 6720 7468 6174  g/appending that
-000099e0: 206d 616e 7920 726f 7773 2c20 6465 7065   many rows, depe
-000099f0: 6e64 696e 6720 6f6e 2073 6967 6e3a 0a0a  nding on sign:..
-00009a00: 2020 2020 2020 2020 3e3e 3e20 6465 6620          >>> def 
-00009a10: 6469 6666 2864 662c 2070 6572 696f 6473  diff(df, periods
-00009a20: 3d31 293a 0a20 2020 2020 2020 202e 2e2e  =1):.        ...
-00009a30: 2020 2020 2062 6566 6f72 652c 2061 6674       before, aft
-00009a40: 6572 203d 2028 7065 7269 6f64 732c 2030  er = (periods, 0
-00009a50: 2920 6966 2070 6572 696f 6473 203e 2030  ) if periods > 0
-00009a60: 2065 6c73 6520 2830 2c20 2d70 6572 696f   else (0, -perio
-00009a70: 6473 290a 2020 2020 2020 2020 2e2e 2e20  ds).        ... 
-00009a80: 2020 2020 7265 7475 726e 2064 662e 6d61      return df.ma
-00009a90: 705f 6f76 6572 6c61 7028 6c61 6d62 6461  p_overlap(lambda
-00009aa0: 2064 662c 2070 6572 696f 6473 3d31 3a20   df, periods=1: 
-00009ab0: 6466 2e64 6966 6628 7065 7269 6f64 7329  df.diff(periods)
-00009ac0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00009ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009ae0: 2020 2020 2020 2020 7065 7269 6f64 732c          periods,
-00009af0: 2030 2c20 7065 7269 6f64 733d 7065 7269   0, periods=peri
-00009b00: 6f64 7329 0a20 2020 2020 2020 203e 3e3e  ods).        >>>
-00009b10: 2064 6966 6628 6464 662c 2031 292e 636f   diff(ddf, 1).co
-00009b20: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
-00009b30: 2020 2020 2078 2020 2020 790a 2020 2020       x    y.    
-00009b40: 2020 2020 3020 204e 614e 2020 4e61 4e0a      0  NaN  NaN.
-00009b50: 2020 2020 2020 2020 3120 2031 2e30 2020          1  1.0  
-00009b60: 312e 300a 2020 2020 2020 2020 3220 2032  1.0.        2  2
-00009b70: 2e30 2020 312e 300a 2020 2020 2020 2020  .0  1.0.        
-00009b80: 3320 2033 2e30 2020 312e 300a 2020 2020  3  3.0  1.0.    
-00009b90: 2020 2020 3420 2034 2e30 2020 312e 300a      4  4.0  1.0.
-00009ba0: 0a20 2020 2020 2020 2049 6620 796f 7520  .        If you 
-00009bb0: 6861 7665 2061 2060 6044 6174 6574 696d  have a ``Datetim
-00009bc0: 6549 6e64 6578 6060 2c20 796f 7520 6361  eIndex``, you ca
-00009bd0: 6e20 7573 6520 6120 6060 7064 2e54 696d  n use a ``pd.Tim
-00009be0: 6564 656c 7461 6060 2066 6f72 2074 696d  edelta`` for tim
-00009bf0: 652d 0a20 2020 2020 2020 2062 6173 6564  e-.        based
-00009c00: 2077 696e 646f 7773 206f 7220 616e 7920   windows or any 
-00009c10: 6060 7064 2e54 696d 6564 656c 7461 6060  ``pd.Timedelta``
-00009c20: 2063 6f6e 7665 7274 6962 6c65 2073 7472   convertible str
-00009c30: 696e 673a 0a0a 2020 2020 2020 2020 3e3e  ing:..        >>
-00009c40: 3e20 7473 203d 2070 642e 5365 7269 6573  > ts = pd.Series
-00009c50: 2872 616e 6765 2831 3029 2c20 696e 6465  (range(10), inde
-00009c60: 783d 7064 2e64 6174 655f 7261 6e67 6528  x=pd.date_range(
-00009c70: 2732 3031 3727 2c20 7065 7269 6f64 733d  '2017', periods=
-00009c80: 3130 2929 0a20 2020 2020 2020 203e 3e3e  10)).        >>>
-00009c90: 2064 7473 203d 2064 642e 6672 6f6d 5f70   dts = dd.from_p
-00009ca0: 616e 6461 7328 7473 2c20 6e70 6172 7469  andas(ts, nparti
-00009cb0: 7469 6f6e 733d 3229 0a20 2020 2020 2020  tions=2).       
-00009cc0: 203e 3e3e 2064 7473 2e6d 6170 5f6f 7665   >>> dts.map_ove
-00009cd0: 726c 6170 286c 616d 6264 6120 6466 3a20  rlap(lambda df: 
-00009ce0: 6466 2e72 6f6c 6c69 6e67 2827 3244 2729  df.rolling('2D')
-00009cf0: 2e73 756d 2829 2c0a 2020 2020 2020 2020  .sum(),.        
-00009d00: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-00009d10: 2020 2020 7064 2e54 696d 6564 656c 7461      pd.Timedelta
-00009d20: 2827 3244 2729 2c20 3029 2e63 6f6d 7075  ('2D'), 0).compu
-00009d30: 7465 2829 0a20 2020 2020 2020 2032 3031  te().        201
-00009d40: 372d 3031 2d30 3120 2020 2020 302e 300a  7-01-01     0.0.
-00009d50: 2020 2020 2020 2020 3230 3137 2d30 312d          2017-01-
-00009d60: 3032 2020 2020 2031 2e30 0a20 2020 2020  02     1.0.     
-00009d70: 2020 2032 3031 372d 3031 2d30 3320 2020     2017-01-03   
-00009d80: 2020 332e 300a 2020 2020 2020 2020 3230    3.0.        20
-00009d90: 3137 2d30 312d 3034 2020 2020 2035 2e30  17-01-04     5.0
-00009da0: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
-00009db0: 2d30 3520 2020 2020 372e 300a 2020 2020  -05     7.0.    
-00009dc0: 2020 2020 3230 3137 2d30 312d 3036 2020      2017-01-06  
-00009dd0: 2020 2039 2e30 0a20 2020 2020 2020 2032     9.0.        2
-00009de0: 3031 372d 3031 2d30 3720 2020 2031 312e  017-01-07    11.
-00009df0: 300a 2020 2020 2020 2020 3230 3137 2d30  0.        2017-0
-00009e00: 312d 3038 2020 2020 3133 2e30 0a20 2020  1-08    13.0.   
-00009e10: 2020 2020 2032 3031 372d 3031 2d30 3920       2017-01-09 
-00009e20: 2020 2031 352e 300a 2020 2020 2020 2020     15.0.        
-00009e30: 3230 3137 2d30 312d 3130 2020 2020 3137  2017-01-10    17
-00009e40: 2e30 0a20 2020 2020 2020 2046 7265 713a  .0.        Freq:
-00009e50: 2044 2c20 6474 7970 653a 2066 6c6f 6174   D, dtype: float
-00009e60: 3634 0a20 2020 2020 2020 2022 2222 0a20  64.        """. 
-00009e70: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-00009e80: 2e64 6174 6166 7261 6d65 2e72 6f6c 6c69  .dataframe.rolli
-00009e90: 6e67 2069 6d70 6f72 7420 6d61 705f 6f76  ng import map_ov
-00009ea0: 6572 6c61 700a 0a20 2020 2020 2020 2072  erlap..        r
-00009eb0: 6574 7572 6e20 6d61 705f 6f76 6572 6c61  eturn map_overla
-00009ec0: 7028 6675 6e63 2c20 7365 6c66 2c20 6265  p(func, self, be
-00009ed0: 666f 7265 2c20 6166 7465 722c 202a 6172  fore, after, *ar
-00009ee0: 6773 2c20 2a2a 6b77 6172 6773 290a 0a20  gs, **kwargs).. 
-00009ef0: 2020 2064 6566 206d 656d 6f72 795f 7573     def memory_us
-00009f00: 6167 655f 7065 725f 7061 7274 6974 696f  age_per_partitio
-00009f10: 6e28 7365 6c66 2c20 696e 6465 783d 5472  n(self, index=Tr
-00009f20: 7565 2c20 6465 6570 3d46 616c 7365 293a  ue, deep=False):
-00009f30: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00009f40: 726e 2074 6865 206d 656d 6f72 7920 7573  rn the memory us
-00009f50: 6167 6520 6f66 2065 6163 6820 7061 7274  age of each part
-00009f60: 6974 696f 6e0a 0a20 2020 2020 2020 2050  ition..        P
-00009f70: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00009f80: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00009f90: 2020 2020 2069 6e64 6578 203a 2062 6f6f       index : boo
-00009fa0: 6c2c 2064 6566 6175 6c74 2054 7275 650a  l, default True.
-00009fb0: 2020 2020 2020 2020 2020 2020 5370 6563              Spec
-00009fc0: 6966 6965 7320 7768 6574 6865 7220 746f  ifies whether to
-00009fd0: 2069 6e63 6c75 6465 2074 6865 206d 656d   include the mem
-00009fe0: 6f72 7920 7573 6167 6520 6f66 2074 6865  ory usage of the
-00009ff0: 2069 6e64 6578 2069 6e0a 2020 2020 2020   index in.      
-0000a000: 2020 2020 2020 7265 7475 726e 6564 2053        returned S
-0000a010: 6572 6965 732e 0a20 2020 2020 2020 2064  eries..        d
-0000a020: 6565 7020 3a20 626f 6f6c 2c20 6465 6661  eep : bool, defa
-0000a030: 756c 7420 4661 6c73 650a 2020 2020 2020  ult False.      
-0000a040: 2020 2020 2020 4966 2054 7275 652c 2069        If True, i
-0000a050: 6e74 726f 7370 6563 7420 7468 6520 6461  ntrospect the da
-0000a060: 7461 2064 6565 706c 7920 6279 2069 6e74  ta deeply by int
-0000a070: 6572 726f 6761 7469 6e67 0a20 2020 2020  errogating.     
-0000a080: 2020 2020 2020 2060 606f 626a 6563 7460         ``object`
-0000a090: 6020 6474 7970 6573 2066 6f72 2073 7973  ` dtypes for sys
-0000a0a0: 7465 6d2d 6c65 7665 6c20 6d65 6d6f 7279  tem-level memory
-0000a0b0: 2063 6f6e 7375 6d70 7469 6f6e 2c20 616e   consumption, an
-0000a0c0: 6420 696e 636c 7564 650a 2020 2020 2020  d include.      
-0000a0d0: 2020 2020 2020 6974 2069 6e20 7468 6520        it in the 
-0000a0e0: 7265 7475 726e 6564 2076 616c 7565 732e  returned values.
-0000a0f0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0000a100: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0000a110: 2d0a 2020 2020 2020 2020 5365 7269 6573  -.        Series
-0000a120: 0a20 2020 2020 2020 2020 2020 2041 2053  .            A S
-0000a130: 6572 6965 7320 7768 6f73 6520 696e 6465  eries whose inde
-0000a140: 7820 6973 2074 6865 2070 6172 7469 7469  x is the partiti
-0000a150: 6f6e 206e 756d 6265 7220 616e 6420 7768  on number and wh
-0000a160: 6f73 6520 7661 6c75 6573 0a20 2020 2020  ose values.     
-0000a170: 2020 2020 2020 2061 7265 2074 6865 206d         are the m
-0000a180: 656d 6f72 7920 7573 6167 6520 6f66 2065  emory usage of e
-0000a190: 6163 6820 7061 7274 6974 696f 6e20 696e  ach partition in
-0000a1a0: 2062 7974 6573 2e0a 2020 2020 2020 2020   bytes..        
-0000a1b0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-0000a1c0: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-0000a1d0: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-0000a1e0: 2020 2020 746f 7461 6c5f 6d65 6d5f 7573      total_mem_us
-0000a1f0: 6167 652c 2069 6e64 6578 3d69 6e64 6578  age, index=index
-0000a200: 2c20 6465 6570 3d64 6565 700a 2020 2020  , deep=deep.    
-0000a210: 2020 2020 292e 636c 6561 725f 6469 7669      ).clear_divi
-0000a220: 7369 6f6e 7328 290a 0a20 2020 2040 696e  sions()..    @in
-0000a230: 7365 7274 5f6d 6574 615f 7061 7261 6d5f  sert_meta_param_
-0000a240: 6465 7363 7269 7074 696f 6e28 7061 643d  description(pad=
-0000a250: 3132 290a 2020 2020 6465 6620 7265 6475  12).    def redu
-0000a260: 6374 696f 6e28 0a20 2020 2020 2020 2073  ction(.        s
-0000a270: 656c 662c 0a20 2020 2020 2020 2063 6875  elf,.        chu
-0000a280: 6e6b 2c0a 2020 2020 2020 2020 6167 6772  nk,.        aggr
-0000a290: 6567 6174 653d 4e6f 6e65 2c0a 2020 2020  egate=None,.    
-0000a2a0: 2020 2020 636f 6d62 696e 653d 4e6f 6e65      combine=None
-0000a2b0: 2c0a 2020 2020 2020 2020 6d65 7461 3d6e  ,.        meta=n
-0000a2c0: 6f5f 6465 6661 756c 742c 0a20 2020 2020  o_default,.     
-0000a2d0: 2020 2074 6f6b 656e 3d4e 6f6e 652c 0a20     token=None,. 
-0000a2e0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-0000a2f0: 7279 3d4e 6f6e 652c 0a20 2020 2020 2020  ry=None,.       
-0000a300: 2063 6875 6e6b 5f6b 7761 7267 733d 4e6f   chunk_kwargs=No
-0000a310: 6e65 2c0a 2020 2020 2020 2020 6167 6772  ne,.        aggr
-0000a320: 6567 6174 655f 6b77 6172 6773 3d4e 6f6e  egate_kwargs=Non
-0000a330: 652c 0a20 2020 2020 2020 2063 6f6d 6269  e,.        combi
-0000a340: 6e65 5f6b 7761 7267 733d 4e6f 6e65 2c0a  ne_kwargs=None,.
-0000a350: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-0000a360: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0000a370: 2022 2222 4765 6e65 7269 6320 726f 772d   """Generic row-
-0000a380: 7769 7365 2072 6564 7563 7469 6f6e 732e  wise reductions.
-0000a390: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0000a3a0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-0000a3b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000a3c0: 6368 756e 6b20 3a20 6361 6c6c 6162 6c65  chunk : callable
-0000a3d0: 0a20 2020 2020 2020 2020 2020 2046 756e  .            Fun
-0000a3e0: 6374 696f 6e20 746f 206f 7065 7261 7465  ction to operate
-0000a3f0: 206f 6e20 6561 6368 2070 6172 7469 7469   on each partiti
-0000a400: 6f6e 2e20 5368 6f75 6c64 2072 6574 7572  on. Should retur
-0000a410: 6e20 610a 2020 2020 2020 2020 2020 2020  n a.            
-0000a420: 6060 7061 6e64 6173 2e44 6174 6146 7261  ``pandas.DataFra
-0000a430: 6d65 6060 2c20 6060 7061 6e64 6173 2e53  me``, ``pandas.S
-0000a440: 6572 6965 7360 602c 206f 7220 6120 7363  eries``, or a sc
-0000a450: 616c 6172 2e0a 2020 2020 2020 2020 6167  alar..        ag
-0000a460: 6772 6567 6174 6520 3a20 6361 6c6c 6162  gregate : callab
-0000a470: 6c65 2c20 6f70 7469 6f6e 616c 0a20 2020  le, optional.   
-0000a480: 2020 2020 2020 2020 2046 756e 6374 696f           Functio
-0000a490: 6e20 746f 206f 7065 7261 7465 206f 6e20  n to operate on 
-0000a4a0: 7468 6520 636f 6e63 6174 656e 6174 6564  the concatenated
-0000a4b0: 2072 6573 756c 7420 6f66 2060 6063 6875   result of ``chu
-0000a4c0: 6e6b 6060 2e20 4966 206e 6f74 0a20 2020  nk``. If not.   
-0000a4d0: 2020 2020 2020 2020 2073 7065 6369 6669           specifi
-0000a4e0: 6564 2c20 6465 6661 756c 7473 2074 6f20  ed, defaults to 
-0000a4f0: 6060 6368 756e 6b60 602e 2055 7365 6420  ``chunk``. Used 
-0000a500: 746f 2064 6f20 7468 6520 6669 6e61 6c20  to do the final 
-0000a510: 6167 6772 6567 6174 696f 6e0a 2020 2020  aggregation.    
-0000a520: 2020 2020 2020 2020 696e 2061 2074 7265          in a tre
-0000a530: 6520 7265 6475 6374 696f 6e2e 0a0a 2020  e reduction...  
-0000a540: 2020 2020 2020 2020 2020 5468 6520 696e            The in
-0000a550: 7075 7420 746f 2060 6061 6767 7265 6761  put to ``aggrega
-0000a560: 7465 6060 2064 6570 656e 6473 206f 6e20  te`` depends on 
-0000a570: 7468 6520 6f75 7470 7574 206f 6620 6060  the output of ``
-0000a580: 6368 756e 6b60 602e 0a20 2020 2020 2020  chunk``..       
-0000a590: 2020 2020 2049 6620 7468 6520 6f75 7470       If the outp
-0000a5a0: 7574 206f 6620 6060 6368 756e 6b60 6020  ut of ``chunk`` 
-0000a5b0: 6973 2061 3a0a 0a20 2020 2020 2020 2020  is a:..         
-0000a5c0: 2020 202d 2073 6361 6c61 723a 2049 6e70     - scalar: Inp
-0000a5d0: 7574 2069 7320 6120 5365 7269 6573 2c20  ut is a Series, 
-0000a5e0: 7769 7468 206f 6e65 2072 6f77 2070 6572  with one row per
-0000a5f0: 2070 6172 7469 7469 6f6e 2e0a 2020 2020   partition..    
-0000a600: 2020 2020 2020 2020 2d20 5365 7269 6573          - Series
-0000a610: 3a20 496e 7075 7420 6973 2061 2044 6174  : Input is a Dat
-0000a620: 6146 7261 6d65 2c20 7769 7468 206f 6e65  aFrame, with one
-0000a630: 2072 6f77 2070 6572 2070 6172 7469 7469   row per partiti
-0000a640: 6f6e 2e20 436f 6c75 6d6e 730a 2020 2020  on. Columns.    
-0000a650: 2020 2020 2020 2020 2020 6172 6520 7468            are th
-0000a660: 6520 726f 7773 2069 6e20 7468 6520 6f75  e rows in the ou
-0000a670: 7470 7574 2073 6572 6965 732e 0a20 2020  tput series..   
-0000a680: 2020 2020 2020 2020 202d 2044 6174 6146           - DataF
-0000a690: 7261 6d65 3a20 496e 7075 7420 6973 2061  rame: Input is a
-0000a6a0: 2044 6174 6146 7261 6d65 2c20 7769 7468   DataFrame, with
-0000a6b0: 206f 6e65 2072 6f77 2070 6572 2070 6172   one row per par
-0000a6c0: 7469 7469 6f6e 2e0a 2020 2020 2020 2020  tition..        
-0000a6d0: 2020 2020 2020 436f 6c75 6d6e 7320 6172        Columns ar
-0000a6e0: 6520 7468 6520 636f 6c75 6d6e 7320 696e  e the columns in
-0000a6f0: 2074 6865 206f 7574 7075 7420 6461 7461   the output data
-0000a700: 6672 616d 6573 2e0a 0a20 2020 2020 2020  frames...       
-0000a710: 2020 2020 2053 686f 756c 6420 7265 7475       Should retu
-0000a720: 726e 2061 2060 6070 616e 6461 732e 4461  rn a ``pandas.Da
-0000a730: 7461 4672 616d 6560 602c 2060 6070 616e  taFrame``, ``pan
-0000a740: 6461 732e 5365 7269 6573 6060 2c20 6f72  das.Series``, or
-0000a750: 2061 0a20 2020 2020 2020 2020 2020 2073   a.            s
-0000a760: 6361 6c61 722e 0a20 2020 2020 2020 2063  calar..        c
-0000a770: 6f6d 6269 6e65 203a 2063 616c 6c61 626c  ombine : callabl
-0000a780: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
-0000a790: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
-0000a7a0: 2074 6f20 6f70 6572 6174 6520 6f6e 2069   to operate on i
-0000a7b0: 6e74 6572 6d65 6469 6174 6520 636f 6e63  ntermediate conc
-0000a7c0: 6174 656e 6174 6564 2072 6573 756c 7473  atenated results
-0000a7d0: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
-0000a7e0: 6060 6368 756e 6b60 6020 696e 2061 2074  ``chunk`` in a t
-0000a7f0: 7265 652d 7265 6475 6374 696f 6e2e 2049  ree-reduction. I
-0000a800: 6620 6e6f 7420 7072 6f76 6964 6564 2c20  f not provided, 
-0000a810: 6465 6661 756c 7473 2074 6f0a 2020 2020  defaults to.    
-0000a820: 2020 2020 2020 2020 6060 6167 6772 6567          ``aggreg
-0000a830: 6174 6560 602e 2054 6865 2069 6e70 7574  ate``. The input
-0000a840: 2f6f 7574 7075 7420 7265 7175 6972 656d  /output requirem
-0000a850: 656e 7473 2073 686f 756c 6420 6d61 7463  ents should matc
-0000a860: 6820 7468 6174 206f 660a 2020 2020 2020  h that of.      
-0000a870: 2020 2020 2020 6060 6167 6772 6567 6174        ``aggregat
-0000a880: 6560 6020 6465 7363 7269 6265 6420 6162  e`` described ab
-0000a890: 6f76 652e 0a20 2020 2020 2020 2024 4d45  ove..        $ME
-0000a8a0: 5441 0a20 2020 2020 2020 2074 6f6b 656e  TA.        token
-0000a8b0: 203a 2073 7472 2c20 6f70 7469 6f6e 616c   : str, optional
-0000a8c0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-0000a8d0: 206e 616d 6520 746f 2075 7365 2066 6f72   name to use for
-0000a8e0: 2074 6865 206f 7574 7075 7420 6b65 7973   the output keys
-0000a8f0: 2e0a 2020 2020 2020 2020 7370 6c69 745f  ..        split_
-0000a900: 6576 6572 7920 3a20 696e 742c 206f 7074  every : int, opt
-0000a910: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0000a920: 2020 4772 6f75 7020 7061 7274 6974 696f    Group partitio
-0000a930: 6e73 2069 6e74 6f20 6772 6f75 7073 206f  ns into groups o
-0000a940: 6620 7468 6973 2073 697a 6520 7768 696c  f this size whil
-0000a950: 6520 7065 7266 6f72 6d69 6e67 2061 0a20  e performing a. 
-0000a960: 2020 2020 2020 2020 2020 2074 7265 652d             tree-
-0000a970: 7265 6475 6374 696f 6e2e 2049 6620 7365  reduction. If se
-0000a980: 7420 746f 2046 616c 7365 2c20 6e6f 2074  t to False, no t
-0000a990: 7265 652d 7265 6475 6374 696f 6e20 7769  ree-reduction wi
-0000a9a0: 6c6c 2062 6520 7573 6564 2c0a 2020 2020  ll be used,.    
-0000a9b0: 2020 2020 2020 2020 616e 6420 616c 6c20          and all 
-0000a9c0: 696e 7465 726d 6564 6961 7465 7320 7769  intermediates wi
-0000a9d0: 6c6c 2062 6520 636f 6e63 6174 656e 6174  ll be concatenat
-0000a9e0: 6564 2061 6e64 2070 6173 7365 6420 746f  ed and passed to
-0000a9f0: 0a20 2020 2020 2020 2020 2020 2060 6061  .            ``a
-0000aa00: 6767 7265 6761 7465 6060 2e20 4465 6661  ggregate``. Defa
-0000aa10: 756c 7420 6973 2038 2e0a 2020 2020 2020  ult is 8..      
-0000aa20: 2020 6368 756e 6b5f 6b77 6172 6773 203a    chunk_kwargs :
-0000aa30: 2064 6963 742c 206f 7074 696f 6e61 6c0a   dict, optional.
-0000aa40: 2020 2020 2020 2020 2020 2020 4b65 7977              Keyw
-0000aa50: 6f72 6420 6172 6775 6d65 6e74 7320 746f  ord arguments to
-0000aa60: 2070 6173 7320 6f6e 2074 6f20 6060 6368   pass on to ``ch
-0000aa70: 756e 6b60 6020 6f6e 6c79 2e0a 2020 2020  unk`` only..    
-0000aa80: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
-0000aa90: 6172 6773 203a 2064 6963 742c 206f 7074  args : dict, opt
-0000aaa0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0000aab0: 2020 4b65 7977 6f72 6420 6172 6775 6d65    Keyword argume
-0000aac0: 6e74 7320 746f 2070 6173 7320 6f6e 2074  nts to pass on t
-0000aad0: 6f20 6060 6167 6772 6567 6174 6560 6020  o ``aggregate`` 
-0000aae0: 6f6e 6c79 2e0a 2020 2020 2020 2020 636f  only..        co
-0000aaf0: 6d62 696e 655f 6b77 6172 6773 203a 2064  mbine_kwargs : d
-0000ab00: 6963 742c 206f 7074 696f 6e61 6c0a 2020  ict, optional.  
-0000ab10: 2020 2020 2020 2020 2020 4b65 7977 6f72            Keywor
-0000ab20: 6420 6172 6775 6d65 6e74 7320 746f 2070  d arguments to p
-0000ab30: 6173 7320 6f6e 2074 6f20 6060 636f 6d62  ass on to ``comb
-0000ab40: 696e 6560 6020 6f6e 6c79 2e0a 2020 2020  ine`` only..    
-0000ab50: 2020 2020 6b77 6172 6773 203a 0a20 2020      kwargs :.   
-0000ab60: 2020 2020 2020 2020 2041 6c6c 2072 656d           All rem
-0000ab70: 6169 6e69 6e67 206b 6579 776f 7264 7320  aining keywords 
-0000ab80: 7769 6c6c 2062 6520 7061 7373 6564 2074  will be passed t
-0000ab90: 6f20 6060 6368 756e 6b60 602c 2060 6063  o ``chunk``, ``c
-0000aba0: 6f6d 6269 6e65 6060 2c0a 2020 2020 2020  ombine``,.      
-0000abb0: 2020 2020 2020 616e 6420 6060 6167 6772        and ``aggr
-0000abc0: 6567 6174 6560 602e 0a0a 2020 2020 2020  egate``...      
-0000abd0: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
-0000abe0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-0000abf0: 2020 2020 3e3e 3e20 696d 706f 7274 2070      >>> import p
-0000ac00: 616e 6461 7320 6173 2070 640a 2020 2020  andas as pd.    
-0000ac10: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
-0000ac20: 6173 6b2e 6461 7461 6672 616d 6520 6173  ask.dataframe as
-0000ac30: 2064 640a 2020 2020 2020 2020 3e3e 3e20   dd.        >>> 
-0000ac40: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-0000ac50: 6528 7b27 7827 3a20 7261 6e67 6528 3530  e({'x': range(50
-0000ac60: 292c 2027 7927 3a20 7261 6e67 6528 3530  ), 'y': range(50
-0000ac70: 2c20 3130 3029 7d29 0a20 2020 2020 2020  , 100)}).       
-0000ac80: 203e 3e3e 2064 6466 203d 2064 642e 6672   >>> ddf = dd.fr
-0000ac90: 6f6d 5f70 616e 6461 7328 6466 2c20 6e70  om_pandas(df, np
-0000aca0: 6172 7469 7469 6f6e 733d 3429 0a0a 2020  artitions=4)..  
-0000acb0: 2020 2020 2020 436f 756e 7420 7468 6520        Count the 
-0000acc0: 6e75 6d62 6572 206f 6620 726f 7773 2069  number of rows i
-0000acd0: 6e20 6120 4461 7461 4672 616d 652e 2054  n a DataFrame. T
-0000ace0: 6f20 646f 2074 6869 732c 2063 6f75 6e74  o do this, count
-0000acf0: 2074 6865 206e 756d 6265 720a 2020 2020   the number.    
-0000ad00: 2020 2020 6f66 2072 6f77 7320 696e 2065      of rows in e
-0000ad10: 6163 6820 7061 7274 6974 696f 6e2c 2074  ach partition, t
-0000ad20: 6865 6e20 7375 6d20 7468 6520 7265 7375  hen sum the resu
-0000ad30: 6c74 733a 0a0a 2020 2020 2020 2020 3e3e  lts:..        >>
-0000ad40: 3e20 7265 7320 3d20 6464 662e 7265 6475  > res = ddf.redu
-0000ad50: 6374 696f 6e28 6c61 6d62 6461 2078 3a20  ction(lambda x: 
-0000ad60: 782e 636f 756e 7428 292c 0a20 2020 2020  x.count(),.     
-0000ad70: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-0000ad80: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
-0000ad90: 6761 7465 3d6c 616d 6264 6120 783a 2078  gate=lambda x: x
-0000ada0: 2e73 756d 2829 290a 2020 2020 2020 2020  .sum()).        
-0000adb0: 3e3e 3e20 7265 732e 636f 6d70 7574 6528  >>> res.compute(
-0000adc0: 290a 2020 2020 2020 2020 7820 2020 2035  ).        x    5
-0000add0: 300a 2020 2020 2020 2020 7920 2020 2035  0.        y    5
-0000ade0: 300a 2020 2020 2020 2020 6474 7970 653a  0.        dtype:
-0000adf0: 2069 6e74 3634 0a0a 2020 2020 2020 2020   int64..        
-0000ae00: 436f 756e 7420 7468 6520 6e75 6d62 6572  Count the number
-0000ae10: 206f 6620 726f 7773 2069 6e20 6120 5365   of rows in a Se
-0000ae20: 7269 6573 2077 6974 6820 656c 656d 656e  ries with elemen
-0000ae30: 7473 2067 7265 6174 6572 2074 6861 6e20  ts greater than 
-0000ae40: 6f72 0a20 2020 2020 2020 2065 7175 616c  or.        equal
-0000ae50: 2074 6f20 6120 7661 6c75 6520 2870 726f   to a value (pro
-0000ae60: 7669 6465 6420 7669 6120 6120 6b65 7977  vided via a keyw
-0000ae70: 6f72 6429 2e0a 0a20 2020 2020 2020 203e  ord)...        >
-0000ae80: 3e3e 2064 6566 2063 6f75 6e74 5f67 7265  >> def count_gre
-0000ae90: 6174 6572 2878 2c20 7661 6c75 653d 3029  ater(x, value=0)
-0000aea0: 3a0a 2020 2020 2020 2020 2e2e 2e20 2020  :.        ...   
-0000aeb0: 2020 7265 7475 726e 2028 7820 3e3d 2076    return (x >= v
-0000aec0: 616c 7565 292e 7375 6d28 290a 2020 2020  alue).sum().    
-0000aed0: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
-0000aee0: 662e 782e 7265 6475 6374 696f 6e28 636f  f.x.reduction(co
-0000aef0: 756e 745f 6772 6561 7465 722c 2061 6767  unt_greater, agg
-0000af00: 7265 6761 7465 3d6c 616d 6264 6120 783a  regate=lambda x:
-0000af10: 2078 2e73 756d 2829 2c0a 2020 2020 2020   x.sum(),.      
-0000af20: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-0000af30: 2020 2020 2020 2020 2020 2020 6368 756e              chun
-0000af40: 6b5f 6b77 6172 6773 3d7b 2776 616c 7565  k_kwargs={'value
-0000af50: 273a 2032 357d 290a 2020 2020 2020 2020  ': 25}).        
-0000af60: 3e3e 3e20 7265 732e 636f 6d70 7574 6528  >>> res.compute(
-0000af70: 290a 2020 2020 2020 2020 3235 0a0a 2020  ).        25..  
-0000af80: 2020 2020 2020 4167 6772 6567 6174 6520        Aggregate 
-0000af90: 626f 7468 2074 6865 2073 756d 2061 6e64  both the sum and
-0000afa0: 2063 6f75 6e74 206f 6620 6120 5365 7269   count of a Seri
-0000afb0: 6573 2061 7420 7468 6520 7361 6d65 2074  es at the same t
-0000afc0: 696d 653a 0a0a 2020 2020 2020 2020 3e3e  ime:..        >>
-0000afd0: 3e20 6465 6620 7375 6d5f 616e 645f 636f  > def sum_and_co
-0000afe0: 756e 7428 7829 3a0a 2020 2020 2020 2020  unt(x):.        
-0000aff0: 2e2e 2e20 2020 2020 7265 7475 726e 2070  ...     return p
-0000b000: 642e 5365 7269 6573 287b 2763 6f75 6e74  d.Series({'count
-0000b010: 273a 2078 2e63 6f75 6e74 2829 2c20 2773  ': x.count(), 's
-0000b020: 756d 273a 2078 2e73 756d 2829 7d2c 0a20  um': x.sum()},. 
-0000b030: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-0000b040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b050: 696e 6465 783d 5b27 636f 756e 7427 2c20  index=['count', 
-0000b060: 2773 756d 275d 290a 2020 2020 2020 2020  'sum']).        
-0000b070: 3e3e 3e20 7265 7320 3d20 6464 662e 782e  >>> res = ddf.x.
-0000b080: 7265 6475 6374 696f 6e28 7375 6d5f 616e  reduction(sum_an
-0000b090: 645f 636f 756e 742c 2061 6767 7265 6761  d_count, aggrega
-0000b0a0: 7465 3d6c 616d 6264 6120 783a 2078 2e73  te=lambda x: x.s
-0000b0b0: 756d 2829 290a 2020 2020 2020 2020 3e3e  um()).        >>
-0000b0c0: 3e20 7265 732e 636f 6d70 7574 6528 290a  > res.compute().
-0000b0d0: 2020 2020 2020 2020 636f 756e 7420 2020          count   
-0000b0e0: 2020 2035 300a 2020 2020 2020 2020 7375     50.        su
-0000b0f0: 6d20 2020 2020 2031 3232 350a 2020 2020  m      1225.    
-0000b100: 2020 2020 6474 7970 653a 2069 6e74 3634      dtype: int64
-0000b110: 0a0a 2020 2020 2020 2020 446f 696e 6720  ..        Doing 
-0000b120: 7468 6520 7361 6d65 2c20 6275 7420 666f  the same, but fo
-0000b130: 7220 6120 4461 7461 4672 616d 652e 2048  r a DataFrame. H
-0000b140: 6572 6520 6060 6368 756e 6b60 6020 7265  ere ``chunk`` re
-0000b150: 7475 726e 7320 610a 2020 2020 2020 2020  turns a.        
-0000b160: 4461 7461 4672 616d 652c 206d 6561 6e69  DataFrame, meani
-0000b170: 6e67 2074 6865 2069 6e70 7574 2074 6f20  ng the input to 
-0000b180: 6060 6167 6772 6567 6174 6560 6020 6973  ``aggregate`` is
-0000b190: 2061 2044 6174 6146 7261 6d65 2077 6974   a DataFrame wit
-0000b1a0: 6820 616e 0a20 2020 2020 2020 2069 6e64  h an.        ind
-0000b1b0: 6578 2077 6974 6820 6e6f 6e2d 756e 6971  ex with non-uniq
-0000b1c0: 7565 2065 6e74 7269 6573 2066 6f72 2062  ue entries for b
-0000b1d0: 6f74 6820 2778 2720 616e 6420 2779 272e  oth 'x' and 'y'.
-0000b1e0: 2057 6520 6772 6f75 7062 7920 7468 650a   We groupby the.
-0000b1f0: 2020 2020 2020 2020 696e 6465 782c 2061          index, a
-0000b200: 6e64 2073 756d 2065 6163 6820 6772 6f75  nd sum each grou
-0000b210: 7020 746f 2067 6574 2074 6865 2066 696e  p to get the fin
-0000b220: 616c 2072 6573 756c 742e 0a0a 2020 2020  al result...    
-0000b230: 2020 2020 3e3e 3e20 6465 6620 7375 6d5f      >>> def sum_
-0000b240: 616e 645f 636f 756e 7428 7829 3a0a 2020  and_count(x):.  
-0000b250: 2020 2020 2020 2e2e 2e20 2020 2020 7265        ...     re
-0000b260: 7475 726e 2070 642e 4461 7461 4672 616d  turn pd.DataFram
-0000b270: 6528 7b27 636f 756e 7427 3a20 782e 636f  e({'count': x.co
-0000b280: 756e 7428 292c 2027 7375 6d27 3a20 782e  unt(), 'sum': x.
-0000b290: 7375 6d28 297d 2c0a 2020 2020 2020 2020  sum()},.        
-0000b2a0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-0000b2b0: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-0000b2c0: 6d6e 733d 5b27 636f 756e 7427 2c20 2773  mns=['count', 's
-0000b2d0: 756d 275d 290a 2020 2020 2020 2020 3e3e  um']).        >>
-0000b2e0: 3e20 7265 7320 3d20 6464 662e 7265 6475  > res = ddf.redu
-0000b2f0: 6374 696f 6e28 7375 6d5f 616e 645f 636f  ction(sum_and_co
-0000b300: 756e 742c 0a20 2020 2020 2020 202e 2e2e  unt,.        ...
-0000b310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b320: 2020 2020 2061 6767 7265 6761 7465 3d6c       aggregate=l
-0000b330: 616d 6264 6120 783a 2078 2e67 726f 7570  ambda x: x.group
-0000b340: 6279 286c 6576 656c 3d30 292e 7375 6d28  by(level=0).sum(
-0000b350: 2929 0a20 2020 2020 2020 203e 3e3e 2072  )).        >>> r
-0000b360: 6573 2e63 6f6d 7075 7465 2829 0a20 2020  es.compute().   
-0000b370: 2020 2020 2020 2020 636f 756e 7420 2020          count   
-0000b380: 7375 6d0a 2020 2020 2020 2020 7820 2020  sum.        x   
-0000b390: 2020 3530 2020 3132 3235 0a20 2020 2020    50  1225.     
-0000b3a0: 2020 2079 2020 2020 2035 3020 2033 3732     y     50  372
-0000b3b0: 350a 2020 2020 2020 2020 2222 220a 2020  5.        """.  
-0000b3c0: 2020 2020 2020 6966 2061 6767 7265 6761        if aggrega
-0000b3d0: 7465 2069 7320 4e6f 6e65 3a0a 2020 2020  te is None:.    
-0000b3e0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-0000b3f0: 6520 3d20 6368 756e 6b0a 0a20 2020 2020  e = chunk..     
-0000b400: 2020 2069 6620 636f 6d62 696e 6520 6973     if combine is
-0000b410: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0000b420: 2020 2069 6620 636f 6d62 696e 655f 6b77     if combine_kw
-0000b430: 6172 6773 3a0a 2020 2020 2020 2020 2020  args:.          
-0000b440: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000b450: 6545 7272 6f72 2822 6063 6f6d 6269 6e65  eError("`combine
-0000b460: 5f6b 7761 7267 7360 2070 726f 7669 6465  _kwargs` provide
-0000b470: 6420 7769 7468 206e 6f20 6063 6f6d 6269  d with no `combi
-0000b480: 6e65 6022 290a 2020 2020 2020 2020 2020  ne`").          
-0000b490: 2020 636f 6d62 696e 6520 3d20 6167 6772    combine = aggr
-0000b4a0: 6567 6174 650a 2020 2020 2020 2020 2020  egate.          
-0000b4b0: 2020 636f 6d62 696e 655f 6b77 6172 6773    combine_kwargs
-0000b4c0: 203d 2061 6767 7265 6761 7465 5f6b 7761   = aggregate_kwa
-0000b4d0: 7267 730a 0a20 2020 2020 2020 2063 6875  rgs..        chu
-0000b4e0: 6e6b 5f6b 7761 7267 7320 3d20 6368 756e  nk_kwargs = chun
-0000b4f0: 6b5f 6b77 6172 6773 2e63 6f70 7928 2920  k_kwargs.copy() 
-0000b500: 6966 2063 6875 6e6b 5f6b 7761 7267 7320  if chunk_kwargs 
-0000b510: 656c 7365 207b 7d0a 2020 2020 2020 2020  else {}.        
-0000b520: 6368 756e 6b5f 6b77 6172 6773 5b22 6163  chunk_kwargs["ac
-0000b530: 615f 6368 756e 6b22 5d20 3d20 6368 756e  a_chunk"] = chun
-0000b540: 6b0a 0a20 2020 2020 2020 2063 6f6d 6269  k..        combi
-0000b550: 6e65 5f6b 7761 7267 7320 3d20 636f 6d62  ne_kwargs = comb
-0000b560: 696e 655f 6b77 6172 6773 2e63 6f70 7928  ine_kwargs.copy(
-0000b570: 2920 6966 2063 6f6d 6269 6e65 5f6b 7761  ) if combine_kwa
-0000b580: 7267 7320 656c 7365 207b 7d0a 2020 2020  rgs else {}.    
-0000b590: 2020 2020 636f 6d62 696e 655f 6b77 6172      combine_kwar
-0000b5a0: 6773 5b22 6163 615f 636f 6d62 696e 6522  gs["aca_combine"
-0000b5b0: 5d20 3d20 636f 6d62 696e 650a 0a20 2020  ] = combine..   
-0000b5c0: 2020 2020 2061 6767 7265 6761 7465 5f6b       aggregate_k
-0000b5d0: 7761 7267 7320 3d20 6167 6772 6567 6174  wargs = aggregat
-0000b5e0: 655f 6b77 6172 6773 2e63 6f70 7928 2920  e_kwargs.copy() 
-0000b5f0: 6966 2061 6767 7265 6761 7465 5f6b 7761  if aggregate_kwa
-0000b600: 7267 7320 656c 7365 207b 7d0a 2020 2020  rgs else {}.    
-0000b610: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
-0000b620: 6172 6773 5b22 6163 615f 6167 6772 6567  args["aca_aggreg
-0000b630: 6174 6522 5d20 3d20 6167 6772 6567 6174  ate"] = aggregat
-0000b640: 650a 0a20 2020 2020 2020 2072 6574 7572  e..        retur
-0000b650: 6e20 6163 6128 0a20 2020 2020 2020 2020  n aca(.         
-0000b660: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000b670: 2020 2020 2063 6875 6e6b 3d5f 7265 6475       chunk=_redu
-0000b680: 6374 696f 6e5f 6368 756e 6b2c 0a20 2020  ction_chunk,.   
-0000b690: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
-0000b6a0: 7465 3d5f 7265 6475 6374 696f 6e5f 6167  te=_reduction_ag
-0000b6b0: 6772 6567 6174 652c 0a20 2020 2020 2020  gregate,.       
-0000b6c0: 2020 2020 2063 6f6d 6269 6e65 3d5f 7265       combine=_re
-0000b6d0: 6475 6374 696f 6e5f 636f 6d62 696e 652c  duction_combine,
-0000b6e0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-0000b6f0: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
-0000b700: 2020 2020 746f 6b65 6e3d 746f 6b65 6e2c      token=token,
-0000b710: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-0000b720: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-0000b730: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
-0000b740: 2020 6368 756e 6b5f 6b77 6172 6773 3d63    chunk_kwargs=c
-0000b750: 6875 6e6b 5f6b 7761 7267 732c 0a20 2020  hunk_kwargs,.   
-0000b760: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
-0000b770: 7465 5f6b 7761 7267 733d 6167 6772 6567  te_kwargs=aggreg
-0000b780: 6174 655f 6b77 6172 6773 2c0a 2020 2020  ate_kwargs,.    
-0000b790: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
-0000b7a0: 6b77 6172 6773 3d63 6f6d 6269 6e65 5f6b  kwargs=combine_k
-0000b7b0: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
-0000b7c0: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
-0000b7d0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-0000b7e0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0000b7f0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-0000b800: 7069 7065 2873 656c 662c 2066 756e 632c  pipe(self, func,
-0000b810: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-0000b820: 293a 0a20 2020 2020 2020 2023 2054 616b  ):.        # Tak
-0000b830: 656e 2066 726f 6d20 7061 6e64 6173 3a0a  en from pandas:.
-0000b840: 2020 2020 2020 2020 2320 6874 7470 733a          # https:
-0000b850: 2f2f 6769 7468 7562 2e63 6f6d 2f70 7964  //github.com/pyd
-0000b860: 6174 612f 7061 6e64 6173 2f62 6c6f 622f  ata/pandas/blob/
-0000b870: 6d61 7374 6572 2f70 616e 6461 732f 636f  master/pandas/co
-0000b880: 7265 2f67 656e 6572 6963 2e70 7923 4c32  re/generic.py#L2
-0000b890: 3639 382d 4c32 3730 370a 2020 2020 2020  698-L2707.      
-0000b8a0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0000b8b0: 6675 6e63 2c20 7475 706c 6529 3a0a 2020  func, tuple):.  
-0000b8c0: 2020 2020 2020 2020 2020 6675 6e63 2c20            func, 
-0000b8d0: 7461 7267 6574 203d 2066 756e 630a 2020  target = func.  
-0000b8e0: 2020 2020 2020 2020 2020 6966 2074 6172            if tar
-0000b8f0: 6765 7420 696e 206b 7761 7267 733a 0a20  get in kwargs:. 
-0000b900: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000b910: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000b920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b930: 2020 2020 2022 2573 2069 7320 626f 7468       "%s is both
-0000b940: 2074 6865 2070 6970 6520 7461 7267 6574   the pipe target
-0000b950: 2061 6e64 2061 206b 6579 776f 7264 2061   and a keyword a
-0000b960: 7267 756d 656e 7422 2025 2074 6172 6765  rgument" % targe
-0000b970: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-0000b980: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000b990: 6b77 6172 6773 5b74 6172 6765 745d 203d  kwargs[target] =
-0000b9a0: 2073 656c 660a 2020 2020 2020 2020 2020   self.          
-0000b9b0: 2020 7265 7475 726e 2066 756e 6328 2a61    return func(*a
-0000b9c0: 7267 732c 202a 2a6b 7761 7267 7329 0a20  rgs, **kwargs). 
-0000b9d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000b9e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000b9f0: 6675 6e63 2873 656c 662c 202a 6172 6773  func(self, *args
-0000ba00: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
-0000ba10: 2064 6566 2072 616e 646f 6d5f 7370 6c69   def random_spli
-0000ba20: 7428 7365 6c66 2c20 6672 6163 2c20 7261  t(self, frac, ra
-0000ba30: 6e64 6f6d 5f73 7461 7465 3d4e 6f6e 652c  ndom_state=None,
-0000ba40: 2073 6875 6666 6c65 3d46 616c 7365 293a   shuffle=False):
-0000ba50: 0a20 2020 2020 2020 2022 2222 5073 6575  .        """Pseu
-0000ba60: 646f 7261 6e64 6f6d 6c79 2073 706c 6974  dorandomly split
-0000ba70: 2064 6174 6166 7261 6d65 2069 6e74 6f20   dataframe into 
-0000ba80: 6469 6666 6572 656e 7420 7069 6563 6573  different pieces
-0000ba90: 2072 6f77 2d77 6973 650a 0a20 2020 2020   row-wise..     
-0000baa0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0000bab0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0000bac0: 0a20 2020 2020 2020 2066 7261 6320 3a20  .        frac : 
-0000bad0: 6c69 7374 0a20 2020 2020 2020 2020 2020  list.           
-0000bae0: 204c 6973 7420 6f66 2066 6c6f 6174 7320   List of floats 
-0000baf0: 7468 6174 2073 686f 756c 6420 7375 6d20  that should sum 
-0000bb00: 746f 206f 6e65 2e0a 2020 2020 2020 2020  to one..        
-0000bb10: 7261 6e64 6f6d 5f73 7461 7465 203a 2069  random_state : i
-0000bb20: 6e74 206f 7220 6e70 2e72 616e 646f 6d2e  nt or np.random.
-0000bb30: 5261 6e64 6f6d 5374 6174 650a 2020 2020  RandomState.    
-0000bb40: 2020 2020 2020 2020 4966 2069 6e74 2063          If int c
-0000bb50: 7265 6174 6520 6120 6e65 7720 5261 6e64  reate a new Rand
-0000bb60: 6f6d 5374 6174 6520 7769 7468 2074 6869  omState with thi
-0000bb70: 7320 6173 2074 6865 2073 6565 642e 0a20  s as the seed.. 
-0000bb80: 2020 2020 2020 2020 2020 204f 7468 6572             Other
-0000bb90: 7769 7365 2064 7261 7720 6672 6f6d 2074  wise draw from t
-0000bba0: 6865 2070 6173 7365 6420 5261 6e64 6f6d  he passed Random
-0000bbb0: 5374 6174 652e 0a20 2020 2020 2020 2073  State..        s
-0000bbc0: 6875 6666 6c65 203a 2062 6f6f 6c2c 2064  huffle : bool, d
-0000bbd0: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
-0000bbe0: 2020 2020 2020 2020 2049 6620 7365 7420           If set 
-0000bbf0: 746f 2054 7275 652c 2074 6865 2064 6174  to True, the dat
-0000bc00: 6166 7261 6d65 2069 7320 7368 7566 666c  aframe is shuffl
-0000bc10: 6564 2028 7769 7468 696e 2070 6172 7469  ed (within parti
-0000bc20: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
-0000bc30: 2020 6265 666f 7265 2074 6865 2073 706c    before the spl
-0000bc40: 6974 2e0a 0a20 2020 2020 2020 2045 7861  it...        Exa
-0000bc50: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-0000bc60: 2d2d 2d2d 2d2d 0a0a 2020 2020 2020 2020  ------..        
-0000bc70: 3530 2f35 3020 7370 6c69 740a 0a20 2020  50/50 split..   
-0000bc80: 2020 2020 203e 3e3e 2061 2c20 6220 3d20       >>> a, b = 
-0000bc90: 6466 2e72 616e 646f 6d5f 7370 6c69 7428  df.random_split(
-0000bca0: 5b30 2e35 2c20 302e 355d 2920 2023 2064  [0.5, 0.5])  # d
-0000bcb0: 6f63 7465 7374 3a20 2b53 4b49 500a 0a20  octest: +SKIP.. 
-0000bcc0: 2020 2020 2020 2038 302f 3130 2f31 3020         80/10/10 
-0000bcd0: 7370 6c69 742c 2063 6f6e 7369 7374 656e  split, consisten
-0000bce0: 7420 7261 6e64 6f6d 5f73 7461 7465 0a0a  t random_state..
-0000bcf0: 2020 2020 2020 2020 3e3e 3e20 612c 2062          >>> a, b
-0000bd00: 2c20 6320 3d20 6466 2e72 616e 646f 6d5f  , c = df.random_
-0000bd10: 7370 6c69 7428 5b30 2e38 2c20 302e 312c  split([0.8, 0.1,
-0000bd20: 2030 2e31 5d2c 2072 616e 646f 6d5f 7374   0.1], random_st
-0000bd30: 6174 653d 3132 3329 2020 2320 646f 6374  ate=123)  # doct
-0000bd40: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
-0000bd50: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-0000bd60: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-0000bd70: 2020 2020 2020 6461 736b 2e44 6174 6146        dask.DataF
-0000bd80: 7261 6d65 2e73 616d 706c 650a 2020 2020  rame.sample.    
-0000bd90: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000bda0: 6966 206e 6f74 206e 702e 616c 6c63 6c6f  if not np.allclo
-0000bdb0: 7365 2873 756d 2866 7261 6329 2c20 3129  se(sum(frac), 1)
-0000bdc0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000bdd0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-0000bde0: 6672 6163 2073 686f 756c 6420 7375 6d20  frac should sum 
-0000bdf0: 746f 2031 2229 0a20 2020 2020 2020 2073  to 1").        s
-0000be00: 7461 7465 5f64 6174 6120 3d20 7261 6e64  tate_data = rand
-0000be10: 6f6d 5f73 7461 7465 5f64 6174 6128 7365  om_state_data(se
-0000be20: 6c66 2e6e 7061 7274 6974 696f 6e73 2c20  lf.npartitions, 
-0000be30: 7261 6e64 6f6d 5f73 7461 7465 290a 2020  random_state).  
-0000be40: 2020 2020 2020 746f 6b65 6e20 3d20 746f        token = to
-0000be50: 6b65 6e69 7a65 2873 656c 662c 2066 7261  kenize(self, fra
-0000be60: 632c 2072 616e 646f 6d5f 7374 6174 6529  c, random_state)
-0000be70: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
-0000be80: 2273 706c 6974 2d22 202b 2074 6f6b 656e  "split-" + token
-0000be90: 0a20 2020 2020 2020 206c 6179 6572 203d  .        layer =
-0000bea0: 207b 0a20 2020 2020 2020 2020 2020 2028   {.            (
-0000beb0: 6e61 6d65 2c20 6929 3a20 2870 645f 7370  name, i): (pd_sp
-0000bec0: 6c69 742c 2028 7365 6c66 2e5f 6e61 6d65  lit, (self._name
-0000bed0: 2c20 6929 2c20 6672 6163 2c20 7374 6174  , i), frac, stat
-0000bee0: 652c 2073 6875 6666 6c65 290a 2020 2020  e, shuffle).    
-0000bef0: 2020 2020 2020 2020 666f 7220 692c 2073          for i, s
-0000bf00: 7461 7465 2069 6e20 656e 756d 6572 6174  tate in enumerat
-0000bf10: 6528 7374 6174 655f 6461 7461 290a 2020  e(state_data).  
-0000bf20: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
-0000bf30: 206f 7574 203d 205b 5d0a 2020 2020 2020   out = [].      
-0000bf40: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-0000bf50: 286c 656e 2866 7261 6329 293a 0a20 2020  (len(frac)):.   
-0000bf60: 2020 2020 2020 2020 206e 616d 6532 203d           name2 =
-0000bf70: 2022 7370 6c69 742d 2564 2d25 7322 2025   "split-%d-%s" %
-0000bf80: 2028 692c 2074 6f6b 656e 290a 2020 2020   (i, token).    
-0000bf90: 2020 2020 2020 2020 6473 6b32 203d 207b          dsk2 = {
-0000bfa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bfb0: 2028 6e61 6d65 322c 206a 293a 2028 6765   (name2, j): (ge
-0000bfc0: 7469 7465 6d2c 2028 6e61 6d65 2c20 6a29  titem, (name, j)
-0000bfd0: 2c20 6929 2066 6f72 206a 2069 6e20 7261  , i) for j in ra
-0000bfe0: 6e67 6528 7365 6c66 2e6e 7061 7274 6974  nge(self.npartit
-0000bff0: 696f 6e73 290a 2020 2020 2020 2020 2020  ions).          
-0000c000: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-0000c010: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
-0000c020: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
-0000c030: 6563 7469 6f6e 7328 0a20 2020 2020 2020  ections(.       
-0000c040: 2020 2020 2020 2020 206e 616d 6532 2c20           name2, 
-0000c050: 6d65 7267 6528 6473 6b32 2c20 6c61 7965  merge(dsk2, laye
-0000c060: 7229 2c20 6465 7065 6e64 656e 6369 6573  r), dependencies
-0000c070: 3d5b 7365 6c66 5d0a 2020 2020 2020 2020  =[self].        
-0000c080: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000c090: 2020 6f75 745f 6466 203d 2074 7970 6528    out_df = type(
-0000c0a0: 7365 6c66 2928 6772 6170 682c 206e 616d  self)(graph, nam
-0000c0b0: 6532 2c20 7365 6c66 2e5f 6d65 7461 2c20  e2, self._meta, 
-0000c0c0: 7365 6c66 2e64 6976 6973 696f 6e73 290a  self.divisions).
-0000c0d0: 2020 2020 2020 2020 2020 2020 6f75 742e              out.
-0000c0e0: 6170 7065 6e64 286f 7574 5f64 6629 0a20  append(out_df). 
-0000c0f0: 2020 2020 2020 2072 6574 7572 6e20 6f75         return ou
-0000c100: 740a 0a20 2020 2064 6566 2068 6561 6428  t..    def head(
-0000c110: 7365 6c66 2c20 6e3d 352c 206e 7061 7274  self, n=5, npart
-0000c120: 6974 696f 6e73 3d31 2c20 636f 6d70 7574  itions=1, comput
-0000c130: 653d 5472 7565 293a 0a20 2020 2020 2020  e=True):.       
-0000c140: 2022 2222 4669 7273 7420 6e20 726f 7773   """First n rows
-0000c150: 206f 6620 7468 6520 6461 7461 7365 740a   of the dataset.
-0000c160: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0000c170: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-0000c180: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
-0000c190: 203a 2069 6e74 2c20 6f70 7469 6f6e 616c   : int, optional
-0000c1a0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-0000c1b0: 206e 756d 6265 7220 6f66 2072 6f77 7320   number of rows 
-0000c1c0: 746f 2072 6574 7572 6e2e 2044 6566 6175  to return. Defau
-0000c1d0: 6c74 2069 7320 352e 0a20 2020 2020 2020  lt is 5..       
-0000c1e0: 206e 7061 7274 6974 696f 6e73 203a 2069   npartitions : i
-0000c1f0: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
-0000c200: 2020 2020 2020 2020 2045 6c65 6d65 6e74           Element
-0000c210: 7320 6172 6520 6f6e 6c79 2074 616b 656e  s are only taken
-0000c220: 2066 726f 6d20 7468 6520 6669 7273 7420   from the first 
-0000c230: 6060 6e70 6172 7469 7469 6f6e 7360 602c  ``npartitions``,
-0000c240: 2077 6974 6820 610a 2020 2020 2020 2020   with a.        
-0000c250: 2020 2020 6465 6661 756c 7420 6f66 2031      default of 1
-0000c260: 2e20 4966 2074 6865 7265 2061 7265 2066  . If there are f
-0000c270: 6577 6572 2074 6861 6e20 6060 6e60 6020  ewer than ``n`` 
-0000c280: 726f 7773 2069 6e20 7468 6520 6669 7273  rows in the firs
-0000c290: 740a 2020 2020 2020 2020 2020 2020 6060  t.            ``
-0000c2a0: 6e70 6172 7469 7469 6f6e 7360 6020 6120  npartitions`` a 
-0000c2b0: 7761 726e 696e 6720 7769 6c6c 2062 6520  warning will be 
-0000c2c0: 7261 6973 6564 2061 6e64 2061 6e79 2066  raised and any f
-0000c2d0: 6f75 6e64 2072 6f77 730a 2020 2020 2020  ound rows.      
-0000c2e0: 2020 2020 2020 7265 7475 726e 6564 2e20        returned. 
-0000c2f0: 5061 7373 202d 3120 746f 2075 7365 2061  Pass -1 to use a
-0000c300: 6c6c 2070 6172 7469 7469 6f6e 732e 0a20  ll partitions.. 
-0000c310: 2020 2020 2020 2063 6f6d 7075 7465 203a         compute :
-0000c320: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
-0000c330: 2020 2020 2020 2020 2020 2020 5768 6574              Whet
-0000c340: 6865 7220 746f 2063 6f6d 7075 7465 2074  her to compute t
-0000c350: 6865 2072 6573 756c 742c 2064 6566 6175  he result, defau
-0000c360: 6c74 2069 7320 5472 7565 2e0a 2020 2020  lt is True..    
-0000c370: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000c380: 6966 206e 7061 7274 6974 696f 6e73 203c  if npartitions <
-0000c390: 3d20 2d31 3a0a 2020 2020 2020 2020 2020  = -1:.          
-0000c3a0: 2020 6e70 6172 7469 7469 6f6e 7320 3d20    npartitions = 
-0000c3b0: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-0000c3c0: 0a20 2020 2020 2020 2023 204e 6f20 6e65  .        # No ne
-0000c3d0: 6564 2074 6f20 7761 726e 2069 6620 7765  ed to warn if we
-0000c3e0: 2772 6520 616c 7265 6164 7920 6c6f 6f6b  're already look
-0000c3f0: 696e 6720 6174 2061 6c6c 2070 6172 7469  ing at all parti
-0000c400: 7469 6f6e 730a 2020 2020 2020 2020 7361  tions.        sa
-0000c410: 6665 203d 206e 7061 7274 6974 696f 6e73  fe = npartitions
-0000c420: 2021 3d20 7365 6c66 2e6e 7061 7274 6974   != self.npartit
-0000c430: 696f 6e73 0a20 2020 2020 2020 2072 6574  ions.        ret
-0000c440: 7572 6e20 7365 6c66 2e5f 6865 6164 286e  urn self._head(n
-0000c450: 3d6e 2c20 6e70 6172 7469 7469 6f6e 733d  =n, npartitions=
-0000c460: 6e70 6172 7469 7469 6f6e 732c 2063 6f6d  npartitions, com
-0000c470: 7075 7465 3d63 6f6d 7075 7465 2c20 7361  pute=compute, sa
-0000c480: 6665 3d73 6166 6529 0a0a 2020 2020 6465  fe=safe)..    de
-0000c490: 6620 5f68 6561 6428 7365 6c66 2c20 6e2c  f _head(self, n,
-0000c4a0: 206e 7061 7274 6974 696f 6e73 2c20 636f   npartitions, co
-0000c4b0: 6d70 7574 652c 2073 6166 6529 3a0a 2020  mpute, safe):.  
-0000c4c0: 2020 2020 2020 6966 206e 7061 7274 6974        if npartit
-0000c4d0: 696f 6e73 203c 3d20 2d31 3a0a 2020 2020  ions <= -1:.    
-0000c4e0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-0000c4f0: 6f6e 7320 3d20 7365 6c66 2e6e 7061 7274  ons = self.npart
-0000c500: 6974 696f 6e73 0a20 2020 2020 2020 2069  itions.        i
-0000c510: 6620 6e70 6172 7469 7469 6f6e 7320 3e20  f npartitions > 
-0000c520: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-0000c530: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000c540: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0000c550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c560: 6622 6f6e 6c79 207b 7365 6c66 2e6e 7061  f"only {self.npa
-0000c570: 7274 6974 696f 6e73 7d20 7061 7274 6974  rtitions} partit
-0000c580: 696f 6e73 2c20 6865 6164 2072 6563 6569  ions, head recei
-0000c590: 7665 6420 7b6e 7061 7274 6974 696f 6e73  ved {npartitions
-0000c5a0: 7d22 0a20 2020 2020 2020 2020 2020 2029  }".            )
-0000c5b0: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
-0000c5c0: 2066 2268 6561 642d 7b6e 7061 7274 6974   f"head-{npartit
-0000c5d0: 696f 6e73 7d2d 7b6e 7d2d 7b73 656c 662e  ions}-{n}-{self.
-0000c5e0: 5f6e 616d 657d 220a 2020 2020 2020 2020  _name}".        
-0000c5f0: 6966 2073 6166 653a 0a20 2020 2020 2020  if safe:.       
-0000c600: 2020 2020 2068 6561 6420 3d20 7361 6665       head = safe
-0000c610: 5f68 6561 640a 2020 2020 2020 2020 656c  _head.        el
-0000c620: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000c630: 6865 6164 203d 204d 2e68 6561 640a 0a20  head = M.head.. 
-0000c640: 2020 2020 2020 2069 6620 6e70 6172 7469         if nparti
-0000c650: 7469 6f6e 7320 3e20 313a 0a20 2020 2020  tions > 1:.     
-0000c660: 2020 2020 2020 206e 616d 655f 7020 3d20         name_p = 
-0000c670: 6622 6865 6164 2d70 6172 7469 616c 2d7b  f"head-partial-{
-0000c680: 6e7d 2d7b 7365 6c66 2e5f 6e61 6d65 7d22  n}-{self._name}"
-0000c690: 0a0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
-0000c6a0: 6b20 3d20 7b7d 0a20 2020 2020 2020 2020  k = {}.         
-0000c6b0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-0000c6c0: 6528 6e70 6172 7469 7469 6f6e 7329 3a0a  e(npartitions):.
-0000c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c6e0: 6473 6b5b 286e 616d 655f 702c 2069 295d  dsk[(name_p, i)]
-0000c6f0: 203d 2028 4d2e 6865 6164 2c20 2873 656c   = (M.head, (sel
-0000c700: 662e 5f6e 616d 652c 2069 292c 206e 290a  f._name, i), n).
-0000c710: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-0000c720: 6361 7420 3d20 285f 636f 6e63 6174 2c20  cat = (_concat, 
-0000c730: 5b28 6e61 6d65 5f70 2c20 6929 2066 6f72  [(name_p, i) for
-0000c740: 2069 2069 6e20 7261 6e67 6528 6e70 6172   i in range(npar
-0000c750: 7469 7469 6f6e 7329 5d29 0a20 2020 2020  titions)]).     
-0000c760: 2020 2020 2020 2064 736b 5b28 6e61 6d65         dsk[(name
-0000c770: 2c20 3029 5d20 3d20 2868 6561 642c 2063  , 0)] = (head, c
-0000c780: 6f6e 6361 742c 206e 290a 2020 2020 2020  oncat, n).      
-0000c790: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000c7a0: 2020 2020 6473 6b20 3d20 7b28 6e61 6d65      dsk = {(name
-0000c7b0: 2c20 3029 3a20 2868 6561 642c 2028 7365  , 0): (head, (se
-0000c7c0: 6c66 2e5f 6e61 6d65 2c20 3029 2c20 6e29  lf._name, 0), n)
-0000c7d0: 7d0a 0a20 2020 2020 2020 2067 7261 7068  }..        graph
-0000c7e0: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
-0000c7f0: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
-0000c800: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
-0000c810: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
-0000c820: 5d29 0a20 2020 2020 2020 2072 6573 756c  ]).        resul
-0000c830: 7420 3d20 6e65 775f 6464 5f6f 626a 6563  t = new_dd_objec
-0000c840: 7428 0a20 2020 2020 2020 2020 2020 2067  t(.            g
-0000c850: 7261 7068 2c20 6e61 6d65 2c20 7365 6c66  raph, name, self
-0000c860: 2e5f 6d65 7461 2c20 5b73 656c 662e 6469  ._meta, [self.di
-0000c870: 7669 7369 6f6e 735b 305d 2c20 7365 6c66  visions[0], self
-0000c880: 2e64 6976 6973 696f 6e73 5b6e 7061 7274  .divisions[npart
-0000c890: 6974 696f 6e73 5d5d 0a20 2020 2020 2020  itions]].       
-0000c8a0: 2029 0a0a 2020 2020 2020 2020 6966 2063   )..        if c
-0000c8b0: 6f6d 7075 7465 3a0a 2020 2020 2020 2020  ompute:.        
-0000c8c0: 2020 2020 7265 7375 6c74 203d 2072 6573      result = res
-0000c8d0: 756c 742e 636f 6d70 7574 6528 290a 2020  ult.compute().  
-0000c8e0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-0000c8f0: 756c 740a 0a20 2020 2064 6566 2074 6169  ult..    def tai
-0000c900: 6c28 7365 6c66 2c20 6e3d 352c 2063 6f6d  l(self, n=5, com
-0000c910: 7075 7465 3d54 7275 6529 3a0a 2020 2020  pute=True):.    
-0000c920: 2020 2020 2222 224c 6173 7420 6e20 726f      """Last n ro
-0000c930: 7773 206f 6620 7468 6520 6461 7461 7365  ws of the datase
-0000c940: 740a 0a20 2020 2020 2020 2043 6176 6561  t..        Cavea
-0000c950: 742c 2074 6865 206f 6e6c 7920 6368 6563  t, the only chec
-0000c960: 6b73 2074 6865 206c 6173 7420 6e20 726f  ks the last n ro
-0000c970: 7773 206f 6620 7468 6520 6c61 7374 2070  ws of the last p
-0000c980: 6172 7469 7469 6f6e 2e0a 2020 2020 2020  artition..      
-0000c990: 2020 2222 220a 2020 2020 2020 2020 6e61    """.        na
-0000c9a0: 6d65 203d 2022 7461 696c 2d25 642d 2573  me = "tail-%d-%s
-0000c9b0: 2220 2520 286e 2c20 7365 6c66 2e5f 6e61  " % (n, self._na
-0000c9c0: 6d65 290a 2020 2020 2020 2020 6473 6b20  me).        dsk 
-0000c9d0: 3d20 7b28 6e61 6d65 2c20 3029 3a20 284d  = {(name, 0): (M
-0000c9e0: 2e74 6169 6c2c 2028 7365 6c66 2e5f 6e61  .tail, (self._na
-0000c9f0: 6d65 2c20 7365 6c66 2e6e 7061 7274 6974  me, self.npartit
-0000ca00: 696f 6e73 202d 2031 292c 206e 297d 0a0a  ions - 1), n)}..
-0000ca10: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
-0000ca20: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-0000ca30: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-0000ca40: 6e61 6d65 2c20 6473 6b2c 2064 6570 656e  name, dsk, depen
-0000ca50: 6465 6e63 6965 733d 5b73 656c 665d 290a  dencies=[self]).
-0000ca60: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-0000ca70: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
-0000ca80: 7261 7068 2c20 6e61 6d65 2c20 7365 6c66  raph, name, self
-0000ca90: 2e5f 6d65 7461 2c20 7365 6c66 2e64 6976  ._meta, self.div
-0000caa0: 6973 696f 6e73 5b2d 323a 5d29 0a0a 2020  isions[-2:])..  
-0000cab0: 2020 2020 2020 6966 2063 6f6d 7075 7465        if compute
-0000cac0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0000cad0: 7375 6c74 203d 2072 6573 756c 742e 636f  sult = result.co
-0000cae0: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
-0000caf0: 7265 7475 726e 2072 6573 756c 740a 0a20  return result.. 
-0000cb00: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-0000cb10: 2064 6566 206c 6f63 2873 656c 6629 3a0a   def loc(self):.
-0000cb20: 2020 2020 2020 2020 2222 2250 7572 656c          """Purel
-0000cb30: 7920 6c61 6265 6c2d 6c6f 6361 7469 6f6e  y label-location
-0000cb40: 2062 6173 6564 2069 6e64 6578 6572 2066   based indexer f
-0000cb50: 6f72 2073 656c 6563 7469 6f6e 2062 7920  or selection by 
-0000cb60: 6c61 6265 6c2e 0a0a 2020 2020 2020 2020  label...        
-0000cb70: 3e3e 3e20 6466 2e6c 6f63 5b22 6222 5d20  >>> df.loc["b"] 
-0000cb80: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-0000cb90: 500a 2020 2020 2020 2020 3e3e 3e20 6466  P.        >>> df
-0000cba0: 2e6c 6f63 5b22 6222 3a22 6422 5d20 2023  .loc["b":"d"]  #
-0000cbb0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-0000cbc0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000cbd0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-0000cbe0: 7461 6672 616d 652e 696e 6465 7869 6e67  taframe.indexing
-0000cbf0: 2069 6d70 6f72 7420 5f4c 6f63 496e 6465   import _LocInde
-0000cc00: 7865 720a 0a20 2020 2020 2020 2072 6574  xer..        ret
-0000cc10: 7572 6e20 5f4c 6f63 496e 6465 7865 7228  urn _LocIndexer(
-0000cc20: 7365 6c66 290a 0a20 2020 2064 6566 205f  self)..    def _
-0000cc30: 7061 7274 6974 696f 6e73 2873 656c 662c  partitions(self,
-0000cc40: 2069 6e64 6578 293a 0a20 2020 2020 2020   index):.       
-0000cc50: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0000cc60: 6365 2869 6e64 6578 2c20 7475 706c 6529  ce(index, tuple)
-0000cc70: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-0000cc80: 6465 7820 3d20 2869 6e64 6578 2c29 0a20  dex = (index,). 
-0000cc90: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-0000cca0: 2e61 7272 6179 2e73 6c69 6369 6e67 2069  .array.slicing i
-0000ccb0: 6d70 6f72 7420 6e6f 726d 616c 697a 655f  mport normalize_
-0000ccc0: 696e 6465 780a 0a20 2020 2020 2020 2069  index..        i
-0000ccd0: 6e64 6578 203d 206e 6f72 6d61 6c69 7a65  ndex = normalize
-0000cce0: 5f69 6e64 6578 2869 6e64 6578 2c20 2873  _index(index, (s
-0000ccf0: 656c 662e 6e70 6172 7469 7469 6f6e 732c  elf.npartitions,
-0000cd00: 2929 0a20 2020 2020 2020 2069 6e64 6578  )).        index
-0000cd10: 203d 2074 7570 6c65 2873 6c69 6365 286b   = tuple(slice(k
-0000cd20: 2c20 6b20 2b20 3129 2069 6620 6973 696e  , k + 1) if isin
-0000cd30: 7374 616e 6365 286b 2c20 4e75 6d62 6572  stance(k, Number
-0000cd40: 2920 656c 7365 206b 2066 6f72 206b 2069  ) else k for k i
-0000cd50: 6e20 696e 6465 7829 0a20 2020 2020 2020  n index).       
-0000cd60: 206e 616d 6520 3d20 2262 6c6f 636b 732d   name = "blocks-
-0000cd70: 2220 2b20 746f 6b65 6e69 7a65 2873 656c  " + tokenize(sel
-0000cd80: 662c 2069 6e64 6578 290a 2020 2020 2020  f, index).      
-0000cd90: 2020 6e65 775f 6b65 7973 203d 206e 702e    new_keys = np.
-0000cda0: 6172 7261 7928 7365 6c66 2e5f 5f64 6173  array(self.__das
-0000cdb0: 6b5f 6b65 7973 5f5f 2829 2c20 6474 7970  k_keys__(), dtyp
-0000cdc0: 653d 6f62 6a65 6374 295b 696e 6465 785d  e=object)[index]
-0000cdd0: 2e74 6f6c 6973 7428 290a 0a20 2020 2020  .tolist()..     
-0000cde0: 2020 2064 6976 6973 696f 6e73 203d 205b     divisions = [
-0000cdf0: 7365 6c66 2e64 6976 6973 696f 6e73 5b69  self.divisions[i
-0000ce00: 5d20 666f 7220 5f2c 2069 2069 6e20 6e65  ] for _, i in ne
-0000ce10: 775f 6b65 7973 5d20 2b20 5b0a 2020 2020  w_keys] + [.    
-0000ce20: 2020 2020 2020 2020 7365 6c66 2e64 6976          self.div
-0000ce30: 6973 696f 6e73 5b6e 6577 5f6b 6579 735b  isions[new_keys[
-0000ce40: 2d31 5d5b 315d 202b 2031 5d0a 2020 2020  -1][1] + 1].    
-0000ce50: 2020 2020 5d0a 2020 2020 2020 2020 6473      ].        ds
-0000ce60: 6b20 3d20 7b28 6e61 6d65 2c20 6929 3a20  k = {(name, i): 
-0000ce70: 7475 706c 6528 6b65 7929 2066 6f72 2069  tuple(key) for i
-0000ce80: 2c20 6b65 7920 696e 2065 6e75 6d65 7261  , key in enumera
-0000ce90: 7465 286e 6577 5f6b 6579 7329 7d0a 0a20  te(new_keys)}.. 
-0000cea0: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
-0000ceb0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-0000cec0: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
-0000ced0: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
-0000cee0: 656e 6369 6573 3d5b 7365 6c66 5d29 0a20  encies=[self]). 
-0000cef0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-0000cf00: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
-0000cf10: 682c 206e 616d 652c 2073 656c 662e 5f6d  h, name, self._m
-0000cf20: 6574 612c 2064 6976 6973 696f 6e73 290a  eta, divisions).
-0000cf30: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0000cf40: 2020 2064 6566 2070 6172 7469 7469 6f6e     def partition
-0000cf50: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-0000cf60: 2022 2222 536c 6963 6520 6461 7461 6672   """Slice datafr
-0000cf70: 616d 6520 6279 2070 6172 7469 7469 6f6e  ame by partition
-0000cf80: 730a 0a20 2020 2020 2020 2054 6869 7320  s..        This 
-0000cf90: 616c 6c6f 7773 2070 6172 7469 7469 6f6e  allows partition
-0000cfa0: 7769 7365 2073 6c69 6369 6e67 206f 6620  wise slicing of 
-0000cfb0: 6120 4461 736b 2044 6174 6166 7261 6d65  a Dask Dataframe
-0000cfc0: 2e20 2059 6f75 2063 616e 2070 6572 666f  .  You can perfo
-0000cfd0: 726d 206e 6f72 6d61 6c0a 2020 2020 2020  rm normal.      
-0000cfe0: 2020 4e75 6d70 792d 7374 796c 6520 736c    Numpy-style sl
-0000cff0: 6963 696e 672c 2062 7574 206e 6f77 2072  icing, but now r
-0000d000: 6174 6865 7220 7468 616e 2073 6c69 6365  ather than slice
-0000d010: 2065 6c65 6d65 6e74 7320 6f66 2074 6865   elements of the
-0000d020: 2061 7272 6179 2079 6f75 0a20 2020 2020   array you.     
-0000d030: 2020 2073 6c69 6365 2061 6c6f 6e67 2070     slice along p
-0000d040: 6172 7469 7469 6f6e 7320 736f 2c20 666f  artitions so, fo
-0000d050: 7220 6578 616d 706c 652c 2060 6064 662e  r example, ``df.
-0000d060: 7061 7274 6974 696f 6e73 5b3a 355d 6060  partitions[:5]``
-0000d070: 2070 726f 6475 6365 7320 6120 6e65 770a   produces a new.
-0000d080: 2020 2020 2020 2020 4461 736b 2044 6174          Dask Dat
-0000d090: 6166 7261 6d65 206f 6620 7468 6520 6669  aframe of the fi
-0000d0a0: 7273 7420 6669 7665 2070 6172 7469 7469  rst five partiti
-0000d0b0: 6f6e 732e 2056 616c 6964 2069 6e64 6578  ons. Valid index
-0000d0c0: 6572 7320 6172 6520 696e 7465 6765 7273  ers are integers
-0000d0d0: 2c20 7365 7175 656e 6365 730a 2020 2020  , sequences.    
-0000d0e0: 2020 2020 6f66 2069 6e74 6567 6572 732c      of integers,
-0000d0f0: 2073 6c69 6365 732c 206f 7220 626f 6f6c   slices, or bool
-0000d100: 6561 6e20 6d61 736b 732e 0a0a 2020 2020  ean masks...    
-0000d110: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0000d120: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-0000d130: 2020 2020 2020 3e3e 3e20 6466 2e70 6172        >>> df.par
-0000d140: 7469 7469 6f6e 735b 305d 2020 2320 646f  titions[0]  # do
-0000d150: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
-0000d160: 2020 2020 203e 3e3e 2064 662e 7061 7274       >>> df.part
-0000d170: 6974 696f 6e73 5b3a 335d 2020 2320 646f  itions[:3]  # do
-0000d180: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
-0000d190: 2020 2020 203e 3e3e 2064 662e 7061 7274       >>> df.part
-0000d1a0: 6974 696f 6e73 5b3a 3a31 305d 2020 2320  itions[::10]  # 
-0000d1b0: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
-0000d1c0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-0000d1d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-0000d1e0: 2020 2020 2020 2020 4120 4461 736b 2044          A Dask D
-0000d1f0: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
-0000d200: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0000d210: 7572 6e20 496e 6465 7843 616c 6c61 626c  urn IndexCallabl
-0000d220: 6528 7365 6c66 2e5f 7061 7274 6974 696f  e(self._partitio
-0000d230: 6e73 290a 0a20 2020 2023 204e 6f74 653a  ns)..    # Note:
-0000d240: 2069 6c6f 6320 6973 2069 6d70 6c65 6d65   iloc is impleme
-0000d250: 6e74 6564 206f 6e6c 7920 6f6e 2044 6174  nted only on Dat
-0000d260: 6146 7261 6d65 0a0a 2020 2020 6465 6620  aFrame..    def 
-0000d270: 7265 7061 7274 6974 696f 6e28 0a20 2020  repartition(.   
-0000d280: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000d290: 2020 2064 6976 6973 696f 6e73 3d4e 6f6e     divisions=Non
-0000d2a0: 652c 0a20 2020 2020 2020 206e 7061 7274  e,.        npart
-0000d2b0: 6974 696f 6e73 3d4e 6f6e 652c 0a20 2020  itions=None,.   
-0000d2c0: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
-0000d2d0: 697a 653d 4e6f 6e65 2c0a 2020 2020 2020  ize=None,.      
-0000d2e0: 2020 6672 6571 3d4e 6f6e 652c 0a20 2020    freq=None,.   
-0000d2f0: 2020 2020 2066 6f72 6365 3d46 616c 7365       force=False
-0000d300: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0000d310: 2022 2222 5265 7061 7274 6974 696f 6e20   """Repartition 
-0000d320: 6461 7461 6672 616d 6520 616c 6f6e 6720  dataframe along 
-0000d330: 6e65 7720 6469 7669 7369 6f6e 730a 0a20  new divisions.. 
-0000d340: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0000d350: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0000d360: 2d2d 2d2d 0a20 2020 2020 2020 2064 6976  ----.        div
-0000d370: 6973 696f 6e73 203a 206c 6973 742c 206f  isions : list, o
-0000d380: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0000d390: 2020 2020 5468 6520 2264 6976 6964 696e      The "dividin
-0000d3a0: 6720 6c69 6e65 7322 2075 7365 6420 746f  g lines" used to
-0000d3b0: 2073 706c 6974 2074 6865 2064 6174 6166   split the dataf
-0000d3c0: 7261 6d65 2069 6e74 6f20 7061 7274 6974  rame into partit
-0000d3d0: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
-0000d3e0: 2020 466f 7220 6060 6469 7669 7369 6f6e    For ``division
-0000d3f0: 733d 5b30 2c20 3130 2c20 3530 2c20 3130  s=[0, 10, 50, 10
-0000d400: 305d 6060 2c20 7468 6572 6520 776f 756c  0]``, there woul
-0000d410: 6420 6265 2074 6872 6565 206f 7574 7075  d be three outpu
-0000d420: 7420 7061 7274 6974 696f 6e73 2c0a 2020  t partitions,.  
-0000d430: 2020 2020 2020 2020 2020 7768 6572 6520            where 
-0000d440: 7468 6520 6e65 7720 696e 6465 7820 636f  the new index co
-0000d450: 6e74 6169 6e65 6420 5b30 2c20 3130 292c  ntained [0, 10),
-0000d460: 205b 3130 2c20 3530 292c 2061 6e64 205b   [10, 50), and [
-0000d470: 3530 2c20 3130 3029 2c20 7265 7370 6563  50, 100), respec
-0000d480: 7469 7665 6c79 2e0a 2020 2020 2020 2020  tively..        
-0000d490: 2020 2020 5365 6520 6874 7470 733a 2f2f      See https://
-0000d4a0: 646f 6373 2e64 6173 6b2e 6f72 672f 656e  docs.dask.org/en
-0000d4b0: 2f6c 6174 6573 742f 6461 7461 6672 616d  /latest/datafram
-0000d4c0: 652d 6465 7369 676e 2e68 746d 6c23 7061  e-design.html#pa
-0000d4d0: 7274 6974 696f 6e73 2e0a 2020 2020 2020  rtitions..      
-0000d4e0: 2020 2020 2020 4f6e 6c79 2075 7365 6420        Only used 
-0000d4f0: 6966 206e 7061 7274 6974 696f 6e73 2061  if npartitions a
-0000d500: 6e64 2070 6172 7469 7469 6f6e 5f73 697a  nd partition_siz
-0000d510: 6520 6973 6e27 7420 7370 6563 6966 6965  e isn't specifie
-0000d520: 642e 0a20 2020 2020 2020 2020 2020 2046  d..            F
-0000d530: 6f72 2063 6f6e 7665 6e69 656e 6365 2069  or convenience i
-0000d540: 6620 6769 7665 6e20 616e 2069 6e74 6567  f given an integ
-0000d550: 6572 2074 6869 7320 7769 6c6c 2064 6566  er this will def
-0000d560: 6572 2074 6f20 6e70 6172 7469 7469 6f6e  er to npartition
-0000d570: 730a 2020 2020 2020 2020 2020 2020 616e  s.            an
-0000d580: 6420 6966 2067 6976 656e 2061 2073 7472  d if given a str
-0000d590: 696e 6720 6974 2077 696c 6c20 6465 6665  ing it will defe
-0000d5a0: 7220 746f 2070 6172 7469 7469 6f6e 5f73  r to partition_s
-0000d5b0: 697a 6520 2873 6565 2062 656c 6f77 290a  ize (see below).
-0000d5c0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-0000d5d0: 6f6e 7320 3a20 696e 742c 206f 7074 696f  ons : int, optio
-0000d5e0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-0000d5f0: 4170 7072 6f78 696d 6174 6520 6e75 6d62  Approximate numb
-0000d600: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
-0000d610: 206f 6620 6f75 7470 7574 2e20 4f6e 6c79   of output. Only
-0000d620: 2075 7365 6420 6966 2070 6172 7469 7469   used if partiti
-0000d630: 6f6e 5f73 697a 650a 2020 2020 2020 2020  on_size.        
-0000d640: 2020 2020 6973 6e27 7420 7370 6563 6966      isn't specif
-0000d650: 6965 642e 2054 6865 206e 756d 6265 7220  ied. The number 
-0000d660: 6f66 2070 6172 7469 7469 6f6e 7320 7573  of partitions us
-0000d670: 6564 206d 6179 2062 6520 736c 6967 6874  ed may be slight
-0000d680: 6c79 0a20 2020 2020 2020 2020 2020 206c  ly.            l
-0000d690: 6f77 6572 2074 6861 6e20 6e70 6172 7469  ower than nparti
-0000d6a0: 7469 6f6e 7320 6465 7065 6e64 696e 6720  tions depending 
-0000d6b0: 6f6e 2064 6174 6120 6469 7374 7269 6275  on data distribu
-0000d6c0: 7469 6f6e 2c20 6275 7420 7769 6c6c 206e  tion, but will n
-0000d6d0: 6576 6572 2062 650a 2020 2020 2020 2020  ever be.        
-0000d6e0: 2020 2020 6869 6768 6572 2e0a 2020 2020      higher..    
-0000d6f0: 2020 2020 7061 7274 6974 696f 6e5f 7369      partition_si
-0000d700: 7a65 3a20 696e 7420 6f72 2073 7472 696e  ze: int or strin
-0000d710: 672c 206f 7074 696f 6e61 6c0a 2020 2020  g, optional.    
-0000d720: 2020 2020 2020 2020 4d61 7820 6e75 6d62          Max numb
-0000d730: 6572 206f 6620 6279 7465 7320 6f66 206d  er of bytes of m
-0000d740: 656d 6f72 7920 666f 7220 6561 6368 2070  emory for each p
-0000d750: 6172 7469 7469 6f6e 2e20 5573 6520 6e75  artition. Use nu
-0000d760: 6d62 6572 7320 6f72 0a20 2020 2020 2020  mbers or.       
-0000d770: 2020 2020 2073 7472 696e 6773 206c 696b       strings lik
-0000d780: 6520 354d 422e 2049 6620 7370 6563 6966  e 5MB. If specif
-0000d790: 6965 6420 6e70 6172 7469 7469 6f6e 7320  ied npartitions 
-0000d7a0: 616e 6420 6469 7669 7369 6f6e 7320 7769  and divisions wi
-0000d7b0: 6c6c 2062 650a 2020 2020 2020 2020 2020  ll be.          
-0000d7c0: 2020 6967 6e6f 7265 642e 204e 6f74 6520    ignored. Note 
-0000d7d0: 7468 6174 2074 6865 2073 697a 6520 7265  that the size re
-0000d7e0: 666c 6563 7473 2074 6865 206e 756d 6265  flects the numbe
-0000d7f0: 7220 6f66 2062 7974 6573 2075 7365 6420  r of bytes used 
-0000d800: 6173 0a20 2020 2020 2020 2020 2020 2063  as.            c
-0000d810: 6f6d 7075 7465 6420 6279 2060 6070 616e  omputed by ``pan
-0000d820: 6461 732e 4461 7461 4672 616d 652e 6d65  das.DataFrame.me
-0000d830: 6d6f 7279 5f75 7361 6765 6060 2c20 7768  mory_usage``, wh
-0000d840: 6963 6820 7769 6c6c 206e 6f74 0a20 2020  ich will not.   
-0000d850: 2020 2020 2020 2020 206e 6563 6573 7361           necessa
-0000d860: 7269 6c79 206d 6174 6368 2074 6865 2073  rily match the s
-0000d870: 697a 6520 7768 656e 2073 746f 7269 6e67  ize when storing
-0000d880: 2074 6f20 6469 736b 2e0a 0a20 2020 2020   to disk...     
-0000d890: 2020 2020 2020 202e 2e20 7761 726e 696e         .. warnin
-0000d8a0: 673a 3a0a 0a20 2020 2020 2020 2020 2020  g::..           
-0000d8b0: 2020 2020 5468 6973 206b 6579 776f 7264      This keyword
-0000d8c0: 2061 7267 756d 656e 7420 7472 6967 6765   argument trigge
-0000d8d0: 7273 2063 6f6d 7075 7461 7469 6f6e 2074  rs computation t
-0000d8e0: 6f20 6465 7465 726d 696e 650a 2020 2020  o determine.    
-0000d8f0: 2020 2020 2020 2020 2020 2074 6865 206d             the m
-0000d900: 656d 6f72 7920 7369 7a65 206f 6620 6561  emory size of ea
-0000d910: 6368 2070 6172 7469 7469 6f6e 2c20 7768  ch partition, wh
-0000d920: 6963 6820 6d61 7920 6265 2065 7870 656e  ich may be expen
-0000d930: 7369 7665 2e0a 0a20 2020 2020 2020 2066  sive...        f
-0000d940: 7265 7120 3a20 7374 722c 2070 642e 5469  req : str, pd.Ti
-0000d950: 6d65 6465 6c74 610a 2020 2020 2020 2020  medelta.        
-0000d960: 2020 2020 4120 7065 7269 6f64 206f 6e20      A period on 
-0000d970: 7768 6963 6820 746f 2070 6172 7469 7469  which to partiti
-0000d980: 6f6e 2074 696d 6573 6572 6965 7320 6461  on timeseries da
-0000d990: 7461 206c 696b 6520 6060 2737 4427 6060  ta like ``'7D'``
-0000d9a0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
-0000d9b0: 6060 2731 3268 2760 6020 6f72 2060 6070  ``'12h'`` or ``p
-0000d9c0: 642e 5469 6d65 6465 6c74 6128 686f 7572  d.Timedelta(hour
-0000d9d0: 733d 3132 2960 602e 2020 4173 7375 6d65  s=12)``.  Assume
-0000d9e0: 7320 6120 6461 7465 7469 6d65 2069 6e64  s a datetime ind
-0000d9f0: 6578 2e0a 2020 2020 2020 2020 666f 7263  ex..        forc
-0000da00: 6520 3a20 626f 6f6c 2c20 6465 6661 756c  e : bool, defaul
-0000da10: 7420 4661 6c73 650a 2020 2020 2020 2020  t False.        
-0000da20: 2020 2020 416c 6c6f 7773 2074 6865 2065      Allows the e
-0000da30: 7870 616e 7369 6f6e 206f 6620 7468 6520  xpansion of the 
-0000da40: 6578 6973 7469 6e67 2064 6976 6973 696f  existing divisio
-0000da50: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
-0000da60: 4966 2046 616c 7365 2074 6865 6e20 7468  If False then th
-0000da70: 6520 6e65 7720 6469 7669 7369 6f6e 7327  e new divisions'
-0000da80: 206c 6f77 6572 2061 6e64 2075 7070 6572   lower and upper
-0000da90: 2062 6f75 6e64 7320 6d75 7374 2062 650a   bounds must be.
-0000daa0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-0000dab0: 7361 6d65 2061 7320 7468 6520 6f6c 6420  same as the old 
-0000dac0: 6469 7669 7369 6f6e 7327 2e0a 0a20 2020  divisions'...   
-0000dad0: 2020 2020 204e 6f74 6573 0a20 2020 2020       Notes.     
-0000dae0: 2020 202d 2d2d 2d2d 0a20 2020 2020 2020     -----.       
-0000daf0: 2045 7861 6374 6c79 206f 6e65 206f 6620   Exactly one of 
-0000db00: 6064 6976 6973 696f 6e73 602c 2060 6e70  `divisions`, `np
-0000db10: 6172 7469 7469 6f6e 7360 2c20 6070 6172  artitions`, `par
-0000db20: 7469 7469 6f6e 5f73 697a 6560 2c20 6f72  tition_size`, or
-0000db30: 2060 6672 6571 600a 2020 2020 2020 2020   `freq`.        
-0000db40: 7368 6f75 6c64 2062 6520 7370 6563 6966  should be specif
-0000db50: 6965 642e 2041 2060 6056 616c 7565 4572  ied. A ``ValueEr
-0000db60: 726f 7260 6020 7769 6c6c 2062 6520 7261  ror`` will be ra
-0000db70: 6973 6564 2077 6865 6e20 7468 6174 2069  ised when that i
-0000db80: 730a 2020 2020 2020 2020 6e6f 7420 7468  s.        not th
-0000db90: 6520 6361 7365 2e0a 0a20 2020 2020 2020  e case...       
-0000dba0: 2041 6c73 6f20 6e6f 7465 2074 6861 7420   Also note that 
-0000dbb0: 6060 6c65 6e28 6469 7669 736f 6e73 2960  ``len(divisons)`
-0000dbc0: 6020 6973 2065 7175 616c 2074 6f20 6060  ` is equal to ``
-0000dbd0: 6e70 6172 7469 7469 6f6e 7320 2b20 3160  npartitions + 1`
-0000dbe0: 602e 2054 6869 7320 6973 2062 6563 6175  `. This is becau
-0000dbf0: 7365 2060 6064 6976 6973 696f 6e73 6060  se ``divisions``
-0000dc00: 0a20 2020 2020 2020 2072 6570 7265 7365  .        represe
-0000dc10: 6e74 7320 7468 6520 7570 7065 7220 616e  nts the upper an
-0000dc20: 6420 6c6f 7765 7220 626f 756e 6473 206f  d lower bounds o
-0000dc30: 6620 6561 6368 2070 6172 7469 7469 6f6e  f each partition
-0000dc40: 2e20 5468 6520 6669 7273 7420 6974 656d  . The first item
-0000dc50: 2069 7320 7468 650a 2020 2020 2020 2020   is the.        
-0000dc60: 6c6f 7765 7220 626f 756e 6420 6f66 2074  lower bound of t
-0000dc70: 6865 2066 6972 7374 2070 6172 7469 7469  he first partiti
-0000dc80: 6f6e 2c20 7468 6520 7365 636f 6e64 2069  on, the second i
-0000dc90: 7465 6d20 6973 2074 6865 206c 6f77 6572  tem is the lower
-0000dca0: 2062 6f75 6e64 206f 6620 7468 650a 2020   bound of the.  
-0000dcb0: 2020 2020 2020 7365 636f 6e64 2070 6172        second par
-0000dcc0: 7469 7469 6f6e 2061 6e64 2074 6865 2075  tition and the u
-0000dcd0: 7070 6572 2062 6f75 6e64 206f 6620 7468  pper bound of th
-0000dce0: 6520 6669 7273 7420 7061 7274 6974 696f  e first partitio
-0000dcf0: 6e2c 2061 6e64 2073 6f20 6f6e 2e0a 2020  n, and so on..  
-0000dd00: 2020 2020 2020 5468 6520 7365 636f 6e64        The second
-0000dd10: 2d74 6f2d 6c61 7374 2069 7465 6d20 6973  -to-last item is
-0000dd20: 2074 6865 206c 6f77 6572 2062 6f75 6e64   the lower bound
-0000dd30: 206f 6620 7468 6520 6c61 7374 2070 6172   of the last par
-0000dd40: 7469 7469 6f6e 2c20 616e 6420 7468 6520  tition, and the 
-0000dd50: 6c61 7374 0a20 2020 2020 2020 2028 6578  last.        (ex
-0000dd60: 7472 6129 2069 7465 6d20 6973 2074 6865  tra) item is the
-0000dd70: 2075 7070 6572 2062 6f75 6e64 206f 6620   upper bound of 
-0000dd80: 7468 6520 6c61 7374 2070 6172 7469 7469  the last partiti
-0000dd90: 6f6e 2e0a 0a20 2020 2020 2020 2045 7861  on...        Exa
-0000dda0: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-0000ddb0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
-0000ddc0: 3e3e 2064 6620 3d20 6466 2e72 6570 6172  >> df = df.repar
-0000ddd0: 7469 7469 6f6e 286e 7061 7274 6974 696f  tition(npartitio
-0000dde0: 6e73 3d31 3029 2020 2320 646f 6374 6573  ns=10)  # doctes
-0000ddf0: 743a 202b 534b 4950 0a20 2020 2020 2020  t: +SKIP.       
-0000de00: 203e 3e3e 2064 6620 3d20 6466 2e72 6570   >>> df = df.rep
-0000de10: 6172 7469 7469 6f6e 2864 6976 6973 696f  artition(divisio
-0000de20: 6e73 3d5b 302c 2035 2c20 3130 2c20 3230  ns=[0, 5, 10, 20
-0000de30: 5d29 2020 2320 646f 6374 6573 743a 202b  ])  # doctest: +
-0000de40: 534b 4950 0a20 2020 2020 2020 203e 3e3e  SKIP.        >>>
-0000de50: 2064 6620 3d20 6466 2e72 6570 6172 7469   df = df.reparti
-0000de60: 7469 6f6e 2866 7265 713d 2737 6427 2920  tion(freq='7d') 
-0000de70: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-0000de80: 500a 0a20 2020 2020 2020 2053 6565 2041  P..        See A
-0000de90: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-0000dea0: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
-0000deb0: 6146 7261 6d65 2e6d 656d 6f72 795f 7573  aFrame.memory_us
-0000dec0: 6167 655f 7065 725f 7061 7274 6974 696f  age_per_partitio
-0000ded0: 6e0a 2020 2020 2020 2020 7061 6e64 6173  n.        pandas
-0000dee0: 2e44 6174 6146 7261 6d65 2e6d 656d 6f72  .DataFrame.memor
-0000def0: 795f 7573 6167 650a 2020 2020 2020 2020  y_usage.        
-0000df00: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
-0000df10: 7369 6e73 7461 6e63 6528 6469 7669 7369  sinstance(divisi
-0000df20: 6f6e 732c 2069 6e74 293a 0a20 2020 2020  ons, int):.     
-0000df30: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
-0000df40: 6e73 203d 2064 6976 6973 696f 6e73 0a20  ns = divisions. 
-0000df50: 2020 2020 2020 2020 2020 2064 6976 6973             divis
-0000df60: 696f 6e73 203d 204e 6f6e 650a 2020 2020  ions = None.    
-0000df70: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0000df80: 6528 6469 7669 7369 6f6e 732c 2073 7472  e(divisions, str
-0000df90: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
-0000dfa0: 6172 7469 7469 6f6e 5f73 697a 6520 3d20  artition_size = 
-0000dfb0: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
-0000dfc0: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
-0000dfd0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2069  = None.        i
-0000dfe0: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-0000dff0: 7375 6d28 0a20 2020 2020 2020 2020 2020  sum(.           
-0000e000: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
-0000e010: 2020 2020 2020 2020 2020 2070 6172 7469             parti
-0000e020: 7469 6f6e 5f73 697a 6520 6973 206e 6f74  tion_size is not
-0000e030: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0000e040: 2020 2020 2020 2020 2020 2064 6976 6973             divis
-0000e050: 696f 6e73 2069 7320 6e6f 7420 4e6f 6e65  ions is not None
-0000e060: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000e070: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
-0000e080: 7320 6973 206e 6f74 204e 6f6e 652c 0a20  s is not None,. 
+00006410: 3230 3231 2d30 312d 3035 2030 303a 3030  2021-01-05 00:00
+00006420: 3a30 3027 292c 0a20 2020 2020 2020 2020  :00'),.         
+00006430: 5469 6d65 7374 616d 7028 2732 3032 312d  Timestamp('2021-
+00006440: 3031 2d30 3620 3030 3a30 303a 3030 2729  01-06 00:00:00')
+00006450: 2c0a 2020 2020 2020 2020 2054 696d 6573  ,.         Times
+00006460: 7461 6d70 2827 3230 3231 2d30 312d 3036  tamp('2021-01-06
+00006470: 2032 333a 3030 3a30 3027 2929 0a0a 2020   23:00:00'))..  
+00006480: 2020 2020 2020 3e3e 3e20 6464 6620 3d20        >>> ddf = 
+00006490: 6464 662e 7365 745f 696e 6465 7828 2274  ddf.set_index("t
+000064a0: 696d 6573 7461 6d70 222c 2064 6976 6973  imestamp", divis
+000064b0: 696f 6e73 3d64 6976 6973 696f 6e73 2c20  ions=divisions, 
+000064c0: 736f 7274 6564 3d54 7275 6529 0a20 2020  sorted=True).   
+000064d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000064e0: 2069 6620 636f 6c20 6973 204e 6f6e 6520   if col is None 
+000064f0: 616e 6420 7365 6c66 2e6b 6e6f 776e 5f64  and self.known_d
+00006500: 6976 6973 696f 6e73 3a0a 2020 2020 2020  ivisions:.      
+00006510: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00006520: 662e 6469 7669 7369 6f6e 730a 0a20 2020  f.divisions..   
+00006530: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
+00006540: 6174 6166 7261 6d65 2e73 6875 6666 6c65  ataframe.shuffle
+00006550: 2069 6d70 6f72 7420 636f 6d70 7574 655f   import compute_
+00006560: 6469 7669 7369 6f6e 730a 0a20 2020 2020  divisions..     
+00006570: 2020 2072 6574 7572 6e20 636f 6d70 7574     return comput
+00006580: 655f 6469 7669 7369 6f6e 7328 7365 6c66  e_divisions(self
+00006590: 2c20 636f 6c3d 636f 6c29 0a0a 2020 2020  , col=col)..    
+000065a0: 6465 6620 6765 745f 7061 7274 6974 696f  def get_partitio
+000065b0: 6e28 7365 6c66 2c20 6e29 3a0a 2020 2020  n(self, n):.    
+000065c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000065d0: 4765 7420 6120 6461 736b 2044 6174 6146  Get a dask DataF
+000065e0: 7261 6d65 2f53 6572 6965 7320 7265 7072  rame/Series repr
+000065f0: 6573 656e 7469 6e67 2074 6865 2060 6e74  esenting the `nt
+00006600: 6860 2070 6172 7469 7469 6f6e 2e0a 0a20  h` partition... 
+00006610: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00006620: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00006630: 2d2d 2d2d 0a20 2020 2020 2020 206e 203a  ----.        n :
+00006640: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
+00006650: 2054 6865 2030 2d69 6e64 6578 6564 2070   The 0-indexed p
+00006660: 6172 7469 7469 6f6e 206e 756d 6265 7220  artition number 
+00006670: 746f 2073 656c 6563 742e 0a0a 2020 2020  to select...    
+00006680: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00006690: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+000066a0: 2020 2020 4461 736b 2044 6174 6146 7261      Dask DataFra
+000066b0: 6d65 206f 7220 5365 7269 6573 0a20 2020  me or Series.   
+000066c0: 2020 2020 2020 2020 2054 6865 2073 616d           The sam
+000066d0: 6520 7479 7065 2061 7320 7468 6520 6f72  e type as the or
+000066e0: 6967 696e 616c 206f 626a 6563 742e 0a0a  iginal object...
+000066f0: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+00006700: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00006710: 2d0a 2020 2020 2020 2020 3e3e 3e20 696d  -.        >>> im
+00006720: 706f 7274 2064 6173 6b0a 2020 2020 2020  port dask.      
+00006730: 2020 3e3e 3e20 6464 6620 3d20 6461 736b    >>> ddf = dask
+00006740: 2e64 6174 6173 6574 732e 7469 6d65 7365  .datasets.timese
+00006750: 7269 6573 2873 7461 7274 3d22 3230 3231  ries(start="2021
+00006760: 2d30 312d 3031 222c 2065 6e64 3d22 3230  -01-01", end="20
+00006770: 3231 2d30 312d 3037 222c 2066 7265 713d  21-01-07", freq=
+00006780: 2231 4822 290a 2020 2020 2020 2020 3e3e  "1H").        >>
+00006790: 3e20 6464 662e 6765 745f 7061 7274 6974  > ddf.get_partit
+000067a0: 696f 6e28 3029 2020 2320 646f 6374 6573  ion(0)  # doctes
+000067b0: 743a 202b 4e4f 524d 414c 495a 455f 5748  t: +NORMALIZE_WH
+000067c0: 4954 4553 5041 4345 0a20 2020 2020 2020  ITESPACE.       
+000067d0: 2044 6173 6b20 4461 7461 4672 616d 6520   Dask DataFrame 
+000067e0: 5374 7275 6374 7572 653a 0a20 2020 2020  Structure:.     
+000067f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006800: 2020 2020 6e61 6d65 2020 2020 2069 6420      name     id 
+00006810: 2020 2020 2020 2078 2020 2020 2020 2020         x        
+00006820: 790a 2020 2020 2020 2020 6e70 6172 7469  y.        nparti
+00006830: 7469 6f6e 733d 310a 2020 2020 2020 2020  tions=1.        
+00006840: 3230 3231 2d30 312d 3031 2020 2020 206f  2021-01-01     o
+00006850: 626a 6563 7420 2069 6e74 3634 2020 666c  bject  int64  fl
+00006860: 6f61 7436 3420 2066 6c6f 6174 3634 0a20  oat64  float64. 
+00006870: 2020 2020 2020 2032 3032 312d 3031 2d30         2021-01-0
+00006880: 3220 2020 2020 2020 202e 2e2e 2020 2020  2        ...    
+00006890: 2e2e 2e20 2020 2020 202e 2e2e 2020 2020  ...      ...    
+000068a0: 2020 2e2e 2e0a 2020 2020 2020 2020 4461    ....        Da
+000068b0: 736b 204e 616d 653a 2067 6574 2d70 6172  sk Name: get-par
+000068c0: 7469 7469 6f6e 2c20 3220 6772 6170 6820  tition, 2 graph 
+000068d0: 6c61 7965 7273 0a0a 2020 2020 2020 2020  layers..        
+000068e0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+000068f0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00006900: 2020 4461 7461 4672 616d 652e 7061 7274    DataFrame.part
+00006910: 6974 696f 6e73 0a20 2020 2020 2020 2022  itions.        "
+00006920: 2222 0a20 2020 2020 2020 2069 6620 3020  "".        if 0 
+00006930: 3c3d 206e 203c 2073 656c 662e 6e70 6172  <= n < self.npar
+00006940: 7469 7469 6f6e 733a 0a20 2020 2020 2020  titions:.       
+00006950: 2020 2020 206e 616d 6520 3d20 6622 6765       name = f"ge
+00006960: 742d 7061 7274 6974 696f 6e2d 7b73 7472  t-partition-{str
+00006970: 286e 297d 2d7b 7365 6c66 2e5f 6e61 6d65  (n)}-{self._name
+00006980: 7d22 0a20 2020 2020 2020 2020 2020 2064  }".            d
+00006990: 6976 6973 696f 6e73 203d 2073 656c 662e  ivisions = self.
+000069a0: 6469 7669 7369 6f6e 735b 6e20 3a20 6e20  divisions[n : n 
+000069b0: 2b20 325d 0a20 2020 2020 2020 2020 2020  + 2].           
+000069c0: 206c 6179 6572 203d 207b 286e 616d 652c   layer = {(name,
+000069d0: 2030 293a 2028 7365 6c66 2e5f 6e61 6d65   0): (self._name
+000069e0: 2c20 6e29 7d0a 2020 2020 2020 2020 2020  , n)}.          
+000069f0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+00006a00: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+00006a10: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
+00006a20: 6c61 7965 722c 2064 6570 656e 6465 6e63  layer, dependenc
+00006a30: 6965 733d 5b73 656c 665d 290a 2020 2020  ies=[self]).    
+00006a40: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00006a50: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
+00006a60: 7068 2c20 6e61 6d65 2c20 7365 6c66 2e5f  ph, name, self._
+00006a70: 6d65 7461 2c20 6469 7669 7369 6f6e 7329  meta, divisions)
+00006a80: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00006a90: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
+00006aa0: 2066 226e 206d 7573 7420 6265 2030 203c   f"n must be 0 <
+00006ab0: 3d20 6e20 3c20 7b73 656c 662e 6e70 6172  = n < {self.npar
+00006ac0: 7469 7469 6f6e 737d 220a 2020 2020 2020  titions}".      
+00006ad0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00006ae0: 6545 7272 6f72 286d 7367 290a 0a20 2020  eError(msg)..   
+00006af0: 2040 6465 7269 7665 645f 6672 6f6d 280a   @derived_from(.
+00006b00: 2020 2020 2020 2020 7064 2e44 6174 6146          pd.DataF
+00006b10: 7261 6d65 2c0a 2020 2020 2020 2020 696e  rame,.        in
+00006b20: 636f 6e73 6973 7465 6e63 6965 733d 226b  consistencies="k
+00006b30: 6565 703d 4661 6c73 6520 7769 6c6c 2072  eep=False will r
+00006b40: 6169 7365 2061 2060 604e 6f74 496d 706c  aise a ``NotImpl
+00006b50: 656d 656e 7465 6445 7272 6f72 6060 222c  ementedError``",
+00006b60: 0a20 2020 2029 0a20 2020 2064 6566 2064  .    ).    def d
+00006b70: 726f 705f 6475 706c 6963 6174 6573 280a  rop_duplicates(.
+00006b80: 2020 2020 2020 2020 7365 6c66 2c20 7375          self, su
+00006b90: 6273 6574 3d4e 6f6e 652c 2073 706c 6974  bset=None, split
+00006ba0: 5f65 7665 7279 3d4e 6f6e 652c 2073 706c  _every=None, spl
+00006bb0: 6974 5f6f 7574 3d31 2c20 6967 6e6f 7265  it_out=1, ignore
+00006bc0: 5f69 6e64 6578 3d46 616c 7365 2c20 2a2a  _index=False, **
+00006bd0: 6b77 6172 6773 0a20 2020 2029 3a0a 2020  kwargs.    ):.  
+00006be0: 2020 2020 2020 6966 2073 7562 7365 7420        if subset 
+00006bf0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00006c00: 2020 2020 2020 2020 2023 204c 6574 2070           # Let p
+00006c10: 616e 6461 7320 6572 726f 7220 6f6e 2062  andas error on b
+00006c20: 6164 2069 6e70 7574 730a 2020 2020 2020  ad inputs.      
+00006c30: 2020 2020 2020 7365 6c66 2e5f 6d65 7461        self._meta
+00006c40: 5f6e 6f6e 656d 7074 792e 6472 6f70 5f64  _nonempty.drop_d
+00006c50: 7570 6c69 6361 7465 7328 7375 6273 6574  uplicates(subset
+00006c60: 3d73 7562 7365 742c 202a 2a6b 7761 7267  =subset, **kwarg
+00006c70: 7329 0a20 2020 2020 2020 2020 2020 206b  s).            k
+00006c80: 7761 7267 735b 2273 7562 7365 7422 5d20  wargs["subset"] 
+00006c90: 3d20 7375 6273 6574 0a20 2020 2020 2020  = subset.       
+00006ca0: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
+00006cb0: 6574 7570 203d 2073 706c 6974 5f6f 7574  etup = split_out
+00006cc0: 5f6f 6e5f 636f 6c73 0a20 2020 2020 2020  _on_cols.       
+00006cd0: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
+00006ce0: 6574 7570 5f6b 7761 7267 7320 3d20 7b22  etup_kwargs = {"
+00006cf0: 636f 6c73 223a 2073 7562 7365 747d 0a20  cols": subset}. 
+00006d00: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00006d10: 2020 2020 2020 2020 2073 656c 662e 5f6d           self._m
+00006d20: 6574 615f 6e6f 6e65 6d70 7479 2e64 726f  eta_nonempty.dro
+00006d30: 705f 6475 706c 6963 6174 6573 282a 2a6b  p_duplicates(**k
+00006d40: 7761 7267 7329 0a20 2020 2020 2020 2020  wargs).         
+00006d50: 2020 2073 706c 6974 5f6f 7574 5f73 6574     split_out_set
+00006d60: 7570 203d 2073 706c 6974 5f6f 7574 5f73  up = split_out_s
+00006d70: 6574 7570 5f6b 7761 7267 7320 3d20 4e6f  etup_kwargs = No
+00006d80: 6e65 0a0a 2020 2020 2020 2020 6966 206b  ne..        if k
+00006d90: 7761 7267 732e 6765 7428 226b 6565 7022  wargs.get("keep"
+00006da0: 2c20 5472 7565 2920 6973 2046 616c 7365  , True) is False
+00006db0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00006dc0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+00006dd0: 6564 4572 726f 7228 2264 726f 705f 6475  edError("drop_du
+00006de0: 706c 6963 6174 6573 2077 6974 6820 6b65  plicates with ke
+00006df0: 6570 3d46 616c 7365 2229 0a0a 2020 2020  ep=False")..    
+00006e00: 2020 2020 6368 756e 6b20 3d20 4d2e 6472      chunk = M.dr
+00006e10: 6f70 5f64 7570 6c69 6361 7465 730a 2020  op_duplicates.  
+00006e20: 2020 2020 2020 7265 7475 726e 2061 6361        return aca
+00006e30: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00006e40: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00006e50: 6368 756e 6b3d 6368 756e 6b2c 0a20 2020  chunk=chunk,.   
+00006e60: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+00006e70: 7465 3d63 6875 6e6b 2c0a 2020 2020 2020  te=chunk,.      
+00006e80: 2020 2020 2020 6d65 7461 3d73 656c 662e        meta=self.
+00006e90: 5f6d 6574 612c 0a20 2020 2020 2020 2020  _meta,.         
+00006ea0: 2020 2074 6f6b 656e 3d22 6472 6f70 2d64     token="drop-d
+00006eb0: 7570 6c69 6361 7465 7322 2c0a 2020 2020  uplicates",.    
+00006ec0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+00006ed0: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
+00006ee0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+00006ef0: 6974 5f6f 7574 3d73 706c 6974 5f6f 7574  it_out=split_out
+00006f00: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+00006f10: 6c69 745f 6f75 745f 7365 7475 703d 7370  lit_out_setup=sp
+00006f20: 6c69 745f 6f75 745f 7365 7475 702c 0a20  lit_out_setup,. 
+00006f30: 2020 2020 2020 2020 2020 2073 706c 6974             split
+00006f40: 5f6f 7574 5f73 6574 7570 5f6b 7761 7267  _out_setup_kwarg
+00006f50: 733d 7370 6c69 745f 6f75 745f 7365 7475  s=split_out_setu
+00006f60: 705f 6b77 6172 6773 2c0a 2020 2020 2020  p_kwargs,.      
+00006f70: 2020 2020 2020 6967 6e6f 7265 5f69 6e64        ignore_ind
+00006f80: 6578 3d69 676e 6f72 655f 696e 6465 782c  ex=ignore_index,
+00006f90: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
+00006fa0: 7761 7267 732c 0a20 2020 2020 2020 2029  wargs,.        )
+00006fb0: 0a0a 2020 2020 6465 6620 5f5f 6c65 6e5f  ..    def __len_
+00006fc0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00006fd0: 2072 6574 7572 6e20 7365 6c66 2e72 6564   return self.red
+00006fe0: 7563 7469 6f6e 280a 2020 2020 2020 2020  uction(.        
+00006ff0: 2020 2020 6c65 6e2c 206e 702e 7375 6d2c      len, np.sum,
+00007000: 2074 6f6b 656e 3d22 6c65 6e22 2c20 6d65   token="len", me
+00007010: 7461 3d69 6e74 2c20 7370 6c69 745f 6576  ta=int, split_ev
+00007020: 6572 793d 4661 6c73 650a 2020 2020 2020  ery=False.      
+00007030: 2020 292e 636f 6d70 7574 6528 290a 0a20    ).compute().. 
+00007040: 2020 2064 6566 205f 5f62 6f6f 6c5f 5f28     def __bool__(
+00007050: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00007060: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00007070: 0a20 2020 2020 2020 2020 2020 2066 2254  .            f"T
+00007080: 6865 2074 7275 7468 2076 616c 7565 206f  he truth value o
+00007090: 6620 6120 7b73 656c 662e 5f5f 636c 6173  f a {self.__clas
+000070a0: 735f 5f2e 5f5f 6e61 6d65 5f5f 7d20 6973  s__.__name__} is
+000070b0: 2061 6d62 6967 756f 7573 2e20 220a 2020   ambiguous. ".  
+000070c0: 2020 2020 2020 2020 2020 2255 7365 2061            "Use a
+000070d0: 2e61 6e79 2829 206f 7220 612e 616c 6c28  .any() or a.all(
+000070e0: 292e 220a 2020 2020 2020 2020 290a 0a20  ).".        ).. 
+000070f0: 2020 205f 5f6e 6f6e 7a65 726f 5f5f 203d     __nonzero__ =
+00007100: 205f 5f62 6f6f 6c5f 5f20 2023 2070 7974   __bool__  # pyt
+00007110: 686f 6e20 320a 0a20 2020 2064 6566 205f  hon 2..    def _
+00007120: 7363 616c 6172 6675 6e63 2873 656c 662c  scalarfunc(self,
+00007130: 2063 6173 745f 7479 7065 293a 0a20 2020   cast_type):.   
+00007140: 2020 2020 2064 6566 2077 7261 7070 6572       def wrapper
+00007150: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00007160: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00007170: 6622 6361 6e6e 6f74 2063 6f6e 7665 7274  f"cannot convert
+00007180: 2074 6865 2073 6572 6965 7320 746f 207b   the series to {
+00007190: 6361 7374 5f74 7970 657d 2229 0a0a 2020  cast_type}")..  
+000071a0: 2020 2020 2020 7265 7475 726e 2077 7261        return wra
+000071b0: 7070 6572 0a0a 2020 2020 6465 6620 5f5f  pper..    def __
+000071c0: 666c 6f61 745f 5f28 7365 6c66 293a 0a20  float__(self):. 
+000071d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000071e0: 6c66 2e5f 7363 616c 6172 6675 6e63 2866  lf._scalarfunc(f
+000071f0: 6c6f 6174 290a 0a20 2020 2064 6566 205f  loat)..    def _
+00007200: 5f69 6e74 5f5f 2873 656c 6629 3a0a 2020  _int__(self):.  
+00007210: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00007220: 662e 5f73 6361 6c61 7266 756e 6328 696e  f._scalarfunc(in
+00007230: 7429 0a0a 2020 2020 5f5f 6c6f 6e67 5f5f  t)..    __long__
+00007240: 203d 205f 5f69 6e74 5f5f 2020 2320 7079   = __int__  # py
+00007250: 7468 6f6e 2032 0a0a 2020 2020 6465 6620  thon 2..    def 
+00007260: 5f5f 636f 6d70 6c65 785f 5f28 7365 6c66  __complex__(self
+00007270: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00007280: 6e20 7365 6c66 2e5f 7363 616c 6172 6675  n self._scalarfu
+00007290: 6e63 2863 6f6d 706c 6578 290a 0a20 2020  nc(complex)..   
+000072a0: 2040 696e 7365 7274 5f6d 6574 615f 7061   @insert_meta_pa
+000072b0: 7261 6d5f 6465 7363 7269 7074 696f 6e28  ram_description(
+000072c0: 7061 643d 3132 290a 2020 2020 6465 6620  pad=12).    def 
+000072d0: 6d61 705f 7061 7274 6974 696f 6e73 2873  map_partitions(s
+000072e0: 656c 662c 2066 756e 632c 202a 6172 6773  elf, func, *args
+000072f0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00007300: 2020 2020 2022 2222 4170 706c 7920 5079       """Apply Py
+00007310: 7468 6f6e 2066 756e 6374 696f 6e20 6f6e  thon function on
+00007320: 2065 6163 6820 4461 7461 4672 616d 6520   each DataFrame 
+00007330: 7061 7274 6974 696f 6e2e 0a0a 2020 2020  partition...    
+00007340: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
+00007350: 6520 696e 6465 7820 616e 6420 6469 7669  e index and divi
+00007360: 7369 6f6e 7320 6172 6520 6173 7375 6d65  sions are assume
+00007370: 6420 746f 2072 656d 6169 6e20 756e 6368  d to remain unch
+00007380: 616e 6765 642e 0a0a 2020 2020 2020 2020  anged...        
+00007390: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+000073a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+000073b0: 2020 2020 2020 6675 6e63 203a 2066 756e        func : fun
+000073c0: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
+000073d0: 2020 5468 6520 6675 6e63 7469 6f6e 2061    The function a
+000073e0: 7070 6c69 6564 2074 6f20 6561 6368 2070  pplied to each p
+000073f0: 6172 7469 7469 6f6e 2e20 4966 2074 6869  artition. If thi
+00007400: 7320 6675 6e63 7469 6f6e 2061 6363 6570  s function accep
+00007410: 7473 0a20 2020 2020 2020 2020 2020 2074  ts.            t
+00007420: 6865 2073 7065 6369 616c 2060 6070 6172  he special ``par
+00007430: 7469 7469 6f6e 5f69 6e66 6f60 6020 6b65  tition_info`` ke
+00007440: 7977 6f72 6420 6172 6775 6d65 6e74 2c20  yword argument, 
+00007450: 6974 2077 696c 6c20 7265 6365 6976 650a  it will receive.
+00007460: 2020 2020 2020 2020 2020 2020 696e 666f              info
+00007470: 726d 6174 696f 6e20 6f6e 2074 6865 2070  rmation on the p
+00007480: 6172 7469 7469 6f6e 2773 2072 656c 6174  artition's relat
+00007490: 6976 6520 6c6f 6361 7469 6f6e 2077 6974  ive location wit
+000074a0: 6869 6e20 7468 650a 2020 2020 2020 2020  hin the.        
+000074b0: 2020 2020 6461 7461 6672 616d 652e 0a20      dataframe.. 
+000074c0: 2020 2020 2020 2061 7267 732c 206b 7761         args, kwa
+000074d0: 7267 7320 3a0a 2020 2020 2020 2020 2020  rgs :.          
+000074e0: 2020 506f 7369 7469 6f6e 616c 2061 6e64    Positional and
+000074f0: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
+00007500: 7473 2074 6f20 7061 7373 2074 6f20 7468  ts to pass to th
+00007510: 6520 6675 6e63 7469 6f6e 2e0a 2020 2020  e function..    
+00007520: 2020 2020 2020 2020 506f 7369 7469 6f6e          Position
+00007530: 616c 2061 7267 756d 656e 7473 2061 7265  al arguments are
+00007540: 2063 6f6d 7075 7465 6420 6f6e 2061 2070   computed on a p
+00007550: 6572 2d70 6172 7469 7469 6f6e 2062 6173  er-partition bas
+00007560: 6973 2c20 7768 696c 650a 2020 2020 2020  is, while.      
+00007570: 2020 2020 2020 6b65 7977 6f72 6420 6172        keyword ar
+00007580: 6775 6d65 6e74 7320 6172 6520 7368 6172  guments are shar
+00007590: 6564 2061 6372 6f73 7320 616c 6c20 7061  ed across all pa
+000075a0: 7274 6974 696f 6e73 2e20 5468 6520 7061  rtitions. The pa
+000075b0: 7274 6974 696f 6e0a 2020 2020 2020 2020  rtition.        
+000075c0: 2020 2020 6974 7365 6c66 2077 696c 6c20      itself will 
+000075d0: 6265 2074 6865 2066 6972 7374 2070 6f73  be the first pos
+000075e0: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
+000075f0: 2c20 7769 7468 2061 6c6c 206f 7468 6572  , with all other
+00007600: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
+00007610: 756d 656e 7473 2070 6173 7365 6420 2a61  uments passed *a
+00007620: 6674 6572 2a2e 2041 7267 756d 656e 7473  fter*. Arguments
+00007630: 2063 616e 2062 6520 6060 5363 616c 6172   can be ``Scalar
+00007640: 6060 2c20 6060 4465 6c61 7965 6460 602c  ``, ``Delayed``,
+00007650: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
+00007660: 7265 6775 6c61 7220 5079 7468 6f6e 206f  regular Python o
+00007670: 626a 6563 7473 2e20 4461 7461 4672 616d  bjects. DataFram
+00007680: 652d 6c69 6b65 2061 7267 7320 2862 6f74  e-like args (bot
+00007690: 6820 6461 736b 2061 6e64 0a20 2020 2020  h dask and.     
+000076a0: 2020 2020 2020 2070 616e 6461 7329 2077         pandas) w
+000076b0: 696c 6c20 6265 2072 6570 6172 7469 7469  ill be repartiti
+000076c0: 6f6e 6564 2074 6f20 616c 6967 6e20 2869  oned to align (i
+000076d0: 6620 6e65 6365 7373 6172 7929 2062 6566  f necessary) bef
+000076e0: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
+000076f0: 6170 706c 7969 6e67 2074 6865 2066 756e  applying the fun
+00007700: 6374 696f 6e3b 2073 6565 2060 6061 6c69  ction; see ``ali
+00007710: 676e 5f64 6174 6166 7261 6d65 7360 6020  gn_dataframes`` 
+00007720: 746f 2063 6f6e 7472 6f6c 2074 6869 730a  to control this.
+00007730: 2020 2020 2020 2020 2020 2020 6265 6861              beha
+00007740: 7669 6f72 2e0a 2020 2020 2020 2020 656e  vior..        en
+00007750: 666f 7263 655f 6d65 7461 6461 7461 203a  force_metadata :
+00007760: 2062 6f6f 6c2c 2064 6566 6175 6c74 2054   bool, default T
+00007770: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+00007780: 5768 6574 6865 7220 746f 2065 6e66 6f72  Whether to enfor
+00007790: 6365 2061 7420 7275 6e74 696d 6520 7468  ce at runtime th
+000077a0: 6174 2074 6865 2073 7472 7563 7475 7265  at the structure
+000077b0: 206f 6620 7468 6520 4461 7461 4672 616d   of the DataFram
+000077c0: 650a 2020 2020 2020 2020 2020 2020 7072  e.            pr
+000077d0: 6f64 7563 6564 2062 7920 6060 6675 6e63  oduced by ``func
+000077e0: 6060 2061 6374 7561 6c6c 7920 6d61 7463  `` actually matc
+000077f0: 6865 7320 7468 6520 7374 7275 6374 7572  hes the structur
+00007800: 6520 6f66 2060 606d 6574 6160 602e 0a20  e of ``meta``.. 
+00007810: 2020 2020 2020 2020 2020 2054 6869 7320             This 
+00007820: 7769 6c6c 2072 656e 616d 6520 616e 6420  will rename and 
+00007830: 7265 6f72 6465 7220 636f 6c75 6d6e 7320  reorder columns 
+00007840: 666f 7220 6561 6368 2070 6172 7469 7469  for each partiti
+00007850: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00007860: 616e 6420 7769 6c6c 2072 6169 7365 2061  and will raise a
+00007870: 6e20 6572 726f 7220 6966 2074 6869 7320  n error if this 
+00007880: 646f 6573 6e27 7420 776f 726b 2c0a 2020  doesn't work,.  
+00007890: 2020 2020 2020 2020 2020 6275 7420 6974            but it
+000078a0: 2077 6f6e 2774 2072 6169 7365 2069 6620   won't raise if 
+000078b0: 6474 7970 6573 2064 6f6e 2774 206d 6174  dtypes don't mat
+000078c0: 6368 2e0a 2020 2020 2020 2020 7472 616e  ch..        tran
+000078d0: 7366 6f72 6d5f 6469 7669 7369 6f6e 7320  sform_divisions 
+000078e0: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+000078f0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00007900: 2057 6865 7468 6572 2074 6f20 6170 706c   Whether to appl
+00007910: 7920 7468 6520 6675 6e63 7469 6f6e 206f  y the function o
+00007920: 6e74 6f20 7468 6520 6469 7669 7369 6f6e  nto the division
+00007930: 7320 616e 6420 6170 706c 7920 7468 6f73  s and apply thos
+00007940: 650a 2020 2020 2020 2020 2020 2020 7472  e.            tr
+00007950: 616e 7366 6f72 6d65 6420 6469 7669 7369  ansformed divisi
+00007960: 6f6e 7320 746f 2074 6865 206f 7574 7075  ons to the outpu
+00007970: 742e 0a20 2020 2020 2020 2061 6c69 676e  t..        align
+00007980: 5f64 6174 6166 7261 6d65 7320 3a20 626f  _dataframes : bo
+00007990: 6f6c 2c20 6465 6661 756c 7420 5472 7565  ol, default True
+000079a0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+000079b0: 7468 6572 2074 6f20 7265 7061 7274 6974  ther to repartit
+000079c0: 696f 6e20 4461 7461 4672 616d 652d 206f  ion DataFrame- o
+000079d0: 7220 5365 7269 6573 2d6c 696b 6520 6172  r Series-like ar
+000079e0: 6773 0a20 2020 2020 2020 2020 2020 2028  gs.            (
+000079f0: 626f 7468 2064 6173 6b20 616e 6420 7061  both dask and pa
+00007a00: 6e64 6173 2920 736f 2074 6865 6972 2064  ndas) so their d
+00007a10: 6976 6973 696f 6e73 2061 6c69 676e 2062  ivisions align b
+00007a20: 6566 6f72 6520 6170 706c 7969 6e67 0a20  efore applying. 
+00007a30: 2020 2020 2020 2020 2020 2074 6865 2066             the f
+00007a40: 756e 6374 696f 6e2e 2054 6869 7320 7265  unction. This re
+00007a50: 7175 6972 6573 2061 6c6c 2069 6e70 7574  quires all input
+00007a60: 7320 746f 2068 6176 6520 6b6e 6f77 6e20  s to have known 
+00007a70: 6469 7669 7369 6f6e 732e 0a20 2020 2020  divisions..     
+00007a80: 2020 2020 2020 2053 696e 676c 652d 7061         Single-pa
+00007a90: 7274 6974 696f 6e20 696e 7075 7473 2077  rtition inputs w
+00007aa0: 696c 6c20 6265 2073 706c 6974 2069 6e74  ill be split int
+00007ab0: 6f20 6d75 6c74 6970 6c65 2070 6172 7469  o multiple parti
+00007ac0: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
+00007ad0: 2020 2020 4966 2046 616c 7365 2c20 616c      If False, al
+00007ae0: 6c20 696e 7075 7473 206d 7573 7420 6861  l inputs must ha
+00007af0: 7665 2065 6974 6865 7220 7468 6520 7361  ve either the sa
+00007b00: 6d65 206e 756d 6265 7220 6f66 2070 6172  me number of par
+00007b10: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
+00007b20: 2020 2020 6f72 2061 2073 696e 676c 6520      or a single 
+00007b30: 7061 7274 6974 696f 6e2e 2053 696e 676c  partition. Singl
+00007b40: 652d 7061 7274 6974 696f 6e20 696e 7075  e-partition inpu
+00007b50: 7473 2077 696c 6c20 6265 2062 726f 6164  ts will be broad
+00007b60: 6361 7374 2074 6f0a 2020 2020 2020 2020  cast to.        
+00007b70: 2020 2020 6576 6572 7920 7061 7274 6974      every partit
+00007b80: 696f 6e20 6f66 206d 756c 7469 2d70 6172  ion of multi-par
+00007b90: 7469 7469 6f6e 2069 6e70 7574 732e 0a20  tition inputs.. 
+00007ba0: 2020 2020 2020 2024 4d45 5441 0a0a 2020         $META..  
+00007bb0: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
+00007bc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+00007bd0: 2020 2020 2020 2020 4769 7665 6e20 6120          Given a 
+00007be0: 4461 7461 4672 616d 652c 2053 6572 6965  DataFrame, Serie
+00007bf0: 732c 206f 7220 496e 6465 782c 2073 7563  s, or Index, suc
+00007c00: 6820 6173 3a0a 0a20 2020 2020 2020 203e  h as:..        >
+00007c10: 3e3e 2069 6d70 6f72 7420 7061 6e64 6173  >> import pandas
+00007c20: 2061 7320 7064 0a20 2020 2020 2020 203e   as pd.        >
+00007c30: 3e3e 2069 6d70 6f72 7420 6461 736b 2e64  >> import dask.d
+00007c40: 6174 6166 7261 6d65 2061 7320 6464 0a20  ataframe as dd. 
+00007c50: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00007c60: 7064 2e44 6174 6146 7261 6d65 287b 2778  pd.DataFrame({'x
+00007c70: 273a 205b 312c 2032 2c20 332c 2034 2c20  ': [1, 2, 3, 4, 
+00007c80: 355d 2c0a 2020 2020 2020 2020 2e2e 2e20  5],.        ... 
+00007c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007ca0: 2020 2027 7927 3a20 5b31 2e2c 2032 2e2c     'y': [1., 2.,
+00007cb0: 2033 2e2c 2034 2e2c 2035 2e5d 7d29 0a20   3., 4., 5.]}). 
+00007cc0: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
+00007cd0: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
+00007ce0: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
+00007cf0: 3229 0a0a 2020 2020 2020 2020 4f6e 6520  2)..        One 
+00007d00: 6361 6e20 7573 6520 6060 6d61 705f 7061  can use ``map_pa
+00007d10: 7274 6974 696f 6e73 6060 2074 6f20 6170  rtitions`` to ap
+00007d20: 706c 7920 6120 6675 6e63 7469 6f6e 206f  ply a function o
+00007d30: 6e20 6561 6368 2070 6172 7469 7469 6f6e  n each partition
+00007d40: 2e0a 2020 2020 2020 2020 4578 7472 6120  ..        Extra 
+00007d50: 6172 6775 6d65 6e74 7320 616e 6420 6b65  arguments and ke
+00007d60: 7977 6f72 6473 2063 616e 206f 7074 696f  ywords can optio
+00007d70: 6e61 6c6c 7920 6265 2070 726f 7669 6465  nally be provide
+00007d80: 642c 2061 6e64 2077 696c 6c20 6265 0a20  d, and will be. 
+00007d90: 2020 2020 2020 2070 6173 7365 6420 746f         passed to
+00007da0: 2074 6865 2066 756e 6374 696f 6e20 6166   the function af
+00007db0: 7465 7220 7468 6520 7061 7274 6974 696f  ter the partitio
+00007dc0: 6e2e 0a0a 2020 2020 2020 2020 4865 7265  n...        Here
+00007dd0: 2077 6520 6170 706c 7920 6120 6675 6e63   we apply a func
+00007de0: 7469 6f6e 2077 6974 6820 6172 6775 6d65  tion with argume
+00007df0: 6e74 7320 616e 6420 6b65 7977 6f72 6473  nts and keywords
+00007e00: 2074 6f20 6120 4461 7461 4672 616d 652c   to a DataFrame,
+00007e10: 0a20 2020 2020 2020 2072 6573 756c 7469  .        resulti
+00007e20: 6e67 2069 6e20 6120 5365 7269 6573 3a0a  ng in a Series:.
+00007e30: 0a20 2020 2020 2020 203e 3e3e 2064 6566  .        >>> def
+00007e40: 206d 7961 6464 2864 662c 2061 2c20 623d   myadd(df, a, b=
+00007e50: 3129 3a0a 2020 2020 2020 2020 2e2e 2e20  1):.        ... 
+00007e60: 2020 2020 7265 7475 726e 2064 662e 7820      return df.x 
+00007e70: 2b20 6466 2e79 202b 2061 202b 2062 0a20  + df.y + a + b. 
+00007e80: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+00007e90: 2064 6466 2e6d 6170 5f70 6172 7469 7469   ddf.map_partiti
+00007ea0: 6f6e 7328 6d79 6164 642c 2031 2c20 623d  ons(myadd, 1, b=
+00007eb0: 3229 0a20 2020 2020 2020 203e 3e3e 2072  2).        >>> r
+00007ec0: 6573 2e64 7479 7065 0a20 2020 2020 2020  es.dtype.       
+00007ed0: 2064 7479 7065 2827 666c 6f61 7436 3427   dtype('float64'
+00007ee0: 290a 0a20 2020 2020 2020 2048 6572 6520  )..        Here 
+00007ef0: 7765 2061 7070 6c79 2061 2066 756e 6374  we apply a funct
+00007f00: 696f 6e20 746f 2061 2053 6572 6965 7320  ion to a Series 
+00007f10: 7265 7375 6c74 696e 6720 696e 2061 2053  resulting in a S
+00007f20: 6572 6965 733a 0a0a 2020 2020 2020 2020  eries:..        
+00007f30: 3e3e 3e20 7265 7320 3d20 6464 662e 782e  >>> res = ddf.x.
+00007f40: 6d61 705f 7061 7274 6974 696f 6e73 286c  map_partitions(l
+00007f50: 616d 6264 6120 783a 206c 656e 2878 2929  ambda x: len(x))
+00007f60: 2023 2064 6466 2e78 2069 7320 6120 4461   # ddf.x is a Da
+00007f70: 736b 2053 6572 6965 7320 5374 7275 6374  sk Series Struct
+00007f80: 7572 650a 2020 2020 2020 2020 3e3e 3e20  ure.        >>> 
+00007f90: 7265 732e 6474 7970 650a 2020 2020 2020  res.dtype.      
+00007fa0: 2020 6474 7970 6528 2769 6e74 3634 2729    dtype('int64')
+00007fb0: 0a0a 2020 2020 2020 2020 4279 2064 6566  ..        By def
+00007fc0: 6175 6c74 2c20 6461 736b 2074 7269 6573  ault, dask tries
+00007fd0: 2074 6f20 696e 6665 7220 7468 6520 6f75   to infer the ou
+00007fe0: 7470 7574 206d 6574 6164 6174 6120 6279  tput metadata by
+00007ff0: 2072 756e 6e69 6e67 2079 6f75 720a 2020   running your.  
+00008000: 2020 2020 2020 7072 6f76 6964 6564 2066        provided f
+00008010: 756e 6374 696f 6e20 6f6e 2073 6f6d 6520  unction on some 
+00008020: 6661 6b65 2064 6174 612e 2054 6869 7320  fake data. This 
+00008030: 776f 726b 7320 7765 6c6c 2069 6e20 6d61  works well in ma
+00008040: 6e79 2063 6173 6573 2c20 6275 740a 2020  ny cases, but.  
+00008050: 2020 2020 2020 6361 6e20 736f 6d65 7469        can someti
+00008060: 6d65 7320 6265 2065 7870 656e 7369 7665  mes be expensive
+00008070: 2c20 6f72 2065 7665 6e20 6661 696c 2e20  , or even fail. 
+00008080: 546f 2061 766f 6964 2074 6869 732c 2079  To avoid this, y
+00008090: 6f75 2063 616e 0a20 2020 2020 2020 206d  ou can.        m
+000080a0: 616e 7561 6c6c 7920 7370 6563 6966 7920  anually specify 
+000080b0: 7468 6520 6f75 7470 7574 206d 6574 6164  the output metad
+000080c0: 6174 6120 7769 7468 2074 6865 2060 606d  ata with the ``m
+000080d0: 6574 6160 6020 6b65 7977 6f72 642e 2054  eta`` keyword. T
+000080e0: 6869 730a 2020 2020 2020 2020 6361 6e20  his.        can 
+000080f0: 6265 2073 7065 6369 6669 6564 2069 6e20  be specified in 
+00008100: 6d61 6e79 2066 6f72 6d73 2c20 666f 7220  many forms, for 
+00008110: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
+00008120: 2073 6565 0a20 2020 2020 2020 2060 6064   see.        ``d
+00008130: 6173 6b2e 6461 7461 6672 616d 652e 7574  ask.dataframe.ut
+00008140: 696c 732e 6d61 6b65 5f6d 6574 6160 602e  ils.make_meta``.
+00008150: 0a0a 2020 2020 2020 2020 4865 7265 2077  ..        Here w
+00008160: 6520 7370 6563 6966 7920 7468 6520 6f75  e specify the ou
+00008170: 7470 7574 2069 7320 6120 5365 7269 6573  tput is a Series
+00008180: 2077 6974 6820 6e6f 206e 616d 652c 2061   with no name, a
+00008190: 6e64 2064 7479 7065 0a20 2020 2020 2020  nd dtype.       
+000081a0: 2060 6066 6c6f 6174 3634 6060 3a0a 0a20   ``float64``:.. 
+000081b0: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+000081c0: 2064 6466 2e6d 6170 5f70 6172 7469 7469   ddf.map_partiti
+000081d0: 6f6e 7328 6d79 6164 642c 2031 2c20 623d  ons(myadd, 1, b=
+000081e0: 322c 206d 6574 613d 284e 6f6e 652c 2027  2, meta=(None, '
+000081f0: 6638 2729 290a 0a20 2020 2020 2020 2048  f8'))..        H
+00008200: 6572 6520 7765 206d 6170 2061 2066 756e  ere we map a fun
+00008210: 6374 696f 6e20 7468 6174 2074 616b 6573  ction that takes
+00008220: 2069 6e20 6120 4461 7461 4672 616d 652c   in a DataFrame,
+00008230: 2061 6e64 2072 6574 7572 6e73 2061 0a20   and returns a. 
+00008240: 2020 2020 2020 2044 6174 6146 7261 6d65         DataFrame
+00008250: 2077 6974 6820 6120 6e65 7720 636f 6c75   with a new colu
+00008260: 6d6e 3a0a 0a20 2020 2020 2020 203e 3e3e  mn:..        >>>
+00008270: 2072 6573 203d 2064 6466 2e6d 6170 5f70   res = ddf.map_p
+00008280: 6172 7469 7469 6f6e 7328 6c61 6d62 6461  artitions(lambda
+00008290: 2064 663a 2064 662e 6173 7369 676e 287a   df: df.assign(z
+000082a0: 3d64 662e 7820 2a20 6466 2e79 2929 0a20  =df.x * df.y)). 
+000082b0: 2020 2020 2020 203e 3e3e 2072 6573 2e64         >>> res.d
+000082c0: 7479 7065 730a 2020 2020 2020 2020 7820  types.        x 
+000082d0: 2020 2020 2069 6e74 3634 0a20 2020 2020       int64.     
+000082e0: 2020 2079 2020 2020 666c 6f61 7436 340a     y    float64.
+000082f0: 2020 2020 2020 2020 7a20 2020 2066 6c6f          z    flo
+00008300: 6174 3634 0a20 2020 2020 2020 2064 7479  at64.        dty
+00008310: 7065 3a20 6f62 6a65 6374 0a0a 2020 2020  pe: object..    
+00008320: 2020 2020 4173 2062 6566 6f72 652c 2074      As before, t
+00008330: 6865 206f 7574 7075 7420 6d65 7461 6461  he output metada
+00008340: 7461 2063 616e 2061 6c73 6f20 6265 2073  ta can also be s
+00008350: 7065 6369 6669 6564 206d 616e 7561 6c6c  pecified manuall
+00008360: 792e 2054 6869 730a 2020 2020 2020 2020  y. This.        
+00008370: 7469 6d65 2077 6520 7061 7373 2069 6e20  time we pass in 
+00008380: 6120 6060 6469 6374 6060 2c20 6173 2074  a ``dict``, as t
+00008390: 6865 206f 7574 7075 7420 6973 2061 2044  he output is a D
+000083a0: 6174 6146 7261 6d65 3a0a 0a20 2020 2020  ataFrame:..     
+000083b0: 2020 203e 3e3e 2072 6573 203d 2064 6466     >>> res = ddf
+000083c0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+000083d0: 6c61 6d62 6461 2064 663a 2064 662e 6173  lambda df: df.as
+000083e0: 7369 676e 287a 3d64 662e 7820 2a20 6466  sign(z=df.x * df
+000083f0: 2e79 292c 0a20 2020 2020 2020 202e 2e2e  .y),.        ...
+00008400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008410: 2020 2020 2020 2020 2020 6d65 7461 3d7b            meta={
+00008420: 2778 273a 2027 6938 272c 2027 7927 3a20  'x': 'i8', 'y': 
+00008430: 2766 3827 2c20 277a 273a 2027 6638 277d  'f8', 'z': 'f8'}
+00008440: 290a 0a20 2020 2020 2020 2049 6e20 7468  )..        In th
+00008450: 6520 6361 7365 2077 6865 7265 2074 6865  e case where the
+00008460: 206d 6574 6164 6174 6120 646f 6573 6e27   metadata doesn'
+00008470: 7420 6368 616e 6765 2c20 796f 7520 6361  t change, you ca
+00008480: 6e20 616c 736f 2070 6173 7320 696e 0a20  n also pass in. 
+00008490: 2020 2020 2020 2074 6865 206f 626a 6563         the objec
+000084a0: 7420 6974 7365 6c66 2064 6972 6563 746c  t itself directl
+000084b0: 793a 0a0a 2020 2020 2020 2020 3e3e 3e20  y:..        >>> 
+000084c0: 7265 7320 3d20 6464 662e 6d61 705f 7061  res = ddf.map_pa
+000084d0: 7274 6974 696f 6e73 286c 616d 6264 6120  rtitions(lambda 
+000084e0: 6466 3a20 6466 2e68 6561 6428 292c 206d  df: df.head(), m
+000084f0: 6574 613d 6464 6629 0a0a 2020 2020 2020  eta=ddf)..      
+00008500: 2020 416c 736f 206e 6f74 6520 7468 6174    Also note that
+00008510: 2074 6865 2069 6e64 6578 2061 6e64 2064   the index and d
+00008520: 6976 6973 696f 6e73 2061 7265 2061 7373  ivisions are ass
+00008530: 756d 6564 2074 6f20 7265 6d61 696e 2075  umed to remain u
+00008540: 6e63 6861 6e67 6564 2e0a 2020 2020 2020  nchanged..      
+00008550: 2020 4966 2074 6865 2066 756e 6374 696f    If the functio
+00008560: 6e20 796f 7527 7265 206d 6170 7069 6e67  n you're mapping
+00008570: 2063 6861 6e67 6573 2074 6865 2069 6e64   changes the ind
+00008580: 6578 2f64 6976 6973 696f 6e73 2c20 796f  ex/divisions, yo
+00008590: 7527 6c6c 206e 6565 640a 2020 2020 2020  u'll need.      
+000085a0: 2020 746f 2063 6c65 6172 2074 6865 6d20    to clear them 
+000085b0: 6166 7465 7277 6172 6473 3a0a 0a20 2020  afterwards:..   
+000085c0: 2020 2020 203e 3e3e 2064 6466 2e6d 6170       >>> ddf.map
+000085d0: 5f70 6172 7469 7469 6f6e 7328 6675 6e63  _partitions(func
+000085e0: 292e 636c 6561 725f 6469 7669 7369 6f6e  ).clear_division
+000085f0: 7328 2920 2023 2064 6f63 7465 7374 3a20  s()  # doctest: 
+00008600: 2b53 4b49 500a 0a20 2020 2020 2020 2059  +SKIP..        Y
+00008610: 6f75 7220 6d61 7020 6675 6e63 7469 6f6e  our map function
+00008620: 2067 6574 7320 696e 666f 726d 6174 696f   gets informatio
+00008630: 6e20 6162 6f75 7420 7768 6572 6520 6974  n about where it
+00008640: 2069 7320 696e 2074 6865 2064 6174 6166   is in the dataf
+00008650: 7261 6d65 2062 790a 2020 2020 2020 2020  rame by.        
+00008660: 6163 6365 7074 696e 6720 6120 7370 6563  accepting a spec
+00008670: 6961 6c20 6060 7061 7274 6974 696f 6e5f  ial ``partition_
+00008680: 696e 666f 6060 206b 6579 776f 7264 2061  info`` keyword a
+00008690: 7267 756d 656e 742e 0a0a 2020 2020 2020  rgument...      
+000086a0: 2020 3e3e 3e20 6465 6620 6675 6e63 2870    >>> def func(p
+000086b0: 6172 7469 7469 6f6e 2c20 7061 7274 6974  artition, partit
+000086c0: 696f 6e5f 696e 666f 3d4e 6f6e 6529 3a0a  ion_info=None):.
+000086d0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+000086e0: 7061 7373 0a0a 2020 2020 2020 2020 5468  pass..        Th
+000086f0: 6973 2077 696c 6c20 7265 6365 6976 6520  is will receive 
+00008700: 7468 6520 666f 6c6c 6f77 696e 6720 696e  the following in
+00008710: 666f 726d 6174 696f 6e3a 0a0a 2020 2020  formation:..    
+00008720: 2020 2020 3e3e 3e20 7061 7274 6974 696f      >>> partitio
+00008730: 6e5f 696e 666f 2020 2320 646f 6374 6573  n_info  # doctes
+00008740: 743a 202b 534b 4950 0a20 2020 2020 2020  t: +SKIP.       
+00008750: 207b 276e 756d 6265 7227 3a20 312c 2027   {'number': 1, '
+00008760: 6469 7669 7369 6f6e 273a 2033 7d0a 0a20  division': 3}.. 
+00008770: 2020 2020 2020 2046 6f72 2065 6163 6820         For each 
+00008780: 6172 6775 6d65 6e74 2061 6e64 206b 6579  argument and key
+00008790: 776f 7264 2061 7267 756d 656e 7473 2074  word arguments t
+000087a0: 6861 7420 6172 6520 6461 736b 2064 6174  hat are dask dat
+000087b0: 6166 7261 6d65 7320 796f 7520 7769 6c6c  aframes you will
+000087c0: 0a20 2020 2020 2020 2072 6563 6569 7665  .        receive
+000087d0: 2074 6865 206e 756d 6265 7220 286e 2920   the number (n) 
+000087e0: 7768 6963 6820 7265 7072 6573 656e 7473  which represents
+000087f0: 2074 6865 206e 7468 2070 6172 7469 7469   the nth partiti
+00008800: 6f6e 206f 6620 7468 6520 6461 7461 6672  on of the datafr
+00008810: 616d 650a 2020 2020 2020 2020 616e 6420  ame.        and 
+00008820: 7468 6520 6469 7669 7369 6f6e 2028 7468  the division (th
+00008830: 6520 6669 7273 7420 696e 6465 7820 7661  e first index va
+00008840: 6c75 6520 696e 2074 6865 2070 6172 7469  lue in the parti
+00008850: 7469 6f6e 292e 2049 6620 6469 7669 7369  tion). If divisi
+00008860: 6f6e 730a 2020 2020 2020 2020 6172 6520  ons.        are 
+00008870: 6e6f 7420 6b6e 6f77 6e20 2866 6f72 2069  not known (for i
+00008880: 6e73 7461 6e63 6520 6966 2074 6865 2069  nstance if the i
+00008890: 6e64 6578 2069 7320 6e6f 7420 736f 7274  ndex is not sort
+000088a0: 6564 2920 7468 656e 2079 6f75 2077 696c  ed) then you wil
+000088b0: 6c20 6765 740a 2020 2020 2020 2020 4e6f  l get.        No
+000088c0: 6e65 2061 7320 7468 6520 6469 7669 7369  ne as the divisi
+000088d0: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
+000088e0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+000088f0: 6170 5f70 6172 7469 7469 6f6e 7328 6675  ap_partitions(fu
+00008900: 6e63 2c20 7365 6c66 2c20 2a61 7267 732c  nc, self, *args,
+00008910: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
+00008920: 4069 6e73 6572 745f 6d65 7461 5f70 6172  @insert_meta_par
+00008930: 616d 5f64 6573 6372 6970 7469 6f6e 2870  am_description(p
+00008940: 6164 3d31 3229 0a20 2020 2064 6566 206d  ad=12).    def m
+00008950: 6170 5f6f 7665 726c 6170 2873 656c 662c  ap_overlap(self,
+00008960: 2066 756e 632c 2062 6566 6f72 652c 2061   func, before, a
+00008970: 6674 6572 2c20 2a61 7267 732c 202a 2a6b  fter, *args, **k
+00008980: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00008990: 2222 2241 7070 6c79 2061 2066 756e 6374  """Apply a funct
+000089a0: 696f 6e20 746f 2065 6163 6820 7061 7274  ion to each part
+000089b0: 6974 696f 6e2c 2073 6861 7269 6e67 2072  ition, sharing r
+000089c0: 6f77 7320 7769 7468 2061 646a 6163 656e  ows with adjacen
+000089d0: 7420 7061 7274 6974 696f 6e73 2e0a 0a20  t partitions... 
+000089e0: 2020 2020 2020 2054 6869 7320 6361 6e20         This can 
+000089f0: 6265 2075 7365 6675 6c20 666f 7220 696d  be useful for im
+00008a00: 706c 656d 656e 7469 6e67 2077 696e 646f  plementing windo
+00008a10: 7769 6e67 2066 756e 6374 696f 6e73 2073  wing functions s
+00008a20: 7563 6820 6173 0a20 2020 2020 2020 2060  uch as.        `
+00008a30: 6064 662e 726f 6c6c 696e 6728 2e2e 2e29  `df.rolling(...)
+00008a40: 2e6d 6561 6e28 2960 6020 6f72 2060 6064  .mean()`` or ``d
+00008a50: 662e 6469 6666 2829 6060 2e0a 0a20 2020  f.diff()``...   
+00008a60: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00008a70: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00008a80: 2d2d 0a20 2020 2020 2020 2066 756e 6320  --.        func 
+00008a90: 3a20 6675 6e63 7469 6f6e 0a20 2020 2020  : function.     
+00008aa0: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
+00008ab0: 6170 706c 6965 6420 746f 2065 6163 6820  applied to each 
+00008ac0: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
+00008ad0: 2020 2062 6566 6f72 6520 3a20 696e 742c     before : int,
+00008ae0: 2074 696d 6564 656c 7461 206f 7220 7374   timedelta or st
+00008af0: 7269 6e67 2074 696d 6564 656c 7461 0a20  ring timedelta. 
+00008b00: 2020 2020 2020 2020 2020 2054 6865 2072             The r
+00008b10: 6f77 7320 746f 2070 7265 7065 6e64 2074  ows to prepend t
+00008b20: 6f20 7061 7274 6974 696f 6e20 6060 6960  o partition ``i`
+00008b30: 6020 6672 6f6d 2074 6865 2065 6e64 206f  ` from the end o
+00008b40: 660a 2020 2020 2020 2020 2020 2020 7061  f.            pa
+00008b50: 7274 6974 696f 6e20 6060 6920 2d20 3160  rtition ``i - 1`
+00008b60: 602e 0a20 2020 2020 2020 2061 6674 6572  `..        after
+00008b70: 203a 2069 6e74 2c20 7469 6d65 6465 6c74   : int, timedelt
+00008b80: 6120 6f72 2073 7472 696e 6720 7469 6d65  a or string time
+00008b90: 6465 6c74 610a 2020 2020 2020 2020 2020  delta.          
+00008ba0: 2020 5468 6520 726f 7773 2074 6f20 6170    The rows to ap
+00008bb0: 7065 6e64 2074 6f20 7061 7274 6974 696f  pend to partitio
+00008bc0: 6e20 6060 6960 6020 6672 6f6d 2074 6865  n ``i`` from the
+00008bd0: 2062 6567 696e 6e69 6e67 0a20 2020 2020   beginning.     
+00008be0: 2020 2020 2020 206f 6620 7061 7274 6974         of partit
+00008bf0: 696f 6e20 6060 6920 2b20 3160 602e 0a20  ion ``i + 1``.. 
+00008c00: 2020 2020 2020 2061 7267 732c 206b 7761         args, kwa
+00008c10: 7267 7320 3a0a 2020 2020 2020 2020 2020  rgs :.          
+00008c20: 2020 506f 7369 7469 6f6e 616c 2061 6e64    Positional and
+00008c30: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
+00008c40: 7473 2074 6f20 7061 7373 2074 6f20 7468  ts to pass to th
+00008c50: 6520 6675 6e63 7469 6f6e 2e0a 2020 2020  e function..    
+00008c60: 2020 2020 2020 2020 506f 7369 7469 6f6e          Position
+00008c70: 616c 2061 7267 756d 656e 7473 2061 7265  al arguments are
+00008c80: 2063 6f6d 7075 7465 6420 6f6e 2061 2070   computed on a p
+00008c90: 6572 2d70 6172 7469 7469 6f6e 2062 6173  er-partition bas
+00008ca0: 6973 2c20 7768 696c 650a 2020 2020 2020  is, while.      
+00008cb0: 2020 2020 2020 6b65 7977 6f72 6420 6172        keyword ar
+00008cc0: 6775 6d65 6e74 7320 6172 6520 7368 6172  guments are shar
+00008cd0: 6564 2061 6372 6f73 7320 616c 6c20 7061  ed across all pa
+00008ce0: 7274 6974 696f 6e73 2e20 5468 6520 7061  rtitions. The pa
+00008cf0: 7274 6974 696f 6e0a 2020 2020 2020 2020  rtition.        
+00008d00: 2020 2020 6974 7365 6c66 2077 696c 6c20      itself will 
+00008d10: 6265 2074 6865 2066 6972 7374 2070 6f73  be the first pos
+00008d20: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
+00008d30: 2c20 7769 7468 2061 6c6c 206f 7468 6572  , with all other
+00008d40: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
+00008d50: 756d 656e 7473 2070 6173 7365 6420 2a61  uments passed *a
+00008d60: 6674 6572 2a2e 2041 7267 756d 656e 7473  fter*. Arguments
+00008d70: 2063 616e 2062 6520 6060 5363 616c 6172   can be ``Scalar
+00008d80: 6060 2c20 6060 4465 6c61 7965 6460 602c  ``, ``Delayed``,
+00008d90: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
+00008da0: 7265 6775 6c61 7220 5079 7468 6f6e 206f  regular Python o
+00008db0: 626a 6563 7473 2e20 4461 7461 4672 616d  bjects. DataFram
+00008dc0: 652d 6c69 6b65 2061 7267 7320 2862 6f74  e-like args (bot
+00008dd0: 6820 6461 736b 2061 6e64 0a20 2020 2020  h dask and.     
+00008de0: 2020 2020 2020 2070 616e 6461 7329 2077         pandas) w
+00008df0: 696c 6c20 6265 2072 6570 6172 7469 7469  ill be repartiti
+00008e00: 6f6e 6564 2074 6f20 616c 6967 6e20 2869  oned to align (i
+00008e10: 6620 6e65 6365 7373 6172 7929 2062 6566  f necessary) bef
+00008e20: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
+00008e30: 6170 706c 7969 6e67 2074 6865 2066 756e  applying the fun
+00008e40: 6374 696f 6e3b 2073 6565 2060 6061 6c69  ction; see ``ali
+00008e50: 676e 5f64 6174 6166 7261 6d65 7360 6020  gn_dataframes`` 
+00008e60: 746f 2063 6f6e 7472 6f6c 2074 6869 730a  to control this.
+00008e70: 2020 2020 2020 2020 2020 2020 6265 6861              beha
+00008e80: 7669 6f72 2e0a 2020 2020 2020 2020 656e  vior..        en
+00008e90: 666f 7263 655f 6d65 7461 6461 7461 203a  force_metadata :
+00008ea0: 2062 6f6f 6c2c 2064 6566 6175 6c74 2054   bool, default T
+00008eb0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+00008ec0: 5768 6574 6865 7220 746f 2065 6e66 6f72  Whether to enfor
+00008ed0: 6365 2061 7420 7275 6e74 696d 6520 7468  ce at runtime th
+00008ee0: 6174 2074 6865 2073 7472 7563 7475 7265  at the structure
+00008ef0: 206f 6620 7468 6520 4461 7461 4672 616d   of the DataFram
+00008f00: 650a 2020 2020 2020 2020 2020 2020 7072  e.            pr
+00008f10: 6f64 7563 6564 2062 7920 6060 6675 6e63  oduced by ``func
+00008f20: 6060 2061 6374 7561 6c6c 7920 6d61 7463  `` actually matc
+00008f30: 6865 7320 7468 6520 7374 7275 6374 7572  hes the structur
+00008f40: 6520 6f66 2060 606d 6574 6160 602e 0a20  e of ``meta``.. 
+00008f50: 2020 2020 2020 2020 2020 2054 6869 7320             This 
+00008f60: 7769 6c6c 2072 656e 616d 6520 616e 6420  will rename and 
+00008f70: 7265 6f72 6465 7220 636f 6c75 6d6e 7320  reorder columns 
+00008f80: 666f 7220 6561 6368 2070 6172 7469 7469  for each partiti
+00008f90: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00008fa0: 616e 6420 7769 6c6c 2072 6169 7365 2061  and will raise a
+00008fb0: 6e20 6572 726f 7220 6966 2074 6869 7320  n error if this 
+00008fc0: 646f 6573 6e27 7420 776f 726b 2c0a 2020  doesn't work,.  
+00008fd0: 2020 2020 2020 2020 2020 6275 7420 6974            but it
+00008fe0: 2077 6f6e 2774 2072 6169 7365 2069 6620   won't raise if 
+00008ff0: 6474 7970 6573 2064 6f6e 2774 206d 6174  dtypes don't mat
+00009000: 6368 2e0a 2020 2020 2020 2020 7472 616e  ch..        tran
+00009010: 7366 6f72 6d5f 6469 7669 7369 6f6e 7320  sform_divisions 
+00009020: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+00009030: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00009040: 2057 6865 7468 6572 2074 6f20 6170 706c   Whether to appl
+00009050: 7920 7468 6520 6675 6e63 7469 6f6e 206f  y the function o
+00009060: 6e74 6f20 7468 6520 6469 7669 7369 6f6e  nto the division
+00009070: 7320 616e 6420 6170 706c 7920 7468 6f73  s and apply thos
+00009080: 650a 2020 2020 2020 2020 2020 2020 7472  e.            tr
+00009090: 616e 7366 6f72 6d65 6420 6469 7669 7369  ansformed divisi
+000090a0: 6f6e 7320 746f 2074 6865 206f 7574 7075  ons to the outpu
+000090b0: 742e 0a20 2020 2020 2020 2061 6c69 676e  t..        align
+000090c0: 5f64 6174 6166 7261 6d65 7320 3a20 626f  _dataframes : bo
+000090d0: 6f6c 2c20 6465 6661 756c 7420 5472 7565  ol, default True
+000090e0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+000090f0: 7468 6572 2074 6f20 7265 7061 7274 6974  ther to repartit
+00009100: 696f 6e20 4461 7461 4672 616d 652d 206f  ion DataFrame- o
+00009110: 7220 5365 7269 6573 2d6c 696b 6520 6172  r Series-like ar
+00009120: 6773 0a20 2020 2020 2020 2020 2020 2028  gs.            (
+00009130: 626f 7468 2064 6173 6b20 616e 6420 7061  both dask and pa
+00009140: 6e64 6173 2920 736f 2074 6865 6972 2064  ndas) so their d
+00009150: 6976 6973 696f 6e73 2061 6c69 676e 2062  ivisions align b
+00009160: 6566 6f72 6520 6170 706c 7969 6e67 0a20  efore applying. 
+00009170: 2020 2020 2020 2020 2020 2074 6865 2066             the f
+00009180: 756e 6374 696f 6e2e 2054 6869 7320 7265  unction. This re
+00009190: 7175 6972 6573 2061 6c6c 2069 6e70 7574  quires all input
+000091a0: 7320 746f 2068 6176 6520 6b6e 6f77 6e20  s to have known 
+000091b0: 6469 7669 7369 6f6e 732e 0a20 2020 2020  divisions..     
+000091c0: 2020 2020 2020 2053 696e 676c 652d 7061         Single-pa
+000091d0: 7274 6974 696f 6e20 696e 7075 7473 2077  rtition inputs w
+000091e0: 696c 6c20 6265 2073 706c 6974 2069 6e74  ill be split int
+000091f0: 6f20 6d75 6c74 6970 6c65 2070 6172 7469  o multiple parti
+00009200: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
+00009210: 2020 2020 4966 2046 616c 7365 2c20 616c      If False, al
+00009220: 6c20 696e 7075 7473 206d 7573 7420 6861  l inputs must ha
+00009230: 7665 2065 6974 6865 7220 7468 6520 7361  ve either the sa
+00009240: 6d65 206e 756d 6265 7220 6f66 2070 6172  me number of par
+00009250: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
+00009260: 2020 2020 6f72 2061 2073 696e 676c 6520      or a single 
+00009270: 7061 7274 6974 696f 6e2e 2053 696e 676c  partition. Singl
+00009280: 652d 7061 7274 6974 696f 6e20 696e 7075  e-partition inpu
+00009290: 7473 2077 696c 6c20 6265 2062 726f 6164  ts will be broad
+000092a0: 6361 7374 2074 6f0a 2020 2020 2020 2020  cast to.        
+000092b0: 2020 2020 6576 6572 7920 7061 7274 6974      every partit
+000092c0: 696f 6e20 6f66 206d 756c 7469 2d70 6172  ion of multi-par
+000092d0: 7469 7469 6f6e 2069 6e70 7574 732e 0a20  tition inputs.. 
+000092e0: 2020 2020 2020 2024 4d45 5441 0a0a 2020         $META..  
+000092f0: 2020 2020 2020 4e6f 7465 730a 2020 2020        Notes.    
+00009300: 2020 2020 2d2d 2d2d 2d0a 2020 2020 2020      -----.      
+00009310: 2020 4769 7665 6e20 706f 7369 7469 7665    Given positive
+00009320: 2069 6e74 6567 6572 7320 6060 6265 666f   integers ``befo
+00009330: 7265 6060 2061 6e64 2060 6061 6674 6572  re`` and ``after
+00009340: 6060 2c20 616e 6420 6120 6675 6e63 7469  ``, and a functi
+00009350: 6f6e 0a20 2020 2020 2020 2060 6066 756e  on.        ``fun
+00009360: 6360 602c 2060 606d 6170 5f6f 7665 726c  c``, ``map_overl
+00009370: 6170 6060 2064 6f65 7320 7468 6520 666f  ap`` does the fo
+00009380: 6c6c 6f77 696e 673a 0a0a 2020 2020 2020  llowing:..      
+00009390: 2020 312e 2050 7265 7065 6e64 2060 6062    1. Prepend ``b
+000093a0: 6566 6f72 6560 6020 726f 7773 2074 6f20  efore`` rows to 
+000093b0: 6561 6368 2070 6172 7469 7469 6f6e 2060  each partition `
+000093c0: 6069 6060 2066 726f 6d20 7468 6520 656e  `i`` from the en
+000093d0: 6420 6f66 0a20 2020 2020 2020 2020 2020  d of.           
+000093e0: 7061 7274 6974 696f 6e20 6060 6920 2d20  partition ``i - 
+000093f0: 3160 602e 2054 6865 2066 6972 7374 2070  1``. The first p
+00009400: 6172 7469 7469 6f6e 2068 6173 206e 6f20  artition has no 
+00009410: 726f 7773 2070 7265 7065 6e64 6564 2e0a  rows prepended..
+00009420: 0a20 2020 2020 2020 2032 2e20 4170 7065  .        2. Appe
+00009430: 6e64 2060 6061 6674 6572 6060 2072 6f77  nd ``after`` row
+00009440: 7320 746f 2065 6163 6820 7061 7274 6974  s to each partit
+00009450: 696f 6e20 6060 6960 6020 6672 6f6d 2074  ion ``i`` from t
+00009460: 6865 2062 6567 696e 6e69 6e67 206f 660a  he beginning of.
+00009470: 2020 2020 2020 2020 2020 2070 6172 7469             parti
+00009480: 7469 6f6e 2060 6069 202b 2031 6060 2e20  tion ``i + 1``. 
+00009490: 5468 6520 6c61 7374 2070 6172 7469 7469  The last partiti
+000094a0: 6f6e 2068 6173 206e 6f20 726f 7773 2061  on has no rows a
+000094b0: 7070 656e 6465 642e 0a0a 2020 2020 2020  ppended...      
+000094c0: 2020 332e 2041 7070 6c79 2060 6066 756e    3. Apply ``fun
+000094d0: 6360 6020 746f 2065 6163 6820 7061 7274  c`` to each part
+000094e0: 6974 696f 6e2c 2070 6173 7369 6e67 2069  ition, passing i
+000094f0: 6e20 616e 7920 6578 7472 6120 6060 6172  n any extra ``ar
+00009500: 6773 6060 2061 6e64 0a20 2020 2020 2020  gs`` and.       
+00009510: 2020 2020 6060 6b77 6172 6773 6060 2069      ``kwargs`` i
+00009520: 6620 7072 6f76 6964 6564 2e0a 0a20 2020  f provided...   
+00009530: 2020 2020 2034 2e20 5472 696d 2060 6062       4. Trim ``b
+00009540: 6566 6f72 6560 6020 726f 7773 2066 726f  efore`` rows fro
+00009550: 6d20 7468 6520 6265 6769 6e6e 696e 6720  m the beginning 
+00009560: 6f66 2061 6c6c 2062 7574 2074 6865 2066  of all but the f
+00009570: 6972 7374 0a20 2020 2020 2020 2020 2020  irst.           
+00009580: 7061 7274 6974 696f 6e2e 0a0a 2020 2020  partition...    
+00009590: 2020 2020 352e 2054 7269 6d20 6060 6166      5. Trim ``af
+000095a0: 7465 7260 6020 726f 7773 2066 726f 6d20  ter`` rows from 
+000095b0: 7468 6520 656e 6420 6f66 2061 6c6c 2062  the end of all b
+000095c0: 7574 2074 6865 206c 6173 7420 7061 7274  ut the last part
+000095d0: 6974 696f 6e2e 0a0a 2020 2020 2020 2020  ition...        
+000095e0: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+000095f0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00009600: 2020 4769 7665 6e20 6120 4461 7461 4672    Given a DataFr
+00009610: 616d 652c 2053 6572 6965 732c 206f 7220  ame, Series, or 
+00009620: 496e 6465 782c 2073 7563 6820 6173 3a0a  Index, such as:.
+00009630: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+00009640: 6f72 7420 7061 6e64 6173 2061 7320 7064  ort pandas as pd
+00009650: 0a20 2020 2020 2020 203e 3e3e 2069 6d70  .        >>> imp
+00009660: 6f72 7420 6461 736b 2e64 6174 6166 7261  ort dask.datafra
+00009670: 6d65 2061 7320 6464 0a20 2020 2020 2020  me as dd.       
+00009680: 203e 3e3e 2064 6620 3d20 7064 2e44 6174   >>> df = pd.Dat
+00009690: 6146 7261 6d65 287b 2778 273a 205b 312c  aFrame({'x': [1,
+000096a0: 2032 2c20 342c 2037 2c20 3131 5d2c 0a20   2, 4, 7, 11],. 
+000096b0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+000096c0: 2020 2020 2020 2020 2020 2020 2020 2779                'y
+000096d0: 273a 205b 312e 2c20 322e 2c20 332e 2c20  ': [1., 2., 3., 
+000096e0: 342e 2c20 352e 5d7d 290a 2020 2020 2020  4., 5.]}).      
+000096f0: 2020 3e3e 3e20 6464 6620 3d20 6464 2e66    >>> ddf = dd.f
+00009700: 726f 6d5f 7061 6e64 6173 2864 662c 206e  rom_pandas(df, n
+00009710: 7061 7274 6974 696f 6e73 3d32 290a 0a20  partitions=2).. 
+00009720: 2020 2020 2020 2041 2072 6f6c 6c69 6e67         A rolling
+00009730: 2073 756d 2077 6974 6820 6120 7472 6169   sum with a trai
+00009740: 6c69 6e67 206d 6f76 696e 6720 7769 6e64  ling moving wind
+00009750: 6f77 206f 6620 7369 7a65 2032 2063 616e  ow of size 2 can
+00009760: 2062 6520 636f 6d70 7574 6564 2062 790a   be computed by.
+00009770: 2020 2020 2020 2020 6f76 6572 6c61 7070          overlapp
+00009780: 696e 6720 3220 726f 7773 2062 6566 6f72  ing 2 rows befor
+00009790: 6520 6561 6368 2070 6172 7469 7469 6f6e  e each partition
+000097a0: 2c20 616e 6420 7468 656e 206d 6170 7069  , and then mappi
+000097b0: 6e67 2063 616c 6c73 2074 6f0a 2020 2020  ng calls to.    
+000097c0: 2020 2020 6060 6466 2e72 6f6c 6c69 6e67      ``df.rolling
+000097d0: 2832 292e 7375 6d28 2960 603a 0a0a 2020  (2).sum()``:..  
+000097e0: 2020 2020 2020 3e3e 3e20 6464 662e 636f        >>> ddf.co
+000097f0: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
+00009800: 2020 2020 7820 2020 2079 0a20 2020 2020      x    y.     
+00009810: 2020 2030 2020 2031 2020 312e 300a 2020     0   1  1.0.  
+00009820: 2020 2020 2020 3120 2020 3220 2032 2e30        1   2  2.0
+00009830: 0a20 2020 2020 2020 2032 2020 2034 2020  .        2   4  
+00009840: 332e 300a 2020 2020 2020 2020 3320 2020  3.0.        3   
+00009850: 3720 2034 2e30 0a20 2020 2020 2020 2034  7  4.0.        4
+00009860: 2020 3131 2020 352e 300a 2020 2020 2020    11  5.0.      
+00009870: 2020 3e3e 3e20 6464 662e 6d61 705f 6f76    >>> ddf.map_ov
+00009880: 6572 6c61 7028 6c61 6d62 6461 2064 663a  erlap(lambda df:
+00009890: 2064 662e 726f 6c6c 696e 6728 3229 2e73   df.rolling(2).s
+000098a0: 756d 2829 2c20 322c 2030 292e 636f 6d70  um(), 2, 0).comp
+000098b0: 7574 6528 290a 2020 2020 2020 2020 2020  ute().          
+000098c0: 2020 2020 7820 2020 2079 0a20 2020 2020      x    y.     
+000098d0: 2020 2030 2020 204e 614e 2020 4e61 4e0a     0   NaN  NaN.
+000098e0: 2020 2020 2020 2020 3120 2020 332e 3020          1   3.0 
+000098f0: 2033 2e30 0a20 2020 2020 2020 2032 2020   3.0.        2  
+00009900: 2036 2e30 2020 352e 300a 2020 2020 2020   6.0  5.0.      
+00009910: 2020 3320 2031 312e 3020 2037 2e30 0a20    3  11.0  7.0. 
+00009920: 2020 2020 2020 2034 2020 3138 2e30 2020         4  18.0  
+00009930: 392e 300a 0a20 2020 2020 2020 2054 6865  9.0..        The
+00009940: 2070 616e 6461 7320 6060 6469 6666 6060   pandas ``diff``
+00009950: 206d 6574 686f 6420 636f 6d70 7574 6573   method computes
+00009960: 2061 2064 6973 6372 6574 6520 6469 6666   a discrete diff
+00009970: 6572 656e 6365 2073 6869 6674 6564 2062  erence shifted b
+00009980: 7920 610a 2020 2020 2020 2020 6e75 6d62  y a.        numb
+00009990: 6572 206f 6620 7065 7269 6f64 7320 2863  er of periods (c
+000099a0: 616e 2062 6520 706f 7369 7469 7665 206f  an be positive o
+000099b0: 7220 6e65 6761 7469 7665 292e 2054 6869  r negative). Thi
+000099c0: 7320 6361 6e20 6265 0a20 2020 2020 2020  s can be.       
+000099d0: 2069 6d70 6c65 6d65 6e74 6564 2062 7920   implemented by 
+000099e0: 6d61 7070 696e 6720 6361 6c6c 7320 746f  mapping calls to
+000099f0: 2060 6064 662e 6469 6666 6060 2074 6f20   ``df.diff`` to 
+00009a00: 6561 6368 2070 6172 7469 7469 6f6e 2061  each partition a
+00009a10: 6674 6572 0a20 2020 2020 2020 2070 7265  fter.        pre
+00009a20: 7065 6e64 696e 672f 6170 7065 6e64 696e  pending/appendin
+00009a30: 6720 7468 6174 206d 616e 7920 726f 7773  g that many rows
+00009a40: 2c20 6465 7065 6e64 696e 6720 6f6e 2073  , depending on s
+00009a50: 6967 6e3a 0a0a 2020 2020 2020 2020 3e3e  ign:..        >>
+00009a60: 3e20 6465 6620 6469 6666 2864 662c 2070  > def diff(df, p
+00009a70: 6572 696f 6473 3d31 293a 0a20 2020 2020  eriods=1):.     
+00009a80: 2020 202e 2e2e 2020 2020 2062 6566 6f72     ...     befor
+00009a90: 652c 2061 6674 6572 203d 2028 7065 7269  e, after = (peri
+00009aa0: 6f64 732c 2030 2920 6966 2070 6572 696f  ods, 0) if perio
+00009ab0: 6473 203e 2030 2065 6c73 6520 2830 2c20  ds > 0 else (0, 
+00009ac0: 2d70 6572 696f 6473 290a 2020 2020 2020  -periods).      
+00009ad0: 2020 2e2e 2e20 2020 2020 7265 7475 726e    ...     return
+00009ae0: 2064 662e 6d61 705f 6f76 6572 6c61 7028   df.map_overlap(
+00009af0: 6c61 6d62 6461 2064 662c 2070 6572 696f  lambda df, perio
+00009b00: 6473 3d31 3a20 6466 2e64 6966 6628 7065  ds=1: df.diff(pe
+00009b10: 7269 6f64 7329 2c0a 2020 2020 2020 2020  riods),.        
+00009b20: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+00009b30: 2020 2020 2020 2020 2020 2020 2020 7065                pe
+00009b40: 7269 6f64 732c 2030 2c20 7065 7269 6f64  riods, 0, period
+00009b50: 733d 7065 7269 6f64 7329 0a20 2020 2020  s=periods).     
+00009b60: 2020 203e 3e3e 2064 6966 6628 6464 662c     >>> diff(ddf,
+00009b70: 2031 292e 636f 6d70 7574 6528 290a 2020   1).compute().  
+00009b80: 2020 2020 2020 2020 2020 2078 2020 2020             x    
+00009b90: 790a 2020 2020 2020 2020 3020 204e 614e  y.        0  NaN
+00009ba0: 2020 4e61 4e0a 2020 2020 2020 2020 3120    NaN.        1 
+00009bb0: 2031 2e30 2020 312e 300a 2020 2020 2020   1.0  1.0.      
+00009bc0: 2020 3220 2032 2e30 2020 312e 300a 2020    2  2.0  1.0.  
+00009bd0: 2020 2020 2020 3320 2033 2e30 2020 312e        3  3.0  1.
+00009be0: 300a 2020 2020 2020 2020 3420 2034 2e30  0.        4  4.0
+00009bf0: 2020 312e 300a 0a20 2020 2020 2020 2049    1.0..        I
+00009c00: 6620 796f 7520 6861 7665 2061 2060 6044  f you have a ``D
+00009c10: 6174 6574 696d 6549 6e64 6578 6060 2c20  atetimeIndex``, 
+00009c20: 796f 7520 6361 6e20 7573 6520 6120 6060  you can use a ``
+00009c30: 7064 2e54 696d 6564 656c 7461 6060 2066  pd.Timedelta`` f
+00009c40: 6f72 2074 696d 652d 0a20 2020 2020 2020  or time-.       
+00009c50: 2062 6173 6564 2077 696e 646f 7773 206f   based windows o
+00009c60: 7220 616e 7920 6060 7064 2e54 696d 6564  r any ``pd.Timed
+00009c70: 656c 7461 6060 2063 6f6e 7665 7274 6962  elta`` convertib
+00009c80: 6c65 2073 7472 696e 673a 0a0a 2020 2020  le string:..    
+00009c90: 2020 2020 3e3e 3e20 7473 203d 2070 642e      >>> ts = pd.
+00009ca0: 5365 7269 6573 2872 616e 6765 2831 3029  Series(range(10)
+00009cb0: 2c20 696e 6465 783d 7064 2e64 6174 655f  , index=pd.date_
+00009cc0: 7261 6e67 6528 2732 3031 3727 2c20 7065  range('2017', pe
+00009cd0: 7269 6f64 733d 3130 2929 0a20 2020 2020  riods=10)).     
+00009ce0: 2020 203e 3e3e 2064 7473 203d 2064 642e     >>> dts = dd.
+00009cf0: 6672 6f6d 5f70 616e 6461 7328 7473 2c20  from_pandas(ts, 
+00009d00: 6e70 6172 7469 7469 6f6e 733d 3229 0a20  npartitions=2). 
+00009d10: 2020 2020 2020 203e 3e3e 2064 7473 2e6d         >>> dts.m
+00009d20: 6170 5f6f 7665 726c 6170 286c 616d 6264  ap_overlap(lambd
+00009d30: 6120 6466 3a20 6466 2e72 6f6c 6c69 6e67  a df: df.rolling
+00009d40: 2827 3244 2729 2e73 756d 2829 2c0a 2020  ('2D').sum(),.  
+00009d50: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00009d60: 2020 2020 2020 2020 2020 7064 2e54 696d            pd.Tim
+00009d70: 6564 656c 7461 2827 3244 2729 2c20 3029  edelta('2D'), 0)
+00009d80: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+00009d90: 2020 2032 3031 372d 3031 2d30 3120 2020     2017-01-01   
+00009da0: 2020 302e 300a 2020 2020 2020 2020 3230    0.0.        20
+00009db0: 3137 2d30 312d 3032 2020 2020 2031 2e30  17-01-02     1.0
+00009dc0: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
+00009dd0: 2d30 3320 2020 2020 332e 300a 2020 2020  -03     3.0.    
+00009de0: 2020 2020 3230 3137 2d30 312d 3034 2020      2017-01-04  
+00009df0: 2020 2035 2e30 0a20 2020 2020 2020 2032     5.0.        2
+00009e00: 3031 372d 3031 2d30 3520 2020 2020 372e  017-01-05     7.
+00009e10: 300a 2020 2020 2020 2020 3230 3137 2d30  0.        2017-0
+00009e20: 312d 3036 2020 2020 2039 2e30 0a20 2020  1-06     9.0.   
+00009e30: 2020 2020 2032 3031 372d 3031 2d30 3720       2017-01-07 
+00009e40: 2020 2031 312e 300a 2020 2020 2020 2020     11.0.        
+00009e50: 3230 3137 2d30 312d 3038 2020 2020 3133  2017-01-08    13
+00009e60: 2e30 0a20 2020 2020 2020 2032 3031 372d  .0.        2017-
+00009e70: 3031 2d30 3920 2020 2031 352e 300a 2020  01-09    15.0.  
+00009e80: 2020 2020 2020 3230 3137 2d30 312d 3130        2017-01-10
+00009e90: 2020 2020 3137 2e30 0a20 2020 2020 2020      17.0.       
+00009ea0: 2046 7265 713a 2044 2c20 6474 7970 653a   Freq: D, dtype:
+00009eb0: 2066 6c6f 6174 3634 0a20 2020 2020 2020   float64.       
+00009ec0: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00009ed0: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
+00009ee0: 2e72 6f6c 6c69 6e67 2069 6d70 6f72 7420  .rolling import 
+00009ef0: 6d61 705f 6f76 6572 6c61 700a 0a20 2020  map_overlap..   
+00009f00: 2020 2020 2072 6574 7572 6e20 6d61 705f       return map_
+00009f10: 6f76 6572 6c61 7028 6675 6e63 2c20 7365  overlap(func, se
+00009f20: 6c66 2c20 6265 666f 7265 2c20 6166 7465  lf, before, afte
+00009f30: 722c 202a 6172 6773 2c20 2a2a 6b77 6172  r, *args, **kwar
+00009f40: 6773 290a 0a20 2020 2064 6566 206d 656d  gs)..    def mem
+00009f50: 6f72 795f 7573 6167 655f 7065 725f 7061  ory_usage_per_pa
+00009f60: 7274 6974 696f 6e28 7365 6c66 2c20 696e  rtition(self, in
+00009f70: 6465 783d 5472 7565 2c20 6465 6570 3d46  dex=True, deep=F
+00009f80: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
+00009f90: 2222 5265 7475 726e 2074 6865 206d 656d  ""Return the mem
+00009fa0: 6f72 7920 7573 6167 6520 6f66 2065 6163  ory usage of eac
+00009fb0: 6820 7061 7274 6974 696f 6e0a 0a20 2020  h partition..   
+00009fc0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00009fd0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00009fe0: 2d2d 0a20 2020 2020 2020 2069 6e64 6578  --.        index
+00009ff0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+0000a000: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0000a010: 2020 5370 6563 6966 6965 7320 7768 6574    Specifies whet
+0000a020: 6865 7220 746f 2069 6e63 6c75 6465 2074  her to include t
+0000a030: 6865 206d 656d 6f72 7920 7573 6167 6520  he memory usage 
+0000a040: 6f66 2074 6865 2069 6e64 6578 2069 6e0a  of the index in.
+0000a050: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000a060: 726e 6564 2053 6572 6965 732e 0a20 2020  rned Series..   
+0000a070: 2020 2020 2064 6565 7020 3a20 626f 6f6c       deep : bool
+0000a080: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
+0000a090: 2020 2020 2020 2020 2020 2020 4966 2054              If T
+0000a0a0: 7275 652c 2069 6e74 726f 7370 6563 7420  rue, introspect 
+0000a0b0: 7468 6520 6461 7461 2064 6565 706c 7920  the data deeply 
+0000a0c0: 6279 2069 6e74 6572 726f 6761 7469 6e67  by interrogating
+0000a0d0: 0a20 2020 2020 2020 2020 2020 2060 606f  .            ``o
+0000a0e0: 626a 6563 7460 6020 6474 7970 6573 2066  bject`` dtypes f
+0000a0f0: 6f72 2073 7973 7465 6d2d 6c65 7665 6c20  or system-level 
+0000a100: 6d65 6d6f 7279 2063 6f6e 7375 6d70 7469  memory consumpti
+0000a110: 6f6e 2c20 616e 6420 696e 636c 7564 650a  on, and include.
+0000a120: 2020 2020 2020 2020 2020 2020 6974 2069              it i
+0000a130: 6e20 7468 6520 7265 7475 726e 6564 2076  n the returned v
+0000a140: 616c 7565 732e 0a0a 2020 2020 2020 2020  alues...        
+0000a150: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+0000a160: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000a170: 5365 7269 6573 0a20 2020 2020 2020 2020  Series.         
+0000a180: 2020 2041 2053 6572 6965 7320 7768 6f73     A Series whos
+0000a190: 6520 696e 6465 7820 6973 2074 6865 2070  e index is the p
+0000a1a0: 6172 7469 7469 6f6e 206e 756d 6265 7220  artition number 
+0000a1b0: 616e 6420 7768 6f73 6520 7661 6c75 6573  and whose values
+0000a1c0: 0a20 2020 2020 2020 2020 2020 2061 7265  .            are
+0000a1d0: 2074 6865 206d 656d 6f72 7920 7573 6167   the memory usag
+0000a1e0: 6520 6f66 2065 6163 6820 7061 7274 6974  e of each partit
+0000a1f0: 696f 6e20 696e 2062 7974 6573 2e0a 2020  ion in bytes..  
+0000a200: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000a210: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+0000a220: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
+0000a230: 2020 2020 2020 2020 2020 746f 7461 6c5f            total_
+0000a240: 6d65 6d5f 7573 6167 652c 2069 6e64 6578  mem_usage, index
+0000a250: 3d69 6e64 6578 2c20 6465 6570 3d64 6565  =index, deep=dee
+0000a260: 700a 2020 2020 2020 2020 292e 636c 6561  p.        ).clea
+0000a270: 725f 6469 7669 7369 6f6e 7328 290a 0a20  r_divisions().. 
+0000a280: 2020 2040 696e 7365 7274 5f6d 6574 615f     @insert_meta_
+0000a290: 7061 7261 6d5f 6465 7363 7269 7074 696f  param_descriptio
+0000a2a0: 6e28 7061 643d 3132 290a 2020 2020 6465  n(pad=12).    de
+0000a2b0: 6620 7265 6475 6374 696f 6e28 0a20 2020  f reduction(.   
+0000a2c0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0000a2d0: 2020 2063 6875 6e6b 2c0a 2020 2020 2020     chunk,.      
+0000a2e0: 2020 6167 6772 6567 6174 653d 4e6f 6e65    aggregate=None
+0000a2f0: 2c0a 2020 2020 2020 2020 636f 6d62 696e  ,.        combin
+0000a300: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
+0000a310: 6d65 7461 3d6e 6f5f 6465 6661 756c 742c  meta=no_default,
+0000a320: 0a20 2020 2020 2020 2074 6f6b 656e 3d4e  .        token=N
+0000a330: 6f6e 652c 0a20 2020 2020 2020 2073 706c  one,.        spl
+0000a340: 6974 5f65 7665 7279 3d4e 6f6e 652c 0a20  it_every=None,. 
+0000a350: 2020 2020 2020 2063 6875 6e6b 5f6b 7761         chunk_kwa
+0000a360: 7267 733d 4e6f 6e65 2c0a 2020 2020 2020  rgs=None,.      
+0000a370: 2020 6167 6772 6567 6174 655f 6b77 6172    aggregate_kwar
+0000a380: 6773 3d4e 6f6e 652c 0a20 2020 2020 2020  gs=None,.       
+0000a390: 2063 6f6d 6269 6e65 5f6b 7761 7267 733d   combine_kwargs=
+0000a3a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2a2a  None,.        **
+0000a3b0: 6b77 6172 6773 2c0a 2020 2020 293a 0a20  kwargs,.    ):. 
+0000a3c0: 2020 2020 2020 2022 2222 4765 6e65 7269         """Generi
+0000a3d0: 6320 726f 772d 7769 7365 2072 6564 7563  c row-wise reduc
+0000a3e0: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
+0000a3f0: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+0000a400: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0000a410: 2020 2020 2020 6368 756e 6b20 3a20 6361        chunk : ca
+0000a420: 6c6c 6162 6c65 0a20 2020 2020 2020 2020  llable.         
+0000a430: 2020 2046 756e 6374 696f 6e20 746f 206f     Function to o
+0000a440: 7065 7261 7465 206f 6e20 6561 6368 2070  perate on each p
+0000a450: 6172 7469 7469 6f6e 2e20 5368 6f75 6c64  artition. Should
+0000a460: 2072 6574 7572 6e20 610a 2020 2020 2020   return a.      
+0000a470: 2020 2020 2020 6060 7061 6e64 6173 2e44        ``pandas.D
+0000a480: 6174 6146 7261 6d65 6060 2c20 6060 7061  ataFrame``, ``pa
+0000a490: 6e64 6173 2e53 6572 6965 7360 602c 206f  ndas.Series``, o
+0000a4a0: 7220 6120 7363 616c 6172 2e0a 2020 2020  r a scalar..    
+0000a4b0: 2020 2020 6167 6772 6567 6174 6520 3a20      aggregate : 
+0000a4c0: 6361 6c6c 6162 6c65 2c20 6f70 7469 6f6e  callable, option
+0000a4d0: 616c 0a20 2020 2020 2020 2020 2020 2046  al.            F
+0000a4e0: 756e 6374 696f 6e20 746f 206f 7065 7261  unction to opera
+0000a4f0: 7465 206f 6e20 7468 6520 636f 6e63 6174  te on the concat
+0000a500: 656e 6174 6564 2072 6573 756c 7420 6f66  enated result of
+0000a510: 2060 6063 6875 6e6b 6060 2e20 4966 206e   ``chunk``. If n
+0000a520: 6f74 0a20 2020 2020 2020 2020 2020 2073  ot.            s
+0000a530: 7065 6369 6669 6564 2c20 6465 6661 756c  pecified, defaul
+0000a540: 7473 2074 6f20 6060 6368 756e 6b60 602e  ts to ``chunk``.
+0000a550: 2055 7365 6420 746f 2064 6f20 7468 6520   Used to do the 
+0000a560: 6669 6e61 6c20 6167 6772 6567 6174 696f  final aggregatio
+0000a570: 6e0a 2020 2020 2020 2020 2020 2020 696e  n.            in
+0000a580: 2061 2074 7265 6520 7265 6475 6374 696f   a tree reductio
+0000a590: 6e2e 0a0a 2020 2020 2020 2020 2020 2020  n...            
+0000a5a0: 5468 6520 696e 7075 7420 746f 2060 6061  The input to ``a
+0000a5b0: 6767 7265 6761 7465 6060 2064 6570 656e  ggregate`` depen
+0000a5c0: 6473 206f 6e20 7468 6520 6f75 7470 7574  ds on the output
+0000a5d0: 206f 6620 6060 6368 756e 6b60 602e 0a20   of ``chunk``.. 
+0000a5e0: 2020 2020 2020 2020 2020 2049 6620 7468             If th
+0000a5f0: 6520 6f75 7470 7574 206f 6620 6060 6368  e output of ``ch
+0000a600: 756e 6b60 6020 6973 2061 3a0a 0a20 2020  unk`` is a:..   
+0000a610: 2020 2020 2020 2020 202d 2073 6361 6c61           - scala
+0000a620: 723a 2049 6e70 7574 2069 7320 6120 5365  r: Input is a Se
+0000a630: 7269 6573 2c20 7769 7468 206f 6e65 2072  ries, with one r
+0000a640: 6f77 2070 6572 2070 6172 7469 7469 6f6e  ow per partition
+0000a650: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0000a660: 5365 7269 6573 3a20 496e 7075 7420 6973  Series: Input is
+0000a670: 2061 2044 6174 6146 7261 6d65 2c20 7769   a DataFrame, wi
+0000a680: 7468 206f 6e65 2072 6f77 2070 6572 2070  th one row per p
+0000a690: 6172 7469 7469 6f6e 2e20 436f 6c75 6d6e  artition. Column
+0000a6a0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+0000a6b0: 6172 6520 7468 6520 726f 7773 2069 6e20  are the rows in 
+0000a6c0: 7468 6520 6f75 7470 7574 2073 6572 6965  the output serie
+0000a6d0: 732e 0a20 2020 2020 2020 2020 2020 202d  s..            -
+0000a6e0: 2044 6174 6146 7261 6d65 3a20 496e 7075   DataFrame: Inpu
+0000a6f0: 7420 6973 2061 2044 6174 6146 7261 6d65  t is a DataFrame
+0000a700: 2c20 7769 7468 206f 6e65 2072 6f77 2070  , with one row p
+0000a710: 6572 2070 6172 7469 7469 6f6e 2e0a 2020  er partition..  
+0000a720: 2020 2020 2020 2020 2020 2020 436f 6c75              Colu
+0000a730: 6d6e 7320 6172 6520 7468 6520 636f 6c75  mns are the colu
+0000a740: 6d6e 7320 696e 2074 6865 206f 7574 7075  mns in the outpu
+0000a750: 7420 6461 7461 6672 616d 6573 2e0a 0a20  t dataframes... 
+0000a760: 2020 2020 2020 2020 2020 2053 686f 756c             Shoul
+0000a770: 6420 7265 7475 726e 2061 2060 6070 616e  d return a ``pan
+0000a780: 6461 732e 4461 7461 4672 616d 6560 602c  das.DataFrame``,
+0000a790: 2060 6070 616e 6461 732e 5365 7269 6573   ``pandas.Series
+0000a7a0: 6060 2c20 6f72 2061 0a20 2020 2020 2020  ``, or a.       
+0000a7b0: 2020 2020 2073 6361 6c61 722e 0a20 2020       scalar..   
+0000a7c0: 2020 2020 2063 6f6d 6269 6e65 203a 2063       combine : c
+0000a7d0: 616c 6c61 626c 652c 206f 7074 696f 6e61  allable, optiona
+0000a7e0: 6c0a 2020 2020 2020 2020 2020 2020 4675  l.            Fu
+0000a7f0: 6e63 7469 6f6e 2074 6f20 6f70 6572 6174  nction to operat
+0000a800: 6520 6f6e 2069 6e74 6572 6d65 6469 6174  e on intermediat
+0000a810: 6520 636f 6e63 6174 656e 6174 6564 2072  e concatenated r
+0000a820: 6573 756c 7473 206f 660a 2020 2020 2020  esults of.      
+0000a830: 2020 2020 2020 6060 6368 756e 6b60 6020        ``chunk`` 
+0000a840: 696e 2061 2074 7265 652d 7265 6475 6374  in a tree-reduct
+0000a850: 696f 6e2e 2049 6620 6e6f 7420 7072 6f76  ion. If not prov
+0000a860: 6964 6564 2c20 6465 6661 756c 7473 2074  ided, defaults t
+0000a870: 6f0a 2020 2020 2020 2020 2020 2020 6060  o.            ``
+0000a880: 6167 6772 6567 6174 6560 602e 2054 6865  aggregate``. The
+0000a890: 2069 6e70 7574 2f6f 7574 7075 7420 7265   input/output re
+0000a8a0: 7175 6972 656d 656e 7473 2073 686f 756c  quirements shoul
+0000a8b0: 6420 6d61 7463 6820 7468 6174 206f 660a  d match that of.
+0000a8c0: 2020 2020 2020 2020 2020 2020 6060 6167              ``ag
+0000a8d0: 6772 6567 6174 6560 6020 6465 7363 7269  gregate`` descri
+0000a8e0: 6265 6420 6162 6f76 652e 0a20 2020 2020  bed above..     
+0000a8f0: 2020 2024 4d45 5441 0a20 2020 2020 2020     $META.       
+0000a900: 2074 6f6b 656e 203a 2073 7472 2c20 6f70   token : str, op
+0000a910: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+0000a920: 2020 2054 6865 206e 616d 6520 746f 2075     The name to u
+0000a930: 7365 2066 6f72 2074 6865 206f 7574 7075  se for the outpu
+0000a940: 7420 6b65 7973 2e0a 2020 2020 2020 2020  t keys..        
+0000a950: 7370 6c69 745f 6576 6572 7920 3a20 696e  split_every : in
+0000a960: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+0000a970: 2020 2020 2020 2020 4772 6f75 7020 7061          Group pa
+0000a980: 7274 6974 696f 6e73 2069 6e74 6f20 6772  rtitions into gr
+0000a990: 6f75 7073 206f 6620 7468 6973 2073 697a  oups of this siz
+0000a9a0: 6520 7768 696c 6520 7065 7266 6f72 6d69  e while performi
+0000a9b0: 6e67 2061 0a20 2020 2020 2020 2020 2020  ng a.           
+0000a9c0: 2074 7265 652d 7265 6475 6374 696f 6e2e   tree-reduction.
+0000a9d0: 2049 6620 7365 7420 746f 2046 616c 7365   If set to False
+0000a9e0: 2c20 6e6f 2074 7265 652d 7265 6475 6374  , no tree-reduct
+0000a9f0: 696f 6e20 7769 6c6c 2062 6520 7573 6564  ion will be used
+0000aa00: 2c0a 2020 2020 2020 2020 2020 2020 616e  ,.            an
+0000aa10: 6420 616c 6c20 696e 7465 726d 6564 6961  d all intermedia
+0000aa20: 7465 7320 7769 6c6c 2062 6520 636f 6e63  tes will be conc
+0000aa30: 6174 656e 6174 6564 2061 6e64 2070 6173  atenated and pas
+0000aa40: 7365 6420 746f 0a20 2020 2020 2020 2020  sed to.         
+0000aa50: 2020 2060 6061 6767 7265 6761 7465 6060     ``aggregate``
+0000aa60: 2e20 4465 6661 756c 7420 6973 2038 2e0a  . Default is 8..
+0000aa70: 2020 2020 2020 2020 6368 756e 6b5f 6b77          chunk_kw
+0000aa80: 6172 6773 203a 2064 6963 742c 206f 7074  args : dict, opt
+0000aa90: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0000aaa0: 2020 4b65 7977 6f72 6420 6172 6775 6d65    Keyword argume
+0000aab0: 6e74 7320 746f 2070 6173 7320 6f6e 2074  nts to pass on t
+0000aac0: 6f20 6060 6368 756e 6b60 6020 6f6e 6c79  o ``chunk`` only
+0000aad0: 2e0a 2020 2020 2020 2020 6167 6772 6567  ..        aggreg
+0000aae0: 6174 655f 6b77 6172 6773 203a 2064 6963  ate_kwargs : dic
+0000aaf0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+0000ab00: 2020 2020 2020 2020 4b65 7977 6f72 6420          Keyword 
+0000ab10: 6172 6775 6d65 6e74 7320 746f 2070 6173  arguments to pas
+0000ab20: 7320 6f6e 2074 6f20 6060 6167 6772 6567  s on to ``aggreg
+0000ab30: 6174 6560 6020 6f6e 6c79 2e0a 2020 2020  ate`` only..    
+0000ab40: 2020 2020 636f 6d62 696e 655f 6b77 6172      combine_kwar
+0000ab50: 6773 203a 2064 6963 742c 206f 7074 696f  gs : dict, optio
+0000ab60: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0000ab70: 4b65 7977 6f72 6420 6172 6775 6d65 6e74  Keyword argument
+0000ab80: 7320 746f 2070 6173 7320 6f6e 2074 6f20  s to pass on to 
+0000ab90: 6060 636f 6d62 696e 6560 6020 6f6e 6c79  ``combine`` only
+0000aba0: 2e0a 2020 2020 2020 2020 6b77 6172 6773  ..        kwargs
+0000abb0: 203a 0a20 2020 2020 2020 2020 2020 2041   :.            A
+0000abc0: 6c6c 2072 656d 6169 6e69 6e67 206b 6579  ll remaining key
+0000abd0: 776f 7264 7320 7769 6c6c 2062 6520 7061  words will be pa
+0000abe0: 7373 6564 2074 6f20 6060 6368 756e 6b60  ssed to ``chunk`
+0000abf0: 602c 2060 6063 6f6d 6269 6e65 6060 2c0a  `, ``combine``,.
+0000ac00: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+0000ac10: 6060 6167 6772 6567 6174 6560 602e 0a0a  ``aggregate``...
+0000ac20: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+0000ac30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000ac40: 2d0a 2020 2020 2020 2020 3e3e 3e20 696d  -.        >>> im
+0000ac50: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
+0000ac60: 640a 2020 2020 2020 2020 3e3e 3e20 696d  d.        >>> im
+0000ac70: 706f 7274 2064 6173 6b2e 6461 7461 6672  port dask.datafr
+0000ac80: 616d 6520 6173 2064 640a 2020 2020 2020  ame as dd.      
+0000ac90: 2020 3e3e 3e20 6466 203d 2070 642e 4461    >>> df = pd.Da
+0000aca0: 7461 4672 616d 6528 7b27 7827 3a20 7261  taFrame({'x': ra
+0000acb0: 6e67 6528 3530 292c 2027 7927 3a20 7261  nge(50), 'y': ra
+0000acc0: 6e67 6528 3530 2c20 3130 3029 7d29 0a20  nge(50, 100)}). 
+0000acd0: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
+0000ace0: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
+0000acf0: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
+0000ad00: 3429 0a0a 2020 2020 2020 2020 436f 756e  4)..        Coun
+0000ad10: 7420 7468 6520 6e75 6d62 6572 206f 6620  t the number of 
+0000ad20: 726f 7773 2069 6e20 6120 4461 7461 4672  rows in a DataFr
+0000ad30: 616d 652e 2054 6f20 646f 2074 6869 732c  ame. To do this,
+0000ad40: 2063 6f75 6e74 2074 6865 206e 756d 6265   count the numbe
+0000ad50: 720a 2020 2020 2020 2020 6f66 2072 6f77  r.        of row
+0000ad60: 7320 696e 2065 6163 6820 7061 7274 6974  s in each partit
+0000ad70: 696f 6e2c 2074 6865 6e20 7375 6d20 7468  ion, then sum th
+0000ad80: 6520 7265 7375 6c74 733a 0a0a 2020 2020  e results:..    
+0000ad90: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
+0000ada0: 662e 7265 6475 6374 696f 6e28 6c61 6d62  f.reduction(lamb
+0000adb0: 6461 2078 3a20 782e 636f 756e 7428 292c  da x: x.count(),
+0000adc0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0000add0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ade0: 2061 6767 7265 6761 7465 3d6c 616d 6264   aggregate=lambd
+0000adf0: 6120 783a 2078 2e73 756d 2829 290a 2020  a x: x.sum()).  
+0000ae00: 2020 2020 2020 3e3e 3e20 7265 732e 636f        >>> res.co
+0000ae10: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
+0000ae20: 7820 2020 2035 300a 2020 2020 2020 2020  x    50.        
+0000ae30: 7920 2020 2035 300a 2020 2020 2020 2020  y    50.        
+0000ae40: 6474 7970 653a 2069 6e74 3634 0a0a 2020  dtype: int64..  
+0000ae50: 2020 2020 2020 436f 756e 7420 7468 6520        Count the 
+0000ae60: 6e75 6d62 6572 206f 6620 726f 7773 2069  number of rows i
+0000ae70: 6e20 6120 5365 7269 6573 2077 6974 6820  n a Series with 
+0000ae80: 656c 656d 656e 7473 2067 7265 6174 6572  elements greater
+0000ae90: 2074 6861 6e20 6f72 0a20 2020 2020 2020   than or.       
+0000aea0: 2065 7175 616c 2074 6f20 6120 7661 6c75   equal to a valu
+0000aeb0: 6520 2870 726f 7669 6465 6420 7669 6120  e (provided via 
+0000aec0: 6120 6b65 7977 6f72 6429 2e0a 0a20 2020  a keyword)...   
+0000aed0: 2020 2020 203e 3e3e 2064 6566 2063 6f75       >>> def cou
+0000aee0: 6e74 5f67 7265 6174 6572 2878 2c20 7661  nt_greater(x, va
+0000aef0: 6c75 653d 3029 3a0a 2020 2020 2020 2020  lue=0):.        
+0000af00: 2e2e 2e20 2020 2020 7265 7475 726e 2028  ...     return (
+0000af10: 7820 3e3d 2076 616c 7565 292e 7375 6d28  x >= value).sum(
+0000af20: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
+0000af30: 7320 3d20 6464 662e 782e 7265 6475 6374  s = ddf.x.reduct
+0000af40: 696f 6e28 636f 756e 745f 6772 6561 7465  ion(count_greate
+0000af50: 722c 2061 6767 7265 6761 7465 3d6c 616d  r, aggregate=lam
+0000af60: 6264 6120 783a 2078 2e73 756d 2829 2c0a  bda x: x.sum(),.
+0000af70: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0000af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000af90: 2020 6368 756e 6b5f 6b77 6172 6773 3d7b    chunk_kwargs={
+0000afa0: 2776 616c 7565 273a 2032 357d 290a 2020  'value': 25}).  
+0000afb0: 2020 2020 2020 3e3e 3e20 7265 732e 636f        >>> res.co
+0000afc0: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
+0000afd0: 3235 0a0a 2020 2020 2020 2020 4167 6772  25..        Aggr
+0000afe0: 6567 6174 6520 626f 7468 2074 6865 2073  egate both the s
+0000aff0: 756d 2061 6e64 2063 6f75 6e74 206f 6620  um and count of 
+0000b000: 6120 5365 7269 6573 2061 7420 7468 6520  a Series at the 
+0000b010: 7361 6d65 2074 696d 653a 0a0a 2020 2020  same time:..    
+0000b020: 2020 2020 3e3e 3e20 6465 6620 7375 6d5f      >>> def sum_
+0000b030: 616e 645f 636f 756e 7428 7829 3a0a 2020  and_count(x):.  
+0000b040: 2020 2020 2020 2e2e 2e20 2020 2020 7265        ...     re
+0000b050: 7475 726e 2070 642e 5365 7269 6573 287b  turn pd.Series({
+0000b060: 2763 6f75 6e74 273a 2078 2e63 6f75 6e74  'count': x.count
+0000b070: 2829 2c20 2773 756d 273a 2078 2e73 756d  (), 'sum': x.sum
+0000b080: 2829 7d2c 0a20 2020 2020 2020 202e 2e2e  ()},.        ...
+0000b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0a0: 2020 2020 2020 696e 6465 783d 5b27 636f        index=['co
+0000b0b0: 756e 7427 2c20 2773 756d 275d 290a 2020  unt', 'sum']).  
+0000b0c0: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
+0000b0d0: 6464 662e 782e 7265 6475 6374 696f 6e28  ddf.x.reduction(
+0000b0e0: 7375 6d5f 616e 645f 636f 756e 742c 2061  sum_and_count, a
+0000b0f0: 6767 7265 6761 7465 3d6c 616d 6264 6120  ggregate=lambda 
+0000b100: 783a 2078 2e73 756d 2829 290a 2020 2020  x: x.sum()).    
+0000b110: 2020 2020 3e3e 3e20 7265 732e 636f 6d70      >>> res.comp
+0000b120: 7574 6528 290a 2020 2020 2020 2020 636f  ute().        co
+0000b130: 756e 7420 2020 2020 2035 300a 2020 2020  unt      50.    
+0000b140: 2020 2020 7375 6d20 2020 2020 2031 3232      sum      122
+0000b150: 350a 2020 2020 2020 2020 6474 7970 653a  5.        dtype:
+0000b160: 2069 6e74 3634 0a0a 2020 2020 2020 2020   int64..        
+0000b170: 446f 696e 6720 7468 6520 7361 6d65 2c20  Doing the same, 
+0000b180: 6275 7420 666f 7220 6120 4461 7461 4672  but for a DataFr
+0000b190: 616d 652e 2048 6572 6520 6060 6368 756e  ame. Here ``chun
+0000b1a0: 6b60 6020 7265 7475 726e 7320 610a 2020  k`` returns a.  
+0000b1b0: 2020 2020 2020 4461 7461 4672 616d 652c        DataFrame,
+0000b1c0: 206d 6561 6e69 6e67 2074 6865 2069 6e70   meaning the inp
+0000b1d0: 7574 2074 6f20 6060 6167 6772 6567 6174  ut to ``aggregat
+0000b1e0: 6560 6020 6973 2061 2044 6174 6146 7261  e`` is a DataFra
+0000b1f0: 6d65 2077 6974 6820 616e 0a20 2020 2020  me with an.     
+0000b200: 2020 2069 6e64 6578 2077 6974 6820 6e6f     index with no
+0000b210: 6e2d 756e 6971 7565 2065 6e74 7269 6573  n-unique entries
+0000b220: 2066 6f72 2062 6f74 6820 2778 2720 616e   for both 'x' an
+0000b230: 6420 2779 272e 2057 6520 6772 6f75 7062  d 'y'. We groupb
+0000b240: 7920 7468 650a 2020 2020 2020 2020 696e  y the.        in
+0000b250: 6465 782c 2061 6e64 2073 756d 2065 6163  dex, and sum eac
+0000b260: 6820 6772 6f75 7020 746f 2067 6574 2074  h group to get t
+0000b270: 6865 2066 696e 616c 2072 6573 756c 742e  he final result.
+0000b280: 0a0a 2020 2020 2020 2020 3e3e 3e20 6465  ..        >>> de
+0000b290: 6620 7375 6d5f 616e 645f 636f 756e 7428  f sum_and_count(
+0000b2a0: 7829 3a0a 2020 2020 2020 2020 2e2e 2e20  x):.        ... 
+0000b2b0: 2020 2020 7265 7475 726e 2070 642e 4461      return pd.Da
+0000b2c0: 7461 4672 616d 6528 7b27 636f 756e 7427  taFrame({'count'
+0000b2d0: 3a20 782e 636f 756e 7428 292c 2027 7375  : x.count(), 'su
+0000b2e0: 6d27 3a20 782e 7375 6d28 297d 2c0a 2020  m': x.sum()},.  
+0000b2f0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0000b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b310: 2020 636f 6c75 6d6e 733d 5b27 636f 756e    columns=['coun
+0000b320: 7427 2c20 2773 756d 275d 290a 2020 2020  t', 'sum']).    
+0000b330: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
+0000b340: 662e 7265 6475 6374 696f 6e28 7375 6d5f  f.reduction(sum_
+0000b350: 616e 645f 636f 756e 742c 0a20 2020 2020  and_count,.     
+0000b360: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+0000b370: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
+0000b380: 6761 7465 3d6c 616d 6264 6120 783a 2078  gate=lambda x: x
+0000b390: 2e67 726f 7570 6279 286c 6576 656c 3d30  .groupby(level=0
+0000b3a0: 292e 7375 6d28 2929 0a20 2020 2020 2020  ).sum()).       
+0000b3b0: 203e 3e3e 2072 6573 2e63 6f6d 7075 7465   >>> res.compute
+0000b3c0: 2829 0a20 2020 2020 2020 2020 2020 636f  ().           co
+0000b3d0: 756e 7420 2020 7375 6d0a 2020 2020 2020  unt   sum.      
+0000b3e0: 2020 7820 2020 2020 3530 2020 3132 3235    x     50  1225
+0000b3f0: 0a20 2020 2020 2020 2079 2020 2020 2035  .        y     5
+0000b400: 3020 2033 3732 350a 2020 2020 2020 2020  0  3725.        
+0000b410: 2222 220a 2020 2020 2020 2020 6966 2061  """.        if a
+0000b420: 6767 7265 6761 7465 2069 7320 4e6f 6e65  ggregate is None
+0000b430: 3a0a 2020 2020 2020 2020 2020 2020 6167  :.            ag
+0000b440: 6772 6567 6174 6520 3d20 6368 756e 6b0a  gregate = chunk.
+0000b450: 0a20 2020 2020 2020 2069 6620 636f 6d62  .        if comb
+0000b460: 696e 6520 6973 204e 6f6e 653a 0a20 2020  ine is None:.   
+0000b470: 2020 2020 2020 2020 2069 6620 636f 6d62           if comb
+0000b480: 696e 655f 6b77 6172 6773 3a0a 2020 2020  ine_kwargs:.    
+0000b490: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000b4a0: 6520 5661 6c75 6545 7272 6f72 2822 6063  e ValueError("`c
+0000b4b0: 6f6d 6269 6e65 5f6b 7761 7267 7360 2070  ombine_kwargs` p
+0000b4c0: 726f 7669 6465 6420 7769 7468 206e 6f20  rovided with no 
+0000b4d0: 6063 6f6d 6269 6e65 6022 290a 2020 2020  `combine`").    
+0000b4e0: 2020 2020 2020 2020 636f 6d62 696e 6520          combine 
+0000b4f0: 3d20 6167 6772 6567 6174 650a 2020 2020  = aggregate.    
+0000b500: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
+0000b510: 6b77 6172 6773 203d 2061 6767 7265 6761  kwargs = aggrega
+0000b520: 7465 5f6b 7761 7267 730a 0a20 2020 2020  te_kwargs..     
+0000b530: 2020 2063 6875 6e6b 5f6b 7761 7267 7320     chunk_kwargs 
+0000b540: 3d20 6368 756e 6b5f 6b77 6172 6773 2e63  = chunk_kwargs.c
+0000b550: 6f70 7928 2920 6966 2063 6875 6e6b 5f6b  opy() if chunk_k
+0000b560: 7761 7267 7320 656c 7365 207b 7d0a 2020  wargs else {}.  
+0000b570: 2020 2020 2020 6368 756e 6b5f 6b77 6172        chunk_kwar
+0000b580: 6773 5b22 6163 615f 6368 756e 6b22 5d20  gs["aca_chunk"] 
+0000b590: 3d20 6368 756e 6b0a 0a20 2020 2020 2020  = chunk..       
+0000b5a0: 2063 6f6d 6269 6e65 5f6b 7761 7267 7320   combine_kwargs 
+0000b5b0: 3d20 636f 6d62 696e 655f 6b77 6172 6773  = combine_kwargs
+0000b5c0: 2e63 6f70 7928 2920 6966 2063 6f6d 6269  .copy() if combi
+0000b5d0: 6e65 5f6b 7761 7267 7320 656c 7365 207b  ne_kwargs else {
+0000b5e0: 7d0a 2020 2020 2020 2020 636f 6d62 696e  }.        combin
+0000b5f0: 655f 6b77 6172 6773 5b22 6163 615f 636f  e_kwargs["aca_co
+0000b600: 6d62 696e 6522 5d20 3d20 636f 6d62 696e  mbine"] = combin
+0000b610: 650a 0a20 2020 2020 2020 2061 6767 7265  e..        aggre
+0000b620: 6761 7465 5f6b 7761 7267 7320 3d20 6167  gate_kwargs = ag
+0000b630: 6772 6567 6174 655f 6b77 6172 6773 2e63  gregate_kwargs.c
+0000b640: 6f70 7928 2920 6966 2061 6767 7265 6761  opy() if aggrega
+0000b650: 7465 5f6b 7761 7267 7320 656c 7365 207b  te_kwargs else {
+0000b660: 7d0a 2020 2020 2020 2020 6167 6772 6567  }.        aggreg
+0000b670: 6174 655f 6b77 6172 6773 5b22 6163 615f  ate_kwargs["aca_
+0000b680: 6167 6772 6567 6174 6522 5d20 3d20 6167  aggregate"] = ag
+0000b690: 6772 6567 6174 650a 0a20 2020 2020 2020  gregate..       
+0000b6a0: 2072 6574 7572 6e20 6163 6128 0a20 2020   return aca(.   
+0000b6b0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
+0000b6c0: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+0000b6d0: 3d5f 7265 6475 6374 696f 6e5f 6368 756e  =_reduction_chun
+0000b6e0: 6b2c 0a20 2020 2020 2020 2020 2020 2061  k,.            a
+0000b6f0: 6767 7265 6761 7465 3d5f 7265 6475 6374  ggregate=_reduct
+0000b700: 696f 6e5f 6167 6772 6567 6174 652c 0a20  ion_aggregate,. 
+0000b710: 2020 2020 2020 2020 2020 2063 6f6d 6269             combi
+0000b720: 6e65 3d5f 7265 6475 6374 696f 6e5f 636f  ne=_reduction_co
+0000b730: 6d62 696e 652c 0a20 2020 2020 2020 2020  mbine,.         
+0000b740: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
+0000b750: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
+0000b760: 746f 6b65 6e2c 0a20 2020 2020 2020 2020  token,.         
+0000b770: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
+0000b780: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
+0000b790: 2020 2020 2020 2020 6368 756e 6b5f 6b77          chunk_kw
+0000b7a0: 6172 6773 3d63 6875 6e6b 5f6b 7761 7267  args=chunk_kwarg
+0000b7b0: 732c 0a20 2020 2020 2020 2020 2020 2061  s,.            a
+0000b7c0: 6767 7265 6761 7465 5f6b 7761 7267 733d  ggregate_kwargs=
+0000b7d0: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
+0000b7e0: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+0000b7f0: 6d62 696e 655f 6b77 6172 6773 3d63 6f6d  mbine_kwargs=com
+0000b800: 6269 6e65 5f6b 7761 7267 732c 0a20 2020  bine_kwargs,.   
+0000b810: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
+0000b820: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
+0000b830: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+0000b840: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+0000b850: 2020 6465 6620 7069 7065 2873 656c 662c    def pipe(self,
+0000b860: 2066 756e 632c 202a 6172 6773 2c20 2a2a   func, *args, **
+0000b870: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+0000b880: 2023 2054 616b 656e 2066 726f 6d20 7061   # Taken from pa
+0000b890: 6e64 6173 3a0a 2020 2020 2020 2020 2320  ndas:.        # 
+0000b8a0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+0000b8b0: 6f6d 2f70 7964 6174 612f 7061 6e64 6173  om/pydata/pandas
+0000b8c0: 2f62 6c6f 622f 6d61 7374 6572 2f70 616e  /blob/master/pan
+0000b8d0: 6461 732f 636f 7265 2f67 656e 6572 6963  das/core/generic
+0000b8e0: 2e70 7923 4c32 3639 382d 4c32 3730 370a  .py#L2698-L2707.
+0000b8f0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000b900: 7461 6e63 6528 6675 6e63 2c20 7475 706c  tance(func, tupl
+0000b910: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0000b920: 6675 6e63 2c20 7461 7267 6574 203d 2066  func, target = f
+0000b930: 756e 630a 2020 2020 2020 2020 2020 2020  unc.            
+0000b940: 6966 2074 6172 6765 7420 696e 206b 7761  if target in kwa
+0000b950: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+0000b960: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000b970: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0000b980: 2020 2020 2020 2020 2020 2022 2573 2069             "%s i
+0000b990: 7320 626f 7468 2074 6865 2070 6970 6520  s both the pipe 
+0000b9a0: 7461 7267 6574 2061 6e64 2061 206b 6579  target and a key
+0000b9b0: 776f 7264 2061 7267 756d 656e 7422 2025  word argument" %
+0000b9c0: 2074 6172 6765 740a 2020 2020 2020 2020   target.        
+0000b9d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000b9e0: 2020 2020 2020 6b77 6172 6773 5b74 6172        kwargs[tar
+0000b9f0: 6765 745d 203d 2073 656c 660a 2020 2020  get] = self.    
+0000ba00: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+0000ba10: 756e 6328 2a61 7267 732c 202a 2a6b 7761  unc(*args, **kwa
+0000ba20: 7267 7329 0a20 2020 2020 2020 2065 6c73  rgs).        els
+0000ba30: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0000ba40: 6574 7572 6e20 6675 6e63 2873 656c 662c  eturn func(self,
+0000ba50: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+0000ba60: 290a 0a20 2020 2064 6566 2072 616e 646f  )..    def rando
+0000ba70: 6d5f 7370 6c69 7428 7365 6c66 2c20 6672  m_split(self, fr
+0000ba80: 6163 2c20 7261 6e64 6f6d 5f73 7461 7465  ac, random_state
+0000ba90: 3d4e 6f6e 652c 2073 6875 6666 6c65 3d46  =None, shuffle=F
+0000baa0: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
+0000bab0: 2222 5073 6575 646f 7261 6e64 6f6d 6c79  ""Pseudorandomly
+0000bac0: 2073 706c 6974 2064 6174 6166 7261 6d65   split dataframe
+0000bad0: 2069 6e74 6f20 6469 6666 6572 656e 7420   into different 
+0000bae0: 7069 6563 6573 2072 6f77 2d77 6973 650a  pieces row-wise.
+0000baf0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0000bb00: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0000bb10: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2066  ------.        f
+0000bb20: 7261 6320 3a20 6c69 7374 0a20 2020 2020  rac : list.     
+0000bb30: 2020 2020 2020 204c 6973 7420 6f66 2066         List of f
+0000bb40: 6c6f 6174 7320 7468 6174 2073 686f 756c  loats that shoul
+0000bb50: 6420 7375 6d20 746f 206f 6e65 2e0a 2020  d sum to one..  
+0000bb60: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
+0000bb70: 7465 203a 2069 6e74 206f 7220 6e70 2e72  te : int or np.r
+0000bb80: 616e 646f 6d2e 5261 6e64 6f6d 5374 6174  andom.RandomStat
+0000bb90: 650a 2020 2020 2020 2020 2020 2020 4966  e.            If
+0000bba0: 2069 6e74 2063 7265 6174 6520 6120 6e65   int create a ne
+0000bbb0: 7720 5261 6e64 6f6d 5374 6174 6520 7769  w RandomState wi
+0000bbc0: 7468 2074 6869 7320 6173 2074 6865 2073  th this as the s
+0000bbd0: 6565 642e 0a20 2020 2020 2020 2020 2020  eed..           
+0000bbe0: 204f 7468 6572 7769 7365 2064 7261 7720   Otherwise draw 
+0000bbf0: 6672 6f6d 2074 6865 2070 6173 7365 6420  from the passed 
+0000bc00: 5261 6e64 6f6d 5374 6174 652e 0a20 2020  RandomState..   
+0000bc10: 2020 2020 2073 6875 6666 6c65 203a 2062       shuffle : b
+0000bc20: 6f6f 6c2c 2064 6566 6175 6c74 2046 616c  ool, default Fal
+0000bc30: 7365 0a20 2020 2020 2020 2020 2020 2049  se.            I
+0000bc40: 6620 7365 7420 746f 2054 7275 652c 2074  f set to True, t
+0000bc50: 6865 2064 6174 6166 7261 6d65 2069 7320  he dataframe is 
+0000bc60: 7368 7566 666c 6564 2028 7769 7468 696e  shuffled (within
+0000bc70: 2070 6172 7469 7469 6f6e 290a 2020 2020   partition).    
+0000bc80: 2020 2020 2020 2020 6265 666f 7265 2074          before t
+0000bc90: 6865 2073 706c 6974 2e0a 0a20 2020 2020  he split...     
+0000bca0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
+0000bcb0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a0a 2020      --------..  
+0000bcc0: 2020 2020 2020 3530 2f35 3020 7370 6c69        50/50 spli
+0000bcd0: 740a 0a20 2020 2020 2020 203e 3e3e 2061  t..        >>> a
+0000bce0: 2c20 6220 3d20 6466 2e72 616e 646f 6d5f  , b = df.random_
+0000bcf0: 7370 6c69 7428 5b30 2e35 2c20 302e 355d  split([0.5, 0.5]
+0000bd00: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+0000bd10: 4b49 500a 0a20 2020 2020 2020 2038 302f  KIP..        80/
+0000bd20: 3130 2f31 3020 7370 6c69 742c 2063 6f6e  10/10 split, con
+0000bd30: 7369 7374 656e 7420 7261 6e64 6f6d 5f73  sistent random_s
+0000bd40: 7461 7465 0a0a 2020 2020 2020 2020 3e3e  tate..        >>
+0000bd50: 3e20 612c 2062 2c20 6320 3d20 6466 2e72  > a, b, c = df.r
+0000bd60: 616e 646f 6d5f 7370 6c69 7428 5b30 2e38  andom_split([0.8
+0000bd70: 2c20 302e 312c 2030 2e31 5d2c 2072 616e  , 0.1, 0.1], ran
+0000bd80: 646f 6d5f 7374 6174 653d 3132 3329 2020  dom_state=123)  
+0000bd90: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
+0000bda0: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+0000bdb0: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+0000bdc0: 2d2d 2d0a 2020 2020 2020 2020 6461 736b  ---.        dask
+0000bdd0: 2e44 6174 6146 7261 6d65 2e73 616d 706c  .DataFrame.sampl
+0000bde0: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
+0000bdf0: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
+0000be00: 616c 6c63 6c6f 7365 2873 756d 2866 7261  allclose(sum(fra
+0000be10: 6329 2c20 3129 3a0a 2020 2020 2020 2020  c), 1):.        
+0000be20: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000be30: 7272 6f72 2822 6672 6163 2073 686f 756c  rror("frac shoul
+0000be40: 6420 7375 6d20 746f 2031 2229 0a20 2020  d sum to 1").   
+0000be50: 2020 2020 2073 7461 7465 5f64 6174 6120       state_data 
+0000be60: 3d20 7261 6e64 6f6d 5f73 7461 7465 5f64  = random_state_d
+0000be70: 6174 6128 7365 6c66 2e6e 7061 7274 6974  ata(self.npartit
+0000be80: 696f 6e73 2c20 7261 6e64 6f6d 5f73 7461  ions, random_sta
+0000be90: 7465 290a 2020 2020 2020 2020 746f 6b65  te).        toke
+0000bea0: 6e20 3d20 746f 6b65 6e69 7a65 2873 656c  n = tokenize(sel
+0000beb0: 662c 2066 7261 632c 2072 616e 646f 6d5f  f, frac, random_
+0000bec0: 7374 6174 6529 0a20 2020 2020 2020 206e  state).        n
+0000bed0: 616d 6520 3d20 2273 706c 6974 2d22 202b  ame = "split-" +
+0000bee0: 2074 6f6b 656e 0a20 2020 2020 2020 206c   token.        l
+0000bef0: 6179 6572 203d 207b 0a20 2020 2020 2020  ayer = {.       
+0000bf00: 2020 2020 2028 6e61 6d65 2c20 6929 3a20       (name, i): 
+0000bf10: 2870 645f 7370 6c69 742c 2028 7365 6c66  (pd_split, (self
+0000bf20: 2e5f 6e61 6d65 2c20 6929 2c20 6672 6163  ._name, i), frac
+0000bf30: 2c20 7374 6174 652c 2073 6875 6666 6c65  , state, shuffle
+0000bf40: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+0000bf50: 7220 692c 2073 7461 7465 2069 6e20 656e  r i, state in en
+0000bf60: 756d 6572 6174 6528 7374 6174 655f 6461  umerate(state_da
+0000bf70: 7461 290a 2020 2020 2020 2020 7d0a 0a20  ta).        }.. 
+0000bf80: 2020 2020 2020 206f 7574 203d 205b 5d0a         out = [].
+0000bf90: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+0000bfa0: 2072 616e 6765 286c 656e 2866 7261 6329   range(len(frac)
+0000bfb0: 293a 0a20 2020 2020 2020 2020 2020 206e  ):.            n
+0000bfc0: 616d 6532 203d 2022 7370 6c69 742d 2564  ame2 = "split-%d
+0000bfd0: 2d25 7322 2025 2028 692c 2074 6f6b 656e  -%s" % (i, token
+0000bfe0: 290a 2020 2020 2020 2020 2020 2020 6473  ).            ds
+0000bff0: 6b32 203d 207b 0a20 2020 2020 2020 2020  k2 = {.         
+0000c000: 2020 2020 2020 2028 6e61 6d65 322c 206a         (name2, j
+0000c010: 293a 2028 6765 7469 7465 6d2c 2028 6e61  ): (getitem, (na
+0000c020: 6d65 2c20 6a29 2c20 6929 2066 6f72 206a  me, j), i) for j
+0000c030: 2069 6e20 7261 6e67 6528 7365 6c66 2e6e   in range(self.n
+0000c040: 7061 7274 6974 696f 6e73 290a 2020 2020  partitions).    
+0000c050: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+0000c060: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
+0000c070: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+0000c080: 6d5f 636f 6c6c 6563 7469 6f6e 7328 0a20  m_collections(. 
+0000c090: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000c0a0: 616d 6532 2c20 6d65 7267 6528 6473 6b32  ame2, merge(dsk2
+0000c0b0: 2c20 6c61 7965 7229 2c20 6465 7065 6e64  , layer), depend
+0000c0c0: 656e 6369 6573 3d5b 7365 6c66 5d0a 2020  encies=[self].  
+0000c0d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000c0e0: 2020 2020 2020 2020 6f75 745f 6466 203d          out_df =
+0000c0f0: 2074 7970 6528 7365 6c66 2928 6772 6170   type(self)(grap
+0000c100: 682c 206e 616d 6532 2c20 7365 6c66 2e5f  h, name2, self._
+0000c110: 6d65 7461 2c20 7365 6c66 2e64 6976 6973  meta, self.divis
+0000c120: 696f 6e73 290a 2020 2020 2020 2020 2020  ions).          
+0000c130: 2020 6f75 742e 6170 7065 6e64 286f 7574    out.append(out
+0000c140: 5f64 6629 0a20 2020 2020 2020 2072 6574  _df).        ret
+0000c150: 7572 6e20 6f75 740a 0a20 2020 2064 6566  urn out..    def
+0000c160: 2068 6561 6428 7365 6c66 2c20 6e3d 352c   head(self, n=5,
+0000c170: 206e 7061 7274 6974 696f 6e73 3d31 2c20   npartitions=1, 
+0000c180: 636f 6d70 7574 653d 5472 7565 293a 0a20  compute=True):. 
+0000c190: 2020 2020 2020 2022 2222 4669 7273 7420         """First 
+0000c1a0: 6e20 726f 7773 206f 6620 7468 6520 6461  n rows of the da
+0000c1b0: 7461 7365 740a 0a20 2020 2020 2020 2050  taset..        P
+0000c1c0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+0000c1d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0000c1e0: 2020 2020 206e 203a 2069 6e74 2c20 6f70       n : int, op
+0000c1f0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+0000c200: 2020 2054 6865 206e 756d 6265 7220 6f66     The number of
+0000c210: 2072 6f77 7320 746f 2072 6574 7572 6e2e   rows to return.
+0000c220: 2044 6566 6175 6c74 2069 7320 352e 0a20   Default is 5.. 
+0000c230: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+0000c240: 6e73 203a 2069 6e74 2c20 6f70 7469 6f6e  ns : int, option
+0000c250: 616c 0a20 2020 2020 2020 2020 2020 2045  al.            E
+0000c260: 6c65 6d65 6e74 7320 6172 6520 6f6e 6c79  lements are only
+0000c270: 2074 616b 656e 2066 726f 6d20 7468 6520   taken from the 
+0000c280: 6669 7273 7420 6060 6e70 6172 7469 7469  first ``npartiti
+0000c290: 6f6e 7360 602c 2077 6974 6820 610a 2020  ons``, with a.  
+0000c2a0: 2020 2020 2020 2020 2020 6465 6661 756c            defaul
+0000c2b0: 7420 6f66 2031 2e20 4966 2074 6865 7265  t of 1. If there
+0000c2c0: 2061 7265 2066 6577 6572 2074 6861 6e20   are fewer than 
+0000c2d0: 6060 6e60 6020 726f 7773 2069 6e20 7468  ``n`` rows in th
+0000c2e0: 6520 6669 7273 740a 2020 2020 2020 2020  e first.        
+0000c2f0: 2020 2020 6060 6e70 6172 7469 7469 6f6e      ``npartition
+0000c300: 7360 6020 6120 7761 726e 696e 6720 7769  s`` a warning wi
+0000c310: 6c6c 2062 6520 7261 6973 6564 2061 6e64  ll be raised and
+0000c320: 2061 6e79 2066 6f75 6e64 2072 6f77 730a   any found rows.
+0000c330: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000c340: 726e 6564 2e20 5061 7373 202d 3120 746f  rned. Pass -1 to
+0000c350: 2075 7365 2061 6c6c 2070 6172 7469 7469   use all partiti
+0000c360: 6f6e 732e 0a20 2020 2020 2020 2063 6f6d  ons..        com
+0000c370: 7075 7465 203a 2062 6f6f 6c2c 206f 7074  pute : bool, opt
+0000c380: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0000c390: 2020 5768 6574 6865 7220 746f 2063 6f6d    Whether to com
+0000c3a0: 7075 7465 2074 6865 2072 6573 756c 742c  pute the result,
+0000c3b0: 2064 6566 6175 6c74 2069 7320 5472 7565   default is True
+0000c3c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000c3d0: 2020 2020 2020 6966 206e 7061 7274 6974        if npartit
+0000c3e0: 696f 6e73 203c 3d20 2d31 3a0a 2020 2020  ions <= -1:.    
+0000c3f0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0000c400: 6f6e 7320 3d20 7365 6c66 2e6e 7061 7274  ons = self.npart
+0000c410: 6974 696f 6e73 0a20 2020 2020 2020 2023  itions.        #
+0000c420: 204e 6f20 6e65 6564 2074 6f20 7761 726e   No need to warn
+0000c430: 2069 6620 7765 2772 6520 616c 7265 6164   if we're alread
+0000c440: 7920 6c6f 6f6b 696e 6720 6174 2061 6c6c  y looking at all
+0000c450: 2070 6172 7469 7469 6f6e 730a 2020 2020   partitions.    
+0000c460: 2020 2020 7361 6665 203d 206e 7061 7274      safe = npart
+0000c470: 6974 696f 6e73 2021 3d20 7365 6c66 2e6e  itions != self.n
+0000c480: 7061 7274 6974 696f 6e73 0a20 2020 2020  partitions.     
+0000c490: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0000c4a0: 6865 6164 286e 3d6e 2c20 6e70 6172 7469  head(n=n, nparti
+0000c4b0: 7469 6f6e 733d 6e70 6172 7469 7469 6f6e  tions=npartition
+0000c4c0: 732c 2063 6f6d 7075 7465 3d63 6f6d 7075  s, compute=compu
+0000c4d0: 7465 2c20 7361 6665 3d73 6166 6529 0a0a  te, safe=safe)..
+0000c4e0: 2020 2020 6465 6620 5f68 6561 6428 7365      def _head(se
+0000c4f0: 6c66 2c20 6e2c 206e 7061 7274 6974 696f  lf, n, npartitio
+0000c500: 6e73 2c20 636f 6d70 7574 652c 2073 6166  ns, compute, saf
+0000c510: 6529 3a0a 2020 2020 2020 2020 6966 206e  e):.        if n
+0000c520: 7061 7274 6974 696f 6e73 203c 3d20 2d31  partitions <= -1
+0000c530: 3a0a 2020 2020 2020 2020 2020 2020 6e70  :.            np
+0000c540: 6172 7469 7469 6f6e 7320 3d20 7365 6c66  artitions = self
+0000c550: 2e6e 7061 7274 6974 696f 6e73 0a20 2020  .npartitions.   
+0000c560: 2020 2020 2069 6620 6e70 6172 7469 7469       if npartiti
+0000c570: 6f6e 7320 3e20 7365 6c66 2e6e 7061 7274  ons > self.npart
+0000c580: 6974 696f 6e73 3a0a 2020 2020 2020 2020  itions:.        
+0000c590: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000c5a0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0000c5b0: 2020 2020 2020 6622 6f6e 6c79 207b 7365        f"only {se
+0000c5c0: 6c66 2e6e 7061 7274 6974 696f 6e73 7d20  lf.npartitions} 
+0000c5d0: 7061 7274 6974 696f 6e73 2c20 6865 6164  partitions, head
+0000c5e0: 2072 6563 6569 7665 6420 7b6e 7061 7274   received {npart
+0000c5f0: 6974 696f 6e73 7d22 0a20 2020 2020 2020  itions}".       
+0000c600: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000c610: 6e61 6d65 203d 2066 2268 6561 642d 7b6e  name = f"head-{n
+0000c620: 7061 7274 6974 696f 6e73 7d2d 7b6e 7d2d  partitions}-{n}-
+0000c630: 7b73 656c 662e 5f6e 616d 657d 220a 2020  {self._name}".  
+0000c640: 2020 2020 2020 6966 2073 6166 653a 0a20        if safe:. 
+0000c650: 2020 2020 2020 2020 2020 2068 6561 6420             head 
+0000c660: 3d20 7361 6665 5f68 6561 640a 2020 2020  = safe_head.    
+0000c670: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000c680: 2020 2020 2020 6865 6164 203d 204d 2e68        head = M.h
+0000c690: 6561 640a 0a20 2020 2020 2020 2069 6620  ead..        if 
+0000c6a0: 6e70 6172 7469 7469 6f6e 7320 3e20 313a  npartitions > 1:
+0000c6b0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+0000c6c0: 655f 7020 3d20 6622 6865 6164 2d70 6172  e_p = f"head-par
+0000c6d0: 7469 616c 2d7b 6e7d 2d7b 7365 6c66 2e5f  tial-{n}-{self._
+0000c6e0: 6e61 6d65 7d22 0a0a 2020 2020 2020 2020  name}"..        
+0000c6f0: 2020 2020 6473 6b20 3d20 7b7d 0a20 2020      dsk = {}.   
+0000c700: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+0000c710: 6e20 7261 6e67 6528 6e70 6172 7469 7469  n range(npartiti
+0000c720: 6f6e 7329 3a0a 2020 2020 2020 2020 2020  ons):.          
+0000c730: 2020 2020 2020 6473 6b5b 286e 616d 655f        dsk[(name_
+0000c740: 702c 2069 295d 203d 2028 4d2e 6865 6164  p, i)] = (M.head
+0000c750: 2c20 2873 656c 662e 5f6e 616d 652c 2069  , (self._name, i
+0000c760: 292c 206e 290a 0a20 2020 2020 2020 2020  ), n)..         
+0000c770: 2020 2063 6f6e 6361 7420 3d20 285f 636f     concat = (_co
+0000c780: 6e63 6174 2c20 5b28 6e61 6d65 5f70 2c20  ncat, [(name_p, 
+0000c790: 6929 2066 6f72 2069 2069 6e20 7261 6e67  i) for i in rang
+0000c7a0: 6528 6e70 6172 7469 7469 6f6e 7329 5d29  e(npartitions)])
+0000c7b0: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
+0000c7c0: 5b28 6e61 6d65 2c20 3029 5d20 3d20 2868  [(name, 0)] = (h
+0000c7d0: 6561 642c 2063 6f6e 6361 742c 206e 290a  ead, concat, n).
+0000c7e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000c7f0: 2020 2020 2020 2020 2020 6473 6b20 3d20            dsk = 
+0000c800: 7b28 6e61 6d65 2c20 3029 3a20 2868 6561  {(name, 0): (hea
+0000c810: 642c 2028 7365 6c66 2e5f 6e61 6d65 2c20  d, (self._name, 
+0000c820: 3029 2c20 6e29 7d0a 0a20 2020 2020 2020  0), n)}..       
+0000c830: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+0000c840: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+0000c850: 6c65 6374 696f 6e73 286e 616d 652c 2064  lections(name, d
+0000c860: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
+0000c870: 3d5b 7365 6c66 5d29 0a20 2020 2020 2020  =[self]).       
+0000c880: 2072 6573 756c 7420 3d20 6e65 775f 6464   result = new_dd
+0000c890: 5f6f 626a 6563 7428 0a20 2020 2020 2020  _object(.       
+0000c8a0: 2020 2020 2067 7261 7068 2c20 6e61 6d65       graph, name
+0000c8b0: 2c20 7365 6c66 2e5f 6d65 7461 2c20 5b73  , self._meta, [s
+0000c8c0: 656c 662e 6469 7669 7369 6f6e 735b 305d  elf.divisions[0]
+0000c8d0: 2c20 7365 6c66 2e64 6976 6973 696f 6e73  , self.divisions
+0000c8e0: 5b6e 7061 7274 6974 696f 6e73 5d5d 0a20  [npartitions]]. 
+0000c8f0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000c900: 2020 6966 2063 6f6d 7075 7465 3a0a 2020    if compute:.  
+0000c910: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+0000c920: 203d 2072 6573 756c 742e 636f 6d70 7574   = result.comput
+0000c930: 6528 290a 2020 2020 2020 2020 7265 7475  e().        retu
+0000c940: 726e 2072 6573 756c 740a 0a20 2020 2064  rn result..    d
+0000c950: 6566 2074 6169 6c28 7365 6c66 2c20 6e3d  ef tail(self, n=
+0000c960: 352c 2063 6f6d 7075 7465 3d54 7275 6529  5, compute=True)
+0000c970: 3a0a 2020 2020 2020 2020 2222 224c 6173  :.        """Las
+0000c980: 7420 6e20 726f 7773 206f 6620 7468 6520  t n rows of the 
+0000c990: 6461 7461 7365 740a 0a20 2020 2020 2020  dataset..       
+0000c9a0: 2043 6176 6561 742c 2074 6865 206f 6e6c   Caveat, the onl
+0000c9b0: 7920 6368 6563 6b73 2074 6865 206c 6173  y checks the las
+0000c9c0: 7420 6e20 726f 7773 206f 6620 7468 6520  t n rows of the 
+0000c9d0: 6c61 7374 2070 6172 7469 7469 6f6e 2e0a  last partition..
+0000c9e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000c9f0: 2020 2020 6e61 6d65 203d 2022 7461 696c      name = "tail
+0000ca00: 2d25 642d 2573 2220 2520 286e 2c20 7365  -%d-%s" % (n, se
+0000ca10: 6c66 2e5f 6e61 6d65 290a 2020 2020 2020  lf._name).      
+0000ca20: 2020 6473 6b20 3d20 7b28 6e61 6d65 2c20    dsk = {(name, 
+0000ca30: 3029 3a20 284d 2e74 6169 6c2c 2028 7365  0): (M.tail, (se
+0000ca40: 6c66 2e5f 6e61 6d65 2c20 7365 6c66 2e6e  lf._name, self.n
+0000ca50: 7061 7274 6974 696f 6e73 202d 2031 292c  partitions - 1),
+0000ca60: 206e 297d 0a0a 2020 2020 2020 2020 6772   n)}..        gr
+0000ca70: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+0000ca80: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+0000ca90: 7469 6f6e 7328 6e61 6d65 2c20 6473 6b2c  tions(name, dsk,
+0000caa0: 2064 6570 656e 6465 6e63 6965 733d 5b73   dependencies=[s
+0000cab0: 656c 665d 290a 2020 2020 2020 2020 7265  elf]).        re
+0000cac0: 7375 6c74 203d 206e 6577 5f64 645f 6f62  sult = new_dd_ob
+0000cad0: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
+0000cae0: 2c20 7365 6c66 2e5f 6d65 7461 2c20 7365  , self._meta, se
+0000caf0: 6c66 2e64 6976 6973 696f 6e73 5b2d 323a  lf.divisions[-2:
+0000cb00: 5d29 0a0a 2020 2020 2020 2020 6966 2063  ])..        if c
+0000cb10: 6f6d 7075 7465 3a0a 2020 2020 2020 2020  ompute:.        
+0000cb20: 2020 2020 7265 7375 6c74 203d 2072 6573      result = res
+0000cb30: 756c 742e 636f 6d70 7574 6528 290a 2020  ult.compute().  
+0000cb40: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0000cb50: 756c 740a 0a20 2020 2040 7072 6f70 6572  ult..    @proper
+0000cb60: 7479 0a20 2020 2064 6566 206c 6f63 2873  ty.    def loc(s
+0000cb70: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0000cb80: 2250 7572 656c 7920 6c61 6265 6c2d 6c6f  "Purely label-lo
+0000cb90: 6361 7469 6f6e 2062 6173 6564 2069 6e64  cation based ind
+0000cba0: 6578 6572 2066 6f72 2073 656c 6563 7469  exer for selecti
+0000cbb0: 6f6e 2062 7920 6c61 6265 6c2e 0a0a 2020  on by label...  
+0000cbc0: 2020 2020 2020 3e3e 3e20 6466 2e6c 6f63        >>> df.loc
+0000cbd0: 5b22 6222 5d20 2023 2064 6f63 7465 7374  ["b"]  # doctest
+0000cbe0: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
+0000cbf0: 3e3e 3e20 6466 2e6c 6f63 5b22 6222 3a22  >>> df.loc["b":"
+0000cc00: 6422 5d20 2023 2064 6f63 7465 7374 3a20  d"]  # doctest: 
+0000cc10: 2b53 4b49 500a 2020 2020 2020 2020 2222  +SKIP.        ""
+0000cc20: 220a 2020 2020 2020 2020 6672 6f6d 2064  ".        from d
+0000cc30: 6173 6b2e 6461 7461 6672 616d 652e 696e  ask.dataframe.in
+0000cc40: 6465 7869 6e67 2069 6d70 6f72 7420 5f4c  dexing import _L
+0000cc50: 6f63 496e 6465 7865 720a 0a20 2020 2020  ocIndexer..     
+0000cc60: 2020 2072 6574 7572 6e20 5f4c 6f63 496e     return _LocIn
+0000cc70: 6465 7865 7228 7365 6c66 290a 0a20 2020  dexer(self)..   
+0000cc80: 2064 6566 205f 7061 7274 6974 696f 6e73   def _partitions
+0000cc90: 2873 656c 662c 2069 6e64 6578 293a 0a20  (self, index):. 
+0000cca0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+0000ccb0: 696e 7374 616e 6365 2869 6e64 6578 2c20  instance(index, 
+0000ccc0: 7475 706c 6529 3a0a 2020 2020 2020 2020  tuple):.        
+0000ccd0: 2020 2020 696e 6465 7820 3d20 2869 6e64      index = (ind
+0000cce0: 6578 2c29 0a20 2020 2020 2020 2066 726f  ex,).        fro
+0000ccf0: 6d20 6461 736b 2e61 7272 6179 2e73 6c69  m dask.array.sli
+0000cd00: 6369 6e67 2069 6d70 6f72 7420 6e6f 726d  cing import norm
+0000cd10: 616c 697a 655f 696e 6465 780a 0a20 2020  alize_index..   
+0000cd20: 2020 2020 2069 6e64 6578 203d 206e 6f72       index = nor
+0000cd30: 6d61 6c69 7a65 5f69 6e64 6578 2869 6e64  malize_index(ind
+0000cd40: 6578 2c20 2873 656c 662e 6e70 6172 7469  ex, (self.nparti
+0000cd50: 7469 6f6e 732c 2929 0a20 2020 2020 2020  tions,)).       
+0000cd60: 2069 6e64 6578 203d 2074 7570 6c65 2873   index = tuple(s
+0000cd70: 6c69 6365 286b 2c20 6b20 2b20 3129 2069  lice(k, k + 1) i
+0000cd80: 6620 6973 696e 7374 616e 6365 286b 2c20  f isinstance(k, 
+0000cd90: 4e75 6d62 6572 2920 656c 7365 206b 2066  Number) else k f
+0000cda0: 6f72 206b 2069 6e20 696e 6465 7829 0a20  or k in index). 
+0000cdb0: 2020 2020 2020 206e 616d 6520 3d20 2262         name = "b
+0000cdc0: 6c6f 636b 732d 2220 2b20 746f 6b65 6e69  locks-" + tokeni
+0000cdd0: 7a65 2873 656c 662c 2069 6e64 6578 290a  ze(self, index).
+0000cde0: 2020 2020 2020 2020 6e65 775f 6b65 7973          new_keys
+0000cdf0: 203d 206e 702e 6172 7261 7928 7365 6c66   = np.array(self
+0000ce00: 2e5f 5f64 6173 6b5f 6b65 7973 5f5f 2829  .__dask_keys__()
+0000ce10: 2c20 6474 7970 653d 6f62 6a65 6374 295b  , dtype=object)[
+0000ce20: 696e 6465 785d 2e74 6f6c 6973 7428 290a  index].tolist().
+0000ce30: 0a20 2020 2020 2020 2064 6976 6973 696f  .        divisio
+0000ce40: 6e73 203d 205b 7365 6c66 2e64 6976 6973  ns = [self.divis
+0000ce50: 696f 6e73 5b69 5d20 666f 7220 5f2c 2069  ions[i] for _, i
+0000ce60: 2069 6e20 6e65 775f 6b65 7973 5d20 2b20   in new_keys] + 
+0000ce70: 5b0a 2020 2020 2020 2020 2020 2020 7365  [.            se
+0000ce80: 6c66 2e64 6976 6973 696f 6e73 5b6e 6577  lf.divisions[new
+0000ce90: 5f6b 6579 735b 2d31 5d5b 315d 202b 2031  _keys[-1][1] + 1
+0000cea0: 5d0a 2020 2020 2020 2020 5d0a 2020 2020  ].        ].    
+0000ceb0: 2020 2020 6473 6b20 3d20 7b28 6e61 6d65      dsk = {(name
+0000cec0: 2c20 6929 3a20 7475 706c 6528 6b65 7929  , i): tuple(key)
+0000ced0: 2066 6f72 2069 2c20 6b65 7920 696e 2065   for i, key in e
+0000cee0: 6e75 6d65 7261 7465 286e 6577 5f6b 6579  numerate(new_key
+0000cef0: 7329 7d0a 0a20 2020 2020 2020 2067 7261  s)}..        gra
+0000cf00: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+0000cf10: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+0000cf20: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
+0000cf30: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
+0000cf40: 6c66 5d29 0a20 2020 2020 2020 2072 6574  lf]).        ret
+0000cf50: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
+0000cf60: 7428 6772 6170 682c 206e 616d 652c 2073  t(graph, name, s
+0000cf70: 656c 662e 5f6d 6574 612c 2064 6976 6973  elf._meta, divis
+0000cf80: 696f 6e73 290a 0a20 2020 2040 7072 6f70  ions)..    @prop
+0000cf90: 6572 7479 0a20 2020 2064 6566 2070 6172  erty.    def par
+0000cfa0: 7469 7469 6f6e 7328 7365 6c66 293a 0a20  titions(self):. 
+0000cfb0: 2020 2020 2020 2022 2222 536c 6963 6520         """Slice 
+0000cfc0: 6461 7461 6672 616d 6520 6279 2070 6172  dataframe by par
+0000cfd0: 7469 7469 6f6e 730a 0a20 2020 2020 2020  titions..       
+0000cfe0: 2054 6869 7320 616c 6c6f 7773 2070 6172   This allows par
+0000cff0: 7469 7469 6f6e 7769 7365 2073 6c69 6369  titionwise slici
+0000d000: 6e67 206f 6620 6120 4461 736b 2044 6174  ng of a Dask Dat
+0000d010: 6166 7261 6d65 2e20 2059 6f75 2063 616e  aframe.  You can
+0000d020: 2070 6572 666f 726d 206e 6f72 6d61 6c0a   perform normal.
+0000d030: 2020 2020 2020 2020 4e75 6d70 792d 7374          Numpy-st
+0000d040: 796c 6520 736c 6963 696e 672c 2062 7574  yle slicing, but
+0000d050: 206e 6f77 2072 6174 6865 7220 7468 616e   now rather than
+0000d060: 2073 6c69 6365 2065 6c65 6d65 6e74 7320   slice elements 
+0000d070: 6f66 2074 6865 2061 7272 6179 2079 6f75  of the array you
+0000d080: 0a20 2020 2020 2020 2073 6c69 6365 2061  .        slice a
+0000d090: 6c6f 6e67 2070 6172 7469 7469 6f6e 7320  long partitions 
+0000d0a0: 736f 2c20 666f 7220 6578 616d 706c 652c  so, for example,
+0000d0b0: 2060 6064 662e 7061 7274 6974 696f 6e73   ``df.partitions
+0000d0c0: 5b3a 355d 6060 2070 726f 6475 6365 7320  [:5]`` produces 
+0000d0d0: 6120 6e65 770a 2020 2020 2020 2020 4461  a new.        Da
+0000d0e0: 736b 2044 6174 6166 7261 6d65 206f 6620  sk Dataframe of 
+0000d0f0: 7468 6520 6669 7273 7420 6669 7665 2070  the first five p
+0000d100: 6172 7469 7469 6f6e 732e 2056 616c 6964  artitions. Valid
+0000d110: 2069 6e64 6578 6572 7320 6172 6520 696e   indexers are in
+0000d120: 7465 6765 7273 2c20 7365 7175 656e 6365  tegers, sequence
+0000d130: 730a 2020 2020 2020 2020 6f66 2069 6e74  s.        of int
+0000d140: 6567 6572 732c 2073 6c69 6365 732c 206f  egers, slices, o
+0000d150: 7220 626f 6f6c 6561 6e20 6d61 736b 732e  r boolean masks.
+0000d160: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+0000d170: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+0000d180: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
+0000d190: 6466 2e70 6172 7469 7469 6f6e 735b 305d  df.partitions[0]
+0000d1a0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+0000d1b0: 4950 0a20 2020 2020 2020 203e 3e3e 2064  IP.        >>> d
+0000d1c0: 662e 7061 7274 6974 696f 6e73 5b3a 335d  f.partitions[:3]
+0000d1d0: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+0000d1e0: 4950 0a20 2020 2020 2020 203e 3e3e 2064  IP.        >>> d
+0000d1f0: 662e 7061 7274 6974 696f 6e73 5b3a 3a31  f.partitions[::1
+0000d200: 305d 2020 2320 646f 6374 6573 743a 202b  0]  # doctest: +
+0000d210: 534b 4950 0a0a 2020 2020 2020 2020 5265  SKIP..        Re
+0000d220: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+0000d230: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4120  -----.        A 
+0000d240: 4461 736b 2044 6174 6146 7261 6d65 0a20  Dask DataFrame. 
+0000d250: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000d260: 2020 2072 6574 7572 6e20 496e 6465 7843     return IndexC
+0000d270: 616c 6c61 626c 6528 7365 6c66 2e5f 7061  allable(self._pa
+0000d280: 7274 6974 696f 6e73 290a 0a20 2020 2023  rtitions)..    #
+0000d290: 204e 6f74 653a 2069 6c6f 6320 6973 2069   Note: iloc is i
+0000d2a0: 6d70 6c65 6d65 6e74 6564 206f 6e6c 7920  mplemented only 
+0000d2b0: 6f6e 2044 6174 6146 7261 6d65 0a0a 2020  on DataFrame..  
+0000d2c0: 2020 6465 6620 7265 7061 7274 6974 696f    def repartitio
+0000d2d0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+0000d2e0: 0a20 2020 2020 2020 2064 6976 6973 696f  .        divisio
+0000d2f0: 6e73 3d4e 6f6e 652c 0a20 2020 2020 2020  ns=None,.       
+0000d300: 206e 7061 7274 6974 696f 6e73 3d4e 6f6e   npartitions=Non
+0000d310: 652c 0a20 2020 2020 2020 2070 6172 7469  e,.        parti
+0000d320: 7469 6f6e 5f73 697a 653d 4e6f 6e65 2c0a  tion_size=None,.
+0000d330: 2020 2020 2020 2020 6672 6571 3d4e 6f6e          freq=Non
+0000d340: 652c 0a20 2020 2020 2020 2066 6f72 6365  e,.        force
+0000d350: 3d46 616c 7365 2c0a 2020 2020 293a 0a20  =False,.    ):. 
+0000d360: 2020 2020 2020 2022 2222 5265 7061 7274         """Repart
+0000d370: 6974 696f 6e20 6461 7461 6672 616d 6520  ition dataframe 
+0000d380: 616c 6f6e 6720 6e65 7720 6469 7669 7369  along new divisi
+0000d390: 6f6e 730a 0a20 2020 2020 2020 2050 6172  ons..        Par
+0000d3a0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+0000d3b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0000d3c0: 2020 2064 6976 6973 696f 6e73 203a 206c     divisions : l
+0000d3d0: 6973 742c 206f 7074 696f 6e61 6c0a 2020  ist, optional.  
+0000d3e0: 2020 2020 2020 2020 2020 5468 6520 2264            The "d
+0000d3f0: 6976 6964 696e 6720 6c69 6e65 7322 2075  ividing lines" u
+0000d400: 7365 6420 746f 2073 706c 6974 2074 6865  sed to split the
+0000d410: 2064 6174 6166 7261 6d65 2069 6e74 6f20   dataframe into 
+0000d420: 7061 7274 6974 696f 6e73 2e0a 2020 2020  partitions..    
+0000d430: 2020 2020 2020 2020 466f 7220 6060 6469          For ``di
+0000d440: 7669 7369 6f6e 733d 5b30 2c20 3130 2c20  visions=[0, 10, 
+0000d450: 3530 2c20 3130 305d 6060 2c20 7468 6572  50, 100]``, ther
+0000d460: 6520 776f 756c 6420 6265 2074 6872 6565  e would be three
+0000d470: 206f 7574 7075 7420 7061 7274 6974 696f   output partitio
+0000d480: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+0000d490: 7768 6572 6520 7468 6520 6e65 7720 696e  where the new in
+0000d4a0: 6465 7820 636f 6e74 6169 6e65 6420 5b30  dex contained [0
+0000d4b0: 2c20 3130 292c 205b 3130 2c20 3530 292c  , 10), [10, 50),
+0000d4c0: 2061 6e64 205b 3530 2c20 3130 3029 2c20   and [50, 100), 
+0000d4d0: 7265 7370 6563 7469 7665 6c79 2e0a 2020  respectively..  
+0000d4e0: 2020 2020 2020 2020 2020 5365 6520 6874            See ht
+0000d4f0: 7470 733a 2f2f 646f 6373 2e64 6173 6b2e  tps://docs.dask.
+0000d500: 6f72 672f 656e 2f6c 6174 6573 742f 6461  org/en/latest/da
+0000d510: 7461 6672 616d 652d 6465 7369 676e 2e68  taframe-design.h
+0000d520: 746d 6c23 7061 7274 6974 696f 6e73 2e0a  tml#partitions..
+0000d530: 2020 2020 2020 2020 2020 2020 4f6e 6c79              Only
+0000d540: 2075 7365 6420 6966 206e 7061 7274 6974   used if npartit
+0000d550: 696f 6e73 2061 6e64 2070 6172 7469 7469  ions and partiti
+0000d560: 6f6e 5f73 697a 6520 6973 6e27 7420 7370  on_size isn't sp
+0000d570: 6563 6966 6965 642e 0a20 2020 2020 2020  ecified..       
+0000d580: 2020 2020 2046 6f72 2063 6f6e 7665 6e69       For conveni
+0000d590: 656e 6365 2069 6620 6769 7665 6e20 616e  ence if given an
+0000d5a0: 2069 6e74 6567 6572 2074 6869 7320 7769   integer this wi
+0000d5b0: 6c6c 2064 6566 6572 2074 6f20 6e70 6172  ll defer to npar
+0000d5c0: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
+0000d5d0: 2020 2020 616e 6420 6966 2067 6976 656e      and if given
+0000d5e0: 2061 2073 7472 696e 6720 6974 2077 696c   a string it wil
+0000d5f0: 6c20 6465 6665 7220 746f 2070 6172 7469  l defer to parti
+0000d600: 7469 6f6e 5f73 697a 6520 2873 6565 2062  tion_size (see b
+0000d610: 656c 6f77 290a 2020 2020 2020 2020 6e70  elow).        np
+0000d620: 6172 7469 7469 6f6e 7320 3a20 696e 742c  artitions : int,
+0000d630: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0000d640: 2020 2020 2020 4170 7072 6f78 696d 6174        Approximat
+0000d650: 6520 6e75 6d62 6572 206f 6620 7061 7274  e number of part
+0000d660: 6974 696f 6e73 206f 6620 6f75 7470 7574  itions of output
+0000d670: 2e20 4f6e 6c79 2075 7365 6420 6966 2070  . Only used if p
+0000d680: 6172 7469 7469 6f6e 5f73 697a 650a 2020  artition_size.  
+0000d690: 2020 2020 2020 2020 2020 6973 6e27 7420            isn't 
+0000d6a0: 7370 6563 6966 6965 642e 2054 6865 206e  specified. The n
+0000d6b0: 756d 6265 7220 6f66 2070 6172 7469 7469  umber of partiti
+0000d6c0: 6f6e 7320 7573 6564 206d 6179 2062 6520  ons used may be 
+0000d6d0: 736c 6967 6874 6c79 0a20 2020 2020 2020  slightly.       
+0000d6e0: 2020 2020 206c 6f77 6572 2074 6861 6e20       lower than 
+0000d6f0: 6e70 6172 7469 7469 6f6e 7320 6465 7065  npartitions depe
+0000d700: 6e64 696e 6720 6f6e 2064 6174 6120 6469  nding on data di
+0000d710: 7374 7269 6275 7469 6f6e 2c20 6275 7420  stribution, but 
+0000d720: 7769 6c6c 206e 6576 6572 2062 650a 2020  will never be.  
+0000d730: 2020 2020 2020 2020 2020 6869 6768 6572            higher
+0000d740: 2e0a 2020 2020 2020 2020 7061 7274 6974  ..        partit
+0000d750: 696f 6e5f 7369 7a65 3a20 696e 7420 6f72  ion_size: int or
+0000d760: 2073 7472 696e 672c 206f 7074 696f 6e61   string, optiona
+0000d770: 6c0a 2020 2020 2020 2020 2020 2020 4d61  l.            Ma
+0000d780: 7820 6e75 6d62 6572 206f 6620 6279 7465  x number of byte
+0000d790: 7320 6f66 206d 656d 6f72 7920 666f 7220  s of memory for 
+0000d7a0: 6561 6368 2070 6172 7469 7469 6f6e 2e20  each partition. 
+0000d7b0: 5573 6520 6e75 6d62 6572 7320 6f72 0a20  Use numbers or. 
+0000d7c0: 2020 2020 2020 2020 2020 2073 7472 696e             strin
+0000d7d0: 6773 206c 696b 6520 354d 422e 2049 6620  gs like 5MB. If 
+0000d7e0: 7370 6563 6966 6965 6420 6e70 6172 7469  specified nparti
+0000d7f0: 7469 6f6e 7320 616e 6420 6469 7669 7369  tions and divisi
+0000d800: 6f6e 7320 7769 6c6c 2062 650a 2020 2020  ons will be.    
+0000d810: 2020 2020 2020 2020 6967 6e6f 7265 642e          ignored.
+0000d820: 204e 6f74 6520 7468 6174 2074 6865 2073   Note that the s
+0000d830: 697a 6520 7265 666c 6563 7473 2074 6865  ize reflects the
+0000d840: 206e 756d 6265 7220 6f66 2062 7974 6573   number of bytes
+0000d850: 2075 7365 6420 6173 0a20 2020 2020 2020   used as.       
+0000d860: 2020 2020 2063 6f6d 7075 7465 6420 6279       computed by
+0000d870: 2060 6070 616e 6461 732e 4461 7461 4672   ``pandas.DataFr
+0000d880: 616d 652e 6d65 6d6f 7279 5f75 7361 6765  ame.memory_usage
+0000d890: 6060 2c20 7768 6963 6820 7769 6c6c 206e  ``, which will n
+0000d8a0: 6f74 0a20 2020 2020 2020 2020 2020 206e  ot.            n
+0000d8b0: 6563 6573 7361 7269 6c79 206d 6174 6368  ecessarily match
+0000d8c0: 2074 6865 2073 697a 6520 7768 656e 2073   the size when s
+0000d8d0: 746f 7269 6e67 2074 6f20 6469 736b 2e0a  toring to disk..
+0000d8e0: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
+0000d8f0: 7761 726e 696e 673a 3a0a 0a20 2020 2020  warning::..     
+0000d900: 2020 2020 2020 2020 2020 5468 6973 206b            This k
+0000d910: 6579 776f 7264 2061 7267 756d 656e 7420  eyword argument 
+0000d920: 7472 6967 6765 7273 2063 6f6d 7075 7461  triggers computa
+0000d930: 7469 6f6e 2074 6f20 6465 7465 726d 696e  tion to determin
+0000d940: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0000d950: 2074 6865 206d 656d 6f72 7920 7369 7a65   the memory size
+0000d960: 206f 6620 6561 6368 2070 6172 7469 7469   of each partiti
+0000d970: 6f6e 2c20 7768 6963 6820 6d61 7920 6265  on, which may be
+0000d980: 2065 7870 656e 7369 7665 2e0a 0a20 2020   expensive...   
+0000d990: 2020 2020 2066 7265 7120 3a20 7374 722c       freq : str,
+0000d9a0: 2070 642e 5469 6d65 6465 6c74 610a 2020   pd.Timedelta.  
+0000d9b0: 2020 2020 2020 2020 2020 4120 7065 7269            A peri
+0000d9c0: 6f64 206f 6e20 7768 6963 6820 746f 2070  od on which to p
+0000d9d0: 6172 7469 7469 6f6e 2074 696d 6573 6572  artition timeser
+0000d9e0: 6965 7320 6461 7461 206c 696b 6520 6060  ies data like ``
+0000d9f0: 2737 4427 6060 206f 720a 2020 2020 2020  '7D'`` or.      
+0000da00: 2020 2020 2020 6060 2731 3268 2760 6020        ``'12h'`` 
+0000da10: 6f72 2060 6070 642e 5469 6d65 6465 6c74  or ``pd.Timedelt
+0000da20: 6128 686f 7572 733d 3132 2960 602e 2020  a(hours=12)``.  
+0000da30: 4173 7375 6d65 7320 6120 6461 7465 7469  Assumes a dateti
+0000da40: 6d65 2069 6e64 6578 2e0a 2020 2020 2020  me index..      
+0000da50: 2020 666f 7263 6520 3a20 626f 6f6c 2c20    force : bool, 
+0000da60: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
+0000da70: 2020 2020 2020 2020 2020 416c 6c6f 7773            Allows
+0000da80: 2074 6865 2065 7870 616e 7369 6f6e 206f   the expansion o
+0000da90: 6620 7468 6520 6578 6973 7469 6e67 2064  f the existing d
+0000daa0: 6976 6973 696f 6e73 2e0a 2020 2020 2020  ivisions..      
+0000dab0: 2020 2020 2020 4966 2046 616c 7365 2074        If False t
+0000dac0: 6865 6e20 7468 6520 6e65 7720 6469 7669  hen the new divi
+0000dad0: 7369 6f6e 7327 206c 6f77 6572 2061 6e64  sions' lower and
+0000dae0: 2075 7070 6572 2062 6f75 6e64 7320 6d75   upper bounds mu
+0000daf0: 7374 2062 650a 2020 2020 2020 2020 2020  st be.          
+0000db00: 2020 7468 6520 7361 6d65 2061 7320 7468    the same as th
+0000db10: 6520 6f6c 6420 6469 7669 7369 6f6e 7327  e old divisions'
+0000db20: 2e0a 0a20 2020 2020 2020 204e 6f74 6573  ...        Notes
+0000db30: 0a20 2020 2020 2020 202d 2d2d 2d2d 0a20  .        -----. 
+0000db40: 2020 2020 2020 2045 7861 6374 6c79 206f         Exactly o
+0000db50: 6e65 206f 6620 6064 6976 6973 696f 6e73  ne of `divisions
+0000db60: 602c 2060 6e70 6172 7469 7469 6f6e 7360  `, `npartitions`
+0000db70: 2c20 6070 6172 7469 7469 6f6e 5f73 697a  , `partition_siz
+0000db80: 6560 2c20 6f72 2060 6672 6571 600a 2020  e`, or `freq`.  
+0000db90: 2020 2020 2020 7368 6f75 6c64 2062 6520        should be 
+0000dba0: 7370 6563 6966 6965 642e 2041 2060 6056  specified. A ``V
+0000dbb0: 616c 7565 4572 726f 7260 6020 7769 6c6c  alueError`` will
+0000dbc0: 2062 6520 7261 6973 6564 2077 6865 6e20   be raised when 
+0000dbd0: 7468 6174 2069 730a 2020 2020 2020 2020  that is.        
+0000dbe0: 6e6f 7420 7468 6520 6361 7365 2e0a 0a20  not the case... 
+0000dbf0: 2020 2020 2020 2041 6c73 6f20 6e6f 7465         Also note
+0000dc00: 2074 6861 7420 6060 6c65 6e28 6469 7669   that ``len(divi
+0000dc10: 736f 6e73 2960 6020 6973 2065 7175 616c  sons)`` is equal
+0000dc20: 2074 6f20 6060 6e70 6172 7469 7469 6f6e   to ``npartition
+0000dc30: 7320 2b20 3160 602e 2054 6869 7320 6973  s + 1``. This is
+0000dc40: 2062 6563 6175 7365 2060 6064 6976 6973   because ``divis
+0000dc50: 696f 6e73 6060 0a20 2020 2020 2020 2072  ions``.        r
+0000dc60: 6570 7265 7365 6e74 7320 7468 6520 7570  epresents the up
+0000dc70: 7065 7220 616e 6420 6c6f 7765 7220 626f  per and lower bo
+0000dc80: 756e 6473 206f 6620 6561 6368 2070 6172  unds of each par
+0000dc90: 7469 7469 6f6e 2e20 5468 6520 6669 7273  tition. The firs
+0000dca0: 7420 6974 656d 2069 7320 7468 650a 2020  t item is the.  
+0000dcb0: 2020 2020 2020 6c6f 7765 7220 626f 756e        lower boun
+0000dcc0: 6420 6f66 2074 6865 2066 6972 7374 2070  d of the first p
+0000dcd0: 6172 7469 7469 6f6e 2c20 7468 6520 7365  artition, the se
+0000dce0: 636f 6e64 2069 7465 6d20 6973 2074 6865  cond item is the
+0000dcf0: 206c 6f77 6572 2062 6f75 6e64 206f 6620   lower bound of 
+0000dd00: 7468 650a 2020 2020 2020 2020 7365 636f  the.        seco
+0000dd10: 6e64 2070 6172 7469 7469 6f6e 2061 6e64  nd partition and
+0000dd20: 2074 6865 2075 7070 6572 2062 6f75 6e64   the upper bound
+0000dd30: 206f 6620 7468 6520 6669 7273 7420 7061   of the first pa
+0000dd40: 7274 6974 696f 6e2c 2061 6e64 2073 6f20  rtition, and so 
+0000dd50: 6f6e 2e0a 2020 2020 2020 2020 5468 6520  on..        The 
+0000dd60: 7365 636f 6e64 2d74 6f2d 6c61 7374 2069  second-to-last i
+0000dd70: 7465 6d20 6973 2074 6865 206c 6f77 6572  tem is the lower
+0000dd80: 2062 6f75 6e64 206f 6620 7468 6520 6c61   bound of the la
+0000dd90: 7374 2070 6172 7469 7469 6f6e 2c20 616e  st partition, an
+0000dda0: 6420 7468 6520 6c61 7374 0a20 2020 2020  d the last.     
+0000ddb0: 2020 2028 6578 7472 6129 2069 7465 6d20     (extra) item 
+0000ddc0: 6973 2074 6865 2075 7070 6572 2062 6f75  is the upper bou
+0000ddd0: 6e64 206f 6620 7468 6520 6c61 7374 2070  nd of the last p
+0000dde0: 6172 7469 7469 6f6e 2e0a 0a20 2020 2020  artition...     
+0000ddf0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
+0000de00: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+0000de10: 2020 2020 203e 3e3e 2064 6620 3d20 6466       >>> df = df
+0000de20: 2e72 6570 6172 7469 7469 6f6e 286e 7061  .repartition(npa
+0000de30: 7274 6974 696f 6e73 3d31 3029 2020 2320  rtitions=10)  # 
+0000de40: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
+0000de50: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0000de60: 6466 2e72 6570 6172 7469 7469 6f6e 2864  df.repartition(d
+0000de70: 6976 6973 696f 6e73 3d5b 302c 2035 2c20  ivisions=[0, 5, 
+0000de80: 3130 2c20 3230 5d29 2020 2320 646f 6374  10, 20])  # doct
+0000de90: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
+0000dea0: 2020 203e 3e3e 2064 6620 3d20 6466 2e72     >>> df = df.r
+0000deb0: 6570 6172 7469 7469 6f6e 2866 7265 713d  epartition(freq=
+0000dec0: 2737 6427 2920 2023 2064 6f63 7465 7374  '7d')  # doctest
+0000ded0: 3a20 2b53 4b49 500a 0a20 2020 2020 2020  : +SKIP..       
+0000dee0: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+0000def0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+0000df00: 2020 2044 6174 6146 7261 6d65 2e6d 656d     DataFrame.mem
+0000df10: 6f72 795f 7573 6167 655f 7065 725f 7061  ory_usage_per_pa
+0000df20: 7274 6974 696f 6e0a 2020 2020 2020 2020  rtition.        
+0000df30: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
+0000df40: 2e6d 656d 6f72 795f 7573 6167 650a 2020  .memory_usage.  
+0000df50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000df60: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0000df70: 6469 7669 7369 6f6e 732c 2069 6e74 293a  divisions, int):
+0000df80: 0a20 2020 2020 2020 2020 2020 206e 7061  .            npa
+0000df90: 7274 6974 696f 6e73 203d 2064 6976 6973  rtitions = divis
+0000dfa0: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
+0000dfb0: 2064 6976 6973 696f 6e73 203d 204e 6f6e   divisions = Non
+0000dfc0: 650a 2020 2020 2020 2020 6966 2069 7369  e.        if isi
+0000dfd0: 6e73 7461 6e63 6528 6469 7669 7369 6f6e  nstance(division
+0000dfe0: 732c 2073 7472 293a 0a20 2020 2020 2020  s, str):.       
+0000dff0: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
+0000e000: 697a 6520 3d20 6469 7669 7369 6f6e 730a  ize = divisions.
+0000e010: 2020 2020 2020 2020 2020 2020 6469 7669              divi
+0000e020: 7369 6f6e 7320 3d20 4e6f 6e65 0a20 2020  sions = None.   
+0000e030: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
+0000e040: 2020 2020 2020 7375 6d28 0a20 2020 2020        sum(.     
+0000e050: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+0000e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e070: 2070 6172 7469 7469 6f6e 5f73 697a 6520   partition_size 
+0000e080: 6973 206e 6f74 204e 6f6e 652c 0a20 2020  is not None,.   
 0000e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e0a0: 2020 2066 7265 7120 6973 206e 6f74 204e     freq is not N
-0000e0b0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0000e0c0: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-0000e0d0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000e0e0: 2021 3d20 310a 2020 2020 2020 2020 293a   != 1.        ):
-0000e0f0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000e100: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0000e110: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000e120: 506c 6561 7365 2070 726f 7669 6465 2065  Please provide e
-0000e130: 7861 6374 6c79 206f 6e65 206f 6620 6060  xactly one of ``
-0000e140: 6e70 6172 7469 7469 6f6e 733d 6060 2c20  npartitions=``, 
-0000e150: 6060 6672 6571 3d60 602c 2022 0a20 2020  ``freq=``, ".   
-0000e160: 2020 2020 2020 2020 2020 2020 2022 6060               "``
-0000e170: 6469 7669 7369 6f6e 733d 6060 2c20 6060  divisions=``, ``
-0000e180: 7061 7274 6974 696f 6e5f 7369 7a65 3d60  partition_size=`
-0000e190: 6020 6b65 7977 6f72 6420 6172 6775 6d65  ` keyword argume
-0000e1a0: 6e74 7322 0a20 2020 2020 2020 2020 2020  nts".           
-0000e1b0: 2029 0a0a 2020 2020 2020 2020 6966 2070   )..        if p
-0000e1c0: 6172 7469 7469 6f6e 5f73 697a 6520 6973  artition_size is
-0000e1d0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000e1e0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-0000e1f0: 7061 7274 6974 696f 6e5f 7369 7a65 2873  partition_size(s
-0000e200: 656c 662c 2070 6172 7469 7469 6f6e 5f73  elf, partition_s
-0000e210: 697a 6529 0a20 2020 2020 2020 2065 6c69  ize).        eli
-0000e220: 6620 6e70 6172 7469 7469 6f6e 7320 6973  f npartitions is
-0000e230: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000e240: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-0000e250: 7061 7274 6974 696f 6e5f 6e70 6172 7469  partition_nparti
-0000e260: 7469 6f6e 7328 7365 6c66 2c20 6e70 6172  tions(self, npar
-0000e270: 7469 7469 6f6e 7329 0a20 2020 2020 2020  titions).       
-0000e280: 2065 6c69 6620 6469 7669 7369 6f6e 7320   elif divisions 
-0000e290: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0000e2a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000e2b0: 7265 7061 7274 6974 696f 6e28 7365 6c66  repartition(self
-0000e2c0: 2c20 6469 7669 7369 6f6e 732c 2066 6f72  , divisions, for
-0000e2d0: 6365 3d66 6f72 6365 290a 2020 2020 2020  ce=force).      
-0000e2e0: 2020 656c 6966 2066 7265 7120 6973 206e    elif freq is n
-0000e2f0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0000e300: 2020 2020 2072 6574 7572 6e20 7265 7061       return repa
-0000e310: 7274 6974 696f 6e5f 6672 6571 2873 656c  rtition_freq(sel
-0000e320: 662c 2066 7265 713d 6672 6571 290a 0a20  f, freq=freq).. 
-0000e330: 2020 2064 6566 2073 6875 6666 6c65 280a     def shuffle(.
-0000e340: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000e350: 2020 2020 2020 6f6e 2c0a 2020 2020 2020        on,.      
-0000e360: 2020 6e70 6172 7469 7469 6f6e 733d 4e6f    npartitions=No
-0000e370: 6e65 2c0a 2020 2020 2020 2020 6d61 785f  ne,.        max_
-0000e380: 6272 616e 6368 3d4e 6f6e 652c 0a20 2020  branch=None,.   
-0000e390: 2020 2020 2073 6875 6666 6c65 3d4e 6f6e       shuffle=Non
-0000e3a0: 652c 0a20 2020 2020 2020 2069 676e 6f72  e,.        ignor
-0000e3b0: 655f 696e 6465 783d 4661 6c73 652c 0a20  e_index=False,. 
-0000e3c0: 2020 2020 2020 2063 6f6d 7075 7465 3d4e         compute=N
-0000e3d0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-0000e3e0: 2020 2020 2222 2252 6561 7272 616e 6765      """Rearrange
-0000e3f0: 2044 6174 6146 7261 6d65 2069 6e74 6f20   DataFrame into 
-0000e400: 6e65 7720 7061 7274 6974 696f 6e73 0a0a  new partitions..
-0000e410: 2020 2020 2020 2020 5573 6573 2068 6173          Uses has
-0000e420: 6869 6e67 206f 6620 606f 6e60 2074 6f20  hing of `on` to 
-0000e430: 6d61 7020 726f 7773 2074 6f20 6f75 7470  map rows to outp
-0000e440: 7574 2070 6172 7469 7469 6f6e 732e 2041  ut partitions. A
-0000e450: 6674 6572 2074 6869 730a 2020 2020 2020  fter this.      
-0000e460: 2020 6f70 6572 6174 696f 6e2c 2072 6f77    operation, row
-0000e470: 7320 7769 7468 2074 6865 2073 616d 6520  s with the same 
-0000e480: 7661 6c75 6520 6f66 2060 6f6e 6020 7769  value of `on` wi
-0000e490: 6c6c 2062 6520 696e 2074 6865 2073 616d  ll be in the sam
-0000e4a0: 650a 2020 2020 2020 2020 7061 7274 6974  e.        partit
-0000e4b0: 696f 6e2e 0a0a 2020 2020 2020 2020 5061  ion...        Pa
-0000e4c0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-0000e4d0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0000e4e0: 2020 2020 6f6e 203a 2073 7472 2c20 6c69      on : str, li
-0000e4f0: 7374 206f 6620 7374 722c 206f 7220 5365  st of str, or Se
-0000e500: 7269 6573 2c20 496e 6465 782c 206f 7220  ries, Index, or 
-0000e510: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
-0000e520: 2020 2020 2020 436f 6c75 6d6e 2873 2920        Column(s) 
-0000e530: 6f72 2069 6e64 6578 2074 6f20 6265 2075  or index to be u
-0000e540: 7365 6420 746f 206d 6170 2072 6f77 7320  sed to map rows 
-0000e550: 746f 206f 7574 7075 7420 7061 7274 6974  to output partit
-0000e560: 696f 6e73 0a20 2020 2020 2020 206e 7061  ions.        npa
-0000e570: 7274 6974 696f 6e73 203a 2069 6e74 2c20  rtitions : int, 
-0000e580: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-0000e590: 2020 2020 204e 756d 6265 7220 6f66 2070       Number of p
-0000e5a0: 6172 7469 7469 6f6e 7320 6f66 206f 7574  artitions of out
-0000e5b0: 7075 742e 2050 6172 7469 7469 6f6e 2063  put. Partition c
-0000e5c0: 6f75 6e74 2077 696c 6c20 6e6f 7420 6265  ount will not be
-0000e5d0: 0a20 2020 2020 2020 2020 2020 2063 6861  .            cha
-0000e5e0: 6e67 6564 2062 7920 6465 6661 756c 742e  nged by default.
-0000e5f0: 0a20 2020 2020 2020 206d 6178 5f62 7261  .        max_bra
-0000e600: 6e63 683a 2069 6e74 2c20 6f70 7469 6f6e  nch: int, option
-0000e610: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
-0000e620: 6865 206d 6178 696d 756d 206e 756d 6265  he maximum numbe
-0000e630: 7220 6f66 2073 706c 6974 7320 7065 7220  r of splits per 
-0000e640: 696e 7075 7420 7061 7274 6974 696f 6e2e  input partition.
-0000e650: 2055 7365 6420 7769 7468 696e 0a20 2020   Used within.   
-0000e660: 2020 2020 2020 2020 2074 6865 2073 7461           the sta
-0000e670: 6765 6420 7368 7566 666c 696e 6720 616c  ged shuffling al
-0000e680: 676f 7269 7468 6d2e 0a20 2020 2020 2020  gorithm..       
-0000e690: 2073 6875 6666 6c65 3a20 7b27 6469 736b   shuffle: {'disk
-0000e6a0: 272c 2027 7461 736b 7327 7d2c 206f 7074  ', 'tasks'}, opt
-0000e6b0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0000e6c0: 2020 4569 7468 6572 2060 6027 6469 736b    Either ``'disk
-0000e6d0: 2760 6020 666f 7220 7369 6e67 6c65 2d6e  '`` for single-n
-0000e6e0: 6f64 6520 6f70 6572 6174 696f 6e20 6f72  ode operation or
-0000e6f0: 2060 6027 7461 736b 7327 6060 2066 6f72   ``'tasks'`` for
-0000e700: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
-0000e710: 7472 6962 7574 6564 206f 7065 7261 7469  tributed operati
-0000e720: 6f6e 2e20 2057 696c 6c20 6265 2069 6e66  on.  Will be inf
-0000e730: 6572 7265 6420 6279 2079 6f75 7220 6375  erred by your cu
-0000e740: 7272 656e 7420 7363 6865 6475 6c65 722e  rrent scheduler.
-0000e750: 0a20 2020 2020 2020 2069 676e 6f72 655f  .        ignore_
-0000e760: 696e 6465 783a 2062 6f6f 6c2c 2064 6566  index: bool, def
-0000e770: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
-0000e780: 2020 2020 2020 2049 676e 6f72 6520 696e         Ignore in
-0000e790: 6465 7820 6475 7269 6e67 2073 6875 6666  dex during shuff
-0000e7a0: 6c65 2e20 2049 6620 6060 5472 7565 6060  le.  If ``True``
-0000e7b0: 2c20 7065 7266 6f72 6d61 6e63 6520 6d61  , performance ma
-0000e7c0: 7920 696d 7072 6f76 652c 0a20 2020 2020  y improve,.     
-0000e7d0: 2020 2020 2020 2062 7574 2069 6e64 6578         but index
-0000e7e0: 2076 616c 7565 7320 7769 6c6c 206e 6f74   values will not
-0000e7f0: 2062 6520 7072 6573 6572 7665 642e 0a20   be preserved.. 
-0000e800: 2020 2020 2020 2063 6f6d 7075 7465 3a20         compute: 
-0000e810: 626f 6f6c 0a20 2020 2020 2020 2020 2020  bool.           
-0000e820: 2057 6865 7468 6572 206f 7220 6e6f 7420   Whether or not 
-0000e830: 746f 2074 7269 6767 6572 2061 6e20 696d  to trigger an im
-0000e840: 6d65 6469 6174 6520 636f 6d70 7574 6174  mediate computat
-0000e850: 696f 6e2e 2044 6566 6175 6c74 7320 746f  ion. Defaults to
-0000e860: 2046 616c 7365 2e0a 0a20 2020 2020 2020   False...       
-0000e870: 204e 6f74 6573 0a20 2020 2020 2020 202d   Notes.        -
-0000e880: 2d2d 2d2d 0a20 2020 2020 2020 2054 6869  ----.        Thi
-0000e890: 7320 646f 6573 206e 6f74 2070 7265 7365  s does not prese
-0000e8a0: 7276 6520 6120 6d65 616e 696e 6766 756c  rve a meaningful
-0000e8b0: 2069 6e64 6578 2f70 6172 7469 7469 6f6e   index/partition
-0000e8c0: 696e 6720 7363 6865 6d65 2e20 5468 6973  ing scheme. This
-0000e8d0: 0a20 2020 2020 2020 2069 7320 6e6f 7420  .        is not 
-0000e8e0: 6465 7465 726d 696e 6973 7469 6320 6966  deterministic if
-0000e8f0: 2064 6f6e 6520 696e 2070 6172 616c 6c65   done in paralle
-0000e900: 6c2e 0a0a 2020 2020 2020 2020 4578 616d  l...        Exam
-0000e910: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-0000e920: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
-0000e930: 3e20 6466 203d 2064 662e 7368 7566 666c  > df = df.shuffl
-0000e940: 6528 6466 2e63 6f6c 756d 6e73 5b30 5d29  e(df.columns[0])
-0000e950: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-0000e960: 4950 0a20 2020 2020 2020 2022 2222 0a20  IP.        """. 
-0000e970: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-0000e980: 2e64 6174 6166 7261 6d65 2e73 6875 6666  .dataframe.shuff
-0000e990: 6c65 2069 6d70 6f72 7420 7368 7566 666c  le import shuffl
-0000e9a0: 6520 6173 2064 645f 7368 7566 666c 650a  e as dd_shuffle.
-0000e9b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000e9c0: 6464 5f73 6875 6666 6c65 280a 2020 2020  dd_shuffle(.    
-0000e9d0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000e9e0: 2020 2020 2020 2020 2020 6f6e 2c0a 2020            on,.  
-0000e9f0: 2020 2020 2020 2020 2020 6e70 6172 7469            nparti
-0000ea00: 7469 6f6e 733d 6e70 6172 7469 7469 6f6e  tions=npartition
-0000ea10: 732c 0a20 2020 2020 2020 2020 2020 206d  s,.            m
-0000ea20: 6178 5f62 7261 6e63 683d 6d61 785f 6272  ax_branch=max_br
-0000ea30: 616e 6368 2c0a 2020 2020 2020 2020 2020  anch,.          
-0000ea40: 2020 7368 7566 666c 653d 7368 7566 666c    shuffle=shuffl
-0000ea50: 652c 0a20 2020 2020 2020 2020 2020 2069  e,.            i
-0000ea60: 676e 6f72 655f 696e 6465 783d 6967 6e6f  gnore_index=igno
-0000ea70: 7265 5f69 6e64 6578 2c0a 2020 2020 2020  re_index,.      
-0000ea80: 2020 2020 2020 636f 6d70 7574 653d 636f        compute=co
-0000ea90: 6d70 7574 652c 0a20 2020 2020 2020 2029  mpute,.        )
-0000eaa0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0000eab0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0000eac0: 290a 2020 2020 6465 6620 6669 6c6c 6e61  ).    def fillna
-0000ead0: 2873 656c 662c 2076 616c 7565 3d4e 6f6e  (self, value=Non
-0000eae0: 652c 206d 6574 686f 643d 4e6f 6e65 2c20  e, method=None, 
-0000eaf0: 6c69 6d69 743d 4e6f 6e65 2c20 6178 6973  limit=None, axis
-0000eb00: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-0000eb10: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
-0000eb20: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
-0000eb30: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
-0000eb40: 6f64 2069 7320 4e6f 6e65 2061 6e64 206c  od is None and l
-0000eb50: 696d 6974 2069 7320 6e6f 7420 4e6f 6e65  imit is not None
-0000eb60: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000eb70: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-0000eb80: 6564 4572 726f 7228 2266 696c 6c6e 6120  edError("fillna 
-0000eb90: 7769 7468 2073 6574 206c 696d 6974 2061  with set limit a
-0000eba0: 6e64 206d 6574 686f 643d 4e6f 6e65 2229  nd method=None")
-0000ebb0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0000ebc0: 7374 616e 6365 2876 616c 7565 2c20 285f  stance(value, (_
-0000ebd0: 4672 616d 652c 2053 6361 6c61 7229 293a  Frame, Scalar)):
-0000ebe0: 0a20 2020 2020 2020 2020 2020 2074 6573  .            tes
-0000ebf0: 745f 7661 6c75 6520 3d20 7661 6c75 652e  t_value = value.
-0000ec00: 5f6d 6574 615f 6e6f 6e65 6d70 7479 0a20  _meta_nonempty. 
-0000ec10: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000ec20: 2020 2020 2020 2020 2074 6573 745f 7661           test_va
-0000ec30: 6c75 6520 3d20 7661 6c75 650a 2020 2020  lue = value.    
-0000ec40: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
-0000ec50: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e66  _meta_nonempty.f
-0000ec60: 696c 6c6e 6128 0a20 2020 2020 2020 2020  illna(.         
-0000ec70: 2020 2076 616c 7565 3d74 6573 745f 7661     value=test_va
-0000ec80: 6c75 652c 206d 6574 686f 643d 6d65 7468  lue, method=meth
-0000ec90: 6f64 2c20 6c69 6d69 743d 6c69 6d69 742c  od, limit=limit,
-0000eca0: 2061 7869 733d 6178 6973 0a20 2020 2020   axis=axis.     
-0000ecb0: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
-0000ecc0: 2061 7869 7320 3d3d 2031 206f 7220 6d65   axis == 1 or me
-0000ecd0: 7468 6f64 2069 7320 4e6f 6e65 3a0a 2020  thod is None:.  
-0000ece0: 2020 2020 2020 2020 2020 2320 436f 6e74            # Cont
-0000ecf0: 726f 6c20 7768 6574 6865 7220 6f72 206e  rol whether or n
-0000ed00: 6f74 2064 6173 6b27 7320 7061 7274 6974  ot dask's partit
-0000ed10: 696f 6e20 616c 6967 6e6d 656e 7420 6861  ion alignment ha
-0000ed20: 7070 656e 732e 0a20 2020 2020 2020 2020  ppens..         
-0000ed30: 2020 2023 2057 6520 646f 6e27 7420 7761     # We don't wa
-0000ed40: 6e74 2066 6f72 2061 2070 616e 6461 7320  nt for a pandas 
-0000ed50: 5365 7269 6573 2e0a 2020 2020 2020 2020  Series..        
-0000ed60: 2020 2020 2320 5765 2064 6f20 7761 6e74      # We do want
-0000ed70: 2069 7420 666f 7220 6120 6461 736b 2053   it for a dask S
-0000ed80: 6572 6965 730a 2020 2020 2020 2020 2020  eries.          
-0000ed90: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
-0000eda0: 696b 6528 7661 6c75 6529 2061 6e64 206e  ike(value) and n
-0000edb0: 6f74 2069 735f 6461 736b 5f63 6f6c 6c65  ot is_dask_colle
-0000edc0: 6374 696f 6e28 7661 6c75 6529 3a0a 2020  ction(value):.  
-0000edd0: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-0000ede0: 6773 203d 2028 290a 2020 2020 2020 2020  gs = ().        
-0000edf0: 2020 2020 2020 2020 6b77 6172 6773 203d          kwargs =
-0000ee00: 207b 2276 616c 7565 223a 2076 616c 7565   {"value": value
-0000ee10: 7d0a 2020 2020 2020 2020 2020 2020 656c  }.            el
-0000ee20: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000ee30: 2020 2020 6172 6773 203d 2028 7661 6c75      args = (valu
-0000ee40: 652c 290a 2020 2020 2020 2020 2020 2020  e,).            
-0000ee50: 2020 2020 6b77 6172 6773 203d 207b 7d0a      kwargs = {}.
-0000ee60: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000ee70: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-0000ee80: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-0000ee90: 2020 2020 2020 2020 4d2e 6669 6c6c 6e61          M.fillna
-0000eea0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000eeb0: 2020 2a61 7267 732c 0a20 2020 2020 2020    *args,.       
-0000eec0: 2020 2020 2020 2020 206d 6574 686f 643d           method=
-0000eed0: 6d65 7468 6f64 2c0a 2020 2020 2020 2020  method,.        
-0000eee0: 2020 2020 2020 2020 6c69 6d69 743d 6c69          limit=li
-0000eef0: 6d69 742c 0a20 2020 2020 2020 2020 2020  mit,.           
-0000ef00: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
-0000ef10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef20: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
-0000ef30: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
-0000ef40: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-0000ef50: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0000ef60: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
-0000ef70: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000ef80: 2020 2020 6966 206d 6574 686f 6420 696e      if method in
-0000ef90: 2028 2270 6164 222c 2022 6666 696c 6c22   ("pad", "ffill"
-0000efa0: 293a 0a20 2020 2020 2020 2020 2020 206d  ):.            m
-0000efb0: 6574 686f 6420 3d20 2266 6669 6c6c 220a  ethod = "ffill".
-0000efc0: 2020 2020 2020 2020 2020 2020 736b 6970              skip
-0000efd0: 5f63 6865 636b 203d 2030 0a20 2020 2020  _check = 0.     
-0000efe0: 2020 2020 2020 2062 6566 6f72 652c 2061         before, a
-0000eff0: 6674 6572 203d 2031 2069 6620 6c69 6d69  fter = 1 if limi
-0000f000: 7420 6973 204e 6f6e 6520 656c 7365 206c  t is None else l
-0000f010: 696d 6974 2c20 300a 2020 2020 2020 2020  imit, 0.        
-0000f020: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000f030: 2020 6d65 7468 6f64 203d 2022 6266 696c    method = "bfil
-0000f040: 6c22 0a20 2020 2020 2020 2020 2020 2073  l".            s
-0000f050: 6b69 705f 6368 6563 6b20 3d20 7365 6c66  kip_check = self
-0000f060: 2e6e 7061 7274 6974 696f 6e73 202d 2031  .npartitions - 1
-0000f070: 0a20 2020 2020 2020 2020 2020 2062 6566  .            bef
-0000f080: 6f72 652c 2061 6674 6572 203d 2030 2c20  ore, after = 0, 
-0000f090: 3120 6966 206c 696d 6974 2069 7320 4e6f  1 if limit is No
-0000f0a0: 6e65 2065 6c73 6520 6c69 6d69 740a 0a20  ne else limit.. 
-0000f0b0: 2020 2020 2020 2069 6620 6c69 6d69 7420         if limit 
-0000f0c0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0000f0d0: 2020 2020 206e 616d 6520 3d20 2266 696c       name = "fil
-0000f0e0: 6c6e 612d 6368 756e 6b2d 2220 2b20 746f  lna-chunk-" + to
-0000f0f0: 6b65 6e69 7a65 2873 656c 662c 206d 6574  kenize(self, met
-0000f100: 686f 6429 0a20 2020 2020 2020 2020 2020  hod).           
-0000f110: 2064 736b 203d 207b 0a20 2020 2020 2020   dsk = {.       
-0000f120: 2020 2020 2020 2020 2028 6e61 6d65 2c20           (name, 
-0000f130: 6929 3a20 280a 2020 2020 2020 2020 2020  i): (.          
-0000f140: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-0000f150: 732e 6669 6c6c 6e61 5f63 6865 636b 2c0a  s.fillna_check,.
-0000f160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f170: 2020 2020 2873 656c 662e 5f6e 616d 652c      (self._name,
-0000f180: 2069 292c 0a20 2020 2020 2020 2020 2020   i),.           
-0000f190: 2020 2020 2020 2020 206d 6574 686f 642c           method,
-0000f1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f1b0: 2020 2020 2069 2021 3d20 736b 6970 5f63       i != skip_c
-0000f1c0: 6865 636b 2c0a 2020 2020 2020 2020 2020  heck,.          
-0000f1d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000f1e0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-0000f1f0: 2072 616e 6765 2873 656c 662e 6e70 6172   range(self.npar
-0000f200: 7469 7469 6f6e 7329 0a20 2020 2020 2020  titions).       
-0000f210: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-0000f220: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-0000f230: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-0000f240: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-0000f250: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-0000f260: 6573 3d5b 7365 6c66 5d29 0a20 2020 2020  es=[self]).     
-0000f270: 2020 2020 2020 2070 6172 7473 203d 206e         parts = n
-0000f280: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
-0000f290: 7068 2c20 6e61 6d65 2c20 6d65 7461 2c20  ph, name, meta, 
-0000f2a0: 7365 6c66 2e64 6976 6973 696f 6e73 290a  self.divisions).
-0000f2b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000f2c0: 2020 2020 2020 2020 2020 7061 7274 7320            parts 
-0000f2d0: 3d20 7365 6c66 0a0a 2020 2020 2020 2020  = self..        
-0000f2e0: 7265 7475 726e 2070 6172 7473 2e6d 6170  return parts.map
-0000f2f0: 5f6f 7665 726c 6170 280a 2020 2020 2020  _overlap(.      
-0000f300: 2020 2020 2020 4d2e 6669 6c6c 6e61 2c20        M.fillna, 
-0000f310: 6265 666f 7265 2c20 6166 7465 722c 206d  before, after, m
-0000f320: 6574 686f 643d 6d65 7468 6f64 2c20 6c69  ethod=method, li
-0000f330: 6d69 743d 6c69 6d69 742c 206d 6574 613d  mit=limit, meta=
-0000f340: 6d65 7461 0a20 2020 2020 2020 2029 0a0a  meta.        )..
-0000f350: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0000f360: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0000f370: 2020 2020 6465 6620 6666 696c 6c28 7365      def ffill(se
-0000f380: 6c66 2c20 6178 6973 3d4e 6f6e 652c 206c  lf, axis=None, l
-0000f390: 696d 6974 3d4e 6f6e 6529 3a0a 2020 2020  imit=None):.    
-0000f3a0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000f3b0: 6669 6c6c 6e61 286d 6574 686f 643d 2266  fillna(method="f
-0000f3c0: 6669 6c6c 222c 206c 696d 6974 3d6c 696d  fill", limit=lim
-0000f3d0: 6974 2c20 6178 6973 3d61 7869 7329 0a0a  it, axis=axis)..
-0000f3e0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0000f3f0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0000f400: 2020 2020 6465 6620 6266 696c 6c28 7365      def bfill(se
-0000f410: 6c66 2c20 6178 6973 3d4e 6f6e 652c 206c  lf, axis=None, l
-0000f420: 696d 6974 3d4e 6f6e 6529 3a0a 2020 2020  imit=None):.    
-0000f430: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000f440: 6669 6c6c 6e61 286d 6574 686f 643d 2262  fillna(method="b
-0000f450: 6669 6c6c 222c 206c 696d 6974 3d6c 696d  fill", limit=lim
-0000f460: 6974 2c20 6178 6973 3d61 7869 7329 0a0a  it, axis=axis)..
-0000f470: 2020 2020 6465 6620 7361 6d70 6c65 2873      def sample(s
-0000f480: 656c 662c 206e 3d4e 6f6e 652c 2066 7261  elf, n=None, fra
-0000f490: 633d 4e6f 6e65 2c20 7265 706c 6163 653d  c=None, replace=
-0000f4a0: 4661 6c73 652c 2072 616e 646f 6d5f 7374  False, random_st
-0000f4b0: 6174 653d 4e6f 6e65 293a 0a20 2020 2020  ate=None):.     
-0000f4c0: 2020 2022 2222 5261 6e64 6f6d 2073 616d     """Random sam
-0000f4d0: 706c 6520 6f66 2069 7465 6d73 0a0a 2020  ple of items..  
-0000f4e0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0000f4f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000f500: 2d2d 2d0a 2020 2020 2020 2020 6e20 3a20  ---.        n : 
-0000f510: 696e 742c 206f 7074 696f 6e61 6c0a 2020  int, optional.  
-0000f520: 2020 2020 2020 2020 2020 4e75 6d62 6572            Number
-0000f530: 206f 6620 6974 656d 7320 746f 2072 6574   of items to ret
-0000f540: 7572 6e20 6973 206e 6f74 2073 7570 706f  urn is not suppo
-0000f550: 7274 6564 2062 7920 6461 736b 2e20 5573  rted by dask. Us
-0000f560: 6520 6672 6163 0a20 2020 2020 2020 2020  e frac.         
-0000f570: 2020 2069 6e73 7465 6164 2e0a 2020 2020     instead..    
-0000f580: 2020 2020 6672 6163 203a 2066 6c6f 6174      frac : float
-0000f590: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0000f5a0: 2020 2020 2020 2041 7070 726f 7869 6d61         Approxima
-0000f5b0: 7465 2066 7261 6374 696f 6e20 6f66 2069  te fraction of i
-0000f5c0: 7465 6d73 2074 6f20 7265 7475 726e 2e20  tems to return. 
-0000f5d0: 5468 6973 2073 616d 706c 696e 6720 6672  This sampling fr
-0000f5e0: 6163 7469 6f6e 2069 730a 2020 2020 2020  action is.      
-0000f5f0: 2020 2020 2020 6170 706c 6965 6420 746f        applied to
-0000f600: 2061 6c6c 2070 6172 7469 7469 6f6e 7320   all partitions 
-0000f610: 6571 7561 6c6c 792e 204e 6f74 6520 7468  equally. Note th
-0000f620: 6174 2074 6869 7320 6973 2061 6e0a 2020  at this is an.  
-0000f630: 2020 2020 2020 2020 2020 2a2a 6170 7072            **appr
-0000f640: 6f78 696d 6174 6520 6672 6163 7469 6f6e  oximate fraction
-0000f650: 2a2a 2e20 596f 7520 7368 6f75 6c64 206e  **. You should n
-0000f660: 6f74 2065 7870 6563 7420 6578 6163 746c  ot expect exactl
-0000f670: 7920 6060 6c65 6e28 6466 2920 2a20 6672  y ``len(df) * fr
-0000f680: 6163 6060 0a20 2020 2020 2020 2020 2020  ac``.           
-0000f690: 2069 7465 6d73 2074 6f20 6265 2072 6574   items to be ret
-0000f6a0: 7572 6e65 642c 2061 7320 7468 6520 6578  urned, as the ex
-0000f6b0: 6163 7420 6e75 6d62 6572 206f 6620 656c  act number of el
-0000f6c0: 656d 656e 7473 2073 656c 6563 7465 6420  ements selected 
-0000f6d0: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
-0000f6e0: 2064 6570 656e 6420 6f6e 2068 6f77 2079   depend on how y
-0000f6f0: 6f75 7220 6461 7461 2069 7320 7061 7274  our data is part
-0000f700: 6974 696f 6e65 6420 2862 7574 2073 686f  itioned (but sho
-0000f710: 756c 6420 6265 2070 7265 7474 7920 636c  uld be pretty cl
-0000f720: 6f73 650a 2020 2020 2020 2020 2020 2020  ose.            
-0000f730: 696e 2070 7261 6374 6963 6529 2e0a 2020  in practice)..  
-0000f740: 2020 2020 2020 7265 706c 6163 6520 3a20        replace : 
-0000f750: 626f 6f6c 6561 6e2c 206f 7074 696f 6e61  boolean, optiona
-0000f760: 6c0a 2020 2020 2020 2020 2020 2020 5361  l.            Sa
-0000f770: 6d70 6c65 2077 6974 6820 6f72 2077 6974  mple with or wit
-0000f780: 686f 7574 2072 6570 6c61 6365 6d65 6e74  hout replacement
-0000f790: 2e20 4465 6661 756c 7420 3d20 4661 6c73  . Default = Fals
-0000f7a0: 652e 0a20 2020 2020 2020 2072 616e 646f  e..        rando
-0000f7b0: 6d5f 7374 6174 6520 3a20 696e 7420 6f72  m_state : int or
-0000f7c0: 2060 606e 702e 7261 6e64 6f6d 2e52 616e   ``np.random.Ran
-0000f7d0: 646f 6d53 7461 7465 6060 0a20 2020 2020  domState``.     
-0000f7e0: 2020 2020 2020 2049 6620 616e 2069 6e74         If an int
-0000f7f0: 2c20 7765 2063 7265 6174 6520 6120 6e65  , we create a ne
-0000f800: 7720 5261 6e64 6f6d 5374 6174 6520 7769  w RandomState wi
-0000f810: 7468 2074 6869 7320 6173 2074 6865 2073  th this as the s
-0000f820: 6565 643b 0a20 2020 2020 2020 2020 2020  eed;.           
-0000f830: 204f 7468 6572 7769 7365 2077 6520 6472   Otherwise we dr
-0000f840: 6177 2066 726f 6d20 7468 6520 7061 7373  aw from the pass
-0000f850: 6564 2052 616e 646f 6d53 7461 7465 2e0a  ed RandomState..
-0000f860: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-0000f870: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-0000f880: 2d2d 0a20 2020 2020 2020 2044 6174 6146  --.        DataF
-0000f890: 7261 6d65 2e72 616e 646f 6d5f 7370 6c69  rame.random_spli
-0000f8a0: 740a 2020 2020 2020 2020 7061 6e64 6173  t.        pandas
-0000f8b0: 2e44 6174 6146 7261 6d65 2e73 616d 706c  .DataFrame.sampl
-0000f8c0: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
-0000f8d0: 2020 2020 2020 6966 206e 2069 7320 6e6f        if n is no
-0000f8e0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0000f8f0: 2020 2020 6d73 6720 3d20 280a 2020 2020      msg = (.    
-0000f900: 2020 2020 2020 2020 2020 2020 2273 616d              "sam
-0000f910: 706c 6520 646f 6573 206e 6f74 2073 7570  ple does not sup
-0000f920: 706f 7274 2074 6865 206e 756d 6265 7220  port the number 
-0000f930: 6f66 2073 616d 706c 6564 2069 7465 6d73  of sampled items
-0000f940: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0000f950: 2020 2022 7061 7261 6d65 7465 722c 2027     "parameter, '
-0000f960: 6e27 2e20 506c 6561 7365 2075 7365 2074  n'. Please use t
-0000f970: 6865 2027 6672 6163 2720 7061 7261 6d65  he 'frac' parame
-0000f980: 7465 7220 696e 7374 6561 642e 220a 2020  ter instead.".  
-0000f990: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000f9a0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0000f9b0: 7461 6e63 6528 6e2c 204e 756d 6265 7229  tance(n, Number)
-0000f9c0: 2061 6e64 2030 203c 3d20 6e20 3c3d 2031   and 0 <= n <= 1
-0000f9d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000f9e0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-0000f9f0: 6d73 6729 0a20 2020 2020 2020 2020 2020  msg).           
-0000fa00: 2020 2020 2066 7261 6320 3d20 6e0a 2020       frac = n.  
-0000fa10: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fa30: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0000fa40: 286d 7367 290a 0a20 2020 2020 2020 2069  (msg)..        i
-0000fa50: 6620 6672 6163 2069 7320 4e6f 6e65 3a0a  f frac is None:.
-0000fa60: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000fa70: 6520 5661 6c75 6545 7272 6f72 2822 6672  e ValueError("fr
-0000fa80: 6163 206d 7573 7420 6e6f 7420 6265 204e  ac must not be N
-0000fa90: 6f6e 6522 290a 0a20 2020 2020 2020 2069  one")..        i
-0000faa0: 6620 7261 6e64 6f6d 5f73 7461 7465 2069  f random_state i
-0000fab0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0000fac0: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
-0000fad0: 203d 206e 702e 7261 6e64 6f6d 2e52 616e   = np.random.Ran
-0000fae0: 646f 6d53 7461 7465 2829 0a0a 2020 2020  domState()..    
-0000faf0: 2020 2020 6e61 6d65 203d 2022 7361 6d70      name = "samp
-0000fb00: 6c65 2d22 202b 2074 6f6b 656e 697a 6528  le-" + tokenize(
-0000fb10: 7365 6c66 2c20 6672 6163 2c20 7265 706c  self, frac, repl
-0000fb20: 6163 652c 2072 616e 646f 6d5f 7374 6174  ace, random_stat
-0000fb30: 6529 0a0a 2020 2020 2020 2020 7374 6174  e)..        stat
-0000fb40: 655f 6461 7461 203d 2072 616e 646f 6d5f  e_data = random_
-0000fb50: 7374 6174 655f 6461 7461 2873 656c 662e  state_data(self.
-0000fb60: 6e70 6172 7469 7469 6f6e 732c 2072 616e  npartitions, ran
-0000fb70: 646f 6d5f 7374 6174 6529 0a20 2020 2020  dom_state).     
-0000fb80: 2020 2064 736b 203d 207b 0a20 2020 2020     dsk = {.     
-0000fb90: 2020 2020 2020 2028 6e61 6d65 2c20 6929         (name, i)
-0000fba0: 3a20 286d 6574 686f 6473 2e73 616d 706c  : (methods.sampl
-0000fbb0: 652c 2028 7365 6c66 2e5f 6e61 6d65 2c20  e, (self._name, 
-0000fbc0: 6929 2c20 7374 6174 652c 2066 7261 632c  i), state, frac,
-0000fbd0: 2072 6570 6c61 6365 290a 2020 2020 2020   replace).      
-0000fbe0: 2020 2020 2020 666f 7220 692c 2073 7461        for i, sta
-0000fbf0: 7465 2069 6e20 656e 756d 6572 6174 6528  te in enumerate(
-0000fc00: 7374 6174 655f 6461 7461 290a 2020 2020  state_data).    
-0000fc10: 2020 2020 7d0a 0a20 2020 2020 2020 2067      }..        g
-0000fc20: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-0000fc30: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-0000fc40: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
-0000fc50: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
-0000fc60: 7365 6c66 5d29 0a20 2020 2020 2020 2072  self]).        r
-0000fc70: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
-0000fc80: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
-0000fc90: 2073 656c 662e 5f6d 6574 612c 2073 656c   self._meta, sel
-0000fca0: 662e 6469 7669 7369 6f6e 7329 0a0a 2020  f.divisions)..  
-0000fcb0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-0000fcc0: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-0000fcd0: 2020 6465 6620 7265 706c 6163 6528 7365    def replace(se
-0000fce0: 6c66 2c20 746f 5f72 6570 6c61 6365 3d4e  lf, to_replace=N
-0000fcf0: 6f6e 652c 2076 616c 7565 3d4e 6f6e 652c  one, value=None,
-0000fd00: 2072 6567 6578 3d46 616c 7365 293a 0a20   regex=False):. 
-0000fd10: 2020 2020 2020 2023 2049 6e20 5041 4e44         # In PAND
-0000fd20: 4153 5f47 545f 3134 3020 7061 6e64 6173  AS_GT_140 pandas
-0000fd30: 2073 7461 7274 7320 7573 696e 6720 6e6f   starts using no
-0000fd40: 5f64 6566 6175 6c74 2069 6e73 7465 6164  _default instead
-0000fd50: 206f 6620 4e6f 6e65 0a20 2020 2020 2020   of None.       
-0000fd60: 2076 616c 7565 5f6b 7761 7267 203d 207b   value_kwarg = {
-0000fd70: 2276 616c 7565 223a 2076 616c 7565 7d20  "value": value} 
-0000fd80: 6966 2076 616c 7565 2069 7320 6e6f 7420  if value is not 
-0000fd90: 4e6f 6e65 2065 6c73 6520 7b7d 0a20 2020  None else {}.   
-0000fda0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000fdb0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-0000fdc0: 0a20 2020 2020 2020 2020 2020 204d 2e72  .            M.r
-0000fdd0: 6570 6c61 6365 2c0a 2020 2020 2020 2020  eplace,.        
-0000fde0: 2020 2020 746f 5f72 6570 6c61 6365 3d74      to_replace=t
-0000fdf0: 6f5f 7265 706c 6163 652c 0a20 2020 2020  o_replace,.     
-0000fe00: 2020 2020 2020 202a 2a76 616c 7565 5f6b         **value_k
-0000fe10: 7761 7267 2c0a 2020 2020 2020 2020 2020  warg,.          
-0000fe20: 2020 7265 6765 783d 7265 6765 782c 0a20    regex=regex,. 
-0000fe30: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
-0000fe40: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-0000fe50: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
-0000fe60: 2020 6465 6620 746f 5f64 6173 6b5f 6172    def to_dask_ar
-0000fe70: 7261 7928 7365 6c66 2c20 6c65 6e67 7468  ray(self, length
-0000fe80: 733d 4e6f 6e65 2c20 6d65 7461 3d4e 6f6e  s=None, meta=Non
-0000fe90: 6529 3a0a 2020 2020 2020 2020 2222 2243  e):.        """C
-0000fea0: 6f6e 7665 7274 2061 2064 6173 6b20 4461  onvert a dask Da
-0000feb0: 7461 4672 616d 6520 746f 2061 2064 6173  taFrame to a das
-0000fec0: 6b20 6172 7261 792e 0a0a 2020 2020 2020  k array...      
-0000fed0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0000fee0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0000fef0: 2020 2020 2020 2020 6c65 6e67 7468 7320          lengths 
-0000ff00: 3a20 626f 6f6c 206f 7220 5365 7175 656e  : bool or Sequen
-0000ff10: 6365 206f 6620 696e 7473 2c20 6f70 7469  ce of ints, opti
-0000ff20: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0000ff30: 2048 6f77 2074 6f20 6465 7465 726d 696e   How to determin
-0000ff40: 6520 7468 6520 6368 756e 6b73 2073 697a  e the chunks siz
-0000ff50: 6573 2066 6f72 2074 6865 206f 7574 7075  es for the outpu
-0000ff60: 7420 6172 7261 792e 0a20 2020 2020 2020  t array..       
-0000ff70: 2020 2020 2042 7920 6465 6661 756c 742c       By default,
-0000ff80: 2074 6865 206f 7574 7075 7420 6172 7261   the output arra
-0000ff90: 7920 7769 6c6c 2068 6176 6520 756e 6b6e  y will have unkn
-0000ffa0: 6f77 6e20 6368 756e 6b20 6c65 6e67 7468  own chunk length
-0000ffb0: 730a 2020 2020 2020 2020 2020 2020 616c  s.            al
-0000ffc0: 6f6e 6720 7468 6520 6669 7273 7420 6178  ong the first ax
-0000ffd0: 6973 2c20 7768 6963 6820 6361 6e20 6361  is, which can ca
-0000ffe0: 7573 6520 736f 6d65 206c 6174 6572 206f  use some later o
-0000fff0: 7065 7261 7469 6f6e 730a 2020 2020 2020  perations.      
-00010000: 2020 2020 2020 746f 2066 6169 6c2e 0a0a        to fail...
-00010010: 2020 2020 2020 2020 2020 2020 2a20 5472              * Tr
-00010020: 7565 203a 2069 6d6d 6564 6961 7465 6c79  ue : immediately
-00010030: 2063 6f6d 7075 7465 2074 6865 206c 656e   compute the len
-00010040: 6774 6820 6f66 2065 6163 6820 7061 7274  gth of each part
-00010050: 6974 696f 6e0a 2020 2020 2020 2020 2020  ition.          
-00010060: 2020 2a20 5365 7175 656e 6365 203a 2061    * Sequence : a
-00010070: 2073 6571 7565 6e63 6520 6f66 2069 6e74   sequence of int
-00010080: 6567 6572 7320 746f 2075 7365 2066 6f72  egers to use for
-00010090: 2074 6865 2063 6875 6e6b 2073 697a 6573   the chunk sizes
-000100a0: 0a20 2020 2020 2020 2020 2020 2020 206f  .              o
-000100b0: 6e20 7468 6520 6669 7273 7420 6178 6973  n the first axis
-000100c0: 2e20 5468 6573 6520 7661 6c75 6573 2061  . These values a
-000100d0: 7265 202a 6e6f 742a 2076 616c 6964 6174  re *not* validat
-000100e0: 6564 2066 6f72 0a20 2020 2020 2020 2020  ed for.         
-000100f0: 2020 2020 2063 6f72 7265 6374 6e65 7373       correctness
-00010100: 2c20 6265 796f 6e64 2065 6e73 7572 696e  , beyond ensurin
-00010110: 6720 7468 6174 2074 6865 206e 756d 6265  g that the numbe
-00010120: 7220 6f66 2069 7465 6d73 0a20 2020 2020  r of items.     
-00010130: 2020 2020 2020 2020 206d 6174 6368 6573           matches
-00010140: 2074 6865 206e 756d 6265 7220 6f66 2070   the number of p
-00010150: 6172 7469 7469 6f6e 732e 0a20 2020 2020  artitions..     
-00010160: 2020 206d 6574 6120 3a20 6f62 6a65 6374     meta : object
-00010170: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00010180: 2020 2020 2020 2041 6e20 6f70 7469 6f6e         An option
-00010190: 616c 2060 6d65 7461 6020 7061 7261 6d65  al `meta` parame
-000101a0: 7465 7220 6361 6e20 6265 2070 6173 7365  ter can be passe
-000101b0: 6420 666f 7220 6461 736b 2074 6f20 6f76  d for dask to ov
-000101c0: 6572 7269 6465 2074 6865 0a20 2020 2020  erride the.     
-000101d0: 2020 2020 2020 2064 6566 6175 6c74 206d         default m
-000101e0: 6574 6164 6174 6120 6f6e 2074 6865 2075  etadata on the u
-000101f0: 6e64 6572 6c79 696e 6720 6461 736b 2061  nderlying dask a
-00010200: 7272 6179 2e0a 0a20 2020 2020 2020 2052  rray...        R
-00010210: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-00010220: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2022  ------.        "
-00010230: 2222 0a20 2020 2020 2020 2069 6620 6c65  "".        if le
-00010240: 6e67 7468 7320 6973 2054 7275 653a 0a20  ngths is True:. 
-00010250: 2020 2020 2020 2020 2020 206c 656e 6774             lengt
-00010260: 6873 203d 2074 7570 6c65 2873 656c 662e  hs = tuple(self.
-00010270: 6d61 705f 7061 7274 6974 696f 6e73 286c  map_partitions(l
-00010280: 656e 2c20 656e 666f 7263 655f 6d65 7461  en, enforce_meta
-00010290: 6461 7461 3d46 616c 7365 292e 636f 6d70  data=False).comp
-000102a0: 7574 6528 2929 0a0a 2020 2020 2020 2020  ute())..        
-000102b0: 6172 7220 3d20 7365 6c66 2e76 616c 7565  arr = self.value
-000102c0: 730a 0a20 2020 2020 2020 2063 6875 6e6b  s..        chunk
-000102d0: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
-000102e0: 7465 5f63 6875 6e6b 7328 6172 722c 206c  te_chunks(arr, l
-000102f0: 656e 6774 6873 290a 2020 2020 2020 2020  engths).        
-00010300: 6172 722e 5f63 6875 6e6b 7320 3d20 6368  arr._chunks = ch
-00010310: 756e 6b73 0a0a 2020 2020 2020 2020 6966  unks..        if
-00010320: 206d 6574 6120 6973 206e 6f74 204e 6f6e   meta is not Non
-00010330: 653a 0a20 2020 2020 2020 2020 2020 2061  e:.            a
-00010340: 7272 2e5f 6d65 7461 203d 206d 6574 610a  rr._meta = meta.
-00010350: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00010360: 6172 720a 0a20 2020 2064 6566 2074 6f5f  arr..    def to_
-00010370: 6864 6628 7365 6c66 2c20 7061 7468 5f6f  hdf(self, path_o
-00010380: 725f 6275 662c 206b 6579 2c20 6d6f 6465  r_buf, key, mode
-00010390: 3d22 6122 2c20 6170 7065 6e64 3d46 616c  ="a", append=Fal
-000103a0: 7365 2c20 2a2a 6b77 6172 6773 293a 0a20  se, **kwargs):. 
-000103b0: 2020 2020 2020 2022 2222 5365 6520 6464         """See dd
-000103c0: 2e74 6f5f 6864 6620 646f 6373 7472 696e  .to_hdf docstrin
-000103d0: 6720 666f 7220 6d6f 7265 2069 6e66 6f72  g for more infor
-000103e0: 6d61 7469 6f6e 2222 220a 2020 2020 2020  mation""".      
-000103f0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-00010400: 6672 616d 652e 696f 2069 6d70 6f72 7420  frame.io import 
-00010410: 746f 5f68 6466 0a0a 2020 2020 2020 2020  to_hdf..        
-00010420: 7265 7475 726e 2074 6f5f 6864 6628 7365  return to_hdf(se
-00010430: 6c66 2c20 7061 7468 5f6f 725f 6275 662c  lf, path_or_buf,
-00010440: 206b 6579 2c20 6d6f 6465 2c20 6170 7065   key, mode, appe
-00010450: 6e64 2c20 2a2a 6b77 6172 6773 290a 0a20  nd, **kwargs).. 
-00010460: 2020 2064 6566 2074 6f5f 6373 7628 7365     def to_csv(se
-00010470: 6c66 2c20 6669 6c65 6e61 6d65 2c20 2a2a  lf, filename, **
-00010480: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-00010490: 2022 2222 5365 6520 6464 2e74 6f5f 6373   """See dd.to_cs
-000104a0: 7620 646f 6373 7472 696e 6720 666f 7220  v docstring for 
-000104b0: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-000104c0: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
-000104d0: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
-000104e0: 696f 2069 6d70 6f72 7420 746f 5f63 7376  io import to_csv
-000104f0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00010500: 2074 6f5f 6373 7628 7365 6c66 2c20 6669   to_csv(self, fi
-00010510: 6c65 6e61 6d65 2c20 2a2a 6b77 6172 6773  lename, **kwargs
-00010520: 290a 0a20 2020 2064 6566 2074 6f5f 7371  )..    def to_sq
-00010530: 6c28 0a20 2020 2020 2020 2073 656c 662c  l(.        self,
-00010540: 0a20 2020 2020 2020 206e 616d 653a 2073  .        name: s
-00010550: 7472 2c0a 2020 2020 2020 2020 7572 693a  tr,.        uri:
-00010560: 2073 7472 2c0a 2020 2020 2020 2020 7363   str,.        sc
-00010570: 6865 6d61 3d4e 6f6e 652c 0a20 2020 2020  hema=None,.     
-00010580: 2020 2069 665f 6578 6973 7473 3a20 7374     if_exists: st
-00010590: 7220 3d20 2266 6169 6c22 2c0a 2020 2020  r = "fail",.    
-000105a0: 2020 2020 696e 6465 783a 2062 6f6f 6c20      index: bool 
-000105b0: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
-000105c0: 696e 6465 785f 6c61 6265 6c3d 4e6f 6e65  index_label=None
-000105d0: 2c0a 2020 2020 2020 2020 6368 756e 6b73  ,.        chunks
-000105e0: 697a 653d 4e6f 6e65 2c0a 2020 2020 2020  ize=None,.      
-000105f0: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
-00010600: 2020 2020 2020 6d65 7468 6f64 3d4e 6f6e        method=Non
-00010610: 652c 0a20 2020 2020 2020 2063 6f6d 7075  e,.        compu
-00010620: 7465 3d54 7275 652c 0a20 2020 2020 2020  te=True,.       
-00010630: 2070 6172 616c 6c65 6c3d 4661 6c73 652c   parallel=False,
-00010640: 0a20 2020 2020 2020 2065 6e67 696e 655f  .        engine_
-00010650: 6b77 6172 6773 3d4e 6f6e 652c 0a20 2020  kwargs=None,.   
-00010660: 2029 3a0a 2020 2020 2020 2020 2222 2253   ):.        """S
-00010670: 6565 2064 642e 746f 5f73 716c 2064 6f63  ee dd.to_sql doc
-00010680: 7374 7269 6e67 2066 6f72 206d 6f72 6520  string for more 
-00010690: 696e 666f 726d 6174 696f 6e22 2222 0a20  information""". 
-000106a0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-000106b0: 2e64 6174 6166 7261 6d65 2e69 6f20 696d  .dataframe.io im
-000106c0: 706f 7274 2074 6f5f 7371 6c0a 0a20 2020  port to_sql..   
-000106d0: 2020 2020 2072 6574 7572 6e20 746f 5f73       return to_s
-000106e0: 716c 280a 2020 2020 2020 2020 2020 2020  ql(.            
-000106f0: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
-00010700: 2020 6e61 6d65 3d6e 616d 652c 0a20 2020    name=name,.   
-00010710: 2020 2020 2020 2020 2075 7269 3d75 7269           uri=uri
-00010720: 2c0a 2020 2020 2020 2020 2020 2020 7363  ,.            sc
-00010730: 6865 6d61 3d73 6368 656d 612c 0a20 2020  hema=schema,.   
-00010740: 2020 2020 2020 2020 2069 665f 6578 6973           if_exis
-00010750: 7473 3d69 665f 6578 6973 7473 2c0a 2020  ts=if_exists,.  
-00010760: 2020 2020 2020 2020 2020 696e 6465 783d            index=
-00010770: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
-00010780: 2020 2069 6e64 6578 5f6c 6162 656c 3d69     index_label=i
-00010790: 6e64 6578 5f6c 6162 656c 2c0a 2020 2020  ndex_label,.    
-000107a0: 2020 2020 2020 2020 6368 756e 6b73 697a          chunksiz
-000107b0: 653d 6368 756e 6b73 697a 652c 0a20 2020  e=chunksize,.   
-000107c0: 2020 2020 2020 2020 2064 7479 7065 3d64           dtype=d
-000107d0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-000107e0: 2020 6d65 7468 6f64 3d6d 6574 686f 642c    method=method,
-000107f0: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-00010800: 7075 7465 3d63 6f6d 7075 7465 2c0a 2020  pute=compute,.  
-00010810: 2020 2020 2020 2020 2020 7061 7261 6c6c            parall
-00010820: 656c 3d70 6172 616c 6c65 6c2c 0a20 2020  el=parallel,.   
-00010830: 2020 2020 2020 2020 2065 6e67 696e 655f           engine_
-00010840: 6b77 6172 6773 3d65 6e67 696e 655f 6b77  kwargs=engine_kw
-00010850: 6172 6773 2c0a 2020 2020 2020 2020 290a  args,.        ).
-00010860: 0a20 2020 2064 6566 2074 6f5f 6a73 6f6e  .    def to_json
-00010870: 2873 656c 662c 2066 696c 656e 616d 652c  (self, filename,
-00010880: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00010890: 293a 0a20 2020 2020 2020 2022 2222 5365  ):.        """Se
-000108a0: 6520 6464 2e74 6f5f 6a73 6f6e 2064 6f63  e dd.to_json doc
-000108b0: 7374 7269 6e67 2066 6f72 206d 6f72 6520  string for more 
-000108c0: 696e 666f 726d 6174 696f 6e22 2222 0a20  information""". 
-000108d0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-000108e0: 2e64 6174 6166 7261 6d65 2e69 6f20 696d  .dataframe.io im
-000108f0: 706f 7274 2074 6f5f 6a73 6f6e 0a0a 2020  port to_json..  
-00010900: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
-00010910: 6a73 6f6e 2873 656c 662c 2066 696c 656e  json(self, filen
-00010920: 616d 652c 202a 6172 6773 2c20 2a2a 6b77  ame, *args, **kw
-00010930: 6172 6773 290a 0a20 2020 2064 6566 2074  args)..    def t
-00010940: 6f5f 6465 6c61 7965 6428 7365 6c66 2c20  o_delayed(self, 
-00010950: 6f70 7469 6d69 7a65 5f67 7261 7068 3d54  optimize_graph=T
-00010960: 7275 6529 3a0a 2020 2020 2020 2020 2222  rue):.        ""
-00010970: 2243 6f6e 7665 7274 2069 6e74 6f20 6120  "Convert into a 
-00010980: 6c69 7374 206f 6620 6060 6461 736b 2e64  list of ``dask.d
-00010990: 656c 6179 6564 6060 206f 626a 6563 7473  elayed`` objects
-000109a0: 2c20 6f6e 6520 7065 7220 7061 7274 6974  , one per partit
-000109b0: 696f 6e2e 0a0a 2020 2020 2020 2020 5061  ion...        Pa
-000109c0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-000109d0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-000109e0: 2020 2020 6f70 7469 6d69 7a65 5f67 7261      optimize_gra
-000109f0: 7068 203a 2062 6f6f 6c2c 206f 7074 696f  ph : bool, optio
-00010a00: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00010a10: 4966 2054 7275 6520 5b64 6566 6175 6c74  If True [default
-00010a20: 5d2c 2074 6865 2067 7261 7068 2069 7320  ], the graph is 
-00010a30: 6f70 7469 6d69 7a65 6420 6265 666f 7265  optimized before
-00010a40: 2063 6f6e 7665 7274 696e 6720 696e 746f   converting into
-00010a50: 0a20 2020 2020 2020 2020 2020 2060 6064  .            ``d
-00010a60: 6173 6b2e 6465 6c61 7965 6460 6020 6f62  ask.delayed`` ob
-00010a70: 6a65 6374 732e 0a0a 2020 2020 2020 2020  jects...        
-00010a80: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-00010a90: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00010aa0: 2020 3e3e 3e20 7061 7274 6974 696f 6e73    >>> partitions
-00010ab0: 203d 2064 662e 746f 5f64 656c 6179 6564   = df.to_delayed
-00010ac0: 2829 2020 2320 646f 6374 6573 743a 202b  ()  # doctest: +
-00010ad0: 534b 4950 0a0a 2020 2020 2020 2020 5365  SKIP..        Se
-00010ae0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-00010af0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00010b00: 6461 736b 2e64 6174 6166 7261 6d65 2e66  dask.dataframe.f
-00010b10: 726f 6d5f 6465 6c61 7965 640a 2020 2020  rom_delayed.    
-00010b20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00010b30: 6b65 7973 203d 2073 656c 662e 5f5f 6461  keys = self.__da
-00010b40: 736b 5f6b 6579 735f 5f28 290a 2020 2020  sk_keys__().    
-00010b50: 2020 2020 6772 6170 6820 3d20 7365 6c66      graph = self
-00010b60: 2e5f 5f64 6173 6b5f 6772 6170 685f 5f28  .__dask_graph__(
-00010b70: 290a 2020 2020 2020 2020 6c61 7965 7220  ).        layer 
-00010b80: 3d20 7365 6c66 2e5f 5f64 6173 6b5f 6c61  = self.__dask_la
-00010b90: 7965 7273 5f5f 2829 5b30 5d0a 2020 2020  yers__()[0].    
-00010ba0: 2020 2020 6966 206f 7074 696d 697a 655f      if optimize_
-00010bb0: 6772 6170 683a 0a20 2020 2020 2020 2020  graph:.         
-00010bc0: 2020 2067 7261 7068 203d 2073 656c 662e     graph = self.
-00010bd0: 5f5f 6461 736b 5f6f 7074 696d 697a 655f  __dask_optimize_
-00010be0: 5f28 6772 6170 682c 2073 656c 662e 5f5f  _(graph, self.__
-00010bf0: 6461 736b 5f6b 6579 735f 5f28 2929 0a20  dask_keys__()). 
-00010c00: 2020 2020 2020 2020 2020 206c 6179 6572             layer
-00010c10: 203d 2022 6465 6c61 7965 642d 2220 2b20   = "delayed-" + 
-00010c20: 7365 6c66 2e5f 6e61 6d65 0a20 2020 2020  self._name.     
-00010c30: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
-00010c40: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-00010c50: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286c  om_collections(l
-00010c60: 6179 6572 2c20 6772 6170 682c 2064 6570  ayer, graph, dep
-00010c70: 656e 6465 6e63 6965 733d 2829 290a 2020  endencies=()).  
-00010c80: 2020 2020 2020 7265 7475 726e 205b 4465        return [De
-00010c90: 6c61 7965 6428 6b2c 2067 7261 7068 2c20  layed(k, graph, 
-00010ca0: 6c61 7965 723d 6c61 7965 7229 2066 6f72  layer=layer) for
-00010cb0: 206b 2069 6e20 6b65 7973 5d0a 0a20 2020   k in keys]..   
-00010cc0: 2064 6566 2074 6f5f 6261 636b 656e 6428   def to_backend(
-00010cd0: 7365 6c66 2c20 6261 636b 656e 643a 2073  self, backend: s
-00010ce0: 7472 207c 204e 6f6e 6520 3d20 4e6f 6e65  tr | None = None
-00010cf0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00010d00: 2020 2020 2022 2222 4d6f 7665 2074 6f20       """Move to 
-00010d10: 6120 6e65 7720 4461 7461 4672 616d 6520  a new DataFrame 
-00010d20: 6261 636b 656e 640a 0a20 2020 2020 2020  backend..       
-00010d30: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00010d40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00010d50: 2020 2020 2020 2062 6163 6b65 6e64 203a         backend :
-00010d60: 2073 7472 2c20 4f70 7469 6f6e 616c 0a20   str, Optional. 
-00010d70: 2020 2020 2020 2020 2020 2054 6865 206e             The n
-00010d80: 616d 6520 6f66 2074 6865 206e 6577 2062  ame of the new b
-00010d90: 6163 6b65 6e64 2074 6f20 6d6f 7665 2074  ackend to move t
-00010da0: 6f2e 2054 6865 2064 6566 6175 6c74 0a20  o. The default. 
-00010db0: 2020 2020 2020 2020 2020 2069 7320 7468             is th
-00010dc0: 6520 6375 7272 656e 7420 2264 6174 6166  e current "dataf
-00010dd0: 7261 6d65 2e62 6163 6b65 6e64 2220 636f  rame.backend" co
-00010de0: 6e66 6967 7572 6174 696f 6e2e 0a0a 2020  nfiguration...  
-00010df0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-00010e00: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00010e10: 2020 2020 2020 4461 7461 4672 616d 652c        DataFrame,
-00010e20: 2053 6572 6965 7320 6f72 2049 6e64 6578   Series or Index
-00010e30: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00010e40: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-00010e50: 6174 6166 7261 6d65 2e69 6f20 696d 706f  ataframe.io impo
-00010e60: 7274 2074 6f5f 6261 636b 656e 640a 0a20  rt to_backend.. 
-00010e70: 2020 2020 2020 2072 6574 7572 6e20 746f         return to
-00010e80: 5f62 6163 6b65 6e64 2873 656c 662c 2062  _backend(self, b
-00010e90: 6163 6b65 6e64 3d62 6163 6b65 6e64 2c20  ackend=backend, 
-00010ea0: 2a2a 6b77 6172 6773 290a 0a20 2020 2040  **kwargs)..    @
-00010eb0: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
-00010ec0: 6465 6620 5f67 6574 5f75 6e61 7279 5f6f  def _get_unary_o
-00010ed0: 7065 7261 746f 7228 636c 732c 206f 7029  perator(cls, op)
-00010ee0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00010ef0: 206c 616d 6264 6120 7365 6c66 3a20 656c   lambda self: el
-00010f00: 656d 7769 7365 286f 702c 2073 656c 6629  emwise(op, self)
-00010f10: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
-00010f20: 6f64 0a20 2020 2064 6566 205f 6765 745f  od.    def _get_
-00010f30: 6269 6e61 7279 5f6f 7065 7261 746f 7228  binary_operator(
-00010f40: 636c 732c 206f 702c 2069 6e76 3d46 616c  cls, op, inv=Fal
-00010f50: 7365 293a 0a20 2020 2020 2020 2069 6620  se):.        if 
-00010f60: 696e 763a 0a20 2020 2020 2020 2020 2020  inv:.           
-00010f70: 2072 6574 7572 6e20 6c61 6d62 6461 2073   return lambda s
-00010f80: 656c 662c 206f 7468 6572 3a20 656c 656d  elf, other: elem
-00010f90: 7769 7365 286f 702c 206f 7468 6572 2c20  wise(op, other, 
-00010fa0: 7365 6c66 290a 2020 2020 2020 2020 656c  self).        el
-00010fb0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00010fc0: 7265 7475 726e 206c 616d 6264 6120 7365  return lambda se
-00010fd0: 6c66 2c20 6f74 6865 723a 2065 6c65 6d77  lf, other: elemw
-00010fe0: 6973 6528 6f70 2c20 7365 6c66 2c20 6f74  ise(op, self, ot
-00010ff0: 6865 7229 0a0a 2020 2020 6465 6620 726f  her)..    def ro
-00011000: 6c6c 696e 6728 0a20 2020 2020 2020 2073  lling(.        s
-00011010: 656c 662c 2077 696e 646f 772c 206d 696e  elf, window, min
-00011020: 5f70 6572 696f 6473 3d4e 6f6e 652c 2063  _periods=None, c
-00011030: 656e 7465 723d 4661 6c73 652c 2077 696e  enter=False, win
-00011040: 5f74 7970 653d 4e6f 6e65 2c20 6178 6973  _type=None, axis
-00011050: 3d6e 6f5f 6465 6661 756c 740a 2020 2020  =no_default.    
-00011060: 293a 0a20 2020 2020 2020 2022 2222 5072  ):.        """Pr
-00011070: 6f76 6964 6573 2072 6f6c 6c69 6e67 2074  ovides rolling t
-00011080: 7261 6e73 666f 726d 6174 696f 6e73 2e0a  ransformations..
-00011090: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-000110a0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-000110b0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2077  ------.        w
-000110c0: 696e 646f 7720 3a20 696e 742c 2073 7472  indow : int, str
-000110d0: 2c20 6f66 6673 6574 0a20 2020 2020 2020  , offset.       
-000110e0: 2020 2020 5369 7a65 206f 6620 7468 6520      Size of the 
-000110f0: 6d6f 7669 6e67 2077 696e 646f 772e 2054  moving window. T
-00011100: 6869 7320 6973 2074 6865 206e 756d 6265  his is the numbe
-00011110: 7220 6f66 206f 6273 6572 7661 7469 6f6e  r of observation
-00011120: 7320 7573 6564 0a20 2020 2020 2020 2020  s used.         
-00011130: 2020 666f 7220 6361 6c63 756c 6174 696e    for calculatin
-00011140: 6720 7468 6520 7374 6174 6973 7469 632e  g the statistic.
-00011150: 2057 6865 6e20 6e6f 7420 7573 696e 6720   When not using 
-00011160: 6120 6060 4461 7465 7469 6d65 496e 6465  a ``DatetimeInde
-00011170: 7860 602c 0a20 2020 2020 2020 2020 2020  x``,.           
-00011180: 7468 6520 7769 6e64 6f77 2073 697a 6520  the window size 
-00011190: 6d75 7374 206e 6f74 2062 6520 736f 206c  must not be so l
-000111a0: 6172 6765 2061 7320 746f 2073 7061 6e20  arge as to span 
-000111b0: 6d6f 7265 2074 6861 6e20 6f6e 650a 2020  more than one.  
-000111c0: 2020 2020 2020 2020 2061 646a 6163 656e           adjacen
-000111d0: 7420 7061 7274 6974 696f 6e2e 2049 6620  t partition. If 
-000111e0: 7573 696e 6720 616e 206f 6666 7365 7420  using an offset 
-000111f0: 6f72 206f 6666 7365 7420 616c 6961 7320  or offset alias 
-00011200: 6c69 6b65 2027 3544 272c 0a20 2020 2020  like '5D',.     
-00011210: 2020 2020 2020 7468 6520 6461 7461 206d        the data m
-00011220: 7573 7420 6861 7665 2061 2060 6044 6174  ust have a ``Dat
-00011230: 6574 696d 6549 6e64 6578 6060 0a0a 2020  etimeIndex``..  
-00011240: 2020 2020 2020 2020 202e 2e20 7665 7273           .. vers
-00011250: 696f 6e63 6861 6e67 6564 3a3a 2030 2e31  ionchanged:: 0.1
-00011260: 352e 300a 0a20 2020 2020 2020 2020 2020  5.0..           
-00011270: 2020 204e 6f77 2061 6363 6570 7473 206f     Now accepts o
-00011280: 6666 7365 7473 2061 6e64 2073 7472 696e  ffsets and strin
-00011290: 6720 6f66 6673 6574 2061 6c69 6173 6573  g offset aliases
-000112a0: 0a0a 2020 2020 2020 2020 6d69 6e5f 7065  ..        min_pe
-000112b0: 7269 6f64 7320 3a20 696e 742c 2064 6566  riods : int, def
-000112c0: 6175 6c74 204e 6f6e 650a 2020 2020 2020  ault None.      
-000112d0: 2020 2020 2020 4d69 6e69 6d75 6d20 6e75        Minimum nu
-000112e0: 6d62 6572 206f 6620 6f62 7365 7276 6174  mber of observat
-000112f0: 696f 6e73 2069 6e20 7769 6e64 6f77 2072  ions in window r
-00011300: 6571 7569 7265 6420 746f 2068 6176 6520  equired to have 
-00011310: 6120 7661 6c75 650a 2020 2020 2020 2020  a value.        
-00011320: 2020 2020 286f 7468 6572 7769 7365 2072      (otherwise r
-00011330: 6573 756c 7420 6973 204e 4129 2e0a 2020  esult is NA)..  
-00011340: 2020 2020 2020 6365 6e74 6572 203a 2062        center : b
-00011350: 6f6f 6c65 616e 2c20 6465 6661 756c 7420  oolean, default 
-00011360: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00011370: 2020 5365 7420 7468 6520 6c61 6265 6c73    Set the labels
-00011380: 2061 7420 7468 6520 6365 6e74 6572 206f   at the center o
-00011390: 6620 7468 6520 7769 6e64 6f77 2e0a 2020  f the window..  
-000113a0: 2020 2020 2020 7769 6e5f 7479 7065 203a        win_type :
-000113b0: 2073 7472 696e 672c 2064 6566 6175 6c74   string, default
-000113c0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-000113d0: 2020 5072 6f76 6964 6520 6120 7769 6e64    Provide a wind
-000113e0: 6f77 2074 7970 652e 2054 6865 2072 6563  ow type. The rec
-000113f0: 6f67 6e69 7a65 6420 7769 6e64 6f77 2074  ognized window t
-00011400: 7970 6573 2061 7265 2069 6465 6e74 6963  ypes are identic
-00011410: 616c 0a20 2020 2020 2020 2020 2020 2074  al.            t
-00011420: 6f20 7061 6e64 6173 2e0a 2020 2020 2020  o pandas..      
-00011430: 2020 6178 6973 203a 2069 6e74 2c20 7374    axis : int, st
-00011440: 722c 204e 6f6e 652c 2064 6566 6175 6c74  r, None, default
-00011450: 2030 0a20 2020 2020 2020 2020 2020 2054   0.            T
-00011460: 6869 7320 7061 7261 6d65 7465 7220 6973  his parameter is
-00011470: 2064 6570 7265 6361 7465 6420 7769 7468   deprecated with
-00011480: 2060 6070 616e 6461 733e 3d32 2e31 6060   ``pandas>=2.1``
-00011490: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-000114a0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-000114b0: 2d2d 0a20 2020 2020 2020 2061 2052 6f6c  --.        a Rol
-000114c0: 6c69 6e67 206f 626a 6563 7420 6f6e 2077  ling object on w
-000114d0: 6869 6368 2074 6f20 6361 6c6c 2061 206d  hich to call a m
-000114e0: 6574 686f 6420 746f 2063 6f6d 7075 7465  ethod to compute
-000114f0: 2061 2073 7461 7469 7374 6963 0a20 2020   a statistic.   
-00011500: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00011510: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
-00011520: 7261 6d65 2e72 6f6c 6c69 6e67 2069 6d70  rame.rolling imp
-00011530: 6f72 7420 526f 6c6c 696e 670a 0a20 2020  ort Rolling..   
-00011540: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00011550: 6365 2877 696e 646f 772c 2049 6e74 6567  ce(window, Integ
-00011560: 7261 6c29 3a0a 2020 2020 2020 2020 2020  ral):.          
-00011570: 2020 6966 2077 696e 646f 7720 3c20 303a    if window < 0:
-00011580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011590: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000115a0: 7228 2277 696e 646f 7720 6d75 7374 2062  r("window must b
-000115b0: 6520 3e3d 2030 2229 0a0a 2020 2020 2020  e >= 0")..      
-000115c0: 2020 6966 206d 696e 5f70 6572 696f 6473    if min_periods
-000115d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-000115e0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-000115f0: 2069 7369 6e73 7461 6e63 6528 6d69 6e5f   isinstance(min_
-00011600: 7065 7269 6f64 732c 2049 6e74 6567 7261  periods, Integra
-00011610: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
-00011620: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00011630: 7272 6f72 2822 6d69 6e5f 7065 7269 6f64  rror("min_period
-00011640: 7320 6d75 7374 2062 6520 616e 2069 6e74  s must be an int
-00011650: 6567 6572 2229 0a20 2020 2020 2020 2020  eger").         
-00011660: 2020 2069 6620 6d69 6e5f 7065 7269 6f64     if min_period
-00011670: 7320 3c20 303a 0a20 2020 2020 2020 2020  s < 0:.         
-00011680: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00011690: 7565 4572 726f 7228 226d 696e 5f70 6572  ueError("min_per
-000116a0: 696f 6473 206d 7573 7420 6265 203e 3d20  iods must be >= 
-000116b0: 3022 290a 0a20 2020 2020 2020 2072 6574  0")..        ret
-000116c0: 7572 6e20 526f 6c6c 696e 6728 0a20 2020  urn Rolling(.   
-000116d0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-000116e0: 2020 2020 2020 2020 2020 2077 696e 646f             windo
-000116f0: 773d 7769 6e64 6f77 2c0a 2020 2020 2020  w=window,.      
-00011700: 2020 2020 2020 6d69 6e5f 7065 7269 6f64        min_period
-00011710: 733d 6d69 6e5f 7065 7269 6f64 732c 0a20  s=min_periods,. 
-00011720: 2020 2020 2020 2020 2020 2063 656e 7465             cente
-00011730: 723d 6365 6e74 6572 2c0a 2020 2020 2020  r=center,.      
-00011740: 2020 2020 2020 7769 6e5f 7479 7065 3d77        win_type=w
-00011750: 696e 5f74 7970 652c 0a20 2020 2020 2020  in_type,.       
-00011760: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
-00011770: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00011780: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00011790: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-000117a0: 6566 2064 6966 6628 7365 6c66 2c20 7065  ef diff(self, pe
-000117b0: 7269 6f64 733d 312c 2061 7869 733d 3029  riods=1, axis=0)
-000117c0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000117d0: 2020 2020 2020 2e2e 206e 6f74 653a 3a0a        .. note::.
-000117e0: 0a20 2020 2020 2020 2020 2020 5061 6e64  .           Pand
-000117f0: 6173 2063 7572 7265 6e74 6c79 2075 7365  as currently use
-00011800: 7320 616e 2060 606f 626a 6563 7460 602d  s an ``object``-
-00011810: 6474 7970 6520 636f 6c75 6d6e 2074 6f20  dtype column to 
-00011820: 7265 7072 6573 656e 740a 2020 2020 2020  represent.      
-00011830: 2020 2020 2062 6f6f 6c65 616e 2064 6174       boolean dat
-00011840: 6120 7769 7468 206d 6973 7369 6e67 2076  a with missing v
-00011850: 616c 7565 732e 2054 6869 7320 6361 6e20  alues. This can 
-00011860: 6361 7573 6520 6973 7375 6573 2066 6f72  cause issues for
-00011870: 0a20 2020 2020 2020 2020 2020 626f 6f6c  .           bool
-00011880: 6561 6e2d 7370 6563 6966 6963 206f 7065  ean-specific ope
-00011890: 7261 7469 6f6e 732c 206c 696b 6520 6060  rations, like ``
-000118a0: 7c60 602e 2054 6f20 656e 6162 6c65 2062  |``. To enable b
-000118b0: 6f6f 6c65 616e 2d0a 2020 2020 2020 2020  oolean-.        
-000118c0: 2020 2073 7065 6369 6669 6320 6f70 6572     specific oper
-000118d0: 6174 696f 6e73 2c20 6174 2074 6865 2063  ations, at the c
-000118e0: 6f73 7420 6f66 206d 6574 6164 6174 6120  ost of metadata 
-000118f0: 7468 6174 2064 6f65 736e 2774 206d 6174  that doesn't mat
-00011900: 6368 0a20 2020 2020 2020 2020 2020 7061  ch.           pa
-00011910: 6e64 6173 2c20 7573 6520 6060 2e61 7374  ndas, use ``.ast
-00011920: 7970 6528 626f 6f6c 2960 6020 6166 7465  ype(bool)`` afte
-00011930: 7220 7468 6520 6060 7368 6966 7460 602e  r the ``shift``.
-00011940: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00011950: 2020 2020 2061 7869 7320 3d20 7365 6c66       axis = self
-00011960: 2e5f 7661 6c69 6461 7465 5f61 7869 7328  ._validate_axis(
-00011970: 6178 6973 290a 2020 2020 2020 2020 6966  axis).        if
-00011980: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00011990: 7065 7269 6f64 732c 2049 6e74 6567 7261  periods, Integra
-000119a0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
-000119b0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-000119c0: 2270 6572 696f 6473 206d 7573 7420 6265  "periods must be
-000119d0: 2061 6e20 696e 7465 6765 7222 290a 0a20   an integer").. 
-000119e0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-000119f0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00011a00: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-00011a10: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-00011a20: 2020 2020 2020 2020 2020 2020 204d 2e64               M.d
-00011a30: 6966 662c 2074 6f6b 656e 3d22 6469 6666  iff, token="diff
-00011a40: 222c 2070 6572 696f 6473 3d70 6572 696f  ", periods=perio
-00011a50: 6473 2c20 6178 6973 3d31 2c20 656e 666f  ds, axis=1, enfo
-00011a60: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-00011a70: 7365 0a20 2020 2020 2020 2020 2020 2029  se.            )
-00011a80: 0a0a 2020 2020 2020 2020 6265 666f 7265  ..        before
-00011a90: 2c20 6166 7465 7220 3d20 2870 6572 696f  , after = (perio
-00011aa0: 6473 2c20 3029 2069 6620 7065 7269 6f64  ds, 0) if period
-00011ab0: 7320 3e20 3020 656c 7365 2028 302c 202d  s > 0 else (0, -
-00011ac0: 7065 7269 6f64 7329 0a20 2020 2020 2020  periods).       
-00011ad0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-00011ae0: 5f6f 7665 726c 6170 284d 2e64 6966 662c  _overlap(M.diff,
-00011af0: 2062 6566 6f72 652c 2061 6674 6572 2c20   before, after, 
-00011b00: 746f 6b65 6e3d 2264 6966 6622 2c20 7065  token="diff", pe
-00011b10: 7269 6f64 733d 7065 7269 6f64 7329 0a0a  riods=periods)..
-00011b20: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00011b30: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-00011b40: 2020 2020 6465 6620 7368 6966 7428 7365      def shift(se
-00011b50: 6c66 2c20 7065 7269 6f64 733d 312c 2066  lf, periods=1, f
-00011b60: 7265 713d 4e6f 6e65 2c20 6178 6973 3d30  req=None, axis=0
-00011b70: 293a 0a20 2020 2020 2020 2061 7869 7320  ):.        axis 
-00011b80: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
-00011b90: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
-00011ba0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-00011bb0: 7461 6e63 6528 7065 7269 6f64 732c 2049  tance(periods, I
-00011bc0: 6e74 6567 7261 6c29 3a0a 2020 2020 2020  ntegral):.      
-00011bd0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00011be0: 4572 726f 7228 2270 6572 696f 6473 206d  Error("periods m
-00011bf0: 7573 7420 6265 2061 6e20 696e 7465 6765  ust be an intege
-00011c00: 7222 290a 0a20 2020 2020 2020 2069 6620  r")..        if 
-00011c10: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
-00011c20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00011c30: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00011c40: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-00011c50: 2020 204d 2e73 6869 6674 2c0a 2020 2020     M.shift,.    
-00011c60: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-00011c70: 6e3d 2273 6869 6674 222c 0a20 2020 2020  n="shift",.     
-00011c80: 2020 2020 2020 2020 2020 2070 6572 696f             perio
-00011c90: 6473 3d70 6572 696f 6473 2c0a 2020 2020  ds=periods,.    
-00011ca0: 2020 2020 2020 2020 2020 2020 6672 6571              freq
-00011cb0: 3d66 7265 712c 0a20 2020 2020 2020 2020  =freq,.         
-00011cc0: 2020 2020 2020 2061 7869 733d 312c 0a20         axis=1,. 
-00011cd0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00011ce0: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-00011cf0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00011d00: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
-00011d10: 2066 7265 7120 6973 204e 6f6e 653a 0a20   freq is None:. 
-00011d20: 2020 2020 2020 2020 2020 2062 6566 6f72             befor
-00011d30: 652c 2061 6674 6572 203d 2028 7065 7269  e, after = (peri
-00011d40: 6f64 732c 2030 2920 6966 2070 6572 696f  ods, 0) if perio
-00011d50: 6473 203e 2030 2065 6c73 6520 2830 2c20  ds > 0 else (0, 
-00011d60: 2d70 6572 696f 6473 290a 2020 2020 2020  -periods).      
-00011d70: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00011d80: 662e 6d61 705f 6f76 6572 6c61 7028 0a20  f.map_overlap(. 
-00011d90: 2020 2020 2020 2020 2020 2020 2020 204d                 M
-00011da0: 2e73 6869 6674 2c20 6265 666f 7265 2c20  .shift, before, 
-00011db0: 6166 7465 722c 2074 6f6b 656e 3d22 7368  after, token="sh
-00011dc0: 6966 7422 2c20 7065 7269 6f64 733d 7065  ift", periods=pe
-00011dd0: 7269 6f64 730a 2020 2020 2020 2020 2020  riods.          
-00011de0: 2020 290a 0a20 2020 2020 2020 2023 204c    )..        # L
-00011df0: 6574 2070 616e 6461 7320 6572 726f 7220  et pandas error 
-00011e00: 6f6e 2069 6e76 616c 6964 2061 7267 756d  on invalid argum
-00011e10: 656e 7473 0a20 2020 2020 2020 206d 6574  ents.        met
-00011e20: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
-00011e30: 6f6e 656d 7074 792e 7368 6966 7428 7065  onempty.shift(pe
-00011e40: 7269 6f64 732c 2066 7265 713d 6672 6571  riods, freq=freq
-00011e50: 290a 2020 2020 2020 2020 6f75 7420 3d20  ).        out = 
-00011e60: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-00011e70: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-00011e80: 204d 2e73 6869 6674 2c0a 2020 2020 2020   M.shift,.      
-00011e90: 2020 2020 2020 746f 6b65 6e3d 2273 6869        token="shi
-00011ea0: 6674 222c 0a20 2020 2020 2020 2020 2020  ft",.           
-00011eb0: 2070 6572 696f 6473 3d70 6572 696f 6473   periods=periods
-00011ec0: 2c0a 2020 2020 2020 2020 2020 2020 6672  ,.            fr
-00011ed0: 6571 3d66 7265 712c 0a20 2020 2020 2020  eq=freq,.       
-00011ee0: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
-00011ef0: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
-00011f00: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-00011f10: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00011f20: 7472 616e 7366 6f72 6d5f 6469 7669 7369  transform_divisi
-00011f30: 6f6e 733d 4661 6c73 652c 0a20 2020 2020  ons=False,.     
-00011f40: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
-00011f50: 7572 6e20 6d61 7962 655f 7368 6966 745f  urn maybe_shift_
-00011f60: 6469 7669 7369 6f6e 7328 6f75 742c 2070  divisions(out, p
-00011f70: 6572 696f 6473 2c20 6672 6571 3d66 7265  eriods, freq=fre
-00011f80: 7129 0a0a 2020 2020 6465 6620 5f72 6564  q)..    def _red
-00011f90: 7563 7469 6f6e 5f61 6767 280a 2020 2020  uction_agg(.    
-00011fa0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00011fb0: 2020 6e61 6d65 2c0a 2020 2020 2020 2020    name,.        
-00011fc0: 6178 6973 3d4e 6f6e 652c 0a20 2020 2020  axis=None,.     
-00011fd0: 2020 2073 6b69 706e 613d 5472 7565 2c0a     skipna=True,.
-00011fe0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-00011ff0: 6572 793d 4661 6c73 652c 0a20 2020 2020  ery=False,.     
-00012000: 2020 206f 7574 3d4e 6f6e 652c 0a20 2020     out=None,.   
-00012010: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-00012020: 793d 4e6f 6e65 2c0a 2020 2020 2020 2020  y=None,.        
-00012030: 6e6f 6e65 5f69 735f 7a65 726f 3d54 7275  none_is_zero=Tru
-00012040: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00012050: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
-00012060: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-00012070: 732c 206e 6f6e 655f 6973 5f7a 6572 6f3d  s, none_is_zero=
-00012080: 6e6f 6e65 5f69 735f 7a65 726f 290a 0a20  none_is_zero).. 
-00012090: 2020 2020 2020 2069 6620 6861 735f 6b65         if has_ke
-000120a0: 7977 6f72 6428 6765 7461 7474 7228 7365  yword(getattr(se
-000120b0: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-000120c0: 792c 206e 616d 6529 2c20 226e 756d 6572  y, name), "numer
-000120d0: 6963 5f6f 6e6c 7922 293a 0a20 2020 2020  ic_only"):.     
-000120e0: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
-000120f0: 6e6c 795f 6b77 6172 6773 203d 207b 226e  nly_kwargs = {"n
-00012100: 756d 6572 6963 5f6f 6e6c 7922 3a20 6e75  umeric_only": nu
-00012110: 6d65 7269 635f 6f6e 6c79 7d0a 2020 2020  meric_only}.    
-00012120: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00012130: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
-00012140: 6c79 5f6b 7761 7267 7320 3d20 7b7d 0a0a  ly_kwargs = {}..
-00012150: 2020 2020 2020 2020 7769 7468 2063 6865          with che
-00012160: 636b 5f6e 756d 6572 6963 5f6f 6e6c 795f  ck_numeric_only_
-00012170: 6465 7072 6563 6174 696f 6e28 6e61 6d65  deprecation(name
-00012180: 2c20 5472 7565 293a 0a20 2020 2020 2020  , True):.       
-00012190: 2020 2020 206d 6574 6120 3d20 6765 7461       meta = geta
-000121a0: 7474 7228 7365 6c66 2e5f 6d65 7461 5f6e  ttr(self._meta_n
-000121b0: 6f6e 656d 7074 792c 206e 616d 6529 280a  onempty, name)(.
-000121c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000121d0: 6178 6973 3d61 7869 732c 2073 6b69 706e  axis=axis, skipn
-000121e0: 613d 736b 6970 6e61 2c20 2a2a 6e75 6d65  a=skipna, **nume
-000121f0: 7269 635f 6f6e 6c79 5f6b 7761 7267 730a  ric_only_kwargs.
-00012200: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00012210: 2020 2020 2020 2074 6f6b 656e 203d 2073         token = s
-00012220: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
-00012230: 7820 2b20 6e61 6d65 0a20 2020 2020 2020  x + name.       
-00012240: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
-00012250: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-00012260: 7420 3d20 7365 6c66 2e6d 6170 5f70 6172  t = self.map_par
-00012270: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-00012280: 2020 2020 2020 2020 205f 6765 7461 7474           _getatt
-00012290: 725f 6e75 6d65 7269 635f 6f6e 6c79 2c0a  r_numeric_only,.
-000122a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000122b0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
-000122c0: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
-000122d0: 3d74 6f6b 656e 2c0a 2020 2020 2020 2020  =token,.        
-000122e0: 2020 2020 2020 2020 736b 6970 6e61 3d73          skipna=s
-000122f0: 6b69 706e 612c 0a20 2020 2020 2020 2020  kipna,.         
-00012300: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
-00012310: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00012320: 2020 5f64 6173 6b5f 6d65 7468 6f64 5f6e    _dask_method_n
-00012330: 616d 653d 6e61 6d65 2c0a 2020 2020 2020  ame=name,.      
-00012340: 2020 2020 2020 2020 2020 2a2a 6e75 6d65            **nume
-00012350: 7269 635f 6f6e 6c79 5f6b 7761 7267 732c  ric_only_kwargs,
-00012360: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00012370: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00012380: 6e20 6861 6e64 6c65 5f6f 7574 286f 7574  n handle_out(out
-00012390: 2c20 7265 7375 6c74 290a 2020 2020 2020  , result).      
-000123a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000123b0: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
-000123c0: 662e 7265 6475 6374 696f 6e28 0a20 2020  f.reduction(.   
-000123d0: 2020 2020 2020 2020 2020 2020 205f 6765               _ge
-000123e0: 7461 7474 725f 6e75 6d65 7269 635f 6f6e  tattr_numeric_on
-000123f0: 6c79 2c0a 2020 2020 2020 2020 2020 2020  ly,.            
-00012400: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
-00012410: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00012420: 6f6b 656e 3d74 6f6b 656e 2c0a 2020 2020  oken=token,.    
-00012430: 2020 2020 2020 2020 2020 2020 736b 6970              skip
-00012440: 6e61 3d73 6b69 706e 612c 0a20 2020 2020  na=skipna,.     
-00012450: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-00012460: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-00012470: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-00012480: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
-00012490: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-000124a0: 6461 736b 5f6d 6574 686f 645f 6e61 6d65  dask_method_name
-000124b0: 3d6e 616d 652c 0a20 2020 2020 2020 2020  =name,.         
-000124c0: 2020 2020 2020 202a 2a6e 756d 6572 6963         **numeric
-000124d0: 5f6f 6e6c 795f 6b77 6172 6773 2c0a 2020  _only_kwargs,.  
-000124e0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000124f0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00012500: 7461 6e63 6528 7365 6c66 2c20 4461 7461  tance(self, Data
-00012510: 4672 616d 6529 2061 6e64 2069 7369 6e73  Frame) and isins
-00012520: 7461 6e63 6528 7265 7375 6c74 2c20 5365  tance(result, Se
-00012530: 7269 6573 293a 0a20 2020 2020 2020 2020  ries):.         
-00012540: 2020 2020 2020 2072 6573 756c 742e 6469         result.di
-00012550: 7669 7369 6f6e 7320 3d20 2873 656c 662e  visions = (self.
-00012560: 636f 6c75 6d6e 732e 6d69 6e28 292c 2073  columns.min(), s
-00012570: 656c 662e 636f 6c75 6d6e 732e 6d61 7828  elf.columns.max(
-00012580: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
-00012590: 6574 7572 6e20 6861 6e64 6c65 5f6f 7574  eturn handle_out
-000125a0: 286f 7574 2c20 7265 7375 6c74 290a 0a20  (out, result).. 
-000125b0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-000125c0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-000125d0: 2020 2064 6566 2061 6464 5f70 7265 6669     def add_prefi
-000125e0: 7828 7365 6c66 2c20 7072 6566 6978 293a  x(self, prefix):
-000125f0: 0a20 2020 2020 2020 2072 6573 203d 2073  .        res = s
-00012600: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-00012610: 6e73 284d 2e61 6464 5f70 7265 6669 782c  ns(M.add_prefix,
-00012620: 2070 7265 6669 7829 0a20 2020 2020 2020   prefix).       
-00012630: 2069 6620 7365 6c66 2e6b 6e6f 776e 5f64   if self.known_d
-00012640: 6976 6973 696f 6e73 2061 6e64 2069 735f  ivisions and is_
-00012650: 7365 7269 6573 5f6c 696b 6528 7365 6c66  series_like(self
-00012660: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00012670: 6573 2e64 6976 6973 696f 6e73 203d 2074  es.divisions = t
-00012680: 7570 6c65 2870 7265 6669 7820 2b20 7374  uple(prefix + st
-00012690: 7228 6469 7669 7369 6f6e 2920 666f 7220  r(division) for 
-000126a0: 6469 7669 7369 6f6e 2069 6e20 7365 6c66  division in self
-000126b0: 2e64 6976 6973 696f 6e73 290a 2020 2020  .divisions).    
-000126c0: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-000126d0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-000126e0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-000126f0: 2020 2020 6465 6620 6164 645f 7375 6666      def add_suff
-00012700: 6978 2873 656c 662c 2073 7566 6669 7829  ix(self, suffix)
-00012710: 3a0a 2020 2020 2020 2020 7265 7320 3d20  :.        res = 
-00012720: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-00012730: 6f6e 7328 4d2e 6164 645f 7375 6666 6978  ons(M.add_suffix
-00012740: 2c20 7375 6666 6978 290a 2020 2020 2020  , suffix).      
-00012750: 2020 6966 2073 656c 662e 6b6e 6f77 6e5f    if self.known_
-00012760: 6469 7669 7369 6f6e 7320 616e 6420 6973  divisions and is
-00012770: 5f73 6572 6965 735f 6c69 6b65 2873 656c  _series_like(sel
-00012780: 6629 3a0a 2020 2020 2020 2020 2020 2020  f):.            
-00012790: 7265 732e 6469 7669 7369 6f6e 7320 3d20  res.divisions = 
-000127a0: 7475 706c 6528 7374 7228 6469 7669 7369  tuple(str(divisi
-000127b0: 6f6e 2920 2b20 7375 6666 6978 2066 6f72  on) + suffix for
-000127c0: 2064 6976 6973 696f 6e20 696e 2073 656c   division in sel
-000127d0: 662e 6469 7669 7369 6f6e 7329 0a20 2020  f.divisions).   
-000127e0: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-000127f0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00012800: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-00012810: 0a20 2020 2064 6566 2061 6273 2873 656c  .    def abs(sel
-00012820: 6629 3a0a 2020 2020 2020 2020 5f72 6169  f):.        _rai
-00012830: 7365 5f69 665f 6f62 6a65 6374 5f73 6572  se_if_object_ser
-00012840: 6965 7328 7365 6c66 2c20 2261 6273 2229  ies(self, "abs")
-00012850: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
-00012860: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-00012870: 7074 792e 6162 7328 290a 2020 2020 2020  pty.abs().      
-00012880: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-00012890: 705f 7061 7274 6974 696f 6e73 284d 2e61  p_partitions(M.a
-000128a0: 6273 2c20 6d65 7461 3d6d 6574 612c 2065  bs, meta=meta, e
-000128b0: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-000128c0: 4661 6c73 6529 0a0a 2020 2020 4064 6572  False)..    @der
-000128d0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-000128e0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-000128f0: 616c 6c28 7365 6c66 2c20 6178 6973 3d4e  all(self, axis=N
-00012900: 6f6e 652c 2073 6b69 706e 613d 5472 7565  one, skipna=True
-00012910: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
-00012920: 6c73 652c 206f 7574 3d4e 6f6e 6529 3a0a  lse, out=None):.
-00012930: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00012940: 656c 662e 5f72 6564 7563 7469 6f6e 5f61  elf._reduction_a
-00012950: 6767 280a 2020 2020 2020 2020 2020 2020  gg(.            
-00012960: 2261 6c6c 222c 2061 7869 733d 6178 6973  "all", axis=axis
-00012970: 2c20 736b 6970 6e61 3d73 6b69 706e 612c  , skipna=skipna,
-00012980: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-00012990: 6974 5f65 7665 7279 2c20 6f75 743d 6f75  it_every, out=ou
-000129a0: 740a 2020 2020 2020 2020 290a 0a20 2020  t.        )..   
-000129b0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-000129c0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-000129d0: 2064 6566 2061 6e79 2873 656c 662c 2061   def any(self, a
-000129e0: 7869 733d 4e6f 6e65 2c20 736b 6970 6e61  xis=None, skipna
-000129f0: 3d54 7275 652c 2073 706c 6974 5f65 7665  =True, split_eve
-00012a00: 7279 3d46 616c 7365 2c20 6f75 743d 4e6f  ry=False, out=No
-00012a10: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
-00012a20: 7572 6e20 7365 6c66 2e5f 7265 6475 6374  urn self._reduct
-00012a30: 696f 6e5f 6167 6728 0a20 2020 2020 2020  ion_agg(.       
-00012a40: 2020 2020 2022 616e 7922 2c20 6178 6973       "any", axis
-00012a50: 3d61 7869 732c 2073 6b69 706e 613d 736b  =axis, skipna=sk
-00012a60: 6970 6e61 2c20 7370 6c69 745f 6576 6572  ipna, split_ever
-00012a70: 793d 7370 6c69 745f 6576 6572 792c 206f  y=split_every, o
-00012a80: 7574 3d6f 7574 0a20 2020 2020 2020 2029  ut=out.        )
-00012a90: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00012aa0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-00012ab0: 290a 2020 2020 6465 6620 7375 6d28 0a20  ).    def sum(. 
-00012ac0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00012ad0: 2020 2020 2061 7869 733d 4e6f 6e65 2c0a       axis=None,.
-00012ae0: 2020 2020 2020 2020 736b 6970 6e61 3d54          skipna=T
-00012af0: 7275 652c 0a20 2020 2020 2020 2073 706c  rue,.        spl
-00012b00: 6974 5f65 7665 7279 3d46 616c 7365 2c0a  it_every=False,.
-00012b10: 2020 2020 2020 2020 6474 7970 653d 4e6f          dtype=No
-00012b20: 6e65 2c0a 2020 2020 2020 2020 6f75 743d  ne,.        out=
-00012b30: 4e6f 6e65 2c0a 2020 2020 2020 2020 6d69  None,.        mi
-00012b40: 6e5f 636f 756e 743d 4e6f 6e65 2c0a 2020  n_count=None,.  
-00012b50: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
-00012b60: 6c79 3d4e 6f6e 652c 0a20 2020 2029 3a0a  ly=None,.    ):.
-00012b70: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-00012b80: 2073 656c 662e 5f72 6564 7563 7469 6f6e   self._reduction
-00012b90: 5f61 6767 280a 2020 2020 2020 2020 2020  _agg(.          
-00012ba0: 2020 2273 756d 222c 0a20 2020 2020 2020    "sum",.       
-00012bb0: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
-00012bc0: 2020 2020 2020 2020 2020 2020 736b 6970              skip
-00012bd0: 6e61 3d73 6b69 706e 612c 0a20 2020 2020  na=skipna,.     
-00012be0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-00012bf0: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
-00012c00: 2020 2020 2020 2020 2020 2020 6f75 743d              out=
-00012c10: 6f75 742c 0a20 2020 2020 2020 2020 2020  out,.           
-00012c20: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
-00012c30: 6d65 7269 635f 6f6e 6c79 2c0a 2020 2020  meric_only,.    
-00012c40: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
-00012c50: 206d 696e 5f63 6f75 6e74 3a0a 2020 2020   min_count:.    
-00012c60: 2020 2020 2020 2020 636f 6e64 203d 2073          cond = s
-00012c70: 656c 662e 6e6f 746e 756c 6c28 292e 7375  elf.notnull().su
-00012c80: 6d28 6178 6973 3d61 7869 7329 203e 3d20  m(axis=axis) >= 
-00012c90: 6d69 6e5f 636f 756e 740a 2020 2020 2020  min_count.      
-00012ca0: 2020 2020 2020 6966 2069 735f 7365 7269        if is_seri
-00012cb0: 6573 5f6c 696b 6528 636f 6e64 293a 0a20  es_like(cond):. 
-00012cc0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00012cd0: 6574 7572 6e20 7265 7375 6c74 2e77 6865  eturn result.whe
-00012ce0: 7265 2863 6f6e 642c 206f 7468 6572 3d6e  re(cond, other=n
-00012cf0: 702e 4e61 4e29 0a20 2020 2020 2020 2020  p.NaN).         
-00012d00: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00012d10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00012d20: 5f73 6361 6c61 725f 6269 6e61 7279 280a  _scalar_binary(.
-00012d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d40: 2020 2020 6c61 6d62 6461 2078 2c20 793a      lambda x, y:
-00012d50: 2072 6573 756c 7420 6966 2078 2069 7320   result if x is 
-00012d60: 7920 656c 7365 206e 702e 4e61 4e2c 2063  y else np.NaN, c
-00012d70: 6f6e 642c 2054 7275 650a 2020 2020 2020  ond, True.      
-00012d80: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00012d90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00012da0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00012db0: 756c 740a 0a20 2020 2040 5f6e 756d 6572  ult..    @_numer
-00012dc0: 6963 5f6f 6e6c 790a 2020 2020 4064 6572  ic_only.    @der
-00012dd0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00012de0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00012df0: 7072 6f64 280a 2020 2020 2020 2020 7365  prod(.        se
-00012e00: 6c66 2c0a 2020 2020 2020 2020 6178 6973  lf,.        axis
-00012e10: 3d4e 6f6e 652c 0a20 2020 2020 2020 2073  =None,.        s
-00012e20: 6b69 706e 613d 5472 7565 2c0a 2020 2020  kipna=True,.    
-00012e30: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
-00012e40: 4661 6c73 652c 0a20 2020 2020 2020 2064  False,.        d
-00012e50: 7479 7065 3d4e 6f6e 652c 0a20 2020 2020  type=None,.     
-00012e60: 2020 206f 7574 3d4e 6f6e 652c 0a20 2020     out=None,.   
-00012e70: 2020 2020 206d 696e 5f63 6f75 6e74 3d4e       min_count=N
-00012e80: 6f6e 652c 0a20 2020 2020 2020 206e 756d  one,.        num
-00012e90: 6572 6963 5f6f 6e6c 793d 4e6f 6e65 2c0a  eric_only=None,.
-00012ea0: 2020 2020 293a 0a20 2020 2020 2020 2072      ):.        r
-00012eb0: 6573 756c 7420 3d20 7365 6c66 2e5f 7265  esult = self._re
-00012ec0: 6475 6374 696f 6e5f 6167 6728 0a20 2020  duction_agg(.   
-00012ed0: 2020 2020 2020 2020 2022 7072 6f64 222c           "prod",
-00012ee0: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
-00012ef0: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
-00012f00: 2020 2020 736b 6970 6e61 3d73 6b69 706e      skipna=skipn
-00012f10: 612c 0a20 2020 2020 2020 2020 2020 2073  a,.            s
-00012f20: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-00012f30: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
-00012f40: 2020 2020 6f75 743d 6f75 742c 0a20 2020      out=out,.   
-00012f50: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-00012f60: 6620 6d69 6e5f 636f 756e 743a 0a20 2020  f min_count:.   
-00012f70: 2020 2020 2020 2020 2063 6f6e 6420 3d20           cond = 
-00012f80: 7365 6c66 2e6e 6f74 6e75 6c6c 2829 2e73  self.notnull().s
-00012f90: 756d 2861 7869 733d 6178 6973 2920 3e3d  um(axis=axis) >=
-00012fa0: 206d 696e 5f63 6f75 6e74 0a20 2020 2020   min_count.     
-00012fb0: 2020 2020 2020 2069 6620 6973 5f73 6572         if is_ser
-00012fc0: 6965 735f 6c69 6b65 2863 6f6e 6429 3a0a  ies_like(cond):.
-00012fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012fe0: 7265 7475 726e 2072 6573 756c 742e 7768  return result.wh
-00012ff0: 6572 6528 636f 6e64 2c20 6f74 6865 723d  ere(cond, other=
-00013000: 6e70 2e4e 614e 290a 2020 2020 2020 2020  np.NaN).        
-00013010: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00013020: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00013030: 205f 7363 616c 6172 5f62 696e 6172 7928   _scalar_binary(
-00013040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013050: 2020 2020 206c 616d 6264 6120 782c 2079       lambda x, y
-00013060: 3a20 7265 7375 6c74 2069 6620 7820 6973  : result if x is
-00013070: 2079 2065 6c73 6520 6e70 2e4e 614e 2c20   y else np.NaN, 
-00013080: 636f 6e64 2c20 5472 7565 0a20 2020 2020  cond, True.     
-00013090: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000130a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000130b0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-000130c0: 7375 6c74 0a0a 2020 2020 7072 6f64 7563  sult..    produc
-000130d0: 7420 3d20 7072 6f64 2020 2320 616c 6961  t = prod  # alia
-000130e0: 7365 6420 6464 2e70 726f 6475 6374 0a0a  sed dd.product..
-000130f0: 2020 2020 405f 6e75 6d65 7269 635f 6f6e      @_numeric_on
-00013100: 6c79 0a20 2020 2040 6465 7269 7665 645f  ly.    @derived_
-00013110: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00013120: 6529 0a20 2020 2064 6566 206d 6178 2873  e).    def max(s
-00013130: 656c 662c 2061 7869 733d 302c 2073 6b69  elf, axis=0, ski
-00013140: 706e 613d 5472 7565 2c20 7370 6c69 745f  pna=True, split_
-00013150: 6576 6572 793d 4661 6c73 652c 206f 7574  every=False, out
-00013160: 3d4e 6f6e 652c 206e 756d 6572 6963 5f6f  =None, numeric_o
-00013170: 6e6c 793d 4e6f 6e65 293a 0a20 2020 2020  nly=None):.     
-00013180: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
-00013190: 2020 2020 5041 4e44 4153 5f47 545f 3134      PANDAS_GT_14
-000131a0: 300a 2020 2020 2020 2020 2020 2020 616e  0.            an
-000131b0: 6420 6e6f 7420 5041 4e44 4153 5f47 545f  d not PANDAS_GT_
-000131c0: 3230 300a 2020 2020 2020 2020 2020 2020  200.            
-000131d0: 616e 6420 6178 6973 2069 7320 4e6f 6e65  and axis is None
-000131e0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-000131f0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-00013200: 2c20 4461 7461 4672 616d 6529 0a20 2020  , DataFrame).   
-00013210: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-00013220: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00013230: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00013240: 2020 2022 496e 2061 2066 7574 7572 6520     "In a future 
-00013250: 7665 7273 696f 6e2c 2044 6174 6146 7261  version, DataFra
-00013260: 6d65 2e6d 6178 2861 7869 733d 4e6f 6e65  me.max(axis=None
-00013270: 2920 7769 6c6c 2072 6574 7572 6e20 6120  ) will return a 
-00013280: 7363 616c 6172 206d 6178 206f 7665 7220  scalar max over 
-00013290: 7468 6520 656e 7469 7265 2044 6174 6146  the entire DataF
-000132a0: 7261 6d65 2e20 220a 2020 2020 2020 2020  rame. ".        
-000132b0: 2020 2020 2020 2020 2254 6f20 7265 7461          "To reta
-000132c0: 696e 2074 6865 206f 6c64 2062 6568 6176  in the old behav
-000132d0: 696f 722c 2075 7365 2027 6672 616d 652e  ior, use 'frame.
-000132e0: 6d61 7828 6178 6973 3d30 2927 206f 7220  max(axis=0)' or 
-000132f0: 6a75 7374 2027 6672 616d 652e 6d61 7828  just 'frame.max(
-00013300: 2927 222c 0a20 2020 2020 2020 2020 2020  )'",.           
-00013310: 2020 2020 2046 7574 7572 6557 6172 6e69       FutureWarni
-00013320: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
-00013330: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
-00013340: 6973 203d 2030 0a0a 2020 2020 2020 2020  is = 0..        
-00013350: 7265 7475 726e 2073 656c 662e 5f72 6564  return self._red
-00013360: 7563 7469 6f6e 5f61 6767 280a 2020 2020  uction_agg(.    
-00013370: 2020 2020 2020 2020 226d 6178 222c 0a20          "max",. 
-00013380: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-00013390: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-000133a0: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
-000133b0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-000133c0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-000133d0: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
-000133e0: 2020 6f75 743d 6f75 742c 0a20 2020 2020    out=out,.     
-000133f0: 2020 2020 2020 2023 2053 7461 7274 696e         # Startin
-00013400: 6720 696e 2070 616e 6461 7320 322e 302c  g in pandas 2.0,
-00013410: 2060 6178 6973 3d4e 6f6e 6560 2064 6f65   `axis=None` doe
-00013420: 7320 6120 6675 6c6c 2061 6767 7265 6761  s a full aggrega
-00013430: 7469 6f6e 2061 6372 6f73 7320 626f 7468  tion across both
-00013440: 2061 7865 730a 2020 2020 2020 2020 2020   axes.          
-00013450: 2020 6e6f 6e65 5f69 735f 7a65 726f 3d6e    none_is_zero=n
-00013460: 6f74 2050 414e 4441 535f 4754 5f32 3030  ot PANDAS_GT_200
-00013470: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00013480: 2040 5f6e 756d 6572 6963 5f6f 6e6c 790a   @_numeric_only.
-00013490: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-000134a0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-000134b0: 2020 2020 6465 6620 6d69 6e28 7365 6c66      def min(self
-000134c0: 2c20 6178 6973 3d30 2c20 736b 6970 6e61  , axis=0, skipna
-000134d0: 3d54 7275 652c 2073 706c 6974 5f65 7665  =True, split_eve
-000134e0: 7279 3d46 616c 7365 2c20 6f75 743d 4e6f  ry=False, out=No
-000134f0: 6e65 2c20 6e75 6d65 7269 635f 6f6e 6c79  ne, numeric_only
-00013500: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00013510: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
-00013520: 2050 414e 4441 535f 4754 5f31 3430 0a20   PANDAS_GT_140. 
-00013530: 2020 2020 2020 2020 2020 2061 6e64 206e             and n
-00013540: 6f74 2050 414e 4441 535f 4754 5f32 3030  ot PANDAS_GT_200
-00013550: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00013560: 2061 7869 7320 6973 204e 6f6e 650a 2020   axis is None.  
-00013570: 2020 2020 2020 2020 2020 616e 6420 6973            and is
-00013580: 696e 7374 616e 6365 2873 656c 662c 2044  instance(self, D
-00013590: 6174 6146 7261 6d65 290a 2020 2020 2020  ataFrame).      
-000135a0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-000135b0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-000135c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000135d0: 2249 6e20 6120 6675 7475 7265 2076 6572  "In a future ver
-000135e0: 7369 6f6e 2c20 4461 7461 4672 616d 652e  sion, DataFrame.
-000135f0: 6d69 6e28 6178 6973 3d4e 6f6e 6529 2077  min(axis=None) w
-00013600: 696c 6c20 7265 7475 726e 2061 2073 6361  ill return a sca
-00013610: 6c61 7220 6d69 6e20 6f76 6572 2074 6865  lar min over the
-00013620: 2065 6e74 6972 6520 4461 7461 4672 616d   entire DataFram
-00013630: 652e 2022 0a20 2020 2020 2020 2020 2020  e. ".           
-00013640: 2020 2020 2022 546f 2072 6574 6169 6e20       "To retain 
-00013650: 7468 6520 6f6c 6420 6265 6861 7669 6f72  the old behavior
-00013660: 2c20 7573 6520 2766 7261 6d65 2e6d 696e  , use 'frame.min
-00013670: 2861 7869 733d 3029 2720 6f72 206a 7573  (axis=0)' or jus
-00013680: 7420 2766 7261 6d65 2e6d 696e 2829 2722  t 'frame.min()'"
-00013690: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000136a0: 2020 4675 7475 7265 5761 726e 696e 672c    FutureWarning,
-000136b0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000136c0: 2020 2020 2020 2020 2020 2061 7869 7320             axis 
-000136d0: 3d20 300a 0a20 2020 2020 2020 2072 6574  = 0..        ret
-000136e0: 7572 6e20 7365 6c66 2e5f 7265 6475 6374  urn self._reduct
-000136f0: 696f 6e5f 6167 6728 0a20 2020 2020 2020  ion_agg(.       
-00013700: 2020 2020 2022 6d69 6e22 2c0a 2020 2020       "min",.    
-00013710: 2020 2020 2020 2020 6178 6973 3d61 7869          axis=axi
-00013720: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
-00013730: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
-00013740: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
-00013750: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-00013760: 792c 0a20 2020 2020 2020 2020 2020 206f  y,.            o
-00013770: 7574 3d6f 7574 2c0a 2020 2020 2020 2020  ut=out,.        
-00013780: 2020 2020 2320 5374 6172 7469 6e67 2069      # Starting i
-00013790: 6e20 7061 6e64 6173 2032 2e30 2c20 6061  n pandas 2.0, `a
-000137a0: 7869 733d 4e6f 6e65 6020 646f 6573 2061  xis=None` does a
-000137b0: 2066 756c 6c20 6167 6772 6567 6174 696f   full aggregatio
-000137c0: 6e20 6163 726f 7373 2062 6f74 6820 6178  n across both ax
-000137d0: 6573 0a20 2020 2020 2020 2020 2020 206e  es.            n
-000137e0: 6f6e 655f 6973 5f7a 6572 6f3d 6e6f 7420  one_is_zero=not 
-000137f0: 5041 4e44 4153 5f47 545f 3230 302c 0a20  PANDAS_GT_200,. 
-00013800: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-00013810: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00013820: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00013830: 6620 6964 786d 6178 2873 656c 662c 2061  f idxmax(self, a
-00013840: 7869 733d 4e6f 6e65 2c20 736b 6970 6e61  xis=None, skipna
-00013850: 3d54 7275 652c 2073 706c 6974 5f65 7665  =True, split_eve
-00013860: 7279 3d46 616c 7365 293a 0a20 2020 2020  ry=False):.     
-00013870: 2020 2066 6e20 3d20 2269 6478 6d61 7822     fn = "idxmax"
-00013880: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
-00013890: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
-000138a0: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
-000138b0: 2020 6d65 7461 203d 2073 656c 662e 5f6d    meta = self._m
-000138c0: 6574 615f 6e6f 6e65 6d70 7479 2e69 6478  eta_nonempty.idx
-000138d0: 6d61 7828 6178 6973 3d61 7869 732c 2073  max(axis=axis, s
-000138e0: 6b69 706e 613d 736b 6970 6e61 290a 2020  kipna=skipna).  
-000138f0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
-00013900: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00013910: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
-00013920: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-00013930: 2020 2020 2020 204d 2e69 6478 6d61 782c         M.idxmax,
-00013940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013950: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-00013960: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
-00013970: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013980: 2020 746f 6b65 6e3d 7365 6c66 2e5f 746f    token=self._to
-00013990: 6b65 6e5f 7072 6566 6978 202b 2066 6e2c  ken_prefix + fn,
-000139a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000139b0: 2073 6b69 706e 613d 736b 6970 6e61 2c0a   skipna=skipna,.
-000139c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000139d0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
-000139e0: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
-000139f0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-00013a00: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-00013a10: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00013a20: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
-00013a30: 7220 3d20 6e6f 7420 6973 5f73 6572 6965  r = not is_serie
-00013a40: 735f 6c69 6b65 286d 6574 6129 0a20 2020  s_like(meta).   
-00013a50: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-00013a60: 3d20 6163 6128 0a20 2020 2020 2020 2020  = aca(.         
-00013a70: 2020 2020 2020 205b 7365 6c66 5d2c 0a20         [self],. 
-00013a80: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00013a90: 6875 6e6b 3d69 6478 6d61 786d 696e 5f63  hunk=idxmaxmin_c
-00013aa0: 6875 6e6b 2c0a 2020 2020 2020 2020 2020  hunk,.          
-00013ab0: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
-00013ac0: 6964 786d 6178 6d69 6e5f 6167 672c 0a20  idxmaxmin_agg,. 
-00013ad0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00013ae0: 6f6d 6269 6e65 3d69 6478 6d61 786d 696e  ombine=idxmaxmin
-00013af0: 5f63 6f6d 6269 6e65 2c0a 2020 2020 2020  _combine,.      
-00013b00: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
-00013b10: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-00013b20: 2020 2020 2061 6767 7265 6761 7465 5f6b       aggregate_k
-00013b30: 7761 7267 733d 7b22 7363 616c 6172 223a  wargs={"scalar":
-00013b40: 2073 6361 6c61 727d 2c0a 2020 2020 2020   scalar},.      
-00013b50: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-00013b60: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
-00013b70: 6978 202b 2066 6e2c 0a20 2020 2020 2020  ix + fn,.       
-00013b80: 2020 2020 2020 2020 2073 706c 6974 5f65           split_e
-00013b90: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00013ba0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00013bb0: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
-00013bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013bd0: 2066 6e3d 666e 2c0a 2020 2020 2020 2020   fn=fn,.        
-00013be0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00013bf0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00013c00: 7365 6c66 2c20 4461 7461 4672 616d 6529  self, DataFrame)
-00013c10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00013c20: 2020 7265 7375 6c74 2e64 6976 6973 696f    result.divisio
-00013c30: 6e73 203d 2028 6d69 6e28 7365 6c66 2e63  ns = (min(self.c
-00013c40: 6f6c 756d 6e73 292c 206d 6178 2873 656c  olumns), max(sel
-00013c50: 662e 636f 6c75 6d6e 7329 290a 2020 2020  f.columns)).    
-00013c60: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00013c70: 6573 756c 740a 0a20 2020 2040 6465 7269  esult..    @deri
-00013c80: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00013c90: 4672 616d 6529 0a20 2020 2064 6566 2069  Frame).    def i
-00013ca0: 6478 6d69 6e28 7365 6c66 2c20 6178 6973  dxmin(self, axis
-00013cb0: 3d4e 6f6e 652c 2073 6b69 706e 613d 5472  =None, skipna=Tr
-00013cc0: 7565 2c20 7370 6c69 745f 6576 6572 793d  ue, split_every=
-00013cd0: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-00013ce0: 666e 203d 2022 6964 786d 696e 220a 2020  fn = "idxmin".  
-00013cf0: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
-00013d00: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-00013d10: 2861 7869 7329 0a20 2020 2020 2020 206d  (axis).        m
-00013d20: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-00013d30: 5f6e 6f6e 656d 7074 792e 6964 786d 6178  _nonempty.idxmax
-00013d40: 2861 7869 733d 6178 6973 290a 2020 2020  (axis=axis).    
-00013d50: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
-00013d60: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00013d70: 7475 726e 206d 6170 5f70 6172 7469 7469  turn map_partiti
-00013d80: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-00013d90: 2020 2020 204d 2e69 6478 6d69 6e2c 0a20       M.idxmin,. 
-00013da0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00013db0: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00013dc0: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
-00013dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013de0: 746f 6b65 6e3d 7365 6c66 2e5f 746f 6b65  token=self._toke
-00013df0: 6e5f 7072 6566 6978 202b 2066 6e2c 0a20  n_prefix + fn,. 
-00013e00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00013e10: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
-00013e20: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00013e30: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
-00013e40: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
-00013e50: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
-00013e60: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00013e70: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00013e80: 2020 2020 2020 2020 2073 6361 6c61 7220           scalar 
-00013e90: 3d20 6e6f 7420 6973 5f73 6572 6965 735f  = not is_series_
-00013ea0: 6c69 6b65 286d 6574 6129 0a20 2020 2020  like(meta).     
-00013eb0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00013ec0: 6163 6128 0a20 2020 2020 2020 2020 2020  aca(.           
-00013ed0: 2020 2020 205b 7365 6c66 5d2c 0a20 2020       [self],.   
-00013ee0: 2020 2020 2020 2020 2020 2020 2063 6875               chu
-00013ef0: 6e6b 3d69 6478 6d61 786d 696e 5f63 6875  nk=idxmaxmin_chu
-00013f00: 6e6b 2c0a 2020 2020 2020 2020 2020 2020  nk,.            
-00013f10: 2020 2020 6167 6772 6567 6174 653d 6964      aggregate=id
-00013f20: 786d 6178 6d69 6e5f 6167 672c 0a20 2020  xmaxmin_agg,.   
-00013f30: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-00013f40: 6269 6e65 3d69 6478 6d61 786d 696e 5f63  bine=idxmaxmin_c
-00013f50: 6f6d 6269 6e65 2c0a 2020 2020 2020 2020  ombine,.        
-00013f60: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
-00013f70: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-00013f80: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
-00013f90: 7267 733d 7b22 7363 616c 6172 223a 2073  rgs={"scalar": s
-00013fa0: 6361 6c61 727d 2c0a 2020 2020 2020 2020  calar},.        
-00013fb0: 2020 2020 2020 2020 746f 6b65 6e3d 7365          token=se
-00013fc0: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
-00013fd0: 202b 2066 6e2c 0a20 2020 2020 2020 2020   + fn,.         
-00013fe0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-00013ff0: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
-00014000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014010: 736b 6970 6e61 3d73 6b69 706e 612c 0a20  skipna=skipna,. 
-00014020: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00014030: 6e3d 666e 2c0a 2020 2020 2020 2020 2020  n=fn,.          
-00014040: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00014050: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
-00014060: 6c66 2c20 4461 7461 4672 616d 6529 3a0a  lf, DataFrame):.
-00014070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014080: 7265 7375 6c74 2e64 6976 6973 696f 6e73  result.divisions
-00014090: 203d 2028 6d69 6e28 7365 6c66 2e63 6f6c   = (min(self.col
-000140a0: 756d 6e73 292c 206d 6178 2873 656c 662e  umns), max(self.
-000140b0: 636f 6c75 6d6e 7329 290a 2020 2020 2020  columns)).      
-000140c0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-000140d0: 756c 740a 0a20 2020 2040 5f6e 756d 6572  ult..    @_numer
-000140e0: 6963 5f6f 6e6c 790a 2020 2020 4064 6572  ic_only.    @der
-000140f0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00014100: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00014110: 636f 756e 7428 7365 6c66 2c20 6178 6973  count(self, axis
-00014120: 3d4e 6f6e 652c 2073 706c 6974 5f65 7665  =None, split_eve
-00014130: 7279 3d46 616c 7365 2c20 6e75 6d65 7269  ry=False, numeri
-00014140: 635f 6f6e 6c79 3d4e 6f6e 6529 3a0a 2020  c_only=None):.  
-00014150: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
-00014160: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-00014170: 2861 7869 7329 0a20 2020 2020 2020 2074  (axis).        t
-00014180: 6f6b 656e 203d 2073 656c 662e 5f74 6f6b  oken = self._tok
-00014190: 656e 5f70 7265 6669 7820 2b20 2263 6f75  en_prefix + "cou
-000141a0: 6e74 220a 2020 2020 2020 2020 6966 2061  nt".        if a
-000141b0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
-000141c0: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
-000141d0: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
-000141e0: 2e63 6f75 6e74 2861 7869 733d 6178 6973  .count(axis=axis
-000141f0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00014200: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
-00014210: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-00014220: 2020 2020 2020 2020 2020 4d2e 636f 756e            M.coun
-00014230: 742c 206d 6574 613d 6d65 7461 2c20 746f  t, meta=meta, to
-00014240: 6b65 6e3d 746f 6b65 6e2c 2061 7869 733d  ken=token, axis=
-00014250: 6178 6973 2c20 656e 666f 7263 655f 6d65  axis, enforce_me
-00014260: 7461 6461 7461 3d46 616c 7365 0a20 2020  tadata=False.   
-00014270: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00014280: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00014290: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
-000142a0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-000142b0: 636f 756e 7428 290a 0a20 2020 2020 2020  count()..       
-000142c0: 2020 2020 2023 204e 6565 6420 7468 6520       # Need the 
-000142d0: 6173 7479 7065 2869 6e74 2920 666f 7220  astype(int) for 
-000142e0: 656d 7074 7920 6461 7461 6672 616d 6573  empty dataframes
-000142f0: 2c20 7768 6963 6820 7375 6d20 746f 2066  , which sum to f
-00014300: 6c6f 6174 2064 7479 7065 0a20 2020 2020  loat dtype.     
-00014310: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00014320: 7365 6c66 2e72 6564 7563 7469 6f6e 280a  self.reduction(.
-00014330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014340: 4d2e 636f 756e 742c 0a20 2020 2020 2020  M.count,.       
-00014350: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
-00014360: 7465 3d5f 636f 756e 745f 6167 6772 6567  te=_count_aggreg
-00014370: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-00014380: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
-00014390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000143a0: 746f 6b65 6e3d 746f 6b65 6e2c 0a20 2020  token=token,.   
-000143b0: 2020 2020 2020 2020 2020 2020 2073 706c               spl
-000143c0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-000143d0: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
-000143e0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000143f0: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
-00014400: 6c66 2c20 4461 7461 4672 616d 6529 3a0a  lf, DataFrame):.
-00014410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014420: 7265 7375 6c74 2e64 6976 6973 696f 6e73  result.divisions
-00014430: 203d 2028 7365 6c66 2e63 6f6c 756d 6e73   = (self.columns
-00014440: 2e6d 696e 2829 2c20 7365 6c66 2e63 6f6c  .min(), self.col
-00014450: 756d 6e73 2e6d 6178 2829 290a 2020 2020  umns.max()).    
-00014460: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00014470: 6573 756c 740a 0a20 2020 2040 6465 7269  esult..    @deri
-00014480: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00014490: 4672 616d 6529 0a20 2020 2064 6566 206d  Frame).    def m
-000144a0: 6f64 6528 7365 6c66 2c20 6472 6f70 6e61  ode(self, dropna
-000144b0: 3d54 7275 652c 2073 706c 6974 5f65 7665  =True, split_eve
-000144c0: 7279 3d46 616c 7365 293a 0a20 2020 2020  ry=False):.     
-000144d0: 2020 206d 6f64 655f 7365 7269 6573 203d     mode_series =
-000144e0: 2073 656c 662e 7265 6475 6374 696f 6e28   self.reduction(
-000144f0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-00014500: 6e6b 3d4d 2e76 616c 7565 5f63 6f75 6e74  nk=M.value_count
-00014510: 732c 0a20 2020 2020 2020 2020 2020 2063  s,.            c
-00014520: 6f6d 6269 6e65 3d4d 2e73 756d 2c0a 2020  ombine=M.sum,.  
-00014530: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
-00014540: 6174 653d 5f6d 6f64 655f 6167 6772 6567  ate=_mode_aggreg
-00014550: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-00014560: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-00014570: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
-00014580: 2020 2020 2020 6368 756e 6b5f 6b77 6172        chunk_kwar
-00014590: 6773 3d7b 2264 726f 706e 6122 3a20 6472  gs={"dropna": dr
-000145a0: 6f70 6e61 7d2c 0a20 2020 2020 2020 2020  opna},.         
-000145b0: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
-000145c0: 7267 733d 7b22 6472 6f70 6e61 223a 2064  rgs={"dropna": d
-000145d0: 726f 706e 617d 2c0a 2020 2020 2020 2020  ropna},.        
-000145e0: 290a 2020 2020 2020 2020 6d6f 6465 5f73  ).        mode_s
-000145f0: 6572 6965 732e 6e61 6d65 203d 2073 656c  eries.name = sel
-00014600: 662e 6e61 6d65 0a20 2020 2020 2020 2072  f.name.        r
-00014610: 6574 7572 6e20 6d6f 6465 5f73 6572 6965  eturn mode_serie
-00014620: 730a 0a20 2020 2040 5f6e 756d 6572 6963  s..    @_numeric
-00014630: 5f6f 6e6c 790a 2020 2020 4064 6572 6976  _only.    @deriv
-00014640: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00014650: 7261 6d65 290a 2020 2020 6465 6620 6d65  rame).    def me
-00014660: 616e 280a 2020 2020 2020 2020 7365 6c66  an(.        self
-00014670: 2c0a 2020 2020 2020 2020 6178 6973 3d30  ,.        axis=0
-00014680: 2c0a 2020 2020 2020 2020 736b 6970 6e61  ,.        skipna
-00014690: 3d54 7275 652c 0a20 2020 2020 2020 2073  =True,.        s
-000146a0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-000146b0: 2c0a 2020 2020 2020 2020 6474 7970 653d  ,.        dtype=
-000146c0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f75  None,.        ou
-000146d0: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
-000146e0: 6e75 6d65 7269 635f 6f6e 6c79 3d4e 6f6e  numeric_only=Non
-000146f0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00014700: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
-00014710: 2020 2050 414e 4441 535f 4754 5f31 3430     PANDAS_GT_140
-00014720: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00014730: 206e 6f74 2050 414e 4441 535f 4754 5f32   not PANDAS_GT_2
-00014740: 3030 0a20 2020 2020 2020 2020 2020 2061  00.            a
-00014750: 6e64 2061 7869 7320 6973 204e 6f6e 650a  nd axis is None.
-00014760: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00014770: 6973 696e 7374 616e 6365 2873 656c 662c  isinstance(self,
-00014780: 2044 6174 6146 7261 6d65 290a 2020 2020   DataFrame).    
-00014790: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-000147a0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-000147b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000147c0: 2020 2249 6e20 6120 6675 7475 7265 2076    "In a future v
-000147d0: 6572 7369 6f6e 2c20 4461 7461 4672 616d  ersion, DataFram
-000147e0: 652e 6d65 616e 2861 7869 733d 4e6f 6e65  e.mean(axis=None
-000147f0: 2920 7769 6c6c 2072 6574 7572 6e20 6120  ) will return a 
-00014800: 7363 616c 6172 206d 6561 6e20 6f76 6572  scalar mean over
-00014810: 2074 6865 2065 6e74 6972 6520 4461 7461   the entire Data
-00014820: 4672 616d 652e 2022 0a20 2020 2020 2020  Frame. ".       
-00014830: 2020 2020 2020 2020 2022 546f 2072 6574           "To ret
-00014840: 6169 6e20 7468 6520 6f6c 6420 6265 6861  ain the old beha
-00014850: 7669 6f72 2c20 7573 6520 2766 7261 6d65  vior, use 'frame
-00014860: 2e6d 6561 6e28 6178 6973 3d30 2927 206f  .mean(axis=0)' o
-00014870: 7220 6a75 7374 2027 6672 616d 652e 6d65  r just 'frame.me
-00014880: 616e 2829 2722 2c0a 2020 2020 2020 2020  an()'",.        
-00014890: 2020 2020 2020 2020 4675 7475 7265 5761          FutureWa
-000148a0: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
-000148b0: 2020 2029 0a20 2020 2020 2020 2061 7869     ).        axi
-000148c0: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
-000148d0: 7465 5f61 7869 7328 6178 6973 2c20 6e6f  te_axis(axis, no
-000148e0: 6e65 5f69 735f 7a65 726f 3d6e 6f74 2050  ne_is_zero=not P
-000148f0: 414e 4441 535f 4754 5f32 3030 290a 2020  ANDAS_GT_200).  
-00014900: 2020 2020 2020 5f72 6169 7365 5f69 665f        _raise_if_
-00014910: 6f62 6a65 6374 5f73 6572 6965 7328 7365  object_series(se
-00014920: 6c66 2c20 226d 6561 6e22 290a 2020 2020  lf, "mean").    
-00014930: 2020 2020 2320 4e4f 5445 3a20 446f 2077      # NOTE: Do w
-00014940: 6520 7761 6e74 2074 6f20 7761 726e 2068  e want to warn h
-00014950: 6572 653f 0a20 2020 2020 2020 2077 6974  ere?.        wit
-00014960: 6820 6368 6563 6b5f 6e75 6d65 7269 635f  h check_numeric_
-00014970: 6f6e 6c79 5f64 6570 7265 6361 7469 6f6e  only_deprecation
-00014980: 2829 2c20 6368 6563 6b5f 6e75 6973 616e  (), check_nuisan
-00014990: 6365 5f63 6f6c 756d 6e73 5f77 6172 6e69  ce_columns_warni
-000149a0: 6e67 2829 3a0a 2020 2020 2020 2020 2020  ng():.          
-000149b0: 2020 6d65 7461 203d 2073 656c 662e 5f6d    meta = self._m
-000149c0: 6574 615f 6e6f 6e65 6d70 7479 2e6d 6561  eta_nonempty.mea
-000149d0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-000149e0: 2020 2061 7869 733d 6178 6973 2c20 736b     axis=axis, sk
-000149f0: 6970 6e61 3d73 6b69 706e 612c 206e 756d  ipna=skipna, num
-00014a00: 6572 6963 5f6f 6e6c 793d 6e75 6d65 7269  eric_only=numeri
-00014a10: 635f 6f6e 6c79 0a20 2020 2020 2020 2020  c_only.         
-00014a20: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-00014a30: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
-00014a40: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00014a50: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-00014a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a70: 4d2e 6d65 616e 2c0a 2020 2020 2020 2020  M.mean,.        
-00014a80: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00014a90: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00014aa0: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
-00014ab0: 2020 2020 2020 2020 2074 6f6b 656e 3d73           token=s
-00014ac0: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
-00014ad0: 7820 2b20 226d 6561 6e22 2c0a 2020 2020  x + "mean",.    
-00014ae0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00014af0: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
-00014b00: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
-00014b10: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
-00014b20: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
-00014b30: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
-00014b40: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-00014b50: 6d65 7269 635f 6f6e 6c79 3d6e 756d 6572  meric_only=numer
-00014b60: 6963 5f6f 6e6c 792c 0a20 2020 2020 2020  ic_only,.       
-00014b70: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00014b80: 2020 2072 6574 7572 6e20 6861 6e64 6c65     return handle
-00014b90: 5f6f 7574 286f 7574 2c20 7265 7375 6c74  _out(out, result
-00014ba0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00014bb0: 2020 2020 2020 2020 2020 2020 6e75 6d20              num 
-00014bc0: 3d20 7365 6c66 2e5f 6765 745f 6e75 6d65  = self._get_nume
-00014bd0: 7269 635f 6461 7461 2829 0a20 2020 2020  ric_data().     
-00014be0: 2020 2020 2020 2073 203d 206e 756d 2e73         s = num.s
-00014bf0: 756d 2873 6b69 706e 613d 736b 6970 6e61  um(skipna=skipna
-00014c00: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
-00014c10: 6c69 745f 6576 6572 7929 0a20 2020 2020  lit_every).     
-00014c20: 2020 2020 2020 206e 203d 206e 756d 2e63         n = num.c
-00014c30: 6f75 6e74 2873 706c 6974 5f65 7665 7279  ount(split_every
-00014c40: 3d73 706c 6974 5f65 7665 7279 290a 2020  =split_every).  
-00014c50: 2020 2020 2020 2020 2020 2320 5374 6172            # Star
-00014c60: 7469 6e67 2069 6e20 7061 6e64 6173 2032  ting in pandas 2
-00014c70: 2e30 2c20 6061 7869 733d 4e6f 6e65 6020  .0, `axis=None` 
-00014c80: 646f 6573 2061 2066 756c 6c20 6167 6772  does a full aggr
-00014c90: 6567 6174 696f 6e20 6163 726f 7373 2062  egation across b
-00014ca0: 6f74 6820 6178 6573 0a20 2020 2020 2020  oth axes.       
-00014cb0: 2020 2020 2069 6620 5041 4e44 4153 5f47       if PANDAS_G
-00014cc0: 545f 3230 3020 616e 6420 6178 6973 2069  T_200 and axis i
-00014cd0: 7320 4e6f 6e65 2061 6e64 2069 7369 6e73  s None and isins
-00014ce0: 7461 6e63 6528 7365 6c66 2c20 4461 7461  tance(self, Data
-00014cf0: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
-00014d00: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-00014d10: 2073 2e73 756d 2829 202f 206e 2e73 756d   s.sum() / n.sum
-00014d20: 2829 0a20 2020 2020 2020 2020 2020 2065  ().            e
-00014d30: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00014d40: 2020 2020 206e 616d 6520 3d20 7365 6c66       name = self
-00014d50: 2e5f 746f 6b65 6e5f 7072 6566 6978 202b  ._token_prefix +
-00014d60: 2022 6d65 616e 2d25 7322 2025 2074 6f6b   "mean-%s" % tok
-00014d70: 656e 697a 6528 7365 6c66 2c20 6178 6973  enize(self, axis
-00014d80: 2c20 736b 6970 6e61 290a 2020 2020 2020  , skipna).      
-00014d90: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00014da0: 203d 206d 6170 5f70 6172 7469 7469 6f6e   = map_partition
-00014db0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-00014dc0: 2020 2020 2020 206d 6574 686f 6473 2e6d         methods.m
-00014dd0: 6561 6e5f 6167 6772 6567 6174 652c 0a20  ean_aggregate,. 
-00014de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014df0: 2020 2073 2c0a 2020 2020 2020 2020 2020     s,.          
-00014e00: 2020 2020 2020 2020 2020 6e2c 0a20 2020            n,.   
-00014e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e20: 2074 6f6b 656e 3d6e 616d 652c 0a20 2020   token=name,.   
-00014e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e40: 206d 6574 613d 6d65 7461 2c0a 2020 2020   meta=meta,.    
-00014e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014e60: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-00014e70: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00014e80: 2020 2020 2020 2020 2020 2020 7061 7265              pare
-00014e90: 6e74 5f6d 6574 613d 7365 6c66 2e5f 6d65  nt_meta=self._me
-00014ea0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-00014eb0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00014ec0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00014ed0: 6e63 6528 7365 6c66 2c20 4461 7461 4672  nce(self, DataFr
-00014ee0: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
-00014ef0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00014f00: 2e64 6976 6973 696f 6e73 203d 2028 7365  .divisions = (se
-00014f10: 6c66 2e63 6f6c 756d 6e73 2e6d 696e 2829  lf.columns.min()
-00014f20: 2c20 7365 6c66 2e63 6f6c 756d 6e73 2e6d  , self.columns.m
-00014f30: 6178 2829 290a 2020 2020 2020 2020 2020  ax()).          
-00014f40: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
-00014f50: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
-00014f60: 0a0a 2020 2020 6465 6620 6d65 6469 616e  ..    def median
-00014f70: 5f61 7070 726f 7869 6d61 7465 280a 2020  _approximate(.  
-00014f80: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00014f90: 2020 2020 6178 6973 3d4e 6f6e 652c 0a20      axis=None,. 
-00014fa0: 2020 2020 2020 206d 6574 686f 643d 2264         method="d
-00014fb0: 6566 6175 6c74 222c 0a20 2020 2029 3a0a  efault",.    ):.
-00014fc0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00014fd0: 6e20 7468 6520 6170 7072 6f78 696d 6174  n the approximat
-00014fe0: 6520 6d65 6469 616e 206f 6620 7468 6520  e median of the 
-00014ff0: 7661 6c75 6573 206f 7665 7220 7468 6520  values over the 
-00015000: 7265 7175 6573 7465 6420 6178 6973 2e0a  requested axis..
-00015010: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00015020: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00015030: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2061  ------.        a
-00015040: 7869 7320 3a20 7b30 2c20 312c 2022 696e  xis : {0, 1, "in
-00015050: 6465 7822 2c20 2263 6f6c 756d 6e73 227d  dex", "columns"}
-00015060: 2028 6465 6661 756c 7420 3029 0a20 2020   (default 0).   
-00015070: 2020 2020 2020 2020 2030 206f 7220 6060           0 or ``
-00015080: 2269 6e64 6578 2260 6020 666f 7220 726f  "index"`` for ro
-00015090: 772d 7769 7365 2c20 3120 6f72 2060 6022  w-wise, 1 or ``"
-000150a0: 636f 6c75 6d6e 7322 6060 2066 6f72 2063  columns"`` for c
-000150b0: 6f6c 756d 6e2d 7769 7365 0a20 2020 2020  olumn-wise.     
-000150c0: 2020 206d 6574 686f 6420 3a20 7b27 6465     method : {'de
-000150d0: 6661 756c 7427 2c20 2774 6469 6765 7374  fault', 'tdigest
-000150e0: 272c 2027 6461 736b 277d 2c20 6f70 7469  ', 'dask'}, opti
-000150f0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00015100: 2057 6861 7420 6d65 7468 6f64 2074 6f20   What method to 
-00015110: 7573 652e 2042 7920 6465 6661 756c 7420  use. By default 
-00015120: 7769 6c6c 2075 7365 2044 6173 6b27 7320  will use Dask's 
-00015130: 696e 7465 726e 616c 2063 7573 746f 6d0a  internal custom.
-00015140: 2020 2020 2020 2020 2020 2020 616c 676f              algo
-00015150: 7269 7468 6d20 2860 6022 6461 736b 2260  rithm (``"dask"`
-00015160: 6029 2e20 2049 6620 7365 7420 746f 2060  `).  If set to `
-00015170: 6022 7464 6967 6573 7422 6060 2077 696c  `"tdigest"`` wil
-00015180: 6c20 7573 6520 7464 6967 6573 740a 2020  l use tdigest.  
-00015190: 2020 2020 2020 2020 2020 666f 7220 666c            for fl
-000151a0: 6f61 7473 2061 6e64 2069 6e74 7320 616e  oats and ints an
-000151b0: 6420 6661 6c6c 6261 636b 2074 6f20 7468  d fallback to th
-000151c0: 6520 6060 2264 6173 6b22 6060 206f 7468  e ``"dask"`` oth
-000151d0: 6572 7769 7365 2e0a 2020 2020 2020 2020  erwise..        
-000151e0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-000151f0: 726e 2073 656c 662e 7175 616e 7469 6c65  rn self.quantile
-00015200: 2871 3d30 2e35 2c20 6178 6973 3d61 7869  (q=0.5, axis=axi
-00015210: 732c 206d 6574 686f 643d 6d65 7468 6f64  s, method=method
-00015220: 292e 7265 6e61 6d65 284e 6f6e 6529 0a0a  ).rename(None)..
-00015230: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00015240: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-00015250: 2020 2020 6465 6620 6d65 6469 616e 2873      def median(s
-00015260: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
-00015270: 6d65 7468 6f64 3d22 6465 6661 756c 7422  method="default"
-00015280: 293a 0a20 2020 2020 2020 2069 6620 6178  ):.        if ax
-00015290: 6973 2069 6e20 2831 2c20 2263 6f6c 756d  is in (1, "colum
-000152a0: 6e73 2229 206f 7220 7365 6c66 2e6e 7061  ns") or self.npa
-000152b0: 7274 6974 696f 6e73 203d 3d20 313a 0a20  rtitions == 1:. 
-000152c0: 2020 2020 2020 2020 2020 2023 2043 616e             # Can
-000152d0: 2070 726f 7669 6465 2061 6e20 6578 6163   provide an exac
-000152e0: 7420 6d65 6469 616e 2069 6e20 7468 6573  t median in thes
-000152f0: 6520 6361 7365 730a 2020 2020 2020 2020  e cases.        
-00015300: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00015310: 6d65 6469 616e 5f61 7070 726f 7869 6d61  median_approxima
-00015320: 7465 2861 7869 733d 6178 6973 2c20 6d65  te(axis=axis, me
-00015330: 7468 6f64 3d6d 6574 686f 6429 0a20 2020  thod=method).   
-00015340: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-00015350: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
-00015360: 2020 2020 2020 2020 2020 2020 2244 6173              "Das
-00015370: 6b20 646f 6573 6e27 7420 696d 706c 656d  k doesn't implem
-00015380: 656e 7420 616e 2065 7861 6374 206d 6564  ent an exact med
-00015390: 6961 6e20 696e 2061 6c6c 2063 6173 6573  ian in all cases
-000153a0: 2061 7320 7468 6973 2069 7320 6861 7264   as this is hard
-000153b0: 2074 6f20 646f 2069 6e20 7061 7261 6c6c   to do in parall
-000153c0: 656c 2e20 220a 2020 2020 2020 2020 2020  el. ".          
-000153d0: 2020 2253 6565 2074 6865 2060 6d65 6469    "See the `medi
-000153e0: 616e 5f61 7070 726f 7869 6d61 7465 6020  an_approximate` 
-000153f0: 6d65 7468 6f64 2069 6e73 7465 6164 2c20  method instead, 
-00015400: 7768 6963 6820 7573 6573 2061 6e20 6170  which uses an ap
-00015410: 7072 6f78 696d 6174 6520 616c 676f 7269  proximate algori
-00015420: 7468 6d2e 220a 2020 2020 2020 2020 290a  thm.".        ).
-00015430: 0a20 2020 2040 5f6e 756d 6572 6963 5f6f  .    @_numeric_o
-00015440: 6e6c 790a 2020 2020 4064 6572 6976 6564  nly.    @derived
-00015450: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-00015460: 6d65 290a 2020 2020 6465 6620 7661 7228  me).    def var(
-00015470: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00015480: 2020 2020 2020 2061 7869 733d 4e6f 6e65         axis=None
-00015490: 2c0a 2020 2020 2020 2020 736b 6970 6e61  ,.        skipna
-000154a0: 3d54 7275 652c 0a20 2020 2020 2020 2064  =True,.        d
-000154b0: 646f 663d 312c 0a20 2020 2020 2020 2073  dof=1,.        s
-000154c0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-000154d0: 2c0a 2020 2020 2020 2020 6474 7970 653d  ,.        dtype=
-000154e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f75  None,.        ou
-000154f0: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
-00015500: 6e75 6d65 7269 635f 6f6e 6c79 3d4e 6f6e  numeric_only=Non
-00015510: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00015520: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
-00015530: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-00015540: 7329 0a20 2020 2020 2020 205f 7261 6973  s).        _rais
-00015550: 655f 6966 5f6f 626a 6563 745f 7365 7269  e_if_object_seri
-00015560: 6573 2873 656c 662c 2022 7661 7222 290a  es(self, "var").
-00015570: 2020 2020 2020 2020 7769 7468 2063 6865          with che
-00015580: 636b 5f6e 756d 6572 6963 5f6f 6e6c 795f  ck_numeric_only_
-00015590: 6465 7072 6563 6174 696f 6e28 292c 2063  deprecation(), c
-000155a0: 6865 636b 5f6e 7569 7361 6e63 655f 636f  heck_nuisance_co
-000155b0: 6c75 6d6e 735f 7761 726e 696e 6728 293a  lumns_warning():
-000155c0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-000155d0: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
-000155e0: 6f6e 656d 7074 792e 7661 7228 0a20 2020  onempty.var(.   
-000155f0: 2020 2020 2020 2020 2020 2020 2061 7869               axi
-00015600: 733d 6178 6973 2c20 736b 6970 6e61 3d73  s=axis, skipna=s
-00015610: 6b69 706e 612c 206e 756d 6572 6963 5f6f  kipna, numeric_o
-00015620: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
-00015630: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00015640: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-00015650: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00015660: 2072 6573 756c 7420 3d20 6d61 705f 7061   result = map_pa
-00015670: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-00015680: 2020 2020 2020 2020 2020 4d2e 7661 722c            M.var,
-00015690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000156a0: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-000156b0: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
-000156c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000156d0: 2020 746f 6b65 6e3d 7365 6c66 2e5f 746f    token=self._to
-000156e0: 6b65 6e5f 7072 6566 6978 202b 2022 7661  ken_prefix + "va
-000156f0: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-00015700: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
-00015710: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00015720: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
-00015730: 2020 2020 2020 2020 2020 2020 2020 6464                dd
-00015740: 6f66 3d64 646f 662c 0a20 2020 2020 2020  of=ddof,.       
-00015750: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
-00015760: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
-00015770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015780: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
-00015790: 6d65 7269 635f 6f6e 6c79 2c0a 2020 2020  meric_only,.    
-000157a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000157b0: 2020 2020 2020 7265 7475 726e 2068 616e        return han
-000157c0: 646c 655f 6f75 7428 6f75 742c 2072 6573  dle_out(out, res
-000157d0: 756c 7429 0a20 2020 2020 2020 2065 6c73  ult).        els
-000157e0: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
-000157f0: 6620 7365 6c66 2e6e 6469 6d20 3d3d 2031  f self.ndim == 1
-00015800: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015810: 2020 7265 7375 6c74 203d 2073 656c 662e    result = self.
-00015820: 5f76 6172 5f31 6428 7365 6c66 2c20 736b  _var_1d(self, sk
-00015830: 6970 6e61 2c20 6464 6f66 2c20 7370 6c69  ipna, ddof, spli
-00015840: 745f 6576 6572 7929 0a20 2020 2020 2020  t_every).       
-00015850: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00015860: 6861 6e64 6c65 5f6f 7574 286f 7574 2c20  handle_out(out, 
-00015870: 7265 7375 6c74 290a 0a20 2020 2020 2020  result)..       
-00015880: 2020 2020 2023 2070 616e 6461 7320 312e       # pandas 1.
-00015890: 302b 2064 6f65 7320 6e6f 7420 696d 706c  0+ does not impl
-000158a0: 656d 656e 7420 7661 7220 6f6e 2074 696d  ement var on tim
-000158b0: 6564 656c 7461 0a20 2020 2020 2020 2020  edelta.         
-000158c0: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
-000158d0: 2e5f 7661 725f 6e75 6d65 7269 6328 736b  ._var_numeric(sk
-000158e0: 6970 6e61 2c20 6464 6f66 2c20 7370 6c69  ipna, ddof, spli
-000158f0: 745f 6576 6572 7929 0a0a 2020 2020 2020  t_every)..      
-00015900: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00015910: 6e63 6528 7365 6c66 2c20 4461 7461 4672  nce(self, DataFr
-00015920: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
-00015930: 2020 2020 2020 7265 7375 6c74 2e64 6976        result.div
-00015940: 6973 696f 6e73 203d 2028 7365 6c66 2e63  isions = (self.c
-00015950: 6f6c 756d 6e73 2e6d 696e 2829 2c20 7365  olumns.min(), se
-00015960: 6c66 2e63 6f6c 756d 6e73 2e6d 6178 2829  lf.columns.max()
-00015970: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00015980: 7475 726e 2068 616e 646c 655f 6f75 7428  turn handle_out(
-00015990: 6f75 742c 2072 6573 756c 7429 0a0a 2020  out, result)..  
-000159a0: 2020 6465 6620 5f76 6172 5f6e 756d 6572    def _var_numer
-000159b0: 6963 2873 656c 662c 2073 6b69 706e 613d  ic(self, skipna=
-000159c0: 5472 7565 2c20 6464 6f66 3d31 2c20 7370  True, ddof=1, sp
-000159d0: 6c69 745f 6576 6572 793d 4661 6c73 6529  lit_every=False)
-000159e0: 3a0a 2020 2020 2020 2020 6e75 6d20 3d20  :.        num = 
-000159f0: 7365 6c66 2e73 656c 6563 745f 6474 7970  self.select_dtyp
-00015a00: 6573 2869 6e63 6c75 6465 3d5b 226e 756d  es(include=["num
-00015a10: 6265 7222 2c20 2262 6f6f 6c22 5d2c 2065  ber", "bool"], e
-00015a20: 7863 6c75 6465 3d5b 6e70 2e74 696d 6564  xclude=[np.timed
-00015a30: 656c 7461 3634 5d29 0a0a 2020 2020 2020  elta64])..      
-00015a40: 2020 7661 6c75 6573 5f64 7479 7065 203d    values_dtype =
-00015a50: 206e 756d 2e76 616c 7565 732e 6474 7970   num.values.dtyp
-00015a60: 650a 2020 2020 2020 2020 6172 7261 795f  e.        array_
-00015a70: 7661 6c75 6573 203d 206e 756d 2e76 616c  values = num.val
-00015a80: 7565 730a 0a20 2020 2020 2020 2069 6620  ues..        if 
-00015a90: 6e6f 7420 6e70 2e69 7373 7562 6474 7970  not np.issubdtyp
-00015aa0: 6528 7661 6c75 6573 5f64 7479 7065 2c20  e(values_dtype, 
-00015ab0: 6e70 2e6e 756d 6265 7229 3a0a 2020 2020  np.number):.    
-00015ac0: 2020 2020 2020 2020 6172 7261 795f 7661          array_va
-00015ad0: 6c75 6573 203d 206e 756d 2e76 616c 7565  lues = num.value
-00015ae0: 732e 6173 7479 7065 2822 6638 2229 0a0a  s.astype("f8")..
-00015af0: 2020 2020 2020 2020 7661 7220 3d20 6461          var = da
-00015b00: 2e6e 616e 7661 7220 6966 2073 6b69 706e  .nanvar if skipn
-00015b10: 6120 6f72 2073 6b69 706e 6120 6973 204e  a or skipna is N
-00015b20: 6f6e 6520 656c 7365 2064 612e 7661 720a  one else da.var.
-00015b30: 2020 2020 2020 2020 6172 7261 795f 7661          array_va
-00015b40: 7220 3d20 7661 7228 6172 7261 795f 7661  r = var(array_va
-00015b50: 6c75 6573 2c20 6178 6973 3d30 2c20 6464  lues, axis=0, dd
-00015b60: 6f66 3d64 646f 662c 2073 706c 6974 5f65  of=ddof, split_e
-00015b70: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00015b80: 290a 0a20 2020 2020 2020 206e 616d 6520  )..        name 
-00015b90: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
-00015ba0: 6566 6978 202b 2022 7661 722d 6e75 6d65  efix + "var-nume
-00015bb0: 7269 6322 202b 2074 6f6b 656e 697a 6528  ric" + tokenize(
-00015bc0: 6e75 6d2c 2073 706c 6974 5f65 7665 7279  num, split_every
-00015bd0: 290a 2020 2020 2020 2020 636f 6c73 203d  ).        cols =
-00015be0: 206e 756d 2e5f 6d65 7461 2e63 6f6c 756d   num._meta.colum
-00015bf0: 6e73 2069 6620 6973 5f64 6174 6166 7261  ns if is_datafra
-00015c00: 6d65 5f6c 696b 6528 6e75 6d29 2065 6c73  me_like(num) els
-00015c10: 6520 4e6f 6e65 0a0a 2020 2020 2020 2020  e None..        
-00015c20: 7661 725f 7368 6170 6520 3d20 6e75 6d2e  var_shape = num.
-00015c30: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e76  _meta_nonempty.v
-00015c40: 616c 7565 732e 7661 7228 6178 6973 3d30  alues.var(axis=0
-00015c50: 292e 7368 6170 650a 2020 2020 2020 2020  ).shape.        
-00015c60: 6172 7261 795f 7661 725f 6e61 6d65 203d  array_var_name =
-00015c70: 2028 6172 7261 795f 7661 722e 5f6e 616d   (array_var._nam
-00015c80: 652c 2920 2b20 2830 2c29 202a 206c 656e  e,) + (0,) * len
-00015c90: 2876 6172 5f73 6861 7065 290a 0a20 2020  (var_shape)..   
-00015ca0: 2020 2020 206c 6179 6572 203d 207b 286e       layer = {(n
-00015cb0: 616d 652c 2030 293a 2028 6d65 7468 6f64  ame, 0): (method
-00015cc0: 732e 7772 6170 5f76 6172 5f72 6564 7563  s.wrap_var_reduc
-00015cd0: 7469 6f6e 2c20 6172 7261 795f 7661 725f  tion, array_var_
-00015ce0: 6e61 6d65 2c20 636f 6c73 297d 0a20 2020  name, cols)}.   
-00015cf0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-00015d00: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-00015d10: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
-00015d20: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
-00015d30: 656e 6369 6573 3d5b 6172 7261 795f 7661  encies=[array_va
-00015d40: 725d 290a 0a20 2020 2020 2020 2072 6574  r])..        ret
-00015d50: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
-00015d60: 7428 0a20 2020 2020 2020 2020 2020 2067  t(.            g
-00015d70: 7261 7068 2c20 6e61 6d65 2c20 6e75 6d2e  raph, name, num.
-00015d80: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e76  _meta_nonempty.v
-00015d90: 6172 2829 2c20 6469 7669 7369 6f6e 733d  ar(), divisions=
-00015da0: 5b4e 6f6e 652c 204e 6f6e 655d 0a20 2020  [None, None].   
-00015db0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00015dc0: 5f76 6172 5f74 696d 6564 656c 7461 7328  _var_timedeltas(
-00015dd0: 7365 6c66 2c20 736b 6970 6e61 3d54 7275  self, skipna=Tru
-00015de0: 652c 2064 646f 663d 312c 2073 706c 6974  e, ddof=1, split
-00015df0: 5f65 7665 7279 3d46 616c 7365 293a 0a20  _every=False):. 
-00015e00: 2020 2020 2020 2074 696d 6564 656c 7461         timedelta
-00015e10: 7320 3d20 7365 6c66 2e73 656c 6563 745f  s = self.select_
-00015e20: 6474 7970 6573 2869 6e63 6c75 6465 3d5b  dtypes(include=[
-00015e30: 6e70 2e74 696d 6564 656c 7461 3634 5d29  np.timedelta64])
-00015e40: 0a0a 2020 2020 2020 2020 7661 725f 7469  ..        var_ti
-00015e50: 6d65 6465 6c74 6173 203d 205b 0a20 2020  medeltas = [.   
-00015e60: 2020 2020 2020 2020 2073 656c 662e 5f76           self._v
-00015e70: 6172 5f31 6428 7469 6d65 6465 6c74 6173  ar_1d(timedeltas
-00015e80: 5b63 6f6c 5f69 6478 5d2c 2073 6b69 706e  [col_idx], skipn
-00015e90: 612c 2064 646f 662c 2073 706c 6974 5f65  a, ddof, split_e
-00015ea0: 7665 7279 290a 2020 2020 2020 2020 2020  very).          
-00015eb0: 2020 666f 7220 636f 6c5f 6964 7820 696e    for col_idx in
-00015ec0: 2074 696d 6564 656c 7461 732e 5f6d 6574   timedeltas._met
-00015ed0: 612e 636f 6c75 6d6e 730a 2020 2020 2020  a.columns.      
-00015ee0: 2020 5d0a 2020 2020 2020 2020 7661 725f    ].        var_
-00015ef0: 7469 6d65 6465 6c74 615f 6e61 6d65 7320  timedelta_names 
-00015f00: 3d20 5b28 762e 5f6e 616d 652c 2030 2920  = [(v._name, 0) 
-00015f10: 666f 7220 7620 696e 2076 6172 5f74 696d  for v in var_tim
-00015f20: 6564 656c 7461 735d 0a0a 2020 2020 2020  edeltas]..      
-00015f30: 2020 6e61 6d65 203d 2028 0a20 2020 2020    name = (.     
-00015f40: 2020 2020 2020 2073 656c 662e 5f74 6f6b         self._tok
-00015f50: 656e 5f70 7265 6669 7820 2b20 2276 6172  en_prefix + "var
-00015f60: 2d74 696d 6564 656c 7461 732d 2220 2b20  -timedeltas-" + 
-00015f70: 746f 6b65 6e69 7a65 2874 696d 6564 656c  tokenize(timedel
-00015f80: 7461 732c 2073 706c 6974 5f65 7665 7279  tas, split_every
-00015f90: 290a 2020 2020 2020 2020 290a 0a20 2020  ).        )..   
-00015fa0: 2020 2020 206c 6179 6572 203d 207b 0a20       layer = {. 
-00015fb0: 2020 2020 2020 2020 2020 2028 6e61 6d65             (name
-00015fc0: 2c20 3029 3a20 280a 2020 2020 2020 2020  , 0): (.        
-00015fd0: 2020 2020 2020 2020 6d65 7468 6f64 732e          methods.
-00015fe0: 7772 6170 5f76 6172 5f72 6564 7563 7469  wrap_var_reducti
-00015ff0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00016000: 2020 2020 7661 725f 7469 6d65 6465 6c74      var_timedelt
-00016010: 615f 6e61 6d65 732c 0a20 2020 2020 2020  a_names,.       
-00016020: 2020 2020 2020 2020 2074 696d 6564 656c           timedel
-00016030: 7461 732e 5f6d 6574 612e 636f 6c75 6d6e  tas._meta.column
-00016040: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-00016050: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00016060: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-00016070: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-00016080: 6f6c 6c65 6374 696f 6e73 280a 2020 2020  ollections(.    
-00016090: 2020 2020 2020 2020 6e61 6d65 2c20 6c61          name, la
-000160a0: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
-000160b0: 733d 7661 725f 7469 6d65 6465 6c74 6173  s=var_timedeltas
-000160c0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000160d0: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
-000160e0: 645f 6f62 6a65 6374 280a 2020 2020 2020  d_object(.      
-000160f0: 2020 2020 2020 6772 6170 682c 206e 616d        graph, nam
-00016100: 652c 2074 696d 6564 656c 7461 732e 5f6d  e, timedeltas._m
-00016110: 6574 615f 6e6f 6e65 6d70 7479 2e76 6172  eta_nonempty.var
-00016120: 2829 2c20 6469 7669 7369 6f6e 733d 5b4e  (), divisions=[N
-00016130: 6f6e 652c 204e 6f6e 655d 0a20 2020 2020  one, None].     
-00016140: 2020 2029 0a0a 2020 2020 6465 6620 5f76     )..    def _v
-00016150: 6172 5f6d 6978 6564 2873 656c 662c 2073  ar_mixed(self, s
-00016160: 6b69 706e 613d 5472 7565 2c20 6464 6f66  kipna=True, ddof
-00016170: 3d31 2c20 7370 6c69 745f 6576 6572 793d  =1, split_every=
-00016180: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-00016190: 6461 7461 203d 2073 656c 662e 7365 6c65  data = self.sele
-000161a0: 6374 5f64 7479 7065 7328 696e 636c 7564  ct_dtypes(includ
-000161b0: 653d 5b22 6e75 6d62 6572 222c 2022 626f  e=["number", "bo
-000161c0: 6f6c 222c 206e 702e 7469 6d65 6465 6c74  ol", np.timedelt
-000161d0: 6136 345d 290a 0a20 2020 2020 2020 2074  a64])..        t
-000161e0: 696d 6564 656c 7461 5f76 6172 7320 3d20  imedelta_vars = 
-000161f0: 7365 6c66 2e5f 7661 725f 7469 6d65 6465  self._var_timede
-00016200: 6c74 6173 2873 6b69 706e 612c 2064 646f  ltas(skipna, ddo
-00016210: 662c 2073 706c 6974 5f65 7665 7279 290a  f, split_every).
-00016220: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
-00016230: 7661 7273 203d 2073 656c 662e 5f76 6172  vars = self._var
-00016240: 5f6e 756d 6572 6963 2873 6b69 706e 612c  _numeric(skipna,
-00016250: 2064 646f 662c 2073 706c 6974 5f65 7665   ddof, split_eve
-00016260: 7279 290a 0a20 2020 2020 2020 206e 616d  ry)..        nam
-00016270: 6520 3d20 7365 6c66 2e5f 746f 6b65 6e5f  e = self._token_
-00016280: 7072 6566 6978 202b 2022 7661 722d 6d69  prefix + "var-mi
-00016290: 7865 642d 2220 2b20 746f 6b65 6e69 7a65  xed-" + tokenize
-000162a0: 2864 6174 612c 2073 706c 6974 5f65 7665  (data, split_eve
-000162b0: 7279 290a 0a20 2020 2020 2020 206c 6179  ry)..        lay
-000162c0: 6572 203d 207b 0a20 2020 2020 2020 2020  er = {.         
-000162d0: 2020 2028 6e61 6d65 2c20 3029 3a20 280a     (name, 0): (.
-000162e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162f0: 6d65 7468 6f64 732e 7661 725f 6d69 7865  methods.var_mixe
-00016300: 645f 636f 6e63 6174 2c0a 2020 2020 2020  d_concat,.      
-00016310: 2020 2020 2020 2020 2020 286e 756d 6572            (numer
-00016320: 6963 5f76 6172 732e 5f6e 616d 652c 2030  ic_vars._name, 0
-00016330: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00016340: 2020 2028 7469 6d65 6465 6c74 615f 7661     (timedelta_va
-00016350: 7273 2e5f 6e61 6d65 2c20 3029 2c0a 2020  rs._name, 0),.  
-00016360: 2020 2020 2020 2020 2020 2020 2020 6461                da
-00016370: 7461 2e5f 6d65 7461 2e63 6f6c 756d 6e73  ta._meta.columns
-00016380: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00016390: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
-000163a0: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-000163b0: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-000163c0: 6f6c 6c65 6374 696f 6e73 280a 2020 2020  ollections(.    
-000163d0: 2020 2020 2020 2020 6e61 6d65 2c20 6c61          name, la
-000163e0: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
-000163f0: 733d 5b6e 756d 6572 6963 5f76 6172 732c  s=[numeric_vars,
-00016400: 2074 696d 6564 656c 7461 5f76 6172 735d   timedelta_vars]
-00016410: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00016420: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
-00016430: 5f6f 626a 6563 7428 0a20 2020 2020 2020  _object(.       
-00016440: 2020 2020 2067 7261 7068 2c20 6e61 6d65       graph, name
-00016450: 2c20 7365 6c66 2e5f 6d65 7461 5f6e 6f6e  , self._meta_non
-00016460: 656d 7074 792e 7661 7228 292c 2064 6976  empty.var(), div
-00016470: 6973 696f 6e73 3d5b 4e6f 6e65 2c20 4e6f  isions=[None, No
-00016480: 6e65 5d0a 2020 2020 2020 2020 290a 0a20  ne].        ).. 
-00016490: 2020 2064 6566 205f 7661 725f 3164 2873     def _var_1d(s
-000164a0: 656c 662c 2063 6f6c 756d 6e2c 2073 6b69  elf, column, ski
-000164b0: 706e 613d 5472 7565 2c20 6464 6f66 3d31  pna=True, ddof=1
-000164c0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
-000164d0: 6c73 6529 3a0a 2020 2020 2020 2020 6973  lse):.        is
-000164e0: 5f74 696d 6564 656c 7461 203d 2069 735f  _timedelta = is_
-000164f0: 7469 6d65 6465 6c74 6136 345f 6474 7970  timedelta64_dtyp
-00016500: 6528 636f 6c75 6d6e 2e5f 6d65 7461 290a  e(column._meta).
-00016510: 0a20 2020 2020 2020 2069 6620 6973 5f74  .        if is_t
-00016520: 696d 6564 656c 7461 3a0a 2020 2020 2020  imedelta:.      
-00016530: 2020 2020 2020 6966 206e 6f74 2073 6b69        if not ski
-00016540: 706e 613a 0a20 2020 2020 2020 2020 2020  pna:.           
-00016550: 2020 2020 2069 735f 6e61 6e20 3d20 636f       is_nan = co
-00016560: 6c75 6d6e 2e69 736e 6128 290a 2020 2020  lumn.isna().    
-00016570: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-00016580: 6d6e 203d 2063 6f6c 756d 6e2e 6173 7479  mn = column.asty
-00016590: 7065 2822 6938 2229 0a20 2020 2020 2020  pe("i8").       
-000165a0: 2020 2020 2020 2020 2063 6f6c 756d 6e20           column 
-000165b0: 3d20 636f 6c75 6d6e 2e6d 6173 6b28 6973  = column.mask(is
-000165c0: 5f6e 616e 290a 2020 2020 2020 2020 2020  _nan).          
-000165d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000165e0: 2020 2020 2020 2020 636f 6c75 6d6e 203d          column =
-000165f0: 2063 6f6c 756d 6e2e 6472 6f70 6e61 2829   column.dropna()
-00016600: 2e61 7374 7970 6528 2269 3822 290a 0a20  .astype("i8").. 
-00016610: 2020 2020 2020 2069 6620 7064 2e49 6e74         if pd.Int
-00016620: 3634 4474 7970 652e 6973 5f64 7479 7065  64Dtype.is_dtype
-00016630: 2863 6f6c 756d 6e2e 5f6d 6574 615f 6e6f  (column._meta_no
-00016640: 6e65 6d70 7479 293a 0a20 2020 2020 2020  nempty):.       
-00016650: 2020 2020 2063 6f6c 756d 6e20 3d20 636f       column = co
-00016660: 6c75 6d6e 2e61 7374 7970 6528 2266 3822  lumn.astype("f8"
-00016670: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-00016680: 7420 6e70 2e69 7373 7562 6474 7970 6528  t np.issubdtype(
-00016690: 636f 6c75 6d6e 2e64 7479 7065 2c20 6e70  column.dtype, np
-000166a0: 2e6e 756d 6265 7229 3a0a 2020 2020 2020  .number):.      
-000166b0: 2020 2020 2020 636f 6c75 6d6e 203d 2063        column = c
-000166c0: 6f6c 756d 6e2e 6173 7479 7065 2822 6638  olumn.astype("f8
-000166d0: 2229 0a0a 2020 2020 2020 2020 6e61 6d65  ")..        name
-000166e0: 203d 2073 656c 662e 5f74 6f6b 656e 5f70   = self._token_p
-000166f0: 7265 6669 7820 2b20 2276 6172 2d31 642d  refix + "var-1d-
-00016700: 2220 2b20 746f 6b65 6e69 7a65 2863 6f6c  " + tokenize(col
-00016710: 756d 6e2c 2073 706c 6974 5f65 7665 7279  umn, split_every
-00016720: 290a 0a20 2020 2020 2020 2076 6172 203d  )..        var =
-00016730: 2064 612e 6e61 6e76 6172 2069 6620 736b   da.nanvar if sk
-00016740: 6970 6e61 206f 7220 736b 6970 6e61 2069  ipna or skipna i
-00016750: 7320 4e6f 6e65 2065 6c73 6520 6461 2e76  s None else da.v
-00016760: 6172 0a20 2020 2020 2020 2061 7272 6179  ar.        array
-00016770: 5f76 6172 203d 2076 6172 2863 6f6c 756d  _var = var(colum
-00016780: 6e2e 7661 6c75 6573 2c20 6178 6973 3d30  n.values, axis=0
-00016790: 2c20 6464 6f66 3d64 646f 662c 2073 706c  , ddof=ddof, spl
-000167a0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-000167b0: 7665 7279 290a 0a20 2020 2020 2020 206c  very)..        l
-000167c0: 6179 6572 203d 207b 286e 616d 652c 2030  ayer = {(name, 0
-000167d0: 293a 2028 6d65 7468 6f64 732e 7772 6170  ): (methods.wrap
-000167e0: 5f76 6172 5f72 6564 7563 7469 6f6e 2c20  _var_reduction, 
-000167f0: 2861 7272 6179 5f76 6172 2e5f 6e61 6d65  (array_var._name
-00016800: 2c29 2c20 4e6f 6e65 297d 0a20 2020 2020  ,), None)}.     
-00016810: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-00016820: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-00016830: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-00016840: 206c 6179 6572 2c20 6465 7065 6e64 656e   layer, dependen
-00016850: 6369 6573 3d5b 6172 7261 795f 7661 725d  cies=[array_var]
-00016860: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00016870: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
-00016880: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
-00016890: 7068 2c20 6e61 6d65 2c20 636f 6c75 6d6e  ph, name, column
-000168a0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-000168b0: 7661 7228 292c 2064 6976 6973 696f 6e73  var(), divisions
-000168c0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d0a 2020  =[None, None].  
-000168d0: 2020 2020 2020 290a 0a20 2020 2040 5f6e        )..    @_n
-000168e0: 756d 6572 6963 5f64 6174 610a 2020 2020  umeric_data.    
-000168f0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00016900: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-00016910: 6465 6620 7374 6428 0a20 2020 2020 2020  def std(.       
-00016920: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-00016930: 7869 733d 4e6f 6e65 2c0a 2020 2020 2020  xis=None,.      
-00016940: 2020 736b 6970 6e61 3d54 7275 652c 0a20    skipna=True,. 
-00016950: 2020 2020 2020 2064 646f 663d 312c 0a20         ddof=1,. 
-00016960: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-00016970: 7279 3d46 616c 7365 2c0a 2020 2020 2020  ry=False,.      
-00016980: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
-00016990: 2020 2020 2020 6f75 743d 4e6f 6e65 2c0a        out=None,.
-000169a0: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
-000169b0: 6f6e 6c79 3d6e 6f5f 6465 6661 756c 742c  only=no_default,
-000169c0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-000169d0: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
-000169e0: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
-000169f0: 0a20 2020 2020 2020 205f 7261 6973 655f  .        _raise_
-00016a00: 6966 5f6f 626a 6563 745f 7365 7269 6573  if_object_series
-00016a10: 2873 656c 662c 2022 7374 6422 290a 2020  (self, "std").  
-00016a20: 2020 2020 2020 5f72 6169 7365 5f69 665f        _raise_if_
-00016a30: 6e6f 745f 7365 7269 6573 5f6f 725f 6461  not_series_or_da
-00016a40: 7461 6672 616d 6528 7365 6c66 2c20 2273  taframe(self, "s
-00016a50: 7464 2229 0a20 2020 2020 2020 206e 756d  td").        num
-00016a60: 6572 6963 5f6b 7761 7267 7320 3d20 5f6e  eric_kwargs = _n
-00016a70: 756d 6572 6963 5f6f 6e6c 795f 6d61 7962  umeric_only_mayb
-00016a80: 655f 7761 726e 2873 656c 662c 206e 756d  e_warn(self, num
-00016a90: 6572 6963 5f6f 6e6c 7929 0a0a 2020 2020  eric_only)..    
-00016aa0: 2020 2020 7769 7468 2063 6865 636b 5f6e      with check_n
-00016ab0: 756d 6572 6963 5f6f 6e6c 795f 6465 7072  umeric_only_depr
-00016ac0: 6563 6174 696f 6e28 292c 2063 6865 636b  ecation(), check
-00016ad0: 5f6e 7569 7361 6e63 655f 636f 6c75 6d6e  _nuisance_column
-00016ae0: 735f 7761 726e 696e 6728 293a 0a20 2020  s_warning():.   
-00016af0: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-00016b00: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-00016b10: 7074 792e 7374 6428 6178 6973 3d61 7869  pty.std(axis=axi
-00016b20: 732c 2073 6b69 706e 613d 736b 6970 6e61  s, skipna=skipna
-00016b30: 2c20 2a2a 6e75 6d65 7269 635f 6b77 6172  , **numeric_kwar
-00016b40: 6773 290a 2020 2020 2020 2020 6973 5f64  gs).        is_d
-00016b50: 665f 6c69 6b65 203d 2069 735f 6461 7461  f_like = is_data
-00016b60: 6672 616d 655f 6c69 6b65 2873 656c 662e  frame_like(self.
-00016b70: 5f6d 6574 6129 0a20 2020 2020 2020 206e  _meta).        n
-00016b80: 6565 6473 5f74 696d 655f 636f 6e76 6572  eeds_time_conver
-00016b90: 7369 6f6e 203d 2046 616c 7365 0a20 2020  sion = False.   
-00016ba0: 2020 2020 206e 756d 6572 6963 5f64 6420       numeric_dd 
-00016bb0: 3d20 7365 6c66 0a0a 2020 2020 2020 2020  = self..        
-00016bc0: 6966 2069 735f 6466 5f6c 696b 653a 0a20  if is_df_like:. 
-00016bd0: 2020 2020 2020 2020 2020 2074 696d 655f             time_
-00016be0: 636f 6c73 203d 2073 656c 662e 5f6d 6574  cols = self._met
-00016bf0: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
-00016c00: 696e 636c 7564 653d 2264 6174 6574 696d  include="datetim
-00016c10: 6522 292e 636f 6c75 6d6e 730a 2020 2020  e").columns.    
-00016c20: 2020 2020 2020 2020 6966 206c 656e 2874          if len(t
-00016c30: 696d 655f 636f 6c73 2920 3e20 303a 0a20  ime_cols) > 0:. 
-00016c40: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-00016c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016c60: 2020 2020 206e 756d 6572 6963 5f64 642c       numeric_dd,
-00016c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016c80: 2020 2020 206e 6565 6473 5f74 696d 655f       needs_time_
-00016c90: 636f 6e76 6572 7369 6f6e 2c0a 2020 2020  conversion,.    
-00016ca0: 2020 2020 2020 2020 2020 2020 2920 3d20              ) = 
-00016cb0: 7365 6c66 2e5f 636f 6e76 6572 745f 7469  self._convert_ti
-00016cc0: 6d65 5f63 6f6c 735f 746f 5f6e 756d 6572  me_cols_to_numer
-00016cd0: 6963 2874 696d 655f 636f 6c73 2c20 6178  ic(time_cols, ax
-00016ce0: 6973 2c20 6d65 7461 2c20 736b 6970 6e61  is, meta, skipna
-00016cf0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00016d00: 2020 2020 2020 2020 2020 2020 6e65 6564              need
-00016d10: 735f 7469 6d65 5f63 6f6e 7665 7273 696f  s_time_conversio
-00016d20: 6e20 3d20 6973 5f64 6174 6574 696d 6536  n = is_datetime6
-00016d30: 345f 616e 795f 6474 7970 6528 7365 6c66  4_any_dtype(self
-00016d40: 2e5f 6d65 7461 290a 2020 2020 2020 2020  ._meta).        
-00016d50: 2020 2020 6966 206e 6565 6473 5f74 696d      if needs_tim
-00016d60: 655f 636f 6e76 6572 7369 6f6e 3a0a 2020  e_conversion:.  
-00016d70: 2020 2020 2020 2020 2020 2020 2020 6e75                nu
-00016d80: 6d65 7269 635f 6464 203d 205f 636f 6e76  meric_dd = _conv
-00016d90: 6572 745f 746f 5f6e 756d 6572 6963 2873  ert_to_numeric(s
-00016da0: 656c 662c 2073 6b69 706e 6129 0a0a 2020  elf, skipna)..  
-00016db0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
-00016dc0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00016dd0: 7265 7375 6c74 203d 206d 6170 5f70 6172  result = map_par
-00016de0: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-00016df0: 2020 2020 2020 2020 204d 2e73 7464 2069           M.std i
-00016e00: 6620 6e6f 7420 6e65 6564 735f 7469 6d65  f not needs_time
-00016e10: 5f63 6f6e 7665 7273 696f 6e20 656c 7365  _conversion else
-00016e20: 205f 7371 7274 5f61 6e64 5f63 6f6e 7665   _sqrt_and_conve
-00016e30: 7274 5f74 6f5f 7469 6d65 6465 6c74 612c  rt_to_timedelta,
-00016e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016e50: 206e 756d 6572 6963 5f64 642c 0a20 2020   numeric_dd,.   
-00016e60: 2020 2020 2020 2020 2020 2020 206d 6574               met
-00016e70: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
-00016e80: 2020 2020 2020 2020 746f 6b65 6e3d 7365          token=se
-00016e90: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
-00016ea0: 202b 2022 7374 6422 2c0a 2020 2020 2020   + "std",.      
-00016eb0: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
-00016ec0: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
-00016ed0: 2020 2020 2073 6b69 706e 613d 736b 6970       skipna=skip
-00016ee0: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
-00016ef0: 2020 2020 6464 6f66 3d64 646f 662c 0a20      ddof=ddof,. 
-00016f00: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00016f10: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-00016f20: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00016f30: 2020 2020 2020 202a 2a6e 756d 6572 6963         **numeric
-00016f40: 5f6b 7761 7267 732c 0a20 2020 2020 2020  _kwargs,.       
-00016f50: 2020 2020 2020 2020 2070 6172 656e 745f           parent_
-00016f60: 6d65 7461 3d73 656c 662e 5f6d 6574 612c  meta=self._meta,
-00016f70: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00016f80: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00016f90: 6e20 6861 6e64 6c65 5f6f 7574 286f 7574  n handle_out(out
-00016fa0: 2c20 7265 7375 6c74 290a 0a20 2020 2020  , result)..     
-00016fb0: 2020 2023 2043 6173 6520 7768 6572 6520     # Case where 
-00016fc0: 6178 6973 3d30 206f 7220 6178 6973 3d4e  axis=0 or axis=N
-00016fd0: 6f6e 650a 2020 2020 2020 2020 7620 3d20  one.        v = 
-00016fe0: 6e75 6d65 7269 635f 6464 2e76 6172 2873  numeric_dd.var(s
-00016ff0: 6b69 706e 613d 736b 6970 6e61 2c20 6464  kipna=skipna, dd
-00017000: 6f66 3d64 646f 662c 2073 706c 6974 5f65  of=ddof, split_e
-00017010: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00017020: 290a 2020 2020 2020 2020 6e61 6d65 203d  ).        name =
-00017030: 2073 656c 662e 5f74 6f6b 656e 5f70 7265   self._token_pre
-00017040: 6669 7820 2b20 2273 7464 220a 0a20 2020  fix + "std"..   
-00017050: 2020 2020 2069 6620 6e65 6564 735f 7469       if needs_ti
-00017060: 6d65 5f63 6f6e 7665 7273 696f 6e3a 0a20  me_conversion:. 
-00017070: 2020 2020 2020 2020 2020 2073 7172 745f             sqrt_
-00017080: 6675 6e63 5f6b 7761 7267 7320 3d20 7b0a  func_kwargs = {.
-00017090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000170a0: 2269 735f 6466 5f6c 696b 6522 3a20 6973  "is_df_like": is
-000170b0: 5f64 665f 6c69 6b65 2c0a 2020 2020 2020  _df_like,.      
-000170c0: 2020 2020 2020 2020 2020 2274 696d 655f            "time_
-000170d0: 636f 6c73 223a 2074 696d 655f 636f 6c73  cols": time_cols
-000170e0: 2069 6620 6973 5f64 665f 6c69 6b65 2065   if is_df_like e
-000170f0: 6c73 6520 4e6f 6e65 2c0a 2020 2020 2020  lse None,.      
-00017100: 2020 2020 2020 2020 2020 2261 7869 7322            "axis"
-00017110: 3a20 6178 6973 2c0a 2020 2020 2020 2020  : axis,.        
-00017120: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-00017130: 2020 7371 7274 5f66 756e 6320 3d20 5f73    sqrt_func = _s
-00017140: 7172 745f 616e 645f 636f 6e76 6572 745f  qrt_and_convert_
-00017150: 746f 5f74 696d 6564 656c 7461 0a20 2020  to_timedelta.   
-00017160: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00017170: 2020 2020 2020 2073 7172 745f 6675 6e63         sqrt_func
-00017180: 5f6b 7761 7267 7320 3d20 7b7d 0a20 2020  _kwargs = {}.   
-00017190: 2020 2020 2020 2020 2073 7172 745f 6675           sqrt_fu
-000171a0: 6e63 203d 206e 702e 7371 7274 0a0a 2020  nc = np.sqrt..  
-000171b0: 2020 2020 2020 7265 7375 6c74 203d 206d        result = m
-000171c0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-000171d0: 2020 2020 2020 2020 2020 2073 7172 745f             sqrt_
-000171e0: 6675 6e63 2c0a 2020 2020 2020 2020 2020  func,.          
-000171f0: 2020 762c 0a20 2020 2020 2020 2020 2020    v,.           
-00017200: 206d 6574 613d 6d65 7461 2c0a 2020 2020   meta=meta,.    
-00017210: 2020 2020 2020 2020 746f 6b65 6e3d 6e61          token=na
-00017220: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00017230: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-00017240: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00017250: 2020 2020 7061 7265 6e74 5f6d 6574 613d      parent_meta=
-00017260: 7365 6c66 2e5f 6d65 7461 2c0a 2020 2020  self._meta,.    
-00017270: 2020 2020 2020 2020 2a2a 7371 7274 5f66          **sqrt_f
-00017280: 756e 635f 6b77 6172 6773 2c0a 2020 2020  unc_kwargs,.    
-00017290: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
-000172a0: 2054 7279 2074 6f20 6d61 7463 6820 7468   Try to match th
-000172b0: 6520 5061 6e64 6173 2072 6573 756c 7420  e Pandas result 
-000172c0: 6474 7970 650a 2020 2020 2020 2020 6966  dtype.        if
-000172d0: 2069 735f 6466 5f6c 696b 6520 616e 6420   is_df_like and 
-000172e0: 6861 7361 7474 7228 6d65 7461 2c20 2264  hasattr(meta, "d
-000172f0: 7479 7065 2229 3a0a 2020 2020 2020 2020  type"):.        
-00017300: 2020 2020 7265 7375 6c74 203d 2072 6573      result = res
-00017310: 756c 742e 6173 7479 7065 286d 6574 612e  ult.astype(meta.
-00017320: 6474 7970 6529 0a0a 2020 2020 2020 2020  dtype)..        
-00017330: 7265 7475 726e 2068 616e 646c 655f 6f75  return handle_ou
-00017340: 7428 6f75 742c 2072 6573 756c 7429 0a0a  t(out, result)..
-00017350: 2020 2020 6465 6620 5f63 6f6e 7665 7274      def _convert
-00017360: 5f74 696d 655f 636f 6c73 5f74 6f5f 6e75  _time_cols_to_nu
-00017370: 6d65 7269 6328 7365 6c66 2c20 7469 6d65  meric(self, time
-00017380: 5f63 6f6c 732c 2061 7869 732c 206d 6574  _cols, axis, met
-00017390: 612c 2073 6b69 706e 6129 3a0a 2020 2020  a, skipna):.    
-000173a0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-000173b0: 7461 6672 616d 652e 696f 2069 6d70 6f72  taframe.io impor
-000173c0: 7420 6672 6f6d 5f70 616e 6461 730a 0a20  t from_pandas.. 
-000173d0: 2020 2020 2020 206e 6565 6473 5f74 696d         needs_tim
-000173e0: 655f 636f 6e76 6572 7369 6f6e 203d 2054  e_conversion = T
-000173f0: 7275 650a 0a20 2020 2020 2020 2023 2045  rue..        # E
-00017400: 6e73 7572 6520 616c 6c20 636f 6c75 6d6e  nsure all column
-00017410: 7320 6172 6520 636f 7272 6563 7420 7479  s are correct ty
-00017420: 7065 2e20 4e65 6564 2074 6f20 7368 616c  pe. Need to shal
-00017430: 6c6f 7720 636f 7079 2073 696e 6365 2063  low copy since c
-00017440: 6f6c 7320 7769 6c6c 2062 6520 6d6f 6469  ols will be modi
-00017450: 6669 6564 0a20 2020 2020 2020 2069 6620  fied.        if 
-00017460: 6178 6973 203d 3d20 303a 0a20 2020 2020  axis == 0:.     
-00017470: 2020 2020 2020 206e 756d 6572 6963 5f64         numeric_d
-00017480: 6420 3d20 7365 6c66 5b6d 6574 612e 696e  d = self[meta.in
-00017490: 6465 785d 2e63 6f70 7928 290a 2020 2020  dex].copy().    
-000174a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000174b0: 2020 2020 2020 6e75 6d65 7269 635f 6464        numeric_dd
-000174c0: 203d 2073 656c 662e 636f 7079 2829 0a0a   = self.copy()..
-000174d0: 2020 2020 2020 2020 2320 4d69 7820 6f66          # Mix of
-000174e0: 2064 6174 6574 696d 6573 2077 6974 6820   datetimes with 
-000174f0: 6f74 6865 7220 6e75 6d65 7269 6320 7479  other numeric ty
-00017500: 7065 7320 7072 6f64 7563 6573 204e 614e  pes produces NaN
-00017510: 7320 666f 7220 6561 6368 2076 616c 7565  s for each value
-00017520: 2069 6e20 7374 6428 2920 7365 7269 6573   in std() series
-00017530: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-00017540: 203d 3d20 3120 616e 6420 6c65 6e28 7469   == 1 and len(ti
-00017550: 6d65 5f63 6f6c 7329 2021 3d20 6c65 6e28  me_cols) != len(
-00017560: 7365 6c66 2e63 6f6c 756d 6e73 293a 0a20  self.columns):. 
-00017570: 2020 2020 2020 2020 2020 2023 2054 6869             # Thi
-00017580: 7320 6973 2066 6173 7465 7220 7468 616e  s is faster than
-00017590: 2063 6f6e 7665 7274 696e 6720 6561 6368   converting each
-000175a0: 2063 6f6c 756d 6e20 746f 206e 756d 6572   column to numer
-000175b0: 6963 2077 6865 6e20 6974 2773 206e 6f74  ic when it's not
-000175c0: 206e 6563 6573 7361 7279 0a20 2020 2020   necessary.     
-000175d0: 2020 2020 2020 2023 2073 696e 6365 2065         # since e
-000175e0: 6163 6820 7374 616e 6461 7264 2064 6576  ach standard dev
-000175f0: 6961 7469 6f6e 2077 696c 6c20 6a75 7374  iation will just
-00017600: 2062 6520 4e61 4e0a 2020 2020 2020 2020   be NaN.        
-00017610: 2020 2020 6e65 6564 735f 7469 6d65 5f63      needs_time_c
-00017620: 6f6e 7665 7273 696f 6e20 3d20 4661 6c73  onversion = Fals
-00017630: 650a 2020 2020 2020 2020 2020 2020 6e75  e.            nu
-00017640: 6d65 7269 635f 6464 203d 2066 726f 6d5f  meric_dd = from_
-00017650: 7061 6e64 6173 280a 2020 2020 2020 2020  pandas(.        
-00017660: 2020 2020 2020 2020 6d65 7461 5f66 7261          meta_fra
-00017670: 6d65 5f63 6f6e 7374 7275 6374 6f72 2873  me_constructor(s
-00017680: 656c 6629 280a 2020 2020 2020 2020 2020  elf)(.          
-00017690: 2020 2020 2020 2020 2020 7b22 5f22 3a20            {"_": 
-000176a0: 6d65 7461 5f73 6572 6965 735f 636f 6e73  meta_series_cons
-000176b0: 7472 7563 746f 7228 7365 6c66 2928 5b6e  tructor(self)([n
-000176c0: 702e 6e61 6e5d 297d 2c0a 2020 2020 2020  p.nan])},.      
-000176d0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000176e0: 6465 783d 7365 6c66 2e69 6e64 6578 2c0a  dex=self.index,.
-000176f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017700: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00017710: 2020 206e 7061 7274 6974 696f 6e73 3d73     npartitions=s
-00017720: 656c 662e 6e70 6172 7469 7469 6f6e 732c  elf.npartitions,
-00017730: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00017740: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00017750: 2020 2020 2020 2020 2023 2043 6f6e 7665           # Conve
-00017760: 7274 2074 696d 6564 656c 7461 2061 6e64  rt timedelta and
-00017770: 2064 6174 6574 696d 6520 636f 6c75 6d6e   datetime column
-00017780: 7320 746f 2069 6e74 6567 6572 2074 7970  s to integer typ
-00017790: 6573 2073 6f20 7765 2063 616e 2075 7365  es so we can use
-000177a0: 2076 6172 0a20 2020 2020 2020 2020 2020   var.           
-000177b0: 2066 6f72 2063 6f6c 2069 6e20 7469 6d65   for col in time
-000177c0: 5f63 6f6c 733a 0a20 2020 2020 2020 2020  _cols:.         
-000177d0: 2020 2020 2020 206e 756d 6572 6963 5f64         numeric_d
-000177e0: 645b 636f 6c5d 203d 205f 636f 6e76 6572  d[col] = _conver
-000177f0: 745f 746f 5f6e 756d 6572 6963 286e 756d  t_to_numeric(num
-00017800: 6572 6963 5f64 645b 636f 6c5d 2c20 736b  eric_dd[col], sk
-00017810: 6970 6e61 290a 0a20 2020 2020 2020 2072  ipna)..        r
-00017820: 6574 7572 6e20 6e75 6d65 7269 635f 6464  eturn numeric_dd
-00017830: 2c20 6e65 6564 735f 7469 6d65 5f63 6f6e  , needs_time_con
-00017840: 7665 7273 696f 6e0a 0a20 2020 2040 5f6e  version..    @_n
-00017850: 756d 6572 6963 5f6f 6e6c 790a 2020 2020  umeric_only.    
-00017860: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00017870: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-00017880: 6465 6620 736b 6577 280a 2020 2020 2020  def skew(.      
-00017890: 2020 7365 6c66 2c20 6178 6973 3d30 2c20    self, axis=0, 
-000178a0: 6269 6173 3d54 7275 652c 206e 616e 5f70  bias=True, nan_p
-000178b0: 6f6c 6963 793d 2270 726f 7061 6761 7465  olicy="propagate
-000178c0: 222c 206f 7574 3d4e 6f6e 652c 206e 756d  ", out=None, num
-000178d0: 6572 6963 5f6f 6e6c 793d 4e6f 6e65 0a20  eric_only=None. 
-000178e0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-000178f0: 220a 2020 2020 2020 2020 2e2e 206e 6f74  ".        .. not
-00017900: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
-00017910: 5468 6973 2069 6d70 6c65 6d65 6e74 6174  This implementat
-00017920: 696f 6e20 666f 6c6c 6f77 7320 7468 6520  ion follows the 
-00017930: 6461 736b 2e61 7272 6179 2e73 7461 7473  dask.array.stats
-00017940: 2069 6d70 6c65 6d65 6e74 6174 696f 6e0a   implementation.
-00017950: 2020 2020 2020 2020 2020 206f 6620 736b             of sk
-00017960: 6577 6e65 7373 2061 6e64 2063 616c 6375  ewness and calcu
-00017970: 6c61 7465 7320 736b 6577 6e65 7373 2077  lates skewness w
-00017980: 6974 686f 7574 2074 616b 696e 6720 696e  ithout taking in
-00017990: 746f 2061 6363 6f75 6e74 0a20 2020 2020  to account.     
-000179a0: 2020 2020 2020 6120 6269 6173 2074 6572        a bias ter
-000179b0: 6d20 666f 7220 6669 6e69 7465 2073 616d  m for finite sam
-000179c0: 706c 6520 7369 7a65 2c20 7768 6963 6820  ple size, which 
-000179d0: 636f 7272 6573 706f 6e64 7320 746f 2074  corresponds to t
-000179e0: 6865 0a20 2020 2020 2020 2020 2020 6465  he.           de
-000179f0: 6661 756c 7420 7365 7474 696e 6773 206f  fault settings o
-00017a00: 6620 7468 6520 7363 6970 792e 7374 6174  f the scipy.stat
-00017a10: 7320 736b 6577 6e65 7373 2063 616c 6375  s skewness calcu
-00017a20: 6c61 7469 6f6e 2e20 486f 7765 7665 722c  lation. However,
-00017a30: 0a20 2020 2020 2020 2020 2020 5061 6e64  .           Pand
-00017a40: 6173 2063 6f72 7265 6374 7320 666f 7220  as corrects for 
-00017a50: 7468 6973 2c20 736f 2074 6865 2076 616c  this, so the val
-00017a60: 7565 7320 6469 6666 6572 2062 7920 6120  ues differ by a 
-00017a70: 6661 6374 6f72 206f 660a 2020 2020 2020  factor of.      
-00017a80: 2020 2020 2028 6e20 2a20 286e 202d 2031       (n * (n - 1
-00017a90: 2929 202a 2a20 302e 3520 2f20 286e 202d  )) ** 0.5 / (n -
-00017aa0: 2032 292c 2077 6865 7265 206e 2069 7320   2), where n is 
-00017ab0: 7468 6520 6e75 6d62 6572 206f 6620 7361  the number of sa
-00017ac0: 6d70 6c65 732e 0a0a 2020 2020 2020 2020  mples...        
-00017ad0: 2020 2046 7572 7468 6572 2c20 7468 6973     Further, this
-00017ae0: 206d 6574 686f 6420 6375 7272 656e 746c   method currentl
-00017af0: 7920 646f 6573 206e 6f74 2073 7570 706f  y does not suppo
-00017b00: 7274 2066 696c 7465 7269 6e67 206f 7574  rt filtering out
-00017b10: 204e 614e 0a20 2020 2020 2020 2020 2020   NaN.           
-00017b20: 7661 6c75 6573 2c20 7768 6963 6820 6973  values, which is
-00017b30: 2061 6761 696e 2061 2064 6966 6665 7265   again a differe
-00017b40: 6e63 6520 746f 2050 616e 6461 732e 0a20  nce to Pandas.. 
-00017b50: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00017b60: 2020 2069 6620 5041 4e44 4153 5f47 545f     if PANDAS_GT_
-00017b70: 3230 3020 616e 6420 6178 6973 2069 7320  200 and axis is 
-00017b80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00017b90: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00017ba0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00017bb0: 2020 2020 2260 6178 6973 3d4e 6f6e 6560      "`axis=None`
-00017bc0: 2069 736e 2774 2063 7572 7265 6e74 6c79   isn't currently
-00017bd0: 2073 7570 706f 7274 6564 2066 6f72 2060   supported for `
-00017be0: 736b 6577 6020 7768 656e 2075 7369 6e67  skew` when using
-00017bf0: 2060 7061 6e64 6173 203e 3d32 6020 220a   `pandas >=2` ".
-00017c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c10: 6622 2870 616e 6461 733d 7b73 7472 2850  f"(pandas={str(P
-00017c20: 414e 4441 535f 5645 5253 494f 4e29 7d20  ANDAS_VERSION)} 
-00017c30: 6973 2069 6e73 7461 6c6c 6564 292e 220a  is installed).".
-00017c40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00017c50: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
-00017c60: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-00017c70: 2861 7869 7329 0a20 2020 2020 2020 205f  (axis).        _
-00017c80: 7261 6973 655f 6966 5f6f 626a 6563 745f  raise_if_object_
-00017c90: 7365 7269 6573 2873 656c 662c 2022 736b  series(self, "sk
-00017ca0: 6577 2229 0a20 2020 2020 2020 206d 6574  ew").        met
-00017cb0: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
-00017cc0: 6f6e 656d 7074 792e 736b 6577 2829 0a20  onempty.skew(). 
-00017cd0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-00017ce0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00017cf0: 2072 6573 756c 7420 3d20 6d61 705f 7061   result = map_pa
-00017d00: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-00017d10: 2020 2020 2020 2020 2020 4d2e 736b 6577            M.skew
-00017d20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00017d30: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00017d40: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
-00017d50: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-00017d60: 2020 2074 6f6b 656e 3d73 656c 662e 5f74     token=self._t
-00017d70: 6f6b 656e 5f70 7265 6669 7820 2b20 2273  oken_prefix + "s
-00017d80: 6b65 7722 2c0a 2020 2020 2020 2020 2020  kew",.          
-00017d90: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
-00017da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017db0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-00017dc0: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
-00017dd0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00017de0: 2020 2072 6574 7572 6e20 6861 6e64 6c65     return handle
-00017df0: 5f6f 7574 286f 7574 2c20 7265 7375 6c74  _out(out, result
-00017e00: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00017e10: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00017e20: 656c 662e 6e64 696d 203d 3d20 313a 0a20  elf.ndim == 1:. 
-00017e30: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00017e40: 6573 756c 7420 3d20 7365 6c66 2e5f 736b  esult = self._sk
-00017e50: 6577 5f31 6428 7365 6c66 2c20 6269 6173  ew_1d(self, bias
-00017e60: 3d62 6961 732c 206e 616e 5f70 6f6c 6963  =bias, nan_polic
-00017e70: 793d 6e61 6e5f 706f 6c69 6379 290a 2020  y=nan_policy).  
-00017e80: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00017e90: 7475 726e 2068 616e 646c 655f 6f75 7428  turn handle_out(
-00017ea0: 6f75 742c 2072 6573 756c 7429 0a20 2020  out, result).   
-00017eb0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00017ec0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00017ed0: 6573 756c 7420 3d20 7365 6c66 2e5f 736b  esult = self._sk
-00017ee0: 6577 5f6e 756d 6572 6963 2862 6961 733d  ew_numeric(bias=
-00017ef0: 6269 6173 2c20 6e61 6e5f 706f 6c69 6379  bias, nan_policy
-00017f00: 3d6e 616e 5f70 6f6c 6963 7929 0a0a 2020  =nan_policy)..  
-00017f10: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00017f20: 6e73 7461 6e63 6528 7365 6c66 2c20 4461  nstance(self, Da
-00017f30: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
-00017f40: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00017f50: 2e64 6976 6973 696f 6e73 203d 2028 7365  .divisions = (se
-00017f60: 6c66 2e63 6f6c 756d 6e73 2e6d 696e 2829  lf.columns.min()
-00017f70: 2c20 7365 6c66 2e63 6f6c 756d 6e73 2e6d  , self.columns.m
-00017f80: 6178 2829 290a 0a20 2020 2020 2020 2020  ax())..         
-00017f90: 2020 2072 6574 7572 6e20 6861 6e64 6c65     return handle
-00017fa0: 5f6f 7574 286f 7574 2c20 7265 7375 6c74  _out(out, result
-00017fb0: 290a 0a20 2020 2064 6566 205f 736b 6577  )..    def _skew
-00017fc0: 5f31 6428 7365 6c66 2c20 636f 6c75 6d6e  _1d(self, column
-00017fd0: 2c20 6269 6173 3d54 7275 652c 206e 616e  , bias=True, nan
-00017fe0: 5f70 6f6c 6963 793d 2270 726f 7061 6761  _policy="propaga
-00017ff0: 7465 2229 3a0a 2020 2020 2020 2020 2222  te"):.        ""
-00018000: 2231 4420 7665 7273 696f 6e20 6f66 2074  "1D version of t
-00018010: 6865 2073 6b65 7720 6361 6c63 756c 6174  he skew calculat
-00018020: 696f 6e2e 0a0a 2020 2020 2020 2020 5573  ion...        Us
-00018030: 6573 2074 6865 2061 7272 6179 2076 6572  es the array ver
-00018040: 7369 6f6e 2066 726f 6d20 6461 2e73 7461  sion from da.sta
-00018050: 7473 2069 6e20 6361 7365 2077 6520 6172  ts in case we ar
-00018060: 6520 7061 7373 696e 6720 696e 2061 2073  e passing in a s
-00018070: 696e 676c 6520 7365 7269 6573 0a20 2020  ingle series.   
-00018080: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00018090: 2023 2069 6d70 6f72 7420 6465 7065 6e64   # import depend
-000180a0: 7320 6f6e 2073 6369 7079 2c20 6e6f 7420  s on scipy, not 
-000180b0: 696e 7374 616c 6c65 6420 6279 2064 6566  installed by def
-000180c0: 6175 6c74 0a20 2020 2020 2020 2066 726f  ault.        fro
-000180d0: 6d20 6461 736b 2e61 7272 6179 2069 6d70  m dask.array imp
-000180e0: 6f72 7420 7374 6174 7320 6173 2064 615f  ort stats as da_
-000180f0: 7374 6174 730a 0a20 2020 2020 2020 2069  stats..        i
-00018100: 6620 7064 2e49 6e74 3634 4474 7970 652e  f pd.Int64Dtype.
-00018110: 6973 5f64 7479 7065 2863 6f6c 756d 6e2e  is_dtype(column.
-00018120: 5f6d 6574 615f 6e6f 6e65 6d70 7479 293a  _meta_nonempty):
-00018130: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00018140: 756d 6e20 3d20 636f 6c75 6d6e 2e61 7374  umn = column.ast
-00018150: 7970 6528 2266 3822 290a 0a20 2020 2020  ype("f8")..     
-00018160: 2020 2069 6620 6e6f 7420 6e70 2e69 7373     if not np.iss
-00018170: 7562 6474 7970 6528 636f 6c75 6d6e 2e64  ubdtype(column.d
-00018180: 7479 7065 2c20 6e70 2e6e 756d 6265 7229  type, np.number)
-00018190: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-000181a0: 6c75 6d6e 203d 2063 6f6c 756d 6e2e 6173  lumn = column.as
-000181b0: 7479 7065 2822 6638 2229 0a0a 2020 2020  type("f8")..    
-000181c0: 2020 2020 6e61 6d65 203d 2073 656c 662e      name = self.
-000181d0: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
-000181e0: 2273 6b65 772d 3164 2d22 202b 2074 6f6b  "skew-1d-" + tok
-000181f0: 656e 697a 6528 636f 6c75 6d6e 290a 0a20  enize(column).. 
-00018200: 2020 2020 2020 2061 7272 6179 5f73 6b65         array_ske
-00018210: 7720 3d20 6461 5f73 7461 7473 2e73 6b65  w = da_stats.ske
-00018220: 7728 0a20 2020 2020 2020 2020 2020 2063  w(.            c
-00018230: 6f6c 756d 6e2e 7661 6c75 6573 2c20 6178  olumn.values, ax
-00018240: 6973 3d30 2c20 6269 6173 3d62 6961 732c  is=0, bias=bias,
-00018250: 206e 616e 5f70 6f6c 6963 793d 6e61 6e5f   nan_policy=nan_
-00018260: 706f 6c69 6379 0a20 2020 2020 2020 2029  policy.        )
-00018270: 0a0a 2020 2020 2020 2020 6c61 7965 7220  ..        layer 
-00018280: 3d20 7b28 6e61 6d65 2c20 3029 3a20 286d  = {(name, 0): (m
-00018290: 6574 686f 6473 2e77 7261 705f 736b 6577  ethods.wrap_skew
-000182a0: 5f72 6564 7563 7469 6f6e 2c20 2861 7272  _reduction, (arr
-000182b0: 6179 5f73 6b65 772e 5f6e 616d 652c 292c  ay_skew._name,),
-000182c0: 204e 6f6e 6529 7d0a 2020 2020 2020 2020   None)}.        
-000182d0: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
-000182e0: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
-000182f0: 6563 7469 6f6e 7328 6e61 6d65 2c20 6c61  ections(name, la
-00018300: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
-00018310: 733d 5b61 7272 6179 5f73 6b65 775d 290a  s=[array_skew]).
-00018320: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00018330: 6e65 775f 6464 5f6f 626a 6563 7428 0a20  new_dd_object(. 
-00018340: 2020 2020 2020 2020 2020 2067 7261 7068             graph
-00018350: 2c20 6e61 6d65 2c20 636f 6c75 6d6e 2e5f  , name, column._
-00018360: 6d65 7461 5f6e 6f6e 656d 7074 792e 736b  meta_nonempty.sk
-00018370: 6577 2829 2c20 6469 7669 7369 6f6e 733d  ew(), divisions=
-00018380: 5b4e 6f6e 652c 204e 6f6e 655d 0a20 2020  [None, None].   
-00018390: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-000183a0: 5f73 6b65 775f 6e75 6d65 7269 6328 7365  _skew_numeric(se
-000183b0: 6c66 2c20 6269 6173 3d54 7275 652c 206e  lf, bias=True, n
-000183c0: 616e 5f70 6f6c 6963 793d 2270 726f 7061  an_policy="propa
-000183d0: 6761 7465 2229 3a0a 2020 2020 2020 2020  gate"):.        
-000183e0: 2222 224d 6574 686f 6420 666f 7220 6461  """Method for da
-000183f0: 7461 6672 616d 6573 2077 6974 6820 6e75  taframes with nu
-00018400: 6d65 7269 6320 636f 6c75 6d6e 732e 0a0a  meric columns...
-00018410: 2020 2020 2020 2020 4d61 7073 2074 6865          Maps the
-00018420: 2061 7272 6179 2076 6572 7369 6f6e 2066   array version f
-00018430: 726f 6d20 6461 2e73 7461 7473 206f 6e74  rom da.stats ont
-00018440: 6f20 7468 6520 6e75 6d65 7269 6320 6172  o the numeric ar
-00018450: 7261 7920 6f66 2063 6f6c 756d 6e73 2e0a  ray of columns..
-00018460: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00018470: 2020 2020 2320 696d 706f 7274 2064 6570      # import dep
-00018480: 656e 6473 206f 6e20 7363 6970 792c 206e  ends on scipy, n
-00018490: 6f74 2069 6e73 7461 6c6c 6564 2062 7920  ot installed by 
-000184a0: 6465 6661 756c 740a 2020 2020 2020 2020  default.        
-000184b0: 6672 6f6d 2064 6173 6b2e 6172 7261 7920  from dask.array 
-000184c0: 696d 706f 7274 2073 7461 7473 2061 7320  import stats as 
-000184d0: 6461 5f73 7461 7473 0a0a 2020 2020 2020  da_stats..      
-000184e0: 2020 6e75 6d20 3d20 7365 6c66 2e73 656c    num = self.sel
-000184f0: 6563 745f 6474 7970 6573 2869 6e63 6c75  ect_dtypes(inclu
-00018500: 6465 3d5b 226e 756d 6265 7222 2c20 2262  de=["number", "b
-00018510: 6f6f 6c22 5d2c 2065 7863 6c75 6465 3d5b  ool"], exclude=[
-00018520: 6e70 2e74 696d 6564 656c 7461 3634 5d29  np.timedelta64])
-00018530: 0a0a 2020 2020 2020 2020 7661 6c75 6573  ..        values
-00018540: 5f64 7479 7065 203d 206e 756d 2e76 616c  _dtype = num.val
-00018550: 7565 732e 6474 7970 650a 2020 2020 2020  ues.dtype.      
-00018560: 2020 6172 7261 795f 7661 6c75 6573 203d    array_values =
-00018570: 206e 756d 2e76 616c 7565 730a 0a20 2020   num.values..   
-00018580: 2020 2020 2069 6620 6e6f 7420 6e70 2e69       if not np.i
-00018590: 7373 7562 6474 7970 6528 7661 6c75 6573  ssubdtype(values
-000185a0: 5f64 7479 7065 2c20 6e70 2e6e 756d 6265  _dtype, np.numbe
-000185b0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-000185c0: 6172 7261 795f 7661 6c75 6573 203d 206e  array_values = n
-000185d0: 756d 2e76 616c 7565 732e 6173 7479 7065  um.values.astype
-000185e0: 2822 6638 2229 0a0a 2020 2020 2020 2020  ("f8")..        
-000185f0: 6172 7261 795f 736b 6577 203d 2064 615f  array_skew = da_
-00018600: 7374 6174 732e 736b 6577 280a 2020 2020  stats.skew(.    
-00018610: 2020 2020 2020 2020 6172 7261 795f 7661          array_va
-00018620: 6c75 6573 2c20 6178 6973 3d30 2c20 6269  lues, axis=0, bi
-00018630: 6173 3d62 6961 732c 206e 616e 5f70 6f6c  as=bias, nan_pol
-00018640: 6963 793d 6e61 6e5f 706f 6c69 6379 0a20  icy=nan_policy. 
-00018650: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00018660: 2020 6e61 6d65 203d 2073 656c 662e 5f74    name = self._t
-00018670: 6f6b 656e 5f70 7265 6669 7820 2b20 2276  oken_prefix + "v
-00018680: 6172 2d6e 756d 6572 6963 2220 2b20 746f  ar-numeric" + to
-00018690: 6b65 6e69 7a65 286e 756d 290a 2020 2020  kenize(num).    
-000186a0: 2020 2020 636f 6c73 203d 206e 756d 2e5f      cols = num._
-000186b0: 6d65 7461 2e63 6f6c 756d 6e73 2069 6620  meta.columns if 
-000186c0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-000186d0: 6528 6e75 6d29 2065 6c73 6520 4e6f 6e65  e(num) else None
-000186e0: 0a0a 2020 2020 2020 2020 736b 6577 5f73  ..        skew_s
-000186f0: 6861 7065 203d 206e 756d 2e5f 6d65 7461  hape = num._meta
-00018700: 5f6e 6f6e 656d 7074 792e 7661 6c75 6573  _nonempty.values
-00018710: 2e76 6172 2861 7869 733d 3029 2e73 6861  .var(axis=0).sha
-00018720: 7065 0a20 2020 2020 2020 2061 7272 6179  pe.        array
-00018730: 5f73 6b65 775f 6e61 6d65 203d 2028 6172  _skew_name = (ar
-00018740: 7261 795f 736b 6577 2e5f 6e61 6d65 2c29  ray_skew._name,)
-00018750: 202b 2028 302c 2920 2a20 6c65 6e28 736b   + (0,) * len(sk
-00018760: 6577 5f73 6861 7065 290a 0a20 2020 2020  ew_shape)..     
-00018770: 2020 206c 6179 6572 203d 207b 286e 616d     layer = {(nam
-00018780: 652c 2030 293a 2028 6d65 7468 6f64 732e  e, 0): (methods.
-00018790: 7772 6170 5f73 6b65 775f 7265 6475 6374  wrap_skew_reduct
-000187a0: 696f 6e2c 2061 7272 6179 5f73 6b65 775f  ion, array_skew_
-000187b0: 6e61 6d65 2c20 636f 6c73 297d 0a20 2020  name, cols)}.   
-000187c0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-000187d0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-000187e0: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
-000187f0: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
-00018800: 656e 6369 6573 3d5b 6172 7261 795f 736b  encies=[array_sk
-00018810: 6577 5d29 0a0a 2020 2020 2020 2020 7265  ew])..        re
-00018820: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
-00018830: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
-00018840: 6772 6170 682c 206e 616d 652c 206e 756d  graph, name, num
-00018850: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-00018860: 736b 6577 2829 2c20 6469 7669 7369 6f6e  skew(), division
-00018870: 733d 5b4e 6f6e 652c 204e 6f6e 655d 0a20  s=[None, None]. 
-00018880: 2020 2020 2020 2029 0a0a 2020 2020 405f         )..    @_
-00018890: 6e75 6d65 7269 635f 6f6e 6c79 0a20 2020  numeric_only.   
-000188a0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-000188b0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-000188c0: 2064 6566 206b 7572 746f 7369 7328 0a20   def kurtosis(. 
-000188d0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000188e0: 2020 2020 2061 7869 733d 302c 0a20 2020       axis=0,.   
-000188f0: 2020 2020 2066 6973 6865 723d 5472 7565       fisher=True
-00018900: 2c0a 2020 2020 2020 2020 6269 6173 3d54  ,.        bias=T
-00018910: 7275 652c 0a20 2020 2020 2020 206e 616e  rue,.        nan
-00018920: 5f70 6f6c 6963 793d 2270 726f 7061 6761  _policy="propaga
-00018930: 7465 222c 0a20 2020 2020 2020 206f 7574  te",.        out
-00018940: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
-00018950: 756d 6572 6963 5f6f 6e6c 793d 4e6f 6e65  umeric_only=None
-00018960: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00018970: 2022 2222 0a20 2020 2020 2020 202e 2e20   """.        .. 
-00018980: 6e6f 7465 3a3a 0a0a 2020 2020 2020 2020  note::..        
-00018990: 2020 2054 6869 7320 696d 706c 656d 656e     This implemen
-000189a0: 7461 7469 6f6e 2066 6f6c 6c6f 7773 2074  tation follows t
-000189b0: 6865 2064 6173 6b2e 6172 7261 792e 7374  he dask.array.st
-000189c0: 6174 7320 696d 706c 656d 656e 7461 7469  ats implementati
-000189d0: 6f6e 0a20 2020 2020 2020 2020 2020 6f66  on.           of
-000189e0: 206b 7572 746f 7369 7320 616e 6420 6361   kurtosis and ca
-000189f0: 6c63 756c 6174 6573 206b 7572 746f 7369  lculates kurtosi
-00018a00: 7320 7769 7468 6f75 7420 7461 6b69 6e67  s without taking
-00018a10: 2069 6e74 6f20 6163 636f 756e 740a 2020   into account.  
-00018a20: 2020 2020 2020 2020 2061 2062 6961 7320           a bias 
-00018a30: 7465 726d 2066 6f72 2066 696e 6974 6520  term for finite 
-00018a40: 7361 6d70 6c65 2073 697a 652c 2077 6869  sample size, whi
-00018a50: 6368 2063 6f72 7265 7370 6f6e 6473 2074  ch corresponds t
-00018a60: 6f20 7468 650a 2020 2020 2020 2020 2020  o the.          
-00018a70: 2064 6566 6175 6c74 2073 6574 7469 6e67   default setting
-00018a80: 7320 6f66 2074 6865 2073 6369 7079 2e73  s of the scipy.s
-00018a90: 7461 7473 206b 7572 746f 7369 7320 6361  tats kurtosis ca
-00018aa0: 6c63 756c 6174 696f 6e2e 2054 6869 7320  lculation. This 
-00018ab0: 6469 6666 6572 730a 2020 2020 2020 2020  differs.        
-00018ac0: 2020 2066 726f 6d20 7061 6e64 6173 2e0a     from pandas..
-00018ad0: 0a20 2020 2020 2020 2020 2020 4675 7274  .           Furt
-00018ae0: 6865 722c 2074 6869 7320 6d65 7468 6f64  her, this method
-00018af0: 2063 7572 7265 6e74 6c79 2064 6f65 7320   currently does 
-00018b00: 6e6f 7420 7375 7070 6f72 7420 6669 6c74  not support filt
-00018b10: 6572 696e 6720 6f75 7420 4e61 4e0a 2020  ering out NaN.  
-00018b20: 2020 2020 2020 2020 2076 616c 7565 732c           values,
-00018b30: 2077 6869 6368 2069 7320 6167 6169 6e20   which is again 
-00018b40: 6120 6469 6666 6572 656e 6365 2074 6f20  a difference to 
-00018b50: 5061 6e64 6173 2e0a 2020 2020 2020 2020  Pandas..        
-00018b60: 2222 220a 2020 2020 2020 2020 6966 2050  """.        if P
-00018b70: 414e 4441 535f 4754 5f32 3030 2061 6e64  ANDAS_GT_200 and
-00018b80: 2061 7869 7320 6973 204e 6f6e 653a 0a20   axis is None:. 
-00018b90: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00018ba0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00018bb0: 2020 2020 2020 2020 2020 2020 2022 6061               "`a
-00018bc0: 7869 733d 4e6f 6e65 6020 6973 6e27 7420  xis=None` isn't 
-00018bd0: 6375 7272 656e 746c 7920 7375 7070 6f72  currently suppor
-00018be0: 7465 6420 666f 7220 606b 7572 746f 7369  ted for `kurtosi
-00018bf0: 7360 2077 6865 6e20 7573 696e 6720 6070  s` when using `p
-00018c00: 616e 6461 7320 3e3d 3260 2022 0a20 2020  andas >=2` ".   
-00018c10: 2020 2020 2020 2020 2020 2020 2066 2228               f"(
-00018c20: 7061 6e64 6173 3d7b 7374 7228 5041 4e44  pandas={str(PAND
-00018c30: 4153 5f56 4552 5349 4f4e 297d 2069 7320  AS_VERSION)} is 
-00018c40: 696e 7374 616c 6c65 6429 2e22 0a20 2020  installed).".   
-00018c50: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00018c60: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
-00018c70: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
-00018c80: 6973 290a 2020 2020 2020 2020 5f72 6169  is).        _rai
-00018c90: 7365 5f69 665f 6f62 6a65 6374 5f73 6572  se_if_object_ser
-00018ca0: 6965 7328 7365 6c66 2c20 226b 7572 746f  ies(self, "kurto
-00018cb0: 7369 7322 290a 2020 2020 2020 2020 6d65  sis").        me
-00018cc0: 7461 203d 2073 656c 662e 5f6d 6574 615f  ta = self._meta_
-00018cd0: 6e6f 6e65 6d70 7479 2e6b 7572 746f 7369  nonempty.kurtosi
-00018ce0: 7328 290a 2020 2020 2020 2020 6966 2061  s().        if a
-00018cf0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
-00018d00: 2020 2020 2020 7265 7375 6c74 203d 206d        result = m
-00018d10: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-00018d20: 2020 2020 2020 2020 2020 2020 2020 204d                 M
-00018d30: 2e6b 7572 746f 7369 732c 0a20 2020 2020  .kurtosis,.     
-00018d40: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00018d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018d60: 206d 6574 613d 6d65 7461 2c0a 2020 2020   meta=meta,.    
-00018d70: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-00018d80: 6e3d 7365 6c66 2e5f 746f 6b65 6e5f 7072  n=self._token_pr
-00018d90: 6566 6978 202b 2022 6b75 7274 6f73 6973  efix + "kurtosis
-00018da0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00018db0: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
-00018dc0: 2020 2020 2020 2020 2020 2020 2020 656e                en
-00018dd0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
-00018de0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00018df0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00018e00: 7265 7475 726e 2068 616e 646c 655f 6f75  return handle_ou
-00018e10: 7428 6f75 742c 2072 6573 756c 7429 0a20  t(out, result). 
-00018e20: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00018e30: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00018e40: 2e6e 6469 6d20 3d3d 2031 3a0a 2020 2020  .ndim == 1:.    
-00018e50: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00018e60: 6c74 203d 2073 656c 662e 5f6b 7572 746f  lt = self._kurto
-00018e70: 7369 735f 3164 280a 2020 2020 2020 2020  sis_1d(.        
-00018e80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00018e90: 2c20 6669 7368 6572 3d66 6973 6865 722c  , fisher=fisher,
-00018ea0: 2062 6961 733d 6269 6173 2c20 6e61 6e5f   bias=bias, nan_
-00018eb0: 706f 6c69 6379 3d6e 616e 5f70 6f6c 6963  policy=nan_polic
-00018ec0: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-00018ed0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00018ee0: 2020 2020 7265 7475 726e 2068 616e 646c      return handl
-00018ef0: 655f 6f75 7428 6f75 742c 2072 6573 756c  e_out(out, resul
-00018f00: 7429 0a20 2020 2020 2020 2020 2020 2065  t).            e
-00018f10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00018f20: 2020 2020 2072 6573 756c 7420 3d20 7365       result = se
-00018f30: 6c66 2e5f 6b75 7274 6f73 6973 5f6e 756d  lf._kurtosis_num
-00018f40: 6572 6963 280a 2020 2020 2020 2020 2020  eric(.          
-00018f50: 2020 2020 2020 2020 2020 6669 7368 6572            fisher
-00018f60: 3d66 6973 6865 722c 2062 6961 733d 6269  =fisher, bias=bi
-00018f70: 6173 2c20 6e61 6e5f 706f 6c69 6379 3d6e  as, nan_policy=n
-00018f80: 616e 5f70 6f6c 6963 790a 2020 2020 2020  an_policy.      
-00018f90: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00018fa0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-00018fb0: 7374 616e 6365 2873 656c 662c 2044 6174  stance(self, Dat
-00018fc0: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
-00018fd0: 2020 2020 2020 2020 2072 6573 756c 742e           result.
-00018fe0: 6469 7669 7369 6f6e 7320 3d20 2873 656c  divisions = (sel
-00018ff0: 662e 636f 6c75 6d6e 732e 6d69 6e28 292c  f.columns.min(),
-00019000: 2073 656c 662e 636f 6c75 6d6e 732e 6d61   self.columns.ma
-00019010: 7828 2929 0a0a 2020 2020 2020 2020 2020  x())..          
-00019020: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
-00019030: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
-00019040: 0a0a 2020 2020 6465 6620 5f6b 7572 746f  ..    def _kurto
-00019050: 7369 735f 3164 2873 656c 662c 2063 6f6c  sis_1d(self, col
-00019060: 756d 6e2c 2066 6973 6865 723d 5472 7565  umn, fisher=True
-00019070: 2c20 6269 6173 3d54 7275 652c 206e 616e  , bias=True, nan
-00019080: 5f70 6f6c 6963 793d 2270 726f 7061 6761  _policy="propaga
-00019090: 7465 2229 3a0a 2020 2020 2020 2020 2222  te"):.        ""
-000190a0: 2231 4420 7665 7273 696f 6e20 6f66 2074  "1D version of t
-000190b0: 6865 206b 7572 746f 7369 7320 6361 6c63  he kurtosis calc
-000190c0: 756c 6174 696f 6e2e 0a0a 2020 2020 2020  ulation...      
-000190d0: 2020 5573 6573 2074 6865 2061 7272 6179    Uses the array
-000190e0: 2076 6572 7369 6f6e 2066 726f 6d20 6461   version from da
-000190f0: 2e73 7461 7473 2069 6e20 6361 7365 2077  .stats in case w
-00019100: 6520 6172 6520 7061 7373 696e 6720 696e  e are passing in
-00019110: 2061 2073 696e 676c 6520 7365 7269 6573   a single series
-00019120: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00019130: 2020 2020 2023 2069 6d70 6f72 7420 6465       # import de
-00019140: 7065 6e64 7320 6f6e 2073 6369 7079 2c20  pends on scipy, 
-00019150: 6e6f 7420 696e 7374 616c 6c65 6420 6279  not installed by
-00019160: 2064 6566 6175 6c74 0a20 2020 2020 2020   default.       
-00019170: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
-00019180: 2069 6d70 6f72 7420 7374 6174 7320 6173   import stats as
-00019190: 2064 615f 7374 6174 730a 0a20 2020 2020   da_stats..     
-000191a0: 2020 2069 6620 7064 2e61 7069 2e74 7970     if pd.api.typ
-000191b0: 6573 2e69 735f 696e 7465 6765 725f 6474  es.is_integer_dt
-000191c0: 7970 6528 636f 6c75 6d6e 2e5f 6d65 7461  ype(column._meta
-000191d0: 5f6e 6f6e 656d 7074 7929 3a0a 2020 2020  _nonempty):.    
-000191e0: 2020 2020 2020 2020 636f 6c75 6d6e 203d          column =
-000191f0: 2063 6f6c 756d 6e2e 6173 7479 7065 2822   column.astype("
-00019200: 6638 2229 0a0a 2020 2020 2020 2020 6966  f8")..        if
-00019210: 206e 6f74 206e 702e 6973 7375 6264 7479   not np.issubdty
-00019220: 7065 2863 6f6c 756d 6e2e 6474 7970 652c  pe(column.dtype,
-00019230: 206e 702e 6e75 6d62 6572 293a 0a20 2020   np.number):.   
-00019240: 2020 2020 2020 2020 2063 6f6c 756d 6e20           column 
-00019250: 3d20 636f 6c75 6d6e 2e61 7374 7970 6528  = column.astype(
-00019260: 2266 3822 290a 0a20 2020 2020 2020 206e  "f8")..        n
-00019270: 616d 6520 3d20 7365 6c66 2e5f 746f 6b65  ame = self._toke
-00019280: 6e5f 7072 6566 6978 202b 2022 6b75 7274  n_prefix + "kurt
-00019290: 6f73 6973 2d31 642d 2220 2b20 746f 6b65  osis-1d-" + toke
-000192a0: 6e69 7a65 2863 6f6c 756d 6e29 0a0a 2020  nize(column)..  
-000192b0: 2020 2020 2020 6172 7261 795f 6b75 7274        array_kurt
-000192c0: 6f73 6973 203d 2064 615f 7374 6174 732e  osis = da_stats.
-000192d0: 6b75 7274 6f73 6973 280a 2020 2020 2020  kurtosis(.      
-000192e0: 2020 2020 2020 636f 6c75 6d6e 2e76 616c        column.val
-000192f0: 7565 732c 2061 7869 733d 302c 2066 6973  ues, axis=0, fis
-00019300: 6865 723d 6669 7368 6572 2c20 6269 6173  her=fisher, bias
-00019310: 3d62 6961 732c 206e 616e 5f70 6f6c 6963  =bias, nan_polic
-00019320: 793d 6e61 6e5f 706f 6c69 6379 0a20 2020  y=nan_policy.   
-00019330: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00019340: 6c61 7965 7220 3d20 7b0a 2020 2020 2020  layer = {.      
-00019350: 2020 2020 2020 286e 616d 652c 2030 293a        (name, 0):
-00019360: 2028 6d65 7468 6f64 732e 7772 6170 5f6b   (methods.wrap_k
-00019370: 7572 746f 7369 735f 7265 6475 6374 696f  urtosis_reductio
-00019380: 6e2c 2028 6172 7261 795f 6b75 7274 6f73  n, (array_kurtos
-00019390: 6973 2e5f 6e61 6d65 2c29 2c20 4e6f 6e65  is._name,), None
-000193a0: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
-000193b0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
-000193c0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-000193d0: 636f 6c6c 6563 7469 6f6e 7328 0a20 2020  collections(.   
-000193e0: 2020 2020 2020 2020 206e 616d 652c 206c           name, l
-000193f0: 6179 6572 2c20 6465 7065 6e64 656e 6369  ayer, dependenci
-00019400: 6573 3d5b 6172 7261 795f 6b75 7274 6f73  es=[array_kurtos
-00019410: 6973 5d0a 2020 2020 2020 2020 290a 0a20  is].        ).. 
-00019420: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00019430: 775f 6464 5f6f 626a 6563 7428 0a20 2020  w_dd_object(.   
-00019440: 2020 2020 2020 2020 2067 7261 7068 2c20           graph, 
-00019450: 6e61 6d65 2c20 636f 6c75 6d6e 2e5f 6d65  name, column._me
-00019460: 7461 5f6e 6f6e 656d 7074 792e 6b75 7274  ta_nonempty.kurt
-00019470: 6f73 6973 2829 2c20 6469 7669 7369 6f6e  osis(), division
-00019480: 733d 5b4e 6f6e 652c 204e 6f6e 655d 0a20  s=[None, None]. 
-00019490: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-000194a0: 6620 5f6b 7572 746f 7369 735f 6e75 6d65  f _kurtosis_nume
-000194b0: 7269 6328 7365 6c66 2c20 6669 7368 6572  ric(self, fisher
-000194c0: 3d54 7275 652c 2062 6961 733d 5472 7565  =True, bias=True
-000194d0: 2c20 6e61 6e5f 706f 6c69 6379 3d22 7072  , nan_policy="pr
-000194e0: 6f70 6167 6174 6522 293a 0a20 2020 2020  opagate"):.     
-000194f0: 2020 2022 2222 4d65 7468 6f64 2066 6f72     """Method for
-00019500: 2064 6174 6166 7261 6d65 7320 7769 7468   dataframes with
-00019510: 206e 756d 6572 6963 2063 6f6c 756d 6e73   numeric columns
-00019520: 2e0a 0a20 2020 2020 2020 204d 6170 7320  ...        Maps 
-00019530: 7468 6520 6172 7261 7920 7665 7273 696f  the array versio
-00019540: 6e20 6672 6f6d 2064 612e 7374 6174 7320  n from da.stats 
-00019550: 6f6e 746f 2074 6865 206e 756d 6572 6963  onto the numeric
-00019560: 2061 7272 6179 206f 6620 636f 6c75 6d6e   array of column
-00019570: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-00019580: 2020 2020 2020 2023 2069 6d70 6f72 7420         # import 
-00019590: 6465 7065 6e64 7320 6f6e 2073 6369 7079  depends on scipy
-000195a0: 2c20 6e6f 7420 696e 7374 616c 6c65 6420  , not installed 
-000195b0: 6279 2064 6566 6175 6c74 0a20 2020 2020  by default.     
-000195c0: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
-000195d0: 6179 2069 6d70 6f72 7420 7374 6174 7320  ay import stats 
-000195e0: 6173 2064 615f 7374 6174 730a 0a20 2020  as da_stats..   
-000195f0: 2020 2020 206e 756d 203d 2073 656c 662e       num = self.
-00019600: 7365 6c65 6374 5f64 7479 7065 7328 696e  select_dtypes(in
-00019610: 636c 7564 653d 5b22 6e75 6d62 6572 222c  clude=["number",
-00019620: 2022 626f 6f6c 225d 2c20 6578 636c 7564   "bool"], exclud
-00019630: 653d 5b6e 702e 7469 6d65 6465 6c74 6136  e=[np.timedelta6
-00019640: 345d 290a 0a20 2020 2020 2020 2076 616c  4])..        val
-00019650: 7565 735f 6474 7970 6520 3d20 6e75 6d2e  ues_dtype = num.
-00019660: 7661 6c75 6573 2e64 7479 7065 0a20 2020  values.dtype.   
-00019670: 2020 2020 2061 7272 6179 5f76 616c 7565       array_value
-00019680: 7320 3d20 6e75 6d2e 7661 6c75 6573 0a0a  s = num.values..
-00019690: 2020 2020 2020 2020 6966 206e 6f74 206e          if not n
-000196a0: 702e 6973 7375 6264 7479 7065 2876 616c  p.issubdtype(val
-000196b0: 7565 735f 6474 7970 652c 206e 702e 6e75  ues_dtype, np.nu
-000196c0: 6d62 6572 293a 0a20 2020 2020 2020 2020  mber):.         
-000196d0: 2020 2061 7272 6179 5f76 616c 7565 7320     array_values 
-000196e0: 3d20 6e75 6d2e 7661 6c75 6573 2e61 7374  = num.values.ast
-000196f0: 7970 6528 2266 3822 290a 0a20 2020 2020  ype("f8")..     
-00019700: 2020 2061 7272 6179 5f6b 7572 746f 7369     array_kurtosi
-00019710: 7320 3d20 6461 5f73 7461 7473 2e6b 7572  s = da_stats.kur
-00019720: 746f 7369 7328 0a20 2020 2020 2020 2020  tosis(.         
-00019730: 2020 2061 7272 6179 5f76 616c 7565 732c     array_values,
-00019740: 2061 7869 733d 302c 2066 6973 6865 723d   axis=0, fisher=
-00019750: 6669 7368 6572 2c20 6269 6173 3d62 6961  fisher, bias=bia
-00019760: 732c 206e 616e 5f70 6f6c 6963 793d 6e61  s, nan_policy=na
-00019770: 6e5f 706f 6c69 6379 0a20 2020 2020 2020  n_policy.       
-00019780: 2029 0a0a 2020 2020 2020 2020 6e61 6d65   )..        name
-00019790: 203d 2073 656c 662e 5f74 6f6b 656e 5f70   = self._token_p
-000197a0: 7265 6669 7820 2b20 226b 7572 746f 7369  refix + "kurtosi
-000197b0: 732d 6e75 6d65 7269 6322 202b 2074 6f6b  s-numeric" + tok
-000197c0: 656e 697a 6528 6e75 6d29 0a20 2020 2020  enize(num).     
-000197d0: 2020 2063 6f6c 7320 3d20 6e75 6d2e 5f6d     cols = num._m
-000197e0: 6574 612e 636f 6c75 6d6e 7320 6966 2069  eta.columns if i
-000197f0: 735f 6461 7461 6672 616d 655f 6c69 6b65  s_dataframe_like
-00019800: 286e 756d 2920 656c 7365 204e 6f6e 650a  (num) else None.
-00019810: 0a20 2020 2020 2020 206b 7572 746f 7369  .        kurtosi
-00019820: 735f 7368 6170 6520 3d20 6e75 6d2e 5f6d  s_shape = num._m
-00019830: 6574 615f 6e6f 6e65 6d70 7479 2e76 616c  eta_nonempty.val
-00019840: 7565 732e 7661 7228 6178 6973 3d30 292e  ues.var(axis=0).
-00019850: 7368 6170 650a 2020 2020 2020 2020 6172  shape.        ar
-00019860: 7261 795f 6b75 7274 6f73 6973 5f6e 616d  ray_kurtosis_nam
-00019870: 6520 3d20 2861 7272 6179 5f6b 7572 746f  e = (array_kurto
-00019880: 7369 732e 5f6e 616d 652c 2920 2b20 2830  sis._name,) + (0
-00019890: 2c29 202a 206c 656e 286b 7572 746f 7369  ,) * len(kurtosi
-000198a0: 735f 7368 6170 6529 0a0a 2020 2020 2020  s_shape)..      
-000198b0: 2020 6c61 7965 7220 3d20 7b0a 2020 2020    layer = {.    
-000198c0: 2020 2020 2020 2020 286e 616d 652c 2030          (name, 0
-000198d0: 293a 2028 6d65 7468 6f64 732e 7772 6170  ): (methods.wrap
-000198e0: 5f6b 7572 746f 7369 735f 7265 6475 6374  _kurtosis_reduct
-000198f0: 696f 6e2c 2061 7272 6179 5f6b 7572 746f  ion, array_kurto
-00019900: 7369 735f 6e61 6d65 2c20 636f 6c73 290a  sis_name, cols).
-00019910: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00019920: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-00019930: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-00019940: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
-00019950: 2020 2020 2020 206e 616d 652c 206c 6179         name, lay
-00019960: 6572 2c20 6465 7065 6e64 656e 6369 6573  er, dependencies
-00019970: 3d5b 6172 7261 795f 6b75 7274 6f73 6973  =[array_kurtosis
-00019980: 5d0a 2020 2020 2020 2020 290a 0a20 2020  ].        )..   
-00019990: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-000199a0: 6464 5f6f 626a 6563 7428 0a20 2020 2020  dd_object(.     
-000199b0: 2020 2020 2020 2067 7261 7068 2c20 6e61         graph, na
-000199c0: 6d65 2c20 6e75 6d2e 5f6d 6574 615f 6e6f  me, num._meta_no
-000199d0: 6e65 6d70 7479 2e6b 7572 746f 7369 7328  nempty.kurtosis(
-000199e0: 292c 2064 6976 6973 696f 6e73 3d5b 4e6f  ), divisions=[No
-000199f0: 6e65 2c20 4e6f 6e65 5d0a 2020 2020 2020  ne, None].      
-00019a00: 2020 290a 0a20 2020 2040 5f6e 756d 6572    )..    @_numer
-00019a10: 6963 5f6f 6e6c 790a 2020 2020 4064 6572  ic_only.    @der
-00019a20: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00019a30: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00019a40: 7365 6d28 7365 6c66 2c20 6178 6973 3d4e  sem(self, axis=N
-00019a50: 6f6e 652c 2073 6b69 706e 613d 5472 7565  one, skipna=True
-00019a60: 2c20 6464 6f66 3d31 2c20 7370 6c69 745f  , ddof=1, split_
-00019a70: 6576 6572 793d 4661 6c73 652c 206e 756d  every=False, num
-00019a80: 6572 6963 5f6f 6e6c 793d 4e6f 6e65 293a  eric_only=None):
-00019a90: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
-00019aa0: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
-00019ab0: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
-00019ac0: 2020 5f72 6169 7365 5f69 665f 6f62 6a65    _raise_if_obje
-00019ad0: 6374 5f73 6572 6965 7328 7365 6c66 2c20  ct_series(self, 
-00019ae0: 2273 656d 2229 0a20 2020 2020 2020 2077  "sem").        w
-00019af0: 6974 6820 6368 6563 6b5f 6e75 6d65 7269  ith check_numeri
-00019b00: 635f 6f6e 6c79 5f64 6570 7265 6361 7469  c_only_deprecati
-00019b10: 6f6e 2829 3a0a 2020 2020 2020 2020 2020  on():.          
-00019b20: 2020 6d65 7461 203d 2073 656c 662e 5f6d    meta = self._m
-00019b30: 6574 615f 6e6f 6e65 6d70 7479 2e73 656d  eta_nonempty.sem
-00019b40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00019b50: 2020 6178 6973 3d61 7869 732c 2073 6b69    axis=axis, ski
-00019b60: 706e 613d 736b 6970 6e61 2c20 6464 6f66  pna=skipna, ddof
-00019b70: 3d64 646f 662c 206e 756d 6572 6963 5f6f  =ddof, numeric_o
-00019b80: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
-00019b90: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00019ba0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-00019bb0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00019bc0: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
-00019bd0: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-00019be0: 2020 2020 2020 2020 4d2e 7365 6d2c 0a20          M.sem,. 
-00019bf0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00019c00: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00019c10: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
-00019c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019c30: 746f 6b65 6e3d 7365 6c66 2e5f 746f 6b65  token=self._toke
-00019c40: 6e5f 7072 6566 6978 202b 2022 7365 6d22  n_prefix + "sem"
-00019c50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00019c60: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
-00019c70: 2020 2020 2020 2020 2020 2020 2073 6b69               ski
-00019c80: 706e 613d 736b 6970 6e61 2c0a 2020 2020  pna=skipna,.    
-00019c90: 2020 2020 2020 2020 2020 2020 6464 6f66              ddof
-00019ca0: 3d64 646f 662c 0a20 2020 2020 2020 2020  =ddof,.         
-00019cb0: 2020 2020 2020 2070 6172 656e 745f 6d65         parent_me
-00019cc0: 7461 3d73 656c 662e 5f6d 6574 612c 0a20  ta=self._meta,. 
-00019cd0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00019ce0: 756d 6572 6963 5f6f 6e6c 793d 6e75 6d65  umeric_only=nume
-00019cf0: 7269 635f 6f6e 6c79 2c0a 2020 2020 2020  ric_only,.      
-00019d00: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00019d10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00019d20: 2020 6e75 6d20 3d20 7365 6c66 2e5f 6765    num = self._ge
-00019d30: 745f 6e75 6d65 7269 635f 6461 7461 2829  t_numeric_data()
-00019d40: 0a20 2020 2020 2020 2020 2020 2076 203d  .            v =
-00019d50: 206e 756d 2e76 6172 2873 6b69 706e 613d   num.var(skipna=
-00019d60: 736b 6970 6e61 2c20 6464 6f66 3d64 646f  skipna, ddof=ddo
-00019d70: 662c 2073 706c 6974 5f65 7665 7279 3d73  f, split_every=s
-00019d80: 706c 6974 5f65 7665 7279 290a 2020 2020  plit_every).    
-00019d90: 2020 2020 2020 2020 6e20 3d20 6e75 6d2e          n = num.
-00019da0: 636f 756e 7428 7370 6c69 745f 6576 6572  count(split_ever
-00019db0: 793d 7370 6c69 745f 6576 6572 7929 0a20  y=split_every). 
-00019dc0: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-00019dd0: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
-00019de0: 6566 6978 202b 2022 7365 6d22 0a20 2020  efix + "sem".   
-00019df0: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-00019e00: 3d20 6d61 705f 7061 7274 6974 696f 6e73  = map_partitions
-00019e10: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00019e20: 2020 6e70 2e73 7172 742c 0a20 2020 2020    np.sqrt,.     
-00019e30: 2020 2020 2020 2020 2020 2076 202f 206e             v / n
-00019e40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00019e50: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
-00019e60: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
-00019e70: 656e 3d6e 616d 652c 0a20 2020 2020 2020  en=name,.       
-00019e80: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
-00019e90: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
-00019ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019eb0: 2070 6172 656e 745f 6d65 7461 3d73 656c   parent_meta=sel
-00019ec0: 662e 5f6d 6574 612c 0a20 2020 2020 2020  f._meta,.       
-00019ed0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00019ee0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00019ef0: 6528 7365 6c66 2c20 4461 7461 4672 616d  e(self, DataFram
-00019f00: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00019f10: 2020 2020 7265 7375 6c74 2e64 6976 6973      result.divis
-00019f20: 696f 6e73 203d 2028 7365 6c66 2e63 6f6c  ions = (self.col
-00019f30: 756d 6e73 2e6d 696e 2829 2c20 7365 6c66  umns.min(), self
-00019f40: 2e63 6f6c 756d 6e73 2e6d 6178 2829 290a  .columns.max()).
-00019f50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00019f60: 726e 2072 6573 756c 740a 0a20 2020 2040  rn result..    @
-00019f70: 5f6e 756d 6572 6963 5f64 6174 610a 2020  _numeric_data.  
-00019f80: 2020 6465 6620 7175 616e 7469 6c65 2873    def quantile(s
-00019f90: 656c 662c 2071 3d30 2e35 2c20 6178 6973  elf, q=0.5, axis
-00019fa0: 3d30 2c20 6e75 6d65 7269 635f 6f6e 6c79  =0, numeric_only
-00019fb0: 3d6e 6f5f 6465 6661 756c 742c 206d 6574  =no_default, met
-00019fc0: 686f 643d 2264 6566 6175 6c74 2229 3a0a  hod="default"):.
-00019fd0: 2020 2020 2020 2020 2222 2241 7070 726f          """Appro
-00019fe0: 7869 6d61 7465 2072 6f77 2d77 6973 6520  ximate row-wise 
-00019ff0: 616e 6420 7072 6563 6973 6520 636f 6c75  and precise colu
-0001a000: 6d6e 2d77 6973 6520 7175 616e 7469 6c65  mn-wise quantile
-0001a010: 7320 6f66 2044 6174 6146 7261 6d65 0a0a  s of DataFrame..
-0001a020: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0001a030: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0001a040: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7120  -----.        q 
-0001a050: 3a20 6c69 7374 2f61 7272 6179 206f 6620  : list/array of 
-0001a060: 666c 6f61 7473 2c20 6465 6661 756c 7420  floats, default 
-0001a070: 302e 3520 2835 3025 290a 2020 2020 2020  0.5 (50%).      
-0001a080: 2020 2020 2020 4974 6572 6162 6c65 206f        Iterable o
-0001a090: 6620 6e75 6d62 6572 7320 7261 6e67 696e  f numbers rangin
-0001a0a0: 6720 6672 6f6d 2030 2074 6f20 3120 666f  g from 0 to 1 fo
-0001a0b0: 7220 7468 6520 6465 7369 7265 6420 7175  r the desired qu
-0001a0c0: 616e 7469 6c65 730a 2020 2020 2020 2020  antiles.        
-0001a0d0: 6178 6973 203a 207b 302c 2031 2c20 2769  axis : {0, 1, 'i
-0001a0e0: 6e64 6578 272c 2027 636f 6c75 6d6e 7327  ndex', 'columns'
-0001a0f0: 7d20 2864 6566 6175 6c74 2030 290a 2020  } (default 0).  
-0001a100: 2020 2020 2020 2020 2020 3020 6f72 2027            0 or '
-0001a110: 696e 6465 7827 2066 6f72 2072 6f77 2d77  index' for row-w
-0001a120: 6973 652c 2031 206f 7220 2763 6f6c 756d  ise, 1 or 'colum
-0001a130: 6e73 2720 666f 7220 636f 6c75 6d6e 2d77  ns' for column-w
-0001a140: 6973 650a 2020 2020 2020 2020 6d65 7468  ise.        meth
-0001a150: 6f64 203a 207b 2764 6566 6175 6c74 272c  od : {'default',
-0001a160: 2027 7464 6967 6573 7427 2c20 2764 6173   'tdigest', 'das
-0001a170: 6b27 7d2c 206f 7074 696f 6e61 6c0a 2020  k'}, optional.  
-0001a180: 2020 2020 2020 2020 2020 5768 6174 206d            What m
-0001a190: 6574 686f 6420 746f 2075 7365 2e20 4279  ethod to use. By
-0001a1a0: 2064 6566 6175 6c74 2077 696c 6c20 7573   default will us
-0001a1b0: 6520 6461 736b 2773 2069 6e74 6572 6e61  e dask's interna
-0001a1c0: 6c20 6375 7374 6f6d 0a20 2020 2020 2020  l custom.       
-0001a1d0: 2020 2020 2061 6c67 6f72 6974 686d 2028       algorithm (
-0001a1e0: 6060 2764 6173 6b27 6060 292e 2020 4966  ``'dask'``).  If
-0001a1f0: 2073 6574 2074 6f20 6060 2774 6469 6765   set to ``'tdige
-0001a200: 7374 2760 6020 7769 6c6c 2075 7365 2074  st'`` will use t
-0001a210: 6469 6765 7374 0a20 2020 2020 2020 2020  digest.         
-0001a220: 2020 2066 6f72 2066 6c6f 6174 7320 616e     for floats an
-0001a230: 6420 696e 7473 2061 6e64 2066 616c 6c62  d ints and fallb
-0001a240: 6163 6b20 746f 2074 6865 2060 6027 6461  ack to the ``'da
-0001a250: 736b 2760 6020 6f74 6865 7277 6973 652e  sk'`` otherwise.
-0001a260: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001a270: 2020 2020 206e 756d 6572 6963 5f6b 7761       numeric_kwa
-0001a280: 7267 7320 3d20 5f6e 756d 6572 6963 5f6f  rgs = _numeric_o
-0001a290: 6e6c 795f 6d61 7962 655f 7761 726e 2873  nly_maybe_warn(s
-0001a2a0: 656c 662c 206e 756d 6572 6963 5f6f 6e6c  elf, numeric_onl
-0001a2b0: 792c 2064 6566 6175 6c74 3d54 7275 6529  y, default=True)
-0001a2c0: 0a0a 2020 2020 2020 2020 6178 6973 203d  ..        axis =
-0001a2d0: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-0001a2e0: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
-0001a2f0: 2020 206b 6579 6e61 6d65 203d 2022 7175     keyname = "qu
-0001a300: 616e 7469 6c65 732d 636f 6e63 6174 2d2d  antiles-concat--
-0001a310: 2220 2b20 746f 6b65 6e69 7a65 2873 656c  " + tokenize(sel
-0001a320: 662c 2071 2c20 6178 6973 290a 0a20 2020  f, q, axis)..   
-0001a330: 2020 2020 2077 6974 6820 6368 6563 6b5f       with check_
-0001a340: 6e75 6d65 7269 635f 6f6e 6c79 5f64 6570  numeric_only_dep
-0001a350: 7265 6361 7469 6f6e 2829 3a0a 2020 2020  recation():.    
-0001a360: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
-0001a370: 656c 662e 5f6d 6574 612e 7175 616e 7469  elf._meta.quanti
-0001a380: 6c65 2871 2c20 6178 6973 3d61 7869 732c  le(q, axis=axis,
-0001a390: 202a 2a6e 756d 6572 6963 5f6b 7761 7267   **numeric_kwarg
-0001a3a0: 7329 0a0a 2020 2020 2020 2020 6966 2061  s)..        if a
-0001a3b0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
-0001a3c0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0001a3d0: 6e63 6528 712c 206c 6973 7429 3a0a 2020  nce(q, list):.  
-0001a3e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001a3f0: 4e6f 7420 7375 7070 6f72 7465 642c 2074  Not supported, t
-0001a400: 6865 2072 6573 756c 7420 7769 6c6c 2068  he result will h
-0001a410: 6176 6520 6375 7272 656e 7420 696e 6465  ave current inde
-0001a420: 7820 6173 2063 6f6c 756d 6e73 0a20 2020  x as columns.   
-0001a430: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001a440: 7365 2056 616c 7565 4572 726f 7228 2227  se ValueError("'
-0001a450: 7127 206d 7573 7420 6265 2073 6361 6c61  q' must be scala
-0001a460: 7220 7768 656e 2061 7869 733d 3120 6973  r when axis=1 is
-0001a470: 2073 7065 6369 6669 6564 2229 0a0a 2020   specified")..  
-0001a480: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001a490: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
-0001a4a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a4b0: 204d 2e71 7561 6e74 696c 652c 0a20 2020   M.quantile,.   
-0001a4c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001a4d0: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
-0001a4e0: 2020 2071 2c0a 2020 2020 2020 2020 2020     q,.          
-0001a4f0: 2020 2020 2020 6178 6973 2c0a 2020 2020        axis,.    
-0001a500: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-0001a510: 6e3d 6b65 796e 616d 652c 0a20 2020 2020  n=keyname,.     
-0001a520: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
-0001a530: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-0001a540: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0001a550: 2020 202a 2a6e 756d 6572 6963 5f6b 7761     **numeric_kwa
-0001a560: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-0001a570: 2020 2020 206d 6574 613d 2871 2c20 2266       meta=(q, "f
-0001a580: 3822 292c 0a20 2020 2020 2020 2020 2020  8"),.           
-0001a590: 2020 2020 2070 6172 656e 745f 6d65 7461       parent_meta
-0001a5a0: 3d73 656c 662e 5f6d 6574 612c 0a20 2020  =self._meta,.   
-0001a5b0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001a5c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001a5d0: 2020 2020 205f 7261 6973 655f 6966 5f6f       _raise_if_o
-0001a5e0: 626a 6563 745f 7365 7269 6573 2873 656c  bject_series(sel
-0001a5f0: 662c 2022 7175 616e 7469 6c65 2229 0a20  f, "quantile"). 
-0001a600: 2020 2020 2020 2020 2020 206e 756d 203d             num =
-0001a610: 2073 656c 662e 5f67 6574 5f6e 756d 6572   self._get_numer
-0001a620: 6963 5f64 6174 6128 290a 2020 2020 2020  ic_data().      
-0001a630: 2020 2020 2020 7175 616e 7469 6c65 7320        quantiles 
-0001a640: 3d20 7475 706c 6528 7175 616e 7469 6c65  = tuple(quantile
-0001a650: 2873 656c 665b 635d 2c20 712c 206d 6574  (self[c], q, met
-0001a660: 686f 6429 2066 6f72 2063 2069 6e20 6e75  hod) for c in nu
-0001a670: 6d2e 636f 6c75 6d6e 7329 0a0a 2020 2020  m.columns)..    
-0001a680: 2020 2020 2020 2020 716e 616d 6573 203d          qnames =
-0001a690: 205b 285f 712e 5f6e 616d 652c 2030 2920   [(_q._name, 0) 
-0001a6a0: 666f 7220 5f71 2069 6e20 7175 616e 7469  for _q in quanti
-0001a6b0: 6c65 735d 0a0a 2020 2020 2020 2020 2020  les]..          
-0001a6c0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0001a6d0: 7175 616e 7469 6c65 735b 305d 2c20 5363  quantiles[0], Sc
-0001a6e0: 616c 6172 293a 0a20 2020 2020 2020 2020  alar):.         
-0001a6f0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
-0001a700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a710: 2020 2020 2028 6b65 796e 616d 652c 2030       (keyname, 0
-0001a720: 293a 2028 7479 7065 286d 6574 6129 2c20  ): (type(meta), 
-0001a730: 716e 616d 6573 2c20 6e75 6d2e 636f 6c75  qnames, num.colu
-0001a740: 6d6e 732c 204e 6f6e 652c 206d 6574 612e  mns, None, meta.
-0001a750: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
-0001a760: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0001a770: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
-0001a780: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-0001a790: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-0001a7a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a7b0: 2020 2020 206b 6579 6e61 6d65 2c20 6c61       keyname, la
-0001a7c0: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
-0001a7d0: 733d 7175 616e 7469 6c65 730a 2020 2020  s=quantiles.    
-0001a7e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001a7f0: 2020 2020 2020 2020 2020 2020 2020 6469                di
-0001a800: 7669 7369 6f6e 7320 3d20 286d 696e 286e  visions = (min(n
-0001a810: 756d 2e63 6f6c 756d 6e73 292c 206d 6178  um.columns), max
-0001a820: 286e 756d 2e63 6f6c 756d 6e73 2929 0a20  (num.columns)). 
-0001a830: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001a840: 6574 7572 6e20 5365 7269 6573 2867 7261  eturn Series(gra
-0001a850: 7068 2c20 6b65 796e 616d 652c 206d 6574  ph, keyname, met
-0001a860: 612c 2064 6976 6973 696f 6e73 290a 2020  a, divisions).  
-0001a870: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001a880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a890: 6c61 7965 7220 3d20 7b28 6b65 796e 616d  layer = {(keynam
-0001a8a0: 652c 2030 293a 2028 6d65 7468 6f64 732e  e, 0): (methods.
-0001a8b0: 636f 6e63 6174 2c20 716e 616d 6573 2c20  concat, qnames, 
-0001a8c0: 3129 7d0a 2020 2020 2020 2020 2020 2020  1)}.            
-0001a8d0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
-0001a8e0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-0001a8f0: 636f 6c6c 6563 7469 6f6e 7328 0a20 2020  collections(.   
-0001a900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a910: 206b 6579 6e61 6d65 2c20 6c61 7965 722c   keyname, layer,
-0001a920: 2064 6570 656e 6465 6e63 6965 733d 7175   dependencies=qu
-0001a930: 616e 7469 6c65 730a 2020 2020 2020 2020  antiles.        
-0001a940: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001a950: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001a960: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
-0001a970: 7261 7068 2c20 6b65 796e 616d 652c 206d  raph, keyname, m
-0001a980: 6574 612c 2071 7561 6e74 696c 6573 5b30  eta, quantiles[0
-0001a990: 5d2e 6469 7669 7369 6f6e 7329 0a0a 2020  ].divisions)..  
-0001a9a0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-0001a9b0: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-0001a9c0: 2020 6465 6620 6465 7363 7269 6265 280a    def describe(.
-0001a9d0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0001a9e0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-0001a9f0: 793d 4661 6c73 652c 0a20 2020 2020 2020  y=False,.       
-0001aa00: 2070 6572 6365 6e74 696c 6573 3d4e 6f6e   percentiles=Non
-0001aa10: 652c 0a20 2020 2020 2020 2070 6572 6365  e,.        perce
-0001aa20: 6e74 696c 6573 5f6d 6574 686f 643d 2264  ntiles_method="d
-0001aa30: 6566 6175 6c74 222c 0a20 2020 2020 2020  efault",.       
-0001aa40: 2069 6e63 6c75 6465 3d4e 6f6e 652c 0a20   include=None,. 
-0001aa50: 2020 2020 2020 2065 7863 6c75 6465 3d4e         exclude=N
-0001aa60: 6f6e 652c 0a20 2020 2020 2020 2064 6174  one,.        dat
-0001aa70: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001aa80: 3d6e 6f5f 6465 6661 756c 742c 0a20 2020  =no_default,.   
-0001aa90: 2029 3a0a 2020 2020 2020 2020 6966 2050   ):.        if P
-0001aaa0: 414e 4441 535f 4754 5f32 3030 3a0a 2020  ANDAS_GT_200:.  
-0001aab0: 2020 2020 2020 2020 2020 6966 2064 6174            if dat
-0001aac0: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001aad0: 2069 7320 6e6f 5f64 6566 6175 6c74 3a0a   is no_default:.
-0001aae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aaf0: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
-0001ab00: 7269 6320 3d20 5472 7565 0a20 2020 2020  ric = True.     
-0001ab10: 2020 2020 2020 2020 2020 2064 6174 6574             datet
-0001ab20: 696d 655f 6973 5f6e 756d 6572 6963 5f6b  ime_is_numeric_k
-0001ab30: 7761 7267 203d 207b 7d0a 2020 2020 2020  warg = {}.      
-0001ab40: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001ab50: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001ab60: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
-0001ab70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ab80: 2022 6461 7465 7469 6d65 5f69 735f 6e75   "datetime_is_nu
-0001ab90: 6d65 7269 6320 6973 2072 656d 6f76 6564  meric is removed
-0001aba0: 2069 6e20 7061 6e64 6173 3e3d 322e 302e   in pandas>=2.0.
-0001abb0: 302c 2064 6174 6574 696d 6520 6461 7461  0, datetime data
-0001abc0: 2077 696c 6c20 616c 7761 7973 2062 6520   will always be 
-0001abd0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0001abe0: 2020 2020 2020 2273 756d 6d61 7269 7a65        "summarize
-0001abf0: 6420 6173 206e 756d 6572 6963 220a 2020  d as numeric".  
-0001ac00: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0001ac10: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001ac20: 2020 2020 2020 2020 2020 6461 7465 7469            dateti
-0001ac30: 6d65 5f69 735f 6e75 6d65 7269 6320 3d20  me_is_numeric = 
-0001ac40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001ac50: 2020 4661 6c73 6520 6966 2064 6174 6574    False if datet
-0001ac60: 696d 655f 6973 5f6e 756d 6572 6963 2069  ime_is_numeric i
-0001ac70: 7320 6e6f 5f64 6566 6175 6c74 2065 6c73  s no_default els
-0001ac80: 6520 6461 7465 7469 6d65 5f69 735f 6e75  e datetime_is_nu
-0001ac90: 6d65 7269 630a 2020 2020 2020 2020 2020  meric.          
-0001aca0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0001acb0: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
-0001acc0: 7269 635f 6b77 6172 6720 3d20 7b22 6461  ric_kwarg = {"da
-0001acd0: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
-0001ace0: 6322 3a20 6461 7465 7469 6d65 5f69 735f  c": datetime_is_
-0001acf0: 6e75 6d65 7269 637d 0a0a 2020 2020 2020  numeric}..      
-0001ad00: 2020 6966 2073 656c 662e 5f6d 6574 612e    if self._meta.
-0001ad10: 6e64 696d 203d 3d20 313a 0a20 2020 2020  ndim == 1:.     
-0001ad20: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
-0001ad30: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-0001ad40: 792e 6465 7363 7269 6265 280a 2020 2020  y.describe(.    
-0001ad50: 2020 2020 2020 2020 2020 2020 7065 7263              perc
-0001ad60: 656e 7469 6c65 733d 7065 7263 656e 7469  entiles=percenti
-0001ad70: 6c65 732c 0a20 2020 2020 2020 2020 2020  les,.           
-0001ad80: 2020 2020 2069 6e63 6c75 6465 3d69 6e63       include=inc
-0001ad90: 6c75 6465 2c0a 2020 2020 2020 2020 2020  lude,.          
-0001ada0: 2020 2020 2020 6578 636c 7564 653d 6578        exclude=ex
-0001adb0: 636c 7564 652c 0a20 2020 2020 2020 2020  clude,.         
-0001adc0: 2020 2020 2020 202a 2a64 6174 6574 696d         **datetim
-0001add0: 655f 6973 5f6e 756d 6572 6963 5f6b 7761  e_is_numeric_kwa
-0001ade0: 7267 2c0a 2020 2020 2020 2020 2020 2020  rg,.            
-0001adf0: 290a 2020 2020 2020 2020 2020 2020 6f75  ).            ou
-0001ae00: 7470 7574 203d 2073 656c 662e 5f64 6573  tput = self._des
-0001ae10: 6372 6962 655f 3164 280a 2020 2020 2020  cribe_1d(.      
-0001ae20: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
-0001ae30: 7370 6c69 745f 6576 6572 792c 2070 6572  split_every, per
-0001ae40: 6365 6e74 696c 6573 2c20 7065 7263 656e  centiles, percen
-0001ae50: 7469 6c65 735f 6d65 7468 6f64 2c20 6461  tiles_method, da
-0001ae60: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
-0001ae70: 630a 2020 2020 2020 2020 2020 2020 290a  c.            ).
-0001ae80: 2020 2020 2020 2020 2020 2020 6f75 7470              outp
-0001ae90: 7574 2e5f 6d65 7461 203d 206d 6574 610a  ut._meta = meta.
-0001aea0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001aeb0: 726e 206f 7574 7075 740a 2020 2020 2020  rn output.      
-0001aec0: 2020 656c 6966 2028 696e 636c 7564 6520    elif (include 
-0001aed0: 6973 204e 6f6e 6529 2061 6e64 2028 6578  is None) and (ex
-0001aee0: 636c 7564 6520 6973 204e 6f6e 6529 3a0a  clude is None):.
-0001aef0: 2020 2020 2020 2020 2020 2020 5f69 6e63              _inc
-0001af00: 6c75 6465 203d 205b 6e70 2e6e 756d 6265  lude = [np.numbe
-0001af10: 722c 206e 702e 7469 6d65 6465 6c74 6136  r, np.timedelta6
-0001af20: 345d 0a20 2020 2020 2020 2020 2020 2069  4].            i
-0001af30: 6620 6461 7465 7469 6d65 5f69 735f 6e75  f datetime_is_nu
-0001af40: 6d65 7269 633a 0a20 2020 2020 2020 2020  meric:.         
-0001af50: 2020 2020 2020 205f 696e 636c 7564 652e         _include.
-0001af60: 6170 7065 6e64 286e 702e 6461 7465 7469  append(np.dateti
-0001af70: 6d65 3634 290a 2020 2020 2020 2020 2020  me64).          
-0001af80: 2020 6461 7461 203d 2073 656c 662e 5f6d    data = self._m
-0001af90: 6574 612e 7365 6c65 6374 5f64 7479 7065  eta.select_dtype
-0001afa0: 7328 696e 636c 7564 653d 5f69 6e63 6c75  s(include=_inclu
-0001afb0: 6465 290a 0a20 2020 2020 2020 2020 2020  de)..           
-0001afc0: 2023 2077 6865 6e20 736f 6d65 206e 756d   # when some num
-0001afd0: 6572 6963 732f 7469 6d65 6465 6c74 6173  erics/timedeltas
-0001afe0: 2061 7265 2066 6f75 6e64 2c20 6279 2064   are found, by d
-0001aff0: 6566 6175 6c74 206b 6565 7020 7468 656d  efault keep them
-0001b000: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001b010: 6c65 6e28 6461 7461 2e63 6f6c 756d 6e73  len(data.columns
-0001b020: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
-0001b030: 2020 2020 2020 2020 6368 6f73 656e 5f63          chosen_c
-0001b040: 6f6c 756d 6e73 203d 2073 656c 662e 5f6d  olumns = self._m
-0001b050: 6574 612e 636f 6c75 6d6e 730a 2020 2020  eta.columns.    
-0001b060: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001b070: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001b080: 6368 6563 6b20 6966 2074 6865 7265 2061  check if there a
-0001b090: 7265 2074 696d 6564 656c 7461 2c20 626f  re timedelta, bo
-0001b0a0: 6f6c 6561 6e2c 206f 7220 6461 7465 7469  olean, or dateti
-0001b0b0: 6d65 2063 6f6c 756d 6e73 0a20 2020 2020  me columns.     
-0001b0c0: 2020 2020 2020 2020 2020 205f 696e 636c             _incl
-0001b0d0: 7564 6520 3d20 5b6e 702e 7469 6d65 6465  ude = [np.timede
-0001b0e0: 6c74 6136 342c 2062 6f6f 6c5d 0a20 2020  lta64, bool].   
-0001b0f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001b100: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
-0001b110: 7269 633a 0a20 2020 2020 2020 2020 2020  ric:.           
-0001b120: 2020 2020 2020 2020 205f 696e 636c 7564           _includ
-0001b130: 652e 6170 7065 6e64 286e 702e 6461 7465  e.append(np.date
-0001b140: 7469 6d65 3634 290a 2020 2020 2020 2020  time64).        
-0001b150: 2020 2020 2020 2020 626f 6f6c 735f 616e          bools_an
-0001b160: 645f 7469 6d65 7320 3d20 7365 6c66 2e5f  d_times = self._
-0001b170: 6d65 7461 2e73 656c 6563 745f 6474 7970  meta.select_dtyp
-0001b180: 6573 2869 6e63 6c75 6465 3d5f 696e 636c  es(include=_incl
-0001b190: 7564 6529 0a20 2020 2020 2020 2020 2020  ude).           
-0001b1a0: 2020 2020 2069 6620 6c65 6e28 626f 6f6c       if len(bool
-0001b1b0: 735f 616e 645f 7469 6d65 732e 636f 6c75  s_and_times.colu
-0001b1c0: 6d6e 7329 203d 3d20 303a 0a20 2020 2020  mns) == 0:.     
-0001b1d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001b1e0: 6574 7572 6e20 7365 6c66 2e5f 6465 7363  eturn self._desc
-0001b1f0: 7269 6265 5f6e 756d 6572 6963 280a 2020  ribe_numeric(.  
-0001b200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b210: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0001b220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b230: 2020 2020 7370 6c69 745f 6576 6572 792c      split_every,
-0001b240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b250: 2020 2020 2020 2020 2070 6572 6365 6e74           percent
-0001b260: 696c 6573 2c0a 2020 2020 2020 2020 2020  iles,.          
-0001b270: 2020 2020 2020 2020 2020 2020 2020 7065                pe
-0001b280: 7263 656e 7469 6c65 735f 6d65 7468 6f64  rcentiles_method
-0001b290: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001b2a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001b2b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001b2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2d0: 2020 6368 6f73 656e 5f63 6f6c 756d 6e73    chosen_columns
-0001b2e0: 203d 2064 6174 612e 636f 6c75 6d6e 730a   = data.columns.
-0001b2f0: 2020 2020 2020 2020 656c 6966 2069 6e63          elif inc
-0001b300: 6c75 6465 203d 3d20 2261 6c6c 223a 0a20  lude == "all":. 
-0001b310: 2020 2020 2020 2020 2020 2069 6620 6578             if ex
-0001b320: 636c 7564 6520 6973 206e 6f74 204e 6f6e  clude is not Non
-0001b330: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0001b340: 2020 206d 7367 203d 2022 6578 636c 7564     msg = "exclud
-0001b350: 6520 6d75 7374 2062 6520 4e6f 6e65 2077  e must be None w
-0001b360: 6865 6e20 696e 636c 7564 6520 6973 2027  hen include is '
-0001b370: 616c 6c27 220a 2020 2020 2020 2020 2020  all'".          
-0001b380: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0001b390: 6545 7272 6f72 286d 7367 290a 2020 2020  eError(msg).    
-0001b3a0: 2020 2020 2020 2020 6368 6f73 656e 5f63          chosen_c
-0001b3b0: 6f6c 756d 6e73 203d 2073 656c 662e 5f6d  olumns = self._m
-0001b3c0: 6574 612e 636f 6c75 6d6e 730a 2020 2020  eta.columns.    
-0001b3d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001b3e0: 2020 2020 2020 6368 6f73 656e 5f63 6f6c        chosen_col
-0001b3f0: 756d 6e73 203d 2073 656c 662e 5f6d 6574  umns = self._met
-0001b400: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
-0001b410: 696e 636c 7564 653d 696e 636c 7564 652c  include=include,
-0001b420: 2065 7863 6c75 6465 3d65 7863 6c75 6465   exclude=exclude
-0001b430: 290a 0a20 2020 2020 2020 2073 7461 7473  )..        stats
-0001b440: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-0001b450: 2073 656c 662e 5f64 6573 6372 6962 655f   self._describe_
-0001b460: 3164 280a 2020 2020 2020 2020 2020 2020  1d(.            
-0001b470: 2020 2020 7365 6c66 5b63 6f6c 5f69 6478      self[col_idx
-0001b480: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0001b490: 2020 2073 706c 6974 5f65 7665 7279 2c0a     split_every,.
-0001b4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b4b0: 7065 7263 656e 7469 6c65 732c 0a20 2020  percentiles,.   
-0001b4c0: 2020 2020 2020 2020 2020 2020 2070 6572               per
-0001b4d0: 6365 6e74 696c 6573 5f6d 6574 686f 642c  centiles_method,
-0001b4e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b4f0: 2064 6174 6574 696d 655f 6973 5f6e 756d   datetime_is_num
-0001b500: 6572 6963 2c0a 2020 2020 2020 2020 2020  eric,.          
-0001b510: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0001b520: 666f 7220 636f 6c5f 6964 7820 696e 2063  for col_idx in c
-0001b530: 686f 7365 6e5f 636f 6c75 6d6e 730a 2020  hosen_columns.  
-0001b540: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-0001b550: 7374 6174 735f 6e61 6d65 7320 3d20 5b28  stats_names = [(
-0001b560: 732e 5f6e 616d 652c 2030 2920 666f 7220  s._name, 0) for 
-0001b570: 7320 696e 2073 7461 7473 5d0a 0a20 2020  s in stats]..   
-0001b580: 2020 2020 206e 616d 6520 3d20 2264 6573       name = "des
-0001b590: 6372 6962 652d 2d22 202b 2074 6f6b 656e  cribe--" + token
-0001b5a0: 697a 6528 7365 6c66 2c20 7370 6c69 745f  ize(self, split_
-0001b5b0: 6576 6572 7929 0a20 2020 2020 2020 206c  every).        l
-0001b5c0: 6179 6572 203d 207b 286e 616d 652c 2030  ayer = {(name, 0
-0001b5d0: 293a 2028 6d65 7468 6f64 732e 6465 7363  ): (methods.desc
-0001b5e0: 7269 6265 5f61 6767 7265 6761 7465 2c20  ribe_aggregate, 
-0001b5f0: 7374 6174 735f 6e61 6d65 7329 7d0a 2020  stats_names)}.  
-0001b600: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-0001b610: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-0001b620: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
-0001b630: 6d65 2c20 6c61 7965 722c 2064 6570 656e  me, layer, depen
-0001b640: 6465 6e63 6965 733d 7374 6174 7329 0a20  dencies=stats). 
-0001b650: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
-0001b660: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-0001b670: 792e 6465 7363 7269 6265 280a 2020 2020  y.describe(.    
-0001b680: 2020 2020 2020 2020 696e 636c 7564 653d          include=
-0001b690: 696e 636c 7564 652c 2065 7863 6c75 6465  include, exclude
-0001b6a0: 3d65 7863 6c75 6465 2c20 2a2a 6461 7465  =exclude, **date
-0001b6b0: 7469 6d65 5f69 735f 6e75 6d65 7269 635f  time_is_numeric_
-0001b6c0: 6b77 6172 670a 2020 2020 2020 2020 290a  kwarg.        ).
-0001b6d0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-0001b6e0: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
-0001b6f0: 7068 2c20 6e61 6d65 2c20 6d65 7461 2c20  ph, name, meta, 
-0001b700: 6469 7669 7369 6f6e 733d 5b4e 6f6e 652c  divisions=[None,
-0001b710: 204e 6f6e 655d 290a 0a20 2020 2064 6566   None])..    def
-0001b720: 205f 6465 7363 7269 6265 5f31 6428 0a20   _describe_1d(. 
-0001b730: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0001b740: 2020 2020 2064 6174 612c 0a20 2020 2020       data,.     
-0001b750: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
-0001b760: 616c 7365 2c0a 2020 2020 2020 2020 7065  alse,.        pe
-0001b770: 7263 656e 7469 6c65 733d 4e6f 6e65 2c0a  rcentiles=None,.
-0001b780: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
-0001b790: 6c65 735f 6d65 7468 6f64 3d22 6465 6661  les_method="defa
-0001b7a0: 756c 7422 2c0a 2020 2020 2020 2020 6461  ult",.        da
-0001b7b0: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
-0001b7c0: 633d 4661 6c73 652c 0a20 2020 2029 3a0a  c=False,.    ):.
-0001b7d0: 2020 2020 2020 2020 6966 2069 735f 626f          if is_bo
-0001b7e0: 6f6c 5f64 7479 7065 2864 6174 612e 5f6d  ol_dtype(data._m
-0001b7f0: 6574 6129 3a0a 2020 2020 2020 2020 2020  eta):.          
-0001b800: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
-0001b810: 6573 6372 6962 655f 6e6f 6e6e 756d 6572  escribe_nonnumer
-0001b820: 6963 5f31 6428 0a20 2020 2020 2020 2020  ic_1d(.         
-0001b830: 2020 2020 2020 2064 6174 612c 2073 706c         data, spl
-0001b840: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-0001b850: 7665 7279 2c20 6461 7465 7469 6d65 5f69  very, datetime_i
-0001b860: 735f 6e75 6d65 7269 633d 6461 7465 7469  s_numeric=dateti
-0001b870: 6d65 5f69 735f 6e75 6d65 7269 630a 2020  me_is_numeric.  
-0001b880: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001b890: 2020 2020 656c 6966 2069 735f 6e75 6d65      elif is_nume
-0001b8a0: 7269 635f 6474 7970 6528 6461 7461 2e5f  ric_dtype(data._
-0001b8b0: 6d65 7461 293a 0a20 2020 2020 2020 2020  meta):.         
-0001b8c0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0001b8d0: 6465 7363 7269 6265 5f6e 756d 6572 6963  describe_numeric
-0001b8e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001b8f0: 2020 6461 7461 2c0a 2020 2020 2020 2020    data,.        
-0001b900: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-0001b910: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
-0001b920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b930: 2070 6572 6365 6e74 696c 6573 3d70 6572   percentiles=per
-0001b940: 6365 6e74 696c 6573 2c0a 2020 2020 2020  centiles,.      
-0001b950: 2020 2020 2020 2020 2020 7065 7263 656e            percen
-0001b960: 7469 6c65 735f 6d65 7468 6f64 3d70 6572  tiles_method=per
-0001b970: 6365 6e74 696c 6573 5f6d 6574 686f 642c  centiles_method,
-0001b980: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001b990: 2020 2020 2020 2065 6c69 6620 6973 5f74         elif is_t
-0001b9a0: 696d 6564 656c 7461 3634 5f64 7479 7065  imedelta64_dtype
-0001b9b0: 2864 6174 612e 5f6d 6574 6129 3a0a 2020  (data._meta):.  
-0001b9c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001b9d0: 2073 656c 662e 5f64 6573 6372 6962 655f   self._describe_
-0001b9e0: 6e75 6d65 7269 6328 0a20 2020 2020 2020  numeric(.       
-0001b9f0: 2020 2020 2020 2020 2064 6174 612e 6472           data.dr
-0001ba00: 6f70 6e61 2829 2c0a 2020 2020 2020 2020  opna(),.        
-0001ba10: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-0001ba20: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
-0001ba30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ba40: 2070 6572 6365 6e74 696c 6573 3d70 6572   percentiles=per
-0001ba50: 6365 6e74 696c 6573 2c0a 2020 2020 2020  centiles,.      
-0001ba60: 2020 2020 2020 2020 2020 7065 7263 656e            percen
-0001ba70: 7469 6c65 735f 6d65 7468 6f64 3d70 6572  tiles_method=per
-0001ba80: 6365 6e74 696c 6573 5f6d 6574 686f 642c  centiles_method,
-0001ba90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001baa0: 2069 735f 7469 6d65 6465 6c74 615f 636f   is_timedelta_co
-0001bab0: 6c75 6d6e 3d54 7275 652c 0a20 2020 2020  lumn=True,.     
-0001bac0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001bad0: 2065 6c69 6620 6973 5f64 6174 6574 696d   elif is_datetim
-0001bae0: 6536 345f 616e 795f 6474 7970 6528 6461  e64_any_dtype(da
-0001baf0: 7461 2e5f 6d65 7461 2920 616e 6420 6461  ta._meta) and da
-0001bb00: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
-0001bb10: 633a 0a20 2020 2020 2020 2020 2020 2072  c:.            r
-0001bb20: 6574 7572 6e20 7365 6c66 2e5f 6465 7363  eturn self._desc
-0001bb30: 7269 6265 5f6e 756d 6572 6963 280a 2020  ribe_numeric(.  
-0001bb40: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0001bb50: 7461 2e64 726f 706e 6128 292c 0a20 2020  ta.dropna(),.   
-0001bb60: 2020 2020 2020 2020 2020 2020 2073 706c               spl
-0001bb70: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-0001bb80: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
-0001bb90: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
-0001bba0: 733d 7065 7263 656e 7469 6c65 732c 0a20  s=percentiles,. 
-0001bbb0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001bbc0: 6572 6365 6e74 696c 6573 5f6d 6574 686f  ercentiles_metho
-0001bbd0: 643d 7065 7263 656e 7469 6c65 735f 6d65  d=percentiles_me
-0001bbe0: 7468 6f64 2c0a 2020 2020 2020 2020 2020  thod,.          
-0001bbf0: 2020 2020 2020 6973 5f64 6174 6574 696d        is_datetim
-0001bc00: 655f 636f 6c75 6d6e 3d54 7275 652c 0a20  e_column=True,. 
-0001bc10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001bc20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001bc30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001bc40: 6c66 2e5f 6465 7363 7269 6265 5f6e 6f6e  lf._describe_non
-0001bc50: 6e75 6d65 7269 635f 3164 280a 2020 2020  numeric_1d(.    
-0001bc60: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0001bc70: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
-0001bc80: 6c69 745f 6576 6572 792c 2064 6174 6574  lit_every, datet
-0001bc90: 696d 655f 6973 5f6e 756d 6572 6963 3d64  ime_is_numeric=d
-0001bca0: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
-0001bcb0: 6963 0a20 2020 2020 2020 2020 2020 2029  ic.            )
-0001bcc0: 0a0a 2020 2020 6465 6620 5f64 6573 6372  ..    def _descr
-0001bcd0: 6962 655f 6e75 6d65 7269 6328 0a20 2020  ibe_numeric(.   
-0001bce0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001bcf0: 2020 2064 6174 612c 0a20 2020 2020 2020     data,.       
-0001bd00: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-0001bd10: 7365 2c0a 2020 2020 2020 2020 7065 7263  se,.        perc
-0001bd20: 656e 7469 6c65 733d 4e6f 6e65 2c0a 2020  entiles=None,.  
-0001bd30: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
-0001bd40: 735f 6d65 7468 6f64 3d22 6465 6661 756c  s_method="defaul
-0001bd50: 7422 2c0a 2020 2020 2020 2020 6973 5f74  t",.        is_t
-0001bd60: 696d 6564 656c 7461 5f63 6f6c 756d 6e3d  imedelta_column=
-0001bd70: 4661 6c73 652c 0a20 2020 2020 2020 2069  False,.        i
-0001bd80: 735f 6461 7465 7469 6d65 5f63 6f6c 756d  s_datetime_colum
-0001bd90: 6e3d 4661 6c73 652c 0a20 2020 2029 3a0a  n=False,.    ):.
-0001bda0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-0001bdb0: 6b2e 6461 7461 6672 616d 652e 6e75 6d65  k.dataframe.nume
-0001bdc0: 7269 6320 696d 706f 7274 2074 6f5f 6e75  ric import to_nu
-0001bdd0: 6d65 7269 630a 0a20 2020 2020 2020 2069  meric..        i
-0001bde0: 6620 6973 5f74 696d 6564 656c 7461 5f63  f is_timedelta_c
-0001bdf0: 6f6c 756d 6e20 6f72 2069 735f 6461 7465  olumn or is_date
-0001be00: 7469 6d65 5f63 6f6c 756d 6e3a 0a20 2020  time_column:.   
-0001be10: 2020 2020 2020 2020 206e 756d 203d 2074           num = t
-0001be20: 6f5f 6e75 6d65 7269 6328 6461 7461 290a  o_numeric(data).
-0001be30: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001be40: 2020 2020 2020 2020 2020 6e75 6d20 3d20            num = 
-0001be50: 6461 7461 2e5f 6765 745f 6e75 6d65 7269  data._get_numeri
-0001be60: 635f 6461 7461 2829 0a0a 2020 2020 2020  c_data()..      
-0001be70: 2020 6966 2064 6174 612e 6e64 696d 203d    if data.ndim =
-0001be80: 3d20 3220 616e 6420 6c65 6e28 6e75 6d2e  = 2 and len(num.
-0001be90: 636f 6c75 6d6e 7329 203d 3d20 303a 0a20  columns) == 0:. 
-0001bea0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001beb0: 2056 616c 7565 4572 726f 7228 2244 6174   ValueError("Dat
-0001bec0: 6146 7261 6d65 2063 6f6e 7461 696e 7320  aFrame contains 
-0001bed0: 6f6e 6c79 206e 6f6e 2d6e 756d 6572 6963  only non-numeric
-0001bee0: 2064 6174 612e 2229 0a20 2020 2020 2020   data.").       
-0001bef0: 2065 6c69 6620 6461 7461 2e6e 6469 6d20   elif data.ndim 
-0001bf00: 3d3d 2031 2061 6e64 2064 6174 612e 6474  == 1 and data.dt
-0001bf10: 7970 6520 3d3d 2022 6f62 6a65 6374 223a  ype == "object":
-0001bf20: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0001bf30: 7365 2056 616c 7565 4572 726f 7228 2243  se ValueError("C
-0001bf40: 616e 6e6f 7420 636f 6d70 7574 6520 6060  annot compute ``
-0001bf50: 6465 7363 7269 6265 6060 206f 6e20 6f62  describe`` on ob
-0001bf60: 6a65 6374 2064 7479 7065 2e22 290a 2020  ject dtype.").  
-0001bf70: 2020 2020 2020 6966 2070 6572 6365 6e74        if percent
-0001bf80: 696c 6573 2069 7320 4e6f 6e65 3a0a 2020  iles is None:.  
-0001bf90: 2020 2020 2020 2020 2020 7065 7263 656e            percen
-0001bfa0: 7469 6c65 7320 3d20 5b30 2e32 352c 2030  tiles = [0.25, 0
-0001bfb0: 2e35 2c20 302e 3735 5d0a 2020 2020 2020  .5, 0.75].      
-0001bfc0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001bfd0: 2020 2020 2320 616c 7761 7973 2069 6e63      # always inc
-0001bfe0: 6c75 6465 2074 6865 2074 6865 2035 3025  lude the the 50%
-0001bff0: 746c 6520 746f 2063 616c 6375 6c61 7465  tle to calculate
-0001c000: 2074 6865 206d 6564 6961 6e0a 2020 2020   the median.    
-0001c010: 2020 2020 2020 2020 2320 756e 6971 7565          # unique
-0001c020: 2072 656d 6f76 6573 2064 7570 6c69 6361   removes duplica
-0001c030: 7465 7320 616e 6420 736f 7274 7320 7175  tes and sorts qu
-0001c040: 616e 7469 6c65 730a 2020 2020 2020 2020  antiles.        
-0001c050: 2020 2020 7065 7263 656e 7469 6c65 7320      percentiles 
-0001c060: 3d20 6e70 2e61 7272 6179 2870 6572 6365  = np.array(perce
-0001c070: 6e74 696c 6573 290a 2020 2020 2020 2020  ntiles).        
-0001c080: 2020 2020 7065 7263 656e 7469 6c65 7320      percentiles 
-0001c090: 3d20 6e70 2e61 7070 656e 6428 7065 7263  = np.append(perc
-0001c0a0: 656e 7469 6c65 732c 2030 2e35 290a 2020  entiles, 0.5).  
-0001c0b0: 2020 2020 2020 2020 2020 7065 7263 656e            percen
-0001c0c0: 7469 6c65 7320 3d20 6e70 2e75 6e69 7175  tiles = np.uniqu
-0001c0d0: 6528 7065 7263 656e 7469 6c65 7329 0a20  e(percentiles). 
-0001c0e0: 2020 2020 2020 2020 2020 2070 6572 6365             perce
-0001c0f0: 6e74 696c 6573 203d 206c 6973 7428 7065  ntiles = list(pe
-0001c100: 7263 656e 7469 6c65 7329 0a20 2020 2020  rcentiles).     
-0001c110: 2020 2073 7461 7473 203d 205b 0a20 2020     stats = [.   
-0001c120: 2020 2020 2020 2020 206e 756d 2e63 6f75           num.cou
-0001c130: 6e74 2873 706c 6974 5f65 7665 7279 3d73  nt(split_every=s
-0001c140: 706c 6974 5f65 7665 7279 292c 0a20 2020  plit_every),.   
-0001c150: 2020 2020 2020 2020 206e 756d 2e6d 6561           num.mea
-0001c160: 6e28 7370 6c69 745f 6576 6572 793d 7370  n(split_every=sp
-0001c170: 6c69 745f 6576 6572 7929 2c0a 2020 2020  lit_every),.    
-0001c180: 2020 2020 2020 2020 6e75 6d2e 7374 6428          num.std(
-0001c190: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-0001c1a0: 745f 6576 6572 7929 2c0a 2020 2020 2020  t_every),.      
-0001c1b0: 2020 2020 2020 6e75 6d2e 6d69 6e28 7370        num.min(sp
-0001c1c0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-0001c1d0: 6576 6572 7929 2c0a 2020 2020 2020 2020  every),.        
-0001c1e0: 2020 2020 6e75 6d2e 7175 616e 7469 6c65      num.quantile
-0001c1f0: 2870 6572 6365 6e74 696c 6573 2c20 6d65  (percentiles, me
-0001c200: 7468 6f64 3d70 6572 6365 6e74 696c 6573  thod=percentiles
-0001c210: 5f6d 6574 686f 6429 2c0a 2020 2020 2020  _method),.      
-0001c220: 2020 2020 2020 6e75 6d2e 6d61 7828 7370        num.max(sp
-0001c230: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-0001c240: 6576 6572 7929 2c0a 2020 2020 2020 2020  every),.        
-0001c250: 5d0a 2020 2020 2020 2020 7374 6174 735f  ].        stats_
-0001c260: 6e61 6d65 7320 3d20 5b28 732e 5f6e 616d  names = [(s._nam
-0001c270: 652c 2030 2920 666f 7220 7320 696e 2073  e, 0) for s in s
-0001c280: 7461 7473 5d0a 0a20 2020 2020 2020 2063  tats]..        c
-0001c290: 6f6c 6e61 6d65 203d 2064 6174 612e 5f6d  olname = data._m
-0001c2a0: 6574 612e 6e61 6d65 2069 6620 6973 5f73  eta.name if is_s
-0001c2b0: 6572 6965 735f 6c69 6b65 2864 6174 612e  eries_like(data.
-0001c2c0: 5f6d 6574 6129 2065 6c73 6520 4e6f 6e65  _meta) else None
-0001c2d0: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
-0001c2e0: 2022 6465 7363 7269 6265 2d6e 756d 6572   "describe-numer
-0001c2f0: 6963 2d2d 2220 2b20 746f 6b65 6e69 7a65  ic--" + tokenize
-0001c300: 286e 756d 2c20 7370 6c69 745f 6576 6572  (num, split_ever
-0001c310: 7929 0a20 2020 2020 2020 206c 6179 6572  y).        layer
-0001c320: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0001c330: 2028 6e61 6d65 2c20 3029 3a20 280a 2020   (name, 0): (.  
-0001c340: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-0001c350: 7468 6f64 732e 6465 7363 7269 6265 5f6e  thods.describe_n
-0001c360: 756d 6572 6963 5f61 6767 7265 6761 7465  umeric_aggregate
-0001c370: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001c380: 2020 7374 6174 735f 6e61 6d65 732c 0a20    stats_names,. 
-0001c390: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001c3a0: 6f6c 6e61 6d65 2c0a 2020 2020 2020 2020  olname,.        
-0001c3b0: 2020 2020 2020 2020 6973 5f74 696d 6564          is_timed
-0001c3c0: 656c 7461 5f63 6f6c 756d 6e2c 0a20 2020  elta_column,.   
-0001c3d0: 2020 2020 2020 2020 2020 2020 2069 735f               is_
-0001c3e0: 6461 7465 7469 6d65 5f63 6f6c 756d 6e2c  datetime_column,
-0001c3f0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001c400: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-0001c410: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-0001c420: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-0001c430: 6c65 6374 696f 6e73 286e 616d 652c 206c  lections(name, l
-0001c440: 6179 6572 2c20 6465 7065 6e64 656e 6369  ayer, dependenci
-0001c450: 6573 3d73 7461 7473 290a 2020 2020 2020  es=stats).      
-0001c460: 2020 6d65 7461 203d 206e 756d 2e5f 6d65    meta = num._me
-0001c470: 7461 5f6e 6f6e 656d 7074 792e 6465 7363  ta_nonempty.desc
-0001c480: 7269 6265 2829 0a20 2020 2020 2020 2072  ribe().        r
-0001c490: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
-0001c4a0: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
-0001c4b0: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
-0001c4c0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d29 0a0a  =[None, None])..
-0001c4d0: 2020 2020 6465 6620 5f64 6573 6372 6962      def _describ
-0001c4e0: 655f 6e6f 6e6e 756d 6572 6963 5f31 6428  e_nonnumeric_1d(
-0001c4f0: 0a20 2020 2020 2020 2073 656c 662c 2064  .        self, d
-0001c500: 6174 612c 2073 706c 6974 5f65 7665 7279  ata, split_every
-0001c510: 3d46 616c 7365 2c20 6461 7465 7469 6d65  =False, datetime
-0001c520: 5f69 735f 6e75 6d65 7269 633d 4661 6c73  _is_numeric=Fals
-0001c530: 650a 2020 2020 293a 0a20 2020 2020 2020  e.    ):.       
-0001c540: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
-0001c550: 7261 6d65 2e6e 756d 6572 6963 2069 6d70  rame.numeric imp
-0001c560: 6f72 7420 746f 5f6e 756d 6572 6963 0a0a  ort to_numeric..
-0001c570: 2020 2020 2020 2020 7663 6f75 6e74 7320          vcounts 
-0001c580: 3d20 6461 7461 2e76 616c 7565 5f63 6f75  = data.value_cou
-0001c590: 6e74 7328 7370 6c69 745f 6576 6572 793d  nts(split_every=
-0001c5a0: 7370 6c69 745f 6576 6572 7929 0a20 2020  split_every).   
-0001c5b0: 2020 2020 2063 6f75 6e74 5f6e 6f6e 7a65       count_nonze
-0001c5c0: 726f 203d 2076 636f 756e 7473 5b76 636f  ro = vcounts[vco
-0001c5d0: 756e 7473 2021 3d20 305d 0a20 2020 2020  unts != 0].     
-0001c5e0: 2020 2063 6f75 6e74 5f75 6e69 7175 6520     count_unique 
-0001c5f0: 3d20 636f 756e 745f 6e6f 6e7a 6572 6f2e  = count_nonzero.
-0001c600: 7369 7a65 0a0a 2020 2020 2020 2020 7374  size..        st
-0001c610: 6174 7320 3d20 5b0a 2020 2020 2020 2020  ats = [.        
-0001c620: 2020 2020 2320 6e75 6e69 7175 650a 2020      # nunique.  
-0001c630: 2020 2020 2020 2020 2020 636f 756e 745f            count_
-0001c640: 756e 6971 7565 2c0a 2020 2020 2020 2020  unique,.        
-0001c650: 2020 2020 2320 636f 756e 740a 2020 2020      # count.    
-0001c660: 2020 2020 2020 2020 6461 7461 2e63 6f75          data.cou
-0001c670: 6e74 2873 706c 6974 5f65 7665 7279 3d73  nt(split_every=s
-0001c680: 706c 6974 5f65 7665 7279 292c 0a20 2020  plit_every),.   
-0001c690: 2020 2020 2020 2020 2023 206d 6f73 7420           # most 
-0001c6a0: 636f 6d6d 6f6e 2076 616c 7565 0a20 2020  common value.   
-0001c6b0: 2020 2020 2020 2020 2076 636f 756e 7473           vcounts
-0001c6c0: 2e5f 6865 6164 2831 2c20 6e70 6172 7469  ._head(1, nparti
-0001c6d0: 7469 6f6e 733d 312c 2063 6f6d 7075 7465  tions=1, compute
-0001c6e0: 3d46 616c 7365 2c20 7361 6665 3d46 616c  =False, safe=Fal
-0001c6f0: 7365 292c 0a20 2020 2020 2020 205d 0a0a  se),.        ]..
-0001c700: 2020 2020 2020 2020 6966 2069 735f 6461          if is_da
-0001c710: 7465 7469 6d65 3634 5f61 6e79 5f64 7479  tetime64_any_dty
-0001c720: 7065 2864 6174 612e 5f6d 6574 6129 2061  pe(data._meta) a
-0001c730: 6e64 206e 6f74 2064 6174 6574 696d 655f  nd not datetime_
-0001c740: 6973 5f6e 756d 6572 6963 3a0a 2020 2020  is_numeric:.    
-0001c750: 2020 2020 2020 2020 6d69 6e5f 7473 203d          min_ts =
-0001c760: 2074 6f5f 6e75 6d65 7269 6328 6461 7461   to_numeric(data
-0001c770: 2e64 726f 706e 6128 2929 2e6d 696e 2873  .dropna()).min(s
-0001c780: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-0001c790: 5f65 7665 7279 290a 2020 2020 2020 2020  _every).        
-0001c7a0: 2020 2020 6d61 785f 7473 203d 2074 6f5f      max_ts = to_
-0001c7b0: 6e75 6d65 7269 6328 6461 7461 2e64 726f  numeric(data.dro
-0001c7c0: 706e 6128 2929 2e6d 6178 2873 706c 6974  pna()).max(split
-0001c7d0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-0001c7e0: 7279 290a 2020 2020 2020 2020 2020 2020  ry).            
-0001c7f0: 7374 6174 732e 6578 7465 6e64 285b 6d69  stats.extend([mi
-0001c800: 6e5f 7473 2c20 6d61 785f 7473 5d29 0a0a  n_ts, max_ts])..
-0001c810: 2020 2020 2020 2020 7374 6174 735f 6e61          stats_na
-0001c820: 6d65 7320 3d20 5b28 732e 5f6e 616d 652c  mes = [(s._name,
-0001c830: 2030 2920 666f 7220 7320 696e 2073 7461   0) for s in sta
-0001c840: 7473 5d0a 2020 2020 2020 2020 636f 6c6e  ts].        coln
-0001c850: 616d 6520 3d20 6461 7461 2e5f 6d65 7461  ame = data._meta
-0001c860: 2e6e 616d 650a 0a20 2020 2020 2020 206e  .name..        n
-0001c870: 616d 6520 3d20 2264 6573 6372 6962 652d  ame = "describe-
-0001c880: 6e6f 6e6e 756d 6572 6963 2d31 642d 2d22  nonnumeric-1d--"
-0001c890: 202b 2074 6f6b 656e 697a 6528 6461 7461   + tokenize(data
-0001c8a0: 2c20 7370 6c69 745f 6576 6572 7929 0a20  , split_every). 
-0001c8b0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
-0001c8c0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
-0001c8d0: 6d65 2c20 3029 3a20 286d 6574 686f 6473  me, 0): (methods
-0001c8e0: 2e64 6573 6372 6962 655f 6e6f 6e6e 756d  .describe_nonnum
-0001c8f0: 6572 6963 5f61 6767 7265 6761 7465 2c20  eric_aggregate, 
-0001c900: 7374 6174 735f 6e61 6d65 732c 2063 6f6c  stats_names, col
-0001c910: 6e61 6d65 290a 2020 2020 2020 2020 7d0a  name).        }.
-0001c920: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
-0001c930: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-0001c940: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-0001c950: 6e61 6d65 2c20 6c61 7965 722c 2064 6570  name, layer, dep
-0001c960: 656e 6465 6e63 6965 733d 7374 6174 7329  endencies=stats)
-0001c970: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0001c980: 2050 414e 4441 535f 4754 5f32 3030 3a0a   PANDAS_GT_200:.
-0001c990: 2020 2020 2020 2020 2020 2020 6461 7465              date
-0001c9a0: 7469 6d65 5f69 735f 6e75 6d65 7269 635f  time_is_numeric_
-0001c9b0: 6b77 6172 6720 3d20 7b22 6461 7465 7469  kwarg = {"dateti
-0001c9c0: 6d65 5f69 735f 6e75 6d65 7269 6322 3a20  me_is_numeric": 
-0001c9d0: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
-0001c9e0: 7269 637d 0a20 2020 2020 2020 2065 6c73  ric}.        els
-0001c9f0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-0001ca00: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
-0001ca10: 6963 5f6b 7761 7267 203d 207b 7d0a 2020  ic_kwarg = {}.  
-0001ca20: 2020 2020 2020 6d65 7461 203d 2064 6174        meta = dat
-0001ca30: 612e 5f6d 6574 615f 6e6f 6e65 6d70 7479  a._meta_nonempty
-0001ca40: 2e64 6573 6372 6962 6528 2a2a 6461 7465  .describe(**date
-0001ca50: 7469 6d65 5f69 735f 6e75 6d65 7269 635f  time_is_numeric_
-0001ca60: 6b77 6172 6729 0a20 2020 2020 2020 2072  kwarg).        r
-0001ca70: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
-0001ca80: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
-0001ca90: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
-0001caa0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d29 0a0a  =[None, None])..
-0001cab0: 2020 2020 6465 6620 5f63 756d 5f61 6767      def _cum_agg
-0001cac0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-0001cad0: 6f70 5f6e 616d 652c 2063 6875 6e6b 2c20  op_name, chunk, 
-0001cae0: 6167 6772 6567 6174 652c 2061 7869 732c  aggregate, axis,
-0001caf0: 2073 6b69 706e 613d 5472 7565 2c20 6368   skipna=True, ch
-0001cb00: 756e 6b5f 6b77 6172 6773 3d4e 6f6e 652c  unk_kwargs=None,
-0001cb10: 206f 7574 3d4e 6f6e 650a 2020 2020 293a   out=None.    ):
-0001cb20: 0a20 2020 2020 2020 2022 2222 5772 6170  .        """Wrap
-0001cb30: 7065 7220 666f 7220 6375 6d75 6c61 7469  per for cumulati
-0001cb40: 7665 206f 7065 7261 7469 6f6e 2222 220a  ve operation""".
-0001cb50: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
-0001cb60: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
-0001cb70: 7869 7328 6178 6973 290a 0a20 2020 2020  xis(axis)..     
-0001cb80: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
-0001cb90: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-0001cba0: 6520 3d20 6622 7b73 656c 662e 5f74 6f6b  e = f"{self._tok
-0001cbb0: 656e 5f70 7265 6669 787d 7b6f 705f 6e61  en_prefix}{op_na
-0001cbc0: 6d65 7d28 6178 6973 3d31 2922 0a20 2020  me}(axis=1)".   
-0001cbd0: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-0001cbe0: 3d20 7365 6c66 2e6d 6170 5f70 6172 7469  = self.map_parti
-0001cbf0: 7469 6f6e 7328 6368 756e 6b2c 2074 6f6b  tions(chunk, tok
-0001cc00: 656e 3d6e 616d 652c 202a 2a63 6875 6e6b  en=name, **chunk
-0001cc10: 5f6b 7761 7267 7329 0a20 2020 2020 2020  _kwargs).       
-0001cc20: 2020 2020 2072 6574 7572 6e20 6861 6e64       return hand
-0001cc30: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
-0001cc40: 6c74 290a 2020 2020 2020 2020 656c 7365  lt).        else
-0001cc50: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0001cc60: 6375 6d75 6c61 7465 2065 6163 6820 7061  cumulate each pa
-0001cc70: 7274 6974 696f 6e73 0a20 2020 2020 2020  rtitions.       
-0001cc80: 2020 2020 206e 616d 6531 203d 2066 227b       name1 = f"{
-0001cc90: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
-0001cca0: 6978 7d7b 6f70 5f6e 616d 657d 2d6d 6170  ix}{op_name}-map
-0001ccb0: 220a 2020 2020 2020 2020 2020 2020 6375  ".            cu
-0001ccc0: 6d70 6172 7420 3d20 6d61 705f 7061 7274  mpart = map_part
-0001ccd0: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-0001cce0: 2020 2020 2020 2020 6368 756e 6b2c 2073          chunk, s
-0001ccf0: 656c 662c 2074 6f6b 656e 3d6e 616d 6531  elf, token=name1
-0001cd00: 2c20 6d65 7461 3d73 656c 662c 202a 2a63  , meta=self, **c
-0001cd10: 6875 6e6b 5f6b 7761 7267 730a 2020 2020  hunk_kwargs.    
-0001cd20: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0001cd30: 2020 2020 2020 206e 616d 6532 203d 2066         name2 = f
-0001cd40: 227b 7365 6c66 2e5f 746f 6b65 6e5f 7072  "{self._token_pr
-0001cd50: 6566 6978 7d7b 6f70 5f6e 616d 657d 2d74  efix}{op_name}-t
-0001cd60: 616b 652d 6c61 7374 220a 2020 2020 2020  ake-last".      
-0001cd70: 2020 2020 2020 6375 6d6c 6173 7420 3d20        cumlast = 
-0001cd80: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-0001cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cda0: 5f74 616b 655f 6c61 7374 2c0a 2020 2020  _take_last,.    
-0001cdb0: 2020 2020 2020 2020 2020 2020 6375 6d70              cump
-0001cdc0: 6172 742c 0a20 2020 2020 2020 2020 2020  art,.           
-0001cdd0: 2020 2020 2073 6b69 706e 612c 0a20 2020       skipna,.   
-0001cde0: 2020 2020 2020 2020 2020 2020 206d 6574               met
-0001cdf0: 613d 6d65 7461 5f73 6572 6965 735f 636f  a=meta_series_co
-0001ce00: 6e73 7472 7563 746f 7228 7365 6c66 2928  nstructor(self)(
-0001ce10: 5b5d 2c20 6474 7970 653d 2266 6c6f 6174  [], dtype="float
-0001ce20: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-0001ce30: 2020 2020 746f 6b65 6e3d 6e61 6d65 322c      token=name2,
-0001ce40: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0001ce50: 2020 2020 2020 2020 2020 2020 7375 6666              suff
-0001ce60: 6978 203d 2074 6f6b 656e 697a 6528 7365  ix = tokenize(se
-0001ce70: 6c66 290a 2020 2020 2020 2020 2020 2020  lf).            
-0001ce80: 6e61 6d65 203d 2066 227b 7365 6c66 2e5f  name = f"{self._
-0001ce90: 746f 6b65 6e5f 7072 6566 6978 7d7b 6f70  token_prefix}{op
-0001cea0: 5f6e 616d 657d 2d7b 7375 6666 6978 7d22  _name}-{suffix}"
-0001ceb0: 0a20 2020 2020 2020 2020 2020 2063 6e61  .            cna
-0001cec0: 6d65 203d 2066 227b 7365 6c66 2e5f 746f  me = f"{self._to
-0001ced0: 6b65 6e5f 7072 6566 6978 7d7b 6f70 5f6e  ken_prefix}{op_n
-0001cee0: 616d 657d 2d63 756d 2d6c 6173 742d 7b73  ame}-cum-last-{s
-0001cef0: 7566 6669 787d 220a 0a20 2020 2020 2020  uffix}"..       
-0001cf00: 2020 2020 2023 2061 6767 7265 6761 7465       # aggregate
-0001cf10: 2063 756d 756c 6174 6564 2070 6172 7469   cumulated parti
-0001cf20: 7369 6f6e 7320 616e 6420 6974 7320 7072  sions and its pr
-0001cf30: 6576 696f 7573 206c 6173 7420 656c 656d  evious last elem
-0001cf40: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
-0001cf50: 6c61 7965 7220 3d20 7b7d 0a20 2020 2020  layer = {}.     
-0001cf60: 2020 2020 2020 206c 6179 6572 5b28 6e61         layer[(na
-0001cf70: 6d65 2c20 3029 5d20 3d20 2863 756d 7061  me, 0)] = (cumpa
-0001cf80: 7274 2e5f 6e61 6d65 2c20 3029 0a0a 2020  rt._name, 0)..  
-0001cf90: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-0001cfa0: 696e 2072 616e 6765 2831 2c20 7365 6c66  in range(1, self
-0001cfb0: 2e6e 7061 7274 6974 696f 6e73 293a 0a20  .npartitions):. 
-0001cfc0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0001cfd0: 2073 746f 7265 2065 6163 6820 6375 6d75   store each cumu
-0001cfe0: 6c61 7469 7665 2073 7465 7020 746f 2067  lative step to g
-0001cff0: 7261 7068 2074 6f20 7265 6475 6365 2063  raph to reduce c
-0001d000: 6f6d 7075 7461 7469 6f6e 0a20 2020 2020  omputation.     
-0001d010: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
-0001d020: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-0001d030: 2020 2020 2020 2020 2020 6c61 7965 725b            layer[
-0001d040: 2863 6e61 6d65 2c20 6929 5d20 3d20 2863  (cname, i)] = (c
-0001d050: 756d 6c61 7374 2e5f 6e61 6d65 2c20 6920  umlast._name, i 
-0001d060: 2d20 3129 0a20 2020 2020 2020 2020 2020  - 1).           
-0001d070: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001d080: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0001d090: 2061 6767 7265 6761 7465 2077 6974 6820   aggregate with 
-0001d0a0: 7072 6576 696f 7573 2063 756d 756c 6174  previous cumulat
-0001d0b0: 696f 6e20 7265 7375 6c74 730a 2020 2020  ion results.    
-0001d0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d0d0: 6c61 7965 725b 2863 6e61 6d65 2c20 6929  layer[(cname, i)
-0001d0e0: 5d20 3d20 280a 2020 2020 2020 2020 2020  ] = (.          
-0001d0f0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-0001d100: 7468 6f64 732e 5f63 756d 5f61 6767 7265  thods._cum_aggre
-0001d110: 6761 7465 5f61 7070 6c79 2c0a 2020 2020  gate_apply,.    
-0001d120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d130: 2020 2020 6167 6772 6567 6174 652c 0a20      aggregate,. 
-0001d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d150: 2020 2020 2020 2028 636e 616d 652c 2069         (cname, i
-0001d160: 202d 2031 292c 0a20 2020 2020 2020 2020   - 1),.         
-0001d170: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-0001d180: 6375 6d6c 6173 742e 5f6e 616d 652c 2069  cumlast._name, i
-0001d190: 202d 2031 292c 0a20 2020 2020 2020 2020   - 1),.         
-0001d1a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001d1b0: 2020 2020 2020 2020 2020 2020 206c 6179               lay
-0001d1c0: 6572 5b28 6e61 6d65 2c20 6929 5d20 3d20  er[(name, i)] = 
-0001d1d0: 2861 6767 7265 6761 7465 2c20 2863 756d  (aggregate, (cum
-0001d1e0: 7061 7274 2e5f 6e61 6d65 2c20 6929 2c20  part._name, i), 
-0001d1f0: 2863 6e61 6d65 2c20 6929 290a 2020 2020  (cname, i)).    
-0001d200: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
-0001d210: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-0001d220: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-0001d230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d240: 206e 616d 652c 206c 6179 6572 2c20 6465   name, layer, de
-0001d250: 7065 6e64 656e 6369 6573 3d5b 6375 6d70  pendencies=[cump
-0001d260: 6172 742c 2063 756d 6c61 7374 5d0a 2020  art, cumlast].  
-0001d270: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001d280: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-0001d290: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
-0001d2a0: 7261 7068 2c20 6e61 6d65 2c20 6368 756e  raph, name, chun
-0001d2b0: 6b28 7365 6c66 2e5f 6d65 7461 292c 2073  k(self._meta), s
-0001d2c0: 656c 662e 6469 7669 7369 6f6e 7329 0a20  elf.divisions). 
-0001d2d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001d2e0: 6e20 6861 6e64 6c65 5f6f 7574 286f 7574  n handle_out(out
-0001d2f0: 2c20 7265 7375 6c74 290a 0a20 2020 2040  , result)..    @
-0001d300: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0001d310: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0001d320: 6566 2063 756d 7375 6d28 7365 6c66 2c20  ef cumsum(self, 
-0001d330: 6178 6973 3d4e 6f6e 652c 2073 6b69 706e  axis=None, skipn
-0001d340: 613d 5472 7565 2c20 6474 7970 653d 4e6f  a=True, dtype=No
-0001d350: 6e65 2c20 6f75 743d 4e6f 6e65 293a 0a20  ne, out=None):. 
-0001d360: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001d370: 6c66 2e5f 6375 6d5f 6167 6728 0a20 2020  lf._cum_agg(.   
-0001d380: 2020 2020 2020 2020 2022 6375 6d73 756d           "cumsum
-0001d390: 222c 0a20 2020 2020 2020 2020 2020 2063  ",.            c
-0001d3a0: 6875 6e6b 3d4d 2e63 756d 7375 6d2c 0a20  hunk=M.cumsum,. 
-0001d3b0: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
-0001d3c0: 6761 7465 3d6d 6574 686f 6473 2e63 756d  gate=methods.cum
-0001d3d0: 7375 6d5f 6167 6772 6567 6174 652c 0a20  sum_aggregate,. 
-0001d3e0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-0001d3f0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-0001d400: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
-0001d410: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-0001d420: 6e6b 5f6b 7761 7267 733d 6469 6374 2861  nk_kwargs=dict(a
-0001d430: 7869 733d 6178 6973 2c20 736b 6970 6e61  xis=axis, skipna
-0001d440: 3d73 6b69 706e 6129 2c0a 2020 2020 2020  =skipna),.      
-0001d450: 2020 2020 2020 6f75 743d 6f75 742c 0a20        out=out,. 
-0001d460: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-0001d470: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0001d480: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0001d490: 6620 6375 6d70 726f 6428 7365 6c66 2c20  f cumprod(self, 
-0001d4a0: 6178 6973 3d4e 6f6e 652c 2073 6b69 706e  axis=None, skipn
-0001d4b0: 613d 5472 7565 2c20 6474 7970 653d 4e6f  a=True, dtype=No
-0001d4c0: 6e65 2c20 6f75 743d 4e6f 6e65 293a 0a20  ne, out=None):. 
-0001d4d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001d4e0: 6c66 2e5f 6375 6d5f 6167 6728 0a20 2020  lf._cum_agg(.   
-0001d4f0: 2020 2020 2020 2020 2022 6375 6d70 726f           "cumpro
-0001d500: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
-0001d510: 6368 756e 6b3d 4d2e 6375 6d70 726f 642c  chunk=M.cumprod,
-0001d520: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
-0001d530: 7265 6761 7465 3d6d 6574 686f 6473 2e63  regate=methods.c
-0001d540: 756d 7072 6f64 5f61 6767 7265 6761 7465  umprod_aggregate
-0001d550: 2c0a 2020 2020 2020 2020 2020 2020 6178  ,.            ax
-0001d560: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
-0001d570: 2020 2020 2073 6b69 706e 613d 736b 6970       skipna=skip
-0001d580: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
-0001d590: 6368 756e 6b5f 6b77 6172 6773 3d64 6963  chunk_kwargs=dic
-0001d5a0: 7428 6178 6973 3d61 7869 732c 2073 6b69  t(axis=axis, ski
-0001d5b0: 706e 613d 736b 6970 6e61 292c 0a20 2020  pna=skipna),.   
-0001d5c0: 2020 2020 2020 2020 206f 7574 3d6f 7574           out=out
-0001d5d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0001d5e0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0001d5f0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0001d600: 2064 6566 2063 756d 6d61 7828 7365 6c66   def cummax(self
-0001d610: 2c20 6178 6973 3d4e 6f6e 652c 2073 6b69  , axis=None, ski
-0001d620: 706e 613d 5472 7565 2c20 6f75 743d 4e6f  pna=True, out=No
-0001d630: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
-0001d640: 7572 6e20 7365 6c66 2e5f 6375 6d5f 6167  urn self._cum_ag
-0001d650: 6728 0a20 2020 2020 2020 2020 2020 2022  g(.            "
-0001d660: 6375 6d6d 6178 222c 0a20 2020 2020 2020  cummax",.       
-0001d670: 2020 2020 2063 6875 6e6b 3d4d 2e63 756d       chunk=M.cum
-0001d680: 6d61 782c 0a20 2020 2020 2020 2020 2020  max,.           
-0001d690: 2061 6767 7265 6761 7465 3d6d 6574 686f   aggregate=metho
-0001d6a0: 6473 2e63 756d 6d61 785f 6167 6772 6567  ds.cummax_aggreg
-0001d6b0: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-0001d6c0: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
-0001d6d0: 2020 2020 2020 2020 736b 6970 6e61 3d73          skipna=s
-0001d6e0: 6b69 706e 612c 0a20 2020 2020 2020 2020  kipna,.         
-0001d6f0: 2020 2063 6875 6e6b 5f6b 7761 7267 733d     chunk_kwargs=
-0001d700: 6469 6374 2861 7869 733d 6178 6973 2c20  dict(axis=axis, 
-0001d710: 736b 6970 6e61 3d73 6b69 706e 6129 2c0a  skipna=skipna),.
-0001d720: 2020 2020 2020 2020 2020 2020 6f75 743d              out=
-0001d730: 6f75 742c 0a20 2020 2020 2020 2029 0a0a  out,.        )..
-0001d740: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0001d750: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0001d760: 2020 2020 6465 6620 6375 6d6d 696e 2873      def cummin(s
-0001d770: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
-0001d780: 736b 6970 6e61 3d54 7275 652c 206f 7574  skipna=True, out
-0001d790: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-0001d7a0: 7265 7475 726e 2073 656c 662e 5f63 756d  return self._cum
-0001d7b0: 5f61 6767 280a 2020 2020 2020 2020 2020  _agg(.          
-0001d7c0: 2020 2263 756d 6d69 6e22 2c0a 2020 2020    "cummin",.    
-0001d7d0: 2020 2020 2020 2020 6368 756e 6b3d 4d2e          chunk=M.
-0001d7e0: 6375 6d6d 696e 2c0a 2020 2020 2020 2020  cummin,.        
-0001d7f0: 2020 2020 6167 6772 6567 6174 653d 6d65      aggregate=me
-0001d800: 7468 6f64 732e 6375 6d6d 696e 5f61 6767  thods.cummin_agg
-0001d810: 7265 6761 7465 2c0a 2020 2020 2020 2020  regate,.        
-0001d820: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
-0001d830: 2020 2020 2020 2020 2020 2073 6b69 706e             skipn
-0001d840: 613d 736b 6970 6e61 2c0a 2020 2020 2020  a=skipna,.      
-0001d850: 2020 2020 2020 6368 756e 6b5f 6b77 6172        chunk_kwar
-0001d860: 6773 3d64 6963 7428 6178 6973 3d61 7869  gs=dict(axis=axi
-0001d870: 732c 2073 6b69 706e 613d 736b 6970 6e61  s, skipna=skipna
-0001d880: 292c 0a20 2020 2020 2020 2020 2020 206f  ),.            o
-0001d890: 7574 3d6f 7574 2c0a 2020 2020 2020 2020  ut=out,.        
-0001d8a0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-0001d8b0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0001d8c0: 6529 0a20 2020 2064 6566 2077 6865 7265  e).    def where
-0001d8d0: 2873 656c 662c 2063 6f6e 642c 206f 7468  (self, cond, oth
-0001d8e0: 6572 3d6e 702e 6e61 6e29 3a0a 2020 2020  er=np.nan):.    
-0001d8f0: 2020 2020 2320 636f 6e64 2061 6e64 206f      # cond and o
-0001d900: 7468 6572 206d 6179 2062 6520 6461 736b  ther may be dask
-0001d910: 2069 6e73 7461 6e63 652c 0a20 2020 2020   instance,.     
-0001d920: 2020 2023 2070 6173 7369 6e67 206d 6170     # passing map
-0001d930: 5f70 6172 7469 7469 6f6e 7320 7669 6120  _partitions via 
-0001d940: 6b65 7977 6f72 6420 7769 6c6c 206e 6f74  keyword will not
-0001d950: 2062 6520 616c 6967 6e65 640a 2020 2020   be aligned.    
-0001d960: 2020 2020 7265 7475 726e 206d 6170 5f70      return map_p
-0001d970: 6172 7469 7469 6f6e 7328 4d2e 7768 6572  artitions(M.wher
-0001d980: 652c 2073 656c 662c 2063 6f6e 642c 206f  e, self, cond, o
-0001d990: 7468 6572 2c20 656e 666f 7263 655f 6d65  ther, enforce_me
-0001d9a0: 7461 6461 7461 3d46 616c 7365 290a 0a20  tadata=False).. 
-0001d9b0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0001d9c0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0001d9d0: 2020 2064 6566 206d 6173 6b28 7365 6c66     def mask(self
-0001d9e0: 2c20 636f 6e64 2c20 6f74 6865 723d 6e70  , cond, other=np
-0001d9f0: 2e6e 616e 293a 0a20 2020 2020 2020 2072  .nan):.        r
-0001da00: 6574 7572 6e20 6d61 705f 7061 7274 6974  eturn map_partit
-0001da10: 696f 6e73 284d 2e6d 6173 6b2c 2073 656c  ions(M.mask, sel
-0001da20: 662c 2063 6f6e 642c 206f 7468 6572 2c20  f, cond, other, 
-0001da30: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-0001da40: 3d46 616c 7365 290a 0a20 2020 2040 6465  =False)..    @de
-0001da50: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0001da60: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0001da70: 206e 6f74 6e75 6c6c 2873 656c 6629 3a0a   notnull(self):.
-0001da80: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001da90: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-0001daa0: 6e73 284d 2e6e 6f74 6e75 6c6c 2c20 656e  ns(M.notnull, en
-0001dab0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
-0001dac0: 616c 7365 290a 0a20 2020 2040 6465 7269  alse)..    @deri
-0001dad0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0001dae0: 4672 616d 6529 0a20 2020 2064 6566 2069  Frame).    def i
-0001daf0: 736e 756c 6c28 7365 6c66 293a 0a20 2020  snull(self):.   
-0001db00: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001db10: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-0001db20: 4d2e 6973 6e75 6c6c 2c20 656e 666f 7263  M.isnull, enforc
-0001db30: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-0001db40: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-0001db50: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0001db60: 6529 0a20 2020 2064 6566 2069 736e 6128  e).    def isna(
-0001db70: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
-0001db80: 6620 6861 7361 7474 7228 7064 2c20 2269  f hasattr(pd, "i
-0001db90: 736e 6122 293a 0a20 2020 2020 2020 2020  sna"):.         
-0001dba0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-0001dbb0: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
-0001dbc0: 6973 6e61 2c20 656e 666f 7263 655f 6d65  isna, enforce_me
-0001dbd0: 7461 6461 7461 3d46 616c 7365 290a 2020  tadata=False).  
-0001dbe0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001dbf0: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-0001dc00: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-0001dc10: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0001dc20: 2020 2022 4e65 6564 206d 6f72 6520 7265     "Need more re
-0001dc30: 6365 6e74 2076 6572 7369 6f6e 206f 6620  cent version of 
-0001dc40: 5061 6e64 6173 2022 0a20 2020 2020 2020  Pandas ".       
-0001dc50: 2020 2020 2020 2020 2022 746f 2073 7570           "to sup
-0001dc60: 706f 7274 2069 736e 612e 2022 0a20 2020  port isna. ".   
-0001dc70: 2020 2020 2020 2020 2020 2020 2022 506c               "Pl
-0001dc80: 6561 7365 2075 7365 2069 736e 756c 6c20  ease use isnull 
-0001dc90: 696e 7374 6561 642e 220a 2020 2020 2020  instead.".      
-0001dca0: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
-0001dcb0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0001dcc0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0001dcd0: 2069 7369 6e28 7365 6c66 2c20 7661 6c75   isin(self, valu
-0001dce0: 6573 293a 0a20 2020 2020 2020 2069 6620  es):.        if 
-0001dcf0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-0001dd00: 6528 7365 6c66 2e5f 6d65 7461 293a 0a20  e(self._meta):. 
-0001dd10: 2020 2020 2020 2020 2020 2023 2044 6174             # Dat
-0001dd20: 6146 7261 6d65 2e69 7369 6e20 646f 6573  aFrame.isin does
-0001dd30: 2077 6569 7264 2061 6c69 676e 6d65 6e74   weird alignment
-0001dd40: 2073 7475 6666 0a20 2020 2020 2020 2020   stuff.         
-0001dd50: 2020 2062 6164 5f74 7970 6573 203d 2028     bad_types = (
-0001dd60: 5f46 7261 6d65 2c20 7064 2e53 6572 6965  _Frame, pd.Serie
-0001dd70: 732c 2070 642e 4461 7461 4672 616d 6529  s, pd.DataFrame)
-0001dd80: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0001dd90: 2020 2020 2020 2020 2020 2062 6164 5f74             bad_t
-0001dda0: 7970 6573 203d 2028 5f46 7261 6d65 2c29  ypes = (_Frame,)
+0000e0a0: 2064 6976 6973 696f 6e73 2069 7320 6e6f   divisions is no
+0000e0b0: 7420 4e6f 6e65 2c0a 2020 2020 2020 2020  t None,.        
+0000e0c0: 2020 2020 2020 2020 2020 2020 6e70 6172              npar
+0000e0d0: 7469 7469 6f6e 7320 6973 206e 6f74 204e  titions is not N
+0000e0e0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0000e0f0: 2020 2020 2020 2020 2066 7265 7120 6973           freq is
+0000e100: 206e 6f74 204e 6f6e 652c 0a20 2020 2020   not None,.     
+0000e110: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+0000e120: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000e130: 2020 2020 2020 2021 3d20 310a 2020 2020         != 1.    
+0000e140: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+0000e150: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0000e160: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0000e170: 2020 2020 2022 506c 6561 7365 2070 726f       "Please pro
+0000e180: 7669 6465 2065 7861 6374 6c79 206f 6e65  vide exactly one
+0000e190: 206f 6620 6060 6e70 6172 7469 7469 6f6e   of ``npartition
+0000e1a0: 733d 6060 2c20 6060 6672 6571 3d60 602c  s=``, ``freq=``,
+0000e1b0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0000e1c0: 2020 2022 6060 6469 7669 7369 6f6e 733d     "``divisions=
+0000e1d0: 6060 2c20 6060 7061 7274 6974 696f 6e5f  ``, ``partition_
+0000e1e0: 7369 7a65 3d60 6020 6b65 7977 6f72 6420  size=`` keyword 
+0000e1f0: 6172 6775 6d65 6e74 7322 0a20 2020 2020  arguments".     
+0000e200: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000e210: 2020 6966 2070 6172 7469 7469 6f6e 5f73    if partition_s
+0000e220: 697a 6520 6973 206e 6f74 204e 6f6e 653a  ize is not None:
+0000e230: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000e240: 7572 6e20 7265 7061 7274 6974 696f 6e5f  urn repartition_
+0000e250: 7369 7a65 2873 656c 662c 2070 6172 7469  size(self, parti
+0000e260: 7469 6f6e 5f73 697a 6529 0a20 2020 2020  tion_size).     
+0000e270: 2020 2065 6c69 6620 6e70 6172 7469 7469     elif npartiti
+0000e280: 6f6e 7320 6973 206e 6f74 204e 6f6e 653a  ons is not None:
+0000e290: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000e2a0: 7572 6e20 7265 7061 7274 6974 696f 6e5f  urn repartition_
+0000e2b0: 6e70 6172 7469 7469 6f6e 7328 7365 6c66  npartitions(self
+0000e2c0: 2c20 6e70 6172 7469 7469 6f6e 7329 0a20  , npartitions). 
+0000e2d0: 2020 2020 2020 2065 6c69 6620 6469 7669         elif divi
+0000e2e0: 7369 6f6e 7320 6973 206e 6f74 204e 6f6e  sions is not Non
+0000e2f0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0000e300: 6574 7572 6e20 7265 7061 7274 6974 696f  eturn repartitio
+0000e310: 6e28 7365 6c66 2c20 6469 7669 7369 6f6e  n(self, division
+0000e320: 732c 2066 6f72 6365 3d66 6f72 6365 290a  s, force=force).
+0000e330: 2020 2020 2020 2020 656c 6966 2066 7265          elif fre
+0000e340: 7120 6973 206e 6f74 204e 6f6e 653a 0a20  q is not None:. 
+0000e350: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000e360: 6e20 7265 7061 7274 6974 696f 6e5f 6672  n repartition_fr
+0000e370: 6571 2873 656c 662c 2066 7265 713d 6672  eq(self, freq=fr
+0000e380: 6571 290a 0a20 2020 2064 6566 2073 6875  eq)..    def shu
+0000e390: 6666 6c65 280a 2020 2020 2020 2020 7365  ffle(.        se
+0000e3a0: 6c66 2c0a 2020 2020 2020 2020 6f6e 2c0a  lf,.        on,.
+0000e3b0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0000e3c0: 6f6e 733d 4e6f 6e65 2c0a 2020 2020 2020  ons=None,.      
+0000e3d0: 2020 6d61 785f 6272 616e 6368 3d4e 6f6e    max_branch=Non
+0000e3e0: 652c 0a20 2020 2020 2020 2073 6875 6666  e,.        shuff
+0000e3f0: 6c65 3d4e 6f6e 652c 0a20 2020 2020 2020  le=None,.       
+0000e400: 2069 676e 6f72 655f 696e 6465 783d 4661   ignore_index=Fa
+0000e410: 6c73 652c 0a20 2020 2020 2020 2063 6f6d  lse,.        com
+0000e420: 7075 7465 3d4e 6f6e 652c 0a20 2020 2029  pute=None,.    )
+0000e430: 3a0a 2020 2020 2020 2020 2222 2252 6561  :.        """Rea
+0000e440: 7272 616e 6765 2044 6174 6146 7261 6d65  rrange DataFrame
+0000e450: 2069 6e74 6f20 6e65 7720 7061 7274 6974   into new partit
+0000e460: 696f 6e73 0a0a 2020 2020 2020 2020 5573  ions..        Us
+0000e470: 6573 2068 6173 6869 6e67 206f 6620 606f  es hashing of `o
+0000e480: 6e60 2074 6f20 6d61 7020 726f 7773 2074  n` to map rows t
+0000e490: 6f20 6f75 7470 7574 2070 6172 7469 7469  o output partiti
+0000e4a0: 6f6e 732e 2041 6674 6572 2074 6869 730a  ons. After this.
+0000e4b0: 2020 2020 2020 2020 6f70 6572 6174 696f          operatio
+0000e4c0: 6e2c 2072 6f77 7320 7769 7468 2074 6865  n, rows with the
+0000e4d0: 2073 616d 6520 7661 6c75 6520 6f66 2060   same value of `
+0000e4e0: 6f6e 6020 7769 6c6c 2062 6520 696e 2074  on` will be in t
+0000e4f0: 6865 2073 616d 650a 2020 2020 2020 2020  he same.        
+0000e500: 7061 7274 6974 696f 6e2e 0a0a 2020 2020  partition...    
+0000e510: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0000e520: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000e530: 2d0a 2020 2020 2020 2020 6f6e 203a 2073  -.        on : s
+0000e540: 7472 2c20 6c69 7374 206f 6620 7374 722c  tr, list of str,
+0000e550: 206f 7220 5365 7269 6573 2c20 496e 6465   or Series, Inde
+0000e560: 782c 206f 7220 4461 7461 4672 616d 650a  x, or DataFrame.
+0000e570: 2020 2020 2020 2020 2020 2020 436f 6c75              Colu
+0000e580: 6d6e 2873 2920 6f72 2069 6e64 6578 2074  mn(s) or index t
+0000e590: 6f20 6265 2075 7365 6420 746f 206d 6170  o be used to map
+0000e5a0: 2072 6f77 7320 746f 206f 7574 7075 7420   rows to output 
+0000e5b0: 7061 7274 6974 696f 6e73 0a20 2020 2020  partitions.     
+0000e5c0: 2020 206e 7061 7274 6974 696f 6e73 203a     npartitions :
+0000e5d0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
+0000e5e0: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
+0000e5f0: 7220 6f66 2070 6172 7469 7469 6f6e 7320  r of partitions 
+0000e600: 6f66 206f 7574 7075 742e 2050 6172 7469  of output. Parti
+0000e610: 7469 6f6e 2063 6f75 6e74 2077 696c 6c20  tion count will 
+0000e620: 6e6f 7420 6265 0a20 2020 2020 2020 2020  not be.         
+0000e630: 2020 2063 6861 6e67 6564 2062 7920 6465     changed by de
+0000e640: 6661 756c 742e 0a20 2020 2020 2020 206d  fault..        m
+0000e650: 6178 5f62 7261 6e63 683a 2069 6e74 2c20  ax_branch: int, 
+0000e660: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0000e670: 2020 2020 2054 6865 206d 6178 696d 756d       The maximum
+0000e680: 206e 756d 6265 7220 6f66 2073 706c 6974   number of split
+0000e690: 7320 7065 7220 696e 7075 7420 7061 7274  s per input part
+0000e6a0: 6974 696f 6e2e 2055 7365 6420 7769 7468  ition. Used with
+0000e6b0: 696e 0a20 2020 2020 2020 2020 2020 2074  in.            t
+0000e6c0: 6865 2073 7461 6765 6420 7368 7566 666c  he staged shuffl
+0000e6d0: 696e 6720 616c 676f 7269 7468 6d2e 0a20  ing algorithm.. 
+0000e6e0: 2020 2020 2020 2073 6875 6666 6c65 3a20         shuffle: 
+0000e6f0: 7b27 6469 736b 272c 2027 7461 736b 7327  {'disk', 'tasks'
+0000e700: 7d2c 206f 7074 696f 6e61 6c0a 2020 2020  }, optional.    
+0000e710: 2020 2020 2020 2020 4569 7468 6572 2060          Either `
+0000e720: 6027 6469 736b 2760 6020 666f 7220 7369  `'disk'`` for si
+0000e730: 6e67 6c65 2d6e 6f64 6520 6f70 6572 6174  ngle-node operat
+0000e740: 696f 6e20 6f72 2060 6027 7461 736b 7327  ion or ``'tasks'
+0000e750: 6060 2066 6f72 0a20 2020 2020 2020 2020  `` for.         
+0000e760: 2020 2064 6973 7472 6962 7574 6564 206f     distributed o
+0000e770: 7065 7261 7469 6f6e 2e20 2057 696c 6c20  peration.  Will 
+0000e780: 6265 2069 6e66 6572 7265 6420 6279 2079  be inferred by y
+0000e790: 6f75 7220 6375 7272 656e 7420 7363 6865  our current sche
+0000e7a0: 6475 6c65 722e 0a20 2020 2020 2020 2069  duler..        i
+0000e7b0: 676e 6f72 655f 696e 6465 783a 2062 6f6f  gnore_index: boo
+0000e7c0: 6c2c 2064 6566 6175 6c74 2046 616c 7365  l, default False
+0000e7d0: 0a20 2020 2020 2020 2020 2020 2049 676e  .            Ign
+0000e7e0: 6f72 6520 696e 6465 7820 6475 7269 6e67  ore index during
+0000e7f0: 2073 6875 6666 6c65 2e20 2049 6620 6060   shuffle.  If ``
+0000e800: 5472 7565 6060 2c20 7065 7266 6f72 6d61  True``, performa
+0000e810: 6e63 6520 6d61 7920 696d 7072 6f76 652c  nce may improve,
+0000e820: 0a20 2020 2020 2020 2020 2020 2062 7574  .            but
+0000e830: 2069 6e64 6578 2076 616c 7565 7320 7769   index values wi
+0000e840: 6c6c 206e 6f74 2062 6520 7072 6573 6572  ll not be preser
+0000e850: 7665 642e 0a20 2020 2020 2020 2063 6f6d  ved..        com
+0000e860: 7075 7465 3a20 626f 6f6c 0a20 2020 2020  pute: bool.     
+0000e870: 2020 2020 2020 2057 6865 7468 6572 206f         Whether o
+0000e880: 7220 6e6f 7420 746f 2074 7269 6767 6572  r not to trigger
+0000e890: 2061 6e20 696d 6d65 6469 6174 6520 636f   an immediate co
+0000e8a0: 6d70 7574 6174 696f 6e2e 2044 6566 6175  mputation. Defau
+0000e8b0: 6c74 7320 746f 2046 616c 7365 2e0a 0a20  lts to False... 
+0000e8c0: 2020 2020 2020 204e 6f74 6573 0a20 2020         Notes.   
+0000e8d0: 2020 2020 202d 2d2d 2d2d 0a20 2020 2020       -----.     
+0000e8e0: 2020 2054 6869 7320 646f 6573 206e 6f74     This does not
+0000e8f0: 2070 7265 7365 7276 6520 6120 6d65 616e   preserve a mean
+0000e900: 696e 6766 756c 2069 6e64 6578 2f70 6172  ingful index/par
+0000e910: 7469 7469 6f6e 696e 6720 7363 6865 6d65  titioning scheme
+0000e920: 2e20 5468 6973 0a20 2020 2020 2020 2069  . This.        i
+0000e930: 7320 6e6f 7420 6465 7465 726d 696e 6973  s not determinis
+0000e940: 7469 6320 6966 2064 6f6e 6520 696e 2070  tic if done in p
+0000e950: 6172 616c 6c65 6c2e 0a0a 2020 2020 2020  arallel...      
+0000e960: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
+0000e970: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+0000e980: 2020 2020 3e3e 3e20 6466 203d 2064 662e      >>> df = df.
+0000e990: 7368 7566 666c 6528 6466 2e63 6f6c 756d  shuffle(df.colum
+0000e9a0: 6e73 5b30 5d29 2020 2320 646f 6374 6573  ns[0])  # doctes
+0000e9b0: 743a 202b 534b 4950 0a20 2020 2020 2020  t: +SKIP.       
+0000e9c0: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+0000e9d0: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
+0000e9e0: 2e73 6875 6666 6c65 2069 6d70 6f72 7420  .shuffle import 
+0000e9f0: 7368 7566 666c 6520 6173 2064 645f 7368  shuffle as dd_sh
+0000ea00: 7566 666c 650a 0a20 2020 2020 2020 2072  uffle..        r
+0000ea10: 6574 7572 6e20 6464 5f73 6875 6666 6c65  eturn dd_shuffle
+0000ea20: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0000ea30: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+0000ea40: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0000ea50: 6e70 6172 7469 7469 6f6e 733d 6e70 6172  npartitions=npar
+0000ea60: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
+0000ea70: 2020 2020 206d 6178 5f62 7261 6e63 683d       max_branch=
+0000ea80: 6d61 785f 6272 616e 6368 2c0a 2020 2020  max_branch,.    
+0000ea90: 2020 2020 2020 2020 7368 7566 666c 653d          shuffle=
+0000eaa0: 7368 7566 666c 652c 0a20 2020 2020 2020  shuffle,.       
+0000eab0: 2020 2020 2069 676e 6f72 655f 696e 6465       ignore_inde
+0000eac0: 783d 6967 6e6f 7265 5f69 6e64 6578 2c0a  x=ignore_index,.
+0000ead0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+0000eae0: 7574 653d 636f 6d70 7574 652c 0a20 2020  ute=compute,.   
+0000eaf0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+0000eb00: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0000eb10: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+0000eb20: 6669 6c6c 6e61 2873 656c 662c 2076 616c  fillna(self, val
+0000eb30: 7565 3d4e 6f6e 652c 206d 6574 686f 643d  ue=None, method=
+0000eb40: 4e6f 6e65 2c20 6c69 6d69 743d 4e6f 6e65  None, limit=None
+0000eb50: 2c20 6178 6973 3d4e 6f6e 6529 3a0a 2020  , axis=None):.  
+0000eb60: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
+0000eb70: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
+0000eb80: 2861 7869 7329 0a20 2020 2020 2020 2069  (axis).        i
+0000eb90: 6620 6d65 7468 6f64 2069 7320 4e6f 6e65  f method is None
+0000eba0: 2061 6e64 206c 696d 6974 2069 7320 6e6f   and limit is no
+0000ebb0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0000ebc0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+0000ebd0: 6c65 6d65 6e74 6564 4572 726f 7228 2266  lementedError("f
+0000ebe0: 696c 6c6e 6120 7769 7468 2073 6574 206c  illna with set l
+0000ebf0: 696d 6974 2061 6e64 206d 6574 686f 643d  imit and method=
+0000ec00: 4e6f 6e65 2229 0a20 2020 2020 2020 2069  None").        i
+0000ec10: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
+0000ec20: 7565 2c20 285f 4672 616d 652c 2053 6361  ue, (_Frame, Sca
+0000ec30: 6c61 7229 293a 0a20 2020 2020 2020 2020  lar)):.         
+0000ec40: 2020 2074 6573 745f 7661 6c75 6520 3d20     test_value = 
+0000ec50: 7661 6c75 652e 5f6d 6574 615f 6e6f 6e65  value._meta_none
+0000ec60: 6d70 7479 0a20 2020 2020 2020 2065 6c73  mpty.        els
+0000ec70: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
+0000ec80: 6573 745f 7661 6c75 6520 3d20 7661 6c75  est_value = valu
+0000ec90: 650a 2020 2020 2020 2020 6d65 7461 203d  e.        meta =
+0000eca0: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
+0000ecb0: 6d70 7479 2e66 696c 6c6e 6128 0a20 2020  mpty.fillna(.   
+0000ecc0: 2020 2020 2020 2020 2076 616c 7565 3d74           value=t
+0000ecd0: 6573 745f 7661 6c75 652c 206d 6574 686f  est_value, metho
+0000ece0: 643d 6d65 7468 6f64 2c20 6c69 6d69 743d  d=method, limit=
+0000ecf0: 6c69 6d69 742c 2061 7869 733d 6178 6973  limit, axis=axis
+0000ed00: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0000ed10: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
+0000ed20: 206f 7220 6d65 7468 6f64 2069 7320 4e6f   or method is No
+0000ed30: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000ed40: 2320 436f 6e74 726f 6c20 7768 6574 6865  # Control whethe
+0000ed50: 7220 6f72 206e 6f74 2064 6173 6b27 7320  r or not dask's 
+0000ed60: 7061 7274 6974 696f 6e20 616c 6967 6e6d  partition alignm
+0000ed70: 656e 7420 6861 7070 656e 732e 0a20 2020  ent happens..   
+0000ed80: 2020 2020 2020 2020 2023 2057 6520 646f           # We do
+0000ed90: 6e27 7420 7761 6e74 2066 6f72 2061 2070  n't want for a p
+0000eda0: 616e 6461 7320 5365 7269 6573 2e0a 2020  andas Series..  
+0000edb0: 2020 2020 2020 2020 2020 2320 5765 2064            # We d
+0000edc0: 6f20 7761 6e74 2069 7420 666f 7220 6120  o want it for a 
+0000edd0: 6461 736b 2053 6572 6965 730a 2020 2020  dask Series.    
+0000ede0: 2020 2020 2020 2020 6966 2069 735f 7365          if is_se
+0000edf0: 7269 6573 5f6c 696b 6528 7661 6c75 6529  ries_like(value)
+0000ee00: 2061 6e64 206e 6f74 2069 735f 6461 736b   and not is_dask
+0000ee10: 5f63 6f6c 6c65 6374 696f 6e28 7661 6c75  _collection(valu
+0000ee20: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0000ee30: 2020 2020 6172 6773 203d 2028 290a 2020      args = ().  
+0000ee40: 2020 2020 2020 2020 2020 2020 2020 6b77                kw
+0000ee50: 6172 6773 203d 207b 2276 616c 7565 223a  args = {"value":
+0000ee60: 2076 616c 7565 7d0a 2020 2020 2020 2020   value}.        
+0000ee70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000ee80: 2020 2020 2020 2020 2020 6172 6773 203d            args =
+0000ee90: 2028 7661 6c75 652c 290a 2020 2020 2020   (value,).      
+0000eea0: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
+0000eeb0: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
+0000eec0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+0000eed0: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
+0000eee0: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
+0000eef0: 6669 6c6c 6e61 2c0a 2020 2020 2020 2020  fillna,.        
+0000ef00: 2020 2020 2020 2020 2a61 7267 732c 0a20          *args,. 
+0000ef10: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000ef20: 6574 686f 643d 6d65 7468 6f64 2c0a 2020  ethod=method,.  
+0000ef30: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+0000ef40: 6d69 743d 6c69 6d69 742c 0a20 2020 2020  mit=limit,.     
+0000ef50: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+0000ef60: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+0000ef70: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
+0000ef80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ef90: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+0000efa0: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
+0000efb0: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
+0000efc0: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
+0000efd0: 0a0a 2020 2020 2020 2020 6966 206d 6574  ..        if met
+0000efe0: 686f 6420 696e 2028 2270 6164 222c 2022  hod in ("pad", "
+0000eff0: 6666 696c 6c22 293a 0a20 2020 2020 2020  ffill"):.       
+0000f000: 2020 2020 206d 6574 686f 6420 3d20 2266       method = "f
+0000f010: 6669 6c6c 220a 2020 2020 2020 2020 2020  fill".          
+0000f020: 2020 736b 6970 5f63 6865 636b 203d 2030    skip_check = 0
+0000f030: 0a20 2020 2020 2020 2020 2020 2062 6566  .            bef
+0000f040: 6f72 652c 2061 6674 6572 203d 2031 2069  ore, after = 1 i
+0000f050: 6620 6c69 6d69 7420 6973 204e 6f6e 6520  f limit is None 
+0000f060: 656c 7365 206c 696d 6974 2c20 300a 2020  else limit, 0.  
+0000f070: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000f080: 2020 2020 2020 2020 6d65 7468 6f64 203d          method =
+0000f090: 2022 6266 696c 6c22 0a20 2020 2020 2020   "bfill".       
+0000f0a0: 2020 2020 2073 6b69 705f 6368 6563 6b20       skip_check 
+0000f0b0: 3d20 7365 6c66 2e6e 7061 7274 6974 696f  = self.npartitio
+0000f0c0: 6e73 202d 2031 0a20 2020 2020 2020 2020  ns - 1.         
+0000f0d0: 2020 2062 6566 6f72 652c 2061 6674 6572     before, after
+0000f0e0: 203d 2030 2c20 3120 6966 206c 696d 6974   = 0, 1 if limit
+0000f0f0: 2069 7320 4e6f 6e65 2065 6c73 6520 6c69   is None else li
+0000f100: 6d69 740a 0a20 2020 2020 2020 2069 6620  mit..        if 
+0000f110: 6c69 6d69 7420 6973 204e 6f6e 653a 0a20  limit is None:. 
+0000f120: 2020 2020 2020 2020 2020 206e 616d 6520             name 
+0000f130: 3d20 2266 696c 6c6e 612d 6368 756e 6b2d  = "fillna-chunk-
+0000f140: 2220 2b20 746f 6b65 6e69 7a65 2873 656c  " + tokenize(sel
+0000f150: 662c 206d 6574 686f 6429 0a20 2020 2020  f, method).     
+0000f160: 2020 2020 2020 2064 736b 203d 207b 0a20         dsk = {. 
+0000f170: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0000f180: 6e61 6d65 2c20 6929 3a20 280a 2020 2020  name, i): (.    
+0000f190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f1a0: 6d65 7468 6f64 732e 6669 6c6c 6e61 5f63  methods.fillna_c
+0000f1b0: 6865 636b 2c0a 2020 2020 2020 2020 2020  heck,.          
+0000f1c0: 2020 2020 2020 2020 2020 2873 656c 662e            (self.
+0000f1d0: 5f6e 616d 652c 2069 292c 0a20 2020 2020  _name, i),.     
+0000f1e0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000f1f0: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
+0000f200: 2020 2020 2020 2020 2020 2069 2021 3d20             i != 
+0000f210: 736b 6970 5f63 6865 636b 2c0a 2020 2020  skip_check,.    
+0000f220: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000f230: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000f240: 7220 6920 696e 2072 616e 6765 2873 656c  r i in range(sel
+0000f250: 662e 6e70 6172 7469 7469 6f6e 7329 0a20  f.npartitions). 
+0000f260: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+0000f270: 2020 2020 2020 2020 2067 7261 7068 203d           graph =
+0000f280: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
+0000f290: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
+0000f2a0: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
+0000f2b0: 6e64 656e 6369 6573 3d5b 7365 6c66 5d29  ndencies=[self])
+0000f2c0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0000f2d0: 7473 203d 206e 6577 5f64 645f 6f62 6a65  ts = new_dd_obje
+0000f2e0: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
+0000f2f0: 6d65 7461 2c20 7365 6c66 2e64 6976 6973  meta, self.divis
+0000f300: 696f 6e73 290a 2020 2020 2020 2020 656c  ions).        el
+0000f310: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000f320: 7061 7274 7320 3d20 7365 6c66 0a0a 2020  parts = self..  
+0000f330: 2020 2020 2020 7265 7475 726e 2070 6172        return par
+0000f340: 7473 2e6d 6170 5f6f 7665 726c 6170 280a  ts.map_overlap(.
+0000f350: 2020 2020 2020 2020 2020 2020 4d2e 6669              M.fi
+0000f360: 6c6c 6e61 2c20 6265 666f 7265 2c20 6166  llna, before, af
+0000f370: 7465 722c 206d 6574 686f 643d 6d65 7468  ter, method=meth
+0000f380: 6f64 2c20 6c69 6d69 743d 6c69 6d69 742c  od, limit=limit,
+0000f390: 206d 6574 613d 6d65 7461 0a20 2020 2020   meta=meta.     
+0000f3a0: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
+0000f3b0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+0000f3c0: 7261 6d65 290a 2020 2020 6465 6620 6666  rame).    def ff
+0000f3d0: 696c 6c28 7365 6c66 2c20 6178 6973 3d4e  ill(self, axis=N
+0000f3e0: 6f6e 652c 206c 696d 6974 3d4e 6f6e 6529  one, limit=None)
+0000f3f0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000f400: 2073 656c 662e 6669 6c6c 6e61 286d 6574   self.fillna(met
+0000f410: 686f 643d 2266 6669 6c6c 222c 206c 696d  hod="ffill", lim
+0000f420: 6974 3d6c 696d 6974 2c20 6178 6973 3d61  it=limit, axis=a
+0000f430: 7869 7329 0a0a 2020 2020 4064 6572 6976  xis)..    @deriv
+0000f440: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+0000f450: 7261 6d65 290a 2020 2020 6465 6620 6266  rame).    def bf
+0000f460: 696c 6c28 7365 6c66 2c20 6178 6973 3d4e  ill(self, axis=N
+0000f470: 6f6e 652c 206c 696d 6974 3d4e 6f6e 6529  one, limit=None)
+0000f480: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000f490: 2073 656c 662e 6669 6c6c 6e61 286d 6574   self.fillna(met
+0000f4a0: 686f 643d 2262 6669 6c6c 222c 206c 696d  hod="bfill", lim
+0000f4b0: 6974 3d6c 696d 6974 2c20 6178 6973 3d61  it=limit, axis=a
+0000f4c0: 7869 7329 0a0a 2020 2020 6465 6620 7361  xis)..    def sa
+0000f4d0: 6d70 6c65 2873 656c 662c 206e 3d4e 6f6e  mple(self, n=Non
+0000f4e0: 652c 2066 7261 633d 4e6f 6e65 2c20 7265  e, frac=None, re
+0000f4f0: 706c 6163 653d 4661 6c73 652c 2072 616e  place=False, ran
+0000f500: 646f 6d5f 7374 6174 653d 4e6f 6e65 293a  dom_state=None):
+0000f510: 0a20 2020 2020 2020 2022 2222 5261 6e64  .        """Rand
+0000f520: 6f6d 2073 616d 706c 6520 6f66 2069 7465  om sample of ite
+0000f530: 6d73 0a0a 2020 2020 2020 2020 5061 7261  ms..        Para
+0000f540: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0000f550: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000f560: 2020 6e20 3a20 696e 742c 206f 7074 696f    n : int, optio
+0000f570: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0000f580: 4e75 6d62 6572 206f 6620 6974 656d 7320  Number of items 
+0000f590: 746f 2072 6574 7572 6e20 6973 206e 6f74  to return is not
+0000f5a0: 2073 7570 706f 7274 6564 2062 7920 6461   supported by da
+0000f5b0: 736b 2e20 5573 6520 6672 6163 0a20 2020  sk. Use frac.   
+0000f5c0: 2020 2020 2020 2020 2069 6e73 7465 6164           instead
+0000f5d0: 2e0a 2020 2020 2020 2020 6672 6163 203a  ..        frac :
+0000f5e0: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+0000f5f0: 0a20 2020 2020 2020 2020 2020 2041 7070  .            App
+0000f600: 726f 7869 6d61 7465 2066 7261 6374 696f  roximate fractio
+0000f610: 6e20 6f66 2069 7465 6d73 2074 6f20 7265  n of items to re
+0000f620: 7475 726e 2e20 5468 6973 2073 616d 706c  turn. This sampl
+0000f630: 696e 6720 6672 6163 7469 6f6e 2069 730a  ing fraction is.
+0000f640: 2020 2020 2020 2020 2020 2020 6170 706c              appl
+0000f650: 6965 6420 746f 2061 6c6c 2070 6172 7469  ied to all parti
+0000f660: 7469 6f6e 7320 6571 7561 6c6c 792e 204e  tions equally. N
+0000f670: 6f74 6520 7468 6174 2074 6869 7320 6973  ote that this is
+0000f680: 2061 6e0a 2020 2020 2020 2020 2020 2020   an.            
+0000f690: 2a2a 6170 7072 6f78 696d 6174 6520 6672  **approximate fr
+0000f6a0: 6163 7469 6f6e 2a2a 2e20 596f 7520 7368  action**. You sh
+0000f6b0: 6f75 6c64 206e 6f74 2065 7870 6563 7420  ould not expect 
+0000f6c0: 6578 6163 746c 7920 6060 6c65 6e28 6466  exactly ``len(df
+0000f6d0: 2920 2a20 6672 6163 6060 0a20 2020 2020  ) * frac``.     
+0000f6e0: 2020 2020 2020 2069 7465 6d73 2074 6f20         items to 
+0000f6f0: 6265 2072 6574 7572 6e65 642c 2061 7320  be returned, as 
+0000f700: 7468 6520 6578 6163 7420 6e75 6d62 6572  the exact number
+0000f710: 206f 6620 656c 656d 656e 7473 2073 656c   of elements sel
+0000f720: 6563 7465 6420 7769 6c6c 0a20 2020 2020  ected will.     
+0000f730: 2020 2020 2020 2064 6570 656e 6420 6f6e         depend on
+0000f740: 2068 6f77 2079 6f75 7220 6461 7461 2069   how your data i
+0000f750: 7320 7061 7274 6974 696f 6e65 6420 2862  s partitioned (b
+0000f760: 7574 2073 686f 756c 6420 6265 2070 7265  ut should be pre
+0000f770: 7474 7920 636c 6f73 650a 2020 2020 2020  tty close.      
+0000f780: 2020 2020 2020 696e 2070 7261 6374 6963        in practic
+0000f790: 6529 2e0a 2020 2020 2020 2020 7265 706c  e)..        repl
+0000f7a0: 6163 6520 3a20 626f 6f6c 6561 6e2c 206f  ace : boolean, o
+0000f7b0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0000f7c0: 2020 2020 5361 6d70 6c65 2077 6974 6820      Sample with 
+0000f7d0: 6f72 2077 6974 686f 7574 2072 6570 6c61  or without repla
+0000f7e0: 6365 6d65 6e74 2e20 4465 6661 756c 7420  cement. Default 
+0000f7f0: 3d20 4661 6c73 652e 0a20 2020 2020 2020  = False..       
+0000f800: 2072 616e 646f 6d5f 7374 6174 6520 3a20   random_state : 
+0000f810: 696e 7420 6f72 2060 606e 702e 7261 6e64  int or ``np.rand
+0000f820: 6f6d 2e52 616e 646f 6d53 7461 7465 6060  om.RandomState``
+0000f830: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0000f840: 616e 2069 6e74 2c20 7765 2063 7265 6174  an int, we creat
+0000f850: 6520 6120 6e65 7720 5261 6e64 6f6d 5374  e a new RandomSt
+0000f860: 6174 6520 7769 7468 2074 6869 7320 6173  ate with this as
+0000f870: 2074 6865 2073 6565 643b 0a20 2020 2020   the seed;.     
+0000f880: 2020 2020 2020 204f 7468 6572 7769 7365         Otherwise
+0000f890: 2077 6520 6472 6177 2066 726f 6d20 7468   we draw from th
+0000f8a0: 6520 7061 7373 6564 2052 616e 646f 6d53  e passed RandomS
+0000f8b0: 7461 7465 2e0a 0a20 2020 2020 2020 2053  tate...        S
+0000f8c0: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
+0000f8d0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000f8e0: 2044 6174 6146 7261 6d65 2e72 616e 646f   DataFrame.rando
+0000f8f0: 6d5f 7370 6c69 740a 2020 2020 2020 2020  m_split.        
+0000f900: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
+0000f910: 2e73 616d 706c 650a 2020 2020 2020 2020  .sample.        
+0000f920: 2222 220a 2020 2020 2020 2020 6966 206e  """.        if n
+0000f930: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0000f940: 2020 2020 2020 2020 2020 6d73 6720 3d20            msg = 
+0000f950: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000f960: 2020 2273 616d 706c 6520 646f 6573 206e    "sample does n
+0000f970: 6f74 2073 7570 706f 7274 2074 6865 206e  ot support the n
+0000f980: 756d 6265 7220 6f66 2073 616d 706c 6564  umber of sampled
+0000f990: 2069 7465 6d73 2022 0a20 2020 2020 2020   items ".       
+0000f9a0: 2020 2020 2020 2020 2022 7061 7261 6d65           "parame
+0000f9b0: 7465 722c 2027 6e27 2e20 506c 6561 7365  ter, 'n'. Please
+0000f9c0: 2075 7365 2074 6865 2027 6672 6163 2720   use the 'frac' 
+0000f9d0: 7061 7261 6d65 7465 7220 696e 7374 6561  parameter instea
+0000f9e0: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
+0000f9f0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0000fa00: 2069 7369 6e73 7461 6e63 6528 6e2c 204e   isinstance(n, N
+0000fa10: 756d 6265 7229 2061 6e64 2030 203c 3d20  umber) and 0 <= 
+0000fa20: 6e20 3c3d 2031 3a0a 2020 2020 2020 2020  n <= 1:.        
+0000fa30: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0000fa40: 2e77 6172 6e28 6d73 6729 0a20 2020 2020  .warn(msg).     
+0000fa50: 2020 2020 2020 2020 2020 2066 7261 6320             frac 
+0000fa60: 3d20 6e0a 2020 2020 2020 2020 2020 2020  = n.            
+0000fa70: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000fa80: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000fa90: 6545 7272 6f72 286d 7367 290a 0a20 2020  eError(msg)..   
+0000faa0: 2020 2020 2069 6620 6672 6163 2069 7320       if frac is 
+0000fab0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000fac0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0000fad0: 6f72 2822 6672 6163 206d 7573 7420 6e6f  or("frac must no
+0000fae0: 7420 6265 204e 6f6e 6522 290a 0a20 2020  t be None")..   
+0000faf0: 2020 2020 2069 6620 7261 6e64 6f6d 5f73       if random_s
+0000fb00: 7461 7465 2069 7320 4e6f 6e65 3a0a 2020  tate is None:.  
+0000fb10: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
+0000fb20: 5f73 7461 7465 203d 206e 702e 7261 6e64  _state = np.rand
+0000fb30: 6f6d 2e52 616e 646f 6d53 7461 7465 2829  om.RandomState()
+0000fb40: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
+0000fb50: 2022 7361 6d70 6c65 2d22 202b 2074 6f6b   "sample-" + tok
+0000fb60: 656e 697a 6528 7365 6c66 2c20 6672 6163  enize(self, frac
+0000fb70: 2c20 7265 706c 6163 652c 2072 616e 646f  , replace, rando
+0000fb80: 6d5f 7374 6174 6529 0a0a 2020 2020 2020  m_state)..      
+0000fb90: 2020 7374 6174 655f 6461 7461 203d 2072    state_data = r
+0000fba0: 616e 646f 6d5f 7374 6174 655f 6461 7461  andom_state_data
+0000fbb0: 2873 656c 662e 6e70 6172 7469 7469 6f6e  (self.npartition
+0000fbc0: 732c 2072 616e 646f 6d5f 7374 6174 6529  s, random_state)
+0000fbd0: 0a20 2020 2020 2020 2064 736b 203d 207b  .        dsk = {
+0000fbe0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
+0000fbf0: 6d65 2c20 6929 3a20 286d 6574 686f 6473  me, i): (methods
+0000fc00: 2e73 616d 706c 652c 2028 7365 6c66 2e5f  .sample, (self._
+0000fc10: 6e61 6d65 2c20 6929 2c20 7374 6174 652c  name, i), state,
+0000fc20: 2066 7261 632c 2072 6570 6c61 6365 290a   frac, replace).
+0000fc30: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0000fc40: 692c 2073 7461 7465 2069 6e20 656e 756d  i, state in enum
+0000fc50: 6572 6174 6528 7374 6174 655f 6461 7461  erate(state_data
+0000fc60: 290a 2020 2020 2020 2020 7d0a 0a20 2020  ).        }..   
+0000fc70: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+0000fc80: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+0000fc90: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+0000fca0: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
+0000fcb0: 6369 6573 3d5b 7365 6c66 5d29 0a20 2020  cies=[self]).   
+0000fcc0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+0000fcd0: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
+0000fce0: 206e 616d 652c 2073 656c 662e 5f6d 6574   name, self._met
+0000fcf0: 612c 2073 656c 662e 6469 7669 7369 6f6e  a, self.division
+0000fd00: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
+0000fd10: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+0000fd20: 6d65 290a 2020 2020 6465 6620 7265 706c  me).    def repl
+0000fd30: 6163 6528 7365 6c66 2c20 746f 5f72 6570  ace(self, to_rep
+0000fd40: 6c61 6365 3d4e 6f6e 652c 2076 616c 7565  lace=None, value
+0000fd50: 3d4e 6f6e 652c 2072 6567 6578 3d46 616c  =None, regex=Fal
+0000fd60: 7365 293a 0a20 2020 2020 2020 2023 2049  se):.        # I
+0000fd70: 6e20 5041 4e44 4153 5f47 545f 3134 3020  n PANDAS_GT_140 
+0000fd80: 7061 6e64 6173 2073 7461 7274 7320 7573  pandas starts us
+0000fd90: 696e 6720 6e6f 5f64 6566 6175 6c74 2069  ing no_default i
+0000fda0: 6e73 7465 6164 206f 6620 4e6f 6e65 0a20  nstead of None. 
+0000fdb0: 2020 2020 2020 2076 616c 7565 5f6b 7761         value_kwa
+0000fdc0: 7267 203d 207b 2276 616c 7565 223a 2076  rg = {"value": v
+0000fdd0: 616c 7565 7d20 6966 2076 616c 7565 2069  alue} if value i
+0000fde0: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
+0000fdf0: 7b7d 0a20 2020 2020 2020 2072 6574 7572  {}.        retur
+0000fe00: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+0000fe10: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+0000fe20: 2020 204d 2e72 6570 6c61 6365 2c0a 2020     M.replace,.  
+0000fe30: 2020 2020 2020 2020 2020 746f 5f72 6570            to_rep
+0000fe40: 6c61 6365 3d74 6f5f 7265 706c 6163 652c  lace=to_replace,
+0000fe50: 0a20 2020 2020 2020 2020 2020 202a 2a76  .            **v
+0000fe60: 616c 7565 5f6b 7761 7267 2c0a 2020 2020  alue_kwarg,.    
+0000fe70: 2020 2020 2020 2020 7265 6765 783d 7265          regex=re
+0000fe80: 6765 782c 0a20 2020 2020 2020 2020 2020  gex,.           
+0000fe90: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+0000fea0: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
+0000feb0: 2029 0a0a 2020 2020 6465 6620 746f 5f64   )..    def to_d
+0000fec0: 6173 6b5f 6172 7261 7928 7365 6c66 2c20  ask_array(self, 
+0000fed0: 6c65 6e67 7468 733d 4e6f 6e65 2c20 6d65  lengths=None, me
+0000fee0: 7461 3d4e 6f6e 6529 3a0a 2020 2020 2020  ta=None):.      
+0000fef0: 2020 2222 2243 6f6e 7665 7274 2061 2064    """Convert a d
+0000ff00: 6173 6b20 4461 7461 4672 616d 6520 746f  ask DataFrame to
+0000ff10: 2061 2064 6173 6b20 6172 7261 792e 0a0a   a dask array...
+0000ff20: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0000ff30: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0000ff40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6c65  -----.        le
+0000ff50: 6e67 7468 7320 3a20 626f 6f6c 206f 7220  ngths : bool or 
+0000ff60: 5365 7175 656e 6365 206f 6620 696e 7473  Sequence of ints
+0000ff70: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0000ff80: 2020 2020 2020 2048 6f77 2074 6f20 6465         How to de
+0000ff90: 7465 726d 696e 6520 7468 6520 6368 756e  termine the chun
+0000ffa0: 6b73 2073 697a 6573 2066 6f72 2074 6865  ks sizes for the
+0000ffb0: 206f 7574 7075 7420 6172 7261 792e 0a20   output array.. 
+0000ffc0: 2020 2020 2020 2020 2020 2042 7920 6465             By de
+0000ffd0: 6661 756c 742c 2074 6865 206f 7574 7075  fault, the outpu
+0000ffe0: 7420 6172 7261 7920 7769 6c6c 2068 6176  t array will hav
+0000fff0: 6520 756e 6b6e 6f77 6e20 6368 756e 6b20  e unknown chunk 
+00010000: 6c65 6e67 7468 730a 2020 2020 2020 2020  lengths.        
+00010010: 2020 2020 616c 6f6e 6720 7468 6520 6669      along the fi
+00010020: 7273 7420 6178 6973 2c20 7768 6963 6820  rst axis, which 
+00010030: 6361 6e20 6361 7573 6520 736f 6d65 206c  can cause some l
+00010040: 6174 6572 206f 7065 7261 7469 6f6e 730a  ater operations.
+00010050: 2020 2020 2020 2020 2020 2020 746f 2066              to f
+00010060: 6169 6c2e 0a0a 2020 2020 2020 2020 2020  ail...          
+00010070: 2020 2a20 5472 7565 203a 2069 6d6d 6564    * True : immed
+00010080: 6961 7465 6c79 2063 6f6d 7075 7465 2074  iately compute t
+00010090: 6865 206c 656e 6774 6820 6f66 2065 6163  he length of eac
+000100a0: 6820 7061 7274 6974 696f 6e0a 2020 2020  h partition.    
+000100b0: 2020 2020 2020 2020 2a20 5365 7175 656e          * Sequen
+000100c0: 6365 203a 2061 2073 6571 7565 6e63 6520  ce : a sequence 
+000100d0: 6f66 2069 6e74 6567 6572 7320 746f 2075  of integers to u
+000100e0: 7365 2066 6f72 2074 6865 2063 6875 6e6b  se for the chunk
+000100f0: 2073 697a 6573 0a20 2020 2020 2020 2020   sizes.         
+00010100: 2020 2020 206f 6e20 7468 6520 6669 7273       on the firs
+00010110: 7420 6178 6973 2e20 5468 6573 6520 7661  t axis. These va
+00010120: 6c75 6573 2061 7265 202a 6e6f 742a 2076  lues are *not* v
+00010130: 616c 6964 6174 6564 2066 6f72 0a20 2020  alidated for.   
+00010140: 2020 2020 2020 2020 2020 2063 6f72 7265             corre
+00010150: 6374 6e65 7373 2c20 6265 796f 6e64 2065  ctness, beyond e
+00010160: 6e73 7572 696e 6720 7468 6174 2074 6865  nsuring that the
+00010170: 206e 756d 6265 7220 6f66 2069 7465 6d73   number of items
+00010180: 0a20 2020 2020 2020 2020 2020 2020 206d  .              m
+00010190: 6174 6368 6573 2074 6865 206e 756d 6265  atches the numbe
+000101a0: 7220 6f66 2070 6172 7469 7469 6f6e 732e  r of partitions.
+000101b0: 0a20 2020 2020 2020 206d 6574 6120 3a20  .        meta : 
+000101c0: 6f62 6a65 6374 2c20 6f70 7469 6f6e 616c  object, optional
+000101d0: 0a20 2020 2020 2020 2020 2020 2041 6e20  .            An 
+000101e0: 6f70 7469 6f6e 616c 2060 6d65 7461 6020  optional `meta` 
+000101f0: 7061 7261 6d65 7465 7220 6361 6e20 6265  parameter can be
+00010200: 2070 6173 7365 6420 666f 7220 6461 736b   passed for dask
+00010210: 2074 6f20 6f76 6572 7269 6465 2074 6865   to override the
+00010220: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
+00010230: 6175 6c74 206d 6574 6164 6174 6120 6f6e  ault metadata on
+00010240: 2074 6865 2075 6e64 6572 6c79 696e 6720   the underlying 
+00010250: 6461 736b 2061 7272 6179 2e0a 0a20 2020  dask array...   
+00010260: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+00010270: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+00010280: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00010290: 2069 6620 6c65 6e67 7468 7320 6973 2054   if lengths is T
+000102a0: 7275 653a 0a20 2020 2020 2020 2020 2020  rue:.           
+000102b0: 206c 656e 6774 6873 203d 2074 7570 6c65   lengths = tuple
+000102c0: 2873 656c 662e 6d61 705f 7061 7274 6974  (self.map_partit
+000102d0: 696f 6e73 286c 656e 2c20 656e 666f 7263  ions(len, enforc
+000102e0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+000102f0: 292e 636f 6d70 7574 6528 2929 0a0a 2020  ).compute())..  
+00010300: 2020 2020 2020 6172 7220 3d20 7365 6c66        arr = self
+00010310: 2e76 616c 7565 730a 0a20 2020 2020 2020  .values..       
+00010320: 2063 6875 6e6b 7320 3d20 7365 6c66 2e5f   chunks = self._
+00010330: 7661 6c69 6461 7465 5f63 6875 6e6b 7328  validate_chunks(
+00010340: 6172 722c 206c 656e 6774 6873 290a 2020  arr, lengths).  
+00010350: 2020 2020 2020 6172 722e 5f63 6875 6e6b        arr._chunk
+00010360: 7320 3d20 6368 756e 6b73 0a0a 2020 2020  s = chunks..    
+00010370: 2020 2020 6966 206d 6574 6120 6973 206e      if meta is n
+00010380: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00010390: 2020 2020 2061 7272 2e5f 6d65 7461 203d       arr._meta =
+000103a0: 206d 6574 610a 0a20 2020 2020 2020 2072   meta..        r
+000103b0: 6574 7572 6e20 6172 720a 0a20 2020 2064  eturn arr..    d
+000103c0: 6566 2074 6f5f 6864 6628 7365 6c66 2c20  ef to_hdf(self, 
+000103d0: 7061 7468 5f6f 725f 6275 662c 206b 6579  path_or_buf, key
+000103e0: 2c20 6d6f 6465 3d22 6122 2c20 6170 7065  , mode="a", appe
+000103f0: 6e64 3d46 616c 7365 2c20 2a2a 6b77 6172  nd=False, **kwar
+00010400: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+00010410: 5365 6520 6464 2e74 6f5f 6864 6620 646f  See dd.to_hdf do
+00010420: 6373 7472 696e 6720 666f 7220 6d6f 7265  cstring for more
+00010430: 2069 6e66 6f72 6d61 7469 6f6e 2222 220a   information""".
+00010440: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+00010450: 6b2e 6461 7461 6672 616d 652e 696f 2069  k.dataframe.io i
+00010460: 6d70 6f72 7420 746f 5f68 6466 0a0a 2020  mport to_hdf..  
+00010470: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
+00010480: 6864 6628 7365 6c66 2c20 7061 7468 5f6f  hdf(self, path_o
+00010490: 725f 6275 662c 206b 6579 2c20 6d6f 6465  r_buf, key, mode
+000104a0: 2c20 6170 7065 6e64 2c20 2a2a 6b77 6172  , append, **kwar
+000104b0: 6773 290a 0a20 2020 2064 6566 2074 6f5f  gs)..    def to_
+000104c0: 6373 7628 7365 6c66 2c20 6669 6c65 6e61  csv(self, filena
+000104d0: 6d65 2c20 2a2a 6b77 6172 6773 293a 0a20  me, **kwargs):. 
+000104e0: 2020 2020 2020 2022 2222 5365 6520 6464         """See dd
+000104f0: 2e74 6f5f 6373 7620 646f 6373 7472 696e  .to_csv docstrin
+00010500: 6720 666f 7220 6d6f 7265 2069 6e66 6f72  g for more infor
+00010510: 6d61 7469 6f6e 2222 220a 2020 2020 2020  mation""".      
+00010520: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+00010530: 6672 616d 652e 696f 2069 6d70 6f72 7420  frame.io import 
+00010540: 746f 5f63 7376 0a0a 2020 2020 2020 2020  to_csv..        
+00010550: 7265 7475 726e 2074 6f5f 6373 7628 7365  return to_csv(se
+00010560: 6c66 2c20 6669 6c65 6e61 6d65 2c20 2a2a  lf, filename, **
+00010570: 6b77 6172 6773 290a 0a20 2020 2064 6566  kwargs)..    def
+00010580: 2074 6f5f 7371 6c28 0a20 2020 2020 2020   to_sql(.       
+00010590: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
+000105a0: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
+000105b0: 2020 7572 693a 2073 7472 2c0a 2020 2020    uri: str,.    
+000105c0: 2020 2020 7363 6865 6d61 3d4e 6f6e 652c      schema=None,
+000105d0: 0a20 2020 2020 2020 2069 665f 6578 6973  .        if_exis
+000105e0: 7473 3a20 7374 7220 3d20 2266 6169 6c22  ts: str = "fail"
+000105f0: 2c0a 2020 2020 2020 2020 696e 6465 783a  ,.        index:
+00010600: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
+00010610: 2020 2020 2020 696e 6465 785f 6c61 6265        index_labe
+00010620: 6c3d 4e6f 6e65 2c0a 2020 2020 2020 2020  l=None,.        
+00010630: 6368 756e 6b73 697a 653d 4e6f 6e65 2c0a  chunksize=None,.
+00010640: 2020 2020 2020 2020 6474 7970 653d 4e6f          dtype=No
+00010650: 6e65 2c0a 2020 2020 2020 2020 6d65 7468  ne,.        meth
+00010660: 6f64 3d4e 6f6e 652c 0a20 2020 2020 2020  od=None,.       
+00010670: 2063 6f6d 7075 7465 3d54 7275 652c 0a20   compute=True,. 
+00010680: 2020 2020 2020 2070 6172 616c 6c65 6c3d         parallel=
+00010690: 4661 6c73 652c 0a20 2020 2020 2020 2065  False,.        e
+000106a0: 6e67 696e 655f 6b77 6172 6773 3d4e 6f6e  ngine_kwargs=Non
+000106b0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+000106c0: 2020 2222 2253 6565 2064 642e 746f 5f73    """See dd.to_s
+000106d0: 716c 2064 6f63 7374 7269 6e67 2066 6f72  ql docstring for
+000106e0: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+000106f0: 6e22 2222 0a20 2020 2020 2020 2066 726f  n""".        fro
+00010700: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
+00010710: 2e69 6f20 696d 706f 7274 2074 6f5f 7371  .io import to_sq
+00010720: 6c0a 0a20 2020 2020 2020 2072 6574 7572  l..        retur
+00010730: 6e20 746f 5f73 716c 280a 2020 2020 2020  n to_sql(.      
+00010740: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00010750: 2020 2020 2020 2020 6e61 6d65 3d6e 616d          name=nam
+00010760: 652c 0a20 2020 2020 2020 2020 2020 2075  e,.            u
+00010770: 7269 3d75 7269 2c0a 2020 2020 2020 2020  ri=uri,.        
+00010780: 2020 2020 7363 6865 6d61 3d73 6368 656d      schema=schem
+00010790: 612c 0a20 2020 2020 2020 2020 2020 2069  a,.            i
+000107a0: 665f 6578 6973 7473 3d69 665f 6578 6973  f_exists=if_exis
+000107b0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+000107c0: 696e 6465 783d 696e 6465 782c 0a20 2020  index=index,.   
+000107d0: 2020 2020 2020 2020 2069 6e64 6578 5f6c           index_l
+000107e0: 6162 656c 3d69 6e64 6578 5f6c 6162 656c  abel=index_label
+000107f0: 2c0a 2020 2020 2020 2020 2020 2020 6368  ,.            ch
+00010800: 756e 6b73 697a 653d 6368 756e 6b73 697a  unksize=chunksiz
+00010810: 652c 0a20 2020 2020 2020 2020 2020 2064  e,.            d
+00010820: 7479 7065 3d64 7479 7065 2c0a 2020 2020  type=dtype,.    
+00010830: 2020 2020 2020 2020 6d65 7468 6f64 3d6d          method=m
+00010840: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
+00010850: 2020 2063 6f6d 7075 7465 3d63 6f6d 7075     compute=compu
+00010860: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+00010870: 7061 7261 6c6c 656c 3d70 6172 616c 6c65  parallel=paralle
+00010880: 6c2c 0a20 2020 2020 2020 2020 2020 2065  l,.            e
+00010890: 6e67 696e 655f 6b77 6172 6773 3d65 6e67  ngine_kwargs=eng
+000108a0: 696e 655f 6b77 6172 6773 2c0a 2020 2020  ine_kwargs,.    
+000108b0: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
+000108c0: 6f5f 6a73 6f6e 2873 656c 662c 2066 696c  o_json(self, fil
+000108d0: 656e 616d 652c 202a 6172 6773 2c20 2a2a  ename, *args, **
+000108e0: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+000108f0: 2022 2222 5365 6520 6464 2e74 6f5f 6a73   """See dd.to_js
+00010900: 6f6e 2064 6f63 7374 7269 6e67 2066 6f72  on docstring for
+00010910: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+00010920: 6e22 2222 0a20 2020 2020 2020 2066 726f  n""".        fro
+00010930: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
+00010940: 2e69 6f20 696d 706f 7274 2074 6f5f 6a73  .io import to_js
+00010950: 6f6e 0a0a 2020 2020 2020 2020 7265 7475  on..        retu
+00010960: 726e 2074 6f5f 6a73 6f6e 2873 656c 662c  rn to_json(self,
+00010970: 2066 696c 656e 616d 652c 202a 6172 6773   filename, *args
+00010980: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
+00010990: 2064 6566 2074 6f5f 6465 6c61 7965 6428   def to_delayed(
+000109a0: 7365 6c66 2c20 6f70 7469 6d69 7a65 5f67  self, optimize_g
+000109b0: 7261 7068 3d54 7275 6529 3a0a 2020 2020  raph=True):.    
+000109c0: 2020 2020 2222 2243 6f6e 7665 7274 2069      """Convert i
+000109d0: 6e74 6f20 6120 6c69 7374 206f 6620 6060  nto a list of ``
+000109e0: 6461 736b 2e64 656c 6179 6564 6060 206f  dask.delayed`` o
+000109f0: 626a 6563 7473 2c20 6f6e 6520 7065 7220  bjects, one per 
+00010a00: 7061 7274 6974 696f 6e2e 0a0a 2020 2020  partition...    
+00010a10: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00010a20: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00010a30: 2d0a 2020 2020 2020 2020 6f70 7469 6d69  -.        optimi
+00010a40: 7a65 5f67 7261 7068 203a 2062 6f6f 6c2c  ze_graph : bool,
+00010a50: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00010a60: 2020 2020 2020 4966 2054 7275 6520 5b64        If True [d
+00010a70: 6566 6175 6c74 5d2c 2074 6865 2067 7261  efault], the gra
+00010a80: 7068 2069 7320 6f70 7469 6d69 7a65 6420  ph is optimized 
+00010a90: 6265 666f 7265 2063 6f6e 7665 7274 696e  before convertin
+00010aa0: 6720 696e 746f 0a20 2020 2020 2020 2020  g into.         
+00010ab0: 2020 2060 6064 6173 6b2e 6465 6c61 7965     ``dask.delaye
+00010ac0: 6460 6020 6f62 6a65 6374 732e 0a0a 2020  d`` objects...  
+00010ad0: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
+00010ae0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+00010af0: 2020 2020 2020 2020 3e3e 3e20 7061 7274          >>> part
+00010b00: 6974 696f 6e73 203d 2064 662e 746f 5f64  itions = df.to_d
+00010b10: 656c 6179 6564 2829 2020 2320 646f 6374  elayed()  # doct
+00010b20: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
+00010b30: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00010b40: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00010b50: 2020 2020 2020 6461 736b 2e64 6174 6166        dask.dataf
+00010b60: 7261 6d65 2e66 726f 6d5f 6465 6c61 7965  rame.from_delaye
+00010b70: 640a 2020 2020 2020 2020 2222 220a 2020  d.        """.  
+00010b80: 2020 2020 2020 6b65 7973 203d 2073 656c        keys = sel
+00010b90: 662e 5f5f 6461 736b 5f6b 6579 735f 5f28  f.__dask_keys__(
+00010ba0: 290a 2020 2020 2020 2020 6772 6170 6820  ).        graph 
+00010bb0: 3d20 7365 6c66 2e5f 5f64 6173 6b5f 6772  = self.__dask_gr
+00010bc0: 6170 685f 5f28 290a 2020 2020 2020 2020  aph__().        
+00010bd0: 6c61 7965 7220 3d20 7365 6c66 2e5f 5f64  layer = self.__d
+00010be0: 6173 6b5f 6c61 7965 7273 5f5f 2829 5b30  ask_layers__()[0
+00010bf0: 5d0a 2020 2020 2020 2020 6966 206f 7074  ].        if opt
+00010c00: 696d 697a 655f 6772 6170 683a 0a20 2020  imize_graph:.   
+00010c10: 2020 2020 2020 2020 2067 7261 7068 203d           graph =
+00010c20: 2073 656c 662e 5f5f 6461 736b 5f6f 7074   self.__dask_opt
+00010c30: 696d 697a 655f 5f28 6772 6170 682c 2073  imize__(graph, s
+00010c40: 656c 662e 5f5f 6461 736b 5f6b 6579 735f  elf.__dask_keys_
+00010c50: 5f28 2929 0a20 2020 2020 2020 2020 2020  _()).           
+00010c60: 206c 6179 6572 203d 2022 6465 6c61 7965   layer = "delaye
+00010c70: 642d 2220 2b20 7365 6c66 2e5f 6e61 6d65  d-" + self._name
+00010c80: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
+00010c90: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+00010ca0: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+00010cb0: 696f 6e73 286c 6179 6572 2c20 6772 6170  ions(layer, grap
+00010cc0: 682c 2064 6570 656e 6465 6e63 6965 733d  h, dependencies=
+00010cd0: 2829 290a 2020 2020 2020 2020 7265 7475  ()).        retu
+00010ce0: 726e 205b 4465 6c61 7965 6428 6b2c 2067  rn [Delayed(k, g
+00010cf0: 7261 7068 2c20 6c61 7965 723d 6c61 7965  raph, layer=laye
+00010d00: 7229 2066 6f72 206b 2069 6e20 6b65 7973  r) for k in keys
+00010d10: 5d0a 0a20 2020 2064 6566 2074 6f5f 6261  ]..    def to_ba
+00010d20: 636b 656e 6428 7365 6c66 2c20 6261 636b  ckend(self, back
+00010d30: 656e 643a 2073 7472 207c 204e 6f6e 6520  end: str | None 
+00010d40: 3d20 4e6f 6e65 2c20 2a2a 6b77 6172 6773  = None, **kwargs
+00010d50: 293a 0a20 2020 2020 2020 2022 2222 4d6f  ):.        """Mo
+00010d60: 7665 2074 6f20 6120 6e65 7720 4461 7461  ve to a new Data
+00010d70: 4672 616d 6520 6261 636b 656e 640a 0a20  Frame backend.. 
+00010d80: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00010d90: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00010da0: 2d2d 2d2d 0a20 2020 2020 2020 2062 6163  ----.        bac
+00010db0: 6b65 6e64 203a 2073 7472 2c20 4f70 7469  kend : str, Opti
+00010dc0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00010dd0: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
+00010de0: 206e 6577 2062 6163 6b65 6e64 2074 6f20   new backend to 
+00010df0: 6d6f 7665 2074 6f2e 2054 6865 2064 6566  move to. The def
+00010e00: 6175 6c74 0a20 2020 2020 2020 2020 2020  ault.           
+00010e10: 2069 7320 7468 6520 6375 7272 656e 7420   is the current 
+00010e20: 2264 6174 6166 7261 6d65 2e62 6163 6b65  "dataframe.backe
+00010e30: 6e64 2220 636f 6e66 6967 7572 6174 696f  nd" configuratio
+00010e40: 6e2e 0a0a 2020 2020 2020 2020 5265 7475  n...        Retu
+00010e50: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+00010e60: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
+00010e70: 4672 616d 652c 2053 6572 6965 7320 6f72  Frame, Series or
+00010e80: 2049 6e64 6578 0a20 2020 2020 2020 2022   Index.        "
+00010e90: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+00010ea0: 6461 736b 2e64 6174 6166 7261 6d65 2e69  dask.dataframe.i
+00010eb0: 6f20 696d 706f 7274 2074 6f5f 6261 636b  o import to_back
+00010ec0: 656e 640a 0a20 2020 2020 2020 2072 6574  end..        ret
+00010ed0: 7572 6e20 746f 5f62 6163 6b65 6e64 2873  urn to_backend(s
+00010ee0: 656c 662c 2062 6163 6b65 6e64 3d62 6163  elf, backend=bac
+00010ef0: 6b65 6e64 2c20 2a2a 6b77 6172 6773 290a  kend, **kwargs).
+00010f00: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+00010f10: 640a 2020 2020 6465 6620 5f67 6574 5f75  d.    def _get_u
+00010f20: 6e61 7279 5f6f 7065 7261 746f 7228 636c  nary_operator(cl
+00010f30: 732c 206f 7029 3a0a 2020 2020 2020 2020  s, op):.        
+00010f40: 7265 7475 726e 206c 616d 6264 6120 7365  return lambda se
+00010f50: 6c66 3a20 656c 656d 7769 7365 286f 702c  lf: elemwise(op,
+00010f60: 2073 656c 6629 0a0a 2020 2020 4063 6c61   self)..    @cla
+00010f70: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+00010f80: 205f 6765 745f 6269 6e61 7279 5f6f 7065   _get_binary_ope
+00010f90: 7261 746f 7228 636c 732c 206f 702c 2069  rator(cls, op, i
+00010fa0: 6e76 3d46 616c 7365 293a 0a20 2020 2020  nv=False):.     
+00010fb0: 2020 2069 6620 696e 763a 0a20 2020 2020     if inv:.     
+00010fc0: 2020 2020 2020 2072 6574 7572 6e20 6c61         return la
+00010fd0: 6d62 6461 2073 656c 662c 206f 7468 6572  mbda self, other
+00010fe0: 3a20 656c 656d 7769 7365 286f 702c 206f  : elemwise(op, o
+00010ff0: 7468 6572 2c20 7365 6c66 290a 2020 2020  ther, self).    
+00011000: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00011010: 2020 2020 2020 7265 7475 726e 206c 616d        return lam
+00011020: 6264 6120 7365 6c66 2c20 6f74 6865 723a  bda self, other:
+00011030: 2065 6c65 6d77 6973 6528 6f70 2c20 7365   elemwise(op, se
+00011040: 6c66 2c20 6f74 6865 7229 0a0a 2020 2020  lf, other)..    
+00011050: 6465 6620 726f 6c6c 696e 6728 0a20 2020  def rolling(.   
+00011060: 2020 2020 2073 656c 662c 2077 696e 646f       self, windo
+00011070: 772c 206d 696e 5f70 6572 696f 6473 3d4e  w, min_periods=N
+00011080: 6f6e 652c 2063 656e 7465 723d 4661 6c73  one, center=Fals
+00011090: 652c 2077 696e 5f74 7970 653d 4e6f 6e65  e, win_type=None
+000110a0: 2c20 6178 6973 3d6e 6f5f 6465 6661 756c  , axis=no_defaul
+000110b0: 740a 2020 2020 293a 0a20 2020 2020 2020  t.    ):.       
+000110c0: 2022 2222 5072 6f76 6964 6573 2072 6f6c   """Provides rol
+000110d0: 6c69 6e67 2074 7261 6e73 666f 726d 6174  ling transformat
+000110e0: 696f 6e73 2e0a 0a20 2020 2020 2020 2050  ions...        P
+000110f0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00011100: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00011110: 2020 2020 2077 696e 646f 7720 3a20 696e       window : in
+00011120: 742c 2073 7472 2c20 6f66 6673 6574 0a20  t, str, offset. 
+00011130: 2020 2020 2020 2020 2020 5369 7a65 206f            Size o
+00011140: 6620 7468 6520 6d6f 7669 6e67 2077 696e  f the moving win
+00011150: 646f 772e 2054 6869 7320 6973 2074 6865  dow. This is the
+00011160: 206e 756d 6265 7220 6f66 206f 6273 6572   number of obser
+00011170: 7661 7469 6f6e 7320 7573 6564 0a20 2020  vations used.   
+00011180: 2020 2020 2020 2020 666f 7220 6361 6c63          for calc
+00011190: 756c 6174 696e 6720 7468 6520 7374 6174  ulating the stat
+000111a0: 6973 7469 632e 2057 6865 6e20 6e6f 7420  istic. When not 
+000111b0: 7573 696e 6720 6120 6060 4461 7465 7469  using a ``Dateti
+000111c0: 6d65 496e 6465 7860 602c 0a20 2020 2020  meIndex``,.     
+000111d0: 2020 2020 2020 7468 6520 7769 6e64 6f77        the window
+000111e0: 2073 697a 6520 6d75 7374 206e 6f74 2062   size must not b
+000111f0: 6520 736f 206c 6172 6765 2061 7320 746f  e so large as to
+00011200: 2073 7061 6e20 6d6f 7265 2074 6861 6e20   span more than 
+00011210: 6f6e 650a 2020 2020 2020 2020 2020 2061  one.           a
+00011220: 646a 6163 656e 7420 7061 7274 6974 696f  djacent partitio
+00011230: 6e2e 2049 6620 7573 696e 6720 616e 206f  n. If using an o
+00011240: 6666 7365 7420 6f72 206f 6666 7365 7420  ffset or offset 
+00011250: 616c 6961 7320 6c69 6b65 2027 3544 272c  alias like '5D',
+00011260: 0a20 2020 2020 2020 2020 2020 7468 6520  .           the 
+00011270: 6461 7461 206d 7573 7420 6861 7665 2061  data must have a
+00011280: 2060 6044 6174 6574 696d 6549 6e64 6578   ``DatetimeIndex
+00011290: 6060 0a0a 2020 2020 2020 2020 2020 202e  ``..           .
+000112a0: 2e20 7665 7273 696f 6e63 6861 6e67 6564  . versionchanged
+000112b0: 3a3a 2030 2e31 352e 300a 0a20 2020 2020  :: 0.15.0..     
+000112c0: 2020 2020 2020 2020 204e 6f77 2061 6363           Now acc
+000112d0: 6570 7473 206f 6666 7365 7473 2061 6e64  epts offsets and
+000112e0: 2073 7472 696e 6720 6f66 6673 6574 2061   string offset a
+000112f0: 6c69 6173 6573 0a0a 2020 2020 2020 2020  liases..        
+00011300: 6d69 6e5f 7065 7269 6f64 7320 3a20 696e  min_periods : in
+00011310: 742c 2064 6566 6175 6c74 204e 6f6e 650a  t, default None.
+00011320: 2020 2020 2020 2020 2020 2020 4d69 6e69              Mini
+00011330: 6d75 6d20 6e75 6d62 6572 206f 6620 6f62  mum number of ob
+00011340: 7365 7276 6174 696f 6e73 2069 6e20 7769  servations in wi
+00011350: 6e64 6f77 2072 6571 7569 7265 6420 746f  ndow required to
+00011360: 2068 6176 6520 6120 7661 6c75 650a 2020   have a value.  
+00011370: 2020 2020 2020 2020 2020 286f 7468 6572            (other
+00011380: 7769 7365 2072 6573 756c 7420 6973 204e  wise result is N
+00011390: 4129 2e0a 2020 2020 2020 2020 6365 6e74  A)..        cent
+000113a0: 6572 203a 2062 6f6f 6c65 616e 2c20 6465  er : boolean, de
+000113b0: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
+000113c0: 2020 2020 2020 2020 5365 7420 7468 6520          Set the 
+000113d0: 6c61 6265 6c73 2061 7420 7468 6520 6365  labels at the ce
+000113e0: 6e74 6572 206f 6620 7468 6520 7769 6e64  nter of the wind
+000113f0: 6f77 2e0a 2020 2020 2020 2020 7769 6e5f  ow..        win_
+00011400: 7479 7065 203a 2073 7472 696e 672c 2064  type : string, d
+00011410: 6566 6175 6c74 204e 6f6e 650a 2020 2020  efault None.    
+00011420: 2020 2020 2020 2020 5072 6f76 6964 6520          Provide 
+00011430: 6120 7769 6e64 6f77 2074 7970 652e 2054  a window type. T
+00011440: 6865 2072 6563 6f67 6e69 7a65 6420 7769  he recognized wi
+00011450: 6e64 6f77 2074 7970 6573 2061 7265 2069  ndow types are i
+00011460: 6465 6e74 6963 616c 0a20 2020 2020 2020  dentical.       
+00011470: 2020 2020 2074 6f20 7061 6e64 6173 2e0a       to pandas..
+00011480: 2020 2020 2020 2020 6178 6973 203a 2069          axis : i
+00011490: 6e74 2c20 7374 722c 204e 6f6e 652c 2064  nt, str, None, d
+000114a0: 6566 6175 6c74 2030 0a20 2020 2020 2020  efault 0.       
+000114b0: 2020 2020 2054 6869 7320 7061 7261 6d65       This parame
+000114c0: 7465 7220 6973 2064 6570 7265 6361 7465  ter is deprecate
+000114d0: 6420 7769 7468 2060 6070 616e 6461 733e  d with ``pandas>
+000114e0: 3d32 2e31 6060 2e0a 0a20 2020 2020 2020  =2.1``...       
+000114f0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00011500: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00011510: 2061 2052 6f6c 6c69 6e67 206f 626a 6563   a Rolling objec
+00011520: 7420 6f6e 2077 6869 6368 2074 6f20 6361  t on which to ca
+00011530: 6c6c 2061 206d 6574 686f 6420 746f 2063  ll a method to c
+00011540: 6f6d 7075 7465 2061 2073 7461 7469 7374  ompute a statist
+00011550: 6963 0a20 2020 2020 2020 2022 2222 0a20  ic.        """. 
+00011560: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00011570: 2e64 6174 6166 7261 6d65 2e72 6f6c 6c69  .dataframe.rolli
+00011580: 6e67 2069 6d70 6f72 7420 526f 6c6c 696e  ng import Rollin
+00011590: 670a 0a20 2020 2020 2020 2069 6620 6973  g..        if is
+000115a0: 696e 7374 616e 6365 2877 696e 646f 772c  instance(window,
+000115b0: 2049 6e74 6567 7261 6c29 3a0a 2020 2020   Integral):.    
+000115c0: 2020 2020 2020 2020 6966 2077 696e 646f          if windo
+000115d0: 7720 3c20 303a 0a20 2020 2020 2020 2020  w < 0:.         
+000115e0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000115f0: 7565 4572 726f 7228 2277 696e 646f 7720  ueError("window 
+00011600: 6d75 7374 2062 6520 3e3d 2030 2229 0a0a  must be >= 0")..
+00011610: 2020 2020 2020 2020 6966 206d 696e 5f70          if min_p
+00011620: 6572 696f 6473 2069 7320 6e6f 7420 4e6f  eriods is not No
+00011630: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00011640: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00011650: 6528 6d69 6e5f 7065 7269 6f64 732c 2049  e(min_periods, I
+00011660: 6e74 6567 7261 6c29 3a0a 2020 2020 2020  ntegral):.      
+00011670: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00011680: 5661 6c75 6545 7272 6f72 2822 6d69 6e5f  ValueError("min_
+00011690: 7065 7269 6f64 7320 6d75 7374 2062 6520  periods must be 
+000116a0: 616e 2069 6e74 6567 6572 2229 0a20 2020  an integer").   
+000116b0: 2020 2020 2020 2020 2069 6620 6d69 6e5f           if min_
+000116c0: 7065 7269 6f64 7320 3c20 303a 0a20 2020  periods < 0:.   
+000116d0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000116e0: 7365 2056 616c 7565 4572 726f 7228 226d  se ValueError("m
+000116f0: 696e 5f70 6572 696f 6473 206d 7573 7420  in_periods must 
+00011700: 6265 203e 3d20 3022 290a 0a20 2020 2020  be >= 0")..     
+00011710: 2020 2072 6574 7572 6e20 526f 6c6c 696e     return Rollin
+00011720: 6728 0a20 2020 2020 2020 2020 2020 2073  g(.            s
+00011730: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+00011740: 2077 696e 646f 773d 7769 6e64 6f77 2c0a   window=window,.
+00011750: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
+00011760: 7065 7269 6f64 733d 6d69 6e5f 7065 7269  periods=min_peri
+00011770: 6f64 732c 0a20 2020 2020 2020 2020 2020  ods,.           
+00011780: 2063 656e 7465 723d 6365 6e74 6572 2c0a   center=center,.
+00011790: 2020 2020 2020 2020 2020 2020 7769 6e5f              win_
+000117a0: 7479 7065 3d77 696e 5f74 7970 652c 0a20  type=win_type,. 
+000117b0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+000117c0: 6178 6973 2c0a 2020 2020 2020 2020 290a  axis,.        ).
+000117d0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+000117e0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+000117f0: 0a20 2020 2064 6566 2064 6966 6628 7365  .    def diff(se
+00011800: 6c66 2c20 7065 7269 6f64 733d 312c 2061  lf, periods=1, a
+00011810: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
+00011820: 2222 220a 2020 2020 2020 2020 2e2e 206e  """.        .. n
+00011830: 6f74 653a 3a0a 0a20 2020 2020 2020 2020  ote::..         
+00011840: 2020 5061 6e64 6173 2063 7572 7265 6e74    Pandas current
+00011850: 6c79 2075 7365 7320 616e 2060 606f 626a  ly uses an ``obj
+00011860: 6563 7460 602d 6474 7970 6520 636f 6c75  ect``-dtype colu
+00011870: 6d6e 2074 6f20 7265 7072 6573 656e 740a  mn to represent.
+00011880: 2020 2020 2020 2020 2020 2062 6f6f 6c65             boole
+00011890: 616e 2064 6174 6120 7769 7468 206d 6973  an data with mis
+000118a0: 7369 6e67 2076 616c 7565 732e 2054 6869  sing values. Thi
+000118b0: 7320 6361 6e20 6361 7573 6520 6973 7375  s can cause issu
+000118c0: 6573 2066 6f72 0a20 2020 2020 2020 2020  es for.         
+000118d0: 2020 626f 6f6c 6561 6e2d 7370 6563 6966    boolean-specif
+000118e0: 6963 206f 7065 7261 7469 6f6e 732c 206c  ic operations, l
+000118f0: 696b 6520 6060 7c60 602e 2054 6f20 656e  ike ``|``. To en
+00011900: 6162 6c65 2062 6f6f 6c65 616e 2d0a 2020  able boolean-.  
+00011910: 2020 2020 2020 2020 2073 7065 6369 6669           specifi
+00011920: 6320 6f70 6572 6174 696f 6e73 2c20 6174  c operations, at
+00011930: 2074 6865 2063 6f73 7420 6f66 206d 6574   the cost of met
+00011940: 6164 6174 6120 7468 6174 2064 6f65 736e  adata that doesn
+00011950: 2774 206d 6174 6368 0a20 2020 2020 2020  't match.       
+00011960: 2020 2020 7061 6e64 6173 2c20 7573 6520      pandas, use 
+00011970: 6060 2e61 7374 7970 6528 626f 6f6c 2960  ``.astype(bool)`
+00011980: 6020 6166 7465 7220 7468 6520 6060 7368  ` after the ``sh
+00011990: 6966 7460 602e 0a20 2020 2020 2020 2022  ift``..        "
+000119a0: 2222 0a20 2020 2020 2020 2061 7869 7320  "".        axis 
+000119b0: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
+000119c0: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
+000119d0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+000119e0: 7461 6e63 6528 7065 7269 6f64 732c 2049  tance(periods, I
+000119f0: 6e74 6567 7261 6c29 3a0a 2020 2020 2020  ntegral):.      
+00011a00: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00011a10: 4572 726f 7228 2270 6572 696f 6473 206d  Error("periods m
+00011a20: 7573 7420 6265 2061 6e20 696e 7465 6765  ust be an intege
+00011a30: 7222 290a 0a20 2020 2020 2020 2069 6620  r")..        if 
+00011a40: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
+00011a50: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00011a60: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00011a70: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00011a80: 2020 204d 2e64 6966 662c 2074 6f6b 656e     M.diff, token
+00011a90: 3d22 6469 6666 222c 2070 6572 696f 6473  ="diff", periods
+00011aa0: 3d70 6572 696f 6473 2c20 6178 6973 3d31  =periods, axis=1
+00011ab0: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
+00011ac0: 7461 3d46 616c 7365 0a20 2020 2020 2020  ta=False.       
+00011ad0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00011ae0: 6265 666f 7265 2c20 6166 7465 7220 3d20  before, after = 
+00011af0: 2870 6572 696f 6473 2c20 3029 2069 6620  (periods, 0) if 
+00011b00: 7065 7269 6f64 7320 3e20 3020 656c 7365  periods > 0 else
+00011b10: 2028 302c 202d 7065 7269 6f64 7329 0a20   (0, -periods). 
+00011b20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00011b30: 6c66 2e6d 6170 5f6f 7665 726c 6170 284d  lf.map_overlap(M
+00011b40: 2e64 6966 662c 2062 6566 6f72 652c 2061  .diff, before, a
+00011b50: 6674 6572 2c20 746f 6b65 6e3d 2264 6966  fter, token="dif
+00011b60: 6622 2c20 7065 7269 6f64 733d 7065 7269  f", periods=peri
+00011b70: 6f64 7329 0a0a 2020 2020 4064 6572 6976  ods)..    @deriv
+00011b80: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00011b90: 7261 6d65 290a 2020 2020 6465 6620 7368  rame).    def sh
+00011ba0: 6966 7428 7365 6c66 2c20 7065 7269 6f64  ift(self, period
+00011bb0: 733d 312c 2066 7265 713d 4e6f 6e65 2c20  s=1, freq=None, 
+00011bc0: 6178 6973 3d30 293a 0a20 2020 2020 2020  axis=0):.       
+00011bd0: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
+00011be0: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
+00011bf0: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
+00011c00: 2069 7369 6e73 7461 6e63 6528 7065 7269   isinstance(peri
+00011c10: 6f64 732c 2049 6e74 6567 7261 6c29 3a0a  ods, Integral):.
+00011c20: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00011c30: 6520 5479 7065 4572 726f 7228 2270 6572  e TypeError("per
+00011c40: 696f 6473 206d 7573 7420 6265 2061 6e20  iods must be an 
+00011c50: 696e 7465 6765 7222 290a 0a20 2020 2020  integer")..     
+00011c60: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
+00011c70: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00011c80: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
+00011c90: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
+00011ca0: 2020 2020 2020 2020 204d 2e73 6869 6674           M.shift
+00011cb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011cc0: 2020 746f 6b65 6e3d 2273 6869 6674 222c    token="shift",
+00011cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011ce0: 2070 6572 696f 6473 3d70 6572 696f 6473   periods=periods
+00011cf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011d00: 2020 6672 6571 3d66 7265 712c 0a20 2020    freq=freq,.   
+00011d10: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+00011d20: 733d 312c 0a20 2020 2020 2020 2020 2020  s=1,.           
+00011d30: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
+00011d40: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
+00011d50: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00011d60: 2020 2020 6966 2066 7265 7120 6973 204e      if freq is N
+00011d70: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00011d80: 2062 6566 6f72 652c 2061 6674 6572 203d   before, after =
+00011d90: 2028 7065 7269 6f64 732c 2030 2920 6966   (periods, 0) if
+00011da0: 2070 6572 696f 6473 203e 2030 2065 6c73   periods > 0 els
+00011db0: 6520 2830 2c20 2d70 6572 696f 6473 290a  e (0, -periods).
+00011dc0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00011dd0: 726e 2073 656c 662e 6d61 705f 6f76 6572  rn self.map_over
+00011de0: 6c61 7028 0a20 2020 2020 2020 2020 2020  lap(.           
+00011df0: 2020 2020 204d 2e73 6869 6674 2c20 6265       M.shift, be
+00011e00: 666f 7265 2c20 6166 7465 722c 2074 6f6b  fore, after, tok
+00011e10: 656e 3d22 7368 6966 7422 2c20 7065 7269  en="shift", peri
+00011e20: 6f64 733d 7065 7269 6f64 730a 2020 2020  ods=periods.    
+00011e30: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00011e40: 2020 2023 204c 6574 2070 616e 6461 7320     # Let pandas 
+00011e50: 6572 726f 7220 6f6e 2069 6e76 616c 6964  error on invalid
+00011e60: 2061 7267 756d 656e 7473 0a20 2020 2020   arguments.     
+00011e70: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+00011e80: 6d65 7461 5f6e 6f6e 656d 7074 792e 7368  meta_nonempty.sh
+00011e90: 6966 7428 7065 7269 6f64 732c 2066 7265  ift(periods, fre
+00011ea0: 713d 6672 6571 290a 2020 2020 2020 2020  q=freq).        
+00011eb0: 6f75 7420 3d20 7365 6c66 2e6d 6170 5f70  out = self.map_p
+00011ec0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+00011ed0: 2020 2020 2020 204d 2e73 6869 6674 2c0a         M.shift,.
+00011ee0: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
+00011ef0: 6e3d 2273 6869 6674 222c 0a20 2020 2020  n="shift",.     
+00011f00: 2020 2020 2020 2070 6572 696f 6473 3d70         periods=p
+00011f10: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
+00011f20: 2020 2020 6672 6571 3d66 7265 712c 0a20      freq=freq,. 
+00011f30: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
+00011f40: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
+00011f50: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
+00011f60: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
+00011f70: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
+00011f80: 6469 7669 7369 6f6e 733d 4661 6c73 652c  divisions=False,
+00011f90: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00011fa0: 2020 2072 6574 7572 6e20 6d61 7962 655f     return maybe_
+00011fb0: 7368 6966 745f 6469 7669 7369 6f6e 7328  shift_divisions(
+00011fc0: 6f75 742c 2070 6572 696f 6473 2c20 6672  out, periods, fr
+00011fd0: 6571 3d66 7265 7129 0a0a 2020 2020 6465  eq=freq)..    de
+00011fe0: 6620 5f72 6564 7563 7469 6f6e 5f61 6767  f _reduction_agg
+00011ff0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00012000: 2020 2020 2020 2020 6e61 6d65 2c0a 2020          name,.  
+00012010: 2020 2020 2020 6178 6973 3d4e 6f6e 652c        axis=None,
+00012020: 0a20 2020 2020 2020 2073 6b69 706e 613d  .        skipna=
+00012030: 5472 7565 2c0a 2020 2020 2020 2020 7370  True,.        sp
+00012040: 6c69 745f 6576 6572 793d 4661 6c73 652c  lit_every=False,
+00012050: 0a20 2020 2020 2020 206f 7574 3d4e 6f6e  .        out=Non
+00012060: 652c 0a20 2020 2020 2020 206e 756d 6572  e,.        numer
+00012070: 6963 5f6f 6e6c 793d 4e6f 6e65 2c0a 2020  ic_only=None,.  
+00012080: 2020 2020 2020 6e6f 6e65 5f69 735f 7a65        none_is_ze
+00012090: 726f 3d54 7275 652c 0a20 2020 2029 3a0a  ro=True,.    ):.
+000120a0: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+000120b0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+000120c0: 6973 2861 7869 732c 206e 6f6e 655f 6973  is(axis, none_is
+000120d0: 5f7a 6572 6f3d 6e6f 6e65 5f69 735f 7a65  _zero=none_is_ze
+000120e0: 726f 290a 0a20 2020 2020 2020 2069 6620  ro)..        if 
+000120f0: 6861 735f 6b65 7977 6f72 6428 6765 7461  has_keyword(geta
+00012100: 7474 7228 7365 6c66 2e5f 6d65 7461 5f6e  ttr(self._meta_n
+00012110: 6f6e 656d 7074 792c 206e 616d 6529 2c20  onempty, name), 
+00012120: 226e 756d 6572 6963 5f6f 6e6c 7922 293a  "numeric_only"):
+00012130: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+00012140: 6572 6963 5f6f 6e6c 795f 6b77 6172 6773  eric_only_kwargs
+00012150: 203d 207b 226e 756d 6572 6963 5f6f 6e6c   = {"numeric_onl
+00012160: 7922 3a20 6e75 6d65 7269 635f 6f6e 6c79  y": numeric_only
+00012170: 7d0a 2020 2020 2020 2020 656c 7365 3a0a  }.        else:.
+00012180: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
+00012190: 7269 635f 6f6e 6c79 5f6b 7761 7267 7320  ric_only_kwargs 
+000121a0: 3d20 7b7d 0a0a 2020 2020 2020 2020 7769  = {}..        wi
+000121b0: 7468 2063 6865 636b 5f6e 756d 6572 6963  th check_numeric
+000121c0: 5f6f 6e6c 795f 6465 7072 6563 6174 696f  _only_deprecatio
+000121d0: 6e28 6e61 6d65 2c20 5472 7565 293a 0a20  n(name, True):. 
+000121e0: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
+000121f0: 3d20 6765 7461 7474 7228 7365 6c66 2e5f  = getattr(self._
+00012200: 6d65 7461 5f6e 6f6e 656d 7074 792c 206e  meta_nonempty, n
+00012210: 616d 6529 280a 2020 2020 2020 2020 2020  ame)(.          
+00012220: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
+00012230: 2073 6b69 706e 613d 736b 6970 6e61 2c20   skipna=skipna, 
+00012240: 2a2a 6e75 6d65 7269 635f 6f6e 6c79 5f6b  **numeric_only_k
+00012250: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
+00012260: 2020 290a 0a20 2020 2020 2020 2074 6f6b    )..        tok
+00012270: 656e 203d 2073 656c 662e 5f74 6f6b 656e  en = self._token
+00012280: 5f70 7265 6669 7820 2b20 6e61 6d65 0a20  _prefix + name. 
+00012290: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+000122a0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+000122b0: 2072 6573 756c 7420 3d20 7365 6c66 2e6d   result = self.m
+000122c0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+000122d0: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+000122e0: 6765 7461 7474 725f 6e75 6d65 7269 635f  getattr_numeric_
+000122f0: 6f6e 6c79 2c0a 2020 2020 2020 2020 2020  only,.          
+00012300: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
+00012310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012320: 2074 6f6b 656e 3d74 6f6b 656e 2c0a 2020   token=token,.  
+00012330: 2020 2020 2020 2020 2020 2020 2020 736b                sk
+00012340: 6970 6e61 3d73 6b69 706e 612c 0a20 2020  ipna=skipna,.   
+00012350: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+00012360: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
+00012370: 2020 2020 2020 2020 5f64 6173 6b5f 6d65          _dask_me
+00012380: 7468 6f64 5f6e 616d 653d 6e61 6d65 2c0a  thod_name=name,.
+00012390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123a0: 2a2a 6e75 6d65 7269 635f 6f6e 6c79 5f6b  **numeric_only_k
+000123b0: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
+000123c0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+000123d0: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+000123e0: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+000123f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00012400: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00012410: 203d 2073 656c 662e 7265 6475 6374 696f   = self.reductio
+00012420: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00012430: 2020 205f 6765 7461 7474 725f 6e75 6d65     _getattr_nume
+00012440: 7269 635f 6f6e 6c79 2c0a 2020 2020 2020  ric_only,.      
+00012450: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
+00012460: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
+00012470: 2020 2020 2074 6f6b 656e 3d74 6f6b 656e       token=token
+00012480: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00012490: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+000124a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000124b0: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
+000124c0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+000124d0: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+000124e0: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+000124f0: 2020 2020 205f 6461 736b 5f6d 6574 686f       _dask_metho
+00012500: 645f 6e61 6d65 3d6e 616d 652c 0a20 2020  d_name=name,.   
+00012510: 2020 2020 2020 2020 2020 2020 202a 2a6e               **n
+00012520: 756d 6572 6963 5f6f 6e6c 795f 6b77 6172  umeric_only_kwar
+00012530: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+00012540: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00012550: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+00012560: 2c20 4461 7461 4672 616d 6529 2061 6e64  , DataFrame) and
+00012570: 2069 7369 6e73 7461 6e63 6528 7265 7375   isinstance(resu
+00012580: 6c74 2c20 5365 7269 6573 293a 0a20 2020  lt, Series):.   
+00012590: 2020 2020 2020 2020 2020 2020 2072 6573               res
+000125a0: 756c 742e 6469 7669 7369 6f6e 7320 3d20  ult.divisions = 
+000125b0: 2873 656c 662e 636f 6c75 6d6e 732e 6d69  (self.columns.mi
+000125c0: 6e28 292c 2073 656c 662e 636f 6c75 6d6e  n(), self.column
+000125d0: 732e 6d61 7828 2929 0a20 2020 2020 2020  s.max()).       
+000125e0: 2020 2020 2072 6574 7572 6e20 6861 6e64       return hand
+000125f0: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
+00012600: 6c74 290a 0a20 2020 2040 6465 7269 7665  lt)..    @derive
+00012610: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00012620: 616d 6529 0a20 2020 2064 6566 2061 6464  ame).    def add
+00012630: 5f70 7265 6669 7828 7365 6c66 2c20 7072  _prefix(self, pr
+00012640: 6566 6978 293a 0a20 2020 2020 2020 2072  efix):.        r
+00012650: 6573 203d 2073 656c 662e 6d61 705f 7061  es = self.map_pa
+00012660: 7274 6974 696f 6e73 284d 2e61 6464 5f70  rtitions(M.add_p
+00012670: 7265 6669 782c 2070 7265 6669 7829 0a20  refix, prefix). 
+00012680: 2020 2020 2020 2069 6620 7365 6c66 2e6b         if self.k
+00012690: 6e6f 776e 5f64 6976 6973 696f 6e73 2061  nown_divisions a
+000126a0: 6e64 2069 735f 7365 7269 6573 5f6c 696b  nd is_series_lik
+000126b0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+000126c0: 2020 2020 2072 6573 2e64 6976 6973 696f       res.divisio
+000126d0: 6e73 203d 2074 7570 6c65 2870 7265 6669  ns = tuple(prefi
+000126e0: 7820 2b20 7374 7228 6469 7669 7369 6f6e  x + str(division
+000126f0: 2920 666f 7220 6469 7669 7369 6f6e 2069  ) for division i
+00012700: 6e20 7365 6c66 2e64 6976 6973 696f 6e73  n self.divisions
+00012710: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00012720: 2072 6573 0a0a 2020 2020 4064 6572 6976   res..    @deriv
+00012730: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00012740: 7261 6d65 290a 2020 2020 6465 6620 6164  rame).    def ad
+00012750: 645f 7375 6666 6978 2873 656c 662c 2073  d_suffix(self, s
+00012760: 7566 6669 7829 3a0a 2020 2020 2020 2020  uffix):.        
+00012770: 7265 7320 3d20 7365 6c66 2e6d 6170 5f70  res = self.map_p
+00012780: 6172 7469 7469 6f6e 7328 4d2e 6164 645f  artitions(M.add_
+00012790: 7375 6666 6978 2c20 7375 6666 6978 290a  suffix, suffix).
+000127a0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000127b0: 6b6e 6f77 6e5f 6469 7669 7369 6f6e 7320  known_divisions 
+000127c0: 616e 6420 6973 5f73 6572 6965 735f 6c69  and is_series_li
+000127d0: 6b65 2873 656c 6629 3a0a 2020 2020 2020  ke(self):.      
+000127e0: 2020 2020 2020 7265 732e 6469 7669 7369        res.divisi
+000127f0: 6f6e 7320 3d20 7475 706c 6528 7374 7228  ons = tuple(str(
+00012800: 6469 7669 7369 6f6e 2920 2b20 7375 6666  division) + suff
+00012810: 6978 2066 6f72 2064 6976 6973 696f 6e20  ix for division 
+00012820: 696e 2073 656c 662e 6469 7669 7369 6f6e  in self.division
+00012830: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
+00012840: 6e20 7265 730a 0a20 2020 2040 6465 7269  n res..    @deri
+00012850: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+00012860: 4672 616d 6529 0a20 2020 2064 6566 2061  Frame).    def a
+00012870: 6273 2873 656c 6629 3a0a 2020 2020 2020  bs(self):.      
+00012880: 2020 5f72 6169 7365 5f69 665f 6f62 6a65    _raise_if_obje
+00012890: 6374 5f73 6572 6965 7328 7365 6c66 2c20  ct_series(self, 
+000128a0: 2261 6273 2229 0a20 2020 2020 2020 206d  "abs").        m
+000128b0: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
+000128c0: 5f6e 6f6e 656d 7074 792e 6162 7328 290a  _nonempty.abs().
+000128d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000128e0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+000128f0: 6e73 284d 2e61 6273 2c20 6d65 7461 3d6d  ns(M.abs, meta=m
+00012900: 6574 612c 2065 6e66 6f72 6365 5f6d 6574  eta, enforce_met
+00012910: 6164 6174 613d 4661 6c73 6529 0a0a 2020  adata=False)..  
+00012920: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00012930: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+00012940: 2020 6465 6620 616c 6c28 7365 6c66 2c20    def all(self, 
+00012950: 6178 6973 3d4e 6f6e 652c 2073 6b69 706e  axis=None, skipn
+00012960: 613d 5472 7565 2c20 7370 6c69 745f 6576  a=True, split_ev
+00012970: 6572 793d 4661 6c73 652c 206f 7574 3d4e  ery=False, out=N
+00012980: 6f6e 6529 3a0a 2020 2020 2020 2020 7265  one):.        re
+00012990: 7475 726e 2073 656c 662e 5f72 6564 7563  turn self._reduc
+000129a0: 7469 6f6e 5f61 6767 280a 2020 2020 2020  tion_agg(.      
+000129b0: 2020 2020 2020 2261 6c6c 222c 2061 7869        "all", axi
+000129c0: 733d 6178 6973 2c20 736b 6970 6e61 3d73  s=axis, skipna=s
+000129d0: 6b69 706e 612c 2073 706c 6974 5f65 7665  kipna, split_eve
+000129e0: 7279 3d73 706c 6974 5f65 7665 7279 2c20  ry=split_every, 
+000129f0: 6f75 743d 6f75 740a 2020 2020 2020 2020  out=out.        
+00012a00: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00012a10: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00012a20: 6529 0a20 2020 2064 6566 2061 6e79 2873  e).    def any(s
+00012a30: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
+00012a40: 736b 6970 6e61 3d54 7275 652c 2073 706c  skipna=True, spl
+00012a50: 6974 5f65 7665 7279 3d46 616c 7365 2c20  it_every=False, 
+00012a60: 6f75 743d 4e6f 6e65 293a 0a20 2020 2020  out=None):.     
+00012a70: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00012a80: 7265 6475 6374 696f 6e5f 6167 6728 0a20  reduction_agg(. 
+00012a90: 2020 2020 2020 2020 2020 2022 616e 7922             "any"
+00012aa0: 2c20 6178 6973 3d61 7869 732c 2073 6b69  , axis=axis, ski
+00012ab0: 706e 613d 736b 6970 6e61 2c20 7370 6c69  pna=skipna, spli
+00012ac0: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00012ad0: 6572 792c 206f 7574 3d6f 7574 0a20 2020  ery, out=out.   
+00012ae0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+00012af0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00012b00: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00012b10: 7375 6d28 0a20 2020 2020 2020 2073 656c  sum(.        sel
+00012b20: 662c 0a20 2020 2020 2020 2061 7869 733d  f,.        axis=
+00012b30: 4e6f 6e65 2c0a 2020 2020 2020 2020 736b  None,.        sk
+00012b40: 6970 6e61 3d54 7275 652c 0a20 2020 2020  ipna=True,.     
+00012b50: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
+00012b60: 616c 7365 2c0a 2020 2020 2020 2020 6474  alse,.        dt
+00012b70: 7970 653d 4e6f 6e65 2c0a 2020 2020 2020  ype=None,.      
+00012b80: 2020 6f75 743d 4e6f 6e65 2c0a 2020 2020    out=None,.    
+00012b90: 2020 2020 6d69 6e5f 636f 756e 743d 4e6f      min_count=No
+00012ba0: 6e65 2c0a 2020 2020 2020 2020 6e75 6d65  ne,.        nume
+00012bb0: 7269 635f 6f6e 6c79 3d4e 6f6e 652c 0a20  ric_only=None,. 
+00012bc0: 2020 2029 3a0a 2020 2020 2020 2020 7265     ):.        re
+00012bd0: 7375 6c74 203d 2073 656c 662e 5f72 6564  sult = self._red
+00012be0: 7563 7469 6f6e 5f61 6767 280a 2020 2020  uction_agg(.    
+00012bf0: 2020 2020 2020 2020 2273 756d 222c 0a20          "sum",. 
+00012c00: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+00012c10: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+00012c20: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+00012c30: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+00012c40: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+00012c50: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
+00012c60: 2020 6f75 743d 6f75 742c 0a20 2020 2020    out=out,.     
+00012c70: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
+00012c80: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
+00012c90: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00012ca0: 2020 2020 6966 206d 696e 5f63 6f75 6e74      if min_count
+00012cb0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+00012cc0: 6e64 203d 2073 656c 662e 6e6f 746e 756c  nd = self.notnul
+00012cd0: 6c28 292e 7375 6d28 6178 6973 3d61 7869  l().sum(axis=axi
+00012ce0: 7329 203e 3d20 6d69 6e5f 636f 756e 740a  s) >= min_count.
+00012cf0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00012d00: 735f 7365 7269 6573 5f6c 696b 6528 636f  s_series_like(co
+00012d10: 6e64 293a 0a20 2020 2020 2020 2020 2020  nd):.           
+00012d20: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+00012d30: 6c74 2e77 6865 7265 2863 6f6e 642c 206f  lt.where(cond, o
+00012d40: 7468 6572 3d6e 702e 4e61 4e29 0a20 2020  ther=np.NaN).   
+00012d50: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00012d60: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00012d70: 6574 7572 6e20 5f73 6361 6c61 725f 6269  eturn _scalar_bi
+00012d80: 6e61 7279 280a 2020 2020 2020 2020 2020  nary(.          
+00012d90: 2020 2020 2020 2020 2020 6c61 6d62 6461            lambda
+00012da0: 2078 2c20 793a 2072 6573 756c 7420 6966   x, y: result if
+00012db0: 2078 2069 7320 7920 656c 7365 206e 702e   x is y else np.
+00012dc0: 4e61 4e2c 2063 6f6e 642c 2054 7275 650a  NaN, cond, True.
+00012dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012de0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00012df0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00012e00: 726e 2072 6573 756c 740a 0a20 2020 2040  rn result..    @
+00012e10: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00012e20: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+00012e30: 6566 2070 726f 6428 0a20 2020 2020 2020  ef prod(.       
+00012e40: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
+00012e50: 7869 733d 4e6f 6e65 2c0a 2020 2020 2020  xis=None,.      
+00012e60: 2020 736b 6970 6e61 3d54 7275 652c 0a20    skipna=True,. 
+00012e70: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+00012e80: 7279 3d46 616c 7365 2c0a 2020 2020 2020  ry=False,.      
+00012e90: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
+00012ea0: 2020 2020 2020 6f75 743d 4e6f 6e65 2c0a        out=None,.
+00012eb0: 2020 2020 2020 2020 6d69 6e5f 636f 756e          min_coun
+00012ec0: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
+00012ed0: 6e75 6d65 7269 635f 6f6e 6c79 3d4e 6f6e  numeric_only=Non
+00012ee0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00012ef0: 2020 7265 7375 6c74 203d 2073 656c 662e    result = self.
+00012f00: 5f72 6564 7563 7469 6f6e 5f61 6767 280a  _reduction_agg(.
+00012f10: 2020 2020 2020 2020 2020 2020 2270 726f              "pro
+00012f20: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+00012f30: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+00012f40: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
+00012f50: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
+00012f60: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
+00012f70: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+00012f80: 2020 2020 2020 206f 7574 3d6f 7574 2c0a         out=out,.
+00012f90: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
+00012fa0: 7269 635f 6f6e 6c79 3d6e 756d 6572 6963  ric_only=numeric
+00012fb0: 5f6f 6e6c 792c 0a20 2020 2020 2020 2029  _only,.        )
+00012fc0: 0a20 2020 2020 2020 2069 6620 6d69 6e5f  .        if min_
+00012fd0: 636f 756e 743a 0a20 2020 2020 2020 2020  count:.         
+00012fe0: 2020 2063 6f6e 6420 3d20 7365 6c66 2e6e     cond = self.n
+00012ff0: 6f74 6e75 6c6c 2829 2e73 756d 2861 7869  otnull().sum(axi
+00013000: 733d 6178 6973 2920 3e3d 206d 696e 5f63  s=axis) >= min_c
+00013010: 6f75 6e74 0a20 2020 2020 2020 2020 2020  ount.           
+00013020: 2069 6620 6973 5f73 6572 6965 735f 6c69   if is_series_li
+00013030: 6b65 2863 6f6e 6429 3a0a 2020 2020 2020  ke(cond):.      
+00013040: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013050: 2072 6573 756c 742e 7768 6572 6528 636f   result.where(co
+00013060: 6e64 2c20 6f74 6865 723d 6e70 2e4e 614e  nd, other=np.NaN
+00013070: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00013080: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00013090: 2020 2020 7265 7475 726e 205f 7363 616c      return _scal
+000130a0: 6172 5f62 696e 6172 7928 0a20 2020 2020  ar_binary(.     
+000130b0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000130c0: 616d 6264 6120 782c 2079 3a20 7265 7375  ambda x, y: resu
+000130d0: 6c74 2069 6620 7820 6973 2079 2065 6c73  lt if x is y els
+000130e0: 6520 6e70 2e4e 614e 2c20 636f 6e64 2c20  e np.NaN, cond, 
+000130f0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00013100: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00013110: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00013120: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
+00013130: 2020 2020 7072 6f64 7563 7420 3d20 7072      product = pr
+00013140: 6f64 2020 2320 616c 6961 7365 6420 6464  od  # aliased dd
+00013150: 2e70 726f 6475 6374 0a0a 2020 2020 4064  .product..    @d
+00013160: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00013170: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00013180: 6620 6d61 7828 7365 6c66 2c20 6178 6973  f max(self, axis
+00013190: 3d30 2c20 736b 6970 6e61 3d54 7275 652c  =0, skipna=True,
+000131a0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+000131b0: 7365 2c20 6f75 743d 4e6f 6e65 2c20 6e75  se, out=None, nu
+000131c0: 6d65 7269 635f 6f6e 6c79 3d4e 6f6e 6529  meric_only=None)
+000131d0: 3a0a 2020 2020 2020 2020 6966 2028 0a20  :.        if (. 
+000131e0: 2020 2020 2020 2020 2020 2050 414e 4441             PANDA
+000131f0: 535f 4754 5f31 3430 0a20 2020 2020 2020  S_GT_140.       
+00013200: 2020 2020 2061 6e64 206e 6f74 2050 414e       and not PAN
+00013210: 4441 535f 4754 5f32 3030 0a20 2020 2020  DAS_GT_200.     
+00013220: 2020 2020 2020 2061 6e64 2061 7869 7320         and axis 
+00013230: 6973 204e 6f6e 650a 2020 2020 2020 2020  is None.        
+00013240: 2020 2020 616e 6420 6973 696e 7374 616e      and isinstan
+00013250: 6365 2873 656c 662c 2044 6174 6146 7261  ce(self, DataFra
+00013260: 6d65 290a 2020 2020 2020 2020 293a 0a20  me).        ):. 
+00013270: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+00013280: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
+00013290: 2020 2020 2020 2020 2020 2249 6e20 6120            "In a 
+000132a0: 6675 7475 7265 2076 6572 7369 6f6e 2c20  future version, 
+000132b0: 4461 7461 4672 616d 652e 6d61 7828 6178  DataFrame.max(ax
+000132c0: 6973 3d4e 6f6e 6529 2077 696c 6c20 7265  is=None) will re
+000132d0: 7475 726e 2061 2073 6361 6c61 7220 6d61  turn a scalar ma
+000132e0: 7820 6f76 6572 2074 6865 2065 6e74 6972  x over the entir
+000132f0: 6520 4461 7461 4672 616d 652e 2022 0a20  e DataFrame. ". 
+00013300: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00013310: 546f 2072 6574 6169 6e20 7468 6520 6f6c  To retain the ol
+00013320: 6420 6265 6861 7669 6f72 2c20 7573 6520  d behavior, use 
+00013330: 2766 7261 6d65 2e6d 6178 2861 7869 733d  'frame.max(axis=
+00013340: 3029 2720 6f72 206a 7573 7420 2766 7261  0)' or just 'fra
+00013350: 6d65 2e6d 6178 2829 2722 2c0a 2020 2020  me.max()'",.    
+00013360: 2020 2020 2020 2020 2020 2020 4675 7475              Futu
+00013370: 7265 5761 726e 696e 672c 0a20 2020 2020  reWarning,.     
+00013380: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00013390: 2020 2020 2061 7869 7320 3d20 300a 0a20       axis = 0.. 
+000133a0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000133b0: 6c66 2e5f 7265 6475 6374 696f 6e5f 6167  lf._reduction_ag
+000133c0: 6728 0a20 2020 2020 2020 2020 2020 2022  g(.            "
+000133d0: 6d61 7822 2c0a 2020 2020 2020 2020 2020  max",.          
+000133e0: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
+000133f0: 2020 2020 2020 2020 2073 6b69 706e 613d           skipna=
+00013400: 736b 6970 6e61 2c0a 2020 2020 2020 2020  skipna,.        
+00013410: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+00013420: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
+00013430: 2020 2020 2020 2020 206f 7574 3d6f 7574           out=out
+00013440: 2c0a 2020 2020 2020 2020 2020 2020 2320  ,.            # 
+00013450: 5374 6172 7469 6e67 2069 6e20 7061 6e64  Starting in pand
+00013460: 6173 2032 2e30 2c20 6061 7869 733d 4e6f  as 2.0, `axis=No
+00013470: 6e65 6020 646f 6573 2061 2066 756c 6c20  ne` does a full 
+00013480: 6167 6772 6567 6174 696f 6e20 6163 726f  aggregation acro
+00013490: 7373 2062 6f74 6820 6178 6573 0a20 2020  ss both axes.   
+000134a0: 2020 2020 2020 2020 206e 6f6e 655f 6973           none_is
+000134b0: 5f7a 6572 6f3d 6e6f 7420 5041 4e44 4153  _zero=not PANDAS
+000134c0: 5f47 545f 3230 302c 0a20 2020 2020 2020  _GT_200,.       
+000134d0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+000134e0: 793d 6e75 6d65 7269 635f 6f6e 6c79 2c0a  y=numeric_only,.
+000134f0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+00013500: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00013510: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+00013520: 6566 206d 696e 2873 656c 662c 2061 7869  ef min(self, axi
+00013530: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
+00013540: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+00013550: 6c73 652c 206f 7574 3d4e 6f6e 652c 206e  lse, out=None, n
+00013560: 756d 6572 6963 5f6f 6e6c 793d 4e6f 6e65  umeric_only=None
+00013570: 293a 0a20 2020 2020 2020 2069 6620 280a  ):.        if (.
+00013580: 2020 2020 2020 2020 2020 2020 5041 4e44              PAND
+00013590: 4153 5f47 545f 3134 300a 2020 2020 2020  AS_GT_140.      
+000135a0: 2020 2020 2020 616e 6420 6e6f 7420 5041        and not PA
+000135b0: 4e44 4153 5f47 545f 3230 300a 2020 2020  NDAS_GT_200.    
+000135c0: 2020 2020 2020 2020 616e 6420 6178 6973          and axis
+000135d0: 2069 7320 4e6f 6e65 0a20 2020 2020 2020   is None.       
+000135e0: 2020 2020 2061 6e64 2069 7369 6e73 7461       and isinsta
+000135f0: 6e63 6528 7365 6c66 2c20 4461 7461 4672  nce(self, DataFr
+00013600: 616d 6529 0a20 2020 2020 2020 2029 3a0a  ame).        ):.
+00013610: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+00013620: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+00013630: 2020 2020 2020 2020 2020 2022 496e 2061             "In a
+00013640: 2066 7574 7572 6520 7665 7273 696f 6e2c   future version,
+00013650: 2044 6174 6146 7261 6d65 2e6d 696e 2861   DataFrame.min(a
+00013660: 7869 733d 4e6f 6e65 2920 7769 6c6c 2072  xis=None) will r
+00013670: 6574 7572 6e20 6120 7363 616c 6172 206d  eturn a scalar m
+00013680: 696e 206f 7665 7220 7468 6520 656e 7469  in over the enti
+00013690: 7265 2044 6174 6146 7261 6d65 2e20 220a  re DataFrame. ".
+000136a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136b0: 2254 6f20 7265 7461 696e 2074 6865 206f  "To retain the o
+000136c0: 6c64 2062 6568 6176 696f 722c 2075 7365  ld behavior, use
+000136d0: 2027 6672 616d 652e 6d69 6e28 6178 6973   'frame.min(axis
+000136e0: 3d30 2927 206f 7220 6a75 7374 2027 6672  =0)' or just 'fr
+000136f0: 616d 652e 6d69 6e28 2927 222c 0a20 2020  ame.min()'",.   
+00013700: 2020 2020 2020 2020 2020 2020 2046 7574               Fut
+00013710: 7572 6557 6172 6e69 6e67 2c0a 2020 2020  ureWarning,.    
+00013720: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00013730: 2020 2020 2020 6178 6973 203d 2030 0a0a        axis = 0..
+00013740: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00013750: 656c 662e 5f72 6564 7563 7469 6f6e 5f61  elf._reduction_a
+00013760: 6767 280a 2020 2020 2020 2020 2020 2020  gg(.            
+00013770: 226d 696e 222c 0a20 2020 2020 2020 2020  "min",.         
+00013780: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
+00013790: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
+000137a0: 3d73 6b69 706e 612c 0a20 2020 2020 2020  =skipna,.       
+000137b0: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+000137c0: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
+000137d0: 2020 2020 2020 2020 2020 6f75 743d 6f75            out=ou
+000137e0: 742c 0a20 2020 2020 2020 2020 2020 2023  t,.            #
+000137f0: 2053 7461 7274 696e 6720 696e 2070 616e   Starting in pan
+00013800: 6461 7320 322e 302c 2060 6178 6973 3d4e  das 2.0, `axis=N
+00013810: 6f6e 6560 2064 6f65 7320 6120 6675 6c6c  one` does a full
+00013820: 2061 6767 7265 6761 7469 6f6e 2061 6372   aggregation acr
+00013830: 6f73 7320 626f 7468 2061 7865 730a 2020  oss both axes.  
+00013840: 2020 2020 2020 2020 2020 6e6f 6e65 5f69            none_i
+00013850: 735f 7a65 726f 3d6e 6f74 2050 414e 4441  s_zero=not PANDA
+00013860: 535f 4754 5f32 3030 2c0a 2020 2020 2020  S_GT_200,.      
+00013870: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+00013880: 6c79 3d6e 756d 6572 6963 5f6f 6e6c 792c  ly=numeric_only,
+00013890: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000138a0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+000138b0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+000138c0: 6465 6620 6964 786d 6178 2873 656c 662c  def idxmax(self,
+000138d0: 2061 7869 733d 4e6f 6e65 2c20 736b 6970   axis=None, skip
+000138e0: 6e61 3d54 7275 652c 2073 706c 6974 5f65  na=True, split_e
+000138f0: 7665 7279 3d46 616c 7365 293a 0a20 2020  very=False):.   
+00013900: 2020 2020 2066 6e20 3d20 2269 6478 6d61       fn = "idxma
+00013910: 7822 0a20 2020 2020 2020 2061 7869 7320  x".        axis 
+00013920: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
+00013930: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
+00013940: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
+00013950: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e69  _meta_nonempty.i
+00013960: 6478 6d61 7828 6178 6973 3d61 7869 732c  dxmax(axis=axis,
+00013970: 2073 6b69 706e 613d 736b 6970 6e61 290a   skipna=skipna).
+00013980: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
+00013990: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+000139a0: 2020 7265 7475 726e 206d 6170 5f70 6172    return map_par
+000139b0: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
+000139c0: 2020 2020 2020 2020 204d 2e69 6478 6d61           M.idxma
+000139d0: 782c 0a20 2020 2020 2020 2020 2020 2020  x,.             
+000139e0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000139f0: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
+00013a00: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+00013a10: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
+00013a20: 746f 6b65 6e5f 7072 6566 6978 202b 2066  token_prefix + f
+00013a30: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
+00013a40: 2020 2073 6b69 706e 613d 736b 6970 6e61     skipna=skipna
+00013a50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013a60: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
+00013a70: 2020 2020 2020 2020 2020 2020 2065 6e66               enf
+00013a80: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
+00013a90: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00013aa0: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
+00013ab0: 0a20 2020 2020 2020 2020 2020 2073 6361  .            sca
+00013ac0: 6c61 7220 3d20 6e6f 7420 6973 5f73 6572  lar = not is_ser
+00013ad0: 6965 735f 6c69 6b65 286d 6574 6129 0a20  ies_like(meta). 
+00013ae0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00013af0: 7420 3d20 6163 6128 0a20 2020 2020 2020  t = aca(.       
+00013b00: 2020 2020 2020 2020 205b 7365 6c66 5d2c           [self],
+00013b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013b20: 2063 6875 6e6b 3d69 6478 6d61 786d 696e   chunk=idxmaxmin
+00013b30: 5f63 6875 6e6b 2c0a 2020 2020 2020 2020  _chunk,.        
+00013b40: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+00013b50: 653d 6964 786d 6178 6d69 6e5f 6167 672c  e=idxmaxmin_agg,
+00013b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013b70: 2063 6f6d 6269 6e65 3d69 6478 6d61 786d   combine=idxmaxm
+00013b80: 696e 5f63 6f6d 6269 6e65 2c0a 2020 2020  in_combine,.    
+00013b90: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00013ba0: 3d6d 6574 612c 0a20 2020 2020 2020 2020  =meta,.         
+00013bb0: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
+00013bc0: 5f6b 7761 7267 733d 7b22 7363 616c 6172  _kwargs={"scalar
+00013bd0: 223a 2073 6361 6c61 727d 2c0a 2020 2020  ": scalar},.    
+00013be0: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
+00013bf0: 6e3d 7365 6c66 2e5f 746f 6b65 6e5f 7072  n=self._token_pr
+00013c00: 6566 6978 202b 2066 6e2c 0a20 2020 2020  efix + fn,.     
+00013c10: 2020 2020 2020 2020 2020 2073 706c 6974             split
+00013c20: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+00013c30: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
+00013c40: 2020 2020 736b 6970 6e61 3d73 6b69 706e      skipna=skipn
+00013c50: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+00013c60: 2020 2066 6e3d 666e 2c0a 2020 2020 2020     fn=fn,.      
+00013c70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00013c80: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00013c90: 6528 7365 6c66 2c20 4461 7461 4672 616d  e(self, DataFram
+00013ca0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00013cb0: 2020 2020 7265 7375 6c74 2e64 6976 6973      result.divis
+00013cc0: 696f 6e73 203d 2028 6d69 6e28 7365 6c66  ions = (min(self
+00013cd0: 2e63 6f6c 756d 6e73 292c 206d 6178 2873  .columns), max(s
+00013ce0: 656c 662e 636f 6c75 6d6e 7329 290a 2020  elf.columns)).  
+00013cf0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013d00: 2072 6573 756c 740a 0a20 2020 2040 6465   result..    @de
+00013d10: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00013d20: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00013d30: 2069 6478 6d69 6e28 7365 6c66 2c20 6178   idxmin(self, ax
+00013d40: 6973 3d4e 6f6e 652c 2073 6b69 706e 613d  is=None, skipna=
+00013d50: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
+00013d60: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
+00013d70: 2020 666e 203d 2022 6964 786d 696e 220a    fn = "idxmin".
+00013d80: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+00013d90: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+00013da0: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+00013db0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+00013dc0: 7461 5f6e 6f6e 656d 7074 792e 6964 786d  ta_nonempty.idxm
+00013dd0: 6178 2861 7869 733d 6178 6973 290a 2020  ax(axis=axis).  
+00013de0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+00013df0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00013e00: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
+00013e10: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+00013e20: 2020 2020 2020 204d 2e69 6478 6d69 6e2c         M.idxmin,
+00013e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013e40: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
+00013e50: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
+00013e60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013e70: 2020 746f 6b65 6e3d 7365 6c66 2e5f 746f    token=self._to
+00013e80: 6b65 6e5f 7072 6566 6978 202b 2066 6e2c  ken_prefix + fn,
+00013e90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013ea0: 2073 6b69 706e 613d 736b 6970 6e61 2c0a   skipna=skipna,.
+00013eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ec0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+00013ed0: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+00013ee0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+00013ef0: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
+00013f00: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00013f10: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
+00013f20: 7220 3d20 6e6f 7420 6973 5f73 6572 6965  r = not is_serie
+00013f30: 735f 6c69 6b65 286d 6574 6129 0a20 2020  s_like(meta).   
+00013f40: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+00013f50: 3d20 6163 6128 0a20 2020 2020 2020 2020  = aca(.         
+00013f60: 2020 2020 2020 205b 7365 6c66 5d2c 0a20         [self],. 
+00013f70: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00013f80: 6875 6e6b 3d69 6478 6d61 786d 696e 5f63  hunk=idxmaxmin_c
+00013f90: 6875 6e6b 2c0a 2020 2020 2020 2020 2020  hunk,.          
+00013fa0: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
+00013fb0: 6964 786d 6178 6d69 6e5f 6167 672c 0a20  idxmaxmin_agg,. 
+00013fc0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00013fd0: 6f6d 6269 6e65 3d69 6478 6d61 786d 696e  ombine=idxmaxmin
+00013fe0: 5f63 6f6d 6269 6e65 2c0a 2020 2020 2020  _combine,.      
+00013ff0: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
+00014000: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
+00014010: 2020 2020 2061 6767 7265 6761 7465 5f6b       aggregate_k
+00014020: 7761 7267 733d 7b22 7363 616c 6172 223a  wargs={"scalar":
+00014030: 2073 6361 6c61 727d 2c0a 2020 2020 2020   scalar},.      
+00014040: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
+00014050: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
+00014060: 6978 202b 2066 6e2c 0a20 2020 2020 2020  ix + fn,.       
+00014070: 2020 2020 2020 2020 2073 706c 6974 5f65           split_e
+00014080: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+00014090: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000140a0: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+000140b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000140c0: 2066 6e3d 666e 2c0a 2020 2020 2020 2020   fn=fn,.        
+000140d0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000140e0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+000140f0: 7365 6c66 2c20 4461 7461 4672 616d 6529  self, DataFrame)
+00014100: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014110: 2020 7265 7375 6c74 2e64 6976 6973 696f    result.divisio
+00014120: 6e73 203d 2028 6d69 6e28 7365 6c66 2e63  ns = (min(self.c
+00014130: 6f6c 756d 6e73 292c 206d 6178 2873 656c  olumns), max(sel
+00014140: 662e 636f 6c75 6d6e 7329 290a 2020 2020  f.columns)).    
+00014150: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00014160: 6573 756c 740a 0a20 2020 2040 6465 7269  esult..    @deri
+00014170: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+00014180: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
+00014190: 6f75 6e74 2873 656c 662c 2061 7869 733d  ount(self, axis=
+000141a0: 4e6f 6e65 2c20 7370 6c69 745f 6576 6572  None, split_ever
+000141b0: 793d 4661 6c73 652c 206e 756d 6572 6963  y=False, numeric
+000141c0: 5f6f 6e6c 793d 4661 6c73 6529 3a0a 2020  _only=False):.  
+000141d0: 2020 2020 2020 2320 5468 6973 206d 6574        # This met
+000141e0: 686f 6420 6973 2073 6861 7265 6420 6279  hod is shared by
+000141f0: 2044 6174 6146 7261 6d65 202f 2053 6572   DataFrame / Ser
+00014200: 6965 732c 2062 7574 206f 6e6c 7920 4461  ies, but only Da
+00014210: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
+00014220: 2320 7375 7070 6f72 7473 2060 6e75 6d65  # supports `nume
+00014230: 7269 635f 6f6e 6c79 3d60 2e20 4861 6e64  ric_only=`. Hand
+00014240: 6c65 2061 6363 6f72 6469 6e67 6c79 2068  le accordingly h
+00014250: 6572 652e 0a20 2020 2020 2020 206e 756d  ere..        num
+00014260: 6572 6963 5f6f 6e6c 795f 6b77 6172 6773  eric_only_kwargs
+00014270: 203d 207b 7d0a 2020 2020 2020 2020 6966   = {}.        if
+00014280: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
+00014290: 6b65 2873 656c 6629 3a0a 2020 2020 2020  ke(self):.      
+000142a0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+000142b0: 6c79 5f6b 7761 7267 7320 3d20 6765 745f  ly_kwargs = get_
+000142c0: 6e75 6d65 7269 635f 6f6e 6c79 5f6b 7761  numeric_only_kwa
+000142d0: 7267 7328 6e75 6d65 7269 635f 6f6e 6c79  rgs(numeric_only
+000142e0: 290a 2020 2020 2020 2020 6178 6973 203d  ).        axis =
+000142f0: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
+00014300: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
+00014310: 2020 2074 6f6b 656e 203d 2073 656c 662e     token = self.
+00014320: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
+00014330: 2263 6f75 6e74 220a 2020 2020 2020 2020  "count".        
+00014340: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
+00014350: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
+00014360: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
+00014370: 6d70 7479 2e63 6f75 6e74 2861 7869 733d  mpty.count(axis=
+00014380: 6178 6973 2c20 2a2a 6e75 6d65 7269 635f  axis, **numeric_
+00014390: 6f6e 6c79 5f6b 7761 7267 7329 0a20 2020  only_kwargs).   
+000143a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000143b0: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+000143c0: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+000143d0: 2020 2020 204d 2e63 6f75 6e74 2c0a 2020       M.count,.  
+000143e0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+000143f0: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
+00014400: 2020 2020 2020 2020 2074 6f6b 656e 3d74           token=t
+00014410: 6f6b 656e 2c0a 2020 2020 2020 2020 2020  oken,.          
+00014420: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
+00014430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014440: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+00014450: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
+00014460: 2020 2020 2020 2020 202a 2a6e 756d 6572           **numer
+00014470: 6963 5f6f 6e6c 795f 6b77 6172 6773 2c0a  ic_only_kwargs,.
+00014480: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00014490: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000144a0: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
+000144b0: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
+000144c0: 7479 2e63 6f75 6e74 2829 0a0a 2020 2020  ty.count()..    
+000144d0: 2020 2020 2020 2020 2320 4e65 6564 2074          # Need t
+000144e0: 6865 2061 7374 7970 6528 696e 7429 2066  he astype(int) f
+000144f0: 6f72 2065 6d70 7479 2064 6174 6166 7261  or empty datafra
+00014500: 6d65 732c 2077 6869 6368 2073 756d 2074  mes, which sum t
+00014510: 6f20 666c 6f61 7420 6474 7970 650a 2020  o float dtype.  
+00014520: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00014530: 203d 2073 656c 662e 7265 6475 6374 696f   = self.reductio
+00014540: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00014550: 2020 204d 2e63 6f75 6e74 2c0a 2020 2020     M.count,.    
+00014560: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
+00014570: 6567 6174 653d 5f63 6f75 6e74 5f61 6767  egate=_count_agg
+00014580: 7265 6761 7465 2c0a 2020 2020 2020 2020  regate,.        
+00014590: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
+000145a0: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+000145b0: 2020 2074 6f6b 656e 3d74 6f6b 656e 2c0a     token=token,.
+000145c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000145d0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+000145e0: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
+000145f0: 2020 2020 2020 2020 2063 6875 6e6b 5f6b           chunk_k
+00014600: 7761 7267 733d 6e75 6d65 7269 635f 6f6e  wargs=numeric_on
+00014610: 6c79 5f6b 7761 7267 732c 0a20 2020 2020  ly_kwargs,.     
+00014620: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00014630: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00014640: 6365 2873 656c 662c 2044 6174 6146 7261  ce(self, DataFra
+00014650: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
+00014660: 2020 2020 2072 6573 756c 742e 6469 7669       result.divi
+00014670: 7369 6f6e 7320 3d20 2873 656c 662e 636f  sions = (self.co
+00014680: 6c75 6d6e 732e 6d69 6e28 292c 2073 656c  lumns.min(), sel
+00014690: 662e 636f 6c75 6d6e 732e 6d61 7828 2929  f.columns.max())
+000146a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000146b0: 7572 6e20 7265 7375 6c74 0a0a 2020 2020  urn result..    
+000146c0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+000146d0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+000146e0: 6465 6620 6d6f 6465 2873 656c 662c 2064  def mode(self, d
+000146f0: 726f 706e 613d 5472 7565 2c20 7370 6c69  ropna=True, spli
+00014700: 745f 6576 6572 793d 4661 6c73 6529 3a0a  t_every=False):.
+00014710: 2020 2020 2020 2020 6d6f 6465 5f73 6572          mode_ser
+00014720: 6965 7320 3d20 7365 6c66 2e72 6564 7563  ies = self.reduc
+00014730: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+00014740: 2020 6368 756e 6b3d 4d2e 7661 6c75 655f    chunk=M.value_
+00014750: 636f 756e 7473 2c0a 2020 2020 2020 2020  counts,.        
+00014760: 2020 2020 636f 6d62 696e 653d 4d2e 7375      combine=M.su
+00014770: 6d2c 0a20 2020 2020 2020 2020 2020 2061  m,.            a
+00014780: 6767 7265 6761 7465 3d5f 6d6f 6465 5f61  ggregate=_mode_a
+00014790: 6767 7265 6761 7465 2c0a 2020 2020 2020  ggregate,.      
+000147a0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
+000147b0: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
+000147c0: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+000147d0: 5f6b 7761 7267 733d 7b22 6472 6f70 6e61  _kwargs={"dropna
+000147e0: 223a 2064 726f 706e 617d 2c0a 2020 2020  ": dropna},.    
+000147f0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+00014800: 655f 6b77 6172 6773 3d7b 2264 726f 706e  e_kwargs={"dropn
+00014810: 6122 3a20 6472 6f70 6e61 7d2c 0a20 2020  a": dropna},.   
+00014820: 2020 2020 2029 0a20 2020 2020 2020 206d       ).        m
+00014830: 6f64 655f 7365 7269 6573 2e6e 616d 6520  ode_series.name 
+00014840: 3d20 7365 6c66 2e6e 616d 650a 2020 2020  = self.name.    
+00014850: 2020 2020 7265 7475 726e 206d 6f64 655f      return mode_
+00014860: 7365 7269 6573 0a0a 2020 2020 405f 6e75  series..    @_nu
+00014870: 6d65 7269 635f 6f6e 6c79 0a20 2020 2040  meric_only.    @
+00014880: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00014890: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+000148a0: 6566 206d 6561 6e28 0a20 2020 2020 2020  ef mean(.       
+000148b0: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
+000148c0: 7869 733d 302c 0a20 2020 2020 2020 2073  xis=0,.        s
+000148d0: 6b69 706e 613d 5472 7565 2c0a 2020 2020  kipna=True,.    
+000148e0: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+000148f0: 4661 6c73 652c 0a20 2020 2020 2020 2064  False,.        d
+00014900: 7479 7065 3d4e 6f6e 652c 0a20 2020 2020  type=None,.     
+00014910: 2020 206f 7574 3d4e 6f6e 652c 0a20 2020     out=None,.   
+00014920: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+00014930: 793d 4e6f 6e65 2c0a 2020 2020 293a 0a20  y=None,.    ):. 
+00014940: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
+00014950: 2020 2020 2020 2020 5041 4e44 4153 5f47          PANDAS_G
+00014960: 545f 3134 300a 2020 2020 2020 2020 2020  T_140.          
+00014970: 2020 616e 6420 6e6f 7420 5041 4e44 4153    and not PANDAS
+00014980: 5f47 545f 3230 300a 2020 2020 2020 2020  _GT_200.        
+00014990: 2020 2020 616e 6420 6178 6973 2069 7320      and axis is 
+000149a0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+000149b0: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
+000149c0: 7365 6c66 2c20 4461 7461 4672 616d 6529  self, DataFrame)
+000149d0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+000149e0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+000149f0: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+00014a00: 2020 2020 2020 2022 496e 2061 2066 7574         "In a fut
+00014a10: 7572 6520 7665 7273 696f 6e2c 2044 6174  ure version, Dat
+00014a20: 6146 7261 6d65 2e6d 6561 6e28 6178 6973  aFrame.mean(axis
+00014a30: 3d4e 6f6e 6529 2077 696c 6c20 7265 7475  =None) will retu
+00014a40: 726e 2061 2073 6361 6c61 7220 6d65 616e  rn a scalar mean
+00014a50: 206f 7665 7220 7468 6520 656e 7469 7265   over the entire
+00014a60: 2044 6174 6146 7261 6d65 2e20 220a 2020   DataFrame. ".  
+00014a70: 2020 2020 2020 2020 2020 2020 2020 2254                "T
+00014a80: 6f20 7265 7461 696e 2074 6865 206f 6c64  o retain the old
+00014a90: 2062 6568 6176 696f 722c 2075 7365 2027   behavior, use '
+00014aa0: 6672 616d 652e 6d65 616e 2861 7869 733d  frame.mean(axis=
+00014ab0: 3029 2720 6f72 206a 7573 7420 2766 7261  0)' or just 'fra
+00014ac0: 6d65 2e6d 6561 6e28 2927 222c 0a20 2020  me.mean()'",.   
+00014ad0: 2020 2020 2020 2020 2020 2020 2046 7574               Fut
+00014ae0: 7572 6557 6172 6e69 6e67 2c0a 2020 2020  ureWarning,.    
+00014af0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00014b00: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
+00014b10: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
+00014b20: 732c 206e 6f6e 655f 6973 5f7a 6572 6f3d  s, none_is_zero=
+00014b30: 6e6f 7420 5041 4e44 4153 5f47 545f 3230  not PANDAS_GT_20
+00014b40: 3029 0a20 2020 2020 2020 205f 7261 6973  0).        _rais
+00014b50: 655f 6966 5f6f 626a 6563 745f 7365 7269  e_if_object_seri
+00014b60: 6573 2873 656c 662c 2022 6d65 616e 2229  es(self, "mean")
+00014b70: 0a20 2020 2020 2020 2023 204e 4f54 453a  .        # NOTE:
+00014b80: 2044 6f20 7765 2077 616e 7420 746f 2077   Do we want to w
+00014b90: 6172 6e20 6865 7265 3f0a 2020 2020 2020  arn here?.      
+00014ba0: 2020 7769 7468 2063 6865 636b 5f6e 756d    with check_num
+00014bb0: 6572 6963 5f6f 6e6c 795f 6465 7072 6563  eric_only_deprec
+00014bc0: 6174 696f 6e28 292c 2063 6865 636b 5f6e  ation(), check_n
+00014bd0: 7569 7361 6e63 655f 636f 6c75 6d6e 735f  uisance_columns_
+00014be0: 7761 726e 696e 6728 293a 0a20 2020 2020  warning():.     
+00014bf0: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
+00014c00: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
+00014c10: 792e 6d65 616e 280a 2020 2020 2020 2020  y.mean(.        
+00014c20: 2020 2020 2020 2020 6178 6973 3d61 7869          axis=axi
+00014c30: 732c 2073 6b69 706e 613d 736b 6970 6e61  s, skipna=skipna
+00014c40: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d6e  , numeric_only=n
+00014c50: 756d 6572 6963 5f6f 6e6c 790a 2020 2020  umeric_only.    
+00014c60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00014c70: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
+00014c80: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00014c90: 6c74 203d 206d 6170 5f70 6172 7469 7469  lt = map_partiti
+00014ca0: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+00014cb0: 2020 2020 204d 2e6d 6561 6e2c 0a20 2020       M.mean,.   
+00014cc0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00014cd0: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
+00014ce0: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
+00014cf0: 2020 2020 2020 2020 2020 2020 2020 746f                to
+00014d00: 6b65 6e3d 7365 6c66 2e5f 746f 6b65 6e5f  ken=self._token_
+00014d10: 7072 6566 6978 202b 2022 6d65 616e 222c  prefix + "mean",
+00014d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014d30: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
+00014d40: 2020 2020 2020 2020 2020 2020 736b 6970              skip
+00014d50: 6e61 3d73 6b69 706e 612c 0a20 2020 2020  na=skipna,.     
+00014d60: 2020 2020 2020 2020 2020 2065 6e66 6f72             enfor
+00014d70: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+00014d80: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00014d90: 2020 206e 756d 6572 6963 5f6f 6e6c 793d     numeric_only=
+00014da0: 6e75 6d65 7269 635f 6f6e 6c79 2c0a 2020  numeric_only,.  
+00014db0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00014dc0: 2020 2020 2020 2020 7265 7475 726e 2068          return h
+00014dd0: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
+00014de0: 6573 756c 7429 0a20 2020 2020 2020 2065  esult).        e
+00014df0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00014e00: 206e 756d 203d 2073 656c 662e 5f67 6574   num = self._get
+00014e10: 5f6e 756d 6572 6963 5f64 6174 6128 290a  _numeric_data().
+00014e20: 2020 2020 2020 2020 2020 2020 7320 3d20              s = 
+00014e30: 6e75 6d2e 7375 6d28 736b 6970 6e61 3d73  num.sum(skipna=s
+00014e40: 6b69 706e 612c 2073 706c 6974 5f65 7665  kipna, split_eve
+00014e50: 7279 3d73 706c 6974 5f65 7665 7279 290a  ry=split_every).
+00014e60: 2020 2020 2020 2020 2020 2020 6e20 3d20              n = 
+00014e70: 6e75 6d2e 636f 756e 7428 7370 6c69 745f  num.count(split_
+00014e80: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00014e90: 7929 0a20 2020 2020 2020 2020 2020 2023  y).            #
+00014ea0: 2053 7461 7274 696e 6720 696e 2070 616e   Starting in pan
+00014eb0: 6461 7320 322e 302c 2060 6178 6973 3d4e  das 2.0, `axis=N
+00014ec0: 6f6e 6560 2064 6f65 7320 6120 6675 6c6c  one` does a full
+00014ed0: 2061 6767 7265 6761 7469 6f6e 2061 6372   aggregation acr
+00014ee0: 6f73 7320 626f 7468 2061 7865 730a 2020  oss both axes.  
+00014ef0: 2020 2020 2020 2020 2020 6966 2050 414e            if PAN
+00014f00: 4441 535f 4754 5f32 3030 2061 6e64 2061  DAS_GT_200 and a
+00014f10: 7869 7320 6973 204e 6f6e 6520 616e 6420  xis is None and 
+00014f20: 6973 696e 7374 616e 6365 2873 656c 662c  isinstance(self,
+00014f30: 2044 6174 6146 7261 6d65 293a 0a20 2020   DataFrame):.   
+00014f40: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00014f50: 756c 7420 3d20 732e 7375 6d28 2920 2f20  ult = s.sum() / 
+00014f60: 6e2e 7375 6d28 290a 2020 2020 2020 2020  n.sum().        
+00014f70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00014f80: 2020 2020 2020 2020 2020 6e61 6d65 203d            name =
+00014f90: 2073 656c 662e 5f74 6f6b 656e 5f70 7265   self._token_pre
+00014fa0: 6669 7820 2b20 226d 6561 6e2d 2573 2220  fix + "mean-%s" 
+00014fb0: 2520 746f 6b65 6e69 7a65 2873 656c 662c  % tokenize(self,
+00014fc0: 2061 7869 732c 2073 6b69 706e 6129 0a20   axis, skipna). 
+00014fd0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00014fe0: 6573 756c 7420 3d20 6d61 705f 7061 7274  esult = map_part
+00014ff0: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+00015000: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
+00015010: 6f64 732e 6d65 616e 5f61 6767 7265 6761  ods.mean_aggrega
+00015020: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+00015030: 2020 2020 2020 2020 732c 0a20 2020 2020          s,.     
+00015040: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00015050: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015060: 2020 2020 2020 746f 6b65 6e3d 6e61 6d65        token=name
+00015070: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015080: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
+00015090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000150a0: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
+000150b0: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
+000150c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000150d0: 2070 6172 656e 745f 6d65 7461 3d73 656c   parent_meta=sel
+000150e0: 662e 5f6d 6574 612c 0a20 2020 2020 2020  f._meta,.       
+000150f0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00015100: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00015110: 696e 7374 616e 6365 2873 656c 662c 2044  instance(self, D
+00015120: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
+00015130: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00015140: 6573 756c 742e 6469 7669 7369 6f6e 7320  esult.divisions 
+00015150: 3d20 2873 656c 662e 636f 6c75 6d6e 732e  = (self.columns.
+00015160: 6d69 6e28 292c 2073 656c 662e 636f 6c75  min(), self.colu
+00015170: 6d6e 732e 6d61 7828 2929 0a20 2020 2020  mns.max()).     
+00015180: 2020 2020 2020 2072 6574 7572 6e20 6861         return ha
+00015190: 6e64 6c65 5f6f 7574 286f 7574 2c20 7265  ndle_out(out, re
+000151a0: 7375 6c74 290a 0a20 2020 2064 6566 206d  sult)..    def m
+000151b0: 6564 6961 6e5f 6170 7072 6f78 696d 6174  edian_approximat
+000151c0: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+000151d0: 0a20 2020 2020 2020 2061 7869 733d 4e6f  .        axis=No
+000151e0: 6e65 2c0a 2020 2020 2020 2020 6d65 7468  ne,.        meth
+000151f0: 6f64 3d22 6465 6661 756c 7422 2c0a 2020  od="default",.  
+00015200: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00015210: 5265 7475 726e 2074 6865 2061 7070 726f  Return the appro
+00015220: 7869 6d61 7465 206d 6564 6961 6e20 6f66  ximate median of
+00015230: 2074 6865 2076 616c 7565 7320 6f76 6572   the values over
+00015240: 2074 6865 2072 6571 7565 7374 6564 2061   the requested a
+00015250: 7869 732e 0a0a 2020 2020 2020 2020 5061  xis...        Pa
+00015260: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00015270: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00015280: 2020 2020 6178 6973 203a 207b 302c 2031      axis : {0, 1
+00015290: 2c20 2269 6e64 6578 222c 2022 636f 6c75  , "index", "colu
+000152a0: 6d6e 7322 7d20 2864 6566 6175 6c74 2030  mns"} (default 0
+000152b0: 290a 2020 2020 2020 2020 2020 2020 3020  ).            0 
+000152c0: 6f72 2060 6022 696e 6465 7822 6060 2066  or ``"index"`` f
+000152d0: 6f72 2072 6f77 2d77 6973 652c 2031 206f  or row-wise, 1 o
+000152e0: 7220 6060 2263 6f6c 756d 6e73 2260 6020  r ``"columns"`` 
+000152f0: 666f 7220 636f 6c75 6d6e 2d77 6973 650a  for column-wise.
+00015300: 2020 2020 2020 2020 6d65 7468 6f64 203a          method :
+00015310: 207b 2764 6566 6175 6c74 272c 2027 7464   {'default', 'td
+00015320: 6967 6573 7427 2c20 2764 6173 6b27 7d2c  igest', 'dask'},
+00015330: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00015340: 2020 2020 2020 5768 6174 206d 6574 686f        What metho
+00015350: 6420 746f 2075 7365 2e20 4279 2064 6566  d to use. By def
+00015360: 6175 6c74 2077 696c 6c20 7573 6520 4461  ault will use Da
+00015370: 736b 2773 2069 6e74 6572 6e61 6c20 6375  sk's internal cu
+00015380: 7374 6f6d 0a20 2020 2020 2020 2020 2020  stom.           
+00015390: 2061 6c67 6f72 6974 686d 2028 6060 2264   algorithm (``"d
+000153a0: 6173 6b22 6060 292e 2020 4966 2073 6574  ask"``).  If set
+000153b0: 2074 6f20 6060 2274 6469 6765 7374 2260   to ``"tdigest"`
+000153c0: 6020 7769 6c6c 2075 7365 2074 6469 6765  ` will use tdige
+000153d0: 7374 0a20 2020 2020 2020 2020 2020 2066  st.            f
+000153e0: 6f72 2066 6c6f 6174 7320 616e 6420 696e  or floats and in
+000153f0: 7473 2061 6e64 2066 616c 6c62 6163 6b20  ts and fallback 
+00015400: 746f 2074 6865 2060 6022 6461 736b 2260  to the ``"dask"`
+00015410: 6020 6f74 6865 7277 6973 652e 0a20 2020  ` otherwise..   
+00015420: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00015430: 2072 6574 7572 6e20 7365 6c66 2e71 7561   return self.qua
+00015440: 6e74 696c 6528 713d 302e 352c 2061 7869  ntile(q=0.5, axi
+00015450: 733d 6178 6973 2c20 6d65 7468 6f64 3d6d  s=axis, method=m
+00015460: 6574 686f 6429 2e72 656e 616d 6528 4e6f  ethod).rename(No
+00015470: 6e65 290a 0a20 2020 2040 6465 7269 7665  ne)..    @derive
+00015480: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00015490: 616d 6529 0a20 2020 2064 6566 206d 6564  ame).    def med
+000154a0: 6961 6e28 7365 6c66 2c20 6178 6973 3d4e  ian(self, axis=N
+000154b0: 6f6e 652c 206d 6574 686f 643d 2264 6566  one, method="def
+000154c0: 6175 6c74 2229 3a0a 2020 2020 2020 2020  ault"):.        
+000154d0: 6966 2061 7869 7320 696e 2028 312c 2022  if axis in (1, "
+000154e0: 636f 6c75 6d6e 7322 2920 6f72 2073 656c  columns") or sel
+000154f0: 662e 6e70 6172 7469 7469 6f6e 7320 3d3d  f.npartitions ==
+00015500: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00015510: 2320 4361 6e20 7072 6f76 6964 6520 616e  # Can provide an
+00015520: 2065 7861 6374 206d 6564 6961 6e20 696e   exact median in
+00015530: 2074 6865 7365 2063 6173 6573 0a20 2020   these cases.   
+00015540: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00015550: 7365 6c66 2e6d 6564 6961 6e5f 6170 7072  self.median_appr
+00015560: 6f78 696d 6174 6528 6178 6973 3d61 7869  oximate(axis=axi
+00015570: 732c 206d 6574 686f 643d 6d65 7468 6f64  s, method=method
+00015580: 290a 2020 2020 2020 2020 7261 6973 6520  ).        raise 
+00015590: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+000155a0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+000155b0: 2022 4461 736b 2064 6f65 736e 2774 2069   "Dask doesn't i
+000155c0: 6d70 6c65 6d65 6e74 2061 6e20 6578 6163  mplement an exac
+000155d0: 7420 6d65 6469 616e 2069 6e20 616c 6c20  t median in all 
+000155e0: 6361 7365 7320 6173 2074 6869 7320 6973  cases as this is
+000155f0: 2068 6172 6420 746f 2064 6f20 696e 2070   hard to do in p
+00015600: 6172 616c 6c65 6c2e 2022 0a20 2020 2020  arallel. ".     
+00015610: 2020 2020 2020 2022 5365 6520 7468 6520         "See the 
+00015620: 606d 6564 6961 6e5f 6170 7072 6f78 696d  `median_approxim
+00015630: 6174 6560 206d 6574 686f 6420 696e 7374  ate` method inst
+00015640: 6561 642c 2077 6869 6368 2075 7365 7320  ead, which uses 
+00015650: 616e 2061 7070 726f 7869 6d61 7465 2061  an approximate a
+00015660: 6c67 6f72 6974 686d 2e22 0a20 2020 2020  lgorithm.".     
+00015670: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
+00015680: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00015690: 7261 6d65 290a 2020 2020 6465 6620 7661  rame).    def va
+000156a0: 7228 0a20 2020 2020 2020 2073 656c 662c  r(.        self,
+000156b0: 0a20 2020 2020 2020 2061 7869 733d 4e6f  .        axis=No
+000156c0: 6e65 2c0a 2020 2020 2020 2020 736b 6970  ne,.        skip
+000156d0: 6e61 3d54 7275 652c 0a20 2020 2020 2020  na=True,.       
+000156e0: 2064 646f 663d 312c 0a20 2020 2020 2020   ddof=1,.       
+000156f0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+00015700: 7365 2c0a 2020 2020 2020 2020 6474 7970  se,.        dtyp
+00015710: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
+00015720: 6f75 743d 4e6f 6e65 2c0a 2020 2020 2020  out=None,.      
+00015730: 2020 6e75 6d65 7269 635f 6f6e 6c79 3d6e    numeric_only=n
+00015740: 6f5f 6465 6661 756c 742c 0a20 2020 2029  o_default,.    )
+00015750: 3a0a 2020 2020 2020 2020 6178 6973 203d  :.        axis =
+00015760: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
+00015770: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
+00015780: 2020 205f 7261 6973 655f 6966 5f6f 626a     _raise_if_obj
+00015790: 6563 745f 7365 7269 6573 2873 656c 662c  ect_series(self,
+000157a0: 2022 7661 7222 290a 2020 2020 2020 2020   "var").        
+000157b0: 6e75 6d65 7269 635f 6f6e 6c79 5f6b 7761  numeric_only_kwa
+000157c0: 7267 7320 3d20 6765 745f 6e75 6d65 7269  rgs = get_numeri
+000157d0: 635f 6f6e 6c79 5f6b 7761 7267 7328 6e75  c_only_kwargs(nu
+000157e0: 6d65 7269 635f 6f6e 6c79 290a 2020 2020  meric_only).    
+000157f0: 2020 2020 7769 7468 2063 6865 636b 5f6e      with check_n
+00015800: 756d 6572 6963 5f6f 6e6c 795f 6465 7072  umeric_only_depr
+00015810: 6563 6174 696f 6e28 0a20 2020 2020 2020  ecation(.       
+00015820: 2020 2020 2022 7661 7222 2c20 5472 7565       "var", True
+00015830: 0a20 2020 2020 2020 2029 2c20 6368 6563  .        ), chec
+00015840: 6b5f 7265 6475 6374 696f 6e73 5f72 756e  k_reductions_run
+00015850: 7469 6d65 5f77 6172 6e69 6e67 2829 3a0a  time_warning():.
+00015860: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00015870: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
+00015880: 6e65 6d70 7479 2e76 6172 280a 2020 2020  nempty.var(.    
+00015890: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+000158a0: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
+000158b0: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
+000158c0: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
+000158d0: 2020 2020 2020 2a2a 6e75 6d65 7269 635f        **numeric_
+000158e0: 6f6e 6c79 5f6b 7761 7267 732c 0a20 2020  only_kwargs,.   
+000158f0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00015900: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
+00015910: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00015920: 756c 7420 3d20 6d61 705f 7061 7274 6974  ult = map_partit
+00015930: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
+00015940: 2020 2020 2020 4d2e 7661 722c 0a20 2020        M.var,.   
+00015950: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00015960: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
+00015970: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
+00015980: 2020 2020 2020 2020 2020 2020 2020 746f                to
+00015990: 6b65 6e3d 7365 6c66 2e5f 746f 6b65 6e5f  ken=self._token_
+000159a0: 7072 6566 6978 202b 2022 7661 7222 2c0a  prefix + "var",.
+000159b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000159c0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+000159d0: 2020 2020 2020 2020 2020 2073 6b69 706e             skipn
+000159e0: 613d 736b 6970 6e61 2c0a 2020 2020 2020  a=skipna,.      
+000159f0: 2020 2020 2020 2020 2020 6464 6f66 3d64            ddof=d
+00015a00: 646f 662c 0a20 2020 2020 2020 2020 2020  dof,.           
+00015a10: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
+00015a20: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
+00015a30: 2020 2020 2020 2020 2020 2020 202a 2a6e               **n
+00015a40: 756d 6572 6963 5f6f 6e6c 795f 6b77 6172  umeric_only_kwar
+00015a50: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+00015a60: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00015a70: 7475 726e 2068 616e 646c 655f 6f75 7428  turn handle_out(
+00015a80: 6f75 742c 2072 6573 756c 7429 0a20 2020  out, result).   
+00015a90: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00015aa0: 2020 2020 2020 2069 6620 7365 6c66 2e6e         if self.n
+00015ab0: 6469 6d20 3d3d 2031 3a0a 2020 2020 2020  dim == 1:.      
+00015ac0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+00015ad0: 203d 2073 656c 662e 5f76 6172 5f31 6428   = self._var_1d(
+00015ae0: 7365 6c66 2c20 736b 6970 6e61 2c20 6464  self, skipna, dd
+00015af0: 6f66 2c20 7370 6c69 745f 6576 6572 7929  of, split_every)
+00015b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015b10: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+00015b20: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+00015b30: 0a20 2020 2020 2020 2020 2020 2023 2070  .            # p
+00015b40: 616e 6461 7320 312e 302b 2064 6f65 7320  andas 1.0+ does 
+00015b50: 6e6f 7420 696d 706c 656d 656e 7420 7661  not implement va
+00015b60: 7220 6f6e 2074 696d 6564 656c 7461 0a20  r on timedelta. 
+00015b70: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00015b80: 7420 3d20 7365 6c66 2e5f 7661 725f 6e75  t = self._var_nu
+00015b90: 6d65 7269 6328 736b 6970 6e61 2c20 6464  meric(skipna, dd
+00015ba0: 6f66 2c20 7370 6c69 745f 6576 6572 7929  of, split_every)
+00015bb0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00015bc0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+00015bd0: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
+00015be0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00015bf0: 7375 6c74 2e64 6976 6973 696f 6e73 203d  sult.divisions =
+00015c00: 2028 7365 6c66 2e63 6f6c 756d 6e73 2e6d   (self.columns.m
+00015c10: 696e 2829 2c20 7365 6c66 2e63 6f6c 756d  in(), self.colum
+00015c20: 6e73 2e6d 6178 2829 290a 2020 2020 2020  ns.max()).      
+00015c30: 2020 2020 2020 7265 7475 726e 2068 616e        return han
+00015c40: 646c 655f 6f75 7428 6f75 742c 2072 6573  dle_out(out, res
+00015c50: 756c 7429 0a0a 2020 2020 6465 6620 5f76  ult)..    def _v
+00015c60: 6172 5f6e 756d 6572 6963 2873 656c 662c  ar_numeric(self,
+00015c70: 2073 6b69 706e 613d 5472 7565 2c20 6464   skipna=True, dd
+00015c80: 6f66 3d31 2c20 7370 6c69 745f 6576 6572  of=1, split_ever
+00015c90: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
+00015ca0: 2020 6e75 6d20 3d20 7365 6c66 2e73 656c    num = self.sel
+00015cb0: 6563 745f 6474 7970 6573 2869 6e63 6c75  ect_dtypes(inclu
+00015cc0: 6465 3d5b 226e 756d 6265 7222 2c20 2262  de=["number", "b
+00015cd0: 6f6f 6c22 5d2c 2065 7863 6c75 6465 3d5b  ool"], exclude=[
+00015ce0: 6e70 2e74 696d 6564 656c 7461 3634 5d29  np.timedelta64])
+00015cf0: 0a0a 2020 2020 2020 2020 7661 6c75 6573  ..        values
+00015d00: 5f64 7479 7065 203d 206e 756d 2e76 616c  _dtype = num.val
+00015d10: 7565 732e 6474 7970 650a 2020 2020 2020  ues.dtype.      
+00015d20: 2020 6172 7261 795f 7661 6c75 6573 203d    array_values =
+00015d30: 206e 756d 2e76 616c 7565 730a 0a20 2020   num.values..   
+00015d40: 2020 2020 2069 6620 6e6f 7420 6e70 2e69       if not np.i
+00015d50: 7373 7562 6474 7970 6528 7661 6c75 6573  ssubdtype(values
+00015d60: 5f64 7479 7065 2c20 6e70 2e6e 756d 6265  _dtype, np.numbe
+00015d70: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00015d80: 6172 7261 795f 7661 6c75 6573 203d 206e  array_values = n
+00015d90: 756d 2e76 616c 7565 732e 6173 7479 7065  um.values.astype
+00015da0: 2822 6638 2229 0a0a 2020 2020 2020 2020  ("f8")..        
+00015db0: 7661 7220 3d20 6461 2e6e 616e 7661 7220  var = da.nanvar 
+00015dc0: 6966 2073 6b69 706e 6120 6f72 2073 6b69  if skipna or ski
+00015dd0: 706e 6120 6973 204e 6f6e 6520 656c 7365  pna is None else
+00015de0: 2064 612e 7661 720a 2020 2020 2020 2020   da.var.        
+00015df0: 6172 7261 795f 7661 7220 3d20 7661 7228  array_var = var(
+00015e00: 6172 7261 795f 7661 6c75 6573 2c20 6178  array_values, ax
+00015e10: 6973 3d30 2c20 6464 6f66 3d64 646f 662c  is=0, ddof=ddof,
+00015e20: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+00015e30: 6974 5f65 7665 7279 290a 0a20 2020 2020  it_every)..     
+00015e40: 2020 206e 616d 6520 3d20 7365 6c66 2e5f     name = self._
+00015e50: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
+00015e60: 7661 722d 6e75 6d65 7269 6322 202b 2074  var-numeric" + t
+00015e70: 6f6b 656e 697a 6528 6e75 6d2c 2073 706c  okenize(num, spl
+00015e80: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
+00015e90: 2020 636f 6c73 203d 206e 756d 2e5f 6d65    cols = num._me
+00015ea0: 7461 2e63 6f6c 756d 6e73 2069 6620 6973  ta.columns if is
+00015eb0: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
+00015ec0: 6e75 6d29 2065 6c73 6520 4e6f 6e65 0a0a  num) else None..
+00015ed0: 2020 2020 2020 2020 7769 7468 2063 6865          with che
+00015ee0: 636b 5f72 6564 7563 7469 6f6e 735f 7275  ck_reductions_ru
+00015ef0: 6e74 696d 655f 7761 726e 696e 6728 293a  ntime_warning():
+00015f00: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00015f10: 615f 636f 6d70 7574 6174 696f 6e20 3d20  a_computation = 
+00015f20: 6e75 6d2e 5f6d 6574 615f 6e6f 6e65 6d70  num._meta_nonemp
+00015f30: 7479 2e76 6172 2861 7869 733d 3029 0a20  ty.var(axis=0). 
+00015f40: 2020 2020 2020 2076 6172 5f73 6861 7065         var_shape
+00015f50: 203d 206d 6574 615f 636f 6d70 7574 6174   = meta_computat
+00015f60: 696f 6e2e 7368 6170 650a 2020 2020 2020  ion.shape.      
+00015f70: 2020 6172 7261 795f 7661 725f 6e61 6d65    array_var_name
+00015f80: 203d 2028 6172 7261 795f 7661 722e 5f6e   = (array_var._n
+00015f90: 616d 652c 2920 2b20 2830 2c29 202a 206c  ame,) + (0,) * l
+00015fa0: 656e 2876 6172 5f73 6861 7065 290a 0a20  en(var_shape).. 
+00015fb0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
+00015fc0: 286e 616d 652c 2030 293a 2028 6d65 7468  (name, 0): (meth
+00015fd0: 6f64 732e 7772 6170 5f76 6172 5f72 6564  ods.wrap_var_red
+00015fe0: 7563 7469 6f6e 2c20 6172 7261 795f 7661  uction, array_va
+00015ff0: 725f 6e61 6d65 2c20 636f 6c73 297d 0a20  r_name, cols)}. 
+00016000: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
+00016010: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+00016020: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
+00016030: 616d 652c 206c 6179 6572 2c20 6465 7065  ame, layer, depe
+00016040: 6e64 656e 6369 6573 3d5b 6172 7261 795f  ndencies=[array_
+00016050: 7661 725d 290a 0a20 2020 2020 2020 2072  var])..        r
+00016060: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
+00016070: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
+00016080: 206d 6574 615f 636f 6d70 7574 6174 696f   meta_computatio
+00016090: 6e2c 2064 6976 6973 696f 6e73 3d5b 4e6f  n, divisions=[No
+000160a0: 6e65 2c20 4e6f 6e65 5d29 0a0a 2020 2020  ne, None])..    
+000160b0: 6465 6620 5f76 6172 5f31 6428 7365 6c66  def _var_1d(self
+000160c0: 2c20 636f 6c75 6d6e 2c20 736b 6970 6e61  , column, skipna
+000160d0: 3d54 7275 652c 2064 646f 663d 312c 2073  =True, ddof=1, s
+000160e0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+000160f0: 293a 0a20 2020 2020 2020 2069 735f 7469  ):.        is_ti
+00016100: 6d65 6465 6c74 6120 3d20 6973 5f74 696d  medelta = is_tim
+00016110: 6564 656c 7461 3634 5f64 7479 7065 2863  edelta64_dtype(c
+00016120: 6f6c 756d 6e2e 5f6d 6574 6129 0a0a 2020  olumn._meta)..  
+00016130: 2020 2020 2020 6966 2069 735f 7469 6d65        if is_time
+00016140: 6465 6c74 613a 0a20 2020 2020 2020 2020  delta:.         
+00016150: 2020 2069 6620 6e6f 7420 736b 6970 6e61     if not skipna
+00016160: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016170: 2020 6973 5f6e 616e 203d 2063 6f6c 756d    is_nan = colum
+00016180: 6e2e 6973 6e61 2829 0a20 2020 2020 2020  n.isna().       
+00016190: 2020 2020 2020 2020 2063 6f6c 756d 6e20           column 
+000161a0: 3d20 636f 6c75 6d6e 2e61 7374 7970 6528  = column.astype(
+000161b0: 2269 3822 290a 2020 2020 2020 2020 2020  "i8").          
+000161c0: 2020 2020 2020 636f 6c75 6d6e 203d 2063        column = c
+000161d0: 6f6c 756d 6e2e 6d61 736b 2869 735f 6e61  olumn.mask(is_na
+000161e0: 6e29 0a20 2020 2020 2020 2020 2020 2065  n).            e
+000161f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00016200: 2020 2020 2063 6f6c 756d 6e20 3d20 636f       column = co
+00016210: 6c75 6d6e 2e64 726f 706e 6128 292e 6173  lumn.dropna().as
+00016220: 7479 7065 2822 6938 2229 0a0a 2020 2020  type("i8")..    
+00016230: 2020 2020 6966 2070 642e 496e 7436 3444      if pd.Int64D
+00016240: 7479 7065 2e69 735f 6474 7970 6528 636f  type.is_dtype(co
+00016250: 6c75 6d6e 2e5f 6d65 7461 5f6e 6f6e 656d  lumn._meta_nonem
+00016260: 7074 7929 3a0a 2020 2020 2020 2020 2020  pty):.          
+00016270: 2020 636f 6c75 6d6e 203d 2063 6f6c 756d    column = colum
+00016280: 6e2e 6173 7479 7065 2822 6638 2229 0a0a  n.astype("f8")..
+00016290: 2020 2020 2020 2020 6966 206e 6f74 206e          if not n
+000162a0: 702e 6973 7375 6264 7479 7065 2863 6f6c  p.issubdtype(col
+000162b0: 756d 6e2e 6474 7970 652c 206e 702e 6e75  umn.dtype, np.nu
+000162c0: 6d62 6572 293a 0a20 2020 2020 2020 2020  mber):.         
+000162d0: 2020 2063 6f6c 756d 6e20 3d20 636f 6c75     column = colu
+000162e0: 6d6e 2e61 7374 7970 6528 2266 3822 290a  mn.astype("f8").
+000162f0: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
+00016300: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
+00016310: 6978 202b 2022 7661 722d 3164 2d22 202b  ix + "var-1d-" +
+00016320: 2074 6f6b 656e 697a 6528 636f 6c75 6d6e   tokenize(column
+00016330: 2c20 7370 6c69 745f 6576 6572 7929 0a0a  , split_every)..
+00016340: 2020 2020 2020 2020 7661 7220 3d20 6461          var = da
+00016350: 2e6e 616e 7661 7220 6966 2073 6b69 706e  .nanvar if skipn
+00016360: 6120 6f72 2073 6b69 706e 6120 6973 204e  a or skipna is N
+00016370: 6f6e 6520 656c 7365 2064 612e 7661 720a  one else da.var.
+00016380: 2020 2020 2020 2020 6172 7261 795f 7661          array_va
+00016390: 7220 3d20 7661 7228 636f 6c75 6d6e 2e76  r = var(column.v
+000163a0: 616c 7565 732c 2061 7869 733d 302c 2064  alues, axis=0, d
+000163b0: 646f 663d 6464 6f66 2c20 7370 6c69 745f  dof=ddof, split_
+000163c0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+000163d0: 7929 0a0a 2020 2020 2020 2020 6c61 7965  y)..        laye
+000163e0: 7220 3d20 7b28 6e61 6d65 2c20 3029 3a20  r = {(name, 0): 
+000163f0: 286d 6574 686f 6473 2e77 7261 705f 7661  (methods.wrap_va
+00016400: 725f 7265 6475 6374 696f 6e2c 2028 6172  r_reduction, (ar
+00016410: 7261 795f 7661 722e 5f6e 616d 652c 292c  ray_var._name,),
+00016420: 204e 6f6e 6529 7d0a 2020 2020 2020 2020   None)}.        
+00016430: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
+00016440: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
+00016450: 6563 7469 6f6e 7328 6e61 6d65 2c20 6c61  ections(name, la
+00016460: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
+00016470: 733d 5b61 7272 6179 5f76 6172 5d29 0a0a  s=[array_var])..
+00016480: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00016490: 6577 5f64 645f 6f62 6a65 6374 280a 2020  ew_dd_object(.  
+000164a0: 2020 2020 2020 2020 2020 6772 6170 682c            graph,
+000164b0: 206e 616d 652c 2063 6f6c 756d 6e2e 5f6d   name, column._m
+000164c0: 6574 615f 6e6f 6e65 6d70 7479 2e76 6172  eta_nonempty.var
+000164d0: 2829 2c20 6469 7669 7369 6f6e 733d 5b4e  (), divisions=[N
+000164e0: 6f6e 652c 204e 6f6e 655d 0a20 2020 2020  one, None].     
+000164f0: 2020 2029 0a0a 2020 2020 405f 6e75 6d65     )..    @_nume
+00016500: 7269 635f 6461 7461 0a20 2020 2040 6465  ric_data.    @de
+00016510: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+00016520: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+00016530: 2073 7464 280a 2020 2020 2020 2020 7365   std(.        se
+00016540: 6c66 2c0a 2020 2020 2020 2020 6178 6973  lf,.        axis
+00016550: 3d4e 6f6e 652c 0a20 2020 2020 2020 2073  =None,.        s
+00016560: 6b69 706e 613d 5472 7565 2c0a 2020 2020  kipna=True,.    
+00016570: 2020 2020 6464 6f66 3d31 2c0a 2020 2020      ddof=1,.    
+00016580: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+00016590: 4661 6c73 652c 0a20 2020 2020 2020 2064  False,.        d
+000165a0: 7479 7065 3d4e 6f6e 652c 0a20 2020 2020  type=None,.     
+000165b0: 2020 206f 7574 3d4e 6f6e 652c 0a20 2020     out=None,.   
+000165c0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+000165d0: 793d 6e6f 5f64 6566 6175 6c74 2c0a 2020  y=no_default,.  
+000165e0: 2020 293a 0a20 2020 2020 2020 2061 7869    ):.        axi
+000165f0: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
+00016600: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
+00016610: 2020 2020 2020 5f72 6169 7365 5f69 665f        _raise_if_
+00016620: 6f62 6a65 6374 5f73 6572 6965 7328 7365  object_series(se
+00016630: 6c66 2c20 2273 7464 2229 0a20 2020 2020  lf, "std").     
+00016640: 2020 205f 7261 6973 655f 6966 5f6e 6f74     _raise_if_not
+00016650: 5f73 6572 6965 735f 6f72 5f64 6174 6166  _series_or_dataf
+00016660: 7261 6d65 2873 656c 662c 2022 7374 6422  rame(self, "std"
+00016670: 290a 2020 2020 2020 2020 6e75 6d65 7269  ).        numeri
+00016680: 635f 6b77 6172 6773 203d 205f 6e75 6d65  c_kwargs = _nume
+00016690: 7269 635f 6f6e 6c79 5f6d 6179 6265 5f77  ric_only_maybe_w
+000166a0: 6172 6e28 7365 6c66 2c20 6e75 6d65 7269  arn(self, numeri
+000166b0: 635f 6f6e 6c79 290a 0a20 2020 2020 2020  c_only)..       
+000166c0: 2077 6974 6820 6368 6563 6b5f 6e75 6d65   with check_nume
+000166d0: 7269 635f 6f6e 6c79 5f64 6570 7265 6361  ric_only_depreca
+000166e0: 7469 6f6e 2829 2c20 6368 6563 6b5f 6e75  tion(), check_nu
+000166f0: 6973 616e 6365 5f63 6f6c 756d 6e73 5f77  isance_columns_w
+00016700: 6172 6e69 6e67 2829 2c20 6368 6563 6b5f  arning(), check_
+00016710: 7265 6475 6374 696f 6e73 5f72 756e 7469  reductions_runti
+00016720: 6d65 5f77 6172 6e69 6e67 2829 3a0a 2020  me_warning():.  
+00016730: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
+00016740: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
+00016750: 6d70 7479 2e73 7464 2861 7869 733d 6178  mpty.std(axis=ax
+00016760: 6973 2c20 736b 6970 6e61 3d73 6b69 706e  is, skipna=skipn
+00016770: 612c 202a 2a6e 756d 6572 6963 5f6b 7761  a, **numeric_kwa
+00016780: 7267 7329 0a20 2020 2020 2020 2069 735f  rgs).        is_
+00016790: 6466 5f6c 696b 6520 3d20 6973 5f64 6174  df_like = is_dat
+000167a0: 6166 7261 6d65 5f6c 696b 6528 7365 6c66  aframe_like(self
+000167b0: 2e5f 6d65 7461 290a 2020 2020 2020 2020  ._meta).        
+000167c0: 6e65 6564 735f 7469 6d65 5f63 6f6e 7665  needs_time_conve
+000167d0: 7273 696f 6e20 3d20 4661 6c73 650a 2020  rsion = False.  
+000167e0: 2020 2020 2020 6e75 6d65 7269 635f 6464        numeric_dd
+000167f0: 203d 2073 656c 660a 0a20 2020 2020 2020   = self..       
+00016800: 2069 6620 6973 5f64 665f 6c69 6b65 3a0a   if is_df_like:.
+00016810: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+00016820: 5f63 6f6c 7320 3d20 7365 6c66 2e5f 6d65  _cols = self._me
+00016830: 7461 2e73 656c 6563 745f 6474 7970 6573  ta.select_dtypes
+00016840: 2869 6e63 6c75 6465 3d22 6461 7465 7469  (include="dateti
+00016850: 6d65 2229 2e63 6f6c 756d 6e73 0a20 2020  me").columns.   
+00016860: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00016870: 7469 6d65 5f63 6f6c 7329 203e 2030 3a0a  time_cols) > 0:.
+00016880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016890: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000168a0: 2020 2020 2020 6e75 6d65 7269 635f 6464        numeric_dd
+000168b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000168c0: 2020 2020 2020 6e65 6564 735f 7469 6d65        needs_time
+000168d0: 5f63 6f6e 7665 7273 696f 6e2c 0a20 2020  _conversion,.   
+000168e0: 2020 2020 2020 2020 2020 2020 2029 203d               ) =
+000168f0: 2073 656c 662e 5f63 6f6e 7665 7274 5f74   self._convert_t
+00016900: 696d 655f 636f 6c73 5f74 6f5f 6e75 6d65  ime_cols_to_nume
+00016910: 7269 6328 7469 6d65 5f63 6f6c 732c 2061  ric(time_cols, a
+00016920: 7869 732c 206d 6574 612c 2073 6b69 706e  xis, meta, skipn
+00016930: 6129 0a20 2020 2020 2020 2065 6c73 653a  a).        else:
+00016940: 0a20 2020 2020 2020 2020 2020 206e 6565  .            nee
+00016950: 6473 5f74 696d 655f 636f 6e76 6572 7369  ds_time_conversi
+00016960: 6f6e 203d 2069 735f 6461 7465 7469 6d65  on = is_datetime
+00016970: 3634 5f61 6e79 5f64 7479 7065 2873 656c  64_any_dtype(sel
+00016980: 662e 5f6d 6574 6129 0a20 2020 2020 2020  f._meta).       
+00016990: 2020 2020 2069 6620 6e65 6564 735f 7469       if needs_ti
+000169a0: 6d65 5f63 6f6e 7665 7273 696f 6e3a 0a20  me_conversion:. 
+000169b0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+000169c0: 756d 6572 6963 5f64 6420 3d20 5f63 6f6e  umeric_dd = _con
+000169d0: 7665 7274 5f74 6f5f 6e75 6d65 7269 6328  vert_to_numeric(
+000169e0: 7365 6c66 2c20 736b 6970 6e61 290a 0a20  self, skipna).. 
+000169f0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+00016a00: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00016a10: 2072 6573 756c 7420 3d20 6d61 705f 7061   result = map_pa
+00016a20: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00016a30: 2020 2020 2020 2020 2020 4d2e 7374 6420            M.std 
+00016a40: 6966 206e 6f74 206e 6565 6473 5f74 696d  if not needs_tim
+00016a50: 655f 636f 6e76 6572 7369 6f6e 2065 6c73  e_conversion els
+00016a60: 6520 5f73 7172 745f 616e 645f 636f 6e76  e _sqrt_and_conv
+00016a70: 6572 745f 746f 5f74 696d 6564 656c 7461  ert_to_timedelta
+00016a80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00016a90: 2020 6e75 6d65 7269 635f 6464 2c0a 2020    numeric_dd,.  
+00016aa0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00016ab0: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
+00016ac0: 2020 2020 2020 2020 2074 6f6b 656e 3d73           token=s
+00016ad0: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
+00016ae0: 7820 2b20 2273 7464 222c 0a20 2020 2020  x + "std",.     
+00016af0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+00016b00: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+00016b10: 2020 2020 2020 736b 6970 6e61 3d73 6b69        skipna=ski
+00016b20: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
+00016b30: 2020 2020 2064 646f 663d 6464 6f66 2c0a       ddof=ddof,.
+00016b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b50: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00016b60: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00016b70: 2020 2020 2020 2020 2a2a 6e75 6d65 7269          **numeri
+00016b80: 635f 6b77 6172 6773 2c0a 2020 2020 2020  c_kwargs,.      
+00016b90: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
+00016ba0: 5f6d 6574 613d 7365 6c66 2e5f 6d65 7461  _meta=self._meta
+00016bb0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00016bc0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00016bd0: 726e 2068 616e 646c 655f 6f75 7428 6f75  rn handle_out(ou
+00016be0: 742c 2072 6573 756c 7429 0a0a 2020 2020  t, result)..    
+00016bf0: 2020 2020 2320 4361 7365 2077 6865 7265      # Case where
+00016c00: 2061 7869 733d 3020 6f72 2061 7869 733d   axis=0 or axis=
+00016c10: 4e6f 6e65 0a20 2020 2020 2020 2076 203d  None.        v =
+00016c20: 206e 756d 6572 6963 5f64 642e 7661 7228   numeric_dd.var(
+00016c30: 736b 6970 6e61 3d73 6b69 706e 612c 2064  skipna=skipna, d
+00016c40: 646f 663d 6464 6f66 2c20 7370 6c69 745f  dof=ddof, split_
+00016c50: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00016c60: 7929 0a20 2020 2020 2020 206e 616d 6520  y).        name 
+00016c70: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
+00016c80: 6566 6978 202b 2022 7374 6422 0a0a 2020  efix + "std"..  
+00016c90: 2020 2020 2020 6966 206e 6565 6473 5f74        if needs_t
+00016ca0: 696d 655f 636f 6e76 6572 7369 6f6e 3a0a  ime_conversion:.
+00016cb0: 2020 2020 2020 2020 2020 2020 7371 7274              sqrt
+00016cc0: 5f66 756e 635f 6b77 6172 6773 203d 207b  _func_kwargs = {
+00016cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016ce0: 2022 6973 5f64 665f 6c69 6b65 223a 2069   "is_df_like": i
+00016cf0: 735f 6466 5f6c 696b 652c 0a20 2020 2020  s_df_like,.     
+00016d00: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
+00016d10: 5f63 6f6c 7322 3a20 7469 6d65 5f63 6f6c  _cols": time_col
+00016d20: 7320 6966 2069 735f 6466 5f6c 696b 6520  s if is_df_like 
+00016d30: 656c 7365 204e 6f6e 652c 0a20 2020 2020  else None,.     
+00016d40: 2020 2020 2020 2020 2020 2022 6178 6973             "axis
+00016d50: 223a 2061 7869 732c 0a20 2020 2020 2020  ": axis,.       
+00016d60: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
+00016d70: 2020 2073 7172 745f 6675 6e63 203d 205f     sqrt_func = _
+00016d80: 7371 7274 5f61 6e64 5f63 6f6e 7665 7274  sqrt_and_convert
+00016d90: 5f74 6f5f 7469 6d65 6465 6c74 610a 2020  _to_timedelta.  
+00016da0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00016db0: 2020 2020 2020 2020 7371 7274 5f66 756e          sqrt_fun
+00016dc0: 635f 6b77 6172 6773 203d 207b 7d0a 2020  c_kwargs = {}.  
+00016dd0: 2020 2020 2020 2020 2020 7371 7274 5f66            sqrt_f
+00016de0: 756e 6320 3d20 6e70 2e73 7172 740a 0a20  unc = np.sqrt.. 
+00016df0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00016e00: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+00016e10: 2020 2020 2020 2020 2020 2020 7371 7274              sqrt
+00016e20: 5f66 756e 632c 0a20 2020 2020 2020 2020  _func,.         
+00016e30: 2020 2076 2c0a 2020 2020 2020 2020 2020     v,.          
+00016e40: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
+00016e50: 2020 2020 2020 2020 2074 6f6b 656e 3d6e           token=n
+00016e60: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00016e70: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+00016e80: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
+00016e90: 2020 2020 2070 6172 656e 745f 6d65 7461       parent_meta
+00016ea0: 3d73 656c 662e 5f6d 6574 612c 0a20 2020  =self._meta,.   
+00016eb0: 2020 2020 2020 2020 202a 2a73 7172 745f           **sqrt_
+00016ec0: 6675 6e63 5f6b 7761 7267 732c 0a20 2020  func_kwargs,.   
+00016ed0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00016ee0: 2320 5472 7920 746f 206d 6174 6368 2074  # Try to match t
+00016ef0: 6865 2050 616e 6461 7320 7265 7375 6c74  he Pandas result
+00016f00: 2064 7479 7065 0a20 2020 2020 2020 2069   dtype.        i
+00016f10: 6620 6973 5f64 665f 6c69 6b65 2061 6e64  f is_df_like and
+00016f20: 2068 6173 6174 7472 286d 6574 612c 2022   hasattr(meta, "
+00016f30: 6474 7970 6522 293a 0a20 2020 2020 2020  dtype"):.       
+00016f40: 2020 2020 2072 6573 756c 7420 3d20 7265       result = re
+00016f50: 7375 6c74 2e61 7374 7970 6528 6d65 7461  sult.astype(meta
+00016f60: 2e64 7479 7065 290a 0a20 2020 2020 2020  .dtype)..       
+00016f70: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+00016f80: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+00016f90: 0a20 2020 2064 6566 205f 636f 6e76 6572  .    def _conver
+00016fa0: 745f 7469 6d65 5f63 6f6c 735f 746f 5f6e  t_time_cols_to_n
+00016fb0: 756d 6572 6963 2873 656c 662c 2074 696d  umeric(self, tim
+00016fc0: 655f 636f 6c73 2c20 6178 6973 2c20 6d65  e_cols, axis, me
+00016fd0: 7461 2c20 736b 6970 6e61 293a 0a20 2020  ta, skipna):.   
+00016fe0: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
+00016ff0: 6174 6166 7261 6d65 2e69 6f20 696d 706f  ataframe.io impo
+00017000: 7274 2066 726f 6d5f 7061 6e64 6173 0a0a  rt from_pandas..
+00017010: 2020 2020 2020 2020 6e65 6564 735f 7469          needs_ti
+00017020: 6d65 5f63 6f6e 7665 7273 696f 6e20 3d20  me_conversion = 
+00017030: 5472 7565 0a0a 2020 2020 2020 2020 2320  True..        # 
+00017040: 456e 7375 7265 2061 6c6c 2063 6f6c 756d  Ensure all colum
+00017050: 6e73 2061 7265 2063 6f72 7265 6374 2074  ns are correct t
+00017060: 7970 652e 204e 6565 6420 746f 2073 6861  ype. Need to sha
+00017070: 6c6c 6f77 2063 6f70 7920 7369 6e63 6520  llow copy since 
+00017080: 636f 6c73 2077 696c 6c20 6265 206d 6f64  cols will be mod
+00017090: 6966 6965 640a 2020 2020 2020 2020 6966  ified.        if
+000170a0: 2061 7869 7320 3d3d 2030 3a0a 2020 2020   axis == 0:.    
+000170b0: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+000170c0: 6464 203d 2073 656c 665b 6d65 7461 2e69  dd = self[meta.i
+000170d0: 6e64 6578 5d2e 636f 7079 2829 0a20 2020  ndex].copy().   
+000170e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000170f0: 2020 2020 2020 206e 756d 6572 6963 5f64         numeric_d
+00017100: 6420 3d20 7365 6c66 2e63 6f70 7928 290a  d = self.copy().
+00017110: 0a20 2020 2020 2020 2023 204d 6978 206f  .        # Mix o
+00017120: 6620 6461 7465 7469 6d65 7320 7769 7468  f datetimes with
+00017130: 206f 7468 6572 206e 756d 6572 6963 2074   other numeric t
+00017140: 7970 6573 2070 726f 6475 6365 7320 4e61  ypes produces Na
+00017150: 4e73 2066 6f72 2065 6163 6820 7661 6c75  Ns for each valu
+00017160: 6520 696e 2073 7464 2829 2073 6572 6965  e in std() serie
+00017170: 730a 2020 2020 2020 2020 6966 2061 7869  s.        if axi
+00017180: 7320 3d3d 2031 2061 6e64 206c 656e 2874  s == 1 and len(t
+00017190: 696d 655f 636f 6c73 2920 213d 206c 656e  ime_cols) != len
+000171a0: 2873 656c 662e 636f 6c75 6d6e 7329 3a0a  (self.columns):.
+000171b0: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
+000171c0: 6973 2069 7320 6661 7374 6572 2074 6861  is is faster tha
+000171d0: 6e20 636f 6e76 6572 7469 6e67 2065 6163  n converting eac
+000171e0: 6820 636f 6c75 6d6e 2074 6f20 6e75 6d65  h column to nume
+000171f0: 7269 6320 7768 656e 2069 7427 7320 6e6f  ric when it's no
+00017200: 7420 6e65 6365 7373 6172 790a 2020 2020  t necessary.    
+00017210: 2020 2020 2020 2020 2320 7369 6e63 6520          # since 
+00017220: 6561 6368 2073 7461 6e64 6172 6420 6465  each standard de
+00017230: 7669 6174 696f 6e20 7769 6c6c 206a 7573  viation will jus
+00017240: 7420 6265 204e 614e 0a20 2020 2020 2020  t be NaN.       
+00017250: 2020 2020 206e 6565 6473 5f74 696d 655f       needs_time_
+00017260: 636f 6e76 6572 7369 6f6e 203d 2046 616c  conversion = Fal
+00017270: 7365 0a20 2020 2020 2020 2020 2020 206e  se.            n
+00017280: 756d 6572 6963 5f64 6420 3d20 6672 6f6d  umeric_dd = from
+00017290: 5f70 616e 6461 7328 0a20 2020 2020 2020  _pandas(.       
+000172a0: 2020 2020 2020 2020 206d 6574 615f 6672           meta_fr
+000172b0: 616d 655f 636f 6e73 7472 7563 746f 7228  ame_constructor(
+000172c0: 7365 6c66 2928 0a20 2020 2020 2020 2020  self)(.         
+000172d0: 2020 2020 2020 2020 2020 207b 225f 223a             {"_":
+000172e0: 206d 6574 615f 7365 7269 6573 5f63 6f6e   meta_series_con
+000172f0: 7374 7275 6374 6f72 2873 656c 6629 285b  structor(self)([
+00017300: 6e70 2e6e 616e 5d29 7d2c 0a20 2020 2020  np.nan])},.     
+00017310: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00017320: 6e64 6578 3d73 656c 662e 696e 6465 782c  ndex=self.index,
+00017330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017340: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+00017350: 2020 2020 6e70 6172 7469 7469 6f6e 733d      npartitions=
+00017360: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
+00017370: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00017380: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00017390: 2020 2020 2020 2020 2020 2320 436f 6e76            # Conv
+000173a0: 6572 7420 7469 6d65 6465 6c74 6120 616e  ert timedelta an
+000173b0: 6420 6461 7465 7469 6d65 2063 6f6c 756d  d datetime colum
+000173c0: 6e73 2074 6f20 696e 7465 6765 7220 7479  ns to integer ty
+000173d0: 7065 7320 736f 2077 6520 6361 6e20 7573  pes so we can us
+000173e0: 6520 7661 720a 2020 2020 2020 2020 2020  e var.          
+000173f0: 2020 666f 7220 636f 6c20 696e 2074 696d    for col in tim
+00017400: 655f 636f 6c73 3a0a 2020 2020 2020 2020  e_cols:.        
+00017410: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+00017420: 6464 5b63 6f6c 5d20 3d20 5f63 6f6e 7665  dd[col] = _conve
+00017430: 7274 5f74 6f5f 6e75 6d65 7269 6328 6e75  rt_to_numeric(nu
+00017440: 6d65 7269 635f 6464 5b63 6f6c 5d2c 2073  meric_dd[col], s
+00017450: 6b69 706e 6129 0a0a 2020 2020 2020 2020  kipna)..        
+00017460: 7265 7475 726e 206e 756d 6572 6963 5f64  return numeric_d
+00017470: 642c 206e 6565 6473 5f74 696d 655f 636f  d, needs_time_co
+00017480: 6e76 6572 7369 6f6e 0a0a 2020 2020 405f  nversion..    @_
+00017490: 6e75 6d65 7269 635f 6f6e 6c79 0a20 2020  numeric_only.   
+000174a0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+000174b0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+000174c0: 2064 6566 2073 6b65 7728 0a20 2020 2020   def skew(.     
+000174d0: 2020 2073 656c 662c 2061 7869 733d 302c     self, axis=0,
+000174e0: 2062 6961 733d 5472 7565 2c20 6e61 6e5f   bias=True, nan_
+000174f0: 706f 6c69 6379 3d22 7072 6f70 6167 6174  policy="propagat
+00017500: 6522 2c20 6f75 743d 4e6f 6e65 2c20 6e75  e", out=None, nu
+00017510: 6d65 7269 635f 6f6e 6c79 3d4e 6f6e 650a  meric_only=None.
+00017520: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+00017530: 2222 0a20 2020 2020 2020 202e 2e20 6e6f  "".        .. no
+00017540: 7465 3a3a 0a0a 2020 2020 2020 2020 2020  te::..          
+00017550: 2054 6869 7320 696d 706c 656d 656e 7461   This implementa
+00017560: 7469 6f6e 2066 6f6c 6c6f 7773 2074 6865  tion follows the
+00017570: 2064 6173 6b2e 6172 7261 792e 7374 6174   dask.array.stat
+00017580: 7320 696d 706c 656d 656e 7461 7469 6f6e  s implementation
+00017590: 0a20 2020 2020 2020 2020 2020 6f66 2073  .           of s
+000175a0: 6b65 776e 6573 7320 616e 6420 6361 6c63  kewness and calc
+000175b0: 756c 6174 6573 2073 6b65 776e 6573 7320  ulates skewness 
+000175c0: 7769 7468 6f75 7420 7461 6b69 6e67 2069  without taking i
+000175d0: 6e74 6f20 6163 636f 756e 740a 2020 2020  nto account.    
+000175e0: 2020 2020 2020 2061 2062 6961 7320 7465         a bias te
+000175f0: 726d 2066 6f72 2066 696e 6974 6520 7361  rm for finite sa
+00017600: 6d70 6c65 2073 697a 652c 2077 6869 6368  mple size, which
+00017610: 2063 6f72 7265 7370 6f6e 6473 2074 6f20   corresponds to 
+00017620: 7468 650a 2020 2020 2020 2020 2020 2064  the.           d
+00017630: 6566 6175 6c74 2073 6574 7469 6e67 7320  efault settings 
+00017640: 6f66 2074 6865 2073 6369 7079 2e73 7461  of the scipy.sta
+00017650: 7473 2073 6b65 776e 6573 7320 6361 6c63  ts skewness calc
+00017660: 756c 6174 696f 6e2e 2048 6f77 6576 6572  ulation. However
+00017670: 2c0a 2020 2020 2020 2020 2020 2050 616e  ,.           Pan
+00017680: 6461 7320 636f 7272 6563 7473 2066 6f72  das corrects for
+00017690: 2074 6869 732c 2073 6f20 7468 6520 7661   this, so the va
+000176a0: 6c75 6573 2064 6966 6665 7220 6279 2061  lues differ by a
+000176b0: 2066 6163 746f 7220 6f66 0a20 2020 2020   factor of.     
+000176c0: 2020 2020 2020 286e 202a 2028 6e20 2d20        (n * (n - 
+000176d0: 3129 2920 2a2a 2030 2e35 202f 2028 6e20  1)) ** 0.5 / (n 
+000176e0: 2d20 3229 2c20 7768 6572 6520 6e20 6973  - 2), where n is
+000176f0: 2074 6865 206e 756d 6265 7220 6f66 2073   the number of s
+00017700: 616d 706c 6573 2e0a 0a20 2020 2020 2020  amples...       
+00017710: 2020 2020 4675 7274 6865 722c 2074 6869      Further, thi
+00017720: 7320 6d65 7468 6f64 2063 7572 7265 6e74  s method current
+00017730: 6c79 2064 6f65 7320 6e6f 7420 7375 7070  ly does not supp
+00017740: 6f72 7420 6669 6c74 6572 696e 6720 6f75  ort filtering ou
+00017750: 7420 4e61 4e0a 2020 2020 2020 2020 2020  t NaN.          
+00017760: 2076 616c 7565 732c 2077 6869 6368 2069   values, which i
+00017770: 7320 6167 6169 6e20 6120 6469 6666 6572  s again a differ
+00017780: 656e 6365 2074 6f20 5061 6e64 6173 2e0a  ence to Pandas..
+00017790: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000177a0: 2020 2020 6966 2050 414e 4441 535f 4754      if PANDAS_GT
+000177b0: 5f32 3030 2061 6e64 2061 7869 7320 6973  _200 and axis is
+000177c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000177d0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000177e0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+000177f0: 2020 2020 2022 6061 7869 733d 4e6f 6e65       "`axis=None
+00017800: 6020 6973 6e27 7420 6375 7272 656e 746c  ` isn't currentl
+00017810: 7920 7375 7070 6f72 7465 6420 666f 7220  y supported for 
+00017820: 6073 6b65 7760 2077 6865 6e20 7573 696e  `skew` when usin
+00017830: 6720 6070 616e 6461 7320 3e3d 3260 2022  g `pandas >=2` "
+00017840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017850: 2066 2228 7061 6e64 6173 3d7b 7374 7228   f"(pandas={str(
+00017860: 5041 4e44 4153 5f56 4552 5349 4f4e 297d  PANDAS_VERSION)}
+00017870: 2069 7320 696e 7374 616c 6c65 6429 2e22   is installed)."
+00017880: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00017890: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
+000178a0: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
+000178b0: 7328 6178 6973 290a 2020 2020 2020 2020  s(axis).        
+000178c0: 5f72 6169 7365 5f69 665f 6f62 6a65 6374  _raise_if_object
+000178d0: 5f73 6572 6965 7328 7365 6c66 2c20 2273  _series(self, "s
+000178e0: 6b65 7722 290a 2020 2020 2020 2020 6d65  kew").        me
+000178f0: 7461 203d 2073 656c 662e 5f6d 6574 615f  ta = self._meta_
+00017900: 6e6f 6e65 6d70 7479 2e73 6b65 7728 290a  nonempty.skew().
+00017910: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
+00017920: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+00017930: 2020 7265 7375 6c74 203d 206d 6170 5f70    result = map_p
+00017940: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+00017950: 2020 2020 2020 2020 2020 204d 2e73 6b65             M.ske
+00017960: 772c 0a20 2020 2020 2020 2020 2020 2020  w,.             
+00017970: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00017980: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
+00017990: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+000179a0: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
+000179b0: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
+000179c0: 736b 6577 222c 0a20 2020 2020 2020 2020  skew",.         
+000179d0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+000179e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000179f0: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
+00017a00: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
+00017a10: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00017a20: 2020 2020 7265 7475 726e 2068 616e 646c      return handl
+00017a30: 655f 6f75 7428 6f75 742c 2072 6573 756c  e_out(out, resul
+00017a40: 7429 0a20 2020 2020 2020 2065 6c73 653a  t).        else:
+00017a50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00017a60: 7365 6c66 2e6e 6469 6d20 3d3d 2031 3a0a  self.ndim == 1:.
+00017a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017a80: 7265 7375 6c74 203d 2073 656c 662e 5f73  result = self._s
+00017a90: 6b65 775f 3164 2873 656c 662c 2062 6961  kew_1d(self, bia
+00017aa0: 733d 6269 6173 2c20 6e61 6e5f 706f 6c69  s=bias, nan_poli
+00017ab0: 6379 3d6e 616e 5f70 6f6c 6963 7929 0a20  cy=nan_policy). 
+00017ac0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00017ad0: 6574 7572 6e20 6861 6e64 6c65 5f6f 7574  eturn handle_out
+00017ae0: 286f 7574 2c20 7265 7375 6c74 290a 2020  (out, result).  
+00017af0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00017b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b10: 7265 7375 6c74 203d 2073 656c 662e 5f73  result = self._s
+00017b20: 6b65 775f 6e75 6d65 7269 6328 6269 6173  kew_numeric(bias
+00017b30: 3d62 6961 732c 206e 616e 5f70 6f6c 6963  =bias, nan_polic
+00017b40: 793d 6e61 6e5f 706f 6c69 6379 290a 0a20  y=nan_policy).. 
+00017b50: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00017b60: 696e 7374 616e 6365 2873 656c 662c 2044  instance(self, D
+00017b70: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
+00017b80: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00017b90: 742e 6469 7669 7369 6f6e 7320 3d20 2873  t.divisions = (s
+00017ba0: 656c 662e 636f 6c75 6d6e 732e 6d69 6e28  elf.columns.min(
+00017bb0: 292c 2073 656c 662e 636f 6c75 6d6e 732e  ), self.columns.
+00017bc0: 6d61 7828 2929 0a0a 2020 2020 2020 2020  max())..        
+00017bd0: 2020 2020 7265 7475 726e 2068 616e 646c      return handl
+00017be0: 655f 6f75 7428 6f75 742c 2072 6573 756c  e_out(out, resul
+00017bf0: 7429 0a0a 2020 2020 6465 6620 5f73 6b65  t)..    def _ske
+00017c00: 775f 3164 2873 656c 662c 2063 6f6c 756d  w_1d(self, colum
+00017c10: 6e2c 2062 6961 733d 5472 7565 2c20 6e61  n, bias=True, na
+00017c20: 6e5f 706f 6c69 6379 3d22 7072 6f70 6167  n_policy="propag
+00017c30: 6174 6522 293a 0a20 2020 2020 2020 2022  ate"):.        "
+00017c40: 2222 3144 2076 6572 7369 6f6e 206f 6620  ""1D version of 
+00017c50: 7468 6520 736b 6577 2063 616c 6375 6c61  the skew calcula
+00017c60: 7469 6f6e 2e0a 0a20 2020 2020 2020 2055  tion...        U
+00017c70: 7365 7320 7468 6520 6172 7261 7920 7665  ses the array ve
+00017c80: 7273 696f 6e20 6672 6f6d 2064 612e 7374  rsion from da.st
+00017c90: 6174 7320 696e 2063 6173 6520 7765 2061  ats in case we a
+00017ca0: 7265 2070 6173 7369 6e67 2069 6e20 6120  re passing in a 
+00017cb0: 7369 6e67 6c65 2073 6572 6965 730a 2020  single series.  
+00017cc0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00017cd0: 2020 2320 696d 706f 7274 2064 6570 656e    # import depen
+00017ce0: 6473 206f 6e20 7363 6970 792c 206e 6f74  ds on scipy, not
+00017cf0: 2069 6e73 7461 6c6c 6564 2062 7920 6465   installed by de
+00017d00: 6661 756c 740a 2020 2020 2020 2020 6672  fault.        fr
+00017d10: 6f6d 2064 6173 6b2e 6172 7261 7920 696d  om dask.array im
+00017d20: 706f 7274 2073 7461 7473 2061 7320 6461  port stats as da
+00017d30: 5f73 7461 7473 0a0a 2020 2020 2020 2020  _stats..        
+00017d40: 6966 2070 642e 496e 7436 3444 7479 7065  if pd.Int64Dtype
+00017d50: 2e69 735f 6474 7970 6528 636f 6c75 6d6e  .is_dtype(column
+00017d60: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 7929  ._meta_nonempty)
+00017d70: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+00017d80: 6c75 6d6e 203d 2063 6f6c 756d 6e2e 6173  lumn = column.as
+00017d90: 7479 7065 2822 6638 2229 0a0a 2020 2020  type("f8")..    
+00017da0: 2020 2020 6966 206e 6f74 206e 702e 6973      if not np.is
+00017db0: 7375 6264 7479 7065 2863 6f6c 756d 6e2e  subdtype(column.
+00017dc0: 6474 7970 652c 206e 702e 6e75 6d62 6572  dtype, np.number
+00017dd0: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
+00017de0: 6f6c 756d 6e20 3d20 636f 6c75 6d6e 2e61  olumn = column.a
+00017df0: 7374 7970 6528 2266 3822 290a 0a20 2020  stype("f8")..   
+00017e00: 2020 2020 206e 616d 6520 3d20 7365 6c66       name = self
+00017e10: 2e5f 746f 6b65 6e5f 7072 6566 6978 202b  ._token_prefix +
+00017e20: 2022 736b 6577 2d31 642d 2220 2b20 746f   "skew-1d-" + to
+00017e30: 6b65 6e69 7a65 2863 6f6c 756d 6e29 0a0a  kenize(column)..
+00017e40: 2020 2020 2020 2020 6172 7261 795f 736b          array_sk
+00017e50: 6577 203d 2064 615f 7374 6174 732e 736b  ew = da_stats.sk
+00017e60: 6577 280a 2020 2020 2020 2020 2020 2020  ew(.            
+00017e70: 636f 6c75 6d6e 2e76 616c 7565 732c 2061  column.values, a
+00017e80: 7869 733d 302c 2062 6961 733d 6269 6173  xis=0, bias=bias
+00017e90: 2c20 6e61 6e5f 706f 6c69 6379 3d6e 616e  , nan_policy=nan
+00017ea0: 5f70 6f6c 6963 790a 2020 2020 2020 2020  _policy.        
+00017eb0: 290a 0a20 2020 2020 2020 206c 6179 6572  )..        layer
+00017ec0: 203d 207b 286e 616d 652c 2030 293a 2028   = {(name, 0): (
+00017ed0: 6d65 7468 6f64 732e 7772 6170 5f73 6b65  methods.wrap_ske
+00017ee0: 775f 7265 6475 6374 696f 6e2c 2028 6172  w_reduction, (ar
+00017ef0: 7261 795f 736b 6577 2e5f 6e61 6d65 2c29  ray_skew._name,)
+00017f00: 2c20 4e6f 6e65 297d 0a20 2020 2020 2020  , None)}.       
+00017f10: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+00017f20: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+00017f30: 6c65 6374 696f 6e73 286e 616d 652c 206c  lections(name, l
+00017f40: 6179 6572 2c20 6465 7065 6e64 656e 6369  ayer, dependenci
+00017f50: 6573 3d5b 6172 7261 795f 736b 6577 5d29  es=[array_skew])
+00017f60: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00017f70: 206e 6577 5f64 645f 6f62 6a65 6374 280a   new_dd_object(.
+00017f80: 2020 2020 2020 2020 2020 2020 6772 6170              grap
+00017f90: 682c 206e 616d 652c 2063 6f6c 756d 6e2e  h, name, column.
+00017fa0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e73  _meta_nonempty.s
+00017fb0: 6b65 7728 292c 2064 6976 6973 696f 6e73  kew(), divisions
+00017fc0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d0a 2020  =[None, None].  
+00017fd0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+00017fe0: 205f 736b 6577 5f6e 756d 6572 6963 2873   _skew_numeric(s
+00017ff0: 656c 662c 2062 6961 733d 5472 7565 2c20  elf, bias=True, 
+00018000: 6e61 6e5f 706f 6c69 6379 3d22 7072 6f70  nan_policy="prop
+00018010: 6167 6174 6522 293a 0a20 2020 2020 2020  agate"):.       
+00018020: 2022 2222 4d65 7468 6f64 2066 6f72 2064   """Method for d
+00018030: 6174 6166 7261 6d65 7320 7769 7468 206e  ataframes with n
+00018040: 756d 6572 6963 2063 6f6c 756d 6e73 2e0a  umeric columns..
+00018050: 0a20 2020 2020 2020 204d 6170 7320 7468  .        Maps th
+00018060: 6520 6172 7261 7920 7665 7273 696f 6e20  e array version 
+00018070: 6672 6f6d 2064 612e 7374 6174 7320 6f6e  from da.stats on
+00018080: 746f 2074 6865 206e 756d 6572 6963 2061  to the numeric a
+00018090: 7272 6179 206f 6620 636f 6c75 6d6e 732e  rray of columns.
+000180a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000180b0: 2020 2020 2023 2069 6d70 6f72 7420 6465       # import de
+000180c0: 7065 6e64 7320 6f6e 2073 6369 7079 2c20  pends on scipy, 
+000180d0: 6e6f 7420 696e 7374 616c 6c65 6420 6279  not installed by
+000180e0: 2064 6566 6175 6c74 0a20 2020 2020 2020   default.       
+000180f0: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
+00018100: 2069 6d70 6f72 7420 7374 6174 7320 6173   import stats as
+00018110: 2064 615f 7374 6174 730a 0a20 2020 2020   da_stats..     
+00018120: 2020 206e 756d 203d 2073 656c 662e 7365     num = self.se
+00018130: 6c65 6374 5f64 7479 7065 7328 696e 636c  lect_dtypes(incl
+00018140: 7564 653d 5b22 6e75 6d62 6572 222c 2022  ude=["number", "
+00018150: 626f 6f6c 225d 2c20 6578 636c 7564 653d  bool"], exclude=
+00018160: 5b6e 702e 7469 6d65 6465 6c74 6136 345d  [np.timedelta64]
+00018170: 290a 0a20 2020 2020 2020 2076 616c 7565  )..        value
+00018180: 735f 6474 7970 6520 3d20 6e75 6d2e 7661  s_dtype = num.va
+00018190: 6c75 6573 2e64 7479 7065 0a20 2020 2020  lues.dtype.     
+000181a0: 2020 2061 7272 6179 5f76 616c 7565 7320     array_values 
+000181b0: 3d20 6e75 6d2e 7661 6c75 6573 0a0a 2020  = num.values..  
+000181c0: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
+000181d0: 6973 7375 6264 7479 7065 2876 616c 7565  issubdtype(value
+000181e0: 735f 6474 7970 652c 206e 702e 6e75 6d62  s_dtype, np.numb
+000181f0: 6572 293a 0a20 2020 2020 2020 2020 2020  er):.           
+00018200: 2061 7272 6179 5f76 616c 7565 7320 3d20   array_values = 
+00018210: 6e75 6d2e 7661 6c75 6573 2e61 7374 7970  num.values.astyp
+00018220: 6528 2266 3822 290a 0a20 2020 2020 2020  e("f8")..       
+00018230: 2061 7272 6179 5f73 6b65 7720 3d20 6461   array_skew = da
+00018240: 5f73 7461 7473 2e73 6b65 7728 0a20 2020  _stats.skew(.   
+00018250: 2020 2020 2020 2020 2061 7272 6179 5f76           array_v
+00018260: 616c 7565 732c 2061 7869 733d 302c 2062  alues, axis=0, b
+00018270: 6961 733d 6269 6173 2c20 6e61 6e5f 706f  ias=bias, nan_po
+00018280: 6c69 6379 3d6e 616e 5f70 6f6c 6963 790a  licy=nan_policy.
+00018290: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000182a0: 2020 206e 616d 6520 3d20 7365 6c66 2e5f     name = self._
+000182b0: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
+000182c0: 7661 722d 6e75 6d65 7269 6322 202b 2074  var-numeric" + t
+000182d0: 6f6b 656e 697a 6528 6e75 6d29 0a20 2020  okenize(num).   
+000182e0: 2020 2020 2063 6f6c 7320 3d20 6e75 6d2e       cols = num.
+000182f0: 5f6d 6574 612e 636f 6c75 6d6e 7320 6966  _meta.columns if
+00018300: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
+00018310: 6b65 286e 756d 2920 656c 7365 204e 6f6e  ke(num) else Non
+00018320: 650a 0a20 2020 2020 2020 2077 6974 6820  e..        with 
+00018330: 6368 6563 6b5f 7265 6475 6374 696f 6e73  check_reductions
+00018340: 5f72 756e 7469 6d65 5f77 6172 6e69 6e67  _runtime_warning
+00018350: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00018360: 736b 6577 5f73 6861 7065 203d 206e 756d  skew_shape = num
+00018370: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
+00018380: 7661 7228 6178 6973 3d30 292e 7368 6170  var(axis=0).shap
+00018390: 650a 2020 2020 2020 2020 6172 7261 795f  e.        array_
+000183a0: 736b 6577 5f6e 616d 6520 3d20 2861 7272  skew_name = (arr
+000183b0: 6179 5f73 6b65 772e 5f6e 616d 652c 2920  ay_skew._name,) 
+000183c0: 2b20 2830 2c29 202a 206c 656e 2873 6b65  + (0,) * len(ske
+000183d0: 775f 7368 6170 6529 0a0a 2020 2020 2020  w_shape)..      
+000183e0: 2020 6c61 7965 7220 3d20 7b28 6e61 6d65    layer = {(name
+000183f0: 2c20 3029 3a20 286d 6574 686f 6473 2e77  , 0): (methods.w
+00018400: 7261 705f 736b 6577 5f72 6564 7563 7469  rap_skew_reducti
+00018410: 6f6e 2c20 6172 7261 795f 736b 6577 5f6e  on, array_skew_n
+00018420: 616d 652c 2063 6f6c 7329 7d0a 2020 2020  ame, cols)}.    
+00018430: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+00018440: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+00018450: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
+00018460: 2c20 6c61 7965 722c 2064 6570 656e 6465  , layer, depende
+00018470: 6e63 6965 733d 5b61 7272 6179 5f73 6b65  ncies=[array_ske
+00018480: 775d 290a 0a20 2020 2020 2020 2072 6574  w])..        ret
+00018490: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
+000184a0: 7428 0a20 2020 2020 2020 2020 2020 2067  t(.            g
+000184b0: 7261 7068 2c20 6e61 6d65 2c20 6e75 6d2e  raph, name, num.
+000184c0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e73  _meta_nonempty.s
+000184d0: 6b65 7728 292c 2064 6976 6973 696f 6e73  kew(), divisions
+000184e0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d0a 2020  =[None, None].  
+000184f0: 2020 2020 2020 290a 0a20 2020 2040 5f6e        )..    @_n
+00018500: 756d 6572 6963 5f6f 6e6c 790a 2020 2020  umeric_only.    
+00018510: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00018520: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00018530: 6465 6620 6b75 7274 6f73 6973 280a 2020  def kurtosis(.  
+00018540: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00018550: 2020 2020 6178 6973 3d30 2c0a 2020 2020      axis=0,.    
+00018560: 2020 2020 6669 7368 6572 3d54 7275 652c      fisher=True,
+00018570: 0a20 2020 2020 2020 2062 6961 733d 5472  .        bias=Tr
+00018580: 7565 2c0a 2020 2020 2020 2020 6e61 6e5f  ue,.        nan_
+00018590: 706f 6c69 6379 3d22 7072 6f70 6167 6174  policy="propagat
+000185a0: 6522 2c0a 2020 2020 2020 2020 6f75 743d  e",.        out=
+000185b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e75  None,.        nu
+000185c0: 6d65 7269 635f 6f6e 6c79 3d4e 6f6e 652c  meric_only=None,
+000185d0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000185e0: 2222 220a 2020 2020 2020 2020 2e2e 206e  """.        .. n
+000185f0: 6f74 653a 3a0a 0a20 2020 2020 2020 2020  ote::..         
+00018600: 2020 5468 6973 2069 6d70 6c65 6d65 6e74    This implement
+00018610: 6174 696f 6e20 666f 6c6c 6f77 7320 7468  ation follows th
+00018620: 6520 6461 736b 2e61 7272 6179 2e73 7461  e dask.array.sta
+00018630: 7473 2069 6d70 6c65 6d65 6e74 6174 696f  ts implementatio
+00018640: 6e0a 2020 2020 2020 2020 2020 206f 6620  n.           of 
+00018650: 6b75 7274 6f73 6973 2061 6e64 2063 616c  kurtosis and cal
+00018660: 6375 6c61 7465 7320 6b75 7274 6f73 6973  culates kurtosis
+00018670: 2077 6974 686f 7574 2074 616b 696e 6720   without taking 
+00018680: 696e 746f 2061 6363 6f75 6e74 0a20 2020  into account.   
+00018690: 2020 2020 2020 2020 6120 6269 6173 2074          a bias t
+000186a0: 6572 6d20 666f 7220 6669 6e69 7465 2073  erm for finite s
+000186b0: 616d 706c 6520 7369 7a65 2c20 7768 6963  ample size, whic
+000186c0: 6820 636f 7272 6573 706f 6e64 7320 746f  h corresponds to
+000186d0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+000186e0: 6465 6661 756c 7420 7365 7474 696e 6773  default settings
+000186f0: 206f 6620 7468 6520 7363 6970 792e 7374   of the scipy.st
+00018700: 6174 7320 6b75 7274 6f73 6973 2063 616c  ats kurtosis cal
+00018710: 6375 6c61 7469 6f6e 2e20 5468 6973 2064  culation. This d
+00018720: 6966 6665 7273 0a20 2020 2020 2020 2020  iffers.         
+00018730: 2020 6672 6f6d 2070 616e 6461 732e 0a0a    from pandas...
+00018740: 2020 2020 2020 2020 2020 2046 7572 7468             Furth
+00018750: 6572 2c20 7468 6973 206d 6574 686f 6420  er, this method 
+00018760: 6375 7272 656e 746c 7920 646f 6573 206e  currently does n
+00018770: 6f74 2073 7570 706f 7274 2066 696c 7465  ot support filte
+00018780: 7269 6e67 206f 7574 204e 614e 0a20 2020  ring out NaN.   
+00018790: 2020 2020 2020 2020 7661 6c75 6573 2c20          values, 
+000187a0: 7768 6963 6820 6973 2061 6761 696e 2061  which is again a
+000187b0: 2064 6966 6665 7265 6e63 6520 746f 2050   difference to P
+000187c0: 616e 6461 732e 0a20 2020 2020 2020 2022  andas..        "
+000187d0: 2222 0a20 2020 2020 2020 2069 6620 5041  "".        if PA
+000187e0: 4e44 4153 5f47 545f 3230 3020 616e 6420  NDAS_GT_200 and 
+000187f0: 6178 6973 2069 7320 4e6f 6e65 3a0a 2020  axis is None:.  
+00018800: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00018810: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00018820: 2020 2020 2020 2020 2020 2020 2260 6178              "`ax
+00018830: 6973 3d4e 6f6e 6560 2069 736e 2774 2063  is=None` isn't c
+00018840: 7572 7265 6e74 6c79 2073 7570 706f 7274  urrently support
+00018850: 6564 2066 6f72 2060 6b75 7274 6f73 6973  ed for `kurtosis
+00018860: 6020 7768 656e 2075 7369 6e67 2060 7061  ` when using `pa
+00018870: 6e64 6173 203e 3d32 6020 220a 2020 2020  ndas >=2` ".    
+00018880: 2020 2020 2020 2020 2020 2020 6622 2870              f"(p
+00018890: 616e 6461 733d 7b73 7472 2850 414e 4441  andas={str(PANDA
+000188a0: 535f 5645 5253 494f 4e29 7d20 6973 2069  S_VERSION)} is i
+000188b0: 6e73 7461 6c6c 6564 292e 220a 2020 2020  nstalled).".    
+000188c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000188d0: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
+000188e0: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
+000188f0: 7329 0a20 2020 2020 2020 205f 7261 6973  s).        _rais
+00018900: 655f 6966 5f6f 626a 6563 745f 7365 7269  e_if_object_seri
+00018910: 6573 2873 656c 662c 2022 6b75 7274 6f73  es(self, "kurtos
+00018920: 6973 2229 0a20 2020 2020 2020 206d 6574  is").        met
+00018930: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
+00018940: 6f6e 656d 7074 792e 6b75 7274 6f73 6973  onempty.kurtosis
+00018950: 2829 0a20 2020 2020 2020 2069 6620 6178  ().        if ax
+00018960: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
+00018970: 2020 2020 2072 6573 756c 7420 3d20 6d61       result = ma
+00018980: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
+00018990: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
+000189a0: 6b75 7274 6f73 6973 2c0a 2020 2020 2020  kurtosis,.      
+000189b0: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+000189c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000189d0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
+000189e0: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
+000189f0: 3d73 656c 662e 5f74 6f6b 656e 5f70 7265  =self._token_pre
+00018a00: 6669 7820 2b20 226b 7572 746f 7369 7322  fix + "kurtosis"
+00018a10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00018a20: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
+00018a30: 2020 2020 2020 2020 2020 2020 2065 6e66               enf
+00018a40: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
+00018a50: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00018a60: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+00018a70: 6574 7572 6e20 6861 6e64 6c65 5f6f 7574  eturn handle_out
+00018a80: 286f 7574 2c20 7265 7375 6c74 290a 2020  (out, result).  
+00018a90: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00018aa0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00018ab0: 6e64 696d 203d 3d20 313a 0a20 2020 2020  ndim == 1:.     
+00018ac0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00018ad0: 7420 3d20 7365 6c66 2e5f 6b75 7274 6f73  t = self._kurtos
+00018ae0: 6973 5f31 6428 0a20 2020 2020 2020 2020  is_1d(.         
+00018af0: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+00018b00: 2066 6973 6865 723d 6669 7368 6572 2c20   fisher=fisher, 
+00018b10: 6269 6173 3d62 6961 732c 206e 616e 5f70  bias=bias, nan_p
+00018b20: 6f6c 6963 793d 6e61 6e5f 706f 6c69 6379  olicy=nan_policy
+00018b30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018b40: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00018b50: 2020 2072 6574 7572 6e20 6861 6e64 6c65     return handle
+00018b60: 5f6f 7574 286f 7574 2c20 7265 7375 6c74  _out(out, result
+00018b70: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00018b80: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00018b90: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
+00018ba0: 662e 5f6b 7572 746f 7369 735f 6e75 6d65  f._kurtosis_nume
+00018bb0: 7269 6328 0a20 2020 2020 2020 2020 2020  ric(.           
+00018bc0: 2020 2020 2020 2020 2066 6973 6865 723d           fisher=
+00018bd0: 6669 7368 6572 2c20 6269 6173 3d62 6961  fisher, bias=bia
+00018be0: 732c 206e 616e 5f70 6f6c 6963 793d 6e61  s, nan_policy=na
+00018bf0: 6e5f 706f 6c69 6379 0a20 2020 2020 2020  n_policy.       
+00018c00: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00018c10: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00018c20: 7461 6e63 6528 7365 6c66 2c20 4461 7461  tance(self, Data
+00018c30: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
+00018c40: 2020 2020 2020 2020 7265 7375 6c74 2e64          result.d
+00018c50: 6976 6973 696f 6e73 203d 2028 7365 6c66  ivisions = (self
+00018c60: 2e63 6f6c 756d 6e73 2e6d 696e 2829 2c20  .columns.min(), 
+00018c70: 7365 6c66 2e63 6f6c 756d 6e73 2e6d 6178  self.columns.max
+00018c80: 2829 290a 0a20 2020 2020 2020 2020 2020  ())..           
+00018c90: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+00018ca0: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+00018cb0: 0a20 2020 2064 6566 205f 6b75 7274 6f73  .    def _kurtos
+00018cc0: 6973 5f31 6428 7365 6c66 2c20 636f 6c75  is_1d(self, colu
+00018cd0: 6d6e 2c20 6669 7368 6572 3d54 7275 652c  mn, fisher=True,
+00018ce0: 2062 6961 733d 5472 7565 2c20 6e61 6e5f   bias=True, nan_
+00018cf0: 706f 6c69 6379 3d22 7072 6f70 6167 6174  policy="propagat
+00018d00: 6522 293a 0a20 2020 2020 2020 2022 2222  e"):.        """
+00018d10: 3144 2076 6572 7369 6f6e 206f 6620 7468  1D version of th
+00018d20: 6520 6b75 7274 6f73 6973 2063 616c 6375  e kurtosis calcu
+00018d30: 6c61 7469 6f6e 2e0a 0a20 2020 2020 2020  lation...       
+00018d40: 2055 7365 7320 7468 6520 6172 7261 7920   Uses the array 
+00018d50: 7665 7273 696f 6e20 6672 6f6d 2064 612e  version from da.
+00018d60: 7374 6174 7320 696e 2063 6173 6520 7765  stats in case we
+00018d70: 2061 7265 2070 6173 7369 6e67 2069 6e20   are passing in 
+00018d80: 6120 7369 6e67 6c65 2073 6572 6965 730a  a single series.
+00018d90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00018da0: 2020 2020 2320 696d 706f 7274 2064 6570      # import dep
+00018db0: 656e 6473 206f 6e20 7363 6970 792c 206e  ends on scipy, n
+00018dc0: 6f74 2069 6e73 7461 6c6c 6564 2062 7920  ot installed by 
+00018dd0: 6465 6661 756c 740a 2020 2020 2020 2020  default.        
+00018de0: 6672 6f6d 2064 6173 6b2e 6172 7261 7920  from dask.array 
+00018df0: 696d 706f 7274 2073 7461 7473 2061 7320  import stats as 
+00018e00: 6461 5f73 7461 7473 0a0a 2020 2020 2020  da_stats..      
+00018e10: 2020 6966 2070 642e 6170 692e 7479 7065    if pd.api.type
+00018e20: 732e 6973 5f69 6e74 6567 6572 5f64 7479  s.is_integer_dty
+00018e30: 7065 2863 6f6c 756d 6e2e 5f6d 6574 615f  pe(column._meta_
+00018e40: 6e6f 6e65 6d70 7479 293a 0a20 2020 2020  nonempty):.     
+00018e50: 2020 2020 2020 2063 6f6c 756d 6e20 3d20         column = 
+00018e60: 636f 6c75 6d6e 2e61 7374 7970 6528 2266  column.astype("f
+00018e70: 3822 290a 0a20 2020 2020 2020 2069 6620  8")..        if 
+00018e80: 6e6f 7420 6e70 2e69 7373 7562 6474 7970  not np.issubdtyp
+00018e90: 6528 636f 6c75 6d6e 2e64 7479 7065 2c20  e(column.dtype, 
+00018ea0: 6e70 2e6e 756d 6265 7229 3a0a 2020 2020  np.number):.    
+00018eb0: 2020 2020 2020 2020 636f 6c75 6d6e 203d          column =
+00018ec0: 2063 6f6c 756d 6e2e 6173 7479 7065 2822   column.astype("
+00018ed0: 6638 2229 0a0a 2020 2020 2020 2020 6e61  f8")..        na
+00018ee0: 6d65 203d 2073 656c 662e 5f74 6f6b 656e  me = self._token
+00018ef0: 5f70 7265 6669 7820 2b20 226b 7572 746f  _prefix + "kurto
+00018f00: 7369 732d 3164 2d22 202b 2074 6f6b 656e  sis-1d-" + token
+00018f10: 697a 6528 636f 6c75 6d6e 290a 0a20 2020  ize(column)..   
+00018f20: 2020 2020 2061 7272 6179 5f6b 7572 746f       array_kurto
+00018f30: 7369 7320 3d20 6461 5f73 7461 7473 2e6b  sis = da_stats.k
+00018f40: 7572 746f 7369 7328 0a20 2020 2020 2020  urtosis(.       
+00018f50: 2020 2020 2063 6f6c 756d 6e2e 7661 6c75       column.valu
+00018f60: 6573 2c20 6178 6973 3d30 2c20 6669 7368  es, axis=0, fish
+00018f70: 6572 3d66 6973 6865 722c 2062 6961 733d  er=fisher, bias=
+00018f80: 6269 6173 2c20 6e61 6e5f 706f 6c69 6379  bias, nan_policy
+00018f90: 3d6e 616e 5f70 6f6c 6963 790a 2020 2020  =nan_policy.    
+00018fa0: 2020 2020 290a 0a20 2020 2020 2020 206c      )..        l
+00018fb0: 6179 6572 203d 207b 0a20 2020 2020 2020  ayer = {.       
+00018fc0: 2020 2020 2028 6e61 6d65 2c20 3029 3a20       (name, 0): 
+00018fd0: 286d 6574 686f 6473 2e77 7261 705f 6b75  (methods.wrap_ku
+00018fe0: 7274 6f73 6973 5f72 6564 7563 7469 6f6e  rtosis_reduction
+00018ff0: 2c20 2861 7272 6179 5f6b 7572 746f 7369  , (array_kurtosi
+00019000: 732e 5f6e 616d 652c 292c 204e 6f6e 6529  s._name,), None)
+00019010: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00019020: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+00019030: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+00019040: 6f6c 6c65 6374 696f 6e73 280a 2020 2020  ollections(.    
+00019050: 2020 2020 2020 2020 6e61 6d65 2c20 6c61          name, la
+00019060: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
+00019070: 733d 5b61 7272 6179 5f6b 7572 746f 7369  s=[array_kurtosi
+00019080: 735d 0a20 2020 2020 2020 2029 0a0a 2020  s].        )..  
+00019090: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+000190a0: 5f64 645f 6f62 6a65 6374 280a 2020 2020  _dd_object(.    
+000190b0: 2020 2020 2020 2020 6772 6170 682c 206e          graph, n
+000190c0: 616d 652c 2063 6f6c 756d 6e2e 5f6d 6574  ame, column._met
+000190d0: 615f 6e6f 6e65 6d70 7479 2e6b 7572 746f  a_nonempty.kurto
+000190e0: 7369 7328 292c 2064 6976 6973 696f 6e73  sis(), divisions
+000190f0: 3d5b 4e6f 6e65 2c20 4e6f 6e65 5d0a 2020  =[None, None].  
+00019100: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+00019110: 205f 6b75 7274 6f73 6973 5f6e 756d 6572   _kurtosis_numer
+00019120: 6963 2873 656c 662c 2066 6973 6865 723d  ic(self, fisher=
+00019130: 5472 7565 2c20 6269 6173 3d54 7275 652c  True, bias=True,
+00019140: 206e 616e 5f70 6f6c 6963 793d 2270 726f   nan_policy="pro
+00019150: 7061 6761 7465 2229 3a0a 2020 2020 2020  pagate"):.      
+00019160: 2020 2222 224d 6574 686f 6420 666f 7220    """Method for 
+00019170: 6461 7461 6672 616d 6573 2077 6974 6820  dataframes with 
+00019180: 6e75 6d65 7269 6320 636f 6c75 6d6e 732e  numeric columns.
+00019190: 0a0a 2020 2020 2020 2020 4d61 7073 2074  ..        Maps t
+000191a0: 6865 2061 7272 6179 2076 6572 7369 6f6e  he array version
+000191b0: 2066 726f 6d20 6461 2e73 7461 7473 206f   from da.stats o
+000191c0: 6e74 6f20 7468 6520 6e75 6d65 7269 6320  nto the numeric 
+000191d0: 6172 7261 7920 6f66 2063 6f6c 756d 6e73  array of columns
+000191e0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+000191f0: 2020 2020 2020 2320 696d 706f 7274 2064        # import d
+00019200: 6570 656e 6473 206f 6e20 7363 6970 792c  epends on scipy,
+00019210: 206e 6f74 2069 6e73 7461 6c6c 6564 2062   not installed b
+00019220: 7920 6465 6661 756c 740a 2020 2020 2020  y default.      
+00019230: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
+00019240: 7920 696d 706f 7274 2073 7461 7473 2061  y import stats a
+00019250: 7320 6461 5f73 7461 7473 0a0a 2020 2020  s da_stats..    
+00019260: 2020 2020 6e75 6d20 3d20 7365 6c66 2e73      num = self.s
+00019270: 656c 6563 745f 6474 7970 6573 2869 6e63  elect_dtypes(inc
+00019280: 6c75 6465 3d5b 226e 756d 6265 7222 2c20  lude=["number", 
+00019290: 2262 6f6f 6c22 5d2c 2065 7863 6c75 6465  "bool"], exclude
+000192a0: 3d5b 6e70 2e74 696d 6564 656c 7461 3634  =[np.timedelta64
+000192b0: 5d29 0a0a 2020 2020 2020 2020 7661 6c75  ])..        valu
+000192c0: 6573 5f64 7479 7065 203d 206e 756d 2e76  es_dtype = num.v
+000192d0: 616c 7565 732e 6474 7970 650a 2020 2020  alues.dtype.    
+000192e0: 2020 2020 6172 7261 795f 7661 6c75 6573      array_values
+000192f0: 203d 206e 756d 2e76 616c 7565 730a 0a20   = num.values.. 
+00019300: 2020 2020 2020 2069 6620 6e6f 7420 6e70         if not np
+00019310: 2e69 7373 7562 6474 7970 6528 7661 6c75  .issubdtype(valu
+00019320: 6573 5f64 7479 7065 2c20 6e70 2e6e 756d  es_dtype, np.num
+00019330: 6265 7229 3a0a 2020 2020 2020 2020 2020  ber):.          
+00019340: 2020 6172 7261 795f 7661 6c75 6573 203d    array_values =
+00019350: 206e 756d 2e76 616c 7565 732e 6173 7479   num.values.asty
+00019360: 7065 2822 6638 2229 0a0a 2020 2020 2020  pe("f8")..      
+00019370: 2020 6172 7261 795f 6b75 7274 6f73 6973    array_kurtosis
+00019380: 203d 2064 615f 7374 6174 732e 6b75 7274   = da_stats.kurt
+00019390: 6f73 6973 280a 2020 2020 2020 2020 2020  osis(.          
+000193a0: 2020 6172 7261 795f 7661 6c75 6573 2c20    array_values, 
+000193b0: 6178 6973 3d30 2c20 6669 7368 6572 3d66  axis=0, fisher=f
+000193c0: 6973 6865 722c 2062 6961 733d 6269 6173  isher, bias=bias
+000193d0: 2c20 6e61 6e5f 706f 6c69 6379 3d6e 616e  , nan_policy=nan
+000193e0: 5f70 6f6c 6963 790a 2020 2020 2020 2020  _policy.        
+000193f0: 290a 0a20 2020 2020 2020 206e 616d 6520  )..        name 
+00019400: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
+00019410: 6566 6978 202b 2022 6b75 7274 6f73 6973  efix + "kurtosis
+00019420: 2d6e 756d 6572 6963 2220 2b20 746f 6b65  -numeric" + toke
+00019430: 6e69 7a65 286e 756d 290a 2020 2020 2020  nize(num).      
+00019440: 2020 636f 6c73 203d 206e 756d 2e5f 6d65    cols = num._me
+00019450: 7461 2e63 6f6c 756d 6e73 2069 6620 6973  ta.columns if is
+00019460: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
+00019470: 6e75 6d29 2065 6c73 6520 4e6f 6e65 0a0a  num) else None..
+00019480: 2020 2020 2020 2020 7769 7468 2063 6865          with che
+00019490: 636b 5f72 6564 7563 7469 6f6e 735f 7275  ck_reductions_ru
+000194a0: 6e74 696d 655f 7761 726e 696e 6728 293a  ntime_warning():
+000194b0: 0a20 2020 2020 2020 2020 2020 206b 7572  .            kur
+000194c0: 746f 7369 735f 7368 6170 6520 3d20 6e75  tosis_shape = nu
+000194d0: 6d2e 5f6d 6574 615f 6e6f 6e65 6d70 7479  m._meta_nonempty
+000194e0: 2e76 6172 2861 7869 733d 3029 2e73 6861  .var(axis=0).sha
+000194f0: 7065 0a20 2020 2020 2020 2061 7272 6179  pe.        array
+00019500: 5f6b 7572 746f 7369 735f 6e61 6d65 203d  _kurtosis_name =
+00019510: 2028 6172 7261 795f 6b75 7274 6f73 6973   (array_kurtosis
+00019520: 2e5f 6e61 6d65 2c29 202b 2028 302c 2920  ._name,) + (0,) 
+00019530: 2a20 6c65 6e28 6b75 7274 6f73 6973 5f73  * len(kurtosis_s
+00019540: 6861 7065 290a 0a20 2020 2020 2020 206c  hape)..        l
+00019550: 6179 6572 203d 207b 0a20 2020 2020 2020  ayer = {.       
+00019560: 2020 2020 2028 6e61 6d65 2c20 3029 3a20       (name, 0): 
+00019570: 286d 6574 686f 6473 2e77 7261 705f 6b75  (methods.wrap_ku
+00019580: 7274 6f73 6973 5f72 6564 7563 7469 6f6e  rtosis_reduction
+00019590: 2c20 6172 7261 795f 6b75 7274 6f73 6973  , array_kurtosis
+000195a0: 5f6e 616d 652c 2063 6f6c 7329 0a20 2020  _name, cols).   
+000195b0: 2020 2020 207d 0a20 2020 2020 2020 2067       }.        g
+000195c0: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+000195d0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+000195e0: 6374 696f 6e73 280a 2020 2020 2020 2020  ctions(.        
+000195f0: 2020 2020 6e61 6d65 2c20 6c61 7965 722c      name, layer,
+00019600: 2064 6570 656e 6465 6e63 6965 733d 5b61   dependencies=[a
+00019610: 7272 6179 5f6b 7572 746f 7369 735d 0a20  rray_kurtosis]. 
+00019620: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00019630: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
+00019640: 6f62 6a65 6374 280a 2020 2020 2020 2020  object(.        
+00019650: 2020 2020 6772 6170 682c 206e 616d 652c      graph, name,
+00019660: 206e 756d 2e5f 6d65 7461 5f6e 6f6e 656d   num._meta_nonem
+00019670: 7074 792e 6b75 7274 6f73 6973 2829 2c20  pty.kurtosis(), 
+00019680: 6469 7669 7369 6f6e 733d 5b4e 6f6e 652c  divisions=[None,
+00019690: 204e 6f6e 655d 0a20 2020 2020 2020 2029   None].        )
+000196a0: 0a0a 2020 2020 405f 6e75 6d65 7269 635f  ..    @_numeric_
+000196b0: 6f6e 6c79 0a20 2020 2040 6465 7269 7665  only.    @derive
+000196c0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+000196d0: 616d 6529 0a20 2020 2064 6566 2073 656d  ame).    def sem
+000196e0: 2873 656c 662c 2061 7869 733d 4e6f 6e65  (self, axis=None
+000196f0: 2c20 736b 6970 6e61 3d54 7275 652c 2064  , skipna=True, d
+00019700: 646f 663d 312c 2073 706c 6974 5f65 7665  dof=1, split_eve
+00019710: 7279 3d46 616c 7365 2c20 6e75 6d65 7269  ry=False, numeri
+00019720: 635f 6f6e 6c79 3d4e 6f6e 6529 3a0a 2020  c_only=None):.  
+00019730: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
+00019740: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
+00019750: 2861 7869 7329 0a20 2020 2020 2020 205f  (axis).        _
+00019760: 7261 6973 655f 6966 5f6f 626a 6563 745f  raise_if_object_
+00019770: 7365 7269 6573 2873 656c 662c 2022 7365  series(self, "se
+00019780: 6d22 290a 2020 2020 2020 2020 7769 7468  m").        with
+00019790: 2063 6865 636b 5f6e 756d 6572 6963 5f6f   check_numeric_o
+000197a0: 6e6c 795f 6465 7072 6563 6174 696f 6e28  nly_deprecation(
+000197b0: 293a 0a20 2020 2020 2020 2020 2020 206d  ):.            m
+000197c0: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
+000197d0: 5f6e 6f6e 656d 7074 792e 7365 6d28 0a20  _nonempty.sem(. 
+000197e0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000197f0: 7869 733d 6178 6973 2c20 736b 6970 6e61  xis=axis, skipna
+00019800: 3d73 6b69 706e 612c 2064 646f 663d 6464  =skipna, ddof=dd
+00019810: 6f66 2c20 6e75 6d65 7269 635f 6f6e 6c79  of, numeric_only
+00019820: 3d6e 756d 6572 6963 5f6f 6e6c 790a 2020  =numeric_only.  
+00019830: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00019840: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
+00019850: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00019860: 7475 726e 206d 6170 5f70 6172 7469 7469  turn map_partiti
+00019870: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+00019880: 2020 2020 204d 2e73 656d 2c0a 2020 2020       M.sem,.    
+00019890: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000198a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000198b0: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
+000198c0: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
+000198d0: 656e 3d73 656c 662e 5f74 6f6b 656e 5f70  en=self._token_p
+000198e0: 7265 6669 7820 2b20 2273 656d 222c 0a20  refix + "sem",. 
+000198f0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00019900: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
+00019910: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
+00019920: 3d73 6b69 706e 612c 0a20 2020 2020 2020  =skipna,.       
+00019930: 2020 2020 2020 2020 2064 646f 663d 6464           ddof=dd
+00019940: 6f66 2c0a 2020 2020 2020 2020 2020 2020  of,.            
+00019950: 2020 2020 7061 7265 6e74 5f6d 6574 613d      parent_meta=
+00019960: 7365 6c66 2e5f 6d65 7461 2c0a 2020 2020  self._meta,.    
+00019970: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
+00019980: 7269 635f 6f6e 6c79 3d6e 756d 6572 6963  ric_only=numeric
+00019990: 5f6f 6e6c 792c 0a20 2020 2020 2020 2020  _only,.         
+000199a0: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
+000199b0: 653a 0a20 2020 2020 2020 2020 2020 206e  e:.            n
+000199c0: 756d 203d 2073 656c 662e 5f67 6574 5f6e  um = self._get_n
+000199d0: 756d 6572 6963 5f64 6174 6128 290a 2020  umeric_data().  
+000199e0: 2020 2020 2020 2020 2020 7620 3d20 6e75            v = nu
+000199f0: 6d2e 7661 7228 736b 6970 6e61 3d73 6b69  m.var(skipna=ski
+00019a00: 706e 612c 2064 646f 663d 6464 6f66 2c20  pna, ddof=ddof, 
+00019a10: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+00019a20: 745f 6576 6572 7929 0a20 2020 2020 2020  t_every).       
+00019a30: 2020 2020 206e 203d 206e 756d 2e63 6f75       n = num.cou
+00019a40: 6e74 2873 706c 6974 5f65 7665 7279 3d73  nt(split_every=s
+00019a50: 706c 6974 5f65 7665 7279 290a 2020 2020  plit_every).    
+00019a60: 2020 2020 2020 2020 6e61 6d65 203d 2073          name = s
+00019a70: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
+00019a80: 7820 2b20 2273 656d 220a 2020 2020 2020  x + "sem".      
+00019a90: 2020 2020 2020 7265 7375 6c74 203d 206d        result = m
+00019aa0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00019ab0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00019ac0: 702e 7371 7274 2c0a 2020 2020 2020 2020  p.sqrt,.        
+00019ad0: 2020 2020 2020 2020 7620 2f20 6e2c 0a20          v / n,. 
+00019ae0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00019af0: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
+00019b00: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
+00019b10: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00019b20: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
+00019b30: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
+00019b40: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00019b50: 7265 6e74 5f6d 6574 613d 7365 6c66 2e5f  rent_meta=self._
+00019b60: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
+00019b70: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00019b80: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
+00019b90: 656c 662c 2044 6174 6146 7261 6d65 293a  elf, DataFrame):
+00019ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019bb0: 2072 6573 756c 742e 6469 7669 7369 6f6e   result.division
+00019bc0: 7320 3d20 2873 656c 662e 636f 6c75 6d6e  s = (self.column
+00019bd0: 732e 6d69 6e28 292c 2073 656c 662e 636f  s.min(), self.co
+00019be0: 6c75 6d6e 732e 6d61 7828 2929 0a20 2020  lumns.max()).   
+00019bf0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00019c00: 7265 7375 6c74 0a0a 2020 2020 405f 6e75  result..    @_nu
+00019c10: 6d65 7269 635f 6461 7461 0a20 2020 2064  meric_data.    d
+00019c20: 6566 2071 7561 6e74 696c 6528 7365 6c66  ef quantile(self
+00019c30: 2c20 713d 302e 352c 2061 7869 733d 302c  , q=0.5, axis=0,
+00019c40: 206e 756d 6572 6963 5f6f 6e6c 793d 6e6f   numeric_only=no
+00019c50: 5f64 6566 6175 6c74 2c20 6d65 7468 6f64  _default, method
+00019c60: 3d22 6465 6661 756c 7422 293a 0a20 2020  ="default"):.   
+00019c70: 2020 2020 2022 2222 4170 7072 6f78 696d       """Approxim
+00019c80: 6174 6520 726f 772d 7769 7365 2061 6e64  ate row-wise and
+00019c90: 2070 7265 6369 7365 2063 6f6c 756d 6e2d   precise column-
+00019ca0: 7769 7365 2071 7561 6e74 696c 6573 206f  wise quantiles o
+00019cb0: 6620 4461 7461 4672 616d 650a 0a20 2020  f DataFrame..   
+00019cc0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00019cd0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00019ce0: 2d2d 0a20 2020 2020 2020 2071 203a 206c  --.        q : l
+00019cf0: 6973 742f 6172 7261 7920 6f66 2066 6c6f  ist/array of flo
+00019d00: 6174 732c 2064 6566 6175 6c74 2030 2e35  ats, default 0.5
+00019d10: 2028 3530 2529 0a20 2020 2020 2020 2020   (50%).         
+00019d20: 2020 2049 7465 7261 626c 6520 6f66 206e     Iterable of n
+00019d30: 756d 6265 7273 2072 616e 6769 6e67 2066  umbers ranging f
+00019d40: 726f 6d20 3020 746f 2031 2066 6f72 2074  rom 0 to 1 for t
+00019d50: 6865 2064 6573 6972 6564 2071 7561 6e74  he desired quant
+00019d60: 696c 6573 0a20 2020 2020 2020 2061 7869  iles.        axi
+00019d70: 7320 3a20 7b30 2c20 312c 2027 696e 6465  s : {0, 1, 'inde
+00019d80: 7827 2c20 2763 6f6c 756d 6e73 277d 2028  x', 'columns'} (
+00019d90: 6465 6661 756c 7420 3029 0a20 2020 2020  default 0).     
+00019da0: 2020 2020 2020 2030 206f 7220 2769 6e64         0 or 'ind
+00019db0: 6578 2720 666f 7220 726f 772d 7769 7365  ex' for row-wise
+00019dc0: 2c20 3120 6f72 2027 636f 6c75 6d6e 7327  , 1 or 'columns'
+00019dd0: 2066 6f72 2063 6f6c 756d 6e2d 7769 7365   for column-wise
+00019de0: 0a20 2020 2020 2020 206d 6574 686f 6420  .        method 
+00019df0: 3a20 7b27 6465 6661 756c 7427 2c20 2774  : {'default', 't
+00019e00: 6469 6765 7374 272c 2027 6461 736b 277d  digest', 'dask'}
+00019e10: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00019e20: 2020 2020 2020 2057 6861 7420 6d65 7468         What meth
+00019e30: 6f64 2074 6f20 7573 652e 2042 7920 6465  od to use. By de
+00019e40: 6661 756c 7420 7769 6c6c 2075 7365 2064  fault will use d
+00019e50: 6173 6b27 7320 696e 7465 726e 616c 2063  ask's internal c
+00019e60: 7573 746f 6d0a 2020 2020 2020 2020 2020  ustom.          
+00019e70: 2020 616c 676f 7269 7468 6d20 2860 6027    algorithm (``'
+00019e80: 6461 736b 2760 6029 2e20 2049 6620 7365  dask'``).  If se
+00019e90: 7420 746f 2060 6027 7464 6967 6573 7427  t to ``'tdigest'
+00019ea0: 6060 2077 696c 6c20 7573 6520 7464 6967  `` will use tdig
+00019eb0: 6573 740a 2020 2020 2020 2020 2020 2020  est.            
+00019ec0: 666f 7220 666c 6f61 7473 2061 6e64 2069  for floats and i
+00019ed0: 6e74 7320 616e 6420 6661 6c6c 6261 636b  nts and fallback
+00019ee0: 2074 6f20 7468 6520 6060 2764 6173 6b27   to the ``'dask'
+00019ef0: 6060 206f 7468 6572 7769 7365 2e0a 2020  `` otherwise..  
+00019f00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00019f10: 2020 6e75 6d65 7269 635f 6b77 6172 6773    numeric_kwargs
+00019f20: 203d 205f 6e75 6d65 7269 635f 6f6e 6c79   = _numeric_only
+00019f30: 5f6d 6179 6265 5f77 6172 6e28 7365 6c66  _maybe_warn(self
+00019f40: 2c20 6e75 6d65 7269 635f 6f6e 6c79 2c20  , numeric_only, 
+00019f50: 6465 6661 756c 743d 5472 7565 290a 0a20  default=True).. 
+00019f60: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
+00019f70: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
+00019f80: 7328 6178 6973 290a 2020 2020 2020 2020  s(axis).        
+00019f90: 6b65 796e 616d 6520 3d20 2271 7561 6e74  keyname = "quant
+00019fa0: 696c 6573 2d63 6f6e 6361 742d 2d22 202b  iles-concat--" +
+00019fb0: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
+00019fc0: 712c 2061 7869 7329 0a0a 2020 2020 2020  q, axis)..      
+00019fd0: 2020 7769 7468 2063 6865 636b 5f6e 756d    with check_num
+00019fe0: 6572 6963 5f6f 6e6c 795f 6465 7072 6563  eric_only_deprec
+00019ff0: 6174 696f 6e28 293a 0a20 2020 2020 2020  ation():.       
+0001a000: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
+0001a010: 2e5f 6d65 7461 2e71 7561 6e74 696c 6528  ._meta.quantile(
+0001a020: 712c 2061 7869 733d 6178 6973 2c20 2a2a  q, axis=axis, **
+0001a030: 6e75 6d65 7269 635f 6b77 6172 6773 290a  numeric_kwargs).
+0001a040: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
+0001a050: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+0001a060: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0001a070: 2871 2c20 6c69 7374 293a 0a20 2020 2020  (q, list):.     
+0001a080: 2020 2020 2020 2020 2020 2023 204e 6f74             # Not
+0001a090: 2073 7570 706f 7274 6564 2c20 7468 6520   supported, the 
+0001a0a0: 7265 7375 6c74 2077 696c 6c20 6861 7665  result will have
+0001a0b0: 2063 7572 7265 6e74 2069 6e64 6578 2061   current index a
+0001a0c0: 7320 636f 6c75 6d6e 730a 2020 2020 2020  s columns.      
+0001a0d0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001a0e0: 5661 6c75 6545 7272 6f72 2822 2771 2720  ValueError("'q' 
+0001a0f0: 6d75 7374 2062 6520 7363 616c 6172 2077  must be scalar w
+0001a100: 6865 6e20 6178 6973 3d31 2069 7320 7370  hen axis=1 is sp
+0001a110: 6563 6966 6965 6422 290a 0a20 2020 2020  ecified")..     
+0001a120: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
+0001a130: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
+0001a140: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
+0001a150: 7175 616e 7469 6c65 2c0a 2020 2020 2020  quantile,.      
+0001a160: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+0001a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a180: 712c 0a20 2020 2020 2020 2020 2020 2020  q,.             
+0001a190: 2020 2061 7869 732c 0a20 2020 2020 2020     axis,.       
+0001a1a0: 2020 2020 2020 2020 2074 6f6b 656e 3d6b           token=k
+0001a1b0: 6579 6e61 6d65 2c0a 2020 2020 2020 2020  eyname,.        
+0001a1c0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
+0001a1d0: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
+0001a1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a1f0: 2a2a 6e75 6d65 7269 635f 6b77 6172 6773  **numeric_kwargs
+0001a200: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001a210: 2020 6d65 7461 3d28 712c 2022 6638 2229    meta=(q, "f8")
+0001a220: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001a230: 2020 7061 7265 6e74 5f6d 6574 613d 7365    parent_meta=se
+0001a240: 6c66 2e5f 6d65 7461 2c0a 2020 2020 2020  lf._meta,.      
+0001a250: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001a260: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001a270: 2020 5f72 6169 7365 5f69 665f 6f62 6a65    _raise_if_obje
+0001a280: 6374 5f73 6572 6965 7328 7365 6c66 2c20  ct_series(self, 
+0001a290: 2271 7561 6e74 696c 6522 290a 2020 2020  "quantile").    
+0001a2a0: 2020 2020 2020 2020 6e75 6d20 3d20 7365          num = se
+0001a2b0: 6c66 2e5f 6765 745f 6e75 6d65 7269 635f  lf._get_numeric_
+0001a2c0: 6461 7461 2829 0a20 2020 2020 2020 2020  data().         
+0001a2d0: 2020 2071 7561 6e74 696c 6573 203d 2074     quantiles = t
+0001a2e0: 7570 6c65 2871 7561 6e74 696c 6528 7365  uple(quantile(se
+0001a2f0: 6c66 5b63 5d2c 2071 2c20 6d65 7468 6f64  lf[c], q, method
+0001a300: 2920 666f 7220 6320 696e 206e 756d 2e63  ) for c in num.c
+0001a310: 6f6c 756d 6e73 290a 0a20 2020 2020 2020  olumns)..       
+0001a320: 2020 2020 2071 6e61 6d65 7320 3d20 5b28       qnames = [(
+0001a330: 5f71 2e5f 6e61 6d65 2c20 3029 2066 6f72  _q._name, 0) for
+0001a340: 205f 7120 696e 2071 7561 6e74 696c 6573   _q in quantiles
+0001a350: 5d0a 0a20 2020 2020 2020 2020 2020 2069  ]..            i
+0001a360: 6620 6973 696e 7374 616e 6365 2871 7561  f isinstance(qua
+0001a370: 6e74 696c 6573 5b30 5d2c 2053 6361 6c61  ntiles[0], Scala
+0001a380: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+0001a390: 2020 2020 6c61 7965 7220 3d20 7b0a 2020      layer = {.  
+0001a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a3b0: 2020 286b 6579 6e61 6d65 2c20 3029 3a20    (keyname, 0): 
+0001a3c0: 2874 7970 6528 6d65 7461 292c 2071 6e61  (type(meta), qna
+0001a3d0: 6d65 732c 206e 756d 2e63 6f6c 756d 6e73  mes, num.columns
+0001a3e0: 2c20 4e6f 6e65 2c20 6d65 7461 2e6e 616d  , None, meta.nam
+0001a3f0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+0001a400: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+0001a410: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+0001a420: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+0001a430: 5f63 6f6c 6c65 6374 696f 6e73 280a 2020  _collections(.  
+0001a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a450: 2020 6b65 796e 616d 652c 206c 6179 6572    keyname, layer
+0001a460: 2c20 6465 7065 6e64 656e 6369 6573 3d71  , dependencies=q
+0001a470: 7561 6e74 696c 6573 0a20 2020 2020 2020  uantiles.       
+0001a480: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001a490: 2020 2020 2020 2020 2020 2064 6976 6973             divis
+0001a4a0: 696f 6e73 203d 2028 6d69 6e28 6e75 6d2e  ions = (min(num.
+0001a4b0: 636f 6c75 6d6e 7329 2c20 6d61 7828 6e75  columns), max(nu
+0001a4c0: 6d2e 636f 6c75 6d6e 7329 290a 2020 2020  m.columns)).    
+0001a4d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001a4e0: 726e 2053 6572 6965 7328 6772 6170 682c  rn Series(graph,
+0001a4f0: 206b 6579 6e61 6d65 2c20 6d65 7461 2c20   keyname, meta, 
+0001a500: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
+0001a510: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001a520: 2020 2020 2020 2020 2020 2020 206c 6179               lay
+0001a530: 6572 203d 207b 286b 6579 6e61 6d65 2c20  er = {(keyname, 
+0001a540: 3029 3a20 286d 6574 686f 6473 2e63 6f6e  0): (methods.con
+0001a550: 6361 742c 2071 6e61 6d65 732c 2031 297d  cat, qnames, 1)}
+0001a560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a570: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+0001a580: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+0001a590: 6c65 6374 696f 6e73 280a 2020 2020 2020  lections(.      
+0001a5a0: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
+0001a5b0: 796e 616d 652c 206c 6179 6572 2c20 6465  yname, layer, de
+0001a5c0: 7065 6e64 656e 6369 6573 3d71 7561 6e74  pendencies=quant
+0001a5d0: 696c 6573 0a20 2020 2020 2020 2020 2020  iles.           
+0001a5e0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0001a5f0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+0001a600: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
+0001a610: 682c 206b 6579 6e61 6d65 2c20 6d65 7461  h, keyname, meta
+0001a620: 2c20 7175 616e 7469 6c65 735b 305d 2e64  , quantiles[0].d
+0001a630: 6976 6973 696f 6e73 290a 0a20 2020 2040  ivisions)..    @
+0001a640: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0001a650: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0001a660: 6566 2064 6573 6372 6962 6528 0a20 2020  ef describe(.   
+0001a670: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0001a680: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
+0001a690: 616c 7365 2c0a 2020 2020 2020 2020 7065  alse,.        pe
+0001a6a0: 7263 656e 7469 6c65 733d 4e6f 6e65 2c0a  rcentiles=None,.
+0001a6b0: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
+0001a6c0: 6c65 735f 6d65 7468 6f64 3d22 6465 6661  les_method="defa
+0001a6d0: 756c 7422 2c0a 2020 2020 2020 2020 696e  ult",.        in
+0001a6e0: 636c 7564 653d 4e6f 6e65 2c0a 2020 2020  clude=None,.    
+0001a6f0: 2020 2020 6578 636c 7564 653d 4e6f 6e65      exclude=None
+0001a700: 2c0a 2020 2020 2020 2020 6461 7465 7469  ,.        dateti
+0001a710: 6d65 5f69 735f 6e75 6d65 7269 633d 6e6f  me_is_numeric=no
+0001a720: 5f64 6566 6175 6c74 2c0a 2020 2020 293a  _default,.    ):
+0001a730: 0a20 2020 2020 2020 2069 6620 5041 4e44  .        if PAND
+0001a740: 4153 5f47 545f 3230 303a 0a20 2020 2020  AS_GT_200:.     
+0001a750: 2020 2020 2020 2069 6620 6461 7465 7469         if dateti
+0001a760: 6d65 5f69 735f 6e75 6d65 7269 6320 6973  me_is_numeric is
+0001a770: 206e 6f5f 6465 6661 756c 743a 0a20 2020   no_default:.   
+0001a780: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+0001a790: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
+0001a7a0: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+0001a7b0: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
+0001a7c0: 5f69 735f 6e75 6d65 7269 635f 6b77 6172  _is_numeric_kwar
+0001a7d0: 6720 3d20 7b7d 0a20 2020 2020 2020 2020  g = {}.         
+0001a7e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0001a7f0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0001a800: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
+0001a810: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+0001a820: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
+0001a830: 6963 2069 7320 7265 6d6f 7665 6420 696e  ic is removed in
+0001a840: 2070 616e 6461 733e 3d32 2e30 2e30 2c20   pandas>=2.0.0, 
+0001a850: 6461 7465 7469 6d65 2064 6174 6120 7769  datetime data wi
+0001a860: 6c6c 2061 6c77 6179 7320 6265 2022 0a20  ll always be ". 
+0001a870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a880: 2020 2022 7375 6d6d 6172 697a 6564 2061     "summarized a
+0001a890: 7320 6e75 6d65 7269 6322 0a20 2020 2020  s numeric".     
+0001a8a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001a8b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001a8c0: 2020 2020 2020 2064 6174 6574 696d 655f         datetime_
+0001a8d0: 6973 5f6e 756d 6572 6963 203d 2028 0a20  is_numeric = (. 
+0001a8e0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
+0001a8f0: 616c 7365 2069 6620 6461 7465 7469 6d65  alse if datetime
+0001a900: 5f69 735f 6e75 6d65 7269 6320 6973 206e  _is_numeric is n
+0001a910: 6f5f 6465 6661 756c 7420 656c 7365 2064  o_default else d
+0001a920: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
+0001a930: 6963 0a20 2020 2020 2020 2020 2020 2029  ic.            )
+0001a940: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+0001a950: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
+0001a960: 5f6b 7761 7267 203d 207b 2264 6174 6574  _kwarg = {"datet
+0001a970: 696d 655f 6973 5f6e 756d 6572 6963 223a  ime_is_numeric":
+0001a980: 2064 6174 6574 696d 655f 6973 5f6e 756d   datetime_is_num
+0001a990: 6572 6963 7d0a 0a20 2020 2020 2020 2069  eric}..        i
+0001a9a0: 6620 7365 6c66 2e5f 6d65 7461 2e6e 6469  f self._meta.ndi
+0001a9b0: 6d20 3d3d 2031 3a0a 2020 2020 2020 2020  m == 1:.        
+0001a9c0: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
+0001a9d0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e64  _meta_nonempty.d
+0001a9e0: 6573 6372 6962 6528 0a20 2020 2020 2020  escribe(.       
+0001a9f0: 2020 2020 2020 2020 2070 6572 6365 6e74           percent
+0001aa00: 696c 6573 3d70 6572 6365 6e74 696c 6573  iles=percentiles
+0001aa10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001aa20: 2020 696e 636c 7564 653d 696e 636c 7564    include=includ
+0001aa30: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0001aa40: 2020 2065 7863 6c75 6465 3d65 7863 6c75     exclude=exclu
+0001aa50: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
+0001aa60: 2020 2020 2a2a 6461 7465 7469 6d65 5f69      **datetime_i
+0001aa70: 735f 6e75 6d65 7269 635f 6b77 6172 672c  s_numeric_kwarg,
+0001aa80: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001aa90: 2020 2020 2020 2020 2020 206f 7574 7075             outpu
+0001aaa0: 7420 3d20 7365 6c66 2e5f 6465 7363 7269  t = self._descri
+0001aab0: 6265 5f31 6428 0a20 2020 2020 2020 2020  be_1d(.         
+0001aac0: 2020 2020 2020 2073 656c 662c 2073 706c         self, spl
+0001aad0: 6974 5f65 7665 7279 2c20 7065 7263 656e  it_every, percen
+0001aae0: 7469 6c65 732c 2070 6572 6365 6e74 696c  tiles, percentil
+0001aaf0: 6573 5f6d 6574 686f 642c 2064 6174 6574  es_method, datet
+0001ab00: 696d 655f 6973 5f6e 756d 6572 6963 0a20  ime_is_numeric. 
+0001ab10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001ab20: 2020 2020 2020 2020 206f 7574 7075 742e           output.
+0001ab30: 5f6d 6574 6120 3d20 6d65 7461 0a20 2020  _meta = meta.   
+0001ab40: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001ab50: 6f75 7470 7574 0a20 2020 2020 2020 2065  output.        e
+0001ab60: 6c69 6620 2869 6e63 6c75 6465 2069 7320  lif (include is 
+0001ab70: 4e6f 6e65 2920 616e 6420 2865 7863 6c75  None) and (exclu
+0001ab80: 6465 2069 7320 4e6f 6e65 293a 0a20 2020  de is None):.   
+0001ab90: 2020 2020 2020 2020 205f 696e 636c 7564           _includ
+0001aba0: 6520 3d20 5b6e 702e 6e75 6d62 6572 2c20  e = [np.number, 
+0001abb0: 6e70 2e74 696d 6564 656c 7461 3634 5d0a  np.timedelta64].
+0001abc0: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+0001abd0: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
+0001abe0: 6963 3a0a 2020 2020 2020 2020 2020 2020  ic:.            
+0001abf0: 2020 2020 5f69 6e63 6c75 6465 2e61 7070      _include.app
+0001ac00: 656e 6428 6e70 2e64 6174 6574 696d 6536  end(np.datetime6
+0001ac10: 3429 0a20 2020 2020 2020 2020 2020 2064  4).            d
+0001ac20: 6174 6120 3d20 7365 6c66 2e5f 6d65 7461  ata = self._meta
+0001ac30: 2e73 656c 6563 745f 6474 7970 6573 2869  .select_dtypes(i
+0001ac40: 6e63 6c75 6465 3d5f 696e 636c 7564 6529  nclude=_include)
+0001ac50: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0001ac60: 7768 656e 2073 6f6d 6520 6e75 6d65 7269  when some numeri
+0001ac70: 6373 2f74 696d 6564 656c 7461 7320 6172  cs/timedeltas ar
+0001ac80: 6520 666f 756e 642c 2062 7920 6465 6661  e found, by defa
+0001ac90: 756c 7420 6b65 6570 2074 6865 6d0a 2020  ult keep them.  
+0001aca0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0001acb0: 2864 6174 612e 636f 6c75 6d6e 7329 203d  (data.columns) =
+0001acc0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+0001acd0: 2020 2020 2063 686f 7365 6e5f 636f 6c75       chosen_colu
+0001ace0: 6d6e 7320 3d20 7365 6c66 2e5f 6d65 7461  mns = self._meta
+0001acf0: 2e63 6f6c 756d 6e73 0a20 2020 2020 2020  .columns.       
+0001ad00: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001ad10: 2020 2020 2020 2020 2020 2023 2063 6865             # che
+0001ad20: 636b 2069 6620 7468 6572 6520 6172 6520  ck if there are 
+0001ad30: 7469 6d65 6465 6c74 612c 2062 6f6f 6c65  timedelta, boole
+0001ad40: 616e 2c20 6f72 2064 6174 6574 696d 6520  an, or datetime 
+0001ad50: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
+0001ad60: 2020 2020 2020 2020 5f69 6e63 6c75 6465          _include
+0001ad70: 203d 205b 6e70 2e74 696d 6564 656c 7461   = [np.timedelta
+0001ad80: 3634 2c20 626f 6f6c 5d0a 2020 2020 2020  64, bool].      
+0001ad90: 2020 2020 2020 2020 2020 6966 2064 6174            if dat
+0001ada0: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
+0001adb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001adc0: 2020 2020 2020 5f69 6e63 6c75 6465 2e61        _include.a
+0001add0: 7070 656e 6428 6e70 2e64 6174 6574 696d  ppend(np.datetim
+0001ade0: 6536 3429 0a20 2020 2020 2020 2020 2020  e64).           
+0001adf0: 2020 2020 2062 6f6f 6c73 5f61 6e64 5f74       bools_and_t
+0001ae00: 696d 6573 203d 2073 656c 662e 5f6d 6574  imes = self._met
+0001ae10: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
+0001ae20: 696e 636c 7564 653d 5f69 6e63 6c75 6465  include=_include
+0001ae30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001ae40: 2020 6966 206c 656e 2862 6f6f 6c73 5f61    if len(bools_a
+0001ae50: 6e64 5f74 696d 6573 2e63 6f6c 756d 6e73  nd_times.columns
+0001ae60: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
+0001ae70: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001ae80: 726e 2073 656c 662e 5f64 6573 6372 6962  rn self._describ
+0001ae90: 655f 6e75 6d65 7269 6328 0a20 2020 2020  e_numeric(.     
+0001aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aeb0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0001aec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aed0: 2073 706c 6974 5f65 7665 7279 2c0a 2020   split_every,.  
+0001aee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aef0: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+0001af00: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0001af10: 2020 2020 2020 2020 2020 2070 6572 6365             perce
+0001af20: 6e74 696c 6573 5f6d 6574 686f 642c 0a20  ntiles_method,. 
+0001af30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af40: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001af50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001af60: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0001af70: 686f 7365 6e5f 636f 6c75 6d6e 7320 3d20  hosen_columns = 
+0001af80: 6461 7461 2e63 6f6c 756d 6e73 0a20 2020  data.columns.   
+0001af90: 2020 2020 2065 6c69 6620 696e 636c 7564       elif includ
+0001afa0: 6520 3d3d 2022 616c 6c22 3a0a 2020 2020  e == "all":.    
+0001afb0: 2020 2020 2020 2020 6966 2065 7863 6c75          if exclu
+0001afc0: 6465 2069 7320 6e6f 7420 4e6f 6e65 3a0a  de is not None:.
+0001afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001afe0: 6d73 6720 3d20 2265 7863 6c75 6465 206d  msg = "exclude m
+0001aff0: 7573 7420 6265 204e 6f6e 6520 7768 656e  ust be None when
+0001b000: 2069 6e63 6c75 6465 2069 7320 2761 6c6c   include is 'all
+0001b010: 2722 0a20 2020 2020 2020 2020 2020 2020  '".             
+0001b020: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0001b030: 726f 7228 6d73 6729 0a20 2020 2020 2020  ror(msg).       
+0001b040: 2020 2020 2063 686f 7365 6e5f 636f 6c75       chosen_colu
+0001b050: 6d6e 7320 3d20 7365 6c66 2e5f 6d65 7461  mns = self._meta
+0001b060: 2e63 6f6c 756d 6e73 0a20 2020 2020 2020  .columns.       
+0001b070: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001b080: 2020 2063 686f 7365 6e5f 636f 6c75 6d6e     chosen_column
+0001b090: 7320 3d20 7365 6c66 2e5f 6d65 7461 2e73  s = self._meta.s
+0001b0a0: 656c 6563 745f 6474 7970 6573 2869 6e63  elect_dtypes(inc
+0001b0b0: 6c75 6465 3d69 6e63 6c75 6465 2c20 6578  lude=include, ex
+0001b0c0: 636c 7564 653d 6578 636c 7564 6529 0a0a  clude=exclude)..
+0001b0d0: 2020 2020 2020 2020 7374 6174 7320 3d20          stats = 
+0001b0e0: 5b0a 2020 2020 2020 2020 2020 2020 7365  [.            se
+0001b0f0: 6c66 2e5f 6465 7363 7269 6265 5f31 6428  lf._describe_1d(
+0001b100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b110: 2073 656c 665b 636f 6c5f 6964 785d 2c0a   self[col_idx],.
+0001b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b130: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
+0001b140: 2020 2020 2020 2020 2020 2020 2070 6572               per
+0001b150: 6365 6e74 696c 6573 2c0a 2020 2020 2020  centiles,.      
+0001b160: 2020 2020 2020 2020 2020 7065 7263 656e            percen
+0001b170: 7469 6c65 735f 6d65 7468 6f64 2c0a 2020  tiles_method,.  
+0001b180: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0001b190: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
+0001b1a0: 632c 0a20 2020 2020 2020 2020 2020 2029  c,.            )
+0001b1b0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001b1c0: 2063 6f6c 5f69 6478 2069 6e20 6368 6f73   col_idx in chos
+0001b1d0: 656e 5f63 6f6c 756d 6e73 0a20 2020 2020  en_columns.     
+0001b1e0: 2020 205d 0a20 2020 2020 2020 2073 7461     ].        sta
+0001b1f0: 7473 5f6e 616d 6573 203d 205b 2873 2e5f  ts_names = [(s._
+0001b200: 6e61 6d65 2c20 3029 2066 6f72 2073 2069  name, 0) for s i
+0001b210: 6e20 7374 6174 735d 0a0a 2020 2020 2020  n stats]..      
+0001b220: 2020 6e61 6d65 203d 2022 6465 7363 7269    name = "descri
+0001b230: 6265 2d2d 2220 2b20 746f 6b65 6e69 7a65  be--" + tokenize
+0001b240: 2873 656c 662c 2073 706c 6974 5f65 7665  (self, split_eve
+0001b250: 7279 290a 2020 2020 2020 2020 6c61 7965  ry).        laye
+0001b260: 7220 3d20 7b28 6e61 6d65 2c20 3029 3a20  r = {(name, 0): 
+0001b270: 286d 6574 686f 6473 2e64 6573 6372 6962  (methods.describ
+0001b280: 655f 6167 6772 6567 6174 652c 2073 7461  e_aggregate, sta
+0001b290: 7473 5f6e 616d 6573 297d 0a20 2020 2020  ts_names)}.     
+0001b2a0: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+0001b2b0: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+0001b2c0: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
+0001b2d0: 206c 6179 6572 2c20 6465 7065 6e64 656e   layer, dependen
+0001b2e0: 6369 6573 3d73 7461 7473 290a 2020 2020  cies=stats).    
+0001b2f0: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
+0001b300: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e64  _meta_nonempty.d
+0001b310: 6573 6372 6962 6528 0a20 2020 2020 2020  escribe(.       
+0001b320: 2020 2020 2069 6e63 6c75 6465 3d69 6e63       include=inc
+0001b330: 6c75 6465 2c20 6578 636c 7564 653d 6578  lude, exclude=ex
+0001b340: 636c 7564 652c 202a 2a64 6174 6574 696d  clude, **datetim
+0001b350: 655f 6973 5f6e 756d 6572 6963 5f6b 7761  e_is_numeric_kwa
+0001b360: 7267 0a20 2020 2020 2020 2029 0a20 2020  rg.        ).   
+0001b370: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+0001b380: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
+0001b390: 206e 616d 652c 206d 6574 612c 2064 6976   name, meta, div
+0001b3a0: 6973 696f 6e73 3d5b 4e6f 6e65 2c20 4e6f  isions=[None, No
+0001b3b0: 6e65 5d29 0a0a 2020 2020 6465 6620 5f64  ne])..    def _d
+0001b3c0: 6573 6372 6962 655f 3164 280a 2020 2020  escribe_1d(.    
+0001b3d0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0001b3e0: 2020 6461 7461 2c0a 2020 2020 2020 2020    data,.        
+0001b3f0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+0001b400: 652c 0a20 2020 2020 2020 2070 6572 6365  e,.        perce
+0001b410: 6e74 696c 6573 3d4e 6f6e 652c 0a20 2020  ntiles=None,.   
+0001b420: 2020 2020 2070 6572 6365 6e74 696c 6573       percentiles
+0001b430: 5f6d 6574 686f 643d 2264 6566 6175 6c74  _method="default
+0001b440: 222c 0a20 2020 2020 2020 2064 6174 6574  ",.        datet
+0001b450: 696d 655f 6973 5f6e 756d 6572 6963 3d46  ime_is_numeric=F
+0001b460: 616c 7365 2c0a 2020 2020 293a 0a20 2020  alse,.    ):.   
+0001b470: 2020 2020 2069 6620 6973 5f62 6f6f 6c5f       if is_bool_
+0001b480: 6474 7970 6528 6461 7461 2e5f 6d65 7461  dtype(data._meta
+0001b490: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0001b4a0: 6574 7572 6e20 7365 6c66 2e5f 6465 7363  eturn self._desc
+0001b4b0: 7269 6265 5f6e 6f6e 6e75 6d65 7269 635f  ribe_nonnumeric_
+0001b4c0: 3164 280a 2020 2020 2020 2020 2020 2020  1d(.            
+0001b4d0: 2020 2020 6461 7461 2c20 7370 6c69 745f      data, split_
+0001b4e0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+0001b4f0: 792c 2064 6174 6574 696d 655f 6973 5f6e  y, datetime_is_n
+0001b500: 756d 6572 6963 3d64 6174 6574 696d 655f  umeric=datetime_
+0001b510: 6973 5f6e 756d 6572 6963 0a20 2020 2020  is_numeric.     
+0001b520: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001b530: 2065 6c69 6620 6973 5f6e 756d 6572 6963   elif is_numeric
+0001b540: 5f64 7479 7065 2864 6174 612e 5f6d 6574  _dtype(data._met
+0001b550: 6129 3a0a 2020 2020 2020 2020 2020 2020  a):.            
+0001b560: 7265 7475 726e 2073 656c 662e 5f64 6573  return self._des
+0001b570: 6372 6962 655f 6e75 6d65 7269 6328 0a20  cribe_numeric(. 
+0001b580: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0001b590: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
+0001b5a0: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+0001b5b0: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
+0001b5c0: 2020 2020 2020 2020 2020 2020 2020 7065                pe
+0001b5d0: 7263 656e 7469 6c65 733d 7065 7263 656e  rcentiles=percen
+0001b5e0: 7469 6c65 732c 0a20 2020 2020 2020 2020  tiles,.         
+0001b5f0: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
+0001b600: 6573 5f6d 6574 686f 643d 7065 7263 656e  es_method=percen
+0001b610: 7469 6c65 735f 6d65 7468 6f64 2c0a 2020  tiles_method,.  
+0001b620: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001b630: 2020 2020 656c 6966 2069 735f 7469 6d65      elif is_time
+0001b640: 6465 6c74 6136 345f 6474 7970 6528 6461  delta64_dtype(da
+0001b650: 7461 2e5f 6d65 7461 293a 0a20 2020 2020  ta._meta):.     
+0001b660: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001b670: 6c66 2e5f 6465 7363 7269 6265 5f6e 756d  lf._describe_num
+0001b680: 6572 6963 280a 2020 2020 2020 2020 2020  eric(.          
+0001b690: 2020 2020 2020 6461 7461 2e64 726f 706e        data.dropn
+0001b6a0: 6128 292c 0a20 2020 2020 2020 2020 2020  a(),.           
+0001b6b0: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+0001b6c0: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
+0001b6d0: 2020 2020 2020 2020 2020 2020 2020 7065                pe
+0001b6e0: 7263 656e 7469 6c65 733d 7065 7263 656e  rcentiles=percen
+0001b6f0: 7469 6c65 732c 0a20 2020 2020 2020 2020  tiles,.         
+0001b700: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
+0001b710: 6573 5f6d 6574 686f 643d 7065 7263 656e  es_method=percen
+0001b720: 7469 6c65 735f 6d65 7468 6f64 2c0a 2020  tiles_method,.  
+0001b730: 2020 2020 2020 2020 2020 2020 2020 6973                is
+0001b740: 5f74 696d 6564 656c 7461 5f63 6f6c 756d  _timedelta_colum
+0001b750: 6e3d 5472 7565 2c0a 2020 2020 2020 2020  n=True,.        
+0001b760: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
+0001b770: 6966 2069 735f 6461 7465 7469 6d65 3634  if is_datetime64
+0001b780: 5f61 6e79 5f64 7479 7065 2864 6174 612e  _any_dtype(data.
+0001b790: 5f6d 6574 6129 2061 6e64 2064 6174 6574  _meta) and datet
+0001b7a0: 696d 655f 6973 5f6e 756d 6572 6963 3a0a  ime_is_numeric:.
+0001b7b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001b7c0: 726e 2073 656c 662e 5f64 6573 6372 6962  rn self._describ
+0001b7d0: 655f 6e75 6d65 7269 6328 0a20 2020 2020  e_numeric(.     
+0001b7e0: 2020 2020 2020 2020 2020 2064 6174 612e             data.
+0001b7f0: 6472 6f70 6e61 2829 2c0a 2020 2020 2020  dropna(),.      
+0001b800: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
+0001b810: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+0001b820: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+0001b830: 2020 2070 6572 6365 6e74 696c 6573 3d70     percentiles=p
+0001b840: 6572 6365 6e74 696c 6573 2c0a 2020 2020  ercentiles,.    
+0001b850: 2020 2020 2020 2020 2020 2020 7065 7263              perc
+0001b860: 656e 7469 6c65 735f 6d65 7468 6f64 3d70  entiles_method=p
+0001b870: 6572 6365 6e74 696c 6573 5f6d 6574 686f  ercentiles_metho
+0001b880: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
+0001b890: 2020 2069 735f 6461 7465 7469 6d65 5f63     is_datetime_c
+0001b8a0: 6f6c 756d 6e3d 5472 7565 2c0a 2020 2020  olumn=True,.    
+0001b8b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001b8c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001b8d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001b8e0: 5f64 6573 6372 6962 655f 6e6f 6e6e 756d  _describe_nonnum
+0001b8f0: 6572 6963 5f31 6428 0a20 2020 2020 2020  eric_1d(.       
+0001b900: 2020 2020 2020 2020 2064 6174 612c 2073           data, s
+0001b910: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+0001b920: 5f65 7665 7279 2c20 6461 7465 7469 6d65  _every, datetime
+0001b930: 5f69 735f 6e75 6d65 7269 633d 6461 7465  _is_numeric=date
+0001b940: 7469 6d65 5f69 735f 6e75 6d65 7269 630a  time_is_numeric.
+0001b950: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0001b960: 2020 2064 6566 205f 6465 7363 7269 6265     def _describe
+0001b970: 5f6e 756d 6572 6963 280a 2020 2020 2020  _numeric(.      
+0001b980: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0001b990: 6461 7461 2c0a 2020 2020 2020 2020 7370  data,.        sp
+0001b9a0: 6c69 745f 6576 6572 793d 4661 6c73 652c  lit_every=False,
+0001b9b0: 0a20 2020 2020 2020 2070 6572 6365 6e74  .        percent
+0001b9c0: 696c 6573 3d4e 6f6e 652c 0a20 2020 2020  iles=None,.     
+0001b9d0: 2020 2070 6572 6365 6e74 696c 6573 5f6d     percentiles_m
+0001b9e0: 6574 686f 643d 2264 6566 6175 6c74 222c  ethod="default",
+0001b9f0: 0a20 2020 2020 2020 2069 735f 7469 6d65  .        is_time
+0001ba00: 6465 6c74 615f 636f 6c75 6d6e 3d46 616c  delta_column=Fal
+0001ba10: 7365 2c0a 2020 2020 2020 2020 6973 5f64  se,.        is_d
+0001ba20: 6174 6574 696d 655f 636f 6c75 6d6e 3d46  atetime_column=F
+0001ba30: 616c 7365 2c0a 2020 2020 293a 0a20 2020  alse,.    ):.   
+0001ba40: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
+0001ba50: 6174 6166 7261 6d65 2e6e 756d 6572 6963  ataframe.numeric
+0001ba60: 2069 6d70 6f72 7420 746f 5f6e 756d 6572   import to_numer
+0001ba70: 6963 0a0a 2020 2020 2020 2020 6966 2069  ic..        if i
+0001ba80: 735f 7469 6d65 6465 6c74 615f 636f 6c75  s_timedelta_colu
+0001ba90: 6d6e 206f 7220 6973 5f64 6174 6574 696d  mn or is_datetim
+0001baa0: 655f 636f 6c75 6d6e 3a0a 2020 2020 2020  e_column:.      
+0001bab0: 2020 2020 2020 6e75 6d20 3d20 746f 5f6e        num = to_n
+0001bac0: 756d 6572 6963 2864 6174 6129 0a20 2020  umeric(data).   
+0001bad0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001bae0: 2020 2020 2020 206e 756d 203d 2064 6174         num = dat
+0001baf0: 612e 5f67 6574 5f6e 756d 6572 6963 5f64  a._get_numeric_d
+0001bb00: 6174 6128 290a 0a20 2020 2020 2020 2069  ata()..        i
+0001bb10: 6620 6461 7461 2e6e 6469 6d20 3d3d 2032  f data.ndim == 2
+0001bb20: 2061 6e64 206c 656e 286e 756d 2e63 6f6c   and len(num.col
+0001bb30: 756d 6e73 2920 3d3d 2030 3a0a 2020 2020  umns) == 0:.    
+0001bb40: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001bb50: 6c75 6545 7272 6f72 2822 4461 7461 4672  lueError("DataFr
+0001bb60: 616d 6520 636f 6e74 6169 6e73 206f 6e6c  ame contains onl
+0001bb70: 7920 6e6f 6e2d 6e75 6d65 7269 6320 6461  y non-numeric da
+0001bb80: 7461 2e22 290a 2020 2020 2020 2020 656c  ta.").        el
+0001bb90: 6966 2064 6174 612e 6e64 696d 203d 3d20  if data.ndim == 
+0001bba0: 3120 616e 6420 6461 7461 2e64 7479 7065  1 and data.dtype
+0001bbb0: 203d 3d20 226f 626a 6563 7422 3a0a 2020   == "object":.  
+0001bbc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001bbd0: 5661 6c75 6545 7272 6f72 2822 4361 6e6e  ValueError("Cann
+0001bbe0: 6f74 2063 6f6d 7075 7465 2060 6064 6573  ot compute ``des
+0001bbf0: 6372 6962 6560 6020 6f6e 206f 626a 6563  cribe`` on objec
+0001bc00: 7420 6474 7970 652e 2229 0a20 2020 2020  t dtype.").     
+0001bc10: 2020 2069 6620 7065 7263 656e 7469 6c65     if percentile
+0001bc20: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+0001bc30: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
+0001bc40: 6573 203d 205b 302e 3235 2c20 302e 352c  es = [0.25, 0.5,
+0001bc50: 2030 2e37 355d 0a20 2020 2020 2020 2065   0.75].        e
+0001bc60: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001bc70: 2023 2061 6c77 6179 7320 696e 636c 7564   # always includ
+0001bc80: 6520 7468 6520 7468 6520 3530 2574 6c65  e the the 50%tle
+0001bc90: 2074 6f20 6361 6c63 756c 6174 6520 7468   to calculate th
+0001bca0: 6520 6d65 6469 616e 0a20 2020 2020 2020  e median.       
+0001bcb0: 2020 2020 2023 2075 6e69 7175 6520 7265       # unique re
+0001bcc0: 6d6f 7665 7320 6475 706c 6963 6174 6573  moves duplicates
+0001bcd0: 2061 6e64 2073 6f72 7473 2071 7561 6e74   and sorts quant
+0001bce0: 696c 6573 0a20 2020 2020 2020 2020 2020  iles.           
+0001bcf0: 2070 6572 6365 6e74 696c 6573 203d 206e   percentiles = n
+0001bd00: 702e 6172 7261 7928 7065 7263 656e 7469  p.array(percenti
+0001bd10: 6c65 7329 0a20 2020 2020 2020 2020 2020  les).           
+0001bd20: 2070 6572 6365 6e74 696c 6573 203d 206e   percentiles = n
+0001bd30: 702e 6170 7065 6e64 2870 6572 6365 6e74  p.append(percent
+0001bd40: 696c 6573 2c20 302e 3529 0a20 2020 2020  iles, 0.5).     
+0001bd50: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
+0001bd60: 6573 203d 206e 702e 756e 6971 7565 2870  es = np.unique(p
+0001bd70: 6572 6365 6e74 696c 6573 290a 2020 2020  ercentiles).    
+0001bd80: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
+0001bd90: 6c65 7320 3d20 6c69 7374 2870 6572 6365  les = list(perce
+0001bda0: 6e74 696c 6573 290a 2020 2020 2020 2020  ntiles).        
+0001bdb0: 7374 6174 7320 3d20 5b0a 2020 2020 2020  stats = [.      
+0001bdc0: 2020 2020 2020 6e75 6d2e 636f 756e 7428        num.count(
+0001bdd0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+0001bde0: 745f 6576 6572 7929 2c0a 2020 2020 2020  t_every),.      
+0001bdf0: 2020 2020 2020 6e75 6d2e 6d65 616e 2873        num.mean(s
+0001be00: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+0001be10: 5f65 7665 7279 292c 0a20 2020 2020 2020  _every),.       
+0001be20: 2020 2020 206e 756d 2e73 7464 2873 706c       num.std(spl
+0001be30: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+0001be40: 7665 7279 292c 0a20 2020 2020 2020 2020  very),.         
+0001be50: 2020 206e 756d 2e6d 696e 2873 706c 6974     num.min(split
+0001be60: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+0001be70: 7279 292c 0a20 2020 2020 2020 2020 2020  ry),.           
+0001be80: 206e 756d 2e71 7561 6e74 696c 6528 7065   num.quantile(pe
+0001be90: 7263 656e 7469 6c65 732c 206d 6574 686f  rcentiles, metho
+0001bea0: 643d 7065 7263 656e 7469 6c65 735f 6d65  d=percentiles_me
+0001beb0: 7468 6f64 292c 0a20 2020 2020 2020 2020  thod),.         
+0001bec0: 2020 206e 756d 2e6d 6178 2873 706c 6974     num.max(split
+0001bed0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+0001bee0: 7279 292c 0a20 2020 2020 2020 205d 0a20  ry),.        ]. 
+0001bef0: 2020 2020 2020 2073 7461 7473 5f6e 616d         stats_nam
+0001bf00: 6573 203d 205b 2873 2e5f 6e61 6d65 2c20  es = [(s._name, 
+0001bf10: 3029 2066 6f72 2073 2069 6e20 7374 6174  0) for s in stat
+0001bf20: 735d 0a0a 2020 2020 2020 2020 636f 6c6e  s]..        coln
+0001bf30: 616d 6520 3d20 6461 7461 2e5f 6d65 7461  ame = data._meta
+0001bf40: 2e6e 616d 6520 6966 2069 735f 7365 7269  .name if is_seri
+0001bf50: 6573 5f6c 696b 6528 6461 7461 2e5f 6d65  es_like(data._me
+0001bf60: 7461 2920 656c 7365 204e 6f6e 650a 0a20  ta) else None.. 
+0001bf70: 2020 2020 2020 206e 616d 6520 3d20 2264         name = "d
+0001bf80: 6573 6372 6962 652d 6e75 6d65 7269 632d  escribe-numeric-
+0001bf90: 2d22 202b 2074 6f6b 656e 697a 6528 6e75  -" + tokenize(nu
+0001bfa0: 6d2c 2073 706c 6974 5f65 7665 7279 290a  m, split_every).
+0001bfb0: 2020 2020 2020 2020 6c61 7965 7220 3d20          layer = 
+0001bfc0: 7b0a 2020 2020 2020 2020 2020 2020 286e  {.            (n
+0001bfd0: 616d 652c 2030 293a 2028 0a20 2020 2020  ame, 0): (.     
+0001bfe0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+0001bff0: 6473 2e64 6573 6372 6962 655f 6e75 6d65  ds.describe_nume
+0001c000: 7269 635f 6167 6772 6567 6174 652c 0a20  ric_aggregate,. 
+0001c010: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001c020: 7461 7473 5f6e 616d 6573 2c0a 2020 2020  tats_names,.    
+0001c030: 2020 2020 2020 2020 2020 2020 636f 6c6e              coln
+0001c040: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+0001c050: 2020 2020 2069 735f 7469 6d65 6465 6c74       is_timedelt
+0001c060: 615f 636f 6c75 6d6e 2c0a 2020 2020 2020  a_column,.      
+0001c070: 2020 2020 2020 2020 2020 6973 5f64 6174            is_dat
+0001c080: 6574 696d 655f 636f 6c75 6d6e 2c0a 2020  etime_column,.  
+0001c090: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001c0a0: 2020 2020 7d0a 2020 2020 2020 2020 6772      }.        gr
+0001c0b0: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+0001c0c0: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+0001c0d0: 7469 6f6e 7328 6e61 6d65 2c20 6c61 7965  tions(name, laye
+0001c0e0: 722c 2064 6570 656e 6465 6e63 6965 733d  r, dependencies=
+0001c0f0: 7374 6174 7329 0a20 2020 2020 2020 206d  stats).        m
+0001c100: 6574 6120 3d20 6e75 6d2e 5f6d 6574 615f  eta = num._meta_
+0001c110: 6e6f 6e65 6d70 7479 2e64 6573 6372 6962  nonempty.describ
+0001c120: 6528 290a 2020 2020 2020 2020 7265 7475  e().        retu
+0001c130: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
+0001c140: 2867 7261 7068 2c20 6e61 6d65 2c20 6d65  (graph, name, me
+0001c150: 7461 2c20 6469 7669 7369 6f6e 733d 5b4e  ta, divisions=[N
+0001c160: 6f6e 652c 204e 6f6e 655d 290a 0a20 2020  one, None])..   
+0001c170: 2064 6566 205f 6465 7363 7269 6265 5f6e   def _describe_n
+0001c180: 6f6e 6e75 6d65 7269 635f 3164 280a 2020  onnumeric_1d(.  
+0001c190: 2020 2020 2020 7365 6c66 2c20 6461 7461        self, data
+0001c1a0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+0001c1b0: 6c73 652c 2064 6174 6574 696d 655f 6973  lse, datetime_is
+0001c1c0: 5f6e 756d 6572 6963 3d46 616c 7365 0a20  _numeric=False. 
+0001c1d0: 2020 2029 3a0a 2020 2020 2020 2020 6672     ):.        fr
+0001c1e0: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+0001c1f0: 652e 6e75 6d65 7269 6320 696d 706f 7274  e.numeric import
+0001c200: 2074 6f5f 6e75 6d65 7269 630a 0a20 2020   to_numeric..   
+0001c210: 2020 2020 2076 636f 756e 7473 203d 2064       vcounts = d
+0001c220: 6174 612e 7661 6c75 655f 636f 756e 7473  ata.value_counts
+0001c230: 2873 706c 6974 5f65 7665 7279 3d73 706c  (split_every=spl
+0001c240: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
+0001c250: 2020 636f 756e 745f 6e6f 6e7a 6572 6f20    count_nonzero 
+0001c260: 3d20 7663 6f75 6e74 735b 7663 6f75 6e74  = vcounts[vcount
+0001c270: 7320 213d 2030 5d0a 2020 2020 2020 2020  s != 0].        
+0001c280: 636f 756e 745f 756e 6971 7565 203d 2063  count_unique = c
+0001c290: 6f75 6e74 5f6e 6f6e 7a65 726f 2e73 697a  ount_nonzero.siz
+0001c2a0: 650a 0a20 2020 2020 2020 2073 7461 7473  e..        stats
+0001c2b0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+0001c2c0: 2023 206e 756e 6971 7565 0a20 2020 2020   # nunique.     
+0001c2d0: 2020 2020 2020 2063 6f75 6e74 5f75 6e69         count_uni
+0001c2e0: 7175 652c 0a20 2020 2020 2020 2020 2020  que,.           
+0001c2f0: 2023 2063 6f75 6e74 0a20 2020 2020 2020   # count.       
+0001c300: 2020 2020 2064 6174 612e 636f 756e 7428       data.count(
+0001c310: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+0001c320: 745f 6576 6572 7929 2c0a 2020 2020 2020  t_every),.      
+0001c330: 2020 2020 2020 2320 6d6f 7374 2063 6f6d        # most com
+0001c340: 6d6f 6e20 7661 6c75 650a 2020 2020 2020  mon value.      
+0001c350: 2020 2020 2020 7663 6f75 6e74 732e 5f68        vcounts._h
+0001c360: 6561 6428 312c 206e 7061 7274 6974 696f  ead(1, npartitio
+0001c370: 6e73 3d31 2c20 636f 6d70 7574 653d 4661  ns=1, compute=Fa
+0001c380: 6c73 652c 2073 6166 653d 4661 6c73 6529  lse, safe=False)
+0001c390: 2c0a 2020 2020 2020 2020 5d0a 0a20 2020  ,.        ]..   
+0001c3a0: 2020 2020 2069 6620 6973 5f64 6174 6574       if is_datet
+0001c3b0: 696d 6536 345f 616e 795f 6474 7970 6528  ime64_any_dtype(
+0001c3c0: 6461 7461 2e5f 6d65 7461 2920 616e 6420  data._meta) and 
+0001c3d0: 6e6f 7420 6461 7465 7469 6d65 5f69 735f  not datetime_is_
+0001c3e0: 6e75 6d65 7269 633a 0a20 2020 2020 2020  numeric:.       
+0001c3f0: 2020 2020 206d 696e 5f74 7320 3d20 746f       min_ts = to
+0001c400: 5f6e 756d 6572 6963 2864 6174 612e 6472  _numeric(data.dr
+0001c410: 6f70 6e61 2829 292e 6d69 6e28 7370 6c69  opna()).min(spli
+0001c420: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+0001c430: 6572 7929 0a20 2020 2020 2020 2020 2020  ery).           
+0001c440: 206d 6178 5f74 7320 3d20 746f 5f6e 756d   max_ts = to_num
+0001c450: 6572 6963 2864 6174 612e 6472 6f70 6e61  eric(data.dropna
+0001c460: 2829 292e 6d61 7828 7370 6c69 745f 6576  ()).max(split_ev
+0001c470: 6572 793d 7370 6c69 745f 6576 6572 7929  ery=split_every)
+0001c480: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+0001c490: 7473 2e65 7874 656e 6428 5b6d 696e 5f74  ts.extend([min_t
+0001c4a0: 732c 206d 6178 5f74 735d 290a 0a20 2020  s, max_ts])..   
+0001c4b0: 2020 2020 2073 7461 7473 5f6e 616d 6573       stats_names
+0001c4c0: 203d 205b 2873 2e5f 6e61 6d65 2c20 3029   = [(s._name, 0)
+0001c4d0: 2066 6f72 2073 2069 6e20 7374 6174 735d   for s in stats]
+0001c4e0: 0a20 2020 2020 2020 2063 6f6c 6e61 6d65  .        colname
+0001c4f0: 203d 2064 6174 612e 5f6d 6574 612e 6e61   = data._meta.na
+0001c500: 6d65 0a0a 2020 2020 2020 2020 6e61 6d65  me..        name
+0001c510: 203d 2022 6465 7363 7269 6265 2d6e 6f6e   = "describe-non
+0001c520: 6e75 6d65 7269 632d 3164 2d2d 2220 2b20  numeric-1d--" + 
+0001c530: 746f 6b65 6e69 7a65 2864 6174 612c 2073  tokenize(data, s
+0001c540: 706c 6974 5f65 7665 7279 290a 2020 2020  plit_every).    
+0001c550: 2020 2020 6c61 7965 7220 3d20 7b0a 2020      layer = {.  
+0001c560: 2020 2020 2020 2020 2020 286e 616d 652c            (name,
+0001c570: 2030 293a 2028 6d65 7468 6f64 732e 6465   0): (methods.de
+0001c580: 7363 7269 6265 5f6e 6f6e 6e75 6d65 7269  scribe_nonnumeri
+0001c590: 635f 6167 6772 6567 6174 652c 2073 7461  c_aggregate, sta
+0001c5a0: 7473 5f6e 616d 6573 2c20 636f 6c6e 616d  ts_names, colnam
+0001c5b0: 6529 0a20 2020 2020 2020 207d 0a20 2020  e).        }.   
+0001c5c0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+0001c5d0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+0001c5e0: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+0001c5f0: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
+0001c600: 656e 6369 6573 3d73 7461 7473 290a 0a20  encies=stats).. 
+0001c610: 2020 2020 2020 2069 6620 6e6f 7420 5041         if not PA
+0001c620: 4e44 4153 5f47 545f 3230 303a 0a20 2020  NDAS_GT_200:.   
+0001c630: 2020 2020 2020 2020 2064 6174 6574 696d           datetim
+0001c640: 655f 6973 5f6e 756d 6572 6963 5f6b 7761  e_is_numeric_kwa
+0001c650: 7267 203d 207b 2264 6174 6574 696d 655f  rg = {"datetime_
+0001c660: 6973 5f6e 756d 6572 6963 223a 2064 6174  is_numeric": dat
+0001c670: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
+0001c680: 7d0a 2020 2020 2020 2020 656c 7365 3a0a  }.        else:.
+0001c690: 2020 2020 2020 2020 2020 2020 6461 7465              date
+0001c6a0: 7469 6d65 5f69 735f 6e75 6d65 7269 635f  time_is_numeric_
+0001c6b0: 6b77 6172 6720 3d20 7b7d 0a20 2020 2020  kwarg = {}.     
+0001c6c0: 2020 206d 6574 6120 3d20 6461 7461 2e5f     meta = data._
+0001c6d0: 6d65 7461 5f6e 6f6e 656d 7074 792e 6465  meta_nonempty.de
+0001c6e0: 7363 7269 6265 282a 2a64 6174 6574 696d  scribe(**datetim
+0001c6f0: 655f 6973 5f6e 756d 6572 6963 5f6b 7761  e_is_numeric_kwa
+0001c700: 7267 290a 2020 2020 2020 2020 7265 7475  rg).        retu
+0001c710: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
+0001c720: 2867 7261 7068 2c20 6e61 6d65 2c20 6d65  (graph, name, me
+0001c730: 7461 2c20 6469 7669 7369 6f6e 733d 5b4e  ta, divisions=[N
+0001c740: 6f6e 652c 204e 6f6e 655d 290a 0a20 2020  one, None])..   
+0001c750: 2064 6566 205f 6375 6d5f 6167 6728 0a20   def _cum_agg(. 
+0001c760: 2020 2020 2020 2073 656c 662c 206f 705f         self, op_
+0001c770: 6e61 6d65 2c20 6368 756e 6b2c 2061 6767  name, chunk, agg
+0001c780: 7265 6761 7465 2c20 6178 6973 2c20 736b  regate, axis, sk
+0001c790: 6970 6e61 3d54 7275 652c 2063 6875 6e6b  ipna=True, chunk
+0001c7a0: 5f6b 7761 7267 733d 4e6f 6e65 2c20 6f75  _kwargs=None, ou
+0001c7b0: 743d 4e6f 6e65 0a20 2020 2029 3a0a 2020  t=None.    ):.  
+0001c7c0: 2020 2020 2020 2222 2257 7261 7070 6572        """Wrapper
+0001c7d0: 2066 6f72 2063 756d 756c 6174 6976 6520   for cumulative 
+0001c7e0: 6f70 6572 6174 696f 6e22 2222 0a0a 2020  operation"""..  
+0001c7f0: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
+0001c800: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
+0001c810: 2861 7869 7329 0a0a 2020 2020 2020 2020  (axis)..        
+0001c820: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
+0001c830: 2020 2020 2020 2020 2020 6e61 6d65 203d            name =
+0001c840: 2066 227b 7365 6c66 2e5f 746f 6b65 6e5f   f"{self._token_
+0001c850: 7072 6566 6978 7d7b 6f70 5f6e 616d 657d  prefix}{op_name}
+0001c860: 2861 7869 733d 3129 220a 2020 2020 2020  (axis=1)".      
+0001c870: 2020 2020 2020 7265 7375 6c74 203d 2073        result = s
+0001c880: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+0001c890: 6e73 2863 6875 6e6b 2c20 746f 6b65 6e3d  ns(chunk, token=
+0001c8a0: 6e61 6d65 2c20 2a2a 6368 756e 6b5f 6b77  name, **chunk_kw
+0001c8b0: 6172 6773 290a 2020 2020 2020 2020 2020  args).          
+0001c8c0: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
+0001c8d0: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
+0001c8e0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0001c8f0: 2020 2020 2020 2020 2020 2023 2063 756d             # cum
+0001c900: 756c 6174 6520 6561 6368 2070 6172 7469  ulate each parti
+0001c910: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
+0001c920: 2020 6e61 6d65 3120 3d20 6622 7b73 656c    name1 = f"{sel
+0001c930: 662e 5f74 6f6b 656e 5f70 7265 6669 787d  f._token_prefix}
+0001c940: 7b6f 705f 6e61 6d65 7d2d 6d61 7022 0a20  {op_name}-map". 
+0001c950: 2020 2020 2020 2020 2020 2063 756d 7061             cumpa
+0001c960: 7274 203d 206d 6170 5f70 6172 7469 7469  rt = map_partiti
+0001c970: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+0001c980: 2020 2020 2063 6875 6e6b 2c20 7365 6c66       chunk, self
+0001c990: 2c20 746f 6b65 6e3d 6e61 6d65 312c 206d  , token=name1, m
+0001c9a0: 6574 613d 7365 6c66 2c20 2a2a 6368 756e  eta=self, **chun
+0001c9b0: 6b5f 6b77 6172 6773 0a20 2020 2020 2020  k_kwargs.       
+0001c9c0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001c9d0: 2020 2020 6e61 6d65 3220 3d20 6622 7b73      name2 = f"{s
+0001c9e0: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
+0001c9f0: 787d 7b6f 705f 6e61 6d65 7d2d 7461 6b65  x}{op_name}-take
+0001ca00: 2d6c 6173 7422 0a20 2020 2020 2020 2020  -last".         
+0001ca10: 2020 2063 756d 6c61 7374 203d 206d 6170     cumlast = map
+0001ca20: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+0001ca30: 2020 2020 2020 2020 2020 2020 205f 7461               _ta
+0001ca40: 6b65 5f6c 6173 742c 0a20 2020 2020 2020  ke_last,.       
+0001ca50: 2020 2020 2020 2020 2063 756d 7061 7274           cumpart
+0001ca60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001ca70: 2020 736b 6970 6e61 2c0a 2020 2020 2020    skipna,.      
+0001ca80: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
+0001ca90: 6574 615f 7365 7269 6573 5f63 6f6e 7374  eta_series_const
+0001caa0: 7275 6374 6f72 2873 656c 6629 285b 5d2c  ructor(self)([],
+0001cab0: 2064 7479 7065 3d22 666c 6f61 7422 292c   dtype="float"),
+0001cac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cad0: 2074 6f6b 656e 3d6e 616d 6532 2c0a 2020   token=name2,.  
+0001cae0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0001caf0: 2020 2020 2020 2020 2073 7566 6669 7820           suffix 
+0001cb00: 3d20 746f 6b65 6e69 7a65 2873 656c 6629  = tokenize(self)
+0001cb10: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+0001cb20: 6520 3d20 6622 7b73 656c 662e 5f74 6f6b  e = f"{self._tok
+0001cb30: 656e 5f70 7265 6669 787d 7b6f 705f 6e61  en_prefix}{op_na
+0001cb40: 6d65 7d2d 7b73 7566 6669 787d 220a 2020  me}-{suffix}".  
+0001cb50: 2020 2020 2020 2020 2020 636e 616d 6520            cname 
+0001cb60: 3d20 6622 7b73 656c 662e 5f74 6f6b 656e  = f"{self._token
+0001cb70: 5f70 7265 6669 787d 7b6f 705f 6e61 6d65  _prefix}{op_name
+0001cb80: 7d2d 6375 6d2d 6c61 7374 2d7b 7375 6666  }-cum-last-{suff
+0001cb90: 6978 7d22 0a0a 2020 2020 2020 2020 2020  ix}"..          
+0001cba0: 2020 2320 6167 6772 6567 6174 6520 6375    # aggregate cu
+0001cbb0: 6d75 6c61 7465 6420 7061 7274 6973 696f  mulated partisio
+0001cbc0: 6e73 2061 6e64 2069 7473 2070 7265 7669  ns and its previ
+0001cbd0: 6f75 7320 6c61 7374 2065 6c65 6d65 6e74  ous last element
+0001cbe0: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
+0001cbf0: 6572 203d 207b 7d0a 2020 2020 2020 2020  er = {}.        
+0001cc00: 2020 2020 6c61 7965 725b 286e 616d 652c      layer[(name,
+0001cc10: 2030 295d 203d 2028 6375 6d70 6172 742e   0)] = (cumpart.
+0001cc20: 5f6e 616d 652c 2030 290a 0a20 2020 2020  _name, 0)..     
+0001cc30: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0001cc40: 7261 6e67 6528 312c 2073 656c 662e 6e70  range(1, self.np
+0001cc50: 6172 7469 7469 6f6e 7329 3a0a 2020 2020  artitions):.    
+0001cc60: 2020 2020 2020 2020 2020 2020 2320 7374              # st
+0001cc70: 6f72 6520 6561 6368 2063 756d 756c 6174  ore each cumulat
+0001cc80: 6976 6520 7374 6570 2074 6f20 6772 6170  ive step to grap
+0001cc90: 6820 746f 2072 6564 7563 6520 636f 6d70  h to reduce comp
+0001cca0: 7574 6174 696f 6e0a 2020 2020 2020 2020  utation.        
+0001ccb0: 2020 2020 2020 2020 6966 2069 203d 3d20          if i == 
+0001ccc0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+0001ccd0: 2020 2020 2020 206c 6179 6572 5b28 636e         layer[(cn
+0001cce0: 616d 652c 2069 295d 203d 2028 6375 6d6c  ame, i)] = (cuml
+0001ccf0: 6173 742e 5f6e 616d 652c 2069 202d 2031  ast._name, i - 1
+0001cd00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001cd10: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001cd20: 2020 2020 2020 2020 2020 2020 2320 6167              # ag
+0001cd30: 6772 6567 6174 6520 7769 7468 2070 7265  gregate with pre
+0001cd40: 7669 6f75 7320 6375 6d75 6c61 7469 6f6e  vious cumulation
+0001cd50: 2072 6573 756c 7473 0a20 2020 2020 2020   results.       
+0001cd60: 2020 2020 2020 2020 2020 2020 206c 6179               lay
+0001cd70: 6572 5b28 636e 616d 652c 2069 295d 203d  er[(cname, i)] =
+0001cd80: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+0001cd90: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+0001cda0: 6473 2e5f 6375 6d5f 6167 6772 6567 6174  ds._cum_aggregat
+0001cdb0: 655f 6170 706c 792c 0a20 2020 2020 2020  e_apply,.       
+0001cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cdd0: 2061 6767 7265 6761 7465 2c0a 2020 2020   aggregate,.    
+0001cde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cdf0: 2020 2020 2863 6e61 6d65 2c20 6920 2d20      (cname, i - 
+0001ce00: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+0001ce10: 2020 2020 2020 2020 2020 2020 2863 756d              (cum
+0001ce20: 6c61 7374 2e5f 6e61 6d65 2c20 6920 2d20  last._name, i - 
+0001ce30: 3129 2c0a 2020 2020 2020 2020 2020 2020  1),.            
+0001ce40: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001ce50: 2020 2020 2020 2020 2020 6c61 7965 725b            layer[
+0001ce60: 286e 616d 652c 2069 295d 203d 2028 6167  (name, i)] = (ag
+0001ce70: 6772 6567 6174 652c 2028 6375 6d70 6172  gregate, (cumpar
+0001ce80: 742e 5f6e 616d 652c 2069 292c 2028 636e  t._name, i), (cn
+0001ce90: 616d 652c 2069 2929 0a20 2020 2020 2020  ame, i)).       
+0001cea0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+0001ceb0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+0001cec0: 5f63 6f6c 6c65 6374 696f 6e73 280a 2020  _collections(.  
+0001ced0: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+0001cee0: 6d65 2c20 6c61 7965 722c 2064 6570 656e  me, layer, depen
+0001cef0: 6465 6e63 6965 733d 5b63 756d 7061 7274  dencies=[cumpart
+0001cf00: 2c20 6375 6d6c 6173 745d 0a20 2020 2020  , cumlast].     
+0001cf10: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001cf20: 2020 2020 2072 6573 756c 7420 3d20 6e65       result = ne
+0001cf30: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
+0001cf40: 682c 206e 616d 652c 2063 6875 6e6b 2873  h, name, chunk(s
+0001cf50: 656c 662e 5f6d 6574 6129 2c20 7365 6c66  elf._meta), self
+0001cf60: 2e64 6976 6973 696f 6e73 290a 2020 2020  .divisions).    
+0001cf70: 2020 2020 2020 2020 7265 7475 726e 2068          return h
+0001cf80: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
+0001cf90: 6573 756c 7429 0a0a 2020 2020 4064 6572  esult)..    @der
+0001cfa0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0001cfb0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+0001cfc0: 6375 6d73 756d 2873 656c 662c 2061 7869  cumsum(self, axi
+0001cfd0: 733d 4e6f 6e65 2c20 736b 6970 6e61 3d54  s=None, skipna=T
+0001cfe0: 7275 652c 2064 7479 7065 3d4e 6f6e 652c  rue, dtype=None,
+0001cff0: 206f 7574 3d4e 6f6e 6529 3a0a 2020 2020   out=None):.    
+0001d000: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001d010: 5f63 756d 5f61 6767 280a 2020 2020 2020  _cum_agg(.      
+0001d020: 2020 2020 2020 2263 756d 7375 6d22 2c0a        "cumsum",.
+0001d030: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+0001d040: 6b3d 4d2e 6375 6d73 756d 2c0a 2020 2020  k=M.cumsum,.    
+0001d050: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+0001d060: 653d 6d65 7468 6f64 732e 6375 6d73 756d  e=methods.cumsum
+0001d070: 5f61 6767 7265 6761 7465 2c0a 2020 2020  _aggregate,.    
+0001d080: 2020 2020 2020 2020 6178 6973 3d61 7869          axis=axi
+0001d090: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
+0001d0a0: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
+0001d0b0: 2020 2020 2020 2020 2020 6368 756e 6b5f            chunk_
+0001d0c0: 6b77 6172 6773 3d64 6963 7428 6178 6973  kwargs=dict(axis
+0001d0d0: 3d61 7869 732c 2073 6b69 706e 613d 736b  =axis, skipna=sk
+0001d0e0: 6970 6e61 292c 0a20 2020 2020 2020 2020  ipna),.         
+0001d0f0: 2020 206f 7574 3d6f 7574 2c0a 2020 2020     out=out,.    
+0001d100: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
+0001d110: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0001d120: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
+0001d130: 756d 7072 6f64 2873 656c 662c 2061 7869  umprod(self, axi
+0001d140: 733d 4e6f 6e65 2c20 736b 6970 6e61 3d54  s=None, skipna=T
+0001d150: 7275 652c 2064 7479 7065 3d4e 6f6e 652c  rue, dtype=None,
+0001d160: 206f 7574 3d4e 6f6e 6529 3a0a 2020 2020   out=None):.    
+0001d170: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001d180: 5f63 756d 5f61 6767 280a 2020 2020 2020  _cum_agg(.      
+0001d190: 2020 2020 2020 2263 756d 7072 6f64 222c        "cumprod",
+0001d1a0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+0001d1b0: 6e6b 3d4d 2e63 756d 7072 6f64 2c0a 2020  nk=M.cumprod,.  
+0001d1c0: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
+0001d1d0: 6174 653d 6d65 7468 6f64 732e 6375 6d70  ate=methods.cump
+0001d1e0: 726f 645f 6167 6772 6567 6174 652c 0a20  rod_aggregate,. 
+0001d1f0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+0001d200: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+0001d210: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+0001d220: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+0001d230: 6e6b 5f6b 7761 7267 733d 6469 6374 2861  nk_kwargs=dict(a
+0001d240: 7869 733d 6178 6973 2c20 736b 6970 6e61  xis=axis, skipna
+0001d250: 3d73 6b69 706e 6129 2c0a 2020 2020 2020  =skipna),.      
+0001d260: 2020 2020 2020 6f75 743d 6f75 742c 0a20        out=out,. 
+0001d270: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+0001d280: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0001d290: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0001d2a0: 6620 6375 6d6d 6178 2873 656c 662c 2061  f cummax(self, a
+0001d2b0: 7869 733d 4e6f 6e65 2c20 736b 6970 6e61  xis=None, skipna
+0001d2c0: 3d54 7275 652c 206f 7574 3d4e 6f6e 6529  =True, out=None)
+0001d2d0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001d2e0: 2073 656c 662e 5f63 756d 5f61 6767 280a   self._cum_agg(.
+0001d2f0: 2020 2020 2020 2020 2020 2020 2263 756d              "cum
+0001d300: 6d61 7822 2c0a 2020 2020 2020 2020 2020  max",.          
+0001d310: 2020 6368 756e 6b3d 4d2e 6375 6d6d 6178    chunk=M.cummax
+0001d320: 2c0a 2020 2020 2020 2020 2020 2020 6167  ,.            ag
+0001d330: 6772 6567 6174 653d 6d65 7468 6f64 732e  gregate=methods.
+0001d340: 6375 6d6d 6178 5f61 6767 7265 6761 7465  cummax_aggregate
+0001d350: 2c0a 2020 2020 2020 2020 2020 2020 6178  ,.            ax
+0001d360: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+0001d370: 2020 2020 2073 6b69 706e 613d 736b 6970       skipna=skip
+0001d380: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
+0001d390: 6368 756e 6b5f 6b77 6172 6773 3d64 6963  chunk_kwargs=dic
+0001d3a0: 7428 6178 6973 3d61 7869 732c 2073 6b69  t(axis=axis, ski
+0001d3b0: 706e 613d 736b 6970 6e61 292c 0a20 2020  pna=skipna),.   
+0001d3c0: 2020 2020 2020 2020 206f 7574 3d6f 7574           out=out
+0001d3d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0001d3e0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+0001d3f0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+0001d400: 2064 6566 2063 756d 6d69 6e28 7365 6c66   def cummin(self
+0001d410: 2c20 6178 6973 3d4e 6f6e 652c 2073 6b69  , axis=None, ski
+0001d420: 706e 613d 5472 7565 2c20 6f75 743d 4e6f  pna=True, out=No
+0001d430: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
+0001d440: 7572 6e20 7365 6c66 2e5f 6375 6d5f 6167  urn self._cum_ag
+0001d450: 6728 0a20 2020 2020 2020 2020 2020 2022  g(.            "
+0001d460: 6375 6d6d 696e 222c 0a20 2020 2020 2020  cummin",.       
+0001d470: 2020 2020 2063 6875 6e6b 3d4d 2e63 756d       chunk=M.cum
+0001d480: 6d69 6e2c 0a20 2020 2020 2020 2020 2020  min,.           
+0001d490: 2061 6767 7265 6761 7465 3d6d 6574 686f   aggregate=metho
+0001d4a0: 6473 2e63 756d 6d69 6e5f 6167 6772 6567  ds.cummin_aggreg
+0001d4b0: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+0001d4c0: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
+0001d4d0: 2020 2020 2020 2020 736b 6970 6e61 3d73          skipna=s
+0001d4e0: 6b69 706e 612c 0a20 2020 2020 2020 2020  kipna,.         
+0001d4f0: 2020 2063 6875 6e6b 5f6b 7761 7267 733d     chunk_kwargs=
+0001d500: 6469 6374 2861 7869 733d 6178 6973 2c20  dict(axis=axis, 
+0001d510: 736b 6970 6e61 3d73 6b69 706e 6129 2c0a  skipna=skipna),.
+0001d520: 2020 2020 2020 2020 2020 2020 6f75 743d              out=
+0001d530: 6f75 742c 0a20 2020 2020 2020 2029 0a0a  out,.        )..
+0001d540: 2020 2020 6465 6620 5f76 616c 6964 6174      def _validat
+0001d550: 655f 636f 6e64 6974 696f 6e28 7365 6c66  e_condition(self
+0001d560: 2c20 636f 6e64 293a 0a20 2020 2020 2020  , cond):.       
+0001d570: 2069 6620 6e6f 7420 280a 2020 2020 2020   if not (.      
+0001d580: 2020 2020 2020 6973 5f64 6173 6b5f 636f        is_dask_co
+0001d590: 6c6c 6563 7469 6f6e 2863 6f6e 6429 0a20  llection(cond). 
+0001d5a0: 2020 2020 2020 2020 2020 206f 7220 6973             or is
+0001d5b0: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
+0001d5c0: 636f 6e64 290a 2020 2020 2020 2020 2020  cond).          
+0001d5d0: 2020 6f72 2069 735f 7365 7269 6573 5f6c    or is_series_l
+0001d5e0: 696b 6528 636f 6e64 290a 2020 2020 2020  ike(cond).      
+0001d5f0: 2020 2020 2020 6f72 2069 735f 696e 6465        or is_inde
+0001d600: 785f 6c69 6b65 2863 6f6e 6429 0a20 2020  x_like(cond).   
+0001d610: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+0001d620: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001d630: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0001d640: 2020 2020 2020 6622 436f 6e64 6974 696f        f"Conditio
+0001d650: 6e20 7368 6f75 6c64 2062 6520 616e 206f  n should be an o
+0001d660: 626a 6563 7420 7468 6174 2063 616e 2062  bject that can b
+0001d670: 6520 616c 6967 6e65 6420 7769 7468 207b  e aligned with {
+0001d680: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 7d2c  self.__class__},
+0001d690: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0001d6a0: 2020 2066 2220 7768 6963 6820 696e 636c     f" which incl
+0001d6b0: 7564 6573 2044 6173 6b20 6f72 2070 616e  udes Dask or pan
+0001d6c0: 6461 7320 636f 6c6c 6563 7469 6f6e 732c  das collections,
+0001d6d0: 2044 6174 6146 7261 6d65 7320 6f72 2053   DataFrames or S
+0001d6e0: 6572 6965 732e 220a 2020 2020 2020 2020  eries.".        
+0001d6f0: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
+0001d700: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0001d710: 4672 616d 6529 0a20 2020 2064 6566 2077  Frame).    def w
+0001d720: 6865 7265 2873 656c 662c 2063 6f6e 642c  here(self, cond,
+0001d730: 206f 7468 6572 3d6e 702e 6e61 6e29 3a0a   other=np.nan):.
+0001d740: 2020 2020 2020 2020 2320 636f 6e64 2061          # cond a
+0001d750: 6e64 206f 7468 6572 206d 6179 2062 6520  nd other may be 
+0001d760: 6461 736b 2069 6e73 7461 6e63 652c 0a20  dask instance,. 
+0001d770: 2020 2020 2020 2023 2070 6173 7369 6e67         # passing
+0001d780: 206d 6170 5f70 6172 7469 7469 6f6e 7320   map_partitions 
+0001d790: 7669 6120 6b65 7977 6f72 6420 7769 6c6c  via keyword will
+0001d7a0: 206e 6f74 2062 6520 616c 6967 6e65 640a   not be aligned.
+0001d7b0: 2020 2020 2020 2020 7365 6c66 2e5f 7661          self._va
+0001d7c0: 6c69 6461 7465 5f63 6f6e 6469 7469 6f6e  lidate_condition
+0001d7d0: 2863 6f6e 6429 0a20 2020 2020 2020 2072  (cond).        r
+0001d7e0: 6574 7572 6e20 6d61 705f 7061 7274 6974  eturn map_partit
+0001d7f0: 696f 6e73 284d 2e77 6865 7265 2c20 7365  ions(M.where, se
+0001d800: 6c66 2c20 636f 6e64 2c20 6f74 6865 722c  lf, cond, other,
+0001d810: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+0001d820: 613d 4661 6c73 6529 0a0a 2020 2020 4064  a=False)..    @d
+0001d830: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0001d840: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0001d850: 6620 6d61 736b 2873 656c 662c 2063 6f6e  f mask(self, con
+0001d860: 642c 206f 7468 6572 3d6e 702e 6e61 6e29  d, other=np.nan)
+0001d870: 3a0a 2020 2020 2020 2020 7365 6c66 2e5f  :.        self._
+0001d880: 7661 6c69 6461 7465 5f63 6f6e 6469 7469  validate_conditi
+0001d890: 6f6e 2863 6f6e 6429 0a20 2020 2020 2020  on(cond).       
+0001d8a0: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
+0001d8b0: 6974 696f 6e73 284d 2e6d 6173 6b2c 2073  itions(M.mask, s
+0001d8c0: 656c 662c 2063 6f6e 642c 206f 7468 6572  elf, cond, other
+0001d8d0: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
+0001d8e0: 7461 3d46 616c 7365 290a 0a20 2020 2040  ta=False)..    @
+0001d8f0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0001d900: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0001d910: 6566 206e 6f74 6e75 6c6c 2873 656c 6629  ef notnull(self)
+0001d920: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001d930: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+0001d940: 696f 6e73 284d 2e6e 6f74 6e75 6c6c 2c20  ions(M.notnull, 
+0001d950: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+0001d960: 3d46 616c 7365 290a 0a20 2020 2040 6465  =False)..    @de
+0001d970: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0001d980: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0001d990: 2069 736e 756c 6c28 7365 6c66 293a 0a20   isnull(self):. 
+0001d9a0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001d9b0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+0001d9c0: 7328 4d2e 6973 6e75 6c6c 2c20 656e 666f  s(M.isnull, enfo
+0001d9d0: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
+0001d9e0: 7365 290a 0a20 2020 2040 6465 7269 7665  se)..    @derive
+0001d9f0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0001da00: 616d 6529 0a20 2020 2064 6566 2069 736e  ame).    def isn
+0001da10: 6128 7365 6c66 293a 0a20 2020 2020 2020  a(self):.       
+0001da20: 2069 6620 6861 7361 7474 7228 7064 2c20   if hasattr(pd, 
+0001da30: 2269 736e 6122 293a 0a20 2020 2020 2020  "isna"):.       
+0001da40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001da50: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+0001da60: 4d2e 6973 6e61 2c20 656e 666f 7263 655f  M.isna, enforce_
+0001da70: 6d65 7461 6461 7461 3d46 616c 7365 290a  metadata=False).
+0001da80: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001da90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001daa0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+0001dab0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0001dac0: 2020 2020 2022 4e65 6564 206d 6f72 6520       "Need more 
+0001dad0: 7265 6365 6e74 2076 6572 7369 6f6e 206f  recent version o
+0001dae0: 6620 5061 6e64 6173 2022 0a20 2020 2020  f Pandas ".     
+0001daf0: 2020 2020 2020 2020 2020 2022 746f 2073             "to s
+0001db00: 7570 706f 7274 2069 736e 612e 2022 0a20  upport isna. ". 
+0001db10: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001db20: 506c 6561 7365 2075 7365 2069 736e 756c  Please use isnul
+0001db30: 6c20 696e 7374 6561 642e 220a 2020 2020  l instead.".    
+0001db40: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+0001db50: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0001db60: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0001db70: 6566 2069 7369 6e28 7365 6c66 2c20 7661  ef isin(self, va
+0001db80: 6c75 6573 293a 0a20 2020 2020 2020 2069  lues):.        i
+0001db90: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
+0001dba0: 696b 6528 7365 6c66 2e5f 6d65 7461 293a  ike(self._meta):
+0001dbb0: 0a20 2020 2020 2020 2020 2020 2023 2044  .            # D
+0001dbc0: 6174 6146 7261 6d65 2e69 7369 6e20 646f  ataFrame.isin do
+0001dbd0: 6573 2077 6569 7264 2061 6c69 676e 6d65  es weird alignme
+0001dbe0: 6e74 2073 7475 6666 0a20 2020 2020 2020  nt stuff.       
+0001dbf0: 2020 2020 2062 6164 5f74 7970 6573 203d       bad_types =
+0001dc00: 2028 5f46 7261 6d65 2c20 7064 2e53 6572   (_Frame, pd.Ser
+0001dc10: 6965 732c 2070 642e 4461 7461 4672 616d  ies, pd.DataFram
+0001dc20: 6529 0a20 2020 2020 2020 2065 6c73 653a  e).        else:
+0001dc30: 0a20 2020 2020 2020 2020 2020 2062 6164  .            bad
+0001dc40: 5f74 7970 6573 203d 2028 5f46 7261 6d65  _types = (_Frame
+0001dc50: 2c29 0a20 2020 2020 2020 2069 6620 6973  ,).        if is
+0001dc60: 696e 7374 616e 6365 2876 616c 7565 732c  instance(values,
+0001dc70: 2062 6164 5f74 7970 6573 293a 0a20 2020   bad_types):.   
+0001dc80: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+0001dc90: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0001dca0: 6f72 2822 5061 7373 696e 6720 6120 2572  or("Passing a %r
+0001dcb0: 2074 6f20 6069 7369 6e60 2220 2520 7479   to `isin`" % ty
+0001dcc0: 7065 6e61 6d65 2874 7970 6528 7661 6c75  pename(type(valu
+0001dcd0: 6573 2929 290a 2020 2020 2020 2020 6d65  es))).        me
+0001dce0: 7461 203d 2073 656c 662e 5f6d 6574 615f  ta = self._meta_
+0001dcf0: 6e6f 6e65 6d70 7479 2e69 7369 6e28 7661  nonempty.isin(va
+0001dd00: 6c75 6573 290a 2020 2020 2020 2020 2320  lues).        # 
+0001dd10: 5765 2077 7261 7020 7661 6c75 6573 2069  We wrap values i
+0001dd20: 6e20 6120 6465 6c61 7965 6420 666f 7220  n a delayed for 
+0001dd30: 7477 6f20 7265 6173 6f6e 733a 0a20 2020  two reasons:.   
+0001dd40: 2020 2020 2023 202d 2061 766f 6964 2073       # - avoid s
+0001dd50: 6572 6961 6c69 7a69 6e67 2064 6174 6120  erializing data 
+0001dd60: 696e 2065 7665 7279 2074 6173 6b0a 2020  in every task.  
+0001dd70: 2020 2020 2020 2320 2d20 6176 6f69 6420        # - avoid 
+0001dd80: 636f 7374 206f 6620 7472 6176 6572 7361  cost of traversa
+0001dd90: 6c20 6f66 206c 6172 6765 206c 6973 7420  l of large list 
+0001dda0: 696e 206f 7074 696d 697a 6174 696f 6e73  in optimizations
 0001ddb0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0001ddc0: 7374 616e 6365 2876 616c 7565 732c 2062  stance(values, b
-0001ddd0: 6164 5f74 7970 6573 293a 0a20 2020 2020  ad_types):.     
-0001dde0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0001ddf0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0001de00: 2822 5061 7373 696e 6720 6120 2572 2074  ("Passing a %r t
-0001de10: 6f20 6069 7369 6e60 2220 2520 7479 7065  o `isin`" % type
-0001de20: 6e61 6d65 2874 7970 6528 7661 6c75 6573  name(type(values
-0001de30: 2929 290a 2020 2020 2020 2020 6d65 7461  ))).        meta
-0001de40: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
-0001de50: 6e65 6d70 7479 2e69 7369 6e28 7661 6c75  nempty.isin(valu
-0001de60: 6573 290a 2020 2020 2020 2020 2320 5765  es).        # We
-0001de70: 2077 7261 7020 7661 6c75 6573 2069 6e20   wrap values in 
-0001de80: 6120 6465 6c61 7965 6420 666f 7220 7477  a delayed for tw
-0001de90: 6f20 7265 6173 6f6e 733a 0a20 2020 2020  o reasons:.     
-0001dea0: 2020 2023 202d 2061 766f 6964 2073 6572     # - avoid ser
-0001deb0: 6961 6c69 7a69 6e67 2064 6174 6120 696e  ializing data in
-0001dec0: 2065 7665 7279 2074 6173 6b0a 2020 2020   every task.    
-0001ded0: 2020 2020 2320 2d20 6176 6f69 6420 636f      # - avoid co
-0001dee0: 7374 206f 6620 7472 6176 6572 7361 6c20  st of traversal 
-0001def0: 6f66 206c 6172 6765 206c 6973 7420 696e  of large list in
-0001df00: 206f 7074 696d 697a 6174 696f 6e73 0a20   optimizations. 
-0001df10: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001df20: 616e 6365 2876 616c 7565 732c 206c 6973  ance(values, lis
-0001df30: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-0001df40: 2320 4d6f 7469 7661 7465 6420 6279 2068  # Motivated by h
-0001df50: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-0001df60: 6d2f 6461 736b 2f64 6173 6b2f 6973 7375  m/dask/dask/issu
-0001df70: 6573 2f39 3431 312e 2020 5468 6973 2061  es/9411.  This a
-0001df80: 7070 6561 7273 2074 6f20 6265 0a20 2020  ppears to be.   
-0001df90: 2020 2020 2020 2020 2023 2063 6175 7365           # cause
-0001dfa0: 6420 6279 2068 7474 7073 3a2f 2f67 6974  d by https://git
-0001dfb0: 6875 622e 636f 6d2f 6461 736b 2f64 6973  hub.com/dask/dis
-0001dfc0: 7472 6962 7574 6564 2f69 7373 7565 732f  tributed/issues/
-0001dfd0: 3633 3638 2c20 616e 6420 6675 7274 6865  6368, and furthe
-0001dfe0: 720a 2020 2020 2020 2020 2020 2020 2320  r.            # 
-0001dff0: 6578 6163 6572 6261 7465 6420 6279 2074  exacerbated by t
-0001e000: 6865 2066 6163 7420 7468 6174 2074 6865  he fact that the
-0001e010: 206c 6973 7420 636f 6e74 6169 6e73 2064   list contains d
-0001e020: 7570 6c69 6361 7465 732e 2020 5468 6973  uplicates.  This
-0001e030: 2069 7320 6120 7061 7463 6820 756e 7469   is a patch unti
-0001e040: 6c0a 2020 2020 2020 2020 2020 2020 2320  l.            # 
-0001e050: 7765 2063 616e 2063 7265 6174 6520 6120  we can create a 
-0001e060: 6265 7474 6572 2066 6978 2066 6f72 2053  better fix for S
-0001e070: 6572 6961 6c69 7a61 7469 6f6e 2e0a 2020  erialization..  
-0001e080: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
-0001e090: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0001e0a0: 616c 7565 7320 3d20 6c69 7374 2873 6574  alues = list(set
-0001e0b0: 2876 616c 7565 7329 290a 2020 2020 2020  (values)).      
-0001e0c0: 2020 2020 2020 6578 6365 7074 2054 7970        except Typ
-0001e0d0: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
-0001e0e0: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
-0001e0f0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0001e100: 616e 7928 6973 5f64 6173 6b5f 636f 6c6c  any(is_dask_coll
-0001e110: 6563 7469 6f6e 2876 2920 666f 7220 7620  ection(v) for v 
-0001e120: 696e 2076 616c 7565 7329 3a0a 2020 2020  in values):.    
-0001e130: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-0001e140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e150: 2020 2020 2076 616c 7565 7320 3d20 6e70       values = np
-0001e160: 2e66 726f 6d69 7465 7228 7661 6c75 6573  .fromiter(values
-0001e170: 2c20 6474 7970 653d 6f62 6a65 6374 290a  , dtype=object).
-0001e180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e190: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
-0001e1a0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-0001e1b0: 2020 2020 2020 2023 204e 756d 7079 2031         # Numpy 1
-0001e1c0: 2e32 3320 7375 7070 6f72 7473 2063 7265  .23 supports cre
-0001e1d0: 6174 696e 6720 6172 7261 7973 206f 6620  ating arrays of 
-0001e1e0: 6974 6572 6162 6c65 732c 2077 6869 6c65  iterables, while
-0001e1f0: 206c 6f77 6572 0a20 2020 2020 2020 2020   lower.         
-0001e200: 2020 2020 2020 2020 2020 2023 2076 6572             # ver
-0001e210: 7369 6f6e 2031 2e32 312e 7820 616e 6420  sion 1.21.x and 
-0001e220: 312e 3232 2e78 2064 6f20 6e6f 740a 2020  1.22.x do not.  
-0001e230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e240: 2020 7061 7373 0a20 2020 2020 2020 2072    pass.        r
-0001e250: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-0001e260: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-0001e270: 2020 2020 2020 204d 2e69 7369 6e2c 2064         M.isin, d
-0001e280: 656c 6179 6564 2876 616c 7565 7329 2c20  elayed(values), 
-0001e290: 6d65 7461 3d6d 6574 612c 2065 6e66 6f72  meta=meta, enfor
-0001e2a0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-0001e2b0: 650a 2020 2020 2020 2020 290a 0a20 2020  e.        )..   
-0001e2c0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0001e2d0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0001e2e0: 2064 6566 2061 7374 7970 6528 7365 6c66   def astype(self
-0001e2f0: 2c20 6474 7970 6529 3a0a 2020 2020 2020  , dtype):.      
-0001e300: 2020 2320 5858 583a 2050 616e 6461 7320    # XXX: Pandas 
-0001e310: 7769 6c6c 2073 6567 6661 756c 7420 666f  will segfault fo
-0001e320: 7220 656d 7074 7920 6461 7461 6672 616d  r empty datafram
-0001e330: 6573 2077 6865 6e20 7365 7474 696e 670a  es when setting.
-0001e340: 2020 2020 2020 2020 2320 6361 7465 676f          # catego
-0001e350: 7269 6361 6c20 6474 7970 6573 2e20 5468  rical dtypes. Th
-0001e360: 6973 206f 7065 7261 7469 6f6e 2069 736e  is operation isn
-0001e370: 2774 2061 6c6c 6f77 6564 2063 7572 7265  't allowed curre
-0001e380: 6e74 6c79 2061 6e79 7761 792e 2057 650a  ntly anyway. We.
-0001e390: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
-0001e3a0: 6520 6d65 7461 6461 7461 2077 6974 6820  e metadata with 
-0001e3b0: 6120 6e6f 6e2d 656d 7074 7920 6672 616d  a non-empty fram
-0001e3c0: 6520 746f 2074 6872 6f77 2074 6865 2065  e to throw the e
-0001e3d0: 7272 6f72 2069 6e73 7465 6164 206f 660a  rror instead of.
-0001e3e0: 2020 2020 2020 2020 2320 7365 6766 6175          # segfau
-0001e3f0: 6c74 696e 672e 0a20 2020 2020 2020 2069  lting..        i
-0001e400: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-0001e410: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-0001e420: 6528 7365 6c66 2e5f 6d65 7461 290a 2020  e(self._meta).  
-0001e430: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
-0001e440: 7420 6861 7361 7474 7228 6474 7970 652c  t hasattr(dtype,
-0001e450: 2022 6974 656d 7322 290a 2020 2020 2020   "items").      
-0001e460: 2020 2020 2020 616e 6420 6973 696e 7374        and isinst
-0001e470: 616e 6365 2870 642e 6170 692e 7479 7065  ance(pd.api.type
-0001e480: 732e 7061 6e64 6173 5f64 7479 7065 2864  s.pandas_dtype(d
-0001e490: 7479 7065 292c 2070 642e 4361 7465 676f  type), pd.Catego
-0001e4a0: 7269 6361 6c44 7479 7065 290a 2020 2020  ricalDtype).    
-0001e4b0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-0001e4c0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
-0001e4d0: 6d65 7461 5f6e 6f6e 656d 7074 792e 6173  meta_nonempty.as
-0001e4e0: 7479 7065 2864 7479 7065 290a 2020 2020  type(dtype).    
-0001e4f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001e500: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
-0001e510: 662e 5f6d 6574 612e 6173 7479 7065 2864  f._meta.astype(d
-0001e520: 7479 7065 290a 2020 2020 2020 2020 6966  type).        if
-0001e530: 2068 6173 6174 7472 2864 7479 7065 2c20   hasattr(dtype, 
-0001e540: 2269 7465 6d73 2229 3a0a 2020 2020 2020  "items"):.      
-0001e550: 2020 2020 2020 7365 745f 756e 6b6e 6f77        set_unknow
-0001e560: 6e20 3d20 5b0a 2020 2020 2020 2020 2020  n = [.          
-0001e570: 2020 2020 2020 6b0a 2020 2020 2020 2020        k.        
-0001e580: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
-0001e590: 2069 6e20 6474 7970 652e 6974 656d 7328   in dtype.items(
-0001e5a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001e5b0: 2020 6966 2028 6973 696e 7374 616e 6365    if (isinstance
-0001e5c0: 2870 642e 6170 692e 7479 7065 732e 7061  (pd.api.types.pa
-0001e5d0: 6e64 6173 5f64 7479 7065 2876 292c 2070  ndas_dtype(v), p
-0001e5e0: 642e 4361 7465 676f 7269 6361 6c44 7479  d.CategoricalDty
-0001e5f0: 7065 2929 0a20 2020 2020 2020 2020 2020  pe)).           
-0001e600: 2020 2020 2061 6e64 2067 6574 6174 7472       and getattr
-0001e610: 2876 2c20 2263 6174 6567 6f72 6965 7322  (v, "categories"
-0001e620: 2c20 4e6f 6e65 2920 6973 204e 6f6e 650a  , None) is None.
-0001e630: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-0001e640: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
-0001e650: 2063 6c65 6172 5f6b 6e6f 776e 5f63 6174   clear_known_cat
-0001e660: 6567 6f72 6965 7328 6d65 7461 2c20 636f  egories(meta, co
-0001e670: 6c73 3d73 6574 5f75 6e6b 6e6f 776e 290a  ls=set_unknown).
-0001e680: 2020 2020 2020 2020 656c 6966 2028 0a20          elif (. 
-0001e690: 2020 2020 2020 2020 2020 2069 7369 6e73             isins
-0001e6a0: 7461 6e63 6528 7064 2e61 7069 2e74 7970  tance(pd.api.typ
-0001e6b0: 6573 2e70 616e 6461 735f 6474 7970 6528  es.pandas_dtype(
-0001e6c0: 6474 7970 6529 2c20 7064 2e43 6174 6567  dtype), pd.Categ
-0001e6d0: 6f72 6963 616c 4474 7970 6529 0a20 2020  oricalDtype).   
-0001e6e0: 2020 2020 2029 2061 6e64 2067 6574 6174       ) and getat
-0001e6f0: 7472 2864 7479 7065 2c20 2263 6174 6567  tr(dtype, "categ
-0001e700: 6f72 6965 7322 2c20 4e6f 6e65 2920 6973  ories", None) is
-0001e710: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0001e720: 2020 206d 6574 6120 3d20 636c 6561 725f     meta = clear_
-0001e730: 6b6e 6f77 6e5f 6361 7465 676f 7269 6573  known_categories
-0001e740: 286d 6574 6129 0a20 2020 2020 2020 2072  (meta).        r
-0001e750: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-0001e760: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-0001e770: 2020 2020 2020 204d 2e61 7374 7970 652c         M.astype,
-0001e780: 2064 7479 7065 3d64 7479 7065 2c20 6d65   dtype=dtype, me
-0001e790: 7461 3d6d 6574 612c 2065 6e66 6f72 6365  ta=meta, enforce
-0001e7a0: 5f6d 6574 6164 6174 613d 4661 6c73 650a  _metadata=False.
-0001e7b0: 2020 2020 2020 2020 290a 0a20 2020 2069          )..    i
-0001e7c0: 6620 6e6f 7420 5041 4e44 4153 5f47 545f  f not PANDAS_GT_
-0001e7d0: 3230 303a 0a0a 2020 2020 2020 2020 4064  200:..        @d
-0001e7e0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-0001e7f0: 6572 6965 7329 0a20 2020 2020 2020 2064  eries).        d
-0001e800: 6566 2061 7070 656e 6428 7365 6c66 2c20  ef append(self, 
-0001e810: 6f74 6865 722c 2069 6e74 6572 6c65 6176  other, interleav
-0001e820: 655f 7061 7274 6974 696f 6e73 3d46 616c  e_partitions=Fal
-0001e830: 7365 293a 0a20 2020 2020 2020 2020 2020  se):.           
-0001e840: 2069 6620 5041 4e44 4153 5f47 545f 3134   if PANDAS_GT_14
-0001e850: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0001e860: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-0001e870: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001e880: 2020 2020 2020 2254 6865 2066 7261 6d65        "The frame
-0001e890: 2e61 7070 656e 6420 6d65 7468 6f64 2069  .append method i
-0001e8a0: 7320 6465 7072 6563 6174 6564 2061 6e64  s deprecated and
-0001e8b0: 2077 696c 6c20 6265 2072 656d 6f76 6564   will be removed
-0001e8c0: 2066 726f 6d22 0a20 2020 2020 2020 2020   from".         
-0001e8d0: 2020 2020 2020 2020 2020 2022 6461 736b             "dask
-0001e8e0: 2069 6e20 6120 6675 7475 7265 2076 6572   in a future ver
-0001e8f0: 7369 6f6e 2e20 5573 6520 6461 736b 2e64  sion. Use dask.d
-0001e900: 6174 6166 7261 6d65 2e63 6f6e 6361 7420  ataframe.concat 
-0001e910: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
-0001e920: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-0001e930: 7574 7572 6557 6172 6e69 6e67 2c0a 2020  utureWarning,.  
-0001e940: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0001e950: 2020 2020 2020 2020 2020 2020 2320 6265              # be
-0001e960: 6361 7573 6520 4461 7461 4672 616d 652e  cause DataFrame.
-0001e970: 6170 7065 6e64 2077 696c 6c20 6f76 6572  append will over
-0001e980: 7269 6465 2074 6865 206d 6574 686f 642c  ride the method,
-0001e990: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
-0001e9a0: 7261 7020 6279 2070 642e 5365 7269 6573  rap by pd.Series
-0001e9b0: 2e61 7070 656e 6420 646f 6373 7472 696e  .append docstrin
-0001e9c0: 670a 2020 2020 2020 2020 2020 2020 6672  g.            fr
-0001e9d0: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
-0001e9e0: 652e 6d75 6c74 6920 696d 706f 7274 2063  e.multi import c
-0001e9f0: 6f6e 6361 740a 0a20 2020 2020 2020 2020  oncat..         
-0001ea00: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0001ea10: 286f 7468 6572 2c20 286c 6973 742c 2064  (other, (list, d
-0001ea20: 6963 7429 293a 0a20 2020 2020 2020 2020  ict)):.         
-0001ea30: 2020 2020 2020 206d 7367 203d 2022 6170         msg = "ap
-0001ea40: 7065 6e64 2064 6f65 736e 2774 2073 7570  pend doesn't sup
-0001ea50: 706f 7274 206c 6973 7420 6f72 2064 6963  port list or dic
-0001ea60: 7420 696e 7075 7422 0a20 2020 2020 2020  t input".       
-0001ea70: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0001ea80: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0001ea90: 6f72 286d 7367 290a 0a20 2020 2020 2020  or(msg)..       
-0001eaa0: 2020 2020 2072 6574 7572 6e20 636f 6e63       return conc
-0001eab0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-0001eac0: 2020 2020 5b73 656c 662c 206f 7468 6572      [self, other
-0001ead0: 5d2c 206a 6f69 6e3d 226f 7574 6572 222c  ], join="outer",
-0001eae0: 2069 6e74 6572 6c65 6176 655f 7061 7274   interleave_part
-0001eaf0: 6974 696f 6e73 3d69 6e74 6572 6c65 6176  itions=interleav
-0001eb00: 655f 7061 7274 6974 696f 6e73 0a20 2020  e_partitions.   
-0001eb10: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0001eb20: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-0001eb30: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
-0001eb40: 2064 6f74 2873 656c 662c 206f 7468 6572   dot(self, other
-0001eb50: 2c20 6d65 7461 3d6e 6f5f 6465 6661 756c  , meta=no_defaul
-0001eb60: 7429 3a0a 2020 2020 2020 2020 6966 206e  t):.        if n
-0001eb70: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
-0001eb80: 6865 722c 205f 4672 616d 6529 3a0a 2020  her, _Frame):.  
-0001eb90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001eba0: 5479 7065 4572 726f 7228 2254 6865 2073  TypeError("The s
-0001ebb0: 6563 6f6e 6420 6f70 6572 616e 6420 6d75  econd operand mu
-0001ebc0: 7374 2062 6520 6120 6461 736b 2061 7272  st be a dask arr
-0001ebd0: 6179 206f 7220 6461 736b 2064 6174 6166  ay or dask dataf
-0001ebe0: 7261 6d65 2229 0a0a 2020 2020 2020 2020  rame")..        
-0001ebf0: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
-0001ec00: 6865 722c 2044 6174 6146 7261 6d65 293a  her, DataFrame):
-0001ec10: 0a20 2020 2020 2020 2020 2020 2073 203d  .            s =
-0001ec20: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-0001ec30: 696f 6e73 284d 2e64 6f74 2c20 6f74 6865  ions(M.dot, othe
-0001ec40: 722c 2074 6f6b 656e 3d22 646f 7422 2c20  r, token="dot", 
-0001ec50: 6d65 7461 3d6d 6574 6129 0a20 2020 2020  meta=meta).     
-0001ec60: 2020 2020 2020 2072 6574 7572 6e20 732e         return s.
-0001ec70: 6772 6f75 7062 7928 6279 3d73 2e69 6e64  groupby(by=s.ind
-0001ec80: 6578 292e 6170 706c 7928 0a20 2020 2020  ex).apply(.     
-0001ec90: 2020 2020 2020 2020 2020 206c 616d 6264             lambd
-0001eca0: 6120 783a 2078 2e73 756d 2873 6b69 706e  a x: x.sum(skipn
-0001ecb0: 613d 4661 6c73 6529 2c20 6d65 7461 3d73  a=False), meta=s
-0001ecc0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 790a  ._meta_nonempty.
-0001ecd0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0001ece0: 2020 2020 2020 2064 6566 205f 646f 745f         def _dot_
-0001ecf0: 7365 7269 6573 282a 6172 6773 2c20 2a2a  series(*args, **
-0001ed00: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-0001ed10: 2020 2020 2023 202e 7375 6d28 2920 6973       # .sum() is
-0001ed20: 2069 6e76 6f6b 6564 206f 6e20 6561 6368   invoked on each
-0001ed30: 2070 6172 7469 7469 6f6e 2062 6566 6f72   partition befor
-0001ed40: 6520 6265 696e 6720 6170 706c 6965 6420  e being applied 
-0001ed50: 746f 2061 6c6c 0a20 2020 2020 2020 2020  to all.         
-0001ed60: 2020 2023 2070 6172 7469 7469 6f6e 732e     # partitions.
-0001ed70: 2054 6865 2072 6574 7572 6e20 7479 7065   The return type
-0001ed80: 2069 7320 6578 7065 6374 6564 2074 6f20   is expected to 
-0001ed90: 6265 2061 2073 6572 6965 732c 206e 6f74  be a series, not
-0001eda0: 2061 206e 756d 7079 206f 626a 6563 740a   a numpy object.
-0001edb0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001edc0: 726e 206d 6574 615f 7365 7269 6573 5f63  rn meta_series_c
-0001edd0: 6f6e 7374 7275 6374 6f72 2873 656c 6629  onstructor(self)
-0001ede0: 284d 2e64 6f74 282a 6172 6773 2c20 2a2a  (M.dot(*args, **
-0001edf0: 6b77 6172 6773 2929 0a0a 2020 2020 2020  kwargs))..      
-0001ee00: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-0001ee10: 705f 7061 7274 6974 696f 6e73 285f 646f  p_partitions(_do
-0001ee20: 745f 7365 7269 6573 2c20 6f74 6865 722c  t_series, other,
-0001ee30: 2074 6f6b 656e 3d22 646f 7422 2c20 6d65   token="dot", me
-0001ee40: 7461 3d6d 6574 6129 2e73 756d 280a 2020  ta=meta).sum(.  
-0001ee50: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
-0001ee60: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
-0001ee70: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0001ee80: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0001ee90: 290a 2020 2020 6465 6620 616c 6967 6e28  ).    def align(
-0001eea0: 7365 6c66 2c20 6f74 6865 722c 206a 6f69  self, other, joi
-0001eeb0: 6e3d 226f 7574 6572 222c 2061 7869 733d  n="outer", axis=
-0001eec0: 4e6f 6e65 2c20 6669 6c6c 5f76 616c 7565  None, fill_value
-0001eed0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-0001eee0: 6d65 7461 312c 206d 6574 6132 203d 205f  meta1, meta2 = _
-0001eef0: 656d 756c 6174 6528 0a20 2020 2020 2020  emulate(.       
-0001ef00: 2020 2020 204d 2e61 6c69 676e 2c20 7365       M.align, se
-0001ef10: 6c66 2c20 6f74 6865 722c 206a 6f69 6e2c  lf, other, join,
-0001ef20: 2061 7869 733d 6178 6973 2c20 6669 6c6c   axis=axis, fill
-0001ef30: 5f76 616c 7565 3d66 696c 6c5f 7661 6c75  _value=fill_valu
-0001ef40: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
-0001ef50: 2020 2020 616c 6967 6e65 6420 3d20 7365      aligned = se
-0001ef60: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-0001ef70: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
-0001ef80: 2e61 6c69 676e 2c0a 2020 2020 2020 2020  .align,.        
-0001ef90: 2020 2020 6f74 6865 722c 0a20 2020 2020      other,.     
-0001efa0: 2020 2020 2020 206a 6f69 6e3d 6a6f 696e         join=join
-0001efb0: 2c0a 2020 2020 2020 2020 2020 2020 6178  ,.            ax
-0001efc0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
-0001efd0: 2020 2020 2066 696c 6c5f 7661 6c75 653d       fill_value=
-0001efe0: 6669 6c6c 5f76 616c 7565 2c0a 2020 2020  fill_value,.    
-0001eff0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
-0001f000: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
-0001f010: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0001f020: 2020 2074 6f6b 656e 203d 2074 6f6b 656e     token = token
-0001f030: 697a 6528 7365 6c66 2c20 6f74 6865 722c  ize(self, other,
-0001f040: 206a 6f69 6e2c 2061 7869 732c 2066 696c   join, axis, fil
-0001f050: 6c5f 7661 6c75 6529 0a0a 2020 2020 2020  l_value)..      
-0001f060: 2020 6e61 6d65 3120 3d20 2261 6c69 676e    name1 = "align
-0001f070: 312d 2220 2b20 746f 6b65 6e0a 2020 2020  1-" + token.    
-0001f080: 2020 2020 6473 6b31 203d 207b 0a20 2020      dsk1 = {.   
-0001f090: 2020 2020 2020 2020 2028 6e61 6d65 312c           (name1,
-0001f0a0: 2069 293a 2028 6765 7469 7465 6d2c 206b   i): (getitem, k
-0001f0b0: 6579 2c20 3029 0a20 2020 2020 2020 2020  ey, 0).         
-0001f0c0: 2020 2066 6f72 2069 2c20 6b65 7920 696e     for i, key in
-0001f0d0: 2065 6e75 6d65 7261 7465 2861 6c69 676e   enumerate(align
-0001f0e0: 6564 2e5f 5f64 6173 6b5f 6b65 7973 5f5f  ed.__dask_keys__
-0001f0f0: 2829 290a 2020 2020 2020 2020 7d0a 2020  ()).        }.  
-0001f100: 2020 2020 2020 6473 6b31 2e75 7064 6174        dsk1.updat
-0001f110: 6528 616c 6967 6e65 642e 6461 736b 290a  e(aligned.dask).
-0001f120: 2020 2020 2020 2020 7265 7375 6c74 3120          result1 
-0001f130: 3d20 6e65 775f 6464 5f6f 626a 6563 7428  = new_dd_object(
-0001f140: 6473 6b31 2c20 6e61 6d65 312c 206d 6574  dsk1, name1, met
-0001f150: 6131 2c20 616c 6967 6e65 642e 6469 7669  a1, aligned.divi
-0001f160: 7369 6f6e 7329 0a0a 2020 2020 2020 2020  sions)..        
-0001f170: 6e61 6d65 3220 3d20 2261 6c69 676e 322d  name2 = "align2-
-0001f180: 2220 2b20 746f 6b65 6e0a 2020 2020 2020  " + token.      
-0001f190: 2020 6473 6b32 203d 207b 0a20 2020 2020    dsk2 = {.     
-0001f1a0: 2020 2020 2020 2028 6e61 6d65 322c 2069         (name2, i
-0001f1b0: 293a 2028 6765 7469 7465 6d2c 206b 6579  ): (getitem, key
-0001f1c0: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
-0001f1d0: 2066 6f72 2069 2c20 6b65 7920 696e 2065   for i, key in e
-0001f1e0: 6e75 6d65 7261 7465 2861 6c69 676e 6564  numerate(aligned
-0001f1f0: 2e5f 5f64 6173 6b5f 6b65 7973 5f5f 2829  .__dask_keys__()
-0001f200: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
-0001f210: 2020 2020 6473 6b32 2e75 7064 6174 6528      dsk2.update(
-0001f220: 616c 6967 6e65 642e 6461 736b 290a 2020  aligned.dask).  
-0001f230: 2020 2020 2020 7265 7375 6c74 3220 3d20        result2 = 
-0001f240: 6e65 775f 6464 5f6f 626a 6563 7428 6473  new_dd_object(ds
-0001f250: 6b32 2c20 6e61 6d65 322c 206d 6574 6132  k2, name2, meta2
-0001f260: 2c20 616c 6967 6e65 642e 6469 7669 7369  , aligned.divisi
-0001f270: 6f6e 7329 0a0a 2020 2020 2020 2020 7265  ons)..        re
-0001f280: 7475 726e 2072 6573 756c 7431 2c20 7265  turn result1, re
-0001f290: 7375 6c74 320a 0a20 2020 2040 6465 7269  sult2..    @deri
-0001f2a0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0001f2b0: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
-0001f2c0: 6f6d 6269 6e65 2873 656c 662c 206f 7468  ombine(self, oth
-0001f2d0: 6572 2c20 6675 6e63 2c20 6669 6c6c 5f76  er, func, fill_v
-0001f2e0: 616c 7565 3d4e 6f6e 652c 206f 7665 7277  alue=None, overw
-0001f2f0: 7269 7465 3d54 7275 6529 3a0a 2020 2020  rite=True):.    
-0001f300: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001f310: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-0001f320: 2020 2020 2020 2020 2020 2020 4d2e 636f              M.co
-0001f330: 6d62 696e 652c 206f 7468 6572 2c20 6675  mbine, other, fu
-0001f340: 6e63 2c20 6669 6c6c 5f76 616c 7565 3d66  nc, fill_value=f
-0001f350: 696c 6c5f 7661 6c75 652c 206f 7665 7277  ill_value, overw
-0001f360: 7269 7465 3d6f 7665 7277 7269 7465 0a20  rite=overwrite. 
-0001f370: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-0001f380: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0001f390: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0001f3a0: 6620 636f 6d62 696e 655f 6669 7273 7428  f combine_first(
-0001f3b0: 7365 6c66 2c20 6f74 6865 7229 3a0a 2020  self, other):.  
-0001f3c0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0001f3d0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-0001f3e0: 284d 2e63 6f6d 6269 6e65 5f66 6972 7374  (M.combine_first
-0001f3f0: 2c20 6f74 6865 7229 0a0a 2020 2020 4063  , other)..    @c
-0001f400: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
-0001f410: 6566 205f 6269 6e64 5f6f 7065 7261 746f  ef _bind_operato
-0001f420: 725f 6d65 7468 6f64 2863 6c73 2c20 6e61  r_method(cls, na
-0001f430: 6d65 2c20 6f70 2c20 6f72 6967 696e 616c  me, op, original
-0001f440: 3d70 642e 4461 7461 4672 616d 6529 3a0a  =pd.DataFrame):.
-0001f450: 2020 2020 2020 2020 2222 2262 696e 6420          """bind 
-0001f460: 6f70 6572 6174 6f72 206d 6574 686f 6420  operator method 
-0001f470: 6c69 6b65 2044 6174 6146 7261 6d65 2e61  like DataFrame.a
-0001f480: 6464 2074 6f20 7468 6973 2063 6c61 7373  dd to this class
-0001f490: 2222 220a 2020 2020 2020 2020 7261 6973  """.        rais
-0001f4a0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-0001f4b0: 4572 726f 720a 0a20 2020 2040 6465 7269  Error..    @deri
-0001f4c0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0001f4d0: 4672 616d 6529 0a20 2020 2064 6566 2072  Frame).    def r
-0001f4e0: 6573 616d 706c 6528 7365 6c66 2c20 7275  esample(self, ru
-0001f4f0: 6c65 2c20 636c 6f73 6564 3d4e 6f6e 652c  le, closed=None,
-0001f500: 206c 6162 656c 3d4e 6f6e 6529 3a0a 2020   label=None):.  
-0001f510: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-0001f520: 6461 7461 6672 616d 652e 7473 6572 6965  dataframe.tserie
-0001f530: 732e 7265 7361 6d70 6c65 2069 6d70 6f72  s.resample impor
-0001f540: 7420 5265 7361 6d70 6c65 720a 0a20 2020  t Resampler..   
-0001f550: 2020 2020 2072 6574 7572 6e20 5265 7361       return Resa
-0001f560: 6d70 6c65 7228 7365 6c66 2c20 7275 6c65  mpler(self, rule
-0001f570: 2c20 636c 6f73 6564 3d63 6c6f 7365 642c  , closed=closed,
-0001f580: 206c 6162 656c 3d6c 6162 656c 290a 0a20   label=label).. 
-0001f590: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0001f5a0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0001f5b0: 2020 2064 6566 2066 6972 7374 2873 656c     def first(sel
-0001f5c0: 662c 206f 6666 7365 7429 3a0a 2020 2020  f, offset):.    
-0001f5d0: 2020 2020 2320 4c65 7420 7061 6e64 6173      # Let pandas
-0001f5e0: 2065 7272 6f72 206f 6e20 6261 6420 6172   error on bad ar
-0001f5f0: 6773 0a20 2020 2020 2020 2073 656c 662e  gs.        self.
-0001f600: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e66  _meta_nonempty.f
-0001f610: 6972 7374 286f 6666 7365 7429 0a0a 2020  irst(offset)..  
-0001f620: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-0001f630: 662e 6b6e 6f77 6e5f 6469 7669 7369 6f6e  f.known_division
-0001f640: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-0001f650: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0001f660: 2260 6669 7273 7460 2069 7320 6e6f 7420  "`first` is not 
-0001f670: 696d 706c 656d 656e 7465 6420 666f 7220  implemented for 
-0001f680: 756e 6b6e 6f77 6e20 6469 7669 7369 6f6e  unknown division
-0001f690: 7322 290a 0a20 2020 2020 2020 206f 6666  s")..        off
-0001f6a0: 7365 7420 3d20 7064 2e74 7365 7269 6573  set = pd.tseries
-0001f6b0: 2e66 7265 7175 656e 6369 6573 2e74 6f5f  .frequencies.to_
-0001f6c0: 6f66 6673 6574 286f 6666 7365 7429 0a20  offset(offset). 
-0001f6d0: 2020 2020 2020 2064 6174 6520 3d20 7365         date = se
-0001f6e0: 6c66 2e64 6976 6973 696f 6e73 5b30 5d20  lf.divisions[0] 
-0001f6f0: 2b20 6f66 6673 6574 0a20 2020 2020 2020  + offset.       
-0001f700: 2065 6e64 203d 2073 656c 662e 6c6f 632e   end = self.loc.
-0001f710: 5f67 6574 5f70 6172 7469 7469 6f6e 7328  _get_partitions(
-0001f720: 6461 7465 290a 0a20 2020 2020 2020 2069  date)..        i
-0001f730: 735f 616e 6368 6f72 6564 203d 206f 6666  s_anchored = off
-0001f740: 7365 742e 6973 5f61 6e63 686f 7265 6428  set.is_anchored(
-0001f750: 290a 0a20 2020 2020 2020 2069 6e63 6c75  )..        inclu
-0001f760: 6465 5f72 6967 6874 203d 2069 735f 616e  de_right = is_an
-0001f770: 6368 6f72 6564 206f 7220 6e6f 7420 6861  chored or not ha
-0001f780: 7361 7474 7228 6f66 6673 6574 2c20 2264  sattr(offset, "d
-0001f790: 656c 7461 2229 0a0a 2020 2020 2020 2020  elta")..        
-0001f7a0: 6966 2065 6e64 203d 3d20 7365 6c66 2e6e  if end == self.n
-0001f7b0: 7061 7274 6974 696f 6e73 202d 2031 3a0a  partitions - 1:.
-0001f7c0: 2020 2020 2020 2020 2020 2020 6469 7673              divs
-0001f7d0: 203d 2073 656c 662e 6469 7669 7369 6f6e   = self.division
-0001f7e0: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
-0001f7f0: 2020 2020 2020 2020 2020 2020 6469 7673              divs
-0001f800: 203d 2073 656c 662e 6469 7669 7369 6f6e   = self.division
-0001f810: 735b 3a20 656e 6420 2b20 315d 202b 2028  s[: end + 1] + (
-0001f820: 6461 7465 2c29 0a0a 2020 2020 2020 2020  date,)..        
-0001f830: 6e61 6d65 203d 2022 6669 7273 742d 2220  name = "first-" 
-0001f840: 2b20 746f 6b65 6e69 7a65 2873 656c 662c  + tokenize(self,
-0001f850: 206f 6666 7365 7429 0a20 2020 2020 2020   offset).       
-0001f860: 2064 736b 203d 207b 286e 616d 652c 2069   dsk = {(name, i
-0001f870: 293a 2028 7365 6c66 2e5f 6e61 6d65 2c20  ): (self._name, 
-0001f880: 6929 2066 6f72 2069 2069 6e20 7261 6e67  i) for i in rang
-0001f890: 6528 656e 6429 7d0a 2020 2020 2020 2020  e(end)}.        
-0001f8a0: 6473 6b5b 286e 616d 652c 2065 6e64 295d  dsk[(name, end)]
-0001f8b0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-0001f8c0: 206d 6574 686f 6473 2e62 6f75 6e64 6172   methods.boundar
-0001f8d0: 795f 736c 6963 652c 0a20 2020 2020 2020  y_slice,.       
-0001f8e0: 2020 2020 2028 7365 6c66 2e5f 6e61 6d65       (self._name
-0001f8f0: 2c20 656e 6429 2c0a 2020 2020 2020 2020  , end),.        
-0001f900: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
-0001f910: 2020 2020 2020 6461 7465 2c0a 2020 2020        date,.    
-0001f920: 2020 2020 2020 2020 696e 636c 7564 655f          include_
-0001f930: 7269 6768 742c 0a20 2020 2020 2020 2020  right,.         
-0001f940: 2020 2054 7275 652c 0a20 2020 2020 2020     True,.       
-0001f950: 2029 0a20 2020 2020 2020 2067 7261 7068   ).        graph
-0001f960: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
-0001f970: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
-0001f980: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
-0001f990: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
-0001f9a0: 5d29 0a20 2020 2020 2020 2072 6574 7572  ]).        retur
-0001f9b0: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
-0001f9c0: 6772 6170 682c 206e 616d 652c 2073 656c  graph, name, sel
-0001f9d0: 662c 2064 6976 7329 0a0a 2020 2020 4064  f, divs)..    @d
-0001f9e0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0001f9f0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0001fa00: 6620 6c61 7374 2873 656c 662c 206f 6666  f last(self, off
-0001fa10: 7365 7429 3a0a 2020 2020 2020 2020 2320  set):.        # 
-0001fa20: 4c65 7420 7061 6e64 6173 2065 7272 6f72  Let pandas error
-0001fa30: 206f 6e20 6261 6420 6172 6773 0a20 2020   on bad args.   
-0001fa40: 2020 2020 2073 656c 662e 5f6d 6574 615f       self._meta_
-0001fa50: 6e6f 6e65 6d70 7479 2e66 6972 7374 286f  nonempty.first(o
-0001fa60: 6666 7365 7429 0a0a 2020 2020 2020 2020  ffset)..        
-0001fa70: 6966 206e 6f74 2073 656c 662e 6b6e 6f77  if not self.know
-0001fa80: 6e5f 6469 7669 7369 6f6e 733a 0a20 2020  n_divisions:.   
-0001fa90: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0001faa0: 616c 7565 4572 726f 7228 2260 6c61 7374  alueError("`last
-0001fab0: 6020 6973 206e 6f74 2069 6d70 6c65 6d65  ` is not impleme
-0001fac0: 6e74 6564 2066 6f72 2075 6e6b 6e6f 776e  nted for unknown
-0001fad0: 2064 6976 6973 696f 6e73 2229 0a0a 2020   divisions")..  
-0001fae0: 2020 2020 2020 6f66 6673 6574 203d 2070        offset = p
-0001faf0: 642e 7473 6572 6965 732e 6672 6571 7565  d.tseries.freque
-0001fb00: 6e63 6965 732e 746f 5f6f 6666 7365 7428  ncies.to_offset(
-0001fb10: 6f66 6673 6574 290a 2020 2020 2020 2020  offset).        
-0001fb20: 6461 7465 203d 2073 656c 662e 6469 7669  date = self.divi
-0001fb30: 7369 6f6e 735b 2d31 5d20 2d20 6f66 6673  sions[-1] - offs
-0001fb40: 6574 0a20 2020 2020 2020 2073 7461 7274  et.        start
-0001fb50: 203d 2073 656c 662e 6c6f 632e 5f67 6574   = self.loc._get
-0001fb60: 5f70 6172 7469 7469 6f6e 7328 6461 7465  _partitions(date
-0001fb70: 290a 0a20 2020 2020 2020 2069 6620 7374  )..        if st
-0001fb80: 6172 7420 3d3d 2030 3a0a 2020 2020 2020  art == 0:.      
-0001fb90: 2020 2020 2020 6469 7673 203d 2073 656c        divs = sel
-0001fba0: 662e 6469 7669 7369 6f6e 730a 2020 2020  f.divisions.    
-0001fbb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001fbc0: 2020 2020 2020 6469 7673 203d 2028 6461        divs = (da
-0001fbd0: 7465 2c29 202b 2073 656c 662e 6469 7669  te,) + self.divi
-0001fbe0: 7369 6f6e 735b 7374 6172 7420 2b20 3120  sions[start + 1 
-0001fbf0: 3a5d 0a0a 2020 2020 2020 2020 6e61 6d65  :]..        name
-0001fc00: 203d 2022 6c61 7374 2d22 202b 2074 6f6b   = "last-" + tok
-0001fc10: 656e 697a 6528 7365 6c66 2c20 6f66 6673  enize(self, offs
-0001fc20: 6574 290a 2020 2020 2020 2020 6473 6b20  et).        dsk 
-0001fc30: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0001fc40: 286e 616d 652c 2069 202b 2031 293a 2028  (name, i + 1): (
-0001fc50: 7365 6c66 2e5f 6e61 6d65 2c20 6a20 2b20  self._name, j + 
-0001fc60: 3129 0a20 2020 2020 2020 2020 2020 2066  1).            f
-0001fc70: 6f72 2069 2c20 6a20 696e 2065 6e75 6d65  or i, j in enume
-0001fc80: 7261 7465 2872 616e 6765 2873 7461 7274  rate(range(start
-0001fc90: 2c20 7365 6c66 2e6e 7061 7274 6974 696f  , self.npartitio
-0001fca0: 6e73 2929 0a20 2020 2020 2020 207d 0a20  ns)).        }. 
-0001fcb0: 2020 2020 2020 2064 736b 5b28 6e61 6d65         dsk[(name
-0001fcc0: 2c20 3029 5d20 3d20 280a 2020 2020 2020  , 0)] = (.      
-0001fcd0: 2020 2020 2020 6d65 7468 6f64 732e 626f        methods.bo
-0001fce0: 756e 6461 7279 5f73 6c69 6365 2c0a 2020  undary_slice,.  
-0001fcf0: 2020 2020 2020 2020 2020 2873 656c 662e            (self.
-0001fd00: 5f6e 616d 652c 2073 7461 7274 292c 0a20  _name, start),. 
-0001fd10: 2020 2020 2020 2020 2020 2064 6174 652c             date,
-0001fd20: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-0001fd30: 652c 0a20 2020 2020 2020 2020 2020 2054  e,.            T
-0001fd40: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-0001fd50: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-0001fd60: 290a 2020 2020 2020 2020 6772 6170 6820  ).        graph 
-0001fd70: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-0001fd80: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-0001fd90: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
-0001fda0: 656e 6465 6e63 6965 733d 5b73 656c 665d  endencies=[self]
-0001fdb0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0001fdc0: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
-0001fdd0: 7261 7068 2c20 6e61 6d65 2c20 7365 6c66  raph, name, self
-0001fde0: 2c20 6469 7673 290a 0a20 2020 2064 6566  , divs)..    def
-0001fdf0: 206e 756e 6971 7565 5f61 7070 726f 7828   nunique_approx(
-0001fe00: 7365 6c66 2c20 7370 6c69 745f 6576 6572  self, split_ever
-0001fe10: 793d 4e6f 6e65 293a 0a20 2020 2020 2020  y=None):.       
-0001fe20: 2022 2222 4170 7072 6f78 696d 6174 6520   """Approximate 
-0001fe30: 6e75 6d62 6572 206f 6620 756e 6971 7565  number of unique
-0001fe40: 2072 6f77 732e 0a0a 2020 2020 2020 2020   rows...        
-0001fe50: 5468 6973 206d 6574 686f 6420 7573 6573  This method uses
-0001fe60: 2074 6865 2048 7970 6572 4c6f 674c 6f67   the HyperLogLog
-0001fe70: 2061 6c67 6f72 6974 686d 2066 6f72 2063   algorithm for c
-0001fe80: 6172 6469 6e61 6c69 7479 0a20 2020 2020  ardinality.     
-0001fe90: 2020 2065 7374 696d 6174 696f 6e20 746f     estimation to
-0001fea0: 2063 6f6d 7075 7465 2074 6865 2061 7070   compute the app
-0001feb0: 726f 7869 6d61 7465 206e 756d 6265 7220  roximate number 
-0001fec0: 6f66 2075 6e69 7175 6520 726f 7773 2e0a  of unique rows..
-0001fed0: 2020 2020 2020 2020 5468 6520 6170 7072          The appr
-0001fee0: 6f78 696d 6174 6520 6572 726f 7220 6973  oximate error is
-0001fef0: 2030 2e34 3036 252e 0a0a 2020 2020 2020   0.406%...      
-0001ff00: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0001ff10: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0001ff20: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-0001ff30: 6572 7920 3a20 696e 742c 206f 7074 696f  ery : int, optio
-0001ff40: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-0001ff50: 4772 6f75 7020 7061 7274 6974 696f 6e73  Group partitions
-0001ff60: 2069 6e74 6f20 6772 6f75 7073 206f 6620   into groups of 
-0001ff70: 7468 6973 2073 697a 6520 7768 696c 6520  this size while 
-0001ff80: 7065 7266 6f72 6d69 6e67 2061 0a20 2020  performing a.   
-0001ff90: 2020 2020 2020 2020 2074 7265 652d 7265           tree-re
-0001ffa0: 6475 6374 696f 6e2e 2049 6620 7365 7420  duction. If set 
-0001ffb0: 746f 2046 616c 7365 2c20 6e6f 2074 7265  to False, no tre
-0001ffc0: 652d 7265 6475 6374 696f 6e20 7769 6c6c  e-reduction will
-0001ffd0: 2062 6520 7573 6564 2e0a 2020 2020 2020   be used..      
-0001ffe0: 2020 2020 2020 4465 6661 756c 7420 6973        Default is
-0001fff0: 2038 2e0a 0a20 2020 2020 2020 2052 6574   8...        Ret
-00020000: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
-00020010: 2d2d 2d2d 0a20 2020 2020 2020 2061 2066  ----.        a f
-00020020: 6c6f 6174 2072 6570 7265 7365 6e74 696e  loat representin
-00020030: 6720 7468 6520 6170 7072 6f78 696d 6174  g the approximat
-00020040: 6520 6e75 6d62 6572 206f 6620 656c 656d  e number of elem
-00020050: 656e 7473 0a20 2020 2020 2020 2022 2222  ents.        """
-00020060: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-00020070: 736b 2e64 6174 6166 7261 6d65 2069 6d70  sk.dataframe imp
-00020080: 6f72 7420 6879 7065 726c 6f67 6c6f 6720  ort hyperloglog 
-00020090: 2023 2068 6572 6520 746f 2061 766f 6964   # here to avoid
-000200a0: 2063 6972 6375 6c61 7220 696d 706f 7274   circular import
-000200b0: 2069 7373 7565 730a 0a20 2020 2020 2020   issues..       
-000200c0: 2072 6574 7572 6e20 6163 6128 0a20 2020   return aca(.   
-000200d0: 2020 2020 2020 2020 205b 7365 6c66 5d2c           [self],
-000200e0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-000200f0: 6e6b 3d68 7970 6572 6c6f 676c 6f67 2e63  nk=hyperloglog.c
-00020100: 6f6d 7075 7465 5f68 6c6c 5f61 7272 6179  ompute_hll_array
-00020110: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
-00020120: 6d62 696e 653d 6879 7065 726c 6f67 6c6f  mbine=hyperloglo
-00020130: 672e 7265 6475 6365 5f73 7461 7465 2c0a  g.reduce_state,.
-00020140: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
-00020150: 6567 6174 653d 6879 7065 726c 6f67 6c6f  egate=hyperloglo
-00020160: 672e 6573 7469 6d61 7465 5f63 6f75 6e74  g.estimate_count
-00020170: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
-00020180: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-00020190: 6576 6572 792c 0a20 2020 2020 2020 2020  every,.         
-000201a0: 2020 2062 3d31 362c 0a20 2020 2020 2020     b=16,.       
-000201b0: 2020 2020 206d 6574 613d 666c 6f61 742c       meta=float,
-000201c0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000201d0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-000201e0: 6620 7661 6c75 6573 2873 656c 6629 3a0a  f values(self):.
-000201f0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00020200: 6e20 6120 6461 736b 2e61 7272 6179 206f  n a dask.array o
-00020210: 6620 7468 6520 7661 6c75 6573 206f 6620  f the values of 
-00020220: 7468 6973 2064 6174 6166 7261 6d65 0a0a  this dataframe..
-00020230: 2020 2020 2020 2020 5761 726e 696e 673a          Warning:
-00020240: 2054 6869 7320 6372 6561 7465 7320 6120   This creates a 
-00020250: 6461 736b 2e61 7272 6179 2077 6974 686f  dask.array witho
-00020260: 7574 2070 7265 6369 7365 2073 6861 7065  ut precise shape
-00020270: 2069 6e66 6f72 6d61 7469 6f6e 2e0a 2020   information..  
-00020280: 2020 2020 2020 4f70 6572 6174 696f 6e73        Operations
-00020290: 2074 6861 7420 6465 7065 6e64 206f 6e20   that depend on 
-000202a0: 7368 6170 6520 696e 666f 726d 6174 696f  shape informatio
-000202b0: 6e2c 206c 696b 6520 736c 6963 696e 6720  n, like slicing 
-000202c0: 6f72 2072 6573 6861 7069 6e67 2c0a 2020  or reshaping,.  
-000202d0: 2020 2020 2020 7769 6c6c 206e 6f74 2077        will not w
-000202e0: 6f72 6b2e 0a20 2020 2020 2020 2022 2222  ork..        """
-000202f0: 0a20 2020 2020 2020 2069 6620 6973 5f65  .        if is_e
-00020300: 7874 656e 7369 6f6e 5f61 7272 6179 5f64  xtension_array_d
-00020310: 7479 7065 2873 656c 662e 5f6d 6574 612e  type(self._meta.
-00020320: 7661 6c75 6573 293a 0a20 2020 2020 2020  values):.       
-00020330: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00020340: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
-00020350: 2020 2020 2244 6173 6b20 6375 7272 656e      "Dask curren
-00020360: 746c 7920 6861 7320 6c69 6d69 7465 6420  tly has limited 
-00020370: 7375 7070 6f72 7420 666f 7220 636f 6e76  support for conv
-00020380: 6572 7469 6e67 2070 616e 6461 7320 6578  erting pandas ex
-00020390: 7465 6e73 696f 6e20 6474 7970 6573 2022  tension dtypes "
-000203a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000203b0: 2066 2274 6f20 6172 7261 7973 2e20 436f   f"to arrays. Co
-000203c0: 6e76 6572 7469 6e67 207b 7365 6c66 2e5f  nverting {self._
-000203d0: 6d65 7461 2e76 616c 7565 732e 6474 7970  meta.values.dtyp
-000203e0: 657d 2074 6f20 6f62 6a65 6374 2064 7479  e} to object dty
-000203f0: 7065 2e22 2c0a 2020 2020 2020 2020 2020  pe.",.          
-00020400: 2020 2020 2020 5573 6572 5761 726e 696e        UserWarnin
-00020410: 672c 0a20 2020 2020 2020 2020 2020 2029  g,.            )
-00020420: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00020430: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-00020440: 6f6e 7328 6d65 7468 6f64 732e 7661 6c75  ons(methods.valu
-00020450: 6573 290a 0a20 2020 2064 6566 205f 7661  es)..    def _va
-00020460: 6c69 6461 7465 5f63 6875 6e6b 7328 7365  lidate_chunks(se
-00020470: 6c66 2c20 6172 722c 206c 656e 6774 6873  lf, arr, lengths
-00020480: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
-00020490: 6461 736b 2e61 7272 6179 2e63 6f72 6520  dask.array.core 
-000204a0: 696d 706f 7274 206e 6f72 6d61 6c69 7a65  import normalize
-000204b0: 5f63 6875 6e6b 730a 0a20 2020 2020 2020  _chunks..       
-000204c0: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
-000204d0: 656e 6774 6873 2c20 5365 7175 656e 6365  engths, Sequence
-000204e0: 293a 0a20 2020 2020 2020 2020 2020 206c  ):.            l
-000204f0: 656e 6774 6873 203d 2074 7570 6c65 286c  engths = tuple(l
-00020500: 656e 6774 6873 290a 0a20 2020 2020 2020  engths)..       
-00020510: 2020 2020 2069 6620 6c65 6e28 6c65 6e67       if len(leng
-00020520: 7468 7329 2021 3d20 7365 6c66 2e6e 7061  ths) != self.npa
-00020530: 7274 6974 696f 6e73 3a0a 2020 2020 2020  rtitions:.      
-00020540: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00020550: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00020560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020570: 2254 6865 206e 756d 6265 7220 6f66 2069  "The number of i
-00020580: 7465 6d73 2069 6e20 276c 656e 6774 6873  tems in 'lengths
-00020590: 2720 646f 6573 206e 6f74 206d 6174 6368  ' does not match
-000205a0: 2074 6865 206e 756d 6265 7220 6f66 2022   the number of "
-000205b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000205c0: 2020 2020 2066 2270 6172 7469 7469 6f6e       f"partition
-000205d0: 732e 207b 6c65 6e28 6c65 6e67 7468 7329  s. {len(lengths)
-000205e0: 7d20 213d 207b 7365 6c66 2e6e 7061 7274  } != {self.npart
-000205f0: 6974 696f 6e73 7d22 0a20 2020 2020 2020  itions}".       
-00020600: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00020610: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00020620: 6e64 696d 203d 3d20 313a 0a20 2020 2020  ndim == 1:.     
-00020630: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
-00020640: 7320 3d20 6e6f 726d 616c 697a 655f 6368  s = normalize_ch
-00020650: 756e 6b73 2828 6c65 6e67 7468 732c 2929  unks((lengths,))
-00020660: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00020670: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00020680: 2020 2063 6875 6e6b 7320 3d20 6e6f 726d     chunks = norm
-00020690: 616c 697a 655f 6368 756e 6b73 2828 6c65  alize_chunks((le
-000206a0: 6e67 7468 732c 2028 6c65 6e28 7365 6c66  ngths, (len(self
-000206b0: 2e63 6f6c 756d 6e73 292c 2929 290a 0a20  .columns),))).. 
-000206c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000206d0: 6e20 6368 756e 6b73 0a20 2020 2020 2020  n chunks.       
-000206e0: 2065 6c69 6620 6c65 6e67 7468 7320 6973   elif lengths is
-000206f0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00020700: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00020710: 7565 4572 726f 7228 6622 556e 6578 7065  ueError(f"Unexpe
-00020720: 6374 6564 2076 616c 7565 2066 6f72 2027  cted value for '
-00020730: 6c65 6e67 7468 7327 3a20 277b 6c65 6e67  lengths': '{leng
-00020740: 7468 737d 2722 290a 0a20 2020 2020 2020  ths}'")..       
-00020750: 2072 6574 7572 6e20 6172 722e 5f63 6875   return arr._chu
-00020760: 6e6b 730a 0a20 2020 2064 6566 205f 6973  nks..    def _is
-00020770: 5f69 6e64 6578 5f6c 6576 656c 5f72 6566  _index_level_ref
-00020780: 6572 656e 6365 2873 656c 662c 206b 6579  erence(self, key
-00020790: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-000207a0: 2020 2020 2020 2054 6573 7420 7768 6574         Test whet
-000207b0: 6865 7220 6120 6b65 7920 6973 2061 6e20  her a key is an 
-000207c0: 696e 6465 7820 6c65 7665 6c20 7265 6665  index level refe
-000207d0: 7265 6e63 650a 0a20 2020 2020 2020 2054  rence..        T
-000207e0: 6f20 6265 2063 6f6e 7369 6465 7265 6420  o be considered 
-000207f0: 616e 2069 6e64 6578 206c 6576 656c 2072  an index level r
-00020800: 6566 6572 656e 6365 2c20 606b 6579 6020  eference, `key` 
-00020810: 6d75 7374 206d 6174 6368 2074 6865 2069  must match the i
-00020820: 6e64 6578 206e 616d 650a 2020 2020 2020  ndex name.      
-00020830: 2020 616e 6420 6d75 7374 204e 4f54 206d    and must NOT m
-00020840: 6174 6368 2074 6865 206e 616d 6520 6f66  atch the name of
-00020850: 2061 6e79 2063 6f6c 756d 6e20 2869 6620   any column (if 
-00020860: 6120 6461 7461 6672 616d 6529 2e0a 2020  a dataframe)..  
-00020870: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00020880: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
-00020890: 2020 2020 2020 2073 656c 662e 696e 6465         self.inde
-000208a0: 782e 6e61 6d65 2069 7320 6e6f 7420 4e6f  x.name is not No
-000208b0: 6e65 0a20 2020 2020 2020 2020 2020 2061  ne.            a
-000208c0: 6e64 206e 6f74 2069 735f 6461 736b 5f63  nd not is_dask_c
-000208d0: 6f6c 6c65 6374 696f 6e28 6b65 7929 0a20  ollection(key). 
-000208e0: 2020 2020 2020 2020 2020 2061 6e64 2028             and (
-000208f0: 6e70 2e69 7373 6361 6c61 7228 6b65 7929  np.isscalar(key)
-00020900: 206f 7220 6973 696e 7374 616e 6365 286b   or isinstance(k
-00020910: 6579 2c20 7475 706c 6529 290a 2020 2020  ey, tuple)).    
-00020920: 2020 2020 2020 2020 616e 6420 6b65 7920          and key 
-00020930: 3d3d 2073 656c 662e 696e 6465 782e 6e61  == self.index.na
-00020940: 6d65 0a20 2020 2020 2020 2020 2020 2061  me.            a
-00020950: 6e64 206b 6579 206e 6f74 2069 6e20 6765  nd key not in ge
-00020960: 7461 7474 7228 7365 6c66 2c20 2263 6f6c  tattr(self, "col
-00020970: 756d 6e73 222c 2028 2929 0a20 2020 2020  umns", ()).     
-00020980: 2020 2029 0a0a 2020 2020 6465 6620 5f63     )..    def _c
-00020990: 6f6e 7461 696e 735f 696e 6465 785f 6e61  ontains_index_na
-000209a0: 6d65 2873 656c 662c 2063 6f6c 756d 6e73  me(self, columns
-000209b0: 5f6f 725f 696e 6465 7829 3a0a 2020 2020  _or_index):.    
-000209c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000209d0: 5465 7374 2077 6865 7468 6572 2074 6865  Test whether the
-000209e0: 2069 6e70 7574 2063 6f6e 7461 696e 7320   input contains 
-000209f0: 6120 7265 6665 7265 6e63 6520 746f 2074  a reference to t
-00020a00: 6865 2069 6e64 6578 206f 6620 7468 6520  he index of the 
-00020a10: 4461 7461 4672 616d 652f 5365 7269 6573  DataFrame/Series
-00020a20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00020a30: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00020a40: 6365 2863 6f6c 756d 6e73 5f6f 725f 696e  ce(columns_or_in
-00020a50: 6465 782c 206c 6973 7429 3a0a 2020 2020  dex, list):.    
-00020a60: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-00020a70: 6e79 2873 656c 662e 5f69 735f 696e 6465  ny(self._is_inde
-00020a80: 785f 6c65 7665 6c5f 7265 6665 7265 6e63  x_level_referenc
-00020a90: 6528 6e29 2066 6f72 206e 2069 6e20 636f  e(n) for n in co
-00020aa0: 6c75 6d6e 735f 6f72 5f69 6e64 6578 290a  lumns_or_index).
-00020ab0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00020ac0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00020ad0: 2073 656c 662e 5f69 735f 696e 6465 785f   self._is_index_
-00020ae0: 6c65 7665 6c5f 7265 6665 7265 6e63 6528  level_reference(
-00020af0: 636f 6c75 6d6e 735f 6f72 5f69 6e64 6578  columns_or_index
-00020b00: 290a 0a0a 6465 6620 5f72 6169 7365 5f69  )...def _raise_i
-00020b10: 665f 6f62 6a65 6374 5f73 6572 6965 7328  f_object_series(
-00020b20: 782c 2066 756e 636e 616d 6529 3a0a 2020  x, funcname):.  
-00020b30: 2020 2222 220a 2020 2020 5574 696c 6974    """.    Utilit
-00020b40: 7920 6675 6e63 7469 6f6e 2074 6f20 7261  y function to ra
-00020b50: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
-00020b60: 616e 206f 626a 6563 7420 636f 6c75 6d6e  an object column
-00020b70: 2064 6f65 7320 6e6f 7420 7375 7070 6f72   does not suppor
-00020b80: 740a 2020 2020 6120 6365 7274 6169 6e20  t.    a certain 
-00020b90: 6f70 6572 6174 696f 6e20 6c69 6b65 2060  operation like `
-00020ba0: 6d65 616e 602e 0a20 2020 2022 2222 0a20  mean`..    """. 
-00020bb0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00020bc0: 2878 2c20 5365 7269 6573 2920 616e 6420  (x, Series) and 
-00020bd0: 6861 7361 7474 7228 782c 2022 6474 7970  hasattr(x, "dtyp
-00020be0: 6522 293a 0a20 2020 2020 2020 2069 6620  e"):.        if 
-00020bf0: 782e 6474 7970 6520 3d3d 206f 626a 6563  x.dtype == objec
-00020c00: 743a 0a20 2020 2020 2020 2020 2020 2072  t:.            r
-00020c10: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00020c20: 2260 2573 6020 6e6f 7420 7375 7070 6f72  "`%s` not suppor
-00020c30: 7465 6420 7769 7468 206f 626a 6563 7420  ted with object 
-00020c40: 7365 7269 6573 2220 2520 6675 6e63 6e61  series" % funcna
-00020c50: 6d65 290a 2020 2020 2020 2020 656c 6966  me).        elif
-00020c60: 2070 642e 6170 692e 7479 7065 732e 6973   pd.api.types.is
-00020c70: 5f64 7479 7065 5f65 7175 616c 2878 2e64  _dtype_equal(x.d
-00020c80: 7479 7065 2c20 2273 7472 696e 6722 293a  type, "string"):
-00020c90: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00020ca0: 7365 2056 616c 7565 4572 726f 7228 2260  se ValueError("`
-00020cb0: 2573 6020 6e6f 7420 7375 7070 6f72 7465  %s` not supporte
-00020cc0: 6420 7769 7468 2073 7472 696e 6720 7365  d with string se
-00020cd0: 7269 6573 2220 2520 6675 6e63 6e61 6d65  ries" % funcname
-00020ce0: 290a 0a0a 636c 6173 7320 5365 7269 6573  )...class Series
-00020cf0: 285f 4672 616d 6529 3a0a 2020 2020 2222  (_Frame):.    ""
-00020d00: 2250 6172 616c 6c65 6c20 5061 6e64 6173  "Parallel Pandas
-00020d10: 2053 6572 6965 730a 0a20 2020 2044 6f20   Series..    Do 
-00020d20: 6e6f 7420 7573 6520 7468 6973 2063 6c61  not use this cla
-00020d30: 7373 2064 6972 6563 746c 792e 2020 496e  ss directly.  In
-00020d40: 7374 6561 6420 7573 6520 6675 6e63 7469  stead use functi
-00020d50: 6f6e 7320 6c69 6b65 0a20 2020 2060 6064  ons like.    ``d
-00020d60: 642e 7265 6164 5f63 7376 6060 2c20 6060  d.read_csv``, ``
-00020d70: 6464 2e72 6561 645f 7061 7271 7565 7460  dd.read_parquet`
-00020d80: 602c 206f 7220 6060 6464 2e66 726f 6d5f  `, or ``dd.from_
-00020d90: 7061 6e64 6173 6060 2e0a 0a20 2020 2050  pandas``...    P
-00020da0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00020db0: 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020 6473  --------..    ds
-00020dc0: 6b3a 2064 6963 740a 2020 2020 2020 2020  k: dict.        
-00020dd0: 5468 6520 6461 736b 2067 7261 7068 2074  The dask graph t
-00020de0: 6f20 636f 6d70 7574 6520 7468 6973 2053  o compute this S
-00020df0: 6572 6965 730a 2020 2020 5f6e 616d 653a  eries.    _name:
-00020e00: 2073 7472 0a20 2020 2020 2020 2054 6865   str.        The
-00020e10: 206b 6579 2070 7265 6669 7820 7468 6174   key prefix that
-00020e20: 2073 7065 6369 6669 6573 2077 6869 6368   specifies which
-00020e30: 206b 6579 7320 696e 2074 6865 2064 6173   keys in the das
-00020e40: 6b20 636f 6d70 7269 7365 2074 6869 730a  k comprise this.
-00020e50: 2020 2020 2020 2020 7061 7274 6963 756c          particul
-00020e60: 6172 2053 6572 6965 730a 2020 2020 6d65  ar Series.    me
-00020e70: 7461 3a20 7061 6e64 6173 2e53 6572 6965  ta: pandas.Serie
-00020e80: 730a 2020 2020 2020 2020 416e 2065 6d70  s.        An emp
-00020e90: 7479 2060 6070 616e 6461 732e 5365 7269  ty ``pandas.Seri
-00020ea0: 6573 6060 2077 6974 6820 6e61 6d65 732c  es`` with names,
-00020eb0: 2064 7479 7065 732c 2061 6e64 2069 6e64   dtypes, and ind
-00020ec0: 6578 206d 6174 6368 696e 6720 7468 650a  ex matching the.
-00020ed0: 2020 2020 2020 2020 6578 7065 6374 6564          expected
-00020ee0: 206f 7574 7075 742e 0a20 2020 2064 6976   output..    div
-00020ef0: 6973 696f 6e73 3a20 7475 706c 6520 6f66  isions: tuple of
-00020f00: 2069 6e64 6578 2076 616c 7565 730a 2020   index values.  
-00020f10: 2020 2020 2020 5661 6c75 6573 2061 6c6f        Values alo
-00020f20: 6e67 2077 6869 6368 2077 6520 7061 7274  ng which we part
-00020f30: 6974 696f 6e20 6f75 7220 626c 6f63 6b73  ition our blocks
-00020f40: 206f 6e20 7468 6520 696e 6465 780a 0a20   on the index.. 
-00020f50: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-00020f60: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064 6173  --------.    das
-00020f70: 6b2e 6461 7461 6672 616d 652e 4461 7461  k.dataframe.Data
-00020f80: 4672 616d 650a 2020 2020 2222 220a 0a20  Frame.    """.. 
-00020f90: 2020 205f 7061 7274 6974 696f 6e5f 7479     _partition_ty
-00020fa0: 7065 203d 2070 642e 5365 7269 6573 0a20  pe = pd.Series. 
-00020fb0: 2020 205f 6973 5f70 6172 7469 7469 6f6e     _is_partition
-00020fc0: 5f74 7970 6520 3d20 7374 6174 6963 6d65  _type = staticme
-00020fd0: 7468 6f64 2869 735f 7365 7269 6573 5f6c  thod(is_series_l
-00020fe0: 696b 6529 0a20 2020 205f 746f 6b65 6e5f  ike).    _token_
-00020ff0: 7072 6566 6978 203d 2022 7365 7269 6573  prefix = "series
-00021000: 2d22 0a20 2020 205f 6163 6365 7373 6f72  -".    _accessor
-00021010: 733a 2043 6c61 7373 5661 725b 7365 745b  s: ClassVar[set[
-00021020: 7374 725d 5d20 3d20 7365 7428 290a 0a20  str]] = set().. 
-00021030: 2020 2064 6566 205f 5f61 7272 6179 5f77     def __array_w
-00021040: 7261 705f 5f28 7365 6c66 2c20 6172 7261  rap__(self, arra
-00021050: 792c 2063 6f6e 7465 7874 3d4e 6f6e 6529  y, context=None)
-00021060: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
-00021070: 6e73 7461 6e63 6528 636f 6e74 6578 742c  nstance(context,
-00021080: 2074 7570 6c65 2920 616e 6420 6c65 6e28   tuple) and len(
-00021090: 636f 6e74 6578 7429 203e 2030 3a0a 2020  context) > 0:.  
-000210a0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-000210b0: 6e73 7461 6e63 6528 636f 6e74 6578 745b  nstance(context[
-000210c0: 315d 5b30 5d2c 206e 702e 6e64 6172 7261  1][0], np.ndarra
-000210d0: 7929 2061 6e64 2063 6f6e 7465 7874 5b31  y) and context[1
-000210e0: 5d5b 305d 2e73 6861 7065 203d 3d20 2829  ][0].shape == ()
-000210f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00021100: 2020 696e 6465 7820 3d20 4e6f 6e65 0a20    index = None. 
-00021110: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00021120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021130: 2069 6e64 6578 203d 2063 6f6e 7465 7874   index = context
-00021140: 5b31 5d5b 305d 2e69 6e64 6578 0a20 2020  [1][0].index.   
-00021150: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00021160: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00021170: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-00021180: 7274 2069 6e73 7065 6374 0a0a 2020 2020  rt inspect..    
-00021190: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-000211a0: 6f64 5f6e 616d 6520 3d20 6622 607b 696e  od_name = f"`{in
-000211b0: 7370 6563 742e 7374 6163 6b28 295b 335d  spect.stack()[3]
-000211c0: 5b33 5d7d 6022 0a20 2020 2020 2020 2020  [3]}`".         
-000211d0: 2020 2065 7863 6570 7420 496e 6465 7845     except IndexE
-000211e0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-000211f0: 2020 2020 2020 6d65 7468 6f64 5f6e 616d        method_nam
-00021200: 6520 3d20 2254 6869 7320 6d65 7468 6f64  e = "This method
-00021210: 220a 2020 2020 2020 2020 2020 2020 7261  ".            ra
-00021220: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-00021230: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
-00021240: 2020 2020 2020 2020 2066 227b 6d65 7468           f"{meth
-00021250: 6f64 5f6e 616d 657d 2069 7320 6e6f 7420  od_name} is not 
-00021260: 696d 706c 656d 656e 7465 6420 666f 7220  implemented for 
-00021270: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
-00021280: 5365 7269 6573 602e 220a 2020 2020 2020  Series`.".      
-00021290: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-000212a0: 2072 6574 7572 6e20 6d65 7461 5f73 6572   return meta_ser
-000212b0: 6965 735f 636f 6e73 7472 7563 746f 7228  ies_constructor(
-000212c0: 7365 6c66 2928 6172 7261 792c 2069 6e64  self)(array, ind
-000212d0: 6578 3d69 6e64 6578 2c20 6e61 6d65 3d73  ex=index, name=s
-000212e0: 656c 662e 6e61 6d65 290a 0a20 2020 2040  elf.name)..    @
-000212f0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00021300: 2061 7865 7328 7365 6c66 293a 0a20 2020   axes(self):.   
-00021310: 2020 2020 2072 6574 7572 6e20 5b73 656c       return [sel
-00021320: 662e 696e 6465 785d 0a0a 2020 2020 4070  f.index]..    @p
-00021330: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00021340: 6e61 6d65 2873 656c 6629 3a0a 2020 2020  name(self):.    
-00021350: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00021360: 5f6d 6574 612e 6e61 6d65 0a0a 2020 2020  _meta.name..    
-00021370: 406e 616d 652e 7365 7474 6572 0a20 2020  @name.setter.   
-00021380: 2064 6566 206e 616d 6528 7365 6c66 2c20   def name(self, 
-00021390: 6e61 6d65 293a 0a20 2020 2020 2020 2073  name):.        s
-000213a0: 656c 662e 5f6d 6574 612e 6e61 6d65 203d  elf._meta.name =
-000213b0: 206e 616d 650a 2020 2020 2020 2020 7265   name.        re
-000213c0: 6e61 6d65 6420 3d20 5f72 656e 616d 655f  named = _rename_
-000213d0: 6461 736b 2873 656c 662c 206e 616d 6529  dask(self, name)
-000213e0: 0a20 2020 2020 2020 2023 2075 7064 6174  .        # updat
-000213f0: 6520 6d79 7365 6c66 0a20 2020 2020 2020  e myself.       
-00021400: 2073 656c 662e 6461 736b 203d 2072 656e   self.dask = ren
-00021410: 616d 6564 2e64 6173 6b0a 2020 2020 2020  amed.dask.      
-00021420: 2020 7365 6c66 2e5f 6e61 6d65 203d 2072    self._name = r
-00021430: 656e 616d 6564 2e5f 6e61 6d65 0a0a 2020  enamed._name..  
-00021440: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-00021450: 6465 6620 6e64 696d 2873 656c 6629 3a0a  def ndim(self):.
-00021460: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00021470: 6e20 6469 6d65 6e73 696f 6e61 6c69 7479  n dimensionality
-00021480: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00021490: 726e 2031 0a0a 2020 2020 4070 726f 7065  rn 1..    @prope
-000214a0: 7274 790a 2020 2020 6465 6620 7368 6170  rty.    def shap
-000214b0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-000214c0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-000214d0: 7572 6e20 6120 7475 706c 6520 7265 7072  urn a tuple repr
-000214e0: 6573 656e 7469 6e67 2074 6865 2064 696d  esenting the dim
-000214f0: 656e 7369 6f6e 616c 6974 7920 6f66 2061  ensionality of a
-00021500: 2053 6572 6965 732e 0a0a 2020 2020 2020   Series...      
-00021510: 2020 5468 6520 7369 6e67 6c65 2065 6c65    The single ele
-00021520: 6d65 6e74 206f 6620 7468 6520 7475 706c  ment of the tupl
-00021530: 6520 6973 2061 2044 656c 6179 6564 2072  e is a Delayed r
-00021540: 6573 756c 742e 0a0a 2020 2020 2020 2020  esult...        
-00021550: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-00021560: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00021570: 2020 3e3e 3e20 7365 7269 6573 2e73 6861    >>> series.sha
-00021580: 7065 2020 2320 646f 6374 6573 743a 202b  pe  # doctest: +
-00021590: 534b 4950 0a20 2020 2020 2020 2028 6464  SKIP.        (dd
-000215a0: 2e53 6361 6c61 723c 7369 7a65 2d61 672e  .Scalar<size-ag.
-000215b0: 2e2e 2c20 6474 7970 653d 696e 7436 343e  .., dtype=int64>
-000215c0: 2c29 0a20 2020 2020 2020 2022 2222 0a20  ,).        """. 
-000215d0: 2020 2020 2020 2072 6574 7572 6e20 2873         return (s
-000215e0: 656c 662e 7369 7a65 2c29 0a0a 2020 2020  elf.size,)..    
-000215f0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00021600: 6620 6474 7970 6528 7365 6c66 293a 0a20  f dtype(self):. 
-00021610: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00021620: 2064 6174 6120 7479 7065 2222 220a 2020   data type""".  
-00021630: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00021640: 662e 5f6d 6574 612e 6474 7970 650a 0a20  f._meta.dtype.. 
-00021650: 2020 2064 7420 3d20 4361 6368 6564 4163     dt = CachedAc
-00021660: 6365 7373 6f72 2822 6474 222c 2044 6174  cessor("dt", Dat
-00021670: 6574 696d 6541 6363 6573 736f 7229 0a0a  etimeAccessor)..
-00021680: 2020 2020 6361 7420 3d20 4361 6368 6564      cat = Cached
-00021690: 4163 6365 7373 6f72 2822 6361 7422 2c20  Accessor("cat", 
-000216a0: 4361 7465 676f 7269 6361 6c41 6363 6573  CategoricalAcces
-000216b0: 736f 7229 0a0a 2020 2020 7374 7220 3d20  sor)..    str = 
-000216c0: 4361 6368 6564 4163 6365 7373 6f72 2822  CachedAccessor("
-000216d0: 7374 7222 2c20 5374 7269 6e67 4163 6365  str", StringAcce
-000216e0: 7373 6f72 290a 0a20 2020 2064 6566 205f  ssor)..    def _
-000216f0: 5f64 6972 5f5f 2873 656c 6629 3a0a 2020  _dir__(self):.  
-00021700: 2020 2020 2020 6f20 3d20 7365 7428 6469        o = set(di
-00021710: 7228 7479 7065 2873 656c 6629 2929 0a20  r(type(self))). 
-00021720: 2020 2020 2020 206f 2e75 7064 6174 6528         o.update(
-00021730: 7365 6c66 2e5f 5f64 6963 745f 5f29 0a20  self.__dict__). 
-00021740: 2020 2020 2020 2023 2052 656d 6f76 6520         # Remove 
-00021750: 7468 6520 6063 6174 6020 616e 6420 6073  the `cat` and `s
-00021760: 7472 6020 6163 6365 7373 6f72 7320 6966  tr` accessors if
-00021770: 206e 6f74 2061 7661 696c 6162 6c65 2e20   not available. 
-00021780: 5765 2063 616e 2774 0a20 2020 2020 2020  We can't.       
-00021790: 2023 2064 6563 6964 6520 7468 6973 2073   # decide this s
-000217a0: 7461 7469 6361 6c6c 7920 666f 7220 7468  tatically for th
-000217b0: 6520 6064 7460 2061 6363 6573 736f 722c  e `dt` accessor,
-000217c0: 2061 7320 6974 2077 6f72 6b73 206f 6e0a   as it works on.
-000217d0: 2020 2020 2020 2020 2320 6461 7465 7469          # dateti
-000217e0: 6d65 2d6c 696b 6520 7468 696e 6773 2061  me-like things a
-000217f0: 7320 7765 6c6c 2e0a 2020 2020 2020 2020  s well..        
-00021800: 666f 7220 6163 6365 7373 6f72 2069 6e20  for accessor in 
-00021810: 5b22 6361 7422 2c20 2273 7472 225d 3a0a  ["cat", "str"]:.
-00021820: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00021830: 6f74 2068 6173 6174 7472 2873 656c 662e  ot hasattr(self.
-00021840: 5f6d 6574 612c 2061 6363 6573 736f 7229  _meta, accessor)
-00021850: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00021860: 2020 6f2e 7265 6d6f 7665 2861 6363 6573    o.remove(acces
-00021870: 736f 7229 0a20 2020 2020 2020 2072 6574  sor).        ret
-00021880: 7572 6e20 6c69 7374 286f 290a 0a20 2020  urn list(o)..   
-00021890: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-000218a0: 6566 206e 6279 7465 7328 7365 6c66 293a  ef nbytes(self):
-000218b0: 0a20 2020 2020 2020 2022 2222 4e75 6d62  .        """Numb
-000218c0: 6572 206f 6620 6279 7465 7322 2222 0a20  er of bytes""". 
-000218d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000218e0: 6c66 2e72 6564 7563 7469 6f6e 280a 2020  lf.reduction(.  
-000218f0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-00021900: 732e 6e62 7974 6573 2c20 6e70 2e73 756d  s.nbytes, np.sum
-00021910: 2c20 746f 6b65 6e3d 226e 6279 7465 7322  , token="nbytes"
-00021920: 2c20 6d65 7461 3d69 6e74 2c20 7370 6c69  , meta=int, spli
-00021930: 745f 6576 6572 793d 4661 6c73 650a 2020  t_every=False.  
-00021940: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00021950: 205f 7265 7072 5f64 6174 6128 7365 6c66   _repr_data(self
-00021960: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00021970: 6e20 5f72 6570 725f 6461 7461 5f73 6572  n _repr_data_ser
-00021980: 6965 7328 7365 6c66 2e5f 6d65 7461 2c20  ies(self._meta, 
-00021990: 7365 6c66 2e5f 7265 7072 5f64 6976 6973  self._repr_divis
-000219a0: 696f 6e73 290a 0a20 2020 2064 6566 205f  ions)..    def _
-000219b0: 5f72 6570 725f 5f28 7365 6c66 293a 0a20  _repr__(self):. 
-000219c0: 2020 2020 2020 2022 2222 6861 7665 2074         """have t
-000219d0: 6f20 6f76 6572 7772 6974 6520 666f 6f74  o overwrite foot
-000219e0: 6572 2222 220a 2020 2020 2020 2020 6966  er""".        if
-000219f0: 2073 656c 662e 6e61 6d65 2069 7320 6e6f   self.name is no
-00021a00: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00021a10: 2020 2020 666f 6f74 6572 203d 2066 224e      footer = f"N
-00021a20: 616d 653a 207b 7365 6c66 2e6e 616d 657d  ame: {self.name}
-00021a30: 2c20 6474 7970 653a 207b 7365 6c66 2e64  , dtype: {self.d
-00021a40: 7479 7065 7d22 0a20 2020 2020 2020 2065  type}".        e
-00021a50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00021a60: 2066 6f6f 7465 7220 3d20 6622 6474 7970   footer = f"dtyp
-00021a70: 653a 207b 7365 6c66 2e64 7479 7065 7d22  e: {self.dtype}"
-00021a80: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00021a90: 2022 2222 4461 736b 207b 6b6c 6173 737d   """Dask {klass}
-00021aa0: 2053 7472 7563 7475 7265 3a0a 7b64 6174   Structure:.{dat
-00021ab0: 617d 0a7b 666f 6f74 6572 7d0a 4461 736b  a}.{footer}.Dask
-00021ac0: 204e 616d 653a 207b 6e61 6d65 7d2c 207b   Name: {name}, {
-00021ad0: 6c61 7965 7273 7d22 2222 2e66 6f72 6d61  layers}""".forma
-00021ae0: 7428 0a20 2020 2020 2020 2020 2020 206b  t(.            k
-00021af0: 6c61 7373 3d73 656c 662e 5f5f 636c 6173  lass=self.__clas
-00021b00: 735f 5f2e 5f5f 6e61 6d65 5f5f 2c0a 2020  s__.__name__,.  
-00021b10: 2020 2020 2020 2020 2020 6461 7461 3d73            data=s
-00021b20: 656c 662e 746f 5f73 7472 696e 6728 292c  elf.to_string(),
-00021b30: 0a20 2020 2020 2020 2020 2020 2066 6f6f  .            foo
-00021b40: 7465 723d 666f 6f74 6572 2c0a 2020 2020  ter=footer,.    
-00021b50: 2020 2020 2020 2020 6e61 6d65 3d6b 6579          name=key
-00021b60: 5f73 706c 6974 2873 656c 662e 5f6e 616d  _split(self._nam
-00021b70: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-00021b80: 6c61 7965 7273 3d6d 6179 6265 5f70 6c75  layers=maybe_plu
-00021b90: 7261 6c69 7a65 286c 656e 2873 656c 662e  ralize(len(self.
-00021ba0: 6461 736b 2e6c 6179 6572 7329 2c20 2267  dask.layers), "g
-00021bb0: 7261 7068 206c 6179 6572 2229 2c0a 2020  raph layer"),.  
-00021bc0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00021bd0: 2072 656e 616d 6528 7365 6c66 2c20 696e   rename(self, in
-00021be0: 6465 783d 4e6f 6e65 2c20 696e 706c 6163  dex=None, inplac
-00021bf0: 653d 4661 6c73 652c 2073 6f72 7465 645f  e=False, sorted_
-00021c00: 696e 6465 783d 4661 6c73 6529 3a0a 2020  index=False):.  
-00021c10: 2020 2020 2020 2222 2241 6c74 6572 2053        """Alter S
-00021c20: 6572 6965 7320 696e 6465 7820 6c61 6265  eries index labe
-00021c30: 6c73 206f 7220 6e61 6d65 0a0a 2020 2020  ls or name..    
-00021c40: 2020 2020 4675 6e63 7469 6f6e 202f 2064      Function / d
-00021c50: 6963 7420 7661 6c75 6573 206d 7573 7420  ict values must 
-00021c60: 6265 2075 6e69 7175 6520 2831 2d74 6f2d  be unique (1-to-
-00021c70: 3129 2e20 4c61 6265 6c73 206e 6f74 2063  1). Labels not c
-00021c80: 6f6e 7461 696e 6564 2069 6e0a 2020 2020  ontained in.    
-00021c90: 2020 2020 6120 6469 6374 202f 2053 6572      a dict / Ser
-00021ca0: 6965 7320 7769 6c6c 2062 6520 6c65 6674  ies will be left
-00021cb0: 2061 732d 6973 2e20 4578 7472 6120 6c61   as-is. Extra la
-00021cc0: 6265 6c73 206c 6973 7465 6420 646f 6e27  bels listed don'
-00021cd0: 7420 7468 726f 7720 616e 0a20 2020 2020  t throw an.     
-00021ce0: 2020 2065 7272 6f72 2e0a 0a20 2020 2020     error...     
-00021cf0: 2020 2041 6c74 6572 6e61 7469 7665 6c79     Alternatively
-00021d00: 2c20 6368 616e 6765 2060 6053 6572 6965  , change ``Serie
-00021d10: 732e 6e61 6d65 6060 2077 6974 6820 6120  s.name`` with a 
-00021d20: 7363 616c 6172 2076 616c 7565 2e0a 0a20  scalar value... 
-00021d30: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00021d40: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00021d50: 2d2d 2d2d 0a20 2020 2020 2020 2069 6e64  ----.        ind
-00021d60: 6578 203a 2073 6361 6c61 722c 2068 6173  ex : scalar, has
-00021d70: 6861 626c 6520 7365 7175 656e 6365 2c20  hable sequence, 
-00021d80: 6469 6374 2d6c 696b 6520 6f72 2063 616c  dict-like or cal
-00021d90: 6c61 626c 652c 206f 7074 696f 6e61 6c0a  lable, optional.
-00021da0: 2020 2020 2020 2020 2020 2020 4966 2064              If d
-00021db0: 6963 742d 6c69 6b65 206f 7220 6361 6c6c  ict-like or call
-00021dc0: 6162 6c65 2c20 7468 6520 7472 616e 7366  able, the transf
-00021dd0: 6f72 6d61 7469 6f6e 2069 7320 6170 706c  ormation is appl
-00021de0: 6965 6420 746f 2074 6865 0a20 2020 2020  ied to the.     
-00021df0: 2020 2020 2020 2069 6e64 6578 2e20 5363         index. Sc
-00021e00: 616c 6172 206f 7220 6861 7368 6162 6c65  alar or hashable
-00021e10: 2073 6571 7565 6e63 652d 6c69 6b65 2077   sequence-like w
-00021e20: 696c 6c20 616c 7465 7220 7468 650a 2020  ill alter the.  
-00021e30: 2020 2020 2020 2020 2020 6060 5365 7269            ``Seri
-00021e40: 6573 2e6e 616d 6560 6020 6174 7472 6962  es.name`` attrib
-00021e50: 7574 652e 0a20 2020 2020 2020 2069 6e70  ute..        inp
-00021e60: 6c61 6365 203a 2062 6f6f 6c65 616e 2c20  lace : boolean, 
-00021e70: 6465 6661 756c 7420 4661 6c73 650a 2020  default False.  
-00021e80: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
-00021e90: 7220 746f 2072 6574 7572 6e20 6120 6e65  r to return a ne
-00021ea0: 7720 5365 7269 6573 206f 7220 6d6f 6469  w Series or modi
-00021eb0: 6679 2074 6869 7320 6f6e 6520 696e 706c  fy this one inpl
-00021ec0: 6163 652e 0a20 2020 2020 2020 2073 6f72  ace..        sor
-00021ed0: 7465 645f 696e 6465 7820 3a20 626f 6f6c  ted_index : bool
-00021ee0: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
-00021ef0: 2020 2020 2020 2020 2020 2020 4966 2074              If t
-00021f00: 7275 652c 2074 6865 206f 7574 7075 7420  rue, the output 
-00021f10: 6060 5365 7269 6573 6060 2077 696c 6c20  ``Series`` will 
-00021f20: 6861 7665 206b 6e6f 776e 2064 6976 6973  have known divis
-00021f30: 696f 6e73 2069 6e66 6572 7265 640a 2020  ions inferred.  
-00021f40: 2020 2020 2020 2020 2020 6672 6f6d 2074            from t
-00021f50: 6865 2069 6e70 7574 2073 6572 6965 7320  he input series 
-00021f60: 616e 6420 7468 6520 7472 616e 7366 6f72  and the transfor
-00021f70: 6d61 7469 6f6e 2e20 4967 6e6f 7265 6420  mation. Ignored 
-00021f80: 666f 720a 2020 2020 2020 2020 2020 2020  for.            
-00021f90: 6e6f 6e2d 6361 6c6c 6162 6c65 2f64 6963  non-callable/dic
-00021fa0: 742d 6c69 6b65 2060 6069 6e64 6578 6060  t-like ``index``
-00021fb0: 206f 7220 7768 656e 2074 6865 2069 6e70   or when the inp
-00021fc0: 7574 2073 6572 6965 7320 6861 730a 2020  ut series has.  
-00021fd0: 2020 2020 2020 2020 2020 756e 6b6e 6f77            unknow
-00021fe0: 6e20 6469 7669 7369 6f6e 732e 204e 6f74  n divisions. Not
-00021ff0: 6520 7468 6174 2074 6869 7320 6d61 7920  e that this may 
-00022000: 6f6e 6c79 2062 6520 7365 7420 746f 2060  only be set to `
-00022010: 6054 7275 6560 6020 6966 0a20 2020 2020  `True`` if.     
-00022020: 2020 2020 2020 2079 6f75 206b 6e6f 7720         you know 
-00022030: 7468 6174 2074 6865 2074 7261 6e73 666f  that the transfo
-00022040: 726d 6564 2069 6e64 6578 2069 7320 6d6f  rmed index is mo
-00022050: 6e6f 746f 6e69 6361 6c6c 7920 696e 6372  notonically incr
-00022060: 6561 7369 6e67 2e20 4461 736b 0a20 2020  easing. Dask.   
-00022070: 2020 2020 2020 2020 2077 696c 6c20 6368           will ch
-00022080: 6563 6b20 7468 6174 2074 7261 6e73 666f  eck that transfo
-00022090: 726d 6564 2064 6976 6973 696f 6e73 2061  rmed divisions a
-000220a0: 7265 206d 6f6e 6f74 6f6e 6963 2c20 6275  re monotonic, bu
-000220b0: 7420 6361 6e6e 6f74 0a20 2020 2020 2020  t cannot.       
-000220c0: 2020 2020 2063 6865 636b 2061 6c6c 2074       check all t
-000220d0: 6865 2076 616c 7565 7320 6265 7477 6565  he values betwee
-000220e0: 6e20 6469 7669 7369 6f6e 732c 2073 6f20  n divisions, so 
-000220f0: 696e 636f 7272 6563 746c 7920 7365 7474  incorrectly sett
-00022100: 696e 6720 7468 6973 0a20 2020 2020 2020  ing this.       
-00022110: 2020 2020 2063 616e 2072 6573 756c 7420       can result 
-00022120: 696e 2062 7567 732e 0a0a 2020 2020 2020  in bugs...      
-00022130: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-00022140: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00022150: 2020 7265 6e61 6d65 6420 3a20 5365 7269    renamed : Seri
-00022160: 6573 0a0a 2020 2020 2020 2020 5365 6520  es..        See 
-00022170: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
-00022180: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7061  -----.        pa
-00022190: 6e64 6173 2e53 6572 6965 732e 7265 6e61  ndas.Series.rena
-000221a0: 6d65 0a20 2020 2020 2020 2022 2222 0a20  me.        """. 
-000221b0: 2020 2020 2020 2066 726f 6d20 7061 6e64         from pand
-000221c0: 6173 2e61 7069 2e74 7970 6573 2069 6d70  as.api.types imp
-000221d0: 6f72 7420 6973 5f64 6963 745f 6c69 6b65  ort is_dict_like
-000221e0: 2c20 6973 5f6c 6973 745f 6c69 6b65 2c20  , is_list_like, 
-000221f0: 6973 5f73 6361 6c61 720a 0a20 2020 2020  is_scalar..     
-00022200: 2020 2069 6d70 6f72 7420 6461 736b 2e64     import dask.d
-00022210: 6174 6166 7261 6d65 2061 7320 6464 0a0a  ataframe as dd..
-00022220: 2020 2020 2020 2020 6966 2069 735f 7363          if is_sc
-00022230: 616c 6172 2869 6e64 6578 2920 6f72 2028  alar(index) or (
-00022240: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
-00022250: 6c69 7374 5f6c 696b 6528 696e 6465 7829  list_like(index)
-00022260: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00022270: 206e 6f74 2069 735f 6469 6374 5f6c 696b   not is_dict_lik
-00022280: 6528 696e 6465 7829 0a20 2020 2020 2020  e(index).       
-00022290: 2020 2020 2061 6e64 206e 6f74 2069 7369       and not isi
-000222a0: 6e73 7461 6e63 6528 696e 6465 782c 2064  nstance(index, d
-000222b0: 642e 5365 7269 6573 290a 2020 2020 2020  d.Series).      
-000222c0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-000222d0: 2069 6620 696e 706c 6163 653a 0a20 2020   if inplace:.   
-000222e0: 2020 2020 2020 2020 2020 2020 2077 6172               war
-000222f0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-00022300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022310: 2227 696e 706c 6163 6527 2061 7267 756d  "'inplace' argum
-00022320: 656e 7420 666f 7220 6461 736b 2073 6572  ent for dask ser
-00022330: 6965 7320 7769 6c6c 2062 6520 7265 6d6f  ies will be remo
-00022340: 7665 6420 696e 2066 7574 7572 6520 7665  ved in future ve
-00022350: 7273 696f 6e73 222c 0a20 2020 2020 2020  rsions",.       
-00022360: 2020 2020 2020 2020 2020 2020 2050 656e               Pen
-00022370: 6469 6e67 4465 7072 6563 6174 696f 6e57  dingDeprecationW
-00022380: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
-00022390: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000223a0: 2020 2020 2020 7265 7320 3d20 7365 6c66        res = self
-000223b0: 2069 6620 696e 706c 6163 6520 656c 7365   if inplace else
-000223c0: 2073 656c 662e 636f 7079 2829 0a20 2020   self.copy().   
-000223d0: 2020 2020 2020 2020 2072 6573 2e6e 616d           res.nam
-000223e0: 6520 3d20 696e 6465 780a 2020 2020 2020  e = index.      
-000223f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00022400: 2020 2020 7265 7320 3d20 7365 6c66 2e6d      res = self.m
-00022410: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
-00022420: 7265 6e61 6d65 2c20 696e 6465 782c 2065  rename, index, e
-00022430: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
-00022440: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
-00022450: 2020 2069 6620 7365 6c66 2e6b 6e6f 776e     if self.known
-00022460: 5f64 6976 6973 696f 6e73 3a0a 2020 2020  _divisions:.    
-00022470: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00022480: 6f72 7465 645f 696e 6465 7820 616e 6420  orted_index and 
-00022490: 2863 616c 6c61 626c 6528 696e 6465 7829  (callable(index)
-000224a0: 206f 7220 6973 5f64 6963 745f 6c69 6b65   or is_dict_like
-000224b0: 2869 6e64 6578 2929 3a0a 2020 2020 2020  (index)):.      
-000224c0: 2020 2020 2020 2020 2020 2020 2020 6f6c                ol
-000224d0: 6420 3d20 7064 2e53 6572 6965 7328 7261  d = pd.Series(ra
-000224e0: 6e67 6528 7365 6c66 2e6e 7061 7274 6974  nge(self.npartit
-000224f0: 696f 6e73 202b 2031 292c 2069 6e64 6578  ions + 1), index
-00022500: 3d73 656c 662e 6469 7669 7369 6f6e 7329  =self.divisions)
-00022510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022520: 2020 2020 206e 6577 203d 206f 6c64 2e72       new = old.r
-00022530: 656e 616d 6528 696e 6465 7829 2e69 6e64  ename(index).ind
-00022540: 6578 0a20 2020 2020 2020 2020 2020 2020  ex.             
-00022550: 2020 2020 2020 2069 6620 6e6f 7420 6e65         if not ne
-00022560: 772e 6973 5f6d 6f6e 6f74 6f6e 6963 5f69  w.is_monotonic_i
-00022570: 6e63 7265 6173 696e 673a 0a20 2020 2020  ncreasing:.     
-00022580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022590: 2020 206d 7367 203d 2028 0a20 2020 2020     msg = (.     
-000225a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000225b0: 2020 2020 2020 2022 736f 7274 6564 5f69         "sorted_i
-000225c0: 6e64 6578 3d54 7275 652c 2062 7574 2074  ndex=True, but t
-000225d0: 6865 2074 7261 6e73 666f 726d 6564 2069  he transformed i
-000225e0: 6e64 6578 2022 0a20 2020 2020 2020 2020  ndex ".         
-000225f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022600: 2020 2022 6973 6e27 7420 6d6f 6e6f 746f     "isn't monoto
-00022610: 6e69 635f 696e 6372 6561 7369 6e67 220a  nic_increasing".
-00022620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022630: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00022640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022650: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00022660: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
-00022670: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00022680: 5f64 6976 6973 696f 6e73 203d 2074 7570  _divisions = tup
-00022690: 6c65 286d 6574 686f 6473 2e74 6f6c 6973  le(methods.tolis
-000226a0: 7428 6e65 7729 290a 2020 2020 2020 2020  t(new)).        
-000226b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000226c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000226d0: 2020 7265 7320 3d20 7265 732e 636c 6561    res = res.clea
-000226e0: 725f 6469 7669 7369 6f6e 7328 290a 2020  r_divisions().  
-000226f0: 2020 2020 2020 2020 2020 6966 2069 6e70            if inp
-00022700: 6c61 6365 3a0a 2020 2020 2020 2020 2020  lace:.          
-00022710: 2020 2020 2020 7365 6c66 2e64 6173 6b20        self.dask 
-00022720: 3d20 7265 732e 6461 736b 0a20 2020 2020  = res.dask.     
-00022730: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00022740: 5f6e 616d 6520 3d20 7265 732e 5f6e 616d  _name = res._nam
-00022750: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00022760: 2020 7365 6c66 2e5f 6469 7669 7369 6f6e    self._division
-00022770: 7320 3d20 7265 732e 6469 7669 7369 6f6e  s = res.division
-00022780: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00022790: 2020 7365 6c66 2e5f 6d65 7461 203d 2072    self._meta = r
-000227a0: 6573 2e5f 6d65 7461 0a20 2020 2020 2020  es._meta.       
-000227b0: 2020 2020 2020 2020 2072 6573 203d 2073           res = s
-000227c0: 656c 660a 2020 2020 2020 2020 7265 7475  elf.        retu
-000227d0: 726e 2072 6573 0a0a 2020 2020 4064 6572  rn res..    @der
-000227e0: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
-000227f0: 6965 7329 0a20 2020 2064 6566 2072 6f75  ies).    def rou
-00022800: 6e64 2873 656c 662c 2064 6563 696d 616c  nd(self, decimal
-00022810: 733d 3029 3a0a 2020 2020 2020 2020 7265  s=0):.        re
-00022820: 7475 726e 2065 6c65 6d77 6973 6528 4d2e  turn elemwise(M.
-00022830: 726f 756e 642c 2073 656c 662c 2064 6563  round, self, dec
-00022840: 696d 616c 7329 0a0a 2020 2020 4064 6572  imals)..    @der
-00022850: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00022860: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00022870: 746f 5f74 696d 6573 7461 6d70 2873 656c  to_timestamp(sel
-00022880: 662c 2066 7265 713d 4e6f 6e65 2c20 686f  f, freq=None, ho
-00022890: 773d 2273 7461 7274 222c 2061 7869 733d  w="start", axis=
-000228a0: 3029 3a0a 2020 2020 2020 2020 6466 203d  0):.        df =
-000228b0: 2065 6c65 6d77 6973 6528 4d2e 746f 5f74   elemwise(M.to_t
-000228c0: 696d 6573 7461 6d70 2c20 7365 6c66 2c20  imestamp, self, 
-000228d0: 6672 6571 2c20 686f 772c 2061 7869 7329  freq, how, axis)
-000228e0: 0a20 2020 2020 2020 2064 662e 6469 7669  .        df.divi
-000228f0: 7369 6f6e 7320 3d20 7475 706c 6528 7064  sions = tuple(pd
-00022900: 2e49 6e64 6578 2873 656c 662e 6469 7669  .Index(self.divi
-00022910: 7369 6f6e 7329 2e74 6f5f 7469 6d65 7374  sions).to_timest
-00022920: 616d 7028 2929 0a20 2020 2020 2020 2072  amp()).        r
-00022930: 6574 7572 6e20 6466 0a0a 2020 2020 6465  eturn df..    de
-00022940: 6620 7175 616e 7469 6c65 2873 656c 662c  f quantile(self,
-00022950: 2071 3d30 2e35 2c20 6d65 7468 6f64 3d22   q=0.5, method="
-00022960: 6465 6661 756c 7422 293a 0a20 2020 2020  default"):.     
-00022970: 2020 2022 2222 4170 7072 6f78 696d 6174     """Approximat
-00022980: 6520 7175 616e 7469 6c65 7320 6f66 2053  e quantiles of S
-00022990: 6572 6965 730a 0a20 2020 2020 2020 2050  eries..        P
-000229a0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-000229b0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-000229c0: 2020 2020 2071 203a 206c 6973 742f 6172       q : list/ar
-000229d0: 7261 7920 6f66 2066 6c6f 6174 732c 2064  ray of floats, d
-000229e0: 6566 6175 6c74 2030 2e35 2028 3530 2529  efault 0.5 (50%)
-000229f0: 0a20 2020 2020 2020 2020 2020 2049 7465  .            Ite
-00022a00: 7261 626c 6520 6f66 206e 756d 6265 7273  rable of numbers
-00022a10: 2072 616e 6769 6e67 2066 726f 6d20 3020   ranging from 0 
-00022a20: 746f 2031 2066 6f72 2074 6865 2064 6573  to 1 for the des
-00022a30: 6972 6564 2071 7561 6e74 696c 6573 0a20  ired quantiles. 
-00022a40: 2020 2020 2020 206d 6574 686f 6420 3a20         method : 
-00022a50: 7b27 6465 6661 756c 7427 2c20 2774 6469  {'default', 'tdi
-00022a60: 6765 7374 272c 2027 6461 736b 277d 2c20  gest', 'dask'}, 
-00022a70: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00022a80: 2020 2020 2057 6861 7420 6d65 7468 6f64       What method
-00022a90: 2074 6f20 7573 652e 2042 7920 6465 6661   to use. By defa
-00022aa0: 756c 7420 7769 6c6c 2075 7365 2064 6173  ult will use das
-00022ab0: 6b27 7320 696e 7465 726e 616c 2063 7573  k's internal cus
-00022ac0: 746f 6d0a 2020 2020 2020 2020 2020 2020  tom.            
-00022ad0: 616c 676f 7269 7468 6d20 2860 6027 6461  algorithm (``'da
-00022ae0: 736b 2760 6029 2e20 2049 6620 7365 7420  sk'``).  If set 
-00022af0: 746f 2060 6027 7464 6967 6573 7427 6060  to ``'tdigest'``
-00022b00: 2077 696c 6c20 7573 6520 7464 6967 6573   will use tdiges
-00022b10: 740a 2020 2020 2020 2020 2020 2020 666f  t.            fo
-00022b20: 7220 666c 6f61 7473 2061 6e64 2069 6e74  r floats and int
-00022b30: 7320 616e 6420 6661 6c6c 6261 636b 2074  s and fallback t
-00022b40: 6f20 7468 6520 6060 2764 6173 6b27 6060  o the ``'dask'``
-00022b50: 206f 7468 6572 7769 7365 2e0a 2020 2020   otherwise..    
-00022b60: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00022b70: 7265 7475 726e 2071 7561 6e74 696c 6528  return quantile(
-00022b80: 7365 6c66 2c20 712c 206d 6574 686f 643d  self, q, method=
-00022b90: 6d65 7468 6f64 290a 0a20 2020 2064 6566  method)..    def
-00022ba0: 206d 6564 6961 6e5f 6170 7072 6f78 696d   median_approxim
-00022bb0: 6174 6528 7365 6c66 2c20 6d65 7468 6f64  ate(self, method
-00022bc0: 3d22 6465 6661 756c 7422 293a 0a20 2020  ="default"):.   
-00022bd0: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
-00022be0: 6865 2061 7070 726f 7869 6d61 7465 206d  he approximate m
-00022bf0: 6564 6961 6e20 6f66 2074 6865 2076 616c  edian of the val
-00022c00: 7565 7320 6f76 6572 2074 6865 2072 6571  ues over the req
-00022c10: 7565 7374 6564 2061 7869 732e 0a0a 2020  uested axis...  
-00022c20: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00022c30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00022c40: 2d2d 2d0a 2020 2020 2020 2020 6d65 7468  ---.        meth
-00022c50: 6f64 203a 207b 2764 6566 6175 6c74 272c  od : {'default',
-00022c60: 2027 7464 6967 6573 7427 2c20 2764 6173   'tdigest', 'das
-00022c70: 6b27 7d2c 206f 7074 696f 6e61 6c0a 2020  k'}, optional.  
-00022c80: 2020 2020 2020 2020 2020 5768 6174 206d            What m
-00022c90: 6574 686f 6420 746f 2075 7365 2e20 4279  ethod to use. By
-00022ca0: 2064 6566 6175 6c74 2077 696c 6c20 7573   default will us
-00022cb0: 6520 4461 736b 2773 2069 6e74 6572 6e61  e Dask's interna
-00022cc0: 6c20 6375 7374 6f6d 0a20 2020 2020 2020  l custom.       
-00022cd0: 2020 2020 2061 6c67 6f72 6974 686d 2028       algorithm (
-00022ce0: 6060 2264 6173 6b22 6060 292e 2020 4966  ``"dask"``).  If
-00022cf0: 2073 6574 2074 6f20 6060 2274 6469 6765   set to ``"tdige
-00022d00: 7374 2260 6020 7769 6c6c 2075 7365 2074  st"`` will use t
-00022d10: 6469 6765 7374 0a20 2020 2020 2020 2020  digest.         
-00022d20: 2020 2066 6f72 2066 6c6f 6174 7320 616e     for floats an
-00022d30: 6420 696e 7473 2061 6e64 2066 616c 6c62  d ints and fallb
-00022d40: 6163 6b20 746f 2074 6865 2060 6022 6461  ack to the ``"da
-00022d50: 736b 2260 6020 6f74 6865 7277 6973 652e  sk"`` otherwise.
-00022d60: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00022d70: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00022d80: 2e71 7561 6e74 696c 6528 713d 302e 352c  .quantile(q=0.5,
-00022d90: 206d 6574 686f 643d 6d65 7468 6f64 290a   method=method).
-00022da0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00022db0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-00022dc0: 2020 6465 6620 6d65 6469 616e 2873 656c    def median(sel
-00022dd0: 662c 206d 6574 686f 643d 2264 6566 6175  f, method="defau
-00022de0: 6c74 2229 3a0a 2020 2020 2020 2020 6966  lt"):.        if
-00022df0: 2073 656c 662e 6e70 6172 7469 7469 6f6e   self.npartition
-00022e00: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
-00022e10: 2020 2020 2320 4361 6e20 7072 6f76 6964      # Can provid
-00022e20: 6520 616e 2065 7861 6374 206d 6564 6961  e an exact media
-00022e30: 6e20 696e 2074 6865 7365 2063 6173 6573  n in these cases
-00022e40: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00022e50: 7572 6e20 7365 6c66 2e6d 6564 6961 6e5f  urn self.median_
-00022e60: 6170 7072 6f78 696d 6174 6528 6d65 7468  approximate(meth
-00022e70: 6f64 3d6d 6574 686f 6429 0a20 2020 2020  od=method).     
-00022e80: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00022e90: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-00022ea0: 2020 2020 2020 2020 2020 2244 6173 6b20            "Dask 
-00022eb0: 646f 6573 6e27 7420 696d 706c 656d 656e  doesn't implemen
-00022ec0: 7420 616e 2065 7861 6374 206d 6564 6961  t an exact media
-00022ed0: 6e20 696e 2061 6c6c 2063 6173 6573 2061  n in all cases a
-00022ee0: 7320 7468 6973 2069 7320 6861 7264 2074  s this is hard t
-00022ef0: 6f20 646f 2069 6e20 7061 7261 6c6c 656c  o do in parallel
-00022f00: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-00022f10: 2253 6565 2074 6865 2060 6d65 6469 616e  "See the `median
-00022f20: 5f61 7070 726f 7869 6d61 7465 6020 6d65  _approximate` me
-00022f30: 7468 6f64 2069 6e73 7465 6164 2c20 7768  thod instead, wh
-00022f40: 6963 6820 7573 6573 2061 6e20 6170 7072  ich uses an appr
-00022f50: 6f78 696d 6174 6520 616c 676f 7269 7468  oximate algorith
-00022f60: 6d2e 220a 2020 2020 2020 2020 290a 0a20  m.".        ).. 
-00022f70: 2020 2064 6566 205f 7265 7061 7274 6974     def _repartit
-00022f80: 696f 6e5f 7175 616e 7469 6c65 7328 7365  ion_quantiles(se
-00022f90: 6c66 2c20 6e70 6172 7469 7469 6f6e 732c  lf, npartitions,
-00022fa0: 2075 7073 616d 706c 653d 312e 3029 3a0a   upsample=1.0):.
-00022fb0: 2020 2020 2020 2020 2222 2241 7070 726f          """Appro
-00022fc0: 7869 6d61 7465 2071 7561 6e74 696c 6573  ximate quantiles
-00022fd0: 206f 6620 5365 7269 6573 2075 7365 6420   of Series used 
-00022fe0: 666f 7220 7265 7061 7274 6974 696f 6e69  for repartitioni
-00022ff0: 6e67 2222 220a 2020 2020 2020 2020 6672  ng""".        fr
-00023000: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
-00023010: 652e 7061 7274 6974 696f 6e71 7561 6e74  e.partitionquant
-00023020: 696c 6573 2069 6d70 6f72 7420 7061 7274  iles import part
-00023030: 6974 696f 6e5f 7175 616e 7469 6c65 730a  ition_quantiles.
-00023040: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00023050: 7061 7274 6974 696f 6e5f 7175 616e 7469  partition_quanti
-00023060: 6c65 7328 7365 6c66 2c20 6e70 6172 7469  les(self, nparti
-00023070: 7469 6f6e 732c 2075 7073 616d 706c 653d  tions, upsample=
-00023080: 7570 7361 6d70 6c65 290a 0a20 2020 2064  upsample)..    d
-00023090: 6566 205f 5f67 6574 6974 656d 5f5f 2873  ef __getitem__(s
-000230a0: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
-000230b0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-000230c0: 286b 6579 2c20 5365 7269 6573 2920 616e  (key, Series) an
-000230d0: 6420 7365 6c66 2e64 6976 6973 696f 6e73  d self.divisions
-000230e0: 203d 3d20 6b65 792e 6469 7669 7369 6f6e   == key.division
-000230f0: 733a 0a20 2020 2020 2020 2020 2020 206e  s:.            n
-00023100: 616d 6520 3d20 2269 6e64 6578 2d25 7322  ame = "index-%s"
-00023110: 2025 2074 6f6b 656e 697a 6528 7365 6c66   % tokenize(self
-00023120: 2c20 6b65 7929 0a20 2020 2020 2020 2020  , key).         
-00023130: 2020 2064 736b 203d 2070 6172 7469 7469     dsk = partiti
-00023140: 6f6e 7769 7365 5f67 7261 7068 286f 7065  onwise_graph(ope
-00023150: 7261 746f 722e 6765 7469 7465 6d2c 206e  rator.getitem, n
-00023160: 616d 652c 2073 656c 662c 206b 6579 290a  ame, self, key).
-00023170: 2020 2020 2020 2020 2020 2020 6772 6170              grap
-00023180: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
-00023190: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
-000231a0: 6f6e 7328 6e61 6d65 2c20 6473 6b2c 2064  ons(name, dsk, d
-000231b0: 6570 656e 6465 6e63 6965 733d 5b73 656c  ependencies=[sel
-000231c0: 662c 206b 6579 5d29 0a20 2020 2020 2020  f, key]).       
-000231d0: 2020 2020 2072 6574 7572 6e20 5365 7269       return Seri
-000231e0: 6573 2867 7261 7068 2c20 6e61 6d65 2c20  es(graph, name, 
-000231f0: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
-00023200: 2e64 6976 6973 696f 6e73 290a 2020 2020  .divisions).    
-00023210: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00023220: 6c6f 635b 6b65 795d 0a0a 2020 2020 4064  loc[key]..    @d
-00023230: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00023240: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00023250: 6620 5f67 6574 5f6e 756d 6572 6963 5f64  f _get_numeric_d
-00023260: 6174 6128 7365 6c66 2c20 686f 773d 2261  ata(self, how="a
-00023270: 6e79 222c 2073 7562 7365 743d 4e6f 6e65  ny", subset=None
-00023280: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00023290: 6e20 7365 6c66 0a0a 2020 2020 6966 206e  n self..    if n
-000232a0: 6f74 2050 414e 4441 535f 4754 5f32 3030  ot PANDAS_GT_200
-000232b0: 3a0a 0a20 2020 2020 2020 2040 6465 7269  :..        @deri
-000232c0: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
-000232d0: 6573 290a 2020 2020 2020 2020 6465 6620  es).        def 
-000232e0: 6974 6572 6974 656d 7328 7365 6c66 293a  iteritems(self):
-000232f0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00023300: 5041 4e44 4153 5f47 545f 3135 303a 0a20  PANDAS_GT_150:. 
-00023310: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-00023320: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-00023330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023340: 2020 2269 7465 7269 7465 6d73 2069 7320    "iteritems is 
-00023350: 6465 7072 6563 6174 6564 2061 6e64 2077  deprecated and w
-00023360: 696c 6c20 6265 2072 656d 6f76 6564 2069  ill be removed i
-00023370: 6e20 6120 6675 7475 7265 2076 6572 7369  n a future versi
-00023380: 6f6e 2e20 220a 2020 2020 2020 2020 2020  on. ".          
-00023390: 2020 2020 2020 2020 2020 2255 7365 202e            "Use .
-000233a0: 6974 656d 7320 696e 7374 6561 642e 222c  items instead.",
-000233b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000233c0: 2020 2020 2046 7574 7572 6557 6172 6e69       FutureWarni
-000233d0: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
-000233e0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000233f0: 2020 2320 5765 2075 7365 2074 6865 2060    # We use the `
-00023400: 5f60 2067 656e 6572 6174 6f72 2062 656c  _` generator bel
-00023410: 6f77 2074 6f20 656e 7375 7265 2074 6865  ow to ensure the
-00023420: 2064 6570 7265 6361 7469 6f6e 2077 6172   deprecation war
-00023430: 6e69 6e67 2061 626f 7665 0a20 2020 2020  ning above.     
-00023440: 2020 2020 2020 2023 2069 7320 7261 6973         # is rais
-00023450: 6564 2077 6865 6e20 602e 6974 6572 6974  ed when `.iterit
-00023460: 656d 7328 2960 2069 7320 6361 6c6c 6564  ems()` is called
-00023470: 2c20 6e6f 7420 7768 656e 2074 6865 2066  , not when the f
-00023480: 6972 7374 2060 6e65 7874 283c 6765 6e65  irst `next(<gene
-00023490: 7261 746f 723e 2960 0a20 2020 2020 2020  rator>)`.       
-000234a0: 2020 2020 2023 2069 7465 7261 7469 6f6e       # iteration
-000234b0: 2068 6170 7065 6e73 0a0a 2020 2020 2020   happens..      
-000234c0: 2020 2020 2020 6465 6620 5f28 7365 6c66        def _(self
-000234d0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000234e0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-000234f0: 6528 7365 6c66 2e6e 7061 7274 6974 696f  e(self.npartitio
-00023500: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
-00023510: 2020 2020 2020 2020 2073 203d 2073 656c           s = sel
-00023520: 662e 6765 745f 7061 7274 6974 696f 6e28  f.get_partition(
-00023530: 6929 2e63 6f6d 7075 7465 2829 0a20 2020  i).compute().   
-00023540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023550: 2079 6965 6c64 2066 726f 6d20 732e 6974   yield from s.it
-00023560: 656d 7328 290a 0a20 2020 2020 2020 2020  ems()..         
-00023570: 2020 2072 6574 7572 6e20 5f28 7365 6c66     return _(self
-00023580: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00023590: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
-000235a0: 2020 2020 6465 6620 5f5f 6974 6572 5f5f      def __iter__
-000235b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000235c0: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
-000235d0: 656c 662e 6e70 6172 7469 7469 6f6e 7329  elf.npartitions)
-000235e0: 3a0a 2020 2020 2020 2020 2020 2020 7320  :.            s 
-000235f0: 3d20 7365 6c66 2e67 6574 5f70 6172 7469  = self.get_parti
-00023600: 7469 6f6e 2869 292e 636f 6d70 7574 6528  tion(i).compute(
-00023610: 290a 2020 2020 2020 2020 2020 2020 7969  ).            yi
-00023620: 656c 6420 6672 6f6d 2073 0a0a 2020 2020  eld from s..    
-00023630: 405f 6465 7072 6563 6174 6564 280a 2020  @_deprecated(.  
-00023640: 2020 2020 2020 6d65 7373 6167 653d 280a        message=(.
-00023650: 2020 2020 2020 2020 2020 2020 2255 7369              "Usi
-00023660: 6e67 2074 6865 2060 6069 6e60 6020 6f70  ng the ``in`` op
-00023670: 6572 6174 6f72 2074 6f20 7465 7374 2066  erator to test f
-00023680: 6f72 206d 656d 6265 7273 6869 7020 696e  or membership in
-00023690: 2053 6572 6965 7320 6973 2022 0a20 2020   Series is ".   
-000236a0: 2020 2020 2020 2020 2022 6465 7072 6563           "deprec
-000236b0: 6174 6564 2e20 546f 2074 6573 7420 666f  ated. To test fo
-000236c0: 7220 6d65 6d62 6572 7368 6970 2069 6e20  r membership in 
-000236d0: 7468 6520 696e 6465 7820 7573 6520 220a  the index use ".
-000236e0: 2020 2020 2020 2020 2020 2020 2260 6028              "``(
-000236f0: 732e 696e 6465 7820 3d3d 206b 6579 292e  s.index == key).
-00023700: 616e 7928 2960 602e 2053 696d 696c 6172  any()``. Similar
-00023710: 6c79 2074 6f20 7465 7374 2066 6f72 206d  ly to test for m
-00023720: 656d 6265 7273 6869 7020 696e 2022 0a20  embership in ". 
-00023730: 2020 2020 2020 2020 2020 2022 7468 6520             "the 
-00023740: 7661 6c75 6573 2075 7365 2060 6028 7320  values use ``(s 
-00023750: 3d3d 206b 6579 292e 616e 7928 2960 6022  == key).any()``"
-00023760: 0a20 2020 2020 2020 2029 0a20 2020 2029  .        ).    )
-00023770: 0a20 2020 2064 6566 205f 5f63 6f6e 7461  .    def __conta
-00023780: 696e 735f 5f28 7365 6c66 2c20 6b65 7929  ins__(self, key)
-00023790: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000237a0: 2028 7365 6c66 203d 3d20 6b65 7929 2e61   (self == key).a
-000237b0: 6e79 2829 2e63 6f6d 7075 7465 2829 0a0a  ny().compute()..
-000237c0: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-000237d0: 0a20 2020 2064 6566 205f 7661 6c69 6461  .    def _valida
-000237e0: 7465 5f61 7869 7328 636c 732c 2061 7869  te_axis(cls, axi
-000237f0: 733d 302c 206e 6f6e 655f 6973 5f7a 6572  s=0, none_is_zer
-00023800: 6f3a 2062 6f6f 6c20 3d20 5472 7565 2920  o: bool = True) 
-00023810: 2d3e 204e 6f6e 6520 7c20 4c69 7465 7261  -> None | Litera
-00023820: 6c5b 302c 2031 5d3a 0a20 2020 2020 2020  l[0, 1]:.       
-00023830: 2069 6620 6178 6973 206e 6f74 2069 6e20   if axis not in 
-00023840: 2830 2c20 2269 6e64 6578 222c 204e 6f6e  (0, "index", Non
-00023850: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00023860: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00023870: 2866 224e 6f20 6178 6973 206e 616d 6564  (f"No axis named
-00023880: 207b 6178 6973 7d22 290a 2020 2020 2020   {axis}").      
-00023890: 2020 2320 636f 6e76 6572 7420 746f 206e    # convert to n
-000238a0: 756d 6572 6963 2061 7869 730a 2020 2020  umeric axis.    
-000238b0: 2020 2020 6e75 6d65 7269 635f 6178 6973      numeric_axis
-000238c0: 3a20 6469 6374 5b73 7472 207c 204e 6f6e  : dict[str | Non
-000238d0: 652c 204c 6974 6572 616c 5b30 2c20 315d  e, Literal[0, 1]
-000238e0: 5d20 3d20 7b22 696e 6465 7822 3a20 307d  ] = {"index": 0}
-000238f0: 0a20 2020 2020 2020 2069 6620 6e6f 6e65  .        if none
-00023900: 5f69 735f 7a65 726f 3a0a 2020 2020 2020  _is_zero:.      
-00023910: 2020 2020 2020 6e75 6d65 7269 635f 6178        numeric_ax
-00023920: 6973 5b4e 6f6e 655d 203d 2030 0a20 2020  is[None] = 0.   
-00023930: 2020 2020 2072 6574 7572 6e20 6e75 6d65       return nume
-00023940: 7269 635f 6178 6973 2e67 6574 2861 7869  ric_axis.get(axi
-00023950: 732c 2061 7869 7329 0a0a 2020 2020 4064  s, axis)..    @d
-00023960: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-00023970: 6572 6965 7329 0a20 2020 2064 6566 2067  eries).    def g
-00023980: 726f 7570 6279 280a 2020 2020 2020 2020  roupby(.        
-00023990: 7365 6c66 2c0a 2020 2020 2020 2020 6279  self,.        by
-000239a0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2067  =None,.        g
-000239b0: 726f 7570 5f6b 6579 733d 4752 4f55 505f  roup_keys=GROUP_
-000239c0: 4b45 5953 5f44 4546 4155 4c54 2c0a 2020  KEYS_DEFAULT,.  
-000239d0: 2020 2020 2020 736f 7274 3d4e 6f6e 652c        sort=None,
-000239e0: 0a20 2020 2020 2020 206f 6273 6572 7665  .        observe
-000239f0: 643d 4e6f 6e65 2c0a 2020 2020 2020 2020  d=None,.        
-00023a00: 6472 6f70 6e61 3d4e 6f6e 652c 0a20 2020  dropna=None,.   
-00023a10: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
-00023a20: 2020 2029 3a0a 2020 2020 2020 2020 6672     ):.        fr
-00023a30: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
-00023a40: 652e 6772 6f75 7062 7920 696d 706f 7274  e.groupby import
-00023a50: 2053 6572 6965 7347 726f 7570 4279 0a0a   SeriesGroupBy..
-00023a60: 2020 2020 2020 2020 7265 7475 726e 2053          return S
-00023a70: 6572 6965 7347 726f 7570 4279 280a 2020  eriesGroupBy(.  
-00023a80: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-00023a90: 2020 2020 2020 2020 2020 2020 6279 3d62              by=b
-00023aa0: 792c 0a20 2020 2020 2020 2020 2020 2067  y,.            g
-00023ab0: 726f 7570 5f6b 6579 733d 6772 6f75 705f  roup_keys=group_
-00023ac0: 6b65 7973 2c0a 2020 2020 2020 2020 2020  keys,.          
-00023ad0: 2020 736f 7274 3d73 6f72 742c 0a20 2020    sort=sort,.   
-00023ae0: 2020 2020 2020 2020 206f 6273 6572 7665           observe
-00023af0: 643d 6f62 7365 7276 6564 2c0a 2020 2020  d=observed,.    
-00023b00: 2020 2020 2020 2020 6472 6f70 6e61 3d64          dropna=d
-00023b10: 726f 706e 612c 0a20 2020 2020 2020 2020  ropna,.         
-00023b20: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
-00023b30: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-00023b40: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
-00023b50: 6965 7329 0a20 2020 2064 6566 2063 6f75  ies).    def cou
-00023b60: 6e74 2873 656c 662c 2073 706c 6974 5f65  nt(self, split_e
-00023b70: 7665 7279 3d46 616c 7365 293a 0a20 2020  very=False):.   
-00023b80: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
-00023b90: 7228 292e 636f 756e 7428 7370 6c69 745f  r().count(split_
-00023ba0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-00023bb0: 7929 0a0a 2020 2020 4064 6572 6976 6564  y)..    @derived
-00023bc0: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00023bd0: 0a20 2020 2064 6566 206d 6f64 6528 7365  .    def mode(se
-00023be0: 6c66 2c20 6472 6f70 6e61 3d54 7275 652c  lf, dropna=True,
-00023bf0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-00023c00: 7365 293a 0a20 2020 2020 2020 2072 6574  se):.        ret
-00023c10: 7572 6e20 7375 7065 7228 292e 6d6f 6465  urn super().mode
-00023c20: 2864 726f 706e 613d 6472 6f70 6e61 2c20  (dropna=dropna, 
-00023c30: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00023c40: 745f 6576 6572 7929 0a0a 2020 2020 4064  t_every)..    @d
-00023c50: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-00023c60: 6572 6965 7329 0a20 2020 2064 6566 2065  eries).    def e
-00023c70: 7870 6c6f 6465 2873 656c 6629 3a0a 2020  xplode(self):.  
-00023c80: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
-00023c90: 662e 5f6d 6574 612e 6578 706c 6f64 6528  f._meta.explode(
-00023ca0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00023cb0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-00023cc0: 696f 6e73 284d 2e65 7870 6c6f 6465 2c20  ions(M.explode, 
-00023cd0: 6d65 7461 3d6d 6574 612c 2065 6e66 6f72  meta=meta, enfor
-00023ce0: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-00023cf0: 6529 0a0a 2020 2020 6465 6620 756e 6971  e)..    def uniq
-00023d00: 7565 2873 656c 662c 2073 706c 6974 5f65  ue(self, split_e
-00023d10: 7665 7279 3d4e 6f6e 652c 2073 706c 6974  very=None, split
-00023d20: 5f6f 7574 3d31 293a 0a20 2020 2020 2020  _out=1):.       
-00023d30: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-00023d40: 7572 6e20 5365 7269 6573 206f 6620 756e  urn Series of un
-00023d50: 6971 7565 2076 616c 7565 7320 696e 2074  ique values in t
-00023d60: 6865 206f 626a 6563 742e 2049 6e63 6c75  he object. Inclu
-00023d70: 6465 7320 4e41 2076 616c 7565 732e 0a0a  des NA values...
-00023d80: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-00023d90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-00023da0: 2020 2020 2020 2020 756e 6971 7565 7320          uniques 
-00023db0: 3a20 5365 7269 6573 0a20 2020 2020 2020  : Series.       
-00023dc0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00023dd0: 7572 6e20 6163 6128 0a20 2020 2020 2020  urn aca(.       
-00023de0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00023df0: 2020 2020 2020 2063 6875 6e6b 3d6d 6574         chunk=met
-00023e00: 686f 6473 2e75 6e69 7175 652c 0a20 2020  hods.unique,.   
-00023e10: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
-00023e20: 7465 3d6d 6574 686f 6473 2e75 6e69 7175  te=methods.uniqu
-00023e30: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
-00023e40: 6574 613d 7365 6c66 2e5f 6d65 7461 2c0a  eta=self._meta,.
-00023e50: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-00023e60: 6e3d 2275 6e69 7175 6522 2c0a 2020 2020  n="unique",.    
-00023e70: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-00023e80: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
-00023e90: 0a20 2020 2020 2020 2020 2020 2073 6572  .            ser
-00023ea0: 6965 735f 6e61 6d65 3d73 656c 662e 6e61  ies_name=self.na
-00023eb0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00023ec0: 7370 6c69 745f 6f75 743d 7370 6c69 745f  split_out=split_
-00023ed0: 6f75 742c 0a20 2020 2020 2020 2029 0a0a  out,.        )..
-00023ee0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00023ef0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00023f00: 2064 6566 206e 756e 6971 7565 2873 656c   def nunique(sel
-00023f10: 662c 2073 706c 6974 5f65 7665 7279 3d4e  f, split_every=N
-00023f20: 6f6e 652c 2064 726f 706e 613d 5472 7565  one, dropna=True
-00023f30: 293a 0a20 2020 2020 2020 2075 6e69 7173  ):.        uniqs
-00023f40: 203d 2073 656c 662e 6472 6f70 5f64 7570   = self.drop_dup
-00023f50: 6c69 6361 7465 7328 7370 6c69 745f 6576  licates(split_ev
-00023f60: 6572 793d 7370 6c69 745f 6576 6572 7929  ery=split_every)
-00023f70: 0a20 2020 2020 2020 2069 6620 6472 6f70  .        if drop
-00023f80: 6e61 3a0a 2020 2020 2020 2020 2020 2020  na:.            
-00023f90: 2320 636f 756e 7420 6d69 6d69 6373 2070  # count mimics p
-00023fa0: 616e 6461 7320 6265 6861 7669 6f72 2061  andas behavior a
-00023fb0: 6e64 2065 7863 6c75 6465 7320 4e41 2076  nd excludes NA v
-00023fc0: 616c 7565 730a 2020 2020 2020 2020 2020  alues.          
-00023fd0: 2020 7265 7475 726e 2075 6e69 7173 2e63    return uniqs.c
-00023fe0: 6f75 6e74 2829 0a20 2020 2020 2020 2065  ount().        e
-00023ff0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00024000: 2072 6574 7572 6e20 756e 6971 732e 7369   return uniqs.si
-00024010: 7a65 0a0a 2020 2020 4064 6572 6976 6564  ze..    @derived
-00024020: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00024030: 0a20 2020 2064 6566 2076 616c 7565 5f63  .    def value_c
-00024040: 6f75 6e74 7328 0a20 2020 2020 2020 2073  ounts(.        s
-00024050: 656c 662c 0a20 2020 2020 2020 2073 6f72  elf,.        sor
-00024060: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
-00024070: 6173 6365 6e64 696e 673d 4661 6c73 652c  ascending=False,
-00024080: 0a20 2020 2020 2020 2064 726f 706e 613d  .        dropna=
-00024090: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e6f  None,.        no
-000240a0: 726d 616c 697a 653d 4661 6c73 652c 0a20  rmalize=False,. 
-000240b0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-000240c0: 7279 3d4e 6f6e 652c 0a20 2020 2020 2020  ry=None,.       
-000240d0: 2073 706c 6974 5f6f 7574 3d31 2c0a 2020   split_out=1,.  
-000240e0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-000240f0: 0a20 2020 2020 2020 204e 6f74 653a 2064  .        Note: d
-00024100: 726f 706e 6120 6973 206f 6e6c 7920 7375  ropna is only su
-00024110: 7070 6f72 7465 6420 696e 2070 616e 6461  pported in panda
-00024120: 7320 3e3d 2031 2e31 2e30 2c20 696e 2077  s >= 1.1.0, in w
-00024130: 6869 6368 2063 6173 6520 6974 2064 6566  hich case it def
-00024140: 6175 6c74 7320 746f 0a20 2020 2020 2020  aults to.       
-00024150: 2054 7275 652e 0a20 2020 2020 2020 2022   True..        "
-00024160: 2222 0a20 2020 2020 2020 206b 7761 7267  "".        kwarg
-00024170: 7320 3d20 7b22 736f 7274 223a 2073 6f72  s = {"sort": sor
-00024180: 742c 2022 6173 6365 6e64 696e 6722 3a20  t, "ascending": 
-00024190: 6173 6365 6e64 696e 677d 0a20 2020 2020  ascending}.     
-000241a0: 2020 2069 6620 6472 6f70 6e61 2069 7320     if dropna is 
-000241b0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-000241c0: 2020 2020 2020 6b77 6172 6773 5b22 6472        kwargs["dr
-000241d0: 6f70 6e61 225d 203d 2064 726f 706e 610a  opna"] = dropna.
-000241e0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-000241f0: 655f 6b77 6172 6773 203d 207b 226e 6f72  e_kwargs = {"nor
-00024200: 6d61 6c69 7a65 223a 206e 6f72 6d61 6c69  malize": normali
-00024210: 7a65 7d0a 2020 2020 2020 2020 6966 2073  ze}.        if s
-00024220: 706c 6974 5f6f 7574 203e 2031 3a0a 2020  plit_out > 1:.  
-00024230: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
-00024240: 6174 655f 6b77 6172 6773 5b22 746f 7461  ate_kwargs["tota
-00024250: 6c5f 6c65 6e67 7468 225d 203d 2028 0a20  l_length"] = (. 
-00024260: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00024270: 656e 2873 656c 6629 2069 6620 6472 6f70  en(self) if drop
-00024280: 6e61 2069 7320 4661 6c73 6520 656c 7365  na is False else
-00024290: 206c 656e 2873 656c 662e 6472 6f70 6e61   len(self.dropna
-000242a0: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
-000242b0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-000242c0: 6e20 6163 6128 0a20 2020 2020 2020 2020  n aca(.         
-000242d0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-000242e0: 2020 2020 2063 6875 6e6b 3d4d 2e76 616c       chunk=M.val
-000242f0: 7565 5f63 6f75 6e74 732c 0a20 2020 2020  ue_counts,.     
-00024300: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
-00024310: 3d6d 6574 686f 6473 2e76 616c 7565 5f63  =methods.value_c
-00024320: 6f75 6e74 735f 6167 6772 6567 6174 652c  ounts_aggregate,
-00024330: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-00024340: 6269 6e65 3d6d 6574 686f 6473 2e76 616c  bine=methods.val
-00024350: 7565 5f63 6f75 6e74 735f 636f 6d62 696e  ue_counts_combin
-00024360: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
-00024370: 6574 613d 7365 6c66 2e5f 6d65 7461 2e76  eta=self._meta.v
-00024380: 616c 7565 5f63 6f75 6e74 7328 6e6f 726d  alue_counts(norm
-00024390: 616c 697a 653d 6e6f 726d 616c 697a 6529  alize=normalize)
-000243a0: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
-000243b0: 6b65 6e3d 2276 616c 7565 2d63 6f75 6e74  ken="value-count
-000243c0: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
-000243d0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-000243e0: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
-000243f0: 2020 2020 2073 706c 6974 5f6f 7574 3d73       split_out=s
-00024400: 706c 6974 5f6f 7574 2c0a 2020 2020 2020  plit_out,.      
-00024410: 2020 2020 2020 7370 6c69 745f 6f75 745f        split_out_
-00024420: 7365 7475 703d 7370 6c69 745f 6f75 745f  setup=split_out_
-00024430: 6f6e 5f69 6e64 6578 2c0a 2020 2020 2020  on_index,.      
-00024440: 2020 2020 2020 6167 6772 6567 6174 655f        aggregate_
-00024450: 6b77 6172 6773 3d61 6767 7265 6761 7465  kwargs=aggregate
-00024460: 5f6b 7761 7267 732c 0a20 2020 2020 2020  _kwargs,.       
-00024470: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
-00024480: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-00024490: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
-000244a0: 6572 6965 7329 0a20 2020 2064 6566 206e  eries).    def n
-000244b0: 6c61 7267 6573 7428 7365 6c66 2c20 6e3d  largest(self, n=
-000244c0: 352c 2073 706c 6974 5f65 7665 7279 3d4e  5, split_every=N
-000244d0: 6f6e 6529 3a0a 2020 2020 2020 2020 7265  one):.        re
-000244e0: 7475 726e 2061 6361 280a 2020 2020 2020  turn aca(.      
-000244f0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00024500: 2020 2020 2020 2020 6368 756e 6b3d 4d2e          chunk=M.
-00024510: 6e6c 6172 6765 7374 2c0a 2020 2020 2020  nlargest,.      
-00024520: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
-00024530: 4d2e 6e6c 6172 6765 7374 2c0a 2020 2020  M.nlargest,.    
-00024540: 2020 2020 2020 2020 6d65 7461 3d73 656c          meta=sel
-00024550: 662e 5f6d 6574 612c 0a20 2020 2020 2020  f._meta,.       
-00024560: 2020 2020 2074 6f6b 656e 3d22 7365 7269       token="seri
-00024570: 6573 2d6e 6c61 7267 6573 7422 2c0a 2020  es-nlargest",.  
-00024580: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
-00024590: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-000245a0: 792c 0a20 2020 2020 2020 2020 2020 206e  y,.            n
-000245b0: 3d6e 2c0a 2020 2020 2020 2020 290a 0a20  =n,.        ).. 
-000245c0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-000245d0: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
-000245e0: 6465 6620 6e73 6d61 6c6c 6573 7428 7365  def nsmallest(se
-000245f0: 6c66 2c20 6e3d 352c 2073 706c 6974 5f65  lf, n=5, split_e
-00024600: 7665 7279 3d4e 6f6e 6529 3a0a 2020 2020  very=None):.    
-00024610: 2020 2020 7265 7475 726e 2061 6361 280a      return aca(.
-00024620: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00024630: 2c0a 2020 2020 2020 2020 2020 2020 6368  ,.            ch
-00024640: 756e 6b3d 4d2e 6e73 6d61 6c6c 6573 742c  unk=M.nsmallest,
-00024650: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
-00024660: 7265 6761 7465 3d4d 2e6e 736d 616c 6c65  regate=M.nsmalle
-00024670: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
-00024680: 6d65 7461 3d73 656c 662e 5f6d 6574 612c  meta=self._meta,
-00024690: 0a20 2020 2020 2020 2020 2020 2074 6f6b  .            tok
-000246a0: 656e 3d22 7365 7269 6573 2d6e 736d 616c  en="series-nsmal
-000246b0: 6c65 7374 222c 0a20 2020 2020 2020 2020  lest",.         
-000246c0: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
-000246d0: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
-000246e0: 2020 2020 2020 2020 6e3d 6e2c 0a20 2020          n=n,.   
-000246f0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-00024700: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
-00024710: 6965 7329 0a20 2020 2064 6566 2069 7369  ies).    def isi
-00024720: 6e28 7365 6c66 2c20 7661 6c75 6573 293a  n(self, values):
-00024730: 0a20 2020 2020 2020 2023 2041 6464 6564  .        # Added
-00024740: 206a 7573 7420 746f 2067 6574 2074 6865   just to get the
-00024750: 2064 6966 6665 7265 6e74 2064 6f63 7374   different docst
-00024760: 7269 6e67 2066 6f72 2053 6572 6965 730a  ring for Series.
-00024770: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00024780: 7570 6572 2829 2e69 7369 6e28 7661 6c75  uper().isin(valu
-00024790: 6573 290a 0a20 2020 2040 696e 7365 7274  es)..    @insert
-000247a0: 5f6d 6574 615f 7061 7261 6d5f 6465 7363  _meta_param_desc
-000247b0: 7269 7074 696f 6e28 7061 643d 3132 290a  ription(pad=12).
-000247c0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-000247d0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-000247e0: 2064 6566 206d 6170 2873 656c 662c 2061   def map(self, a
-000247f0: 7267 2c20 6e61 5f61 6374 696f 6e3d 4e6f  rg, na_action=No
-00024800: 6e65 2c20 6d65 7461 3d6e 6f5f 6465 6661  ne, meta=no_defa
-00024810: 756c 7429 3a0a 2020 2020 2020 2020 6966  ult):.        if
-00024820: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
-00024830: 6172 6729 2061 6e64 2069 735f 6461 736b  arg) and is_dask
-00024840: 5f63 6f6c 6c65 6374 696f 6e28 6172 6729  _collection(arg)
-00024850: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00024860: 7475 726e 2073 6572 6965 735f 6d61 7028  turn series_map(
-00024870: 7365 6c66 2c20 6172 6729 0a20 2020 2020  self, arg).     
-00024880: 2020 2069 6620 6e6f 7420 280a 2020 2020     if not (.    
-00024890: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
-000248a0: 6365 2861 7267 2c20 6469 6374 290a 2020  ce(arg, dict).  
-000248b0: 2020 2020 2020 2020 2020 6f72 2063 616c            or cal
-000248c0: 6c61 626c 6528 6172 6729 0a20 2020 2020  lable(arg).     
-000248d0: 2020 2020 2020 206f 7220 6973 5f73 6572         or is_ser
-000248e0: 6965 735f 6c69 6b65 2861 7267 290a 2020  ies_like(arg).  
-000248f0: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
-00024900: 7420 6973 5f64 6173 6b5f 636f 6c6c 6563  t is_dask_collec
-00024910: 7469 6f6e 2861 7267 290a 2020 2020 2020  tion(arg).      
-00024920: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-00024930: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00024940: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00024950: 2020 6622 6172 6720 6d75 7374 2062 6520    f"arg must be 
-00024960: 7061 6e64 6173 2e53 6572 6965 732c 2064  pandas.Series, d
-00024970: 6963 7420 6f72 2063 616c 6c61 626c 652e  ict or callable.
-00024980: 2047 6f74 207b 7479 7065 2861 7267 297d   Got {type(arg)}
-00024990: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-000249a0: 2020 2020 2020 2020 6e61 6d65 203d 2022          name = "
-000249b0: 6d61 702d 2220 2b20 746f 6b65 6e69 7a65  map-" + tokenize
-000249c0: 2873 656c 662c 2061 7267 2c20 6e61 5f61  (self, arg, na_a
-000249d0: 6374 696f 6e29 0a20 2020 2020 2020 2064  ction).        d
-000249e0: 736b 203d 207b 0a20 2020 2020 2020 2020  sk = {.         
-000249f0: 2020 2028 6e61 6d65 2c20 6929 3a20 284d     (name, i): (M
-00024a00: 2e6d 6170 2c20 6b2c 2061 7267 2c20 6e61  .map, k, arg, na
-00024a10: 5f61 6374 696f 6e29 0a20 2020 2020 2020  _action).       
-00024a20: 2020 2020 2066 6f72 2069 2c20 6b20 696e       for i, k in
-00024a30: 2065 6e75 6d65 7261 7465 2873 656c 662e   enumerate(self.
-00024a40: 5f5f 6461 736b 5f6b 6579 735f 5f28 2929  __dask_keys__())
-00024a50: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00024a60: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-00024a70: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-00024a80: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-00024a90: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-00024aa0: 6573 3d5b 7365 6c66 5d29 0a20 2020 2020  es=[self]).     
-00024ab0: 2020 2069 6620 6d65 7461 2069 7320 6e6f     if meta is no
-00024ac0: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
-00024ad0: 2020 2020 2020 6d65 7461 203d 205f 656d        meta = _em
-00024ae0: 756c 6174 6528 4d2e 6d61 702c 2073 656c  ulate(M.map, sel
-00024af0: 662c 2061 7267 2c20 6e61 5f61 6374 696f  f, arg, na_actio
-00024b00: 6e3d 6e61 5f61 6374 696f 6e2c 2075 6466  n=na_action, udf
-00024b10: 3d54 7275 6529 0a20 2020 2020 2020 2065  =True).        e
-00024b20: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00024b30: 206d 6574 6120 3d20 6d61 6b65 5f6d 6574   meta = make_met
-00024b40: 6128 0a20 2020 2020 2020 2020 2020 2020  a(.             
-00024b50: 2020 206d 6574 612c 0a20 2020 2020 2020     meta,.       
-00024b60: 2020 2020 2020 2020 2069 6e64 6578 3d67           index=g
-00024b70: 6574 6174 7472 286d 616b 655f 6d65 7461  etattr(make_meta
-00024b80: 2873 656c 6629 2c20 2269 6e64 6578 222c  (self), "index",
-00024b90: 204e 6f6e 6529 2c0a 2020 2020 2020 2020   None),.        
-00024ba0: 2020 2020 2020 2020 7061 7265 6e74 5f6d          parent_m
-00024bb0: 6574 613d 7365 6c66 2e5f 6d65 7461 2c0a  eta=self._meta,.
-00024bc0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00024bd0: 2020 2020 2020 2072 6574 7572 6e20 7479         return ty
-00024be0: 7065 2873 656c 6629 2867 7261 7068 2c20  pe(self)(graph, 
-00024bf0: 6e61 6d65 2c20 6d65 7461 2c20 7365 6c66  name, meta, self
-00024c00: 2e64 6976 6973 696f 6e73 290a 0a20 2020  .divisions)..   
-00024c10: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00024c20: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
-00024c30: 6620 6472 6f70 6e61 2873 656c 6629 3a0a  f dropna(self):.
-00024c40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00024c50: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-00024c60: 6e73 284d 2e64 726f 706e 612c 2065 6e66  ns(M.dropna, enf
-00024c70: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-00024c80: 6c73 6529 0a0a 2020 2020 4064 6572 6976  lse)..    @deriv
-00024c90: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-00024ca0: 7329 0a20 2020 2064 6566 2062 6574 7765  s).    def betwe
-00024cb0: 656e 2873 656c 662c 206c 6566 742c 2072  en(self, left, r
-00024cc0: 6967 6874 2c20 696e 636c 7573 6976 653d  ight, inclusive=
-00024cd0: 2262 6f74 6822 293a 0a20 2020 2020 2020  "both"):.       
-00024ce0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-00024cf0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-00024d00: 2020 2020 2020 2020 204d 2e62 6574 7765           M.betwe
-00024d10: 656e 2c20 6c65 6674 3d6c 6566 742c 2072  en, left=left, r
-00024d20: 6967 6874 3d72 6967 6874 2c20 696e 636c  ight=right, incl
-00024d30: 7573 6976 653d 696e 636c 7573 6976 650a  usive=inclusive.
-00024d40: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00024d50: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00024d60: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
-00024d70: 636c 6970 2873 656c 662c 206c 6f77 6572  clip(self, lower
-00024d80: 3d4e 6f6e 652c 2075 7070 6572 3d4e 6f6e  =None, upper=Non
-00024d90: 652c 206f 7574 3d4e 6f6e 6529 3a0a 2020  e, out=None):.  
-00024da0: 2020 2020 2020 6966 206f 7574 2069 7320        if out is 
-00024db0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00024dc0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00024dd0: 6545 7272 6f72 2822 276f 7574 2720 6d75  eError("'out' mu
-00024de0: 7374 2062 6520 4e6f 6e65 2229 0a20 2020  st be None").   
-00024df0: 2020 2020 2023 206e 702e 636c 6970 206d       # np.clip m
-00024e00: 6179 2070 6173 7320 6f75 740a 2020 2020  ay pass out.    
-00024e10: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00024e20: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-00024e30: 2020 2020 2020 2020 2020 2020 4d2e 636c              M.cl
-00024e40: 6970 2c20 6c6f 7765 723d 6c6f 7765 722c  ip, lower=lower,
-00024e50: 2075 7070 6572 3d75 7070 6572 2c20 656e   upper=upper, en
-00024e60: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
-00024e70: 616c 7365 0a20 2020 2020 2020 2029 0a0a  alse.        )..
-00024e80: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00024e90: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00024ea0: 2064 6566 2063 6c69 705f 6c6f 7765 7228   def clip_lower(
-00024eb0: 7365 6c66 2c20 7468 7265 7368 6f6c 6429  self, threshold)
-00024ec0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00024ed0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-00024ee0: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
-00024ef0: 2020 4d2e 636c 6970 5f6c 6f77 6572 2c20    M.clip_lower, 
-00024f00: 7468 7265 7368 6f6c 643d 7468 7265 7368  threshold=thresh
-00024f10: 6f6c 642c 2065 6e66 6f72 6365 5f6d 6574  old, enforce_met
-00024f20: 6164 6174 613d 4661 6c73 650a 2020 2020  adata=False.    
-00024f30: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-00024f40: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
-00024f50: 6573 290a 2020 2020 6465 6620 636c 6970  es).    def clip
-00024f60: 5f75 7070 6572 2873 656c 662c 2074 6872  _upper(self, thr
-00024f70: 6573 686f 6c64 293a 0a20 2020 2020 2020  eshold):.       
-00024f80: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-00024f90: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-00024fa0: 2020 2020 2020 2020 204d 2e63 6c69 705f           M.clip_
-00024fb0: 7570 7065 722c 2074 6872 6573 686f 6c64  upper, threshold
-00024fc0: 3d74 6872 6573 686f 6c64 2c20 656e 666f  =threshold, enfo
-00024fd0: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-00024fe0: 7365 0a20 2020 2020 2020 2029 0a0a 2020  se.        )..  
-00024ff0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00025000: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-00025010: 6566 2061 6c69 676e 2873 656c 662c 206f  ef align(self, o
-00025020: 7468 6572 2c20 6a6f 696e 3d22 6f75 7465  ther, join="oute
-00025030: 7222 2c20 6178 6973 3d4e 6f6e 652c 2066  r", axis=None, f
-00025040: 696c 6c5f 7661 6c75 653d 4e6f 6e65 293a  ill_value=None):
-00025050: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00025060: 7375 7065 7228 292e 616c 6967 6e28 6f74  super().align(ot
-00025070: 6865 722c 206a 6f69 6e3d 6a6f 696e 2c20  her, join=join, 
-00025080: 6178 6973 3d61 7869 732c 2066 696c 6c5f  axis=axis, fill_
-00025090: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
-000250a0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-000250b0: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
-000250c0: 2020 2020 6465 6620 636f 6d62 696e 6528      def combine(
-000250d0: 7365 6c66 2c20 6f74 6865 722c 2066 756e  self, other, fun
-000250e0: 632c 2066 696c 6c5f 7661 6c75 653d 4e6f  c, fill_value=No
-000250f0: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
-00025100: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
-00025110: 7469 7469 6f6e 7328 4d2e 636f 6d62 696e  titions(M.combin
-00025120: 652c 206f 7468 6572 2c20 6675 6e63 2c20  e, other, func, 
-00025130: 6669 6c6c 5f76 616c 7565 3d66 696c 6c5f  fill_value=fill_
-00025140: 7661 6c75 6529 0a0a 2020 2020 4064 6572  value)..    @der
-00025150: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
-00025160: 6965 7329 0a20 2020 2064 6566 2073 7175  ies).    def squ
-00025170: 6565 7a65 2873 656c 6629 3a0a 2020 2020  eeze(self):.    
-00025180: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
-00025190: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-000251a0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-000251b0: 2020 6465 6620 636f 6d62 696e 655f 6669    def combine_fi
-000251c0: 7273 7428 7365 6c66 2c20 6f74 6865 7229  rst(self, other)
-000251d0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000251e0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-000251f0: 696f 6e73 284d 2e63 6f6d 6269 6e65 5f66  ions(M.combine_f
-00025200: 6972 7374 2c20 6f74 6865 7229 0a0a 2020  irst, other)..  
-00025210: 2020 6465 6620 746f 5f62 6167 2873 656c    def to_bag(sel
-00025220: 662c 2069 6e64 6578 3d46 616c 7365 2c20  f, index=False, 
-00025230: 666f 726d 6174 3d22 7475 706c 6522 293a  format="tuple"):
-00025240: 0a20 2020 2020 2020 2022 2222 4372 6561  .        """Crea
-00025250: 7465 2061 2044 6173 6b20 4261 6720 6672  te a Dask Bag fr
-00025260: 6f6d 2061 2053 6572 6965 7322 2222 0a20  om a Series""". 
-00025270: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-00025280: 2e64 6174 6166 7261 6d65 2e69 6f20 696d  .dataframe.io im
-00025290: 706f 7274 2074 6f5f 6261 670a 0a20 2020  port to_bag..   
-000252a0: 2020 2020 2072 6574 7572 6e20 746f 5f62       return to_b
-000252b0: 6167 2873 656c 662c 2069 6e64 6578 2c20  ag(self, index, 
-000252c0: 666f 726d 6174 3d66 6f72 6d61 7429 0a0a  format=format)..
-000252d0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-000252e0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-000252f0: 2064 6566 2074 6f5f 6672 616d 6528 7365   def to_frame(se
-00025300: 6c66 2c20 6e61 6d65 3d4e 6f6e 6529 3a0a  lf, name=None):.
-00025310: 2020 2020 2020 2020 6172 6773 203d 205b          args = [
-00025320: 5d20 6966 206e 616d 6520 6973 204e 6f6e  ] if name is Non
-00025330: 6520 656c 7365 205b 6e61 6d65 5d0a 2020  e else [name].  
-00025340: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00025350: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-00025360: 284d 2e74 6f5f 6672 616d 652c 202a 6172  (M.to_frame, *ar
-00025370: 6773 2c20 6d65 7461 3d73 656c 662e 5f6d  gs, meta=self._m
-00025380: 6574 612e 746f 5f66 7261 6d65 282a 6172  eta.to_frame(*ar
-00025390: 6773 2929 0a0a 2020 2020 4064 6572 6976  gs))..    @deriv
-000253a0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-000253b0: 7329 0a20 2020 2064 6566 2074 6f5f 7374  s).    def to_st
-000253c0: 7269 6e67 2873 656c 662c 206d 6178 5f72  ring(self, max_r
-000253d0: 6f77 733d 3529 3a0a 2020 2020 2020 2020  ows=5):.        
-000253e0: 2320 6f70 7469 6f6e 5f63 6f6e 7465 7874  # option_context
-000253f0: 2064 6f65 736e 2774 2061 6666 6563 740a   doesn't affect.
-00025400: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00025410: 656c 662e 5f72 6570 725f 6461 7461 2829  elf._repr_data()
-00025420: 2e74 6f5f 7374 7269 6e67 286d 6178 5f72  .to_string(max_r
-00025430: 6f77 733d 6d61 785f 726f 7773 290a 0a20  ows=max_rows).. 
-00025440: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
-00025450: 2020 2020 6465 6620 5f62 696e 645f 6f70      def _bind_op
-00025460: 6572 6174 6f72 5f6d 6574 686f 6428 636c  erator_method(cl
-00025470: 732c 206e 616d 652c 206f 702c 206f 7269  s, name, op, ori
-00025480: 6769 6e61 6c3d 7064 2e53 6572 6965 7329  ginal=pd.Series)
-00025490: 3a0a 2020 2020 2020 2020 2222 2262 696e  :.        """bin
-000254a0: 6420 6f70 6572 6174 6f72 206d 6574 686f  d operator metho
-000254b0: 6420 6c69 6b65 2053 6572 6965 732e 6164  d like Series.ad
-000254c0: 6420 746f 2074 6869 7320 636c 6173 7322  d to this class"
-000254d0: 2222 0a0a 2020 2020 2020 2020 6465 6620  ""..        def 
-000254e0: 6d65 7468 2873 656c 662c 206f 7468 6572  meth(self, other
-000254f0: 2c20 6c65 7665 6c3d 4e6f 6e65 2c20 6669  , level=None, fi
-00025500: 6c6c 5f76 616c 7565 3d4e 6f6e 652c 2061  ll_value=None, a
-00025510: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
-00025520: 2020 2020 6966 206c 6576 656c 2069 7320      if level is 
-00025530: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00025540: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00025550: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00025560: 726f 7228 226c 6576 656c 206d 7573 7420  ror("level must 
-00025570: 6265 204e 6f6e 6522 290a 2020 2020 2020  be None").      
-00025580: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
-00025590: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-000255a0: 2861 7869 7329 0a20 2020 2020 2020 2020  (axis).         
-000255b0: 2020 206d 6574 6120 3d20 5f65 6d75 6c61     meta = _emula
-000255c0: 7465 286f 702c 2073 656c 662c 206f 7468  te(op, self, oth
-000255d0: 6572 2c20 6178 6973 3d61 7869 732c 2066  er, axis=axis, f
-000255e0: 696c 6c5f 7661 6c75 653d 6669 6c6c 5f76  ill_value=fill_v
-000255f0: 616c 7565 290a 2020 2020 2020 2020 2020  alue).          
-00025600: 2020 7265 7475 726e 206d 6170 5f70 6172    return map_par
-00025610: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-00025620: 2020 2020 2020 2020 206f 702c 2073 656c           op, sel
-00025630: 662c 206f 7468 6572 2c20 6d65 7461 3d6d  f, other, meta=m
-00025640: 6574 612c 2061 7869 733d 6178 6973 2c20  eta, axis=axis, 
-00025650: 6669 6c6c 5f76 616c 7565 3d66 696c 6c5f  fill_value=fill_
-00025660: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00025670: 2020 290a 0a20 2020 2020 2020 206d 6574    )..        met
-00025680: 682e 5f5f 6e61 6d65 5f5f 203d 206e 616d  h.__name__ = nam
-00025690: 650a 2020 2020 2020 2020 7365 7461 7474  e.        setatt
-000256a0: 7228 636c 732c 206e 616d 652c 2064 6572  r(cls, name, der
-000256b0: 6976 6564 5f66 726f 6d28 6f72 6967 696e  ived_from(origin
-000256c0: 616c 2928 6d65 7468 2929 0a0a 2020 2020  al)(meth))..    
-000256d0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-000256e0: 2064 6566 205f 6269 6e64 5f63 6f6d 7061   def _bind_compa
-000256f0: 7269 736f 6e5f 6d65 7468 6f64 2863 6c73  rison_method(cls
-00025700: 2c20 6e61 6d65 2c20 636f 6d70 6172 6973  , name, comparis
-00025710: 6f6e 2c20 6f72 6967 696e 616c 3d70 642e  on, original=pd.
-00025720: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
-00025730: 2022 2222 6269 6e64 2063 6f6d 7061 7269   """bind compari
-00025740: 736f 6e20 6d65 7468 6f64 206c 696b 6520  son method like 
-00025750: 5365 7269 6573 2e65 7120 746f 2074 6869  Series.eq to thi
-00025760: 7320 636c 6173 7322 2222 0a0a 2020 2020  s class"""..    
-00025770: 2020 2020 6465 6620 6d65 7468 2873 656c      def meth(sel
-00025780: 662c 206f 7468 6572 2c20 6c65 7665 6c3d  f, other, level=
-00025790: 4e6f 6e65 2c20 6669 6c6c 5f76 616c 7565  None, fill_value
-000257a0: 3d4e 6f6e 652c 2061 7869 733d 3029 3a0a  =None, axis=0):.
-000257b0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-000257c0: 6576 656c 2069 7320 6e6f 7420 4e6f 6e65  evel is not None
-000257d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000257e0: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-000257f0: 6d65 6e74 6564 4572 726f 7228 226c 6576  mentedError("lev
-00025800: 656c 206d 7573 7420 6265 204e 6f6e 6522  el must be None"
-00025810: 290a 2020 2020 2020 2020 2020 2020 6178  ).            ax
-00025820: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
-00025830: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
-00025840: 2020 2020 2020 2020 2020 2069 6620 6669             if fi
-00025850: 6c6c 5f76 616c 7565 2069 7320 4e6f 6e65  ll_value is None
-00025860: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00025870: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
-00025880: 6528 636f 6d70 6172 6973 6f6e 2c20 7365  e(comparison, se
-00025890: 6c66 2c20 6f74 6865 722c 2061 7869 733d  lf, other, axis=
-000258a0: 6178 6973 290a 2020 2020 2020 2020 2020  axis).          
-000258b0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000258c0: 2020 2020 2020 2020 6f70 203d 2070 6172          op = par
-000258d0: 7469 616c 2863 6f6d 7061 7269 736f 6e2c  tial(comparison,
-000258e0: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
-000258f0: 5f76 616c 7565 290a 2020 2020 2020 2020  _value).        
-00025900: 2020 2020 2020 2020 7265 7475 726e 2065          return e
-00025910: 6c65 6d77 6973 6528 6f70 2c20 7365 6c66  lemwise(op, self
-00025920: 2c20 6f74 6865 722c 2061 7869 733d 6178  , other, axis=ax
-00025930: 6973 290a 0a20 2020 2020 2020 206d 6574  is)..        met
-00025940: 682e 5f5f 6e61 6d65 5f5f 203d 206e 616d  h.__name__ = nam
-00025950: 650a 2020 2020 2020 2020 7365 7461 7474  e.        setatt
-00025960: 7228 636c 732c 206e 616d 652c 2064 6572  r(cls, name, der
-00025970: 6976 6564 5f66 726f 6d28 6f72 6967 696e  ived_from(origin
-00025980: 616c 2928 6d65 7468 2929 0a0a 2020 2020  al)(meth))..    
-00025990: 4069 6e73 6572 745f 6d65 7461 5f70 6172  @insert_meta_par
-000259a0: 616d 5f64 6573 6372 6970 7469 6f6e 2870  am_description(p
-000259b0: 6164 3d31 3229 0a20 2020 2064 6566 2061  ad=12).    def a
-000259c0: 7070 6c79 2873 656c 662c 2066 756e 632c  pply(self, func,
-000259d0: 2063 6f6e 7665 7274 5f64 7479 7065 3d6e   convert_dtype=n
-000259e0: 6f5f 6465 6661 756c 742c 206d 6574 613d  o_default, meta=
-000259f0: 6e6f 5f64 6566 6175 6c74 2c20 6172 6773  no_default, args
-00025a00: 3d28 292c 202a 2a6b 7764 7329 3a0a 2020  =(), **kwds):.  
-00025a10: 2020 2020 2020 2222 2250 6172 616c 6c65        """Paralle
-00025a20: 6c20 7665 7273 696f 6e20 6f66 2070 616e  l version of pan
-00025a30: 6461 732e 5365 7269 6573 2e61 7070 6c79  das.Series.apply
-00025a40: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00025a50: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00025a60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00025a70: 6675 6e63 203a 2066 756e 6374 696f 6e0a  func : function.
-00025a80: 2020 2020 2020 2020 2020 2020 4675 6e63              Func
-00025a90: 7469 6f6e 2074 6f20 6170 706c 790a 2020  tion to apply.  
-00025aa0: 2020 2020 2020 636f 6e76 6572 745f 6474        convert_dt
-00025ab0: 7970 6520 3a20 626f 6f6c 6561 6e2c 2064  ype : boolean, d
-00025ac0: 6566 6175 6c74 2054 7275 650a 2020 2020  efault True.    
-00025ad0: 2020 2020 2020 2020 5472 7920 746f 2066          Try to f
-00025ae0: 696e 6420 6265 7474 6572 2064 7479 7065  ind better dtype
-00025af0: 2066 6f72 2065 6c65 6d65 6e74 7769 7365   for elementwise
-00025b00: 2066 756e 6374 696f 6e20 7265 7375 6c74   function result
-00025b10: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
-00025b20: 6620 4661 6c73 652c 206c 6561 7665 2061  f False, leave a
-00025b30: 7320 6474 7970 653d 6f62 6a65 6374 2e0a  s dtype=object..
-00025b40: 2020 2020 2020 2020 244d 4554 410a 2020          $META.  
-00025b50: 2020 2020 2020 6172 6773 203a 2074 7570        args : tup
-00025b60: 6c65 0a20 2020 2020 2020 2020 2020 2050  le.            P
-00025b70: 6f73 6974 696f 6e61 6c20 6172 6775 6d65  ositional argume
-00025b80: 6e74 7320 746f 2070 6173 7320 746f 2066  nts to pass to f
-00025b90: 756e 6374 696f 6e20 696e 2061 6464 6974  unction in addit
-00025ba0: 696f 6e20 746f 2074 6865 2076 616c 7565  ion to the value
-00025bb0: 2e0a 0a20 2020 2020 2020 2041 6464 6974  ...        Addit
-00025bc0: 696f 6e61 6c20 6b65 7977 6f72 6420 6172  ional keyword ar
-00025bd0: 6775 6d65 6e74 7320 7769 6c6c 2062 6520  guments will be 
-00025be0: 7061 7373 6564 2061 7320 6b65 7977 6f72  passed as keywor
-00025bf0: 6473 2074 6f20 7468 6520 6675 6e63 7469  ds to the functi
-00025c00: 6f6e 2e0a 0a20 2020 2020 2020 2052 6574  on...        Ret
-00025c10: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
-00025c20: 2d2d 2d2d 0a20 2020 2020 2020 2061 7070  ----.        app
-00025c30: 6c69 6564 203a 2053 6572 6965 7320 6f72  lied : Series or
-00025c40: 2044 6174 6146 7261 6d65 2069 6620 6675   DataFrame if fu
-00025c50: 6e63 2072 6574 7572 6e73 2061 2053 6572  nc returns a Ser
-00025c60: 6965 732e 0a0a 2020 2020 2020 2020 4578  ies...        Ex
-00025c70: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
-00025c80: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00025c90: 3e3e 3e20 696d 706f 7274 2064 6173 6b2e  >>> import dask.
-00025ca0: 6461 7461 6672 616d 6520 6173 2064 640a  dataframe as dd.
-00025cb0: 2020 2020 2020 2020 3e3e 3e20 7320 3d20          >>> s = 
-00025cc0: 7064 2e53 6572 6965 7328 7261 6e67 6528  pd.Series(range(
-00025cd0: 3529 2c20 6e61 6d65 3d27 7827 290a 2020  5), name='x').  
-00025ce0: 2020 2020 2020 3e3e 3e20 6473 203d 2064        >>> ds = d
-00025cf0: 642e 6672 6f6d 5f70 616e 6461 7328 732c  d.from_pandas(s,
-00025d00: 206e 7061 7274 6974 696f 6e73 3d32 290a   npartitions=2).
-00025d10: 0a20 2020 2020 2020 2041 7070 6c79 2061  .        Apply a
-00025d20: 2066 756e 6374 696f 6e20 656c 656d 656e   function elemen
-00025d30: 7477 6973 6520 6163 726f 7373 2074 6865  twise across the
-00025d40: 2053 6572 6965 732c 2070 6173 7369 6e67   Series, passing
-00025d50: 2069 6e20 6578 7472 610a 2020 2020 2020   in extra.      
-00025d60: 2020 6172 6775 6d65 6e74 7320 696e 2060    arguments in `
-00025d70: 6061 7267 7360 6020 616e 6420 6060 6b77  `args`` and ``kw
-00025d80: 6172 6773 6060 3a0a 0a20 2020 2020 2020  args``:..       
-00025d90: 203e 3e3e 2064 6566 206d 7961 6464 2878   >>> def myadd(x
-00025da0: 2c20 612c 2062 3d31 293a 0a20 2020 2020  , a, b=1):.     
-00025db0: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
-00025dc0: 6e20 7820 2b20 6120 2b20 620a 2020 2020  n x + a + b.    
-00025dd0: 2020 2020 3e3e 3e20 7265 7320 3d20 6473      >>> res = ds
-00025de0: 2e61 7070 6c79 286d 7961 6464 2c20 6172  .apply(myadd, ar
-00025df0: 6773 3d28 322c 292c 2062 3d31 2e35 2920  gs=(2,), b=1.5) 
-00025e00: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-00025e10: 500a 0a20 2020 2020 2020 2042 7920 6465  P..        By de
-00025e20: 6661 756c 742c 2064 6173 6b20 7472 6965  fault, dask trie
-00025e30: 7320 746f 2069 6e66 6572 2074 6865 206f  s to infer the o
-00025e40: 7574 7075 7420 6d65 7461 6461 7461 2062  utput metadata b
-00025e50: 7920 7275 6e6e 696e 6720 796f 7572 0a20  y running your. 
-00025e60: 2020 2020 2020 2070 726f 7669 6465 6420         provided 
-00025e70: 6675 6e63 7469 6f6e 206f 6e20 736f 6d65  function on some
-00025e80: 2066 616b 6520 6461 7461 2e20 5468 6973   fake data. This
-00025e90: 2077 6f72 6b73 2077 656c 6c20 696e 206d   works well in m
-00025ea0: 616e 7920 6361 7365 732c 2062 7574 0a20  any cases, but. 
-00025eb0: 2020 2020 2020 2063 616e 2073 6f6d 6574         can somet
-00025ec0: 696d 6573 2062 6520 6578 7065 6e73 6976  imes be expensiv
-00025ed0: 652c 206f 7220 6576 656e 2066 6169 6c2e  e, or even fail.
-00025ee0: 2054 6f20 6176 6f69 6420 7468 6973 2c20   To avoid this, 
-00025ef0: 796f 7520 6361 6e0a 2020 2020 2020 2020  you can.        
-00025f00: 6d61 6e75 616c 6c79 2073 7065 6369 6679  manually specify
-00025f10: 2074 6865 206f 7574 7075 7420 6d65 7461   the output meta
-00025f20: 6461 7461 2077 6974 6820 7468 6520 6060  data with the ``
-00025f30: 6d65 7461 6060 206b 6579 776f 7264 2e20  meta`` keyword. 
-00025f40: 5468 6973 0a20 2020 2020 2020 2063 616e  This.        can
-00025f50: 2062 6520 7370 6563 6966 6965 6420 696e   be specified in
-00025f60: 206d 616e 7920 666f 726d 732c 2066 6f72   many forms, for
-00025f70: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-00025f80: 6e20 7365 650a 2020 2020 2020 2020 6060  n see.        ``
-00025f90: 6461 736b 2e64 6174 6166 7261 6d65 2e75  dask.dataframe.u
-00025fa0: 7469 6c73 2e6d 616b 655f 6d65 7461 6060  tils.make_meta``
-00025fb0: 2e0a 0a20 2020 2020 2020 2048 6572 6520  ...        Here 
-00025fc0: 7765 2073 7065 6369 6679 2074 6865 206f  we specify the o
-00025fd0: 7574 7075 7420 6973 2061 2053 6572 6965  utput is a Serie
-00025fe0: 7320 7769 7468 206e 616d 6520 6060 2778  s with name ``'x
-00025ff0: 2760 602c 2061 6e64 2064 7479 7065 0a20  '``, and dtype. 
-00026000: 2020 2020 2020 2060 6066 6c6f 6174 3634         ``float64
-00026010: 6060 3a0a 0a20 2020 2020 2020 203e 3e3e  ``:..        >>>
-00026020: 2072 6573 203d 2064 732e 6170 706c 7928   res = ds.apply(
-00026030: 6d79 6164 642c 2061 7267 733d 2832 2c29  myadd, args=(2,)
-00026040: 2c20 623d 312e 352c 206d 6574 613d 2827  , b=1.5, meta=('
-00026050: 7827 2c20 2766 3827 2929 0a0a 2020 2020  x', 'f8'))..    
-00026060: 2020 2020 496e 2074 6865 2063 6173 6520      In the case 
-00026070: 7768 6572 6520 7468 6520 6d65 7461 6461  where the metada
-00026080: 7461 2064 6f65 736e 2774 2063 6861 6e67  ta doesn't chang
-00026090: 652c 2079 6f75 2063 616e 2061 6c73 6f20  e, you can also 
-000260a0: 7061 7373 2069 6e0a 2020 2020 2020 2020  pass in.        
-000260b0: 7468 6520 6f62 6a65 6374 2069 7473 656c  the object itsel
-000260c0: 6620 6469 7265 6374 6c79 3a0a 0a20 2020  f directly:..   
-000260d0: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
-000260e0: 732e 6170 706c 7928 6c61 6d62 6461 2078  s.apply(lambda x
-000260f0: 3a20 7820 2b20 312c 206d 6574 613d 6473  : x + 1, meta=ds
-00026100: 290a 0a20 2020 2020 2020 2053 6565 2041  )..        See A
-00026110: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-00026120: 2d2d 2d2d 0a20 2020 2020 2020 2064 6173  ----.        das
-00026130: 6b2e 5365 7269 6573 2e6d 6170 5f70 6172  k.Series.map_par
-00026140: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
-00026150: 2222 220a 2020 2020 2020 2020 6966 2063  """.        if c
-00026160: 6f6e 7665 7274 5f64 7479 7065 2069 7320  onvert_dtype is 
-00026170: 6e6f 7420 6e6f 5f64 6566 6175 6c74 3a0a  not no_default:.
-00026180: 2020 2020 2020 2020 2020 2020 6b77 6473              kwds
-00026190: 5b22 636f 6e76 6572 745f 6474 7970 6522  ["convert_dtype"
-000261a0: 5d20 3d20 636f 6e76 6572 745f 6474 7970  ] = convert_dtyp
-000261b0: 650a 0a20 2020 2020 2020 2023 206c 6574  e..        # let
-000261c0: 2070 616e 6461 7320 7472 6967 6765 7220   pandas trigger 
-000261d0: 616e 7920 7761 726e 696e 6773 2c20 7375  any warnings, su
-000261e0: 6368 2061 7320 636f 6e76 6572 745f 6474  ch as convert_dt
-000261f0: 7970 6520 7761 726e 696e 670a 2020 2020  ype warning.    
-00026200: 2020 2020 7365 6c66 2e5f 6d65 7461 2e61      self._meta.a
-00026210: 7070 6c79 2866 756e 632c 2061 7267 733d  pply(func, args=
-00026220: 6172 6773 2c20 2a2a 6b77 6473 290a 0a20  args, **kwds).. 
-00026230: 2020 2020 2020 2069 6620 6d65 7461 2069         if meta i
-00026240: 7320 6e6f 5f64 6566 6175 6c74 3a0a 2020  s no_default:.  
-00026250: 2020 2020 2020 2020 2020 7769 7468 2063            with c
-00026260: 6865 636b 5f63 6f6e 7665 7274 5f64 7479  heck_convert_dty
-00026270: 7065 5f64 6570 7265 6361 7469 6f6e 2829  pe_deprecation()
-00026280: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00026290: 2020 6d65 7461 203d 205f 656d 756c 6174    meta = _emulat
-000262a0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-000262b0: 2020 2020 2020 204d 2e61 7070 6c79 2c20         M.apply, 
-000262c0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-000262d0: 7074 792c 2066 756e 632c 2061 7267 733d  pty, func, args=
-000262e0: 6172 6773 2c20 7564 663d 5472 7565 2c20  args, udf=True, 
-000262f0: 2a2a 6b77 6473 0a20 2020 2020 2020 2020  **kwds.         
-00026300: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00026310: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00026320: 726e 286d 6574 615f 7761 726e 696e 6728  rn(meta_warning(
-00026330: 6d65 7461 2929 0a0a 2020 2020 2020 2020  meta))..        
-00026340: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
-00026350: 7469 6f6e 7328 6d65 7468 6f64 732e 6170  tions(methods.ap
-00026360: 706c 792c 2073 656c 662c 2066 756e 632c  ply, self, func,
-00026370: 2061 7267 733d 6172 6773 2c20 6d65 7461   args=args, meta
-00026380: 3d6d 6574 612c 202a 2a6b 7764 7329 0a0a  =meta, **kwds)..
-00026390: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-000263a0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-000263b0: 2064 6566 2063 6f76 2873 656c 662c 206f   def cov(self, o
-000263c0: 7468 6572 2c20 6d69 6e5f 7065 7269 6f64  ther, min_period
-000263d0: 733d 4e6f 6e65 2c20 7370 6c69 745f 6576  s=None, split_ev
-000263e0: 6572 793d 4661 6c73 6529 3a0a 2020 2020  ery=False):.    
-000263f0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-00026400: 7461 6672 616d 652e 6d75 6c74 6920 696d  taframe.multi im
-00026410: 706f 7274 2063 6f6e 6361 740a 0a20 2020  port concat..   
-00026420: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00026430: 7374 616e 6365 286f 7468 6572 2c20 5365  stance(other, Se
-00026440: 7269 6573 293a 0a20 2020 2020 2020 2020  ries):.         
-00026450: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00026460: 6f72 2822 6f74 6865 7220 6d75 7374 2062  or("other must b
-00026470: 6520 6120 6461 736b 2e64 6174 6166 7261  e a dask.datafra
-00026480: 6d65 2e53 6572 6965 7322 290a 2020 2020  me.Series").    
-00026490: 2020 2020 6466 203d 2063 6f6e 6361 7428      df = concat(
-000264a0: 5b73 656c 662c 206f 7468 6572 5d2c 2061  [self, other], a
-000264b0: 7869 733d 3129 0a20 2020 2020 2020 2072  xis=1).        r
-000264c0: 6574 7572 6e20 5f63 6f76 5f63 6f72 7228  eturn _cov_corr(
-000264d0: 0a20 2020 2020 2020 2020 2020 2064 662c  .            df,
-000264e0: 206d 696e 5f70 6572 696f 6473 2c20 7363   min_periods, sc
-000264f0: 616c 6172 3d54 7275 652c 206e 756d 6572  alar=True, numer
-00026500: 6963 5f6f 6e6c 793d 4661 6c73 652c 2073  ic_only=False, s
-00026510: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-00026520: 5f65 7665 7279 0a20 2020 2020 2020 2029  _every.        )
-00026530: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00026540: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-00026550: 2020 2064 6566 2063 6f72 7228 7365 6c66     def corr(self
-00026560: 2c20 6f74 6865 722c 206d 6574 686f 643d  , other, method=
-00026570: 2270 6561 7273 6f6e 222c 206d 696e 5f70  "pearson", min_p
-00026580: 6572 696f 6473 3d4e 6f6e 652c 2073 706c  eriods=None, spl
-00026590: 6974 5f65 7665 7279 3d46 616c 7365 293a  it_every=False):
-000265a0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-000265b0: 736b 2e64 6174 6166 7261 6d65 2e6d 756c  sk.dataframe.mul
-000265c0: 7469 2069 6d70 6f72 7420 636f 6e63 6174  ti import concat
-000265d0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-000265e0: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
-000265f0: 722c 2053 6572 6965 7329 3a0a 2020 2020  r, Series):.    
-00026600: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00026610: 7065 4572 726f 7228 226f 7468 6572 206d  peError("other m
-00026620: 7573 7420 6265 2061 2064 6173 6b2e 6461  ust be a dask.da
-00026630: 7461 6672 616d 652e 5365 7269 6573 2229  taframe.Series")
-00026640: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
-00026650: 6f64 2021 3d20 2270 6561 7273 6f6e 223a  od != "pearson":
-00026660: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00026670: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00026680: 6445 7272 6f72 2822 4f6e 6c79 2050 6561  dError("Only Pea
-00026690: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
-000266a0: 2068 6173 2062 6565 6e20 696d 706c 656d   has been implem
-000266b0: 656e 7465 6422 290a 2020 2020 2020 2020  ented").        
-000266c0: 6466 203d 2063 6f6e 6361 7428 5b73 656c  df = concat([sel
-000266d0: 662c 206f 7468 6572 5d2c 2061 7869 733d  f, other], axis=
-000266e0: 3129 0a20 2020 2020 2020 2072 6574 7572  1).        retur
-000266f0: 6e20 5f63 6f76 5f63 6f72 7228 0a20 2020  n _cov_corr(.   
-00026700: 2020 2020 2020 2020 2064 662c 0a20 2020           df,.   
-00026710: 2020 2020 2020 2020 206d 696e 5f70 6572           min_per
-00026720: 696f 6473 2c0a 2020 2020 2020 2020 2020  iods,.          
-00026730: 2020 636f 7272 3d54 7275 652c 0a20 2020    corr=True,.   
-00026740: 2020 2020 2020 2020 2073 6361 6c61 723d           scalar=
-00026750: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
-00026760: 2020 6e75 6d65 7269 635f 6f6e 6c79 3d46    numeric_only=F
-00026770: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00026780: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
-00026790: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
-000267a0: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
-000267b0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-000267c0: 7329 0a20 2020 2064 6566 2061 7574 6f63  s).    def autoc
-000267d0: 6f72 7228 7365 6c66 2c20 6c61 673d 312c  orr(self, lag=1,
-000267e0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-000267f0: 7365 293a 0a20 2020 2020 2020 2069 6620  se):.        if 
-00026800: 6e6f 7420 6973 696e 7374 616e 6365 286c  not isinstance(l
-00026810: 6167 2c20 496e 7465 6772 616c 293a 0a20  ag, Integral):. 
-00026820: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00026830: 2054 7970 6545 7272 6f72 2822 6c61 6720   TypeError("lag 
-00026840: 6d75 7374 2062 6520 616e 2069 6e74 6567  must be an integ
-00026850: 6572 2229 0a20 2020 2020 2020 2072 6574  er").        ret
-00026860: 7572 6e20 7365 6c66 2e63 6f72 7228 7365  urn self.corr(se
-00026870: 6c66 2069 6620 6c61 6720 3d3d 2030 2065  lf if lag == 0 e
-00026880: 6c73 6520 7365 6c66 2e73 6869 6674 286c  lse self.shift(l
-00026890: 6167 292c 2073 706c 6974 5f65 7665 7279  ag), split_every
-000268a0: 3d73 706c 6974 5f65 7665 7279 290a 0a20  =split_every).. 
-000268b0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-000268c0: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
-000268d0: 6465 6620 6d65 6d6f 7279 5f75 7361 6765  def memory_usage
-000268e0: 2873 656c 662c 2069 6e64 6578 3d54 7275  (self, index=Tru
-000268f0: 652c 2064 6565 703d 4661 6c73 6529 3a0a  e, deep=False):.
-00026900: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00026910: 656c 662e 7265 6475 6374 696f 6e28 0a20  elf.reduction(. 
-00026920: 2020 2020 2020 2020 2020 204d 2e6d 656d             M.mem
-00026930: 6f72 795f 7573 6167 652c 0a20 2020 2020  ory_usage,.     
-00026940: 2020 2020 2020 204d 2e73 756d 2c0a 2020         M.sum,.  
-00026950: 2020 2020 2020 2020 2020 6368 756e 6b5f            chunk_
-00026960: 6b77 6172 6773 3d7b 2269 6e64 6578 223a  kwargs={"index":
-00026970: 2069 6e64 6578 2c20 2264 6565 7022 3a20   index, "deep": 
-00026980: 6465 6570 7d2c 0a20 2020 2020 2020 2020  deep},.         
-00026990: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
-000269a0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-000269b0: 2020 746f 6b65 6e3d 7365 6c66 2e5f 746f    token=self._to
-000269c0: 6b65 6e5f 7072 6566 6978 202b 2022 6d65  ken_prefix + "me
-000269d0: 6d6f 7279 2d75 7361 6765 222c 0a20 2020  mory-usage",.   
-000269e0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-000269f0: 5f5f 6469 766d 6f64 5f5f 2873 656c 662c  __divmod__(self,
-00026a00: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
-00026a10: 2072 6573 3120 3d20 7365 6c66 202f 2f20   res1 = self // 
-00026a20: 6f74 6865 720a 2020 2020 2020 2020 7265  other.        re
-00026a30: 7332 203d 2073 656c 6620 2520 6f74 6865  s2 = self % othe
-00026a40: 720a 2020 2020 2020 2020 7265 7475 726e  r.        return
-00026a50: 2072 6573 312c 2072 6573 320a 0a20 2020   res1, res2..   
-00026a60: 2064 6566 205f 5f72 6469 766d 6f64 5f5f   def __rdivmod__
-00026a70: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
-00026a80: 2020 2020 2020 2072 6573 3120 3d20 6f74         res1 = ot
-00026a90: 6865 7220 2f2f 2073 656c 660a 2020 2020  her // self.    
-00026aa0: 2020 2020 7265 7332 203d 206f 7468 6572      res2 = other
-00026ab0: 2025 2073 656c 660a 2020 2020 2020 2020   % self.        
-00026ac0: 7265 7475 726e 2072 6573 312c 2072 6573  return res1, res
-00026ad0: 320a 0a20 2020 2069 6620 6e6f 7420 5041  2..    if not PA
-00026ae0: 4e44 4153 5f47 545f 3230 303a 0a0a 2020  NDAS_GT_200:..  
-00026af0: 2020 2020 2020 4070 726f 7065 7274 790a        @property.
-00026b00: 2020 2020 2020 2020 4064 6572 6976 6564          @derived
-00026b10: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00026b20: 0a20 2020 2020 2020 2064 6566 2069 735f  .        def is_
-00026b30: 6d6f 6e6f 746f 6e69 6328 7365 6c66 293a  monotonic(self):
-00026b40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00026b50: 5041 4e44 4153 5f47 545f 3135 303a 0a20  PANDAS_GT_150:. 
-00026b60: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-00026b70: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-00026b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026b90: 2020 2269 735f 6d6f 6e6f 746f 6e69 6320    "is_monotonic 
-00026ba0: 6973 2064 6570 7265 6361 7465 6420 616e  is deprecated an
-00026bb0: 6420 7769 6c6c 2062 6520 7265 6d6f 7665  d will be remove
-00026bc0: 6420 696e 2061 2066 7574 7572 6520 7665  d in a future ve
-00026bd0: 7273 696f 6e2e 2022 0a20 2020 2020 2020  rsion. ".       
-00026be0: 2020 2020 2020 2020 2020 2020 2022 5573               "Us
-00026bf0: 6520 6973 5f6d 6f6e 6f74 6f6e 6963 5f69  e is_monotonic_i
-00026c00: 6e63 7265 6173 696e 6720 696e 7374 6561  ncreasing instea
-00026c10: 642e 222c 0a20 2020 2020 2020 2020 2020  d.",.           
-00026c20: 2020 2020 2020 2020 2046 7574 7572 6557           FutureW
-00026c30: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
-00026c40: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00026c50: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00026c60: 662e 6973 5f6d 6f6e 6f74 6f6e 6963 5f69  f.is_monotonic_i
-00026c70: 6e63 7265 6173 696e 670a 0a20 2020 2040  ncreasing..    @
-00026c80: 7072 6f70 6572 7479 0a20 2020 2040 6465  property.    @de
-00026c90: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00026ca0: 7269 6573 290a 2020 2020 6465 6620 6973  ries).    def is
-00026cb0: 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63 7265  _monotonic_incre
-00026cc0: 6173 696e 6728 7365 6c66 293a 0a20 2020  asing(self):.   
-00026cd0: 2020 2020 2072 6574 7572 6e20 6163 6128       return aca(
-00026ce0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00026cf0: 662c 0a20 2020 2020 2020 2020 2020 2063  f,.            c
-00026d00: 6875 6e6b 3d6d 6574 686f 6473 2e6d 6f6e  hunk=methods.mon
-00026d10: 6f74 6f6e 6963 5f69 6e63 7265 6173 696e  otonic_increasin
-00026d20: 675f 6368 756e 6b2c 0a20 2020 2020 2020  g_chunk,.       
-00026d30: 2020 2020 2063 6f6d 6269 6e65 3d6d 6574       combine=met
-00026d40: 686f 6473 2e6d 6f6e 6f74 6f6e 6963 5f69  hods.monotonic_i
-00026d50: 6e63 7265 6173 696e 675f 636f 6d62 696e  ncreasing_combin
-00026d60: 652c 0a20 2020 2020 2020 2020 2020 2061  e,.            a
-00026d70: 6767 7265 6761 7465 3d6d 6574 686f 6473  ggregate=methods
-00026d80: 2e6d 6f6e 6f74 6f6e 6963 5f69 6e63 7265  .monotonic_incre
-00026d90: 6173 696e 675f 6167 6772 6567 6174 652c  asing_aggregate,
-00026da0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00026db0: 613d 626f 6f6c 2c0a 2020 2020 2020 2020  a=bool,.        
-00026dc0: 2020 2020 746f 6b65 6e3d 226d 6f6e 6f74      token="monot
-00026dd0: 6f6e 6963 5f69 6e63 7265 6173 696e 6722  onic_increasing"
-00026de0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00026df0: 2040 7072 6f70 6572 7479 0a20 2020 2040   @property.    @
-00026e00: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00026e10: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
-00026e20: 6973 5f6d 6f6e 6f74 6f6e 6963 5f64 6563  is_monotonic_dec
-00026e30: 7265 6173 696e 6728 7365 6c66 293a 0a20  reasing(self):. 
-00026e40: 2020 2020 2020 2072 6574 7572 6e20 6163         return ac
-00026e50: 6128 0a20 2020 2020 2020 2020 2020 2073  a(.            s
-00026e60: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00026e70: 2063 6875 6e6b 3d6d 6574 686f 6473 2e6d   chunk=methods.m
-00026e80: 6f6e 6f74 6f6e 6963 5f64 6563 7265 6173  onotonic_decreas
-00026e90: 696e 675f 6368 756e 6b2c 0a20 2020 2020  ing_chunk,.     
-00026ea0: 2020 2020 2020 2063 6f6d 6269 6e65 3d6d         combine=m
-00026eb0: 6574 686f 6473 2e6d 6f6e 6f74 6f6e 6963  ethods.monotonic
-00026ec0: 5f64 6563 7265 6173 696e 675f 636f 6d62  _decreasing_comb
-00026ed0: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
-00026ee0: 2061 6767 7265 6761 7465 3d6d 6574 686f   aggregate=metho
-00026ef0: 6473 2e6d 6f6e 6f74 6f6e 6963 5f64 6563  ds.monotonic_dec
-00026f00: 7265 6173 696e 675f 6167 6772 6567 6174  reasing_aggregat
-00026f10: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
-00026f20: 6574 613d 626f 6f6c 2c0a 2020 2020 2020  eta=bool,.      
-00026f30: 2020 2020 2020 746f 6b65 6e3d 226d 6f6e        token="mon
-00026f40: 6f74 6f6e 6963 5f64 6563 7265 6173 696e  otonic_decreasin
-00026f50: 6722 2c0a 2020 2020 2020 2020 290a 0a20  g",.        ).. 
-00026f60: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00026f70: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
-00026f80: 6465 6620 7669 6577 2873 656c 662c 2064  def view(self, d
-00026f90: 7479 7065 293a 0a20 2020 2020 2020 206d  type):.        m
-00026fa0: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-00026fb0: 2e76 6965 7728 6474 7970 6529 0a20 2020  .view(dtype).   
-00026fc0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00026fd0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-00026fe0: 4d2e 7669 6577 2c20 6474 7970 652c 206d  M.view, dtype, m
-00026ff0: 6574 613d 6d65 7461 290a 0a0a 636c 6173  eta=meta)...clas
-00027000: 7320 496e 6465 7828 5365 7269 6573 293a  s Index(Series):
-00027010: 0a20 2020 205f 7061 7274 6974 696f 6e5f  .    _partition_
-00027020: 7479 7065 203d 2070 642e 496e 6465 780a  type = pd.Index.
-00027030: 2020 2020 5f69 735f 7061 7274 6974 696f      _is_partitio
-00027040: 6e5f 7479 7065 203d 2073 7461 7469 636d  n_type = staticm
-00027050: 6574 686f 6428 6973 5f69 6e64 6578 5f6c  ethod(is_index_l
-00027060: 696b 6529 0a20 2020 205f 746f 6b65 6e5f  ike).    _token_
-00027070: 7072 6566 6978 203d 2022 696e 6465 782d  prefix = "index-
-00027080: 220a 2020 2020 5f61 6363 6573 736f 7273  ".    _accessors
-00027090: 3a20 436c 6173 7356 6172 5b73 6574 5b73  : ClassVar[set[s
-000270a0: 7472 5d5d 203d 2073 6574 2829 0a0a 2020  tr]] = set()..  
-000270b0: 2020 5f64 745f 6174 7472 6962 7574 6573    _dt_attributes
-000270c0: 203d 207b 0a20 2020 2020 2020 2022 6e61   = {.        "na
-000270d0: 6e6f 7365 636f 6e64 222c 0a20 2020 2020  nosecond",.     
-000270e0: 2020 2022 6d69 6372 6f73 6563 6f6e 6422     "microsecond"
-000270f0: 2c0a 2020 2020 2020 2020 226d 696c 6c69  ,.        "milli
-00027100: 7365 636f 6e64 222c 0a20 2020 2020 2020  second",.       
-00027110: 2022 6461 796f 6679 6561 7222 2c0a 2020   "dayofyear",.  
-00027120: 2020 2020 2020 226d 696e 7574 6522 2c0a        "minute",.
-00027130: 2020 2020 2020 2020 2268 6f75 7222 2c0a          "hour",.
-00027140: 2020 2020 2020 2020 2264 6179 222c 0a20          "day",. 
-00027150: 2020 2020 2020 2022 6461 796f 6677 6565         "dayofwee
-00027160: 6b22 2c0a 2020 2020 2020 2020 2273 6563  k",.        "sec
-00027170: 6f6e 6422 2c0a 2020 2020 2020 2020 2277  ond",.        "w
-00027180: 6565 6b22 2c0a 2020 2020 2020 2020 2277  eek",.        "w
-00027190: 6565 6b64 6179 222c 0a20 2020 2020 2020  eekday",.       
-000271a0: 2022 7765 656b 6f66 7965 6172 222c 0a20   "weekofyear",. 
-000271b0: 2020 2020 2020 2022 6d6f 6e74 6822 2c0a         "month",.
-000271c0: 2020 2020 2020 2020 2271 7561 7274 6572          "quarter
-000271d0: 222c 0a20 2020 2020 2020 2022 7965 6172  ",.        "year
-000271e0: 222c 0a20 2020 207d 0a0a 2020 2020 5f63  ",.    }..    _c
-000271f0: 6174 5f61 7474 7269 6275 7465 7320 3d20  at_attributes = 
-00027200: 7b0a 2020 2020 2020 2020 226b 6e6f 776e  {.        "known
-00027210: 222c 0a20 2020 2020 2020 2022 6173 5f6b  ",.        "as_k
-00027220: 6e6f 776e 222c 0a20 2020 2020 2020 2022  nown",.        "
-00027230: 6173 5f75 6e6b 6e6f 776e 222c 0a20 2020  as_unknown",.   
-00027240: 2020 2020 2022 6164 645f 6361 7465 676f       "add_catego
-00027250: 7269 6573 222c 0a20 2020 2020 2020 2022  ries",.        "
-00027260: 6361 7465 676f 7269 6573 222c 0a20 2020  categories",.   
-00027270: 2020 2020 2022 7265 6d6f 7665 5f63 6174       "remove_cat
-00027280: 6567 6f72 6965 7322 2c0a 2020 2020 2020  egories",.      
-00027290: 2020 2272 656f 7264 6572 5f63 6174 6567    "reorder_categ
-000272a0: 6f72 6965 7322 2c0a 2020 2020 2020 2020  ories",.        
-000272b0: 2261 735f 6f72 6465 7265 6422 2c0a 2020  "as_ordered",.  
-000272c0: 2020 2020 2020 2263 6f64 6573 222c 0a20        "codes",. 
-000272d0: 2020 2020 2020 2022 7265 6d6f 7665 5f75         "remove_u
-000272e0: 6e75 7365 645f 6361 7465 676f 7269 6573  nused_categories
-000272f0: 222c 0a20 2020 2020 2020 2022 7365 745f  ",.        "set_
-00027300: 6361 7465 676f 7269 6573 222c 0a20 2020  categories",.   
-00027310: 2020 2020 2022 6173 5f75 6e6f 7264 6572       "as_unorder
-00027320: 6564 222c 0a20 2020 2020 2020 2022 6f72  ed",.        "or
-00027330: 6465 7265 6422 2c0a 2020 2020 2020 2020  dered",.        
-00027340: 2272 656e 616d 655f 6361 7465 676f 7269  "rename_categori
-00027350: 6573 222c 0a20 2020 207d 0a0a 2020 2020  es",.    }..    
-00027360: 5f6d 6f6e 6f74 6f6e 6963 5f61 7474 7269  _monotonic_attri
-00027370: 6275 7465 7320 3d20 7b0a 2020 2020 2020  butes = {.      
-00027380: 2020 2269 735f 6d6f 6e6f 746f 6e69 6322    "is_monotonic"
-00027390: 2c0a 2020 2020 2020 2020 2269 735f 6d6f  ,.        "is_mo
-000273a0: 6e6f 746f 6e69 635f 696e 6372 6561 7369  notonic_increasi
-000273b0: 6e67 222c 0a20 2020 2020 2020 2022 6973  ng",.        "is
-000273c0: 5f6d 6f6e 6f74 6f6e 6963 5f64 6563 7265  _monotonic_decre
-000273d0: 6173 696e 6722 2c0a 2020 2020 7d0a 0a20  asing",.    }.. 
-000273e0: 2020 2064 6566 205f 5f67 6574 6174 7472     def __getattr
-000273f0: 5f5f 2873 656c 662c 206b 6579 293a 0a20  __(self, key):. 
-00027400: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
-00027410: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
-00027420: 6365 2873 656c 662e 5f6d 6574 612e 6474  ce(self._meta.dt
-00027430: 7970 652c 2070 642e 4361 7465 676f 7269  ype, pd.Categori
-00027440: 6361 6c44 7479 7065 290a 2020 2020 2020  calDtype).      
-00027450: 2020 2020 2020 616e 6420 6b65 7920 696e        and key in
-00027460: 2073 656c 662e 5f63 6174 5f61 7474 7269   self._cat_attri
-00027470: 6275 7465 730a 2020 2020 2020 2020 293a  butes.        ):
-00027480: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00027490: 7572 6e20 6765 7461 7474 7228 7365 6c66  urn getattr(self
-000274a0: 2e63 6174 2c20 6b65 7929 0a20 2020 2020  .cat, key).     
-000274b0: 2020 2065 6c69 6620 6b65 7920 696e 2073     elif key in s
-000274c0: 656c 662e 5f64 745f 6174 7472 6962 7574  elf._dt_attribut
-000274d0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-000274e0: 7265 7475 726e 2067 6574 6174 7472 2873  return getattr(s
-000274f0: 656c 662e 6474 2c20 6b65 7929 0a20 2020  elf.dt, key).   
-00027500: 2020 2020 2065 6c69 6620 6b65 7920 696e       elif key in
-00027510: 2073 656c 662e 5f6d 6f6e 6f74 6f6e 6963   self._monotonic
-00027520: 5f61 7474 7269 6275 7465 733a 0a20 2020  _attributes:.   
-00027530: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00027540: 6765 7461 7474 7228 7365 6c66 2c20 6b65  getattr(self, ke
-00027550: 7929 0a20 2020 2020 2020 2072 6169 7365  y).        raise
-00027560: 2041 7474 7269 6275 7465 4572 726f 7228   AttributeError(
-00027570: 2227 496e 6465 7827 206f 626a 6563 7420  "'Index' object 
-00027580: 6861 7320 6e6f 2061 7474 7269 6275 7465  has no attribute
-00027590: 2025 7222 2025 206b 6579 290a 0a20 2020   %r" % key)..   
-000275a0: 2064 6566 205f 5f64 6972 5f5f 2873 656c   def __dir__(sel
-000275b0: 6629 3a0a 2020 2020 2020 2020 6f75 7420  f):.        out 
-000275c0: 3d20 7375 7065 7228 292e 5f5f 6469 725f  = super().__dir_
-000275d0: 5f28 290a 2020 2020 2020 2020 6f75 742e  _().        out.
-000275e0: 6578 7465 6e64 2873 656c 662e 5f64 745f  extend(self._dt_
-000275f0: 6174 7472 6962 7574 6573 290a 2020 2020  attributes).    
-00027600: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00027610: 6528 7365 6c66 2e64 7479 7065 2c20 7064  e(self.dtype, pd
-00027620: 2e43 6174 6567 6f72 6963 616c 4474 7970  .CategoricalDtyp
-00027630: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00027640: 6f75 742e 6578 7465 6e64 2873 656c 662e  out.extend(self.
-00027650: 5f63 6174 5f61 7474 7269 6275 7465 7329  _cat_attributes)
-00027660: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00027670: 6f75 740a 0a20 2020 2023 2054 7970 696e  out..    # Typin
-00027680: 673a 2068 7474 7073 3a2f 2f67 6974 6875  g: https://githu
-00027690: 622e 636f 6d2f 7079 7468 6f6e 2f6d 7970  b.com/python/myp
-000276a0: 792f 6973 7375 6573 2f34 3132 350a 2020  y/issues/4125.  
-000276b0: 2020 4070 726f 7065 7274 7920 2023 2074    @property  # t
-000276c0: 7970 653a 2069 676e 6f72 650a 2020 2020  ype: ignore.    
-000276d0: 6465 6620 696e 6465 7828 7365 6c66 293a  def index(self):
-000276e0: 0a20 2020 2020 2020 2072 6169 7365 2041  .        raise A
-000276f0: 7474 7269 6275 7465 4572 726f 7228 0a20  ttributeError(. 
-00027700: 2020 2020 2020 2020 2020 2066 227b 7365             f"{se
-00027710: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
-00027720: 616d 655f 5f21 727d 206f 626a 6563 7420  ame__!r} object 
-00027730: 6861 7320 6e6f 2061 7474 7269 6275 7465  has no attribute
-00027740: 2027 696e 6465 7827 220a 2020 2020 2020   'index'".      
-00027750: 2020 290a 0a20 2020 2064 6566 205f 5f61    )..    def __a
-00027760: 7272 6179 5f77 7261 705f 5f28 7365 6c66  rray_wrap__(self
-00027770: 2c20 6172 7261 792c 2063 6f6e 7465 7874  , array, context
-00027780: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00027790: 7265 7475 726e 2070 642e 496e 6465 7828  return pd.Index(
-000277a0: 6172 7261 792c 206e 616d 653d 7365 6c66  array, name=self
-000277b0: 2e6e 616d 6529 0a0a 2020 2020 6465 6620  .name)..    def 
-000277c0: 6865 6164 2873 656c 662c 206e 3d35 2c20  head(self, n=5, 
-000277d0: 636f 6d70 7574 653d 5472 7565 293a 0a20  compute=True):. 
-000277e0: 2020 2020 2020 2022 2222 4669 7273 7420         """First 
-000277f0: 6e20 6974 656d 7320 6f66 2074 6865 2049  n items of the I
-00027800: 6e64 6578 2e0a 0a20 2020 2020 2020 2043  ndex...        C
-00027810: 6176 6561 742c 2074 6869 7320 6f6e 6c79  aveat, this only
-00027820: 2063 6865 636b 7320 7468 6520 6669 7273   checks the firs
-00027830: 7420 7061 7274 6974 696f 6e2e 0a20 2020  t partition..   
-00027840: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00027850: 206e 616d 6520 3d20 2268 6561 642d 2564   name = "head-%d
-00027860: 2d25 7322 2025 2028 6e2c 2073 656c 662e  -%s" % (n, self.
-00027870: 5f6e 616d 6529 0a20 2020 2020 2020 2064  _name).        d
-00027880: 736b 203d 207b 286e 616d 652c 2030 293a  sk = {(name, 0):
-00027890: 2028 6f70 6572 6174 6f72 2e67 6574 6974   (operator.getit
-000278a0: 656d 2c20 2873 656c 662e 5f6e 616d 652c  em, (self._name,
-000278b0: 2030 292c 2073 6c69 6365 2830 2c20 6e29   0), slice(0, n)
-000278c0: 297d 0a20 2020 2020 2020 2067 7261 7068  )}.        graph
-000278d0: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
-000278e0: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
-000278f0: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
-00027900: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
-00027910: 5d29 0a0a 2020 2020 2020 2020 7265 7375  ])..        resu
-00027920: 6c74 203d 206e 6577 5f64 645f 6f62 6a65  lt = new_dd_obje
-00027930: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
-00027940: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
-00027950: 2e64 6976 6973 696f 6e73 5b3a 325d 290a  .divisions[:2]).
-00027960: 0a20 2020 2020 2020 2069 6620 636f 6d70  .        if comp
-00027970: 7574 653a 0a20 2020 2020 2020 2020 2020  ute:.           
-00027980: 2072 6573 756c 7420 3d20 7265 7375 6c74   result = result
-00027990: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-000279a0: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
-000279b0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-000279c0: 726f 6d28 7064 2e49 6e64 6578 290a 2020  rom(pd.Index).  
-000279d0: 2020 6465 6620 6d61 7828 7365 6c66 2c20    def max(self, 
-000279e0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
-000279f0: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
-00027a00: 726e 2073 656c 662e 7265 6475 6374 696f  rn self.reductio
-00027a10: 6e28 0a20 2020 2020 2020 2020 2020 204d  n(.            M
-00027a20: 2e6d 6178 2c0a 2020 2020 2020 2020 2020  .max,.          
-00027a30: 2020 6d65 7461 3d73 656c 662e 5f6d 6574    meta=self._met
-00027a40: 615f 6e6f 6e65 6d70 7479 2e6d 6178 2829  a_nonempty.max()
-00027a50: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
-00027a60: 6b65 6e3d 7365 6c66 2e5f 746f 6b65 6e5f  ken=self._token_
-00027a70: 7072 6566 6978 202b 2022 6d61 7822 2c0a  prefix + "max",.
-00027a80: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-00027a90: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-00027aa0: 6572 792c 0a20 2020 2020 2020 2029 0a0a  ery,.        )..
-00027ab0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00027ac0: 6d28 7064 2e49 6e64 6578 290a 2020 2020  m(pd.Index).    
-00027ad0: 6465 6620 6d69 6e28 7365 6c66 2c20 7370  def min(self, sp
-00027ae0: 6c69 745f 6576 6572 793d 4661 6c73 6529  lit_every=False)
-00027af0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00027b00: 2073 656c 662e 7265 6475 6374 696f 6e28   self.reduction(
-00027b10: 0a20 2020 2020 2020 2020 2020 204d 2e6d  .            M.m
-00027b20: 696e 2c0a 2020 2020 2020 2020 2020 2020  in,.            
-00027b30: 6d65 7461 3d73 656c 662e 5f6d 6574 615f  meta=self._meta_
-00027b40: 6e6f 6e65 6d70 7479 2e6d 696e 2829 2c0a  nonempty.min(),.
-00027b50: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-00027b60: 6e3d 7365 6c66 2e5f 746f 6b65 6e5f 7072  n=self._token_pr
-00027b70: 6566 6978 202b 2022 6d69 6e22 2c0a 2020  efix + "min",.  
-00027b80: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
-00027b90: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-00027ba0: 792c 0a20 2020 2020 2020 2029 0a0a 2020  y,.        )..  
-00027bb0: 2020 6465 6620 636f 756e 7428 7365 6c66    def count(self
-00027bc0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
-00027bd0: 6c73 6529 3a0a 2020 2020 2020 2020 7265  lse):.        re
-00027be0: 7475 726e 2073 656c 662e 7265 6475 6374  turn self.reduct
-00027bf0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-00027c00: 206d 6574 686f 6473 2e69 6e64 6578 5f63   methods.index_c
-00027c10: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
-00027c20: 2020 6e70 2e73 756d 2c0a 2020 2020 2020    np.sum,.      
-00027c30: 2020 2020 2020 746f 6b65 6e3d 2269 6e64        token="ind
-00027c40: 6578 2d63 6f75 6e74 222c 0a20 2020 2020  ex-count",.     
-00027c50: 2020 2020 2020 206d 6574 613d 696e 742c         meta=int,
-00027c60: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-00027c70: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-00027c80: 7665 7279 2c0a 2020 2020 2020 2020 290a  very,.        ).
-00027c90: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00027ca0: 6f6d 2870 642e 496e 6465 7829 0a20 2020  om(pd.Index).   
-00027cb0: 2064 6566 2073 6869 6674 2873 656c 662c   def shift(self,
-00027cc0: 2070 6572 696f 6473 3d31 2c20 6672 6571   periods=1, freq
-00027cd0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00027ce0: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
-00027cf0: 6c66 2e5f 6d65 7461 2c20 7064 2e50 6572  lf._meta, pd.Per
-00027d00: 696f 6449 6e64 6578 293a 0a20 2020 2020  iodIndex):.     
-00027d10: 2020 2020 2020 2069 6620 6672 6571 2069         if freq i
-00027d20: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00027d30: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00027d40: 6520 5661 6c75 6545 7272 6f72 2822 5065  e ValueError("Pe
-00027d50: 7269 6f64 496e 6465 7820 646f 6573 6e27  riodIndex doesn'
-00027d60: 7420 6163 6365 7074 2060 6672 6571 6020  t accept `freq` 
-00027d70: 6172 6775 6d65 6e74 2229 0a20 2020 2020  argument").     
-00027d80: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
-00027d90: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-00027da0: 792e 7368 6966 7428 7065 7269 6f64 7329  y.shift(periods)
-00027db0: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-00027dc0: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
-00027dd0: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-00027de0: 2020 2020 2020 2020 4d2e 7368 6966 742c          M.shift,
-00027df0: 2070 6572 696f 6473 2c20 6d65 7461 3d6d   periods, meta=m
-00027e00: 6574 612c 2074 6f6b 656e 3d22 7368 6966  eta, token="shif
-00027e10: 7422 2c20 7472 616e 7366 6f72 6d5f 6469  t", transform_di
-00027e20: 7669 7369 6f6e 733d 4661 6c73 650a 2020  visions=False.  
-00027e30: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00027e40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00027e50: 2020 2020 2020 2320 5061 6e64 6173 2077        # Pandas w
-00027e60: 696c 6c20 7261 6973 6520 666f 7220 6f74  ill raise for ot
-00027e70: 6865 7220 696e 6465 7820 7479 7065 7320  her index types 
-00027e80: 7468 6174 2064 6f6e 2774 2069 6d70 6c65  that don't imple
-00027e90: 6d65 6e74 2073 6869 6674 0a20 2020 2020  ment shift.     
-00027ea0: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
-00027eb0: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-00027ec0: 792e 7368 6966 7428 7065 7269 6f64 732c  y.shift(periods,
-00027ed0: 2066 7265 713d 6672 6571 290a 2020 2020   freq=freq).    
-00027ee0: 2020 2020 2020 2020 6f75 7420 3d20 7365          out = se
-00027ef0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00027f00: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-00027f10: 2020 204d 2e73 6869 6674 2c0a 2020 2020     M.shift,.    
-00027f20: 2020 2020 2020 2020 2020 2020 7065 7269              peri
-00027f30: 6f64 732c 0a20 2020 2020 2020 2020 2020  ods,.           
-00027f40: 2020 2020 2074 6f6b 656e 3d22 7368 6966       token="shif
-00027f50: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
-00027f60: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
-00027f70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00027f80: 7265 713d 6672 6571 2c0a 2020 2020 2020  req=freq,.      
-00027f90: 2020 2020 2020 2020 2020 7472 616e 7366            transf
-00027fa0: 6f72 6d5f 6469 7669 7369 6f6e 733d 4661  orm_divisions=Fa
-00027fb0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00027fc0: 2029 0a20 2020 2020 2020 2069 6620 6672   ).        if fr
-00027fd0: 6571 2069 7320 4e6f 6e65 3a0a 2020 2020  eq is None:.    
-00027fe0: 2020 2020 2020 2020 6672 6571 203d 206d          freq = m
-00027ff0: 6574 612e 6672 6571 0a20 2020 2020 2020  eta.freq.       
-00028000: 2072 6574 7572 6e20 6d61 7962 655f 7368   return maybe_sh
-00028010: 6966 745f 6469 7669 7369 6f6e 7328 6f75  ift_divisions(ou
-00028020: 742c 2070 6572 696f 6473 2c20 6672 6571  t, periods, freq
-00028030: 3d66 7265 7129 0a0a 2020 2020 4064 6572  =freq)..    @der
-00028040: 6976 6564 5f66 726f 6d28 7064 2e49 6e64  ived_from(pd.Ind
-00028050: 6578 290a 2020 2020 6465 6620 746f 5f73  ex).    def to_s
-00028060: 6572 6965 7328 7365 6c66 293a 0a20 2020  eries(self):.   
-00028070: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00028080: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-00028090: 0a20 2020 2020 2020 2020 2020 204d 2e74  .            M.t
-000280a0: 6f5f 7365 7269 6573 2c0a 2020 2020 2020  o_series,.      
-000280b0: 2020 2020 2020 6d65 7461 3d73 656c 662e        meta=self.
-000280c0: 5f6d 6574 612e 746f 5f73 6572 6965 7328  _meta.to_series(
-000280d0: 292c 0a20 2020 2020 2020 2020 2020 2074  ),.            t
-000280e0: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
-000280f0: 6e73 3d46 616c 7365 2c0a 2020 2020 2020  ns=False,.      
-00028100: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-00028110: 645f 6672 6f6d 2870 642e 496e 6465 782c  d_from(pd.Index,
-00028120: 2075 615f 6172 6773 3d5b 2269 6e64 6578   ua_args=["index
-00028130: 225d 290a 2020 2020 6465 6620 746f 5f66  "]).    def to_f
-00028140: 7261 6d65 2873 656c 662c 2069 6e64 6578  rame(self, index
-00028150: 3d54 7275 652c 206e 616d 653d 4e6f 6e65  =True, name=None
-00028160: 293a 0a20 2020 2020 2020 2069 6620 6e6f  ):.        if no
-00028170: 7420 696e 6465 783a 0a20 2020 2020 2020  t index:.       
-00028180: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-00028190: 706c 656d 656e 7465 6445 7272 6f72 2829  plementedError()
-000281a0: 0a20 2020 2020 2020 2061 7267 7320 3d20  .        args = 
-000281b0: 5b69 6e64 6578 5d20 6966 206e 616d 6520  [index] if name 
-000281c0: 6973 204e 6f6e 6520 656c 7365 205b 696e  is None else [in
-000281d0: 6465 782c 206e 616d 655d 0a0a 2020 2020  dex, name]..    
-000281e0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000281f0: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-00028200: 2020 2020 2020 2020 2020 2020 4d2e 746f              M.to
-00028210: 5f66 7261 6d65 2c0a 2020 2020 2020 2020  _frame,.        
-00028220: 2020 2020 2a61 7267 732c 0a20 2020 2020      *args,.     
-00028230: 2020 2020 2020 206d 6574 613d 7365 6c66         meta=self
-00028240: 2e5f 6d65 7461 2e74 6f5f 6672 616d 6528  ._meta.to_frame(
-00028250: 2a61 7267 7329 2c0a 2020 2020 2020 2020  *args),.        
-00028260: 2020 2020 7472 616e 7366 6f72 6d5f 6469      transform_di
-00028270: 7669 7369 6f6e 733d 4661 6c73 652c 0a20  visions=False,. 
-00028280: 2020 2020 2020 2029 0a0a 2020 2020 4069         )..    @i
-00028290: 6e73 6572 745f 6d65 7461 5f70 6172 616d  nsert_meta_param
-000282a0: 5f64 6573 6372 6970 7469 6f6e 2870 6164  _description(pad
-000282b0: 3d31 3229 0a20 2020 2040 6465 7269 7665  =12).    @derive
-000282c0: 645f 6672 6f6d 2870 642e 496e 6465 7829  d_from(pd.Index)
-000282d0: 0a20 2020 2064 6566 206d 6170 2873 656c  .    def map(sel
-000282e0: 662c 2061 7267 2c20 6e61 5f61 6374 696f  f, arg, na_actio
-000282f0: 6e3d 4e6f 6e65 2c20 6d65 7461 3d6e 6f5f  n=None, meta=no_
-00028300: 6465 6661 756c 742c 2069 735f 6d6f 6e6f  default, is_mono
-00028310: 746f 6e69 633d 4661 6c73 6529 3a0a 2020  tonic=False):.  
-00028320: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00028330: 2020 4e6f 7465 2074 6861 7420 7468 6973    Note that this
-00028340: 206d 6574 686f 6420 636c 6561 7273 2061   method clears a
-00028350: 6e79 206b 6e6f 776e 2064 6976 6973 696f  ny known divisio
-00028360: 6e73 2e0a 0a20 2020 2020 2020 2049 6620  ns...        If 
-00028370: 796f 7572 206d 6170 7069 6e67 2066 756e  your mapping fun
-00028380: 6374 696f 6e20 6973 206d 6f6e 6f74 6f6e  ction is monoton
-00028390: 6963 616c 6c79 2069 6e63 7265 6173 696e  ically increasin
-000283a0: 6720 7468 656e 2075 7365 2060 6973 5f6d  g then use `is_m
-000283b0: 6f6e 6f74 6f6e 6963 600a 2020 2020 2020  onotonic`.      
-000283c0: 2020 746f 2061 7070 6c79 2074 6865 206d    to apply the m
-000283d0: 6170 696e 6720 6675 6e63 7469 6f6e 2074  aping function t
-000283e0: 6f20 7468 6520 6f6c 6420 6469 7669 7369  o the old divisi
-000283f0: 6f6e 7320 616e 6420 6173 7369 676e 2074  ons and assign t
-00028400: 6865 206e 6577 0a20 2020 2020 2020 2064  he new.        d
-00028410: 6976 6973 696f 6e73 2074 6f20 7468 6520  ivisions to the 
-00028420: 6f75 7470 7574 2e0a 0a20 2020 2020 2020  output...       
-00028430: 2022 2222 0a20 2020 2020 2020 2061 7070   """.        app
-00028440: 6c69 6564 203d 2073 7570 6572 2829 2e6d  lied = super().m
-00028450: 6170 2861 7267 2c20 6e61 5f61 6374 696f  ap(arg, na_actio
-00028460: 6e3d 6e61 5f61 6374 696f 6e2c 206d 6574  n=na_action, met
-00028470: 613d 6d65 7461 290a 2020 2020 2020 2020  a=meta).        
-00028480: 6966 2069 735f 6d6f 6e6f 746f 6e69 6320  if is_monotonic 
-00028490: 616e 6420 7365 6c66 2e6b 6e6f 776e 5f64  and self.known_d
-000284a0: 6976 6973 696f 6e73 3a0a 2020 2020 2020  ivisions:.      
-000284b0: 2020 2020 2020 6170 706c 6965 642e 6469        applied.di
-000284c0: 7669 7369 6f6e 7320 3d20 7475 706c 6528  visions = tuple(
-000284d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000284e0: 2070 642e 5365 7269 6573 2873 656c 662e   pd.Series(self.
-000284f0: 6469 7669 7369 6f6e 7329 2e6d 6170 2861  divisions).map(a
-00028500: 7267 2c20 6e61 5f61 6374 696f 6e3d 6e61  rg, na_action=na
-00028510: 5f61 6374 696f 6e29 0a20 2020 2020 2020  _action).       
-00028520: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-00028530: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00028540: 2061 7070 6c69 6564 203d 2061 7070 6c69   applied = appli
-00028550: 6564 2e63 6c65 6172 5f64 6976 6973 696f  ed.clear_divisio
-00028560: 6e73 2829 0a20 2020 2020 2020 2072 6574  ns().        ret
-00028570: 7572 6e20 6170 706c 6965 640a 0a20 2020  urn applied..   
-00028580: 2069 6620 6e6f 7420 5041 4e44 4153 5f47   if not PANDAS_G
-00028590: 545f 3230 303a 0a0a 2020 2020 2020 2020  T_200:..        
-000285a0: 4070 726f 7065 7274 790a 2020 2020 2020  @property.      
-000285b0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-000285c0: 7064 2e49 6e64 6578 290a 2020 2020 2020  pd.Index).      
-000285d0: 2020 6465 6620 6973 5f6d 6f6e 6f74 6f6e    def is_monoton
-000285e0: 6963 2873 656c 6629 3a0a 2020 2020 2020  ic(self):.      
-000285f0: 2020 2020 2020 6966 2050 414e 4441 535f        if PANDAS_
-00028600: 4754 5f31 3530 3a0a 2020 2020 2020 2020  GT_150:.        
-00028610: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00028620: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-00028630: 2020 2020 2020 2020 2020 2022 6973 5f6d             "is_m
-00028640: 6f6e 6f74 6f6e 6963 2069 7320 6465 7072  onotonic is depr
-00028650: 6563 6174 6564 2061 6e64 2077 696c 6c20  ecated and will 
-00028660: 6265 2072 656d 6f76 6564 2069 6e20 6120  be removed in a 
-00028670: 6675 7475 7265 2076 6572 7369 6f6e 2e20  future version. 
-00028680: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00028690: 2020 2020 2020 2255 7365 2069 735f 6d6f        "Use is_mo
-000286a0: 6e6f 746f 6e69 635f 696e 6372 6561 7369  notonic_increasi
-000286b0: 6e67 2069 6e73 7465 6164 2e22 2c0a 2020  ng instead.",.  
-000286c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000286d0: 2020 4675 7475 7265 5761 726e 696e 672c    FutureWarning,
-000286e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000286f0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-00028700: 6574 7572 6e20 7375 7065 7228 292e 6973  eturn super().is
-00028710: 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63 7265  _monotonic_incre
-00028720: 6173 696e 670a 0a20 2020 2040 7072 6f70  asing..    @prop
-00028730: 6572 7479 0a20 2020 2040 6465 7269 7665  erty.    @derive
-00028740: 645f 6672 6f6d 2870 642e 496e 6465 7829  d_from(pd.Index)
-00028750: 0a20 2020 2064 6566 2069 735f 6d6f 6e6f  .    def is_mono
-00028760: 746f 6e69 635f 696e 6372 6561 7369 6e67  tonic_increasing
-00028770: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00028780: 7265 7475 726e 2073 7570 6572 2829 2e69  return super().i
-00028790: 735f 6d6f 6e6f 746f 6e69 635f 696e 6372  s_monotonic_incr
-000287a0: 6561 7369 6e67 0a0a 2020 2020 4070 726f  easing..    @pro
-000287b0: 7065 7274 790a 2020 2020 4064 6572 6976  perty.    @deriv
-000287c0: 6564 5f66 726f 6d28 7064 2e49 6e64 6578  ed_from(pd.Index
-000287d0: 290a 2020 2020 6465 6620 6973 5f6d 6f6e  ).    def is_mon
-000287e0: 6f74 6f6e 6963 5f64 6563 7265 6173 696e  otonic_decreasin
-000287f0: 6728 7365 6c66 293a 0a20 2020 2020 2020  g(self):.       
-00028800: 2072 6574 7572 6e20 7375 7065 7228 292e   return super().
-00028810: 6973 5f6d 6f6e 6f74 6f6e 6963 5f64 6563  is_monotonic_dec
-00028820: 7265 6173 696e 670a 0a20 2020 2040 6465  reasing..    @de
-00028830: 7269 7665 645f 6672 6f6d 2870 642e 496e  rived_from(pd.In
-00028840: 6465 7829 0a20 2020 2064 6566 206d 656d  dex).    def mem
-00028850: 6f72 795f 7573 6167 6528 7365 6c66 2c20  ory_usage(self, 
-00028860: 6465 6570 3d46 616c 7365 293a 0a20 2020  deep=False):.   
-00028870: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00028880: 2e72 6564 7563 7469 6f6e 280a 2020 2020  .reduction(.    
-00028890: 2020 2020 2020 2020 4d2e 6d65 6d6f 7279          M.memory
-000288a0: 5f75 7361 6765 2c0a 2020 2020 2020 2020  _usage,.        
-000288b0: 2020 2020 4d2e 7375 6d2c 0a20 2020 2020      M.sum,.     
-000288c0: 2020 2020 2020 2063 6875 6e6b 5f6b 7761         chunk_kwa
-000288d0: 7267 733d 7b22 6465 6570 223a 2064 6565  rgs={"deep": dee
-000288e0: 707d 2c0a 2020 2020 2020 2020 2020 2020  p},.            
-000288f0: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
-00028900: 652c 0a20 2020 2020 2020 2020 2020 2074  e,.            t
-00028910: 6f6b 656e 3d73 656c 662e 5f74 6f6b 656e  oken=self._token
-00028920: 5f70 7265 6669 7820 2b20 226d 656d 6f72  _prefix + "memor
-00028930: 792d 7573 6167 6522 2c0a 2020 2020 2020  y-usage",.      
-00028940: 2020 290a 0a0a 636c 6173 7320 4461 7461    )...class Data
-00028950: 4672 616d 6528 5f46 7261 6d65 293a 0a20  Frame(_Frame):. 
-00028960: 2020 2022 2222 0a20 2020 2050 6172 616c     """.    Paral
-00028970: 6c65 6c20 5061 6e64 6173 2044 6174 6146  lel Pandas DataF
-00028980: 7261 6d65 0a0a 2020 2020 446f 206e 6f74  rame..    Do not
-00028990: 2075 7365 2074 6869 7320 636c 6173 7320   use this class 
-000289a0: 6469 7265 6374 6c79 2e20 2049 6e73 7465  directly.  Inste
-000289b0: 6164 2075 7365 2066 756e 6374 696f 6e73  ad use functions
-000289c0: 206c 696b 650a 2020 2020 6060 6464 2e72   like.    ``dd.r
-000289d0: 6561 645f 6373 7660 602c 2060 6064 642e  ead_csv``, ``dd.
-000289e0: 7265 6164 5f70 6172 7175 6574 6060 2c20  read_parquet``, 
-000289f0: 6f72 2060 6064 642e 6672 6f6d 5f70 616e  or ``dd.from_pan
-00028a00: 6461 7360 602e 0a0a 2020 2020 5061 7261  das``...    Para
-00028a10: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-00028a20: 2d2d 2d2d 2d0a 2020 2020 6473 6b3a 2064  -----.    dsk: d
-00028a30: 6963 740a 2020 2020 2020 2020 5468 6520  ict.        The 
-00028a40: 6461 736b 2067 7261 7068 2074 6f20 636f  dask graph to co
-00028a50: 6d70 7574 6520 7468 6973 2044 6174 6146  mpute this DataF
-00028a60: 7261 6d65 0a20 2020 206e 616d 653a 2073  rame.    name: s
-00028a70: 7472 0a20 2020 2020 2020 2054 6865 206b  tr.        The k
-00028a80: 6579 2070 7265 6669 7820 7468 6174 2073  ey prefix that s
-00028a90: 7065 6369 6669 6573 2077 6869 6368 206b  pecifies which k
-00028aa0: 6579 7320 696e 2074 6865 2064 6173 6b20  eys in the dask 
-00028ab0: 636f 6d70 7269 7365 2074 6869 730a 2020  comprise this.  
-00028ac0: 2020 2020 2020 7061 7274 6963 756c 6172        particular
-00028ad0: 2044 6174 6146 7261 6d65 0a20 2020 206d   DataFrame.    m
-00028ae0: 6574 613a 2070 616e 6461 732e 4461 7461  eta: pandas.Data
-00028af0: 4672 616d 650a 2020 2020 2020 2020 416e  Frame.        An
-00028b00: 2065 6d70 7479 2060 6070 616e 6461 732e   empty ``pandas.
-00028b10: 4461 7461 4672 616d 6560 6020 7769 7468  DataFrame`` with
-00028b20: 206e 616d 6573 2c20 6474 7970 6573 2c20   names, dtypes, 
-00028b30: 616e 6420 696e 6465 7820 6d61 7463 6869  and index matchi
-00028b40: 6e67 0a20 2020 2020 2020 2074 6865 2065  ng.        the e
-00028b50: 7870 6563 7465 6420 6f75 7470 7574 2e0a  xpected output..
-00028b60: 2020 2020 6469 7669 7369 6f6e 733a 2074      divisions: t
-00028b70: 7570 6c65 206f 6620 696e 6465 7820 7661  uple of index va
-00028b80: 6c75 6573 0a20 2020 2020 2020 2056 616c  lues.        Val
-00028b90: 7565 7320 616c 6f6e 6720 7768 6963 6820  ues along which 
-00028ba0: 7765 2070 6172 7469 7469 6f6e 206f 7572  we partition our
-00028bb0: 2062 6c6f 636b 7320 6f6e 2074 6865 2069   blocks on the i
-00028bc0: 6e64 6578 0a20 2020 2022 2222 0a0a 2020  ndex.    """..  
-00028bd0: 2020 5f70 6172 7469 7469 6f6e 5f74 7970    _partition_typ
-00028be0: 6520 3d20 7064 2e44 6174 6146 7261 6d65  e = pd.DataFrame
-00028bf0: 0a20 2020 205f 6973 5f70 6172 7469 7469  .    _is_partiti
-00028c00: 6f6e 5f74 7970 6520 3d20 7374 6174 6963  on_type = static
-00028c10: 6d65 7468 6f64 2869 735f 6461 7461 6672  method(is_datafr
-00028c20: 616d 655f 6c69 6b65 290a 2020 2020 5f74  ame_like).    _t
-00028c30: 6f6b 656e 5f70 7265 6669 7820 3d20 2264  oken_prefix = "d
-00028c40: 6174 6166 7261 6d65 2d22 0a20 2020 205f  ataframe-".    _
-00028c50: 6163 6365 7373 6f72 733a 2043 6c61 7373  accessors: Class
-00028c60: 5661 725b 7365 745b 7374 725d 5d20 3d20  Var[set[str]] = 
-00028c70: 7365 7428 290a 0a20 2020 2064 6566 205f  set()..    def _
-00028c80: 5f69 6e69 745f 5f28 7365 6c66 2c20 6473  _init__(self, ds
-00028c90: 6b2c 206e 616d 652c 206d 6574 612c 2064  k, name, meta, d
-00028ca0: 6976 6973 696f 6e73 293a 0a20 2020 2020  ivisions):.     
-00028cb0: 2020 2073 7570 6572 2829 2e5f 5f69 6e69     super().__ini
-00028cc0: 745f 5f28 6473 6b2c 206e 616d 652c 206d  t__(dsk, name, m
-00028cd0: 6574 612c 2064 6976 6973 696f 6e73 290a  eta, divisions).
-00028ce0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00028cf0: 6461 736b 2e6c 6179 6572 735b 6e61 6d65  dask.layers[name
-00028d00: 5d2e 636f 6c6c 6563 7469 6f6e 5f61 6e6e  ].collection_ann
-00028d10: 6f74 6174 696f 6e73 2069 7320 4e6f 6e65  otations is None
-00028d20: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00028d30: 6c66 2e64 6173 6b2e 6c61 7965 7273 5b6e  lf.dask.layers[n
-00028d40: 616d 655d 2e63 6f6c 6c65 6374 696f 6e5f  ame].collection_
-00028d50: 616e 6e6f 7461 7469 6f6e 7320 3d20 7b0a  annotations = {.
-00028d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d70: 226e 7061 7274 6974 696f 6e73 223a 2073  "npartitions": s
-00028d80: 656c 662e 6e70 6172 7469 7469 6f6e 732c  elf.npartitions,
-00028d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028da0: 2022 636f 6c75 6d6e 7322 3a20 5b63 6f6c   "columns": [col
-00028db0: 2066 6f72 2063 6f6c 2069 6e20 7365 6c66   for col in self
-00028dc0: 2e63 6f6c 756d 6e73 5d2c 0a20 2020 2020  .columns],.     
-00028dd0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
-00028de0: 223a 2074 7970 656e 616d 6528 7479 7065  ": typename(type
-00028df0: 2873 656c 6629 292c 0a20 2020 2020 2020  (self)),.       
-00028e00: 2020 2020 2020 2020 2022 6461 7461 6672           "datafr
-00028e10: 616d 655f 7479 7065 223a 2074 7970 656e  ame_type": typen
-00028e20: 616d 6528 7479 7065 2873 656c 662e 5f6d  ame(type(self._m
-00028e30: 6574 6129 292c 0a20 2020 2020 2020 2020  eta)),.         
-00028e40: 2020 2020 2020 2022 7365 7269 6573 5f64         "series_d
-00028e50: 7479 7065 7322 3a20 7b0a 2020 2020 2020  types": {.      
-00028e60: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00028e70: 6c3a 2073 656c 662e 5f6d 6574 615b 636f  l: self._meta[co
-00028e80: 6c5d 2e64 7479 7065 0a20 2020 2020 2020  l].dtype.       
-00028e90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00028ea0: 6861 7361 7474 7228 7365 6c66 2e5f 6d65  hasattr(self._me
-00028eb0: 7461 5b63 6f6c 5d2c 2022 6474 7970 6522  ta[col], "dtype"
-00028ec0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00028ed0: 2020 2020 2020 656c 7365 204e 6f6e 650a        else None.
-00028ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ef0: 2020 2020 666f 7220 636f 6c20 696e 2073      for col in s
-00028f00: 656c 662e 5f6d 6574 612e 636f 6c75 6d6e  elf._meta.column
-00028f10: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00028f20: 2020 7d2c 0a20 2020 2020 2020 2020 2020    },.           
-00028f30: 207d 0a20 2020 2020 2020 2065 6c73 653a   }.        else:
-00028f40: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00028f50: 662e 6461 736b 2e6c 6179 6572 735b 6e61  f.dask.layers[na
-00028f60: 6d65 5d2e 636f 6c6c 6563 7469 6f6e 5f61  me].collection_a
-00028f70: 6e6e 6f74 6174 696f 6e73 2e75 7064 6174  nnotations.updat
-00028f80: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00028f90: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-00028fa0: 2020 2020 2020 2020 2022 6e70 6172 7469           "nparti
-00028fb0: 7469 6f6e 7322 3a20 7365 6c66 2e6e 7061  tions": self.npa
-00028fc0: 7274 6974 696f 6e73 2c0a 2020 2020 2020  rtitions,.      
-00028fd0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-00028fe0: 6f6c 756d 6e73 223a 205b 636f 6c20 666f  olumns": [col fo
-00028ff0: 7220 636f 6c20 696e 2073 656c 662e 636f  r col in self.co
-00029000: 6c75 6d6e 735d 2c0a 2020 2020 2020 2020  lumns],.        
-00029010: 2020 2020 2020 2020 2020 2020 2274 7970              "typ
-00029020: 6522 3a20 7479 7065 6e61 6d65 2874 7970  e": typename(typ
-00029030: 6528 7365 6c66 2929 2c0a 2020 2020 2020  e(self)),.      
-00029040: 2020 2020 2020 2020 2020 2020 2020 2264                "d
-00029050: 6174 6166 7261 6d65 5f74 7970 6522 3a20  ataframe_type": 
-00029060: 7479 7065 6e61 6d65 2874 7970 6528 7365  typename(type(se
-00029070: 6c66 2e5f 6d65 7461 2929 2c0a 2020 2020  lf._meta)),.    
+0001ddc0: 7374 616e 6365 2876 616c 7565 732c 206c  stance(values, l
+0001ddd0: 6973 7429 3a0a 2020 2020 2020 2020 2020  ist):.          
+0001dde0: 2020 2320 4d6f 7469 7661 7465 6420 6279    # Motivated by
+0001ddf0: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
+0001de00: 636f 6d2f 6461 736b 2f64 6173 6b2f 6973  com/dask/dask/is
+0001de10: 7375 6573 2f39 3431 312e 2020 5468 6973  sues/9411.  This
+0001de20: 2061 7070 6561 7273 2074 6f20 6265 0a20   appears to be. 
+0001de30: 2020 2020 2020 2020 2020 2023 2063 6175             # cau
+0001de40: 7365 6420 6279 2068 7474 7073 3a2f 2f67  sed by https://g
+0001de50: 6974 6875 622e 636f 6d2f 6461 736b 2f64  ithub.com/dask/d
+0001de60: 6973 7472 6962 7574 6564 2f69 7373 7565  istributed/issue
+0001de70: 732f 3633 3638 2c20 616e 6420 6675 7274  s/6368, and furt
+0001de80: 6865 720a 2020 2020 2020 2020 2020 2020  her.            
+0001de90: 2320 6578 6163 6572 6261 7465 6420 6279  # exacerbated by
+0001dea0: 2074 6865 2066 6163 7420 7468 6174 2074   the fact that t
+0001deb0: 6865 206c 6973 7420 636f 6e74 6169 6e73  he list contains
+0001dec0: 2064 7570 6c69 6361 7465 732e 2020 5468   duplicates.  Th
+0001ded0: 6973 2069 7320 6120 7061 7463 6820 756e  is is a patch un
+0001dee0: 7469 6c0a 2020 2020 2020 2020 2020 2020  til.            
+0001def0: 2320 7765 2063 616e 2063 7265 6174 6520  # we can create 
+0001df00: 6120 6265 7474 6572 2066 6978 2066 6f72  a better fix for
+0001df10: 2053 6572 6961 6c69 7a61 7469 6f6e 2e0a   Serialization..
+0001df20: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+0001df30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001df40: 2076 616c 7565 7320 3d20 6c69 7374 2873   values = list(s
+0001df50: 6574 2876 616c 7565 7329 290a 2020 2020  et(values)).    
+0001df60: 2020 2020 2020 2020 6578 6365 7074 2054          except T
+0001df70: 7970 6545 7272 6f72 3a0a 2020 2020 2020  ypeError:.      
+0001df80: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
+0001df90: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0001dfa0: 7420 616e 7928 6973 5f64 6173 6b5f 636f  t any(is_dask_co
+0001dfb0: 6c6c 6563 7469 6f6e 2876 2920 666f 7220  llection(v) for 
+0001dfc0: 7620 696e 2076 616c 7565 7329 3a0a 2020  v in values):.  
+0001dfd0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+0001dfe0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+0001dff0: 2020 2020 2020 2076 616c 7565 7320 3d20         values = 
+0001e000: 6e70 2e66 726f 6d69 7465 7228 7661 6c75  np.fromiter(valu
+0001e010: 6573 2c20 6474 7970 653d 6f62 6a65 6374  es, dtype=object
+0001e020: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001e030: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
+0001e040: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+0001e050: 2020 2020 2020 2020 2023 204e 756d 7079           # Numpy
+0001e060: 2031 2e32 3320 7375 7070 6f72 7473 2063   1.23 supports c
+0001e070: 7265 6174 696e 6720 6172 7261 7973 206f  reating arrays o
+0001e080: 6620 6974 6572 6162 6c65 732c 2077 6869  f iterables, whi
+0001e090: 6c65 206c 6f77 6572 0a20 2020 2020 2020  le lower.       
+0001e0a0: 2020 2020 2020 2020 2020 2020 2023 2076               # v
+0001e0b0: 6572 7369 6f6e 2031 2e32 312e 7820 616e  ersion 1.21.x an
+0001e0c0: 6420 312e 3232 2e78 2064 6f20 6e6f 740a  d 1.22.x do not.
+0001e0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e0e0: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
+0001e0f0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+0001e100: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+0001e110: 2020 2020 2020 2020 204d 2e69 7369 6e2c           M.isin,
+0001e120: 2064 656c 6179 6564 2876 616c 7565 7329   delayed(values)
+0001e130: 2c20 6d65 7461 3d6d 6574 612c 2065 6e66  , meta=meta, enf
+0001e140: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
+0001e150: 6c73 650a 2020 2020 2020 2020 290a 0a20  lse.        ).. 
+0001e160: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0001e170: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0001e180: 2020 2064 6566 2061 7374 7970 6528 7365     def astype(se
+0001e190: 6c66 2c20 6474 7970 6529 3a0a 2020 2020  lf, dtype):.    
+0001e1a0: 2020 2020 2320 5858 583a 2050 616e 6461      # XXX: Panda
+0001e1b0: 7320 7769 6c6c 2073 6567 6661 756c 7420  s will segfault 
+0001e1c0: 666f 7220 656d 7074 7920 6461 7461 6672  for empty datafr
+0001e1d0: 616d 6573 2077 6865 6e20 7365 7474 696e  ames when settin
+0001e1e0: 670a 2020 2020 2020 2020 2320 6361 7465  g.        # cate
+0001e1f0: 676f 7269 6361 6c20 6474 7970 6573 2e20  gorical dtypes. 
+0001e200: 5468 6973 206f 7065 7261 7469 6f6e 2069  This operation i
+0001e210: 736e 2774 2061 6c6c 6f77 6564 2063 7572  sn't allowed cur
+0001e220: 7265 6e74 6c79 2061 6e79 7761 792e 2057  rently anyway. W
+0001e230: 650a 2020 2020 2020 2020 2320 6765 7420  e.        # get 
+0001e240: 7468 6520 6d65 7461 6461 7461 2077 6974  the metadata wit
+0001e250: 6820 6120 6e6f 6e2d 656d 7074 7920 6672  h a non-empty fr
+0001e260: 616d 6520 746f 2074 6872 6f77 2074 6865  ame to throw the
+0001e270: 2065 7272 6f72 2069 6e73 7465 6164 206f   error instead o
+0001e280: 660a 2020 2020 2020 2020 2320 7365 6766  f.        # segf
+0001e290: 6175 6c74 696e 672e 0a20 2020 2020 2020  aulting..       
+0001e2a0: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
+0001e2b0: 2020 6973 5f64 6174 6166 7261 6d65 5f6c    is_dataframe_l
+0001e2c0: 696b 6528 7365 6c66 2e5f 6d65 7461 290a  ike(self._meta).
+0001e2d0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+0001e2e0: 6e6f 7420 6861 7361 7474 7228 6474 7970  not hasattr(dtyp
+0001e2f0: 652c 2022 6974 656d 7322 290a 2020 2020  e, "items").    
+0001e300: 2020 2020 2020 2020 616e 6420 6973 696e          and isin
+0001e310: 7374 616e 6365 2870 642e 6170 692e 7479  stance(pd.api.ty
+0001e320: 7065 732e 7061 6e64 6173 5f64 7479 7065  pes.pandas_dtype
+0001e330: 2864 7479 7065 292c 2070 642e 4361 7465  (dtype), pd.Cate
+0001e340: 676f 7269 6361 6c44 7479 7065 290a 2020  goricalDtype).  
+0001e350: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+0001e360: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
+0001e370: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
+0001e380: 6173 7479 7065 2864 7479 7065 290a 2020  astype(dtype).  
+0001e390: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001e3a0: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
+0001e3b0: 656c 662e 5f6d 6574 612e 6173 7479 7065  elf._meta.astype
+0001e3c0: 2864 7479 7065 290a 2020 2020 2020 2020  (dtype).        
+0001e3d0: 6966 2068 6173 6174 7472 2864 7479 7065  if hasattr(dtype
+0001e3e0: 2c20 2269 7465 6d73 2229 3a0a 2020 2020  , "items"):.    
+0001e3f0: 2020 2020 2020 2020 7365 745f 756e 6b6e          set_unkn
+0001e400: 6f77 6e20 3d20 5b0a 2020 2020 2020 2020  own = [.        
+0001e410: 2020 2020 2020 2020 6b0a 2020 2020 2020          k.      
+0001e420: 2020 2020 2020 2020 2020 666f 7220 6b2c            for k,
+0001e430: 2076 2069 6e20 6474 7970 652e 6974 656d   v in dtype.item
+0001e440: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+0001e450: 2020 2020 6966 2028 6973 696e 7374 616e      if (isinstan
+0001e460: 6365 2870 642e 6170 692e 7479 7065 732e  ce(pd.api.types.
+0001e470: 7061 6e64 6173 5f64 7479 7065 2876 292c  pandas_dtype(v),
+0001e480: 2070 642e 4361 7465 676f 7269 6361 6c44   pd.CategoricalD
+0001e490: 7479 7065 2929 0a20 2020 2020 2020 2020  type)).         
+0001e4a0: 2020 2020 2020 2061 6e64 2067 6574 6174         and getat
+0001e4b0: 7472 2876 2c20 2263 6174 6567 6f72 6965  tr(v, "categorie
+0001e4c0: 7322 2c20 4e6f 6e65 2920 6973 204e 6f6e  s", None) is Non
+0001e4d0: 650a 2020 2020 2020 2020 2020 2020 5d0a  e.            ].
+0001e4e0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+0001e4f0: 203d 2063 6c65 6172 5f6b 6e6f 776e 5f63   = clear_known_c
+0001e500: 6174 6567 6f72 6965 7328 6d65 7461 2c20  ategories(meta, 
+0001e510: 636f 6c73 3d73 6574 5f75 6e6b 6e6f 776e  cols=set_unknown
+0001e520: 290a 2020 2020 2020 2020 656c 6966 2028  ).        elif (
+0001e530: 0a20 2020 2020 2020 2020 2020 2069 7369  .            isi
+0001e540: 6e73 7461 6e63 6528 7064 2e61 7069 2e74  nstance(pd.api.t
+0001e550: 7970 6573 2e70 616e 6461 735f 6474 7970  ypes.pandas_dtyp
+0001e560: 6528 6474 7970 6529 2c20 7064 2e43 6174  e(dtype), pd.Cat
+0001e570: 6567 6f72 6963 616c 4474 7970 6529 0a20  egoricalDtype). 
+0001e580: 2020 2020 2020 2029 2061 6e64 2067 6574         ) and get
+0001e590: 6174 7472 2864 7479 7065 2c20 2263 6174  attr(dtype, "cat
+0001e5a0: 6567 6f72 6965 7322 2c20 4e6f 6e65 2920  egories", None) 
+0001e5b0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0001e5c0: 2020 2020 206d 6574 6120 3d20 636c 6561       meta = clea
+0001e5d0: 725f 6b6e 6f77 6e5f 6361 7465 676f 7269  r_known_categori
+0001e5e0: 6573 286d 6574 6129 0a20 2020 2020 2020  es(meta).       
+0001e5f0: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+0001e600: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+0001e610: 2020 2020 2020 2020 204d 2e61 7374 7970           M.astyp
+0001e620: 652c 2064 7479 7065 3d64 7479 7065 2c20  e, dtype=dtype, 
+0001e630: 6d65 7461 3d6d 6574 612c 2065 6e66 6f72  meta=meta, enfor
+0001e640: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
+0001e650: 650a 2020 2020 2020 2020 290a 0a20 2020  e.        )..   
+0001e660: 2069 6620 6e6f 7420 5041 4e44 4153 5f47   if not PANDAS_G
+0001e670: 545f 3230 303a 0a0a 2020 2020 2020 2020  T_200:..        
+0001e680: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0001e690: 2e53 6572 6965 7329 0a20 2020 2020 2020  .Series).       
+0001e6a0: 2064 6566 2061 7070 656e 6428 7365 6c66   def append(self
+0001e6b0: 2c20 6f74 6865 722c 2069 6e74 6572 6c65  , other, interle
+0001e6c0: 6176 655f 7061 7274 6974 696f 6e73 3d46  ave_partitions=F
+0001e6d0: 616c 7365 293a 0a20 2020 2020 2020 2020  alse):.         
+0001e6e0: 2020 2069 6620 5041 4e44 4153 5f47 545f     if PANDAS_GT_
+0001e6f0: 3134 303a 0a20 2020 2020 2020 2020 2020  140:.           
+0001e700: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+0001e710: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+0001e720: 2020 2020 2020 2020 2254 6865 2066 7261          "The fra
+0001e730: 6d65 2e61 7070 656e 6420 6d65 7468 6f64  me.append method
+0001e740: 2069 7320 6465 7072 6563 6174 6564 2061   is deprecated a
+0001e750: 6e64 2077 696c 6c20 6265 2072 656d 6f76  nd will be remov
+0001e760: 6564 2066 726f 6d22 0a20 2020 2020 2020  ed from".       
+0001e770: 2020 2020 2020 2020 2020 2020 2022 6461               "da
+0001e780: 736b 2069 6e20 6120 6675 7475 7265 2076  sk in a future v
+0001e790: 6572 7369 6f6e 2e20 5573 6520 6461 736b  ersion. Use dask
+0001e7a0: 2e64 6174 6166 7261 6d65 2e63 6f6e 6361  .dataframe.conca
+0001e7b0: 7420 696e 7374 6561 642e 222c 0a20 2020  t instead.",.   
+0001e7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e7d0: 2046 7574 7572 6557 6172 6e69 6e67 2c0a   FutureWarning,.
+0001e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e7f0: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+0001e800: 6265 6361 7573 6520 4461 7461 4672 616d  because DataFram
+0001e810: 652e 6170 7065 6e64 2077 696c 6c20 6f76  e.append will ov
+0001e820: 6572 7269 6465 2074 6865 206d 6574 686f  erride the metho
+0001e830: 642c 0a20 2020 2020 2020 2020 2020 2023  d,.            #
+0001e840: 2077 7261 7020 6279 2070 642e 5365 7269   wrap by pd.Seri
+0001e850: 6573 2e61 7070 656e 6420 646f 6373 7472  es.append docstr
+0001e860: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+0001e870: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
+0001e880: 616d 652e 6d75 6c74 6920 696d 706f 7274  ame.multi import
+0001e890: 2063 6f6e 6361 740a 0a20 2020 2020 2020   concat..       
+0001e8a0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0001e8b0: 6365 286f 7468 6572 2c20 286c 6973 742c  ce(other, (list,
+0001e8c0: 2064 6963 7429 293a 0a20 2020 2020 2020   dict)):.       
+0001e8d0: 2020 2020 2020 2020 206d 7367 203d 2022           msg = "
+0001e8e0: 6170 7065 6e64 2064 6f65 736e 2774 2073  append doesn't s
+0001e8f0: 7570 706f 7274 206c 6973 7420 6f72 2064  upport list or d
+0001e900: 6963 7420 696e 7075 7422 0a20 2020 2020  ict input".     
+0001e910: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0001e920: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+0001e930: 7272 6f72 286d 7367 290a 0a20 2020 2020  rror(msg)..     
+0001e940: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
+0001e950: 6e63 6174 280a 2020 2020 2020 2020 2020  ncat(.          
+0001e960: 2020 2020 2020 5b73 656c 662c 206f 7468        [self, oth
+0001e970: 6572 5d2c 206a 6f69 6e3d 226f 7574 6572  er], join="outer
+0001e980: 222c 2069 6e74 6572 6c65 6176 655f 7061  ", interleave_pa
+0001e990: 7274 6974 696f 6e73 3d69 6e74 6572 6c65  rtitions=interle
+0001e9a0: 6176 655f 7061 7274 6974 696f 6e73 0a20  ave_partitions. 
+0001e9b0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0001e9c0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+0001e9d0: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
+0001e9e0: 6566 2064 6f74 2873 656c 662c 206f 7468  ef dot(self, oth
+0001e9f0: 6572 2c20 6d65 7461 3d6e 6f5f 6465 6661  er, meta=no_defa
+0001ea00: 756c 7429 3a0a 2020 2020 2020 2020 6966  ult):.        if
+0001ea10: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0001ea20: 6f74 6865 722c 205f 4672 616d 6529 3a0a  other, _Frame):.
+0001ea30: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001ea40: 6520 5479 7065 4572 726f 7228 2254 6865  e TypeError("The
+0001ea50: 2073 6563 6f6e 6420 6f70 6572 616e 6420   second operand 
+0001ea60: 6d75 7374 2062 6520 6120 6461 736b 2061  must be a dask a
+0001ea70: 7272 6179 206f 7220 6461 736b 2064 6174  rray or dask dat
+0001ea80: 6166 7261 6d65 2229 0a0a 2020 2020 2020  aframe")..      
+0001ea90: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0001eaa0: 6f74 6865 722c 2044 6174 6146 7261 6d65  other, DataFrame
+0001eab0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+0001eac0: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
+0001ead0: 6974 696f 6e73 284d 2e64 6f74 2c20 6f74  itions(M.dot, ot
+0001eae0: 6865 722c 2074 6f6b 656e 3d22 646f 7422  her, token="dot"
+0001eaf0: 2c20 6d65 7461 3d6d 6574 6129 0a20 2020  , meta=meta).   
+0001eb00: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001eb10: 732e 6772 6f75 7062 7928 6279 3d73 2e69  s.groupby(by=s.i
+0001eb20: 6e64 6578 292e 6170 706c 7928 0a20 2020  ndex).apply(.   
+0001eb30: 2020 2020 2020 2020 2020 2020 206c 616d               lam
+0001eb40: 6264 6120 783a 2078 2e73 756d 2873 6b69  bda x: x.sum(ski
+0001eb50: 706e 613d 4661 6c73 6529 2c20 6d65 7461  pna=False), meta
+0001eb60: 3d73 2e5f 6d65 7461 5f6e 6f6e 656d 7074  =s._meta_nonempt
+0001eb70: 790a 2020 2020 2020 2020 2020 2020 290a  y.            ).
+0001eb80: 0a20 2020 2020 2020 2064 6566 205f 646f  .        def _do
+0001eb90: 745f 7365 7269 6573 282a 6172 6773 2c20  t_series(*args, 
+0001eba0: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+0001ebb0: 2020 2020 2020 2023 202e 7375 6d28 2920         # .sum() 
+0001ebc0: 6973 2069 6e76 6f6b 6564 206f 6e20 6561  is invoked on ea
+0001ebd0: 6368 2070 6172 7469 7469 6f6e 2062 6566  ch partition bef
+0001ebe0: 6f72 6520 6265 696e 6720 6170 706c 6965  ore being applie
+0001ebf0: 6420 746f 2061 6c6c 0a20 2020 2020 2020  d to all.       
+0001ec00: 2020 2020 2023 2070 6172 7469 7469 6f6e       # partition
+0001ec10: 732e 2054 6865 2072 6574 7572 6e20 7479  s. The return ty
+0001ec20: 7065 2069 7320 6578 7065 6374 6564 2074  pe is expected t
+0001ec30: 6f20 6265 2061 2073 6572 6965 732c 206e  o be a series, n
+0001ec40: 6f74 2061 206e 756d 7079 206f 626a 6563  ot a numpy objec
+0001ec50: 740a 2020 2020 2020 2020 2020 2020 7265  t.            re
+0001ec60: 7475 726e 206d 6574 615f 7365 7269 6573  turn meta_series
+0001ec70: 5f63 6f6e 7374 7275 6374 6f72 2873 656c  _constructor(sel
+0001ec80: 6629 284d 2e64 6f74 282a 6172 6773 2c20  f)(M.dot(*args, 
+0001ec90: 2a2a 6b77 6172 6773 2929 0a0a 2020 2020  **kwargs))..    
+0001eca0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001ecb0: 6d61 705f 7061 7274 6974 696f 6e73 285f  map_partitions(_
+0001ecc0: 646f 745f 7365 7269 6573 2c20 6f74 6865  dot_series, othe
+0001ecd0: 722c 2074 6f6b 656e 3d22 646f 7422 2c20  r, token="dot", 
+0001ece0: 6d65 7461 3d6d 6574 6129 2e73 756d 280a  meta=meta).sum(.
+0001ecf0: 2020 2020 2020 2020 2020 2020 736b 6970              skip
+0001ed00: 6e61 3d46 616c 7365 0a20 2020 2020 2020  na=False.       
+0001ed10: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
+0001ed20: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+0001ed30: 6d65 290a 2020 2020 6465 6620 616c 6967  me).    def alig
+0001ed40: 6e28 7365 6c66 2c20 6f74 6865 722c 206a  n(self, other, j
+0001ed50: 6f69 6e3d 226f 7574 6572 222c 2061 7869  oin="outer", axi
+0001ed60: 733d 4e6f 6e65 2c20 6669 6c6c 5f76 616c  s=None, fill_val
+0001ed70: 7565 3d4e 6f6e 6529 3a0a 2020 2020 2020  ue=None):.      
+0001ed80: 2020 6d65 7461 312c 206d 6574 6132 203d    meta1, meta2 =
+0001ed90: 205f 656d 756c 6174 6528 0a20 2020 2020   _emulate(.     
+0001eda0: 2020 2020 2020 204d 2e61 6c69 676e 2c20         M.align, 
+0001edb0: 7365 6c66 2c20 6f74 6865 722c 206a 6f69  self, other, joi
+0001edc0: 6e2c 2061 7869 733d 6178 6973 2c20 6669  n, axis=axis, fi
+0001edd0: 6c6c 5f76 616c 7565 3d66 696c 6c5f 7661  ll_value=fill_va
+0001ede0: 6c75 650a 2020 2020 2020 2020 290a 2020  lue.        ).  
+0001edf0: 2020 2020 2020 616c 6967 6e65 6420 3d20        aligned = 
+0001ee00: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+0001ee10: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+0001ee20: 204d 2e61 6c69 676e 2c0a 2020 2020 2020   M.align,.      
+0001ee30: 2020 2020 2020 6f74 6865 722c 0a20 2020        other,.   
+0001ee40: 2020 2020 2020 2020 206a 6f69 6e3d 6a6f           join=jo
+0001ee50: 696e 2c0a 2020 2020 2020 2020 2020 2020  in,.            
+0001ee60: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+0001ee70: 2020 2020 2020 2066 696c 6c5f 7661 6c75         fill_valu
+0001ee80: 653d 6669 6c6c 5f76 616c 7565 2c0a 2020  e=fill_value,.  
+0001ee90: 2020 2020 2020 2020 2020 656e 666f 7263            enforc
+0001eea0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+0001eeb0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0001eec0: 2020 2020 2074 6f6b 656e 203d 2074 6f6b       token = tok
+0001eed0: 656e 697a 6528 7365 6c66 2c20 6f74 6865  enize(self, othe
+0001eee0: 722c 206a 6f69 6e2c 2061 7869 732c 2066  r, join, axis, f
+0001eef0: 696c 6c5f 7661 6c75 6529 0a0a 2020 2020  ill_value)..    
+0001ef00: 2020 2020 6e61 6d65 3120 3d20 2261 6c69      name1 = "ali
+0001ef10: 676e 312d 2220 2b20 746f 6b65 6e0a 2020  gn1-" + token.  
+0001ef20: 2020 2020 2020 6473 6b31 203d 207b 0a20        dsk1 = {. 
+0001ef30: 2020 2020 2020 2020 2020 2028 6e61 6d65             (name
+0001ef40: 312c 2069 293a 2028 6765 7469 7465 6d2c  1, i): (getitem,
+0001ef50: 206b 6579 2c20 3029 0a20 2020 2020 2020   key, 0).       
+0001ef60: 2020 2020 2066 6f72 2069 2c20 6b65 7920       for i, key 
+0001ef70: 696e 2065 6e75 6d65 7261 7465 2861 6c69  in enumerate(ali
+0001ef80: 676e 6564 2e5f 5f64 6173 6b5f 6b65 7973  gned.__dask_keys
+0001ef90: 5f5f 2829 290a 2020 2020 2020 2020 7d0a  __()).        }.
+0001efa0: 2020 2020 2020 2020 6473 6b31 2e75 7064          dsk1.upd
+0001efb0: 6174 6528 616c 6967 6e65 642e 6461 736b  ate(aligned.dask
+0001efc0: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
+0001efd0: 3120 3d20 6e65 775f 6464 5f6f 626a 6563  1 = new_dd_objec
+0001efe0: 7428 6473 6b31 2c20 6e61 6d65 312c 206d  t(dsk1, name1, m
+0001eff0: 6574 6131 2c20 616c 6967 6e65 642e 6469  eta1, aligned.di
+0001f000: 7669 7369 6f6e 7329 0a0a 2020 2020 2020  visions)..      
+0001f010: 2020 6e61 6d65 3220 3d20 2261 6c69 676e    name2 = "align
+0001f020: 322d 2220 2b20 746f 6b65 6e0a 2020 2020  2-" + token.    
+0001f030: 2020 2020 6473 6b32 203d 207b 0a20 2020      dsk2 = {.   
+0001f040: 2020 2020 2020 2020 2028 6e61 6d65 322c           (name2,
+0001f050: 2069 293a 2028 6765 7469 7465 6d2c 206b   i): (getitem, k
+0001f060: 6579 2c20 3129 0a20 2020 2020 2020 2020  ey, 1).         
+0001f070: 2020 2066 6f72 2069 2c20 6b65 7920 696e     for i, key in
+0001f080: 2065 6e75 6d65 7261 7465 2861 6c69 676e   enumerate(align
+0001f090: 6564 2e5f 5f64 6173 6b5f 6b65 7973 5f5f  ed.__dask_keys__
+0001f0a0: 2829 290a 2020 2020 2020 2020 7d0a 2020  ()).        }.  
+0001f0b0: 2020 2020 2020 6473 6b32 2e75 7064 6174        dsk2.updat
+0001f0c0: 6528 616c 6967 6e65 642e 6461 736b 290a  e(aligned.dask).
+0001f0d0: 2020 2020 2020 2020 7265 7375 6c74 3220          result2 
+0001f0e0: 3d20 6e65 775f 6464 5f6f 626a 6563 7428  = new_dd_object(
+0001f0f0: 6473 6b32 2c20 6e61 6d65 322c 206d 6574  dsk2, name2, met
+0001f100: 6132 2c20 616c 6967 6e65 642e 6469 7669  a2, aligned.divi
+0001f110: 7369 6f6e 7329 0a0a 2020 2020 2020 2020  sions)..        
+0001f120: 7265 7475 726e 2072 6573 756c 7431 2c20  return result1, 
+0001f130: 7265 7375 6c74 320a 0a20 2020 2040 6465  result2..    @de
+0001f140: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0001f150: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0001f160: 2063 6f6d 6269 6e65 2873 656c 662c 206f   combine(self, o
+0001f170: 7468 6572 2c20 6675 6e63 2c20 6669 6c6c  ther, func, fill
+0001f180: 5f76 616c 7565 3d4e 6f6e 652c 206f 7665  _value=None, ove
+0001f190: 7277 7269 7465 3d54 7275 6529 3a0a 2020  rwrite=True):.  
+0001f1a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001f1b0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+0001f1c0: 280a 2020 2020 2020 2020 2020 2020 4d2e  (.            M.
+0001f1d0: 636f 6d62 696e 652c 206f 7468 6572 2c20  combine, other, 
+0001f1e0: 6675 6e63 2c20 6669 6c6c 5f76 616c 7565  func, fill_value
+0001f1f0: 3d66 696c 6c5f 7661 6c75 652c 206f 7665  =fill_value, ove
+0001f200: 7277 7269 7465 3d6f 7665 7277 7269 7465  rwrite=overwrite
+0001f210: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0001f220: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0001f230: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+0001f240: 6465 6620 636f 6d62 696e 655f 6669 7273  def combine_firs
+0001f250: 7428 7365 6c66 2c20 6f74 6865 7229 3a0a  t(self, other):.
+0001f260: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001f270: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+0001f280: 6e73 284d 2e63 6f6d 6269 6e65 5f66 6972  ns(M.combine_fir
+0001f290: 7374 2c20 6f74 6865 7229 0a0a 2020 2020  st, other)..    
+0001f2a0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
+0001f2b0: 2064 6566 205f 6269 6e64 5f6f 7065 7261   def _bind_opera
+0001f2c0: 746f 725f 6d65 7468 6f64 2863 6c73 2c20  tor_method(cls, 
+0001f2d0: 6e61 6d65 2c20 6f70 2c20 6f72 6967 696e  name, op, origin
+0001f2e0: 616c 3d70 642e 4461 7461 4672 616d 6529  al=pd.DataFrame)
+0001f2f0: 3a0a 2020 2020 2020 2020 2222 2262 696e  :.        """bin
+0001f300: 6420 6f70 6572 6174 6f72 206d 6574 686f  d operator metho
+0001f310: 6420 6c69 6b65 2044 6174 6146 7261 6d65  d like DataFrame
+0001f320: 2e61 6464 2074 6f20 7468 6973 2063 6c61  .add to this cla
+0001f330: 7373 2222 220a 2020 2020 2020 2020 7261  ss""".        ra
+0001f340: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0001f350: 6564 4572 726f 720a 0a20 2020 2040 6465  edError..    @de
+0001f360: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0001f370: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0001f380: 2072 6573 616d 706c 6528 7365 6c66 2c20   resample(self, 
+0001f390: 7275 6c65 2c20 636c 6f73 6564 3d4e 6f6e  rule, closed=Non
+0001f3a0: 652c 206c 6162 656c 3d4e 6f6e 6529 3a0a  e, label=None):.
+0001f3b0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+0001f3c0: 6b2e 6461 7461 6672 616d 652e 7473 6572  k.dataframe.tser
+0001f3d0: 6965 732e 7265 7361 6d70 6c65 2069 6d70  ies.resample imp
+0001f3e0: 6f72 7420 5265 7361 6d70 6c65 720a 0a20  ort Resampler.. 
+0001f3f0: 2020 2020 2020 2072 6574 7572 6e20 5265         return Re
+0001f400: 7361 6d70 6c65 7228 7365 6c66 2c20 7275  sampler(self, ru
+0001f410: 6c65 2c20 636c 6f73 6564 3d63 6c6f 7365  le, closed=close
+0001f420: 642c 206c 6162 656c 3d6c 6162 656c 290a  d, label=label).
+0001f430: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0001f440: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+0001f450: 0a20 2020 2064 6566 2066 6972 7374 2873  .    def first(s
+0001f460: 656c 662c 206f 6666 7365 7429 3a0a 2020  elf, offset):.  
+0001f470: 2020 2020 2020 2320 4c65 7420 7061 6e64        # Let pand
+0001f480: 6173 2065 7272 6f72 206f 6e20 6261 6420  as error on bad 
+0001f490: 6172 6773 0a20 2020 2020 2020 2073 656c  args.        sel
+0001f4a0: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
+0001f4b0: 2e66 6972 7374 286f 6666 7365 7429 0a0a  .first(offset)..
+0001f4c0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+0001f4d0: 656c 662e 6b6e 6f77 6e5f 6469 7669 7369  elf.known_divisi
+0001f4e0: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
+0001f4f0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001f500: 7228 2260 6669 7273 7460 2069 7320 6e6f  r("`first` is no
+0001f510: 7420 696d 706c 656d 656e 7465 6420 666f  t implemented fo
+0001f520: 7220 756e 6b6e 6f77 6e20 6469 7669 7369  r unknown divisi
+0001f530: 6f6e 7322 290a 0a20 2020 2020 2020 206f  ons")..        o
+0001f540: 6666 7365 7420 3d20 7064 2e74 7365 7269  ffset = pd.tseri
+0001f550: 6573 2e66 7265 7175 656e 6369 6573 2e74  es.frequencies.t
+0001f560: 6f5f 6f66 6673 6574 286f 6666 7365 7429  o_offset(offset)
+0001f570: 0a20 2020 2020 2020 2064 6174 6520 3d20  .        date = 
+0001f580: 7365 6c66 2e64 6976 6973 696f 6e73 5b30  self.divisions[0
+0001f590: 5d20 2b20 6f66 6673 6574 0a20 2020 2020  ] + offset.     
+0001f5a0: 2020 2065 6e64 203d 2073 656c 662e 6c6f     end = self.lo
+0001f5b0: 632e 5f67 6574 5f70 6172 7469 7469 6f6e  c._get_partition
+0001f5c0: 7328 6461 7465 290a 0a20 2020 2020 2020  s(date)..       
+0001f5d0: 2069 735f 616e 6368 6f72 6564 203d 206f   is_anchored = o
+0001f5e0: 6666 7365 742e 6973 5f61 6e63 686f 7265  ffset.is_anchore
+0001f5f0: 6428 290a 0a20 2020 2020 2020 2069 6e63  d()..        inc
+0001f600: 6c75 6465 5f72 6967 6874 203d 2069 735f  lude_right = is_
+0001f610: 616e 6368 6f72 6564 206f 7220 6e6f 7420  anchored or not 
+0001f620: 6861 7361 7474 7228 6f66 6673 6574 2c20  hasattr(offset, 
+0001f630: 2264 656c 7461 2229 0a0a 2020 2020 2020  "delta")..      
+0001f640: 2020 6966 2065 6e64 203d 3d20 7365 6c66    if end == self
+0001f650: 2e6e 7061 7274 6974 696f 6e73 202d 2031  .npartitions - 1
+0001f660: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
+0001f670: 7673 203d 2073 656c 662e 6469 7669 7369  vs = self.divisi
+0001f680: 6f6e 730a 2020 2020 2020 2020 656c 7365  ons.        else
+0001f690: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
+0001f6a0: 7673 203d 2073 656c 662e 6469 7669 7369  vs = self.divisi
+0001f6b0: 6f6e 735b 3a20 656e 6420 2b20 315d 202b  ons[: end + 1] +
+0001f6c0: 2028 6461 7465 2c29 0a0a 2020 2020 2020   (date,)..      
+0001f6d0: 2020 6e61 6d65 203d 2022 6669 7273 742d    name = "first-
+0001f6e0: 2220 2b20 746f 6b65 6e69 7a65 2873 656c  " + tokenize(sel
+0001f6f0: 662c 206f 6666 7365 7429 0a20 2020 2020  f, offset).     
+0001f700: 2020 2064 736b 203d 207b 286e 616d 652c     dsk = {(name,
+0001f710: 2069 293a 2028 7365 6c66 2e5f 6e61 6d65   i): (self._name
+0001f720: 2c20 6929 2066 6f72 2069 2069 6e20 7261  , i) for i in ra
+0001f730: 6e67 6528 656e 6429 7d0a 2020 2020 2020  nge(end)}.      
+0001f740: 2020 6473 6b5b 286e 616d 652c 2065 6e64    dsk[(name, end
+0001f750: 295d 203d 2028 0a20 2020 2020 2020 2020  )] = (.         
+0001f760: 2020 206d 6574 686f 6473 2e62 6f75 6e64     methods.bound
+0001f770: 6172 795f 736c 6963 652c 0a20 2020 2020  ary_slice,.     
+0001f780: 2020 2020 2020 2028 7365 6c66 2e5f 6e61         (self._na
+0001f790: 6d65 2c20 656e 6429 2c0a 2020 2020 2020  me, end),.      
+0001f7a0: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
+0001f7b0: 2020 2020 2020 2020 6461 7465 2c0a 2020          date,.  
+0001f7c0: 2020 2020 2020 2020 2020 696e 636c 7564            includ
+0001f7d0: 655f 7269 6768 742c 0a20 2020 2020 2020  e_right,.       
+0001f7e0: 2020 2020 2054 7275 652c 0a20 2020 2020       True,.     
+0001f7f0: 2020 2029 0a20 2020 2020 2020 2067 7261     ).        gra
+0001f800: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+0001f810: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+0001f820: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
+0001f830: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
+0001f840: 6c66 5d29 0a20 2020 2020 2020 2072 6574  lf]).        ret
+0001f850: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
+0001f860: 7428 6772 6170 682c 206e 616d 652c 2073  t(graph, name, s
+0001f870: 656c 662c 2064 6976 7329 0a0a 2020 2020  elf, divs)..    
+0001f880: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0001f890: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+0001f8a0: 6465 6620 6c61 7374 2873 656c 662c 206f  def last(self, o
+0001f8b0: 6666 7365 7429 3a0a 2020 2020 2020 2020  ffset):.        
+0001f8c0: 2320 4c65 7420 7061 6e64 6173 2065 7272  # Let pandas err
+0001f8d0: 6f72 206f 6e20 6261 6420 6172 6773 0a20  or on bad args. 
+0001f8e0: 2020 2020 2020 2073 656c 662e 5f6d 6574         self._met
+0001f8f0: 615f 6e6f 6e65 6d70 7479 2e66 6972 7374  a_nonempty.first
+0001f900: 286f 6666 7365 7429 0a0a 2020 2020 2020  (offset)..      
+0001f910: 2020 6966 206e 6f74 2073 656c 662e 6b6e    if not self.kn
+0001f920: 6f77 6e5f 6469 7669 7369 6f6e 733a 0a20  own_divisions:. 
+0001f930: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0001f940: 2056 616c 7565 4572 726f 7228 2260 6c61   ValueError("`la
+0001f950: 7374 6020 6973 206e 6f74 2069 6d70 6c65  st` is not imple
+0001f960: 6d65 6e74 6564 2066 6f72 2075 6e6b 6e6f  mented for unkno
+0001f970: 776e 2064 6976 6973 696f 6e73 2229 0a0a  wn divisions")..
+0001f980: 2020 2020 2020 2020 6f66 6673 6574 203d          offset =
+0001f990: 2070 642e 7473 6572 6965 732e 6672 6571   pd.tseries.freq
+0001f9a0: 7565 6e63 6965 732e 746f 5f6f 6666 7365  uencies.to_offse
+0001f9b0: 7428 6f66 6673 6574 290a 2020 2020 2020  t(offset).      
+0001f9c0: 2020 6461 7465 203d 2073 656c 662e 6469    date = self.di
+0001f9d0: 7669 7369 6f6e 735b 2d31 5d20 2d20 6f66  visions[-1] - of
+0001f9e0: 6673 6574 0a20 2020 2020 2020 2073 7461  fset.        sta
+0001f9f0: 7274 203d 2073 656c 662e 6c6f 632e 5f67  rt = self.loc._g
+0001fa00: 6574 5f70 6172 7469 7469 6f6e 7328 6461  et_partitions(da
+0001fa10: 7465 290a 0a20 2020 2020 2020 2069 6620  te)..        if 
+0001fa20: 7374 6172 7420 3d3d 2030 3a0a 2020 2020  start == 0:.    
+0001fa30: 2020 2020 2020 2020 6469 7673 203d 2073          divs = s
+0001fa40: 656c 662e 6469 7669 7369 6f6e 730a 2020  elf.divisions.  
+0001fa50: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001fa60: 2020 2020 2020 2020 6469 7673 203d 2028          divs = (
+0001fa70: 6461 7465 2c29 202b 2073 656c 662e 6469  date,) + self.di
+0001fa80: 7669 7369 6f6e 735b 7374 6172 7420 2b20  visions[start + 
+0001fa90: 3120 3a5d 0a0a 2020 2020 2020 2020 6e61  1 :]..        na
+0001faa0: 6d65 203d 2022 6c61 7374 2d22 202b 2074  me = "last-" + t
+0001fab0: 6f6b 656e 697a 6528 7365 6c66 2c20 6f66  okenize(self, of
+0001fac0: 6673 6574 290a 2020 2020 2020 2020 6473  fset).        ds
+0001fad0: 6b20 3d20 7b0a 2020 2020 2020 2020 2020  k = {.          
+0001fae0: 2020 286e 616d 652c 2069 202b 2031 293a    (name, i + 1):
+0001faf0: 2028 7365 6c66 2e5f 6e61 6d65 2c20 6a20   (self._name, j 
+0001fb00: 2b20 3129 0a20 2020 2020 2020 2020 2020  + 1).           
+0001fb10: 2066 6f72 2069 2c20 6a20 696e 2065 6e75   for i, j in enu
+0001fb20: 6d65 7261 7465 2872 616e 6765 2873 7461  merate(range(sta
+0001fb30: 7274 2c20 7365 6c66 2e6e 7061 7274 6974  rt, self.npartit
+0001fb40: 696f 6e73 2929 0a20 2020 2020 2020 207d  ions)).        }
+0001fb50: 0a20 2020 2020 2020 2064 736b 5b28 6e61  .        dsk[(na
+0001fb60: 6d65 2c20 3029 5d20 3d20 280a 2020 2020  me, 0)] = (.    
+0001fb70: 2020 2020 2020 2020 6d65 7468 6f64 732e          methods.
+0001fb80: 626f 756e 6461 7279 5f73 6c69 6365 2c0a  boundary_slice,.
+0001fb90: 2020 2020 2020 2020 2020 2020 2873 656c              (sel
+0001fba0: 662e 5f6e 616d 652c 2073 7461 7274 292c  f._name, start),
+0001fbb0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+0001fbc0: 652c 0a20 2020 2020 2020 2020 2020 204e  e,.            N
+0001fbd0: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0001fbe0: 2054 7275 652c 0a20 2020 2020 2020 2020   True,.         
+0001fbf0: 2020 2046 616c 7365 2c0a 2020 2020 2020     False,.      
+0001fc00: 2020 290a 2020 2020 2020 2020 6772 6170    ).        grap
+0001fc10: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+0001fc20: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+0001fc30: 6f6e 7328 6e61 6d65 2c20 6473 6b2c 2064  ons(name, dsk, d
+0001fc40: 6570 656e 6465 6e63 6965 733d 5b73 656c  ependencies=[sel
+0001fc50: 665d 290a 2020 2020 2020 2020 7265 7475  f]).        retu
+0001fc60: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
+0001fc70: 2867 7261 7068 2c20 6e61 6d65 2c20 7365  (graph, name, se
+0001fc80: 6c66 2c20 6469 7673 290a 0a20 2020 2064  lf, divs)..    d
+0001fc90: 6566 206e 756e 6971 7565 5f61 7070 726f  ef nunique_appro
+0001fca0: 7828 7365 6c66 2c20 7370 6c69 745f 6576  x(self, split_ev
+0001fcb0: 6572 793d 4e6f 6e65 293a 0a20 2020 2020  ery=None):.     
+0001fcc0: 2020 2022 2222 4170 7072 6f78 696d 6174     """Approximat
+0001fcd0: 6520 6e75 6d62 6572 206f 6620 756e 6971  e number of uniq
+0001fce0: 7565 2072 6f77 732e 0a0a 2020 2020 2020  ue rows...      
+0001fcf0: 2020 5468 6973 206d 6574 686f 6420 7573    This method us
+0001fd00: 6573 2074 6865 2048 7970 6572 4c6f 674c  es the HyperLogL
+0001fd10: 6f67 2061 6c67 6f72 6974 686d 2066 6f72  og algorithm for
+0001fd20: 2063 6172 6469 6e61 6c69 7479 0a20 2020   cardinality.   
+0001fd30: 2020 2020 2065 7374 696d 6174 696f 6e20       estimation 
+0001fd40: 746f 2063 6f6d 7075 7465 2074 6865 2061  to compute the a
+0001fd50: 7070 726f 7869 6d61 7465 206e 756d 6265  pproximate numbe
+0001fd60: 7220 6f66 2075 6e69 7175 6520 726f 7773  r of unique rows
+0001fd70: 2e0a 2020 2020 2020 2020 5468 6520 6170  ..        The ap
+0001fd80: 7072 6f78 696d 6174 6520 6572 726f 7220  proximate error 
+0001fd90: 6973 2030 2e34 3036 252e 0a0a 2020 2020  is 0.406%...    
+0001fda0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0001fdb0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001fdc0: 2d0a 2020 2020 2020 2020 7370 6c69 745f  -.        split_
+0001fdd0: 6576 6572 7920 3a20 696e 742c 206f 7074  every : int, opt
+0001fde0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0001fdf0: 2020 4772 6f75 7020 7061 7274 6974 696f    Group partitio
+0001fe00: 6e73 2069 6e74 6f20 6772 6f75 7073 206f  ns into groups o
+0001fe10: 6620 7468 6973 2073 697a 6520 7768 696c  f this size whil
+0001fe20: 6520 7065 7266 6f72 6d69 6e67 2061 0a20  e performing a. 
+0001fe30: 2020 2020 2020 2020 2020 2074 7265 652d             tree-
+0001fe40: 7265 6475 6374 696f 6e2e 2049 6620 7365  reduction. If se
+0001fe50: 7420 746f 2046 616c 7365 2c20 6e6f 2074  t to False, no t
+0001fe60: 7265 652d 7265 6475 6374 696f 6e20 7769  ree-reduction wi
+0001fe70: 6c6c 2062 6520 7573 6564 2e0a 2020 2020  ll be used..    
+0001fe80: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
+0001fe90: 6973 2038 2e0a 0a20 2020 2020 2020 2052  is 8...        R
+0001fea0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+0001feb0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2061  ------.        a
+0001fec0: 2066 6c6f 6174 2072 6570 7265 7365 6e74   float represent
+0001fed0: 696e 6720 7468 6520 6170 7072 6f78 696d  ing the approxim
+0001fee0: 6174 6520 6e75 6d62 6572 206f 6620 656c  ate number of el
+0001fef0: 656d 656e 7473 0a20 2020 2020 2020 2022  ements.        "
+0001ff00: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+0001ff10: 6461 736b 2e64 6174 6166 7261 6d65 2069  dask.dataframe i
+0001ff20: 6d70 6f72 7420 6879 7065 726c 6f67 6c6f  mport hyperloglo
+0001ff30: 6720 2023 2068 6572 6520 746f 2061 766f  g  # here to avo
+0001ff40: 6964 2063 6972 6375 6c61 7220 696d 706f  id circular impo
+0001ff50: 7274 2069 7373 7565 730a 0a20 2020 2020  rt issues..     
+0001ff60: 2020 2072 6574 7572 6e20 6163 6128 0a20     return aca(. 
+0001ff70: 2020 2020 2020 2020 2020 205b 7365 6c66             [self
+0001ff80: 5d2c 0a20 2020 2020 2020 2020 2020 2063  ],.            c
+0001ff90: 6875 6e6b 3d68 7970 6572 6c6f 676c 6f67  hunk=hyperloglog
+0001ffa0: 2e63 6f6d 7075 7465 5f68 6c6c 5f61 7272  .compute_hll_arr
+0001ffb0: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
+0001ffc0: 636f 6d62 696e 653d 6879 7065 726c 6f67  combine=hyperlog
+0001ffd0: 6c6f 672e 7265 6475 6365 5f73 7461 7465  log.reduce_state
+0001ffe0: 2c0a 2020 2020 2020 2020 2020 2020 6167  ,.            ag
+0001fff0: 6772 6567 6174 653d 6879 7065 726c 6f67  gregate=hyperlog
+00020000: 6c6f 672e 6573 7469 6d61 7465 5f63 6f75  log.estimate_cou
+00020010: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
+00020020: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+00020030: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
+00020040: 2020 2020 2062 3d31 362c 0a20 2020 2020       b=16,.     
+00020050: 2020 2020 2020 206d 6574 613d 666c 6f61         meta=floa
+00020060: 742c 0a20 2020 2020 2020 2029 0a0a 2020  t,.        )..  
+00020070: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00020080: 6465 6620 7661 6c75 6573 2873 656c 6629  def values(self)
+00020090: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+000200a0: 7572 6e20 6120 6461 736b 2e61 7272 6179  urn a dask.array
+000200b0: 206f 6620 7468 6520 7661 6c75 6573 206f   of the values o
+000200c0: 6620 7468 6973 2064 6174 6166 7261 6d65  f this dataframe
+000200d0: 0a0a 2020 2020 2020 2020 5761 726e 696e  ..        Warnin
+000200e0: 673a 2054 6869 7320 6372 6561 7465 7320  g: This creates 
+000200f0: 6120 6461 736b 2e61 7272 6179 2077 6974  a dask.array wit
+00020100: 686f 7574 2070 7265 6369 7365 2073 6861  hout precise sha
+00020110: 7065 2069 6e66 6f72 6d61 7469 6f6e 2e0a  pe information..
+00020120: 2020 2020 2020 2020 4f70 6572 6174 696f          Operatio
+00020130: 6e73 2074 6861 7420 6465 7065 6e64 206f  ns that depend o
+00020140: 6e20 7368 6170 6520 696e 666f 726d 6174  n shape informat
+00020150: 696f 6e2c 206c 696b 6520 736c 6963 696e  ion, like slicin
+00020160: 6720 6f72 2072 6573 6861 7069 6e67 2c0a  g or reshaping,.
+00020170: 2020 2020 2020 2020 7769 6c6c 206e 6f74          will not
+00020180: 2077 6f72 6b2e 0a20 2020 2020 2020 2022   work..        "
+00020190: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
+000201a0: 5f65 7874 656e 7369 6f6e 5f61 7272 6179  _extension_array
+000201b0: 5f64 7479 7065 2873 656c 662e 5f6d 6574  _dtype(self._met
+000201c0: 612e 7661 6c75 6573 293a 0a20 2020 2020  a.values):.     
+000201d0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+000201e0: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+000201f0: 2020 2020 2020 2244 6173 6b20 6375 7272        "Dask curr
+00020200: 656e 746c 7920 6861 7320 6c69 6d69 7465  ently has limite
+00020210: 6420 7375 7070 6f72 7420 666f 7220 636f  d support for co
+00020220: 6e76 6572 7469 6e67 2070 616e 6461 7320  nverting pandas 
+00020230: 6578 7465 6e73 696f 6e20 6474 7970 6573  extension dtypes
+00020240: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+00020250: 2020 2066 2274 6f20 6172 7261 7973 2e20     f"to arrays. 
+00020260: 436f 6e76 6572 7469 6e67 207b 7365 6c66  Converting {self
+00020270: 2e5f 6d65 7461 2e76 616c 7565 732e 6474  ._meta.values.dt
+00020280: 7970 657d 2074 6f20 6f62 6a65 6374 2064  ype} to object d
+00020290: 7479 7065 2e22 2c0a 2020 2020 2020 2020  type.",.        
+000202a0: 2020 2020 2020 2020 5573 6572 5761 726e          UserWarn
+000202b0: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
+000202c0: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+000202d0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+000202e0: 7469 6f6e 7328 6d65 7468 6f64 732e 7661  tions(methods.va
+000202f0: 6c75 6573 290a 0a20 2020 2064 6566 205f  lues)..    def _
+00020300: 7661 6c69 6461 7465 5f63 6875 6e6b 7328  validate_chunks(
+00020310: 7365 6c66 2c20 6172 722c 206c 656e 6774  self, arr, lengt
+00020320: 6873 293a 0a20 2020 2020 2020 2066 726f  hs):.        fro
+00020330: 6d20 6461 736b 2e61 7272 6179 2e63 6f72  m dask.array.cor
+00020340: 6520 696d 706f 7274 206e 6f72 6d61 6c69  e import normali
+00020350: 7a65 5f63 6875 6e6b 730a 0a20 2020 2020  ze_chunks..     
+00020360: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00020370: 286c 656e 6774 6873 2c20 5365 7175 656e  (lengths, Sequen
+00020380: 6365 293a 0a20 2020 2020 2020 2020 2020  ce):.           
+00020390: 206c 656e 6774 6873 203d 2074 7570 6c65   lengths = tuple
+000203a0: 286c 656e 6774 6873 290a 0a20 2020 2020  (lengths)..     
+000203b0: 2020 2020 2020 2069 6620 6c65 6e28 6c65         if len(le
+000203c0: 6e67 7468 7329 2021 3d20 7365 6c66 2e6e  ngths) != self.n
+000203d0: 7061 7274 6974 696f 6e73 3a0a 2020 2020  partitions:.    
+000203e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000203f0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+00020400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020410: 2020 2254 6865 206e 756d 6265 7220 6f66    "The number of
+00020420: 2069 7465 6d73 2069 6e20 276c 656e 6774   items in 'lengt
+00020430: 6873 2720 646f 6573 206e 6f74 206d 6174  hs' does not mat
+00020440: 6368 2074 6865 206e 756d 6265 7220 6f66  ch the number of
+00020450: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+00020460: 2020 2020 2020 2066 2270 6172 7469 7469         f"partiti
+00020470: 6f6e 732e 207b 6c65 6e28 6c65 6e67 7468  ons. {len(length
+00020480: 7329 7d20 213d 207b 7365 6c66 2e6e 7061  s)} != {self.npa
+00020490: 7274 6974 696f 6e73 7d22 0a20 2020 2020  rtitions}".     
+000204a0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+000204b0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000204c0: 662e 6e64 696d 203d 3d20 313a 0a20 2020  f.ndim == 1:.   
+000204d0: 2020 2020 2020 2020 2020 2020 2063 6875               chu
+000204e0: 6e6b 7320 3d20 6e6f 726d 616c 697a 655f  nks = normalize_
+000204f0: 6368 756e 6b73 2828 6c65 6e67 7468 732c  chunks((lengths,
+00020500: 2929 0a20 2020 2020 2020 2020 2020 2065  )).            e
+00020510: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00020520: 2020 2020 2063 6875 6e6b 7320 3d20 6e6f       chunks = no
+00020530: 726d 616c 697a 655f 6368 756e 6b73 2828  rmalize_chunks((
+00020540: 6c65 6e67 7468 732c 2028 6c65 6e28 7365  lengths, (len(se
+00020550: 6c66 2e63 6f6c 756d 6e73 292c 2929 290a  lf.columns),))).
+00020560: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00020570: 7572 6e20 6368 756e 6b73 0a20 2020 2020  urn chunks.     
+00020580: 2020 2065 6c69 6620 6c65 6e67 7468 7320     elif lengths 
+00020590: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000205a0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+000205b0: 616c 7565 4572 726f 7228 6622 556e 6578  alueError(f"Unex
+000205c0: 7065 6374 6564 2076 616c 7565 2066 6f72  pected value for
+000205d0: 2027 6c65 6e67 7468 7327 3a20 277b 6c65   'lengths': '{le
+000205e0: 6e67 7468 737d 2722 290a 0a20 2020 2020  ngths}'")..     
+000205f0: 2020 2072 6574 7572 6e20 6172 722e 5f63     return arr._c
+00020600: 6875 6e6b 730a 0a20 2020 2064 6566 205f  hunks..    def _
+00020610: 6973 5f69 6e64 6578 5f6c 6576 656c 5f72  is_index_level_r
+00020620: 6566 6572 656e 6365 2873 656c 662c 206b  eference(self, k
+00020630: 6579 293a 0a20 2020 2020 2020 2022 2222  ey):.        """
+00020640: 0a20 2020 2020 2020 2054 6573 7420 7768  .        Test wh
+00020650: 6574 6865 7220 6120 6b65 7920 6973 2061  ether a key is a
+00020660: 6e20 696e 6465 7820 6c65 7665 6c20 7265  n index level re
+00020670: 6665 7265 6e63 650a 0a20 2020 2020 2020  ference..       
+00020680: 2054 6f20 6265 2063 6f6e 7369 6465 7265   To be considere
+00020690: 6420 616e 2069 6e64 6578 206c 6576 656c  d an index level
+000206a0: 2072 6566 6572 656e 6365 2c20 606b 6579   reference, `key
+000206b0: 6020 6d75 7374 206d 6174 6368 2074 6865  ` must match the
+000206c0: 2069 6e64 6578 206e 616d 650a 2020 2020   index name.    
+000206d0: 2020 2020 616e 6420 6d75 7374 204e 4f54      and must NOT
+000206e0: 206d 6174 6368 2074 6865 206e 616d 6520   match the name 
+000206f0: 6f66 2061 6e79 2063 6f6c 756d 6e20 2869  of any column (i
+00020700: 6620 6120 6461 7461 6672 616d 6529 2e0a  f a dataframe)..
+00020710: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00020720: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
+00020730: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
+00020740: 6465 782e 6e61 6d65 2069 7320 6e6f 7420  dex.name is not 
+00020750: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+00020760: 2061 6e64 206e 6f74 2069 735f 6461 736b   and not is_dask
+00020770: 5f63 6f6c 6c65 6374 696f 6e28 6b65 7929  _collection(key)
+00020780: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00020790: 2028 6e70 2e69 7373 6361 6c61 7228 6b65   (np.isscalar(ke
+000207a0: 7929 206f 7220 6973 696e 7374 616e 6365  y) or isinstance
+000207b0: 286b 6579 2c20 7475 706c 6529 290a 2020  (key, tuple)).  
+000207c0: 2020 2020 2020 2020 2020 616e 6420 6b65            and ke
+000207d0: 7920 3d3d 2073 656c 662e 696e 6465 782e  y == self.index.
+000207e0: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+000207f0: 2061 6e64 206b 6579 206e 6f74 2069 6e20   and key not in 
+00020800: 6765 7461 7474 7228 7365 6c66 2c20 2263  getattr(self, "c
+00020810: 6f6c 756d 6e73 222c 2028 2929 0a20 2020  olumns", ()).   
+00020820: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00020830: 5f63 6f6e 7461 696e 735f 696e 6465 785f  _contains_index_
+00020840: 6e61 6d65 2873 656c 662c 2063 6f6c 756d  name(self, colum
+00020850: 6e73 5f6f 725f 696e 6465 7829 3a0a 2020  ns_or_index):.  
+00020860: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00020870: 2020 5465 7374 2077 6865 7468 6572 2074    Test whether t
+00020880: 6865 2069 6e70 7574 2063 6f6e 7461 696e  he input contain
+00020890: 7320 6120 7265 6665 7265 6e63 6520 746f  s a reference to
+000208a0: 2074 6865 2069 6e64 6578 206f 6620 7468   the index of th
+000208b0: 6520 4461 7461 4672 616d 652f 5365 7269  e DataFrame/Seri
+000208c0: 6573 0a20 2020 2020 2020 2022 2222 0a20  es.        """. 
+000208d0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000208e0: 616e 6365 2863 6f6c 756d 6e73 5f6f 725f  ance(columns_or_
+000208f0: 696e 6465 782c 206c 6973 7429 3a0a 2020  index, list):.  
+00020900: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00020910: 2061 6e79 2873 656c 662e 5f69 735f 696e   any(self._is_in
+00020920: 6465 785f 6c65 7665 6c5f 7265 6665 7265  dex_level_refere
+00020930: 6e63 6528 6e29 2066 6f72 206e 2069 6e20  nce(n) for n in 
+00020940: 636f 6c75 6d6e 735f 6f72 5f69 6e64 6578  columns_or_index
+00020950: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00020960: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00020970: 726e 2073 656c 662e 5f69 735f 696e 6465  rn self._is_inde
+00020980: 785f 6c65 7665 6c5f 7265 6665 7265 6e63  x_level_referenc
+00020990: 6528 636f 6c75 6d6e 735f 6f72 5f69 6e64  e(columns_or_ind
+000209a0: 6578 290a 0a0a 6465 6620 5f72 6169 7365  ex)...def _raise
+000209b0: 5f69 665f 6f62 6a65 6374 5f73 6572 6965  _if_object_serie
+000209c0: 7328 782c 2066 756e 636e 616d 6529 3a0a  s(x, funcname):.
+000209d0: 2020 2020 2222 220a 2020 2020 5574 696c      """.    Util
+000209e0: 6974 7920 6675 6e63 7469 6f6e 2074 6f20  ity function to 
+000209f0: 7261 6973 6520 616e 2065 7272 6f72 2069  raise an error i
+00020a00: 6620 616e 206f 626a 6563 7420 636f 6c75  f an object colu
+00020a10: 6d6e 2064 6f65 7320 6e6f 7420 7375 7070  mn does not supp
+00020a20: 6f72 740a 2020 2020 6120 6365 7274 6169  ort.    a certai
+00020a30: 6e20 6f70 6572 6174 696f 6e20 6c69 6b65  n operation like
+00020a40: 2060 6d65 616e 602e 0a20 2020 2022 2222   `mean`..    """
+00020a50: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+00020a60: 6365 2878 2c20 5365 7269 6573 2920 616e  ce(x, Series) an
+00020a70: 6420 6861 7361 7474 7228 782c 2022 6474  d hasattr(x, "dt
+00020a80: 7970 6522 293a 0a20 2020 2020 2020 2069  ype"):.        i
+00020a90: 6620 782e 6474 7970 6520 3d3d 206f 626a  f x.dtype == obj
+00020aa0: 6563 743a 0a20 2020 2020 2020 2020 2020  ect:.           
+00020ab0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00020ac0: 7228 2260 2573 6020 6e6f 7420 7375 7070  r("`%s` not supp
+00020ad0: 6f72 7465 6420 7769 7468 206f 626a 6563  orted with objec
+00020ae0: 7420 7365 7269 6573 2220 2520 6675 6e63  t series" % func
+00020af0: 6e61 6d65 290a 2020 2020 2020 2020 656c  name).        el
+00020b00: 6966 2070 642e 6170 692e 7479 7065 732e  if pd.api.types.
+00020b10: 6973 5f64 7479 7065 5f65 7175 616c 2878  is_dtype_equal(x
+00020b20: 2e64 7479 7065 2c20 2273 7472 696e 6722  .dtype, "string"
+00020b30: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00020b40: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00020b50: 2260 2573 6020 6e6f 7420 7375 7070 6f72  "`%s` not suppor
+00020b60: 7465 6420 7769 7468 2073 7472 696e 6720  ted with string 
+00020b70: 7365 7269 6573 2220 2520 6675 6e63 6e61  series" % funcna
+00020b80: 6d65 290a 0a0a 636c 6173 7320 5365 7269  me)...class Seri
+00020b90: 6573 285f 4672 616d 6529 3a0a 2020 2020  es(_Frame):.    
+00020ba0: 2222 2250 6172 616c 6c65 6c20 5061 6e64  """Parallel Pand
+00020bb0: 6173 2053 6572 6965 730a 0a20 2020 2044  as Series..    D
+00020bc0: 6f20 6e6f 7420 7573 6520 7468 6973 2063  o not use this c
+00020bd0: 6c61 7373 2064 6972 6563 746c 792e 2020  lass directly.  
+00020be0: 496e 7374 6561 6420 7573 6520 6675 6e63  Instead use func
+00020bf0: 7469 6f6e 7320 6c69 6b65 0a20 2020 2060  tions like.    `
+00020c00: 6064 642e 7265 6164 5f63 7376 6060 2c20  `dd.read_csv``, 
+00020c10: 6060 6464 2e72 6561 645f 7061 7271 7565  ``dd.read_parque
+00020c20: 7460 602c 206f 7220 6060 6464 2e66 726f  t``, or ``dd.fro
+00020c30: 6d5f 7061 6e64 6173 6060 2e0a 0a20 2020  m_pandas``...   
+00020c40: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00020c50: 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020  ----------..    
+00020c60: 6473 6b3a 2064 6963 740a 2020 2020 2020  dsk: dict.      
+00020c70: 2020 5468 6520 6461 736b 2067 7261 7068    The dask graph
+00020c80: 2074 6f20 636f 6d70 7574 6520 7468 6973   to compute this
+00020c90: 2053 6572 6965 730a 2020 2020 5f6e 616d   Series.    _nam
+00020ca0: 653a 2073 7472 0a20 2020 2020 2020 2054  e: str.        T
+00020cb0: 6865 206b 6579 2070 7265 6669 7820 7468  he key prefix th
+00020cc0: 6174 2073 7065 6369 6669 6573 2077 6869  at specifies whi
+00020cd0: 6368 206b 6579 7320 696e 2074 6865 2064  ch keys in the d
+00020ce0: 6173 6b20 636f 6d70 7269 7365 2074 6869  ask comprise thi
+00020cf0: 730a 2020 2020 2020 2020 7061 7274 6963  s.        partic
+00020d00: 756c 6172 2053 6572 6965 730a 2020 2020  ular Series.    
+00020d10: 6d65 7461 3a20 7061 6e64 6173 2e53 6572  meta: pandas.Ser
+00020d20: 6965 730a 2020 2020 2020 2020 416e 2065  ies.        An e
+00020d30: 6d70 7479 2060 6070 616e 6461 732e 5365  mpty ``pandas.Se
+00020d40: 7269 6573 6060 2077 6974 6820 6e61 6d65  ries`` with name
+00020d50: 732c 2064 7479 7065 732c 2061 6e64 2069  s, dtypes, and i
+00020d60: 6e64 6578 206d 6174 6368 696e 6720 7468  ndex matching th
+00020d70: 650a 2020 2020 2020 2020 6578 7065 6374  e.        expect
+00020d80: 6564 206f 7574 7075 742e 0a20 2020 2064  ed output..    d
+00020d90: 6976 6973 696f 6e73 3a20 7475 706c 6520  ivisions: tuple 
+00020da0: 6f66 2069 6e64 6578 2076 616c 7565 730a  of index values.
+00020db0: 2020 2020 2020 2020 5661 6c75 6573 2061          Values a
+00020dc0: 6c6f 6e67 2077 6869 6368 2077 6520 7061  long which we pa
+00020dd0: 7274 6974 696f 6e20 6f75 7220 626c 6f63  rtition our bloc
+00020de0: 6b73 206f 6e20 7468 6520 696e 6465 780a  ks on the index.
+00020df0: 0a20 2020 2053 6565 2041 6c73 6f0a 2020  .    See Also.  
+00020e00: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064    --------.    d
+00020e10: 6173 6b2e 6461 7461 6672 616d 652e 4461  ask.dataframe.Da
+00020e20: 7461 4672 616d 650a 2020 2020 2222 220a  taFrame.    """.
+00020e30: 0a20 2020 205f 7061 7274 6974 696f 6e5f  .    _partition_
+00020e40: 7479 7065 203d 2070 642e 5365 7269 6573  type = pd.Series
+00020e50: 0a20 2020 205f 6973 5f70 6172 7469 7469  .    _is_partiti
+00020e60: 6f6e 5f74 7970 6520 3d20 7374 6174 6963  on_type = static
+00020e70: 6d65 7468 6f64 2869 735f 7365 7269 6573  method(is_series
+00020e80: 5f6c 696b 6529 0a20 2020 205f 746f 6b65  _like).    _toke
+00020e90: 6e5f 7072 6566 6978 203d 2022 7365 7269  n_prefix = "seri
+00020ea0: 6573 2d22 0a20 2020 205f 6163 6365 7373  es-".    _access
+00020eb0: 6f72 733a 2043 6c61 7373 5661 725b 7365  ors: ClassVar[se
+00020ec0: 745b 7374 725d 5d20 3d20 7365 7428 290a  t[str]] = set().
+00020ed0: 0a20 2020 2064 6566 205f 5f61 7272 6179  .    def __array
+00020ee0: 5f77 7261 705f 5f28 7365 6c66 2c20 6172  _wrap__(self, ar
+00020ef0: 7261 792c 2063 6f6e 7465 7874 3d4e 6f6e  ray, context=Non
+00020f00: 6529 3a0a 2020 2020 2020 2020 6966 2069  e):.        if i
+00020f10: 7369 6e73 7461 6e63 6528 636f 6e74 6578  sinstance(contex
+00020f20: 742c 2074 7570 6c65 2920 616e 6420 6c65  t, tuple) and le
+00020f30: 6e28 636f 6e74 6578 7429 203e 2030 3a0a  n(context) > 0:.
+00020f40: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00020f50: 7369 6e73 7461 6e63 6528 636f 6e74 6578  sinstance(contex
+00020f60: 745b 315d 5b30 5d2c 206e 702e 6e64 6172  t[1][0], np.ndar
+00020f70: 7261 7929 2061 6e64 2063 6f6e 7465 7874  ray) and context
+00020f80: 5b31 5d5b 305d 2e73 6861 7065 203d 3d20  [1][0].shape == 
+00020f90: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00020fa0: 2020 2020 696e 6465 7820 3d20 4e6f 6e65      index = None
+00020fb0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00020fc0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00020fd0: 2020 2069 6e64 6578 203d 2063 6f6e 7465     index = conte
+00020fe0: 7874 5b31 5d5b 305d 2e69 6e64 6578 0a20  xt[1][0].index. 
+00020ff0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00021000: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+00021010: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00021020: 706f 7274 2069 6e73 7065 6374 0a0a 2020  port inspect..  
+00021030: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00021040: 7468 6f64 5f6e 616d 6520 3d20 6622 607b  thod_name = f"`{
+00021050: 696e 7370 6563 742e 7374 6163 6b28 295b  inspect.stack()[
+00021060: 335d 5b33 5d7d 6022 0a20 2020 2020 2020  3][3]}`".       
+00021070: 2020 2020 2065 7863 6570 7420 496e 6465       except Inde
+00021080: 7845 7272 6f72 3a0a 2020 2020 2020 2020  xError:.        
+00021090: 2020 2020 2020 2020 6d65 7468 6f64 5f6e          method_n
+000210a0: 616d 6520 3d20 2254 6869 7320 6d65 7468  ame = "This meth
+000210b0: 6f64 220a 2020 2020 2020 2020 2020 2020  od".            
+000210c0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+000210d0: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
+000210e0: 2020 2020 2020 2020 2020 2066 227b 6d65             f"{me
+000210f0: 7468 6f64 5f6e 616d 657d 2069 7320 6e6f  thod_name} is no
+00021100: 7420 696d 706c 656d 656e 7465 6420 666f  t implemented fo
+00021110: 7220 6064 6173 6b2e 6461 7461 6672 616d  r `dask.datafram
+00021120: 652e 5365 7269 6573 602e 220a 2020 2020  e.Series`.".    
+00021130: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00021140: 2020 2072 6574 7572 6e20 6d65 7461 5f73     return meta_s
+00021150: 6572 6965 735f 636f 6e73 7472 7563 746f  eries_constructo
+00021160: 7228 7365 6c66 2928 6172 7261 792c 2069  r(self)(array, i
+00021170: 6e64 6578 3d69 6e64 6578 2c20 6e61 6d65  ndex=index, name
+00021180: 3d73 656c 662e 6e61 6d65 290a 0a20 2020  =self.name)..   
+00021190: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000211a0: 6566 2061 7865 7328 7365 6c66 293a 0a20  ef axes(self):. 
+000211b0: 2020 2020 2020 2072 6574 7572 6e20 5b73         return [s
+000211c0: 656c 662e 696e 6465 785d 0a0a 2020 2020  elf.index]..    
+000211d0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+000211e0: 6620 6e61 6d65 2873 656c 6629 3a0a 2020  f name(self):.  
+000211f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00021200: 662e 5f6d 6574 612e 6e61 6d65 0a0a 2020  f._meta.name..  
+00021210: 2020 406e 616d 652e 7365 7474 6572 0a20    @name.setter. 
+00021220: 2020 2064 6566 206e 616d 6528 7365 6c66     def name(self
+00021230: 2c20 6e61 6d65 293a 0a20 2020 2020 2020  , name):.       
+00021240: 2073 656c 662e 5f6d 6574 612e 6e61 6d65   self._meta.name
+00021250: 203d 206e 616d 650a 2020 2020 2020 2020   = name.        
+00021260: 7265 6e61 6d65 6420 3d20 5f72 656e 616d  renamed = _renam
+00021270: 655f 6461 736b 2873 656c 662c 206e 616d  e_dask(self, nam
+00021280: 6529 0a20 2020 2020 2020 2023 2075 7064  e).        # upd
+00021290: 6174 6520 6d79 7365 6c66 0a20 2020 2020  ate myself.     
+000212a0: 2020 2073 656c 662e 6461 736b 203d 2072     self.dask = r
+000212b0: 656e 616d 6564 2e64 6173 6b0a 2020 2020  enamed.dask.    
+000212c0: 2020 2020 7365 6c66 2e5f 6e61 6d65 203d      self._name =
+000212d0: 2072 656e 616d 6564 2e5f 6e61 6d65 0a0a   renamed._name..
+000212e0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+000212f0: 2020 6465 6620 6e64 696d 2873 656c 6629    def ndim(self)
+00021300: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+00021310: 7572 6e20 6469 6d65 6e73 696f 6e61 6c69  urn dimensionali
+00021320: 7479 2222 220a 2020 2020 2020 2020 7265  ty""".        re
+00021330: 7475 726e 2031 0a0a 2020 2020 4070 726f  turn 1..    @pro
+00021340: 7065 7274 790a 2020 2020 6465 6620 7368  perty.    def sh
+00021350: 6170 6528 7365 6c66 293a 0a20 2020 2020  ape(self):.     
+00021360: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+00021370: 6574 7572 6e20 6120 7475 706c 6520 7265  eturn a tuple re
+00021380: 7072 6573 656e 7469 6e67 2074 6865 2064  presenting the d
+00021390: 696d 656e 7369 6f6e 616c 6974 7920 6f66  imensionality of
+000213a0: 2061 2053 6572 6965 732e 0a0a 2020 2020   a Series...    
+000213b0: 2020 2020 5468 6520 7369 6e67 6c65 2065      The single e
+000213c0: 6c65 6d65 6e74 206f 6620 7468 6520 7475  lement of the tu
+000213d0: 706c 6520 6973 2061 2044 656c 6179 6564  ple is a Delayed
+000213e0: 2072 6573 756c 742e 0a0a 2020 2020 2020   result...      
+000213f0: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
+00021400: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00021410: 2020 2020 3e3e 3e20 7365 7269 6573 2e73      >>> series.s
+00021420: 6861 7065 2020 2320 646f 6374 6573 743a  hape  # doctest:
+00021430: 202b 534b 4950 0a20 2020 2020 2020 2028   +SKIP.        (
+00021440: 6464 2e53 6361 6c61 723c 7369 7a65 2d61  dd.Scalar<size-a
+00021450: 672e 2e2e 2c20 6474 7970 653d 696e 7436  g..., dtype=int6
+00021460: 343e 2c29 0a20 2020 2020 2020 2022 2222  4>,).        """
+00021470: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00021480: 2873 656c 662e 7369 7a65 2c29 0a0a 2020  (self.size,)..  
+00021490: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000214a0: 6465 6620 6474 7970 6528 7365 6c66 293a  def dtype(self):
+000214b0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+000214c0: 726e 2064 6174 6120 7479 7065 2222 220a  rn data type""".
+000214d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000214e0: 656c 662e 5f6d 6574 612e 6474 7970 650a  elf._meta.dtype.
+000214f0: 0a20 2020 2064 7420 3d20 4361 6368 6564  .    dt = Cached
+00021500: 4163 6365 7373 6f72 2822 6474 222c 2044  Accessor("dt", D
+00021510: 6174 6574 696d 6541 6363 6573 736f 7229  atetimeAccessor)
+00021520: 0a0a 2020 2020 6361 7420 3d20 4361 6368  ..    cat = Cach
+00021530: 6564 4163 6365 7373 6f72 2822 6361 7422  edAccessor("cat"
+00021540: 2c20 4361 7465 676f 7269 6361 6c41 6363  , CategoricalAcc
+00021550: 6573 736f 7229 0a0a 2020 2020 7374 7220  essor)..    str 
+00021560: 3d20 4361 6368 6564 4163 6365 7373 6f72  = CachedAccessor
+00021570: 2822 7374 7222 2c20 5374 7269 6e67 4163  ("str", StringAc
+00021580: 6365 7373 6f72 290a 0a20 2020 2064 6566  cessor)..    def
+00021590: 205f 5f64 6972 5f5f 2873 656c 6629 3a0a   __dir__(self):.
+000215a0: 2020 2020 2020 2020 6f20 3d20 7365 7428          o = set(
+000215b0: 6469 7228 7479 7065 2873 656c 6629 2929  dir(type(self)))
+000215c0: 0a20 2020 2020 2020 206f 2e75 7064 6174  .        o.updat
+000215d0: 6528 7365 6c66 2e5f 5f64 6963 745f 5f29  e(self.__dict__)
+000215e0: 0a20 2020 2020 2020 2023 2052 656d 6f76  .        # Remov
+000215f0: 6520 7468 6520 6063 6174 6020 616e 6420  e the `cat` and 
+00021600: 6073 7472 6020 6163 6365 7373 6f72 7320  `str` accessors 
+00021610: 6966 206e 6f74 2061 7661 696c 6162 6c65  if not available
+00021620: 2e20 5765 2063 616e 2774 0a20 2020 2020  . We can't.     
+00021630: 2020 2023 2064 6563 6964 6520 7468 6973     # decide this
+00021640: 2073 7461 7469 6361 6c6c 7920 666f 7220   statically for 
+00021650: 7468 6520 6064 7460 2061 6363 6573 736f  the `dt` accesso
+00021660: 722c 2061 7320 6974 2077 6f72 6b73 206f  r, as it works o
+00021670: 6e0a 2020 2020 2020 2020 2320 6461 7465  n.        # date
+00021680: 7469 6d65 2d6c 696b 6520 7468 696e 6773  time-like things
+00021690: 2061 7320 7765 6c6c 2e0a 2020 2020 2020   as well..      
+000216a0: 2020 666f 7220 6163 6365 7373 6f72 2069    for accessor i
+000216b0: 6e20 5b22 6361 7422 2c20 2273 7472 225d  n ["cat", "str"]
+000216c0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000216d0: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
+000216e0: 662e 5f6d 6574 612c 2061 6363 6573 736f  f._meta, accesso
+000216f0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00021700: 2020 2020 6f2e 7265 6d6f 7665 2861 6363      o.remove(acc
+00021710: 6573 736f 7229 0a20 2020 2020 2020 2072  essor).        r
+00021720: 6574 7572 6e20 6c69 7374 286f 290a 0a20  eturn list(o).. 
+00021730: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00021740: 2064 6566 206e 6279 7465 7328 7365 6c66   def nbytes(self
+00021750: 293a 0a20 2020 2020 2020 2022 2222 4e75  ):.        """Nu
+00021760: 6d62 6572 206f 6620 6279 7465 7322 2222  mber of bytes"""
+00021770: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00021780: 7365 6c66 2e72 6564 7563 7469 6f6e 280a  self.reduction(.
+00021790: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
+000217a0: 6f64 732e 6e62 7974 6573 2c20 6e70 2e73  ods.nbytes, np.s
+000217b0: 756d 2c20 746f 6b65 6e3d 226e 6279 7465  um, token="nbyte
+000217c0: 7322 2c20 6d65 7461 3d69 6e74 2c20 7370  s", meta=int, sp
+000217d0: 6c69 745f 6576 6572 793d 4661 6c73 650a  lit_every=False.
+000217e0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+000217f0: 6566 205f 7265 7072 5f64 6174 6128 7365  ef _repr_data(se
+00021800: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00021810: 7572 6e20 5f72 6570 725f 6461 7461 5f73  urn _repr_data_s
+00021820: 6572 6965 7328 7365 6c66 2e5f 6d65 7461  eries(self._meta
+00021830: 2c20 7365 6c66 2e5f 7265 7072 5f64 6976  , self._repr_div
+00021840: 6973 696f 6e73 290a 0a20 2020 2064 6566  isions)..    def
+00021850: 205f 5f72 6570 725f 5f28 7365 6c66 293a   __repr__(self):
+00021860: 0a20 2020 2020 2020 2022 2222 6861 7665  .        """have
+00021870: 2074 6f20 6f76 6572 7772 6974 6520 666f   to overwrite fo
+00021880: 6f74 6572 2222 220a 2020 2020 2020 2020  oter""".        
+00021890: 6966 2073 656c 662e 6e61 6d65 2069 7320  if self.name is 
+000218a0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+000218b0: 2020 2020 2020 666f 6f74 6572 203d 2066        footer = f
+000218c0: 224e 616d 653a 207b 7365 6c66 2e6e 616d  "Name: {self.nam
+000218d0: 657d 2c20 6474 7970 653a 207b 7365 6c66  e}, dtype: {self
+000218e0: 2e64 7479 7065 7d22 0a20 2020 2020 2020  .dtype}".       
+000218f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00021900: 2020 2066 6f6f 7465 7220 3d20 6622 6474     footer = f"dt
+00021910: 7970 653a 207b 7365 6c66 2e64 7479 7065  ype: {self.dtype
+00021920: 7d22 0a0a 2020 2020 2020 2020 7265 7475  }"..        retu
+00021930: 726e 2022 2222 4461 736b 207b 6b6c 6173  rn """Dask {klas
+00021940: 737d 2053 7472 7563 7475 7265 3a0a 7b64  s} Structure:.{d
+00021950: 6174 617d 0a7b 666f 6f74 6572 7d0a 4461  ata}.{footer}.Da
+00021960: 736b 204e 616d 653a 207b 6e61 6d65 7d2c  sk Name: {name},
+00021970: 207b 6c61 7965 7273 7d22 2222 2e66 6f72   {layers}""".for
+00021980: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
+00021990: 206b 6c61 7373 3d73 656c 662e 5f5f 636c   klass=self.__cl
+000219a0: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2c0a  ass__.__name__,.
+000219b0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000219c0: 3d73 656c 662e 746f 5f73 7472 696e 6728  =self.to_string(
+000219d0: 292c 0a20 2020 2020 2020 2020 2020 2066  ),.            f
+000219e0: 6f6f 7465 723d 666f 6f74 6572 2c0a 2020  ooter=footer,.  
+000219f0: 2020 2020 2020 2020 2020 6e61 6d65 3d6b            name=k
+00021a00: 6579 5f73 706c 6974 2873 656c 662e 5f6e  ey_split(self._n
+00021a10: 616d 6529 2c0a 2020 2020 2020 2020 2020  ame),.          
+00021a20: 2020 6c61 7965 7273 3d6d 6179 6265 5f70    layers=maybe_p
+00021a30: 6c75 7261 6c69 7a65 286c 656e 2873 656c  luralize(len(sel
+00021a40: 662e 6461 736b 2e6c 6179 6572 7329 2c20  f.dask.layers), 
+00021a50: 2267 7261 7068 206c 6179 6572 2229 2c0a  "graph layer"),.
+00021a60: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00021a70: 6566 2072 656e 616d 6528 7365 6c66 2c20  ef rename(self, 
+00021a80: 696e 6465 783d 4e6f 6e65 2c20 696e 706c  index=None, inpl
+00021a90: 6163 653d 4661 6c73 652c 2073 6f72 7465  ace=False, sorte
+00021aa0: 645f 696e 6465 783d 4661 6c73 6529 3a0a  d_index=False):.
+00021ab0: 2020 2020 2020 2020 2222 2241 6c74 6572          """Alter
+00021ac0: 2053 6572 6965 7320 696e 6465 7820 6c61   Series index la
+00021ad0: 6265 6c73 206f 7220 6e61 6d65 0a0a 2020  bels or name..  
+00021ae0: 2020 2020 2020 4675 6e63 7469 6f6e 202f        Function /
+00021af0: 2064 6963 7420 7661 6c75 6573 206d 7573   dict values mus
+00021b00: 7420 6265 2075 6e69 7175 6520 2831 2d74  t be unique (1-t
+00021b10: 6f2d 3129 2e20 4c61 6265 6c73 206e 6f74  o-1). Labels not
+00021b20: 2063 6f6e 7461 696e 6564 2069 6e0a 2020   contained in.  
+00021b30: 2020 2020 2020 6120 6469 6374 202f 2053        a dict / S
+00021b40: 6572 6965 7320 7769 6c6c 2062 6520 6c65  eries will be le
+00021b50: 6674 2061 732d 6973 2e20 4578 7472 6120  ft as-is. Extra 
+00021b60: 6c61 6265 6c73 206c 6973 7465 6420 646f  labels listed do
+00021b70: 6e27 7420 7468 726f 7720 616e 0a20 2020  n't throw an.   
+00021b80: 2020 2020 2065 7272 6f72 2e0a 0a20 2020       error...   
+00021b90: 2020 2020 2041 6c74 6572 6e61 7469 7665       Alternative
+00021ba0: 6c79 2c20 6368 616e 6765 2060 6053 6572  ly, change ``Ser
+00021bb0: 6965 732e 6e61 6d65 6060 2077 6974 6820  ies.name`` with 
+00021bc0: 6120 7363 616c 6172 2076 616c 7565 2e0a  a scalar value..
+00021bd0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00021be0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00021bf0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2069  ------.        i
+00021c00: 6e64 6578 203a 2073 6361 6c61 722c 2068  ndex : scalar, h
+00021c10: 6173 6861 626c 6520 7365 7175 656e 6365  ashable sequence
+00021c20: 2c20 6469 6374 2d6c 696b 6520 6f72 2063  , dict-like or c
+00021c30: 616c 6c61 626c 652c 206f 7074 696f 6e61  allable, optiona
+00021c40: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
+00021c50: 2064 6963 742d 6c69 6b65 206f 7220 6361   dict-like or ca
+00021c60: 6c6c 6162 6c65 2c20 7468 6520 7472 616e  llable, the tran
+00021c70: 7366 6f72 6d61 7469 6f6e 2069 7320 6170  sformation is ap
+00021c80: 706c 6965 6420 746f 2074 6865 0a20 2020  plied to the.   
+00021c90: 2020 2020 2020 2020 2069 6e64 6578 2e20           index. 
+00021ca0: 5363 616c 6172 206f 7220 6861 7368 6162  Scalar or hashab
+00021cb0: 6c65 2073 6571 7565 6e63 652d 6c69 6b65  le sequence-like
+00021cc0: 2077 696c 6c20 616c 7465 7220 7468 650a   will alter the.
+00021cd0: 2020 2020 2020 2020 2020 2020 6060 5365              ``Se
+00021ce0: 7269 6573 2e6e 616d 6560 6020 6174 7472  ries.name`` attr
+00021cf0: 6962 7574 652e 0a20 2020 2020 2020 2069  ibute..        i
+00021d00: 6e70 6c61 6365 203a 2062 6f6f 6c65 616e  nplace : boolean
+00021d10: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
+00021d20: 2020 2020 2020 2020 2020 2020 5768 6574              Whet
+00021d30: 6865 7220 746f 2072 6574 7572 6e20 6120  her to return a 
+00021d40: 6e65 7720 5365 7269 6573 206f 7220 6d6f  new Series or mo
+00021d50: 6469 6679 2074 6869 7320 6f6e 6520 696e  dify this one in
+00021d60: 706c 6163 652e 0a20 2020 2020 2020 2073  place..        s
+00021d70: 6f72 7465 645f 696e 6465 7820 3a20 626f  orted_index : bo
+00021d80: 6f6c 2c20 6465 6661 756c 7420 4661 6c73  ol, default Fals
+00021d90: 650a 2020 2020 2020 2020 2020 2020 4966  e.            If
+00021da0: 2074 7275 652c 2074 6865 206f 7574 7075   true, the outpu
+00021db0: 7420 6060 5365 7269 6573 6060 2077 696c  t ``Series`` wil
+00021dc0: 6c20 6861 7665 206b 6e6f 776e 2064 6976  l have known div
+00021dd0: 6973 696f 6e73 2069 6e66 6572 7265 640a  isions inferred.
+00021de0: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+00021df0: 2074 6865 2069 6e70 7574 2073 6572 6965   the input serie
+00021e00: 7320 616e 6420 7468 6520 7472 616e 7366  s and the transf
+00021e10: 6f72 6d61 7469 6f6e 2e20 4967 6e6f 7265  ormation. Ignore
+00021e20: 6420 666f 720a 2020 2020 2020 2020 2020  d for.          
+00021e30: 2020 6e6f 6e2d 6361 6c6c 6162 6c65 2f64    non-callable/d
+00021e40: 6963 742d 6c69 6b65 2060 6069 6e64 6578  ict-like ``index
+00021e50: 6060 206f 7220 7768 656e 2074 6865 2069  `` or when the i
+00021e60: 6e70 7574 2073 6572 6965 7320 6861 730a  nput series has.
+00021e70: 2020 2020 2020 2020 2020 2020 756e 6b6e              unkn
+00021e80: 6f77 6e20 6469 7669 7369 6f6e 732e 204e  own divisions. N
+00021e90: 6f74 6520 7468 6174 2074 6869 7320 6d61  ote that this ma
+00021ea0: 7920 6f6e 6c79 2062 6520 7365 7420 746f  y only be set to
+00021eb0: 2060 6054 7275 6560 6020 6966 0a20 2020   ``True`` if.   
+00021ec0: 2020 2020 2020 2020 2079 6f75 206b 6e6f           you kno
+00021ed0: 7720 7468 6174 2074 6865 2074 7261 6e73  w that the trans
+00021ee0: 666f 726d 6564 2069 6e64 6578 2069 7320  formed index is 
+00021ef0: 6d6f 6e6f 746f 6e69 6361 6c6c 7920 696e  monotonically in
+00021f00: 6372 6561 7369 6e67 2e20 4461 736b 0a20  creasing. Dask. 
+00021f10: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
+00021f20: 6368 6563 6b20 7468 6174 2074 7261 6e73  check that trans
+00021f30: 666f 726d 6564 2064 6976 6973 696f 6e73  formed divisions
+00021f40: 2061 7265 206d 6f6e 6f74 6f6e 6963 2c20   are monotonic, 
+00021f50: 6275 7420 6361 6e6e 6f74 0a20 2020 2020  but cannot.     
+00021f60: 2020 2020 2020 2063 6865 636b 2061 6c6c         check all
+00021f70: 2074 6865 2076 616c 7565 7320 6265 7477   the values betw
+00021f80: 6565 6e20 6469 7669 7369 6f6e 732c 2073  een divisions, s
+00021f90: 6f20 696e 636f 7272 6563 746c 7920 7365  o incorrectly se
+00021fa0: 7474 696e 6720 7468 6973 0a20 2020 2020  tting this.     
+00021fb0: 2020 2020 2020 2063 616e 2072 6573 756c         can resul
+00021fc0: 7420 696e 2062 7567 732e 0a0a 2020 2020  t in bugs...    
+00021fd0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00021fe0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00021ff0: 2020 2020 7265 6e61 6d65 6420 3a20 5365      renamed : Se
+00022000: 7269 6573 0a0a 2020 2020 2020 2020 5365  ries..        Se
+00022010: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+00022020: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00022030: 7061 6e64 6173 2e53 6572 6965 732e 7265  pandas.Series.re
+00022040: 6e61 6d65 0a20 2020 2020 2020 2022 2222  name.        """
+00022050: 0a20 2020 2020 2020 2066 726f 6d20 7061  .        from pa
+00022060: 6e64 6173 2e61 7069 2e74 7970 6573 2069  ndas.api.types i
+00022070: 6d70 6f72 7420 6973 5f64 6963 745f 6c69  mport is_dict_li
+00022080: 6b65 2c20 6973 5f6c 6973 745f 6c69 6b65  ke, is_list_like
+00022090: 2c20 6973 5f73 6361 6c61 720a 0a20 2020  , is_scalar..   
+000220a0: 2020 2020 2069 6d70 6f72 7420 6461 736b       import dask
+000220b0: 2e64 6174 6166 7261 6d65 2061 7320 6464  .dataframe as dd
+000220c0: 0a0a 2020 2020 2020 2020 6966 2069 735f  ..        if is_
+000220d0: 7363 616c 6172 2869 6e64 6578 2920 6f72  scalar(index) or
+000220e0: 2028 0a20 2020 2020 2020 2020 2020 2069   (.            i
+000220f0: 735f 6c69 7374 5f6c 696b 6528 696e 6465  s_list_like(inde
+00022100: 7829 0a20 2020 2020 2020 2020 2020 2061  x).            a
+00022110: 6e64 206e 6f74 2069 735f 6469 6374 5f6c  nd not is_dict_l
+00022120: 696b 6528 696e 6465 7829 0a20 2020 2020  ike(index).     
+00022130: 2020 2020 2020 2061 6e64 206e 6f74 2069         and not i
+00022140: 7369 6e73 7461 6e63 6528 696e 6465 782c  sinstance(index,
+00022150: 2064 642e 5365 7269 6573 290a 2020 2020   dd.Series).    
+00022160: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+00022170: 2020 2069 6620 696e 706c 6163 653a 0a20     if inplace:. 
+00022180: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00022190: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+000221a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000221b0: 2020 2227 696e 706c 6163 6527 2061 7267    "'inplace' arg
+000221c0: 756d 656e 7420 666f 7220 6461 736b 2073  ument for dask s
+000221d0: 6572 6965 7320 7769 6c6c 2062 6520 7265  eries will be re
+000221e0: 6d6f 7665 6420 696e 2066 7574 7572 6520  moved in future 
+000221f0: 7665 7273 696f 6e73 222c 0a20 2020 2020  versions",.     
+00022200: 2020 2020 2020 2020 2020 2020 2020 2050                 P
+00022210: 656e 6469 6e67 4465 7072 6563 6174 696f  endingDeprecatio
+00022220: 6e57 6172 6e69 6e67 2c0a 2020 2020 2020  nWarning,.      
+00022230: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00022240: 2020 2020 2020 2020 7265 7320 3d20 7365          res = se
+00022250: 6c66 2069 6620 696e 706c 6163 6520 656c  lf if inplace el
+00022260: 7365 2073 656c 662e 636f 7079 2829 0a20  se self.copy(). 
+00022270: 2020 2020 2020 2020 2020 2072 6573 2e6e             res.n
+00022280: 616d 6520 3d20 696e 6465 780a 2020 2020  ame = index.    
+00022290: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000222a0: 2020 2020 2020 7265 7320 3d20 7365 6c66        res = self
+000222b0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+000222c0: 4d2e 7265 6e61 6d65 2c20 696e 6465 782c  M.rename, index,
+000222d0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+000222e0: 613d 4661 6c73 6529 0a20 2020 2020 2020  a=False).       
+000222f0: 2020 2020 2069 6620 7365 6c66 2e6b 6e6f       if self.kno
+00022300: 776e 5f64 6976 6973 696f 6e73 3a0a 2020  wn_divisions:.  
+00022310: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00022320: 2073 6f72 7465 645f 696e 6465 7820 616e   sorted_index an
+00022330: 6420 2863 616c 6c61 626c 6528 696e 6465  d (callable(inde
+00022340: 7829 206f 7220 6973 5f64 6963 745f 6c69  x) or is_dict_li
+00022350: 6b65 2869 6e64 6578 2929 3a0a 2020 2020  ke(index)):.    
+00022360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022370: 6f6c 6420 3d20 7064 2e53 6572 6965 7328  old = pd.Series(
+00022380: 7261 6e67 6528 7365 6c66 2e6e 7061 7274  range(self.npart
+00022390: 6974 696f 6e73 202b 2031 292c 2069 6e64  itions + 1), ind
+000223a0: 6578 3d73 656c 662e 6469 7669 7369 6f6e  ex=self.division
+000223b0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+000223c0: 2020 2020 2020 206e 6577 203d 206f 6c64         new = old
+000223d0: 2e72 656e 616d 6528 696e 6465 7829 2e69  .rename(index).i
+000223e0: 6e64 6578 0a20 2020 2020 2020 2020 2020  ndex.           
+000223f0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00022400: 6e65 772e 6973 5f6d 6f6e 6f74 6f6e 6963  new.is_monotonic
+00022410: 5f69 6e63 7265 6173 696e 673a 0a20 2020  _increasing:.   
+00022420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022430: 2020 2020 206d 7367 203d 2028 0a20 2020       msg = (.   
+00022440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022450: 2020 2020 2020 2020 2022 736f 7274 6564           "sorted
+00022460: 5f69 6e64 6578 3d54 7275 652c 2062 7574  _index=True, but
+00022470: 2074 6865 2074 7261 6e73 666f 726d 6564   the transformed
+00022480: 2069 6e64 6578 2022 0a20 2020 2020 2020   index ".       
+00022490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000224a0: 2020 2020 2022 6973 6e27 7420 6d6f 6e6f       "isn't mono
+000224b0: 746f 6e69 635f 696e 6372 6561 7369 6e67  tonic_increasing
+000224c0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000224d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000224e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000224f0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00022500: 7272 6f72 286d 7367 290a 2020 2020 2020  rror(msg).      
+00022510: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00022520: 732e 5f64 6976 6973 696f 6e73 203d 2074  s._divisions = t
+00022530: 7570 6c65 286d 6574 686f 6473 2e74 6f6c  uple(methods.tol
+00022540: 6973 7428 6e65 7729 290a 2020 2020 2020  ist(new)).      
+00022550: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00022560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022570: 2020 2020 7265 7320 3d20 7265 732e 636c      res = res.cl
+00022580: 6561 725f 6469 7669 7369 6f6e 7328 290a  ear_divisions().
+00022590: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+000225a0: 6e70 6c61 6365 3a0a 2020 2020 2020 2020  nplace:.        
+000225b0: 2020 2020 2020 2020 7365 6c66 2e64 6173          self.das
+000225c0: 6b20 3d20 7265 732e 6461 736b 0a20 2020  k = res.dask.   
+000225d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000225e0: 662e 5f6e 616d 6520 3d20 7265 732e 5f6e  f._name = res._n
+000225f0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
+00022600: 2020 2020 7365 6c66 2e5f 6469 7669 7369      self._divisi
+00022610: 6f6e 7320 3d20 7265 732e 6469 7669 7369  ons = res.divisi
+00022620: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
+00022630: 2020 2020 7365 6c66 2e5f 6d65 7461 203d      self._meta =
+00022640: 2072 6573 2e5f 6d65 7461 0a20 2020 2020   res._meta.     
+00022650: 2020 2020 2020 2020 2020 2072 6573 203d             res =
+00022660: 2073 656c 660a 2020 2020 2020 2020 7265   self.        re
+00022670: 7475 726e 2072 6573 0a0a 2020 2020 4064  turn res..    @d
+00022680: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+00022690: 6572 6965 7329 0a20 2020 2064 6566 2072  eries).    def r
+000226a0: 6f75 6e64 2873 656c 662c 2064 6563 696d  ound(self, decim
+000226b0: 616c 733d 3029 3a0a 2020 2020 2020 2020  als=0):.        
+000226c0: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
+000226d0: 4d2e 726f 756e 642c 2073 656c 662c 2064  M.round, self, d
+000226e0: 6563 696d 616c 7329 0a0a 2020 2020 4064  ecimals)..    @d
+000226f0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00022700: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00022710: 6620 746f 5f74 696d 6573 7461 6d70 2873  f to_timestamp(s
+00022720: 656c 662c 2066 7265 713d 4e6f 6e65 2c20  elf, freq=None, 
+00022730: 686f 773d 2273 7461 7274 222c 2061 7869  how="start", axi
+00022740: 733d 3029 3a0a 2020 2020 2020 2020 6466  s=0):.        df
+00022750: 203d 2065 6c65 6d77 6973 6528 4d2e 746f   = elemwise(M.to
+00022760: 5f74 696d 6573 7461 6d70 2c20 7365 6c66  _timestamp, self
+00022770: 2c20 6672 6571 2c20 686f 772c 2061 7869  , freq, how, axi
+00022780: 7329 0a20 2020 2020 2020 2064 662e 6469  s).        df.di
+00022790: 7669 7369 6f6e 7320 3d20 7475 706c 6528  visions = tuple(
+000227a0: 7064 2e49 6e64 6578 2873 656c 662e 6469  pd.Index(self.di
+000227b0: 7669 7369 6f6e 7329 2e74 6f5f 7469 6d65  visions).to_time
+000227c0: 7374 616d 7028 2929 0a20 2020 2020 2020  stamp()).       
+000227d0: 2072 6574 7572 6e20 6466 0a0a 2020 2020   return df..    
+000227e0: 6465 6620 7175 616e 7469 6c65 2873 656c  def quantile(sel
+000227f0: 662c 2071 3d30 2e35 2c20 6d65 7468 6f64  f, q=0.5, method
+00022800: 3d22 6465 6661 756c 7422 293a 0a20 2020  ="default"):.   
+00022810: 2020 2020 2022 2222 4170 7072 6f78 696d       """Approxim
+00022820: 6174 6520 7175 616e 7469 6c65 7320 6f66  ate quantiles of
+00022830: 2053 6572 6965 730a 0a20 2020 2020 2020   Series..       
+00022840: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00022850: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00022860: 2020 2020 2020 2071 203a 206c 6973 742f         q : list/
+00022870: 6172 7261 7920 6f66 2066 6c6f 6174 732c  array of floats,
+00022880: 2064 6566 6175 6c74 2030 2e35 2028 3530   default 0.5 (50
+00022890: 2529 0a20 2020 2020 2020 2020 2020 2049  %).            I
+000228a0: 7465 7261 626c 6520 6f66 206e 756d 6265  terable of numbe
+000228b0: 7273 2072 616e 6769 6e67 2066 726f 6d20  rs ranging from 
+000228c0: 3020 746f 2031 2066 6f72 2074 6865 2064  0 to 1 for the d
+000228d0: 6573 6972 6564 2071 7561 6e74 696c 6573  esired quantiles
+000228e0: 0a20 2020 2020 2020 206d 6574 686f 6420  .        method 
+000228f0: 3a20 7b27 6465 6661 756c 7427 2c20 2774  : {'default', 't
+00022900: 6469 6765 7374 272c 2027 6461 736b 277d  digest', 'dask'}
+00022910: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00022920: 2020 2020 2020 2057 6861 7420 6d65 7468         What meth
+00022930: 6f64 2074 6f20 7573 652e 2042 7920 6465  od to use. By de
+00022940: 6661 756c 7420 7769 6c6c 2075 7365 2064  fault will use d
+00022950: 6173 6b27 7320 696e 7465 726e 616c 2063  ask's internal c
+00022960: 7573 746f 6d0a 2020 2020 2020 2020 2020  ustom.          
+00022970: 2020 616c 676f 7269 7468 6d20 2860 6027    algorithm (``'
+00022980: 6461 736b 2760 6029 2e20 2049 6620 7365  dask'``).  If se
+00022990: 7420 746f 2060 6027 7464 6967 6573 7427  t to ``'tdigest'
+000229a0: 6060 2077 696c 6c20 7573 6520 7464 6967  `` will use tdig
+000229b0: 6573 740a 2020 2020 2020 2020 2020 2020  est.            
+000229c0: 666f 7220 666c 6f61 7473 2061 6e64 2069  for floats and i
+000229d0: 6e74 7320 616e 6420 6661 6c6c 6261 636b  nts and fallback
+000229e0: 2074 6f20 7468 6520 6060 2764 6173 6b27   to the ``'dask'
+000229f0: 6060 206f 7468 6572 7769 7365 2e0a 2020  `` otherwise..  
+00022a00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00022a10: 2020 7265 7475 726e 2071 7561 6e74 696c    return quantil
+00022a20: 6528 7365 6c66 2c20 712c 206d 6574 686f  e(self, q, metho
+00022a30: 643d 6d65 7468 6f64 290a 0a20 2020 2064  d=method)..    d
+00022a40: 6566 206d 6564 6961 6e5f 6170 7072 6f78  ef median_approx
+00022a50: 696d 6174 6528 7365 6c66 2c20 6d65 7468  imate(self, meth
+00022a60: 6f64 3d22 6465 6661 756c 7422 293a 0a20  od="default"):. 
+00022a70: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+00022a80: 2074 6865 2061 7070 726f 7869 6d61 7465   the approximate
+00022a90: 206d 6564 6961 6e20 6f66 2074 6865 2076   median of the v
+00022aa0: 616c 7565 7320 6f76 6572 2074 6865 2072  alues over the r
+00022ab0: 6571 7565 7374 6564 2061 7869 732e 0a0a  equested axis...
+00022ac0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00022ad0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00022ae0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6d65  -----.        me
+00022af0: 7468 6f64 203a 207b 2764 6566 6175 6c74  thod : {'default
+00022b00: 272c 2027 7464 6967 6573 7427 2c20 2764  ', 'tdigest', 'd
+00022b10: 6173 6b27 7d2c 206f 7074 696f 6e61 6c0a  ask'}, optional.
+00022b20: 2020 2020 2020 2020 2020 2020 5768 6174              What
+00022b30: 206d 6574 686f 6420 746f 2075 7365 2e20   method to use. 
+00022b40: 4279 2064 6566 6175 6c74 2077 696c 6c20  By default will 
+00022b50: 7573 6520 4461 736b 2773 2069 6e74 6572  use Dask's inter
+00022b60: 6e61 6c20 6375 7374 6f6d 0a20 2020 2020  nal custom.     
+00022b70: 2020 2020 2020 2061 6c67 6f72 6974 686d         algorithm
+00022b80: 2028 6060 2264 6173 6b22 6060 292e 2020   (``"dask"``).  
+00022b90: 4966 2073 6574 2074 6f20 6060 2274 6469  If set to ``"tdi
+00022ba0: 6765 7374 2260 6020 7769 6c6c 2075 7365  gest"`` will use
+00022bb0: 2074 6469 6765 7374 0a20 2020 2020 2020   tdigest.       
+00022bc0: 2020 2020 2066 6f72 2066 6c6f 6174 7320       for floats 
+00022bd0: 616e 6420 696e 7473 2061 6e64 2066 616c  and ints and fal
+00022be0: 6c62 6163 6b20 746f 2074 6865 2060 6022  lback to the ``"
+00022bf0: 6461 736b 2260 6020 6f74 6865 7277 6973  dask"`` otherwis
+00022c00: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+00022c10: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00022c20: 6c66 2e71 7561 6e74 696c 6528 713d 302e  lf.quantile(q=0.
+00022c30: 352c 206d 6574 686f 643d 6d65 7468 6f64  5, method=method
+00022c40: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00022c50: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+00022c60: 2020 2020 6465 6620 6d65 6469 616e 2873      def median(s
+00022c70: 656c 662c 206d 6574 686f 643d 2264 6566  elf, method="def
+00022c80: 6175 6c74 2229 3a0a 2020 2020 2020 2020  ault"):.        
+00022c90: 6966 2073 656c 662e 6e70 6172 7469 7469  if self.npartiti
+00022ca0: 6f6e 7320 3d3d 2031 3a0a 2020 2020 2020  ons == 1:.      
+00022cb0: 2020 2020 2020 2320 4361 6e20 7072 6f76        # Can prov
+00022cc0: 6964 6520 616e 2065 7861 6374 206d 6564  ide an exact med
+00022cd0: 6961 6e20 696e 2074 6865 7365 2063 6173  ian in these cas
+00022ce0: 6573 0a20 2020 2020 2020 2020 2020 2072  es.            r
+00022cf0: 6574 7572 6e20 7365 6c66 2e6d 6564 6961  eturn self.media
+00022d00: 6e5f 6170 7072 6f78 696d 6174 6528 6d65  n_approximate(me
+00022d10: 7468 6f64 3d6d 6574 686f 6429 0a20 2020  thod=method).   
+00022d20: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00022d30: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
+00022d40: 2020 2020 2020 2020 2020 2020 2244 6173              "Das
+00022d50: 6b20 646f 6573 6e27 7420 696d 706c 656d  k doesn't implem
+00022d60: 656e 7420 616e 2065 7861 6374 206d 6564  ent an exact med
+00022d70: 6961 6e20 696e 2061 6c6c 2063 6173 6573  ian in all cases
+00022d80: 2061 7320 7468 6973 2069 7320 6861 7264   as this is hard
+00022d90: 2074 6f20 646f 2069 6e20 7061 7261 6c6c   to do in parall
+00022da0: 656c 2e20 220a 2020 2020 2020 2020 2020  el. ".          
+00022db0: 2020 2253 6565 2074 6865 2060 6d65 6469    "See the `medi
+00022dc0: 616e 5f61 7070 726f 7869 6d61 7465 6020  an_approximate` 
+00022dd0: 6d65 7468 6f64 2069 6e73 7465 6164 2c20  method instead, 
+00022de0: 7768 6963 6820 7573 6573 2061 6e20 6170  which uses an ap
+00022df0: 7072 6f78 696d 6174 6520 616c 676f 7269  proximate algori
+00022e00: 7468 6d2e 220a 2020 2020 2020 2020 290a  thm.".        ).
+00022e10: 0a20 2020 2064 6566 205f 7265 7061 7274  .    def _repart
+00022e20: 6974 696f 6e5f 7175 616e 7469 6c65 7328  ition_quantiles(
+00022e30: 7365 6c66 2c20 6e70 6172 7469 7469 6f6e  self, npartition
+00022e40: 732c 2075 7073 616d 706c 653d 312e 3029  s, upsample=1.0)
+00022e50: 3a0a 2020 2020 2020 2020 2222 2241 7070  :.        """App
+00022e60: 726f 7869 6d61 7465 2071 7561 6e74 696c  roximate quantil
+00022e70: 6573 206f 6620 5365 7269 6573 2075 7365  es of Series use
+00022e80: 6420 666f 7220 7265 7061 7274 6974 696f  d for repartitio
+00022e90: 6e69 6e67 2222 220a 2020 2020 2020 2020  ning""".        
+00022ea0: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
+00022eb0: 616d 652e 7061 7274 6974 696f 6e71 7561  ame.partitionqua
+00022ec0: 6e74 696c 6573 2069 6d70 6f72 7420 7061  ntiles import pa
+00022ed0: 7274 6974 696f 6e5f 7175 616e 7469 6c65  rtition_quantile
+00022ee0: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
+00022ef0: 6e20 7061 7274 6974 696f 6e5f 7175 616e  n partition_quan
+00022f00: 7469 6c65 7328 7365 6c66 2c20 6e70 6172  tiles(self, npar
+00022f10: 7469 7469 6f6e 732c 2075 7073 616d 706c  titions, upsampl
+00022f20: 653d 7570 7361 6d70 6c65 290a 0a20 2020  e=upsample)..   
+00022f30: 2064 6566 205f 5f67 6574 6974 656d 5f5f   def __getitem__
+00022f40: 2873 656c 662c 206b 6579 293a 0a20 2020  (self, key):.   
+00022f50: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00022f60: 6365 286b 6579 2c20 5365 7269 6573 2920  ce(key, Series) 
+00022f70: 616e 6420 7365 6c66 2e64 6976 6973 696f  and self.divisio
+00022f80: 6e73 203d 3d20 6b65 792e 6469 7669 7369  ns == key.divisi
+00022f90: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
+00022fa0: 206e 616d 6520 3d20 2269 6e64 6578 2d25   name = "index-%
+00022fb0: 7322 2025 2074 6f6b 656e 697a 6528 7365  s" % tokenize(se
+00022fc0: 6c66 2c20 6b65 7929 0a20 2020 2020 2020  lf, key).       
+00022fd0: 2020 2020 2064 736b 203d 2070 6172 7469       dsk = parti
+00022fe0: 7469 6f6e 7769 7365 5f67 7261 7068 286f  tionwise_graph(o
+00022ff0: 7065 7261 746f 722e 6765 7469 7465 6d2c  perator.getitem,
+00023000: 206e 616d 652c 2073 656c 662c 206b 6579   name, self, key
+00023010: 290a 2020 2020 2020 2020 2020 2020 6772  ).            gr
+00023020: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+00023030: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+00023040: 7469 6f6e 7328 6e61 6d65 2c20 6473 6b2c  tions(name, dsk,
+00023050: 2064 6570 656e 6465 6e63 6965 733d 5b73   dependencies=[s
+00023060: 656c 662c 206b 6579 5d29 0a20 2020 2020  elf, key]).     
+00023070: 2020 2020 2020 2072 6574 7572 6e20 5365         return Se
+00023080: 7269 6573 2867 7261 7068 2c20 6e61 6d65  ries(graph, name
+00023090: 2c20 7365 6c66 2e5f 6d65 7461 2c20 7365  , self._meta, se
+000230a0: 6c66 2e64 6976 6973 696f 6e73 290a 2020  lf.divisions).  
+000230b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000230c0: 662e 6c6f 635b 6b65 795d 0a0a 2020 2020  f.loc[key]..    
+000230d0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+000230e0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+000230f0: 6465 6620 5f67 6574 5f6e 756d 6572 6963  def _get_numeric
+00023100: 5f64 6174 6128 7365 6c66 2c20 686f 773d  _data(self, how=
+00023110: 2261 6e79 222c 2073 7562 7365 743d 4e6f  "any", subset=No
+00023120: 6e65 293a 0a20 2020 2020 2020 2072 6574  ne):.        ret
+00023130: 7572 6e20 7365 6c66 0a0a 2020 2020 6966  urn self..    if
+00023140: 206e 6f74 2050 414e 4441 535f 4754 5f32   not PANDAS_GT_2
+00023150: 3030 3a0a 0a20 2020 2020 2020 2040 6465  00:..        @de
+00023160: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+00023170: 7269 6573 290a 2020 2020 2020 2020 6465  ries).        de
+00023180: 6620 6974 6572 6974 656d 7328 7365 6c66  f iteritems(self
+00023190: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+000231a0: 6620 5041 4e44 4153 5f47 545f 3135 303a  f PANDAS_GT_150:
+000231b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000231c0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
+000231d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000231e0: 2020 2020 2269 7465 7269 7465 6d73 2069      "iteritems i
+000231f0: 7320 6465 7072 6563 6174 6564 2061 6e64  s deprecated and
+00023200: 2077 696c 6c20 6265 2072 656d 6f76 6564   will be removed
+00023210: 2069 6e20 6120 6675 7475 7265 2076 6572   in a future ver
+00023220: 7369 6f6e 2e20 220a 2020 2020 2020 2020  sion. ".        
+00023230: 2020 2020 2020 2020 2020 2020 2255 7365              "Use
+00023240: 202e 6974 656d 7320 696e 7374 6561 642e   .items instead.
+00023250: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00023260: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
+00023270: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
+00023280: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00023290: 2020 2020 2320 5765 2075 7365 2074 6865      # We use the
+000232a0: 2060 5f60 2067 656e 6572 6174 6f72 2062   `_` generator b
+000232b0: 656c 6f77 2074 6f20 656e 7375 7265 2074  elow to ensure t
+000232c0: 6865 2064 6570 7265 6361 7469 6f6e 2077  he deprecation w
+000232d0: 6172 6e69 6e67 2061 626f 7665 0a20 2020  arning above.   
+000232e0: 2020 2020 2020 2020 2023 2069 7320 7261           # is ra
+000232f0: 6973 6564 2077 6865 6e20 602e 6974 6572  ised when `.iter
+00023300: 6974 656d 7328 2960 2069 7320 6361 6c6c  items()` is call
+00023310: 6564 2c20 6e6f 7420 7768 656e 2074 6865  ed, not when the
+00023320: 2066 6972 7374 2060 6e65 7874 283c 6765   first `next(<ge
+00023330: 6e65 7261 746f 723e 2960 0a20 2020 2020  nerator>)`.     
+00023340: 2020 2020 2020 2023 2069 7465 7261 7469         # iterati
+00023350: 6f6e 2068 6170 7065 6e73 0a0a 2020 2020  on happens..    
+00023360: 2020 2020 2020 2020 6465 6620 5f28 7365          def _(se
+00023370: 6c66 293a 0a20 2020 2020 2020 2020 2020  lf):.           
+00023380: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00023390: 6e67 6528 7365 6c66 2e6e 7061 7274 6974  nge(self.npartit
+000233a0: 696f 6e73 293a 0a20 2020 2020 2020 2020  ions):.         
+000233b0: 2020 2020 2020 2020 2020 2073 203d 2073             s = s
+000233c0: 656c 662e 6765 745f 7061 7274 6974 696f  elf.get_partitio
+000233d0: 6e28 6929 2e63 6f6d 7075 7465 2829 0a20  n(i).compute(). 
+000233e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000233f0: 2020 2079 6965 6c64 2066 726f 6d20 732e     yield from s.
+00023400: 6974 656d 7328 290a 0a20 2020 2020 2020  items()..       
+00023410: 2020 2020 2072 6574 7572 6e20 5f28 7365       return _(se
+00023420: 6c66 290a 0a20 2020 2040 6465 7269 7665  lf)..    @derive
+00023430: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
+00023440: 290a 2020 2020 6465 6620 5f5f 6974 6572  ).    def __iter
+00023450: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+00023460: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00023470: 2873 656c 662e 6e70 6172 7469 7469 6f6e  (self.npartition
+00023480: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00023490: 7320 3d20 7365 6c66 2e67 6574 5f70 6172  s = self.get_par
+000234a0: 7469 7469 6f6e 2869 292e 636f 6d70 7574  tition(i).comput
+000234b0: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+000234c0: 7969 656c 6420 6672 6f6d 2073 0a0a 2020  yield from s..  
+000234d0: 2020 405f 6465 7072 6563 6174 6564 280a    @_deprecated(.
+000234e0: 2020 2020 2020 2020 6d65 7373 6167 653d          message=
+000234f0: 280a 2020 2020 2020 2020 2020 2020 2255  (.            "U
+00023500: 7369 6e67 2074 6865 2060 6069 6e60 6020  sing the ``in`` 
+00023510: 6f70 6572 6174 6f72 2074 6f20 7465 7374  operator to test
+00023520: 2066 6f72 206d 656d 6265 7273 6869 7020   for membership 
+00023530: 696e 2053 6572 6965 7320 6973 2022 0a20  in Series is ". 
+00023540: 2020 2020 2020 2020 2020 2022 6465 7072             "depr
+00023550: 6563 6174 6564 2e20 546f 2074 6573 7420  ecated. To test 
+00023560: 666f 7220 6d65 6d62 6572 7368 6970 2069  for membership i
+00023570: 6e20 7468 6520 696e 6465 7820 7573 6520  n the index use 
+00023580: 220a 2020 2020 2020 2020 2020 2020 2260  ".            "`
+00023590: 6028 732e 696e 6465 7820 3d3d 206b 6579  `(s.index == key
+000235a0: 292e 616e 7928 2960 602e 2053 696d 696c  ).any()``. Simil
+000235b0: 6172 6c79 2074 6f20 7465 7374 2066 6f72  arly to test for
+000235c0: 206d 656d 6265 7273 6869 7020 696e 2022   membership in "
+000235d0: 0a20 2020 2020 2020 2020 2020 2022 7468  .            "th
+000235e0: 6520 7661 6c75 6573 2075 7365 2060 6028  e values use ``(
+000235f0: 7320 3d3d 206b 6579 292e 616e 7928 2960  s == key).any()`
+00023600: 6022 0a20 2020 2020 2020 2029 0a20 2020  `".        ).   
+00023610: 2029 0a20 2020 2064 6566 205f 5f63 6f6e   ).    def __con
+00023620: 7461 696e 735f 5f28 7365 6c66 2c20 6b65  tains__(self, ke
+00023630: 7929 3a0a 2020 2020 2020 2020 7265 7475  y):.        retu
+00023640: 726e 2028 7365 6c66 203d 3d20 6b65 7929  rn (self == key)
+00023650: 2e61 6e79 2829 2e63 6f6d 7075 7465 2829  .any().compute()
+00023660: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+00023670: 6f64 0a20 2020 2064 6566 205f 7661 6c69  od.    def _vali
+00023680: 6461 7465 5f61 7869 7328 636c 732c 2061  date_axis(cls, a
+00023690: 7869 733d 302c 206e 6f6e 655f 6973 5f7a  xis=0, none_is_z
+000236a0: 6572 6f3a 2062 6f6f 6c20 3d20 5472 7565  ero: bool = True
+000236b0: 2920 2d3e 204e 6f6e 6520 7c20 4c69 7465  ) -> None | Lite
+000236c0: 7261 6c5b 302c 2031 5d3a 0a20 2020 2020  ral[0, 1]:.     
+000236d0: 2020 2069 6620 6178 6973 206e 6f74 2069     if axis not i
+000236e0: 6e20 2830 2c20 2269 6e64 6578 222c 204e  n (0, "index", N
+000236f0: 6f6e 6529 3a0a 2020 2020 2020 2020 2020  one):.          
+00023700: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00023710: 6f72 2866 224e 6f20 6178 6973 206e 616d  or(f"No axis nam
+00023720: 6564 207b 6178 6973 7d22 290a 2020 2020  ed {axis}").    
+00023730: 2020 2020 2320 636f 6e76 6572 7420 746f      # convert to
+00023740: 206e 756d 6572 6963 2061 7869 730a 2020   numeric axis.  
+00023750: 2020 2020 2020 6e75 6d65 7269 635f 6178        numeric_ax
+00023760: 6973 3a20 6469 6374 5b73 7472 207c 204e  is: dict[str | N
+00023770: 6f6e 652c 204c 6974 6572 616c 5b30 2c20  one, Literal[0, 
+00023780: 315d 5d20 3d20 7b22 696e 6465 7822 3a20  1]] = {"index": 
+00023790: 307d 0a20 2020 2020 2020 2069 6620 6e6f  0}.        if no
+000237a0: 6e65 5f69 735f 7a65 726f 3a0a 2020 2020  ne_is_zero:.    
+000237b0: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+000237c0: 6178 6973 5b4e 6f6e 655d 203d 2030 0a20  axis[None] = 0. 
+000237d0: 2020 2020 2020 2072 6574 7572 6e20 6e75         return nu
+000237e0: 6d65 7269 635f 6178 6973 2e67 6574 2861  meric_axis.get(a
+000237f0: 7869 732c 2061 7869 7329 0a0a 2020 2020  xis, axis)..    
+00023800: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00023810: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+00023820: 2067 726f 7570 6279 280a 2020 2020 2020   groupby(.      
+00023830: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00023840: 6279 3d4e 6f6e 652c 0a20 2020 2020 2020  by=None,.       
+00023850: 2067 726f 7570 5f6b 6579 733d 4752 4f55   group_keys=GROU
+00023860: 505f 4b45 5953 5f44 4546 4155 4c54 2c0a  P_KEYS_DEFAULT,.
+00023870: 2020 2020 2020 2020 736f 7274 3d4e 6f6e          sort=Non
+00023880: 652c 0a20 2020 2020 2020 206f 6273 6572  e,.        obser
+00023890: 7665 643d 4e6f 6e65 2c0a 2020 2020 2020  ved=None,.      
+000238a0: 2020 6472 6f70 6e61 3d4e 6f6e 652c 0a20    dropna=None,. 
+000238b0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+000238c0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000238d0: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
+000238e0: 616d 652e 6772 6f75 7062 7920 696d 706f  ame.groupby impo
+000238f0: 7274 2053 6572 6965 7347 726f 7570 4279  rt SeriesGroupBy
+00023900: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00023910: 2053 6572 6965 7347 726f 7570 4279 280a   SeriesGroupBy(.
+00023920: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00023930: 2c0a 2020 2020 2020 2020 2020 2020 6279  ,.            by
+00023940: 3d62 792c 0a20 2020 2020 2020 2020 2020  =by,.           
+00023950: 2067 726f 7570 5f6b 6579 733d 6772 6f75   group_keys=grou
+00023960: 705f 6b65 7973 2c0a 2020 2020 2020 2020  p_keys,.        
+00023970: 2020 2020 736f 7274 3d73 6f72 742c 0a20      sort=sort,. 
+00023980: 2020 2020 2020 2020 2020 206f 6273 6572             obser
+00023990: 7665 643d 6f62 7365 7276 6564 2c0a 2020  ved=observed,.  
+000239a0: 2020 2020 2020 2020 2020 6472 6f70 6e61            dropna
+000239b0: 3d64 726f 706e 612c 0a20 2020 2020 2020  =dropna,.       
+000239c0: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
+000239d0: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+000239e0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+000239f0: 6572 6965 7329 0a20 2020 2064 6566 2063  eries).    def c
+00023a00: 6f75 6e74 2873 656c 662c 2073 706c 6974  ount(self, split
+00023a10: 5f65 7665 7279 3d46 616c 7365 293a 0a20  _every=False):. 
+00023a20: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
+00023a30: 7065 7228 292e 636f 756e 7428 7370 6c69  per().count(spli
+00023a40: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00023a50: 6572 7929 0a0a 2020 2020 4064 6572 6976  ery)..    @deriv
+00023a60: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
+00023a70: 7329 0a20 2020 2064 6566 206d 6f64 6528  s).    def mode(
+00023a80: 7365 6c66 2c20 6472 6f70 6e61 3d54 7275  self, dropna=Tru
+00023a90: 652c 2073 706c 6974 5f65 7665 7279 3d46  e, split_every=F
+00023aa0: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
+00023ab0: 6574 7572 6e20 7375 7065 7228 292e 6d6f  eturn super().mo
+00023ac0: 6465 2864 726f 706e 613d 6472 6f70 6e61  de(dropna=dropna
+00023ad0: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
+00023ae0: 6c69 745f 6576 6572 7929 0a0a 2020 2020  lit_every)..    
+00023af0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00023b00: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+00023b10: 2065 7870 6c6f 6465 2873 656c 6629 3a0a   explode(self):.
+00023b20: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
+00023b30: 656c 662e 5f6d 6574 612e 6578 706c 6f64  elf._meta.explod
+00023b40: 6528 290a 2020 2020 2020 2020 7265 7475  e().        retu
+00023b50: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+00023b60: 6974 696f 6e73 284d 2e65 7870 6c6f 6465  itions(M.explode
+00023b70: 2c20 6d65 7461 3d6d 6574 612c 2065 6e66  , meta=meta, enf
+00023b80: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
+00023b90: 6c73 6529 0a0a 2020 2020 6465 6620 756e  lse)..    def un
+00023ba0: 6971 7565 2873 656c 662c 2073 706c 6974  ique(self, split
+00023bb0: 5f65 7665 7279 3d4e 6f6e 652c 2073 706c  _every=None, spl
+00023bc0: 6974 5f6f 7574 3d31 293a 0a20 2020 2020  it_out=1):.     
+00023bd0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
+00023be0: 6574 7572 6e20 5365 7269 6573 206f 6620  eturn Series of 
+00023bf0: 756e 6971 7565 2076 616c 7565 7320 696e  unique values in
+00023c00: 2074 6865 206f 626a 6563 742e 2049 6e63   the object. Inc
+00023c10: 6c75 6465 7320 4e41 2076 616c 7565 732e  ludes NA values.
+00023c20: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00023c30: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00023c40: 2d0a 2020 2020 2020 2020 756e 6971 7565  -.        unique
+00023c50: 7320 3a20 5365 7269 6573 0a20 2020 2020  s : Series.     
+00023c60: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00023c70: 6574 7572 6e20 6163 6128 0a20 2020 2020  eturn aca(.     
+00023c80: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00023c90: 2020 2020 2020 2020 2063 6875 6e6b 3d6d           chunk=m
+00023ca0: 6574 686f 6473 2e75 6e69 7175 652c 0a20  ethods.unique,. 
+00023cb0: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
+00023cc0: 6761 7465 3d6d 6574 686f 6473 2e75 6e69  gate=methods.uni
+00023cd0: 7175 652c 0a20 2020 2020 2020 2020 2020  que,.           
+00023ce0: 206d 6574 613d 7365 6c66 2e5f 6d65 7461   meta=self._meta
+00023cf0: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
+00023d00: 6b65 6e3d 2275 6e69 7175 6522 2c0a 2020  ken="unique",.  
+00023d10: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
+00023d20: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00023d30: 792c 0a20 2020 2020 2020 2020 2020 2073  y,.            s
+00023d40: 6572 6965 735f 6e61 6d65 3d73 656c 662e  eries_name=self.
+00023d50: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00023d60: 2020 7370 6c69 745f 6f75 743d 7370 6c69    split_out=spli
+00023d70: 745f 6f75 742c 0a20 2020 2020 2020 2029  t_out,.        )
+00023d80: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00023d90: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00023da0: 2020 2064 6566 206e 756e 6971 7565 2873     def nunique(s
+00023db0: 656c 662c 2073 706c 6974 5f65 7665 7279  elf, split_every
+00023dc0: 3d4e 6f6e 652c 2064 726f 706e 613d 5472  =None, dropna=Tr
+00023dd0: 7565 293a 0a20 2020 2020 2020 2075 6e69  ue):.        uni
+00023de0: 7173 203d 2073 656c 662e 6472 6f70 5f64  qs = self.drop_d
+00023df0: 7570 6c69 6361 7465 7328 7370 6c69 745f  uplicates(split_
+00023e00: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00023e10: 7929 0a20 2020 2020 2020 2069 6620 6472  y).        if dr
+00023e20: 6f70 6e61 3a0a 2020 2020 2020 2020 2020  opna:.          
+00023e30: 2020 2320 636f 756e 7420 6d69 6d69 6373    # count mimics
+00023e40: 2070 616e 6461 7320 6265 6861 7669 6f72   pandas behavior
+00023e50: 2061 6e64 2065 7863 6c75 6465 7320 4e41   and excludes NA
+00023e60: 2076 616c 7565 730a 2020 2020 2020 2020   values.        
+00023e70: 2020 2020 7265 7475 726e 2075 6e69 7173      return uniqs
+00023e80: 2e63 6f75 6e74 2829 0a20 2020 2020 2020  .count().       
+00023e90: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00023ea0: 2020 2072 6574 7572 6e20 756e 6971 732e     return uniqs.
+00023eb0: 7369 7a65 0a0a 2020 2020 4064 6572 6976  size..    @deriv
+00023ec0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
+00023ed0: 7329 0a20 2020 2064 6566 2076 616c 7565  s).    def value
+00023ee0: 5f63 6f75 6e74 7328 0a20 2020 2020 2020  _counts(.       
+00023ef0: 2073 656c 662c 0a20 2020 2020 2020 2073   self,.        s
+00023f00: 6f72 743d 4e6f 6e65 2c0a 2020 2020 2020  ort=None,.      
+00023f10: 2020 6173 6365 6e64 696e 673d 4661 6c73    ascending=Fals
+00023f20: 652c 0a20 2020 2020 2020 2064 726f 706e  e,.        dropn
+00023f30: 613d 4e6f 6e65 2c0a 2020 2020 2020 2020  a=None,.        
+00023f40: 6e6f 726d 616c 697a 653d 4661 6c73 652c  normalize=False,
+00023f50: 0a20 2020 2020 2020 2073 706c 6974 5f65  .        split_e
+00023f60: 7665 7279 3d4e 6f6e 652c 0a20 2020 2020  very=None,.     
+00023f70: 2020 2073 706c 6974 5f6f 7574 3d31 2c0a     split_out=1,.
+00023f80: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+00023f90: 2222 0a20 2020 2020 2020 204e 6f74 653a  "".        Note:
+00023fa0: 2064 726f 706e 6120 6973 206f 6e6c 7920   dropna is only 
+00023fb0: 7375 7070 6f72 7465 6420 696e 2070 616e  supported in pan
+00023fc0: 6461 7320 3e3d 2031 2e31 2e30 2c20 696e  das >= 1.1.0, in
+00023fd0: 2077 6869 6368 2063 6173 6520 6974 2064   which case it d
+00023fe0: 6566 6175 6c74 7320 746f 0a20 2020 2020  efaults to.     
+00023ff0: 2020 2054 7275 652e 0a20 2020 2020 2020     True..       
+00024000: 2022 2222 0a20 2020 2020 2020 206b 7761   """.        kwa
+00024010: 7267 7320 3d20 7b22 736f 7274 223a 2073  rgs = {"sort": s
+00024020: 6f72 742c 2022 6173 6365 6e64 696e 6722  ort, "ascending"
+00024030: 3a20 6173 6365 6e64 696e 677d 0a20 2020  : ascending}.   
+00024040: 2020 2020 2069 6620 6472 6f70 6e61 2069       if dropna i
+00024050: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00024060: 2020 2020 2020 2020 6b77 6172 6773 5b22          kwargs["
+00024070: 6472 6f70 6e61 225d 203d 2064 726f 706e  dropna"] = dropn
+00024080: 610a 2020 2020 2020 2020 6167 6772 6567  a.        aggreg
+00024090: 6174 655f 6b77 6172 6773 203d 207b 226e  ate_kwargs = {"n
+000240a0: 6f72 6d61 6c69 7a65 223a 206e 6f72 6d61  ormalize": norma
+000240b0: 6c69 7a65 7d0a 2020 2020 2020 2020 6966  lize}.        if
+000240c0: 2073 706c 6974 5f6f 7574 203e 2031 3a0a   split_out > 1:.
+000240d0: 2020 2020 2020 2020 2020 2020 6167 6772              aggr
+000240e0: 6567 6174 655f 6b77 6172 6773 5b22 746f  egate_kwargs["to
+000240f0: 7461 6c5f 6c65 6e67 7468 225d 203d 2028  tal_length"] = (
+00024100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024110: 206c 656e 2873 656c 6629 2069 6620 6472   len(self) if dr
+00024120: 6f70 6e61 2069 7320 4661 6c73 6520 656c  opna is False el
+00024130: 7365 206c 656e 2873 656c 662e 6472 6f70  se len(self.drop
+00024140: 6e61 2829 290a 2020 2020 2020 2020 2020  na()).          
+00024150: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
+00024160: 7572 6e20 6163 6128 0a20 2020 2020 2020  urn aca(.       
+00024170: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00024180: 2020 2020 2020 2063 6875 6e6b 3d4d 2e76         chunk=M.v
+00024190: 616c 7565 5f63 6f75 6e74 732c 0a20 2020  alue_counts,.   
+000241a0: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+000241b0: 7465 3d6d 6574 686f 6473 2e76 616c 7565  te=methods.value
+000241c0: 5f63 6f75 6e74 735f 6167 6772 6567 6174  _counts_aggregat
+000241d0: 652c 0a20 2020 2020 2020 2020 2020 2063  e,.            c
+000241e0: 6f6d 6269 6e65 3d6d 6574 686f 6473 2e76  ombine=methods.v
+000241f0: 616c 7565 5f63 6f75 6e74 735f 636f 6d62  alue_counts_comb
+00024200: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
+00024210: 206d 6574 613d 7365 6c66 2e5f 6d65 7461   meta=self._meta
+00024220: 2e76 616c 7565 5f63 6f75 6e74 7328 6e6f  .value_counts(no
+00024230: 726d 616c 697a 653d 6e6f 726d 616c 697a  rmalize=normaliz
+00024240: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+00024250: 746f 6b65 6e3d 2276 616c 7565 2d63 6f75  token="value-cou
+00024260: 6e74 7322 2c0a 2020 2020 2020 2020 2020  nts",.          
+00024270: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
+00024280: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+00024290: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
+000242a0: 3d73 706c 6974 5f6f 7574 2c0a 2020 2020  =split_out,.    
+000242b0: 2020 2020 2020 2020 7370 6c69 745f 6f75          split_ou
+000242c0: 745f 7365 7475 703d 7370 6c69 745f 6f75  t_setup=split_ou
+000242d0: 745f 6f6e 5f69 6e64 6578 2c0a 2020 2020  t_on_index,.    
+000242e0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+000242f0: 655f 6b77 6172 6773 3d61 6767 7265 6761  e_kwargs=aggrega
+00024300: 7465 5f6b 7761 7267 732c 0a20 2020 2020  te_kwargs,.     
+00024310: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+00024320: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00024330: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00024340: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+00024350: 206e 6c61 7267 6573 7428 7365 6c66 2c20   nlargest(self, 
+00024360: 6e3d 352c 2073 706c 6974 5f65 7665 7279  n=5, split_every
+00024370: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00024380: 7265 7475 726e 2061 6361 280a 2020 2020  return aca(.    
+00024390: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000243a0: 2020 2020 2020 2020 2020 6368 756e 6b3d            chunk=
+000243b0: 4d2e 6e6c 6172 6765 7374 2c0a 2020 2020  M.nlargest,.    
+000243c0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+000243d0: 653d 4d2e 6e6c 6172 6765 7374 2c0a 2020  e=M.nlargest,.  
+000243e0: 2020 2020 2020 2020 2020 6d65 7461 3d73            meta=s
+000243f0: 656c 662e 5f6d 6574 612c 0a20 2020 2020  elf._meta,.     
+00024400: 2020 2020 2020 2074 6f6b 656e 3d22 7365         token="se
+00024410: 7269 6573 2d6e 6c61 7267 6573 7422 2c0a  ries-nlargest",.
+00024420: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00024430: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00024440: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+00024450: 206e 3d6e 2c0a 2020 2020 2020 2020 290a   n=n,.        ).
+00024460: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00024470: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+00024480: 2020 6465 6620 6e73 6d61 6c6c 6573 7428    def nsmallest(
+00024490: 7365 6c66 2c20 6e3d 352c 2073 706c 6974  self, n=5, split
+000244a0: 5f65 7665 7279 3d4e 6f6e 6529 3a0a 2020  _every=None):.  
+000244b0: 2020 2020 2020 7265 7475 726e 2061 6361        return aca
+000244c0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+000244d0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+000244e0: 6368 756e 6b3d 4d2e 6e73 6d61 6c6c 6573  chunk=M.nsmalles
+000244f0: 742c 0a20 2020 2020 2020 2020 2020 2061  t,.            a
+00024500: 6767 7265 6761 7465 3d4d 2e6e 736d 616c  ggregate=M.nsmal
+00024510: 6c65 7374 2c0a 2020 2020 2020 2020 2020  lest,.          
+00024520: 2020 6d65 7461 3d73 656c 662e 5f6d 6574    meta=self._met
+00024530: 612c 0a20 2020 2020 2020 2020 2020 2074  a,.            t
+00024540: 6f6b 656e 3d22 7365 7269 6573 2d6e 736d  oken="series-nsm
+00024550: 616c 6c65 7374 222c 0a20 2020 2020 2020  allest",.       
+00024560: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+00024570: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
+00024580: 2020 2020 2020 2020 2020 6e3d 6e2c 0a20            n=n,. 
+00024590: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+000245a0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+000245b0: 6572 6965 7329 0a20 2020 2064 6566 2069  eries).    def i
+000245c0: 7369 6e28 7365 6c66 2c20 7661 6c75 6573  sin(self, values
+000245d0: 293a 0a20 2020 2020 2020 2023 2041 6464  ):.        # Add
+000245e0: 6564 206a 7573 7420 746f 2067 6574 2074  ed just to get t
+000245f0: 6865 2064 6966 6665 7265 6e74 2064 6f63  he different doc
+00024600: 7374 7269 6e67 2066 6f72 2053 6572 6965  string for Serie
+00024610: 730a 2020 2020 2020 2020 7265 7475 726e  s.        return
+00024620: 2073 7570 6572 2829 2e69 7369 6e28 7661   super().isin(va
+00024630: 6c75 6573 290a 0a20 2020 2040 696e 7365  lues)..    @inse
+00024640: 7274 5f6d 6574 615f 7061 7261 6d5f 6465  rt_meta_param_de
+00024650: 7363 7269 7074 696f 6e28 7061 643d 3132  scription(pad=12
+00024660: 290a 2020 2020 4064 6572 6976 6564 5f66  ).    @derived_f
+00024670: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00024680: 2020 2064 6566 206d 6170 2873 656c 662c     def map(self,
+00024690: 2061 7267 2c20 6e61 5f61 6374 696f 6e3d   arg, na_action=
+000246a0: 4e6f 6e65 2c20 6d65 7461 3d6e 6f5f 6465  None, meta=no_de
+000246b0: 6661 756c 7429 3a0a 2020 2020 2020 2020  fault):.        
+000246c0: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
+000246d0: 6528 6172 6729 2061 6e64 2069 735f 6461  e(arg) and is_da
+000246e0: 736b 5f63 6f6c 6c65 6374 696f 6e28 6172  sk_collection(ar
+000246f0: 6729 3a0a 2020 2020 2020 2020 2020 2020  g):.            
+00024700: 7265 7475 726e 2073 6572 6965 735f 6d61  return series_ma
+00024710: 7028 7365 6c66 2c20 6172 6729 0a20 2020  p(self, arg).   
+00024720: 2020 2020 2069 6620 6e6f 7420 280a 2020       if not (.  
+00024730: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
+00024740: 616e 6365 2861 7267 2c20 6469 6374 290a  ance(arg, dict).
+00024750: 2020 2020 2020 2020 2020 2020 6f72 2063              or c
+00024760: 616c 6c61 626c 6528 6172 6729 0a20 2020  allable(arg).   
+00024770: 2020 2020 2020 2020 206f 7220 6973 5f73           or is_s
+00024780: 6572 6965 735f 6c69 6b65 2861 7267 290a  eries_like(arg).
+00024790: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+000247a0: 6e6f 7420 6973 5f64 6173 6b5f 636f 6c6c  not is_dask_coll
+000247b0: 6563 7469 6f6e 2861 7267 290a 2020 2020  ection(arg).    
+000247c0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+000247d0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+000247e0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+000247f0: 2020 2020 6622 6172 6720 6d75 7374 2062      f"arg must b
+00024800: 6520 7061 6e64 6173 2e53 6572 6965 732c  e pandas.Series,
+00024810: 2064 6963 7420 6f72 2063 616c 6c61 626c   dict or callabl
+00024820: 652e 2047 6f74 207b 7479 7065 2861 7267  e. Got {type(arg
+00024830: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00024840: 290a 2020 2020 2020 2020 6e61 6d65 203d  ).        name =
+00024850: 2022 6d61 702d 2220 2b20 746f 6b65 6e69   "map-" + tokeni
+00024860: 7a65 2873 656c 662c 2061 7267 2c20 6e61  ze(self, arg, na
+00024870: 5f61 6374 696f 6e29 0a20 2020 2020 2020  _action).       
+00024880: 2064 736b 203d 207b 0a20 2020 2020 2020   dsk = {.       
+00024890: 2020 2020 2028 6e61 6d65 2c20 6929 3a20       (name, i): 
+000248a0: 284d 2e6d 6170 2c20 6b2c 2061 7267 2c20  (M.map, k, arg, 
+000248b0: 6e61 5f61 6374 696f 6e29 0a20 2020 2020  na_action).     
+000248c0: 2020 2020 2020 2066 6f72 2069 2c20 6b20         for i, k 
+000248d0: 696e 2065 6e75 6d65 7261 7465 2873 656c  in enumerate(sel
+000248e0: 662e 5f5f 6461 736b 5f6b 6579 735f 5f28  f.__dask_keys__(
+000248f0: 2929 0a20 2020 2020 2020 207d 0a20 2020  )).        }.   
+00024900: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+00024910: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+00024920: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+00024930: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
+00024940: 6369 6573 3d5b 7365 6c66 5d29 0a20 2020  cies=[self]).   
+00024950: 2020 2020 2069 6620 6d65 7461 2069 7320       if meta is 
+00024960: 6e6f 5f64 6566 6175 6c74 3a0a 2020 2020  no_default:.    
+00024970: 2020 2020 2020 2020 6d65 7461 203d 205f          meta = _
+00024980: 656d 756c 6174 6528 4d2e 6d61 702c 2073  emulate(M.map, s
+00024990: 656c 662c 2061 7267 2c20 6e61 5f61 6374  elf, arg, na_act
+000249a0: 696f 6e3d 6e61 5f61 6374 696f 6e2c 2075  ion=na_action, u
+000249b0: 6466 3d54 7275 6529 0a20 2020 2020 2020  df=True).       
+000249c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000249d0: 2020 206d 6574 6120 3d20 6d61 6b65 5f6d     meta = make_m
+000249e0: 6574 6128 0a20 2020 2020 2020 2020 2020  eta(.           
+000249f0: 2020 2020 206d 6574 612c 0a20 2020 2020       meta,.     
+00024a00: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+00024a10: 3d67 6574 6174 7472 286d 616b 655f 6d65  =getattr(make_me
+00024a20: 7461 2873 656c 6629 2c20 2269 6e64 6578  ta(self), "index
+00024a30: 222c 204e 6f6e 6529 2c0a 2020 2020 2020  ", None),.      
+00024a40: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
+00024a50: 5f6d 6574 613d 7365 6c66 2e5f 6d65 7461  _meta=self._meta
+00024a60: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00024a70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00024a80: 7479 7065 2873 656c 6629 2867 7261 7068  type(self)(graph
+00024a90: 2c20 6e61 6d65 2c20 6d65 7461 2c20 7365  , name, meta, se
+00024aa0: 6c66 2e64 6976 6973 696f 6e73 290a 0a20  lf.divisions).. 
+00024ab0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00024ac0: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
+00024ad0: 6465 6620 6472 6f70 6e61 2873 656c 6629  def dropna(self)
+00024ae0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00024af0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+00024b00: 696f 6e73 284d 2e64 726f 706e 612c 2065  ions(M.dropna, e
+00024b10: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+00024b20: 4661 6c73 6529 0a0a 2020 2020 4064 6572  False)..    @der
+00024b30: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00024b40: 6965 7329 0a20 2020 2064 6566 2062 6574  ies).    def bet
+00024b50: 7765 656e 2873 656c 662c 206c 6566 742c  ween(self, left,
+00024b60: 2072 6967 6874 2c20 696e 636c 7573 6976   right, inclusiv
+00024b70: 653d 2262 6f74 6822 293a 0a20 2020 2020  e="both"):.     
+00024b80: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+00024b90: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00024ba0: 2020 2020 2020 2020 2020 204d 2e62 6574             M.bet
+00024bb0: 7765 656e 2c20 6c65 6674 3d6c 6566 742c  ween, left=left,
+00024bc0: 2072 6967 6874 3d72 6967 6874 2c20 696e   right=right, in
+00024bd0: 636c 7573 6976 653d 696e 636c 7573 6976  clusive=inclusiv
+00024be0: 650a 2020 2020 2020 2020 290a 0a20 2020  e.        )..   
+00024bf0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00024c00: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+00024c10: 6620 636c 6970 2873 656c 662c 206c 6f77  f clip(self, low
+00024c20: 6572 3d4e 6f6e 652c 2075 7070 6572 3d4e  er=None, upper=N
+00024c30: 6f6e 652c 206f 7574 3d4e 6f6e 6529 3a0a  one, out=None):.
+00024c40: 2020 2020 2020 2020 6966 206f 7574 2069          if out i
+00024c50: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00024c60: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00024c70: 6c75 6545 7272 6f72 2822 276f 7574 2720  lueError("'out' 
+00024c80: 6d75 7374 2062 6520 4e6f 6e65 2229 0a20  must be None"). 
+00024c90: 2020 2020 2020 2023 206e 702e 636c 6970         # np.clip
+00024ca0: 206d 6179 2070 6173 7320 6f75 740a 2020   may pass out.  
+00024cb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00024cc0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+00024cd0: 280a 2020 2020 2020 2020 2020 2020 4d2e  (.            M.
+00024ce0: 636c 6970 2c20 6c6f 7765 723d 6c6f 7765  clip, lower=lowe
+00024cf0: 722c 2075 7070 6572 3d75 7070 6572 2c20  r, upper=upper, 
+00024d00: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00024d10: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
+00024d20: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00024d30: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00024d40: 2020 2064 6566 2063 6c69 705f 6c6f 7765     def clip_lowe
+00024d50: 7228 7365 6c66 2c20 7468 7265 7368 6f6c  r(self, threshol
+00024d60: 6429 3a0a 2020 2020 2020 2020 7265 7475  d):.        retu
+00024d70: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+00024d80: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+00024d90: 2020 2020 4d2e 636c 6970 5f6c 6f77 6572      M.clip_lower
+00024da0: 2c20 7468 7265 7368 6f6c 643d 7468 7265  , threshold=thre
+00024db0: 7368 6f6c 642c 2065 6e66 6f72 6365 5f6d  shold, enforce_m
+00024dc0: 6574 6164 6174 613d 4661 6c73 650a 2020  etadata=False.  
+00024dd0: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+00024de0: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+00024df0: 7269 6573 290a 2020 2020 6465 6620 636c  ries).    def cl
+00024e00: 6970 5f75 7070 6572 2873 656c 662c 2074  ip_upper(self, t
+00024e10: 6872 6573 686f 6c64 293a 0a20 2020 2020  hreshold):.     
+00024e20: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+00024e30: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00024e40: 2020 2020 2020 2020 2020 204d 2e63 6c69             M.cli
+00024e50: 705f 7570 7065 722c 2074 6872 6573 686f  p_upper, thresho
+00024e60: 6c64 3d74 6872 6573 686f 6c64 2c20 656e  ld=threshold, en
+00024e70: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+00024e80: 616c 7365 0a20 2020 2020 2020 2029 0a0a  alse.        )..
+00024e90: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00024ea0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+00024eb0: 2064 6566 2061 6c69 676e 2873 656c 662c   def align(self,
+00024ec0: 206f 7468 6572 2c20 6a6f 696e 3d22 6f75   other, join="ou
+00024ed0: 7465 7222 2c20 6178 6973 3d4e 6f6e 652c  ter", axis=None,
+00024ee0: 2066 696c 6c5f 7661 6c75 653d 4e6f 6e65   fill_value=None
+00024ef0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00024f00: 6e20 7375 7065 7228 292e 616c 6967 6e28  n super().align(
+00024f10: 6f74 6865 722c 206a 6f69 6e3d 6a6f 696e  other, join=join
+00024f20: 2c20 6178 6973 3d61 7869 732c 2066 696c  , axis=axis, fil
+00024f30: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
+00024f40: 7565 290a 0a20 2020 2040 6465 7269 7665  ue)..    @derive
+00024f50: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
+00024f60: 290a 2020 2020 6465 6620 636f 6d62 696e  ).    def combin
+00024f70: 6528 7365 6c66 2c20 6f74 6865 722c 2066  e(self, other, f
+00024f80: 756e 632c 2066 696c 6c5f 7661 6c75 653d  unc, fill_value=
+00024f90: 4e6f 6e65 293a 0a20 2020 2020 2020 2072  None):.        r
+00024fa0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+00024fb0: 6172 7469 7469 6f6e 7328 4d2e 636f 6d62  artitions(M.comb
+00024fc0: 696e 652c 206f 7468 6572 2c20 6675 6e63  ine, other, func
+00024fd0: 2c20 6669 6c6c 5f76 616c 7565 3d66 696c  , fill_value=fil
+00024fe0: 6c5f 7661 6c75 6529 0a0a 2020 2020 4064  l_value)..    @d
+00024ff0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+00025000: 6572 6965 7329 0a20 2020 2064 6566 2073  eries).    def s
+00025010: 7175 6565 7a65 2873 656c 6629 3a0a 2020  queeze(self):.  
+00025020: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00025030: 660a 0a20 2020 2040 6465 7269 7665 645f  f..    @derived_
+00025040: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+00025050: 2020 2020 6465 6620 636f 6d62 696e 655f      def combine_
+00025060: 6669 7273 7428 7365 6c66 2c20 6f74 6865  first(self, othe
+00025070: 7229 3a0a 2020 2020 2020 2020 7265 7475  r):.        retu
+00025080: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+00025090: 6974 696f 6e73 284d 2e63 6f6d 6269 6e65  itions(M.combine
+000250a0: 5f66 6972 7374 2c20 6f74 6865 7229 0a0a  _first, other)..
+000250b0: 2020 2020 6465 6620 746f 5f62 6167 2873      def to_bag(s
+000250c0: 656c 662c 2069 6e64 6578 3d46 616c 7365  elf, index=False
+000250d0: 2c20 666f 726d 6174 3d22 7475 706c 6522  , format="tuple"
+000250e0: 293a 0a20 2020 2020 2020 2022 2222 4372  ):.        """Cr
+000250f0: 6561 7465 2061 2044 6173 6b20 4261 6720  eate a Dask Bag 
+00025100: 6672 6f6d 2061 2053 6572 6965 7322 2222  from a Series"""
+00025110: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00025120: 736b 2e64 6174 6166 7261 6d65 2e69 6f20  sk.dataframe.io 
+00025130: 696d 706f 7274 2074 6f5f 6261 670a 0a20  import to_bag.. 
+00025140: 2020 2020 2020 2072 6574 7572 6e20 746f         return to
+00025150: 5f62 6167 2873 656c 662c 2069 6e64 6578  _bag(self, index
+00025160: 2c20 666f 726d 6174 3d66 6f72 6d61 7429  , format=format)
+00025170: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00025180: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00025190: 2020 2064 6566 2074 6f5f 6672 616d 6528     def to_frame(
+000251a0: 7365 6c66 2c20 6e61 6d65 3d4e 6f6e 6529  self, name=None)
+000251b0: 3a0a 2020 2020 2020 2020 6172 6773 203d  :.        args =
+000251c0: 205b 5d20 6966 206e 616d 6520 6973 204e   [] if name is N
+000251d0: 6f6e 6520 656c 7365 205b 6e61 6d65 5d0a  one else [name].
+000251e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000251f0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00025200: 6e73 284d 2e74 6f5f 6672 616d 652c 202a  ns(M.to_frame, *
+00025210: 6172 6773 2c20 6d65 7461 3d73 656c 662e  args, meta=self.
+00025220: 5f6d 6574 612e 746f 5f66 7261 6d65 282a  _meta.to_frame(*
+00025230: 6172 6773 2929 0a0a 2020 2020 4064 6572  args))..    @der
+00025240: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00025250: 6965 7329 0a20 2020 2064 6566 2074 6f5f  ies).    def to_
+00025260: 7374 7269 6e67 2873 656c 662c 206d 6178  string(self, max
+00025270: 5f72 6f77 733d 3529 3a0a 2020 2020 2020  _rows=5):.      
+00025280: 2020 2320 6f70 7469 6f6e 5f63 6f6e 7465    # option_conte
+00025290: 7874 2064 6f65 736e 2774 2061 6666 6563  xt doesn't affec
+000252a0: 740a 2020 2020 2020 2020 7265 7475 726e  t.        return
+000252b0: 2073 656c 662e 5f72 6570 725f 6461 7461   self._repr_data
+000252c0: 2829 2e74 6f5f 7374 7269 6e67 286d 6178  ().to_string(max
+000252d0: 5f72 6f77 733d 6d61 785f 726f 7773 290a  _rows=max_rows).
+000252e0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+000252f0: 640a 2020 2020 6465 6620 5f62 696e 645f  d.    def _bind_
+00025300: 6f70 6572 6174 6f72 5f6d 6574 686f 6428  operator_method(
+00025310: 636c 732c 206e 616d 652c 206f 702c 206f  cls, name, op, o
+00025320: 7269 6769 6e61 6c3d 7064 2e53 6572 6965  riginal=pd.Serie
+00025330: 7329 3a0a 2020 2020 2020 2020 2222 2262  s):.        """b
+00025340: 696e 6420 6f70 6572 6174 6f72 206d 6574  ind operator met
+00025350: 686f 6420 6c69 6b65 2053 6572 6965 732e  hod like Series.
+00025360: 6164 6420 746f 2074 6869 7320 636c 6173  add to this clas
+00025370: 7322 2222 0a0a 2020 2020 2020 2020 6465  s"""..        de
+00025380: 6620 6d65 7468 2873 656c 662c 206f 7468  f meth(self, oth
+00025390: 6572 2c20 6c65 7665 6c3d 4e6f 6e65 2c20  er, level=None, 
+000253a0: 6669 6c6c 5f76 616c 7565 3d4e 6f6e 652c  fill_value=None,
+000253b0: 2061 7869 733d 3029 3a0a 2020 2020 2020   axis=0):.      
+000253c0: 2020 2020 2020 6966 206c 6576 656c 2069        if level i
+000253d0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+000253e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000253f0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00025400: 4572 726f 7228 226c 6576 656c 206d 7573  Error("level mus
+00025410: 7420 6265 204e 6f6e 6522 290a 2020 2020  t be None").    
+00025420: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+00025430: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+00025440: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+00025450: 2020 2020 206d 6574 6120 3d20 5f65 6d75       meta = _emu
+00025460: 6c61 7465 286f 702c 2073 656c 662c 206f  late(op, self, o
+00025470: 7468 6572 2c20 6178 6973 3d61 7869 732c  ther, axis=axis,
+00025480: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
+00025490: 5f76 616c 7565 290a 2020 2020 2020 2020  _value).        
+000254a0: 2020 2020 7265 7475 726e 206d 6170 5f70      return map_p
+000254b0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+000254c0: 2020 2020 2020 2020 2020 206f 702c 2073             op, s
+000254d0: 656c 662c 206f 7468 6572 2c20 6d65 7461  elf, other, meta
+000254e0: 3d6d 6574 612c 2061 7869 733d 6178 6973  =meta, axis=axis
+000254f0: 2c20 6669 6c6c 5f76 616c 7565 3d66 696c  , fill_value=fil
+00025500: 6c5f 7661 6c75 650a 2020 2020 2020 2020  l_value.        
+00025510: 2020 2020 290a 0a20 2020 2020 2020 206d      )..        m
+00025520: 6574 682e 5f5f 6e61 6d65 5f5f 203d 206e  eth.__name__ = n
+00025530: 616d 650a 2020 2020 2020 2020 7365 7461  ame.        seta
+00025540: 7474 7228 636c 732c 206e 616d 652c 2064  ttr(cls, name, d
+00025550: 6572 6976 6564 5f66 726f 6d28 6f72 6967  erived_from(orig
+00025560: 696e 616c 2928 6d65 7468 2929 0a0a 2020  inal)(meth))..  
+00025570: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
+00025580: 2020 2064 6566 205f 6269 6e64 5f63 6f6d     def _bind_com
+00025590: 7061 7269 736f 6e5f 6d65 7468 6f64 2863  parison_method(c
+000255a0: 6c73 2c20 6e61 6d65 2c20 636f 6d70 6172  ls, name, compar
+000255b0: 6973 6f6e 2c20 6f72 6967 696e 616c 3d70  ison, original=p
+000255c0: 642e 5365 7269 6573 293a 0a20 2020 2020  d.Series):.     
+000255d0: 2020 2022 2222 6269 6e64 2063 6f6d 7061     """bind compa
+000255e0: 7269 736f 6e20 6d65 7468 6f64 206c 696b  rison method lik
+000255f0: 6520 5365 7269 6573 2e65 7120 746f 2074  e Series.eq to t
+00025600: 6869 7320 636c 6173 7322 2222 0a0a 2020  his class"""..  
+00025610: 2020 2020 2020 6465 6620 6d65 7468 2873        def meth(s
+00025620: 656c 662c 206f 7468 6572 2c20 6c65 7665  elf, other, leve
+00025630: 6c3d 4e6f 6e65 2c20 6669 6c6c 5f76 616c  l=None, fill_val
+00025640: 7565 3d4e 6f6e 652c 2061 7869 733d 3029  ue=None, axis=0)
+00025650: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00025660: 206c 6576 656c 2069 7320 6e6f 7420 4e6f   level is not No
+00025670: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00025680: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+00025690: 6c65 6d65 6e74 6564 4572 726f 7228 226c  lementedError("l
+000256a0: 6576 656c 206d 7573 7420 6265 204e 6f6e  evel must be Non
+000256b0: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+000256c0: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
+000256d0: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
+000256e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000256f0: 6669 6c6c 5f76 616c 7565 2069 7320 4e6f  fill_value is No
+00025700: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00025710: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
+00025720: 6973 6528 636f 6d70 6172 6973 6f6e 2c20  ise(comparison, 
+00025730: 7365 6c66 2c20 6f74 6865 722c 2061 7869  self, other, axi
+00025740: 733d 6178 6973 290a 2020 2020 2020 2020  s=axis).        
+00025750: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00025760: 2020 2020 2020 2020 2020 6f70 203d 2070            op = p
+00025770: 6172 7469 616c 2863 6f6d 7061 7269 736f  artial(compariso
+00025780: 6e2c 2066 696c 6c5f 7661 6c75 653d 6669  n, fill_value=fi
+00025790: 6c6c 5f76 616c 7565 290a 2020 2020 2020  ll_value).      
+000257a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000257b0: 2065 6c65 6d77 6973 6528 6f70 2c20 7365   elemwise(op, se
+000257c0: 6c66 2c20 6f74 6865 722c 2061 7869 733d  lf, other, axis=
+000257d0: 6178 6973 290a 0a20 2020 2020 2020 206d  axis)..        m
+000257e0: 6574 682e 5f5f 6e61 6d65 5f5f 203d 206e  eth.__name__ = n
+000257f0: 616d 650a 2020 2020 2020 2020 7365 7461  ame.        seta
+00025800: 7474 7228 636c 732c 206e 616d 652c 2064  ttr(cls, name, d
+00025810: 6572 6976 6564 5f66 726f 6d28 6f72 6967  erived_from(orig
+00025820: 696e 616c 2928 6d65 7468 2929 0a0a 2020  inal)(meth))..  
+00025830: 2020 4069 6e73 6572 745f 6d65 7461 5f70    @insert_meta_p
+00025840: 6172 616d 5f64 6573 6372 6970 7469 6f6e  aram_description
+00025850: 2870 6164 3d31 3229 0a20 2020 2064 6566  (pad=12).    def
+00025860: 2061 7070 6c79 2873 656c 662c 2066 756e   apply(self, fun
+00025870: 632c 2063 6f6e 7665 7274 5f64 7479 7065  c, convert_dtype
+00025880: 3d6e 6f5f 6465 6661 756c 742c 206d 6574  =no_default, met
+00025890: 613d 6e6f 5f64 6566 6175 6c74 2c20 6172  a=no_default, ar
+000258a0: 6773 3d28 292c 202a 2a6b 7764 7329 3a0a  gs=(), **kwds):.
+000258b0: 2020 2020 2020 2020 2222 2250 6172 616c          """Paral
+000258c0: 6c65 6c20 7665 7273 696f 6e20 6f66 2070  lel version of p
+000258d0: 616e 6461 732e 5365 7269 6573 2e61 7070  andas.Series.app
+000258e0: 6c79 0a0a 2020 2020 2020 2020 5061 7261  ly..        Para
+000258f0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+00025900: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00025910: 2020 6675 6e63 203a 2066 756e 6374 696f    func : functio
+00025920: 6e0a 2020 2020 2020 2020 2020 2020 4675  n.            Fu
+00025930: 6e63 7469 6f6e 2074 6f20 6170 706c 790a  nction to apply.
+00025940: 2020 2020 2020 2020 636f 6e76 6572 745f          convert_
+00025950: 6474 7970 6520 3a20 626f 6f6c 6561 6e2c  dtype : boolean,
+00025960: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
+00025970: 2020 2020 2020 2020 2020 5472 7920 746f            Try to
+00025980: 2066 696e 6420 6265 7474 6572 2064 7479   find better dty
+00025990: 7065 2066 6f72 2065 6c65 6d65 6e74 7769  pe for elementwi
+000259a0: 7365 2066 756e 6374 696f 6e20 7265 7375  se function resu
+000259b0: 6c74 732e 0a20 2020 2020 2020 2020 2020  lts..           
+000259c0: 2049 6620 4661 6c73 652c 206c 6561 7665   If False, leave
+000259d0: 2061 7320 6474 7970 653d 6f62 6a65 6374   as dtype=object
+000259e0: 2e0a 2020 2020 2020 2020 244d 4554 410a  ..        $META.
+000259f0: 2020 2020 2020 2020 6172 6773 203a 2074          args : t
+00025a00: 7570 6c65 0a20 2020 2020 2020 2020 2020  uple.           
+00025a10: 2050 6f73 6974 696f 6e61 6c20 6172 6775   Positional argu
+00025a20: 6d65 6e74 7320 746f 2070 6173 7320 746f  ments to pass to
+00025a30: 2066 756e 6374 696f 6e20 696e 2061 6464   function in add
+00025a40: 6974 696f 6e20 746f 2074 6865 2076 616c  ition to the val
+00025a50: 7565 2e0a 0a20 2020 2020 2020 2041 6464  ue...        Add
+00025a60: 6974 696f 6e61 6c20 6b65 7977 6f72 6420  itional keyword 
+00025a70: 6172 6775 6d65 6e74 7320 7769 6c6c 2062  arguments will b
+00025a80: 6520 7061 7373 6564 2061 7320 6b65 7977  e passed as keyw
+00025a90: 6f72 6473 2074 6f20 7468 6520 6675 6e63  ords to the func
+00025aa0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2052  tion...        R
+00025ab0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+00025ac0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2061  ------.        a
+00025ad0: 7070 6c69 6564 203a 2053 6572 6965 7320  pplied : Series 
+00025ae0: 6f72 2044 6174 6146 7261 6d65 2069 6620  or DataFrame if 
+00025af0: 6675 6e63 2072 6574 7572 6e73 2061 2053  func returns a S
+00025b00: 6572 6965 732e 0a0a 2020 2020 2020 2020  eries...        
+00025b10: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+00025b20: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00025b30: 2020 3e3e 3e20 696d 706f 7274 2064 6173    >>> import das
+00025b40: 6b2e 6461 7461 6672 616d 6520 6173 2064  k.dataframe as d
+00025b50: 640a 2020 2020 2020 2020 3e3e 3e20 7320  d.        >>> s 
+00025b60: 3d20 7064 2e53 6572 6965 7328 7261 6e67  = pd.Series(rang
+00025b70: 6528 3529 2c20 6e61 6d65 3d27 7827 290a  e(5), name='x').
+00025b80: 2020 2020 2020 2020 3e3e 3e20 6473 203d          >>> ds =
+00025b90: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
+00025ba0: 732c 206e 7061 7274 6974 696f 6e73 3d32  s, npartitions=2
+00025bb0: 290a 0a20 2020 2020 2020 2041 7070 6c79  )..        Apply
+00025bc0: 2061 2066 756e 6374 696f 6e20 656c 656d   a function elem
+00025bd0: 656e 7477 6973 6520 6163 726f 7373 2074  entwise across t
+00025be0: 6865 2053 6572 6965 732c 2070 6173 7369  he Series, passi
+00025bf0: 6e67 2069 6e20 6578 7472 610a 2020 2020  ng in extra.    
+00025c00: 2020 2020 6172 6775 6d65 6e74 7320 696e      arguments in
+00025c10: 2060 6061 7267 7360 6020 616e 6420 6060   ``args`` and ``
+00025c20: 6b77 6172 6773 6060 3a0a 0a20 2020 2020  kwargs``:..     
+00025c30: 2020 203e 3e3e 2064 6566 206d 7961 6464     >>> def myadd
+00025c40: 2878 2c20 612c 2062 3d31 293a 0a20 2020  (x, a, b=1):.   
+00025c50: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
+00025c60: 7572 6e20 7820 2b20 6120 2b20 620a 2020  urn x + a + b.  
+00025c70: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
+00025c80: 6473 2e61 7070 6c79 286d 7961 6464 2c20  ds.apply(myadd, 
+00025c90: 6172 6773 3d28 322c 292c 2062 3d31 2e35  args=(2,), b=1.5
+00025ca0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+00025cb0: 4b49 500a 0a20 2020 2020 2020 2042 7920  KIP..        By 
+00025cc0: 6465 6661 756c 742c 2064 6173 6b20 7472  default, dask tr
+00025cd0: 6965 7320 746f 2069 6e66 6572 2074 6865  ies to infer the
+00025ce0: 206f 7574 7075 7420 6d65 7461 6461 7461   output metadata
+00025cf0: 2062 7920 7275 6e6e 696e 6720 796f 7572   by running your
+00025d00: 0a20 2020 2020 2020 2070 726f 7669 6465  .        provide
+00025d10: 6420 6675 6e63 7469 6f6e 206f 6e20 736f  d function on so
+00025d20: 6d65 2066 616b 6520 6461 7461 2e20 5468  me fake data. Th
+00025d30: 6973 2077 6f72 6b73 2077 656c 6c20 696e  is works well in
+00025d40: 206d 616e 7920 6361 7365 732c 2062 7574   many cases, but
+00025d50: 0a20 2020 2020 2020 2063 616e 2073 6f6d  .        can som
+00025d60: 6574 696d 6573 2062 6520 6578 7065 6e73  etimes be expens
+00025d70: 6976 652c 206f 7220 6576 656e 2066 6169  ive, or even fai
+00025d80: 6c2e 2054 6f20 6176 6f69 6420 7468 6973  l. To avoid this
+00025d90: 2c20 796f 7520 6361 6e0a 2020 2020 2020  , you can.      
+00025da0: 2020 6d61 6e75 616c 6c79 2073 7065 6369    manually speci
+00025db0: 6679 2074 6865 206f 7574 7075 7420 6d65  fy the output me
+00025dc0: 7461 6461 7461 2077 6974 6820 7468 6520  tadata with the 
+00025dd0: 6060 6d65 7461 6060 206b 6579 776f 7264  ``meta`` keyword
+00025de0: 2e20 5468 6973 0a20 2020 2020 2020 2063  . This.        c
+00025df0: 616e 2062 6520 7370 6563 6966 6965 6420  an be specified 
+00025e00: 696e 206d 616e 7920 666f 726d 732c 2066  in many forms, f
+00025e10: 6f72 206d 6f72 6520 696e 666f 726d 6174  or more informat
+00025e20: 696f 6e20 7365 650a 2020 2020 2020 2020  ion see.        
+00025e30: 6060 6461 736b 2e64 6174 6166 7261 6d65  ``dask.dataframe
+00025e40: 2e75 7469 6c73 2e6d 616b 655f 6d65 7461  .utils.make_meta
+00025e50: 6060 2e0a 0a20 2020 2020 2020 2048 6572  ``...        Her
+00025e60: 6520 7765 2073 7065 6369 6679 2074 6865  e we specify the
+00025e70: 206f 7574 7075 7420 6973 2061 2053 6572   output is a Ser
+00025e80: 6965 7320 7769 7468 206e 616d 6520 6060  ies with name ``
+00025e90: 2778 2760 602c 2061 6e64 2064 7479 7065  'x'``, and dtype
+00025ea0: 0a20 2020 2020 2020 2060 6066 6c6f 6174  .        ``float
+00025eb0: 3634 6060 3a0a 0a20 2020 2020 2020 203e  64``:..        >
+00025ec0: 3e3e 2072 6573 203d 2064 732e 6170 706c  >> res = ds.appl
+00025ed0: 7928 6d79 6164 642c 2061 7267 733d 2832  y(myadd, args=(2
+00025ee0: 2c29 2c20 623d 312e 352c 206d 6574 613d  ,), b=1.5, meta=
+00025ef0: 2827 7827 2c20 2766 3827 2929 0a0a 2020  ('x', 'f8'))..  
+00025f00: 2020 2020 2020 496e 2074 6865 2063 6173        In the cas
+00025f10: 6520 7768 6572 6520 7468 6520 6d65 7461  e where the meta
+00025f20: 6461 7461 2064 6f65 736e 2774 2063 6861  data doesn't cha
+00025f30: 6e67 652c 2079 6f75 2063 616e 2061 6c73  nge, you can als
+00025f40: 6f20 7061 7373 2069 6e0a 2020 2020 2020  o pass in.      
+00025f50: 2020 7468 6520 6f62 6a65 6374 2069 7473    the object its
+00025f60: 656c 6620 6469 7265 6374 6c79 3a0a 0a20  elf directly:.. 
+00025f70: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+00025f80: 2064 732e 6170 706c 7928 6c61 6d62 6461   ds.apply(lambda
+00025f90: 2078 3a20 7820 2b20 312c 206d 6574 613d   x: x + 1, meta=
+00025fa0: 6473 290a 0a20 2020 2020 2020 2053 6565  ds)..        See
+00025fb0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
+00025fc0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+00025fd0: 6173 6b2e 5365 7269 6573 2e6d 6170 5f70  ask.Series.map_p
+00025fe0: 6172 7469 7469 6f6e 730a 2020 2020 2020  artitions.      
+00025ff0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00026000: 2063 6f6e 7665 7274 5f64 7479 7065 2069   convert_dtype i
+00026010: 7320 6e6f 7420 6e6f 5f64 6566 6175 6c74  s not no_default
+00026020: 3a0a 2020 2020 2020 2020 2020 2020 6b77  :.            kw
+00026030: 6473 5b22 636f 6e76 6572 745f 6474 7970  ds["convert_dtyp
+00026040: 6522 5d20 3d20 636f 6e76 6572 745f 6474  e"] = convert_dt
+00026050: 7970 650a 0a20 2020 2020 2020 2023 206c  ype..        # l
+00026060: 6574 2070 616e 6461 7320 7472 6967 6765  et pandas trigge
+00026070: 7220 616e 7920 7761 726e 696e 6773 2c20  r any warnings, 
+00026080: 7375 6368 2061 7320 636f 6e76 6572 745f  such as convert_
+00026090: 6474 7970 6520 7761 726e 696e 670a 2020  dtype warning.  
+000260a0: 2020 2020 2020 7365 6c66 2e5f 6d65 7461        self._meta
+000260b0: 2e61 7070 6c79 2866 756e 632c 2061 7267  .apply(func, arg
+000260c0: 733d 6172 6773 2c20 2a2a 6b77 6473 290a  s=args, **kwds).
+000260d0: 0a20 2020 2020 2020 2069 6620 6d65 7461  .        if meta
+000260e0: 2069 7320 6e6f 5f64 6566 6175 6c74 3a0a   is no_default:.
+000260f0: 2020 2020 2020 2020 2020 2020 7769 7468              with
+00026100: 2063 6865 636b 5f63 6f6e 7665 7274 5f64   check_convert_d
+00026110: 7479 7065 5f64 6570 7265 6361 7469 6f6e  type_deprecation
+00026120: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00026130: 2020 2020 6d65 7461 203d 205f 656d 756c      meta = _emul
+00026140: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
+00026150: 2020 2020 2020 2020 204d 2e61 7070 6c79           M.apply
+00026160: 2c20 7365 6c66 2e5f 6d65 7461 5f6e 6f6e  , self._meta_non
+00026170: 656d 7074 792c 2066 756e 632c 2061 7267  empty, func, arg
+00026180: 733d 6172 6773 2c20 7564 663d 5472 7565  s=args, udf=True
+00026190: 2c20 2a2a 6b77 6473 0a20 2020 2020 2020  , **kwds.       
+000261a0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000261b0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+000261c0: 7761 726e 286d 6574 615f 7761 726e 696e  warn(meta_warnin
+000261d0: 6728 6d65 7461 2929 0a20 2020 2020 2020  g(meta)).       
+000261e0: 2065 6c69 6620 5041 4e44 4153 5f47 545f   elif PANDAS_GT_
+000261f0: 3231 303a 0a20 2020 2020 2020 2020 2020  210:.           
+00026200: 2074 6573 745f 6d65 7461 203d 206d 616b   test_meta = mak
+00026210: 655f 6d65 7461 286d 6574 6129 0a20 2020  e_meta(meta).   
+00026220: 2020 2020 2020 2020 2069 6620 6973 5f64           if is_d
+00026230: 6174 6166 7261 6d65 5f6c 696b 6528 7465  ataframe_like(te
+00026240: 7374 5f6d 6574 6129 3a0a 2020 2020 2020  st_meta):.      
+00026250: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+00026260: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+00026270: 2020 2020 2020 2020 2020 2020 2022 5265               "Re
+00026280: 7475 726e 696e 6720 6120 4461 7461 4672  turning a DataFr
+00026290: 616d 6520 6672 6f6d 2053 6572 6965 732e  ame from Series.
+000262a0: 6170 706c 7920 7768 656e 2074 6865 2073  apply when the s
+000262b0: 7570 706c 6965 6420 6675 6e63 7469 6f6e  upplied function
+000262c0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+000262d0: 2020 2020 2020 2022 7265 7475 726e 7320         "returns 
+000262e0: 6120 5365 7269 6573 2069 7320 6465 7072  a Series is depr
+000262f0: 6563 6174 6564 2061 6e64 2077 696c 6c20  ecated and will 
+00026300: 6265 2072 656d 6f76 6564 2069 6e20 6120  be removed in a 
+00026310: 6675 7475 7265 2076 6572 7369 6f6e 2e22  future version."
+00026320: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00026330: 2020 2020 2020 4675 7475 7265 5761 726e        FutureWarn
+00026340: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
+00026350: 2020 2020 2020 2020 2073 7461 636b 6c65           stackle
+00026360: 7665 6c3d 322c 0a20 2020 2020 2020 2020  vel=2,.         
+00026370: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00026380: 2020 7265 7475 726e 206d 6170 5f70 6172    return map_par
+00026390: 7469 7469 6f6e 7328 6d65 7468 6f64 732e  titions(methods.
+000263a0: 6170 706c 792c 2073 656c 662c 2066 756e  apply, self, fun
+000263b0: 632c 2061 7267 733d 6172 6773 2c20 6d65  c, args=args, me
+000263c0: 7461 3d6d 6574 612c 202a 2a6b 7764 7329  ta=meta, **kwds)
+000263d0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+000263e0: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+000263f0: 2020 2064 6566 2063 6f76 2873 656c 662c     def cov(self,
+00026400: 206f 7468 6572 2c20 6d69 6e5f 7065 7269   other, min_peri
+00026410: 6f64 733d 4e6f 6e65 2c20 7370 6c69 745f  ods=None, split_
+00026420: 6576 6572 793d 4661 6c73 6529 3a0a 2020  every=False):.  
+00026430: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00026440: 6461 7461 6672 616d 652e 6d75 6c74 6920  dataframe.multi 
+00026450: 696d 706f 7274 2063 6f6e 6361 740a 0a20  import concat.. 
+00026460: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00026470: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
+00026480: 5365 7269 6573 293a 0a20 2020 2020 2020  Series):.       
+00026490: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+000264a0: 7272 6f72 2822 6f74 6865 7220 6d75 7374  rror("other must
+000264b0: 2062 6520 6120 6461 736b 2e64 6174 6166   be a dask.dataf
+000264c0: 7261 6d65 2e53 6572 6965 7322 290a 2020  rame.Series").  
+000264d0: 2020 2020 2020 6466 203d 2063 6f6e 6361        df = conca
+000264e0: 7428 5b73 656c 662c 206f 7468 6572 5d2c  t([self, other],
+000264f0: 2061 7869 733d 3129 0a20 2020 2020 2020   axis=1).       
+00026500: 2072 6574 7572 6e20 5f63 6f76 5f63 6f72   return _cov_cor
+00026510: 7228 0a20 2020 2020 2020 2020 2020 2064  r(.            d
+00026520: 662c 206d 696e 5f70 6572 696f 6473 2c20  f, min_periods, 
+00026530: 7363 616c 6172 3d54 7275 652c 206e 756d  scalar=True, num
+00026540: 6572 6963 5f6f 6e6c 793d 4661 6c73 652c  eric_only=False,
+00026550: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+00026560: 6974 5f65 7665 7279 0a20 2020 2020 2020  it_every.       
+00026570: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
+00026580: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
+00026590: 0a20 2020 2064 6566 2063 6f72 7228 7365  .    def corr(se
+000265a0: 6c66 2c20 6f74 6865 722c 206d 6574 686f  lf, other, metho
+000265b0: 643d 2270 6561 7273 6f6e 222c 206d 696e  d="pearson", min
+000265c0: 5f70 6572 696f 6473 3d4e 6f6e 652c 2073  _periods=None, s
+000265d0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+000265e0: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
+000265f0: 6461 736b 2e64 6174 6166 7261 6d65 2e6d  dask.dataframe.m
+00026600: 756c 7469 2069 6d70 6f72 7420 636f 6e63  ulti import conc
+00026610: 6174 0a0a 2020 2020 2020 2020 6966 206e  at..        if n
+00026620: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
+00026630: 6865 722c 2053 6572 6965 7329 3a0a 2020  her, Series):.  
+00026640: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00026650: 5479 7065 4572 726f 7228 226f 7468 6572  TypeError("other
+00026660: 206d 7573 7420 6265 2061 2064 6173 6b2e   must be a dask.
+00026670: 6461 7461 6672 616d 652e 5365 7269 6573  dataframe.Series
+00026680: 2229 0a20 2020 2020 2020 2069 6620 6d65  ").        if me
+00026690: 7468 6f64 2021 3d20 2270 6561 7273 6f6e  thod != "pearson
+000266a0: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
+000266b0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+000266c0: 7465 6445 7272 6f72 2822 4f6e 6c79 2050  tedError("Only P
+000266d0: 6561 7273 6f6e 2063 6f72 7265 6c61 7469  earson correlati
+000266e0: 6f6e 2068 6173 2062 6565 6e20 696d 706c  on has been impl
+000266f0: 656d 656e 7465 6422 290a 2020 2020 2020  emented").      
+00026700: 2020 6466 203d 2063 6f6e 6361 7428 5b73    df = concat([s
+00026710: 656c 662c 206f 7468 6572 5d2c 2061 7869  elf, other], axi
+00026720: 733d 3129 0a20 2020 2020 2020 2072 6574  s=1).        ret
+00026730: 7572 6e20 5f63 6f76 5f63 6f72 7228 0a20  urn _cov_corr(. 
+00026740: 2020 2020 2020 2020 2020 2064 662c 0a20             df,. 
+00026750: 2020 2020 2020 2020 2020 206d 696e 5f70             min_p
+00026760: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
+00026770: 2020 2020 636f 7272 3d54 7275 652c 0a20      corr=True,. 
+00026780: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
+00026790: 723d 5472 7565 2c0a 2020 2020 2020 2020  r=True,.        
+000267a0: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
+000267b0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+000267c0: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+000267d0: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
+000267e0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+000267f0: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00026800: 6965 7329 0a20 2020 2064 6566 2061 7574  ies).    def aut
+00026810: 6f63 6f72 7228 7365 6c66 2c20 6c61 673d  ocorr(self, lag=
+00026820: 312c 2073 706c 6974 5f65 7665 7279 3d46  1, split_every=F
+00026830: 616c 7365 293a 0a20 2020 2020 2020 2069  alse):.        i
+00026840: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00026850: 286c 6167 2c20 496e 7465 6772 616c 293a  (lag, Integral):
+00026860: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00026870: 7365 2054 7970 6545 7272 6f72 2822 6c61  se TypeError("la
+00026880: 6720 6d75 7374 2062 6520 616e 2069 6e74  g must be an int
+00026890: 6567 6572 2229 0a20 2020 2020 2020 2072  eger").        r
+000268a0: 6574 7572 6e20 7365 6c66 2e63 6f72 7228  eturn self.corr(
+000268b0: 7365 6c66 2069 6620 6c61 6720 3d3d 2030  self if lag == 0
+000268c0: 2065 6c73 6520 7365 6c66 2e73 6869 6674   else self.shift
+000268d0: 286c 6167 292c 2073 706c 6974 5f65 7665  (lag), split_eve
+000268e0: 7279 3d73 706c 6974 5f65 7665 7279 290a  ry=split_every).
+000268f0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00026900: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+00026910: 2020 6465 6620 6d65 6d6f 7279 5f75 7361    def memory_usa
+00026920: 6765 2873 656c 662c 2069 6e64 6578 3d54  ge(self, index=T
+00026930: 7275 652c 2064 6565 703d 4661 6c73 6529  rue, deep=False)
+00026940: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00026950: 2073 656c 662e 7265 6475 6374 696f 6e28   self.reduction(
+00026960: 0a20 2020 2020 2020 2020 2020 204d 2e6d  .            M.m
+00026970: 656d 6f72 795f 7573 6167 652c 0a20 2020  emory_usage,.   
+00026980: 2020 2020 2020 2020 204d 2e73 756d 2c0a           M.sum,.
+00026990: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+000269a0: 6b5f 6b77 6172 6773 3d7b 2269 6e64 6578  k_kwargs={"index
+000269b0: 223a 2069 6e64 6578 2c20 2264 6565 7022  ": index, "deep"
+000269c0: 3a20 6465 6570 7d2c 0a20 2020 2020 2020  : deep},.       
+000269d0: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+000269e0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+000269f0: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
+00026a00: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
+00026a10: 6d65 6d6f 7279 2d75 7361 6765 222c 0a20  memory-usage",. 
+00026a20: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00026a30: 6620 5f5f 6469 766d 6f64 5f5f 2873 656c  f __divmod__(sel
+00026a40: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
+00026a50: 2020 2072 6573 3120 3d20 7365 6c66 202f     res1 = self /
+00026a60: 2f20 6f74 6865 720a 2020 2020 2020 2020  / other.        
+00026a70: 7265 7332 203d 2073 656c 6620 2520 6f74  res2 = self % ot
+00026a80: 6865 720a 2020 2020 2020 2020 7265 7475  her.        retu
+00026a90: 726e 2072 6573 312c 2072 6573 320a 0a20  rn res1, res2.. 
+00026aa0: 2020 2064 6566 205f 5f72 6469 766d 6f64     def __rdivmod
+00026ab0: 5f5f 2873 656c 662c 206f 7468 6572 293a  __(self, other):
+00026ac0: 0a20 2020 2020 2020 2072 6573 3120 3d20  .        res1 = 
+00026ad0: 6f74 6865 7220 2f2f 2073 656c 660a 2020  other // self.  
+00026ae0: 2020 2020 2020 7265 7332 203d 206f 7468        res2 = oth
+00026af0: 6572 2025 2073 656c 660a 2020 2020 2020  er % self.      
+00026b00: 2020 7265 7475 726e 2072 6573 312c 2072    return res1, r
+00026b10: 6573 320a 0a20 2020 2069 6620 6e6f 7420  es2..    if not 
+00026b20: 5041 4e44 4153 5f47 545f 3230 303a 0a0a  PANDAS_GT_200:..
+00026b30: 2020 2020 2020 2020 4070 726f 7065 7274          @propert
+00026b40: 790a 2020 2020 2020 2020 4064 6572 6976  y.        @deriv
+00026b50: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
+00026b60: 7329 0a20 2020 2020 2020 2064 6566 2069  s).        def i
+00026b70: 735f 6d6f 6e6f 746f 6e69 6328 7365 6c66  s_monotonic(self
+00026b80: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00026b90: 6620 5041 4e44 4153 5f47 545f 3135 303a  f PANDAS_GT_150:
+00026ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026bb0: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
+00026bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026bd0: 2020 2020 2269 735f 6d6f 6e6f 746f 6e69      "is_monotoni
+00026be0: 6320 6973 2064 6570 7265 6361 7465 6420  c is deprecated 
+00026bf0: 616e 6420 7769 6c6c 2062 6520 7265 6d6f  and will be remo
+00026c00: 7665 6420 696e 2061 2066 7574 7572 6520  ved in a future 
+00026c10: 7665 7273 696f 6e2e 2022 0a20 2020 2020  version. ".     
+00026c20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00026c30: 5573 6520 6973 5f6d 6f6e 6f74 6f6e 6963  Use is_monotonic
+00026c40: 5f69 6e63 7265 6173 696e 6720 696e 7374  _increasing inst
+00026c50: 6561 642e 222c 0a20 2020 2020 2020 2020  ead.",.         
+00026c60: 2020 2020 2020 2020 2020 2046 7574 7572             Futur
+00026c70: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
+00026c80: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00026c90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00026ca0: 656c 662e 6973 5f6d 6f6e 6f74 6f6e 6963  elf.is_monotonic
+00026cb0: 5f69 6e63 7265 6173 696e 670a 0a20 2020  _increasing..   
+00026cc0: 2040 7072 6f70 6572 7479 0a20 2020 2040   @property.    @
+00026cd0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00026ce0: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
+00026cf0: 6973 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63  is_monotonic_inc
+00026d00: 7265 6173 696e 6728 7365 6c66 293a 0a20  reasing(self):. 
+00026d10: 2020 2020 2020 2072 6574 7572 6e20 6163         return ac
+00026d20: 6128 0a20 2020 2020 2020 2020 2020 2073  a(.            s
+00026d30: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+00026d40: 2063 6875 6e6b 3d6d 6574 686f 6473 2e6d   chunk=methods.m
+00026d50: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
+00026d60: 696e 675f 6368 756e 6b2c 0a20 2020 2020  ing_chunk,.     
+00026d70: 2020 2020 2020 2063 6f6d 6269 6e65 3d6d         combine=m
+00026d80: 6574 686f 6473 2e6d 6f6e 6f74 6f6e 6963  ethods.monotonic
+00026d90: 5f69 6e63 7265 6173 696e 675f 636f 6d62  _increasing_comb
+00026da0: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
+00026db0: 2061 6767 7265 6761 7465 3d6d 6574 686f   aggregate=metho
+00026dc0: 6473 2e6d 6f6e 6f74 6f6e 6963 5f69 6e63  ds.monotonic_inc
+00026dd0: 7265 6173 696e 675f 6167 6772 6567 6174  reasing_aggregat
+00026de0: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
+00026df0: 6574 613d 626f 6f6c 2c0a 2020 2020 2020  eta=bool,.      
+00026e00: 2020 2020 2020 746f 6b65 6e3d 226d 6f6e        token="mon
+00026e10: 6f74 6f6e 6963 5f69 6e63 7265 6173 696e  otonic_increasin
+00026e20: 6722 2c0a 2020 2020 2020 2020 290a 0a20  g",.        ).. 
+00026e30: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00026e40: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00026e50: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+00026e60: 6620 6973 5f6d 6f6e 6f74 6f6e 6963 5f64  f is_monotonic_d
+00026e70: 6563 7265 6173 696e 6728 7365 6c66 293a  ecreasing(self):
+00026e80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00026e90: 6163 6128 0a20 2020 2020 2020 2020 2020  aca(.           
+00026ea0: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
+00026eb0: 2020 2063 6875 6e6b 3d6d 6574 686f 6473     chunk=methods
+00026ec0: 2e6d 6f6e 6f74 6f6e 6963 5f64 6563 7265  .monotonic_decre
+00026ed0: 6173 696e 675f 6368 756e 6b2c 0a20 2020  asing_chunk,.   
+00026ee0: 2020 2020 2020 2020 2063 6f6d 6269 6e65           combine
+00026ef0: 3d6d 6574 686f 6473 2e6d 6f6e 6f74 6f6e  =methods.monoton
+00026f00: 6963 5f64 6563 7265 6173 696e 675f 636f  ic_decreasing_co
+00026f10: 6d62 696e 652c 0a20 2020 2020 2020 2020  mbine,.         
+00026f20: 2020 2061 6767 7265 6761 7465 3d6d 6574     aggregate=met
+00026f30: 686f 6473 2e6d 6f6e 6f74 6f6e 6963 5f64  hods.monotonic_d
+00026f40: 6563 7265 6173 696e 675f 6167 6772 6567  ecreasing_aggreg
+00026f50: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+00026f60: 206d 6574 613d 626f 6f6c 2c0a 2020 2020   meta=bool,.    
+00026f70: 2020 2020 2020 2020 746f 6b65 6e3d 226d          token="m
+00026f80: 6f6e 6f74 6f6e 6963 5f64 6563 7265 6173  onotonic_decreas
+00026f90: 696e 6722 2c0a 2020 2020 2020 2020 290a  ing",.        ).
+00026fa0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00026fb0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+00026fc0: 2020 6465 6620 7669 6577 2873 656c 662c    def view(self,
+00026fd0: 2064 7479 7065 293a 0a20 2020 2020 2020   dtype):.       
+00026fe0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+00026ff0: 7461 2e76 6965 7728 6474 7970 6529 0a20  ta.view(dtype). 
+00027000: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00027010: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00027020: 7328 4d2e 7669 6577 2c20 6474 7970 652c  s(M.view, dtype,
+00027030: 206d 6574 613d 6d65 7461 290a 0a0a 636c   meta=meta)...cl
+00027040: 6173 7320 496e 6465 7828 5365 7269 6573  ass Index(Series
+00027050: 293a 0a20 2020 205f 7061 7274 6974 696f  ):.    _partitio
+00027060: 6e5f 7479 7065 203d 2070 642e 496e 6465  n_type = pd.Inde
+00027070: 780a 2020 2020 5f69 735f 7061 7274 6974  x.    _is_partit
+00027080: 696f 6e5f 7479 7065 203d 2073 7461 7469  ion_type = stati
+00027090: 636d 6574 686f 6428 6973 5f69 6e64 6578  cmethod(is_index
+000270a0: 5f6c 696b 6529 0a20 2020 205f 746f 6b65  _like).    _toke
+000270b0: 6e5f 7072 6566 6978 203d 2022 696e 6465  n_prefix = "inde
+000270c0: 782d 220a 2020 2020 5f61 6363 6573 736f  x-".    _accesso
+000270d0: 7273 3a20 436c 6173 7356 6172 5b73 6574  rs: ClassVar[set
+000270e0: 5b73 7472 5d5d 203d 2073 6574 2829 0a0a  [str]] = set()..
+000270f0: 2020 2020 5f64 745f 6174 7472 6962 7574      _dt_attribut
+00027100: 6573 203d 207b 0a20 2020 2020 2020 2022  es = {.        "
+00027110: 6e61 6e6f 7365 636f 6e64 222c 0a20 2020  nanosecond",.   
+00027120: 2020 2020 2022 6d69 6372 6f73 6563 6f6e       "microsecon
+00027130: 6422 2c0a 2020 2020 2020 2020 226d 696c  d",.        "mil
+00027140: 6c69 7365 636f 6e64 222c 0a20 2020 2020  lisecond",.     
+00027150: 2020 2022 6461 796f 6679 6561 7222 2c0a     "dayofyear",.
+00027160: 2020 2020 2020 2020 226d 696e 7574 6522          "minute"
+00027170: 2c0a 2020 2020 2020 2020 2268 6f75 7222  ,.        "hour"
+00027180: 2c0a 2020 2020 2020 2020 2264 6179 222c  ,.        "day",
+00027190: 0a20 2020 2020 2020 2022 6461 796f 6677  .        "dayofw
+000271a0: 6565 6b22 2c0a 2020 2020 2020 2020 2273  eek",.        "s
+000271b0: 6563 6f6e 6422 2c0a 2020 2020 2020 2020  econd",.        
+000271c0: 2277 6565 6b22 2c0a 2020 2020 2020 2020  "week",.        
+000271d0: 2277 6565 6b64 6179 222c 0a20 2020 2020  "weekday",.     
+000271e0: 2020 2022 7765 656b 6f66 7965 6172 222c     "weekofyear",
+000271f0: 0a20 2020 2020 2020 2022 6d6f 6e74 6822  .        "month"
+00027200: 2c0a 2020 2020 2020 2020 2271 7561 7274  ,.        "quart
+00027210: 6572 222c 0a20 2020 2020 2020 2022 7965  er",.        "ye
+00027220: 6172 222c 0a20 2020 207d 0a0a 2020 2020  ar",.    }..    
+00027230: 5f63 6174 5f61 7474 7269 6275 7465 7320  _cat_attributes 
+00027240: 3d20 7b0a 2020 2020 2020 2020 226b 6e6f  = {.        "kno
+00027250: 776e 222c 0a20 2020 2020 2020 2022 6173  wn",.        "as
+00027260: 5f6b 6e6f 776e 222c 0a20 2020 2020 2020  _known",.       
+00027270: 2022 6173 5f75 6e6b 6e6f 776e 222c 0a20   "as_unknown",. 
+00027280: 2020 2020 2020 2022 6164 645f 6361 7465         "add_cate
+00027290: 676f 7269 6573 222c 0a20 2020 2020 2020  gories",.       
+000272a0: 2022 6361 7465 676f 7269 6573 222c 0a20   "categories",. 
+000272b0: 2020 2020 2020 2022 7265 6d6f 7665 5f63         "remove_c
+000272c0: 6174 6567 6f72 6965 7322 2c0a 2020 2020  ategories",.    
+000272d0: 2020 2020 2272 656f 7264 6572 5f63 6174      "reorder_cat
+000272e0: 6567 6f72 6965 7322 2c0a 2020 2020 2020  egories",.      
+000272f0: 2020 2261 735f 6f72 6465 7265 6422 2c0a    "as_ordered",.
+00027300: 2020 2020 2020 2020 2263 6f64 6573 222c          "codes",
+00027310: 0a20 2020 2020 2020 2022 7265 6d6f 7665  .        "remove
+00027320: 5f75 6e75 7365 645f 6361 7465 676f 7269  _unused_categori
+00027330: 6573 222c 0a20 2020 2020 2020 2022 7365  es",.        "se
+00027340: 745f 6361 7465 676f 7269 6573 222c 0a20  t_categories",. 
+00027350: 2020 2020 2020 2022 6173 5f75 6e6f 7264         "as_unord
+00027360: 6572 6564 222c 0a20 2020 2020 2020 2022  ered",.        "
+00027370: 6f72 6465 7265 6422 2c0a 2020 2020 2020  ordered",.      
+00027380: 2020 2272 656e 616d 655f 6361 7465 676f    "rename_catego
+00027390: 7269 6573 222c 0a20 2020 207d 0a0a 2020  ries",.    }..  
+000273a0: 2020 5f6d 6f6e 6f74 6f6e 6963 5f61 7474    _monotonic_att
+000273b0: 7269 6275 7465 7320 3d20 7b0a 2020 2020  ributes = {.    
+000273c0: 2020 2020 2269 735f 6d6f 6e6f 746f 6e69      "is_monotoni
+000273d0: 6322 2c0a 2020 2020 2020 2020 2269 735f  c",.        "is_
+000273e0: 6d6f 6e6f 746f 6e69 635f 696e 6372 6561  monotonic_increa
+000273f0: 7369 6e67 222c 0a20 2020 2020 2020 2022  sing",.        "
+00027400: 6973 5f6d 6f6e 6f74 6f6e 6963 5f64 6563  is_monotonic_dec
+00027410: 7265 6173 696e 6722 2c0a 2020 2020 7d0a  reasing",.    }.
+00027420: 0a20 2020 2064 6566 205f 5f67 6574 6174  .    def __getat
+00027430: 7472 5f5f 2873 656c 662c 206b 6579 293a  tr__(self, key):
+00027440: 0a20 2020 2020 2020 2069 6620 280a 2020  .        if (.  
+00027450: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
+00027460: 616e 6365 2873 656c 662e 5f6d 6574 612e  ance(self._meta.
+00027470: 6474 7970 652c 2070 642e 4361 7465 676f  dtype, pd.Catego
+00027480: 7269 6361 6c44 7479 7065 290a 2020 2020  ricalDtype).    
+00027490: 2020 2020 2020 2020 616e 6420 6b65 7920          and key 
+000274a0: 696e 2073 656c 662e 5f63 6174 5f61 7474  in self._cat_att
+000274b0: 7269 6275 7465 730a 2020 2020 2020 2020  ributes.        
+000274c0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+000274d0: 6574 7572 6e20 6765 7461 7474 7228 7365  eturn getattr(se
+000274e0: 6c66 2e63 6174 2c20 6b65 7929 0a20 2020  lf.cat, key).   
+000274f0: 2020 2020 2065 6c69 6620 6b65 7920 696e       elif key in
+00027500: 2073 656c 662e 5f64 745f 6174 7472 6962   self._dt_attrib
+00027510: 7574 6573 3a0a 2020 2020 2020 2020 2020  utes:.          
+00027520: 2020 7265 7475 726e 2067 6574 6174 7472    return getattr
+00027530: 2873 656c 662e 6474 2c20 6b65 7929 0a20  (self.dt, key). 
+00027540: 2020 2020 2020 2065 6c69 6620 6b65 7920         elif key 
+00027550: 696e 2073 656c 662e 5f6d 6f6e 6f74 6f6e  in self._monoton
+00027560: 6963 5f61 7474 7269 6275 7465 733a 0a20  ic_attributes:. 
+00027570: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00027580: 6e20 6765 7461 7474 7228 7365 6c66 2c20  n getattr(self, 
+00027590: 6b65 7929 0a20 2020 2020 2020 2072 6169  key).        rai
+000275a0: 7365 2041 7474 7269 6275 7465 4572 726f  se AttributeErro
+000275b0: 7228 2227 496e 6465 7827 206f 626a 6563  r("'Index' objec
+000275c0: 7420 6861 7320 6e6f 2061 7474 7269 6275  t has no attribu
+000275d0: 7465 2025 7222 2025 206b 6579 290a 0a20  te %r" % key).. 
+000275e0: 2020 2064 6566 205f 5f64 6972 5f5f 2873     def __dir__(s
+000275f0: 656c 6629 3a0a 2020 2020 2020 2020 6f75  elf):.        ou
+00027600: 7420 3d20 7375 7065 7228 292e 5f5f 6469  t = super().__di
+00027610: 725f 5f28 290a 2020 2020 2020 2020 6f75  r__().        ou
+00027620: 742e 6578 7465 6e64 2873 656c 662e 5f64  t.extend(self._d
+00027630: 745f 6174 7472 6962 7574 6573 290a 2020  t_attributes).  
+00027640: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00027650: 6e63 6528 7365 6c66 2e64 7479 7065 2c20  nce(self.dtype, 
+00027660: 7064 2e43 6174 6567 6f72 6963 616c 4474  pd.CategoricalDt
+00027670: 7970 6529 3a0a 2020 2020 2020 2020 2020  ype):.          
+00027680: 2020 6f75 742e 6578 7465 6e64 2873 656c    out.extend(sel
+00027690: 662e 5f63 6174 5f61 7474 7269 6275 7465  f._cat_attribute
+000276a0: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
+000276b0: 6e20 6f75 740a 0a20 2020 2023 2054 7970  n out..    # Typ
+000276c0: 696e 673a 2068 7474 7073 3a2f 2f67 6974  ing: https://git
+000276d0: 6875 622e 636f 6d2f 7079 7468 6f6e 2f6d  hub.com/python/m
+000276e0: 7970 792f 6973 7375 6573 2f34 3132 350a  ypy/issues/4125.
+000276f0: 2020 2020 4070 726f 7065 7274 7920 2023      @property  #
+00027700: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
+00027710: 2020 6465 6620 696e 6465 7828 7365 6c66    def index(self
+00027720: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+00027730: 2041 7474 7269 6275 7465 4572 726f 7228   AttributeError(
+00027740: 0a20 2020 2020 2020 2020 2020 2066 227b  .            f"{
+00027750: 7365 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f  self.__class__._
+00027760: 5f6e 616d 655f 5f21 727d 206f 626a 6563  _name__!r} objec
+00027770: 7420 6861 7320 6e6f 2061 7474 7269 6275  t has no attribu
+00027780: 7465 2027 696e 6465 7827 220a 2020 2020  te 'index'".    
+00027790: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
+000277a0: 5f61 7272 6179 5f77 7261 705f 5f28 7365  _array_wrap__(se
+000277b0: 6c66 2c20 6172 7261 792c 2063 6f6e 7465  lf, array, conte
+000277c0: 7874 3d4e 6f6e 6529 3a0a 2020 2020 2020  xt=None):.      
+000277d0: 2020 7265 7475 726e 2070 642e 496e 6465    return pd.Inde
+000277e0: 7828 6172 7261 792c 206e 616d 653d 7365  x(array, name=se
+000277f0: 6c66 2e6e 616d 6529 0a0a 2020 2020 6465  lf.name)..    de
+00027800: 6620 6865 6164 2873 656c 662c 206e 3d35  f head(self, n=5
+00027810: 2c20 636f 6d70 7574 653d 5472 7565 293a  , compute=True):
+00027820: 0a20 2020 2020 2020 2022 2222 4669 7273  .        """Firs
+00027830: 7420 6e20 6974 656d 7320 6f66 2074 6865  t n items of the
+00027840: 2049 6e64 6578 2e0a 0a20 2020 2020 2020   Index...       
+00027850: 2043 6176 6561 742c 2074 6869 7320 6f6e   Caveat, this on
+00027860: 6c79 2063 6865 636b 7320 7468 6520 6669  ly checks the fi
+00027870: 7273 7420 7061 7274 6974 696f 6e2e 0a20  rst partition.. 
+00027880: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00027890: 2020 206e 616d 6520 3d20 2268 6561 642d     name = "head-
+000278a0: 2564 2d25 7322 2025 2028 6e2c 2073 656c  %d-%s" % (n, sel
+000278b0: 662e 5f6e 616d 6529 0a20 2020 2020 2020  f._name).       
+000278c0: 2064 736b 203d 207b 286e 616d 652c 2030   dsk = {(name, 0
+000278d0: 293a 2028 6f70 6572 6174 6f72 2e67 6574  ): (operator.get
+000278e0: 6974 656d 2c20 2873 656c 662e 5f6e 616d  item, (self._nam
+000278f0: 652c 2030 292c 2073 6c69 6365 2830 2c20  e, 0), slice(0, 
+00027900: 6e29 297d 0a20 2020 2020 2020 2067 7261  n))}.        gra
+00027910: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+00027920: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+00027930: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
+00027940: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
+00027950: 6c66 5d29 0a0a 2020 2020 2020 2020 7265  lf])..        re
+00027960: 7375 6c74 203d 206e 6577 5f64 645f 6f62  sult = new_dd_ob
+00027970: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
+00027980: 2c20 7365 6c66 2e5f 6d65 7461 2c20 7365  , self._meta, se
+00027990: 6c66 2e64 6976 6973 696f 6e73 5b3a 325d  lf.divisions[:2]
+000279a0: 290a 0a20 2020 2020 2020 2069 6620 636f  )..        if co
+000279b0: 6d70 7574 653a 0a20 2020 2020 2020 2020  mpute:.         
+000279c0: 2020 2072 6573 756c 7420 3d20 7265 7375     result = resu
+000279d0: 6c74 2e63 6f6d 7075 7465 2829 0a20 2020  lt.compute().   
+000279e0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+000279f0: 6c74 0a0a 2020 2020 4064 6572 6976 6564  lt..    @derived
+00027a00: 5f66 726f 6d28 7064 2e49 6e64 6578 290a  _from(pd.Index).
+00027a10: 2020 2020 6465 6620 6d61 7828 7365 6c66      def max(self
+00027a20: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+00027a30: 6c73 6529 3a0a 2020 2020 2020 2020 7265  lse):.        re
+00027a40: 7475 726e 2073 656c 662e 7265 6475 6374  turn self.reduct
+00027a50: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+00027a60: 204d 2e6d 6178 2c0a 2020 2020 2020 2020   M.max,.        
+00027a70: 2020 2020 6d65 7461 3d73 656c 662e 5f6d      meta=self._m
+00027a80: 6574 615f 6e6f 6e65 6d70 7479 2e6d 6178  eta_nonempty.max
+00027a90: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+00027aa0: 746f 6b65 6e3d 7365 6c66 2e5f 746f 6b65  token=self._toke
+00027ab0: 6e5f 7072 6566 6978 202b 2022 6d61 7822  n_prefix + "max"
+00027ac0: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+00027ad0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00027ae0: 6576 6572 792c 0a20 2020 2020 2020 2029  every,.        )
+00027af0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00027b00: 726f 6d28 7064 2e49 6e64 6578 290a 2020  rom(pd.Index).  
+00027b10: 2020 6465 6620 6d69 6e28 7365 6c66 2c20    def min(self, 
+00027b20: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+00027b30: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
+00027b40: 726e 2073 656c 662e 7265 6475 6374 696f  rn self.reductio
+00027b50: 6e28 0a20 2020 2020 2020 2020 2020 204d  n(.            M
+00027b60: 2e6d 696e 2c0a 2020 2020 2020 2020 2020  .min,.          
+00027b70: 2020 6d65 7461 3d73 656c 662e 5f6d 6574    meta=self._met
+00027b80: 615f 6e6f 6e65 6d70 7479 2e6d 696e 2829  a_nonempty.min()
+00027b90: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
+00027ba0: 6b65 6e3d 7365 6c66 2e5f 746f 6b65 6e5f  ken=self._token_
+00027bb0: 7072 6566 6978 202b 2022 6d69 6e22 2c0a  prefix + "min",.
+00027bc0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00027bd0: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00027be0: 6572 792c 0a20 2020 2020 2020 2029 0a0a  ery,.        )..
+00027bf0: 2020 2020 6465 6620 636f 756e 7428 7365      def count(se
+00027c00: 6c66 2c20 7370 6c69 745f 6576 6572 793d  lf, split_every=
+00027c10: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00027c20: 7265 7475 726e 2073 656c 662e 7265 6475  return self.redu
+00027c30: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+00027c40: 2020 206d 6574 686f 6473 2e69 6e64 6578     methods.index
+00027c50: 5f63 6f75 6e74 2c0a 2020 2020 2020 2020  _count,.        
+00027c60: 2020 2020 6e70 2e73 756d 2c0a 2020 2020      np.sum,.    
+00027c70: 2020 2020 2020 2020 746f 6b65 6e3d 2269          token="i
+00027c80: 6e64 6578 2d63 6f75 6e74 222c 0a20 2020  ndex-count",.   
+00027c90: 2020 2020 2020 2020 206d 6574 613d 696e           meta=in
+00027ca0: 742c 0a20 2020 2020 2020 2020 2020 2073  t,.            s
+00027cb0: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+00027cc0: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
+00027cd0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00027ce0: 6672 6f6d 2870 642e 496e 6465 7829 0a20  from(pd.Index). 
+00027cf0: 2020 2064 6566 2073 6869 6674 2873 656c     def shift(sel
+00027d00: 662c 2070 6572 696f 6473 3d31 2c20 6672  f, periods=1, fr
+00027d10: 6571 3d4e 6f6e 6529 3a0a 2020 2020 2020  eq=None):.      
+00027d20: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00027d30: 7365 6c66 2e5f 6d65 7461 2c20 7064 2e50  self._meta, pd.P
+00027d40: 6572 696f 6449 6e64 6578 293a 0a20 2020  eriodIndex):.   
+00027d50: 2020 2020 2020 2020 2069 6620 6672 6571           if freq
+00027d60: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00027d70: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00027d80: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00027d90: 5065 7269 6f64 496e 6465 7820 646f 6573  PeriodIndex does
+00027da0: 6e27 7420 6163 6365 7074 2060 6672 6571  n't accept `freq
+00027db0: 6020 6172 6775 6d65 6e74 2229 0a20 2020  ` argument").   
+00027dc0: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+00027dd0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+00027de0: 7074 792e 7368 6966 7428 7065 7269 6f64  pty.shift(period
+00027df0: 7329 0a20 2020 2020 2020 2020 2020 206f  s).            o
+00027e00: 7574 203d 2073 656c 662e 6d61 705f 7061  ut = self.map_pa
+00027e10: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00027e20: 2020 2020 2020 2020 2020 4d2e 7368 6966            M.shif
+00027e30: 742c 2070 6572 696f 6473 2c20 6d65 7461  t, periods, meta
+00027e40: 3d6d 6574 612c 2074 6f6b 656e 3d22 7368  =meta, token="sh
+00027e50: 6966 7422 2c20 7472 616e 7366 6f72 6d5f  ift", transform_
+00027e60: 6469 7669 7369 6f6e 733d 4661 6c73 650a  divisions=False.
+00027e70: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00027e80: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00027e90: 2020 2020 2020 2020 2320 5061 6e64 6173          # Pandas
+00027ea0: 2077 696c 6c20 7261 6973 6520 666f 7220   will raise for 
+00027eb0: 6f74 6865 7220 696e 6465 7820 7479 7065  other index type
+00027ec0: 7320 7468 6174 2064 6f6e 2774 2069 6d70  s that don't imp
+00027ed0: 6c65 6d65 6e74 2073 6869 6674 0a20 2020  lement shift.   
+00027ee0: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+00027ef0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+00027f00: 7074 792e 7368 6966 7428 7065 7269 6f64  pty.shift(period
+00027f10: 732c 2066 7265 713d 6672 6571 290a 2020  s, freq=freq).  
+00027f20: 2020 2020 2020 2020 2020 6f75 7420 3d20            out = 
+00027f30: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+00027f40: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+00027f50: 2020 2020 204d 2e73 6869 6674 2c0a 2020       M.shift,.  
+00027f60: 2020 2020 2020 2020 2020 2020 2020 7065                pe
+00027f70: 7269 6f64 732c 0a20 2020 2020 2020 2020  riods,.         
+00027f80: 2020 2020 2020 2074 6f6b 656e 3d22 7368         token="sh
+00027f90: 6966 7422 2c0a 2020 2020 2020 2020 2020  ift",.          
+00027fa0: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
+00027fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027fc0: 2066 7265 713d 6672 6571 2c0a 2020 2020   freq=freq,.    
+00027fd0: 2020 2020 2020 2020 2020 2020 7472 616e              tran
+00027fe0: 7366 6f72 6d5f 6469 7669 7369 6f6e 733d  sform_divisions=
+00027ff0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00028000: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+00028010: 6672 6571 2069 7320 4e6f 6e65 3a0a 2020  freq is None:.  
+00028020: 2020 2020 2020 2020 2020 6672 6571 203d            freq =
+00028030: 206d 6574 612e 6672 6571 0a20 2020 2020   meta.freq.     
+00028040: 2020 2072 6574 7572 6e20 6d61 7962 655f     return maybe_
+00028050: 7368 6966 745f 6469 7669 7369 6f6e 7328  shift_divisions(
+00028060: 6f75 742c 2070 6572 696f 6473 2c20 6672  out, periods, fr
+00028070: 6571 3d66 7265 7129 0a0a 2020 2020 4064  eq=freq)..    @d
+00028080: 6572 6976 6564 5f66 726f 6d28 7064 2e49  erived_from(pd.I
+00028090: 6e64 6578 290a 2020 2020 6465 6620 746f  ndex).    def to
+000280a0: 5f73 6572 6965 7328 7365 6c66 293a 0a20  _series(self):. 
+000280b0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000280c0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+000280d0: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
+000280e0: 2e74 6f5f 7365 7269 6573 2c0a 2020 2020  .to_series,.    
+000280f0: 2020 2020 2020 2020 6d65 7461 3d73 656c          meta=sel
+00028100: 662e 5f6d 6574 612e 746f 5f73 6572 6965  f._meta.to_serie
+00028110: 7328 292c 0a20 2020 2020 2020 2020 2020  s(),.           
+00028120: 2074 7261 6e73 666f 726d 5f64 6976 6973   transform_divis
+00028130: 696f 6e73 3d46 616c 7365 2c0a 2020 2020  ions=False,.    
+00028140: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
+00028150: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
+00028160: 782c 2075 615f 6172 6773 3d5b 2269 6e64  x, ua_args=["ind
+00028170: 6578 225d 290a 2020 2020 6465 6620 746f  ex"]).    def to
+00028180: 5f66 7261 6d65 2873 656c 662c 2069 6e64  _frame(self, ind
+00028190: 6578 3d54 7275 652c 206e 616d 653d 4e6f  ex=True, name=No
+000281a0: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
+000281b0: 6e6f 7420 696e 6465 783a 0a20 2020 2020  not index:.     
+000281c0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+000281d0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+000281e0: 2829 0a20 2020 2020 2020 2061 7267 7320  ().        args 
+000281f0: 3d20 5b69 6e64 6578 5d20 6966 206e 616d  = [index] if nam
+00028200: 6520 6973 204e 6f6e 6520 656c 7365 205b  e is None else [
+00028210: 696e 6465 782c 206e 616d 655d 0a0a 2020  index, name]..  
+00028220: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00028230: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+00028240: 280a 2020 2020 2020 2020 2020 2020 4d2e  (.            M.
+00028250: 746f 5f66 7261 6d65 2c0a 2020 2020 2020  to_frame,.      
+00028260: 2020 2020 2020 2a61 7267 732c 0a20 2020        *args,.   
+00028270: 2020 2020 2020 2020 206d 6574 613d 7365           meta=se
+00028280: 6c66 2e5f 6d65 7461 2e74 6f5f 6672 616d  lf._meta.to_fram
+00028290: 6528 2a61 7267 7329 2c0a 2020 2020 2020  e(*args),.      
+000282a0: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
+000282b0: 6469 7669 7369 6f6e 733d 4661 6c73 652c  divisions=False,
+000282c0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000282d0: 4069 6e73 6572 745f 6d65 7461 5f70 6172  @insert_meta_par
+000282e0: 616d 5f64 6573 6372 6970 7469 6f6e 2870  am_description(p
+000282f0: 6164 3d31 3229 0a20 2020 2040 6465 7269  ad=12).    @deri
+00028300: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
+00028310: 7829 0a20 2020 2064 6566 206d 6170 2873  x).    def map(s
+00028320: 656c 662c 2061 7267 2c20 6e61 5f61 6374  elf, arg, na_act
+00028330: 696f 6e3d 4e6f 6e65 2c20 6d65 7461 3d6e  ion=None, meta=n
+00028340: 6f5f 6465 6661 756c 742c 2069 735f 6d6f  o_default, is_mo
+00028350: 6e6f 746f 6e69 633d 4661 6c73 6529 3a0a  notonic=False):.
+00028360: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00028370: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
+00028380: 6973 206d 6574 686f 6420 636c 6561 7273  is method clears
+00028390: 2061 6e79 206b 6e6f 776e 2064 6976 6973   any known divis
+000283a0: 696f 6e73 2e0a 0a20 2020 2020 2020 2049  ions...        I
+000283b0: 6620 796f 7572 206d 6170 7069 6e67 2066  f your mapping f
+000283c0: 756e 6374 696f 6e20 6973 206d 6f6e 6f74  unction is monot
+000283d0: 6f6e 6963 616c 6c79 2069 6e63 7265 6173  onically increas
+000283e0: 696e 6720 7468 656e 2075 7365 2060 6973  ing then use `is
+000283f0: 5f6d 6f6e 6f74 6f6e 6963 600a 2020 2020  _monotonic`.    
+00028400: 2020 2020 746f 2061 7070 6c79 2074 6865      to apply the
+00028410: 206d 6170 696e 6720 6675 6e63 7469 6f6e   maping function
+00028420: 2074 6f20 7468 6520 6f6c 6420 6469 7669   to the old divi
+00028430: 7369 6f6e 7320 616e 6420 6173 7369 676e  sions and assign
+00028440: 2074 6865 206e 6577 0a20 2020 2020 2020   the new.       
+00028450: 2064 6976 6973 696f 6e73 2074 6f20 7468   divisions to th
+00028460: 6520 6f75 7470 7574 2e0a 0a20 2020 2020  e output...     
+00028470: 2020 2022 2222 0a20 2020 2020 2020 2061     """.        a
+00028480: 7070 6c69 6564 203d 2073 7570 6572 2829  pplied = super()
+00028490: 2e6d 6170 2861 7267 2c20 6e61 5f61 6374  .map(arg, na_act
+000284a0: 696f 6e3d 6e61 5f61 6374 696f 6e2c 206d  ion=na_action, m
+000284b0: 6574 613d 6d65 7461 290a 2020 2020 2020  eta=meta).      
+000284c0: 2020 6966 2069 735f 6d6f 6e6f 746f 6e69    if is_monotoni
+000284d0: 6320 616e 6420 7365 6c66 2e6b 6e6f 776e  c and self.known
+000284e0: 5f64 6976 6973 696f 6e73 3a0a 2020 2020  _divisions:.    
+000284f0: 2020 2020 2020 2020 6170 706c 6965 642e          applied.
+00028500: 6469 7669 7369 6f6e 7320 3d20 7475 706c  divisions = tupl
+00028510: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00028520: 2020 2070 642e 5365 7269 6573 2873 656c     pd.Series(sel
+00028530: 662e 6469 7669 7369 6f6e 7329 2e6d 6170  f.divisions).map
+00028540: 2861 7267 2c20 6e61 5f61 6374 696f 6e3d  (arg, na_action=
+00028550: 6e61 5f61 6374 696f 6e29 0a20 2020 2020  na_action).     
+00028560: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00028570: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00028580: 2020 2061 7070 6c69 6564 203d 2061 7070     applied = app
+00028590: 6c69 6564 2e63 6c65 6172 5f64 6976 6973  lied.clear_divis
+000285a0: 696f 6e73 2829 0a20 2020 2020 2020 2072  ions().        r
+000285b0: 6574 7572 6e20 6170 706c 6965 640a 0a20  eturn applied.. 
+000285c0: 2020 2069 6620 6e6f 7420 5041 4e44 4153     if not PANDAS
+000285d0: 5f47 545f 3230 303a 0a0a 2020 2020 2020  _GT_200:..      
+000285e0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+000285f0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00028600: 6d28 7064 2e49 6e64 6578 290a 2020 2020  m(pd.Index).    
+00028610: 2020 2020 6465 6620 6973 5f6d 6f6e 6f74      def is_monot
+00028620: 6f6e 6963 2873 656c 6629 3a0a 2020 2020  onic(self):.    
+00028630: 2020 2020 2020 2020 6966 2050 414e 4441          if PANDA
+00028640: 535f 4754 5f31 3530 3a0a 2020 2020 2020  S_GT_150:.      
+00028650: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+00028660: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+00028670: 2020 2020 2020 2020 2020 2020 2022 6973               "is
+00028680: 5f6d 6f6e 6f74 6f6e 6963 2069 7320 6465  _monotonic is de
+00028690: 7072 6563 6174 6564 2061 6e64 2077 696c  precated and wil
+000286a0: 6c20 6265 2072 656d 6f76 6564 2069 6e20  l be removed in 
+000286b0: 6120 6675 7475 7265 2076 6572 7369 6f6e  a future version
+000286c0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+000286d0: 2020 2020 2020 2020 2255 7365 2069 735f          "Use is_
+000286e0: 6d6f 6e6f 746f 6e69 635f 696e 6372 6561  monotonic_increa
+000286f0: 7369 6e67 2069 6e73 7465 6164 2e22 2c0a  sing instead.",.
+00028700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028710: 2020 2020 4675 7475 7265 5761 726e 696e      FutureWarnin
+00028720: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
+00028730: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00028740: 2072 6574 7572 6e20 7375 7065 7228 292e   return super().
+00028750: 6973 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63  is_monotonic_inc
+00028760: 7265 6173 696e 670a 0a20 2020 2040 7072  reasing..    @pr
+00028770: 6f70 6572 7479 0a20 2020 2040 6465 7269  operty.    @deri
+00028780: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
+00028790: 7829 0a20 2020 2064 6566 2069 735f 6d6f  x).    def is_mo
+000287a0: 6e6f 746f 6e69 635f 696e 6372 6561 7369  notonic_increasi
+000287b0: 6e67 2873 656c 6629 3a0a 2020 2020 2020  ng(self):.      
+000287c0: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
+000287d0: 2e69 735f 6d6f 6e6f 746f 6e69 635f 696e  .is_monotonic_in
+000287e0: 6372 6561 7369 6e67 0a0a 2020 2020 4070  creasing..    @p
+000287f0: 726f 7065 7274 790a 2020 2020 4064 6572  roperty.    @der
+00028800: 6976 6564 5f66 726f 6d28 7064 2e49 6e64  ived_from(pd.Ind
+00028810: 6578 290a 2020 2020 6465 6620 6973 5f6d  ex).    def is_m
+00028820: 6f6e 6f74 6f6e 6963 5f64 6563 7265 6173  onotonic_decreas
+00028830: 696e 6728 7365 6c66 293a 0a20 2020 2020  ing(self):.     
+00028840: 2020 2072 6574 7572 6e20 7375 7065 7228     return super(
+00028850: 292e 6973 5f6d 6f6e 6f74 6f6e 6963 5f64  ).is_monotonic_d
+00028860: 6563 7265 6173 696e 670a 0a20 2020 2040  ecreasing..    @
+00028870: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00028880: 496e 6465 7829 0a20 2020 2064 6566 206d  Index).    def m
+00028890: 656d 6f72 795f 7573 6167 6528 7365 6c66  emory_usage(self
+000288a0: 2c20 6465 6570 3d46 616c 7365 293a 0a20  , deep=False):. 
+000288b0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000288c0: 6c66 2e72 6564 7563 7469 6f6e 280a 2020  lf.reduction(.  
+000288d0: 2020 2020 2020 2020 2020 4d2e 6d65 6d6f            M.memo
+000288e0: 7279 5f75 7361 6765 2c0a 2020 2020 2020  ry_usage,.      
+000288f0: 2020 2020 2020 4d2e 7375 6d2c 0a20 2020        M.sum,.   
+00028900: 2020 2020 2020 2020 2063 6875 6e6b 5f6b           chunk_k
+00028910: 7761 7267 733d 7b22 6465 6570 223a 2064  wargs={"deep": d
+00028920: 6565 707d 2c0a 2020 2020 2020 2020 2020  eep},.          
+00028930: 2020 7370 6c69 745f 6576 6572 793d 4661    split_every=Fa
+00028940: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00028950: 2074 6f6b 656e 3d73 656c 662e 5f74 6f6b   token=self._tok
+00028960: 656e 5f70 7265 6669 7820 2b20 226d 656d  en_prefix + "mem
+00028970: 6f72 792d 7573 6167 6522 2c0a 2020 2020  ory-usage",.    
+00028980: 2020 2020 290a 0a0a 636c 6173 7320 4461      )...class Da
+00028990: 7461 4672 616d 6528 5f46 7261 6d65 293a  taFrame(_Frame):
+000289a0: 0a20 2020 2022 2222 0a20 2020 2050 6172  .    """.    Par
+000289b0: 616c 6c65 6c20 5061 6e64 6173 2044 6174  allel Pandas Dat
+000289c0: 6146 7261 6d65 0a0a 2020 2020 446f 206e  aFrame..    Do n
+000289d0: 6f74 2075 7365 2074 6869 7320 636c 6173  ot use this clas
+000289e0: 7320 6469 7265 6374 6c79 2e20 2049 6e73  s directly.  Ins
+000289f0: 7465 6164 2075 7365 2066 756e 6374 696f  tead use functio
+00028a00: 6e73 206c 696b 650a 2020 2020 6060 6464  ns like.    ``dd
+00028a10: 2e72 6561 645f 6373 7660 602c 2060 6064  .read_csv``, ``d
+00028a20: 642e 7265 6164 5f70 6172 7175 6574 6060  d.read_parquet``
+00028a30: 2c20 6f72 2060 6064 642e 6672 6f6d 5f70  , or ``dd.from_p
+00028a40: 616e 6461 7360 602e 0a0a 2020 2020 5061  andas``...    Pa
+00028a50: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+00028a60: 2d2d 2d2d 2d2d 2d0a 2020 2020 6473 6b3a  -------.    dsk:
+00028a70: 2064 6963 740a 2020 2020 2020 2020 5468   dict.        Th
+00028a80: 6520 6461 736b 2067 7261 7068 2074 6f20  e dask graph to 
+00028a90: 636f 6d70 7574 6520 7468 6973 2044 6174  compute this Dat
+00028aa0: 6146 7261 6d65 0a20 2020 206e 616d 653a  aFrame.    name:
+00028ab0: 2073 7472 0a20 2020 2020 2020 2054 6865   str.        The
+00028ac0: 206b 6579 2070 7265 6669 7820 7468 6174   key prefix that
+00028ad0: 2073 7065 6369 6669 6573 2077 6869 6368   specifies which
+00028ae0: 206b 6579 7320 696e 2074 6865 2064 6173   keys in the das
+00028af0: 6b20 636f 6d70 7269 7365 2074 6869 730a  k comprise this.
+00028b00: 2020 2020 2020 2020 7061 7274 6963 756c          particul
+00028b10: 6172 2044 6174 6146 7261 6d65 0a20 2020  ar DataFrame.   
+00028b20: 206d 6574 613a 2070 616e 6461 732e 4461   meta: pandas.Da
+00028b30: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
+00028b40: 416e 2065 6d70 7479 2060 6070 616e 6461  An empty ``panda
+00028b50: 732e 4461 7461 4672 616d 6560 6020 7769  s.DataFrame`` wi
+00028b60: 7468 206e 616d 6573 2c20 6474 7970 6573  th names, dtypes
+00028b70: 2c20 616e 6420 696e 6465 7820 6d61 7463  , and index matc
+00028b80: 6869 6e67 0a20 2020 2020 2020 2074 6865  hing.        the
+00028b90: 2065 7870 6563 7465 6420 6f75 7470 7574   expected output
+00028ba0: 2e0a 2020 2020 6469 7669 7369 6f6e 733a  ..    divisions:
+00028bb0: 2074 7570 6c65 206f 6620 696e 6465 7820   tuple of index 
+00028bc0: 7661 6c75 6573 0a20 2020 2020 2020 2056  values.        V
+00028bd0: 616c 7565 7320 616c 6f6e 6720 7768 6963  alues along whic
+00028be0: 6820 7765 2070 6172 7469 7469 6f6e 206f  h we partition o
+00028bf0: 7572 2062 6c6f 636b 7320 6f6e 2074 6865  ur blocks on the
+00028c00: 2069 6e64 6578 0a20 2020 2022 2222 0a0a   index.    """..
+00028c10: 2020 2020 5f70 6172 7469 7469 6f6e 5f74      _partition_t
+00028c20: 7970 6520 3d20 7064 2e44 6174 6146 7261  ype = pd.DataFra
+00028c30: 6d65 0a20 2020 205f 6973 5f70 6172 7469  me.    _is_parti
+00028c40: 7469 6f6e 5f74 7970 6520 3d20 7374 6174  tion_type = stat
+00028c50: 6963 6d65 7468 6f64 2869 735f 6461 7461  icmethod(is_data
+00028c60: 6672 616d 655f 6c69 6b65 290a 2020 2020  frame_like).    
+00028c70: 5f74 6f6b 656e 5f70 7265 6669 7820 3d20  _token_prefix = 
+00028c80: 2264 6174 6166 7261 6d65 2d22 0a20 2020  "dataframe-".   
+00028c90: 205f 6163 6365 7373 6f72 733a 2043 6c61   _accessors: Cla
+00028ca0: 7373 5661 725b 7365 745b 7374 725d 5d20  ssVar[set[str]] 
+00028cb0: 3d20 7365 7428 290a 0a20 2020 2064 6566  = set()..    def
+00028cc0: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00028cd0: 6473 6b2c 206e 616d 652c 206d 6574 612c  dsk, name, meta,
+00028ce0: 2064 6976 6973 696f 6e73 293a 0a20 2020   divisions):.   
+00028cf0: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
+00028d00: 6e69 745f 5f28 6473 6b2c 206e 616d 652c  nit__(dsk, name,
+00028d10: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
+00028d20: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
+00028d30: 662e 6461 736b 2e6c 6179 6572 735b 6e61  f.dask.layers[na
+00028d40: 6d65 5d2e 636f 6c6c 6563 7469 6f6e 5f61  me].collection_a
+00028d50: 6e6e 6f74 6174 696f 6e73 2069 7320 4e6f  nnotations is No
+00028d60: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00028d70: 7365 6c66 2e64 6173 6b2e 6c61 7965 7273  self.dask.layers
+00028d80: 5b6e 616d 655d 2e63 6f6c 6c65 6374 696f  [name].collectio
+00028d90: 6e5f 616e 6e6f 7461 7469 6f6e 7320 3d20  n_annotations = 
+00028da0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00028db0: 2020 226e 7061 7274 6974 696f 6e73 223a    "npartitions":
+00028dc0: 2073 656c 662e 6e70 6172 7469 7469 6f6e   self.npartition
+00028dd0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00028de0: 2020 2022 636f 6c75 6d6e 7322 3a20 5b63     "columns": [c
+00028df0: 6f6c 2066 6f72 2063 6f6c 2069 6e20 7365  ol for col in se
+00028e00: 6c66 2e63 6f6c 756d 6e73 5d2c 0a20 2020  lf.columns],.   
+00028e10: 2020 2020 2020 2020 2020 2020 2022 7479               "ty
+00028e20: 7065 223a 2074 7970 656e 616d 6528 7479  pe": typename(ty
+00028e30: 7065 2873 656c 6629 292c 0a20 2020 2020  pe(self)),.     
+00028e40: 2020 2020 2020 2020 2020 2022 6461 7461             "data
+00028e50: 6672 616d 655f 7479 7065 223a 2074 7970  frame_type": typ
+00028e60: 656e 616d 6528 7479 7065 2873 656c 662e  ename(type(self.
+00028e70: 5f6d 6574 6129 292c 0a20 2020 2020 2020  _meta)),.       
+00028e80: 2020 2020 2020 2020 2022 7365 7269 6573           "series
+00028e90: 5f64 7479 7065 7322 3a20 7b0a 2020 2020  _dtypes": {.    
+00028ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028eb0: 636f 6c3a 2073 656c 662e 5f6d 6574 615b  col: self._meta[
+00028ec0: 636f 6c5d 2e64 7479 7065 0a20 2020 2020  col].dtype.     
+00028ed0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00028ee0: 6620 6861 7361 7474 7228 7365 6c66 2e5f  f hasattr(self._
+00028ef0: 6d65 7461 5b63 6f6c 5d2c 2022 6474 7970  meta[col], "dtyp
+00028f00: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+00028f10: 2020 2020 2020 2020 656c 7365 204e 6f6e          else Non
+00028f20: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00028f30: 2020 2020 2020 666f 7220 636f 6c20 696e        for col in
+00028f40: 2073 656c 662e 5f6d 6574 612e 636f 6c75   self._meta.colu
+00028f50: 6d6e 730a 2020 2020 2020 2020 2020 2020  mns.            
+00028f60: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+00028f70: 2020 207d 0a20 2020 2020 2020 2065 6c73     }.        els
+00028f80: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00028f90: 656c 662e 6461 736b 2e6c 6179 6572 735b  elf.dask.layers[
+00028fa0: 6e61 6d65 5d2e 636f 6c6c 6563 7469 6f6e  name].collection
+00028fb0: 5f61 6e6e 6f74 6174 696f 6e73 2e75 7064  _annotations.upd
+00028fc0: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
+00028fd0: 2020 2020 207b 0a20 2020 2020 2020 2020       {.         
+00028fe0: 2020 2020 2020 2020 2020 2022 6e70 6172             "npar
+00028ff0: 7469 7469 6f6e 7322 3a20 7365 6c66 2e6e  titions": self.n
+00029000: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
+00029010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029020: 2263 6f6c 756d 6e73 223a 205b 636f 6c20  "columns": [col 
+00029030: 666f 7220 636f 6c20 696e 2073 656c 662e  for col in self.
+00029040: 636f 6c75 6d6e 735d 2c0a 2020 2020 2020  columns],.      
+00029050: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00029060: 7970 6522 3a20 7479 7065 6e61 6d65 2874  ype": typename(t
+00029070: 7970 6528 7365 6c66 2929 2c0a 2020 2020  ype(self)),.    
 00029080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029090: 2273 6572 6965 735f 6474 7970 6573 223a  "series_dtypes":
-000290a0: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-000290b0: 2020 2020 2020 2020 2020 2063 6f6c 3a20             col: 
-000290c0: 7365 6c66 2e5f 6d65 7461 5b63 6f6c 5d2e  self._meta[col].
-000290d0: 6474 7970 650a 2020 2020 2020 2020 2020  dtype.          
-000290e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000290f0: 2068 6173 6174 7472 2873 656c 662e 5f6d   hasattr(self._m
-00029100: 6574 615b 636f 6c5d 2c20 2264 7479 7065  eta[col], "dtype
-00029110: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00029120: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-00029130: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00029140: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00029150: 2063 6f6c 2069 6e20 7365 6c66 2e5f 6d65   col in self._me
-00029160: 7461 2e63 6f6c 756d 6e73 0a20 2020 2020  ta.columns.     
-00029170: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00029180: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00029190: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-000291a0: 290a 0a20 2020 2064 6566 205f 5f61 7272  )..    def __arr
-000291b0: 6179 5f77 7261 705f 5f28 7365 6c66 2c20  ay_wrap__(self, 
-000291c0: 6172 7261 792c 2063 6f6e 7465 7874 3d4e  array, context=N
-000291d0: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
-000291e0: 2069 7369 6e73 7461 6e63 6528 636f 6e74   isinstance(cont
-000291f0: 6578 742c 2074 7570 6c65 2920 616e 6420  ext, tuple) and 
-00029200: 6c65 6e28 636f 6e74 6578 7429 203e 2030  len(context) > 0
-00029210: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00029220: 2069 7369 6e73 7461 6e63 6528 636f 6e74   isinstance(cont
-00029230: 6578 745b 315d 5b30 5d2c 206e 702e 6e64  ext[1][0], np.nd
-00029240: 6172 7261 7929 2061 6e64 2063 6f6e 7465  array) and conte
-00029250: 7874 5b31 5d5b 305d 2e73 6861 7065 203d  xt[1][0].shape =
-00029260: 3d20 2829 3a0a 2020 2020 2020 2020 2020  = ():.          
-00029270: 2020 2020 2020 696e 6465 7820 3d20 4e6f        index = No
-00029280: 6e65 0a20 2020 2020 2020 2020 2020 2065  ne.            e
-00029290: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000292a0: 2020 2020 2069 6e64 6578 203d 2063 6f6e       index = con
-000292b0: 7465 7874 5b31 5d5b 305d 2e69 6e64 6578  text[1][0].index
-000292c0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000292d0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-000292e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000292f0: 696d 706f 7274 2069 6e73 7065 6374 0a0a  import inspect..
-00029300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029310: 6d65 7468 6f64 5f6e 616d 6520 3d20 6622  method_name = f"
-00029320: 607b 696e 7370 6563 742e 7374 6163 6b28  `{inspect.stack(
-00029330: 295b 335d 5b33 5d7d 6022 0a20 2020 2020  )[3][3]}`".     
-00029340: 2020 2020 2020 2065 7863 6570 7420 496e         except In
-00029350: 6465 7845 7272 6f72 3a0a 2020 2020 2020  dexError:.      
-00029360: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-00029370: 5f6e 616d 6520 3d20 2254 6869 7320 6d65  _name = "This me
-00029380: 7468 6f64 220a 0a20 2020 2020 2020 2020  thod"..         
-00029390: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-000293a0: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-000293b0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-000293c0: 7b6d 6574 686f 645f 6e61 6d65 7d20 6973  {method_name} is
-000293d0: 206e 6f74 2069 6d70 6c65 6d65 6e74 6564   not implemented
-000293e0: 2066 6f72 2060 6461 736b 2e64 6174 6166   for `dask.dataf
-000293f0: 7261 6d65 2e44 6174 6146 7261 6d65 602e  rame.DataFrame`.
-00029400: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00029410: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00029420: 6d65 7461 5f66 7261 6d65 5f63 6f6e 7374  meta_frame_const
-00029430: 7275 6374 6f72 2873 656c 6629 2861 7272  ructor(self)(arr
-00029440: 6179 2c20 696e 6465 783d 696e 6465 782c  ay, index=index,
-00029450: 2063 6f6c 756d 6e73 3d73 656c 662e 636f   columns=self.co
-00029460: 6c75 6d6e 7329 0a0a 2020 2020 4070 726f  lumns)..    @pro
-00029470: 7065 7274 790a 2020 2020 6465 6620 6178  perty.    def ax
-00029480: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
-00029490: 2020 7265 7475 726e 205b 7365 6c66 2e69    return [self.i
-000294a0: 6e64 6578 2c20 7365 6c66 2e63 6f6c 756d  ndex, self.colum
-000294b0: 6e73 5d0a 0a20 2020 2040 7072 6f70 6572  ns]..    @proper
-000294c0: 7479 0a20 2020 2064 6566 2063 6f6c 756d  ty.    def colum
-000294d0: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-000294e0: 2020 7265 7475 726e 2073 656c 662e 5f6d    return self._m
-000294f0: 6574 612e 636f 6c75 6d6e 730a 0a20 2020  eta.columns..   
-00029500: 2040 636f 6c75 6d6e 732e 7365 7474 6572   @columns.setter
-00029510: 0a20 2020 2064 6566 2063 6f6c 756d 6e73  .    def columns
-00029520: 2873 656c 662c 2063 6f6c 756d 6e73 293a  (self, columns):
-00029530: 0a20 2020 2020 2020 2072 656e 616d 6564  .        renamed
-00029540: 203d 205f 7265 6e61 6d65 5f64 6173 6b28   = _rename_dask(
-00029550: 7365 6c66 2c20 636f 6c75 6d6e 7329 0a20  self, columns). 
-00029560: 2020 2020 2020 2073 656c 662e 5f6d 6574         self._met
-00029570: 6120 3d20 7265 6e61 6d65 642e 5f6d 6574  a = renamed._met
-00029580: 610a 2020 2020 2020 2020 7365 6c66 2e5f  a.        self._
-00029590: 6e61 6d65 203d 2072 656e 616d 6564 2e5f  name = renamed._
-000295a0: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
-000295b0: 662e 6461 736b 203d 2072 656e 616d 6564  f.dask = renamed
-000295c0: 2e64 6173 6b0a 0a20 2020 2040 7072 6f70  .dask..    @prop
-000295d0: 6572 7479 0a20 2020 2064 6566 2069 6c6f  erty.    def ilo
-000295e0: 6328 7365 6c66 293a 0a20 2020 2020 2020  c(self):.       
-000295f0: 2022 2222 5075 7265 6c79 2069 6e74 6567   """Purely integ
-00029600: 6572 2d6c 6f63 6174 696f 6e20 6261 7365  er-location base
-00029610: 6420 696e 6465 7869 6e67 2066 6f72 2073  d indexing for s
-00029620: 656c 6563 7469 6f6e 2062 7920 706f 7369  election by posi
-00029630: 7469 6f6e 2e0a 0a20 2020 2020 2020 204f  tion...        O
-00029640: 6e6c 7920 696e 6465 7869 6e67 2074 6865  nly indexing the
-00029650: 2063 6f6c 756d 6e20 706f 7369 7469 6f6e   column position
-00029660: 7320 6973 2073 7570 706f 7274 6564 2e20  s is supported. 
-00029670: 5472 7969 6e67 2074 6f20 7365 6c65 6374  Trying to select
-00029680: 0a20 2020 2020 2020 2072 6f77 2070 6f73  .        row pos
-00029690: 6974 696f 6e73 2077 696c 6c20 7261 6973  itions will rais
-000296a0: 6520 6120 5661 6c75 6545 7272 6f72 2e0a  e a ValueError..
-000296b0: 0a20 2020 2020 2020 2053 6565 203a 7265  .        See :re
-000296c0: 663a 6064 6174 6166 7261 6d65 2e69 6e64  f:`dataframe.ind
-000296d0: 6578 696e 6760 2066 6f72 206d 6f72 652e  exing` for more.
-000296e0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-000296f0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-00029700: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
-00029710: 6466 2e69 6c6f 635b 3a2c 205b 322c 2030  df.iloc[:, [2, 0
-00029720: 2c20 315d 5d20 2023 2064 6f63 7465 7374  , 1]]  # doctest
-00029730: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
-00029740: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
-00029750: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
-00029760: 696e 6465 7869 6e67 2069 6d70 6f72 7420  indexing import 
-00029770: 5f69 4c6f 6349 6e64 6578 6572 0a0a 2020  _iLocIndexer..  
-00029780: 2020 2020 2020 2320 466f 7220 6461 7461        # For data
-00029790: 6672 616d 6573 2077 6974 6820 756e 6971  frames with uniq
-000297a0: 7565 2063 6f6c 756d 6e20 6e61 6d65 732c  ue column names,
-000297b0: 2074 6869 7320 7769 6c6c 2062 6520 7472   this will be tr
-000297c0: 616e 7366 6f72 6d65 6420 696e 746f 2061  ansformed into a
-000297d0: 205f 5f67 6574 6974 656d 5f5f 2063 616c   __getitem__ cal
-000297e0: 6c0a 2020 2020 2020 2020 7265 7475 726e  l.        return
-000297f0: 205f 694c 6f63 496e 6465 7865 7228 7365   _iLocIndexer(se
-00029800: 6c66 290a 0a20 2020 2064 6566 205f 5f6c  lf)..    def __l
-00029810: 656e 5f5f 2873 656c 6629 3a0a 2020 2020  en__(self):.    
-00029820: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00029830: 2020 2020 2073 203d 2073 656c 662e 696c       s = self.il
-00029840: 6f63 5b3a 2c20 305d 0a20 2020 2020 2020  oc[:, 0].       
-00029850: 2065 7863 6570 7420 496e 6465 7845 7272   except IndexErr
-00029860: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-00029870: 7265 7475 726e 2073 7570 6572 2829 2e5f  return super()._
-00029880: 5f6c 656e 5f5f 2829 0a20 2020 2020 2020  _len__().       
-00029890: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000298a0: 2020 2072 6574 7572 6e20 6c65 6e28 7329     return len(s)
-000298b0: 0a0a 2020 2020 6465 6620 5f5f 636f 6e74  ..    def __cont
-000298c0: 6169 6e73 5f5f 2873 656c 662c 206b 6579  ains__(self, key
-000298d0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-000298e0: 6e20 6b65 7920 696e 2073 656c 662e 5f6d  n key in self._m
-000298f0: 6574 610a 0a20 2020 2040 7072 6f70 6572  eta..    @proper
-00029900: 7479 0a20 2020 2064 6566 2065 6d70 7479  ty.    def empty
-00029910: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00029920: 2320 5f5f 6765 7461 7474 725f 5f20 7769  # __getattr__ wi
-00029930: 6c6c 2062 6520 6361 6c6c 6564 2061 6674  ll be called aft
-00029940: 6572 2077 6520 7261 6973 6520 7468 6973  er we raise this
-00029950: 2c20 736f 2077 6527 6c6c 2072 6169 7365  , so we'll raise
-00029960: 2069 7420 6167 6169 6e20 6672 6f6d 2074   it again from t
-00029970: 6865 7265 0a20 2020 2020 2020 2072 6169  here.        rai
-00029980: 7365 2041 7474 7269 6275 7465 4e6f 7449  se AttributeNotI
-00029990: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-000299a0: 0a20 2020 2020 2020 2020 2020 2022 4368  .            "Ch
-000299b0: 6563 6b69 6e67 2077 6865 7468 6572 2061  ecking whether a
-000299c0: 2044 6173 6b20 4461 7461 4672 616d 6520   Dask DataFrame 
-000299d0: 6861 7320 616e 7920 726f 7773 206d 6179  has any rows may
-000299e0: 2062 6520 6578 7065 6e73 6976 652e 2022   be expensive. "
-000299f0: 0a20 2020 2020 2020 2020 2020 2022 486f  .            "Ho
-00029a00: 7765 7665 722c 2063 6865 636b 696e 6720  wever, checking 
-00029a10: 7468 6520 6e75 6d62 6572 206f 6620 636f  the number of co
-00029a20: 6c75 6d6e 7320 6973 2066 6173 742e 2022  lumns is fast. "
-00029a30: 0a20 2020 2020 2020 2020 2020 2022 4465  .            "De
-00029a40: 7065 6e64 696e 6720 6f6e 2077 6869 6368  pending on which
-00029a50: 206f 6620 7468 6573 6520 7265 7375 6c74   of these result
-00029a60: 7320 796f 7520 6e65 6564 2c20 7573 6520  s you need, use 
-00029a70: 6569 7468 6572 2022 0a20 2020 2020 2020  either ".       
-00029a80: 2020 2020 2022 606c 656e 2864 662e 696e       "`len(df.in
-00029a90: 6465 7829 203d 3d20 3060 206f 7220 606c  dex) == 0` or `l
-00029aa0: 656e 2864 662e 636f 6c75 6d6e 7329 203d  en(df.columns) =
-00029ab0: 3d20 3060 220a 2020 2020 2020 2020 290a  = 0`".        ).
-00029ac0: 0a20 2020 2064 6566 205f 5f67 6574 6974  .    def __getit
-00029ad0: 656d 5f5f 2873 656c 662c 206b 6579 293a  em__(self, key):
-00029ae0: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
-00029af0: 2267 6574 6974 656d 2d25 7322 2025 2074  "getitem-%s" % t
-00029b00: 6f6b 656e 697a 6528 7365 6c66 2c20 6b65  okenize(self, ke
-00029b10: 7929 0a20 2020 2020 2020 2069 6620 6e70  y).        if np
-00029b20: 2e69 7373 6361 6c61 7228 6b65 7929 206f  .isscalar(key) o
-00029b30: 7220 6973 696e 7374 616e 6365 286b 6579  r isinstance(key
-00029b40: 2c20 2874 7570 6c65 2c20 7374 7229 293a  , (tuple, str)):
-00029b50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00029b60: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
-00029b70: 5f6d 6574 612e 696e 6465 782c 2028 7064  _meta.index, (pd
-00029b80: 2e44 6174 6574 696d 6549 6e64 6578 2c20  .DatetimeIndex, 
-00029b90: 7064 2e50 6572 696f 6449 6e64 6578 2929  pd.PeriodIndex))
-00029ba0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00029bb0: 2020 6966 206b 6579 206e 6f74 2069 6e20    if key not in 
-00029bc0: 7365 6c66 2e5f 6d65 7461 2e63 6f6c 756d  self._meta.colum
-00029bd0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-00029be0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00029bf0: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-00029c00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00029c10: 496e 6465 7869 6e67 2061 2044 6174 6146  Indexing a DataF
-00029c20: 7261 6d65 2077 6974 6820 6120 6461 7465  rame with a date
-00029c30: 7469 6d65 6c69 6b65 2069 6e64 6578 2075  timelike index u
-00029c40: 7369 6e67 2061 2073 696e 676c 6520 220a  sing a single ".
-00029c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c60: 2020 2020 2020 2020 2273 7472 696e 6720          "string 
-00029c70: 746f 2073 6c69 6365 2074 6865 2072 6f77  to slice the row
-00029c80: 732c 206c 696b 6520 6066 7261 6d65 5b73  s, like `frame[s
-00029c90: 7472 696e 675d 602c 2069 7320 6465 7072  tring]`, is depr
-00029ca0: 6563 6174 6564 2022 0a20 2020 2020 2020  ecated ".       
-00029cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029cc0: 2022 616e 6420 7769 6c6c 2062 6520 7265   "and will be re
-00029cd0: 6d6f 7665 6420 696e 2061 2066 7574 7572  moved in a futur
-00029ce0: 6520 7665 7273 696f 6e2e 2055 7365 2060  e version. Use `
-00029cf0: 6672 616d 652e 6c6f 635b 7374 7269 6e67  frame.loc[string
-00029d00: 5d60 2022 0a20 2020 2020 2020 2020 2020  ]` ".           
-00029d10: 2020 2020 2020 2020 2020 2020 2022 696e               "in
-00029d20: 7374 6561 642e 222c 0a20 2020 2020 2020  stead.",.       
-00029d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d40: 2046 7574 7572 6557 6172 6e69 6e67 2c0a   FutureWarning,.
-00029d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d60: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00029d70: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00029d80: 2073 656c 662e 6c6f 635b 6b65 795d 0a0a   self.loc[key]..
-00029d90: 2020 2020 2020 2020 2020 2020 2320 6572              # er
-00029da0: 726f 7220 6973 2072 6169 7365 6420 6672  ror is raised fr
-00029db0: 6f6d 2070 616e 6461 730a 2020 2020 2020  om pandas.      
-00029dc0: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
-00029dd0: 662e 5f6d 6574 615b 5f65 7874 7261 6374  f._meta[_extract
-00029de0: 5f6d 6574 6128 6b65 7929 5d0a 2020 2020  _meta(key)].    
-00029df0: 2020 2020 2020 2020 6473 6b20 3d20 7061          dsk = pa
-00029e00: 7274 6974 696f 6e77 6973 655f 6772 6170  rtitionwise_grap
-00029e10: 6828 6f70 6572 6174 6f72 2e67 6574 6974  h(operator.getit
-00029e20: 656d 2c20 6e61 6d65 2c20 7365 6c66 2c20  em, name, self, 
-00029e30: 6b65 7929 0a20 2020 2020 2020 2020 2020  key).           
-00029e40: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-00029e50: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-00029e60: 6c65 6374 696f 6e73 286e 616d 652c 2064  lections(name, d
-00029e70: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
-00029e80: 3d5b 7365 6c66 5d29 0a20 2020 2020 2020  =[self]).       
-00029e90: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-00029ea0: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
-00029eb0: 206e 616d 652c 206d 6574 612c 2073 656c   name, meta, sel
-00029ec0: 662e 6469 7669 7369 6f6e 7329 0a20 2020  f.divisions).   
-00029ed0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-00029ee0: 616e 6365 286b 6579 2c20 736c 6963 6529  ance(key, slice)
-00029ef0: 3a0a 2020 2020 2020 2020 2020 2020 6672  :.            fr
-00029f00: 6f6d 2070 616e 6461 732e 6170 692e 7479  om pandas.api.ty
-00029f10: 7065 7320 696d 706f 7274 2069 735f 666c  pes import is_fl
-00029f20: 6f61 745f 6474 7970 650a 0a20 2020 2020  oat_dtype..     
-00029f30: 2020 2020 2020 2069 735f 696e 7465 6765         is_intege
-00029f40: 725f 736c 6963 6520 3d20 616e 7928 0a20  r_slice = any(. 
-00029f50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00029f60: 7369 6e73 7461 6e63 6528 692c 2049 6e74  sinstance(i, Int
-00029f70: 6567 7261 6c29 2066 6f72 2069 2069 6e20  egral) for i in 
-00029f80: 286b 6579 2e73 7461 7274 2c20 6b65 792e  (key.start, key.
-00029f90: 7374 6570 2c20 6b65 792e 7374 6f70 290a  step, key.stop).
-00029fa0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00029fb0: 2020 2020 2020 2020 2020 2320 536c 6963            # Slic
-00029fc0: 696e 6720 7769 7468 2069 6e74 6567 6572  ing with integer
-00029fd0: 206c 6162 656c 7320 6973 2061 6c77 6179   labels is alway
-00029fe0: 7320 696c 6f63 2062 6173 6564 2065 7863  s iloc based exc
-00029ff0: 6570 7420 666f 7220 610a 2020 2020 2020  ept for a.      
-0002a000: 2020 2020 2020 2320 666c 6f61 7420 696e        # float in
-0002a010: 6465 7865 7220 666f 7220 736f 6d65 2072  dexer for some r
-0002a020: 6561 736f 6e0a 2020 2020 2020 2020 2020  eason.          
-0002a030: 2020 6966 2069 735f 696e 7465 6765 725f    if is_integer_
-0002a040: 736c 6963 6520 616e 6420 6e6f 7420 6973  slice and not is
-0002a050: 5f66 6c6f 6174 5f64 7479 7065 2873 656c  _float_dtype(sel
-0002a060: 662e 696e 6465 782e 6474 7970 6529 3a0a  f.index.dtype):.
-0002a070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a080: 2320 4e4f 5445 3a20 7468 6973 2061 6c77  # NOTE: this alw
-0002a090: 6179 7320 6661 696c 7320 6375 7272 656e  ays fails curren
-0002a0a0: 746c 792c 2061 7320 696c 6f63 2069 7320  tly, as iloc is 
-0002a0b0: 6d6f 7374 6c79 0a20 2020 2020 2020 2020  mostly.         
-0002a0c0: 2020 2020 2020 2023 2075 6e73 7570 706f         # unsuppo
-0002a0d0: 7274 6564 2c20 6275 7420 7765 2063 616c  rted, but we cal
-0002a0e0: 6c20 6974 2061 6e79 7761 7920 6865 7265  l it anyway here
-0002a0f0: 2066 6f72 2066 7574 7572 652d 7072 6f6f   for future-proo
-0002a100: 6669 6e67 0a20 2020 2020 2020 2020 2020  fing.           
-0002a110: 2020 2020 2023 2061 6e64 2065 7272 6f72       # and error
-0002a120: 2d61 7474 7269 6275 7469 6f6e 2070 7572  -attribution pur
-0002a130: 706f 7365 730a 2020 2020 2020 2020 2020  poses.          
-0002a140: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0002a150: 662e 696c 6f63 5b6b 6579 5d0a 2020 2020  f.iloc[key].    
-0002a160: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002a170: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0002a180: 7475 726e 2073 656c 662e 6c6f 635b 6b65  turn self.loc[ke
-0002a190: 795d 0a0a 2020 2020 2020 2020 6966 2069  y]..        if i
-0002a1a0: 7369 6e73 7461 6e63 6528 6b65 792c 2028  sinstance(key, (
-0002a1b0: 6e70 2e6e 6461 7272 6179 2c20 6c69 7374  np.ndarray, list
-0002a1c0: 2929 206f 7220 280a 2020 2020 2020 2020  )) or (.        
-0002a1d0: 2020 2020 6e6f 7420 6973 5f64 6173 6b5f      not is_dask_
-0002a1e0: 636f 6c6c 6563 7469 6f6e 286b 6579 2920  collection(key) 
-0002a1f0: 616e 6420 2869 735f 7365 7269 6573 5f6c  and (is_series_l
-0002a200: 696b 6528 6b65 7929 206f 7220 6973 5f69  ike(key) or is_i
-0002a210: 6e64 6578 5f6c 696b 6528 6b65 7929 290a  ndex_like(key)).
-0002a220: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-0002a230: 2020 2020 2020 2023 2065 7272 6f72 2069         # error i
-0002a240: 7320 7261 6973 6564 2066 726f 6d20 7061  s raised from pa
-0002a250: 6e64 6173 0a20 2020 2020 2020 2020 2020  ndas.           
-0002a260: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
-0002a270: 7461 5b5f 6578 7472 6163 745f 6d65 7461  ta[_extract_meta
-0002a280: 286b 6579 295d 0a0a 2020 2020 2020 2020  (key)]..        
-0002a290: 2020 2020 6473 6b20 3d20 7061 7274 6974      dsk = partit
-0002a2a0: 696f 6e77 6973 655f 6772 6170 6828 6f70  ionwise_graph(op
-0002a2b0: 6572 6174 6f72 2e67 6574 6974 656d 2c20  erator.getitem, 
-0002a2c0: 6e61 6d65 2c20 7365 6c66 2c20 6b65 7929  name, self, key)
-0002a2d0: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
-0002a2e0: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
-0002a2f0: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
-0002a300: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
-0002a310: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
-0002a320: 6c66 5d29 0a20 2020 2020 2020 2020 2020  lf]).           
-0002a330: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
-0002a340: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
-0002a350: 652c 206d 6574 612c 2073 656c 662e 6469  e, meta, self.di
-0002a360: 7669 7369 6f6e 7329 0a20 2020 2020 2020  visions).       
-0002a370: 2069 6620 6973 696e 7374 616e 6365 286b   if isinstance(k
-0002a380: 6579 2c20 5365 7269 6573 293a 0a20 2020  ey, Series):.   
-0002a390: 2020 2020 2020 2020 2023 2064 6f20 6e6f           # do no
-0002a3a0: 7420 7065 7266 6f72 6d20 6475 6d6d 7920  t perform dummy 
-0002a3b0: 6361 6c63 756c 6174 696f 6e2c 2061 7320  calculation, as 
-0002a3c0: 636f 6c75 6d6e 7320 7769 6c6c 206e 6f74  columns will not
-0002a3d0: 2062 6520 6368 616e 6765 642e 0a20 2020   be changed..   
-0002a3e0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0002a3f0: 2e64 6976 6973 696f 6e73 2021 3d20 6b65  .divisions != ke
-0002a400: 792e 6469 7669 7369 6f6e 733a 0a20 2020  y.divisions:.   
-0002a410: 2020 2020 2020 2020 2020 2020 2066 726f               fro
-0002a420: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-0002a430: 2e6d 756c 7469 2069 6d70 6f72 7420 5f6d  .multi import _m
-0002a440: 6179 6265 5f61 6c69 676e 5f70 6172 7469  aybe_align_parti
-0002a450: 7469 6f6e 730a 0a20 2020 2020 2020 2020  tions..         
-0002a460: 2020 2020 2020 2073 656c 662c 206b 6579         self, key
-0002a470: 203d 205f 6d61 7962 655f 616c 6967 6e5f   = _maybe_align_
-0002a480: 7061 7274 6974 696f 6e73 285b 7365 6c66  partitions([self
-0002a490: 2c20 6b65 795d 290a 2020 2020 2020 2020  , key]).        
-0002a4a0: 2020 2020 6473 6b20 3d20 7061 7274 6974      dsk = partit
-0002a4b0: 696f 6e77 6973 655f 6772 6170 6828 6f70  ionwise_graph(op
-0002a4c0: 6572 6174 6f72 2e67 6574 6974 656d 2c20  erator.getitem, 
-0002a4d0: 6e61 6d65 2c20 7365 6c66 2c20 6b65 7929  name, self, key)
-0002a4e0: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
-0002a4f0: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
-0002a500: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
-0002a510: 696f 6e73 286e 616d 652c 2064 736b 2c20  ions(name, dsk, 
-0002a520: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
-0002a530: 6c66 2c20 6b65 795d 290a 2020 2020 2020  lf, key]).      
-0002a540: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0002a550: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
-0002a560: 2c20 6e61 6d65 2c20 7365 6c66 2c20 7365  , name, self, se
-0002a570: 6c66 2e64 6976 6973 696f 6e73 290a 2020  lf.divisions).  
-0002a580: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0002a590: 6e63 6528 6b65 792c 2044 6174 6146 7261  nce(key, DataFra
-0002a5a0: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-0002a5b0: 2072 6574 7572 6e20 7365 6c66 2e77 6865   return self.whe
-0002a5c0: 7265 286b 6579 2c20 6e70 2e6e 616e 290a  re(key, np.nan).
-0002a5d0: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
-0002a5e0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0002a5f0: 6f72 286b 6579 290a 0a20 2020 2064 6566  or(key)..    def
-0002a600: 205f 5f73 6574 6974 656d 5f5f 2873 656c   __setitem__(sel
-0002a610: 662c 206b 6579 2c20 7661 6c75 6529 3a0a  f, key, value):.
-0002a620: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0002a630: 7461 6e63 6528 6b65 792c 2028 7475 706c  tance(key, (tupl
-0002a640: 652c 206c 6973 7429 2920 616e 6420 6973  e, list)) and is
-0002a650: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
-0002a660: 4461 7461 4672 616d 6529 3a0a 2020 2020  DataFrame):.    
-0002a670: 2020 2020 2020 2020 6466 203d 2073 656c          df = sel
-0002a680: 662e 6173 7369 676e 282a 2a7b 6b3a 2076  f.assign(**{k: v
-0002a690: 616c 7565 5b63 5d20 666f 7220 6b2c 2063  alue[c] for k, c
-0002a6a0: 2069 6e20 7a69 7028 6b65 792c 2076 616c   in zip(key, val
-0002a6b0: 7565 2e63 6f6c 756d 6e73 297d 290a 0a20  ue.columns)}).. 
-0002a6c0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-0002a6d0: 7374 616e 6365 286b 6579 2c20 7064 2e49  stance(key, pd.I
-0002a6e0: 6e64 6578 2920 616e 6420 6e6f 7420 6973  ndex) and not is
-0002a6f0: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
-0002a700: 4461 7461 4672 616d 6529 3a0a 2020 2020  DataFrame):.    
-0002a710: 2020 2020 2020 2020 6b65 7920 3d20 6c69          key = li
-0002a720: 7374 286b 6579 290a 2020 2020 2020 2020  st(key).        
-0002a730: 2020 2020 6466 203d 2073 656c 662e 6173      df = self.as
-0002a740: 7369 676e 282a 2a7b 6b3a 2076 616c 7565  sign(**{k: value
-0002a750: 2066 6f72 206b 2069 6e20 6b65 797d 290a   for k in key}).
-0002a760: 2020 2020 2020 2020 656c 6966 2028 0a20          elif (. 
-0002a770: 2020 2020 2020 2020 2020 2069 735f 6461             is_da
-0002a780: 7461 6672 616d 655f 6c69 6b65 286b 6579  taframe_like(key
-0002a790: 290a 2020 2020 2020 2020 2020 2020 6f72  ).            or
-0002a7a0: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
-0002a7b0: 6b65 7929 0a20 2020 2020 2020 2020 2020  key).           
-0002a7c0: 206f 7220 6973 696e 7374 616e 6365 286b   or isinstance(k
-0002a7d0: 6579 2c20 2844 6174 6146 7261 6d65 2c20  ey, (DataFrame, 
-0002a7e0: 5365 7269 6573 2929 0a20 2020 2020 2020  Series)).       
-0002a7f0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-0002a800: 6466 203d 2073 656c 662e 7768 6572 6528  df = self.where(
-0002a810: 7e6b 6579 2c20 7661 6c75 6529 0a20 2020  ~key, value).   
-0002a820: 2020 2020 2065 6c69 6620 6e6f 7420 6973       elif not is
-0002a830: 696e 7374 616e 6365 286b 6579 2c20 7374  instance(key, st
-0002a840: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-0002a850: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-0002a860: 6e74 6564 4572 726f 7228 6622 4974 656d  ntedError(f"Item
-0002a870: 2061 7373 6967 6e6d 656e 7420 7769 7468   assignment with
-0002a880: 207b 7479 7065 286b 6579 297d 206e 6f74   {type(key)} not
-0002a890: 2073 7570 706f 7274 6564 2229 0a20 2020   supported").   
-0002a8a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0002a8b0: 2020 2020 2020 2064 6620 3d20 7365 6c66         df = self
-0002a8c0: 2e61 7373 6967 6e28 2a2a 7b6b 6579 3a20  .assign(**{key: 
-0002a8d0: 7661 6c75 657d 290a 0a20 2020 2020 2020  value})..       
-0002a8e0: 2073 656c 662e 6461 736b 203d 2064 662e   self.dask = df.
-0002a8f0: 6461 736b 0a20 2020 2020 2020 2073 656c  dask.        sel
-0002a900: 662e 5f6e 616d 6520 3d20 6466 2e5f 6e61  f._name = df._na
-0002a910: 6d65 0a20 2020 2020 2020 2073 656c 662e  me.        self.
-0002a920: 5f6d 6574 6120 3d20 6466 2e5f 6d65 7461  _meta = df._meta
-0002a930: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
-0002a940: 6976 6973 696f 6e73 203d 2064 662e 6469  ivisions = df.di
-0002a950: 7669 7369 6f6e 730a 0a20 2020 2064 6566  visions..    def
-0002a960: 205f 5f64 656c 6974 656d 5f5f 2873 656c   __delitem__(sel
-0002a970: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
-0002a980: 2072 6573 756c 7420 3d20 7365 6c66 2e64   result = self.d
-0002a990: 726f 7028 5b6b 6579 5d2c 2061 7869 733d  rop([key], axis=
-0002a9a0: 3129 0a20 2020 2020 2020 2073 656c 662e  1).        self.
-0002a9b0: 6461 736b 203d 2072 6573 756c 742e 6461  dask = result.da
-0002a9c0: 736b 0a20 2020 2020 2020 2073 656c 662e  sk.        self.
-0002a9d0: 5f6e 616d 6520 3d20 7265 7375 6c74 2e5f  _name = result._
-0002a9e0: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
-0002a9f0: 662e 5f6d 6574 6120 3d20 7265 7375 6c74  f._meta = result
-0002aa00: 2e5f 6d65 7461 0a0a 2020 2020 6465 6620  ._meta..    def 
-0002aa10: 5f5f 7365 7461 7474 725f 5f28 7365 6c66  __setattr__(self
-0002aa20: 2c20 6b65 792c 2076 616c 7565 293a 0a20  , key, value):. 
-0002aa30: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0002aa40: 2020 2020 2020 2020 636f 6c75 6d6e 7320          columns 
-0002aa50: 3d20 6f62 6a65 6374 2e5f 5f67 6574 6174  = object.__getat
-0002aa60: 7472 6962 7574 655f 5f28 7365 6c66 2c20  tribute__(self, 
-0002aa70: 225f 6d65 7461 2229 2e63 6f6c 756d 6e73  "_meta").columns
-0002aa80: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0002aa90: 4174 7472 6962 7574 6545 7272 6f72 3a0a  AttributeError:.
-0002aaa0: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-0002aab0: 6d6e 7320 3d20 2829 0a0a 2020 2020 2020  mns = ()..      
-0002aac0: 2020 2320 6578 636c 7564 6520 7072 6f74    # exclude prot
-0002aad0: 6563 7465 6420 6174 7472 6962 7574 6573  ected attributes
-0002aae0: 2066 726f 6d20 7365 7469 7465 6d0a 2020   from setitem.  
-0002aaf0: 2020 2020 2020 6966 206b 6579 2069 6e20        if key in 
-0002ab00: 636f 6c75 6d6e 7320 616e 6420 6b65 7920  columns and key 
-0002ab10: 6e6f 7420 696e 205b 2264 6976 6973 696f  not in ["divisio
-0002ab20: 6e73 222c 2022 6461 736b 222c 2022 5f6e  ns", "dask", "_n
-0002ab30: 616d 6522 2c20 225f 6d65 7461 225d 3a0a  ame", "_meta"]:.
-0002ab40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002ab50: 5b6b 6579 5d20 3d20 7661 6c75 650a 2020  [key] = value.  
-0002ab60: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002ab70: 2020 2020 2020 2020 6f62 6a65 6374 2e5f          object._
-0002ab80: 5f73 6574 6174 7472 5f5f 2873 656c 662c  _setattr__(self,
-0002ab90: 206b 6579 2c20 7661 6c75 6529 0a0a 2020   key, value)..  
-0002aba0: 2020 6465 6620 5f5f 6765 7461 7474 725f    def __getattr_
-0002abb0: 5f28 7365 6c66 2c20 6b65 7929 3a0a 2020  _(self, key):.  
-0002abc0: 2020 2020 2020 6966 206b 6579 2069 6e20        if key in 
-0002abd0: 7365 6c66 2e63 6f6c 756d 6e73 3a0a 2020  self.columns:.  
-0002abe0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002abf0: 2073 656c 665b 6b65 795d 0a20 2020 2020   self[key].     
-0002ac00: 2020 2065 6c69 6620 6b65 7920 3d3d 2022     elif key == "
-0002ac10: 656d 7074 7922 3a0a 2020 2020 2020 2020  empty":.        
-0002ac20: 2020 2020 2320 7365 6c66 2e65 6d70 7479      # self.empty
-0002ac30: 2072 6169 7365 7320 4174 7472 6962 7574   raises Attribut
-0002ac40: 654e 6f74 496d 706c 656d 656e 7465 6445  eNotImplementedE
-0002ac50: 7272 6f72 2c20 7768 6963 6820 696e 636c  rror, which incl
-0002ac60: 7564 6573 0a20 2020 2020 2020 2020 2020  udes.           
-0002ac70: 2023 2041 7474 7269 6275 7465 4572 726f   # AttributeErro
-0002ac80: 722c 2077 6869 6368 206d 6561 6e73 2077  r, which means w
-0002ac90: 6520 656e 6420 7570 2068 6572 6520 696e  e end up here in
-0002aca0: 2073 656c 662e 5f5f 6765 7461 7474 725f   self.__getattr_
-0002acb0: 5f2c 0a20 2020 2020 2020 2020 2020 2023  _,.            #
-0002acc0: 2062 6563 6175 7365 2044 6174 6146 7261   because DataFra
-0002acd0: 6d65 2e5f 5f67 6574 6174 7472 6962 7574  me.__getattribut
-0002ace0: 655f 5f20 646f 6573 6e27 7420 7468 696e  e__ doesn't thin
-0002acf0: 6b20 7468 6520 6174 7472 6962 7574 6520  k the attribute 
-0002ad00: 6578 6973 7473 0a20 2020 2020 2020 2020  exists.         
-0002ad10: 2020 2023 2061 6e64 2075 7365 7320 5f5f     # and uses __
-0002ad20: 6765 7461 7474 725f 5f20 6173 2074 6865  getattr__ as the
-0002ad30: 2066 616c 6c62 6163 6b2e 2053 6f2c 2067   fallback. So, g
-0002ad40: 6574 2060 7365 6c66 2e65 6d70 7479 6020  et `self.empty` 
-0002ad50: 6d6f 7265 0a20 2020 2020 2020 2020 2020  more.           
-0002ad60: 2023 2066 6f72 6365 6675 6c6c 7920 7669   # forcefully vi
-0002ad70: 6120 6f62 6a65 6374 2e5f 5f67 6574 6174  a object.__getat
-0002ad80: 7472 6962 7574 655f 5f20 746f 2072 6169  tribute__ to rai
-0002ad90: 7365 2069 6e66 6f72 6d61 7469 7665 2065  se informative e
-0002ada0: 7272 6f72 2e0a 2020 2020 2020 2020 2020  rror..          
-0002adb0: 2020 6f62 6a65 6374 2e5f 5f67 6574 6174    object.__getat
-0002adc0: 7472 6962 7574 655f 5f28 7365 6c66 2c20  tribute__(self, 
-0002add0: 6b65 7929 0a20 2020 2020 2020 2065 6c73  key).        els
-0002ade0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0002adf0: 6169 7365 2041 7474 7269 6275 7465 4572  aise AttributeEr
-0002ae00: 726f 7228 2227 4461 7461 4672 616d 6527  ror("'DataFrame'
-0002ae10: 206f 626a 6563 7420 6861 7320 6e6f 2061   object has no a
-0002ae20: 7474 7269 6275 7465 2025 7222 2025 206b  ttribute %r" % k
-0002ae30: 6579 290a 0a20 2020 2064 6566 205f 5f64  ey)..    def __d
-0002ae40: 6972 5f5f 2873 656c 6629 3a0a 2020 2020  ir__(self):.    
-0002ae50: 2020 2020 6f20 3d20 7365 7428 6469 7228      o = set(dir(
-0002ae60: 7479 7065 2873 656c 6629 2929 0a20 2020  type(self))).   
-0002ae70: 2020 2020 206f 2e75 7064 6174 6528 7365       o.update(se
-0002ae80: 6c66 2e5f 5f64 6963 745f 5f29 0a20 2020  lf.__dict__).   
-0002ae90: 2020 2020 206f 2e75 7064 6174 6528 6320       o.update(c 
-0002aea0: 666f 7220 6320 696e 2073 656c 662e 636f  for c in self.co
-0002aeb0: 6c75 6d6e 7320 6966 2028 6973 696e 7374  lumns if (isinst
-0002aec0: 616e 6365 2863 2c20 7374 7229 2061 6e64  ance(c, str) and
-0002aed0: 2063 2e69 7369 6465 6e74 6966 6965 7228   c.isidentifier(
-0002aee0: 2929 290a 2020 2020 2020 2020 7265 7475  ))).        retu
-0002aef0: 726e 206c 6973 7428 6f29 0a0a 2020 2020  rn list(o)..    
-0002af00: 6465 6620 5f5f 6974 6572 5f5f 2873 656c  def __iter__(sel
-0002af10: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-0002af20: 726e 2069 7465 7228 7365 6c66 2e5f 6d65  rn iter(self._me
-0002af30: 7461 290a 0a20 2020 2064 6566 205f 6970  ta)..    def _ip
-0002af40: 7974 686f 6e5f 6b65 795f 636f 6d70 6c65  ython_key_comple
-0002af50: 7469 6f6e 735f 2873 656c 6629 3a0a 2020  tions_(self):.  
-0002af60: 2020 2020 2020 7265 7475 726e 206d 6574        return met
-0002af70: 686f 6473 2e74 6f6c 6973 7428 7365 6c66  hods.tolist(self
-0002af80: 2e63 6f6c 756d 6e73 290a 0a20 2020 2040  .columns)..    @
-0002af90: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0002afa0: 206e 6469 6d28 7365 6c66 293a 0a20 2020   ndim(self):.   
-0002afb0: 2020 2020 2022 2222 5265 7475 726e 2064       """Return d
-0002afc0: 696d 656e 7369 6f6e 616c 6974 7922 2222  imensionality"""
-0002afd0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002afe0: 320a 0a20 2020 2040 7072 6f70 6572 7479  2..    @property
-0002aff0: 0a20 2020 2064 6566 2073 6861 7065 2873  .    def shape(s
-0002b000: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0002b010: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-0002b020: 2061 2074 7570 6c65 2072 6570 7265 7365   a tuple represe
-0002b030: 6e74 696e 6720 7468 6520 6469 6d65 6e73  nting the dimens
-0002b040: 696f 6e61 6c69 7479 206f 6620 7468 6520  ionality of the 
-0002b050: 4461 7461 4672 616d 652e 0a0a 2020 2020  DataFrame...    
-0002b060: 2020 2020 5468 6520 6e75 6d62 6572 206f      The number o
-0002b070: 6620 726f 7773 2069 7320 6120 4465 6c61  f rows is a Dela
-0002b080: 7965 6420 7265 7375 6c74 2e20 5468 6520  yed result. The 
-0002b090: 6e75 6d62 6572 206f 6620 636f 6c75 6d6e  number of column
-0002b0a0: 730a 2020 2020 2020 2020 6973 2061 2063  s.        is a c
-0002b0b0: 6f6e 6372 6574 6520 696e 7465 6765 722e  oncrete integer.
-0002b0c0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-0002b0d0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-0002b0e0: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
-0002b0f0: 6466 2e73 697a 6520 2023 2064 6f63 7465  df.size  # docte
-0002b100: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
-0002b110: 2020 2844 656c 6179 6564 2827 696e 742d    (Delayed('int-
-0002b120: 3037 6630 3630 3735 2d35 6563 632d 3464  07f06075-5ecc-4d
-0002b130: 3737 2d38 3137 652d 3633 6336 3961 3931  77-817e-63c69a91
-0002b140: 3838 6138 2729 2c20 3229 0a20 2020 2020  88a8'), 2).     
-0002b150: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-0002b160: 6f6c 5f73 697a 6520 3d20 6c65 6e28 7365  ol_size = len(se
-0002b170: 6c66 2e63 6f6c 756d 6e73 290a 2020 2020  lf.columns).    
-0002b180: 2020 2020 6966 2063 6f6c 5f73 697a 6520      if col_size 
-0002b190: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-0002b1a0: 2020 7265 7475 726e 2028 7365 6c66 2e69    return (self.i
-0002b1b0: 6e64 6578 2e73 6861 7065 5b30 5d2c 2030  ndex.shape[0], 0
-0002b1c0: 290a 2020 2020 2020 2020 726f 775f 7369  ).        row_si
-0002b1d0: 7a65 203d 2064 656c 6179 6564 2869 6e74  ze = delayed(int
-0002b1e0: 2928 7365 6c66 2e73 697a 6520 2f20 636f  )(self.size / co
-0002b1f0: 6c5f 7369 7a65 290a 2020 2020 2020 2020  l_size).        
-0002b200: 7265 7475 726e 2028 726f 775f 7369 7a65  return (row_size
-0002b210: 2c20 636f 6c5f 7369 7a65 290a 0a20 2020  , col_size)..   
-0002b220: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0002b230: 6566 2064 7479 7065 7328 7365 6c66 293a  ef dtypes(self):
-0002b240: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-0002b250: 726e 2064 6174 6120 7479 7065 7322 2222  rn data types"""
-0002b260: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002b270: 7365 6c66 2e5f 6d65 7461 2e64 7479 7065  self._meta.dtype
-0002b280: 730a 0a20 2020 2040 6465 7269 7665 645f  s..    @derived_
-0002b290: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0002b2a0: 6529 0a20 2020 2064 6566 2067 6574 5f64  e).    def get_d
-0002b2b0: 7479 7065 5f63 6f75 6e74 7328 7365 6c66  type_counts(self
-0002b2c0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0002b2d0: 6e20 7365 6c66 2e5f 6d65 7461 2e67 6574  n self._meta.get
-0002b2e0: 5f64 7479 7065 5f63 6f75 6e74 7328 290a  _dtype_counts().
-0002b2f0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0002b300: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0002b310: 0a20 2020 2064 6566 2067 6574 5f66 7479  .    def get_fty
-0002b320: 7065 5f63 6f75 6e74 7328 7365 6c66 293a  pe_counts(self):
-0002b330: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002b340: 7365 6c66 2e5f 6d65 7461 2e67 6574 5f66  self._meta.get_f
-0002b350: 7479 7065 5f63 6f75 6e74 7328 290a 0a20  type_counts().. 
-0002b360: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0002b370: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0002b380: 2020 2064 6566 2073 656c 6563 745f 6474     def select_dt
-0002b390: 7970 6573 2873 656c 662c 2069 6e63 6c75  ypes(self, inclu
-0002b3a0: 6465 3d4e 6f6e 652c 2065 7863 6c75 6465  de=None, exclude
-0002b3b0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-0002b3c0: 6373 203d 2073 656c 662e 5f6d 6574 612e  cs = self._meta.
-0002b3d0: 7365 6c65 6374 5f64 7479 7065 7328 696e  select_dtypes(in
-0002b3e0: 636c 7564 653d 696e 636c 7564 652c 2065  clude=include, e
-0002b3f0: 7863 6c75 6465 3d65 7863 6c75 6465 292e  xclude=exclude).
-0002b400: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
-0002b410: 7265 7475 726e 2073 656c 665b 6c69 7374  return self[list
-0002b420: 2863 7329 5d0a 0a20 2020 2064 6566 2073  (cs)]..    def s
-0002b430: 6f72 745f 7661 6c75 6573 280a 2020 2020  ort_values(.    
-0002b440: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0002b450: 2020 6279 3a20 7374 7220 7c20 6c69 7374    by: str | list
-0002b460: 5b73 7472 5d2c 0a20 2020 2020 2020 206e  [str],.        n
-0002b470: 7061 7274 6974 696f 6e73 3a20 696e 7420  partitions: int 
-0002b480: 7c20 4c69 7465 7261 6c5b 2261 7574 6f22  | Literal["auto"
-0002b490: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
-0002b4a0: 0a20 2020 2020 2020 2061 7363 656e 6469  .        ascendi
-0002b4b0: 6e67 3a20 626f 6f6c 203d 2054 7275 652c  ng: bool = True,
-0002b4c0: 0a20 2020 2020 2020 206e 615f 706f 7369  .        na_posi
-0002b4d0: 7469 6f6e 3a20 4c69 7465 7261 6c5b 2266  tion: Literal["f
-0002b4e0: 6972 7374 225d 207c 204c 6974 6572 616c  irst"] | Literal
-0002b4f0: 5b22 6c61 7374 225d 203d 2022 6c61 7374  ["last"] = "last
-0002b500: 222c 0a20 2020 2020 2020 2073 6f72 745f  ",.        sort_
-0002b510: 6675 6e63 7469 6f6e 3a20 4361 6c6c 6162  function: Callab
-0002b520: 6c65 5b5b 7064 2e44 6174 6146 7261 6d65  le[[pd.DataFrame
-0002b530: 5d2c 2070 642e 4461 7461 4672 616d 655d  ], pd.DataFrame]
-0002b540: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
-0002b550: 2020 2020 2020 2020 736f 7274 5f66 756e          sort_fun
-0002b560: 6374 696f 6e5f 6b77 6172 6773 3a20 4d61  ction_kwargs: Ma
-0002b570: 7070 696e 675b 7374 722c 2041 6e79 5d20  pping[str, Any] 
-0002b580: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-0002b590: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-0002b5a0: 0a20 2020 2029 202d 3e20 4461 7461 4672  .    ) -> DataFr
-0002b5b0: 616d 653a 0a20 2020 2020 2020 2022 2222  ame:.        """
-0002b5c0: 536f 7274 2074 6865 2064 6174 6173 6574  Sort the dataset
-0002b5d0: 2062 7920 6120 7369 6e67 6c65 2063 6f6c   by a single col
-0002b5e0: 756d 6e2e 0a0a 2020 2020 2020 2020 536f  umn...        So
-0002b5f0: 7274 696e 6720 6120 7061 7261 6c6c 656c  rting a parallel
-0002b600: 2064 6174 6173 6574 2072 6571 7569 7265   dataset require
-0002b610: 7320 6578 7065 6e73 6976 6520 7368 7566  s expensive shuf
-0002b620: 666c 6573 2061 6e64 2069 7320 6765 6e65  fles and is gene
-0002b630: 7261 6c6c 790a 2020 2020 2020 2020 6e6f  rally.        no
-0002b640: 7420 7265 636f 6d6d 656e 6465 642e 2053  t recommended. S
-0002b650: 6565 2060 6073 6574 5f69 6e64 6578 6060  ee ``set_index``
-0002b660: 2066 6f72 2069 6d70 6c65 6d65 6e74 6174   for implementat
-0002b670: 696f 6e20 6465 7461 696c 732e 0a0a 2020  ion details...  
-0002b680: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0002b690: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0002b6a0: 2d2d 2d0a 2020 2020 2020 2020 6279 3a20  ---.        by: 
-0002b6b0: 7374 7220 6f72 206c 6973 745b 7374 725d  str or list[str]
-0002b6c0: 0a20 2020 2020 2020 2020 2020 2043 6f6c  .            Col
-0002b6d0: 756d 6e28 7329 2074 6f20 736f 7274 2062  umn(s) to sort b
-0002b6e0: 792e 0a20 2020 2020 2020 206e 7061 7274  y..        npart
-0002b6f0: 6974 696f 6e73 3a20 696e 742c 204e 6f6e  itions: int, Non
-0002b700: 652c 206f 7220 2761 7574 6f27 0a20 2020  e, or 'auto'.   
-0002b710: 2020 2020 2020 2020 2054 6865 2069 6465           The ide
-0002b720: 616c 206e 756d 6265 7220 6f66 206f 7574  al number of out
-0002b730: 7075 7420 7061 7274 6974 696f 6e73 2e20  put partitions. 
-0002b740: 4966 204e 6f6e 652c 2075 7365 2074 6865  If None, use the
-0002b750: 2073 616d 6520 6173 0a20 2020 2020 2020   same as.       
-0002b760: 2020 2020 2074 6865 2069 6e70 7574 2e20       the input. 
-0002b770: 4966 2027 6175 746f 2720 7468 656e 2064  If 'auto' then d
-0002b780: 6563 6964 6520 6279 206d 656d 6f72 7920  ecide by memory 
-0002b790: 7573 652e 0a20 2020 2020 2020 2061 7363  use..        asc
-0002b7a0: 656e 6469 6e67 3a20 626f 6f6c 2c20 6f70  ending: bool, op
-0002b7b0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0002b7c0: 2020 2053 6f72 7420 6173 6365 6e64 696e     Sort ascendin
-0002b7d0: 6720 7673 2e20 6465 7363 656e 6469 6e67  g vs. descending
-0002b7e0: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
-0002b7f0: 6661 756c 7473 2074 6f20 5472 7565 2e0a  faults to True..
-0002b800: 2020 2020 2020 2020 6e61 5f70 6f73 6974          na_posit
-0002b810: 696f 6e3a 207b 276c 6173 7427 2c20 2766  ion: {'last', 'f
-0002b820: 6972 7374 277d 2c20 6f70 7469 6f6e 616c  irst'}, optional
-0002b830: 0a20 2020 2020 2020 2020 2020 2050 7574  .            Put
-0002b840: 7320 4e61 4e73 2061 7420 7468 6520 6265  s NaNs at the be
-0002b850: 6769 6e6e 696e 6720 6966 2027 6669 7273  ginning if 'firs
-0002b860: 7427 2c20 7075 7473 204e 614e 2061 7420  t', puts NaN at 
-0002b870: 7468 6520 656e 6420 6966 2027 6c61 7374  the end if 'last
-0002b880: 272e 0a20 2020 2020 2020 2020 2020 2044  '..            D
-0002b890: 6566 6175 6c74 7320 746f 2027 6c61 7374  efaults to 'last
-0002b8a0: 272e 0a20 2020 2020 2020 2073 6f72 745f  '..        sort_
-0002b8b0: 6675 6e63 7469 6f6e 3a20 6675 6e63 7469  function: functi
-0002b8c0: 6f6e 2c20 6f70 7469 6f6e 616c 0a20 2020  on, optional.   
-0002b8d0: 2020 2020 2020 2020 2053 6f72 7469 6e67           Sorting
-0002b8e0: 2066 756e 6374 696f 6e20 746f 2075 7365   function to use
-0002b8f0: 2077 6865 6e20 736f 7274 696e 6720 756e   when sorting un
-0002b900: 6465 726c 7969 6e67 2070 6172 7469 7469  derlying partiti
-0002b910: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
-0002b920: 2049 6620 4e6f 6e65 2c20 6465 6661 756c   If None, defaul
-0002b930: 7473 2074 6f20 6060 4d2e 736f 7274 5f76  ts to ``M.sort_v
-0002b940: 616c 7565 7360 6020 2874 6865 2070 6172  alues`` (the par
-0002b950: 7469 7469 6f6e 206c 6962 7261 7279 2773  tition library's
-0002b960: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
-0002b970: 6c65 6d65 6e74 6174 696f 6e20 6f66 2060  lementation of `
-0002b980: 6073 6f72 745f 7661 6c75 6573 6060 292e  `sort_values``).
-0002b990: 0a20 2020 2020 2020 2073 6f72 745f 6675  .        sort_fu
-0002b9a0: 6e63 7469 6f6e 5f6b 7761 7267 733a 2064  nction_kwargs: d
-0002b9b0: 6963 742c 206f 7074 696f 6e61 6c0a 2020  ict, optional.  
-0002b9c0: 2020 2020 2020 2020 2020 4164 6469 7469            Additi
-0002b9d0: 6f6e 616c 206b 6579 776f 7264 2061 7267  onal keyword arg
-0002b9e0: 756d 656e 7473 2074 6f20 7061 7373 2074  uments to pass t
-0002b9f0: 6f20 7468 6520 7061 7274 6974 696f 6e20  o the partition 
-0002ba00: 736f 7274 696e 6720 6675 6e63 7469 6f6e  sorting function
-0002ba10: 2e0a 2020 2020 2020 2020 2020 2020 4279  ..            By
-0002ba20: 2064 6566 6175 6c74 2c20 6060 6279 6060   default, ``by``
-0002ba30: 2c20 6060 6173 6365 6e64 696e 6760 602c  , ``ascending``,
-0002ba40: 2061 6e64 2060 606e 615f 706f 7369 7469   and ``na_positi
-0002ba50: 6f6e 6060 2061 7265 2070 726f 7669 6465  on`` are provide
-0002ba60: 642e 0a0a 2020 2020 2020 2020 4578 616d  d...        Exam
-0002ba70: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-0002ba80: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
-0002ba90: 3e20 6466 3220 3d20 6466 2e73 6f72 745f  > df2 = df.sort_
-0002baa0: 7661 6c75 6573 2827 7827 2920 2023 2064  values('x')  # d
-0002bab0: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
-0002bac0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0002bad0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-0002bae0: 6672 616d 652e 7368 7566 666c 6520 696d  frame.shuffle im
-0002baf0: 706f 7274 2073 6f72 745f 7661 6c75 6573  port sort_values
-0002bb00: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0002bb10: 2073 6f72 745f 7661 6c75 6573 280a 2020   sort_values(.  
-0002bb20: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-0002bb30: 2020 2020 2020 2020 2020 2020 6279 2c0a              by,.
-0002bb40: 2020 2020 2020 2020 2020 2020 6173 6365              asce
-0002bb50: 6e64 696e 673d 6173 6365 6e64 696e 672c  nding=ascending,
-0002bb60: 0a20 2020 2020 2020 2020 2020 206e 7061  .            npa
-0002bb70: 7274 6974 696f 6e73 3d6e 7061 7274 6974  rtitions=npartit
-0002bb80: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-0002bb90: 2020 6e61 5f70 6f73 6974 696f 6e3d 6e61    na_position=na
-0002bba0: 5f70 6f73 6974 696f 6e2c 0a20 2020 2020  _position,.     
-0002bbb0: 2020 2020 2020 2073 6f72 745f 6675 6e63         sort_func
-0002bbc0: 7469 6f6e 3d73 6f72 745f 6675 6e63 7469  tion=sort_functi
-0002bbd0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0002bbe0: 736f 7274 5f66 756e 6374 696f 6e5f 6b77  sort_function_kw
-0002bbf0: 6172 6773 3d73 6f72 745f 6675 6e63 7469  args=sort_functi
-0002bc00: 6f6e 5f6b 7761 7267 732c 0a20 2020 2020  on_kwargs,.     
-0002bc10: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-0002bc20: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0002bc30: 6465 6620 7365 745f 696e 6465 7828 0a20  def set_index(. 
-0002bc40: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0002bc50: 2020 2020 206f 7468 6572 3a20 7374 7220       other: str 
-0002bc60: 7c20 5365 7269 6573 2c0a 2020 2020 2020  | Series,.      
-0002bc70: 2020 6472 6f70 3a20 626f 6f6c 203d 2054    drop: bool = T
-0002bc80: 7275 652c 0a20 2020 2020 2020 2073 6f72  rue,.        sor
-0002bc90: 7465 643a 2062 6f6f 6c20 3d20 4661 6c73  ted: bool = Fals
-0002bca0: 652c 0a20 2020 2020 2020 206e 7061 7274  e,.        npart
-0002bcb0: 6974 696f 6e73 3a20 696e 7420 7c20 4c69  itions: int | Li
-0002bcc0: 7465 7261 6c5b 2261 7574 6f22 5d20 7c20  teral["auto"] | 
-0002bcd0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
-0002bce0: 2020 2020 2064 6976 6973 696f 6e73 3a20       divisions: 
-0002bcf0: 5365 7175 656e 6365 207c 204e 6f6e 6520  Sequence | None 
-0002bd00: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0002bd10: 696e 706c 6163 653a 2062 6f6f 6c20 3d20  inplace: bool = 
-0002bd20: 4661 6c73 652c 0a20 2020 2020 2020 202a  False,.        *
-0002bd30: 2a6b 7761 7267 732c 0a20 2020 2029 3a0a  *kwargs,.    ):.
-0002bd40: 2020 2020 2020 2020 2222 2253 6574 2074          """Set t
-0002bd50: 6865 2044 6174 6146 7261 6d65 2069 6e64  he DataFrame ind
-0002bd60: 6578 2028 726f 7720 6c61 6265 6c73 2920  ex (row labels) 
-0002bd70: 7573 696e 6720 616e 2065 7869 7374 696e  using an existin
-0002bd80: 6720 636f 6c75 6d6e 2e0a 0a20 2020 2020  g column...     
-0002bd90: 2020 2054 6869 7320 7265 616c 6967 6e73     This realigns
-0002bda0: 2074 6865 2064 6174 6173 6574 2074 6f20   the dataset to 
-0002bdb0: 6265 2073 6f72 7465 6420 6279 2061 206e  be sorted by a n
-0002bdc0: 6577 2063 6f6c 756d 6e2e 2054 6869 7320  ew column. This 
-0002bdd0: 6361 6e20 6861 7665 2061 0a20 2020 2020  can have a.     
-0002bde0: 2020 2073 6967 6e69 6669 6361 6e74 2069     significant i
-0002bdf0: 6d70 6163 7420 6f6e 2070 6572 666f 726d  mpact on perform
-0002be00: 616e 6365 2c20 6265 6361 7573 6520 6a6f  ance, because jo
-0002be10: 696e 732c 2067 726f 7570 6279 732c 206c  ins, groupbys, l
-0002be20: 6f6f 6b75 7073 2c20 6574 632e 0a20 2020  ookups, etc..   
-0002be30: 2020 2020 2061 7265 2061 6c6c 206d 7563       are all muc
-0002be40: 6820 6661 7374 6572 206f 6e20 7468 6174  h faster on that
-0002be50: 2063 6f6c 756d 6e2e 2048 6f77 6576 6572   column. However
-0002be60: 2c20 7468 6973 2070 6572 666f 726d 616e  , this performan
-0002be70: 6365 2069 6e63 7265 6173 650a 2020 2020  ce increase.    
-0002be80: 2020 2020 636f 6d65 7320 7769 7468 2061      comes with a
-0002be90: 2063 6f73 742c 2073 6f72 7469 6e67 2061   cost, sorting a
-0002bea0: 2070 6172 616c 6c65 6c20 6461 7461 7365   parallel datase
-0002beb0: 7420 7265 7175 6972 6573 2065 7870 656e  t requires expen
-0002bec0: 7369 7665 2073 6875 6666 6c65 732e 0a20  sive shuffles.. 
-0002bed0: 2020 2020 2020 204f 6674 656e 2077 6520         Often we 
-0002bee0: 6060 7365 745f 696e 6465 7860 6020 6f6e  ``set_index`` on
-0002bef0: 6365 2064 6972 6563 746c 7920 6166 7465  ce directly afte
-0002bf00: 7220 6461 7461 2069 6e67 6573 7420 616e  r data ingest an
-0002bf10: 6420 6669 6c74 6572 696e 6720 616e 640a  d filtering and.
-0002bf20: 2020 2020 2020 2020 7468 656e 2070 6572          then per
-0002bf30: 666f 726d 206d 616e 7920 6368 6561 7020  form many cheap 
-0002bf40: 636f 6d70 7574 6174 696f 6e73 206f 6666  computations off
-0002bf50: 206f 6620 7468 6520 736f 7274 6564 2064   of the sorted d
-0002bf60: 6174 6173 6574 2e0a 0a20 2020 2020 2020  ataset...       
-0002bf70: 2054 6869 7320 6675 6e63 7469 6f6e 206f   This function o
-0002bf80: 7065 7261 7465 7320 6578 6163 746c 7920  perates exactly 
-0002bf90: 6c69 6b65 2060 6070 616e 6461 732e 7365  like ``pandas.se
-0002bfa0: 745f 696e 6465 7860 6020 6578 6365 7074  t_index`` except
-0002bfb0: 2077 6974 680a 2020 2020 2020 2020 6469   with.        di
-0002bfc0: 6666 6572 656e 7420 7065 7266 6f72 6d61  fferent performa
-0002bfd0: 6e63 6520 636f 7374 7320 2864 6173 6b20  nce costs (dask 
-0002bfe0: 6461 7461 6672 616d 6520 6060 7365 745f  dataframe ``set_
-0002bff0: 696e 6465 7860 6020 6973 206d 7563 6820  index`` is much 
-0002c000: 6d6f 7265 2065 7870 656e 7369 7665 292e  more expensive).
-0002c010: 0a20 2020 2020 2020 2055 6e64 6572 206e  .        Under n
-0002c020: 6f72 6d61 6c20 6f70 6572 6174 696f 6e20  ormal operation 
-0002c030: 7468 6973 2066 756e 6374 696f 6e20 646f  this function do
-0002c040: 6573 2061 6e20 696e 6974 6961 6c20 7061  es an initial pa
-0002c050: 7373 206f 7665 7220 7468 6520 696e 6465  ss over the inde
-0002c060: 7820 636f 6c75 6d6e 0a20 2020 2020 2020  x column.       
-0002c070: 2074 6f20 636f 6d70 7574 6520 6170 7072   to compute appr
-0002c080: 6f78 696d 6174 6520 7175 616e 7469 6c65  oximate quantile
-0002c090: 7320 746f 2073 6572 7665 2061 7320 6675  s to serve as fu
-0002c0a0: 7475 7265 2064 6976 6973 696f 6e73 2e20  ture divisions. 
-0002c0b0: 4974 2074 6865 6e20 7061 7373 6573 0a20  It then passes. 
-0002c0c0: 2020 2020 2020 206f 7665 7220 7468 6520         over the 
-0002c0d0: 6461 7461 2061 2073 6563 6f6e 6420 7469  data a second ti
-0002c0e0: 6d65 2c20 7370 6c69 7474 696e 6720 7570  me, splitting up
-0002c0f0: 2065 6163 6820 696e 7075 7420 7061 7274   each input part
-0002c100: 6974 696f 6e20 696e 746f 2073 6576 6572  ition into sever
-0002c110: 616c 0a20 2020 2020 2020 2070 6965 6365  al.        piece
-0002c120: 7320 616e 6420 7368 6172 696e 6720 7468  s and sharing th
-0002c130: 6f73 6520 7069 6563 6573 2074 6f20 616c  ose pieces to al
-0002c140: 6c20 6f66 2074 6865 206f 7574 7075 7420  l of the output 
-0002c150: 7061 7274 6974 696f 6e73 206e 6f77 2069  partitions now i
-0002c160: 6e0a 2020 2020 2020 2020 736f 7274 6564  n.        sorted
-0002c170: 206f 7264 6572 2e0a 0a20 2020 2020 2020   order...       
-0002c180: 2049 6e20 736f 6d65 2063 6173 6573 2077   In some cases w
-0002c190: 6520 6361 6e20 616c 6c65 7669 6174 6520  e can alleviate 
-0002c1a0: 7468 6f73 6520 636f 7374 732c 2066 6f72  those costs, for
-0002c1b0: 2065 7861 6d70 6c65 2069 6620 796f 7572   example if your
-0002c1c0: 2064 6174 6173 6574 2069 730a 2020 2020   dataset is.    
-0002c1d0: 2020 2020 736f 7274 6564 2061 6c72 6561      sorted alrea
-0002c1e0: 6479 2074 6865 6e20 7765 2063 616e 2061  dy then we can a
-0002c1f0: 766f 6964 206d 616b 696e 6720 6d61 6e79  void making many
-0002c200: 2073 6d61 6c6c 2070 6965 6365 7320 6f72   small pieces or
-0002c210: 2069 6620 796f 7520 6b6e 6f77 0a20 2020   if you know.   
-0002c220: 2020 2020 2067 6f6f 6420 7661 6c75 6573       good values
-0002c230: 2074 6f20 7370 6c69 7420 7468 6520 6e65   to split the ne
-0002c240: 7720 696e 6465 7820 636f 6c75 6d6e 2074  w index column t
-0002c250: 6865 6e20 7765 2063 616e 2061 766f 6964  hen we can avoid
-0002c260: 2074 6865 2069 6e69 7469 616c 0a20 2020   the initial.   
-0002c270: 2020 2020 2070 6173 7320 6f76 6572 2074       pass over t
-0002c280: 6865 2064 6174 612e 2046 6f72 2065 7861  he data. For exa
-0002c290: 6d70 6c65 2069 6620 796f 7572 206e 6577  mple if your new
-0002c2a0: 2069 6e64 6578 2069 7320 6120 6461 7465   index is a date
-0002c2b0: 7469 6d65 2069 6e64 6578 2061 6e64 0a20  time index and. 
-0002c2c0: 2020 2020 2020 2079 6f75 7220 6461 7461         your data
-0002c2d0: 2069 7320 616c 7265 6164 7920 736f 7274   is already sort
-0002c2e0: 6564 2062 7920 6461 7920 7468 656e 2074  ed by day then t
-0002c2f0: 6869 7320 656e 7469 7265 206f 7065 7261  his entire opera
-0002c300: 7469 6f6e 2063 616e 2062 6520 646f 6e65  tion can be done
-0002c310: 0a20 2020 2020 2020 2066 6f72 2066 7265  .        for fre
-0002c320: 652e 2059 6f75 2063 616e 2063 6f6e 7472  e. You can contr
-0002c330: 6f6c 2074 6865 7365 206f 7074 696f 6e73  ol these options
-0002c340: 2077 6974 6820 7468 6520 666f 6c6c 6f77   with the follow
-0002c350: 696e 6720 7061 7261 6d65 7465 7273 2e0a  ing parameters..
-0002c360: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0002c370: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-0002c380: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
-0002c390: 7468 6572 3a20 7374 7269 6e67 206f 7220  ther: string or 
-0002c3a0: 4461 736b 2053 6572 6965 730a 2020 2020  Dask Series.    
-0002c3b0: 2020 2020 2020 2020 436f 6c75 6d6e 2074          Column t
-0002c3c0: 6f20 7573 6520 6173 2069 6e64 6578 2e0a  o use as index..
-0002c3d0: 2020 2020 2020 2020 6472 6f70 3a20 626f          drop: bo
-0002c3e0: 6f6c 6561 6e2c 2064 6566 6175 6c74 2054  olean, default T
-0002c3f0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-0002c400: 4465 6c65 7465 2063 6f6c 756d 6e20 746f  Delete column to
-0002c410: 2062 6520 7573 6564 2061 7320 7468 6520   be used as the 
-0002c420: 6e65 7720 696e 6465 782e 0a20 2020 2020  new index..     
-0002c430: 2020 2073 6f72 7465 643a 2062 6f6f 6c2c     sorted: bool,
-0002c440: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0002c450: 2020 2020 2020 4966 2074 6865 2069 6e64        If the ind
-0002c460: 6578 2063 6f6c 756d 6e20 6973 2061 6c72  ex column is alr
-0002c470: 6561 6479 2073 6f72 7465 6420 696e 2069  eady sorted in i
-0002c480: 6e63 7265 6173 696e 6720 6f72 6465 722e  ncreasing order.
-0002c490: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
-0002c4a0: 6175 6c74 7320 746f 2046 616c 7365 0a20  aults to False. 
-0002c4b0: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
-0002c4c0: 6e73 3a20 696e 742c 204e 6f6e 652c 206f  ns: int, None, o
-0002c4d0: 7220 2761 7574 6f27 0a20 2020 2020 2020  r 'auto'.       
-0002c4e0: 2020 2020 2054 6865 2069 6465 616c 206e       The ideal n
-0002c4f0: 756d 6265 7220 6f66 206f 7574 7075 7420  umber of output 
-0002c500: 7061 7274 6974 696f 6e73 2e20 4966 204e  partitions. If N
-0002c510: 6f6e 652c 2075 7365 2074 6865 2073 616d  one, use the sam
-0002c520: 6520 6173 0a20 2020 2020 2020 2020 2020  e as.           
-0002c530: 2074 6865 2069 6e70 7574 2e20 4966 2027   the input. If '
-0002c540: 6175 746f 2720 7468 656e 2064 6563 6964  auto' then decid
-0002c550: 6520 6279 206d 656d 6f72 7920 7573 652e  e by memory use.
-0002c560: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
-0002c570: 7920 7573 6564 2077 6865 6e20 6060 6469  y used when ``di
-0002c580: 7669 7369 6f6e 7360 6020 6973 206e 6f74  visions`` is not
-0002c590: 2067 6976 656e 2e20 4966 2060 6064 6976   given. If ``div
-0002c5a0: 6973 696f 6e73 6060 2069 7320 6769 7665  isions`` is give
-0002c5b0: 6e2c 0a20 2020 2020 2020 2020 2020 2074  n,.            t
-0002c5c0: 6865 206e 756d 6265 7220 6f66 206f 7574  he number of out
-0002c5d0: 7075 7420 7061 7274 6974 696f 6e73 2077  put partitions w
-0002c5e0: 696c 6c20 6265 2060 606c 656e 2864 6976  ill be ``len(div
-0002c5f0: 6973 696f 6e73 2920 2d20 3160 602e 0a20  isions) - 1``.. 
-0002c600: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
-0002c610: 3a20 6c69 7374 2c20 6f70 7469 6f6e 616c  : list, optional
-0002c620: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-0002c630: 2022 6469 7669 6469 6e67 206c 696e 6573   "dividing lines
-0002c640: 2220 7573 6564 2074 6f20 7370 6c69 7420  " used to split 
-0002c650: 7468 6520 6e65 7720 696e 6465 7820 696e  the new index in
-0002c660: 746f 2070 6172 7469 7469 6f6e 732e 0a20  to partitions.. 
-0002c670: 2020 2020 2020 2020 2020 2046 6f72 2060             For `
-0002c680: 6064 6976 6973 696f 6e73 3d5b 302c 2031  `divisions=[0, 1
-0002c690: 302c 2035 302c 2031 3030 5d60 602c 2074  0, 50, 100]``, t
-0002c6a0: 6865 7265 2077 6f75 6c64 2062 6520 7468  here would be th
-0002c6b0: 7265 6520 6f75 7470 7574 2070 6172 7469  ree output parti
-0002c6c0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
-0002c6d0: 2020 2077 6865 7265 2074 6865 206e 6577     where the new
-0002c6e0: 2069 6e64 6578 2063 6f6e 7461 696e 6564   index contained
-0002c6f0: 205b 302c 2031 3029 2c20 5b31 302c 2035   [0, 10), [10, 5
-0002c700: 3029 2c20 616e 6420 5b35 302c 2031 3030  0), and [50, 100
-0002c710: 292c 2072 6573 7065 6374 6976 656c 792e  ), respectively.
-0002c720: 0a20 2020 2020 2020 2020 2020 2053 6565  .            See
-0002c730: 2068 7474 7073 3a2f 2f64 6f63 732e 6461   https://docs.da
-0002c740: 736b 2e6f 7267 2f65 6e2f 6c61 7465 7374  sk.org/en/latest
-0002c750: 2f64 6174 6166 7261 6d65 2d64 6573 6967  /dataframe-desig
-0002c760: 6e2e 6874 6d6c 2370 6172 7469 7469 6f6e  n.html#partition
-0002c770: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
-0002c780: 6620 6e6f 7420 6769 7665 6e20 2864 6566  f not given (def
-0002c790: 6175 6c74 292c 2067 6f6f 6420 6469 7669  ault), good divi
-0002c7a0: 7369 6f6e 7320 6172 6520 6361 6c63 756c  sions are calcul
-0002c7b0: 6174 6564 2062 7920 696d 6d65 6469 6174  ated by immediat
-0002c7c0: 656c 7920 636f 6d70 7574 696e 670a 2020  ely computing.  
-0002c7d0: 2020 2020 2020 2020 2020 7468 6520 6461            the da
-0002c7e0: 7461 2061 6e64 206c 6f6f 6b69 6e67 2061  ta and looking a
-0002c7f0: 7420 7468 6520 6469 7374 7269 6275 7469  t the distributi
-0002c800: 6f6e 206f 6620 6974 7320 7661 6c75 6573  on of its values
-0002c810: 2e20 466f 7220 6c61 7267 6520 6461 7461  . For large data
-0002c820: 7365 7473 2c0a 2020 2020 2020 2020 2020  sets,.          
-0002c830: 2020 7468 6973 2063 616e 2062 6520 6578    this can be ex
-0002c840: 7065 6e73 6976 652e 0a20 2020 2020 2020  pensive..       
-0002c850: 2020 2020 204e 6f74 6520 7468 6174 2069       Note that i
-0002c860: 6620 6060 736f 7274 6564 3d54 7275 6560  f ``sorted=True`
-0002c870: 602c 2073 7065 6369 6669 6564 2064 6976  `, specified div
-0002c880: 6973 696f 6e73 2061 7265 2061 7373 756d  isions are assum
-0002c890: 6564 2074 6f20 6d61 7463 680a 2020 2020  ed to match.    
-0002c8a0: 2020 2020 2020 2020 7468 6520 6578 6973          the exis
-0002c8b0: 7469 6e67 2070 6172 7469 7469 6f6e 7320  ting partitions 
-0002c8c0: 696e 2074 6865 2064 6174 613b 2069 6620  in the data; if 
-0002c8d0: 7468 6973 2069 7320 756e 7472 7565 2079  this is untrue y
-0002c8e0: 6f75 2073 686f 756c 640a 2020 2020 2020  ou should.      
-0002c8f0: 2020 2020 2020 6c65 6176 6520 6469 7669        leave divi
-0002c900: 7369 6f6e 7320 656d 7074 7920 616e 6420  sions empty and 
-0002c910: 6361 6c6c 2060 6072 6570 6172 7469 7469  call ``repartiti
-0002c920: 6f6e 6060 2061 6674 6572 2060 6073 6574  on`` after ``set
-0002c930: 5f69 6e64 6578 6060 2e0a 2020 2020 2020  _index``..      
-0002c940: 2020 696e 706c 6163 653a 2062 6f6f 6c2c    inplace: bool,
-0002c950: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0002c960: 2020 2020 2020 4d6f 6469 6679 696e 6720        Modifying 
-0002c970: 7468 6520 4461 7461 4672 616d 6520 696e  the DataFrame in
-0002c980: 2070 6c61 6365 2069 7320 6e6f 7420 7375   place is not su
-0002c990: 7070 6f72 7465 6420 6279 2044 6173 6b2e  pported by Dask.
-0002c9a0: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
-0002c9b0: 6175 6c74 7320 746f 2046 616c 7365 2e0a  aults to False..
-0002c9c0: 2020 2020 2020 2020 7368 7566 666c 653a          shuffle:
-0002c9d0: 2073 7472 696e 672c 2027 6469 736b 2720   string, 'disk' 
-0002c9e0: 6f72 2027 7461 736b 7327 2c20 6f70 7469  or 'tasks', opti
-0002c9f0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0002ca00: 2045 6974 6865 7220 6060 2764 6973 6b27   Either ``'disk'
-0002ca10: 6060 2066 6f72 2073 696e 676c 652d 6e6f  `` for single-no
-0002ca20: 6465 206f 7065 7261 7469 6f6e 206f 7220  de operation or 
-0002ca30: 6060 2774 6173 6b73 2760 6020 666f 720a  ``'tasks'`` for.
-0002ca40: 2020 2020 2020 2020 2020 2020 6469 7374              dist
-0002ca50: 7269 6275 7465 6420 6f70 6572 6174 696f  ributed operatio
-0002ca60: 6e2e 2020 5769 6c6c 2062 6520 696e 6665  n.  Will be infe
-0002ca70: 7272 6564 2062 7920 796f 7572 2063 7572  rred by your cur
-0002ca80: 7265 6e74 2073 6368 6564 756c 6572 2e0a  rent scheduler..
-0002ca90: 2020 2020 2020 2020 636f 6d70 7574 653a          compute:
-0002caa0: 2062 6f6f 6c2c 2064 6566 6175 6c74 2046   bool, default F
-0002cab0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-0002cac0: 2057 6865 7468 6572 206f 7220 6e6f 7420   Whether or not 
-0002cad0: 746f 2074 7269 6767 6572 2061 6e20 696d  to trigger an im
-0002cae0: 6d65 6469 6174 6520 636f 6d70 7574 6174  mediate computat
-0002caf0: 696f 6e2e 2044 6566 6175 6c74 7320 746f  ion. Defaults to
-0002cb00: 2046 616c 7365 2e0a 2020 2020 2020 2020   False..        
-0002cb10: 2020 2020 4e6f 7465 2c20 7468 6174 2065      Note, that e
-0002cb20: 7665 6e20 6966 2079 6f75 2073 6574 2060  ven if you set `
-0002cb30: 6063 6f6d 7075 7465 3d46 616c 7365 6060  `compute=False``
-0002cb40: 2c20 616e 2069 6d6d 6564 6961 7465 2063  , an immediate c
-0002cb50: 6f6d 7075 7461 7469 6f6e 0a20 2020 2020  omputation.     
-0002cb60: 2020 2020 2020 2077 696c 6c20 7374 696c         will stil
-0002cb70: 6c20 6265 2074 7269 6767 6572 6564 2069  l be triggered i
-0002cb80: 6620 6060 6469 7669 7369 6f6e 7360 6020  f ``divisions`` 
-0002cb90: 6973 2060 604e 6f6e 6560 602e 0a20 2020  is ``None``..   
-0002cba0: 2020 2020 2070 6172 7469 7469 6f6e 5f73       partition_s
-0002cbb0: 697a 653a 2069 6e74 2c20 6f70 7469 6f6e  ize: int, option
-0002cbc0: 616c 0a20 2020 2020 2020 2020 2020 2044  al.            D
-0002cbd0: 6573 6972 6564 2073 697a 6520 6f66 2065  esired size of e
-0002cbe0: 6163 6820 7061 7274 6974 696f 6e73 2069  ach partitions i
-0002cbf0: 6e20 6279 7465 732e 0a20 2020 2020 2020  n bytes..       
-0002cc00: 2020 2020 204f 6e6c 7920 7573 6564 2077       Only used w
-0002cc10: 6865 6e20 6060 6e70 6172 7469 7469 6f6e  hen ``npartition
-0002cc20: 733d 2761 7574 6f27 6060 0a0a 2020 2020  s='auto'``..    
-0002cc30: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0002cc40: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-0002cc50: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-0002cc60: 2064 6173 6b0a 2020 2020 2020 2020 3e3e   dask.        >>
-0002cc70: 3e20 6464 6620 3d20 6461 736b 2e64 6174  > ddf = dask.dat
-0002cc80: 6173 6574 732e 7469 6d65 7365 7269 6573  asets.timeseries
-0002cc90: 2873 7461 7274 3d22 3230 3231 2d30 312d  (start="2021-01-
-0002cca0: 3031 222c 2065 6e64 3d22 3230 3231 2d30  01", end="2021-0
-0002ccb0: 312d 3037 222c 2066 7265 713d 2231 4822  1-07", freq="1H"
-0002ccc0: 292e 7265 7365 745f 696e 6465 7828 290a  ).reset_index().
-0002ccd0: 2020 2020 2020 2020 3e3e 3e20 6464 6632          >>> ddf2
-0002cce0: 203d 2064 6466 2e73 6574 5f69 6e64 6578   = ddf.set_index
-0002ccf0: 2822 7822 290a 2020 2020 2020 2020 3e3e  ("x").        >>
-0002cd00: 3e20 6464 6632 203d 2064 6466 2e73 6574  > ddf2 = ddf.set
-0002cd10: 5f69 6e64 6578 2864 6466 2e78 290a 2020  _index(ddf.x).  
-0002cd20: 2020 2020 2020 3e3e 3e20 6464 6632 203d        >>> ddf2 =
-0002cd30: 2064 6466 2e73 6574 5f69 6e64 6578 2864   ddf.set_index(d
-0002cd40: 6466 2e74 696d 6573 7461 6d70 2c20 736f  df.timestamp, so
-0002cd50: 7274 6564 3d54 7275 6529 0a0a 2020 2020  rted=True)..    
-0002cd60: 2020 2020 4120 636f 6d6d 6f6e 2063 6173      A common cas
-0002cd70: 6520 6973 2077 6865 6e20 7765 2068 6176  e is when we hav
-0002cd80: 6520 6120 6461 7465 7469 6d65 2063 6f6c  e a datetime col
-0002cd90: 756d 6e20 7468 6174 2077 6520 6b6e 6f77  umn that we know
-0002cda0: 2074 6f20 6265 0a20 2020 2020 2020 2073   to be.        s
-0002cdb0: 6f72 7465 6420 616e 6420 6973 2063 6c65  orted and is cle
-0002cdc0: 616e 6c79 2064 6976 6964 6564 2062 7920  anly divided by 
-0002cdd0: 6461 792e 2020 5765 2063 616e 2073 6574  day.  We can set
-0002cde0: 2074 6869 7320 696e 6465 7820 666f 7220   this index for 
-0002cdf0: 6672 6565 0a20 2020 2020 2020 2062 7920  free.        by 
-0002ce00: 7370 6563 6966 7969 6e67 2062 6f74 6820  specifying both 
-0002ce10: 7468 6174 2074 6865 2063 6f6c 756d 6e20  that the column 
-0002ce20: 6973 2070 7265 2d73 6f72 7465 6420 616e  is pre-sorted an
-0002ce30: 6420 7468 6520 7061 7274 6963 756c 6172  d the particular
-0002ce40: 0a20 2020 2020 2020 2064 6976 6973 696f  .        divisio
-0002ce50: 6e73 2061 6c6f 6e67 2077 6869 6368 2069  ns along which i
-0002ce60: 7320 6973 2073 6570 6172 6174 6564 0a0a  s is separated..
-0002ce70: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-0002ce80: 7274 2070 616e 6461 7320 6173 2070 640a  rt pandas as pd.
-0002ce90: 2020 2020 2020 2020 3e3e 3e20 6469 7669          >>> divi
-0002cea0: 7369 6f6e 7320 3d20 7064 2e64 6174 655f  sions = pd.date_
-0002ceb0: 7261 6e67 6528 7374 6172 743d 2232 3032  range(start="202
-0002cec0: 312d 3031 2d30 3122 2c20 656e 643d 2232  1-01-01", end="2
-0002ced0: 3032 312d 3031 2d30 3722 2c20 6672 6571  021-01-07", freq
-0002cee0: 3d27 3144 2729 0a20 2020 2020 2020 203e  ='1D').        >
-0002cef0: 3e3e 2064 6976 6973 696f 6e73 0a20 2020  >> divisions.   
-0002cf00: 2020 2020 2044 6174 6574 696d 6549 6e64       DatetimeInd
-0002cf10: 6578 285b 2732 3032 312d 3031 2d30 3127  ex(['2021-01-01'
-0002cf20: 2c20 2732 3032 312d 3031 2d30 3227 2c20  , '2021-01-02', 
-0002cf30: 2732 3032 312d 3031 2d30 3327 2c20 2732  '2021-01-03', '2
-0002cf40: 3032 312d 3031 2d30 3427 2c0a 2020 2020  021-01-04',.    
-0002cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cf60: 2020 2027 3230 3231 2d30 312d 3035 272c     '2021-01-05',
-0002cf70: 2027 3230 3231 2d30 312d 3036 272c 2027   '2021-01-06', '
-0002cf80: 3230 3231 2d30 312d 3037 275d 2c0a 2020  2021-01-07'],.  
+00029090: 2264 6174 6166 7261 6d65 5f74 7970 6522  "dataframe_type"
+000290a0: 3a20 7479 7065 6e61 6d65 2874 7970 6528  : typename(type(
+000290b0: 7365 6c66 2e5f 6d65 7461 2929 2c0a 2020  self._meta)),.  
+000290c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000290d0: 2020 2273 6572 6965 735f 6474 7970 6573    "series_dtypes
+000290e0: 223a 207b 0a20 2020 2020 2020 2020 2020  ": {.           
+000290f0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+00029100: 3a20 7365 6c66 2e5f 6d65 7461 5b63 6f6c  : self._meta[col
+00029110: 5d2e 6474 7970 650a 2020 2020 2020 2020  ].dtype.        
+00029120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029130: 6966 2068 6173 6174 7472 2873 656c 662e  if hasattr(self.
+00029140: 5f6d 6574 615b 636f 6c5d 2c20 2264 7479  _meta[col], "dty
+00029150: 7065 2229 0a20 2020 2020 2020 2020 2020  pe").           
+00029160: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00029170: 6520 4e6f 6e65 0a20 2020 2020 2020 2020  e None.         
+00029180: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00029190: 6f72 2063 6f6c 2069 6e20 7365 6c66 2e5f  or col in self._
+000291a0: 6d65 7461 2e63 6f6c 756d 6e73 0a20 2020  meta.columns.   
+000291b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000291c0: 207d 2c0a 2020 2020 2020 2020 2020 2020   },.            
+000291d0: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+000291e0: 2020 290a 0a20 2020 2064 6566 205f 5f61    )..    def __a
+000291f0: 7272 6179 5f77 7261 705f 5f28 7365 6c66  rray_wrap__(self
+00029200: 2c20 6172 7261 792c 2063 6f6e 7465 7874  , array, context
+00029210: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00029220: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
+00029230: 6e74 6578 742c 2074 7570 6c65 2920 616e  ntext, tuple) an
+00029240: 6420 6c65 6e28 636f 6e74 6578 7429 203e  d len(context) >
+00029250: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00029260: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
+00029270: 6e74 6578 745b 315d 5b30 5d2c 206e 702e  ntext[1][0], np.
+00029280: 6e64 6172 7261 7929 2061 6e64 2063 6f6e  ndarray) and con
+00029290: 7465 7874 5b31 5d5b 305d 2e73 6861 7065  text[1][0].shape
+000292a0: 203d 3d20 2829 3a0a 2020 2020 2020 2020   == ():.        
+000292b0: 2020 2020 2020 2020 696e 6465 7820 3d20          index = 
+000292c0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+000292d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000292e0: 2020 2020 2020 2069 6e64 6578 203d 2063         index = c
+000292f0: 6f6e 7465 7874 5b31 5d5b 305d 2e69 6e64  ontext[1][0].ind
+00029300: 6578 0a20 2020 2020 2020 2065 6c73 653a  ex.        else:
+00029310: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+00029320: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00029330: 2020 696d 706f 7274 2069 6e73 7065 6374    import inspect
+00029340: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029350: 2020 6d65 7468 6f64 5f6e 616d 6520 3d20    method_name = 
+00029360: 6622 607b 696e 7370 6563 742e 7374 6163  f"`{inspect.stac
+00029370: 6b28 295b 335d 5b33 5d7d 6022 0a20 2020  k()[3][3]}`".   
+00029380: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+00029390: 496e 6465 7845 7272 6f72 3a0a 2020 2020  IndexError:.    
+000293a0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
+000293b0: 6f64 5f6e 616d 6520 3d20 2254 6869 7320  od_name = "This 
+000293c0: 6d65 7468 6f64 220a 0a20 2020 2020 2020  method"..       
+000293d0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+000293e0: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
+000293f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029400: 6622 7b6d 6574 686f 645f 6e61 6d65 7d20  f"{method_name} 
+00029410: 6973 206e 6f74 2069 6d70 6c65 6d65 6e74  is not implement
+00029420: 6564 2066 6f72 2060 6461 736b 2e64 6174  ed for `dask.dat
+00029430: 6166 7261 6d65 2e44 6174 6146 7261 6d65  aframe.DataFrame
+00029440: 602e 220a 2020 2020 2020 2020 2020 2020  `.".            
+00029450: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00029460: 6e20 6d65 7461 5f66 7261 6d65 5f63 6f6e  n meta_frame_con
+00029470: 7374 7275 6374 6f72 2873 656c 6629 2861  structor(self)(a
+00029480: 7272 6179 2c20 696e 6465 783d 696e 6465  rray, index=inde
+00029490: 782c 2063 6f6c 756d 6e73 3d73 656c 662e  x, columns=self.
+000294a0: 636f 6c75 6d6e 7329 0a0a 2020 2020 4070  columns)..    @p
+000294b0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+000294c0: 6178 6573 2873 656c 6629 3a0a 2020 2020  axes(self):.    
+000294d0: 2020 2020 7265 7475 726e 205b 7365 6c66      return [self
+000294e0: 2e69 6e64 6578 2c20 7365 6c66 2e63 6f6c  .index, self.col
+000294f0: 756d 6e73 5d0a 0a20 2020 2040 7072 6f70  umns]..    @prop
+00029500: 6572 7479 0a20 2020 2064 6566 2063 6f6c  erty.    def col
+00029510: 756d 6e73 2873 656c 6629 3a0a 2020 2020  umns(self):.    
+00029520: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00029530: 5f6d 6574 612e 636f 6c75 6d6e 730a 0a20  _meta.columns.. 
+00029540: 2020 2040 636f 6c75 6d6e 732e 7365 7474     @columns.sett
+00029550: 6572 0a20 2020 2064 6566 2063 6f6c 756d  er.    def colum
+00029560: 6e73 2873 656c 662c 2063 6f6c 756d 6e73  ns(self, columns
+00029570: 293a 0a20 2020 2020 2020 2072 656e 616d  ):.        renam
+00029580: 6564 203d 205f 7265 6e61 6d65 5f64 6173  ed = _rename_das
+00029590: 6b28 7365 6c66 2c20 636f 6c75 6d6e 7329  k(self, columns)
+000295a0: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
+000295b0: 6574 6120 3d20 7265 6e61 6d65 642e 5f6d  eta = renamed._m
+000295c0: 6574 610a 2020 2020 2020 2020 7365 6c66  eta.        self
+000295d0: 2e5f 6e61 6d65 203d 2072 656e 616d 6564  ._name = renamed
+000295e0: 2e5f 6e61 6d65 0a20 2020 2020 2020 2073  ._name.        s
+000295f0: 656c 662e 6461 736b 203d 2072 656e 616d  elf.dask = renam
+00029600: 6564 2e64 6173 6b0a 0a20 2020 2040 7072  ed.dask..    @pr
+00029610: 6f70 6572 7479 0a20 2020 2064 6566 2069  operty.    def i
+00029620: 6c6f 6328 7365 6c66 293a 0a20 2020 2020  loc(self):.     
+00029630: 2020 2022 2222 5075 7265 6c79 2069 6e74     """Purely int
+00029640: 6567 6572 2d6c 6f63 6174 696f 6e20 6261  eger-location ba
+00029650: 7365 6420 696e 6465 7869 6e67 2066 6f72  sed indexing for
+00029660: 2073 656c 6563 7469 6f6e 2062 7920 706f   selection by po
+00029670: 7369 7469 6f6e 2e0a 0a20 2020 2020 2020  sition...       
+00029680: 204f 6e6c 7920 696e 6465 7869 6e67 2074   Only indexing t
+00029690: 6865 2063 6f6c 756d 6e20 706f 7369 7469  he column positi
+000296a0: 6f6e 7320 6973 2073 7570 706f 7274 6564  ons is supported
+000296b0: 2e20 5472 7969 6e67 2074 6f20 7365 6c65  . Trying to sele
+000296c0: 6374 0a20 2020 2020 2020 2072 6f77 2070  ct.        row p
+000296d0: 6f73 6974 696f 6e73 2077 696c 6c20 7261  ositions will ra
+000296e0: 6973 6520 6120 5661 6c75 6545 7272 6f72  ise a ValueError
+000296f0: 2e0a 0a20 2020 2020 2020 2053 6565 203a  ...        See :
+00029700: 7265 663a 6064 6174 6166 7261 6d65 2e69  ref:`dataframe.i
+00029710: 6e64 6578 696e 6760 2066 6f72 206d 6f72  ndexing` for mor
+00029720: 652e 0a0a 2020 2020 2020 2020 4578 616d  e...        Exam
+00029730: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
+00029740: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
+00029750: 3e20 6466 2e69 6c6f 635b 3a2c 205b 322c  > df.iloc[:, [2,
+00029760: 2030 2c20 315d 5d20 2023 2064 6f63 7465   0, 1]]  # docte
+00029770: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
+00029780: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
+00029790: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+000297a0: 652e 696e 6465 7869 6e67 2069 6d70 6f72  e.indexing impor
+000297b0: 7420 5f69 4c6f 6349 6e64 6578 6572 0a0a  t _iLocIndexer..
+000297c0: 2020 2020 2020 2020 2320 466f 7220 6461          # For da
+000297d0: 7461 6672 616d 6573 2077 6974 6820 756e  taframes with un
+000297e0: 6971 7565 2063 6f6c 756d 6e20 6e61 6d65  ique column name
+000297f0: 732c 2074 6869 7320 7769 6c6c 2062 6520  s, this will be 
+00029800: 7472 616e 7366 6f72 6d65 6420 696e 746f  transformed into
+00029810: 2061 205f 5f67 6574 6974 656d 5f5f 2063   a __getitem__ c
+00029820: 616c 6c0a 2020 2020 2020 2020 7265 7475  all.        retu
+00029830: 726e 205f 694c 6f63 496e 6465 7865 7228  rn _iLocIndexer(
+00029840: 7365 6c66 290a 0a20 2020 2064 6566 205f  self)..    def _
+00029850: 5f6c 656e 5f5f 2873 656c 6629 3a0a 2020  _len__(self):.  
+00029860: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+00029870: 2020 2020 2020 2073 203d 2073 656c 662e         s = self.
+00029880: 696c 6f63 5b3a 2c20 305d 0a20 2020 2020  iloc[:, 0].     
+00029890: 2020 2065 7863 6570 7420 496e 6465 7845     except IndexE
+000298a0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+000298b0: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
+000298c0: 2e5f 5f6c 656e 5f5f 2829 0a20 2020 2020  .__len__().     
+000298d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000298e0: 2020 2020 2072 6574 7572 6e20 6c65 6e28       return len(
+000298f0: 7329 0a0a 2020 2020 6465 6620 5f5f 636f  s)..    def __co
+00029900: 6e74 6169 6e73 5f5f 2873 656c 662c 206b  ntains__(self, k
+00029910: 6579 293a 0a20 2020 2020 2020 2072 6574  ey):.        ret
+00029920: 7572 6e20 6b65 7920 696e 2073 656c 662e  urn key in self.
+00029930: 5f6d 6574 610a 0a20 2020 2040 7072 6f70  _meta..    @prop
+00029940: 6572 7479 0a20 2020 2064 6566 2065 6d70  erty.    def emp
+00029950: 7479 2873 656c 6629 3a0a 2020 2020 2020  ty(self):.      
+00029960: 2020 2320 5f5f 6765 7461 7474 725f 5f20    # __getattr__ 
+00029970: 7769 6c6c 2062 6520 6361 6c6c 6564 2061  will be called a
+00029980: 6674 6572 2077 6520 7261 6973 6520 7468  fter we raise th
+00029990: 6973 2c20 736f 2077 6527 6c6c 2072 6169  is, so we'll rai
+000299a0: 7365 2069 7420 6167 6169 6e20 6672 6f6d  se it again from
+000299b0: 2074 6865 7265 0a20 2020 2020 2020 2072   there.        r
+000299c0: 6169 7365 2041 7474 7269 6275 7465 4e6f  aise AttributeNo
+000299d0: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+000299e0: 7228 0a20 2020 2020 2020 2020 2020 2022  r(.            "
+000299f0: 4368 6563 6b69 6e67 2077 6865 7468 6572  Checking whether
+00029a00: 2061 2044 6173 6b20 4461 7461 4672 616d   a Dask DataFram
+00029a10: 6520 6861 7320 616e 7920 726f 7773 206d  e has any rows m
+00029a20: 6179 2062 6520 6578 7065 6e73 6976 652e  ay be expensive.
+00029a30: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+00029a40: 486f 7765 7665 722c 2063 6865 636b 696e  However, checkin
+00029a50: 6720 7468 6520 6e75 6d62 6572 206f 6620  g the number of 
+00029a60: 636f 6c75 6d6e 7320 6973 2066 6173 742e  columns is fast.
+00029a70: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+00029a80: 4465 7065 6e64 696e 6720 6f6e 2077 6869  Depending on whi
+00029a90: 6368 206f 6620 7468 6573 6520 7265 7375  ch of these resu
+00029aa0: 6c74 7320 796f 7520 6e65 6564 2c20 7573  lts you need, us
+00029ab0: 6520 6569 7468 6572 2022 0a20 2020 2020  e either ".     
+00029ac0: 2020 2020 2020 2022 606c 656e 2864 662e         "`len(df.
+00029ad0: 696e 6465 7829 203d 3d20 3060 206f 7220  index) == 0` or 
+00029ae0: 606c 656e 2864 662e 636f 6c75 6d6e 7329  `len(df.columns)
+00029af0: 203d 3d20 3060 220a 2020 2020 2020 2020   == 0`".        
+00029b00: 290a 0a20 2020 2064 6566 205f 5f67 6574  )..    def __get
+00029b10: 6974 656d 5f5f 2873 656c 662c 206b 6579  item__(self, key
+00029b20: 293a 0a20 2020 2020 2020 206e 616d 6520  ):.        name 
+00029b30: 3d20 2267 6574 6974 656d 2d25 7322 2025  = "getitem-%s" %
+00029b40: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
+00029b50: 6b65 7929 0a20 2020 2020 2020 2069 6620  key).        if 
+00029b60: 6e70 2e69 7373 6361 6c61 7228 6b65 7929  np.isscalar(key)
+00029b70: 206f 7220 6973 696e 7374 616e 6365 286b   or isinstance(k
+00029b80: 6579 2c20 2874 7570 6c65 2c20 7374 7229  ey, (tuple, str)
+00029b90: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00029ba0: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
+00029bb0: 662e 5f6d 6574 612e 696e 6465 782c 2028  f._meta.index, (
+00029bc0: 7064 2e44 6174 6574 696d 6549 6e64 6578  pd.DatetimeIndex
+00029bd0: 2c20 7064 2e50 6572 696f 6449 6e64 6578  , pd.PeriodIndex
+00029be0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00029bf0: 2020 2020 6966 206b 6579 206e 6f74 2069      if key not i
+00029c00: 6e20 7365 6c66 2e5f 6d65 7461 2e63 6f6c  n self._meta.col
+00029c10: 756d 6e73 3a0a 2020 2020 2020 2020 2020  umns:.          
+00029c20: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+00029c30: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+00029c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029c50: 2022 496e 6465 7869 6e67 2061 2044 6174   "Indexing a Dat
+00029c60: 6146 7261 6d65 2077 6974 6820 6120 6461  aFrame with a da
+00029c70: 7465 7469 6d65 6c69 6b65 2069 6e64 6578  tetimelike index
+00029c80: 2075 7369 6e67 2061 2073 696e 676c 6520   using a single 
+00029c90: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00029ca0: 2020 2020 2020 2020 2020 2273 7472 696e            "strin
+00029cb0: 6720 746f 2073 6c69 6365 2074 6865 2072  g to slice the r
+00029cc0: 6f77 732c 206c 696b 6520 6066 7261 6d65  ows, like `frame
+00029cd0: 5b73 7472 696e 675d 602c 2069 7320 6465  [string]`, is de
+00029ce0: 7072 6563 6174 6564 2022 0a20 2020 2020  precated ".     
+00029cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029d00: 2020 2022 616e 6420 7769 6c6c 2062 6520     "and will be 
+00029d10: 7265 6d6f 7665 6420 696e 2061 2066 7574  removed in a fut
+00029d20: 7572 6520 7665 7273 696f 6e2e 2055 7365  ure version. Use
+00029d30: 2060 6672 616d 652e 6c6f 635b 7374 7269   `frame.loc[stri
+00029d40: 6e67 5d60 2022 0a20 2020 2020 2020 2020  ng]` ".         
+00029d50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00029d60: 696e 7374 6561 642e 222c 0a20 2020 2020  instead.",.     
+00029d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029d80: 2020 2046 7574 7572 6557 6172 6e69 6e67     FutureWarning
+00029d90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00029da0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00029db0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00029dc0: 726e 2073 656c 662e 6c6f 635b 6b65 795d  rn self.loc[key]
+00029dd0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00029de0: 6572 726f 7220 6973 2072 6169 7365 6420  error is raised 
+00029df0: 6672 6f6d 2070 616e 6461 730a 2020 2020  from pandas.    
+00029e00: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
+00029e10: 656c 662e 5f6d 6574 615b 5f65 7874 7261  elf._meta[_extra
+00029e20: 6374 5f6d 6574 6128 6b65 7929 5d0a 2020  ct_meta(key)].  
+00029e30: 2020 2020 2020 2020 2020 6473 6b20 3d20            dsk = 
+00029e40: 7061 7274 6974 696f 6e77 6973 655f 6772  partitionwise_gr
+00029e50: 6170 6828 6f70 6572 6174 6f72 2e67 6574  aph(operator.get
+00029e60: 6974 656d 2c20 6e61 6d65 2c20 7365 6c66  item, name, self
+00029e70: 2c20 6b65 7929 0a20 2020 2020 2020 2020  , key).         
+00029e80: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+00029e90: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+00029ea0: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
+00029eb0: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+00029ec0: 6573 3d5b 7365 6c66 5d29 0a20 2020 2020  es=[self]).     
+00029ed0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
+00029ee0: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
+00029ef0: 682c 206e 616d 652c 206d 6574 612c 2073  h, name, meta, s
+00029f00: 656c 662e 6469 7669 7369 6f6e 7329 0a20  elf.divisions). 
+00029f10: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+00029f20: 7374 616e 6365 286b 6579 2c20 736c 6963  stance(key, slic
+00029f30: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00029f40: 6672 6f6d 2070 616e 6461 732e 6170 692e  from pandas.api.
+00029f50: 7479 7065 7320 696d 706f 7274 2069 735f  types import is_
+00029f60: 666c 6f61 745f 6474 7970 650a 0a20 2020  float_dtype..   
+00029f70: 2020 2020 2020 2020 2069 735f 696e 7465           is_inte
+00029f80: 6765 725f 736c 6963 6520 3d20 616e 7928  ger_slice = any(
+00029f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029fa0: 2069 7369 6e73 7461 6e63 6528 692c 2049   isinstance(i, I
+00029fb0: 6e74 6567 7261 6c29 2066 6f72 2069 2069  ntegral) for i i
+00029fc0: 6e20 286b 6579 2e73 7461 7274 2c20 6b65  n (key.start, ke
+00029fd0: 792e 7374 6570 2c20 6b65 792e 7374 6f70  y.step, key.stop
+00029fe0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+00029ff0: 2020 2020 2020 2020 2020 2020 2320 536c              # Sl
+0002a000: 6963 696e 6720 7769 7468 2069 6e74 6567  icing with integ
+0002a010: 6572 206c 6162 656c 7320 6973 2061 6c77  er labels is alw
+0002a020: 6179 7320 696c 6f63 2062 6173 6564 2065  ays iloc based e
+0002a030: 7863 6570 7420 666f 7220 610a 2020 2020  xcept for a.    
+0002a040: 2020 2020 2020 2020 2320 666c 6f61 7420          # float 
+0002a050: 696e 6465 7865 7220 666f 7220 736f 6d65  indexer for some
+0002a060: 2072 6561 736f 6e0a 2020 2020 2020 2020   reason.        
+0002a070: 2020 2020 6966 2069 735f 696e 7465 6765      if is_intege
+0002a080: 725f 736c 6963 6520 616e 6420 6e6f 7420  r_slice and not 
+0002a090: 6973 5f66 6c6f 6174 5f64 7479 7065 2873  is_float_dtype(s
+0002a0a0: 656c 662e 696e 6465 782e 6474 7970 6529  elf.index.dtype)
+0002a0b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002a0c0: 2020 2320 4e4f 5445 3a20 7468 6973 2061    # NOTE: this a
+0002a0d0: 6c77 6179 7320 6661 696c 7320 6375 7272  lways fails curr
+0002a0e0: 656e 746c 792c 2061 7320 696c 6f63 2069  ently, as iloc i
+0002a0f0: 7320 6d6f 7374 6c79 0a20 2020 2020 2020  s mostly.       
+0002a100: 2020 2020 2020 2020 2023 2075 6e73 7570           # unsup
+0002a110: 706f 7274 6564 2c20 6275 7420 7765 2063  ported, but we c
+0002a120: 616c 6c20 6974 2061 6e79 7761 7920 6865  all it anyway he
+0002a130: 7265 2066 6f72 2066 7574 7572 652d 7072  re for future-pr
+0002a140: 6f6f 6669 6e67 0a20 2020 2020 2020 2020  oofing.         
+0002a150: 2020 2020 2020 2023 2061 6e64 2065 7272         # and err
+0002a160: 6f72 2d61 7474 7269 6275 7469 6f6e 2070  or-attribution p
+0002a170: 7572 706f 7365 730a 2020 2020 2020 2020  urposes.        
+0002a180: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0002a190: 656c 662e 696c 6f63 5b6b 6579 5d0a 2020  elf.iloc[key].  
+0002a1a0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0002a1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a1c0: 7265 7475 726e 2073 656c 662e 6c6f 635b  return self.loc[
+0002a1d0: 6b65 795d 0a0a 2020 2020 2020 2020 6966  key]..        if
+0002a1e0: 2069 7369 6e73 7461 6e63 6528 6b65 792c   isinstance(key,
+0002a1f0: 2028 6e70 2e6e 6461 7272 6179 2c20 6c69   (np.ndarray, li
+0002a200: 7374 2929 206f 7220 280a 2020 2020 2020  st)) or (.      
+0002a210: 2020 2020 2020 6e6f 7420 6973 5f64 6173        not is_das
+0002a220: 6b5f 636f 6c6c 6563 7469 6f6e 286b 6579  k_collection(key
+0002a230: 2920 616e 6420 2869 735f 7365 7269 6573  ) and (is_series
+0002a240: 5f6c 696b 6528 6b65 7929 206f 7220 6973  _like(key) or is
+0002a250: 5f69 6e64 6578 5f6c 696b 6528 6b65 7929  _index_like(key)
+0002a260: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
+0002a270: 2020 2020 2020 2020 2023 2065 7272 6f72           # error
+0002a280: 2069 7320 7261 6973 6564 2066 726f 6d20   is raised from 
+0002a290: 7061 6e64 6173 0a20 2020 2020 2020 2020  pandas.         
+0002a2a0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+0002a2b0: 6d65 7461 5b5f 6578 7472 6163 745f 6d65  meta[_extract_me
+0002a2c0: 7461 286b 6579 295d 0a0a 2020 2020 2020  ta(key)]..      
+0002a2d0: 2020 2020 2020 6473 6b20 3d20 7061 7274        dsk = part
+0002a2e0: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
+0002a2f0: 6f70 6572 6174 6f72 2e67 6574 6974 656d  operator.getitem
+0002a300: 2c20 6e61 6d65 2c20 7365 6c66 2c20 6b65  , name, self, ke
+0002a310: 7929 0a20 2020 2020 2020 2020 2020 2067  y).            g
+0002a320: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+0002a330: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+0002a340: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
+0002a350: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
+0002a360: 7365 6c66 5d29 0a20 2020 2020 2020 2020  self]).         
+0002a370: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
+0002a380: 5f6f 626a 6563 7428 6772 6170 682c 206e  _object(graph, n
+0002a390: 616d 652c 206d 6574 612c 2073 656c 662e  ame, meta, self.
+0002a3a0: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
+0002a3b0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0002a3c0: 286b 6579 2c20 5365 7269 6573 293a 0a20  (key, Series):. 
+0002a3d0: 2020 2020 2020 2020 2020 2023 2064 6f20             # do 
+0002a3e0: 6e6f 7420 7065 7266 6f72 6d20 6475 6d6d  not perform dumm
+0002a3f0: 7920 6361 6c63 756c 6174 696f 6e2c 2061  y calculation, a
+0002a400: 7320 636f 6c75 6d6e 7320 7769 6c6c 206e  s columns will n
+0002a410: 6f74 2062 6520 6368 616e 6765 642e 0a20  ot be changed.. 
+0002a420: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0002a430: 6c66 2e64 6976 6973 696f 6e73 2021 3d20  lf.divisions != 
+0002a440: 6b65 792e 6469 7669 7369 6f6e 733a 0a20  key.divisions:. 
+0002a450: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002a460: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+0002a470: 6d65 2e6d 756c 7469 2069 6d70 6f72 7420  me.multi import 
+0002a480: 5f6d 6179 6265 5f61 6c69 676e 5f70 6172  _maybe_align_par
+0002a490: 7469 7469 6f6e 730a 0a20 2020 2020 2020  titions..       
+0002a4a0: 2020 2020 2020 2020 2073 656c 662c 206b           self, k
+0002a4b0: 6579 203d 205f 6d61 7962 655f 616c 6967  ey = _maybe_alig
+0002a4c0: 6e5f 7061 7274 6974 696f 6e73 285b 7365  n_partitions([se
+0002a4d0: 6c66 2c20 6b65 795d 290a 2020 2020 2020  lf, key]).      
+0002a4e0: 2020 2020 2020 6473 6b20 3d20 7061 7274        dsk = part
+0002a4f0: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
+0002a500: 6f70 6572 6174 6f72 2e67 6574 6974 656d  operator.getitem
+0002a510: 2c20 6e61 6d65 2c20 7365 6c66 2c20 6b65  , name, self, ke
+0002a520: 7929 0a20 2020 2020 2020 2020 2020 2067  y).            g
+0002a530: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+0002a540: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+0002a550: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
+0002a560: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
+0002a570: 7365 6c66 2c20 6b65 795d 290a 2020 2020  self, key]).    
+0002a580: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+0002a590: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
+0002a5a0: 7068 2c20 6e61 6d65 2c20 7365 6c66 2c20  ph, name, self, 
+0002a5b0: 7365 6c66 2e64 6976 6973 696f 6e73 290a  self.divisions).
+0002a5c0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0002a5d0: 7461 6e63 6528 6b65 792c 2044 6174 6146  tance(key, DataF
+0002a5e0: 7261 6d65 293a 0a20 2020 2020 2020 2020  rame):.         
+0002a5f0: 2020 2072 6574 7572 6e20 7365 6c66 2e77     return self.w
+0002a600: 6865 7265 286b 6579 2c20 6e70 2e6e 616e  here(key, np.nan
+0002a610: 290a 0a20 2020 2020 2020 2072 6169 7365  )..        raise
+0002a620: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+0002a630: 7272 6f72 286b 6579 290a 0a20 2020 2064  rror(key)..    d
+0002a640: 6566 205f 5f73 6574 6974 656d 5f5f 2873  ef __setitem__(s
+0002a650: 656c 662c 206b 6579 2c20 7661 6c75 6529  elf, key, value)
+0002a660: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
+0002a670: 6e73 7461 6e63 6528 6b65 792c 2028 7475  nstance(key, (tu
+0002a680: 706c 652c 206c 6973 7429 2920 616e 6420  ple, list)) and 
+0002a690: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
+0002a6a0: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
+0002a6b0: 2020 2020 2020 2020 2020 6466 203d 2073            df = s
+0002a6c0: 656c 662e 6173 7369 676e 282a 2a7b 6b3a  elf.assign(**{k:
+0002a6d0: 2076 616c 7565 5b63 5d20 666f 7220 6b2c   value[c] for k,
+0002a6e0: 2063 2069 6e20 7a69 7028 6b65 792c 2076   c in zip(key, v
+0002a6f0: 616c 7565 2e63 6f6c 756d 6e73 297d 290a  alue.columns)}).
+0002a700: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
+0002a710: 696e 7374 616e 6365 286b 6579 2c20 7064  instance(key, pd
+0002a720: 2e49 6e64 6578 2920 616e 6420 6e6f 7420  .Index) and not 
+0002a730: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
+0002a740: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
+0002a750: 2020 2020 2020 2020 2020 6b65 7920 3d20            key = 
+0002a760: 6c69 7374 286b 6579 290a 2020 2020 2020  list(key).      
+0002a770: 2020 2020 2020 6466 203d 2073 656c 662e        df = self.
+0002a780: 6173 7369 676e 282a 2a7b 6b3a 2076 616c  assign(**{k: val
+0002a790: 7565 2066 6f72 206b 2069 6e20 6b65 797d  ue for k in key}
+0002a7a0: 290a 2020 2020 2020 2020 656c 6966 2028  ).        elif (
+0002a7b0: 0a20 2020 2020 2020 2020 2020 2069 735f  .            is_
+0002a7c0: 6461 7461 6672 616d 655f 6c69 6b65 286b  dataframe_like(k
+0002a7d0: 6579 290a 2020 2020 2020 2020 2020 2020  ey).            
+0002a7e0: 6f72 2069 735f 7365 7269 6573 5f6c 696b  or is_series_lik
+0002a7f0: 6528 6b65 7929 0a20 2020 2020 2020 2020  e(key).         
+0002a800: 2020 206f 7220 6973 696e 7374 616e 6365     or isinstance
+0002a810: 286b 6579 2c20 2844 6174 6146 7261 6d65  (key, (DataFrame
+0002a820: 2c20 5365 7269 6573 2929 0a20 2020 2020  , Series)).     
+0002a830: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+0002a840: 2020 6466 203d 2073 656c 662e 7768 6572    df = self.wher
+0002a850: 6528 7e6b 6579 2c20 7661 6c75 6529 0a20  e(~key, value). 
+0002a860: 2020 2020 2020 2065 6c69 6620 6e6f 7420         elif not 
+0002a870: 6973 696e 7374 616e 6365 286b 6579 2c20  isinstance(key, 
+0002a880: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
+0002a890: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+0002a8a0: 6d65 6e74 6564 4572 726f 7228 6622 4974  mentedError(f"It
+0002a8b0: 656d 2061 7373 6967 6e6d 656e 7420 7769  em assignment wi
+0002a8c0: 7468 207b 7479 7065 286b 6579 297d 206e  th {type(key)} n
+0002a8d0: 6f74 2073 7570 706f 7274 6564 2229 0a20  ot supported"). 
+0002a8e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002a8f0: 2020 2020 2020 2020 2064 6620 3d20 7365           df = se
+0002a900: 6c66 2e61 7373 6967 6e28 2a2a 7b6b 6579  lf.assign(**{key
+0002a910: 3a20 7661 6c75 657d 290a 0a20 2020 2020  : value})..     
+0002a920: 2020 2073 656c 662e 6461 736b 203d 2064     self.dask = d
+0002a930: 662e 6461 736b 0a20 2020 2020 2020 2073  f.dask.        s
+0002a940: 656c 662e 5f6e 616d 6520 3d20 6466 2e5f  elf._name = df._
+0002a950: 6e61 6d65 0a20 2020 2020 2020 2073 656c  name.        sel
+0002a960: 662e 5f6d 6574 6120 3d20 6466 2e5f 6d65  f._meta = df._me
+0002a970: 7461 0a20 2020 2020 2020 2073 656c 662e  ta.        self.
+0002a980: 5f64 6976 6973 696f 6e73 203d 2064 662e  _divisions = df.
+0002a990: 6469 7669 7369 6f6e 730a 0a20 2020 2064  divisions..    d
+0002a9a0: 6566 205f 5f64 656c 6974 656d 5f5f 2873  ef __delitem__(s
+0002a9b0: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
+0002a9c0: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
+0002a9d0: 2e64 726f 7028 5b6b 6579 5d2c 2061 7869  .drop([key], axi
+0002a9e0: 733d 3129 0a20 2020 2020 2020 2073 656c  s=1).        sel
+0002a9f0: 662e 6461 736b 203d 2072 6573 756c 742e  f.dask = result.
+0002aa00: 6461 736b 0a20 2020 2020 2020 2073 656c  dask.        sel
+0002aa10: 662e 5f6e 616d 6520 3d20 7265 7375 6c74  f._name = result
+0002aa20: 2e5f 6e61 6d65 0a20 2020 2020 2020 2073  ._name.        s
+0002aa30: 656c 662e 5f6d 6574 6120 3d20 7265 7375  elf._meta = resu
+0002aa40: 6c74 2e5f 6d65 7461 0a0a 2020 2020 6465  lt._meta..    de
+0002aa50: 6620 5f5f 7365 7461 7474 725f 5f28 7365  f __setattr__(se
+0002aa60: 6c66 2c20 6b65 792c 2076 616c 7565 293a  lf, key, value):
+0002aa70: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+0002aa80: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+0002aa90: 7320 3d20 6f62 6a65 6374 2e5f 5f67 6574  s = object.__get
+0002aaa0: 6174 7472 6962 7574 655f 5f28 7365 6c66  attribute__(self
+0002aab0: 2c20 225f 6d65 7461 2229 2e63 6f6c 756d  , "_meta").colum
+0002aac0: 6e73 0a20 2020 2020 2020 2065 7863 6570  ns.        excep
+0002aad0: 7420 4174 7472 6962 7574 6545 7272 6f72  t AttributeError
+0002aae0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+0002aaf0: 6c75 6d6e 7320 3d20 2829 0a0a 2020 2020  lumns = ()..    
+0002ab00: 2020 2020 2320 6578 636c 7564 6520 7072      # exclude pr
+0002ab10: 6f74 6563 7465 6420 6174 7472 6962 7574  otected attribut
+0002ab20: 6573 2066 726f 6d20 7365 7469 7465 6d0a  es from setitem.
+0002ab30: 2020 2020 2020 2020 6966 206b 6579 2069          if key i
+0002ab40: 6e20 636f 6c75 6d6e 7320 616e 6420 6b65  n columns and ke
+0002ab50: 7920 6e6f 7420 696e 205b 2264 6976 6973  y not in ["divis
+0002ab60: 696f 6e73 222c 2022 6461 736b 222c 2022  ions", "dask", "
+0002ab70: 5f6e 616d 6522 2c20 225f 6d65 7461 225d  _name", "_meta"]
+0002ab80: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0002ab90: 6c66 5b6b 6579 5d20 3d20 7661 6c75 650a  lf[key] = value.
+0002aba0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002abb0: 2020 2020 2020 2020 2020 6f62 6a65 6374            object
+0002abc0: 2e5f 5f73 6574 6174 7472 5f5f 2873 656c  .__setattr__(sel
+0002abd0: 662c 206b 6579 2c20 7661 6c75 6529 0a0a  f, key, value)..
+0002abe0: 2020 2020 6465 6620 5f5f 6765 7461 7474      def __getatt
+0002abf0: 725f 5f28 7365 6c66 2c20 6b65 7929 3a0a  r__(self, key):.
+0002ac00: 2020 2020 2020 2020 6966 206b 6579 2069          if key i
+0002ac10: 6e20 7365 6c66 2e63 6f6c 756d 6e73 3a0a  n self.columns:.
+0002ac20: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002ac30: 726e 2073 656c 665b 6b65 795d 0a20 2020  rn self[key].   
+0002ac40: 2020 2020 2065 6c69 6620 6b65 7920 3d3d       elif key ==
+0002ac50: 2022 656d 7074 7922 3a0a 2020 2020 2020   "empty":.      
+0002ac60: 2020 2020 2020 2320 7365 6c66 2e65 6d70        # self.emp
+0002ac70: 7479 2072 6169 7365 7320 4174 7472 6962  ty raises Attrib
+0002ac80: 7574 654e 6f74 496d 706c 656d 656e 7465  uteNotImplemente
+0002ac90: 6445 7272 6f72 2c20 7768 6963 6820 696e  dError, which in
+0002aca0: 636c 7564 6573 0a20 2020 2020 2020 2020  cludes.         
+0002acb0: 2020 2023 2041 7474 7269 6275 7465 4572     # AttributeEr
+0002acc0: 726f 722c 2077 6869 6368 206d 6561 6e73  ror, which means
+0002acd0: 2077 6520 656e 6420 7570 2068 6572 6520   we end up here 
+0002ace0: 696e 2073 656c 662e 5f5f 6765 7461 7474  in self.__getatt
+0002acf0: 725f 5f2c 0a20 2020 2020 2020 2020 2020  r__,.           
+0002ad00: 2023 2062 6563 6175 7365 2044 6174 6146   # because DataF
+0002ad10: 7261 6d65 2e5f 5f67 6574 6174 7472 6962  rame.__getattrib
+0002ad20: 7574 655f 5f20 646f 6573 6e27 7420 7468  ute__ doesn't th
+0002ad30: 696e 6b20 7468 6520 6174 7472 6962 7574  ink the attribut
+0002ad40: 6520 6578 6973 7473 0a20 2020 2020 2020  e exists.       
+0002ad50: 2020 2020 2023 2061 6e64 2075 7365 7320       # and uses 
+0002ad60: 5f5f 6765 7461 7474 725f 5f20 6173 2074  __getattr__ as t
+0002ad70: 6865 2066 616c 6c62 6163 6b2e 2053 6f2c  he fallback. So,
+0002ad80: 2067 6574 2060 7365 6c66 2e65 6d70 7479   get `self.empty
+0002ad90: 6020 6d6f 7265 0a20 2020 2020 2020 2020  ` more.         
+0002ada0: 2020 2023 2066 6f72 6365 6675 6c6c 7920     # forcefully 
+0002adb0: 7669 6120 6f62 6a65 6374 2e5f 5f67 6574  via object.__get
+0002adc0: 6174 7472 6962 7574 655f 5f20 746f 2072  attribute__ to r
+0002add0: 6169 7365 2069 6e66 6f72 6d61 7469 7665  aise informative
+0002ade0: 2065 7272 6f72 2e0a 2020 2020 2020 2020   error..        
+0002adf0: 2020 2020 6f62 6a65 6374 2e5f 5f67 6574      object.__get
+0002ae00: 6174 7472 6962 7574 655f 5f28 7365 6c66  attribute__(self
+0002ae10: 2c20 6b65 7929 0a20 2020 2020 2020 2065  , key).        e
+0002ae20: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002ae30: 2072 6169 7365 2041 7474 7269 6275 7465   raise Attribute
+0002ae40: 4572 726f 7228 2227 4461 7461 4672 616d  Error("'DataFram
+0002ae50: 6527 206f 626a 6563 7420 6861 7320 6e6f  e' object has no
+0002ae60: 2061 7474 7269 6275 7465 2025 7222 2025   attribute %r" %
+0002ae70: 206b 6579 290a 0a20 2020 2064 6566 205f   key)..    def _
+0002ae80: 5f64 6972 5f5f 2873 656c 6629 3a0a 2020  _dir__(self):.  
+0002ae90: 2020 2020 2020 6f20 3d20 7365 7428 6469        o = set(di
+0002aea0: 7228 7479 7065 2873 656c 6629 2929 0a20  r(type(self))). 
+0002aeb0: 2020 2020 2020 206f 2e75 7064 6174 6528         o.update(
+0002aec0: 7365 6c66 2e5f 5f64 6963 745f 5f29 0a20  self.__dict__). 
+0002aed0: 2020 2020 2020 206f 2e75 7064 6174 6528         o.update(
+0002aee0: 6320 666f 7220 6320 696e 2073 656c 662e  c for c in self.
+0002aef0: 636f 6c75 6d6e 7320 6966 2028 6973 696e  columns if (isin
+0002af00: 7374 616e 6365 2863 2c20 7374 7229 2061  stance(c, str) a
+0002af10: 6e64 2063 2e69 7369 6465 6e74 6966 6965  nd c.isidentifie
+0002af20: 7228 2929 290a 2020 2020 2020 2020 7265  r())).        re
+0002af30: 7475 726e 206c 6973 7428 6f29 0a0a 2020  turn list(o)..  
+0002af40: 2020 6465 6620 5f5f 6974 6572 5f5f 2873    def __iter__(s
+0002af50: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+0002af60: 7475 726e 2069 7465 7228 7365 6c66 2e5f  turn iter(self._
+0002af70: 6d65 7461 290a 0a20 2020 2064 6566 205f  meta)..    def _
+0002af80: 6970 7974 686f 6e5f 6b65 795f 636f 6d70  ipython_key_comp
+0002af90: 6c65 7469 6f6e 735f 2873 656c 6629 3a0a  letions_(self):.
+0002afa0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+0002afb0: 6574 686f 6473 2e74 6f6c 6973 7428 7365  ethods.tolist(se
+0002afc0: 6c66 2e63 6f6c 756d 6e73 290a 0a20 2020  lf.columns)..   
+0002afd0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0002afe0: 6566 206e 6469 6d28 7365 6c66 293a 0a20  ef ndim(self):. 
+0002aff0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0002b000: 2064 696d 656e 7369 6f6e 616c 6974 7922   dimensionality"
+0002b010: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0002b020: 6e20 320a 0a20 2020 2040 7072 6f70 6572  n 2..    @proper
+0002b030: 7479 0a20 2020 2064 6566 2073 6861 7065  ty.    def shape
+0002b040: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0002b050: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+0002b060: 726e 2061 2074 7570 6c65 2072 6570 7265  rn a tuple repre
+0002b070: 7365 6e74 696e 6720 7468 6520 6469 6d65  senting the dime
+0002b080: 6e73 696f 6e61 6c69 7479 206f 6620 7468  nsionality of th
+0002b090: 6520 4461 7461 4672 616d 652e 0a0a 2020  e DataFrame...  
+0002b0a0: 2020 2020 2020 5468 6520 6e75 6d62 6572        The number
+0002b0b0: 206f 6620 726f 7773 2069 7320 6120 4465   of rows is a De
+0002b0c0: 6c61 7965 6420 7265 7375 6c74 2e20 5468  layed result. Th
+0002b0d0: 6520 6e75 6d62 6572 206f 6620 636f 6c75  e number of colu
+0002b0e0: 6d6e 730a 2020 2020 2020 2020 6973 2061  mns.        is a
+0002b0f0: 2063 6f6e 6372 6574 6520 696e 7465 6765   concrete intege
+0002b100: 722e 0a0a 2020 2020 2020 2020 4578 616d  r...        Exam
+0002b110: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
+0002b120: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
+0002b130: 3e20 6466 2e73 697a 6520 2023 2064 6f63  > df.size  # doc
+0002b140: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
+0002b150: 2020 2020 2844 656c 6179 6564 2827 696e      (Delayed('in
+0002b160: 742d 3037 6630 3630 3735 2d35 6563 632d  t-07f06075-5ecc-
+0002b170: 3464 3737 2d38 3137 652d 3633 6336 3961  4d77-817e-63c69a
+0002b180: 3931 3838 6138 2729 2c20 3229 0a20 2020  9188a8'), 2).   
+0002b190: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0002b1a0: 2063 6f6c 5f73 697a 6520 3d20 6c65 6e28   col_size = len(
+0002b1b0: 7365 6c66 2e63 6f6c 756d 6e73 290a 2020  self.columns).  
+0002b1c0: 2020 2020 2020 6966 2063 6f6c 5f73 697a        if col_siz
+0002b1d0: 6520 3d3d 2030 3a0a 2020 2020 2020 2020  e == 0:.        
+0002b1e0: 2020 2020 7265 7475 726e 2028 7365 6c66      return (self
+0002b1f0: 2e69 6e64 6578 2e73 6861 7065 5b30 5d2c  .index.shape[0],
+0002b200: 2030 290a 2020 2020 2020 2020 726f 775f   0).        row_
+0002b210: 7369 7a65 203d 2064 656c 6179 6564 2869  size = delayed(i
+0002b220: 6e74 2928 7365 6c66 2e73 697a 6520 2f20  nt)(self.size / 
+0002b230: 636f 6c5f 7369 7a65 290a 2020 2020 2020  col_size).      
+0002b240: 2020 7265 7475 726e 2028 726f 775f 7369    return (row_si
+0002b250: 7a65 2c20 636f 6c5f 7369 7a65 290a 0a20  ze, col_size).. 
+0002b260: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0002b270: 2064 6566 2064 7479 7065 7328 7365 6c66   def dtypes(self
+0002b280: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+0002b290: 7475 726e 2064 6174 6120 7479 7065 7322  turn data types"
+0002b2a0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0002b2b0: 6e20 7365 6c66 2e5f 6d65 7461 2e64 7479  n self._meta.dty
+0002b2c0: 7065 730a 0a20 2020 2040 6465 7269 7665  pes..    @derive
+0002b2d0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0002b2e0: 616d 6529 0a20 2020 2064 6566 2067 6574  ame).    def get
+0002b2f0: 5f64 7479 7065 5f63 6f75 6e74 7328 7365  _dtype_counts(se
+0002b300: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+0002b310: 7572 6e20 7365 6c66 2e5f 6d65 7461 2e67  urn self._meta.g
+0002b320: 6574 5f64 7479 7065 5f63 6f75 6e74 7328  et_dtype_counts(
+0002b330: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0002b340: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0002b350: 6529 0a20 2020 2064 6566 2067 6574 5f66  e).    def get_f
+0002b360: 7479 7065 5f63 6f75 6e74 7328 7365 6c66  type_counts(self
+0002b370: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0002b380: 6e20 7365 6c66 2e5f 6d65 7461 2e67 6574  n self._meta.get
+0002b390: 5f66 7479 7065 5f63 6f75 6e74 7328 290a  _ftype_counts().
+0002b3a0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0002b3b0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+0002b3c0: 0a20 2020 2064 6566 2073 656c 6563 745f  .    def select_
+0002b3d0: 6474 7970 6573 2873 656c 662c 2069 6e63  dtypes(self, inc
+0002b3e0: 6c75 6465 3d4e 6f6e 652c 2065 7863 6c75  lude=None, exclu
+0002b3f0: 6465 3d4e 6f6e 6529 3a0a 2020 2020 2020  de=None):.      
+0002b400: 2020 6373 203d 2073 656c 662e 5f6d 6574    cs = self._met
+0002b410: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
+0002b420: 696e 636c 7564 653d 696e 636c 7564 652c  include=include,
+0002b430: 2065 7863 6c75 6465 3d65 7863 6c75 6465   exclude=exclude
+0002b440: 292e 636f 6c75 6d6e 730a 2020 2020 2020  ).columns.      
+0002b450: 2020 7265 7475 726e 2073 656c 665b 6c69    return self[li
+0002b460: 7374 2863 7329 5d0a 0a20 2020 2064 6566  st(cs)]..    def
+0002b470: 2073 6f72 745f 7661 6c75 6573 280a 2020   sort_values(.  
+0002b480: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0002b490: 2020 2020 6279 3a20 7374 7220 7c20 6c69      by: str | li
+0002b4a0: 7374 5b73 7472 5d2c 0a20 2020 2020 2020  st[str],.       
+0002b4b0: 206e 7061 7274 6974 696f 6e73 3a20 696e   npartitions: in
+0002b4c0: 7420 7c20 4c69 7465 7261 6c5b 2261 7574  t | Literal["aut
+0002b4d0: 6f22 5d20 7c20 4e6f 6e65 203d 204e 6f6e  o"] | None = Non
+0002b4e0: 652c 0a20 2020 2020 2020 2061 7363 656e  e,.        ascen
+0002b4f0: 6469 6e67 3a20 626f 6f6c 203d 2054 7275  ding: bool = Tru
+0002b500: 652c 0a20 2020 2020 2020 206e 615f 706f  e,.        na_po
+0002b510: 7369 7469 6f6e 3a20 4c69 7465 7261 6c5b  sition: Literal[
+0002b520: 2266 6972 7374 225d 207c 204c 6974 6572  "first"] | Liter
+0002b530: 616c 5b22 6c61 7374 225d 203d 2022 6c61  al["last"] = "la
+0002b540: 7374 222c 0a20 2020 2020 2020 2073 6f72  st",.        sor
+0002b550: 745f 6675 6e63 7469 6f6e 3a20 4361 6c6c  t_function: Call
+0002b560: 6162 6c65 5b5b 7064 2e44 6174 6146 7261  able[[pd.DataFra
+0002b570: 6d65 5d2c 2070 642e 4461 7461 4672 616d  me], pd.DataFram
+0002b580: 655d 207c 204e 6f6e 6520 3d20 4e6f 6e65  e] | None = None
+0002b590: 2c0a 2020 2020 2020 2020 736f 7274 5f66  ,.        sort_f
+0002b5a0: 756e 6374 696f 6e5f 6b77 6172 6773 3a20  unction_kwargs: 
+0002b5b0: 4d61 7070 696e 675b 7374 722c 2041 6e79  Mapping[str, Any
+0002b5c0: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
+0002b5d0: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
+0002b5e0: 732c 0a20 2020 2029 202d 3e20 4461 7461  s,.    ) -> Data
+0002b5f0: 4672 616d 653a 0a20 2020 2020 2020 2022  Frame:.        "
+0002b600: 2222 536f 7274 2074 6865 2064 6174 6173  ""Sort the datas
+0002b610: 6574 2062 7920 6120 7369 6e67 6c65 2063  et by a single c
+0002b620: 6f6c 756d 6e2e 0a0a 2020 2020 2020 2020  olumn...        
+0002b630: 536f 7274 696e 6720 6120 7061 7261 6c6c  Sorting a parall
+0002b640: 656c 2064 6174 6173 6574 2072 6571 7569  el dataset requi
+0002b650: 7265 7320 6578 7065 6e73 6976 6520 7368  res expensive sh
+0002b660: 7566 666c 6573 2061 6e64 2069 7320 6765  uffles and is ge
+0002b670: 6e65 7261 6c6c 790a 2020 2020 2020 2020  nerally.        
+0002b680: 6e6f 7420 7265 636f 6d6d 656e 6465 642e  not recommended.
+0002b690: 2053 6565 2060 6073 6574 5f69 6e64 6578   See ``set_index
+0002b6a0: 6060 2066 6f72 2069 6d70 6c65 6d65 6e74  `` for implement
+0002b6b0: 6174 696f 6e20 6465 7461 696c 732e 0a0a  ation details...
+0002b6c0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0002b6d0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0002b6e0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6279  -----.        by
+0002b6f0: 3a20 7374 7220 6f72 206c 6973 745b 7374  : str or list[st
+0002b700: 725d 0a20 2020 2020 2020 2020 2020 2043  r].            C
+0002b710: 6f6c 756d 6e28 7329 2074 6f20 736f 7274  olumn(s) to sort
+0002b720: 2062 792e 0a20 2020 2020 2020 206e 7061   by..        npa
+0002b730: 7274 6974 696f 6e73 3a20 696e 742c 204e  rtitions: int, N
+0002b740: 6f6e 652c 206f 7220 2761 7574 6f27 0a20  one, or 'auto'. 
+0002b750: 2020 2020 2020 2020 2020 2054 6865 2069             The i
+0002b760: 6465 616c 206e 756d 6265 7220 6f66 206f  deal number of o
+0002b770: 7574 7075 7420 7061 7274 6974 696f 6e73  utput partitions
+0002b780: 2e20 4966 204e 6f6e 652c 2075 7365 2074  . If None, use t
+0002b790: 6865 2073 616d 6520 6173 0a20 2020 2020  he same as.     
+0002b7a0: 2020 2020 2020 2074 6865 2069 6e70 7574         the input
+0002b7b0: 2e20 4966 2027 6175 746f 2720 7468 656e  . If 'auto' then
+0002b7c0: 2064 6563 6964 6520 6279 206d 656d 6f72   decide by memor
+0002b7d0: 7920 7573 652e 0a20 2020 2020 2020 2061  y use..        a
+0002b7e0: 7363 656e 6469 6e67 3a20 626f 6f6c 2c20  scending: bool, 
+0002b7f0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0002b800: 2020 2020 2053 6f72 7420 6173 6365 6e64       Sort ascend
+0002b810: 696e 6720 7673 2e20 6465 7363 656e 6469  ing vs. descendi
+0002b820: 6e67 2e0a 2020 2020 2020 2020 2020 2020  ng..            
+0002b830: 4465 6661 756c 7473 2074 6f20 5472 7565  Defaults to True
+0002b840: 2e0a 2020 2020 2020 2020 6e61 5f70 6f73  ..        na_pos
+0002b850: 6974 696f 6e3a 207b 276c 6173 7427 2c20  ition: {'last', 
+0002b860: 2766 6972 7374 277d 2c20 6f70 7469 6f6e  'first'}, option
+0002b870: 616c 0a20 2020 2020 2020 2020 2020 2050  al.            P
+0002b880: 7574 7320 4e61 4e73 2061 7420 7468 6520  uts NaNs at the 
+0002b890: 6265 6769 6e6e 696e 6720 6966 2027 6669  beginning if 'fi
+0002b8a0: 7273 7427 2c20 7075 7473 204e 614e 2061  rst', puts NaN a
+0002b8b0: 7420 7468 6520 656e 6420 6966 2027 6c61  t the end if 'la
+0002b8c0: 7374 272e 0a20 2020 2020 2020 2020 2020  st'..           
+0002b8d0: 2044 6566 6175 6c74 7320 746f 2027 6c61   Defaults to 'la
+0002b8e0: 7374 272e 0a20 2020 2020 2020 2073 6f72  st'..        sor
+0002b8f0: 745f 6675 6e63 7469 6f6e 3a20 6675 6e63  t_function: func
+0002b900: 7469 6f6e 2c20 6f70 7469 6f6e 616c 0a20  tion, optional. 
+0002b910: 2020 2020 2020 2020 2020 2053 6f72 7469             Sorti
+0002b920: 6e67 2066 756e 6374 696f 6e20 746f 2075  ng function to u
+0002b930: 7365 2077 6865 6e20 736f 7274 696e 6720  se when sorting 
+0002b940: 756e 6465 726c 7969 6e67 2070 6172 7469  underlying parti
+0002b950: 7469 6f6e 732e 0a20 2020 2020 2020 2020  tions..         
+0002b960: 2020 2049 6620 4e6f 6e65 2c20 6465 6661     If None, defa
+0002b970: 756c 7473 2074 6f20 6060 4d2e 736f 7274  ults to ``M.sort
+0002b980: 5f76 616c 7565 7360 6020 2874 6865 2070  _values`` (the p
+0002b990: 6172 7469 7469 6f6e 206c 6962 7261 7279  artition library
+0002b9a0: 2773 0a20 2020 2020 2020 2020 2020 2069  's.            i
+0002b9b0: 6d70 6c65 6d65 6e74 6174 696f 6e20 6f66  mplementation of
+0002b9c0: 2060 6073 6f72 745f 7661 6c75 6573 6060   ``sort_values``
+0002b9d0: 292e 0a20 2020 2020 2020 2073 6f72 745f  )..        sort_
+0002b9e0: 6675 6e63 7469 6f6e 5f6b 7761 7267 733a  function_kwargs:
+0002b9f0: 2064 6963 742c 206f 7074 696f 6e61 6c0a   dict, optional.
+0002ba00: 2020 2020 2020 2020 2020 2020 4164 6469              Addi
+0002ba10: 7469 6f6e 616c 206b 6579 776f 7264 2061  tional keyword a
+0002ba20: 7267 756d 656e 7473 2074 6f20 7061 7373  rguments to pass
+0002ba30: 2074 6f20 7468 6520 7061 7274 6974 696f   to the partitio
+0002ba40: 6e20 736f 7274 696e 6720 6675 6e63 7469  n sorting functi
+0002ba50: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
+0002ba60: 4279 2064 6566 6175 6c74 2c20 6060 6279  By default, ``by
+0002ba70: 6060 2c20 6060 6173 6365 6e64 696e 6760  ``, ``ascending`
+0002ba80: 602c 2061 6e64 2060 606e 615f 706f 7369  `, and ``na_posi
+0002ba90: 7469 6f6e 6060 2061 7265 2070 726f 7669  tion`` are provi
+0002baa0: 6465 642e 0a0a 2020 2020 2020 2020 4578  ded...        Ex
+0002bab0: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
+0002bac0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0002bad0: 3e3e 3e20 6466 3220 3d20 6466 2e73 6f72  >>> df2 = df.sor
+0002bae0: 745f 7661 6c75 6573 2827 7827 2920 2023  t_values('x')  #
+0002baf0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
+0002bb00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002bb10: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+0002bb20: 7461 6672 616d 652e 7368 7566 666c 6520  taframe.shuffle 
+0002bb30: 696d 706f 7274 2073 6f72 745f 7661 6c75  import sort_valu
+0002bb40: 6573 0a0a 2020 2020 2020 2020 7265 7475  es..        retu
+0002bb50: 726e 2073 6f72 745f 7661 6c75 6573 280a  rn sort_values(.
+0002bb60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002bb70: 2c0a 2020 2020 2020 2020 2020 2020 6279  ,.            by
+0002bb80: 2c0a 2020 2020 2020 2020 2020 2020 6173  ,.            as
+0002bb90: 6365 6e64 696e 673d 6173 6365 6e64 696e  cending=ascendin
+0002bba0: 672c 0a20 2020 2020 2020 2020 2020 206e  g,.            n
+0002bbb0: 7061 7274 6974 696f 6e73 3d6e 7061 7274  partitions=npart
+0002bbc0: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
+0002bbd0: 2020 2020 6e61 5f70 6f73 6974 696f 6e3d      na_position=
+0002bbe0: 6e61 5f70 6f73 6974 696f 6e2c 0a20 2020  na_position,.   
+0002bbf0: 2020 2020 2020 2020 2073 6f72 745f 6675           sort_fu
+0002bc00: 6e63 7469 6f6e 3d73 6f72 745f 6675 6e63  nction=sort_func
+0002bc10: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+0002bc20: 2020 736f 7274 5f66 756e 6374 696f 6e5f    sort_function_
+0002bc30: 6b77 6172 6773 3d73 6f72 745f 6675 6e63  kwargs=sort_func
+0002bc40: 7469 6f6e 5f6b 7761 7267 732c 0a20 2020  tion_kwargs,.   
+0002bc50: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
+0002bc60: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
+0002bc70: 2020 6465 6620 7365 745f 696e 6465 7828    def set_index(
+0002bc80: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0002bc90: 2020 2020 2020 206f 7468 6572 3a20 7374         other: st
+0002bca0: 7220 7c20 5365 7269 6573 2c0a 2020 2020  r | Series,.    
+0002bcb0: 2020 2020 6472 6f70 3a20 626f 6f6c 203d      drop: bool =
+0002bcc0: 2054 7275 652c 0a20 2020 2020 2020 2073   True,.        s
+0002bcd0: 6f72 7465 643a 2062 6f6f 6c20 3d20 4661  orted: bool = Fa
+0002bce0: 6c73 652c 0a20 2020 2020 2020 206e 7061  lse,.        npa
+0002bcf0: 7274 6974 696f 6e73 3a20 696e 7420 7c20  rtitions: int | 
+0002bd00: 4c69 7465 7261 6c5b 2261 7574 6f22 5d20  Literal["auto"] 
+0002bd10: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+0002bd20: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+0002bd30: 3a20 5365 7175 656e 6365 207c 204e 6f6e  : Sequence | Non
+0002bd40: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+0002bd50: 2020 696e 706c 6163 653a 2062 6f6f 6c20    inplace: bool 
+0002bd60: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
+0002bd70: 202a 2a6b 7761 7267 732c 0a20 2020 2029   **kwargs,.    )
+0002bd80: 3a0a 2020 2020 2020 2020 2222 2253 6574  :.        """Set
+0002bd90: 2074 6865 2044 6174 6146 7261 6d65 2069   the DataFrame i
+0002bda0: 6e64 6578 2028 726f 7720 6c61 6265 6c73  ndex (row labels
+0002bdb0: 2920 7573 696e 6720 616e 2065 7869 7374  ) using an exist
+0002bdc0: 696e 6720 636f 6c75 6d6e 2e0a 0a20 2020  ing column...   
+0002bdd0: 2020 2020 2054 6869 7320 7265 616c 6967       This realig
+0002bde0: 6e73 2074 6865 2064 6174 6173 6574 2074  ns the dataset t
+0002bdf0: 6f20 6265 2073 6f72 7465 6420 6279 2061  o be sorted by a
+0002be00: 206e 6577 2063 6f6c 756d 6e2e 2054 6869   new column. Thi
+0002be10: 7320 6361 6e20 6861 7665 2061 0a20 2020  s can have a.   
+0002be20: 2020 2020 2073 6967 6e69 6669 6361 6e74       significant
+0002be30: 2069 6d70 6163 7420 6f6e 2070 6572 666f   impact on perfo
+0002be40: 726d 616e 6365 2c20 6265 6361 7573 6520  rmance, because 
+0002be50: 6a6f 696e 732c 2067 726f 7570 6279 732c  joins, groupbys,
+0002be60: 206c 6f6f 6b75 7073 2c20 6574 632e 0a20   lookups, etc.. 
+0002be70: 2020 2020 2020 2061 7265 2061 6c6c 206d         are all m
+0002be80: 7563 6820 6661 7374 6572 206f 6e20 7468  uch faster on th
+0002be90: 6174 2063 6f6c 756d 6e2e 2048 6f77 6576  at column. Howev
+0002bea0: 6572 2c20 7468 6973 2070 6572 666f 726d  er, this perform
+0002beb0: 616e 6365 2069 6e63 7265 6173 650a 2020  ance increase.  
+0002bec0: 2020 2020 2020 636f 6d65 7320 7769 7468        comes with
+0002bed0: 2061 2063 6f73 742c 2073 6f72 7469 6e67   a cost, sorting
+0002bee0: 2061 2070 6172 616c 6c65 6c20 6461 7461   a parallel data
+0002bef0: 7365 7420 7265 7175 6972 6573 2065 7870  set requires exp
+0002bf00: 656e 7369 7665 2073 6875 6666 6c65 732e  ensive shuffles.
+0002bf10: 0a20 2020 2020 2020 204f 6674 656e 2077  .        Often w
+0002bf20: 6520 6060 7365 745f 696e 6465 7860 6020  e ``set_index`` 
+0002bf30: 6f6e 6365 2064 6972 6563 746c 7920 6166  once directly af
+0002bf40: 7465 7220 6461 7461 2069 6e67 6573 7420  ter data ingest 
+0002bf50: 616e 6420 6669 6c74 6572 696e 6720 616e  and filtering an
+0002bf60: 640a 2020 2020 2020 2020 7468 656e 2070  d.        then p
+0002bf70: 6572 666f 726d 206d 616e 7920 6368 6561  erform many chea
+0002bf80: 7020 636f 6d70 7574 6174 696f 6e73 206f  p computations o
+0002bf90: 6666 206f 6620 7468 6520 736f 7274 6564  ff of the sorted
+0002bfa0: 2064 6174 6173 6574 2e0a 0a20 2020 2020   dataset...     
+0002bfb0: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
+0002bfc0: 206f 7065 7261 7465 7320 6578 6163 746c   operates exactl
+0002bfd0: 7920 6c69 6b65 2060 6070 616e 6461 732e  y like ``pandas.
+0002bfe0: 7365 745f 696e 6465 7860 6020 6578 6365  set_index`` exce
+0002bff0: 7074 2077 6974 680a 2020 2020 2020 2020  pt with.        
+0002c000: 6469 6666 6572 656e 7420 7065 7266 6f72  different perfor
+0002c010: 6d61 6e63 6520 636f 7374 7320 2864 6173  mance costs (das
+0002c020: 6b20 6461 7461 6672 616d 6520 6060 7365  k dataframe ``se
+0002c030: 745f 696e 6465 7860 6020 6973 206d 7563  t_index`` is muc
+0002c040: 6820 6d6f 7265 2065 7870 656e 7369 7665  h more expensive
+0002c050: 292e 0a20 2020 2020 2020 2055 6e64 6572  )..        Under
+0002c060: 206e 6f72 6d61 6c20 6f70 6572 6174 696f   normal operatio
+0002c070: 6e20 7468 6973 2066 756e 6374 696f 6e20  n this function 
+0002c080: 646f 6573 2061 6e20 696e 6974 6961 6c20  does an initial 
+0002c090: 7061 7373 206f 7665 7220 7468 6520 696e  pass over the in
+0002c0a0: 6465 7820 636f 6c75 6d6e 0a20 2020 2020  dex column.     
+0002c0b0: 2020 2074 6f20 636f 6d70 7574 6520 6170     to compute ap
+0002c0c0: 7072 6f78 696d 6174 6520 7175 616e 7469  proximate quanti
+0002c0d0: 6c65 7320 746f 2073 6572 7665 2061 7320  les to serve as 
+0002c0e0: 6675 7475 7265 2064 6976 6973 696f 6e73  future divisions
+0002c0f0: 2e20 4974 2074 6865 6e20 7061 7373 6573  . It then passes
+0002c100: 0a20 2020 2020 2020 206f 7665 7220 7468  .        over th
+0002c110: 6520 6461 7461 2061 2073 6563 6f6e 6420  e data a second 
+0002c120: 7469 6d65 2c20 7370 6c69 7474 696e 6720  time, splitting 
+0002c130: 7570 2065 6163 6820 696e 7075 7420 7061  up each input pa
+0002c140: 7274 6974 696f 6e20 696e 746f 2073 6576  rtition into sev
+0002c150: 6572 616c 0a20 2020 2020 2020 2070 6965  eral.        pie
+0002c160: 6365 7320 616e 6420 7368 6172 696e 6720  ces and sharing 
+0002c170: 7468 6f73 6520 7069 6563 6573 2074 6f20  those pieces to 
+0002c180: 616c 6c20 6f66 2074 6865 206f 7574 7075  all of the outpu
+0002c190: 7420 7061 7274 6974 696f 6e73 206e 6f77  t partitions now
+0002c1a0: 2069 6e0a 2020 2020 2020 2020 736f 7274   in.        sort
+0002c1b0: 6564 206f 7264 6572 2e0a 0a20 2020 2020  ed order...     
+0002c1c0: 2020 2049 6e20 736f 6d65 2063 6173 6573     In some cases
+0002c1d0: 2077 6520 6361 6e20 616c 6c65 7669 6174   we can alleviat
+0002c1e0: 6520 7468 6f73 6520 636f 7374 732c 2066  e those costs, f
+0002c1f0: 6f72 2065 7861 6d70 6c65 2069 6620 796f  or example if yo
+0002c200: 7572 2064 6174 6173 6574 2069 730a 2020  ur dataset is.  
+0002c210: 2020 2020 2020 736f 7274 6564 2061 6c72        sorted alr
+0002c220: 6561 6479 2074 6865 6e20 7765 2063 616e  eady then we can
+0002c230: 2061 766f 6964 206d 616b 696e 6720 6d61   avoid making ma
+0002c240: 6e79 2073 6d61 6c6c 2070 6965 6365 7320  ny small pieces 
+0002c250: 6f72 2069 6620 796f 7520 6b6e 6f77 0a20  or if you know. 
+0002c260: 2020 2020 2020 2067 6f6f 6420 7661 6c75         good valu
+0002c270: 6573 2074 6f20 7370 6c69 7420 7468 6520  es to split the 
+0002c280: 6e65 7720 696e 6465 7820 636f 6c75 6d6e  new index column
+0002c290: 2074 6865 6e20 7765 2063 616e 2061 766f   then we can avo
+0002c2a0: 6964 2074 6865 2069 6e69 7469 616c 0a20  id the initial. 
+0002c2b0: 2020 2020 2020 2070 6173 7320 6f76 6572         pass over
+0002c2c0: 2074 6865 2064 6174 612e 2046 6f72 2065   the data. For e
+0002c2d0: 7861 6d70 6c65 2069 6620 796f 7572 206e  xample if your n
+0002c2e0: 6577 2069 6e64 6578 2069 7320 6120 6461  ew index is a da
+0002c2f0: 7465 7469 6d65 2069 6e64 6578 2061 6e64  tetime index and
+0002c300: 0a20 2020 2020 2020 2079 6f75 7220 6461  .        your da
+0002c310: 7461 2069 7320 616c 7265 6164 7920 736f  ta is already so
+0002c320: 7274 6564 2062 7920 6461 7920 7468 656e  rted by day then
+0002c330: 2074 6869 7320 656e 7469 7265 206f 7065   this entire ope
+0002c340: 7261 7469 6f6e 2063 616e 2062 6520 646f  ration can be do
+0002c350: 6e65 0a20 2020 2020 2020 2066 6f72 2066  ne.        for f
+0002c360: 7265 652e 2059 6f75 2063 616e 2063 6f6e  ree. You can con
+0002c370: 7472 6f6c 2074 6865 7365 206f 7074 696f  trol these optio
+0002c380: 6e73 2077 6974 6820 7468 6520 666f 6c6c  ns with the foll
+0002c390: 6f77 696e 6720 7061 7261 6d65 7465 7273  owing parameters
+0002c3a0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+0002c3b0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+0002c3c0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0002c3d0: 206f 7468 6572 3a20 7374 7269 6e67 206f   other: string o
+0002c3e0: 7220 4461 736b 2053 6572 6965 730a 2020  r Dask Series.  
+0002c3f0: 2020 2020 2020 2020 2020 436f 6c75 6d6e            Column
+0002c400: 2074 6f20 7573 6520 6173 2069 6e64 6578   to use as index
+0002c410: 2e0a 2020 2020 2020 2020 6472 6f70 3a20  ..        drop: 
+0002c420: 626f 6f6c 6561 6e2c 2064 6566 6175 6c74  boolean, default
+0002c430: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0002c440: 2020 4465 6c65 7465 2063 6f6c 756d 6e20    Delete column 
+0002c450: 746f 2062 6520 7573 6564 2061 7320 7468  to be used as th
+0002c460: 6520 6e65 7720 696e 6465 782e 0a20 2020  e new index..   
+0002c470: 2020 2020 2073 6f72 7465 643a 2062 6f6f       sorted: boo
+0002c480: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
+0002c490: 2020 2020 2020 2020 4966 2074 6865 2069          If the i
+0002c4a0: 6e64 6578 2063 6f6c 756d 6e20 6973 2061  ndex column is a
+0002c4b0: 6c72 6561 6479 2073 6f72 7465 6420 696e  lready sorted in
+0002c4c0: 2069 6e63 7265 6173 696e 6720 6f72 6465   increasing orde
+0002c4d0: 722e 0a20 2020 2020 2020 2020 2020 2044  r..            D
+0002c4e0: 6566 6175 6c74 7320 746f 2046 616c 7365  efaults to False
+0002c4f0: 0a20 2020 2020 2020 206e 7061 7274 6974  .        npartit
+0002c500: 696f 6e73 3a20 696e 742c 204e 6f6e 652c  ions: int, None,
+0002c510: 206f 7220 2761 7574 6f27 0a20 2020 2020   or 'auto'.     
+0002c520: 2020 2020 2020 2054 6865 2069 6465 616c         The ideal
+0002c530: 206e 756d 6265 7220 6f66 206f 7574 7075   number of outpu
+0002c540: 7420 7061 7274 6974 696f 6e73 2e20 4966  t partitions. If
+0002c550: 204e 6f6e 652c 2075 7365 2074 6865 2073   None, use the s
+0002c560: 616d 6520 6173 0a20 2020 2020 2020 2020  ame as.         
+0002c570: 2020 2074 6865 2069 6e70 7574 2e20 4966     the input. If
+0002c580: 2027 6175 746f 2720 7468 656e 2064 6563   'auto' then dec
+0002c590: 6964 6520 6279 206d 656d 6f72 7920 7573  ide by memory us
+0002c5a0: 652e 0a20 2020 2020 2020 2020 2020 204f  e..            O
+0002c5b0: 6e6c 7920 7573 6564 2077 6865 6e20 6060  nly used when ``
+0002c5c0: 6469 7669 7369 6f6e 7360 6020 6973 206e  divisions`` is n
+0002c5d0: 6f74 2067 6976 656e 2e20 4966 2060 6064  ot given. If ``d
+0002c5e0: 6976 6973 696f 6e73 6060 2069 7320 6769  ivisions`` is gi
+0002c5f0: 7665 6e2c 0a20 2020 2020 2020 2020 2020  ven,.           
+0002c600: 2074 6865 206e 756d 6265 7220 6f66 206f   the number of o
+0002c610: 7574 7075 7420 7061 7274 6974 696f 6e73  utput partitions
+0002c620: 2077 696c 6c20 6265 2060 606c 656e 2864   will be ``len(d
+0002c630: 6976 6973 696f 6e73 2920 2d20 3160 602e  ivisions) - 1``.
+0002c640: 0a20 2020 2020 2020 2064 6976 6973 696f  .        divisio
+0002c650: 6e73 3a20 6c69 7374 2c20 6f70 7469 6f6e  ns: list, option
+0002c660: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
+0002c670: 6865 2022 6469 7669 6469 6e67 206c 696e  he "dividing lin
+0002c680: 6573 2220 7573 6564 2074 6f20 7370 6c69  es" used to spli
+0002c690: 7420 7468 6520 6e65 7720 696e 6465 7820  t the new index 
+0002c6a0: 696e 746f 2070 6172 7469 7469 6f6e 732e  into partitions.
+0002c6b0: 0a20 2020 2020 2020 2020 2020 2046 6f72  .            For
+0002c6c0: 2060 6064 6976 6973 696f 6e73 3d5b 302c   ``divisions=[0,
+0002c6d0: 2031 302c 2035 302c 2031 3030 5d60 602c   10, 50, 100]``,
+0002c6e0: 2074 6865 7265 2077 6f75 6c64 2062 6520   there would be 
+0002c6f0: 7468 7265 6520 6f75 7470 7574 2070 6172  three output par
+0002c700: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
+0002c710: 2020 2020 2077 6865 7265 2074 6865 206e       where the n
+0002c720: 6577 2069 6e64 6578 2063 6f6e 7461 696e  ew index contain
+0002c730: 6564 205b 302c 2031 3029 2c20 5b31 302c  ed [0, 10), [10,
+0002c740: 2035 3029 2c20 616e 6420 5b35 302c 2031   50), and [50, 1
+0002c750: 3030 292c 2072 6573 7065 6374 6976 656c  00), respectivel
+0002c760: 792e 0a20 2020 2020 2020 2020 2020 2053  y..            S
+0002c770: 6565 2068 7474 7073 3a2f 2f64 6f63 732e  ee https://docs.
+0002c780: 6461 736b 2e6f 7267 2f65 6e2f 6c61 7465  dask.org/en/late
+0002c790: 7374 2f64 6174 6166 7261 6d65 2d64 6573  st/dataframe-des
+0002c7a0: 6967 6e2e 6874 6d6c 2370 6172 7469 7469  ign.html#partiti
+0002c7b0: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
+0002c7c0: 2049 6620 6e6f 7420 6769 7665 6e20 2864   If not given (d
+0002c7d0: 6566 6175 6c74 292c 2067 6f6f 6420 6469  efault), good di
+0002c7e0: 7669 7369 6f6e 7320 6172 6520 6361 6c63  visions are calc
+0002c7f0: 756c 6174 6564 2062 7920 696d 6d65 6469  ulated by immedi
+0002c800: 6174 656c 7920 636f 6d70 7574 696e 670a  ately computing.
+0002c810: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+0002c820: 6461 7461 2061 6e64 206c 6f6f 6b69 6e67  data and looking
+0002c830: 2061 7420 7468 6520 6469 7374 7269 6275   at the distribu
+0002c840: 7469 6f6e 206f 6620 6974 7320 7661 6c75  tion of its valu
+0002c850: 6573 2e20 466f 7220 6c61 7267 6520 6461  es. For large da
+0002c860: 7461 7365 7473 2c0a 2020 2020 2020 2020  tasets,.        
+0002c870: 2020 2020 7468 6973 2063 616e 2062 6520      this can be 
+0002c880: 6578 7065 6e73 6976 652e 0a20 2020 2020  expensive..     
+0002c890: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
+0002c8a0: 2069 6620 6060 736f 7274 6564 3d54 7275   if ``sorted=Tru
+0002c8b0: 6560 602c 2073 7065 6369 6669 6564 2064  e``, specified d
+0002c8c0: 6976 6973 696f 6e73 2061 7265 2061 7373  ivisions are ass
+0002c8d0: 756d 6564 2074 6f20 6d61 7463 680a 2020  umed to match.  
+0002c8e0: 2020 2020 2020 2020 2020 7468 6520 6578            the ex
+0002c8f0: 6973 7469 6e67 2070 6172 7469 7469 6f6e  isting partition
+0002c900: 7320 696e 2074 6865 2064 6174 613b 2069  s in the data; i
+0002c910: 6620 7468 6973 2069 7320 756e 7472 7565  f this is untrue
+0002c920: 2079 6f75 2073 686f 756c 640a 2020 2020   you should.    
+0002c930: 2020 2020 2020 2020 6c65 6176 6520 6469          leave di
+0002c940: 7669 7369 6f6e 7320 656d 7074 7920 616e  visions empty an
+0002c950: 6420 6361 6c6c 2060 6072 6570 6172 7469  d call ``reparti
+0002c960: 7469 6f6e 6060 2061 6674 6572 2060 6073  tion`` after ``s
+0002c970: 6574 5f69 6e64 6578 6060 2e0a 2020 2020  et_index``..    
+0002c980: 2020 2020 696e 706c 6163 653a 2062 6f6f      inplace: boo
+0002c990: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
+0002c9a0: 2020 2020 2020 2020 4d6f 6469 6679 696e          Modifyin
+0002c9b0: 6720 7468 6520 4461 7461 4672 616d 6520  g the DataFrame 
+0002c9c0: 696e 2070 6c61 6365 2069 7320 6e6f 7420  in place is not 
+0002c9d0: 7375 7070 6f72 7465 6420 6279 2044 6173  supported by Das
+0002c9e0: 6b2e 0a20 2020 2020 2020 2020 2020 2044  k..            D
+0002c9f0: 6566 6175 6c74 7320 746f 2046 616c 7365  efaults to False
+0002ca00: 2e0a 2020 2020 2020 2020 7368 7566 666c  ..        shuffl
+0002ca10: 653a 2073 7472 696e 672c 2027 6469 736b  e: string, 'disk
+0002ca20: 2720 6f72 2027 7461 736b 7327 2c20 6f70  ' or 'tasks', op
+0002ca30: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+0002ca40: 2020 2045 6974 6865 7220 6060 2764 6973     Either ``'dis
+0002ca50: 6b27 6060 2066 6f72 2073 696e 676c 652d  k'`` for single-
+0002ca60: 6e6f 6465 206f 7065 7261 7469 6f6e 206f  node operation o
+0002ca70: 7220 6060 2774 6173 6b73 2760 6020 666f  r ``'tasks'`` fo
+0002ca80: 720a 2020 2020 2020 2020 2020 2020 6469  r.            di
+0002ca90: 7374 7269 6275 7465 6420 6f70 6572 6174  stributed operat
+0002caa0: 696f 6e2e 2020 5769 6c6c 2062 6520 696e  ion.  Will be in
+0002cab0: 6665 7272 6564 2062 7920 796f 7572 2063  ferred by your c
+0002cac0: 7572 7265 6e74 2073 6368 6564 756c 6572  urrent scheduler
+0002cad0: 2e0a 2020 2020 2020 2020 636f 6d70 7574  ..        comput
+0002cae0: 653a 2062 6f6f 6c2c 2064 6566 6175 6c74  e: bool, default
+0002caf0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+0002cb00: 2020 2057 6865 7468 6572 206f 7220 6e6f     Whether or no
+0002cb10: 7420 746f 2074 7269 6767 6572 2061 6e20  t to trigger an 
+0002cb20: 696d 6d65 6469 6174 6520 636f 6d70 7574  immediate comput
+0002cb30: 6174 696f 6e2e 2044 6566 6175 6c74 7320  ation. Defaults 
+0002cb40: 746f 2046 616c 7365 2e0a 2020 2020 2020  to False..      
+0002cb50: 2020 2020 2020 4e6f 7465 2c20 7468 6174        Note, that
+0002cb60: 2065 7665 6e20 6966 2079 6f75 2073 6574   even if you set
+0002cb70: 2060 6063 6f6d 7075 7465 3d46 616c 7365   ``compute=False
+0002cb80: 6060 2c20 616e 2069 6d6d 6564 6961 7465  ``, an immediate
+0002cb90: 2063 6f6d 7075 7461 7469 6f6e 0a20 2020   computation.   
+0002cba0: 2020 2020 2020 2020 2077 696c 6c20 7374           will st
+0002cbb0: 696c 6c20 6265 2074 7269 6767 6572 6564  ill be triggered
+0002cbc0: 2069 6620 6060 6469 7669 7369 6f6e 7360   if ``divisions`
+0002cbd0: 6020 6973 2060 604e 6f6e 6560 602e 0a20  ` is ``None``.. 
+0002cbe0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+0002cbf0: 5f73 697a 653a 2069 6e74 2c20 6f70 7469  _size: int, opti
+0002cc00: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+0002cc10: 2044 6573 6972 6564 2073 697a 6520 6f66   Desired size of
+0002cc20: 2065 6163 6820 7061 7274 6974 696f 6e73   each partitions
+0002cc30: 2069 6e20 6279 7465 732e 0a20 2020 2020   in bytes..     
+0002cc40: 2020 2020 2020 204f 6e6c 7920 7573 6564         Only used
+0002cc50: 2077 6865 6e20 6060 6e70 6172 7469 7469   when ``npartiti
+0002cc60: 6f6e 733d 2761 7574 6f27 6060 0a0a 2020  ons='auto'``..  
+0002cc70: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
+0002cc80: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+0002cc90: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
+0002cca0: 7274 2064 6173 6b0a 2020 2020 2020 2020  rt dask.        
+0002ccb0: 3e3e 3e20 6464 6620 3d20 6461 736b 2e64  >>> ddf = dask.d
+0002ccc0: 6174 6173 6574 732e 7469 6d65 7365 7269  atasets.timeseri
+0002ccd0: 6573 2873 7461 7274 3d22 3230 3231 2d30  es(start="2021-0
+0002cce0: 312d 3031 222c 2065 6e64 3d22 3230 3231  1-01", end="2021
+0002ccf0: 2d30 312d 3037 222c 2066 7265 713d 2231  -01-07", freq="1
+0002cd00: 4822 292e 7265 7365 745f 696e 6465 7828  H").reset_index(
+0002cd10: 290a 2020 2020 2020 2020 3e3e 3e20 6464  ).        >>> dd
+0002cd20: 6632 203d 2064 6466 2e73 6574 5f69 6e64  f2 = ddf.set_ind
+0002cd30: 6578 2822 7822 290a 2020 2020 2020 2020  ex("x").        
+0002cd40: 3e3e 3e20 6464 6632 203d 2064 6466 2e73  >>> ddf2 = ddf.s
+0002cd50: 6574 5f69 6e64 6578 2864 6466 2e78 290a  et_index(ddf.x).
+0002cd60: 2020 2020 2020 2020 3e3e 3e20 6464 6632          >>> ddf2
+0002cd70: 203d 2064 6466 2e73 6574 5f69 6e64 6578   = ddf.set_index
+0002cd80: 2864 6466 2e74 696d 6573 7461 6d70 2c20  (ddf.timestamp, 
+0002cd90: 736f 7274 6564 3d54 7275 6529 0a0a 2020  sorted=True)..  
+0002cda0: 2020 2020 2020 4120 636f 6d6d 6f6e 2063        A common c
+0002cdb0: 6173 6520 6973 2077 6865 6e20 7765 2068  ase is when we h
+0002cdc0: 6176 6520 6120 6461 7465 7469 6d65 2063  ave a datetime c
+0002cdd0: 6f6c 756d 6e20 7468 6174 2077 6520 6b6e  olumn that we kn
+0002cde0: 6f77 2074 6f20 6265 0a20 2020 2020 2020  ow to be.       
+0002cdf0: 2073 6f72 7465 6420 616e 6420 6973 2063   sorted and is c
+0002ce00: 6c65 616e 6c79 2064 6976 6964 6564 2062  leanly divided b
+0002ce10: 7920 6461 792e 2020 5765 2063 616e 2073  y day.  We can s
+0002ce20: 6574 2074 6869 7320 696e 6465 7820 666f  et this index fo
+0002ce30: 7220 6672 6565 0a20 2020 2020 2020 2062  r free.        b
+0002ce40: 7920 7370 6563 6966 7969 6e67 2062 6f74  y specifying bot
+0002ce50: 6820 7468 6174 2074 6865 2063 6f6c 756d  h that the colum
+0002ce60: 6e20 6973 2070 7265 2d73 6f72 7465 6420  n is pre-sorted 
+0002ce70: 616e 6420 7468 6520 7061 7274 6963 756c  and the particul
+0002ce80: 6172 0a20 2020 2020 2020 2064 6976 6973  ar.        divis
+0002ce90: 696f 6e73 2061 6c6f 6e67 2077 6869 6368  ions along which
+0002cea0: 2069 7320 6973 2073 6570 6172 6174 6564   is is separated
+0002ceb0: 0a0a 2020 2020 2020 2020 3e3e 3e20 696d  ..        >>> im
+0002cec0: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
+0002ced0: 640a 2020 2020 2020 2020 3e3e 3e20 6469  d.        >>> di
+0002cee0: 7669 7369 6f6e 7320 3d20 7064 2e64 6174  visions = pd.dat
+0002cef0: 655f 7261 6e67 6528 7374 6172 743d 2232  e_range(start="2
+0002cf00: 3032 312d 3031 2d30 3122 2c20 656e 643d  021-01-01", end=
+0002cf10: 2232 3032 312d 3031 2d30 3722 2c20 6672  "2021-01-07", fr
+0002cf20: 6571 3d27 3144 2729 0a20 2020 2020 2020  eq='1D').       
+0002cf30: 203e 3e3e 2064 6976 6973 696f 6e73 0a20   >>> divisions. 
+0002cf40: 2020 2020 2020 2044 6174 6574 696d 6549         DatetimeI
+0002cf50: 6e64 6578 285b 2732 3032 312d 3031 2d30  ndex(['2021-01-0
+0002cf60: 3127 2c20 2732 3032 312d 3031 2d30 3227  1', '2021-01-02'
+0002cf70: 2c20 2732 3032 312d 3031 2d30 3327 2c20  , '2021-01-03', 
+0002cf80: 2732 3032 312d 3031 2d30 3427 2c0a 2020  '2021-01-04',.  
 0002cf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cfa0: 2020 2020 6474 7970 653d 2764 6174 6574      dtype='datet
-0002cfb0: 696d 6536 345b 6e73 5d27 2c20 6672 6571  ime64[ns]', freq
-0002cfc0: 3d27 4427 290a 0a20 2020 2020 2020 204e  ='D')..        N
-0002cfd0: 6f74 6520 7468 6174 2060 606c 656e 2864  ote that ``len(d
-0002cfe0: 6976 6973 6f6e 7329 6060 2069 7320 6571  ivisons)`` is eq
-0002cff0: 7561 6c20 746f 2060 606e 7061 7274 6974  ual to ``npartit
-0002d000: 696f 6e73 202b 2031 6060 2e20 5468 6973  ions + 1``. This
-0002d010: 2069 7320 6265 6361 7573 6520 6060 6469   is because ``di
-0002d020: 7669 7369 6f6e 7360 600a 2020 2020 2020  visions``.      
-0002d030: 2020 7265 7072 6573 656e 7473 2074 6865    represents the
-0002d040: 2075 7070 6572 2061 6e64 206c 6f77 6572   upper and lower
-0002d050: 2062 6f75 6e64 7320 6f66 2065 6163 6820   bounds of each 
-0002d060: 7061 7274 6974 696f 6e2e 2054 6865 2066  partition. The f
-0002d070: 6972 7374 2069 7465 6d20 6973 2074 6865  irst item is the
-0002d080: 0a20 2020 2020 2020 206c 6f77 6572 2062  .        lower b
-0002d090: 6f75 6e64 206f 6620 7468 6520 6669 7273  ound of the firs
-0002d0a0: 7420 7061 7274 6974 696f 6e2c 2074 6865  t partition, the
-0002d0b0: 2073 6563 6f6e 6420 6974 656d 2069 7320   second item is 
-0002d0c0: 7468 6520 6c6f 7765 7220 626f 756e 6420  the lower bound 
-0002d0d0: 6f66 2074 6865 0a20 2020 2020 2020 2073  of the.        s
-0002d0e0: 6563 6f6e 6420 7061 7274 6974 696f 6e20  econd partition 
-0002d0f0: 616e 6420 7468 6520 7570 7065 7220 626f  and the upper bo
-0002d100: 756e 6420 6f66 2074 6865 2066 6972 7374  und of the first
-0002d110: 2070 6172 7469 7469 6f6e 2c20 616e 6420   partition, and 
-0002d120: 736f 206f 6e2e 0a20 2020 2020 2020 2054  so on..        T
-0002d130: 6865 2073 6563 6f6e 642d 746f 2d6c 6173  he second-to-las
-0002d140: 7420 6974 656d 2069 7320 7468 6520 6c6f  t item is the lo
-0002d150: 7765 7220 626f 756e 6420 6f66 2074 6865  wer bound of the
-0002d160: 206c 6173 7420 7061 7274 6974 696f 6e2c   last partition,
-0002d170: 2061 6e64 2074 6865 206c 6173 740a 2020   and the last.  
-0002d180: 2020 2020 2020 2865 7874 7261 2920 6974        (extra) it
-0002d190: 656d 2069 7320 7468 6520 7570 7065 7220  em is the upper 
-0002d1a0: 626f 756e 6420 6f66 2074 6865 206c 6173  bound of the las
-0002d1b0: 7420 7061 7274 6974 696f 6e2e 0a0a 2020  t partition...  
-0002d1c0: 2020 2020 2020 3e3e 3e20 6464 6632 203d        >>> ddf2 =
-0002d1d0: 2064 6466 2e73 6574 5f69 6e64 6578 2822   ddf.set_index("
-0002d1e0: 7469 6d65 7374 616d 7022 2c20 736f 7274  timestamp", sort
-0002d1f0: 6564 3d54 7275 652c 2064 6976 6973 696f  ed=True, divisio
-0002d200: 6e73 3d64 6976 6973 696f 6e73 2e74 6f6c  ns=divisions.tol
-0002d210: 6973 7428 2929 0a0a 2020 2020 2020 2020  ist())..        
-0002d220: 4966 2079 6f75 276c 6c20 6265 2072 756e  If you'll be run
-0002d230: 6e69 6e67 2060 7365 745f 696e 6465 7860  ning `set_index`
-0002d240: 206f 6e20 7468 6520 7361 6d65 2028 6f72   on the same (or
-0002d250: 2073 696d 696c 6172 2920 6461 7461 7365   similar) datase
-0002d260: 7473 2072 6570 6561 7465 646c 792c 0a20  ts repeatedly,. 
-0002d270: 2020 2020 2020 2079 6f75 2063 6f75 6c64         you could
-0002d280: 2073 6176 6520 7469 6d65 2062 7920 6c65   save time by le
-0002d290: 7474 696e 6720 4461 736b 2063 616c 6375  tting Dask calcu
-0002d2a0: 6c61 7465 2067 6f6f 6420 6469 7669 7369  late good divisi
-0002d2b0: 6f6e 7320 6f6e 6365 2c20 7468 656e 2063  ons once, then c
-0002d2c0: 6f70 792d 7061 7374 696e 670a 2020 2020  opy-pasting.    
-0002d2d0: 2020 2020 7468 656d 2074 6f20 7265 7573      them to reus
-0002d2e0: 652e 2054 6869 7320 6973 2065 7370 6563  e. This is espec
-0002d2f0: 6961 6c6c 7920 6865 6c70 6675 6c20 7275  ially helpful ru
-0002d300: 6e6e 696e 6720 696e 2061 204a 7570 7974  nning in a Jupyt
-0002d310: 6572 206e 6f74 6562 6f6f 6b3a 0a0a 2020  er notebook:..  
-0002d320: 2020 2020 2020 3e3e 3e20 6464 6632 203d        >>> ddf2 =
-0002d330: 2064 6466 2e73 6574 5f69 6e64 6578 2822   ddf.set_index("
-0002d340: 6e61 6d65 2229 2020 2320 736c 6f77 2c20  name")  # slow, 
-0002d350: 6361 6c63 756c 6174 6573 2064 6174 6120  calculates data 
-0002d360: 6469 7374 7269 6275 7469 6f6e 0a20 2020  distribution.   
-0002d370: 2020 2020 203e 3e3e 2064 6466 322e 6469       >>> ddf2.di
-0002d380: 7669 7369 6f6e 7320 2023 2064 6f63 7465  visions  # docte
-0002d390: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
-0002d3a0: 2020 5b22 416c 6963 6522 2c20 224c 6175    ["Alice", "Lau
-0002d3b0: 7261 222c 2022 5572 7375 6c61 222c 2022  ra", "Ursula", "
-0002d3c0: 5a65 6c64 6122 5d0a 2020 2020 2020 2020  Zelda"].        
-0002d3d0: 3e3e 3e20 2320 5e20 4e6f 7720 636f 7079  >>> # ^ Now copy
-0002d3e0: 2d70 6173 7465 2074 6869 7320 616e 6420  -paste this and 
-0002d3f0: 6564 6974 2074 6865 206c 696e 6520 6162  edit the line ab
-0002d400: 6f76 6520 746f 3a0a 2020 2020 2020 2020  ove to:.        
-0002d410: 3e3e 3e20 2320 6464 6632 203d 2064 6466  >>> # ddf2 = ddf
-0002d420: 2e73 6574 5f69 6e64 6578 2822 6e61 6d65  .set_index("name
-0002d430: 222c 2064 6976 6973 696f 6e73 3d5b 2241  ", divisions=["A
-0002d440: 6c69 6365 222c 2022 4c61 7572 6122 2c20  lice", "Laura", 
-0002d450: 2255 7273 756c 6122 2c20 225a 656c 6461  "Ursula", "Zelda
-0002d460: 225d 290a 2020 2020 2020 2020 2222 220a  "]).        """.
-0002d470: 0a20 2020 2020 2020 2069 6620 696e 706c  .        if inpl
-0002d480: 6163 653a 0a20 2020 2020 2020 2020 2020  ace:.           
-0002d490: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-0002d4a0: 656e 7465 6445 7272 6f72 2822 5468 6520  entedError("The 
-0002d4b0: 696e 706c 6163 653d 206b 6579 776f 7264  inplace= keyword
-0002d4c0: 2069 7320 6e6f 7420 7375 7070 6f72 7465   is not supporte
-0002d4d0: 6422 290a 2020 2020 2020 2020 7072 655f  d").        pre_
-0002d4e0: 736f 7274 6564 203d 2073 6f72 7465 640a  sorted = sorted.
-0002d4f0: 2020 2020 2020 2020 6465 6c20 736f 7274          del sort
-0002d500: 6564 0a0a 2020 2020 2020 2020 2320 4368  ed..        # Ch
-0002d510: 6563 6b20 6f74 6865 7220 6361 6e20 6265  eck other can be
-0002d520: 2074 7261 6e73 6c61 7465 6420 746f 2063   translated to c
-0002d530: 6f6c 756d 6e20 6e61 6d65 206f 7220 636f  olumn name or co
-0002d540: 6c75 6d6e 206f 626a 6563 742c 2070 6f73  lumn object, pos
-0002d550: 7369 626c 7920 666c 6174 7465 6e69 6e67  sibly flattening
-0002d560: 2069 740a 2020 2020 2020 2020 6966 206e   it.        if n
-0002d570: 6f74 2069 7369 6e73 7461 6e63 6528 6f74  ot isinstance(ot
-0002d580: 6865 722c 2073 7472 293a 0a20 2020 2020  her, str):.     
-0002d590: 2020 2020 2020 2023 2049 7420 6d61 7920         # It may 
-0002d5a0: 7265 6665 7220 746f 2073 6576 6572 616c  refer to several
-0002d5b0: 2063 6f6c 756d 6e73 0a20 2020 2020 2020   columns.       
-0002d5c0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0002d5d0: 6365 286f 7468 6572 2c20 5365 7175 656e  ce(other, Sequen
-0002d5e0: 6365 293a 2020 2320 7479 7065 3a20 6967  ce):  # type: ig
-0002d5f0: 6e6f 7265 5b75 6e72 6561 6368 6162 6c65  nore[unreachable
-0002d600: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0002d610: 2020 2320 4163 6365 7074 205b 2261 225d    # Accept ["a"]
-0002d620: 2c20 6275 7420 6e6f 7420 5b5b 2261 225d  , but not [["a"]
-0002d630: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0002d640: 2020 6966 206c 656e 286f 7468 6572 2920    if len(other) 
-0002d650: 3d3d 2031 2061 6e64 2028 2020 2320 7479  == 1 and (  # ty
-0002d660: 7065 3a20 6967 6e6f 7265 5b75 6e72 6561  pe: ignore[unrea
-0002d670: 6368 6162 6c65 5d0a 2020 2020 2020 2020  chable].        
-0002d680: 2020 2020 2020 2020 2020 2020 6973 696e              isin
-0002d690: 7374 616e 6365 286f 7468 6572 5b30 5d2c  stance(other[0],
-0002d6a0: 2073 7472 2920 6f72 206e 6f74 2069 7369   str) or not isi
-0002d6b0: 6e73 7461 6e63 6528 6f74 6865 725b 305d  nstance(other[0]
-0002d6c0: 2c20 5365 7175 656e 6365 290a 2020 2020  , Sequence).    
-0002d6d0: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
-0002d6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6f0: 2020 206f 7468 6572 203d 206f 7468 6572     other = other
-0002d700: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-0002d710: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0002d720: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0002d730: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-0002d740: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
-0002d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d760: 2022 4461 736b 2064 6174 6166 7261 6d65   "Dask dataframe
-0002d770: 2064 6f65 7320 6e6f 7420 7965 7420 7375   does not yet su
-0002d780: 7070 6f72 7420 6d75 6c74 692d 696e 6465  pport multi-inde
-0002d790: 7865 732e 5c6e 220a 2020 2020 2020 2020  xes.\n".        
-0002d7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d7b0: 6622 596f 7520 7472 6965 6420 746f 2069  f"You tried to i
-0002d7c0: 6e64 6578 2077 6974 6820 7468 6973 2069  ndex with this i
-0002d7d0: 6e64 6578 3a20 7b6f 7468 6572 7d5c 6e22  ndex: {other}\n"
-0002d7e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d7f0: 2020 2020 2020 2020 2022 496e 6465 7865           "Indexe
-0002d800: 7320 6d75 7374 2062 6520 7369 6e67 6c65  s must be single
-0002d810: 2063 6f6c 756d 6e73 206f 6e6c 792e 220a   columns only.".
-0002d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d830: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-0002d840: 2020 2023 204f 7220 6265 2061 2066 7261     # Or be a fra
-0002d850: 6d65 2064 6972 6563 746c 790a 2020 2020  me directly.    
-0002d860: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-0002d870: 6e73 7461 6e63 6528 6f74 6865 722c 2044  nstance(other, D
-0002d880: 6174 6146 7261 6d65 293a 2020 2320 7479  ataFrame):  # ty
-0002d890: 7065 3a20 6967 6e6f 7265 5b75 6e72 6561  pe: ignore[unrea
-0002d8a0: 6368 6162 6c65 5d0a 2020 2020 2020 2020  chable].        
-0002d8b0: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-0002d8c0: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-0002d8d0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0002d8e0: 2020 2020 2020 2022 4461 736b 2064 6174         "Dask dat
-0002d8f0: 6166 7261 6d65 2064 6f65 7320 6e6f 7420  aframe does not 
-0002d900: 7965 7420 7375 7070 6f72 7420 6d75 6c74  yet support mult
-0002d910: 692d 696e 6465 7865 732e 5c6e 220a 2020  i-indexes.\n".  
-0002d920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d930: 2020 6622 596f 7520 7472 6965 6420 746f    f"You tried to
-0002d940: 2069 6e64 6578 2077 6974 6820 6120 6672   index with a fr
-0002d950: 616d 6520 7769 7468 2074 6865 7365 2063  ame with these c
-0002d960: 6f6c 756d 6e73 3a20 7b6c 6973 7428 6f74  olumns: {list(ot
-0002d970: 6865 722e 636f 6c75 6d6e 7329 7d5c 6e22  her.columns)}\n"
-0002d980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d990: 2020 2020 2022 496e 6465 7865 7320 6d75       "Indexes mu
-0002d9a0: 7374 2062 6520 7369 6e67 6c65 2063 6f6c  st be single col
-0002d9b0: 756d 6e73 206f 6e6c 792e 220a 2020 2020  umns only.".    
-0002d9c0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0002d9d0: 2020 2020 2020 2023 2049 6620 616c 7265         # If alre
-0002d9e0: 6164 7920 6120 7365 7269 6573 0a20 2020  ady a series.   
-0002d9f0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0002da00: 6365 286f 7468 6572 2c20 5365 7269 6573  ce(other, Series
-0002da10: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-0002da20: 2049 6620 6974 2773 2061 6c72 6561 6479   If it's already
-0002da30: 2074 6865 2069 6e64 6578 2c20 7468 6572   the index, ther
-0002da40: 6527 7320 6e6f 7468 696e 6720 746f 2064  e's nothing to d
-0002da50: 6f0a 2020 2020 2020 2020 2020 2020 6966  o.            if
-0002da60: 206f 7468 6572 2e5f 6e61 6d65 203d 3d20   other._name == 
-0002da70: 7365 6c66 2e69 6e64 6578 2e5f 6e61 6d65  self.index._name
-0002da80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002da90: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-0002daa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002dab0: 2020 2020 2022 4e65 7720 696e 6465 7820       "New index 
-0002dac0: 6861 7320 7361 6d65 206e 616d 6520 6173  has same name as
-0002dad0: 2065 7869 7374 696e 672c 2074 6869 7320   existing, this 
-0002dae0: 6973 2061 206e 6f2d 6f70 2e22 2c20 5573  is a no-op.", Us
-0002daf0: 6572 5761 726e 696e 670a 2020 2020 2020  erWarning.      
-0002db00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0002db10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0002db20: 726e 2073 656c 660a 0a20 2020 2020 2020  rn self..       
-0002db30: 2023 2049 6620 7468 6520 6e61 6d65 206f   # If the name o
-0002db40: 6620 6120 636f 6c75 6d6e 2f69 6e64 6578  f a column/index
-0002db50: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0002db60: 2020 2020 2020 2020 2020 2023 2057 6974             # Wit
-0002db70: 6820 7468 6520 7361 6d65 206e 616d 6520  h the same name 
-0002db80: 6173 2074 6865 2069 6e64 6578 2c20 7468  as the index, th
-0002db90: 6572 6527 7320 6e6f 7468 696e 6720 746f  ere's nothing to
-0002dba0: 2064 6f20 6569 7468 6572 0a20 2020 2020   do either.     
-0002dbb0: 2020 2020 2020 2069 6620 6f74 6865 7220         if other 
-0002dbc0: 3d3d 2073 656c 662e 696e 6465 782e 6e61  == self.index.na
-0002dbd0: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
-0002dbe0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-0002dbf0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-0002dc00: 2020 2020 2020 2022 4e65 7720 696e 6465         "New inde
-0002dc10: 7820 6861 7320 7361 6d65 206e 616d 6520  x has same name 
-0002dc20: 6173 2065 7869 7374 696e 672c 2074 6869  as existing, thi
-0002dc30: 7320 6973 2061 206e 6f2d 6f70 2e22 2c20  s is a no-op.", 
-0002dc40: 5573 6572 5761 726e 696e 670a 2020 2020  UserWarning.    
-0002dc50: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0002dc60: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0002dc70: 7475 726e 2073 656c 660a 0a20 2020 2020  turn self..     
-0002dc80: 2020 2020 2020 2023 2049 6620 6120 6d69         # If a mi
-0002dc90: 7373 696e 6720 636f 6c75 6d6e 2c20 4b65  ssing column, Ke
-0002dca0: 7945 7272 6f72 0a20 2020 2020 2020 2020  yError.         
-0002dcb0: 2020 2069 6620 6f74 6865 7220 6e6f 7420     if other not 
-0002dcc0: 696e 2073 656c 662e 636f 6c75 6d6e 733a  in self.columns:
-0002dcd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002dce0: 2072 6169 7365 204b 6579 4572 726f 7228   raise KeyError(
-0002dcf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002dd00: 2020 2020 2066 2244 6174 6120 6861 7320       f"Data has 
-0002dd10: 6e6f 2063 6f6c 756d 6e20 277b 6f74 6865  no column '{othe
-0002dd20: 727d 273a 2075 7365 2061 6e79 2063 6f6c  r}': use any col
-0002dd30: 756d 6e20 6f66 207b 6c69 7374 2873 656c  umn of {list(sel
-0002dd40: 662e 636f 6c75 6d6e 7329 7d22 0a20 2020  f.columns)}".   
-0002dd50: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-0002dd60: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
-0002dd70: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
-0002dd80: 2020 6966 2064 6976 6973 696f 6e73 2069    if divisions i
-0002dd90: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0002dda0: 2020 2020 2020 2020 6368 6563 6b5f 6469          check_di
-0002ddb0: 7669 7369 6f6e 7328 6469 7669 7369 6f6e  visions(division
-0002ddc0: 7329 0a20 2020 2020 2020 2065 6c69 6620  s).        elif 
-0002ddd0: 280a 2020 2020 2020 2020 2020 2020 6973  (.            is
-0002dde0: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
-0002ddf0: 496e 6465 7829 0a20 2020 2020 2020 2020  Index).         
-0002de00: 2020 2061 6e64 206f 7468 6572 2e6b 6e6f     and other.kno
-0002de10: 776e 5f64 6976 6973 696f 6e73 0a20 2020  wn_divisions.   
-0002de20: 2020 2020 2020 2020 2061 6e64 206f 7468           and oth
-0002de30: 6572 2e6e 7061 7274 6974 696f 6e73 203d  er.npartitions =
-0002de40: 3d20 7365 6c66 2e6e 7061 7274 6974 696f  = self.npartitio
-0002de50: 6e73 0a20 2020 2020 2020 2029 3a0a 2020  ns.        ):.  
-0002de60: 2020 2020 2020 2020 2020 2320 4966 2074            # If t
-0002de70: 6865 2069 6e64 6578 2068 6173 2074 6865  he index has the
-0002de80: 2073 616d 6520 6e75 6d62 6572 206f 6620   same number of 
-0002de90: 7061 7274 6974 696f 6e73 2061 6e64 206b  partitions and k
-0002dea0: 6e6f 776e 0a20 2020 2020 2020 2020 2020  nown.           
-0002deb0: 2023 2064 6976 6973 696f 6e73 2c20 7468   # divisions, th
-0002dec0: 656e 2077 6520 6361 6e20 7472 6561 7420  en we can treat 
-0002ded0: 6974 2061 7320 7072 652d 736f 7274 6564  it as pre-sorted
-0002dee0: 2077 6974 6820 6b6e 6f77 6e0a 2020 2020   with known.    
-0002def0: 2020 2020 2020 2020 2320 6469 7669 7369          # divisi
-0002df00: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
-0002df10: 7072 655f 736f 7274 6564 203d 2054 7275  pre_sorted = Tru
-0002df20: 650a 2020 2020 2020 2020 2020 2020 6469  e.            di
-0002df30: 7669 7369 6f6e 7320 3d20 6f74 6865 722e  visions = other.
-0002df40: 6469 7669 7369 6f6e 730a 0a20 2020 2020  divisions..     
-0002df50: 2020 2023 2049 6620 696e 6465 7820 6973     # If index is
-0002df60: 2061 6c72 6561 6479 2073 6f72 7465 642c   already sorted,
-0002df70: 2074 616b 6520 6164 7661 6e74 6167 6520   take advantage 
-0002df80: 6f66 2074 6861 7420 7769 7468 2073 6574  of that with set
-0002df90: 5f73 6f72 7465 645f 696e 6465 780a 2020  _sorted_index.  
-0002dfa0: 2020 2020 2020 6966 2070 7265 5f73 6f72        if pre_sor
-0002dfb0: 7465 643a 0a20 2020 2020 2020 2020 2020  ted:.           
-0002dfc0: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
-0002dfd0: 7261 6d65 2e73 6875 6666 6c65 2069 6d70  rame.shuffle imp
-0002dfe0: 6f72 7420 7365 745f 736f 7274 6564 5f69  ort set_sorted_i
-0002dff0: 6e64 6578 0a0a 2020 2020 2020 2020 2020  ndex..          
-0002e000: 2020 7265 7475 726e 2073 6574 5f73 6f72    return set_sor
-0002e010: 7465 645f 696e 6465 7828 0a20 2020 2020  ted_index(.     
-0002e020: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-0002e030: 206f 7468 6572 2c20 6472 6f70 3d64 726f   other, drop=dro
-0002e040: 702c 2064 6976 6973 696f 6e73 3d64 6976  p, divisions=div
-0002e050: 6973 696f 6e73 2c20 2a2a 6b77 6172 6773  isions, **kwargs
-0002e060: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0002e070: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002e080: 2020 2020 2020 2020 2066 726f 6d20 6461           from da
-0002e090: 736b 2e64 6174 6166 7261 6d65 2e73 6875  sk.dataframe.shu
-0002e0a0: 6666 6c65 2069 6d70 6f72 7420 7365 745f  ffle import set_
-0002e0b0: 696e 6465 780a 0a20 2020 2020 2020 2020  index..         
-0002e0c0: 2020 2072 6574 7572 6e20 7365 745f 696e     return set_in
-0002e0d0: 6465 7828 0a20 2020 2020 2020 2020 2020  dex(.           
-0002e0e0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0002e0f0: 2020 2020 2020 2020 2020 206f 7468 6572             other
-0002e100: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002e110: 2020 6472 6f70 3d64 726f 702c 0a20 2020    drop=drop,.   
-0002e120: 2020 2020 2020 2020 2020 2020 206e 7061               npa
-0002e130: 7274 6974 696f 6e73 3d6e 7061 7274 6974  rtitions=npartit
-0002e140: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-0002e150: 2020 2020 2020 6469 7669 7369 6f6e 733d        divisions=
-0002e160: 6469 7669 7369 6f6e 732c 0a20 2020 2020  divisions,.     
-0002e170: 2020 2020 2020 2020 2020 202a 2a6b 7761             **kwa
-0002e180: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-0002e190: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
-0002e1a0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0002e1b0: 6d65 290a 2020 2020 6465 6620 706f 7028  me).    def pop(
-0002e1c0: 7365 6c66 2c20 6974 656d 293a 0a20 2020  self, item):.   
-0002e1d0: 2020 2020 206f 7574 203d 2073 656c 665b       out = self[
-0002e1e0: 6974 656d 5d0a 2020 2020 2020 2020 6465  item].        de
-0002e1f0: 6c20 7365 6c66 5b69 7465 6d5d 0a20 2020  l self[item].   
-0002e200: 2020 2020 2072 6574 7572 6e20 6f75 740a       return out.
-0002e210: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0002e220: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0002e230: 0a20 2020 2064 6566 206e 6c61 7267 6573  .    def nlarges
-0002e240: 7428 7365 6c66 2c20 6e3d 352c 2063 6f6c  t(self, n=5, col
-0002e250: 756d 6e73 3d4e 6f6e 652c 2073 706c 6974  umns=None, split
-0002e260: 5f65 7665 7279 3d4e 6f6e 6529 3a0a 2020  _every=None):.  
-0002e270: 2020 2020 2020 746f 6b65 6e20 3d20 2264        token = "d
-0002e280: 6174 6166 7261 6d65 2d6e 6c61 7267 6573  ataframe-nlarges
-0002e290: 7422 0a20 2020 2020 2020 2072 6574 7572  t".        retur
-0002e2a0: 6e20 6163 6128 0a20 2020 2020 2020 2020  n aca(.         
-0002e2b0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0002e2c0: 2020 2020 2063 6875 6e6b 3d4d 2e6e 6c61       chunk=M.nla
-0002e2d0: 7267 6573 742c 0a20 2020 2020 2020 2020  rgest,.         
-0002e2e0: 2020 2061 6767 7265 6761 7465 3d4d 2e6e     aggregate=M.n
-0002e2f0: 6c61 7267 6573 742c 0a20 2020 2020 2020  largest,.       
-0002e300: 2020 2020 206d 6574 613d 7365 6c66 2e5f       meta=self._
-0002e310: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-0002e320: 2020 746f 6b65 6e3d 746f 6b65 6e2c 0a20    token=token,. 
-0002e330: 2020 2020 2020 2020 2020 2073 706c 6974             split
-0002e340: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-0002e350: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
-0002e360: 6e3d 6e2c 0a20 2020 2020 2020 2020 2020  n=n,.           
-0002e370: 2063 6f6c 756d 6e73 3d63 6f6c 756d 6e73   columns=columns
-0002e380: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0002e390: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0002e3a0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0002e3b0: 2064 6566 206e 736d 616c 6c65 7374 2873   def nsmallest(s
-0002e3c0: 656c 662c 206e 3d35 2c20 636f 6c75 6d6e  elf, n=5, column
-0002e3d0: 733d 4e6f 6e65 2c20 7370 6c69 745f 6576  s=None, split_ev
-0002e3e0: 6572 793d 4e6f 6e65 293a 0a20 2020 2020  ery=None):.     
-0002e3f0: 2020 2074 6f6b 656e 203d 2022 6461 7461     token = "data
-0002e400: 6672 616d 652d 6e73 6d61 6c6c 6573 7422  frame-nsmallest"
-0002e410: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002e420: 6163 6128 0a20 2020 2020 2020 2020 2020  aca(.           
-0002e430: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-0002e440: 2020 2063 6875 6e6b 3d4d 2e6e 736d 616c     chunk=M.nsmal
-0002e450: 6c65 7374 2c0a 2020 2020 2020 2020 2020  lest,.          
-0002e460: 2020 6167 6772 6567 6174 653d 4d2e 6e73    aggregate=M.ns
-0002e470: 6d61 6c6c 6573 742c 0a20 2020 2020 2020  mallest,.       
-0002e480: 2020 2020 206d 6574 613d 7365 6c66 2e5f       meta=self._
-0002e490: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-0002e4a0: 2020 746f 6b65 6e3d 746f 6b65 6e2c 0a20    token=token,. 
-0002e4b0: 2020 2020 2020 2020 2020 2073 706c 6974             split
-0002e4c0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-0002e4d0: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
-0002e4e0: 6e3d 6e2c 0a20 2020 2020 2020 2020 2020  n=n,.           
-0002e4f0: 2063 6f6c 756d 6e73 3d63 6f6c 756d 6e73   columns=columns
-0002e500: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0002e510: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0002e520: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0002e530: 2064 6566 2067 726f 7570 6279 280a 2020   def groupby(.  
-0002e540: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0002e550: 2020 2020 6279 3d4e 6f6e 652c 0a20 2020      by=None,.   
-0002e560: 2020 2020 2067 726f 7570 5f6b 6579 733d       group_keys=
-0002e570: 4752 4f55 505f 4b45 5953 5f44 4546 4155  GROUP_KEYS_DEFAU
-0002e580: 4c54 2c0a 2020 2020 2020 2020 736f 7274  LT,.        sort
-0002e590: 3d4e 6f6e 652c 0a20 2020 2020 2020 206f  =None,.        o
-0002e5a0: 6273 6572 7665 643d 4e6f 6e65 2c0a 2020  bserved=None,.  
-0002e5b0: 2020 2020 2020 6472 6f70 6e61 3d4e 6f6e        dropna=Non
-0002e5c0: 652c 0a20 2020 2020 2020 202a 2a6b 7761  e,.        **kwa
-0002e5d0: 7267 732c 0a20 2020 2029 3a0a 2020 2020  rgs,.    ):.    
-0002e5e0: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
-0002e5f0: 7461 6672 616d 652e 6772 6f75 7062 7920  taframe.groupby 
-0002e600: 696d 706f 7274 2044 6174 6146 7261 6d65  import DataFrame
-0002e610: 4772 6f75 7042 790a 0a20 2020 2020 2020  GroupBy..       
-0002e620: 2072 6574 7572 6e20 4461 7461 4672 616d   return DataFram
-0002e630: 6547 726f 7570 4279 280a 2020 2020 2020  eGroupBy(.      
-0002e640: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0002e650: 2020 2020 2020 2020 6279 3d62 792c 0a20          by=by,. 
-0002e660: 2020 2020 2020 2020 2020 2067 726f 7570             group
-0002e670: 5f6b 6579 733d 6772 6f75 705f 6b65 7973  _keys=group_keys
-0002e680: 2c0a 2020 2020 2020 2020 2020 2020 736f  ,.            so
-0002e690: 7274 3d73 6f72 742c 0a20 2020 2020 2020  rt=sort,.       
-0002e6a0: 2020 2020 206f 6273 6572 7665 643d 6f62       observed=ob
-0002e6b0: 7365 7276 6564 2c0a 2020 2020 2020 2020  served,.        
-0002e6c0: 2020 2020 6472 6f70 6e61 3d64 726f 706e      dropna=dropn
-0002e6d0: 612c 0a20 2020 2020 2020 2020 2020 202a  a,.            *
-0002e6e0: 2a6b 7761 7267 732c 0a20 2020 2020 2020  *kwargs,.       
-0002e6f0: 2029 0a0a 2020 2020 4077 7261 7073 2863   )..    @wraps(c
-0002e700: 6174 6567 6f72 697a 6529 0a20 2020 2064  ategorize).    d
-0002e710: 6566 2063 6174 6567 6f72 697a 6528 7365  ef categorize(se
-0002e720: 6c66 2c20 636f 6c75 6d6e 733d 4e6f 6e65  lf, columns=None
-0002e730: 2c20 696e 6465 783d 4e6f 6e65 2c20 7370  , index=None, sp
-0002e740: 6c69 745f 6576 6572 793d 4e6f 6e65 2c20  lit_every=None, 
-0002e750: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-0002e760: 2020 2072 6574 7572 6e20 6361 7465 676f     return catego
-0002e770: 7269 7a65 280a 2020 2020 2020 2020 2020  rize(.          
-0002e780: 2020 7365 6c66 2c20 636f 6c75 6d6e 733d    self, columns=
-0002e790: 636f 6c75 6d6e 732c 2069 6e64 6578 3d69  columns, index=i
-0002e7a0: 6e64 6578 2c20 7370 6c69 745f 6576 6572  ndex, split_ever
-0002e7b0: 793d 7370 6c69 745f 6576 6572 792c 202a  y=split_every, *
-0002e7c0: 2a6b 7761 7267 730a 2020 2020 2020 2020  *kwargs.        
-0002e7d0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-0002e7e0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0002e7f0: 6529 0a20 2020 2064 6566 2061 7373 6967  e).    def assig
-0002e800: 6e28 7365 6c66 2c20 2a2a 6b77 6172 6773  n(self, **kwargs
-0002e810: 293a 0a20 2020 2020 2020 2064 6174 6120  ):.        data 
-0002e820: 3d20 7365 6c66 2e63 6f70 7928 290a 2020  = self.copy().  
-0002e830: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
-0002e840: 6e20 6b77 6172 6773 2e69 7465 6d73 2829  n kwargs.items()
-0002e850: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0002e860: 206e 6f74 2028 0a20 2020 2020 2020 2020   not (.         
-0002e870: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
-0002e880: 6528 762c 2053 6361 6c61 7229 0a20 2020  e(v, Scalar).   
-0002e890: 2020 2020 2020 2020 2020 2020 206f 7220               or 
-0002e8a0: 6973 5f73 6572 6965 735f 6c69 6b65 2876  is_series_like(v
-0002e8b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002e8c0: 2020 6f72 2063 616c 6c61 626c 6528 7629    or callable(v)
-0002e8d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e8e0: 206f 7220 7064 2e61 7069 2e74 7970 6573   or pd.api.types
-0002e8f0: 2e69 735f 7363 616c 6172 2876 290a 2020  .is_scalar(v).  
-0002e900: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-0002e910: 2069 735f 696e 6465 785f 6c69 6b65 2876   is_index_like(v
-0002e920: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002e930: 2020 6f72 2069 7369 6e73 7461 6e63 6528    or isinstance(
-0002e940: 762c 2041 7272 6179 290a 2020 2020 2020  v, Array).      
-0002e950: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-0002e960: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0002e970: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
-0002e980: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0002e990: 436f 6c75 6d6e 2061 7373 6967 6e6d 656e  Column assignmen
-0002e9a0: 7420 646f 6573 6e27 7420 7375 7070 6f72  t doesn't suppor
-0002e9b0: 7420 7479 7065 207b 7479 7065 6e61 6d65  t type {typename
-0002e9c0: 2874 7970 6528 7629 297d 220a 2020 2020  (type(v))}".    
-0002e9d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0002e9e0: 2020 2020 2020 2020 2020 6966 2063 616c            if cal
-0002e9f0: 6c61 626c 6528 7629 3a0a 2020 2020 2020  lable(v):.      
-0002ea00: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-0002ea10: 5b6b 5d20 3d20 7628 6461 7461 290a 2020  [k] = v(data).  
-0002ea20: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-0002ea30: 6e73 7461 6e63 6528 762c 2041 7272 6179  nstance(v, Array
-0002ea40: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0002ea50: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-0002ea60: 6166 7261 6d65 2e69 6f20 696d 706f 7274  aframe.io import
-0002ea70: 2066 726f 6d5f 6461 736b 5f61 7272 6179   from_dask_array
-0002ea80: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002ea90: 2020 6966 206c 656e 2876 2e73 6861 7065    if len(v.shape
-0002eaa0: 2920 3e20 313a 0a20 2020 2020 2020 2020  ) > 1:.         
-0002eab0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0002eac0: 2056 616c 7565 4572 726f 7228 2241 7272   ValueError("Arr
-0002ead0: 6179 2061 7373 6967 6e6d 656e 7420 6f6e  ay assignment on
-0002eae0: 6c79 2073 7570 706f 7274 7320 312d 4420  ly supports 1-D 
-0002eaf0: 6172 7261 7973 2229 0a20 2020 2020 2020  arrays").       
-0002eb00: 2020 2020 2020 2020 2069 6620 762e 6e70           if v.np
-0002eb10: 6172 7469 7469 6f6e 7320 213d 2064 6174  artitions != dat
-0002eb20: 612e 6e70 6172 7469 7469 6f6e 733a 0a20  a.npartitions:. 
-0002eb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002eb40: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0002eb50: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0002eb60: 2020 2020 2020 2020 2020 2020 2022 4e75               "Nu
-0002eb70: 6d62 6572 206f 6620 7061 7274 6974 696f  mber of partitio
-0002eb80: 6e73 2064 6f20 6e6f 7420 6d61 7463 6820  ns do not match 
-0002eb90: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0002eba0: 2020 2020 2020 2020 2020 6622 287b 762e            f"({v.
-0002ebb0: 6e70 6172 7469 7469 6f6e 737d 2021 3d20  npartitions} != 
-0002ebc0: 7b64 6174 612e 6e70 6172 7469 7469 6f6e  {data.npartition
-0002ebd0: 737d 2922 0a20 2020 2020 2020 2020 2020  s})".           
-0002ebe0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0002ebf0: 2020 2020 2020 2020 2020 206b 7761 7267             kwarg
-0002ec00: 735b 6b5d 203d 2066 726f 6d5f 6461 736b  s[k] = from_dask
-0002ec10: 5f61 7272 6179 2876 2c20 696e 6465 783d  _array(v, index=
-0002ec20: 6461 7461 2e69 6e64 6578 2c20 6d65 7461  data.index, meta
-0002ec30: 3d64 6174 612e 5f6d 6574 6129 0a0a 2020  =data._meta)..  
-0002ec40: 2020 2020 2020 2020 2020 7061 6972 7320            pairs 
-0002ec50: 3d20 5b6b 2c20 6b77 6172 6773 5b6b 5d5d  = [k, kwargs[k]]
-0002ec60: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0002ec70: 4669 6775 7265 206f 7574 2063 6f6c 756d  Figure out colum
-0002ec80: 6e73 206f 6620 7468 6520 6f75 7470 7574  ns of the output
-0002ec90: 0a20 2020 2020 2020 2020 2020 2064 6632  .            df2
-0002eca0: 203d 2064 6174 612e 5f6d 6574 615f 6e6f   = data._meta_no
-0002ecb0: 6e65 6d70 7479 2e61 7373 6967 6e28 0a20  nempty.assign(. 
-0002ecc0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-0002ecd0: 2a5f 6578 7472 6163 745f 6d65 7461 287b  *_extract_meta({
-0002ece0: 6b3a 206b 7761 7267 735b 6b5d 7d2c 206e  k: kwargs[k]}, n
-0002ecf0: 6f6e 656d 7074 793d 5472 7565 290a 2020  onempty=True).  
-0002ed00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0002ed10: 2020 2020 2020 2020 6461 7461 203d 2065          data = e
-0002ed20: 6c65 6d77 6973 6528 6d65 7468 6f64 732e  lemwise(methods.
-0002ed30: 6173 7369 676e 2c20 6461 7461 2c20 2a70  assign, data, *p
-0002ed40: 6169 7273 2c20 6d65 7461 3d64 6632 290a  airs, meta=df2).
-0002ed50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0002ed60: 6461 7461 0a0a 2020 2020 4064 6572 6976  data..    @deriv
-0002ed70: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-0002ed80: 7261 6d65 2c20 7561 5f61 7267 733d 5b22  rame, ua_args=["
-0002ed90: 696e 6465 7822 5d29 0a20 2020 2064 6566  index"]).    def
-0002eda0: 2072 656e 616d 6528 7365 6c66 2c20 696e   rename(self, in
-0002edb0: 6465 783d 4e6f 6e65 2c20 636f 6c75 6d6e  dex=None, column
-0002edc0: 733d 4e6f 6e65 293a 0a20 2020 2020 2020  s=None):.       
-0002edd0: 2069 6620 696e 6465 7820 6973 206e 6f74   if index is not
-0002ede0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0002edf0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0002ee00: 726f 7228 2243 616e 6e6f 7420 7265 6e61  ror("Cannot rena
-0002ee10: 6d65 2069 6e64 6578 2e22 290a 0a20 2020  me index.")..   
-0002ee20: 2020 2020 2023 202a 6172 6773 2068 6572       # *args her
-0002ee30: 6520 6973 2069 6e64 6578 2c20 636f 6c75  e is index, colu
-0002ee40: 6d6e 7320 6275 7420 636f 6c75 6d6e 7320  mns but columns 
-0002ee50: 6172 6720 6973 2061 6c72 6561 6479 2075  arg is already u
-0002ee60: 7365 640a 2020 2020 2020 2020 7265 7475  sed.        retu
-0002ee70: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-0002ee80: 6974 696f 6e73 284d 2e72 656e 616d 652c  itions(M.rename,
-0002ee90: 204e 6f6e 652c 2063 6f6c 756d 6e73 3d63   None, columns=c
-0002eea0: 6f6c 756d 6e73 290a 0a20 2020 2064 6566  olumns)..    def
-0002eeb0: 2071 7565 7279 2873 656c 662c 2065 7870   query(self, exp
-0002eec0: 722c 202a 2a6b 7761 7267 7329 3a0a 2020  r, **kwargs):.  
-0002eed0: 2020 2020 2020 2222 2246 696c 7465 7220        """Filter 
-0002eee0: 6461 7461 6672 616d 6520 7769 7468 2063  dataframe with c
-0002eef0: 6f6d 706c 6578 2065 7870 7265 7373 696f  omplex expressio
-0002ef00: 6e0a 0a20 2020 2020 2020 2042 6c6f 636b  n..        Block
-0002ef10: 6564 2076 6572 7369 6f6e 206f 6620 7064  ed version of pd
-0002ef20: 2e44 6174 6146 7261 6d65 2e71 7565 7279  .DataFrame.query
-0002ef30: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0002ef40: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-0002ef50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0002ef60: 6578 7072 3a20 7374 720a 2020 2020 2020  expr: str.      
-0002ef70: 2020 2020 2020 5468 6520 7175 6572 7920        The query 
-0002ef80: 7374 7269 6e67 2074 6f20 6576 616c 7561  string to evalua
-0002ef90: 7465 2e0a 2020 2020 2020 2020 2020 2020  te..            
-0002efa0: 596f 7520 6361 6e20 7265 6665 7220 746f  You can refer to
-0002efb0: 2063 6f6c 756d 6e20 6e61 6d65 7320 7468   column names th
-0002efc0: 6174 2061 7265 206e 6f74 2076 616c 6964  at are not valid
-0002efd0: 2050 7974 686f 6e20 7661 7269 6162 6c65   Python variable
-0002efe0: 206e 616d 6573 0a20 2020 2020 2020 2020   names.         
-0002eff0: 2020 2062 7920 7375 7272 6f75 6e64 696e     by surroundin
-0002f000: 6720 7468 656d 2069 6e20 6261 636b 7469  g them in backti
-0002f010: 636b 732e 0a20 2020 2020 2020 2020 2020  cks..           
-0002f020: 2044 6173 6b20 646f 6573 206e 6f74 2066   Dask does not f
-0002f030: 756c 6c79 2073 7570 706f 7274 2072 6566  ully support ref
-0002f040: 6572 7269 6e67 2074 6f20 7661 7269 6162  erring to variab
-0002f050: 6c65 7320 7573 696e 6720 7468 6520 2740  les using the '@
-0002f060: 2720 6368 6172 6163 7465 722c 0a20 2020  ' character,.   
-0002f070: 2020 2020 2020 2020 2075 7365 2066 2d73           use f-s
-0002f080: 7472 696e 6773 206f 7220 7468 6520 6060  trings or the ``
-0002f090: 6c6f 6361 6c5f 6469 6374 6060 206b 6579  local_dict`` key
-0002f0a0: 776f 7264 2061 7267 756d 656e 7420 696e  word argument in
-0002f0b0: 7374 6561 642e 0a0a 2020 2020 2020 2020  stead...        
-0002f0c0: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
-0002f0d0: 2d2d 2d0a 2020 2020 2020 2020 5468 6973  ---.        This
-0002f0e0: 2069 7320 6c69 6b65 2074 6865 2073 6571   is like the seq
-0002f0f0: 7565 6e74 6961 6c20 7665 7273 696f 6e20  uential version 
-0002f100: 6578 6365 7074 2074 6861 7420 7468 6973  except that this
-0002f110: 2077 696c 6c20 616c 736f 2068 6170 7065   will also happe
-0002f120: 6e0a 2020 2020 2020 2020 696e 206d 616e  n.        in man
-0002f130: 7920 7468 7265 6164 732e 2020 5468 6973  y threads.  This
-0002f140: 206d 6179 2063 6f6e 666c 6963 7420 7769   may conflict wi
-0002f150: 7468 2060 606e 756d 6578 7072 6060 2077  th ``numexpr`` w
-0002f160: 6869 6368 2077 696c 6c20 7573 650a 2020  hich will use.  
-0002f170: 2020 2020 2020 6d75 6c74 6970 6c65 2074        multiple t
-0002f180: 6872 6561 6473 2069 7473 656c 662e 2020  hreads itself.  
-0002f190: 5765 2072 6563 6f6d 6d65 6e64 2074 6861  We recommend tha
-0002f1a0: 7420 796f 7520 7365 7420 6060 6e75 6d65  t you set ``nume
-0002f1b0: 7870 7260 6020 746f 2075 7365 2061 0a20  xpr`` to use a. 
-0002f1c0: 2020 2020 2020 2073 696e 676c 6520 7468         single th
-0002f1d0: 7265 6164 3a0a 0a20 2020 2020 2020 202e  read:..        .
-0002f1e0: 2e20 636f 6465 2d62 6c6f 636b 3a3a 2070  . code-block:: p
-0002f1f0: 7974 686f 6e0a 0a20 2020 2020 2020 2020  ython..         
-0002f200: 2020 2069 6d70 6f72 7420 6e75 6d65 7870     import numexp
-0002f210: 720a 2020 2020 2020 2020 2020 2020 6e75  r.            nu
-0002f220: 6d65 7870 722e 7365 745f 6e75 6d5f 7468  mexpr.set_num_th
-0002f230: 7265 6164 7328 3129 0a0a 2020 2020 2020  reads(1)..      
-0002f240: 2020 5365 6520 616c 736f 0a20 2020 2020    See also.     
-0002f250: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-0002f260: 2020 2020 7061 6e64 6173 2e44 6174 6146      pandas.DataF
-0002f270: 7261 6d65 2e71 7565 7279 0a20 2020 2020  rame.query.     
-0002f280: 2020 2070 616e 6461 732e 6576 616c 0a0a     pandas.eval..
-0002f290: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-0002f2a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0002f2b0: 2d0a 2020 2020 2020 2020 3e3e 3e20 696d  -.        >>> im
-0002f2c0: 706f 7274 2070 616e 6461 7320 6173 2070  port pandas as p
-0002f2d0: 640a 2020 2020 2020 2020 3e3e 3e20 696d  d.        >>> im
-0002f2e0: 706f 7274 2064 6173 6b2e 6461 7461 6672  port dask.datafr
-0002f2f0: 616d 6520 6173 2064 640a 2020 2020 2020  ame as dd.      
-0002f300: 2020 3e3e 3e20 6466 203d 2070 642e 4461    >>> df = pd.Da
-0002f310: 7461 4672 616d 6528 7b27 7827 3a20 5b31  taFrame({'x': [1
-0002f320: 2c20 322c 2031 2c20 325d 2c0a 2020 2020  , 2, 1, 2],.    
-0002f330: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-0002f340: 2020 2020 2020 2020 2020 2027 7927 3a20             'y': 
-0002f350: 5b31 2c20 322c 2033 2c20 345d 2c0a 2020  [1, 2, 3, 4],.  
-0002f360: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0002f370: 2020 2020 2020 2020 2020 2020 2027 7a20               'z 
-0002f380: 7a27 3a20 5b34 2c20 332c 2032 2c20 315d  z': [4, 3, 2, 1]
-0002f390: 7d29 0a20 2020 2020 2020 203e 3e3e 2064  }).        >>> d
-0002f3a0: 6466 203d 2064 642e 6672 6f6d 5f70 616e  df = dd.from_pan
-0002f3b0: 6461 7328 6466 2c20 6e70 6172 7469 7469  das(df, npartiti
-0002f3c0: 6f6e 733d 3229 0a0a 2020 2020 2020 2020  ons=2)..        
-0002f3d0: 5265 6665 7220 746f 2063 6f6c 756d 6e20  Refer to column 
-0002f3e0: 6e61 6d65 7320 6469 7265 6374 6c79 3a0a  names directly:.
-0002f3f0: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
-0002f400: 2e71 7565 7279 2827 7920 3e20 7827 292e  .query('y > x').
-0002f410: 636f 6d70 7574 6528 290a 2020 2020 2020  compute().      
-0002f420: 2020 2020 2078 2020 7920 207a 207a 0a20       x  y  z z. 
-0002f430: 2020 2020 2020 2032 2020 3120 2033 2020         2  1  3  
-0002f440: 2020 320a 2020 2020 2020 2020 3320 2032    2.        3  2
-0002f450: 2020 3420 2020 2031 0a0a 2020 2020 2020    4    1..      
-0002f460: 2020 5265 6665 7220 746f 2063 6f6c 756d    Refer to colum
-0002f470: 6e20 6e61 6d65 2075 7369 6e67 2062 6163  n name using bac
-0002f480: 6b74 6963 6b73 3a0a 0a20 2020 2020 2020  kticks:..       
-0002f490: 203e 3e3e 2064 6466 2e71 7565 7279 2827   >>> ddf.query('
-0002f4a0: 607a 207a 6020 3e20 7827 292e 636f 6d70  `z z` > x').comp
-0002f4b0: 7574 6528 290a 2020 2020 2020 2020 2020  ute().          
-0002f4c0: 2078 2020 7920 207a 207a 0a20 2020 2020   x  y  z z.     
-0002f4d0: 2020 2030 2020 3120 2031 2020 2020 340a     0  1  1    4.
-0002f4e0: 2020 2020 2020 2020 3120 2032 2020 3220          1  2  2 
-0002f4f0: 2020 2033 0a20 2020 2020 2020 2032 2020     3.        2  
-0002f500: 3120 2033 2020 2020 320a 0a20 2020 2020  1  3    2..     
-0002f510: 2020 2052 6566 6572 2074 6f20 7661 7269     Refer to vari
-0002f520: 6162 6c65 206e 616d 6520 7573 696e 6720  able name using 
-0002f530: 662d 7374 7269 6e67 733a 0a0a 2020 2020  f-strings:..    
-0002f540: 2020 2020 3e3e 3e20 7661 6c75 6520 3d20      >>> value = 
-0002f550: 310a 2020 2020 2020 2020 3e3e 3e20 6464  1.        >>> dd
-0002f560: 662e 7175 6572 7928 6627 7820 3d3d 207b  f.query(f'x == {
-0002f570: 7661 6c75 657d 2729 2e63 6f6d 7075 7465  value}').compute
-0002f580: 2829 0a20 2020 2020 2020 2020 2020 7820  ().           x 
-0002f590: 2079 2020 7a20 7a0a 2020 2020 2020 2020   y  z z.        
-0002f5a0: 3020 2031 2020 3120 2020 2034 0a20 2020  0  1  1    4.   
-0002f5b0: 2020 2020 2032 2020 3120 2033 2020 2020       2  1  3    
-0002f5c0: 320a 0a20 2020 2020 2020 2052 6566 6572  2..        Refer
-0002f5d0: 2074 6f20 7661 7269 6162 6c65 206e 616d   to variable nam
-0002f5e0: 6520 7573 696e 6720 6060 6c6f 6361 6c5f  e using ``local_
-0002f5f0: 6469 6374 6060 3a0a 0a20 2020 2020 2020  dict``:..       
-0002f600: 203e 3e3e 2064 6466 2e71 7565 7279 2827   >>> ddf.query('
-0002f610: 7820 3d3d 2040 7661 6c75 6527 2c20 6c6f  x == @value', lo
-0002f620: 6361 6c5f 6469 6374 3d7b 2276 616c 7565  cal_dict={"value
-0002f630: 223a 2076 616c 7565 7d29 2e63 6f6d 7075  ": value}).compu
-0002f640: 7465 2829 0a20 2020 2020 2020 2020 2020  te().           
-0002f650: 7820 2079 2020 7a20 7a0a 2020 2020 2020  x  y  z z.      
-0002f660: 2020 3020 2031 2020 3120 2020 2034 0a20    0  1  1    4. 
-0002f670: 2020 2020 2020 2032 2020 3120 2033 2020         2  1  3  
-0002f680: 2020 320a 2020 2020 2020 2020 2222 220a    2.        """.
-0002f690: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002f6a0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-0002f6b0: 6e73 284d 2e71 7565 7279 2c20 6578 7072  ns(M.query, expr
-0002f6c0: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
-0002f6d0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0002f6e0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0002f6f0: 2064 6566 2065 7661 6c28 7365 6c66 2c20   def eval(self, 
-0002f700: 6578 7072 2c20 696e 706c 6163 653d 4e6f  expr, inplace=No
-0002f710: 6e65 2c20 2a2a 6b77 6172 6773 293a 0a20  ne, **kwargs):. 
-0002f720: 2020 2020 2020 2069 6620 696e 706c 6163         if inplac
-0002f730: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-0002f740: 2020 2020 2020 2069 6e70 6c61 6365 203d         inplace =
-0002f750: 2046 616c 7365 0a20 2020 2020 2020 2069   False.        i
-0002f760: 6620 223d 2220 696e 2065 7870 7220 616e  f "=" in expr an
-0002f770: 6420 696e 706c 6163 6520 696e 2028 5472  d inplace in (Tr
-0002f780: 7565 2c20 4e6f 6e65 293a 0a20 2020 2020  ue, None):.     
-0002f790: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0002f7a0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0002f7b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002f7c0: 2020 2249 6e70 6c61 6365 2065 7661 6c20    "Inplace eval 
-0002f7d0: 6e6f 7420 7375 7070 6f72 7465 642e 2050  not supported. P
-0002f7e0: 6c65 6173 6520 7573 6520 696e 706c 6163  lease use inplac
-0002f7f0: 653d 4661 6c73 6522 0a20 2020 2020 2020  e=False".       
-0002f800: 2020 2020 2029 0a20 2020 2020 2020 206d       ).        m
-0002f810: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-0002f820: 2e65 7661 6c28 6578 7072 2c20 696e 706c  .eval(expr, inpl
-0002f830: 6163 653d 696e 706c 6163 652c 202a 2a6b  ace=inplace, **k
-0002f840: 7761 7267 7329 0a20 2020 2020 2020 2072  wargs).        r
-0002f850: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-0002f860: 6172 7469 7469 6f6e 7328 4d2e 6576 616c  artitions(M.eval
-0002f870: 2c20 6578 7072 2c20 6d65 7461 3d6d 6574  , expr, meta=met
-0002f880: 612c 2069 6e70 6c61 6365 3d69 6e70 6c61  a, inplace=inpla
-0002f890: 6365 2c20 2a2a 6b77 6172 6773 290a 0a20  ce, **kwargs).. 
-0002f8a0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0002f8b0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0002f8c0: 2020 2064 6566 2064 726f 706e 6128 7365     def dropna(se
-0002f8d0: 6c66 2c20 686f 773d 6e6f 5f64 6566 6175  lf, how=no_defau
-0002f8e0: 6c74 2c20 7375 6273 6574 3d4e 6f6e 652c  lt, subset=None,
-0002f8f0: 2074 6872 6573 683d 6e6f 5f64 6566 6175   thresh=no_defau
-0002f900: 6c74 293a 0a20 2020 2020 2020 2023 2054  lt):.        # T
-0002f910: 6865 7365 206b 6579 776f 7264 7320 6172  hese keywords ar
-0002f920: 6520 696e 636f 6d70 6174 6962 6c65 2077  e incompatible w
-0002f930: 6974 6820 6561 6368 206f 7468 6572 2e0a  ith each other..
-0002f940: 2020 2020 2020 2020 2320 446f 6e27 7420          # Don't 
-0002f950: 616c 6c6f 7720 7468 656d 2062 6f74 6820  allow them both 
-0002f960: 746f 2062 6520 7365 742e 0a20 2020 2020  to be set..     
-0002f970: 2020 2069 6620 686f 7720 6973 206e 6f74     if how is not
-0002f980: 206e 6f5f 6465 6661 756c 7420 616e 6420   no_default and 
-0002f990: 7468 7265 7368 2069 7320 6e6f 7420 6e6f  thresh is not no
-0002f9a0: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
-0002f9b0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0002f9c0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0002f9d0: 2020 2020 2020 2022 596f 7520 6361 6e6e         "You cann
-0002f9e0: 6f74 2073 6574 2062 6f74 6820 7468 6520  ot set both the 
-0002f9f0: 686f 7720 616e 6420 7468 7265 7368 2061  how and thresh a
-0002fa00: 7267 756d 656e 7473 2061 7420 7468 6520  rguments at the 
-0002fa10: 7361 6d65 2074 696d 652e 220a 2020 2020  same time.".    
-0002fa20: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0002fa30: 2020 2023 204f 6e6c 7920 7370 6563 6966     # Only specif
-0002fa40: 7920 6068 6f77 6020 6f72 2060 7468 7265  y `how` or `thre
-0002fa50: 7368 6020 6b65 7977 6f72 6420 6966 2073  sh` keyword if s
-0002fa60: 7065 6369 6669 6564 2062 7920 7468 6520  pecified by the 
-0002fa70: 7573 6572 0a20 2020 2020 2020 2023 2073  user.        # s
-0002fa80: 6f20 7765 2075 7469 6c69 7a65 206f 7468  o we utilize oth
-0002fa90: 6572 2060 6472 6f70 6e61 6020 6b65 7977  er `dropna` keyw
-0002faa0: 6f72 6420 6465 6661 756c 7473 2061 7070  ord defaults app
-0002fab0: 726f 7072 6961 7465 6c79 0a20 2020 2020  ropriately.     
-0002fac0: 2020 206b 7761 7267 7320 3d20 7b22 7375     kwargs = {"su
-0002fad0: 6273 6574 223a 2073 7562 7365 747d 0a20  bset": subset}. 
-0002fae0: 2020 2020 2020 2069 6620 686f 7720 6973         if how is
-0002faf0: 206e 6f74 206e 6f5f 6465 6661 756c 743a   not no_default:
-0002fb00: 0a20 2020 2020 2020 2020 2020 206b 7761  .            kwa
-0002fb10: 7267 735b 2268 6f77 225d 203d 2068 6f77  rgs["how"] = how
-0002fb20: 0a20 2020 2020 2020 2065 6c69 6620 7468  .        elif th
-0002fb30: 7265 7368 2069 7320 6e6f 7420 6e6f 5f64  resh is not no_d
-0002fb40: 6566 6175 6c74 3a0a 2020 2020 2020 2020  efault:.        
-0002fb50: 2020 2020 6b77 6172 6773 5b22 7468 7265      kwargs["thre
-0002fb60: 7368 225d 203d 2074 6872 6573 680a 0a20  sh"] = thresh.. 
-0002fb70: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002fb80: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-0002fb90: 7328 4d2e 6472 6f70 6e61 2c20 2a2a 6b77  s(M.dropna, **kw
-0002fba0: 6172 6773 2c20 656e 666f 7263 655f 6d65  args, enforce_me
-0002fbb0: 7461 6461 7461 3d46 616c 7365 290a 0a20  tadata=False).. 
-0002fbc0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0002fbd0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0002fbe0: 2020 2064 6566 2063 6c69 7028 7365 6c66     def clip(self
-0002fbf0: 2c20 6c6f 7765 723d 4e6f 6e65 2c20 7570  , lower=None, up
-0002fc00: 7065 723d 4e6f 6e65 2c20 6f75 743d 4e6f  per=None, out=No
-0002fc10: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
-0002fc20: 6f75 7420 6973 206e 6f74 204e 6f6e 653a  out is not None:
-0002fc30: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0002fc40: 7365 2056 616c 7565 4572 726f 7228 2227  se ValueError("'
-0002fc50: 6f75 7427 206d 7573 7420 6265 204e 6f6e  out' must be Non
-0002fc60: 6522 290a 2020 2020 2020 2020 7265 7475  e").        retu
-0002fc70: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-0002fc80: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-0002fc90: 2020 2020 4d2e 636c 6970 2c20 6c6f 7765      M.clip, lowe
-0002fca0: 723d 6c6f 7765 722c 2075 7070 6572 3d75  r=lower, upper=u
-0002fcb0: 7070 6572 2c20 656e 666f 7263 655f 6d65  pper, enforce_me
-0002fcc0: 7461 6461 7461 3d46 616c 7365 0a20 2020  tadata=False.   
-0002fcd0: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
-0002fce0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0002fcf0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-0002fd00: 636c 6970 5f6c 6f77 6572 2873 656c 662c  clip_lower(self,
-0002fd10: 2074 6872 6573 686f 6c64 293a 0a20 2020   threshold):.   
-0002fd20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0002fd30: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-0002fd40: 0a20 2020 2020 2020 2020 2020 204d 2e63  .            M.c
-0002fd50: 6c69 705f 6c6f 7765 722c 2074 6872 6573  lip_lower, thres
-0002fd60: 686f 6c64 3d74 6872 6573 686f 6c64 2c20  hold=threshold, 
-0002fd70: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-0002fd80: 3d46 616c 7365 0a20 2020 2020 2020 2029  =False.        )
-0002fd90: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0002fda0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0002fdb0: 290a 2020 2020 6465 6620 636c 6970 5f75  ).    def clip_u
-0002fdc0: 7070 6572 2873 656c 662c 2074 6872 6573  pper(self, thres
-0002fdd0: 686f 6c64 293a 0a20 2020 2020 2020 2072  hold):.        r
-0002fde0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-0002fdf0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-0002fe00: 2020 2020 2020 204d 2e63 6c69 705f 7570         M.clip_up
-0002fe10: 7065 722c 2074 6872 6573 686f 6c64 3d74  per, threshold=t
-0002fe20: 6872 6573 686f 6c64 2c20 656e 666f 7263  hreshold, enforc
-0002fe30: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-0002fe40: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0002fe50: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-0002fe60: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-0002fe70: 6465 6620 7371 7565 657a 6528 7365 6c66  def squeeze(self
-0002fe80: 2c20 6178 6973 3d4e 6f6e 6529 3a0a 2020  , axis=None):.  
-0002fe90: 2020 2020 2020 6966 2061 7869 7320 696e        if axis in
-0002fea0: 205b 4e6f 6e65 2c20 315d 3a0a 2020 2020   [None, 1]:.    
-0002feb0: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
-0002fec0: 656c 662e 636f 6c75 6d6e 7329 203d 3d20  elf.columns) == 
-0002fed0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-0002fee0: 2020 2072 6574 7572 6e20 7365 6c66 5b73     return self[s
-0002fef0: 656c 662e 636f 6c75 6d6e 735b 305d 5d0a  elf.columns[0]].
-0002ff00: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0002ff10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002ff20: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
-0002ff30: 2020 2020 2020 2065 6c69 6620 6178 6973         elif axis
-0002ff40: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-0002ff50: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-0002ff60: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-0002ff70: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0002ff80: 7b74 7970 6528 7365 6c66 297d 2064 6f65  {type(self)} doe
-0002ff90: 7320 6e6f 7420 7375 7070 6f72 7420 7371  s not support sq
-0002ffa0: 7565 657a 6520 616c 6f6e 6720 6178 6973  ueeze along axis
-0002ffb0: 2030 220a 2020 2020 2020 2020 2020 2020   0".            
-0002ffc0: 290a 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
-0002ffd0: 6178 6973 206e 6f74 2069 6e20 5b30 2c20  axis not in [0, 
-0002ffe0: 312c 204e 6f6e 655d 3a0a 2020 2020 2020  1, None]:.      
-0002fff0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00030000: 6545 7272 6f72 2866 224e 6f20 6178 6973  eError(f"No axis
-00030010: 207b 6178 6973 7d20 666f 7220 6f62 6a65   {axis} for obje
-00030020: 6374 2074 7970 6520 7b74 7970 6528 7365  ct type {type(se
-00030030: 6c66 297d 2229 0a0a 2020 2020 4064 6572  lf)}")..    @der
-00030040: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00030050: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00030060: 746f 5f74 696d 6573 7461 6d70 2873 656c  to_timestamp(sel
-00030070: 662c 2066 7265 713d 4e6f 6e65 2c20 686f  f, freq=None, ho
-00030080: 773d 2273 7461 7274 222c 2061 7869 733d  w="start", axis=
-00030090: 3029 3a0a 2020 2020 2020 2020 6466 203d  0):.        df =
-000300a0: 2065 6c65 6d77 6973 6528 4d2e 746f 5f74   elemwise(M.to_t
-000300b0: 696d 6573 7461 6d70 2c20 7365 6c66 2c20  imestamp, self, 
-000300c0: 6672 6571 2c20 686f 772c 2061 7869 7329  freq, how, axis)
-000300d0: 0a20 2020 2020 2020 2064 662e 6469 7669  .        df.divi
-000300e0: 7369 6f6e 7320 3d20 7475 706c 6528 7064  sions = tuple(pd
-000300f0: 2e49 6e64 6578 2873 656c 662e 6469 7669  .Index(self.divi
-00030100: 7369 6f6e 7329 2e74 6f5f 7469 6d65 7374  sions).to_timest
-00030110: 616d 7028 2929 0a20 2020 2020 2020 2072  amp()).        r
-00030120: 6574 7572 6e20 6466 0a0a 2020 2020 4064  eturn df..    @d
-00030130: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00030140: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00030150: 6620 6578 706c 6f64 6528 7365 6c66 2c20  f explode(self, 
-00030160: 636f 6c75 6d6e 293a 0a20 2020 2020 2020  column):.       
-00030170: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
-00030180: 7461 2e65 7870 6c6f 6465 2863 6f6c 756d  ta.explode(colum
-00030190: 6e29 0a20 2020 2020 2020 2072 6574 7572  n).        retur
-000301a0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-000301b0: 7469 6f6e 7328 4d2e 6578 706c 6f64 652c  tions(M.explode,
-000301c0: 2063 6f6c 756d 6e2c 206d 6574 613d 6d65   column, meta=me
-000301d0: 7461 2c20 656e 666f 7263 655f 6d65 7461  ta, enforce_meta
-000301e0: 6461 7461 3d46 616c 7365 290a 0a20 2020  data=False)..   
-000301f0: 2064 6566 2074 6f5f 6261 6728 7365 6c66   def to_bag(self
-00030200: 2c20 696e 6465 783d 4661 6c73 652c 2066  , index=False, f
-00030210: 6f72 6d61 743d 2274 7570 6c65 2229 3a0a  ormat="tuple"):.
-00030220: 2020 2020 2020 2020 2222 2243 6f6e 7665          """Conve
-00030230: 7274 2074 6f20 6120 6461 736b 2042 6167  rt to a dask Bag
-00030240: 206f 6620 7475 706c 6573 206f 6620 6561   of tuples of ea
-00030250: 6368 2072 6f77 2e0a 0a20 2020 2020 2020  ch row...       
-00030260: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00030270: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00030280: 2020 2020 2020 2069 6e64 6578 203a 2062         index : b
-00030290: 6f6f 6c2c 206f 7074 696f 6e61 6c0a 2020  ool, optional.  
-000302a0: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
-000302b0: 652c 2074 6865 2069 6e64 6578 2069 7320  e, the index is 
-000302c0: 696e 636c 7564 6564 2061 7320 7468 6520  included as the 
-000302d0: 6669 7273 7420 656c 656d 656e 7420 6f66  first element of
-000302e0: 2065 6163 6820 7475 706c 652e 0a20 2020   each tuple..   
-000302f0: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
-00030300: 2069 7320 4661 6c73 652e 0a20 2020 2020   is False..     
-00030310: 2020 2066 6f72 6d61 7420 3a20 7b22 7475     format : {"tu
-00030320: 706c 6522 2c20 2264 6963 7422 2c20 2266  ple", "dict", "f
-00030330: 7261 6d65 227d 2c20 6f70 7469 6f6e 616c  rame"}, optional
-00030340: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-00030350: 7468 6572 2074 6f20 7265 7475 726e 2061  ther to return a
-00030360: 2062 6167 206f 6620 7475 706c 6573 2c20   bag of tuples, 
-00030370: 6469 6374 696f 6e61 7269 6573 2c20 6f72  dictionaries, or
-00030380: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00030390: 6166 7261 6d65 2d6c 696b 6520 6f62 6a65  aframe-like obje
-000303a0: 6374 732e 2044 6566 6175 6c74 2069 7320  cts. Default is 
-000303b0: 2274 7570 6c65 222e 2049 6620 2266 7261  "tuple". If "fra
-000303c0: 6d65 222c 0a20 2020 2020 2020 2020 2020  me",.           
-000303d0: 2074 6865 206f 7269 6769 6e61 6c20 7061   the original pa
-000303e0: 7274 6974 696f 6e73 206f 6620 6060 6466  rtitions of ``df
-000303f0: 6060 2077 696c 6c20 6e6f 7420 6265 2074  `` will not be t
-00030400: 7261 6e73 666f 726d 6564 0a20 2020 2020  ransformed.     
-00030410: 2020 2020 2020 2069 6e20 616e 7920 7761         in any wa
-00030420: 792e 0a20 2020 2020 2020 2022 2222 0a20  y..        """. 
-00030430: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-00030440: 2e64 6174 6166 7261 6d65 2e69 6f20 696d  .dataframe.io im
-00030450: 706f 7274 2074 6f5f 6261 670a 0a20 2020  port to_bag..   
-00030460: 2020 2020 2072 6574 7572 6e20 746f 5f62       return to_b
-00030470: 6167 2873 656c 662c 2069 6e64 6578 2c20  ag(self, index, 
-00030480: 666f 726d 6174 290a 0a20 2020 2064 6566  format)..    def
-00030490: 2074 6f5f 7061 7271 7565 7428 7365 6c66   to_parquet(self
-000304a0: 2c20 7061 7468 2c20 2a61 7267 732c 202a  , path, *args, *
-000304b0: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-000304c0: 2020 2222 2253 6565 2064 642e 746f 5f70    """See dd.to_p
-000304d0: 6172 7175 6574 2064 6f63 7374 7269 6e67  arquet docstring
-000304e0: 2066 6f72 206d 6f72 6520 696e 666f 726d   for more inform
-000304f0: 6174 696f 6e22 2222 0a20 2020 2020 2020  ation""".       
-00030500: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
-00030510: 7261 6d65 2e69 6f20 696d 706f 7274 2074  rame.io import t
-00030520: 6f5f 7061 7271 7565 740a 0a20 2020 2020  o_parquet..     
-00030530: 2020 2072 6574 7572 6e20 746f 5f70 6172     return to_par
-00030540: 7175 6574 2873 656c 662c 2070 6174 682c  quet(self, path,
-00030550: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00030560: 290a 0a20 2020 2064 6566 2074 6f5f 6f72  )..    def to_or
-00030570: 6328 7365 6c66 2c20 7061 7468 2c20 2a61  c(self, path, *a
-00030580: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00030590: 2020 2020 2020 2020 2222 2253 6565 2064          """See d
-000305a0: 642e 746f 5f6f 7263 2064 6f63 7374 7269  d.to_orc docstri
-000305b0: 6e67 2066 6f72 206d 6f72 6520 696e 666f  ng for more info
-000305c0: 726d 6174 696f 6e22 2222 0a20 2020 2020  rmation""".     
-000305d0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-000305e0: 6166 7261 6d65 2e69 6f20 696d 706f 7274  aframe.io import
-000305f0: 2074 6f5f 6f72 630a 0a20 2020 2020 2020   to_orc..       
-00030600: 2072 6574 7572 6e20 746f 5f6f 7263 2873   return to_orc(s
-00030610: 656c 662c 2070 6174 682c 202a 6172 6773  elf, path, *args
-00030620: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
-00030630: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00030640: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-00030650: 2064 6566 2074 6f5f 7374 7269 6e67 2873   def to_string(s
-00030660: 656c 662c 206d 6178 5f72 6f77 733d 3529  elf, max_rows=5)
-00030670: 3a0a 2020 2020 2020 2020 2320 6f70 7469  :.        # opti
-00030680: 6f6e 5f63 6f6e 7465 7874 2064 6f65 736e  on_context doesn
-00030690: 2774 2061 6666 6563 740a 2020 2020 2020  't affect.      
-000306a0: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
-000306b0: 6570 725f 6461 7461 2829 2e74 6f5f 7374  epr_data().to_st
-000306c0: 7269 6e67 286d 6178 5f72 6f77 733d 6d61  ring(max_rows=ma
-000306d0: 785f 726f 7773 2c20 7368 6f77 5f64 696d  x_rows, show_dim
-000306e0: 656e 7369 6f6e 733d 4661 6c73 6529 0a0a  ensions=False)..
-000306f0: 2020 2020 6465 6620 5f67 6574 5f6e 756d      def _get_num
-00030700: 6572 6963 5f64 6174 6128 7365 6c66 2c20  eric_data(self, 
-00030710: 686f 773d 2261 6e79 222c 2073 7562 7365  how="any", subse
-00030720: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
-00030730: 2023 2063 616c 6375 6c61 7465 2063 6f6c   # calculate col
-00030740: 756d 6e73 2074 6f20 6176 6f69 6420 756e  umns to avoid un
-00030750: 6e65 6365 7373 6172 7920 6361 6c63 756c  necessary calcul
-00030760: 6174 696f 6e0a 2020 2020 2020 2020 6e75  ation.        nu
-00030770: 6d65 7269 6373 203d 2073 656c 662e 5f6d  merics = self._m
-00030780: 6574 612e 5f67 6574 5f6e 756d 6572 6963  eta._get_numeric
-00030790: 5f64 6174 6128 290a 0a20 2020 2020 2020  _data()..       
-000307a0: 2069 6620 6c65 6e28 6e75 6d65 7269 6373   if len(numerics
-000307b0: 2e63 6f6c 756d 6e73 2920 3c20 6c65 6e28  .columns) < len(
-000307c0: 7365 6c66 2e63 6f6c 756d 6e73 293a 0a20  self.columns):. 
-000307d0: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-000307e0: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
-000307f0: 6566 6978 202b 2022 2d67 6574 5f6e 756d  efix + "-get_num
-00030800: 6572 6963 5f64 6174 6122 0a20 2020 2020  eric_data".     
-00030810: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00030820: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00030830: 7328 4d2e 5f67 6574 5f6e 756d 6572 6963  s(M._get_numeric
-00030840: 5f64 6174 612c 206d 6574 613d 6e75 6d65  _data, meta=nume
-00030850: 7269 6373 2c20 746f 6b65 6e3d 6e61 6d65  rics, token=name
-00030860: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00030870: 2020 2020 2020 2020 2020 2020 2320 7573              # us
-00030880: 6520 6d79 7365 6c66 2069 6620 616c 6c20  e myself if all 
-00030890: 6e75 6d65 7269 6373 0a20 2020 2020 2020  numerics.       
-000308a0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000308b0: 0a0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
-000308c0: 6f64 0a20 2020 2064 6566 205f 7661 6c69  od.    def _vali
-000308d0: 6461 7465 5f61 7869 7328 636c 732c 2061  date_axis(cls, a
-000308e0: 7869 733d 302c 206e 6f6e 655f 6973 5f7a  xis=0, none_is_z
-000308f0: 6572 6f3a 2062 6f6f 6c20 3d20 5472 7565  ero: bool = True
-00030900: 2920 2d3e 204e 6f6e 6520 7c20 4c69 7465  ) -> None | Lite
-00030910: 7261 6c5b 302c 2031 5d3a 0a20 2020 2020  ral[0, 1]:.     
-00030920: 2020 2069 6620 6178 6973 206e 6f74 2069     if axis not i
-00030930: 6e20 2830 2c20 312c 2022 696e 6465 7822  n (0, 1, "index"
-00030940: 2c20 2263 6f6c 756d 6e73 222c 204e 6f6e  , "columns", Non
-00030950: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00030960: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00030970: 2866 224e 6f20 6178 6973 206e 616d 6564  (f"No axis named
-00030980: 207b 6178 6973 7d22 290a 2020 2020 2020   {axis}").      
-00030990: 2020 2320 636f 6e76 6572 7420 746f 206e    # convert to n
-000309a0: 756d 6572 6963 2061 7869 730a 2020 2020  umeric axis.    
-000309b0: 2020 2020 6e75 6d65 7269 635f 6178 6973      numeric_axis
-000309c0: 3a20 6469 6374 5b73 7472 207c 204e 6f6e  : dict[str | Non
-000309d0: 652c 204c 6974 6572 616c 5b30 2c20 315d  e, Literal[0, 1]
-000309e0: 5d20 3d20 7b22 696e 6465 7822 3a20 302c  ] = {"index": 0,
-000309f0: 2022 636f 6c75 6d6e 7322 3a20 317d 0a20   "columns": 1}. 
-00030a00: 2020 2020 2020 2069 6620 6e6f 6e65 5f69         if none_i
-00030a10: 735f 7a65 726f 3a0a 2020 2020 2020 2020  s_zero:.        
-00030a20: 2020 2020 6e75 6d65 7269 635f 6178 6973      numeric_axis
-00030a30: 5b4e 6f6e 655d 203d 2030 0a0a 2020 2020  [None] = 0..    
-00030a40: 2020 2020 7265 7475 726e 206e 756d 6572      return numer
-00030a50: 6963 5f61 7869 732e 6765 7428 6178 6973  ic_axis.get(axis
-00030a60: 2c20 6178 6973 290a 0a20 2020 2040 6465  , axis)..    @de
-00030a70: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-00030a80: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-00030a90: 2064 726f 7028 7365 6c66 2c20 6c61 6265   drop(self, labe
-00030aa0: 6c73 3d4e 6f6e 652c 2061 7869 733d 302c  ls=None, axis=0,
-00030ab0: 2063 6f6c 756d 6e73 3d4e 6f6e 652c 2065   columns=None, e
-00030ac0: 7272 6f72 733d 2272 6169 7365 2229 3a0a  rrors="raise"):.
-00030ad0: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
-00030ae0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
-00030af0: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
-00030b00: 2069 6620 6178 6973 203d 3d20 3020 616e   if axis == 0 an
-00030b10: 6420 636f 6c75 6d6e 7320 6973 206e 6f74  d columns is not
-00030b20: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00030b30: 2020 2023 2043 6f6c 756d 6e73 206d 7573     # Columns mus
-00030b40: 7420 6265 2073 7065 6369 6669 6564 2069  t be specified i
-00030b50: 6620 6178 6973 3d3d 300a 2020 2020 2020  f axis==0.      
-00030b60: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00030b70: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-00030b80: 2864 726f 705f 6279 5f73 6861 6c6c 6f77  (drop_by_shallow
-00030b90: 5f63 6f70 792c 2063 6f6c 756d 6e73 2c20  _copy, columns, 
-00030ba0: 6572 726f 7273 3d65 7272 6f72 7329 0a20  errors=errors). 
-00030bb0: 2020 2020 2020 2065 6c69 6620 6178 6973         elif axis
-00030bc0: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-00030bd0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00030be0: 6170 5f70 6172 7469 7469 6f6e 7328 6472  ap_partitions(dr
-00030bf0: 6f70 5f62 795f 7368 616c 6c6f 775f 636f  op_by_shallow_co
-00030c00: 7079 2c20 6c61 6265 6c73 2c20 6572 726f  py, labels, erro
-00030c10: 7273 3d65 7272 6f72 7329 0a20 2020 2020  rs=errors).     
-00030c20: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00030c30: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-00030c40: 2020 2020 2020 2020 2020 2244 726f 7020            "Drop 
-00030c50: 6375 7272 656e 746c 7920 6f6e 6c79 2077  currently only w
-00030c60: 6f72 6b73 2066 6f72 2061 7869 733d 3120  orks for axis=1 
-00030c70: 6f72 2077 6865 6e20 636f 6c75 6d6e 7320  or when columns 
-00030c80: 6973 206e 6f74 204e 6f6e 6522 0a20 2020  is not None".   
-00030c90: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00030ca0: 6d65 7267 6528 0a20 2020 2020 2020 2073  merge(.        s
-00030cb0: 656c 662c 0a20 2020 2020 2020 2072 6967  elf,.        rig
-00030cc0: 6874 2c0a 2020 2020 2020 2020 686f 773d  ht,.        how=
-00030cd0: 2269 6e6e 6572 222c 0a20 2020 2020 2020  "inner",.       
-00030ce0: 206f 6e3d 4e6f 6e65 2c0a 2020 2020 2020   on=None,.      
-00030cf0: 2020 6c65 6674 5f6f 6e3d 4e6f 6e65 2c0a    left_on=None,.
-00030d00: 2020 2020 2020 2020 7269 6768 745f 6f6e          right_on
-00030d10: 3d4e 6f6e 652c 0a20 2020 2020 2020 206c  =None,.        l
-00030d20: 6566 745f 696e 6465 783d 4661 6c73 652c  eft_index=False,
-00030d30: 0a20 2020 2020 2020 2072 6967 6874 5f69  .        right_i
-00030d40: 6e64 6578 3d46 616c 7365 2c0a 2020 2020  ndex=False,.    
-00030d50: 2020 2020 7375 6666 6978 6573 3d28 225f      suffixes=("_
-00030d60: 7822 2c20 225f 7922 292c 0a20 2020 2020  x", "_y"),.     
-00030d70: 2020 2069 6e64 6963 6174 6f72 3d46 616c     indicator=Fal
-00030d80: 7365 2c0a 2020 2020 2020 2020 6e70 6172  se,.        npar
-00030d90: 7469 7469 6f6e 733d 4e6f 6e65 2c0a 2020  titions=None,.  
-00030da0: 2020 2020 2020 7368 7566 666c 653d 4e6f        shuffle=No
-00030db0: 6e65 2c0a 2020 2020 2020 2020 6272 6f61  ne,.        broa
-00030dc0: 6463 6173 743d 4e6f 6e65 2c0a 2020 2020  dcast=None,.    
-00030dd0: 293a 0a20 2020 2020 2020 2022 2222 4d65  ):.        """Me
-00030de0: 7267 6520 7468 6520 4461 7461 4672 616d  rge the DataFram
-00030df0: 6520 7769 7468 2061 6e6f 7468 6572 2044  e with another D
-00030e00: 6174 6146 7261 6d65 0a0a 2020 2020 2020  ataFrame..      
-00030e10: 2020 5468 6973 2077 696c 6c20 6d65 7267    This will merg
-00030e20: 6520 7468 6520 7477 6f20 6461 7461 7365  e the two datase
-00030e30: 7473 2c20 6569 7468 6572 206f 6e20 7468  ts, either on th
-00030e40: 6520 696e 6469 6365 732c 2061 2063 6572  e indices, a cer
-00030e50: 7461 696e 2063 6f6c 756d 6e0a 2020 2020  tain column.    
-00030e60: 2020 2020 696e 2065 6163 6820 6461 7461      in each data
-00030e70: 7365 7420 6f72 2074 6865 2069 6e64 6578  set or the index
-00030e80: 2069 6e20 6f6e 6520 6461 7461 7365 7420   in one dataset 
-00030e90: 616e 6420 7468 6520 636f 6c75 6d6e 2069  and the column i
-00030ea0: 6e20 616e 6f74 6865 722e 0a0a 2020 2020  n another...    
-00030eb0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00030ec0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00030ed0: 2d0a 2020 2020 2020 2020 7269 6768 743a  -.        right:
-00030ee0: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
-00030ef0: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
-00030f00: 2020 686f 7720 3a20 7b27 6c65 6674 272c    how : {'left',
-00030f10: 2027 7269 6768 7427 2c20 276f 7574 6572   'right', 'outer
-00030f20: 272c 2027 696e 6e65 7227 7d2c 2064 6566  ', 'inner'}, def
-00030f30: 6175 6c74 3a20 2769 6e6e 6572 270a 2020  ault: 'inner'.  
-00030f40: 2020 2020 2020 2020 2020 486f 7720 746f            How to
-00030f50: 2068 616e 646c 6520 7468 6520 6f70 6572   handle the oper
-00030f60: 6174 696f 6e20 6f66 2074 6865 2074 776f  ation of the two
-00030f70: 206f 626a 6563 7473 3a0a 0a20 2020 2020   objects:..     
-00030f80: 2020 2020 2020 202d 206c 6566 743a 2075         - left: u
-00030f90: 7365 2063 616c 6c69 6e67 2066 7261 6d65  se calling frame
-00030fa0: 2773 2069 6e64 6578 2028 6f72 2063 6f6c  's index (or col
-00030fb0: 756d 6e20 6966 206f 6e20 6973 2073 7065  umn if on is spe
-00030fc0: 6369 6669 6564 290a 2020 2020 2020 2020  cified).        
-00030fd0: 2020 2020 2d20 7269 6768 743a 2075 7365      - right: use
-00030fe0: 206f 7468 6572 2066 7261 6d65 2773 2069   other frame's i
-00030ff0: 6e64 6578 0a20 2020 2020 2020 2020 2020  ndex.           
-00031000: 202d 206f 7574 6572 3a20 666f 726d 2075   - outer: form u
-00031010: 6e69 6f6e 206f 6620 6361 6c6c 696e 6720  nion of calling 
-00031020: 6672 616d 6527 7320 696e 6465 7820 286f  frame's index (o
-00031030: 7220 636f 6c75 6d6e 2069 6620 6f6e 2069  r column if on i
-00031040: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00031050: 7370 6563 6966 6965 6429 2077 6974 6820  specified) with 
-00031060: 6f74 6865 7220 6672 616d 6527 7320 696e  other frame's in
-00031070: 6465 782c 2061 6e64 2073 6f72 7420 6974  dex, and sort it
-00031080: 0a20 2020 2020 2020 2020 2020 2020 206c  .              l
-00031090: 6578 6963 6f67 7261 7068 6963 616c 6c79  exicographically
-000310a0: 0a20 2020 2020 2020 2020 2020 202d 2069  .            - i
-000310b0: 6e6e 6572 3a20 666f 726d 2069 6e74 6572  nner: form inter
-000310c0: 7365 6374 696f 6e20 6f66 2063 616c 6c69  section of calli
-000310d0: 6e67 2066 7261 6d65 2773 2069 6e64 6578  ng frame's index
-000310e0: 2028 6f72 2063 6f6c 756d 6e20 6966 0a20   (or column if. 
-000310f0: 2020 2020 2020 2020 2020 2020 206f 6e20               on 
-00031100: 6973 2073 7065 6369 6669 6564 2920 7769  is specified) wi
-00031110: 7468 206f 7468 6572 2066 7261 6d65 2773  th other frame's
-00031120: 2069 6e64 6578 2c20 7072 6573 6572 7669   index, preservi
-00031130: 6e67 2074 6865 206f 7264 6572 0a20 2020  ng the order.   
-00031140: 2020 2020 2020 2020 2020 206f 6620 7468             of th
-00031150: 6520 6361 6c6c 696e 6727 7320 6f6e 650a  e calling's one.
-00031160: 0a20 2020 2020 2020 206f 6e20 3a20 6c61  .        on : la
-00031170: 6265 6c20 6f72 206c 6973 740a 2020 2020  bel or list.    
-00031180: 2020 2020 2020 2020 436f 6c75 6d6e 206f          Column o
-00031190: 7220 696e 6465 7820 6c65 7665 6c20 6e61  r index level na
-000311a0: 6d65 7320 746f 206a 6f69 6e20 6f6e 2e20  mes to join on. 
-000311b0: 5468 6573 6520 6d75 7374 2062 6520 666f  These must be fo
-000311c0: 756e 6420 696e 2062 6f74 680a 2020 2020  und in both.    
-000311d0: 2020 2020 2020 2020 4461 7461 4672 616d          DataFram
-000311e0: 6573 2e20 4966 206f 6e20 6973 204e 6f6e  es. If on is Non
-000311f0: 6520 616e 6420 6e6f 7420 6d65 7267 696e  e and not mergin
-00031200: 6720 6f6e 2069 6e64 6578 6573 2074 6865  g on indexes the
-00031210: 6e20 7468 6973 0a20 2020 2020 2020 2020  n this.         
-00031220: 2020 2064 6566 6175 6c74 7320 746f 2074     defaults to t
-00031230: 6865 2069 6e74 6572 7365 6374 696f 6e20  he intersection 
-00031240: 6f66 2074 6865 2063 6f6c 756d 6e73 2069  of the columns i
-00031250: 6e20 626f 7468 2044 6174 6146 7261 6d65  n both DataFrame
-00031260: 732e 0a20 2020 2020 2020 206c 6566 745f  s..        left_
-00031270: 6f6e 203a 206c 6162 656c 206f 7220 6c69  on : label or li
-00031280: 7374 2c20 6f72 2061 7272 6179 2d6c 696b  st, or array-lik
-00031290: 650a 2020 2020 2020 2020 2020 2020 436f  e.            Co
-000312a0: 6c75 6d6e 2074 6f20 6a6f 696e 206f 6e20  lumn to join on 
-000312b0: 696e 2074 6865 206c 6566 7420 4461 7461  in the left Data
-000312c0: 4672 616d 652e 204f 7468 6572 2074 6861  Frame. Other tha
-000312d0: 6e20 696e 2070 616e 6461 730a 2020 2020  n in pandas.    
-000312e0: 2020 2020 2020 2020 6172 7261 7973 2061          arrays a
-000312f0: 6e64 206c 6973 7473 2061 7265 206f 6e6c  nd lists are onl
-00031300: 7920 7375 7070 6f72 7420 6966 2074 6865  y support if the
-00031310: 6972 206c 656e 6774 6820 6973 2031 2e0a  ir length is 1..
-00031320: 2020 2020 2020 2020 7269 6768 745f 6f6e          right_on
-00031330: 203a 206c 6162 656c 206f 7220 6c69 7374   : label or list
-00031340: 2c20 6f72 2061 7272 6179 2d6c 696b 650a  , or array-like.
-00031350: 2020 2020 2020 2020 2020 2020 436f 6c75              Colu
-00031360: 6d6e 2074 6f20 6a6f 696e 206f 6e20 696e  mn to join on in
-00031370: 2074 6865 2072 6967 6874 2044 6174 6146   the right DataF
-00031380: 7261 6d65 2e20 4f74 6865 7220 7468 616e  rame. Other than
-00031390: 2069 6e20 7061 6e64 6173 0a20 2020 2020   in pandas.     
-000313a0: 2020 2020 2020 2061 7272 6179 7320 616e         arrays an
-000313b0: 6420 6c69 7374 7320 6172 6520 6f6e 6c79  d lists are only
-000313c0: 2073 7570 706f 7274 2069 6620 7468 6569   support if thei
-000313d0: 7220 6c65 6e67 7468 2069 7320 312e 0a20  r length is 1.. 
-000313e0: 2020 2020 2020 206c 6566 745f 696e 6465         left_inde
-000313f0: 7820 3a20 626f 6f6c 6561 6e2c 2064 6566  x : boolean, def
-00031400: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
-00031410: 2020 2020 2020 2055 7365 2074 6865 2069         Use the i
-00031420: 6e64 6578 2066 726f 6d20 7468 6520 6c65  ndex from the le
-00031430: 6674 2044 6174 6146 7261 6d65 2061 7320  ft DataFrame as 
-00031440: 7468 6520 6a6f 696e 206b 6579 2e0a 2020  the join key..  
-00031450: 2020 2020 2020 7269 6768 745f 696e 6465        right_inde
-00031460: 7820 3a20 626f 6f6c 6561 6e2c 2064 6566  x : boolean, def
-00031470: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
-00031480: 2020 2020 2020 2055 7365 2074 6865 2069         Use the i
-00031490: 6e64 6578 2066 726f 6d20 7468 6520 7269  ndex from the ri
-000314a0: 6768 7420 4461 7461 4672 616d 6520 6173  ght DataFrame as
-000314b0: 2074 6865 206a 6f69 6e20 6b65 792e 0a20   the join key.. 
-000314c0: 2020 2020 2020 2073 7566 6669 7865 7320         suffixes 
-000314d0: 3a20 322d 6c65 6e67 7468 2073 6571 7565  : 2-length seque
-000314e0: 6e63 6520 2874 7570 6c65 2c20 6c69 7374  nce (tuple, list
-000314f0: 2c20 2e2e 2e29 0a20 2020 2020 2020 2020  , ...).         
-00031500: 2020 2053 7566 6669 7820 746f 2061 7070     Suffix to app
-00031510: 6c79 2074 6f20 6f76 6572 6c61 7070 696e  ly to overlappin
-00031520: 6720 636f 6c75 6d6e 206e 616d 6573 2069  g column names i
-00031530: 6e20 7468 6520 6c65 6674 2061 6e64 0a20  n the left and. 
-00031540: 2020 2020 2020 2020 2020 2072 6967 6874             right
-00031550: 2073 6964 652c 2072 6573 7065 6374 6976   side, respectiv
-00031560: 656c 790a 2020 2020 2020 2020 696e 6469  ely.        indi
-00031570: 6361 746f 7220 3a20 626f 6f6c 6561 6e20  cator : boolean 
-00031580: 6f72 2073 7472 696e 672c 2064 6566 6175  or string, defau
-00031590: 6c74 2046 616c 7365 0a20 2020 2020 2020  lt False.       
-000315a0: 2020 2020 2049 6620 5472 7565 2c20 6164       If True, ad
-000315b0: 6473 2061 2063 6f6c 756d 6e20 746f 206f  ds a column to o
-000315c0: 7574 7075 7420 4461 7461 4672 616d 6520  utput DataFrame 
-000315d0: 6361 6c6c 6564 2022 5f6d 6572 6765 2220  called "_merge" 
-000315e0: 7769 7468 0a20 2020 2020 2020 2020 2020  with.           
-000315f0: 2069 6e66 6f72 6d61 7469 6f6e 206f 6e20   information on 
-00031600: 7468 6520 736f 7572 6365 206f 6620 6561  the source of ea
-00031610: 6368 2072 6f77 2e20 4966 2073 7472 696e  ch row. If strin
-00031620: 672c 2063 6f6c 756d 6e20 7769 7468 0a20  g, column with. 
-00031630: 2020 2020 2020 2020 2020 2069 6e66 6f72             infor
-00031640: 6d61 7469 6f6e 206f 6e20 736f 7572 6365  mation on source
-00031650: 206f 6620 6561 6368 2072 6f77 2077 696c   of each row wil
-00031660: 6c20 6265 2061 6464 6564 2074 6f20 6f75  l be added to ou
-00031670: 7470 7574 2044 6174 6146 7261 6d65 2c0a  tput DataFrame,.
-00031680: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00031690: 636f 6c75 6d6e 2077 696c 6c20 6265 206e  column will be n
-000316a0: 616d 6564 2076 616c 7565 206f 6620 7374  amed value of st
-000316b0: 7269 6e67 2e20 496e 666f 726d 6174 696f  ring. Informatio
-000316c0: 6e20 636f 6c75 6d6e 2069 730a 2020 2020  n column is.    
-000316d0: 2020 2020 2020 2020 4361 7465 676f 7269          Categori
-000316e0: 6361 6c2d 7479 7065 2061 6e64 2074 616b  cal-type and tak
-000316f0: 6573 206f 6e20 6120 7661 6c75 6520 6f66  es on a value of
-00031700: 2022 6c65 6674 5f6f 6e6c 7922 2066 6f72   "left_only" for
-00031710: 206f 6273 6572 7661 7469 6f6e 730a 2020   observations.  
-00031720: 2020 2020 2020 2020 2020 7768 6f73 6520            whose 
-00031730: 6d65 7267 6520 6b65 7920 6f6e 6c79 2061  merge key only a
-00031740: 7070 6561 7273 2069 6e20 606c 6566 7460  ppears in `left`
-00031750: 2044 6174 6146 7261 6d65 2c20 2272 6967   DataFrame, "rig
-00031760: 6874 5f6f 6e6c 7922 2066 6f72 0a20 2020  ht_only" for.   
-00031770: 2020 2020 2020 2020 206f 6273 6572 7661           observa
-00031780: 7469 6f6e 7320 7768 6f73 6520 6d65 7267  tions whose merg
-00031790: 6520 6b65 7920 6f6e 6c79 2061 7070 6561  e key only appea
-000317a0: 7273 2069 6e20 6072 6967 6874 6020 4461  rs in `right` Da
-000317b0: 7461 4672 616d 652c 0a20 2020 2020 2020  taFrame,.       
-000317c0: 2020 2020 2061 6e64 2022 626f 7468 2220       and "both" 
-000317d0: 6966 2074 6865 206f 6273 6572 7661 7469  if the observati
-000317e0: 6f6e e280 9973 206d 6572 6765 206b 6579  on...s merge key
-000317f0: 2069 7320 666f 756e 6420 696e 2062 6f74   is found in bot
-00031800: 682e 0a20 2020 2020 2020 206e 7061 7274  h..        npart
-00031810: 6974 696f 6e73 3a20 696e 7420 6f72 204e  itions: int or N
-00031820: 6f6e 652c 206f 7074 696f 6e61 6c0a 2020  one, optional.  
-00031830: 2020 2020 2020 2020 2020 5468 6520 6964            The id
-00031840: 6561 6c20 6e75 6d62 6572 206f 6620 6f75  eal number of ou
-00031850: 7470 7574 2070 6172 7469 7469 6f6e 732e  tput partitions.
-00031860: 2054 6869 7320 6973 206f 6e6c 7920 7574   This is only ut
-00031870: 696c 6973 6564 2077 6865 6e0a 2020 2020  ilised when.    
-00031880: 2020 2020 2020 2020 7065 7266 6f72 6d69          performi
-00031890: 6e67 2061 2068 6173 685f 6a6f 696e 2028  ng a hash_join (
-000318a0: 6d65 7267 696e 6720 6f6e 2063 6f6c 756d  merging on colum
-000318b0: 6e73 206f 6e6c 7929 2e20 4966 2060 604e  ns only). If ``N
-000318c0: 6f6e 6560 6020 7468 656e 0a20 2020 2020  one`` then.     
-000318d0: 2020 2020 2020 2060 606e 7061 7274 6974         ``npartit
-000318e0: 696f 6e73 203d 206d 6178 286c 6873 2e6e  ions = max(lhs.n
-000318f0: 7061 7274 6974 696f 6e73 2c20 7268 732e  partitions, rhs.
-00031900: 6e70 6172 7469 7469 6f6e 7329 6060 2e0a  npartitions)``..
-00031910: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
-00031920: 756c 7420 6973 2060 604e 6f6e 6560 602e  ult is ``None``.
-00031930: 0a20 2020 2020 2020 2073 6875 6666 6c65  .        shuffle
-00031940: 3a20 7b27 6469 736b 272c 2027 7461 736b  : {'disk', 'task
-00031950: 7327 7d2c 206f 7074 696f 6e61 6c0a 2020  s'}, optional.  
-00031960: 2020 2020 2020 2020 2020 4569 7468 6572            Either
-00031970: 2060 6027 6469 736b 2760 6020 666f 7220   ``'disk'`` for 
-00031980: 7369 6e67 6c65 2d6e 6f64 6520 6f70 6572  single-node oper
-00031990: 6174 696f 6e20 6f72 2060 6027 7461 736b  ation or ``'task
-000319a0: 7327 6060 2066 6f72 0a20 2020 2020 2020  s'`` for.       
-000319b0: 2020 2020 2064 6973 7472 6962 7574 6564       distributed
-000319c0: 206f 7065 7261 7469 6f6e 2e20 2057 696c   operation.  Wil
-000319d0: 6c20 6265 2069 6e66 6572 7265 6420 6279  l be inferred by
-000319e0: 2079 6f75 7220 6375 7272 656e 7420 7363   your current sc
-000319f0: 6865 6475 6c65 722e 0a20 2020 2020 2020  heduler..       
-00031a00: 2062 726f 6164 6361 7374 3a20 626f 6f6c   broadcast: bool
-00031a10: 6561 6e20 6f72 2066 6c6f 6174 2c20 6f70  ean or float, op
-00031a20: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00031a30: 2020 2057 6865 7468 6572 2074 6f20 7573     Whether to us
-00031a40: 6520 6120 6272 6f61 6463 6173 742d 6261  e a broadcast-ba
-00031a50: 7365 6420 6a6f 696e 2069 6e20 6c69 6575  sed join in lieu
-00031a60: 206f 6620 6120 7368 7566 666c 652d 6261   of a shuffle-ba
-00031a70: 7365 640a 2020 2020 2020 2020 2020 2020  sed.            
-00031a80: 6a6f 696e 2066 6f72 2073 7570 706f 7274  join for support
-00031a90: 6564 2063 6173 6573 2e20 2042 7920 6465  ed cases.  By de
-00031aa0: 6661 756c 742c 2061 2073 696d 706c 6520  fault, a simple 
-00031ab0: 6865 7572 6973 7469 6320 7769 6c6c 2062  heuristic will b
-00031ac0: 650a 2020 2020 2020 2020 2020 2020 7573  e.            us
-00031ad0: 6564 2074 6f20 7365 6c65 6374 2074 6865  ed to select the
-00031ae0: 2075 6e64 6572 6c79 696e 6720 616c 676f   underlying algo
-00031af0: 7269 7468 6d2e 2049 6620 6120 666c 6f61  rithm. If a floa
-00031b00: 7469 6e67 2d70 6f69 6e74 2076 616c 7565  ting-point value
-00031b10: 0a20 2020 2020 2020 2020 2020 2069 7320  .            is 
-00031b20: 7370 6563 6966 6965 642c 2074 6861 7420  specified, that 
-00031b30: 6e75 6d62 6572 2077 696c 6c20 6265 2075  number will be u
-00031b40: 7365 6420 6173 2074 6865 2060 6062 726f  sed as the ``bro
-00031b50: 6164 6361 7374 5f62 6961 7360 600a 2020  adcast_bias``.  
-00031b60: 2020 2020 2020 2020 2020 7769 7468 696e            within
-00031b70: 2074 6865 2073 696d 706c 6520 6865 7572   the simple heur
-00031b80: 6973 7469 6320 2861 206c 6172 6765 206e  istic (a large n
-00031b90: 756d 6265 7220 6d61 6b65 7320 4461 736b  umber makes Dask
-00031ba0: 206d 6f72 6520 6c69 6b65 6c79 0a20 2020   more likely.   
-00031bb0: 2020 2020 2020 2020 2074 6f20 6368 6f6f           to choo
-00031bc0: 7365 2074 6865 2060 6062 726f 6163 6173  se the ``broacas
-00031bd0: 745f 6a6f 696e 6060 2063 6f64 6520 7061  t_join`` code pa
-00031be0: 7468 292e 2053 6565 2060 6062 726f 6164  th). See ``broad
-00031bf0: 6361 7374 5f6a 6f69 6e60 600a 2020 2020  cast_join``.    
-00031c00: 2020 2020 2020 2020 666f 7220 6d6f 7265          for more
-00031c10: 2069 6e66 6f72 6d61 7469 6f6e 2e0a 0a20   information... 
-00031c20: 2020 2020 2020 204e 6f74 6573 0a20 2020         Notes.   
-00031c30: 2020 2020 202d 2d2d 2d2d 0a0a 2020 2020       -----..    
-00031c40: 2020 2020 5468 6572 6520 6172 6520 7468      There are th
-00031c50: 7265 6520 7761 7973 2074 6f20 6a6f 696e  ree ways to join
-00031c60: 2064 6174 6166 7261 6d65 733a 0a0a 2020   dataframes:..  
-00031c70: 2020 2020 2020 312e 204a 6f69 6e69 6e67        1. Joining
-00031c80: 206f 6e20 696e 6469 6365 732e 2049 6e20   on indices. In 
-00031c90: 7468 6973 2063 6173 6520 7468 6520 6469  this case the di
-00031ca0: 7669 7369 6f6e 7320 6172 650a 2020 2020  visions are.    
-00031cb0: 2020 2020 2020 2061 6c69 676e 6564 2075         aligned u
-00031cc0: 7369 6e67 2074 6865 2066 756e 6374 696f  sing the functio
-00031cd0: 6e20 6060 6461 736b 2e64 6174 6166 7261  n ``dask.datafra
-00031ce0: 6d65 2e6d 756c 7469 2e61 6c69 676e 5f70  me.multi.align_p
-00031cf0: 6172 7469 7469 6f6e 7360 602e 0a20 2020  artitions``..   
-00031d00: 2020 2020 2020 2020 4166 7465 7277 6172          Afterwar
-00031d10: 6473 2c20 6561 6368 2070 6172 7469 7469  ds, each partiti
-00031d20: 6f6e 2069 7320 6d65 7267 6564 2077 6974  on is merged wit
-00031d30: 6820 7468 6520 7061 6e64 6173 206d 6572  h the pandas mer
-00031d40: 6765 2066 756e 6374 696f 6e2e 0a0a 2020  ge function...  
-00031d50: 2020 2020 2020 322e 204a 6f69 6e69 6e67        2. Joining
-00031d60: 206f 6e65 206f 6e20 696e 6465 7820 616e   one on index an
-00031d70: 6420 6f6e 6520 6f6e 2063 6f6c 756d 6e2e  d one on column.
-00031d80: 2049 6e20 7468 6973 2063 6173 6520 7468   In this case th
-00031d90: 6520 6469 7669 7369 6f6e 7320 6f66 0a20  e divisions of. 
-00031da0: 2020 2020 2020 2020 2020 6461 7461 6672            datafr
-00031db0: 616d 6520 6d65 7267 6564 2062 7920 696e  ame merged by in
-00031dc0: 6465 7820 283a 6d61 7468 3a60 645f 6960  dex (:math:`d_i`
-00031dd0: 2920 6172 6520 7573 6564 2074 6f20 6469  ) are used to di
-00031de0: 7669 6465 2074 6865 2063 6f6c 756d 6e0a  vide the column.
-00031df0: 2020 2020 2020 2020 2020 206d 6572 6765             merge
-00031e00: 6420 6461 7461 6672 616d 6520 283a 6d61  d dataframe (:ma
-00031e10: 7468 3a60 645f 6360 2920 6f6e 6520 7573  th:`d_c`) one us
-00031e20: 696e 670a 2020 2020 2020 2020 2020 2060  ing.           `
-00031e30: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
-00031e40: 6d75 6c74 692e 7265 6172 7261 6e67 655f  multi.rearrange_
-00031e50: 6279 5f64 6976 6973 696f 6e73 6060 2e20  by_divisions``. 
-00031e60: 496e 2074 6869 7320 6361 7365 2074 6865  In this case the
-00031e70: 0a20 2020 2020 2020 2020 2020 6d65 7267  .           merg
-00031e80: 6564 2064 6174 6166 7261 6d65 2028 3a6d  ed dataframe (:m
-00031e90: 6174 683a 6064 5f6d 6029 2068 6173 2074  ath:`d_m`) has t
-00031ea0: 6865 2065 7861 6374 2073 616d 6520 6469  he exact same di
-00031eb0: 7669 7369 6f6e 730a 2020 2020 2020 2020  visions.        
-00031ec0: 2020 2061 7320 283a 6d61 7468 3a60 645f     as (:math:`d_
-00031ed0: 6960 292e 2054 6869 7320 6361 6e20 6c65  i`). This can le
-00031ee0: 6164 2074 6f20 6973 7375 6573 2069 6620  ad to issues if 
-00031ef0: 796f 7520 6d65 7267 6520 6d75 6c74 6970  you merge multip
-00031f00: 6c65 2072 6f77 7320 6672 6f6d 0a20 2020  le rows from.   
-00031f10: 2020 2020 2020 2020 283a 6d61 7468 3a60          (:math:`
-00031f20: 645f 6360 2920 746f 206f 6e65 2072 6f77  d_c`) to one row
-00031f30: 2069 6e20 283a 6d61 7468 3a60 645f 6960   in (:math:`d_i`
-00031f40: 292e 0a0a 2020 2020 2020 2020 332e 204a  )...        3. J
-00031f50: 6f69 6e69 6e67 2062 6f74 6820 6f6e 2063  oining both on c
-00031f60: 6f6c 756d 6e73 2e20 496e 2074 6869 7320  olumns. In this 
-00031f70: 6361 7365 2061 2068 6173 6820 6a6f 696e  case a hash join
-00031f80: 2069 7320 7065 7266 6f72 6d65 6420 7573   is performed us
-00031f90: 696e 670a 2020 2020 2020 2020 2020 2060  ing.           `
-00031fa0: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
-00031fb0: 6d75 6c74 692e 6861 7368 5f6a 6f69 6e60  multi.hash_join`
-00031fc0: 602e 0a0a 2020 2020 2020 2020 496e 2073  `...        In s
-00031fd0: 6f6d 6520 6361 7365 732c 2079 6f75 206d  ome cases, you m
-00031fe0: 6179 2073 6565 2061 2060 604d 656d 6f72  ay see a ``Memor
-00031ff0: 7945 7272 6f72 6060 2069 6620 7468 6520  yError`` if the 
-00032000: 6060 6d65 7267 6560 6020 6f70 6572 6174  ``merge`` operat
-00032010: 696f 6e20 7265 7175 6972 6573 0a20 2020  ion requires.   
-00032020: 2020 2020 2061 6e20 696e 7465 726e 616c       an internal
-00032030: 2060 6073 6875 6666 6c65 6060 2c20 6265   ``shuffle``, be
-00032040: 6361 7573 6520 7368 7566 666c 696e 6720  cause shuffling 
-00032050: 706c 6163 6573 2061 6c6c 2072 6f77 7320  places all rows 
-00032060: 7468 6174 2068 6176 6520 7468 6520 7361  that have the sa
-00032070: 6d65 0a20 2020 2020 2020 2069 6e64 6578  me.        index
-00032080: 2069 6e20 7468 6520 7361 6d65 2070 6172   in the same par
-00032090: 7469 7469 6f6e 2e20 546f 2061 766f 6964  tition. To avoid
-000320a0: 2074 6869 7320 6572 726f 722c 206d 616b   this error, mak
-000320b0: 6520 7375 7265 2061 6c6c 2072 6f77 7320  e sure all rows 
-000320c0: 7769 7468 2074 6865 0a20 2020 2020 2020  with the.       
-000320d0: 2073 616d 6520 6060 6f6e 6060 2d63 6f6c   same ``on``-col
-000320e0: 756d 6e20 7661 6c75 6520 6361 6e20 6669  umn value can fi
-000320f0: 7420 6f6e 2061 2073 696e 676c 6520 7061  t on a single pa
-00032100: 7274 6974 696f 6e2e 0a20 2020 2020 2020  rtition..       
-00032110: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
-00032120: 206e 6f74 2069 735f 6461 7461 6672 616d   not is_datafram
-00032130: 655f 6c69 6b65 2872 6967 6874 293a 0a20  e_like(right):. 
-00032140: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00032150: 2056 616c 7565 4572 726f 7228 2272 6967   ValueError("rig
-00032160: 6874 206d 7573 7420 6265 2044 6174 6146  ht must be DataF
-00032170: 7261 6d65 2229 0a0a 2020 2020 2020 2020  rame")..        
-00032180: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
-00032190: 616d 652e 6d75 6c74 6920 696d 706f 7274  ame.multi import
-000321a0: 206d 6572 6765 0a0a 2020 2020 2020 2020   merge..        
-000321b0: 7265 7475 726e 206d 6572 6765 280a 2020  return merge(.  
-000321c0: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-000321d0: 2020 2020 2020 2020 2020 2020 7269 6768              righ
-000321e0: 742c 0a20 2020 2020 2020 2020 2020 2068  t,.            h
-000321f0: 6f77 3d68 6f77 2c0a 2020 2020 2020 2020  ow=how,.        
-00032200: 2020 2020 6f6e 3d6f 6e2c 0a20 2020 2020      on=on,.     
-00032210: 2020 2020 2020 206c 6566 745f 6f6e 3d6c         left_on=l
-00032220: 6566 745f 6f6e 2c0a 2020 2020 2020 2020  eft_on,.        
-00032230: 2020 2020 7269 6768 745f 6f6e 3d72 6967      right_on=rig
-00032240: 6874 5f6f 6e2c 0a20 2020 2020 2020 2020  ht_on,.         
-00032250: 2020 206c 6566 745f 696e 6465 783d 6c65     left_index=le
-00032260: 6674 5f69 6e64 6578 2c0a 2020 2020 2020  ft_index,.      
-00032270: 2020 2020 2020 7269 6768 745f 696e 6465        right_inde
-00032280: 783d 7269 6768 745f 696e 6465 782c 0a20  x=right_index,. 
-00032290: 2020 2020 2020 2020 2020 2073 7566 6669             suffi
-000322a0: 7865 733d 7375 6666 6978 6573 2c0a 2020  xes=suffixes,.  
-000322b0: 2020 2020 2020 2020 2020 6e70 6172 7469            nparti
-000322c0: 7469 6f6e 733d 6e70 6172 7469 7469 6f6e  tions=npartition
-000322d0: 732c 0a20 2020 2020 2020 2020 2020 2069  s,.            i
-000322e0: 6e64 6963 6174 6f72 3d69 6e64 6963 6174  ndicator=indicat
-000322f0: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
-00032300: 7368 7566 666c 653d 7368 7566 666c 652c  shuffle=shuffle,
-00032310: 0a20 2020 2020 2020 2020 2020 2062 726f  .            bro
-00032320: 6164 6361 7374 3d62 726f 6164 6361 7374  adcast=broadcast
-00032330: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00032340: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00032350: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-00032360: 2064 6566 206a 6f69 6e28 0a20 2020 2020   def join(.     
-00032370: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00032380: 206f 7468 6572 2c0a 2020 2020 2020 2020   other,.        
-00032390: 6f6e 3d4e 6f6e 652c 0a20 2020 2020 2020  on=None,.       
-000323a0: 2068 6f77 3d22 6c65 6674 222c 0a20 2020   how="left",.   
-000323b0: 2020 2020 206c 7375 6666 6978 3d22 222c       lsuffix="",
-000323c0: 0a20 2020 2020 2020 2072 7375 6666 6978  .        rsuffix
-000323d0: 3d22 222c 0a20 2020 2020 2020 206e 7061  ="",.        npa
-000323e0: 7274 6974 696f 6e73 3d4e 6f6e 652c 0a20  rtitions=None,. 
-000323f0: 2020 2020 2020 2073 6875 6666 6c65 3d4e         shuffle=N
-00032400: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-00032410: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
-00032420: 5f6c 696b 6528 6f74 6865 7229 2061 6e64  _like(other) and
-00032430: 2068 6173 6174 7472 286f 7468 6572 2c20   hasattr(other, 
-00032440: 226e 616d 6522 293a 0a20 2020 2020 2020  "name"):.       
-00032450: 2020 2020 206f 7468 6572 203d 206f 7468       other = oth
-00032460: 6572 2e74 6f5f 6672 616d 6528 290a 0a20  er.to_frame().. 
-00032470: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-00032480: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
-00032490: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-000324a0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-000324b0: 7461 6e63 6528 6f74 6865 722c 206c 6973  tance(other, lis
-000324c0: 7429 206f 7220 6e6f 7420 616c 6c28 0a20  t) or not all(. 
-000324d0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-000324e0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-000324f0: 6528 6f29 2066 6f72 206f 2069 6e20 6f74  e(o) for o in ot
-00032500: 6865 725d 0a20 2020 2020 2020 2020 2020  her].           
-00032510: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-00032520: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00032530: 7272 6f72 2822 6f74 6865 7220 6d75 7374  rror("other must
-00032540: 2062 6520 4461 7461 4672 616d 6520 6f72   be DataFrame or
-00032550: 206c 6973 7420 6f66 2044 6174 6146 7261   list of DataFra
-00032560: 6d65 7322 290a 2020 2020 2020 2020 2020  mes").          
-00032570: 2020 6966 2068 6f77 206e 6f74 2069 6e20    if how not in 
-00032580: 5b22 6f75 7465 7222 2c20 226c 6566 7422  ["outer", "left"
-00032590: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-000325a0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000325b0: 726f 7228 226d 6572 6765 5f6d 756c 7469  ror("merge_multi
-000325c0: 206f 6e6c 7920 7375 7070 6f72 7473 206c   only supports l
-000325d0: 6566 7420 6f72 206f 7574 6572 206a 6f69  eft or outer joi
-000325e0: 6e73 2229 0a0a 2020 2020 2020 2020 2020  ns")..          
-000325f0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-00032600: 6672 616d 652e 6d75 6c74 6920 696d 706f  frame.multi impo
-00032610: 7274 205f 7265 6375 7273 6976 655f 7061  rt _recursive_pa
-00032620: 6972 7769 7365 5f6f 7574 6572 5f6a 6f69  irwise_outer_joi
-00032630: 6e0a 0a20 2020 2020 2020 2020 2020 2023  n..            #
-00032640: 2049 6620 6974 7320 616e 206f 7574 6572   If its an outer
-00032650: 206a 6f69 6e20 7765 2063 616e 2075 7365   join we can use
-00032660: 2074 6865 2066 756c 6c20 7265 6375 7273   the full recurs
-00032670: 6976 6520 7061 6972 7769 7365 206a 6f69  ive pairwise joi
-00032680: 6e2e 0a20 2020 2020 2020 2020 2020 2069  n..            i
-00032690: 6620 686f 7720 3d3d 2022 6f75 7465 7222  f how == "outer"
-000326a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000326b0: 2020 6675 6c6c 203d 205b 7365 6c66 5d20    full = [self] 
-000326c0: 2b20 6f74 6865 720a 0a20 2020 2020 2020  + other..       
-000326d0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000326e0: 5f72 6563 7572 7369 7665 5f70 6169 7277  _recursive_pairw
-000326f0: 6973 655f 6f75 7465 725f 6a6f 696e 280a  ise_outer_join(.
-00032700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032710: 2020 2020 6675 6c6c 2c0a 2020 2020 2020      full,.      
-00032720: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
-00032730: 3d6f 6e2c 0a20 2020 2020 2020 2020 2020  =on,.           
-00032740: 2020 2020 2020 2020 206c 7375 6666 6978           lsuffix
-00032750: 3d6c 7375 6666 6978 2c0a 2020 2020 2020  =lsuffix,.      
-00032760: 2020 2020 2020 2020 2020 2020 2020 7273                rs
-00032770: 7566 6669 783d 7273 7566 6669 782c 0a20  uffix=rsuffix,. 
-00032780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032790: 2020 206e 7061 7274 6974 696f 6e73 3d6e     npartitions=n
-000327a0: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
-000327b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000327c0: 7368 7566 666c 653d 7368 7566 666c 652c  shuffle=shuffle,
-000327d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000327e0: 2029 0a20 2020 2020 2020 2020 2020 2065   ).            e
-000327f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00032800: 2020 2020 2023 2044 6f20 7265 6375 7273       # Do recurs
-00032810: 6976 6520 7061 6972 7769 7365 206a 6f69  ive pairwise joi
-00032820: 6e20 6f6e 2065 7665 7279 7468 696e 6720  n on everything 
-00032830: 5f65 7863 6570 745f 2074 6865 206c 6173  _except_ the las
-00032840: 7420 6a6f 696e 0a20 2020 2020 2020 2020  t join.         
-00032850: 2020 2020 2020 2023 2077 6865 7265 2077         # where w
-00032860: 6520 6e65 6564 2074 6f20 646f 2061 206c  e need to do a l
-00032870: 6566 7420 6a6f 696e 2e0a 2020 2020 2020  eft join..      
-00032880: 2020 2020 2020 2020 2020 6f74 6865 7220            other 
-00032890: 3d20 5f72 6563 7572 7369 7665 5f70 6169  = _recursive_pai
-000328a0: 7277 6973 655f 6f75 7465 725f 6a6f 696e  rwise_outer_join
-000328b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000328c0: 2020 2020 2020 6f74 6865 722c 0a20 2020        other,.   
-000328d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000328e0: 206f 6e3d 6f6e 2c0a 2020 2020 2020 2020   on=on,.        
-000328f0: 2020 2020 2020 2020 2020 2020 6c73 7566              lsuf
-00032900: 6669 783d 6c73 7566 6669 782c 0a20 2020  fix=lsuffix,.   
+0002cfa0: 2020 2020 2027 3230 3231 2d30 312d 3035       '2021-01-05
+0002cfb0: 272c 2027 3230 3231 2d30 312d 3036 272c  ', '2021-01-06',
+0002cfc0: 2027 3230 3231 2d30 312d 3037 275d 2c0a   '2021-01-07'],.
+0002cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cfe0: 2020 2020 2020 6474 7970 653d 2764 6174        dtype='dat
+0002cff0: 6574 696d 6536 345b 6e73 5d27 2c20 6672  etime64[ns]', fr
+0002d000: 6571 3d27 4427 290a 0a20 2020 2020 2020  eq='D')..       
+0002d010: 204e 6f74 6520 7468 6174 2060 606c 656e   Note that ``len
+0002d020: 2864 6976 6973 6f6e 7329 6060 2069 7320  (divisons)`` is 
+0002d030: 6571 7561 6c20 746f 2060 606e 7061 7274  equal to ``npart
+0002d040: 6974 696f 6e73 202b 2031 6060 2e20 5468  itions + 1``. Th
+0002d050: 6973 2069 7320 6265 6361 7573 6520 6060  is is because ``
+0002d060: 6469 7669 7369 6f6e 7360 600a 2020 2020  divisions``.    
+0002d070: 2020 2020 7265 7072 6573 656e 7473 2074      represents t
+0002d080: 6865 2075 7070 6572 2061 6e64 206c 6f77  he upper and low
+0002d090: 6572 2062 6f75 6e64 7320 6f66 2065 6163  er bounds of eac
+0002d0a0: 6820 7061 7274 6974 696f 6e2e 2054 6865  h partition. The
+0002d0b0: 2066 6972 7374 2069 7465 6d20 6973 2074   first item is t
+0002d0c0: 6865 0a20 2020 2020 2020 206c 6f77 6572  he.        lower
+0002d0d0: 2062 6f75 6e64 206f 6620 7468 6520 6669   bound of the fi
+0002d0e0: 7273 7420 7061 7274 6974 696f 6e2c 2074  rst partition, t
+0002d0f0: 6865 2073 6563 6f6e 6420 6974 656d 2069  he second item i
+0002d100: 7320 7468 6520 6c6f 7765 7220 626f 756e  s the lower boun
+0002d110: 6420 6f66 2074 6865 0a20 2020 2020 2020  d of the.       
+0002d120: 2073 6563 6f6e 6420 7061 7274 6974 696f   second partitio
+0002d130: 6e20 616e 6420 7468 6520 7570 7065 7220  n and the upper 
+0002d140: 626f 756e 6420 6f66 2074 6865 2066 6972  bound of the fir
+0002d150: 7374 2070 6172 7469 7469 6f6e 2c20 616e  st partition, an
+0002d160: 6420 736f 206f 6e2e 0a20 2020 2020 2020  d so on..       
+0002d170: 2054 6865 2073 6563 6f6e 642d 746f 2d6c   The second-to-l
+0002d180: 6173 7420 6974 656d 2069 7320 7468 6520  ast item is the 
+0002d190: 6c6f 7765 7220 626f 756e 6420 6f66 2074  lower bound of t
+0002d1a0: 6865 206c 6173 7420 7061 7274 6974 696f  he last partitio
+0002d1b0: 6e2c 2061 6e64 2074 6865 206c 6173 740a  n, and the last.
+0002d1c0: 2020 2020 2020 2020 2865 7874 7261 2920          (extra) 
+0002d1d0: 6974 656d 2069 7320 7468 6520 7570 7065  item is the uppe
+0002d1e0: 7220 626f 756e 6420 6f66 2074 6865 206c  r bound of the l
+0002d1f0: 6173 7420 7061 7274 6974 696f 6e2e 0a0a  ast partition...
+0002d200: 2020 2020 2020 2020 3e3e 3e20 6464 6632          >>> ddf2
+0002d210: 203d 2064 6466 2e73 6574 5f69 6e64 6578   = ddf.set_index
+0002d220: 2822 7469 6d65 7374 616d 7022 2c20 736f  ("timestamp", so
+0002d230: 7274 6564 3d54 7275 652c 2064 6976 6973  rted=True, divis
+0002d240: 696f 6e73 3d64 6976 6973 696f 6e73 2e74  ions=divisions.t
+0002d250: 6f6c 6973 7428 2929 0a0a 2020 2020 2020  olist())..      
+0002d260: 2020 4966 2079 6f75 276c 6c20 6265 2072    If you'll be r
+0002d270: 756e 6e69 6e67 2060 7365 745f 696e 6465  unning `set_inde
+0002d280: 7860 206f 6e20 7468 6520 7361 6d65 2028  x` on the same (
+0002d290: 6f72 2073 696d 696c 6172 2920 6461 7461  or similar) data
+0002d2a0: 7365 7473 2072 6570 6561 7465 646c 792c  sets repeatedly,
+0002d2b0: 0a20 2020 2020 2020 2079 6f75 2063 6f75  .        you cou
+0002d2c0: 6c64 2073 6176 6520 7469 6d65 2062 7920  ld save time by 
+0002d2d0: 6c65 7474 696e 6720 4461 736b 2063 616c  letting Dask cal
+0002d2e0: 6375 6c61 7465 2067 6f6f 6420 6469 7669  culate good divi
+0002d2f0: 7369 6f6e 7320 6f6e 6365 2c20 7468 656e  sions once, then
+0002d300: 2063 6f70 792d 7061 7374 696e 670a 2020   copy-pasting.  
+0002d310: 2020 2020 2020 7468 656d 2074 6f20 7265        them to re
+0002d320: 7573 652e 2054 6869 7320 6973 2065 7370  use. This is esp
+0002d330: 6563 6961 6c6c 7920 6865 6c70 6675 6c20  ecially helpful 
+0002d340: 7275 6e6e 696e 6720 696e 2061 204a 7570  running in a Jup
+0002d350: 7974 6572 206e 6f74 6562 6f6f 6b3a 0a0a  yter notebook:..
+0002d360: 2020 2020 2020 2020 3e3e 3e20 6464 6632          >>> ddf2
+0002d370: 203d 2064 6466 2e73 6574 5f69 6e64 6578   = ddf.set_index
+0002d380: 2822 6e61 6d65 2229 2020 2320 736c 6f77  ("name")  # slow
+0002d390: 2c20 6361 6c63 756c 6174 6573 2064 6174  , calculates dat
+0002d3a0: 6120 6469 7374 7269 6275 7469 6f6e 0a20  a distribution. 
+0002d3b0: 2020 2020 2020 203e 3e3e 2064 6466 322e         >>> ddf2.
+0002d3c0: 6469 7669 7369 6f6e 7320 2023 2064 6f63  divisions  # doc
+0002d3d0: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
+0002d3e0: 2020 2020 5b22 416c 6963 6522 2c20 224c      ["Alice", "L
+0002d3f0: 6175 7261 222c 2022 5572 7375 6c61 222c  aura", "Ursula",
+0002d400: 2022 5a65 6c64 6122 5d0a 2020 2020 2020   "Zelda"].      
+0002d410: 2020 3e3e 3e20 2320 5e20 4e6f 7720 636f    >>> # ^ Now co
+0002d420: 7079 2d70 6173 7465 2074 6869 7320 616e  py-paste this an
+0002d430: 6420 6564 6974 2074 6865 206c 696e 6520  d edit the line 
+0002d440: 6162 6f76 6520 746f 3a0a 2020 2020 2020  above to:.      
+0002d450: 2020 3e3e 3e20 2320 6464 6632 203d 2064    >>> # ddf2 = d
+0002d460: 6466 2e73 6574 5f69 6e64 6578 2822 6e61  df.set_index("na
+0002d470: 6d65 222c 2064 6976 6973 696f 6e73 3d5b  me", divisions=[
+0002d480: 2241 6c69 6365 222c 2022 4c61 7572 6122  "Alice", "Laura"
+0002d490: 2c20 2255 7273 756c 6122 2c20 225a 656c  , "Ursula", "Zel
+0002d4a0: 6461 225d 290a 2020 2020 2020 2020 2222  da"]).        ""
+0002d4b0: 220a 0a20 2020 2020 2020 2069 6620 696e  "..        if in
+0002d4c0: 706c 6163 653a 0a20 2020 2020 2020 2020  place:.         
+0002d4d0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+0002d4e0: 656d 656e 7465 6445 7272 6f72 2822 5468  ementedError("Th
+0002d4f0: 6520 696e 706c 6163 653d 206b 6579 776f  e inplace= keywo
+0002d500: 7264 2069 7320 6e6f 7420 7375 7070 6f72  rd is not suppor
+0002d510: 7465 6422 290a 2020 2020 2020 2020 7072  ted").        pr
+0002d520: 655f 736f 7274 6564 203d 2073 6f72 7465  e_sorted = sorte
+0002d530: 640a 2020 2020 2020 2020 6465 6c20 736f  d.        del so
+0002d540: 7274 6564 0a0a 2020 2020 2020 2020 2320  rted..        # 
+0002d550: 4368 6563 6b20 6f74 6865 7220 6361 6e20  Check other can 
+0002d560: 6265 2074 7261 6e73 6c61 7465 6420 746f  be translated to
+0002d570: 2063 6f6c 756d 6e20 6e61 6d65 206f 7220   column name or 
+0002d580: 636f 6c75 6d6e 206f 626a 6563 742c 2070  column object, p
+0002d590: 6f73 7369 626c 7920 666c 6174 7465 6e69  ossibly flatteni
+0002d5a0: 6e67 2069 740a 2020 2020 2020 2020 6966  ng it.        if
+0002d5b0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0002d5c0: 6f74 6865 722c 2073 7472 293a 0a20 2020  other, str):.   
+0002d5d0: 2020 2020 2020 2020 2023 2049 7420 6d61           # It ma
+0002d5e0: 7920 7265 6665 7220 746f 2073 6576 6572  y refer to sever
+0002d5f0: 616c 2063 6f6c 756d 6e73 0a20 2020 2020  al columns.     
+0002d600: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0002d610: 616e 6365 286f 7468 6572 2c20 5365 7175  ance(other, Sequ
+0002d620: 656e 6365 293a 2020 2320 7479 7065 3a20  ence):  # type: 
+0002d630: 6967 6e6f 7265 5b75 6e72 6561 6368 6162  ignore[unreachab
+0002d640: 6c65 5d0a 2020 2020 2020 2020 2020 2020  le].            
+0002d650: 2020 2020 2320 4163 6365 7074 205b 2261      # Accept ["a
+0002d660: 225d 2c20 6275 7420 6e6f 7420 5b5b 2261  "], but not [["a
+0002d670: 225d 5d0a 2020 2020 2020 2020 2020 2020  "]].            
+0002d680: 2020 2020 6966 206c 656e 286f 7468 6572      if len(other
+0002d690: 2920 3d3d 2031 2061 6e64 2028 2020 2320  ) == 1 and (  # 
+0002d6a0: 7479 7065 3a20 6967 6e6f 7265 5b75 6e72  type: ignore[unr
+0002d6b0: 6561 6368 6162 6c65 5d0a 2020 2020 2020  eachable].      
+0002d6c0: 2020 2020 2020 2020 2020 2020 2020 6973                is
+0002d6d0: 696e 7374 616e 6365 286f 7468 6572 5b30  instance(other[0
+0002d6e0: 5d2c 2073 7472 2920 6f72 206e 6f74 2069  ], str) or not i
+0002d6f0: 7369 6e73 7461 6e63 6528 6f74 6865 725b  sinstance(other[
+0002d700: 305d 2c20 5365 7175 656e 6365 290a 2020  0], Sequence).  
+0002d710: 2020 2020 2020 2020 2020 2020 2020 293a                ):
+0002d720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d730: 2020 2020 206f 7468 6572 203d 206f 7468       other = oth
+0002d740: 6572 5b30 5d0a 2020 2020 2020 2020 2020  er[0].          
+0002d750: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0002d760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d770: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+0002d780: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
+0002d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d7a0: 2020 2022 4461 736b 2064 6174 6166 7261     "Dask datafra
+0002d7b0: 6d65 2064 6f65 7320 6e6f 7420 7965 7420  me does not yet 
+0002d7c0: 7375 7070 6f72 7420 6d75 6c74 692d 696e  support multi-in
+0002d7d0: 6465 7865 732e 5c6e 220a 2020 2020 2020  dexes.\n".      
+0002d7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d7f0: 2020 6622 596f 7520 7472 6965 6420 746f    f"You tried to
+0002d800: 2069 6e64 6578 2077 6974 6820 7468 6973   index with this
+0002d810: 2069 6e64 6578 3a20 7b6f 7468 6572 7d5c   index: {other}\
+0002d820: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
+0002d830: 2020 2020 2020 2020 2020 2022 496e 6465             "Inde
+0002d840: 7865 7320 6d75 7374 2062 6520 7369 6e67  xes must be sing
+0002d850: 6c65 2063 6f6c 756d 6e73 206f 6e6c 792e  le columns only.
+0002d860: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0002d870: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0002d880: 2020 2020 2023 204f 7220 6265 2061 2066       # Or be a f
+0002d890: 7261 6d65 2064 6972 6563 746c 790a 2020  rame directly.  
+0002d8a0: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+0002d8b0: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
+0002d8c0: 2044 6174 6146 7261 6d65 293a 2020 2320   DataFrame):  # 
+0002d8d0: 7479 7065 3a20 6967 6e6f 7265 5b75 6e72  type: ignore[unr
+0002d8e0: 6561 6368 6162 6c65 5d0a 2020 2020 2020  eachable].      
+0002d8f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0002d900: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+0002d910: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0002d920: 2020 2020 2020 2020 2022 4461 736b 2064           "Dask d
+0002d930: 6174 6166 7261 6d65 2064 6f65 7320 6e6f  ataframe does no
+0002d940: 7420 7965 7420 7375 7070 6f72 7420 6d75  t yet support mu
+0002d950: 6c74 692d 696e 6465 7865 732e 5c6e 220a  lti-indexes.\n".
+0002d960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d970: 2020 2020 6622 596f 7520 7472 6965 6420      f"You tried 
+0002d980: 746f 2069 6e64 6578 2077 6974 6820 6120  to index with a 
+0002d990: 6672 616d 6520 7769 7468 2074 6865 7365  frame with these
+0002d9a0: 2063 6f6c 756d 6e73 3a20 7b6c 6973 7428   columns: {list(
+0002d9b0: 6f74 6865 722e 636f 6c75 6d6e 7329 7d5c  other.columns)}\
+0002d9c0: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
+0002d9d0: 2020 2020 2020 2022 496e 6465 7865 7320         "Indexes 
+0002d9e0: 6d75 7374 2062 6520 7369 6e67 6c65 2063  must be single c
+0002d9f0: 6f6c 756d 6e73 206f 6e6c 792e 220a 2020  olumns only.".  
+0002da00: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0002da10: 0a20 2020 2020 2020 2023 2049 6620 616c  .        # If al
+0002da20: 7265 6164 7920 6120 7365 7269 6573 0a20  ready a series. 
+0002da30: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0002da40: 616e 6365 286f 7468 6572 2c20 5365 7269  ance(other, Seri
+0002da50: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+0002da60: 2023 2049 6620 6974 2773 2061 6c72 6561   # If it's alrea
+0002da70: 6479 2074 6865 2069 6e64 6578 2c20 7468  dy the index, th
+0002da80: 6572 6527 7320 6e6f 7468 696e 6720 746f  ere's nothing to
+0002da90: 2064 6f0a 2020 2020 2020 2020 2020 2020   do.            
+0002daa0: 6966 206f 7468 6572 2e5f 6e61 6d65 203d  if other._name =
+0002dab0: 3d20 7365 6c66 2e69 6e64 6578 2e5f 6e61  = self.index._na
+0002dac0: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
+0002dad0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+0002dae0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+0002daf0: 2020 2020 2020 2022 4e65 7720 696e 6465         "New inde
+0002db00: 7820 6861 7320 7361 6d65 206e 616d 6520  x has same name 
+0002db10: 6173 2065 7869 7374 696e 672c 2074 6869  as existing, thi
+0002db20: 7320 6973 2061 206e 6f2d 6f70 2e22 2c20  s is a no-op.", 
+0002db30: 5573 6572 5761 726e 696e 670a 2020 2020  UserWarning.    
+0002db40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0002db50: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0002db60: 7475 726e 2073 656c 660a 0a20 2020 2020  turn self..     
+0002db70: 2020 2023 2049 6620 7468 6520 6e61 6d65     # If the name
+0002db80: 206f 6620 6120 636f 6c75 6d6e 2f69 6e64   of a column/ind
+0002db90: 6578 0a20 2020 2020 2020 2065 6c73 653a  ex.        else:
+0002dba0: 0a20 2020 2020 2020 2020 2020 2023 2057  .            # W
+0002dbb0: 6974 6820 7468 6520 7361 6d65 206e 616d  ith the same nam
+0002dbc0: 6520 6173 2074 6865 2069 6e64 6578 2c20  e as the index, 
+0002dbd0: 7468 6572 6527 7320 6e6f 7468 696e 6720  there's nothing 
+0002dbe0: 746f 2064 6f20 6569 7468 6572 0a20 2020  to do either.   
+0002dbf0: 2020 2020 2020 2020 2069 6620 6f74 6865           if othe
+0002dc00: 7220 3d3d 2073 656c 662e 696e 6465 782e  r == self.index.
+0002dc10: 6e61 6d65 3a0a 2020 2020 2020 2020 2020  name:.          
+0002dc20: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+0002dc30: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
+0002dc40: 2020 2020 2020 2020 2022 4e65 7720 696e           "New in
+0002dc50: 6465 7820 6861 7320 7361 6d65 206e 616d  dex has same nam
+0002dc60: 6520 6173 2065 7869 7374 696e 672c 2074  e as existing, t
+0002dc70: 6869 7320 6973 2061 206e 6f2d 6f70 2e22  his is a no-op."
+0002dc80: 2c20 5573 6572 5761 726e 696e 670a 2020  , UserWarning.  
+0002dc90: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0002dca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dcb0: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
+0002dcc0: 2020 2020 2020 2020 2023 2049 6620 6120           # If a 
+0002dcd0: 6d69 7373 696e 6720 636f 6c75 6d6e 2c20  missing column, 
+0002dce0: 4b65 7945 7272 6f72 0a20 2020 2020 2020  KeyError.       
+0002dcf0: 2020 2020 2069 6620 6f74 6865 7220 6e6f       if other no
+0002dd00: 7420 696e 2073 656c 662e 636f 6c75 6d6e  t in self.column
+0002dd10: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+0002dd20: 2020 2072 6169 7365 204b 6579 4572 726f     raise KeyErro
+0002dd30: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0002dd40: 2020 2020 2020 2066 2244 6174 6120 6861         f"Data ha
+0002dd50: 7320 6e6f 2063 6f6c 756d 6e20 277b 6f74  s no column '{ot
+0002dd60: 6865 727d 273a 2075 7365 2061 6e79 2063  her}': use any c
+0002dd70: 6f6c 756d 6e20 6f66 207b 6c69 7374 2873  olumn of {list(s
+0002dd80: 656c 662e 636f 6c75 6d6e 7329 7d22 0a20  elf.columns)}". 
+0002dd90: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002dda0: 0a0a 2020 2020 2020 2020 2320 4368 6563  ..        # Chec
+0002ddb0: 6b20 6469 7669 7369 6f6e 730a 2020 2020  k divisions.    
+0002ddc0: 2020 2020 6966 2064 6976 6973 696f 6e73      if divisions
+0002ddd0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0002dde0: 2020 2020 2020 2020 2020 6368 6563 6b5f            check_
+0002ddf0: 6469 7669 7369 6f6e 7328 6469 7669 7369  divisions(divisi
+0002de00: 6f6e 7329 0a20 2020 2020 2020 2065 6c69  ons).        eli
+0002de10: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+0002de20: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
+0002de30: 2c20 496e 6465 7829 0a20 2020 2020 2020  , Index).       
+0002de40: 2020 2020 2061 6e64 206f 7468 6572 2e6b       and other.k
+0002de50: 6e6f 776e 5f64 6976 6973 696f 6e73 0a20  nown_divisions. 
+0002de60: 2020 2020 2020 2020 2020 2061 6e64 206f             and o
+0002de70: 7468 6572 2e6e 7061 7274 6974 696f 6e73  ther.npartitions
+0002de80: 203d 3d20 7365 6c66 2e6e 7061 7274 6974   == self.npartit
+0002de90: 696f 6e73 0a20 2020 2020 2020 2029 3a0a  ions.        ):.
+0002dea0: 2020 2020 2020 2020 2020 2020 2320 4966              # If
+0002deb0: 2074 6865 2069 6e64 6578 2068 6173 2074   the index has t
+0002dec0: 6865 2073 616d 6520 6e75 6d62 6572 206f  he same number o
+0002ded0: 6620 7061 7274 6974 696f 6e73 2061 6e64  f partitions and
+0002dee0: 206b 6e6f 776e 0a20 2020 2020 2020 2020   known.         
+0002def0: 2020 2023 2064 6976 6973 696f 6e73 2c20     # divisions, 
+0002df00: 7468 656e 2077 6520 6361 6e20 7472 6561  then we can trea
+0002df10: 7420 6974 2061 7320 7072 652d 736f 7274  t it as pre-sort
+0002df20: 6564 2077 6974 6820 6b6e 6f77 6e0a 2020  ed with known.  
+0002df30: 2020 2020 2020 2020 2020 2320 6469 7669            # divi
+0002df40: 7369 6f6e 730a 2020 2020 2020 2020 2020  sions.          
+0002df50: 2020 7072 655f 736f 7274 6564 203d 2054    pre_sorted = T
+0002df60: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0002df70: 6469 7669 7369 6f6e 7320 3d20 6f74 6865  divisions = othe
+0002df80: 722e 6469 7669 7369 6f6e 730a 0a20 2020  r.divisions..   
+0002df90: 2020 2020 2023 2049 6620 696e 6465 7820       # If index 
+0002dfa0: 6973 2061 6c72 6561 6479 2073 6f72 7465  is already sorte
+0002dfb0: 642c 2074 616b 6520 6164 7661 6e74 6167  d, take advantag
+0002dfc0: 6520 6f66 2074 6861 7420 7769 7468 2073  e of that with s
+0002dfd0: 6574 5f73 6f72 7465 645f 696e 6465 780a  et_sorted_index.
+0002dfe0: 2020 2020 2020 2020 6966 2070 7265 5f73          if pre_s
+0002dff0: 6f72 7465 643a 0a20 2020 2020 2020 2020  orted:.         
+0002e000: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
+0002e010: 6166 7261 6d65 2e73 6875 6666 6c65 2069  aframe.shuffle i
+0002e020: 6d70 6f72 7420 7365 745f 736f 7274 6564  mport set_sorted
+0002e030: 5f69 6e64 6578 0a0a 2020 2020 2020 2020  _index..        
+0002e040: 2020 2020 7265 7475 726e 2073 6574 5f73      return set_s
+0002e050: 6f72 7465 645f 696e 6465 7828 0a20 2020  orted_index(.   
+0002e060: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0002e070: 662c 206f 7468 6572 2c20 6472 6f70 3d64  f, other, drop=d
+0002e080: 726f 702c 2064 6976 6973 696f 6e73 3d64  rop, divisions=d
+0002e090: 6976 6973 696f 6e73 2c20 2a2a 6b77 6172  ivisions, **kwar
+0002e0a0: 6773 0a20 2020 2020 2020 2020 2020 2029  gs.            )
+0002e0b0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0002e0c0: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
+0002e0d0: 6461 736b 2e64 6174 6166 7261 6d65 2e73  dask.dataframe.s
+0002e0e0: 6875 6666 6c65 2069 6d70 6f72 7420 7365  huffle import se
+0002e0f0: 745f 696e 6465 780a 0a20 2020 2020 2020  t_index..       
+0002e100: 2020 2020 2072 6574 7572 6e20 7365 745f       return set_
+0002e110: 696e 6465 7828 0a20 2020 2020 2020 2020  index(.         
+0002e120: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0002e130: 2020 2020 2020 2020 2020 2020 206f 7468               oth
+0002e140: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+0002e150: 2020 2020 6472 6f70 3d64 726f 702c 0a20      drop=drop,. 
+0002e160: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0002e170: 7061 7274 6974 696f 6e73 3d6e 7061 7274  partitions=npart
+0002e180: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
+0002e190: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+0002e1a0: 733d 6469 7669 7369 6f6e 732c 0a20 2020  s=divisions,.   
+0002e1b0: 2020 2020 2020 2020 2020 2020 202a 2a6b               **k
+0002e1c0: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
+0002e1d0: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
+0002e1e0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+0002e1f0: 7261 6d65 290a 2020 2020 6465 6620 706f  rame).    def po
+0002e200: 7028 7365 6c66 2c20 6974 656d 293a 0a20  p(self, item):. 
+0002e210: 2020 2020 2020 206f 7574 203d 2073 656c         out = sel
+0002e220: 665b 6974 656d 5d0a 2020 2020 2020 2020  f[item].        
+0002e230: 6465 6c20 7365 6c66 5b69 7465 6d5d 0a20  del self[item]. 
+0002e240: 2020 2020 2020 2072 6574 7572 6e20 6f75         return ou
+0002e250: 740a 0a20 2020 2040 6465 7269 7665 645f  t..    @derived_
+0002e260: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0002e270: 6529 0a20 2020 2064 6566 206e 6c61 7267  e).    def nlarg
+0002e280: 6573 7428 7365 6c66 2c20 6e3d 352c 2063  est(self, n=5, c
+0002e290: 6f6c 756d 6e73 3d4e 6f6e 652c 2073 706c  olumns=None, spl
+0002e2a0: 6974 5f65 7665 7279 3d4e 6f6e 6529 3a0a  it_every=None):.
+0002e2b0: 2020 2020 2020 2020 746f 6b65 6e20 3d20          token = 
+0002e2c0: 2264 6174 6166 7261 6d65 2d6e 6c61 7267  "dataframe-nlarg
+0002e2d0: 6573 7422 0a20 2020 2020 2020 2072 6574  est".        ret
+0002e2e0: 7572 6e20 6163 6128 0a20 2020 2020 2020  urn aca(.       
+0002e2f0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0002e300: 2020 2020 2020 2063 6875 6e6b 3d4d 2e6e         chunk=M.n
+0002e310: 6c61 7267 6573 742c 0a20 2020 2020 2020  largest,.       
+0002e320: 2020 2020 2061 6767 7265 6761 7465 3d4d       aggregate=M
+0002e330: 2e6e 6c61 7267 6573 742c 0a20 2020 2020  .nlargest,.     
+0002e340: 2020 2020 2020 206d 6574 613d 7365 6c66         meta=self
+0002e350: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
+0002e360: 2020 2020 746f 6b65 6e3d 746f 6b65 6e2c      token=token,
+0002e370: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+0002e380: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+0002e390: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
+0002e3a0: 2020 6e3d 6e2c 0a20 2020 2020 2020 2020    n=n,.         
+0002e3b0: 2020 2063 6f6c 756d 6e73 3d63 6f6c 756d     columns=colum
+0002e3c0: 6e73 2c0a 2020 2020 2020 2020 290a 0a20  ns,.        ).. 
+0002e3d0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0002e3e0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0002e3f0: 2020 2064 6566 206e 736d 616c 6c65 7374     def nsmallest
+0002e400: 2873 656c 662c 206e 3d35 2c20 636f 6c75  (self, n=5, colu
+0002e410: 6d6e 733d 4e6f 6e65 2c20 7370 6c69 745f  mns=None, split_
+0002e420: 6576 6572 793d 4e6f 6e65 293a 0a20 2020  every=None):.   
+0002e430: 2020 2020 2074 6f6b 656e 203d 2022 6461       token = "da
+0002e440: 7461 6672 616d 652d 6e73 6d61 6c6c 6573  taframe-nsmalles
+0002e450: 7422 0a20 2020 2020 2020 2072 6574 7572  t".        retur
+0002e460: 6e20 6163 6128 0a20 2020 2020 2020 2020  n aca(.         
+0002e470: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0002e480: 2020 2020 2063 6875 6e6b 3d4d 2e6e 736d       chunk=M.nsm
+0002e490: 616c 6c65 7374 2c0a 2020 2020 2020 2020  allest,.        
+0002e4a0: 2020 2020 6167 6772 6567 6174 653d 4d2e      aggregate=M.
+0002e4b0: 6e73 6d61 6c6c 6573 742c 0a20 2020 2020  nsmallest,.     
+0002e4c0: 2020 2020 2020 206d 6574 613d 7365 6c66         meta=self
+0002e4d0: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
+0002e4e0: 2020 2020 746f 6b65 6e3d 746f 6b65 6e2c      token=token,
+0002e4f0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+0002e500: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+0002e510: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
+0002e520: 2020 6e3d 6e2c 0a20 2020 2020 2020 2020    n=n,.         
+0002e530: 2020 2063 6f6c 756d 6e73 3d63 6f6c 756d     columns=colum
+0002e540: 6e73 2c0a 2020 2020 2020 2020 290a 0a20  ns,.        ).. 
+0002e550: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0002e560: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0002e570: 2020 2064 6566 2067 726f 7570 6279 280a     def groupby(.
+0002e580: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0002e590: 2020 2020 2020 6279 3d4e 6f6e 652c 0a20        by=None,. 
+0002e5a0: 2020 2020 2020 2067 726f 7570 5f6b 6579         group_key
+0002e5b0: 733d 4752 4f55 505f 4b45 5953 5f44 4546  s=GROUP_KEYS_DEF
+0002e5c0: 4155 4c54 2c0a 2020 2020 2020 2020 736f  AULT,.        so
+0002e5d0: 7274 3d4e 6f6e 652c 0a20 2020 2020 2020  rt=None,.       
+0002e5e0: 206f 6273 6572 7665 643d 4e6f 6e65 2c0a   observed=None,.
+0002e5f0: 2020 2020 2020 2020 6472 6f70 6e61 3d4e          dropna=N
+0002e600: 6f6e 652c 0a20 2020 2020 2020 202a 2a6b  one,.        **k
+0002e610: 7761 7267 732c 0a20 2020 2029 3a0a 2020  wargs,.    ):.  
+0002e620: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+0002e630: 6461 7461 6672 616d 652e 6772 6f75 7062  dataframe.groupb
+0002e640: 7920 696d 706f 7274 2044 6174 6146 7261  y import DataFra
+0002e650: 6d65 4772 6f75 7042 790a 0a20 2020 2020  meGroupBy..     
+0002e660: 2020 2072 6574 7572 6e20 4461 7461 4672     return DataFr
+0002e670: 616d 6547 726f 7570 4279 280a 2020 2020  ameGroupBy(.    
+0002e680: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0002e690: 2020 2020 2020 2020 2020 6279 3d62 792c            by=by,
+0002e6a0: 0a20 2020 2020 2020 2020 2020 2067 726f  .            gro
+0002e6b0: 7570 5f6b 6579 733d 6772 6f75 705f 6b65  up_keys=group_ke
+0002e6c0: 7973 2c0a 2020 2020 2020 2020 2020 2020  ys,.            
+0002e6d0: 736f 7274 3d73 6f72 742c 0a20 2020 2020  sort=sort,.     
+0002e6e0: 2020 2020 2020 206f 6273 6572 7665 643d         observed=
+0002e6f0: 6f62 7365 7276 6564 2c0a 2020 2020 2020  observed,.      
+0002e700: 2020 2020 2020 6472 6f70 6e61 3d64 726f        dropna=dro
+0002e710: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
+0002e720: 202a 2a6b 7761 7267 732c 0a20 2020 2020   **kwargs,.     
+0002e730: 2020 2029 0a0a 2020 2020 4077 7261 7073     )..    @wraps
+0002e740: 2863 6174 6567 6f72 697a 6529 0a20 2020  (categorize).   
+0002e750: 2064 6566 2063 6174 6567 6f72 697a 6528   def categorize(
+0002e760: 7365 6c66 2c20 636f 6c75 6d6e 733d 4e6f  self, columns=No
+0002e770: 6e65 2c20 696e 6465 783d 4e6f 6e65 2c20  ne, index=None, 
+0002e780: 7370 6c69 745f 6576 6572 793d 4e6f 6e65  split_every=None
+0002e790: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+0002e7a0: 2020 2020 2072 6574 7572 6e20 6361 7465       return cate
+0002e7b0: 676f 7269 7a65 280a 2020 2020 2020 2020  gorize(.        
+0002e7c0: 2020 2020 7365 6c66 2c20 636f 6c75 6d6e      self, column
+0002e7d0: 733d 636f 6c75 6d6e 732c 2069 6e64 6578  s=columns, index
+0002e7e0: 3d69 6e64 6578 2c20 7370 6c69 745f 6576  =index, split_ev
+0002e7f0: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
+0002e800: 202a 2a6b 7761 7267 730a 2020 2020 2020   **kwargs.      
+0002e810: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
+0002e820: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0002e830: 616d 6529 0a20 2020 2064 6566 2061 7373  ame).    def ass
+0002e840: 6967 6e28 7365 6c66 2c20 2a2a 6b77 6172  ign(self, **kwar
+0002e850: 6773 293a 0a20 2020 2020 2020 2064 6174  gs):.        dat
+0002e860: 6120 3d20 7365 6c66 2e63 6f70 7928 290a  a = self.copy().
+0002e870: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
+0002e880: 2069 6e20 6b77 6172 6773 2e69 7465 6d73   in kwargs.items
+0002e890: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0002e8a0: 6966 206e 6f74 2028 0a20 2020 2020 2020  if not (.       
+0002e8b0: 2020 2020 2020 2020 2069 7369 6e73 7461           isinsta
+0002e8c0: 6e63 6528 762c 2053 6361 6c61 7229 0a20  nce(v, Scalar). 
+0002e8d0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0002e8e0: 7220 6973 5f73 6572 6965 735f 6c69 6b65  r is_series_like
+0002e8f0: 2876 290a 2020 2020 2020 2020 2020 2020  (v).            
+0002e900: 2020 2020 6f72 2063 616c 6c61 626c 6528      or callable(
+0002e910: 7629 0a20 2020 2020 2020 2020 2020 2020  v).             
+0002e920: 2020 206f 7220 7064 2e61 7069 2e74 7970     or pd.api.typ
+0002e930: 6573 2e69 735f 7363 616c 6172 2876 290a  es.is_scalar(v).
+0002e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e950: 6f72 2069 735f 696e 6465 785f 6c69 6b65  or is_index_like
+0002e960: 2876 290a 2020 2020 2020 2020 2020 2020  (v).            
+0002e970: 2020 2020 6f72 2069 7369 6e73 7461 6e63      or isinstanc
+0002e980: 6528 762c 2041 7272 6179 290a 2020 2020  e(v, Array).    
+0002e990: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+0002e9a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002e9b0: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
+0002e9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e9d0: 6622 436f 6c75 6d6e 2061 7373 6967 6e6d  f"Column assignm
+0002e9e0: 656e 7420 646f 6573 6e27 7420 7375 7070  ent doesn't supp
+0002e9f0: 6f72 7420 7479 7065 207b 7479 7065 6e61  ort type {typena
+0002ea00: 6d65 2874 7970 6528 7629 297d 220a 2020  me(type(v))}".  
+0002ea10: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0002ea20: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+0002ea30: 616c 6c61 626c 6528 7629 3a0a 2020 2020  allable(v):.    
+0002ea40: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
+0002ea50: 6773 5b6b 5d20 3d20 7628 6461 7461 290a  gs[k] = v(data).
+0002ea60: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0002ea70: 7369 6e73 7461 6e63 6528 762c 2041 7272  sinstance(v, Arr
+0002ea80: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
+0002ea90: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
+0002eaa0: 6174 6166 7261 6d65 2e69 6f20 696d 706f  ataframe.io impo
+0002eab0: 7274 2066 726f 6d5f 6461 736b 5f61 7272  rt from_dask_arr
+0002eac0: 6179 0a0a 2020 2020 2020 2020 2020 2020  ay..            
+0002ead0: 2020 2020 6966 206c 656e 2876 2e73 6861      if len(v.sha
+0002eae0: 7065 2920 3e20 313a 0a20 2020 2020 2020  pe) > 1:.       
+0002eaf0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0002eb00: 7365 2056 616c 7565 4572 726f 7228 2241  se ValueError("A
+0002eb10: 7272 6179 2061 7373 6967 6e6d 656e 7420  rray assignment 
+0002eb20: 6f6e 6c79 2073 7570 706f 7274 7320 312d  only supports 1-
+0002eb30: 4420 6172 7261 7973 2229 0a20 2020 2020  D arrays").     
+0002eb40: 2020 2020 2020 2020 2020 2069 6620 762e             if v.
+0002eb50: 6e70 6172 7469 7469 6f6e 7320 213d 2064  npartitions != d
+0002eb60: 6174 612e 6e70 6172 7469 7469 6f6e 733a  ata.npartitions:
+0002eb70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002eb80: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0002eb90: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0002eba0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002ebb0: 4e75 6d62 6572 206f 6620 7061 7274 6974  Number of partit
+0002ebc0: 696f 6e73 2064 6f20 6e6f 7420 6d61 7463  ions do not matc
+0002ebd0: 6820 220a 2020 2020 2020 2020 2020 2020  h ".            
+0002ebe0: 2020 2020 2020 2020 2020 2020 6622 287b              f"({
+0002ebf0: 762e 6e70 6172 7469 7469 6f6e 737d 2021  v.npartitions} !
+0002ec00: 3d20 7b64 6174 612e 6e70 6172 7469 7469  = {data.npartiti
+0002ec10: 6f6e 737d 2922 0a20 2020 2020 2020 2020  ons})".         
+0002ec20: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0002ec30: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
+0002ec40: 7267 735b 6b5d 203d 2066 726f 6d5f 6461  rgs[k] = from_da
+0002ec50: 736b 5f61 7272 6179 2876 2c20 696e 6465  sk_array(v, inde
+0002ec60: 783d 6461 7461 2e69 6e64 6578 2c20 6d65  x=data.index, me
+0002ec70: 7461 3d64 6174 612e 5f6d 6574 6129 0a0a  ta=data._meta)..
+0002ec80: 2020 2020 2020 2020 2020 2020 7061 6972              pair
+0002ec90: 7320 3d20 5b6b 2c20 6b77 6172 6773 5b6b  s = [k, kwargs[k
+0002eca0: 5d5d 0a0a 2020 2020 2020 2020 2020 2020  ]]..            
+0002ecb0: 2320 4669 6775 7265 206f 7574 2063 6f6c  # Figure out col
+0002ecc0: 756d 6e73 206f 6620 7468 6520 6f75 7470  umns of the outp
+0002ecd0: 7574 0a20 2020 2020 2020 2020 2020 2064  ut.            d
+0002ece0: 6632 203d 2064 6174 612e 5f6d 6574 615f  f2 = data._meta_
+0002ecf0: 6e6f 6e65 6d70 7479 2e61 7373 6967 6e28  nonempty.assign(
+0002ed00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ed10: 202a 2a5f 6578 7472 6163 745f 6d65 7461   **_extract_meta
+0002ed20: 287b 6b3a 206b 7761 7267 735b 6b5d 7d2c  ({k: kwargs[k]},
+0002ed30: 206e 6f6e 656d 7074 793d 5472 7565 290a   nonempty=True).
+0002ed40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0002ed50: 2020 2020 2020 2020 2020 6461 7461 203d            data =
+0002ed60: 2065 6c65 6d77 6973 6528 6d65 7468 6f64   elemwise(method
+0002ed70: 732e 6173 7369 676e 2c20 6461 7461 2c20  s.assign, data, 
+0002ed80: 2a70 6169 7273 2c20 6d65 7461 3d64 6632  *pairs, meta=df2
+0002ed90: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0002eda0: 6e20 6461 7461 0a0a 2020 2020 4064 6572  n data..    @der
+0002edb0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+0002edc0: 6146 7261 6d65 2c20 7561 5f61 7267 733d  aFrame, ua_args=
+0002edd0: 5b22 696e 6465 7822 5d29 0a20 2020 2064  ["index"]).    d
+0002ede0: 6566 2072 656e 616d 6528 7365 6c66 2c20  ef rename(self, 
+0002edf0: 696e 6465 783d 4e6f 6e65 2c20 636f 6c75  index=None, colu
+0002ee00: 6d6e 733d 4e6f 6e65 293a 0a20 2020 2020  mns=None):.     
+0002ee10: 2020 2069 6620 696e 6465 7820 6973 206e     if index is n
+0002ee20: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0002ee30: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0002ee40: 4572 726f 7228 2243 616e 6e6f 7420 7265  Error("Cannot re
+0002ee50: 6e61 6d65 2069 6e64 6578 2e22 290a 0a20  name index.").. 
+0002ee60: 2020 2020 2020 2023 202a 6172 6773 2068         # *args h
+0002ee70: 6572 6520 6973 2069 6e64 6578 2c20 636f  ere is index, co
+0002ee80: 6c75 6d6e 7320 6275 7420 636f 6c75 6d6e  lumns but column
+0002ee90: 7320 6172 6720 6973 2061 6c72 6561 6479  s arg is already
+0002eea0: 2075 7365 640a 2020 2020 2020 2020 7265   used.        re
+0002eeb0: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+0002eec0: 7274 6974 696f 6e73 284d 2e72 656e 616d  rtitions(M.renam
+0002eed0: 652c 204e 6f6e 652c 2063 6f6c 756d 6e73  e, None, columns
+0002eee0: 3d63 6f6c 756d 6e73 290a 0a20 2020 2064  =columns)..    d
+0002eef0: 6566 2071 7565 7279 2873 656c 662c 2065  ef query(self, e
+0002ef00: 7870 722c 202a 2a6b 7761 7267 7329 3a0a  xpr, **kwargs):.
+0002ef10: 2020 2020 2020 2020 2222 2246 696c 7465          """Filte
+0002ef20: 7220 6461 7461 6672 616d 6520 7769 7468  r dataframe with
+0002ef30: 2063 6f6d 706c 6578 2065 7870 7265 7373   complex express
+0002ef40: 696f 6e0a 0a20 2020 2020 2020 2042 6c6f  ion..        Blo
+0002ef50: 636b 6564 2076 6572 7369 6f6e 206f 6620  cked version of 
+0002ef60: 7064 2e44 6174 6146 7261 6d65 2e71 7565  pd.DataFrame.que
+0002ef70: 7279 0a0a 2020 2020 2020 2020 5061 7261  ry..        Para
+0002ef80: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0002ef90: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0002efa0: 2020 6578 7072 3a20 7374 720a 2020 2020    expr: str.    
+0002efb0: 2020 2020 2020 2020 5468 6520 7175 6572          The quer
+0002efc0: 7920 7374 7269 6e67 2074 6f20 6576 616c  y string to eval
+0002efd0: 7561 7465 2e0a 2020 2020 2020 2020 2020  uate..          
+0002efe0: 2020 596f 7520 6361 6e20 7265 6665 7220    You can refer 
+0002eff0: 746f 2063 6f6c 756d 6e20 6e61 6d65 7320  to column names 
+0002f000: 7468 6174 2061 7265 206e 6f74 2076 616c  that are not val
+0002f010: 6964 2050 7974 686f 6e20 7661 7269 6162  id Python variab
+0002f020: 6c65 206e 616d 6573 0a20 2020 2020 2020  le names.       
+0002f030: 2020 2020 2062 7920 7375 7272 6f75 6e64       by surround
+0002f040: 696e 6720 7468 656d 2069 6e20 6261 636b  ing them in back
+0002f050: 7469 636b 732e 0a20 2020 2020 2020 2020  ticks..         
+0002f060: 2020 2044 6173 6b20 646f 6573 206e 6f74     Dask does not
+0002f070: 2066 756c 6c79 2073 7570 706f 7274 2072   fully support r
+0002f080: 6566 6572 7269 6e67 2074 6f20 7661 7269  eferring to vari
+0002f090: 6162 6c65 7320 7573 696e 6720 7468 6520  ables using the 
+0002f0a0: 2740 2720 6368 6172 6163 7465 722c 0a20  '@' character,. 
+0002f0b0: 2020 2020 2020 2020 2020 2075 7365 2066             use f
+0002f0c0: 2d73 7472 696e 6773 206f 7220 7468 6520  -strings or the 
+0002f0d0: 6060 6c6f 6361 6c5f 6469 6374 6060 206b  ``local_dict`` k
+0002f0e0: 6579 776f 7264 2061 7267 756d 656e 7420  eyword argument 
+0002f0f0: 696e 7374 6561 642e 0a0a 2020 2020 2020  instead...      
+0002f100: 2020 4e6f 7465 730a 2020 2020 2020 2020    Notes.        
+0002f110: 2d2d 2d2d 2d0a 2020 2020 2020 2020 5468  -----.        Th
+0002f120: 6973 2069 7320 6c69 6b65 2074 6865 2073  is is like the s
+0002f130: 6571 7565 6e74 6961 6c20 7665 7273 696f  equential versio
+0002f140: 6e20 6578 6365 7074 2074 6861 7420 7468  n except that th
+0002f150: 6973 2077 696c 6c20 616c 736f 2068 6170  is will also hap
+0002f160: 7065 6e0a 2020 2020 2020 2020 696e 206d  pen.        in m
+0002f170: 616e 7920 7468 7265 6164 732e 2020 5468  any threads.  Th
+0002f180: 6973 206d 6179 2063 6f6e 666c 6963 7420  is may conflict 
+0002f190: 7769 7468 2060 606e 756d 6578 7072 6060  with ``numexpr``
+0002f1a0: 2077 6869 6368 2077 696c 6c20 7573 650a   which will use.
+0002f1b0: 2020 2020 2020 2020 6d75 6c74 6970 6c65          multiple
+0002f1c0: 2074 6872 6561 6473 2069 7473 656c 662e   threads itself.
+0002f1d0: 2020 5765 2072 6563 6f6d 6d65 6e64 2074    We recommend t
+0002f1e0: 6861 7420 796f 7520 7365 7420 6060 6e75  hat you set ``nu
+0002f1f0: 6d65 7870 7260 6020 746f 2075 7365 2061  mexpr`` to use a
+0002f200: 0a20 2020 2020 2020 2073 696e 676c 6520  .        single 
+0002f210: 7468 7265 6164 3a0a 0a20 2020 2020 2020  thread:..       
+0002f220: 202e 2e20 636f 6465 2d62 6c6f 636b 3a3a   .. code-block::
+0002f230: 2070 7974 686f 6e0a 0a20 2020 2020 2020   python..       
+0002f240: 2020 2020 2069 6d70 6f72 7420 6e75 6d65       import nume
+0002f250: 7870 720a 2020 2020 2020 2020 2020 2020  xpr.            
+0002f260: 6e75 6d65 7870 722e 7365 745f 6e75 6d5f  numexpr.set_num_
+0002f270: 7468 7265 6164 7328 3129 0a0a 2020 2020  threads(1)..    
+0002f280: 2020 2020 5365 6520 616c 736f 0a20 2020      See also.   
+0002f290: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+0002f2a0: 2020 2020 2020 7061 6e64 6173 2e44 6174        pandas.Dat
+0002f2b0: 6146 7261 6d65 2e71 7565 7279 0a20 2020  aFrame.query.   
+0002f2c0: 2020 2020 2070 616e 6461 732e 6576 616c       pandas.eval
+0002f2d0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+0002f2e0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+0002f2f0: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
+0002f300: 696d 706f 7274 2070 616e 6461 7320 6173  import pandas as
+0002f310: 2070 640a 2020 2020 2020 2020 3e3e 3e20   pd.        >>> 
+0002f320: 696d 706f 7274 2064 6173 6b2e 6461 7461  import dask.data
+0002f330: 6672 616d 6520 6173 2064 640a 2020 2020  frame as dd.    
+0002f340: 2020 2020 3e3e 3e20 6466 203d 2070 642e      >>> df = pd.
+0002f350: 4461 7461 4672 616d 6528 7b27 7827 3a20  DataFrame({'x': 
+0002f360: 5b31 2c20 322c 2031 2c20 325d 2c0a 2020  [1, 2, 1, 2],.  
+0002f370: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0002f380: 2020 2020 2020 2020 2020 2020 2027 7927               'y'
+0002f390: 3a20 5b31 2c20 322c 2033 2c20 345d 2c0a  : [1, 2, 3, 4],.
+0002f3a0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0002f3b0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+0002f3c0: 7a20 7a27 3a20 5b34 2c20 332c 2032 2c20  z z': [4, 3, 2, 
+0002f3d0: 315d 7d29 0a20 2020 2020 2020 203e 3e3e  1]}).        >>>
+0002f3e0: 2064 6466 203d 2064 642e 6672 6f6d 5f70   ddf = dd.from_p
+0002f3f0: 616e 6461 7328 6466 2c20 6e70 6172 7469  andas(df, nparti
+0002f400: 7469 6f6e 733d 3229 0a0a 2020 2020 2020  tions=2)..      
+0002f410: 2020 5265 6665 7220 746f 2063 6f6c 756d    Refer to colum
+0002f420: 6e20 6e61 6d65 7320 6469 7265 6374 6c79  n names directly
+0002f430: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+0002f440: 6466 2e71 7565 7279 2827 7920 3e20 7827  df.query('y > x'
+0002f450: 292e 636f 6d70 7574 6528 290a 2020 2020  ).compute().    
+0002f460: 2020 2020 2020 2078 2020 7920 207a 207a         x  y  z z
+0002f470: 0a20 2020 2020 2020 2032 2020 3120 2033  .        2  1  3
+0002f480: 2020 2020 320a 2020 2020 2020 2020 3320      2.        3 
+0002f490: 2032 2020 3420 2020 2031 0a0a 2020 2020   2  4    1..    
+0002f4a0: 2020 2020 5265 6665 7220 746f 2063 6f6c      Refer to col
+0002f4b0: 756d 6e20 6e61 6d65 2075 7369 6e67 2062  umn name using b
+0002f4c0: 6163 6b74 6963 6b73 3a0a 0a20 2020 2020  ackticks:..     
+0002f4d0: 2020 203e 3e3e 2064 6466 2e71 7565 7279     >>> ddf.query
+0002f4e0: 2827 607a 207a 6020 3e20 7827 292e 636f  ('`z z` > x').co
+0002f4f0: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
+0002f500: 2020 2078 2020 7920 207a 207a 0a20 2020     x  y  z z.   
+0002f510: 2020 2020 2030 2020 3120 2031 2020 2020       0  1  1    
+0002f520: 340a 2020 2020 2020 2020 3120 2032 2020  4.        1  2  
+0002f530: 3220 2020 2033 0a20 2020 2020 2020 2032  2    3.        2
+0002f540: 2020 3120 2033 2020 2020 320a 0a20 2020    1  3    2..   
+0002f550: 2020 2020 2052 6566 6572 2074 6f20 7661       Refer to va
+0002f560: 7269 6162 6c65 206e 616d 6520 7573 696e  riable name usin
+0002f570: 6720 662d 7374 7269 6e67 733a 0a0a 2020  g f-strings:..  
+0002f580: 2020 2020 2020 3e3e 3e20 7661 6c75 6520        >>> value 
+0002f590: 3d20 310a 2020 2020 2020 2020 3e3e 3e20  = 1.        >>> 
+0002f5a0: 6464 662e 7175 6572 7928 6627 7820 3d3d  ddf.query(f'x ==
+0002f5b0: 207b 7661 6c75 657d 2729 2e63 6f6d 7075   {value}').compu
+0002f5c0: 7465 2829 0a20 2020 2020 2020 2020 2020  te().           
+0002f5d0: 7820 2079 2020 7a20 7a0a 2020 2020 2020  x  y  z z.      
+0002f5e0: 2020 3020 2031 2020 3120 2020 2034 0a20    0  1  1    4. 
+0002f5f0: 2020 2020 2020 2032 2020 3120 2033 2020         2  1  3  
+0002f600: 2020 320a 0a20 2020 2020 2020 2052 6566    2..        Ref
+0002f610: 6572 2074 6f20 7661 7269 6162 6c65 206e  er to variable n
+0002f620: 616d 6520 7573 696e 6720 6060 6c6f 6361  ame using ``loca
+0002f630: 6c5f 6469 6374 6060 3a0a 0a20 2020 2020  l_dict``:..     
+0002f640: 2020 203e 3e3e 2064 6466 2e71 7565 7279     >>> ddf.query
+0002f650: 2827 7820 3d3d 2040 7661 6c75 6527 2c20  ('x == @value', 
+0002f660: 6c6f 6361 6c5f 6469 6374 3d7b 2276 616c  local_dict={"val
+0002f670: 7565 223a 2076 616c 7565 7d29 2e63 6f6d  ue": value}).com
+0002f680: 7075 7465 2829 0a20 2020 2020 2020 2020  pute().         
+0002f690: 2020 7820 2079 2020 7a20 7a0a 2020 2020    x  y  z z.    
+0002f6a0: 2020 2020 3020 2031 2020 3120 2020 2034      0  1  1    4
+0002f6b0: 0a20 2020 2020 2020 2032 2020 3120 2033  .        2  1  3
+0002f6c0: 2020 2020 320a 2020 2020 2020 2020 2222      2.        ""
+0002f6d0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0002f6e0: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+0002f6f0: 696f 6e73 284d 2e71 7565 7279 2c20 6578  ions(M.query, ex
+0002f700: 7072 2c20 2a2a 6b77 6172 6773 290a 0a20  pr, **kwargs).. 
+0002f710: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0002f720: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0002f730: 2020 2064 6566 2065 7661 6c28 7365 6c66     def eval(self
+0002f740: 2c20 6578 7072 2c20 696e 706c 6163 653d  , expr, inplace=
+0002f750: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 293a  None, **kwargs):
+0002f760: 0a20 2020 2020 2020 2069 6620 696e 706c  .        if inpl
+0002f770: 6163 6520 6973 204e 6f6e 653a 0a20 2020  ace is None:.   
+0002f780: 2020 2020 2020 2020 2069 6e70 6c61 6365           inplace
+0002f790: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+0002f7a0: 2069 6620 223d 2220 696e 2065 7870 7220   if "=" in expr 
+0002f7b0: 616e 6420 696e 706c 6163 6520 696e 2028  and inplace in (
+0002f7c0: 5472 7565 2c20 4e6f 6e65 293a 0a20 2020  True, None):.   
+0002f7d0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+0002f7e0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0002f7f0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0002f800: 2020 2020 2249 6e70 6c61 6365 2065 7661      "Inplace eva
+0002f810: 6c20 6e6f 7420 7375 7070 6f72 7465 642e  l not supported.
+0002f820: 2050 6c65 6173 6520 7573 6520 696e 706c   Please use inpl
+0002f830: 6163 653d 4661 6c73 6522 0a20 2020 2020  ace=False".     
+0002f840: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0002f850: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+0002f860: 7461 2e65 7661 6c28 6578 7072 2c20 696e  ta.eval(expr, in
+0002f870: 706c 6163 653d 696e 706c 6163 652c 202a  place=inplace, *
+0002f880: 2a6b 7761 7267 7329 0a20 2020 2020 2020  *kwargs).       
+0002f890: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+0002f8a0: 5f70 6172 7469 7469 6f6e 7328 4d2e 6576  _partitions(M.ev
+0002f8b0: 616c 2c20 6578 7072 2c20 6d65 7461 3d6d  al, expr, meta=m
+0002f8c0: 6574 612c 2069 6e70 6c61 6365 3d69 6e70  eta, inplace=inp
+0002f8d0: 6c61 6365 2c20 2a2a 6b77 6172 6773 290a  lace, **kwargs).
+0002f8e0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0002f8f0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+0002f900: 0a20 2020 2064 6566 2064 726f 706e 6128  .    def dropna(
+0002f910: 7365 6c66 2c20 686f 773d 6e6f 5f64 6566  self, how=no_def
+0002f920: 6175 6c74 2c20 7375 6273 6574 3d4e 6f6e  ault, subset=Non
+0002f930: 652c 2074 6872 6573 683d 6e6f 5f64 6566  e, thresh=no_def
+0002f940: 6175 6c74 293a 0a20 2020 2020 2020 2023  ault):.        #
+0002f950: 2054 6865 7365 206b 6579 776f 7264 7320   These keywords 
+0002f960: 6172 6520 696e 636f 6d70 6174 6962 6c65  are incompatible
+0002f970: 2077 6974 6820 6561 6368 206f 7468 6572   with each other
+0002f980: 2e0a 2020 2020 2020 2020 2320 446f 6e27  ..        # Don'
+0002f990: 7420 616c 6c6f 7720 7468 656d 2062 6f74  t allow them bot
+0002f9a0: 6820 746f 2062 6520 7365 742e 0a20 2020  h to be set..   
+0002f9b0: 2020 2020 2069 6620 686f 7720 6973 206e       if how is n
+0002f9c0: 6f74 206e 6f5f 6465 6661 756c 7420 616e  ot no_default an
+0002f9d0: 6420 7468 7265 7368 2069 7320 6e6f 7420  d thresh is not 
+0002f9e0: 6e6f 5f64 6566 6175 6c74 3a0a 2020 2020  no_default:.    
+0002f9f0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+0002fa00: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+0002fa10: 2020 2020 2020 2020 2022 596f 7520 6361           "You ca
+0002fa20: 6e6e 6f74 2073 6574 2062 6f74 6820 7468  nnot set both th
+0002fa30: 6520 686f 7720 616e 6420 7468 7265 7368  e how and thresh
+0002fa40: 2061 7267 756d 656e 7473 2061 7420 7468   arguments at th
+0002fa50: 6520 7361 6d65 2074 696d 652e 220a 2020  e same time.".  
+0002fa60: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0002fa70: 2020 2020 2023 204f 6e6c 7920 7370 6563       # Only spec
+0002fa80: 6966 7920 6068 6f77 6020 6f72 2060 7468  ify `how` or `th
+0002fa90: 7265 7368 6020 6b65 7977 6f72 6420 6966  resh` keyword if
+0002faa0: 2073 7065 6369 6669 6564 2062 7920 7468   specified by th
+0002fab0: 6520 7573 6572 0a20 2020 2020 2020 2023  e user.        #
+0002fac0: 2073 6f20 7765 2075 7469 6c69 7a65 206f   so we utilize o
+0002fad0: 7468 6572 2060 6472 6f70 6e61 6020 6b65  ther `dropna` ke
+0002fae0: 7977 6f72 6420 6465 6661 756c 7473 2061  yword defaults a
+0002faf0: 7070 726f 7072 6961 7465 6c79 0a20 2020  ppropriately.   
+0002fb00: 2020 2020 206b 7761 7267 7320 3d20 7b22       kwargs = {"
+0002fb10: 7375 6273 6574 223a 2073 7562 7365 747d  subset": subset}
+0002fb20: 0a20 2020 2020 2020 2069 6620 686f 7720  .        if how 
+0002fb30: 6973 206e 6f74 206e 6f5f 6465 6661 756c  is not no_defaul
+0002fb40: 743a 0a20 2020 2020 2020 2020 2020 206b  t:.            k
+0002fb50: 7761 7267 735b 2268 6f77 225d 203d 2068  wargs["how"] = h
+0002fb60: 6f77 0a20 2020 2020 2020 2065 6c69 6620  ow.        elif 
+0002fb70: 7468 7265 7368 2069 7320 6e6f 7420 6e6f  thresh is not no
+0002fb80: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
+0002fb90: 2020 2020 2020 6b77 6172 6773 5b22 7468        kwargs["th
+0002fba0: 7265 7368 225d 203d 2074 6872 6573 680a  resh"] = thresh.
+0002fbb0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002fbc0: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+0002fbd0: 6f6e 7328 4d2e 6472 6f70 6e61 2c20 2a2a  ons(M.dropna, **
+0002fbe0: 6b77 6172 6773 2c20 656e 666f 7263 655f  kwargs, enforce_
+0002fbf0: 6d65 7461 6461 7461 3d46 616c 7365 290a  metadata=False).
+0002fc00: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0002fc10: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+0002fc20: 0a20 2020 2064 6566 2063 6c69 7028 7365  .    def clip(se
+0002fc30: 6c66 2c20 6c6f 7765 723d 4e6f 6e65 2c20  lf, lower=None, 
+0002fc40: 7570 7065 723d 4e6f 6e65 2c20 6f75 743d  upper=None, out=
+0002fc50: 4e6f 6e65 293a 0a20 2020 2020 2020 2069  None):.        i
+0002fc60: 6620 6f75 7420 6973 206e 6f74 204e 6f6e  f out is not Non
+0002fc70: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0002fc80: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0002fc90: 2227 6f75 7427 206d 7573 7420 6265 204e  "'out' must be N
+0002fca0: 6f6e 6522 290a 2020 2020 2020 2020 7265  one").        re
+0002fcb0: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+0002fcc0: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+0002fcd0: 2020 2020 2020 4d2e 636c 6970 2c20 6c6f        M.clip, lo
+0002fce0: 7765 723d 6c6f 7765 722c 2075 7070 6572  wer=lower, upper
+0002fcf0: 3d75 7070 6572 2c20 656e 666f 7263 655f  =upper, enforce_
+0002fd00: 6d65 7461 6461 7461 3d46 616c 7365 0a20  metadata=False. 
+0002fd10: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+0002fd20: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0002fd30: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0002fd40: 6620 636c 6970 5f6c 6f77 6572 2873 656c  f clip_lower(sel
+0002fd50: 662c 2074 6872 6573 686f 6c64 293a 0a20  f, threshold):. 
+0002fd60: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0002fd70: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+0002fd80: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
+0002fd90: 2e63 6c69 705f 6c6f 7765 722c 2074 6872  .clip_lower, thr
+0002fda0: 6573 686f 6c64 3d74 6872 6573 686f 6c64  eshold=threshold
+0002fdb0: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
+0002fdc0: 7461 3d46 616c 7365 0a20 2020 2020 2020  ta=False.       
+0002fdd0: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
+0002fde0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+0002fdf0: 6d65 290a 2020 2020 6465 6620 636c 6970  me).    def clip
+0002fe00: 5f75 7070 6572 2873 656c 662c 2074 6872  _upper(self, thr
+0002fe10: 6573 686f 6c64 293a 0a20 2020 2020 2020  eshold):.       
+0002fe20: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+0002fe30: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+0002fe40: 2020 2020 2020 2020 204d 2e63 6c69 705f           M.clip_
+0002fe50: 7570 7065 722c 2074 6872 6573 686f 6c64  upper, threshold
+0002fe60: 3d74 6872 6573 686f 6c64 2c20 656e 666f  =threshold, enfo
+0002fe70: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
+0002fe80: 7365 0a20 2020 2020 2020 2029 0a0a 2020  se.        )..  
+0002fe90: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+0002fea0: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+0002feb0: 2020 6465 6620 7371 7565 657a 6528 7365    def squeeze(se
+0002fec0: 6c66 2c20 6178 6973 3d4e 6f6e 6529 3a0a  lf, axis=None):.
+0002fed0: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
+0002fee0: 696e 205b 4e6f 6e65 2c20 315d 3a0a 2020  in [None, 1]:.  
+0002fef0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0002ff00: 2873 656c 662e 636f 6c75 6d6e 7329 203d  (self.columns) =
+0002ff10: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+0002ff20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0002ff30: 5b73 656c 662e 636f 6c75 6d6e 735b 305d  [self.columns[0]
+0002ff40: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
+0002ff50: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0002ff60: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+0002ff70: 0a20 2020 2020 2020 2065 6c69 6620 6178  .        elif ax
+0002ff80: 6973 203d 3d20 303a 0a20 2020 2020 2020  is == 0:.       
+0002ff90: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+0002ffa0: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
+0002ffb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ffc0: 6622 7b74 7970 6528 7365 6c66 297d 2064  f"{type(self)} d
+0002ffd0: 6f65 7320 6e6f 7420 7375 7070 6f72 7420  oes not support 
+0002ffe0: 7371 7565 657a 6520 616c 6f6e 6720 6178  squeeze along ax
+0002fff0: 6973 2030 220a 2020 2020 2020 2020 2020  is 0".          
+00030000: 2020 290a 0a20 2020 2020 2020 2065 6c69    )..        eli
+00030010: 6620 6178 6973 206e 6f74 2069 6e20 5b30  f axis not in [0
+00030020: 2c20 312c 204e 6f6e 655d 3a0a 2020 2020  , 1, None]:.    
+00030030: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00030040: 6c75 6545 7272 6f72 2866 224e 6f20 6178  lueError(f"No ax
+00030050: 6973 207b 6178 6973 7d20 666f 7220 6f62  is {axis} for ob
+00030060: 6a65 6374 2074 7970 6520 7b74 7970 6528  ject type {type(
+00030070: 7365 6c66 297d 2229 0a0a 2020 2020 4064  self)}")..    @d
+00030080: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00030090: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+000300a0: 6620 746f 5f74 696d 6573 7461 6d70 2873  f to_timestamp(s
+000300b0: 656c 662c 2066 7265 713d 4e6f 6e65 2c20  elf, freq=None, 
+000300c0: 686f 773d 2273 7461 7274 222c 2061 7869  how="start", axi
+000300d0: 733d 3029 3a0a 2020 2020 2020 2020 6466  s=0):.        df
+000300e0: 203d 2065 6c65 6d77 6973 6528 4d2e 746f   = elemwise(M.to
+000300f0: 5f74 696d 6573 7461 6d70 2c20 7365 6c66  _timestamp, self
+00030100: 2c20 6672 6571 2c20 686f 772c 2061 7869  , freq, how, axi
+00030110: 7329 0a20 2020 2020 2020 2064 662e 6469  s).        df.di
+00030120: 7669 7369 6f6e 7320 3d20 7475 706c 6528  visions = tuple(
+00030130: 7064 2e49 6e64 6578 2873 656c 662e 6469  pd.Index(self.di
+00030140: 7669 7369 6f6e 7329 2e74 6f5f 7469 6d65  visions).to_time
+00030150: 7374 616d 7028 2929 0a20 2020 2020 2020  stamp()).       
+00030160: 2072 6574 7572 6e20 6466 0a0a 2020 2020   return df..    
+00030170: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00030180: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00030190: 6465 6620 6578 706c 6f64 6528 7365 6c66  def explode(self
+000301a0: 2c20 636f 6c75 6d6e 293a 0a20 2020 2020  , column):.     
+000301b0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+000301c0: 6d65 7461 2e65 7870 6c6f 6465 2863 6f6c  meta.explode(col
+000301d0: 756d 6e29 0a20 2020 2020 2020 2072 6574  umn).        ret
+000301e0: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
+000301f0: 7469 7469 6f6e 7328 4d2e 6578 706c 6f64  titions(M.explod
+00030200: 652c 2063 6f6c 756d 6e2c 206d 6574 613d  e, column, meta=
+00030210: 6d65 7461 2c20 656e 666f 7263 655f 6d65  meta, enforce_me
+00030220: 7461 6461 7461 3d46 616c 7365 290a 0a20  tadata=False).. 
+00030230: 2020 2064 6566 2074 6f5f 6261 6728 7365     def to_bag(se
+00030240: 6c66 2c20 696e 6465 783d 4661 6c73 652c  lf, index=False,
+00030250: 2066 6f72 6d61 743d 2274 7570 6c65 2229   format="tuple")
+00030260: 3a0a 2020 2020 2020 2020 2222 2243 6f6e  :.        """Con
+00030270: 7665 7274 2074 6f20 6120 6461 736b 2042  vert to a dask B
+00030280: 6167 206f 6620 7475 706c 6573 206f 6620  ag of tuples of 
+00030290: 6561 6368 2072 6f77 2e0a 0a20 2020 2020  each row...     
+000302a0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+000302b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000302c0: 0a20 2020 2020 2020 2069 6e64 6578 203a  .        index :
+000302d0: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
+000302e0: 2020 2020 2020 2020 2020 2020 4966 2054              If T
+000302f0: 7275 652c 2074 6865 2069 6e64 6578 2069  rue, the index i
+00030300: 7320 696e 636c 7564 6564 2061 7320 7468  s included as th
+00030310: 6520 6669 7273 7420 656c 656d 656e 7420  e first element 
+00030320: 6f66 2065 6163 6820 7475 706c 652e 0a20  of each tuple.. 
+00030330: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+00030340: 6c74 2069 7320 4661 6c73 652e 0a20 2020  lt is False..   
+00030350: 2020 2020 2066 6f72 6d61 7420 3a20 7b22       format : {"
+00030360: 7475 706c 6522 2c20 2264 6963 7422 2c20  tuple", "dict", 
+00030370: 2266 7261 6d65 227d 2c20 6f70 7469 6f6e  "frame"}, option
+00030380: 616c 0a20 2020 2020 2020 2020 2020 2057  al.            W
+00030390: 6865 7468 6572 2074 6f20 7265 7475 726e  hether to return
+000303a0: 2061 2062 6167 206f 6620 7475 706c 6573   a bag of tuples
+000303b0: 2c20 6469 6374 696f 6e61 7269 6573 2c20  , dictionaries, 
+000303c0: 6f72 0a20 2020 2020 2020 2020 2020 2064  or.            d
+000303d0: 6174 6166 7261 6d65 2d6c 696b 6520 6f62  ataframe-like ob
+000303e0: 6a65 6374 732e 2044 6566 6175 6c74 2069  jects. Default i
+000303f0: 7320 2274 7570 6c65 222e 2049 6620 2266  s "tuple". If "f
+00030400: 7261 6d65 222c 0a20 2020 2020 2020 2020  rame",.         
+00030410: 2020 2074 6865 206f 7269 6769 6e61 6c20     the original 
+00030420: 7061 7274 6974 696f 6e73 206f 6620 6060  partitions of ``
+00030430: 6466 6060 2077 696c 6c20 6e6f 7420 6265  df`` will not be
+00030440: 2074 7261 6e73 666f 726d 6564 0a20 2020   transformed.   
+00030450: 2020 2020 2020 2020 2069 6e20 616e 7920           in any 
+00030460: 7761 792e 0a20 2020 2020 2020 2022 2222  way..        """
+00030470: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00030480: 736b 2e64 6174 6166 7261 6d65 2e69 6f20  sk.dataframe.io 
+00030490: 696d 706f 7274 2074 6f5f 6261 670a 0a20  import to_bag.. 
+000304a0: 2020 2020 2020 2072 6574 7572 6e20 746f         return to
+000304b0: 5f62 6167 2873 656c 662c 2069 6e64 6578  _bag(self, index
+000304c0: 2c20 666f 726d 6174 290a 0a20 2020 2064  , format)..    d
+000304d0: 6566 2074 6f5f 7061 7271 7565 7428 7365  ef to_parquet(se
+000304e0: 6c66 2c20 7061 7468 2c20 2a61 7267 732c  lf, path, *args,
+000304f0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+00030500: 2020 2020 2222 2253 6565 2064 642e 746f      """See dd.to
+00030510: 5f70 6172 7175 6574 2064 6f63 7374 7269  _parquet docstri
+00030520: 6e67 2066 6f72 206d 6f72 6520 696e 666f  ng for more info
+00030530: 726d 6174 696f 6e22 2222 0a20 2020 2020  rmation""".     
+00030540: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
+00030550: 6166 7261 6d65 2e69 6f20 696d 706f 7274  aframe.io import
+00030560: 2074 6f5f 7061 7271 7565 740a 0a20 2020   to_parquet..   
+00030570: 2020 2020 2072 6574 7572 6e20 746f 5f70       return to_p
+00030580: 6172 7175 6574 2873 656c 662c 2070 6174  arquet(self, pat
+00030590: 682c 202a 6172 6773 2c20 2a2a 6b77 6172  h, *args, **kwar
+000305a0: 6773 290a 0a20 2020 2064 6566 2074 6f5f  gs)..    def to_
+000305b0: 6f72 6328 7365 6c66 2c20 7061 7468 2c20  orc(self, path, 
+000305c0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+000305d0: 3a0a 2020 2020 2020 2020 2222 2253 6565  :.        """See
+000305e0: 2064 642e 746f 5f6f 7263 2064 6f63 7374   dd.to_orc docst
+000305f0: 7269 6e67 2066 6f72 206d 6f72 6520 696e  ring for more in
+00030600: 666f 726d 6174 696f 6e22 2222 0a20 2020  formation""".   
+00030610: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
+00030620: 6174 6166 7261 6d65 2e69 6f20 696d 706f  ataframe.io impo
+00030630: 7274 2074 6f5f 6f72 630a 0a20 2020 2020  rt to_orc..     
+00030640: 2020 2072 6574 7572 6e20 746f 5f6f 7263     return to_orc
+00030650: 2873 656c 662c 2070 6174 682c 202a 6172  (self, path, *ar
+00030660: 6773 2c20 2a2a 6b77 6172 6773 290a 0a20  gs, **kwargs).. 
+00030670: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00030680: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00030690: 2020 2064 6566 2074 6f5f 7374 7269 6e67     def to_string
+000306a0: 2873 656c 662c 206d 6178 5f72 6f77 733d  (self, max_rows=
+000306b0: 3529 3a0a 2020 2020 2020 2020 2320 6f70  5):.        # op
+000306c0: 7469 6f6e 5f63 6f6e 7465 7874 2064 6f65  tion_context doe
+000306d0: 736e 2774 2061 6666 6563 740a 2020 2020  sn't affect.    
+000306e0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000306f0: 5f72 6570 725f 6461 7461 2829 2e74 6f5f  _repr_data().to_
+00030700: 7374 7269 6e67 286d 6178 5f72 6f77 733d  string(max_rows=
+00030710: 6d61 785f 726f 7773 2c20 7368 6f77 5f64  max_rows, show_d
+00030720: 696d 656e 7369 6f6e 733d 4661 6c73 6529  imensions=False)
+00030730: 0a0a 2020 2020 6465 6620 5f67 6574 5f6e  ..    def _get_n
+00030740: 756d 6572 6963 5f64 6174 6128 7365 6c66  umeric_data(self
+00030750: 2c20 686f 773d 2261 6e79 222c 2073 7562  , how="any", sub
+00030760: 7365 743d 4e6f 6e65 293a 0a20 2020 2020  set=None):.     
+00030770: 2020 2023 2063 616c 6375 6c61 7465 2063     # calculate c
+00030780: 6f6c 756d 6e73 2074 6f20 6176 6f69 6420  olumns to avoid 
+00030790: 756e 6e65 6365 7373 6172 7920 6361 6c63  unnecessary calc
+000307a0: 756c 6174 696f 6e0a 2020 2020 2020 2020  ulation.        
+000307b0: 6e75 6d65 7269 6373 203d 2073 656c 662e  numerics = self.
+000307c0: 5f6d 6574 612e 5f67 6574 5f6e 756d 6572  _meta._get_numer
+000307d0: 6963 5f64 6174 6128 290a 0a20 2020 2020  ic_data()..     
+000307e0: 2020 2069 6620 6c65 6e28 6e75 6d65 7269     if len(numeri
+000307f0: 6373 2e63 6f6c 756d 6e73 2920 3c20 6c65  cs.columns) < le
+00030800: 6e28 7365 6c66 2e63 6f6c 756d 6e73 293a  n(self.columns):
+00030810: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+00030820: 6520 3d20 7365 6c66 2e5f 746f 6b65 6e5f  e = self._token_
+00030830: 7072 6566 6978 202b 2022 2d67 6574 5f6e  prefix + "-get_n
+00030840: 756d 6572 6963 5f64 6174 6122 0a20 2020  umeric_data".   
+00030850: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00030860: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+00030870: 6f6e 7328 4d2e 5f67 6574 5f6e 756d 6572  ons(M._get_numer
+00030880: 6963 5f64 6174 612c 206d 6574 613d 6e75  ic_data, meta=nu
+00030890: 6d65 7269 6373 2c20 746f 6b65 6e3d 6e61  merics, token=na
+000308a0: 6d65 290a 2020 2020 2020 2020 656c 7365  me).        else
+000308b0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+000308c0: 7573 6520 6d79 7365 6c66 2069 6620 616c  use myself if al
+000308d0: 6c20 6e75 6d65 7269 6373 0a20 2020 2020  l numerics.     
+000308e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000308f0: 6c66 0a0a 2020 2020 4063 6c61 7373 6d65  lf..    @classme
+00030900: 7468 6f64 0a20 2020 2064 6566 205f 7661  thod.    def _va
+00030910: 6c69 6461 7465 5f61 7869 7328 636c 732c  lidate_axis(cls,
+00030920: 2061 7869 733d 302c 206e 6f6e 655f 6973   axis=0, none_is
+00030930: 5f7a 6572 6f3a 2062 6f6f 6c20 3d20 5472  _zero: bool = Tr
+00030940: 7565 2920 2d3e 204e 6f6e 6520 7c20 4c69  ue) -> None | Li
+00030950: 7465 7261 6c5b 302c 2031 5d3a 0a20 2020  teral[0, 1]:.   
+00030960: 2020 2020 2069 6620 6178 6973 206e 6f74       if axis not
+00030970: 2069 6e20 2830 2c20 312c 2022 696e 6465   in (0, 1, "inde
+00030980: 7822 2c20 2263 6f6c 756d 6e73 222c 204e  x", "columns", N
+00030990: 6f6e 6529 3a0a 2020 2020 2020 2020 2020  one):.          
+000309a0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000309b0: 6f72 2866 224e 6f20 6178 6973 206e 616d  or(f"No axis nam
+000309c0: 6564 207b 6178 6973 7d22 290a 2020 2020  ed {axis}").    
+000309d0: 2020 2020 2320 636f 6e76 6572 7420 746f      # convert to
+000309e0: 206e 756d 6572 6963 2061 7869 730a 2020   numeric axis.  
+000309f0: 2020 2020 2020 6e75 6d65 7269 635f 6178        numeric_ax
+00030a00: 6973 3a20 6469 6374 5b73 7472 207c 204e  is: dict[str | N
+00030a10: 6f6e 652c 204c 6974 6572 616c 5b30 2c20  one, Literal[0, 
+00030a20: 315d 5d20 3d20 7b22 696e 6465 7822 3a20  1]] = {"index": 
+00030a30: 302c 2022 636f 6c75 6d6e 7322 3a20 317d  0, "columns": 1}
+00030a40: 0a20 2020 2020 2020 2069 6620 6e6f 6e65  .        if none
+00030a50: 5f69 735f 7a65 726f 3a0a 2020 2020 2020  _is_zero:.      
+00030a60: 2020 2020 2020 6e75 6d65 7269 635f 6178        numeric_ax
+00030a70: 6973 5b4e 6f6e 655d 203d 2030 0a0a 2020  is[None] = 0..  
+00030a80: 2020 2020 2020 7265 7475 726e 206e 756d        return num
+00030a90: 6572 6963 5f61 7869 732e 6765 7428 6178  eric_axis.get(ax
+00030aa0: 6973 2c20 6178 6973 290a 0a20 2020 2040  is, axis)..    @
+00030ab0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00030ac0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+00030ad0: 6566 2064 726f 7028 7365 6c66 2c20 6c61  ef drop(self, la
+00030ae0: 6265 6c73 3d4e 6f6e 652c 2061 7869 733d  bels=None, axis=
+00030af0: 302c 2063 6f6c 756d 6e73 3d4e 6f6e 652c  0, columns=None,
+00030b00: 2065 7272 6f72 733d 2272 6169 7365 2229   errors="raise")
+00030b10: 3a0a 2020 2020 2020 2020 6178 6973 203d  :.        axis =
+00030b20: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
+00030b30: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
+00030b40: 2020 2069 6620 6178 6973 203d 3d20 3020     if axis == 0 
+00030b50: 616e 6420 636f 6c75 6d6e 7320 6973 206e  and columns is n
+00030b60: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00030b70: 2020 2020 2023 2043 6f6c 756d 6e73 206d       # Columns m
+00030b80: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
+00030b90: 2069 6620 6178 6973 3d3d 300a 2020 2020   if axis==0.    
+00030ba0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00030bb0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00030bc0: 6e73 2864 726f 705f 6279 5f73 6861 6c6c  ns(drop_by_shall
+00030bd0: 6f77 5f63 6f70 792c 2063 6f6c 756d 6e73  ow_copy, columns
+00030be0: 2c20 6572 726f 7273 3d65 7272 6f72 7329  , errors=errors)
+00030bf0: 0a20 2020 2020 2020 2065 6c69 6620 6178  .        elif ax
+00030c00: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
+00030c10: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00030c20: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+00030c30: 6472 6f70 5f62 795f 7368 616c 6c6f 775f  drop_by_shallow_
+00030c40: 636f 7079 2c20 6c61 6265 6c73 2c20 6572  copy, labels, er
+00030c50: 726f 7273 3d65 7272 6f72 7329 0a20 2020  rors=errors).   
+00030c60: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00030c70: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
+00030c80: 2020 2020 2020 2020 2020 2020 2244 726f              "Dro
+00030c90: 7020 6375 7272 656e 746c 7920 6f6e 6c79  p currently only
+00030ca0: 2077 6f72 6b73 2066 6f72 2061 7869 733d   works for axis=
+00030cb0: 3120 6f72 2077 6865 6e20 636f 6c75 6d6e  1 or when column
+00030cc0: 7320 6973 206e 6f74 204e 6f6e 6522 0a20  s is not None". 
+00030cd0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00030ce0: 6620 6d65 7267 6528 0a20 2020 2020 2020  f merge(.       
+00030cf0: 2073 656c 662c 0a20 2020 2020 2020 2072   self,.        r
+00030d00: 6967 6874 2c0a 2020 2020 2020 2020 686f  ight,.        ho
+00030d10: 773d 2269 6e6e 6572 222c 0a20 2020 2020  w="inner",.     
+00030d20: 2020 206f 6e3d 4e6f 6e65 2c0a 2020 2020     on=None,.    
+00030d30: 2020 2020 6c65 6674 5f6f 6e3d 4e6f 6e65      left_on=None
+00030d40: 2c0a 2020 2020 2020 2020 7269 6768 745f  ,.        right_
+00030d50: 6f6e 3d4e 6f6e 652c 0a20 2020 2020 2020  on=None,.       
+00030d60: 206c 6566 745f 696e 6465 783d 4661 6c73   left_index=Fals
+00030d70: 652c 0a20 2020 2020 2020 2072 6967 6874  e,.        right
+00030d80: 5f69 6e64 6578 3d46 616c 7365 2c0a 2020  _index=False,.  
+00030d90: 2020 2020 2020 7375 6666 6978 6573 3d28        suffixes=(
+00030da0: 225f 7822 2c20 225f 7922 292c 0a20 2020  "_x", "_y"),.   
+00030db0: 2020 2020 2069 6e64 6963 6174 6f72 3d46       indicator=F
+00030dc0: 616c 7365 2c0a 2020 2020 2020 2020 6e70  alse,.        np
+00030dd0: 6172 7469 7469 6f6e 733d 4e6f 6e65 2c0a  artitions=None,.
+00030de0: 2020 2020 2020 2020 7368 7566 666c 653d          shuffle=
+00030df0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6272  None,.        br
+00030e00: 6f61 6463 6173 743d 4e6f 6e65 2c0a 2020  oadcast=None,.  
+00030e10: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00030e20: 4d65 7267 6520 7468 6520 4461 7461 4672  Merge the DataFr
+00030e30: 616d 6520 7769 7468 2061 6e6f 7468 6572  ame with another
+00030e40: 2044 6174 6146 7261 6d65 0a0a 2020 2020   DataFrame..    
+00030e50: 2020 2020 5468 6973 2077 696c 6c20 6d65      This will me
+00030e60: 7267 6520 7468 6520 7477 6f20 6461 7461  rge the two data
+00030e70: 7365 7473 2c20 6569 7468 6572 206f 6e20  sets, either on 
+00030e80: 7468 6520 696e 6469 6365 732c 2061 2063  the indices, a c
+00030e90: 6572 7461 696e 2063 6f6c 756d 6e0a 2020  ertain column.  
+00030ea0: 2020 2020 2020 696e 2065 6163 6820 6461        in each da
+00030eb0: 7461 7365 7420 6f72 2074 6865 2069 6e64  taset or the ind
+00030ec0: 6578 2069 6e20 6f6e 6520 6461 7461 7365  ex in one datase
+00030ed0: 7420 616e 6420 7468 6520 636f 6c75 6d6e  t and the column
+00030ee0: 2069 6e20 616e 6f74 6865 722e 0a0a 2020   in another...  
+00030ef0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00030f00: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00030f10: 2d2d 2d0a 2020 2020 2020 2020 7269 6768  ---.        righ
+00030f20: 743a 2064 6173 6b2e 6461 7461 6672 616d  t: dask.datafram
+00030f30: 652e 4461 7461 4672 616d 650a 2020 2020  e.DataFrame.    
+00030f40: 2020 2020 686f 7720 3a20 7b27 6c65 6674      how : {'left
+00030f50: 272c 2027 7269 6768 7427 2c20 276f 7574  ', 'right', 'out
+00030f60: 6572 272c 2027 696e 6e65 7227 7d2c 2064  er', 'inner'}, d
+00030f70: 6566 6175 6c74 3a20 2769 6e6e 6572 270a  efault: 'inner'.
+00030f80: 2020 2020 2020 2020 2020 2020 486f 7720              How 
+00030f90: 746f 2068 616e 646c 6520 7468 6520 6f70  to handle the op
+00030fa0: 6572 6174 696f 6e20 6f66 2074 6865 2074  eration of the t
+00030fb0: 776f 206f 626a 6563 7473 3a0a 0a20 2020  wo objects:..   
+00030fc0: 2020 2020 2020 2020 202d 206c 6566 743a           - left:
+00030fd0: 2075 7365 2063 616c 6c69 6e67 2066 7261   use calling fra
+00030fe0: 6d65 2773 2069 6e64 6578 2028 6f72 2063  me's index (or c
+00030ff0: 6f6c 756d 6e20 6966 206f 6e20 6973 2073  olumn if on is s
+00031000: 7065 6369 6669 6564 290a 2020 2020 2020  pecified).      
+00031010: 2020 2020 2020 2d20 7269 6768 743a 2075        - right: u
+00031020: 7365 206f 7468 6572 2066 7261 6d65 2773  se other frame's
+00031030: 2069 6e64 6578 0a20 2020 2020 2020 2020   index.         
+00031040: 2020 202d 206f 7574 6572 3a20 666f 726d     - outer: form
+00031050: 2075 6e69 6f6e 206f 6620 6361 6c6c 696e   union of callin
+00031060: 6720 6672 616d 6527 7320 696e 6465 7820  g frame's index 
+00031070: 286f 7220 636f 6c75 6d6e 2069 6620 6f6e  (or column if on
+00031080: 2069 730a 2020 2020 2020 2020 2020 2020   is.            
+00031090: 2020 7370 6563 6966 6965 6429 2077 6974    specified) wit
+000310a0: 6820 6f74 6865 7220 6672 616d 6527 7320  h other frame's 
+000310b0: 696e 6465 782c 2061 6e64 2073 6f72 7420  index, and sort 
+000310c0: 6974 0a20 2020 2020 2020 2020 2020 2020  it.             
+000310d0: 206c 6578 6963 6f67 7261 7068 6963 616c   lexicographical
+000310e0: 6c79 0a20 2020 2020 2020 2020 2020 202d  ly.            -
+000310f0: 2069 6e6e 6572 3a20 666f 726d 2069 6e74   inner: form int
+00031100: 6572 7365 6374 696f 6e20 6f66 2063 616c  ersection of cal
+00031110: 6c69 6e67 2066 7261 6d65 2773 2069 6e64  ling frame's ind
+00031120: 6578 2028 6f72 2063 6f6c 756d 6e20 6966  ex (or column if
+00031130: 0a20 2020 2020 2020 2020 2020 2020 206f  .              o
+00031140: 6e20 6973 2073 7065 6369 6669 6564 2920  n is specified) 
+00031150: 7769 7468 206f 7468 6572 2066 7261 6d65  with other frame
+00031160: 2773 2069 6e64 6578 2c20 7072 6573 6572  's index, preser
+00031170: 7669 6e67 2074 6865 206f 7264 6572 0a20  ving the order. 
+00031180: 2020 2020 2020 2020 2020 2020 206f 6620               of 
+00031190: 7468 6520 6361 6c6c 696e 6727 7320 6f6e  the calling's on
+000311a0: 650a 0a20 2020 2020 2020 206f 6e20 3a20  e..        on : 
+000311b0: 6c61 6265 6c20 6f72 206c 6973 740a 2020  label or list.  
+000311c0: 2020 2020 2020 2020 2020 436f 6c75 6d6e            Column
+000311d0: 206f 7220 696e 6465 7820 6c65 7665 6c20   or index level 
+000311e0: 6e61 6d65 7320 746f 206a 6f69 6e20 6f6e  names to join on
+000311f0: 2e20 5468 6573 6520 6d75 7374 2062 6520  . These must be 
+00031200: 666f 756e 6420 696e 2062 6f74 680a 2020  found in both.  
+00031210: 2020 2020 2020 2020 2020 4461 7461 4672            DataFr
+00031220: 616d 6573 2e20 4966 206f 6e20 6973 204e  ames. If on is N
+00031230: 6f6e 6520 616e 6420 6e6f 7420 6d65 7267  one and not merg
+00031240: 696e 6720 6f6e 2069 6e64 6578 6573 2074  ing on indexes t
+00031250: 6865 6e20 7468 6973 0a20 2020 2020 2020  hen this.       
+00031260: 2020 2020 2064 6566 6175 6c74 7320 746f       defaults to
+00031270: 2074 6865 2069 6e74 6572 7365 6374 696f   the intersectio
+00031280: 6e20 6f66 2074 6865 2063 6f6c 756d 6e73  n of the columns
+00031290: 2069 6e20 626f 7468 2044 6174 6146 7261   in both DataFra
+000312a0: 6d65 732e 0a20 2020 2020 2020 206c 6566  mes..        lef
+000312b0: 745f 6f6e 203a 206c 6162 656c 206f 7220  t_on : label or 
+000312c0: 6c69 7374 2c20 6f72 2061 7272 6179 2d6c  list, or array-l
+000312d0: 696b 650a 2020 2020 2020 2020 2020 2020  ike.            
+000312e0: 436f 6c75 6d6e 2074 6f20 6a6f 696e 206f  Column to join o
+000312f0: 6e20 696e 2074 6865 206c 6566 7420 4461  n in the left Da
+00031300: 7461 4672 616d 652e 204f 7468 6572 2074  taFrame. Other t
+00031310: 6861 6e20 696e 2070 616e 6461 730a 2020  han in pandas.  
+00031320: 2020 2020 2020 2020 2020 6172 7261 7973            arrays
+00031330: 2061 6e64 206c 6973 7473 2061 7265 206f   and lists are o
+00031340: 6e6c 7920 7375 7070 6f72 7420 6966 2074  nly support if t
+00031350: 6865 6972 206c 656e 6774 6820 6973 2031  heir length is 1
+00031360: 2e0a 2020 2020 2020 2020 7269 6768 745f  ..        right_
+00031370: 6f6e 203a 206c 6162 656c 206f 7220 6c69  on : label or li
+00031380: 7374 2c20 6f72 2061 7272 6179 2d6c 696b  st, or array-lik
+00031390: 650a 2020 2020 2020 2020 2020 2020 436f  e.            Co
+000313a0: 6c75 6d6e 2074 6f20 6a6f 696e 206f 6e20  lumn to join on 
+000313b0: 696e 2074 6865 2072 6967 6874 2044 6174  in the right Dat
+000313c0: 6146 7261 6d65 2e20 4f74 6865 7220 7468  aFrame. Other th
+000313d0: 616e 2069 6e20 7061 6e64 6173 0a20 2020  an in pandas.   
+000313e0: 2020 2020 2020 2020 2061 7272 6179 7320           arrays 
+000313f0: 616e 6420 6c69 7374 7320 6172 6520 6f6e  and lists are on
+00031400: 6c79 2073 7570 706f 7274 2069 6620 7468  ly support if th
+00031410: 6569 7220 6c65 6e67 7468 2069 7320 312e  eir length is 1.
+00031420: 0a20 2020 2020 2020 206c 6566 745f 696e  .        left_in
+00031430: 6465 7820 3a20 626f 6f6c 6561 6e2c 2064  dex : boolean, d
+00031440: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+00031450: 2020 2020 2020 2020 2055 7365 2074 6865           Use the
+00031460: 2069 6e64 6578 2066 726f 6d20 7468 6520   index from the 
+00031470: 6c65 6674 2044 6174 6146 7261 6d65 2061  left DataFrame a
+00031480: 7320 7468 6520 6a6f 696e 206b 6579 2e0a  s the join key..
+00031490: 2020 2020 2020 2020 7269 6768 745f 696e          right_in
+000314a0: 6465 7820 3a20 626f 6f6c 6561 6e2c 2064  dex : boolean, d
+000314b0: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+000314c0: 2020 2020 2020 2020 2055 7365 2074 6865           Use the
+000314d0: 2069 6e64 6578 2066 726f 6d20 7468 6520   index from the 
+000314e0: 7269 6768 7420 4461 7461 4672 616d 6520  right DataFrame 
+000314f0: 6173 2074 6865 206a 6f69 6e20 6b65 792e  as the join key.
+00031500: 0a20 2020 2020 2020 2073 7566 6669 7865  .        suffixe
+00031510: 7320 3a20 322d 6c65 6e67 7468 2073 6571  s : 2-length seq
+00031520: 7565 6e63 6520 2874 7570 6c65 2c20 6c69  uence (tuple, li
+00031530: 7374 2c20 2e2e 2e29 0a20 2020 2020 2020  st, ...).       
+00031540: 2020 2020 2053 7566 6669 7820 746f 2061       Suffix to a
+00031550: 7070 6c79 2074 6f20 6f76 6572 6c61 7070  pply to overlapp
+00031560: 696e 6720 636f 6c75 6d6e 206e 616d 6573  ing column names
+00031570: 2069 6e20 7468 6520 6c65 6674 2061 6e64   in the left and
+00031580: 0a20 2020 2020 2020 2020 2020 2072 6967  .            rig
+00031590: 6874 2073 6964 652c 2072 6573 7065 6374  ht side, respect
+000315a0: 6976 656c 790a 2020 2020 2020 2020 696e  ively.        in
+000315b0: 6469 6361 746f 7220 3a20 626f 6f6c 6561  dicator : boolea
+000315c0: 6e20 6f72 2073 7472 696e 672c 2064 6566  n or string, def
+000315d0: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
+000315e0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+000315f0: 6164 6473 2061 2063 6f6c 756d 6e20 746f  adds a column to
+00031600: 206f 7574 7075 7420 4461 7461 4672 616d   output DataFram
+00031610: 6520 6361 6c6c 6564 2022 5f6d 6572 6765  e called "_merge
+00031620: 2220 7769 7468 0a20 2020 2020 2020 2020  " with.         
+00031630: 2020 2069 6e66 6f72 6d61 7469 6f6e 206f     information o
+00031640: 6e20 7468 6520 736f 7572 6365 206f 6620  n the source of 
+00031650: 6561 6368 2072 6f77 2e20 4966 2073 7472  each row. If str
+00031660: 696e 672c 2063 6f6c 756d 6e20 7769 7468  ing, column with
+00031670: 0a20 2020 2020 2020 2020 2020 2069 6e66  .            inf
+00031680: 6f72 6d61 7469 6f6e 206f 6e20 736f 7572  ormation on sour
+00031690: 6365 206f 6620 6561 6368 2072 6f77 2077  ce of each row w
+000316a0: 696c 6c20 6265 2061 6464 6564 2074 6f20  ill be added to 
+000316b0: 6f75 7470 7574 2044 6174 6146 7261 6d65  output DataFrame
+000316c0: 2c0a 2020 2020 2020 2020 2020 2020 616e  ,.            an
+000316d0: 6420 636f 6c75 6d6e 2077 696c 6c20 6265  d column will be
+000316e0: 206e 616d 6564 2076 616c 7565 206f 6620   named value of 
+000316f0: 7374 7269 6e67 2e20 496e 666f 726d 6174  string. Informat
+00031700: 696f 6e20 636f 6c75 6d6e 2069 730a 2020  ion column is.  
+00031710: 2020 2020 2020 2020 2020 4361 7465 676f            Catego
+00031720: 7269 6361 6c2d 7479 7065 2061 6e64 2074  rical-type and t
+00031730: 616b 6573 206f 6e20 6120 7661 6c75 6520  akes on a value 
+00031740: 6f66 2022 6c65 6674 5f6f 6e6c 7922 2066  of "left_only" f
+00031750: 6f72 206f 6273 6572 7661 7469 6f6e 730a  or observations.
+00031760: 2020 2020 2020 2020 2020 2020 7768 6f73              whos
+00031770: 6520 6d65 7267 6520 6b65 7920 6f6e 6c79  e merge key only
+00031780: 2061 7070 6561 7273 2069 6e20 606c 6566   appears in `lef
+00031790: 7460 2044 6174 6146 7261 6d65 2c20 2272  t` DataFrame, "r
+000317a0: 6967 6874 5f6f 6e6c 7922 2066 6f72 0a20  ight_only" for. 
+000317b0: 2020 2020 2020 2020 2020 206f 6273 6572             obser
+000317c0: 7661 7469 6f6e 7320 7768 6f73 6520 6d65  vations whose me
+000317d0: 7267 6520 6b65 7920 6f6e 6c79 2061 7070  rge key only app
+000317e0: 6561 7273 2069 6e20 6072 6967 6874 6020  ears in `right` 
+000317f0: 4461 7461 4672 616d 652c 0a20 2020 2020  DataFrame,.     
+00031800: 2020 2020 2020 2061 6e64 2022 626f 7468         and "both
+00031810: 2220 6966 2074 6865 206f 6273 6572 7661  " if the observa
+00031820: 7469 6f6e e280 9973 206d 6572 6765 206b  tion...s merge k
+00031830: 6579 2069 7320 666f 756e 6420 696e 2062  ey is found in b
+00031840: 6f74 682e 0a20 2020 2020 2020 206e 7061  oth..        npa
+00031850: 7274 6974 696f 6e73 3a20 696e 7420 6f72  rtitions: int or
+00031860: 204e 6f6e 652c 206f 7074 696f 6e61 6c0a   None, optional.
+00031870: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00031880: 6964 6561 6c20 6e75 6d62 6572 206f 6620  ideal number of 
+00031890: 6f75 7470 7574 2070 6172 7469 7469 6f6e  output partition
+000318a0: 732e 2054 6869 7320 6973 206f 6e6c 7920  s. This is only 
+000318b0: 7574 696c 6973 6564 2077 6865 6e0a 2020  utilised when.  
+000318c0: 2020 2020 2020 2020 2020 7065 7266 6f72            perfor
+000318d0: 6d69 6e67 2061 2068 6173 685f 6a6f 696e  ming a hash_join
+000318e0: 2028 6d65 7267 696e 6720 6f6e 2063 6f6c   (merging on col
+000318f0: 756d 6e73 206f 6e6c 7929 2e20 4966 2060  umns only). If `
+00031900: 604e 6f6e 6560 6020 7468 656e 0a20 2020  `None`` then.   
+00031910: 2020 2020 2020 2020 2060 606e 7061 7274           ``npart
+00031920: 6974 696f 6e73 203d 206d 6178 286c 6873  itions = max(lhs
+00031930: 2e6e 7061 7274 6974 696f 6e73 2c20 7268  .npartitions, rh
+00031940: 732e 6e70 6172 7469 7469 6f6e 7329 6060  s.npartitions)``
+00031950: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
+00031960: 6661 756c 7420 6973 2060 604e 6f6e 6560  fault is ``None`
+00031970: 602e 0a20 2020 2020 2020 2073 6875 6666  `..        shuff
+00031980: 6c65 3a20 7b27 6469 736b 272c 2027 7461  le: {'disk', 'ta
+00031990: 736b 7327 7d2c 206f 7074 696f 6e61 6c0a  sks'}, optional.
+000319a0: 2020 2020 2020 2020 2020 2020 4569 7468              Eith
+000319b0: 6572 2060 6027 6469 736b 2760 6020 666f  er ``'disk'`` fo
+000319c0: 7220 7369 6e67 6c65 2d6e 6f64 6520 6f70  r single-node op
+000319d0: 6572 6174 696f 6e20 6f72 2060 6027 7461  eration or ``'ta
+000319e0: 736b 7327 6060 2066 6f72 0a20 2020 2020  sks'`` for.     
+000319f0: 2020 2020 2020 2064 6973 7472 6962 7574         distribut
+00031a00: 6564 206f 7065 7261 7469 6f6e 2e20 2057  ed operation.  W
+00031a10: 696c 6c20 6265 2069 6e66 6572 7265 6420  ill be inferred 
+00031a20: 6279 2079 6f75 7220 6375 7272 656e 7420  by your current 
+00031a30: 7363 6865 6475 6c65 722e 0a20 2020 2020  scheduler..     
+00031a40: 2020 2062 726f 6164 6361 7374 3a20 626f     broadcast: bo
+00031a50: 6f6c 6561 6e20 6f72 2066 6c6f 6174 2c20  olean or float, 
+00031a60: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00031a70: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+00031a80: 7573 6520 6120 6272 6f61 6463 6173 742d  use a broadcast-
+00031a90: 6261 7365 6420 6a6f 696e 2069 6e20 6c69  based join in li
+00031aa0: 6575 206f 6620 6120 7368 7566 666c 652d  eu of a shuffle-
+00031ab0: 6261 7365 640a 2020 2020 2020 2020 2020  based.          
+00031ac0: 2020 6a6f 696e 2066 6f72 2073 7570 706f    join for suppo
+00031ad0: 7274 6564 2063 6173 6573 2e20 2042 7920  rted cases.  By 
+00031ae0: 6465 6661 756c 742c 2061 2073 696d 706c  default, a simpl
+00031af0: 6520 6865 7572 6973 7469 6320 7769 6c6c  e heuristic will
+00031b00: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
+00031b10: 7573 6564 2074 6f20 7365 6c65 6374 2074  used to select t
+00031b20: 6865 2075 6e64 6572 6c79 696e 6720 616c  he underlying al
+00031b30: 676f 7269 7468 6d2e 2049 6620 6120 666c  gorithm. If a fl
+00031b40: 6f61 7469 6e67 2d70 6f69 6e74 2076 616c  oating-point val
+00031b50: 7565 0a20 2020 2020 2020 2020 2020 2069  ue.            i
+00031b60: 7320 7370 6563 6966 6965 642c 2074 6861  s specified, tha
+00031b70: 7420 6e75 6d62 6572 2077 696c 6c20 6265  t number will be
+00031b80: 2075 7365 6420 6173 2074 6865 2060 6062   used as the ``b
+00031b90: 726f 6164 6361 7374 5f62 6961 7360 600a  roadcast_bias``.
+00031ba0: 2020 2020 2020 2020 2020 2020 7769 7468              with
+00031bb0: 696e 2074 6865 2073 696d 706c 6520 6865  in the simple he
+00031bc0: 7572 6973 7469 6320 2861 206c 6172 6765  uristic (a large
+00031bd0: 206e 756d 6265 7220 6d61 6b65 7320 4461   number makes Da
+00031be0: 736b 206d 6f72 6520 6c69 6b65 6c79 0a20  sk more likely. 
+00031bf0: 2020 2020 2020 2020 2020 2074 6f20 6368             to ch
+00031c00: 6f6f 7365 2074 6865 2060 6062 726f 6163  oose the ``broac
+00031c10: 6173 745f 6a6f 696e 6060 2063 6f64 6520  ast_join`` code 
+00031c20: 7061 7468 292e 2053 6565 2060 6062 726f  path). See ``bro
+00031c30: 6164 6361 7374 5f6a 6f69 6e60 600a 2020  adcast_join``.  
+00031c40: 2020 2020 2020 2020 2020 666f 7220 6d6f            for mo
+00031c50: 7265 2069 6e66 6f72 6d61 7469 6f6e 2e0a  re information..
+00031c60: 0a20 2020 2020 2020 204e 6f74 6573 0a20  .        Notes. 
+00031c70: 2020 2020 2020 202d 2d2d 2d2d 0a0a 2020         -----..  
+00031c80: 2020 2020 2020 5468 6572 6520 6172 6520        There are 
+00031c90: 7468 7265 6520 7761 7973 2074 6f20 6a6f  three ways to jo
+00031ca0: 696e 2064 6174 6166 7261 6d65 733a 0a0a  in dataframes:..
+00031cb0: 2020 2020 2020 2020 312e 204a 6f69 6e69          1. Joini
+00031cc0: 6e67 206f 6e20 696e 6469 6365 732e 2049  ng on indices. I
+00031cd0: 6e20 7468 6973 2063 6173 6520 7468 6520  n this case the 
+00031ce0: 6469 7669 7369 6f6e 7320 6172 650a 2020  divisions are.  
+00031cf0: 2020 2020 2020 2020 2061 6c69 676e 6564           aligned
+00031d00: 2075 7369 6e67 2074 6865 2066 756e 6374   using the funct
+00031d10: 696f 6e20 6060 6461 736b 2e64 6174 6166  ion ``dask.dataf
+00031d20: 7261 6d65 2e6d 756c 7469 2e61 6c69 676e  rame.multi.align
+00031d30: 5f70 6172 7469 7469 6f6e 7360 602e 0a20  _partitions``.. 
+00031d40: 2020 2020 2020 2020 2020 4166 7465 7277            Afterw
+00031d50: 6172 6473 2c20 6561 6368 2070 6172 7469  ards, each parti
+00031d60: 7469 6f6e 2069 7320 6d65 7267 6564 2077  tion is merged w
+00031d70: 6974 6820 7468 6520 7061 6e64 6173 206d  ith the pandas m
+00031d80: 6572 6765 2066 756e 6374 696f 6e2e 0a0a  erge function...
+00031d90: 2020 2020 2020 2020 322e 204a 6f69 6e69          2. Joini
+00031da0: 6e67 206f 6e65 206f 6e20 696e 6465 7820  ng one on index 
+00031db0: 616e 6420 6f6e 6520 6f6e 2063 6f6c 756d  and one on colum
+00031dc0: 6e2e 2049 6e20 7468 6973 2063 6173 6520  n. In this case 
+00031dd0: 7468 6520 6469 7669 7369 6f6e 7320 6f66  the divisions of
+00031de0: 0a20 2020 2020 2020 2020 2020 6461 7461  .           data
+00031df0: 6672 616d 6520 6d65 7267 6564 2062 7920  frame merged by 
+00031e00: 696e 6465 7820 283a 6d61 7468 3a60 645f  index (:math:`d_
+00031e10: 6960 2920 6172 6520 7573 6564 2074 6f20  i`) are used to 
+00031e20: 6469 7669 6465 2074 6865 2063 6f6c 756d  divide the colum
+00031e30: 6e0a 2020 2020 2020 2020 2020 206d 6572  n.           mer
+00031e40: 6765 6420 6461 7461 6672 616d 6520 283a  ged dataframe (:
+00031e50: 6d61 7468 3a60 645f 6360 2920 6f6e 6520  math:`d_c`) one 
+00031e60: 7573 696e 670a 2020 2020 2020 2020 2020  using.          
+00031e70: 2060 6064 6173 6b2e 6461 7461 6672 616d   ``dask.datafram
+00031e80: 652e 6d75 6c74 692e 7265 6172 7261 6e67  e.multi.rearrang
+00031e90: 655f 6279 5f64 6976 6973 696f 6e73 6060  e_by_divisions``
+00031ea0: 2e20 496e 2074 6869 7320 6361 7365 2074  . In this case t
+00031eb0: 6865 0a20 2020 2020 2020 2020 2020 6d65  he.           me
+00031ec0: 7267 6564 2064 6174 6166 7261 6d65 2028  rged dataframe (
+00031ed0: 3a6d 6174 683a 6064 5f6d 6029 2068 6173  :math:`d_m`) has
+00031ee0: 2074 6865 2065 7861 6374 2073 616d 6520   the exact same 
+00031ef0: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
+00031f00: 2020 2020 2061 7320 283a 6d61 7468 3a60       as (:math:`
+00031f10: 645f 6960 292e 2054 6869 7320 6361 6e20  d_i`). This can 
+00031f20: 6c65 6164 2074 6f20 6973 7375 6573 2069  lead to issues i
+00031f30: 6620 796f 7520 6d65 7267 6520 6d75 6c74  f you merge mult
+00031f40: 6970 6c65 2072 6f77 7320 6672 6f6d 0a20  iple rows from. 
+00031f50: 2020 2020 2020 2020 2020 283a 6d61 7468            (:math
+00031f60: 3a60 645f 6360 2920 746f 206f 6e65 2072  :`d_c`) to one r
+00031f70: 6f77 2069 6e20 283a 6d61 7468 3a60 645f  ow in (:math:`d_
+00031f80: 6960 292e 0a0a 2020 2020 2020 2020 332e  i`)...        3.
+00031f90: 204a 6f69 6e69 6e67 2062 6f74 6820 6f6e   Joining both on
+00031fa0: 2063 6f6c 756d 6e73 2e20 496e 2074 6869   columns. In thi
+00031fb0: 7320 6361 7365 2061 2068 6173 6820 6a6f  s case a hash jo
+00031fc0: 696e 2069 7320 7065 7266 6f72 6d65 6420  in is performed 
+00031fd0: 7573 696e 670a 2020 2020 2020 2020 2020  using.          
+00031fe0: 2060 6064 6173 6b2e 6461 7461 6672 616d   ``dask.datafram
+00031ff0: 652e 6d75 6c74 692e 6861 7368 5f6a 6f69  e.multi.hash_joi
+00032000: 6e60 602e 0a0a 2020 2020 2020 2020 496e  n``...        In
+00032010: 2073 6f6d 6520 6361 7365 732c 2079 6f75   some cases, you
+00032020: 206d 6179 2073 6565 2061 2060 604d 656d   may see a ``Mem
+00032030: 6f72 7945 7272 6f72 6060 2069 6620 7468  oryError`` if th
+00032040: 6520 6060 6d65 7267 6560 6020 6f70 6572  e ``merge`` oper
+00032050: 6174 696f 6e20 7265 7175 6972 6573 0a20  ation requires. 
+00032060: 2020 2020 2020 2061 6e20 696e 7465 726e         an intern
+00032070: 616c 2060 6073 6875 6666 6c65 6060 2c20  al ``shuffle``, 
+00032080: 6265 6361 7573 6520 7368 7566 666c 696e  because shufflin
+00032090: 6720 706c 6163 6573 2061 6c6c 2072 6f77  g places all row
+000320a0: 7320 7468 6174 2068 6176 6520 7468 6520  s that have the 
+000320b0: 7361 6d65 0a20 2020 2020 2020 2069 6e64  same.        ind
+000320c0: 6578 2069 6e20 7468 6520 7361 6d65 2070  ex in the same p
+000320d0: 6172 7469 7469 6f6e 2e20 546f 2061 766f  artition. To avo
+000320e0: 6964 2074 6869 7320 6572 726f 722c 206d  id this error, m
+000320f0: 616b 6520 7375 7265 2061 6c6c 2072 6f77  ake sure all row
+00032100: 7320 7769 7468 2074 6865 0a20 2020 2020  s with the.     
+00032110: 2020 2073 616d 6520 6060 6f6e 6060 2d63     same ``on``-c
+00032120: 6f6c 756d 6e20 7661 6c75 6520 6361 6e20  olumn value can 
+00032130: 6669 7420 6f6e 2061 2073 696e 676c 6520  fit on a single 
+00032140: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
+00032150: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00032160: 6966 206e 6f74 2069 735f 6461 7461 6672  if not is_datafr
+00032170: 616d 655f 6c69 6b65 2872 6967 6874 293a  ame_like(right):
+00032180: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00032190: 7365 2056 616c 7565 4572 726f 7228 2272  se ValueError("r
+000321a0: 6967 6874 206d 7573 7420 6265 2044 6174  ight must be Dat
+000321b0: 6146 7261 6d65 2229 0a0a 2020 2020 2020  aFrame")..      
+000321c0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+000321d0: 6672 616d 652e 6d75 6c74 6920 696d 706f  frame.multi impo
+000321e0: 7274 206d 6572 6765 0a0a 2020 2020 2020  rt merge..      
+000321f0: 2020 7265 7475 726e 206d 6572 6765 280a    return merge(.
+00032200: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00032210: 2c0a 2020 2020 2020 2020 2020 2020 7269  ,.            ri
+00032220: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
+00032230: 2068 6f77 3d68 6f77 2c0a 2020 2020 2020   how=how,.      
+00032240: 2020 2020 2020 6f6e 3d6f 6e2c 0a20 2020        on=on,.   
+00032250: 2020 2020 2020 2020 206c 6566 745f 6f6e           left_on
+00032260: 3d6c 6566 745f 6f6e 2c0a 2020 2020 2020  =left_on,.      
+00032270: 2020 2020 2020 7269 6768 745f 6f6e 3d72        right_on=r
+00032280: 6967 6874 5f6f 6e2c 0a20 2020 2020 2020  ight_on,.       
+00032290: 2020 2020 206c 6566 745f 696e 6465 783d       left_index=
+000322a0: 6c65 6674 5f69 6e64 6578 2c0a 2020 2020  left_index,.    
+000322b0: 2020 2020 2020 2020 7269 6768 745f 696e          right_in
+000322c0: 6465 783d 7269 6768 745f 696e 6465 782c  dex=right_index,
+000322d0: 0a20 2020 2020 2020 2020 2020 2073 7566  .            suf
+000322e0: 6669 7865 733d 7375 6666 6978 6573 2c0a  fixes=suffixes,.
+000322f0: 2020 2020 2020 2020 2020 2020 6e70 6172              npar
+00032300: 7469 7469 6f6e 733d 6e70 6172 7469 7469  titions=npartiti
+00032310: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
+00032320: 2069 6e64 6963 6174 6f72 3d69 6e64 6963   indicator=indic
+00032330: 6174 6f72 2c0a 2020 2020 2020 2020 2020  ator,.          
+00032340: 2020 7368 7566 666c 653d 7368 7566 666c    shuffle=shuffl
+00032350: 652c 0a20 2020 2020 2020 2020 2020 2062  e,.            b
+00032360: 726f 6164 6361 7374 3d62 726f 6164 6361  roadcast=broadca
+00032370: 7374 2c0a 2020 2020 2020 2020 290a 0a20  st,.        ).. 
+00032380: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00032390: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+000323a0: 2020 2064 6566 206a 6f69 6e28 0a20 2020     def join(.   
+000323b0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000323c0: 2020 206f 7468 6572 2c0a 2020 2020 2020     other,.      
+000323d0: 2020 6f6e 3d4e 6f6e 652c 0a20 2020 2020    on=None,.     
+000323e0: 2020 2068 6f77 3d22 6c65 6674 222c 0a20     how="left",. 
+000323f0: 2020 2020 2020 206c 7375 6666 6978 3d22         lsuffix="
+00032400: 222c 0a20 2020 2020 2020 2072 7375 6666  ",.        rsuff
+00032410: 6978 3d22 222c 0a20 2020 2020 2020 206e  ix="",.        n
+00032420: 7061 7274 6974 696f 6e73 3d4e 6f6e 652c  partitions=None,
+00032430: 0a20 2020 2020 2020 2073 6875 6666 6c65  .        shuffle
+00032440: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
+00032450: 2020 2020 2020 6966 2069 735f 7365 7269        if is_seri
+00032460: 6573 5f6c 696b 6528 6f74 6865 7229 2061  es_like(other) a
+00032470: 6e64 2068 6173 6174 7472 286f 7468 6572  nd hasattr(other
+00032480: 2c20 226e 616d 6522 293a 0a20 2020 2020  , "name"):.     
+00032490: 2020 2020 2020 206f 7468 6572 203d 206f         other = o
+000324a0: 7468 6572 2e74 6f5f 6672 616d 6528 290a  ther.to_frame().
+000324b0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+000324c0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+000324d0: 6528 6f74 6865 7229 3a0a 2020 2020 2020  e(other):.      
+000324e0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+000324f0: 6e73 7461 6e63 6528 6f74 6865 722c 206c  nstance(other, l
+00032500: 6973 7429 206f 7220 6e6f 7420 616c 6c28  ist) or not all(
+00032510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032520: 205b 6973 5f64 6174 6166 7261 6d65 5f6c   [is_dataframe_l
+00032530: 696b 6528 6f29 2066 6f72 206f 2069 6e20  ike(o) for o in 
+00032540: 6f74 6865 725d 0a20 2020 2020 2020 2020  other].         
+00032550: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00032560: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00032570: 6545 7272 6f72 2822 6f74 6865 7220 6d75  eError("other mu
+00032580: 7374 2062 6520 4461 7461 4672 616d 6520  st be DataFrame 
+00032590: 6f72 206c 6973 7420 6f66 2044 6174 6146  or list of DataF
+000325a0: 7261 6d65 7322 290a 2020 2020 2020 2020  rames").        
+000325b0: 2020 2020 6966 2068 6f77 206e 6f74 2069      if how not i
+000325c0: 6e20 5b22 6f75 7465 7222 2c20 226c 6566  n ["outer", "lef
+000325d0: 7422 5d3a 0a20 2020 2020 2020 2020 2020  t"]:.           
+000325e0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+000325f0: 4572 726f 7228 226d 6572 6765 5f6d 756c  Error("merge_mul
+00032600: 7469 206f 6e6c 7920 7375 7070 6f72 7473  ti only supports
+00032610: 206c 6566 7420 6f72 206f 7574 6572 206a   left or outer j
+00032620: 6f69 6e73 2229 0a0a 2020 2020 2020 2020  oins")..        
+00032630: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+00032640: 7461 6672 616d 652e 6d75 6c74 6920 696d  taframe.multi im
+00032650: 706f 7274 205f 7265 6375 7273 6976 655f  port _recursive_
+00032660: 7061 6972 7769 7365 5f6f 7574 6572 5f6a  pairwise_outer_j
+00032670: 6f69 6e0a 0a20 2020 2020 2020 2020 2020  oin..           
+00032680: 2023 2049 6620 6974 7320 616e 206f 7574   # If its an out
+00032690: 6572 206a 6f69 6e20 7765 2063 616e 2075  er join we can u
+000326a0: 7365 2074 6865 2066 756c 6c20 7265 6375  se the full recu
+000326b0: 7273 6976 6520 7061 6972 7769 7365 206a  rsive pairwise j
+000326c0: 6f69 6e2e 0a20 2020 2020 2020 2020 2020  oin..           
+000326d0: 2069 6620 686f 7720 3d3d 2022 6f75 7465   if how == "oute
+000326e0: 7222 3a0a 2020 2020 2020 2020 2020 2020  r":.            
+000326f0: 2020 2020 6675 6c6c 203d 205b 7365 6c66      full = [self
+00032700: 5d20 2b20 6f74 6865 720a 0a20 2020 2020  ] + other..     
+00032710: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00032720: 6e20 5f72 6563 7572 7369 7665 5f70 6169  n _recursive_pai
+00032730: 7277 6973 655f 6f75 7465 725f 6a6f 696e  rwise_outer_join
+00032740: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00032750: 2020 2020 2020 6675 6c6c 2c0a 2020 2020        full,.    
+00032760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032770: 6f6e 3d6f 6e2c 0a20 2020 2020 2020 2020  on=on,.         
+00032780: 2020 2020 2020 2020 2020 206c 7375 6666             lsuff
+00032790: 6978 3d6c 7375 6666 6978 2c0a 2020 2020  ix=lsuffix,.    
+000327a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000327b0: 7273 7566 6669 783d 7273 7566 6669 782c  rsuffix=rsuffix,
+000327c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000327d0: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+000327e0: 3d6e 7061 7274 6974 696f 6e73 2c0a 2020  =npartitions,.  
+000327f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032800: 2020 7368 7566 666c 653d 7368 7566 666c    shuffle=shuffl
+00032810: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00032820: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00032830: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00032840: 2020 2020 2020 2023 2044 6f20 7265 6375         # Do recu
+00032850: 7273 6976 6520 7061 6972 7769 7365 206a  rsive pairwise j
+00032860: 6f69 6e20 6f6e 2065 7665 7279 7468 696e  oin on everythin
+00032870: 6720 5f65 7863 6570 745f 2074 6865 206c  g _except_ the l
+00032880: 6173 7420 6a6f 696e 0a20 2020 2020 2020  ast join.       
+00032890: 2020 2020 2020 2020 2023 2077 6865 7265           # where
+000328a0: 2077 6520 6e65 6564 2074 6f20 646f 2061   we need to do a
+000328b0: 206c 6566 7420 6a6f 696e 2e0a 2020 2020   left join..    
+000328c0: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
+000328d0: 7220 3d20 5f72 6563 7572 7369 7665 5f70  r = _recursive_p
+000328e0: 6169 7277 6973 655f 6f75 7465 725f 6a6f  airwise_outer_jo
+000328f0: 696e 280a 2020 2020 2020 2020 2020 2020  in(.            
+00032900: 2020 2020 2020 2020 6f74 6865 722c 0a20          other,. 
 00032910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032920: 2072 7375 6666 6978 3d72 7375 6666 6978   rsuffix=rsuffix
-00032930: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00032940: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
-00032950: 733d 6e70 6172 7469 7469 6f6e 732c 0a20  s=npartitions,. 
-00032960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032970: 2020 2073 6875 6666 6c65 3d73 6875 6666     shuffle=shuff
-00032980: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
-00032990: 2020 2020 290a 0a20 2020 2020 2020 2066      )..        f
-000329a0: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-000329b0: 6d65 2e6d 756c 7469 2069 6d70 6f72 7420  me.multi import 
-000329c0: 6d65 7267 650a 0a20 2020 2020 2020 2072  merge..        r
-000329d0: 6574 7572 6e20 6d65 7267 6528 0a20 2020  eturn merge(.   
-000329e0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-000329f0: 2020 2020 2020 2020 2020 206f 7468 6572             other
-00032a00: 2c0a 2020 2020 2020 2020 2020 2020 686f  ,.            ho
-00032a10: 773d 686f 772c 0a20 2020 2020 2020 2020  w=how,.         
-00032a20: 2020 206c 6566 745f 696e 6465 783d 6f6e     left_index=on
-00032a30: 2069 7320 4e6f 6e65 2c0a 2020 2020 2020   is None,.      
-00032a40: 2020 2020 2020 7269 6768 745f 696e 6465        right_inde
-00032a50: 783d 5472 7565 2c0a 2020 2020 2020 2020  x=True,.        
-00032a60: 2020 2020 6c65 6674 5f6f 6e3d 6f6e 2c0a      left_on=on,.
-00032a70: 2020 2020 2020 2020 2020 2020 7375 6666              suff
-00032a80: 6978 6573 3d28 6c73 7566 6669 782c 2072  ixes=(lsuffix, r
-00032a90: 7375 6666 6978 292c 0a20 2020 2020 2020  suffix),.       
-00032aa0: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
-00032ab0: 3d6e 7061 7274 6974 696f 6e73 2c0a 2020  =npartitions,.  
-00032ac0: 2020 2020 2020 2020 2020 7368 7566 666c            shuffl
-00032ad0: 653d 7368 7566 666c 652c 0a20 2020 2020  e=shuffle,.     
-00032ae0: 2020 2029 0a0a 2020 2020 6966 206e 6f74     )..    if not
-00032af0: 2050 414e 4441 535f 4754 5f32 3030 3a0a   PANDAS_GT_200:.
-00032b00: 0a20 2020 2020 2020 2040 6465 7269 7665  .        @derive
-00032b10: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-00032b20: 616d 6529 0a20 2020 2020 2020 2064 6566  ame).        def
-00032b30: 2061 7070 656e 6428 7365 6c66 2c20 6f74   append(self, ot
-00032b40: 6865 722c 2069 6e74 6572 6c65 6176 655f  her, interleave_
-00032b50: 7061 7274 6974 696f 6e73 3d46 616c 7365  partitions=False
-00032b60: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00032b70: 6620 6973 696e 7374 616e 6365 286f 7468  f isinstance(oth
-00032b80: 6572 2c20 5365 7269 6573 293a 0a20 2020  er, Series):.   
-00032b90: 2020 2020 2020 2020 2020 2020 206d 7367               msg
-00032ba0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00032bb0: 2020 2020 2020 2020 2022 556e 6162 6c65           "Unable
-00032bc0: 2074 6f20 6170 7065 6e64 696e 6720 6464   to appending dd
-00032bd0: 2e53 6572 6965 7320 746f 2064 642e 4461  .Series to dd.Da
-00032be0: 7461 4672 616d 652e 220a 2020 2020 2020  taFrame.".      
-00032bf0: 2020 2020 2020 2020 2020 2020 2020 2255                "U
-00032c00: 7365 2070 642e 5365 7269 6573 2074 6f20  se pd.Series to 
-00032c10: 6170 7065 6e64 2061 7320 726f 772e 220a  append as row.".
-00032c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00032c40: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00032c50: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
-00032c60: 2020 2020 656c 6966 2069 735f 7365 7269      elif is_seri
-00032c70: 6573 5f6c 696b 6528 6f74 6865 7229 3a0a  es_like(other):.
-00032c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c90: 6f74 6865 7220 3d20 6f74 6865 722e 746f  other = other.to
-00032ca0: 5f66 7261 6d65 2829 2e54 0a20 2020 2020  _frame().T.     
-00032cb0: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
-00032cc0: 7065 7228 292e 6170 7065 6e64 286f 7468  per().append(oth
-00032cd0: 6572 2c20 696e 7465 726c 6561 7665 5f70  er, interleave_p
-00032ce0: 6172 7469 7469 6f6e 733d 696e 7465 726c  artitions=interl
-00032cf0: 6561 7665 5f70 6172 7469 7469 6f6e 7329  eave_partitions)
-00032d00: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00032d10: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-00032d20: 290a 2020 2020 6465 6620 6974 6572 726f  ).    def iterro
-00032d30: 7773 2873 656c 6629 3a0a 2020 2020 2020  ws(self):.      
-00032d40: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00032d50: 2873 656c 662e 6e70 6172 7469 7469 6f6e  (self.npartition
-00032d60: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00032d70: 6466 203d 2073 656c 662e 6765 745f 7061  df = self.get_pa
-00032d80: 7274 6974 696f 6e28 6929 2e63 6f6d 7075  rtition(i).compu
-00032d90: 7465 2829 0a20 2020 2020 2020 2020 2020  te().           
-00032da0: 2079 6965 6c64 2066 726f 6d20 6466 2e69   yield from df.i
-00032db0: 7465 7272 6f77 7328 290a 0a20 2020 2040  terrows()..    @
-00032dc0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00032dd0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00032de0: 6566 2069 7465 7274 7570 6c65 7328 7365  ef itertuples(se
-00032df0: 6c66 2c20 696e 6465 783d 5472 7565 2c20  lf, index=True, 
-00032e00: 6e61 6d65 3d22 5061 6e64 6173 2229 3a0a  name="Pandas"):.
-00032e10: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00032e20: 2072 616e 6765 2873 656c 662e 6e70 6172   range(self.npar
-00032e30: 7469 7469 6f6e 7329 3a0a 2020 2020 2020  titions):.      
-00032e40: 2020 2020 2020 6466 203d 2073 656c 662e        df = self.
-00032e50: 6765 745f 7061 7274 6974 696f 6e28 6929  get_partition(i)
-00032e60: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-00032e70: 2020 2020 2020 2079 6965 6c64 2066 726f         yield fro
-00032e80: 6d20 6466 2e69 7465 7274 7570 6c65 7328  m df.itertuples(
-00032e90: 696e 6465 783d 696e 6465 782c 206e 616d  index=index, nam
-00032ea0: 653d 6e61 6d65 290a 0a20 2020 2040 6465  e=name)..    @de
-00032eb0: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-00032ec0: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-00032ed0: 2069 7465 6d73 2873 656c 6629 3a0a 2020   items(self):.  
-00032ee0: 2020 2020 2020 666f 7220 636f 6c5f 6964        for col_id
-00032ef0: 782c 206c 6162 656c 2069 6e20 656e 756d  x, label in enum
-00032f00: 6572 6174 6528 7365 6c66 2e63 6f6c 756d  erate(self.colum
-00032f10: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
-00032f20: 2079 6965 6c64 206c 6162 656c 2c20 7365   yield label, se
-00032f30: 6c66 2e69 6c6f 635b 3a2c 2063 6f6c 5f69  lf.iloc[:, col_i
-00032f40: 6478 5d0a 0a20 2020 2040 636c 6173 736d  dx]..    @classm
-00032f50: 6574 686f 640a 2020 2020 6465 6620 5f62  ethod.    def _b
-00032f60: 696e 645f 6f70 6572 6174 6f72 5f6d 6574  ind_operator_met
-00032f70: 686f 6428 636c 732c 206e 616d 652c 206f  hod(cls, name, o
-00032f80: 702c 206f 7269 6769 6e61 6c3d 7064 2e44  p, original=pd.D
-00032f90: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
-00032fa0: 2020 2022 2222 6269 6e64 206f 7065 7261     """bind opera
-00032fb0: 746f 7220 6d65 7468 6f64 206c 696b 6520  tor method like 
-00032fc0: 4461 7461 4672 616d 652e 6164 6420 746f  DataFrame.add to
-00032fd0: 2074 6869 7320 636c 6173 7322 2222 0a0a   this class"""..
-00032fe0: 2020 2020 2020 2020 2320 6e61 6d65 206d          # name m
-00032ff0: 7573 7420 6265 2065 7870 6c69 6369 746c  ust be explicitl
-00033000: 7920 7061 7373 6564 2066 6f72 2064 6976  y passed for div
-00033010: 206d 6574 686f 6420 7768 6f73 6520 6e61   method whose na
-00033020: 6d65 2069 7320 7472 7565 6469 760a 0a20  me is truediv.. 
-00033030: 2020 2020 2020 2064 6566 206d 6574 6828         def meth(
-00033040: 7365 6c66 2c20 6f74 6865 722c 2061 7869  self, other, axi
-00033050: 733d 2263 6f6c 756d 6e73 222c 206c 6576  s="columns", lev
-00033060: 656c 3d4e 6f6e 652c 2066 696c 6c5f 7661  el=None, fill_va
-00033070: 6c75 653d 4e6f 6e65 293a 0a20 2020 2020  lue=None):.     
-00033080: 2020 2020 2020 2069 6620 6c65 7665 6c20         if level 
-00033090: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-000330a0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-000330b0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-000330c0: 6445 7272 6f72 2822 6c65 7665 6c20 6d75  dError("level mu
-000330d0: 7374 2062 6520 4e6f 6e65 2229 0a0a 2020  st be None")..  
-000330e0: 2020 2020 2020 2020 2020 6178 6973 203d            axis =
-000330f0: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-00033100: 6178 6973 2861 7869 7329 0a0a 2020 2020  axis(axis)..    
-00033110: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-00033120: 696e 2028 312c 2022 636f 6c75 6d6e 7322  in (1, "columns"
-00033130: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00033140: 2020 2023 2057 6865 6e20 6178 6973 3d31     # When axis=1
-00033150: 2061 6e64 206f 7468 6572 2069 7320 6120   and other is a 
-00033160: 7365 7269 6573 2c20 606f 7468 6572 6020  series, `other` 
-00033170: 6973 2074 7261 6e73 706f 7365 640a 2020  is transposed.  
-00033180: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00033190: 616e 6420 7468 6520 6f70 6572 6174 6f72  and the operator
-000331a0: 2069 7320 6170 706c 6965 6420 6272 6f61   is applied broa
-000331b0: 6463 6173 7420 6163 726f 7373 2072 6f77  dcast across row
-000331c0: 732e 2054 6869 730a 2020 2020 2020 2020  s. This.        
-000331d0: 2020 2020 2020 2020 2320 6973 6e27 7420          # isn't 
-000331e0: 7375 7070 6f72 7465 6420 7769 7468 2064  supported with d
-000331f0: 642e 5365 7269 6573 2e0a 2020 2020 2020  d.Series..      
-00033200: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00033210: 6e73 7461 6e63 6528 6f74 6865 722c 2053  nstance(other, S
-00033220: 6572 6965 7329 3a0a 2020 2020 2020 2020  eries):.        
-00033230: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
-00033240: 3d20 6622 556e 6162 6c65 2074 6f20 7b6e  = f"Unable to {n
-00033250: 616d 657d 2064 642e 5365 7269 6573 2077  ame} dd.Series w
-00033260: 6974 6820 6178 6973 3d31 220a 2020 2020  ith axis=1".    
-00033270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033280: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00033290: 286d 7367 290a 2020 2020 2020 2020 2020  (msg).          
-000332a0: 2020 2020 2020 656c 6966 2069 735f 7365        elif is_se
-000332b0: 7269 6573 5f6c 696b 6528 6f74 6865 7229  ries_like(other)
-000332c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000332d0: 2020 2020 2020 2320 5370 6563 6961 6c20        # Special 
-000332e0: 6361 7365 2066 6f72 2070 642e 5365 7269  case for pd.Seri
-000332f0: 6573 2074 6f20 6176 6f69 6420 756e 7761  es to avoid unwa
-00033300: 6e74 6564 2070 6172 7469 7469 6f6e 696e  nted partitionin
-00033310: 670a 2020 2020 2020 2020 2020 2020 2020  g.              
-00033320: 2020 2020 2020 2320 6f66 206f 7468 6572        # of other
-00033330: 2e20 5765 2070 6173 7320 6974 2069 6e20  . We pass it in 
-00033340: 6173 2061 206b 7761 7267 2074 6f20 7072  as a kwarg to pr
-00033350: 6576 656e 7420 7468 6973 2e0a 2020 2020  event this..    
-00033360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033370: 6d65 7461 203d 205f 656d 756c 6174 6528  meta = _emulate(
-00033380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033390: 2020 2020 2020 2020 206f 702c 2073 656c           op, sel
-000333a0: 662c 206f 7468 6572 3d6f 7468 6572 2c20  f, other=other, 
-000333b0: 6178 6973 3d61 7869 732c 2066 696c 6c5f  axis=axis, fill_
-000333c0: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
-000333d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000333e0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-000333f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00033400: 6e20 6d61 705f 7061 7274 6974 696f 6e73  n map_partitions
-00033410: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00033420: 2020 2020 2020 2020 2020 6f70 2c0a 2020            op,.  
-00033430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033440: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00033450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033460: 2020 2020 6f74 6865 723d 6f74 6865 722c      other=other,
-00033470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033480: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
-00033490: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-000334a0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-000334b0: 3d61 7869 732c 0a20 2020 2020 2020 2020  =axis,.         
-000334c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000334d0: 696c 6c5f 7661 6c75 653d 6669 6c6c 5f76  ill_value=fill_v
-000334e0: 616c 7565 2c0a 2020 2020 2020 2020 2020  alue,.          
-000334f0: 2020 2020 2020 2020 2020 2020 2020 656e                en
-00033500: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
-00033510: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00033520: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00033530: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-00033540: 5f65 6d75 6c61 7465 286f 702c 2073 656c  _emulate(op, sel
-00033550: 662c 206f 7468 6572 2c20 6178 6973 3d61  f, other, axis=a
-00033560: 7869 732c 2066 696c 6c5f 7661 6c75 653d  xis, fill_value=
-00033570: 6669 6c6c 5f76 616c 7565 290a 2020 2020  fill_value).    
-00033580: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-00033590: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-000335a0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000335b0: 702c 0a20 2020 2020 2020 2020 2020 2020  p,.             
-000335c0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-000335d0: 2020 2020 2020 2020 206f 7468 6572 2c0a           other,.
-000335e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000335f0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
-00033600: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-00033610: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-00033620: 2020 2020 2020 6669 6c6c 5f76 616c 7565        fill_value
-00033630: 3d66 696c 6c5f 7661 6c75 652c 0a20 2020  =fill_value,.   
-00033640: 2020 2020 2020 2020 2020 2020 2065 6e66               enf
-00033650: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-00033660: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00033670: 2029 0a0a 2020 2020 2020 2020 6d65 7468   )..        meth
-00033680: 2e5f 5f6e 616d 655f 5f20 3d20 6e61 6d65  .__name__ = name
-00033690: 0a20 2020 2020 2020 2073 6574 6174 7472  .        setattr
-000336a0: 2863 6c73 2c20 6e61 6d65 2c20 6465 7269  (cls, name, deri
-000336b0: 7665 645f 6672 6f6d 286f 7269 6769 6e61  ved_from(origina
-000336c0: 6c29 286d 6574 6829 290a 0a20 2020 2040  l)(meth))..    @
-000336d0: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
-000336e0: 6465 6620 5f62 696e 645f 636f 6d70 6172  def _bind_compar
-000336f0: 6973 6f6e 5f6d 6574 686f 6428 636c 732c  ison_method(cls,
-00033700: 206e 616d 652c 2063 6f6d 7061 7269 736f   name, compariso
-00033710: 6e2c 206f 7269 6769 6e61 6c3d 7064 2e44  n, original=pd.D
-00033720: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
-00033730: 2020 2022 2222 6269 6e64 2063 6f6d 7061     """bind compa
-00033740: 7269 736f 6e20 6d65 7468 6f64 206c 696b  rison method lik
-00033750: 6520 4461 7461 4672 616d 652e 6571 2074  e DataFrame.eq t
-00033760: 6f20 7468 6973 2063 6c61 7373 2222 220a  o this class""".
-00033770: 0a20 2020 2020 2020 2064 6566 206d 6574  .        def met
-00033780: 6828 7365 6c66 2c20 6f74 6865 722c 2061  h(self, other, a
-00033790: 7869 733d 2263 6f6c 756d 6e73 222c 206c  xis="columns", l
-000337a0: 6576 656c 3d4e 6f6e 6529 3a0a 2020 2020  evel=None):.    
-000337b0: 2020 2020 2020 2020 6966 206c 6576 656c          if level
-000337c0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-000337d0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000337e0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-000337f0: 6564 4572 726f 7228 226c 6576 656c 206d  edError("level m
-00033800: 7573 7420 6265 204e 6f6e 6522 290a 2020  ust be None").  
-00033810: 2020 2020 2020 2020 2020 6178 6973 203d            axis =
-00033820: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-00033830: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
-00033840: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
-00033850: 656d 7769 7365 2863 6f6d 7061 7269 736f  emwise(compariso
-00033860: 6e2c 2073 656c 662c 206f 7468 6572 2c20  n, self, other, 
-00033870: 6178 6973 3d61 7869 7329 0a0a 2020 2020  axis=axis)..    
-00033880: 2020 2020 6d65 7468 2e5f 5f6e 616d 655f      meth.__name_
-00033890: 5f20 3d20 6e61 6d65 0a20 2020 2020 2020  _ = name.       
-000338a0: 2073 6574 6174 7472 2863 6c73 2c20 6e61   setattr(cls, na
-000338b0: 6d65 2c20 6465 7269 7665 645f 6672 6f6d  me, derived_from
-000338c0: 286f 7269 6769 6e61 6c29 286d 6574 6829  (original)(meth)
-000338d0: 290a 0a20 2020 2040 696e 7365 7274 5f6d  )..    @insert_m
-000338e0: 6574 615f 7061 7261 6d5f 6465 7363 7269  eta_param_descri
-000338f0: 7074 696f 6e28 7061 643d 3132 290a 2020  ption(pad=12).  
-00033900: 2020 6465 6620 6170 706c 7928 0a20 2020    def apply(.   
-00033910: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00033920: 2020 2066 756e 632c 0a20 2020 2020 2020     func,.       
-00033930: 2061 7869 733d 302c 0a20 2020 2020 2020   axis=0,.       
-00033940: 2062 726f 6164 6361 7374 3d4e 6f6e 652c   broadcast=None,
-00033950: 0a20 2020 2020 2020 2072 6177 3d46 616c  .        raw=Fal
-00033960: 7365 2c0a 2020 2020 2020 2020 7265 6475  se,.        redu
-00033970: 6365 3d4e 6f6e 652c 0a20 2020 2020 2020  ce=None,.       
-00033980: 2061 7267 733d 2829 2c0a 2020 2020 2020   args=(),.      
-00033990: 2020 6d65 7461 3d6e 6f5f 6465 6661 756c    meta=no_defaul
-000339a0: 742c 0a20 2020 2020 2020 2072 6573 756c  t,.        resul
-000339b0: 745f 7479 7065 3d4e 6f6e 652c 0a20 2020  t_type=None,.   
-000339c0: 2020 2020 202a 2a6b 7764 732c 0a20 2020       **kwds,.   
-000339d0: 2029 3a0a 2020 2020 2020 2020 2222 2250   ):.        """P
-000339e0: 6172 616c 6c65 6c20 7665 7273 696f 6e20  arallel version 
-000339f0: 6f66 2070 616e 6461 732e 4461 7461 4672  of pandas.DataFr
-00033a00: 616d 652e 6170 706c 790a 0a20 2020 2020  ame.apply..     
-00033a10: 2020 2054 6869 7320 6d69 6d69 6373 2074     This mimics t
-00033a20: 6865 2070 616e 6461 7320 7665 7273 696f  he pandas versio
-00033a30: 6e20 6578 6365 7074 2066 6f72 2074 6865  n except for the
-00033a40: 2066 6f6c 6c6f 7769 6e67 3a0a 0a20 2020   following:..   
-00033a50: 2020 2020 2031 2e20 204f 6e6c 7920 6060       1.  Only ``
-00033a60: 6178 6973 3d31 6060 2069 7320 7375 7070  axis=1`` is supp
-00033a70: 6f72 7465 6420 2861 6e64 206d 7573 7420  orted (and must 
-00033a80: 6265 2073 7065 6369 6669 6564 2065 7870  be specified exp
-00033a90: 6c69 6369 746c 7929 2e0a 2020 2020 2020  licitly)..      
-00033aa0: 2020 322e 2020 5468 6520 7573 6572 2073    2.  The user s
-00033ab0: 686f 756c 6420 7072 6f76 6964 6520 6f75  hould provide ou
-00033ac0: 7470 7574 206d 6574 6164 6174 6120 7669  tput metadata vi
-00033ad0: 6120 7468 6520 606d 6574 6160 206b 6579  a the `meta` key
-00033ae0: 776f 7264 2e0a 0a20 2020 2020 2020 2050  word...        P
-00033af0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00033b00: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00033b10: 2020 2020 2066 756e 6320 3a20 6675 6e63       func : func
-00033b20: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-00033b30: 2046 756e 6374 696f 6e20 746f 2061 7070   Function to app
-00033b40: 6c79 2074 6f20 6561 6368 2063 6f6c 756d  ly to each colum
-00033b50: 6e2f 726f 770a 2020 2020 2020 2020 6178  n/row.        ax
-00033b60: 6973 203a 207b 3020 6f72 2027 696e 6465  is : {0 or 'inde
-00033b70: 7827 2c20 3120 6f72 2027 636f 6c75 6d6e  x', 1 or 'column
-00033b80: 7327 7d2c 2064 6566 6175 6c74 2030 0a20  s'}, default 0. 
-00033b90: 2020 2020 2020 2020 2020 202d 2030 206f             - 0 o
-00033ba0: 7220 2769 6e64 6578 273a 2061 7070 6c79  r 'index': apply
-00033bb0: 2066 756e 6374 696f 6e20 746f 2065 6163   function to eac
-00033bc0: 6820 636f 6c75 6d6e 2028 4e4f 5420 5355  h column (NOT SU
-00033bd0: 5050 4f52 5445 4429 0a20 2020 2020 2020  PPORTED).       
-00033be0: 2020 2020 202d 2031 206f 7220 2763 6f6c       - 1 or 'col
-00033bf0: 756d 6e73 273a 2061 7070 6c79 2066 756e  umns': apply fun
-00033c00: 6374 696f 6e20 746f 2065 6163 6820 726f  ction to each ro
-00033c10: 770a 2020 2020 2020 2020 244d 4554 410a  w.        $META.
-00033c20: 2020 2020 2020 2020 6172 6773 203a 2074          args : t
-00033c30: 7570 6c65 0a20 2020 2020 2020 2020 2020  uple.           
-00033c40: 2050 6f73 6974 696f 6e61 6c20 6172 6775   Positional argu
-00033c50: 6d65 6e74 7320 746f 2070 6173 7320 746f  ments to pass to
-00033c60: 2066 756e 6374 696f 6e20 696e 2061 6464   function in add
-00033c70: 6974 696f 6e20 746f 2074 6865 2061 7272  ition to the arr
-00033c80: 6179 2f73 6572 6965 730a 0a20 2020 2020  ay/series..     
-00033c90: 2020 2041 6464 6974 696f 6e61 6c20 6b65     Additional ke
-00033ca0: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
-00033cb0: 7769 6c6c 2062 6520 7061 7373 6564 2061  will be passed a
-00033cc0: 7320 6b65 7977 6f72 6473 2074 6f20 7468  s keywords to th
-00033cd0: 6520 6675 6e63 7469 6f6e 0a0a 2020 2020  e function..    
-00033ce0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00033cf0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00033d00: 2020 2020 6170 706c 6965 6420 3a20 5365      applied : Se
-00033d10: 7269 6573 206f 7220 4461 7461 4672 616d  ries or DataFram
-00033d20: 650a 0a20 2020 2020 2020 2045 7861 6d70  e..        Examp
-00033d30: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
-00033d40: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
-00033d50: 2069 6d70 6f72 7420 7061 6e64 6173 2061   import pandas a
-00033d60: 7320 7064 0a20 2020 2020 2020 203e 3e3e  s pd.        >>>
-00033d70: 2069 6d70 6f72 7420 6461 736b 2e64 6174   import dask.dat
-00033d80: 6166 7261 6d65 2061 7320 6464 0a20 2020  aframe as dd.   
-00033d90: 2020 2020 203e 3e3e 2064 6620 3d20 7064       >>> df = pd
-00033da0: 2e44 6174 6146 7261 6d65 287b 2778 273a  .DataFrame({'x':
-00033db0: 205b 312c 2032 2c20 332c 2034 2c20 355d   [1, 2, 3, 4, 5]
-00033dc0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00033dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033de0: 2027 7927 3a20 5b31 2e2c 2032 2e2c 2033   'y': [1., 2., 3
-00033df0: 2e2c 2034 2e2c 2035 2e5d 7d29 0a20 2020  ., 4., 5.]}).   
-00033e00: 2020 2020 203e 3e3e 2064 6466 203d 2064       >>> ddf = d
-00033e10: 642e 6672 6f6d 5f70 616e 6461 7328 6466  d.from_pandas(df
-00033e20: 2c20 6e70 6172 7469 7469 6f6e 733d 3229  , npartitions=2)
-00033e30: 0a0a 2020 2020 2020 2020 4170 706c 7920  ..        Apply 
-00033e40: 6120 6675 6e63 7469 6f6e 2074 6f20 726f  a function to ro
-00033e50: 772d 7769 7365 2070 6173 7369 6e67 2069  w-wise passing i
-00033e60: 6e20 6578 7472 6120 6172 6775 6d65 6e74  n extra argument
-00033e70: 7320 696e 2060 6061 7267 7360 6020 616e  s in ``args`` an
-00033e80: 640a 2020 2020 2020 2020 6060 6b77 6172  d.        ``kwar
-00033e90: 6773 6060 3a0a 0a20 2020 2020 2020 203e  gs``:..        >
-00033ea0: 3e3e 2064 6566 206d 7961 6464 2872 6f77  >> def myadd(row
-00033eb0: 2c20 612c 2062 3d31 293a 0a20 2020 2020  , a, b=1):.     
-00033ec0: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
-00033ed0: 6e20 726f 772e 7375 6d28 2920 2b20 6120  n row.sum() + a 
-00033ee0: 2b20 620a 2020 2020 2020 2020 3e3e 3e20  + b.        >>> 
-00033ef0: 7265 7320 3d20 6464 662e 6170 706c 7928  res = ddf.apply(
-00033f00: 6d79 6164 642c 2061 7869 733d 312c 2061  myadd, axis=1, a
-00033f10: 7267 733d 2832 2c29 2c20 623d 312e 3529  rgs=(2,), b=1.5)
-00033f20: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
-00033f30: 4950 0a0a 2020 2020 2020 2020 4279 2064  IP..        By d
-00033f40: 6566 6175 6c74 2c20 6461 736b 2074 7269  efault, dask tri
-00033f50: 6573 2074 6f20 696e 6665 7220 7468 6520  es to infer the 
-00033f60: 6f75 7470 7574 206d 6574 6164 6174 6120  output metadata 
-00033f70: 6279 2072 756e 6e69 6e67 2079 6f75 720a  by running your.
-00033f80: 2020 2020 2020 2020 7072 6f76 6964 6564          provided
-00033f90: 2066 756e 6374 696f 6e20 6f6e 2073 6f6d   function on som
-00033fa0: 6520 6661 6b65 2064 6174 612e 2054 6869  e fake data. Thi
-00033fb0: 7320 776f 726b 7320 7765 6c6c 2069 6e20  s works well in 
-00033fc0: 6d61 6e79 2063 6173 6573 2c20 6275 740a  many cases, but.
-00033fd0: 2020 2020 2020 2020 6361 6e20 736f 6d65          can some
-00033fe0: 7469 6d65 7320 6265 2065 7870 656e 7369  times be expensi
-00033ff0: 7665 2c20 6f72 2065 7665 6e20 6661 696c  ve, or even fail
-00034000: 2e20 546f 2061 766f 6964 2074 6869 732c  . To avoid this,
-00034010: 2079 6f75 2063 616e 0a20 2020 2020 2020   you can.       
-00034020: 206d 616e 7561 6c6c 7920 7370 6563 6966   manually specif
-00034030: 7920 7468 6520 6f75 7470 7574 206d 6574  y the output met
-00034040: 6164 6174 6120 7769 7468 2074 6865 2060  adata with the `
-00034050: 606d 6574 6160 6020 6b65 7977 6f72 642e  `meta`` keyword.
-00034060: 2054 6869 730a 2020 2020 2020 2020 6361   This.        ca
-00034070: 6e20 6265 2073 7065 6369 6669 6564 2069  n be specified i
-00034080: 6e20 6d61 6e79 2066 6f72 6d73 2c20 666f  n many forms, fo
-00034090: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
-000340a0: 6f6e 2073 6565 0a20 2020 2020 2020 2060  on see.        `
-000340b0: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
-000340c0: 7574 696c 732e 6d61 6b65 5f6d 6574 6160  utils.make_meta`
-000340d0: 602e 0a0a 2020 2020 2020 2020 4865 7265  `...        Here
-000340e0: 2077 6520 7370 6563 6966 7920 7468 6520   we specify the 
-000340f0: 6f75 7470 7574 2069 7320 6120 5365 7269  output is a Seri
-00034100: 6573 2077 6974 6820 6e61 6d65 2060 6027  es with name ``'
-00034110: 7827 6060 2c20 616e 6420 6474 7970 650a  x'``, and dtype.
-00034120: 2020 2020 2020 2020 6060 666c 6f61 7436          ``float6
-00034130: 3460 603a 0a0a 2020 2020 2020 2020 3e3e  4``:..        >>
-00034140: 3e20 7265 7320 3d20 6464 662e 6170 706c  > res = ddf.appl
-00034150: 7928 6d79 6164 642c 2061 7869 733d 312c  y(myadd, axis=1,
-00034160: 2061 7267 733d 2832 2c29 2c20 623d 312e   args=(2,), b=1.
-00034170: 352c 206d 6574 613d 2827 7827 2c20 2766  5, meta=('x', 'f
-00034180: 3827 2929 0a0a 2020 2020 2020 2020 496e  8'))..        In
-00034190: 2074 6865 2063 6173 6520 7768 6572 6520   the case where 
-000341a0: 7468 6520 6d65 7461 6461 7461 2064 6f65  the metadata doe
-000341b0: 736e 2774 2063 6861 6e67 652c 2079 6f75  sn't change, you
-000341c0: 2063 616e 2061 6c73 6f20 7061 7373 2069   can also pass i
-000341d0: 6e0a 2020 2020 2020 2020 7468 6520 6f62  n.        the ob
-000341e0: 6a65 6374 2069 7473 656c 6620 6469 7265  ject itself dire
-000341f0: 6374 6c79 3a0a 0a20 2020 2020 2020 203e  ctly:..        >
-00034200: 3e3e 2072 6573 203d 2064 6466 2e61 7070  >> res = ddf.app
-00034210: 6c79 286c 616d 6264 6120 726f 773a 2072  ly(lambda row: r
-00034220: 6f77 202b 2031 2c20 6178 6973 3d31 2c20  ow + 1, axis=1, 
-00034230: 6d65 7461 3d64 6466 290a 0a20 2020 2020  meta=ddf)..     
-00034240: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-00034250: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00034260: 2020 2020 2064 6173 6b2e 4461 7461 4672       dask.DataFr
-00034270: 616d 652e 6d61 705f 7061 7274 6974 696f  ame.map_partitio
-00034280: 6e73 0a20 2020 2020 2020 2022 2222 0a0a  ns.        """..
-00034290: 2020 2020 2020 2020 6966 2062 726f 6164          if broad
-000342a0: 6361 7374 2069 7320 6e6f 7420 4e6f 6e65  cast is not None
-000342b0: 3a0a 2020 2020 2020 2020 2020 2020 7761  :.            wa
-000342c0: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
-000342d0: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
-000342e0: 6520 6062 726f 6164 6361 7374 6020 6172  e `broadcast` ar
-000342f0: 6775 6d65 6e74 2069 7320 6e6f 206c 6f6e  gument is no lon
-00034300: 6765 7220 7573 6564 2f73 7570 706f 7274  ger used/support
-00034310: 6564 2e20 220a 2020 2020 2020 2020 2020  ed. ".          
-00034320: 2020 2020 2020 2249 7420 7769 6c6c 2062        "It will b
-00034330: 6520 6472 6f70 7065 6420 696e 2061 2066  e dropped in a f
-00034340: 7574 7572 6520 7265 6c65 6173 652e 222c  uture release.",
-00034350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034360: 2063 6174 6567 6f72 793d 4675 7475 7265   category=Future
-00034370: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
-00034380: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00034390: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
-000343a0: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
-000343b0: 0a20 2020 2020 2020 2070 616e 6461 735f  .        pandas_
-000343c0: 6b77 6172 6773 203d 207b 2261 7869 7322  kwargs = {"axis"
-000343d0: 3a20 6178 6973 2c20 2272 6177 223a 2072  : axis, "raw": r
-000343e0: 6177 2c20 2272 6573 756c 745f 7479 7065  aw, "result_type
-000343f0: 223a 2072 6573 756c 745f 7479 7065 7d0a  ": result_type}.
-00034400: 0a20 2020 2020 2020 206b 7764 732e 7570  .        kwds.up
-00034410: 6461 7465 2870 616e 6461 735f 6b77 6172  date(pandas_kwar
-00034420: 6773 290a 0a20 2020 2020 2020 2069 6620  gs)..        if 
-00034430: 6178 6973 203d 3d20 303a 0a20 2020 2020  axis == 0:.     
-00034440: 2020 2020 2020 206d 7367 203d 2028 0a20         msg = (. 
-00034450: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00034460: 6464 2e44 6174 6146 7261 6d65 2e61 7070  dd.DataFrame.app
-00034470: 6c79 206f 6e6c 7920 7375 7070 6f72 7473  ly only supports
-00034480: 2061 7869 733d 315c 6e22 0a20 2020 2020   axis=1\n".     
-00034490: 2020 2020 2020 2020 2020 2022 2020 5472             "  Tr
-000344a0: 793a 2064 662e 6170 706c 7928 6675 6e63  y: df.apply(func
-000344b0: 2c20 6178 6973 3d31 2922 0a20 2020 2020  , axis=1)".     
-000344c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000344d0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-000344e0: 706c 656d 656e 7465 6445 7272 6f72 286d  plementedError(m
-000344f0: 7367 290a 0a20 2020 2020 2020 2069 6620  sg)..        if 
-00034500: 6d65 7461 2069 7320 6e6f 5f64 6566 6175  meta is no_defau
-00034510: 6c74 3a0a 2020 2020 2020 2020 2020 2020  lt:.            
-00034520: 6d65 7461 203d 205f 656d 756c 6174 6528  meta = _emulate(
-00034530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034540: 204d 2e61 7070 6c79 2c20 7365 6c66 2e5f   M.apply, self._
-00034550: 6d65 7461 5f6e 6f6e 656d 7074 792c 2066  meta_nonempty, f
-00034560: 756e 632c 2061 7267 733d 6172 6773 2c20  unc, args=args, 
-00034570: 7564 663d 5472 7565 2c20 2a2a 6b77 6473  udf=True, **kwds
-00034580: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00034590: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-000345a0: 6e67 732e 7761 726e 286d 6574 615f 7761  ngs.warn(meta_wa
-000345b0: 726e 696e 6728 6d65 7461 2929 0a20 2020  rning(meta)).   
-000345c0: 2020 2020 206b 7764 732e 7570 6461 7465       kwds.update
-000345d0: 287b 2270 6172 656e 745f 6d65 7461 223a  ({"parent_meta":
-000345e0: 2073 656c 662e 5f6d 6574 617d 290a 2020   self._meta}).  
-000345f0: 2020 2020 2020 7265 7475 726e 206d 6170        return map
-00034600: 5f70 6172 7469 7469 6f6e 7328 4d2e 6170  _partitions(M.ap
-00034610: 706c 792c 2073 656c 662c 2066 756e 632c  ply, self, func,
-00034620: 2061 7267 733d 6172 6773 2c20 6d65 7461   args=args, meta
-00034630: 3d6d 6574 612c 202a 2a6b 7764 7329 0a0a  =meta, **kwds)..
-00034640: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00034650: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-00034660: 2020 2020 6465 6620 6170 706c 796d 6170      def applymap
-00034670: 2873 656c 662c 2066 756e 632c 206d 6574  (self, func, met
-00034680: 613d 225f 5f6e 6f5f 6465 6661 756c 745f  a="__no_default_
-00034690: 5f22 293a 0a20 2020 2020 2020 2072 6574  _"):.        ret
-000346a0: 7572 6e20 656c 656d 7769 7365 284d 2e61  urn elemwise(M.a
-000346b0: 7070 6c79 6d61 702c 2073 656c 662c 2066  pplymap, self, f
-000346c0: 756e 632c 206d 6574 613d 6d65 7461 290a  unc, meta=meta).
-000346d0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-000346e0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-000346f0: 0a20 2020 2064 6566 2072 6f75 6e64 2873  .    def round(s
-00034700: 656c 662c 2064 6563 696d 616c 733d 3029  elf, decimals=0)
-00034710: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00034720: 2065 6c65 6d77 6973 6528 4d2e 726f 756e   elemwise(M.roun
-00034730: 642c 2073 656c 662c 2064 6563 696d 616c  d, self, decimal
-00034740: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
-00034750: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-00034760: 6d65 290a 2020 2020 6465 6620 6e75 6e69  me).    def nuni
-00034770: 7175 6528 7365 6c66 2c20 7370 6c69 745f  que(self, split_
-00034780: 6576 6572 793d 4661 6c73 652c 2064 726f  every=False, dro
-00034790: 706e 613d 5472 7565 2c20 6178 6973 3d30  pna=True, axis=0
-000347a0: 293a 0a20 2020 2020 2020 2069 6620 6178  ):.        if ax
-000347b0: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
-000347c0: 2020 2020 2023 2073 706c 6974 5f65 7665       # split_eve
-000347d0: 7279 206e 6f74 2075 7365 6420 666f 7220  ry not used for 
-000347e0: 6178 6973 3d31 0a20 2020 2020 2020 2020  axis=1.         
-000347f0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
-00034800: 6d65 7461 5f6e 6f6e 656d 7074 792e 6e75  meta_nonempty.nu
-00034810: 6e69 7175 6528 6178 6973 3d61 7869 7329  nique(axis=axis)
-00034820: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00034830: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
-00034840: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-00034850: 2020 2020 2020 2020 204d 2e6e 756e 6971           M.nuniq
-00034860: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-00034870: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
-00034880: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00034890: 6f6b 656e 3d22 7365 7269 6573 2d6e 756e  oken="series-nun
-000348a0: 6971 7565 222c 0a20 2020 2020 2020 2020  ique",.         
-000348b0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
-000348c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000348d0: 2020 6472 6f70 6e61 3d64 726f 706e 612c    dropna=dropna,
-000348e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000348f0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-00034900: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
-00034910: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-00034920: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00034930: 206e 756e 6971 7565 5f6c 6973 7420 3d20   nunique_list = 
-00034940: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00034950: 2020 7365 6c66 5b63 6f6c 5d2e 6e75 6e69    self[col].nuni
-00034960: 7175 6528 7370 6c69 745f 6576 6572 793d  que(split_every=
-00034970: 7370 6c69 745f 6576 6572 792c 2064 726f  split_every, dro
-00034980: 706e 613d 6472 6f70 6e61 290a 2020 2020  pna=dropna).    
-00034990: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000349a0: 636f 6c20 696e 2073 656c 662e 636f 6c75  col in self.colu
-000349b0: 6d6e 730a 2020 2020 2020 2020 2020 2020  mns.            
-000349c0: 5d0a 2020 2020 2020 2020 2020 2020 6e61  ].            na
-000349d0: 6d65 203d 2022 7365 7269 6573 2d22 202b  me = "series-" +
-000349e0: 2074 6f6b 656e 697a 6528 2a6e 756e 6971   tokenize(*nuniq
-000349f0: 7565 5f6c 6973 7429 0a20 2020 2020 2020  ue_list).       
-00034a00: 2020 2020 2064 736b 203d 207b 0a20 2020       dsk = {.   
-00034a10: 2020 2020 2020 2020 2020 2020 2028 6e61               (na
-00034a20: 6d65 2c20 3029 3a20 280a 2020 2020 2020  me, 0): (.      
-00034a30: 2020 2020 2020 2020 2020 2020 2020 6170                ap
-00034a40: 706c 792c 0a20 2020 2020 2020 2020 2020  ply,.           
-00034a50: 2020 2020 2020 2020 2070 642e 5365 7269           pd.Seri
-00034a60: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-00034a70: 2020 2020 2020 2020 5b5b 2873 2e5f 6e61          [[(s._na
-00034a80: 6d65 2c20 3029 2066 6f72 2073 2069 6e20  me, 0) for s in 
-00034a90: 6e75 6e69 7175 655f 6c69 7374 5d5d 2c0a  nunique_list]],.
-00034aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ab0: 2020 2020 7b22 696e 6465 7822 3a20 7365      {"index": se
-00034ac0: 6c66 2e63 6f6c 756d 6e73 7d2c 0a20 2020  lf.columns},.   
-00034ad0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00034ae0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-00034af0: 2020 2020 2020 2020 2067 7261 7068 203d           graph =
-00034b00: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-00034b10: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-00034b20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00034b30: 2020 6e61 6d65 2c20 6473 6b2c 2064 6570    name, dsk, dep
-00034b40: 656e 6465 6e63 6965 733d 6e75 6e69 7175  endencies=nuniqu
-00034b50: 655f 6c69 7374 0a20 2020 2020 2020 2020  e_list.         
-00034b60: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00034b70: 2072 6574 7572 6e20 5365 7269 6573 2867   return Series(g
-00034b80: 7261 7068 2c20 6e61 6d65 2c20 7365 6c66  raph, name, self
-00034b90: 2e5f 6d65 7461 2e6e 756e 6971 7565 2829  ._meta.nunique()
-00034ba0: 2c20 284e 6f6e 652c 204e 6f6e 6529 290a  , (None, None)).
-00034bb0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00034bc0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-00034bd0: 0a20 2020 2064 6566 206d 6f64 6528 7365  .    def mode(se
-00034be0: 6c66 2c20 6472 6f70 6e61 3d54 7275 652c  lf, dropna=True,
-00034bf0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-00034c00: 7365 293a 0a20 2020 2020 2020 206d 6f64  se):.        mod
-00034c10: 655f 7365 7269 6573 5f6c 6973 7420 3d20  e_series_list = 
-00034c20: 5b5d 0a20 2020 2020 2020 2066 6f72 2063  [].        for c
-00034c30: 6f6c 5f69 6e64 6578 2069 6e20 7261 6e67  ol_index in rang
-00034c40: 6528 6c65 6e28 7365 6c66 2e63 6f6c 756d  e(len(self.colum
-00034c50: 6e73 2929 3a0a 2020 2020 2020 2020 2020  ns)):.          
-00034c60: 2020 636f 6c5f 7365 7269 6573 203d 2073    col_series = s
-00034c70: 656c 662e 696c 6f63 5b3a 2c20 636f 6c5f  elf.iloc[:, col_
-00034c80: 696e 6465 785d 0a20 2020 2020 2020 2020  index].         
-00034c90: 2020 206d 6f64 655f 7365 7269 6573 203d     mode_series =
-00034ca0: 2053 6572 6965 732e 6d6f 6465 280a 2020   Series.mode(.  
-00034cb0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00034cc0: 6c5f 7365 7269 6573 2c20 6472 6f70 6e61  l_series, dropna
-00034cd0: 3d64 726f 706e 612c 2073 706c 6974 5f65  =dropna, split_e
-00034ce0: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00034cf0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00034d00: 2020 2020 2020 2020 2020 206d 6f64 655f             mode_
-00034d10: 7365 7269 6573 5f6c 6973 742e 6170 7065  series_list.appe
-00034d20: 6e64 286d 6f64 655f 7365 7269 6573 290a  nd(mode_series).
-00034d30: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
-00034d40: 2263 6f6e 6361 742d 2220 2b20 746f 6b65  "concat-" + toke
-00034d50: 6e69 7a65 282a 6d6f 6465 5f73 6572 6965  nize(*mode_serie
-00034d60: 735f 6c69 7374 290a 0a20 2020 2020 2020  s_list)..       
-00034d70: 2064 736b 203d 207b 0a20 2020 2020 2020   dsk = {.       
-00034d80: 2020 2020 2028 6e61 6d65 2c20 3029 3a20       (name, 0): 
-00034d90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00034da0: 2020 6170 706c 792c 0a20 2020 2020 2020    apply,.       
-00034db0: 2020 2020 2020 2020 206d 6574 686f 6473           methods
-00034dc0: 2e63 6f6e 6361 742c 0a20 2020 2020 2020  .concat,.       
-00034dd0: 2020 2020 2020 2020 205b 5b28 6466 2e5f           [[(df._
-00034de0: 6e61 6d65 2c20 3029 2066 6f72 2064 6620  name, 0) for df 
-00034df0: 696e 206d 6f64 655f 7365 7269 6573 5f6c  in mode_series_l
-00034e00: 6973 745d 5d2c 0a20 2020 2020 2020 2020  ist]],.         
-00034e10: 2020 2020 2020 207b 2261 7869 7322 3a20         {"axis": 
-00034e20: 317d 2c0a 2020 2020 2020 2020 2020 2020  1},.            
-00034e30: 290a 2020 2020 2020 2020 7d0a 0a20 2020  ).        }..   
-00034e40: 2020 2020 206d 6574 6120 3d20 6d65 7468       meta = meth
-00034e50: 6f64 732e 636f 6e63 6174 285b 6466 2e5f  ods.concat([df._
-00034e60: 6d65 7461 2066 6f72 2064 6620 696e 206d  meta for df in m
-00034e70: 6f64 655f 7365 7269 6573 5f6c 6973 745d  ode_series_list]
-00034e80: 2c20 6178 6973 3d31 290a 2020 2020 2020  , axis=1).      
-00034e90: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-00034ea0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-00034eb0: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
-00034ec0: 2020 2020 2020 206e 616d 652c 2064 736b         name, dsk
-00034ed0: 2c20 6465 7065 6e64 656e 6369 6573 3d6d  , dependencies=m
-00034ee0: 6f64 655f 7365 7269 6573 5f6c 6973 740a  ode_series_list.
-00034ef0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00034f00: 2020 6464 6620 3d20 6e65 775f 6464 5f6f    ddf = new_dd_o
-00034f10: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
-00034f20: 652c 206d 6574 612c 2064 6976 6973 696f  e, meta, divisio
-00034f30: 6e73 3d28 4e6f 6e65 2c20 4e6f 6e65 2929  ns=(None, None))
-00034f40: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00034f50: 2064 6466 0a0a 2020 2020 4064 6572 6976   ddf..    @deriv
-00034f60: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00034f70: 7261 6d65 290a 2020 2020 6465 6620 636f  rame).    def co
-00034f80: 7628 7365 6c66 2c20 6d69 6e5f 7065 7269  v(self, min_peri
-00034f90: 6f64 733d 4e6f 6e65 2c20 6e75 6d65 7269  ods=None, numeri
-00034fa0: 635f 6f6e 6c79 3d6e 6f5f 6465 6661 756c  c_only=no_defaul
-00034fb0: 742c 2073 706c 6974 5f65 7665 7279 3d46  t, split_every=F
-00034fc0: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
-00034fd0: 6574 7572 6e20 5f63 6f76 5f63 6f72 7228  eturn _cov_corr(
-00034fe0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00034ff0: 662c 206d 696e 5f70 6572 696f 6473 2c20  f, min_periods, 
-00035000: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 756d  numeric_only=num
-00035010: 6572 6963 5f6f 6e6c 792c 2073 706c 6974  eric_only, split
-00035020: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-00035030: 7279 0a20 2020 2020 2020 2029 0a0a 2020  ry.        )..  
-00035040: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00035050: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00035060: 2020 6465 6620 636f 7272 280a 2020 2020    def corr(.    
-00035070: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00035080: 2020 6d65 7468 6f64 3d22 7065 6172 736f    method="pearso
-00035090: 6e22 2c0a 2020 2020 2020 2020 6d69 6e5f  n",.        min_
-000350a0: 7065 7269 6f64 733d 4e6f 6e65 2c0a 2020  periods=None,.  
-000350b0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
-000350c0: 6c79 3d6e 6f5f 6465 6661 756c 742c 0a20  ly=no_default,. 
-000350d0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-000350e0: 7279 3d46 616c 7365 2c0a 2020 2020 293a  ry=False,.    ):
-000350f0: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
-00035100: 6f64 2021 3d20 2270 6561 7273 6f6e 223a  od != "pearson":
-00035110: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00035120: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00035130: 6445 7272 6f72 2822 4f6e 6c79 2050 6561  dError("Only Pea
-00035140: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
-00035150: 2068 6173 2062 6565 6e20 696d 706c 656d   has been implem
-00035160: 656e 7465 6422 290a 0a20 2020 2020 2020  ented")..       
-00035170: 2072 6574 7572 6e20 5f63 6f76 5f63 6f72   return _cov_cor
-00035180: 7228 0a20 2020 2020 2020 2020 2020 2073  r(.            s
-00035190: 656c 662c 206d 696e 5f70 6572 696f 6473  elf, min_periods
-000351a0: 2c20 5472 7565 2c20 6e75 6d65 7269 635f  , True, numeric_
-000351b0: 6f6e 6c79 3d6e 756d 6572 6963 5f6f 6e6c  only=numeric_onl
-000351c0: 792c 2073 706c 6974 5f65 7665 7279 3d73  y, split_every=s
-000351d0: 706c 6974 5f65 7665 7279 0a20 2020 2020  plit_every.     
-000351e0: 2020 2029 0a0a 2020 2020 6465 6620 696e     )..    def in
-000351f0: 666f 2873 656c 662c 2062 7566 3d4e 6f6e  fo(self, buf=Non
-00035200: 652c 2076 6572 626f 7365 3d46 616c 7365  e, verbose=False
-00035210: 2c20 6d65 6d6f 7279 5f75 7361 6765 3d46  , memory_usage=F
-00035220: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
-00035230: 2222 0a20 2020 2020 2020 2043 6f6e 6369  "".        Conci
-00035240: 7365 2073 756d 6d61 7279 206f 6620 6120  se summary of a 
-00035250: 4461 736b 2044 6174 6146 7261 6d65 2e0a  Dask DataFrame..
-00035260: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00035270: 2020 2020 2069 6620 6275 6620 6973 204e       if buf is N
-00035280: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00035290: 2069 6d70 6f72 7420 7379 730a 0a20 2020   import sys..   
-000352a0: 2020 2020 2020 2020 2062 7566 203d 2073           buf = s
-000352b0: 7973 2e73 7464 6f75 740a 0a20 2020 2020  ys.stdout..     
-000352c0: 2020 206c 696e 6573 203d 205b 7374 7228     lines = [str(
-000352d0: 7479 7065 2873 656c 6629 295d 0a0a 2020  type(self))]..  
-000352e0: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-000352f0: 662e 636f 6c75 6d6e 7329 203d 3d20 303a  f.columns) == 0:
-00035300: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
-00035310: 6573 2e61 7070 656e 6428 6622 7b74 7970  es.append(f"{typ
-00035320: 6528 7365 6c66 2e69 6e64 6578 2e5f 6d65  e(self.index._me
-00035330: 7461 292e 5f5f 6e61 6d65 5f5f 7d3a 2030  ta).__name__}: 0
-00035340: 2065 6e74 7269 6573 2229 0a20 2020 2020   entries").     
-00035350: 2020 2020 2020 206c 696e 6573 2e61 7070         lines.app
-00035360: 656e 6428 6622 456d 7074 7920 7b74 7970  end(f"Empty {typ
-00035370: 6528 7365 6c66 292e 5f5f 6e61 6d65 5f5f  e(self).__name__
-00035380: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
-00035390: 6966 2050 414e 4441 535f 4754 5f31 3530  if PANDAS_GT_150
-000353a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000353b0: 2020 2320 7061 6e64 6173 2064 6174 6166    # pandas dataf
-000353c0: 7261 6d65 2073 7461 7274 6564 2061 6464  rame started add
-000353d0: 696e 6720 6120 6e65 776c 696e 6520 7768  ing a newline wh
-000353e0: 656e 2069 6e66 6f20 6973 2063 616c 6c65  en info is calle
-000353f0: 642e 0a20 2020 2020 2020 2020 2020 2020  d..             
-00035400: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
-00035410: 2222 290a 2020 2020 2020 2020 2020 2020  "").            
-00035420: 7075 745f 6c69 6e65 7328 6275 662c 206c  put_lines(buf, l
-00035430: 696e 6573 290a 2020 2020 2020 2020 2020  ines).          
-00035440: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
-00035450: 2020 2320 4772 6f75 7020 616e 6420 6578    # Group and ex
-00035460: 6563 7574 6520 7468 6520 7265 7175 6972  ecute the requir
-00035470: 6564 2063 6f6d 7075 7461 7469 6f6e 730a  ed computations.
-00035480: 2020 2020 2020 2020 636f 6d70 7574 6174          computat
-00035490: 696f 6e73 203d 207b 7d0a 2020 2020 2020  ions = {}.      
-000354a0: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
-000354b0: 2020 2020 2020 2020 2020 6d65 6d6f 7279            memory
-000354c0: 5f75 7361 6765 203d 2054 7275 650a 2020  _usage = True.  
-000354d0: 2020 2020 2020 2020 2020 636f 6d70 7574            comput
-000354e0: 6174 696f 6e73 2e75 7064 6174 6528 7b22  ations.update({"
-000354f0: 696e 6465 7822 3a20 7365 6c66 2e69 6e64  index": self.ind
-00035500: 6578 2c20 2263 6f75 6e74 223a 2073 656c  ex, "count": sel
-00035510: 662e 636f 756e 7428 297d 290a 2020 2020  f.count()}).    
-00035520: 2020 2020 6966 206d 656d 6f72 795f 7573      if memory_us
-00035530: 6167 653a 0a20 2020 2020 2020 2020 2020  age:.           
-00035540: 2063 6f6d 7075 7461 7469 6f6e 732e 7570   computations.up
-00035550: 6461 7465 280a 2020 2020 2020 2020 2020  date(.          
-00035560: 2020 2020 2020 7b22 6d65 6d6f 7279 5f75        {"memory_u
-00035570: 7361 6765 223a 2073 656c 662e 6d61 705f  sage": self.map_
-00035580: 7061 7274 6974 696f 6e73 284d 2e6d 656d  partitions(M.mem
-00035590: 6f72 795f 7573 6167 652c 2069 6e64 6578  ory_usage, index
-000355a0: 3d54 7275 6529 7d0a 2020 2020 2020 2020  =True)}.        
-000355b0: 2020 2020 290a 2020 2020 2020 2020 636f      ).        co
-000355c0: 6d70 7574 6174 696f 6e73 203d 2064 6963  mputations = dic
-000355d0: 7428 0a20 2020 2020 2020 2020 2020 207a  t(.            z
-000355e0: 6970 2863 6f6d 7075 7461 7469 6f6e 732e  ip(computations.
-000355f0: 6b65 7973 2829 2c20 6461 2e63 6f6d 7075  keys(), da.compu
-00035600: 7465 282a 636f 6d70 7574 6174 696f 6e73  te(*computations
-00035610: 2e76 616c 7565 7328 2929 290a 2020 2020  .values())).    
-00035620: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-00035630: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
-00035640: 2020 2020 2020 2069 6d70 6f72 7420 7465         import te
-00035650: 7874 7772 6170 0a0a 2020 2020 2020 2020  xtwrap..        
-00035660: 2020 2020 696e 6465 7820 3d20 636f 6d70      index = comp
-00035670: 7574 6174 696f 6e73 5b22 696e 6465 7822  utations["index"
-00035680: 5d0a 2020 2020 2020 2020 2020 2020 636f  ].            co
-00035690: 756e 7473 203d 2063 6f6d 7075 7461 7469  unts = computati
-000356a0: 6f6e 735b 2263 6f75 6e74 225d 0a20 2020  ons["count"].   
-000356b0: 2020 2020 2020 2020 206c 696e 6573 2e61           lines.a
-000356c0: 7070 656e 6428 696e 6465 785f 7375 6d6d  ppend(index_summ
-000356d0: 6172 7928 696e 6465 7829 290a 2020 2020  ary(index)).    
-000356e0: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
-000356f0: 7065 6e64 2866 2244 6174 6120 636f 6c75  pend(f"Data colu
-00035700: 6d6e 7320 2874 6f74 616c 207b 6c65 6e28  mns (total {len(
-00035710: 7365 6c66 2e63 6f6c 756d 6e73 297d 2063  self.columns)} c
-00035720: 6f6c 756d 6e73 293a 2229 0a0a 2020 2020  olumns):")..    
-00035730: 2020 2020 2020 2020 6672 6f6d 2070 616e          from pan
-00035740: 6461 732e 696f 2e66 6f72 6d61 7473 2e70  das.io.formats.p
-00035750: 7269 6e74 696e 6720 696d 706f 7274 2070  rinting import p
-00035760: 7072 696e 745f 7468 696e 670a 0a20 2020  print_thing..   
-00035770: 2020 2020 2020 2020 2073 7061 6365 203d           space =
-00035780: 206d 6178 286c 656e 2870 7072 696e 745f   max(len(pprint_
-00035790: 7468 696e 6728 6b29 2920 666f 7220 6b20  thing(k)) for k 
-000357a0: 696e 2073 656c 662e 636f 6c75 6d6e 7329  in self.columns)
-000357b0: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
-000357c0: 2063 6f6c 756d 6e5f 7769 6474 6820 3d20   column_width = 
-000357d0: 6d61 7828 7370 6163 652c 2037 290a 0a20  max(space, 7).. 
-000357e0: 2020 2020 2020 2020 2020 2068 6561 6465             heade
-000357f0: 7220 3d20 280a 2020 2020 2020 2020 2020  r = (.          
-00035800: 2020 2020 2020 7465 7874 7772 6170 2e64        textwrap.d
-00035810: 6564 656e 7428 0a20 2020 2020 2020 2020  edent(.         
-00035820: 2020 2020 2020 2020 2020 2022 2222 5c0a             """\.
-00035830: 2020 2020 2020 2020 2020 2020 2023 2020               #  
-00035840: 207b 7b63 6f6c 756d 6e3a 3c7b 636f 6c75   {{column:<{colu
-00035850: 6d6e 5f77 6964 7468 7d7d 7d20 4e6f 6e2d  mn_width}}} Non-
-00035860: 4e75 6c6c 2043 6f75 6e74 2020 4474 7970  Null Count  Dtyp
-00035870: 650a 2020 2020 2020 2020 2020 2020 2d2d  e.            --
-00035880: 2d20 207b 7b75 6e64 6572 6c3a 3c7b 636f  -  {{underl:<{co
-00035890: 6c75 6d6e 5f77 6964 7468 7d7d 7d20 2d2d  lumn_width}}} --
-000358a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2020 2d2d  ------------  --
-000358b0: 2d2d 2d22 2222 0a20 2020 2020 2020 2020  ---""".         
-000358c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000358d0: 2020 2020 2020 2020 202e 666f 726d 6174           .format
-000358e0: 2863 6f6c 756d 6e5f 7769 6474 683d 636f  (column_width=co
-000358f0: 6c75 6d6e 5f77 6964 7468 290a 2020 2020  lumn_width).    
-00035900: 2020 2020 2020 2020 2020 2020 2e66 6f72              .for
-00035910: 6d61 7428 636f 6c75 6d6e 3d22 436f 6c75  mat(column="Colu
-00035920: 6d6e 222c 2075 6e64 6572 6c3d 222d 2d2d  mn", underl="---
-00035930: 2d2d 2d22 290a 2020 2020 2020 2020 2020  ---").          
-00035940: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00035950: 636f 6c75 6d6e 5f74 656d 706c 6174 6520  column_template 
-00035960: 3d20 7465 7874 7772 6170 2e64 6564 656e  = textwrap.deden
-00035970: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00035980: 2020 2022 2222 5c0a 2020 2020 2020 2020     """\.        
-00035990: 2020 2020 7b7b 693a 5e33 7d7d 2020 7b7b      {{i:^3}}  {{
-000359a0: 6e61 6d65 3a3c 7b63 6f6c 756d 6e5f 7769  name:<{column_wi
-000359b0: 6474 687d 7d7d 207b 7b63 6f75 6e74 7d7d  dth}}} {{count}}
-000359c0: 206e 6f6e 2d6e 756c 6c20 2020 2020 207b   non-null      {
-000359d0: 7b64 7479 7065 7d7d 2222 222e 666f 726d  {dtype}}""".form
-000359e0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-000359f0: 2020 2020 2020 2020 636f 6c75 6d6e 5f77          column_w
-00035a00: 6964 7468 3d63 6f6c 756d 6e5f 7769 6474  idth=column_widt
-00035a10: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
-00035a20: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00035a30: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-00035a40: 6c75 6d6e 5f69 6e66 6f20 3d20 5b0a 2020  lumn_info = [.  
-00035a50: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00035a60: 6c75 6d6e 5f74 656d 706c 6174 652e 666f  lumn_template.fo
-00035a70: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
-00035a80: 2020 2020 2020 2020 2020 693d 7070 7269            i=ppri
-00035a90: 6e74 5f74 6869 6e67 2869 292c 0a20 2020  nt_thing(i),.   
-00035aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035ab0: 206e 616d 653d 7070 7269 6e74 5f74 6869   name=pprint_thi
-00035ac0: 6e67 286e 616d 6529 2c0a 2020 2020 2020  ng(name),.      
-00035ad0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00035ae0: 756e 743d 7070 7269 6e74 5f74 6869 6e67  unt=pprint_thing
-00035af0: 2863 6f75 6e74 292c 0a20 2020 2020 2020  (count),.       
-00035b00: 2020 2020 2020 2020 2020 2020 2064 7479               dty
-00035b10: 7065 3d70 7072 696e 745f 7468 696e 6728  pe=pprint_thing(
-00035b20: 6474 7970 6529 2c0a 2020 2020 2020 2020  dtype),.        
-00035b30: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00035b40: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
-00035b50: 2028 6e61 6d65 2c20 636f 756e 742c 2064   (name, count, d
-00035b60: 7479 7065 2920 696e 2065 6e75 6d65 7261  type) in enumera
-00035b70: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
-00035b80: 2020 2020 2020 2020 7a69 7028 7365 6c66          zip(self
-00035b90: 2e63 6f6c 756d 6e73 2c20 636f 756e 7473  .columns, counts
-00035ba0: 2c20 7365 6c66 2e64 7479 7065 7329 0a20  , self.dtypes). 
-00035bb0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00035bc0: 0a20 2020 2020 2020 2020 2020 205d 0a20  .            ]. 
-00035bd0: 2020 2020 2020 2020 2020 206c 696e 6573             lines
-00035be0: 2e65 7874 656e 6428 6865 6164 6572 2e73  .extend(header.s
-00035bf0: 706c 6974 2822 5c6e 2229 290a 2020 2020  plit("\n")).    
-00035c00: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00035c10: 2020 2020 2020 636f 6c75 6d6e 5f69 6e66        column_inf
-00035c20: 6f20 3d20 5b69 6e64 6578 5f73 756d 6d61  o = [index_summa
-00035c30: 7279 2873 656c 662e 636f 6c75 6d6e 732c  ry(self.columns,
-00035c40: 206e 616d 653d 2243 6f6c 756d 6e73 2229   name="Columns")
-00035c50: 5d0a 0a20 2020 2020 2020 206c 696e 6573  ]..        lines
-00035c60: 2e65 7874 656e 6428 636f 6c75 6d6e 5f69  .extend(column_i
-00035c70: 6e66 6f29 0a20 2020 2020 2020 2064 7479  nfo).        dty
-00035c80: 7065 5f63 6f75 6e74 7320 3d20 5b0a 2020  pe_counts = [.  
-00035c90: 2020 2020 2020 2020 2020 2225 7328 2564            "%s(%d
-00035ca0: 2922 2025 206b 2066 6f72 206b 2069 6e20  )" % k for k in 
-00035cb0: 736f 7274 6564 2873 656c 662e 6474 7970  sorted(self.dtyp
-00035cc0: 6573 2e76 616c 7565 5f63 6f75 6e74 7328  es.value_counts(
-00035cd0: 292e 6974 656d 7328 292c 206b 6579 3d73  ).items(), key=s
-00035ce0: 7472 290a 2020 2020 2020 2020 5d0a 2020  tr).        ].  
-00035cf0: 2020 2020 2020 6c69 6e65 732e 6170 7065        lines.appe
-00035d00: 6e64 2822 6474 7970 6573 3a20 7b7d 222e  nd("dtypes: {}".
-00035d10: 666f 726d 6174 2822 2c20 222e 6a6f 696e  format(", ".join
-00035d20: 2864 7479 7065 5f63 6f75 6e74 7329 2929  (dtype_counts)))
-00035d30: 0a0a 2020 2020 2020 2020 6966 206d 656d  ..        if mem
-00035d40: 6f72 795f 7573 6167 653a 0a20 2020 2020  ory_usage:.     
-00035d50: 2020 2020 2020 206d 656d 6f72 795f 696e         memory_in
-00035d60: 7420 3d20 636f 6d70 7574 6174 696f 6e73  t = computations
-00035d70: 5b22 6d65 6d6f 7279 5f75 7361 6765 225d  ["memory_usage"]
-00035d80: 2e73 756d 2829 0a20 2020 2020 2020 2020  .sum().         
-00035d90: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
-00035da0: 6622 6d65 6d6f 7279 2075 7361 6765 3a20  f"memory usage: 
-00035db0: 7b6d 656d 6f72 795f 7265 7072 286d 656d  {memory_repr(mem
-00035dc0: 6f72 795f 696e 7429 7d5c 6e22 290a 0a20  ory_int)}\n").. 
-00035dd0: 2020 2020 2020 2070 7574 5f6c 696e 6573         put_lines
-00035de0: 2862 7566 2c20 6c69 6e65 7329 0a0a 2020  (buf, lines)..  
-00035df0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00035e00: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00035e10: 2020 6465 6620 6d65 6d6f 7279 5f75 7361    def memory_usa
-00035e20: 6765 2873 656c 662c 2069 6e64 6578 3d54  ge(self, index=T
-00035e30: 7275 652c 2064 6565 703d 4661 6c73 6529  rue, deep=False)
-00035e40: 3a0a 2020 2020 2020 2020 7265 7375 6c74  :.        result
-00035e50: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
-00035e60: 6974 696f 6e73 284d 2e6d 656d 6f72 795f  itions(M.memory_
-00035e70: 7573 6167 652c 2069 6e64 6578 3d69 6e64  usage, index=ind
-00035e80: 6578 2c20 6465 6570 3d64 6565 7029 0a20  ex, deep=deep). 
-00035e90: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00035ea0: 7265 7375 6c74 2e67 726f 7570 6279 2872  result.groupby(r
-00035eb0: 6573 756c 742e 696e 6465 7829 2e73 756d  esult.index).sum
-00035ec0: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-00035ed0: 6e20 7265 7375 6c74 0a0a 2020 2020 6465  n result..    de
-00035ee0: 6620 7069 766f 745f 7461 626c 6528 7365  f pivot_table(se
-00035ef0: 6c66 2c20 696e 6465 783d 4e6f 6e65 2c20  lf, index=None, 
-00035f00: 636f 6c75 6d6e 733d 4e6f 6e65 2c20 7661  columns=None, va
-00035f10: 6c75 6573 3d4e 6f6e 652c 2061 6767 6675  lues=None, aggfu
-00035f20: 6e63 3d22 6d65 616e 2229 3a0a 2020 2020  nc="mean"):.    
-00035f30: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00035f40: 4372 6561 7465 2061 2073 7072 6561 6473  Create a spreads
-00035f50: 6865 6574 2d73 7479 6c65 2070 6976 6f74  heet-style pivot
-00035f60: 2074 6162 6c65 2061 7320 6120 4461 7461   table as a Data
-00035f70: 4672 616d 652e 2054 6172 6765 7420 6060  Frame. Target ``
-00035f80: 636f 6c75 6d6e 7360 600a 2020 2020 2020  columns``.      
-00035f90: 2020 6d75 7374 2068 6176 6520 6361 7465    must have cate
-00035fa0: 676f 7279 2064 7479 7065 2074 6f20 696e  gory dtype to in
-00035fb0: 6665 7220 7265 7375 6c74 2773 2060 6063  fer result's ``c
-00035fc0: 6f6c 756d 6e73 6060 2e0a 2020 2020 2020  olumns``..      
-00035fd0: 2020 6060 696e 6465 7860 602c 2060 6063    ``index``, ``c
-00035fe0: 6f6c 756d 6e73 6060 2c20 6060 7661 6c75  olumns``, ``valu
-00035ff0: 6573 6060 2061 6e64 2060 6061 6767 6675  es`` and ``aggfu
-00036000: 6e63 6060 206d 7573 7420 6265 2061 6c6c  nc`` must be all
-00036010: 2073 6361 6c61 722e 0a0a 2020 2020 2020   scalar...      
-00036020: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00036030: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00036040: 2020 2020 2020 2020 7661 6c75 6573 203a          values :
-00036050: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
-00036060: 2020 2020 636f 6c75 6d6e 2074 6f20 6167      column to ag
-00036070: 6772 6567 6174 650a 2020 2020 2020 2020  gregate.        
-00036080: 696e 6465 7820 3a20 7363 616c 6172 0a20  index : scalar. 
-00036090: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-000360a0: 6e20 746f 2062 6520 696e 6465 780a 2020  n to be index.  
-000360b0: 2020 2020 2020 636f 6c75 6d6e 7320 3a20        columns : 
-000360c0: 7363 616c 6172 0a20 2020 2020 2020 2020  scalar.         
-000360d0: 2020 2063 6f6c 756d 6e20 746f 2062 6520     column to be 
-000360e0: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
-000360f0: 6167 6766 756e 6320 3a20 7b27 6d65 616e  aggfunc : {'mean
-00036100: 272c 2027 7375 6d27 2c20 2763 6f75 6e74  ', 'sum', 'count
-00036110: 277d 2c20 6465 6661 756c 7420 276d 6561  '}, default 'mea
-00036120: 6e27 0a0a 2020 2020 2020 2020 5265 7475  n'..        Retu
-00036130: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-00036140: 2d2d 2d0a 2020 2020 2020 2020 7461 626c  ---.        tabl
-00036150: 6520 3a20 4461 7461 4672 616d 650a 2020  e : DataFrame.  
-00036160: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00036170: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-00036180: 6672 616d 652e 7265 7368 6170 6520 696d  frame.reshape im
-00036190: 706f 7274 2070 6976 6f74 5f74 6162 6c65  port pivot_table
-000361a0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000361b0: 2070 6976 6f74 5f74 6162 6c65 280a 2020   pivot_table(.  
-000361c0: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
-000361d0: 696e 6465 783d 696e 6465 782c 2063 6f6c  index=index, col
-000361e0: 756d 6e73 3d63 6f6c 756d 6e73 2c20 7661  umns=columns, va
-000361f0: 6c75 6573 3d76 616c 7565 732c 2061 6767  lues=values, agg
-00036200: 6675 6e63 3d61 6767 6675 6e63 0a20 2020  func=aggfunc.   
-00036210: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00036220: 6d65 6c74 280a 2020 2020 2020 2020 7365  melt(.        se
-00036230: 6c66 2c0a 2020 2020 2020 2020 6964 5f76  lf,.        id_v
-00036240: 6172 733d 4e6f 6e65 2c0a 2020 2020 2020  ars=None,.      
-00036250: 2020 7661 6c75 655f 7661 7273 3d4e 6f6e    value_vars=Non
-00036260: 652c 0a20 2020 2020 2020 2076 6172 5f6e  e,.        var_n
-00036270: 616d 653d 4e6f 6e65 2c0a 2020 2020 2020  ame=None,.      
-00036280: 2020 7661 6c75 655f 6e61 6d65 3d22 7661    value_name="va
-00036290: 6c75 6522 2c0a 2020 2020 2020 2020 636f  lue",.        co
-000362a0: 6c5f 6c65 7665 6c3d 4e6f 6e65 2c0a 2020  l_level=None,.  
-000362b0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-000362c0: 0a20 2020 2020 2020 2055 6e70 6976 6f74  .        Unpivot
-000362d0: 7320 6120 4461 7461 4672 616d 6520 6672  s a DataFrame fr
-000362e0: 6f6d 2077 6964 6520 666f 726d 6174 2074  om wide format t
-000362f0: 6f20 6c6f 6e67 2066 6f72 6d61 742c 0a20  o long format,. 
-00036300: 2020 2020 2020 206f 7074 696f 6e61 6c6c         optionall
-00036310: 7920 6c65 6176 696e 6720 6964 656e 7469  y leaving identi
-00036320: 6669 6572 2076 6172 6961 626c 6573 2073  fier variables s
-00036330: 6574 2e0a 0a20 2020 2020 2020 2054 6869  et...        Thi
-00036340: 7320 6675 6e63 7469 6f6e 2069 7320 7573  s function is us
-00036350: 6566 756c 2074 6f20 6d61 7373 6167 6520  eful to massage 
-00036360: 6120 4461 7461 4672 616d 6520 696e 746f  a DataFrame into
-00036370: 2061 2066 6f72 6d61 7420 7768 6572 650a   a format where.
-00036380: 2020 2020 2020 2020 6f6e 6520 6f72 206d          one or m
-00036390: 6f72 6520 636f 6c75 6d6e 7320 6172 6520  ore columns are 
-000363a0: 6964 656e 7469 6669 6572 2076 6172 6961  identifier varia
-000363b0: 626c 6573 2028 6060 6964 5f76 6172 7360  bles (``id_vars`
-000363c0: 6029 2c20 7768 696c 650a 2020 2020 2020  `), while.      
-000363d0: 2020 616c 6c20 6f74 6865 7220 636f 6c75    all other colu
-000363e0: 6d6e 732c 2063 6f6e 7369 6465 7265 6420  mns, considered 
-000363f0: 6d65 6173 7572 6564 2076 6172 6961 626c  measured variabl
-00036400: 6573 2028 6060 7661 6c75 655f 7661 7273  es (``value_vars
-00036410: 6060 292c 0a20 2020 2020 2020 2061 7265  ``),.        are
-00036420: 2022 756e 7069 766f 7465 6422 2074 6f20   "unpivoted" to 
-00036430: 7468 6520 726f 7720 6178 6973 2c20 6c65  the row axis, le
-00036440: 6176 696e 6720 6a75 7374 2074 776f 206e  aving just two n
-00036450: 6f6e 2d69 6465 6e74 6966 6965 720a 2020  on-identifier.  
-00036460: 2020 2020 2020 636f 6c75 6d6e 732c 2027        columns, '
-00036470: 7661 7269 6162 6c65 2720 616e 6420 2776  variable' and 'v
-00036480: 616c 7565 272e 0a0a 2020 2020 2020 2020  alue'...        
-00036490: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-000364a0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-000364b0: 2020 2020 2020 6672 616d 6520 3a20 4461        frame : Da
-000364c0: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
-000364d0: 6964 5f76 6172 7320 3a20 7475 706c 652c  id_vars : tuple,
-000364e0: 206c 6973 742c 206f 7220 6e64 6172 7261   list, or ndarra
-000364f0: 792c 206f 7074 696f 6e61 6c0a 2020 2020  y, optional.    
-00036500: 2020 2020 2020 2020 436f 6c75 6d6e 2873          Column(s
-00036510: 2920 746f 2075 7365 2061 7320 6964 656e  ) to use as iden
-00036520: 7469 6669 6572 2076 6172 6961 626c 6573  tifier variables
-00036530: 2e0a 2020 2020 2020 2020 7661 6c75 655f  ..        value_
-00036540: 7661 7273 203a 2074 7570 6c65 2c20 6c69  vars : tuple, li
-00036550: 7374 2c20 6f72 206e 6461 7272 6179 2c20  st, or ndarray, 
-00036560: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00036570: 2020 2020 2043 6f6c 756d 6e28 7329 2074       Column(s) t
-00036580: 6f20 756e 7069 766f 742e 2049 6620 6e6f  o unpivot. If no
-00036590: 7420 7370 6563 6966 6965 642c 2075 7365  t specified, use
-000365a0: 7320 616c 6c20 636f 6c75 6d6e 7320 7468  s all columns th
-000365b0: 6174 0a20 2020 2020 2020 2020 2020 2061  at.            a
-000365c0: 7265 206e 6f74 2073 6574 2061 7320 6069  re not set as `i
-000365d0: 645f 7661 7273 602e 0a20 2020 2020 2020  d_vars`..       
-000365e0: 2076 6172 5f6e 616d 6520 3a20 7363 616c   var_name : scal
-000365f0: 6172 0a20 2020 2020 2020 2020 2020 204e  ar.            N
-00036600: 616d 6520 746f 2075 7365 2066 6f72 2074  ame to use for t
-00036610: 6865 2027 7661 7269 6162 6c65 2720 636f  he 'variable' co
-00036620: 6c75 6d6e 2e20 4966 204e 6f6e 6520 6974  lumn. If None it
-00036630: 2075 7365 730a 2020 2020 2020 2020 2020   uses.          
-00036640: 2020 6060 6672 616d 652e 636f 6c75 6d6e    ``frame.column
-00036650: 732e 6e61 6d65 6060 206f 7220 2776 6172  s.name`` or 'var
-00036660: 6961 626c 6527 2e0a 2020 2020 2020 2020  iable'..        
-00036670: 7661 6c75 655f 6e61 6d65 203a 2073 6361  value_name : sca
-00036680: 6c61 722c 2064 6566 6175 6c74 2027 7661  lar, default 'va
-00036690: 6c75 6527 0a20 2020 2020 2020 2020 2020  lue'.           
-000366a0: 204e 616d 6520 746f 2075 7365 2066 6f72   Name to use for
-000366b0: 2074 6865 2027 7661 6c75 6527 2063 6f6c   the 'value' col
-000366c0: 756d 6e2e 0a20 2020 2020 2020 2063 6f6c  umn..        col
-000366d0: 5f6c 6576 656c 203a 2069 6e74 206f 7220  _level : int or 
-000366e0: 7374 7269 6e67 2c20 6f70 7469 6f6e 616c  string, optional
-000366f0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00036700: 636f 6c75 6d6e 7320 6172 6520 6120 4d75  columns are a Mu
-00036710: 6c74 6949 6e64 6578 2074 6865 6e20 7573  ltiIndex then us
-00036720: 6520 7468 6973 206c 6576 656c 2074 6f20  e this level to 
-00036730: 6d65 6c74 2e0a 0a20 2020 2020 2020 2052  melt...        R
-00036740: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-00036750: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
-00036760: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
-00036770: 2020 2020 2055 6e70 6976 6f74 6564 2044       Unpivoted D
-00036780: 6174 6146 7261 6d65 2e0a 0a20 2020 2020  ataFrame...     
-00036790: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-000367a0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-000367b0: 2020 2020 2070 616e 6461 732e 4461 7461       pandas.Data
-000367c0: 4672 616d 652e 6d65 6c74 0a20 2020 2020  Frame.melt.     
-000367d0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-000367e0: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-000367f0: 6d65 2e72 6573 6861 7065 2069 6d70 6f72  me.reshape impor
-00036800: 7420 6d65 6c74 0a0a 2020 2020 2020 2020  t melt..        
-00036810: 7265 7475 726e 206d 656c 7428 0a20 2020  return melt(.   
-00036820: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-00036830: 2020 2020 2020 2020 2020 2069 645f 7661             id_va
-00036840: 7273 3d69 645f 7661 7273 2c0a 2020 2020  rs=id_vars,.    
-00036850: 2020 2020 2020 2020 7661 6c75 655f 7661          value_va
-00036860: 7273 3d76 616c 7565 5f76 6172 732c 0a20  rs=value_vars,. 
-00036870: 2020 2020 2020 2020 2020 2076 6172 5f6e             var_n
-00036880: 616d 653d 7661 725f 6e61 6d65 2c0a 2020  ame=var_name,.  
-00036890: 2020 2020 2020 2020 2020 7661 6c75 655f            value_
-000368a0: 6e61 6d65 3d76 616c 7565 5f6e 616d 652c  name=value_name,
-000368b0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-000368c0: 5f6c 6576 656c 3d63 6f6c 5f6c 6576 656c  _level=col_level
-000368d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-000368e0: 2064 6566 2074 6f5f 7265 636f 7264 7328   def to_records(
-000368f0: 7365 6c66 2c20 696e 6465 783d 4661 6c73  self, index=Fals
-00036900: 652c 206c 656e 6774 6873 3d4e 6f6e 6529  e, lengths=None)
-00036910: 3a0a 2020 2020 2020 2020 6672 6f6d 2064  :.        from d
-00036920: 6173 6b2e 6461 7461 6672 616d 652e 696f  ask.dataframe.io
-00036930: 2069 6d70 6f72 7420 746f 5f72 6563 6f72   import to_recor
-00036940: 6473 0a0a 2020 2020 2020 2020 6966 206c  ds..        if l
-00036950: 656e 6774 6873 2069 7320 5472 7565 3a0a  engths is True:.
-00036960: 2020 2020 2020 2020 2020 2020 6c65 6e67              leng
-00036970: 7468 7320 3d20 7475 706c 6528 7365 6c66  ths = tuple(self
-00036980: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-00036990: 6c65 6e29 2e63 6f6d 7075 7465 2829 290a  len).compute()).
-000369a0: 0a20 2020 2020 2020 2072 6563 6f72 6473  .        records
-000369b0: 203d 2074 6f5f 7265 636f 7264 7328 7365   = to_records(se
-000369c0: 6c66 290a 0a20 2020 2020 2020 2063 6875  lf)..        chu
-000369d0: 6e6b 7320 3d20 7365 6c66 2e5f 7661 6c69  nks = self._vali
-000369e0: 6461 7465 5f63 6875 6e6b 7328 7265 636f  date_chunks(reco
-000369f0: 7264 732c 206c 656e 6774 6873 290a 2020  rds, lengths).  
-00036a00: 2020 2020 2020 7265 636f 7264 732e 5f63        records._c
-00036a10: 6875 6e6b 7320 3d20 2863 6875 6e6b 735b  hunks = (chunks[
-00036a20: 305d 2c29 0a0a 2020 2020 2020 2020 7265  0],)..        re
-00036a30: 7475 726e 2072 6563 6f72 6473 0a0a 2020  turn records..  
-00036a40: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00036a50: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00036a60: 2020 6465 6620 746f 5f68 746d 6c28 7365    def to_html(se
-00036a70: 6c66 2c20 6d61 785f 726f 7773 3d35 293a  lf, max_rows=5):
-00036a80: 0a20 2020 2020 2020 2023 2070 642e 5365  .        # pd.Se
-00036a90: 7269 6573 2064 6f65 736e 2774 2068 6176  ries doesn't hav
-00036aa0: 6520 6874 6d6c 2072 6570 720a 2020 2020  e html repr.    
-00036ab0: 2020 2020 6461 7461 203d 2073 656c 662e      data = self.
-00036ac0: 5f72 6570 725f 6461 7461 2829 2e74 6f5f  _repr_data().to_
-00036ad0: 6874 6d6c 286d 6178 5f72 6f77 733d 6d61  html(max_rows=ma
-00036ae0: 785f 726f 7773 2c20 7368 6f77 5f64 696d  x_rows, show_dim
-00036af0: 656e 7369 6f6e 733d 4661 6c73 6529 0a20  ensions=False). 
-00036b00: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
-00036b10: 745f 7465 6d70 6c61 7465 2822 6461 7461  t_template("data
-00036b20: 6672 616d 652e 6874 6d6c 2e6a 3222 292e  frame.html.j2").
-00036b30: 7265 6e64 6572 280a 2020 2020 2020 2020  render(.        
-00036b40: 2020 2020 6461 7461 3d64 6174 612c 0a20      data=data,. 
-00036b50: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-00036b60: 7365 6c66 2e5f 6e61 6d65 2c0a 2020 2020  self._name,.    
-00036b70: 2020 2020 2020 2020 6c61 7965 7273 3d6d          layers=m
-00036b80: 6179 6265 5f70 6c75 7261 6c69 7a65 286c  aybe_pluralize(l
-00036b90: 656e 2873 656c 662e 6461 736b 2e6c 6179  en(self.dask.lay
-00036ba0: 6572 7329 2c20 2267 7261 7068 206c 6179  ers), "graph lay
-00036bb0: 6572 2229 2c0a 2020 2020 2020 2020 290a  er"),.        ).
-00036bc0: 0a20 2020 2064 6566 205f 7265 7072 5f64  .    def _repr_d
-00036bd0: 6174 6128 7365 6c66 293a 0a20 2020 2020  ata(self):.     
-00036be0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
-00036bf0: 6d65 7461 0a20 2020 2020 2020 2069 6e64  meta.        ind
-00036c00: 6578 203d 2073 656c 662e 5f72 6570 725f  ex = self._repr_
-00036c10: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
-00036c20: 2020 636f 6c73 203d 206d 6574 612e 636f    cols = meta.co
-00036c30: 6c75 6d6e 730a 2020 2020 2020 2020 6966  lumns.        if
-00036c40: 206c 656e 2863 6f6c 7329 203d 3d20 303a   len(cols) == 0:
-00036c50: 0a20 2020 2020 2020 2020 2020 2073 6572  .            ser
-00036c60: 6965 735f 6466 203d 2070 642e 4461 7461  ies_df = pd.Data
-00036c70: 4672 616d 6528 5b5b 5d5d 202a 206c 656e  Frame([[]] * len
-00036c80: 2869 6e64 6578 292c 2063 6f6c 756d 6e73  (index), columns
-00036c90: 3d63 6f6c 732c 2069 6e64 6578 3d69 6e64  =cols, index=ind
-00036ca0: 6578 290a 2020 2020 2020 2020 656c 7365  ex).        else
-00036cb0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00036cc0: 7269 6573 5f64 6620 3d20 7064 2e63 6f6e  ries_df = pd.con
-00036cd0: 6361 7428 0a20 2020 2020 2020 2020 2020  cat(.           
-00036ce0: 2020 2020 205b 5f72 6570 725f 6461 7461       [_repr_data
-00036cf0: 5f73 6572 6965 7328 732c 2069 6e64 6578  _series(s, index
-00036d00: 3d69 6e64 6578 2920 666f 7220 5f2c 2073  =index) for _, s
-00036d10: 2069 6e20 6d65 7461 2e69 7465 6d73 2829   in meta.items()
-00036d20: 5d2c 2061 7869 733d 310a 2020 2020 2020  ], axis=1.      
-00036d30: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00036d40: 7265 7475 726e 2073 6572 6965 735f 6466  return series_df
-00036d50: 0a0a 2020 2020 6465 6620 5f72 6570 725f  ..    def _repr_
-00036d60: 6874 6d6c 5f28 7365 6c66 293a 0a20 2020  html_(self):.   
-00036d70: 2020 2020 2064 6174 6120 3d20 7365 6c66       data = self
-00036d80: 2e5f 7265 7072 5f64 6174 6128 292e 746f  ._repr_data().to
-00036d90: 5f68 746d 6c28 0a20 2020 2020 2020 2020  _html(.         
-00036da0: 2020 206d 6178 5f72 6f77 733d 352c 2073     max_rows=5, s
-00036db0: 686f 775f 6469 6d65 6e73 696f 6e73 3d46  how_dimensions=F
-00036dc0: 616c 7365 2c20 6e6f 7465 626f 6f6b 3d54  alse, notebook=T
-00036dd0: 7275 650a 2020 2020 2020 2020 290a 2020  rue.        ).  
-00036de0: 2020 2020 2020 7265 7475 726e 2067 6574        return get
-00036df0: 5f74 656d 706c 6174 6528 2264 6174 6166  _template("dataf
-00036e00: 7261 6d65 2e68 746d 6c2e 6a32 2229 2e72  rame.html.j2").r
-00036e10: 656e 6465 7228 0a20 2020 2020 2020 2020  ender(.         
-00036e20: 2020 2064 6174 613d 6461 7461 2c0a 2020     data=data,.  
-00036e30: 2020 2020 2020 2020 2020 6e61 6d65 3d73            name=s
-00036e40: 656c 662e 5f6e 616d 652c 0a20 2020 2020  elf._name,.     
-00036e50: 2020 2020 2020 206c 6179 6572 733d 6d61         layers=ma
-00036e60: 7962 655f 706c 7572 616c 697a 6528 6c65  ybe_pluralize(le
-00036e70: 6e28 7365 6c66 2e64 6173 6b2e 6c61 7965  n(self.dask.laye
-00036e80: 7273 292c 2022 6772 6170 6820 6c61 7965  rs), "graph laye
-00036e90: 7222 292c 0a20 2020 2020 2020 2029 0a0a  r"),.        )..
-00036ea0: 2020 2020 6465 6620 5f73 656c 6563 745f      def _select_
-00036eb0: 636f 6c75 6d6e 735f 6f72 5f69 6e64 6578  columns_or_index
-00036ec0: 2873 656c 662c 2063 6f6c 756d 6e73 5f6f  (self, columns_o
-00036ed0: 725f 696e 6465 7829 3a0a 2020 2020 2020  r_index):.      
-00036ee0: 2020 2222 220a 2020 2020 2020 2020 5061    """.        Pa
-00036ef0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00036f00: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00036f10: 2020 2020 636f 6c75 6d6e 735f 6f72 5f69      columns_or_i
-00036f20: 6e64 6578 0a20 2020 2020 2020 2020 2020  ndex.           
-00036f30: 2043 6f6c 756d 6e20 6f72 2069 6e64 6578   Column or index
-00036f40: 206e 616d 652c 206f 7220 6120 6c69 7374   name, or a list
-00036f50: 206f 6620 7468 6573 650a 0a20 2020 2020   of these..     
-00036f60: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00036f70: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00036f80: 2020 2064 642e 4461 7461 4672 616d 650a     dd.DataFrame.
-00036f90: 2020 2020 2020 2020 2020 2020 4461 736b              Dask
-00036fa0: 2044 6174 6146 7261 6d65 2077 6974 6820   DataFrame with 
-00036fb0: 636f 6c75 6d6e 7320 636f 7272 6573 706f  columns correspo
-00036fc0: 6e64 696e 6720 746f 2065 6163 6820 636f  nding to each co
-00036fd0: 6c75 6d6e 206f 720a 2020 2020 2020 2020  lumn or.        
-00036fe0: 2020 2020 696e 6465 7820 6c65 7665 6c20      index level 
-00036ff0: 696e 2063 6f6c 756d 6e73 5f6f 725f 696e  in columns_or_in
-00037000: 6465 782e 2020 4966 2069 6e63 6c75 6465  dex.  If include
-00037010: 642c 2074 6865 2063 6f6c 756d 6e0a 2020  d, the column.  
-00037020: 2020 2020 2020 2020 2020 636f 7272 6573            corres
-00037030: 706f 6e64 696e 6720 746f 2074 6865 2069  ponding to the i
-00037040: 6e64 6578 206c 6576 656c 2069 7320 6e61  ndex level is na
-00037050: 6d65 6420 5f69 6e64 6578 0a20 2020 2020  med _index.     
-00037060: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-00037070: 2320 456e 7375 7265 2063 6f6c 756d 6e73  # Ensure columns
-00037080: 5f6f 725f 696e 6465 7820 6973 2061 206c  _or_index is a l
-00037090: 6973 740a 2020 2020 2020 2020 636f 6c75  ist.        colu
-000370a0: 6d6e 735f 6f72 5f69 6e64 6578 203d 2028  mns_or_index = (
-000370b0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-000370c0: 756d 6e73 5f6f 725f 696e 6465 780a 2020  umns_or_index.  
-000370d0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-000370e0: 6e73 7461 6e63 6528 636f 6c75 6d6e 735f  nstance(columns_
-000370f0: 6f72 5f69 6e64 6578 2c20 6c69 7374 290a  or_index, list).
-00037100: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00037110: 205b 636f 6c75 6d6e 735f 6f72 5f69 6e64   [columns_or_ind
-00037120: 6578 5d0a 2020 2020 2020 2020 290a 0a20  ex].        ).. 
-00037130: 2020 2020 2020 2063 6f6c 756d 6e5f 6e61         column_na
-00037140: 6d65 7320 3d20 5b0a 2020 2020 2020 2020  mes = [.        
-00037150: 2020 2020 6e20 666f 7220 6e20 696e 2063      n for n in c
-00037160: 6f6c 756d 6e73 5f6f 725f 696e 6465 7820  olumns_or_index 
-00037170: 6966 2073 656c 662e 5f69 735f 636f 6c75  if self._is_colu
-00037180: 6d6e 5f6c 6162 656c 5f72 6566 6572 656e  mn_label_referen
-00037190: 6365 286e 290a 2020 2020 2020 2020 5d0a  ce(n).        ].
-000371a0: 0a20 2020 2020 2020 2073 656c 6563 7465  .        selecte
-000371b0: 645f 6466 203d 2073 656c 665b 636f 6c75  d_df = self[colu
-000371c0: 6d6e 5f6e 616d 6573 5d0a 2020 2020 2020  mn_names].      
-000371d0: 2020 6966 2073 656c 662e 5f63 6f6e 7461    if self._conta
-000371e0: 696e 735f 696e 6465 785f 6e61 6d65 2863  ins_index_name(c
-000371f0: 6f6c 756d 6e73 5f6f 725f 696e 6465 7829  olumns_or_index)
-00037200: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-00037210: 496e 6465 7820 6e61 6d65 2077 6173 2069  Index name was i
-00037220: 6e63 6c75 6465 640a 2020 2020 2020 2020  ncluded.        
-00037230: 2020 2020 7365 6c65 6374 6564 5f64 6620      selected_df 
-00037240: 3d20 7365 6c65 6374 6564 5f64 662e 6173  = selected_df.as
-00037250: 7369 676e 285f 696e 6465 783d 7365 6c66  sign(_index=self
-00037260: 2e69 6e64 6578 290a 0a20 2020 2020 2020  .index)..       
-00037270: 2072 6574 7572 6e20 7365 6c65 6374 6564   return selected
-00037280: 5f64 660a 0a20 2020 2064 6566 205f 6973  _df..    def _is
-00037290: 5f63 6f6c 756d 6e5f 6c61 6265 6c5f 7265  _column_label_re
-000372a0: 6665 7265 6e63 6528 7365 6c66 2c20 6b65  ference(self, ke
-000372b0: 7929 3a0a 2020 2020 2020 2020 2222 220a  y):.        """.
-000372c0: 2020 2020 2020 2020 5465 7374 2077 6865          Test whe
-000372d0: 7468 6572 2061 206b 6579 2069 7320 6120  ther a key is a 
-000372e0: 636f 6c75 6d6e 206c 6162 656c 2072 6566  column label ref
-000372f0: 6572 656e 6365 0a0a 2020 2020 2020 2020  erence..        
-00037300: 546f 2062 6520 636f 6e73 6964 6572 6564  To be considered
-00037310: 2061 2063 6f6c 756d 6e20 6c61 6265 6c20   a column label 
-00037320: 7265 6665 7265 6e63 652c 2060 6b65 7960  reference, `key`
-00037330: 206d 7573 7420 6d61 7463 6820 7468 6520   must match the 
-00037340: 6e61 6d65 206f 6620 6174 0a20 2020 2020  name of at.     
-00037350: 2020 206c 6561 7374 206f 6e65 2063 6f6c     least one col
-00037360: 756d 6e2e 0a20 2020 2020 2020 2022 2222  umn..        """
-00037370: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00037380: 280a 2020 2020 2020 2020 2020 2020 6e6f  (.            no
-00037390: 7420 6973 5f64 6173 6b5f 636f 6c6c 6563  t is_dask_collec
-000373a0: 7469 6f6e 286b 6579 290a 2020 2020 2020  tion(key).      
-000373b0: 2020 2020 2020 616e 6420 286e 702e 6973        and (np.is
-000373c0: 7363 616c 6172 286b 6579 2920 6f72 2069  scalar(key) or i
-000373d0: 7369 6e73 7461 6e63 6528 6b65 792c 2074  sinstance(key, t
-000373e0: 7570 6c65 2929 0a20 2020 2020 2020 2020  uple)).         
-000373f0: 2020 2061 6e64 206b 6579 2069 6e20 7365     and key in se
-00037400: 6c66 2e63 6f6c 756d 6e73 0a20 2020 2020  lf.columns.     
-00037410: 2020 2029 0a0a 2020 2020 4063 6c61 7373     )..    @class
-00037420: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
-00037430: 726f 6d5f 6469 6374 280a 2020 2020 2020  rom_dict(.      
-00037440: 2020 636c 732c 2064 6174 612c 202a 2c20    cls, data, *, 
-00037450: 6e70 6172 7469 7469 6f6e 732c 206f 7269  npartitions, ori
-00037460: 656e 743d 2263 6f6c 756d 6e73 222c 2064  ent="columns", d
-00037470: 7479 7065 3d4e 6f6e 652c 2063 6f6c 756d  type=None, colum
-00037480: 6e73 3d4e 6f6e 650a 2020 2020 293a 0a20  ns=None.    ):. 
-00037490: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000374a0: 2020 2043 6f6e 7374 7275 6374 2061 2044     Construct a D
-000374b0: 6173 6b20 4461 7461 4672 616d 6520 6672  ask DataFrame fr
-000374c0: 6f6d 2061 2050 7974 686f 6e20 4469 6374  om a Python Dict
-000374d0: 696f 6e61 7279 0a0a 2020 2020 2020 2020  ionary..        
-000374e0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-000374f0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00037500: 2020 6461 736b 2e64 6174 6166 7261 6d65    dask.dataframe
-00037510: 2e66 726f 6d5f 6469 6374 0a20 2020 2020  .from_dict.     
-00037520: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-00037530: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-00037540: 6d65 2e69 6f20 696d 706f 7274 2066 726f  me.io import fro
-00037550: 6d5f 6469 6374 0a0a 2020 2020 2020 2020  m_dict..        
-00037560: 7265 7475 726e 2066 726f 6d5f 6469 6374  return from_dict
-00037570: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
-00037580: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-00037590: 6e70 6172 7469 7469 6f6e 732c 0a20 2020  npartitions,.   
-000375a0: 2020 2020 2020 2020 206f 7269 656e 743d           orient=
-000375b0: 6f72 6965 6e74 2c0a 2020 2020 2020 2020  orient,.        
-000375c0: 2020 2020 6474 7970 653d 6474 7970 652c      dtype=dtype,
-000375d0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-000375e0: 756d 6e73 3d63 6f6c 756d 6e73 2c0a 2020  umns=columns,.  
-000375f0: 2020 2020 2020 2020 2020 636f 6e73 7472            constr
-00037600: 7563 746f 723d 636c 732e 5f70 6172 7469  uctor=cls._parti
-00037610: 7469 6f6e 5f74 7970 652c 0a20 2020 2020  tion_type,.     
-00037620: 2020 2029 0a0a 0a23 2062 696e 6420 6f70     )...# bind op
-00037630: 6572 6174 6f72 730a 2320 544f 444f 3a20  erators.# TODO: 
-00037640: 6479 6e61 6d69 6361 6c6c 7920 626f 756e  dynamically boun
-00037650: 6420 6f70 6572 6174 6f72 7320 6172 6520  d operators are 
-00037660: 6465 6665 6174 696e 6720 7479 7065 2061  defeating type a
-00037670: 6e6e 6f74 6174 696f 6e73 0a66 6f72 206f  nnotations.for o
-00037680: 7020 696e 205b 0a20 2020 206f 7065 7261  p in [.    opera
-00037690: 746f 722e 6162 732c 0a20 2020 206f 7065  tor.abs,.    ope
-000376a0: 7261 746f 722e 6164 642c 0a20 2020 206f  rator.add,.    o
-000376b0: 7065 7261 746f 722e 616e 645f 2c0a 2020  perator.and_,.  
-000376c0: 2020 6f70 6572 6174 6f72 2e65 712c 0a20    operator.eq,. 
-000376d0: 2020 206f 7065 7261 746f 722e 6774 2c0a     operator.gt,.
-000376e0: 2020 2020 6f70 6572 6174 6f72 2e67 652c      operator.ge,
-000376f0: 0a20 2020 206f 7065 7261 746f 722e 696e  .    operator.in
-00037700: 762c 0a20 2020 206f 7065 7261 746f 722e  v,.    operator.
-00037710: 6c74 2c0a 2020 2020 6f70 6572 6174 6f72  lt,.    operator
-00037720: 2e6c 652c 0a20 2020 206f 7065 7261 746f  .le,.    operato
-00037730: 722e 6d6f 642c 0a20 2020 206f 7065 7261  r.mod,.    opera
-00037740: 746f 722e 6d75 6c2c 0a20 2020 206f 7065  tor.mul,.    ope
-00037750: 7261 746f 722e 6e65 2c0a 2020 2020 6f70  rator.ne,.    op
-00037760: 6572 6174 6f72 2e6e 6567 2c0a 2020 2020  erator.neg,.    
-00037770: 6f70 6572 6174 6f72 2e6f 725f 2c0a 2020  operator.or_,.  
-00037780: 2020 6f70 6572 6174 6f72 2e70 6f77 2c0a    operator.pow,.
-00037790: 2020 2020 6f70 6572 6174 6f72 2e73 7562      operator.sub
-000377a0: 2c0a 2020 2020 6f70 6572 6174 6f72 2e74  ,.    operator.t
-000377b0: 7275 6564 6976 2c0a 2020 2020 6f70 6572  ruediv,.    oper
-000377c0: 6174 6f72 2e66 6c6f 6f72 6469 762c 0a20  ator.floordiv,. 
-000377d0: 2020 206f 7065 7261 746f 722e 786f 722c     operator.xor,
-000377e0: 0a5d 3a0a 2020 2020 5f46 7261 6d65 2e5f  .]:.    _Frame._
-000377f0: 6269 6e64 5f6f 7065 7261 746f 7228 6f70  bind_operator(op
-00037800: 290a 2020 2020 5363 616c 6172 2e5f 6269  ).    Scalar._bi
-00037810: 6e64 5f6f 7065 7261 746f 7228 6f70 290a  nd_operator(op).
-00037820: 0a66 6f72 206e 616d 6520 696e 205b 0a20  .for name in [. 
-00037830: 2020 2022 6164 6422 2c0a 2020 2020 2273     "add",.    "s
-00037840: 7562 222c 0a20 2020 2022 6d75 6c22 2c0a  ub",.    "mul",.
-00037850: 2020 2020 2264 6976 222c 0a20 2020 2022      "div",.    "
-00037860: 6469 7669 6465 222c 0a20 2020 2022 7472  divide",.    "tr
-00037870: 7565 6469 7622 2c0a 2020 2020 2266 6c6f  uediv",.    "flo
-00037880: 6f72 6469 7622 2c0a 2020 2020 226d 6f64  ordiv",.    "mod
-00037890: 222c 0a20 2020 2022 706f 7722 2c0a 2020  ",.    "pow",.  
-000378a0: 2020 2272 6164 6422 2c0a 2020 2020 2272    "radd",.    "r
-000378b0: 7375 6222 2c0a 2020 2020 2272 6d75 6c22  sub",.    "rmul"
-000378c0: 2c0a 2020 2020 2272 6469 7622 2c0a 2020  ,.    "rdiv",.  
-000378d0: 2020 2272 7472 7565 6469 7622 2c0a 2020    "rtruediv",.  
-000378e0: 2020 2272 666c 6f6f 7264 6976 222c 0a20    "rfloordiv",. 
-000378f0: 2020 2022 726d 6f64 222c 0a20 2020 2022     "rmod",.    "
-00037900: 7270 6f77 222c 0a5d 3a0a 2020 2020 6d65  rpow",.]:.    me
-00037910: 7468 203d 2067 6574 6174 7472 2870 642e  th = getattr(pd.
-00037920: 4461 7461 4672 616d 652c 206e 616d 6529  DataFrame, name)
-00037930: 0a20 2020 2044 6174 6146 7261 6d65 2e5f  .    DataFrame._
-00037940: 6269 6e64 5f6f 7065 7261 746f 725f 6d65  bind_operator_me
-00037950: 7468 6f64 286e 616d 652c 206d 6574 6829  thod(name, meth)
-00037960: 0a0a 2020 2020 6d65 7468 203d 2067 6574  ..    meth = get
-00037970: 6174 7472 2870 642e 5365 7269 6573 2c20  attr(pd.Series, 
-00037980: 6e61 6d65 290a 2020 2020 5365 7269 6573  name).    Series
-00037990: 2e5f 6269 6e64 5f6f 7065 7261 746f 725f  ._bind_operator_
-000379a0: 6d65 7468 6f64 286e 616d 652c 206d 6574  method(name, met
-000379b0: 6829 0a0a 666f 7220 6e61 6d65 2069 6e20  h)..for name in 
-000379c0: 5b22 6c74 222c 2022 6774 222c 2022 6c65  ["lt", "gt", "le
-000379d0: 222c 2022 6765 222c 2022 6e65 222c 2022  ", "ge", "ne", "
-000379e0: 6571 225d 3a0a 2020 2020 6d65 7468 203d  eq"]:.    meth =
-000379f0: 2067 6574 6174 7472 2870 642e 4461 7461   getattr(pd.Data
-00037a00: 4672 616d 652c 206e 616d 6529 0a20 2020  Frame, name).   
-00037a10: 2044 6174 6146 7261 6d65 2e5f 6269 6e64   DataFrame._bind
-00037a20: 5f63 6f6d 7061 7269 736f 6e5f 6d65 7468  _comparison_meth
-00037a30: 6f64 286e 616d 652c 206d 6574 6829 0a0a  od(name, meth)..
-00037a40: 2020 2020 6d65 7468 203d 2067 6574 6174      meth = getat
-00037a50: 7472 2870 642e 5365 7269 6573 2c20 6e61  tr(pd.Series, na
-00037a60: 6d65 290a 2020 2020 5365 7269 6573 2e5f  me).    Series._
-00037a70: 6269 6e64 5f63 6f6d 7061 7269 736f 6e5f  bind_comparison_
-00037a80: 6d65 7468 6f64 286e 616d 652c 206d 6574  method(name, met
-00037a90: 6829 0a0a 0a64 6566 2069 735f 6272 6f61  h)...def is_broa
-00037aa0: 6463 6173 7461 626c 6528 6466 732c 2073  dcastable(dfs, s
-00037ab0: 293a 0a20 2020 2022 2222 0a20 2020 2054  ):.    """.    T
-00037ac0: 6869 7320 5365 7269 6573 2069 7320 6272  his Series is br
-00037ad0: 6f61 6463 6173 7461 626c 6520 6167 6169  oadcastable agai
-00037ae0: 6e73 7420 616e 6f74 6865 7220 6461 7461  nst another data
-00037af0: 6672 616d 6520 696e 2074 6865 2073 6571  frame in the seq
-00037b00: 7565 6e63 650a 2020 2020 2222 220a 0a20  uence.    """.. 
-00037b10: 2020 2064 6566 2063 6f6d 7061 7265 2873     def compare(s
-00037b20: 2c20 6466 293a 0a20 2020 2020 2020 2074  , df):.        t
-00037b30: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00037b40: 7265 7475 726e 2073 2e64 6976 6973 696f  return s.divisio
-00037b50: 6e73 203d 3d20 2864 662e 636f 6c75 6d6e  ns == (df.column
-00037b60: 732e 6d69 6e28 292c 2064 662e 636f 6c75  s.min(), df.colu
-00037b70: 6d6e 732e 6d61 7828 2929 0a20 2020 2020  mns.max()).     
-00037b80: 2020 2065 7863 6570 7420 5479 7065 4572     except TypeEr
-00037b90: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-00037ba0: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
-00037bb0: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
-00037bc0: 2020 2020 6973 696e 7374 616e 6365 2873      isinstance(s
-00037bd0: 2c20 5365 7269 6573 290a 2020 2020 2020  , Series).      
-00037be0: 2020 616e 6420 732e 6e70 6172 7469 7469    and s.npartiti
-00037bf0: 6f6e 7320 3d3d 2031 0a20 2020 2020 2020  ons == 1.       
-00037c00: 2061 6e64 2073 2e6b 6e6f 776e 5f64 6976   and s.known_div
-00037c10: 6973 696f 6e73 0a20 2020 2020 2020 2061  isions.        a
-00037c20: 6e64 2061 6e79 2863 6f6d 7061 7265 2873  nd any(compare(s
-00037c30: 2c20 6466 2920 666f 7220 6466 2069 6e20  , df) for df in 
-00037c40: 6466 7320 6966 2069 7369 6e73 7461 6e63  dfs if isinstanc
-00037c50: 6528 6466 2c20 4461 7461 4672 616d 6529  e(df, DataFrame)
-00037c60: 290a 2020 2020 290a 0a0a 6465 6620 656c  ).    )...def el
-00037c70: 656d 7769 7365 286f 702c 202a 6172 6773  emwise(op, *args
-00037c80: 2c20 6d65 7461 3d6e 6f5f 6465 6661 756c  , meta=no_defaul
-00037c90: 742c 206f 7574 3d4e 6f6e 652c 2074 7261  t, out=None, tra
-00037ca0: 6e73 666f 726d 5f64 6976 6973 696f 6e73  nsform_divisions
-00037cb0: 3d54 7275 652c 202a 2a6b 7761 7267 7329  =True, **kwargs)
-00037cc0: 3a0a 2020 2020 2222 2245 6c65 6d65 6e74  :.    """Element
-00037cd0: 7769 7365 206f 7065 7261 7469 6f6e 2066  wise operation f
-00037ce0: 6f72 2044 6173 6b20 6461 7461 6672 616d  or Dask datafram
-00037cf0: 6573 0a0a 2020 2020 5061 7261 6d65 7465  es..    Paramete
-00037d00: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00037d10: 2d0a 2020 2020 6f70 3a20 6361 6c6c 6162  -.    op: callab
-00037d20: 6c65 0a20 2020 2020 2020 2046 756e 6374  le.        Funct
-00037d30: 696f 6e20 746f 2061 7070 6c79 2061 6372  ion to apply acr
-00037d40: 6f73 7320 696e 7075 7420 6461 7461 6672  oss input datafr
-00037d50: 616d 6573 0a20 2020 202a 6172 6773 3a20  ames.    *args: 
-00037d60: 4461 7461 4672 616d 6573 2c20 5365 7269  DataFrames, Seri
-00037d70: 6573 2c20 5363 616c 6172 732c 2041 7272  es, Scalars, Arr
-00037d80: 6179 732c 0a20 2020 2020 2020 2054 6865  ays,.        The
-00037d90: 2061 7267 756d 656e 7473 206f 6620 7468   arguments of th
-00037da0: 6520 6f70 6572 6174 696f 6e0a 2020 2020  e operation.    
-00037db0: 6d65 7461 3a20 7064 2e44 6174 6146 7261  meta: pd.DataFra
-00037dc0: 6d65 2c20 7064 2e53 6572 6965 7320 286f  me, pd.Series (o
-00037dd0: 7074 696f 6e61 6c29 0a20 2020 2020 2020  ptional).       
-00037de0: 2056 616c 6964 206d 6574 6164 6174 6120   Valid metadata 
-00037df0: 666f 7220 7468 6520 6f70 6572 6174 696f  for the operatio
-00037e00: 6e2e 2020 5769 6c6c 2065 7661 6c75 6174  n.  Will evaluat
-00037e10: 6520 6f6e 2061 2073 6d61 6c6c 2070 6965  e on a small pie
-00037e20: 6365 206f 660a 2020 2020 2020 2020 6461  ce of.        da
-00037e30: 7461 2069 6620 6e6f 7420 7072 6f76 6964  ta if not provid
-00037e40: 6564 2e0a 2020 2020 7472 616e 7366 6f72  ed..    transfor
-00037e50: 6d5f 6469 7669 7369 6f6e 733a 2062 6f6f  m_divisions: boo
-00037e60: 6c65 616e 0a20 2020 2020 2020 2049 6620  lean.        If 
-00037e70: 7468 6520 696e 7075 7420 6973 2061 2060  the input is a `
-00037e80: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
-00037e90: 496e 6465 7860 6020 7765 206e 6f72 6d61  Index`` we norma
-00037ea0: 6c6c 7920 7769 6c6c 2061 6c73 6f20 6170  lly will also ap
-00037eb0: 706c 790a 2020 2020 2020 2020 7468 6520  ply.        the 
-00037ec0: 6675 6e63 7469 6f6e 206f 6e74 6f20 7468  function onto th
-00037ed0: 6520 6469 7669 7369 6f6e 7320 616e 6420  e divisions and 
-00037ee0: 6170 706c 7920 7468 6f73 6520 7472 616e  apply those tran
-00037ef0: 7366 6f72 6d65 6420 6469 7669 7369 6f6e  sformed division
-00037f00: 730a 2020 2020 2020 2020 746f 2074 6865  s.        to the
-00037f10: 206f 7574 7075 742e 2020 596f 7520 6361   output.  You ca
-00037f20: 6e20 7061 7373 2060 6074 7261 6e73 666f  n pass ``transfo
-00037f30: 726d 5f64 6976 6973 696f 6e73 3d46 616c  rm_divisions=Fal
-00037f40: 7365 6060 2074 6f20 6f76 6572 7269 6465  se`` to override
-00037f50: 0a20 2020 2020 2020 2074 6869 7320 6265  .        this be
-00037f60: 6861 7669 6f72 0a20 2020 206f 7574 203a  havior.    out :
-00037f70: 2060 6064 6173 6b2e 6172 7261 7960 6020   ``dask.array`` 
-00037f80: 6f72 2060 604e 6f6e 6560 600a 2020 2020  or ``None``.    
-00037f90: 2020 2020 4966 206f 7574 2069 7320 6120      If out is a 
-00037fa0: 6461 736b 2e44 6174 6146 7261 6d65 2c20  dask.DataFrame, 
-00037fb0: 6461 736b 2e53 6572 6965 7320 6f72 2064  dask.Series or d
-00037fc0: 6173 6b2e 5363 616c 6172 2074 6865 6e0a  ask.Scalar then.
-00037fd0: 2020 2020 2020 2020 7468 6973 206f 7665          this ove
-00037fe0: 7277 7269 7465 7320 7468 6520 636f 6e74  rwrites the cont
-00037ff0: 656e 7473 206f 6620 6974 2077 6974 6820  ents of it with 
-00038000: 7468 6520 7265 7375 6c74 0a20 2020 202a  the result.    *
-00038010: 2a6b 7761 7267 733a 2073 6361 6c61 7273  *kwargs: scalars
-00038020: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
-00038030: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00038040: 3e3e 3e20 656c 656d 7769 7365 286f 7065  >>> elemwise(ope
-00038050: 7261 746f 722e 6164 642c 2064 662e 782c  rator.add, df.x,
-00038060: 2064 662e 7929 2020 2320 646f 6374 6573   df.y)  # doctes
-00038070: 743a 202b 534b 4950 0a20 2020 2022 2222  t: +SKIP.    """
-00038080: 0a20 2020 205f 6e61 6d65 203d 2066 756e  .    _name = fun
-00038090: 636e 616d 6528 6f70 2920 2b20 222d 2220  cname(op) + "-" 
-000380a0: 2b20 746f 6b65 6e69 7a65 286f 702c 202a  + tokenize(op, *
-000380b0: 6172 6773 2c20 2a2a 6b77 6172 6773 290a  args, **kwargs).
-000380c0: 0a20 2020 2061 7267 7320 3d20 5f6d 6179  .    args = _may
-000380d0: 6265 5f66 726f 6d5f 7061 6e64 6173 2861  be_from_pandas(a
-000380e0: 7267 7329 0a0a 2020 2020 6672 6f6d 2064  rgs)..    from d
-000380f0: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
-00038100: 6c74 6920 696d 706f 7274 205f 6d61 7962  lti import _mayb
-00038110: 655f 616c 6967 6e5f 7061 7274 6974 696f  e_align_partitio
-00038120: 6e73 0a0a 2020 2020 6172 6773 203d 205f  ns..    args = _
-00038130: 6d61 7962 655f 616c 6967 6e5f 7061 7274  maybe_align_part
-00038140: 6974 696f 6e73 2861 7267 7329 0a20 2020  itions(args).   
-00038150: 2064 6173 6b73 203d 205b 6172 6720 666f   dasks = [arg fo
-00038160: 7220 6172 6720 696e 2061 7267 7320 6966  r arg in args if
-00038170: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
-00038180: 2028 5f46 7261 6d65 2c20 5363 616c 6172   (_Frame, Scalar
-00038190: 2c20 4172 7261 7929 295d 0a20 2020 2064  , Array))].    d
-000381a0: 6673 203d 205b 6466 2066 6f72 2064 6620  fs = [df for df 
-000381b0: 696e 2064 6173 6b73 2069 6620 6973 696e  in dasks if isin
-000381c0: 7374 616e 6365 2864 662c 205f 4672 616d  stance(df, _Fram
-000381d0: 6529 5d0a 0a20 2020 2023 2043 6c65 616e  e)]..    # Clean
-000381e0: 2075 7020 6461 736b 2061 7272 6179 7320   up dask arrays 
-000381f0: 6966 2070 7265 7365 6e74 0a20 2020 2064  if present.    d
-00038200: 6570 7320 3d20 6461 736b 732e 636f 7079  eps = dasks.copy
-00038210: 2829 0a20 2020 2066 6f72 2069 2c20 6120  ().    for i, a 
-00038220: 696e 2065 6e75 6d65 7261 7465 2864 6173  in enumerate(das
-00038230: 6b73 293a 0a20 2020 2020 2020 2069 6620  ks):.        if 
-00038240: 6e6f 7420 6973 696e 7374 616e 6365 2861  not isinstance(a
-00038250: 2c20 4172 7261 7929 3a0a 2020 2020 2020  , Array):.      
-00038260: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
-00038270: 2020 2020 2020 2023 2045 6e73 7572 6520         # Ensure 
-00038280: 7468 6174 2074 6865 7920 6861 7665 2073  that they have s
-00038290: 696d 696c 6172 2d69 7368 2063 6875 6e6b  imilar-ish chunk
-000382a0: 2073 7472 7563 7475 7265 0a20 2020 2020   structure.     
-000382b0: 2020 2069 6620 6e6f 7420 616c 6c28 6e6f     if not all(no
-000382c0: 7420 612e 6368 756e 6b73 206f 7220 6c65  t a.chunks or le
-000382d0: 6e28 612e 6368 756e 6b73 5b30 5d29 203d  n(a.chunks[0]) =
-000382e0: 3d20 6466 2e6e 7061 7274 6974 696f 6e73  = df.npartitions
-000382f0: 2066 6f72 2064 6620 696e 2064 6673 293a   for df in dfs):
-00038300: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-00038310: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00038320: 2020 2020 2022 5768 656e 2063 6f6d 6269       "When combi
-00038330: 6e69 6e67 2064 6173 6b20 6172 7261 7973  ning dask arrays
-00038340: 2077 6974 6820 6461 7461 6672 616d 6573   with dataframes
-00038350: 2074 6865 7920 6d75 7374 2022 0a20 2020   they must ".   
-00038360: 2020 2020 2020 2020 2020 2020 2022 6d61               "ma
-00038370: 7463 6820 6368 756e 6b69 6e67 2065 7861  tch chunking exa
-00038380: 6374 6c79 2e20 204f 7065 7261 7469 6f6e  ctly.  Operation
-00038390: 3a20 2573 2220 2520 6675 6e63 6e61 6d65  : %s" % funcname
-000383a0: 286f 7029 0a20 2020 2020 2020 2020 2020  (op).           
-000383b0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-000383c0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-000383d0: 6d73 6729 0a20 2020 2020 2020 2023 2052  msg).        # R
-000383e0: 6563 6875 6e6b 2074 6f20 6861 7665 2061  echunk to have a
-000383f0: 2073 696e 676c 6520 6368 756e 6b20 616c   single chunk al
-00038400: 6f6e 6720 616c 6c20 6f74 6865 7220 6178  ong all other ax
-00038410: 6573 0a20 2020 2020 2020 2069 6620 612e  es.        if a.
-00038420: 6e64 696d 203e 2031 3a0a 2020 2020 2020  ndim > 1:.      
-00038430: 2020 2020 2020 6120 3d20 612e 7265 6368        a = a.rech
-00038440: 756e 6b28 7b69 202b 2031 3a20 6420 666f  unk({i + 1: d fo
-00038450: 7220 692c 2064 2069 6e20 656e 756d 6572  r i, d in enumer
-00038460: 6174 6528 612e 7368 6170 655b 313a 5d29  ate(a.shape[1:])
-00038470: 7d29 0a20 2020 2020 2020 2020 2020 2064  }).            d
-00038480: 6173 6b73 5b69 5d20 3d20 610a 0a20 2020  asks[i] = a..   
-00038490: 2064 6976 6973 696f 6e73 203d 2064 6673   divisions = dfs
-000384a0: 5b30 5d2e 6469 7669 7369 6f6e 730a 2020  [0].divisions.  
-000384b0: 2020 6966 2074 7261 6e73 666f 726d 5f64    if transform_d
-000384c0: 6976 6973 696f 6e73 2061 6e64 2069 7369  ivisions and isi
-000384d0: 6e73 7461 6e63 6528 6466 735b 305d 2c20  nstance(dfs[0], 
-000384e0: 496e 6465 7829 2061 6e64 206c 656e 2864  Index) and len(d
-000384f0: 6673 2920 3d3d 2031 3a0a 2020 2020 2020  fs) == 1:.      
-00038500: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00038510: 2020 2064 6976 6973 696f 6e73 203d 206f     divisions = o
-00038520: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
-00038530: 2020 202a 5b70 642e 496e 6465 7828 6172     *[pd.Index(ar
-00038540: 672e 6469 7669 7369 6f6e 7329 2069 6620  g.divisions) if 
-00038550: 6172 6720 6973 2064 6673 5b30 5d20 656c  arg is dfs[0] el
-00038560: 7365 2061 7267 2066 6f72 2061 7267 2069  se arg for arg i
-00038570: 6e20 6172 6773 5d2c 0a20 2020 2020 2020  n args],.       
-00038580: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
-00038590: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-000385a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000385b0: 6973 696e 7374 616e 6365 2864 6976 6973  isinstance(divis
-000385c0: 696f 6e73 2c20 7064 2e49 6e64 6578 293a  ions, pd.Index):
-000385d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000385e0: 2064 6976 6973 696f 6e73 203d 206d 6574   divisions = met
-000385f0: 686f 6473 2e74 6f6c 6973 7428 6469 7669  hods.tolist(divi
-00038600: 7369 6f6e 7329 0a20 2020 2020 2020 2065  sions).        e
-00038610: 7863 6570 7420 4578 6365 7074 696f 6e3a  xcept Exception:
-00038620: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
-00038630: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
-00038640: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00038650: 6f74 2076 616c 6964 5f64 6976 6973 696f  ot valid_divisio
-00038660: 6e73 2864 6976 6973 696f 6e73 293a 0a20  ns(divisions):. 
-00038670: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00038680: 6976 6973 696f 6e73 203d 205b 4e6f 6e65  ivisions = [None
-00038690: 5d20 2a20 2864 6673 5b30 5d2e 6e70 6172  ] * (dfs[0].npar
-000386a0: 7469 7469 6f6e 7320 2b20 3129 0a0a 2020  titions + 1)..  
-000386b0: 2020 5f69 735f 6272 6f61 6463 6173 7461    _is_broadcasta
-000386c0: 626c 6520 3d20 7061 7274 6961 6c28 6973  ble = partial(is
-000386d0: 5f62 726f 6164 6361 7374 6162 6c65 2c20  _broadcastable, 
-000386e0: 6466 7329 0a20 2020 2064 6673 203d 206c  dfs).    dfs = l
-000386f0: 6973 7428 7265 6d6f 7665 285f 6973 5f62  ist(remove(_is_b
-00038700: 726f 6164 6361 7374 6162 6c65 2c20 6466  roadcastable, df
-00038710: 7329 290a 0a20 2020 206f 7468 6572 203d  s))..    other =
-00038720: 205b 0a20 2020 2020 2020 2028 692c 2061   [.        (i, a
-00038730: 7267 290a 2020 2020 2020 2020 666f 7220  rg).        for 
-00038740: 692c 2061 7267 2069 6e20 656e 756d 6572  i, arg in enumer
-00038750: 6174 6528 6172 6773 290a 2020 2020 2020  ate(args).      
-00038760: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-00038770: 6e63 6528 6172 672c 2028 5f46 7261 6d65  nce(arg, (_Frame
-00038780: 2c20 5363 616c 6172 2c20 4172 7261 7929  , Scalar, Array)
-00038790: 290a 2020 2020 5d0a 0a20 2020 2023 2061  ).    ]..    # a
-000387a0: 646a 7573 7420 7468 6520 6b65 7920 6c65  djust the key le
-000387b0: 6e67 7468 206f 6620 5363 616c 6172 0a20  ngth of Scalar. 
-000387c0: 2020 2064 736b 203d 2070 6172 7469 7469     dsk = partiti
-000387d0: 6f6e 7769 7365 5f67 7261 7068 286f 702c  onwise_graph(op,
-000387e0: 205f 6e61 6d65 2c20 2a61 7267 732c 202a   _name, *args, *
-000387f0: 2a6b 7761 7267 7329 0a0a 2020 2020 6772  *kwargs)..    gr
-00038800: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-00038810: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-00038820: 7469 6f6e 7328 5f6e 616d 652c 2064 736b  tions(_name, dsk
-00038830: 2c20 6465 7065 6e64 656e 6369 6573 3d64  , dependencies=d
-00038840: 6570 7329 0a0a 2020 2020 6966 206d 6574  eps)..    if met
-00038850: 6120 6973 206e 6f5f 6465 6661 756c 743a  a is no_default:
-00038860: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00038870: 6466 7329 203e 3d20 3220 616e 6420 6e6f  dfs) >= 2 and no
-00038880: 7420 616c 6c28 6861 7361 7474 7228 642c  t all(hasattr(d,
-00038890: 2022 6e70 6172 7469 7469 6f6e 7322 2920   "npartitions") 
-000388a0: 666f 7220 6420 696e 2064 6173 6b73 293a  for d in dasks):
-000388b0: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
-000388c0: 686f 756c 6420 6e6f 7420 6f63 6375 7220  hould not occur 
-000388d0: 696e 2063 7572 7265 6e74 2066 756e 6373  in current funcs
-000388e0: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-000388f0: 203d 2022 656c 656d 7769 7365 2077 6974   = "elemwise wit
-00038900: 6820 3220 6f72 206d 6f72 6520 4461 7461  h 2 or more Data
-00038910: 4672 616d 6573 2061 6e64 2053 6361 6c61  Frames and Scala
-00038920: 7220 6973 206e 6f74 2073 7570 706f 7274  r is not support
-00038930: 6564 220a 2020 2020 2020 2020 2020 2020  ed".            
-00038940: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00038950: 6e74 6564 4572 726f 7228 6d73 6729 0a20  ntedError(msg). 
-00038960: 2020 2020 2020 2023 2046 6f72 2062 726f         # For bro
-00038970: 6164 6361 7374 6162 6c65 2073 6572 6965  adcastable serie
-00038980: 732c 2075 7365 206e 6f20 726f 7773 2e0a  s, use no rows..
-00038990: 2020 2020 2020 2020 7061 7274 7320 3d20          parts = 
-000389a0: 5b0a 2020 2020 2020 2020 2020 2020 642e  [.            d.
-000389b0: 5f6d 6574 610a 2020 2020 2020 2020 2020  _meta.          
-000389c0: 2020 6966 205f 6973 5f62 726f 6164 6361    if _is_broadca
-000389d0: 7374 6162 6c65 2864 290a 2020 2020 2020  stable(d).      
-000389e0: 2020 2020 2020 656c 7365 206e 702e 656d        else np.em
-000389f0: 7074 7928 2829 2c20 6474 7970 653d 642e  pty((), dtype=d.
-00038a00: 6474 7970 6529 0a20 2020 2020 2020 2020  dtype).         
-00038a10: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00038a20: 2864 2c20 4172 7261 7929 0a20 2020 2020  (d, Array).     
-00038a30: 2020 2020 2020 2065 6c73 6520 642e 5f6d         else d._m
-00038a40: 6574 615f 6e6f 6e65 6d70 7479 0a20 2020  eta_nonempty.   
-00038a50: 2020 2020 2020 2020 2066 6f72 2064 2069           for d i
-00038a60: 6e20 6461 736b 730a 2020 2020 2020 2020  n dasks.        
-00038a70: 5d0a 2020 2020 2020 2020 7769 7468 2072  ].        with r
-00038a80: 6169 7365 5f6f 6e5f 6d65 7461 5f65 7272  aise_on_meta_err
-00038a90: 6f72 2866 756e 636e 616d 6528 6f70 2929  or(funcname(op))
-00038aa0: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
-00038ab0: 7461 203d 2070 6172 7469 616c 5f62 795f  ta = partial_by_
-00038ac0: 6f72 6465 7228 2a70 6172 7473 2c20 6675  order(*parts, fu
-00038ad0: 6e63 7469 6f6e 3d6f 702c 206f 7468 6572  nction=op, other
-00038ae0: 3d6f 7468 6572 290a 0a20 2020 2072 6573  =other)..    res
-00038af0: 756c 7420 3d20 6e65 775f 6464 5f6f 626a  ult = new_dd_obj
-00038b00: 6563 7428 6772 6170 682c 205f 6e61 6d65  ect(graph, _name
-00038b10: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
-00038b20: 7329 0a20 2020 2072 6574 7572 6e20 6861  s).    return ha
-00038b30: 6e64 6c65 5f6f 7574 286f 7574 2c20 7265  ndle_out(out, re
-00038b40: 7375 6c74 290a 0a0a 6465 6620 6861 6e64  sult)...def hand
-00038b50: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
-00038b60: 6c74 293a 0a20 2020 2022 2222 4861 6e64  lt):.    """Hand
-00038b70: 6c65 206f 7574 2070 6172 616d 6574 6572  le out parameter
-00038b80: 730a 0a20 2020 2049 6620 6f75 7420 6973  s..    If out is
-00038b90: 2061 2064 6173 6b2e 4461 7461 4672 616d   a dask.DataFram
-00038ba0: 652c 2064 6173 6b2e 5365 7269 6573 206f  e, dask.Series o
-00038bb0: 7220 6461 736b 2e53 6361 6c61 7220 7468  r dask.Scalar th
-00038bc0: 656e 0a20 2020 2074 6869 7320 6f76 6572  en.    this over
-00038bd0: 7772 6974 6573 2074 6865 2063 6f6e 7465  writes the conte
-00038be0: 6e74 7320 6f66 2069 7420 7769 7468 2074  nts of it with t
-00038bf0: 6865 2072 6573 756c 740a 2020 2020 2222  he result.    ""
-00038c00: 220a 2020 2020 6966 2069 7369 6e73 7461  ".    if isinsta
-00038c10: 6e63 6528 6f75 742c 2074 7570 6c65 293a  nce(out, tuple):
-00038c20: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00038c30: 6f75 7429 203d 3d20 313a 0a20 2020 2020  out) == 1:.     
-00038c40: 2020 2020 2020 206f 7574 203d 206f 7574         out = out
-00038c50: 5b30 5d0a 2020 2020 2020 2020 656c 6966  [0].        elif
-00038c60: 206c 656e 286f 7574 2920 3e20 313a 0a20   len(out) > 1:. 
-00038c70: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00038c80: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-00038c90: 7272 6f72 2822 5468 6520 6f75 7420 7061  rror("The out pa
-00038ca0: 7261 6d65 7465 7220 6973 206e 6f74 2066  rameter is not f
-00038cb0: 756c 6c79 2073 7570 706f 7274 6564 2229  ully supported")
-00038cc0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00038cd0: 2020 2020 2020 2020 2020 206f 7574 203d             out =
-00038ce0: 204e 6f6e 650a 0a20 2020 2023 204e 6f74   None..    # Not
-00038cf0: 6963 652c 2077 6520 7573 6520 2e5f 5f63  ice, we use .__c
-00038d00: 6c61 7373 5f5f 2061 7320 6f70 706f 7365  lass__ as oppose
-00038d10: 6420 746f 2074 7970 6528 2920 696e 206f  d to type() in o
-00038d20: 7264 6572 2074 6f20 7375 7070 6f72 740a  rder to support.
-00038d30: 2020 2020 2320 6f62 6a65 6374 2070 726f      # object pro
-00038d40: 7869 6573 2073 6565 203c 6874 7470 733a  xies see <https:
-00038d50: 2f2f 6769 7468 7562 2e63 6f6d 2f64 6173  //github.com/das
-00038d60: 6b2f 6461 736b 2f70 756c 6c2f 3639 3831  k/dask/pull/6981
-00038d70: 3e0a 2020 2020 6966 206f 7574 2069 7320  >.    if out is 
-00038d80: 6e6f 7420 4e6f 6e65 2061 6e64 206f 7574  not None and out
-00038d90: 2e5f 5f63 6c61 7373 5f5f 2021 3d20 7265  .__class__ != re
-00038da0: 7375 6c74 2e5f 5f63 6c61 7373 5f5f 3a0a  sult.__class__:.
-00038db0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00038dc0: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
-00038dd0: 2020 2020 2022 4d69 736d 6174 6368 6564       "Mismatched
-00038de0: 2074 7970 6573 2062 6574 7765 656e 2072   types between r
-00038df0: 6573 756c 7420 616e 6420 6f75 7420 7061  esult and out pa
-00038e00: 7261 6d65 7465 722e 2022 0a20 2020 2020  rameter. ".     
-00038e10: 2020 2020 2020 2022 6f75 743d 2573 2c20         "out=%s, 
-00038e20: 7265 7375 6c74 3d25 7322 2025 2028 7374  result=%s" % (st
-00038e30: 7228 7479 7065 286f 7574 2929 2c20 7374  r(type(out)), st
-00038e40: 7228 7479 7065 2872 6573 756c 7429 2929  r(type(result)))
-00038e50: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00038e60: 6966 2069 7369 6e73 7461 6e63 6528 6f75  if isinstance(ou
-00038e70: 742c 2044 6174 6146 7261 6d65 293a 0a20  t, DataFrame):. 
-00038e80: 2020 2020 2020 2069 6620 6c65 6e28 6f75         if len(ou
-00038e90: 742e 636f 6c75 6d6e 7329 2021 3d20 6c65  t.columns) != le
-00038ea0: 6e28 7265 7375 6c74 2e63 6f6c 756d 6e73  n(result.columns
-00038eb0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00038ec0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00038ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038ee0: 2022 4d69 736d 6174 6368 6564 2063 6f6c   "Mismatched col
-00038ef0: 756d 6e73 2063 6f75 6e74 2062 6574 7765  umns count betwe
-00038f00: 656e 2072 6573 756c 7420 616e 6420 6f75  en result and ou
-00038f10: 7420 7061 7261 6d65 7465 722e 2022 0a20  t parameter. ". 
-00038f20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00038f30: 6f75 743d 2573 2c20 7265 7375 6c74 3d25  out=%s, result=%
-00038f40: 7322 2025 2028 7374 7228 6c65 6e28 6f75  s" % (str(len(ou
-00038f50: 742e 636f 6c75 6d6e 7329 292c 2073 7472  t.columns)), str
-00038f60: 286c 656e 2872 6573 756c 742e 636f 6c75  (len(result.colu
-00038f70: 6d6e 7329 2929 0a20 2020 2020 2020 2020  mns))).         
-00038f80: 2020 2029 0a0a 2020 2020 6966 2069 7369     )..    if isi
-00038f90: 6e73 7461 6e63 6528 6f75 742c 2028 5365  nstance(out, (Se
-00038fa0: 7269 6573 2c20 4461 7461 4672 616d 652c  ries, DataFrame,
-00038fb0: 2053 6361 6c61 7229 293a 0a20 2020 2020   Scalar)):.     
-00038fc0: 2020 206f 7574 2e5f 6d65 7461 203d 2072     out._meta = r
-00038fd0: 6573 756c 742e 5f6d 6574 610a 2020 2020  esult._meta.    
-00038fe0: 2020 2020 6f75 742e 5f6e 616d 6520 3d20      out._name = 
-00038ff0: 7265 7375 6c74 2e5f 6e61 6d65 0a20 2020  result._name.   
-00039000: 2020 2020 206f 7574 2e64 6173 6b20 3d20       out.dask = 
-00039010: 7265 7375 6c74 2e64 6173 6b0a 0a20 2020  result.dask..   
-00039020: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00039030: 7374 616e 6365 286f 7574 2c20 5363 616c  stance(out, Scal
-00039040: 6172 293a 0a20 2020 2020 2020 2020 2020  ar):.           
-00039050: 206f 7574 2e5f 6469 7669 7369 6f6e 7320   out._divisions 
-00039060: 3d20 7265 7375 6c74 2e64 6976 6973 696f  = result.divisio
-00039070: 6e73 0a20 2020 2065 6c69 6620 6f75 7420  ns.    elif out 
-00039080: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00039090: 2020 2020 206d 7367 203d 2028 0a20 2020       msg = (.   
-000390a0: 2020 2020 2020 2020 2022 5468 6520 6f75           "The ou
-000390b0: 7420 7061 7261 6d65 7465 7220 6973 206e  t parameter is n
-000390c0: 6f74 2066 756c 6c79 2073 7570 706f 7274  ot fully support
-000390d0: 6564 2e22 0a20 2020 2020 2020 2020 2020  ed.".           
-000390e0: 2022 2052 6563 6569 7665 6420 7479 7065   " Received type
-000390f0: 2025 732c 2065 7870 6563 7465 6420 2573   %s, expected %s
-00039100: 2022 0a20 2020 2020 2020 2020 2020 2025   ".            %
-00039110: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00039120: 2020 2074 7970 656e 616d 6528 7479 7065     typename(type
-00039130: 286f 7574 2929 2c0a 2020 2020 2020 2020  (out)),.        
-00039140: 2020 2020 2020 2020 7479 7065 6e61 6d65          typename
-00039150: 2874 7970 6528 7265 7375 6c74 2929 2c0a  (type(result)),.
-00039160: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00039170: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00039180: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00039190: 6e74 6564 4572 726f 7228 6d73 6729 0a20  ntedError(msg). 
-000391a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000391b0: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
-000391c0: 0a64 6566 205f 6d61 7962 655f 6672 6f6d  .def _maybe_from
-000391d0: 5f70 616e 6461 7328 6466 7329 3a0a 2020  _pandas(dfs):.  
-000391e0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-000391f0: 6672 616d 652e 696f 2069 6d70 6f72 7420  frame.io import 
-00039200: 6672 6f6d 5f70 616e 6461 730a 0a20 2020  from_pandas..   
-00039210: 2064 6673 203d 205b 0a20 2020 2020 2020   dfs = [.       
-00039220: 2066 726f 6d5f 7061 6e64 6173 2864 662c   from_pandas(df,
-00039230: 2031 290a 2020 2020 2020 2020 6966 2028   1).        if (
-00039240: 6973 5f73 6572 6965 735f 6c69 6b65 2864  is_series_like(d
-00039250: 6629 206f 7220 6973 5f64 6174 6166 7261  f) or is_datafra
-00039260: 6d65 5f6c 696b 6528 6466 2929 2061 6e64  me_like(df)) and
-00039270: 206e 6f74 2069 735f 6461 736b 5f63 6f6c   not is_dask_col
-00039280: 6c65 6374 696f 6e28 6466 290a 2020 2020  lection(df).    
-00039290: 2020 2020 656c 7365 2064 660a 2020 2020      else df.    
-000392a0: 2020 2020 666f 7220 6466 2069 6e20 6466      for df in df
-000392b0: 730a 2020 2020 5d0a 2020 2020 7265 7475  s.    ].    retu
-000392c0: 726e 2064 6673 0a0a 0a64 6566 2068 6173  rn dfs...def has
-000392d0: 685f 7368 6172 6428 0a20 2020 2064 662c  h_shard(.    df,
-000392e0: 206e 7061 7274 732c 2073 706c 6974 5f6f   nparts, split_o
-000392f0: 7574 5f73 6574 7570 3d4e 6f6e 652c 2073  ut_setup=None, s
-00039300: 706c 6974 5f6f 7574 5f73 6574 7570 5f6b  plit_out_setup_k
-00039310: 7761 7267 733d 4e6f 6e65 2c20 6967 6e6f  wargs=None, igno
-00039320: 7265 5f69 6e64 6578 3d46 616c 7365 0a29  re_index=False.)
-00039330: 3a0a 2020 2020 6966 2073 706c 6974 5f6f  :.    if split_o
-00039340: 7574 5f73 6574 7570 3a0a 2020 2020 2020  ut_setup:.      
-00039350: 2020 6820 3d20 7370 6c69 745f 6f75 745f    h = split_out_
-00039360: 7365 7475 7028 6466 2c20 2a2a 2873 706c  setup(df, **(spl
-00039370: 6974 5f6f 7574 5f73 6574 7570 5f6b 7761  it_out_setup_kwa
-00039380: 7267 7320 6f72 207b 7d29 290a 2020 2020  rgs or {})).    
-00039390: 656c 7365 3a0a 2020 2020 2020 2020 6820  else:.        h 
-000393a0: 3d20 6466 0a0a 2020 2020 6820 3d20 6861  = df..    h = ha
-000393b0: 7368 5f6f 626a 6563 745f 6469 7370 6174  sh_object_dispat
-000393c0: 6368 2868 2c20 696e 6465 783d 4661 6c73  ch(h, index=Fals
-000393d0: 6529 0a20 2020 2072 6574 7572 6e20 6772  e).    return gr
-000393e0: 6f75 705f 7370 6c69 745f 6469 7370 6174  oup_split_dispat
-000393f0: 6368 2864 662c 2068 2025 206e 7061 7274  ch(df, h % npart
-00039400: 732c 206e 7061 7274 732c 2069 676e 6f72  s, nparts, ignor
-00039410: 655f 696e 6465 783d 6967 6e6f 7265 5f69  e_index=ignore_i
-00039420: 6e64 6578 290a 0a0a 6465 6620 7370 6c69  ndex)...def spli
-00039430: 745f 6576 656e 6c79 2864 662c 206b 293a  t_evenly(df, k):
-00039440: 0a20 2020 2022 2222 5370 6c69 7420 6461  .    """Split da
-00039450: 7461 6672 616d 6520 696e 746f 206b 2072  taframe into k r
-00039460: 6f75 6768 6c79 2065 7175 616c 2070 6172  oughly equal par
-00039470: 7473 2222 220a 2020 2020 6469 7669 7369  ts""".    divisi
-00039480: 6f6e 7320 3d20 6e70 2e6c 696e 7370 6163  ons = np.linspac
-00039490: 6528 302c 206c 656e 2864 6629 2c20 6b20  e(0, len(df), k 
-000394a0: 2b20 3129 2e61 7374 7970 6528 696e 7429  + 1).astype(int)
-000394b0: 0a20 2020 2072 6574 7572 6e20 7b69 3a20  .    return {i: 
-000394c0: 6466 2e69 6c6f 635b 6469 7669 7369 6f6e  df.iloc[division
-000394d0: 735b 695d 203a 2064 6976 6973 696f 6e73  s[i] : divisions
-000394e0: 5b69 202b 2031 5d5d 2066 6f72 2069 2069  [i + 1]] for i i
-000394f0: 6e20 7261 6e67 6528 6b29 7d0a 0a0a 6465  n range(k)}...de
-00039500: 6620 7370 6c69 745f 6f75 745f 6f6e 5f69  f split_out_on_i
-00039510: 6e64 6578 2864 6629 3a0a 2020 2020 6820  ndex(df):.    h 
-00039520: 3d20 6466 2e69 6e64 6578 0a20 2020 2069  = df.index.    i
-00039530: 6620 6973 696e 7374 616e 6365 2868 2c20  f isinstance(h, 
-00039540: 7064 2e4d 756c 7469 496e 6465 7829 3a0a  pd.MultiIndex):.
-00039550: 2020 2020 2020 2020 6820 3d20 6d65 7461          h = meta
-00039560: 5f66 7261 6d65 5f63 6f6e 7374 7275 6374  _frame_construct
-00039570: 6f72 2864 6629 285b 5d2c 2069 6e64 6578  or(df)([], index
-00039580: 3d68 292e 7265 7365 745f 696e 6465 7828  =h).reset_index(
-00039590: 290a 2020 2020 7265 7475 726e 2068 0a0a  ).    return h..
-000395a0: 0a64 6566 2073 706c 6974 5f6f 7574 5f6f  .def split_out_o
-000395b0: 6e5f 636f 6c73 2864 662c 2063 6f6c 733d  n_cols(df, cols=
-000395c0: 4e6f 6e65 293a 0a20 2020 2072 6574 7572  None):.    retur
-000395d0: 6e20 6466 5b63 6f6c 735d 0a0a 0a40 696e  n df[cols]...@in
-000395e0: 7365 7274 5f6d 6574 615f 7061 7261 6d5f  sert_meta_param_
-000395f0: 6465 7363 7269 7074 696f 6e0a 6465 6620  description.def 
-00039600: 6170 706c 795f 636f 6e63 6174 5f61 7070  apply_concat_app
-00039610: 6c79 280a 2020 2020 6172 6773 2c0a 2020  ly(.    args,.  
-00039620: 2020 6368 756e 6b3d 4e6f 6e65 2c0a 2020    chunk=None,.  
-00039630: 2020 6167 6772 6567 6174 653d 4e6f 6e65    aggregate=None
-00039640: 2c0a 2020 2020 636f 6d62 696e 653d 4e6f  ,.    combine=No
-00039650: 6e65 2c0a 2020 2020 6d65 7461 3d6e 6f5f  ne,.    meta=no_
-00039660: 6465 6661 756c 742c 0a20 2020 2074 6f6b  default,.    tok
-00039670: 656e 3d4e 6f6e 652c 0a20 2020 2063 6875  en=None,.    chu
-00039680: 6e6b 5f6b 7761 7267 733d 4e6f 6e65 2c0a  nk_kwargs=None,.
-00039690: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
-000396a0: 6172 6773 3d4e 6f6e 652c 0a20 2020 2063  args=None,.    c
-000396b0: 6f6d 6269 6e65 5f6b 7761 7267 733d 4e6f  ombine_kwargs=No
-000396c0: 6e65 2c0a 2020 2020 7370 6c69 745f 6576  ne,.    split_ev
-000396d0: 6572 793d 4e6f 6e65 2c0a 2020 2020 7370  ery=None,.    sp
-000396e0: 6c69 745f 6f75 743d 4e6f 6e65 2c0a 2020  lit_out=None,.  
-000396f0: 2020 7370 6c69 745f 6f75 745f 7365 7475    split_out_setu
-00039700: 703d 4e6f 6e65 2c0a 2020 2020 7370 6c69  p=None,.    spli
-00039710: 745f 6f75 745f 7365 7475 705f 6b77 6172  t_out_setup_kwar
-00039720: 6773 3d4e 6f6e 652c 0a20 2020 2073 6f72  gs=None,.    sor
-00039730: 743d 4e6f 6e65 2c0a 2020 2020 6967 6e6f  t=None,.    igno
-00039740: 7265 5f69 6e64 6578 3d46 616c 7365 2c0a  re_index=False,.
-00039750: 2020 2020 2a2a 6b77 6172 6773 2c0a 293a      **kwargs,.):
-00039760: 0a20 2020 2022 2222 4170 706c 7920 6120  .    """Apply a 
-00039770: 6675 6e63 7469 6f6e 2074 6f20 626c 6f63  function to bloc
-00039780: 6b73 2c20 7468 656e 2063 6f6e 6361 742c  ks, then concat,
-00039790: 2074 6865 6e20 6170 706c 7920 6167 6169   then apply agai
-000397a0: 6e0a 0a20 2020 2050 6172 616d 6574 6572  n..    Parameter
-000397b0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-000397c0: 0a20 2020 2061 7267 7320 3a0a 2020 2020  .    args :.    
-000397d0: 2020 2020 506f 7369 7469 6f6e 616c 2061      Positional a
-000397e0: 7267 756d 656e 7473 2066 6f72 2074 6865  rguments for the
-000397f0: 2060 6368 756e 6b60 2066 756e 6374 696f   `chunk` functio
-00039800: 6e2e 2041 6c6c 2060 6461 736b 2e64 6174  n. All `dask.dat
-00039810: 6166 7261 6d65 600a 2020 2020 2020 2020  aframe`.        
-00039820: 6f62 6a65 6374 7320 7368 6f75 6c64 2062  objects should b
-00039830: 6520 7061 7274 6974 696f 6e65 6420 616e  e partitioned an
-00039840: 6420 696e 6465 7865 6420 6571 7569 7661  d indexed equiva
-00039850: 6c65 6e74 6c79 2e0a 2020 2020 6368 756e  lently..    chun
-00039860: 6b20 3a20 6675 6e63 7469 6f6e 205b 626c  k : function [bl
-00039870: 6f63 6b2d 7065 722d 6172 675d 202d 3e20  ock-per-arg] -> 
-00039880: 626c 6f63 6b0a 2020 2020 2020 2020 4675  block.        Fu
-00039890: 6e63 7469 6f6e 2074 6f20 6f70 6572 6174  nction to operat
-000398a0: 6520 6f6e 2065 6163 6820 626c 6f63 6b20  e on each block 
-000398b0: 6f66 2064 6174 610a 2020 2020 6167 6772  of data.    aggr
-000398c0: 6567 6174 6520 3a20 6675 6e63 7469 6f6e  egate : function
-000398d0: 2063 6f6e 6361 7465 6e61 7465 642d 626c   concatenated-bl
-000398e0: 6f63 6b20 2d3e 2062 6c6f 636b 0a20 2020  ock -> block.   
-000398f0: 2020 2020 2046 756e 6374 696f 6e20 746f       Function to
-00039900: 206f 7065 7261 7465 206f 6e20 7468 6520   operate on the 
-00039910: 636f 6e63 6174 656e 6174 6564 2072 6573  concatenated res
-00039920: 756c 7420 6f66 2063 6875 6e6b 0a20 2020  ult of chunk.   
-00039930: 2063 6f6d 6269 6e65 203a 2066 756e 6374   combine : funct
-00039940: 696f 6e20 636f 6e63 6174 656e 6174 6564  ion concatenated
-00039950: 2d62 6c6f 636b 202d 3e20 626c 6f63 6b2c  -block -> block,
-00039960: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00039970: 2020 4675 6e63 7469 6f6e 2074 6f20 6f70    Function to op
-00039980: 6572 6174 6520 6f6e 2069 6e74 6572 6d65  erate on interme
-00039990: 6469 6174 6520 636f 6e63 6174 656e 6174  diate concatenat
-000399a0: 6564 2072 6573 756c 7473 206f 6620 6368  ed results of ch
-000399b0: 756e 6b0a 2020 2020 2020 2020 696e 2061  unk.        in a
-000399c0: 2074 7265 652d 7265 6475 6374 696f 6e2e   tree-reduction.
-000399d0: 2049 6620 6e6f 7420 7072 6f76 6964 6564   If not provided
-000399e0: 2c20 6465 6661 756c 7473 2074 6f20 6167  , defaults to ag
-000399f0: 6772 6567 6174 652e 0a20 2020 2024 4d45  gregate..    $ME
-00039a00: 5441 0a20 2020 2074 6f6b 656e 203a 2073  TA.    token : s
-00039a10: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
-00039a20: 2020 2020 2054 6865 206e 616d 6520 746f       The name to
-00039a30: 2075 7365 2066 6f72 2074 6865 206f 7574   use for the out
-00039a40: 7075 7420 6b65 7973 2e0a 2020 2020 6368  put keys..    ch
-00039a50: 756e 6b5f 6b77 6172 6773 203a 2064 6963  unk_kwargs : dic
-00039a60: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00039a70: 2020 2020 4b65 7977 6f72 6473 2066 6f72      Keywords for
-00039a80: 2074 6865 2063 6875 6e6b 2066 756e 6374   the chunk funct
-00039a90: 696f 6e20 6f6e 6c79 2e0a 2020 2020 6167  ion only..    ag
-00039aa0: 6772 6567 6174 655f 6b77 6172 6773 203a  gregate_kwargs :
-00039ab0: 2064 6963 742c 206f 7074 696f 6e61 6c0a   dict, optional.
-00039ac0: 2020 2020 2020 2020 4b65 7977 6f72 6473          Keywords
-00039ad0: 2066 6f72 2074 6865 2061 6767 7265 6761   for the aggrega
-00039ae0: 7465 2066 756e 6374 696f 6e20 6f6e 6c79  te function only
-00039af0: 2e0a 2020 2020 636f 6d62 696e 655f 6b77  ..    combine_kw
-00039b00: 6172 6773 203a 2064 6963 742c 206f 7074  args : dict, opt
-00039b10: 696f 6e61 6c0a 2020 2020 2020 2020 4b65  ional.        Ke
-00039b20: 7977 6f72 6473 2066 6f72 2074 6865 2063  ywords for the c
-00039b30: 6f6d 6269 6e65 2066 756e 6374 696f 6e20  ombine function 
-00039b40: 6f6e 6c79 2e0a 2020 2020 7370 6c69 745f  only..    split_
-00039b50: 6576 6572 7920 3a20 696e 742c 206f 7074  every : int, opt
-00039b60: 696f 6e61 6c0a 2020 2020 2020 2020 4772  ional.        Gr
-00039b70: 6f75 7020 7061 7274 6974 696f 6e73 2069  oup partitions i
-00039b80: 6e74 6f20 6772 6f75 7073 206f 6620 7468  nto groups of th
-00039b90: 6973 2073 697a 6520 7768 696c 6520 7065  is size while pe
-00039ba0: 7266 6f72 6d69 6e67 2061 0a20 2020 2020  rforming a.     
-00039bb0: 2020 2074 7265 652d 7265 6475 6374 696f     tree-reductio
-00039bc0: 6e2e 2049 6620 7365 7420 746f 2046 616c  n. If set to Fal
-00039bd0: 7365 2c20 6e6f 2074 7265 652d 7265 6475  se, no tree-redu
-00039be0: 6374 696f 6e20 7769 6c6c 2062 6520 7573  ction will be us
-00039bf0: 6564 2c0a 2020 2020 2020 2020 616e 6420  ed,.        and 
-00039c00: 616c 6c20 696e 7465 726d 6564 6961 7465  all intermediate
-00039c10: 7320 7769 6c6c 2062 6520 636f 6e63 6174  s will be concat
-00039c20: 656e 6174 6564 2061 6e64 2070 6173 7365  enated and passe
-00039c30: 6420 746f 2060 6061 6767 7265 6761 7465  d to ``aggregate
-00039c40: 6060 2e0a 2020 2020 2020 2020 4465 6661  ``..        Defa
-00039c50: 756c 7420 6973 2038 2e0a 2020 2020 7370  ult is 8..    sp
-00039c60: 6c69 745f 6f75 7420 3a20 696e 742c 206f  lit_out : int, o
-00039c70: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00039c80: 4e75 6d62 6572 206f 6620 6f75 7470 7574  Number of output
-00039c90: 2070 6172 7469 7469 6f6e 732e 2053 706c   partitions. Spl
-00039ca0: 6974 206f 6363 7572 7320 6166 7465 7220  it occurs after 
-00039cb0: 6669 7273 7420 6368 756e 6b20 7265 6475  first chunk redu
-00039cc0: 6374 696f 6e2e 0a20 2020 2073 706c 6974  ction..    split
-00039cd0: 5f6f 7574 5f73 6574 7570 203a 2063 616c  _out_setup : cal
-00039ce0: 6c61 626c 652c 206f 7074 696f 6e61 6c0a  lable, optional.
-00039cf0: 2020 2020 2020 2020 4966 2070 726f 7669          If provi
-00039d00: 6465 642c 2074 6869 7320 6675 6e63 7469  ded, this functi
-00039d10: 6f6e 2069 7320 6361 6c6c 6564 206f 6e20  on is called on 
-00039d20: 6561 6368 2063 6875 6e6b 2062 6566 6f72  each chunk befor
-00039d30: 6520 7065 7266 6f72 6d69 6e67 0a20 2020  e performing.   
-00039d40: 2020 2020 2074 6865 2068 6173 682d 7370       the hash-sp
-00039d50: 6c69 742e 2049 7420 7368 6f75 6c64 2072  lit. It should r
-00039d60: 6574 7572 6e20 6120 7061 6e64 6173 206f  eturn a pandas o
-00039d70: 626a 6563 742c 2077 6865 7265 2065 6163  bject, where eac
-00039d80: 6820 726f 770a 2020 2020 2020 2020 2865  h row.        (e
-00039d90: 7863 6c75 6469 6e67 2074 6865 2069 6e64  xcluding the ind
-00039da0: 6578 2920 6973 2068 6173 6865 642e 2049  ex) is hashed. I
-00039db0: 6620 6e6f 7420 7072 6f76 6964 6564 2c20  f not provided, 
-00039dc0: 7468 6520 6368 756e 6b20 6973 2068 6173  the chunk is has
-00039dd0: 6865 640a 2020 2020 2020 2020 6173 2069  hed.        as i
-00039de0: 732e 0a20 2020 2073 706c 6974 5f6f 7574  s..    split_out
-00039df0: 5f73 6574 7570 5f6b 7761 7267 7320 3a20  _setup_kwargs : 
-00039e00: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
-00039e10: 2020 2020 2020 204b 6579 776f 7264 7320         Keywords 
-00039e20: 666f 7220 7468 6520 6073 706c 6974 5f6f  for the `split_o
-00039e30: 7574 5f73 6574 7570 6020 6675 6e63 7469  ut_setup` functi
-00039e40: 6f6e 206f 6e6c 792e 0a20 2020 2073 6f72  on only..    sor
-00039e50: 7420 3a20 626f 6f6c 2c20 6465 6661 756c  t : bool, defaul
-00039e60: 7420 4e6f 6e65 0a20 2020 2020 2020 2049  t None.        I
-00039e70: 6620 616c 6c6f 7765 642c 2073 6f72 7420  f allowed, sort 
-00039e80: 7468 6520 6b65 7973 206f 6620 7468 6520  the keys of the 
-00039e90: 6f75 7470 7574 2061 6767 7265 6761 7469  output aggregati
-00039ea0: 6f6e 2e0a 2020 2020 6967 6e6f 7265 5f69  on..    ignore_i
-00039eb0: 6e64 6578 203a 2062 6f6f 6c2c 2064 6566  ndex : bool, def
-00039ec0: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
-00039ed0: 2020 2049 6620 5472 7565 2c20 646f 206e     If True, do n
-00039ee0: 6f74 2070 7265 7365 7276 6520 696e 6465  ot preserve inde
-00039ef0: 7820 7661 6c75 6573 2074 6872 6f75 6768  x values through
-00039f00: 6f75 7420 4143 4120 6f70 6572 6174 696f  out ACA operatio
-00039f10: 6e73 2e0a 2020 2020 6b77 6172 6773 203a  ns..    kwargs :
-00039f20: 0a20 2020 2020 2020 2041 6c6c 2072 656d  .        All rem
-00039f30: 6169 6e69 6e67 206b 6579 776f 7264 7320  aining keywords 
-00039f40: 7769 6c6c 2062 6520 7061 7373 6564 2074  will be passed t
-00039f50: 6f20 6060 6368 756e 6b60 602c 2060 6061  o ``chunk``, ``a
-00039f60: 6767 7265 6761 7465 6060 2c20 616e 640a  ggregate``, and.
-00039f70: 2020 2020 2020 2020 6060 636f 6d62 696e          ``combin
-00039f80: 6560 602e 0a0a 2020 2020 4578 616d 706c  e``...    Exampl
-00039f90: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
-00039fa0: 2020 2020 3e3e 3e20 6465 6620 6368 756e      >>> def chun
-00039fb0: 6b28 615f 626c 6f63 6b2c 2062 5f62 6c6f  k(a_block, b_blo
-00039fc0: 636b 293a 0a20 2020 202e 2e2e 2020 2020  ck):.    ...    
-00039fd0: 2070 6173 730a 0a20 2020 203e 3e3e 2064   pass..    >>> d
-00039fe0: 6566 2061 6767 2864 6629 3a0a 2020 2020  ef agg(df):.    
-00039ff0: 2e2e 2e20 2020 2020 7061 7373 0a0a 2020  ...     pass..  
-0003a000: 2020 3e3e 3e20 6170 706c 795f 636f 6e63    >>> apply_conc
-0003a010: 6174 5f61 7070 6c79 285b 612c 2062 5d2c  at_apply([a, b],
-0003a020: 2063 6875 6e6b 3d63 6875 6e6b 2c20 6167   chunk=chunk, ag
-0003a030: 6772 6567 6174 653d 6167 6729 2020 2320  gregate=agg)  # 
-0003a040: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0003a050: 2020 2022 2222 0a20 2020 2069 6620 7370     """.    if sp
-0003a060: 6c69 745f 6f75 7420 6973 204e 6f6e 653a  lit_out is None:
-0003a070: 0a20 2020 2020 2020 2073 706c 6974 5f6f  .        split_o
-0003a080: 7574 203d 2031 0a20 2020 2069 6620 6368  ut = 1.    if ch
-0003a090: 756e 6b5f 6b77 6172 6773 2069 7320 4e6f  unk_kwargs is No
-0003a0a0: 6e65 3a0a 2020 2020 2020 2020 6368 756e  ne:.        chun
-0003a0b0: 6b5f 6b77 6172 6773 203d 2064 6963 7428  k_kwargs = dict(
-0003a0c0: 290a 2020 2020 6966 2061 6767 7265 6761  ).    if aggrega
-0003a0d0: 7465 5f6b 7761 7267 7320 6973 204e 6f6e  te_kwargs is Non
-0003a0e0: 653a 0a20 2020 2020 2020 2061 6767 7265  e:.        aggre
-0003a0f0: 6761 7465 5f6b 7761 7267 7320 3d20 6469  gate_kwargs = di
-0003a100: 6374 2829 0a20 2020 2063 6875 6e6b 5f6b  ct().    chunk_k
-0003a110: 7761 7267 732e 7570 6461 7465 286b 7761  wargs.update(kwa
-0003a120: 7267 7329 0a20 2020 2061 6767 7265 6761  rgs).    aggrega
-0003a130: 7465 5f6b 7761 7267 732e 7570 6461 7465  te_kwargs.update
-0003a140: 286b 7761 7267 7329 0a0a 2020 2020 6966  (kwargs)..    if
-0003a150: 2063 6f6d 6269 6e65 2069 7320 4e6f 6e65   combine is None
-0003a160: 3a0a 2020 2020 2020 2020 6966 2063 6f6d  :.        if com
-0003a170: 6269 6e65 5f6b 7761 7267 733a 0a20 2020  bine_kwargs:.   
-0003a180: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0003a190: 616c 7565 4572 726f 7228 2260 636f 6d62  alueError("`comb
-0003a1a0: 696e 655f 6b77 6172 6773 6020 7072 6f76  ine_kwargs` prov
-0003a1b0: 6964 6564 2077 6974 6820 6e6f 2060 636f  ided with no `co
-0003a1c0: 6d62 696e 6560 2229 0a20 2020 2020 2020  mbine`").       
-0003a1d0: 2063 6f6d 6269 6e65 203d 2061 6767 7265   combine = aggre
-0003a1e0: 6761 7465 0a20 2020 2020 2020 2063 6f6d  gate.        com
-0003a1f0: 6269 6e65 5f6b 7761 7267 7320 3d20 6167  bine_kwargs = ag
-0003a200: 6772 6567 6174 655f 6b77 6172 6773 0a20  gregate_kwargs. 
-0003a210: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003a220: 2069 6620 636f 6d62 696e 655f 6b77 6172   if combine_kwar
-0003a230: 6773 2069 7320 4e6f 6e65 3a0a 2020 2020  gs is None:.    
-0003a240: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
-0003a250: 6b77 6172 6773 203d 2064 6963 7428 290a  kwargs = dict().
-0003a260: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
-0003a270: 6b77 6172 6773 2e75 7064 6174 6528 6b77  kwargs.update(kw
-0003a280: 6172 6773 290a 0a20 2020 2069 6620 6e6f  args)..    if no
-0003a290: 7420 6973 696e 7374 616e 6365 2861 7267  t isinstance(arg
-0003a2a0: 732c 2028 7475 706c 652c 206c 6973 7429  s, (tuple, list)
-0003a2b0: 293a 0a20 2020 2020 2020 2061 7267 7320  ):.        args 
-0003a2c0: 3d20 5b61 7267 735d 0a0a 2020 2020 6466  = [args]..    df
-0003a2d0: 7320 3d20 5b61 7267 2066 6f72 2061 7267  s = [arg for arg
-0003a2e0: 2069 6e20 6172 6773 2069 6620 6973 696e   in args if isin
-0003a2f0: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
-0003a300: 6d65 295d 0a0a 2020 2020 6e70 6172 7469  me)]..    nparti
-0003a310: 7469 6f6e 7320 3d20 7b61 7267 2e6e 7061  tions = {arg.npa
-0003a320: 7274 6974 696f 6e73 2066 6f72 2061 7267  rtitions for arg
-0003a330: 2069 6e20 6466 737d 0a20 2020 2069 6620   in dfs}.    if 
-0003a340: 6c65 6e28 6e70 6172 7469 7469 6f6e 7329  len(npartitions)
-0003a350: 203e 2031 3a0a 2020 2020 2020 2020 7261   > 1:.        ra
-0003a360: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-0003a370: 416c 6c20 6172 6775 6d65 6e74 7320 6d75  All arguments mu
-0003a380: 7374 2068 6176 6520 7361 6d65 206e 756d  st have same num
-0003a390: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
-0003a3a0: 7322 290a 2020 2020 6e70 6172 7469 7469  s").    npartiti
-0003a3b0: 6f6e 7320 3d20 6e70 6172 7469 7469 6f6e  ons = npartition
-0003a3c0: 732e 706f 7028 290a 0a20 2020 2069 6620  s.pop()..    if 
-0003a3d0: 7370 6c69 745f 6576 6572 7920 6973 204e  split_every is N
-0003a3e0: 6f6e 653a 0a20 2020 2020 2020 2073 706c  one:.        spl
-0003a3f0: 6974 5f65 7665 7279 203d 2038 0a20 2020  it_every = 8.   
-0003a400: 2065 6c69 6620 7370 6c69 745f 6576 6572   elif split_ever
-0003a410: 7920 6973 2046 616c 7365 3a0a 2020 2020  y is False:.    
-0003a420: 2020 2020 7370 6c69 745f 6576 6572 7920      split_every 
-0003a430: 3d20 6e70 6172 7469 7469 6f6e 730a 2020  = npartitions.  
-0003a440: 2020 656c 6966 2073 706c 6974 5f65 7665    elif split_eve
-0003a450: 7279 203c 2032 206f 7220 6e6f 7420 6973  ry < 2 or not is
-0003a460: 696e 7374 616e 6365 2873 706c 6974 5f65  instance(split_e
-0003a470: 7665 7279 2c20 496e 7465 6772 616c 293a  very, Integral):
-0003a480: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
-0003a490: 616c 7565 4572 726f 7228 2273 706c 6974  alueError("split
-0003a4a0: 5f65 7665 7279 206d 7573 7420 6265 2061  _every must be a
-0003a4b0: 6e20 696e 7465 6765 7220 3e3d 2032 2229  n integer >= 2")
-0003a4c0: 0a0a 2020 2020 746f 6b65 6e5f 6b65 7920  ..    token_key 
-0003a4d0: 3d20 746f 6b65 6e69 7a65 280a 2020 2020  = tokenize(.    
-0003a4e0: 2020 2020 746f 6b65 6e20 6f72 2028 6368      token or (ch
-0003a4f0: 756e 6b2c 2061 6767 7265 6761 7465 292c  unk, aggregate),
-0003a500: 0a20 2020 2020 2020 206d 6574 612c 0a20  .        meta,. 
-0003a510: 2020 2020 2020 2061 7267 732c 0a20 2020         args,.   
-0003a520: 2020 2020 2063 6875 6e6b 5f6b 7761 7267       chunk_kwarg
-0003a530: 732c 0a20 2020 2020 2020 2061 6767 7265  s,.        aggre
-0003a540: 6761 7465 5f6b 7761 7267 732c 0a20 2020  gate_kwargs,.   
-0003a550: 2020 2020 2063 6f6d 6269 6e65 5f6b 7761       combine_kwa
-0003a560: 7267 732c 0a20 2020 2020 2020 2073 706c  rgs,.        spl
-0003a570: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
-0003a580: 2020 7370 6c69 745f 6f75 742c 0a20 2020    split_out,.   
-0003a590: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
-0003a5a0: 6574 7570 2c0a 2020 2020 2020 2020 7370  etup,.        sp
-0003a5b0: 6c69 745f 6f75 745f 7365 7475 705f 6b77  lit_out_setup_kw
-0003a5c0: 6172 6773 2c0a 2020 2020 290a 0a20 2020  args,.    )..   
-0003a5d0: 2023 2042 6c6f 636b 7769 7365 2043 6875   # Blockwise Chu
-0003a5e0: 6e6b 204c 6179 6572 0a20 2020 2063 6875  nk Layer.    chu
-0003a5f0: 6e6b 5f6e 616d 6520 3d20 6622 7b74 6f6b  nk_name = f"{tok
-0003a600: 656e 206f 7220 6675 6e63 6e61 6d65 2863  en or funcname(c
-0003a610: 6875 6e6b 297d 2d63 6875 6e6b 2d7b 746f  hunk)}-chunk-{to
-0003a620: 6b65 6e5f 6b65 797d 220a 2020 2020 6368  ken_key}".    ch
-0003a630: 756e 6b65 6420 3d20 6d61 705f 6261 675f  unked = map_bag_
-0003a640: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-0003a650: 2020 2020 6368 756e 6b2c 0a20 2020 2020      chunk,.     
-0003a660: 2020 2023 2043 6f6e 7665 7274 205f 4672     # Convert _Fr
-0003a670: 616d 6520 636f 6c6c 6563 7469 6f6e 7320  ame collections 
-0003a680: 746f 2042 6167 0a20 2020 2020 2020 202a  to Bag.        *
-0003a690: 5b0a 2020 2020 2020 2020 2020 2020 6172  [.            ar
-0003a6a0: 672e 746f 5f62 6167 2866 6f72 6d61 743d  g.to_bag(format=
-0003a6b0: 2266 7261 6d65 2229 2069 6620 6973 696e  "frame") if isin
-0003a6c0: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
-0003a6d0: 6d65 2920 656c 7365 2061 7267 0a20 2020  me) else arg.   
-0003a6e0: 2020 2020 2020 2020 2066 6f72 2061 7267           for arg
-0003a6f0: 2069 6e20 6172 6773 0a20 2020 2020 2020   in args.       
-0003a700: 205d 2c0a 2020 2020 2020 2020 746f 6b65   ],.        toke
-0003a710: 6e3d 6368 756e 6b5f 6e61 6d65 2c0a 2020  n=chunk_name,.  
-0003a720: 2020 2020 2020 2a2a 6368 756e 6b5f 6b77        **chunk_kw
-0003a730: 6172 6773 2c0a 2020 2020 290a 0a20 2020  args,.    )..   
-0003a740: 2023 204e 4f54 453a 2060 6368 756e 6b65   # NOTE: `chunke
-0003a750: 6460 2069 7320 6e6f 7720 6120 4261 6720  d` is now a Bag 
-0003a760: 636f 6c6c 6563 7469 6f6e 2e0a 2020 2020  collection..    
-0003a770: 2320 5765 2064 6f6e 2774 2075 7365 2061  # We don't use a
-0003a780: 2044 6174 6146 7261 6d65 2063 6f6c 6c65   DataFrame colle
-0003a790: 6374 696f 6e2c 2062 6563 6175 7365 0a20  ction, because. 
-0003a7a0: 2020 2023 2074 6865 2070 6172 7469 7469     # the partiti
-0003a7b0: 6f6e 7320 6d61 7920 6e6f 7420 636f 6e74  ons may not cont
-0003a7c0: 6169 6e20 6461 7461 6672 616d 652d 6c69  ain dataframe-li
-0003a7d0: 6b65 0a20 2020 2023 206f 626a 6563 7473  ke.    # objects
-0003a7e0: 2061 6e79 6d6f 7265 2e0a 0a20 2020 2023   anymore...    #
-0003a7f0: 2042 6c6f 636b 7769 7365 2053 706c 6974   Blockwise Split
-0003a800: 204c 6179 6572 0a20 2020 2069 6620 7370   Layer.    if sp
-0003a810: 6c69 745f 6f75 7420 616e 6420 7370 6c69  lit_out and spli
-0003a820: 745f 6f75 7420 3e20 313a 0a20 2020 2020  t_out > 1:.     
-0003a830: 2020 2063 6875 6e6b 6564 203d 2063 6875     chunked = chu
-0003a840: 6e6b 6564 2e6d 6170 5f70 6172 7469 7469  nked.map_partiti
-0003a850: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-0003a860: 2068 6173 685f 7368 6172 642c 0a20 2020   hash_shard,.   
-0003a870: 2020 2020 2020 2020 2073 706c 6974 5f6f           split_o
-0003a880: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
-0003a890: 7370 6c69 745f 6f75 745f 7365 7475 702c  split_out_setup,
-0003a8a0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-0003a8b0: 6974 5f6f 7574 5f73 6574 7570 5f6b 7761  it_out_setup_kwa
-0003a8c0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-0003a8d0: 2069 676e 6f72 655f 696e 6465 782c 0a20   ignore_index,. 
-0003a8e0: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
-0003a8f0: 3d22 7370 6c69 742d 2573 2220 2520 746f  ="split-%s" % to
-0003a900: 6b65 6e5f 6b65 792c 0a20 2020 2020 2020  ken_key,.       
-0003a910: 2029 0a0a 2020 2020 2320 4861 6e64 6c65   )..    # Handle
-0003a920: 2073 6f72 7420 6265 6861 7669 6f72 0a20   sort behavior. 
-0003a930: 2020 2069 6620 736f 7274 2069 7320 6e6f     if sort is no
-0003a940: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0003a950: 6966 2073 6f72 7420 616e 6420 7370 6c69  if sort and spli
-0003a960: 745f 6f75 7420 3e20 313a 0a20 2020 2020  t_out > 1:.     
-0003a970: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0003a980: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0003a990: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003a9a0: 2020 2243 616e 6e6f 7420 6775 6172 616e    "Cannot guaran
-0003a9b0: 7465 6520 736f 7274 6564 206b 6579 7320  tee sorted keys 
-0003a9c0: 666f 7220 6073 706c 6974 5f6f 7574 3e31  for `split_out>1
-0003a9d0: 602e 220a 2020 2020 2020 2020 2020 2020  `.".            
-0003a9e0: 2020 2020 2220 5472 7920 7573 696e 6720      " Try using 
-0003a9f0: 7370 6c69 745f 6f75 743d 312c 206f 7220  split_out=1, or 
-0003aa00: 6772 6f75 7069 6e67 2077 6974 6820 736f  grouping with so
-0003aa10: 7274 3d46 616c 7365 2e22 0a20 2020 2020  rt=False.".     
-0003aa20: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0003aa30: 2061 6767 7265 6761 7465 5f6b 7761 7267   aggregate_kwarg
-0003aa40: 7320 3d20 6167 6772 6567 6174 655f 6b77  s = aggregate_kw
-0003aa50: 6172 6773 206f 7220 7b7d 0a20 2020 2020  args or {}.     
-0003aa60: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
-0003aa70: 7267 735b 2273 6f72 7422 5d20 3d20 736f  rgs["sort"] = so
-0003aa80: 7274 0a0a 2020 2020 2320 5472 6565 2d52  rt..    # Tree-R
-0003aa90: 6564 7563 7469 6f6e 204c 6179 6572 0a20  eduction Layer. 
-0003aaa0: 2020 2066 696e 616c 5f6e 616d 6520 3d20     final_name = 
-0003aab0: 6622 7b74 6f6b 656e 206f 7220 6675 6e63  f"{token or func
-0003aac0: 6e61 6d65 2861 6767 7265 6761 7465 297d  name(aggregate)}
-0003aad0: 2d61 6767 2d7b 746f 6b65 6e5f 6b65 797d  -agg-{token_key}
-0003aae0: 220a 2020 2020 6c61 7965 7220 3d20 4461  ".    layer = Da
-0003aaf0: 7461 4672 616d 6554 7265 6552 6564 7563  taFrameTreeReduc
-0003ab00: 7469 6f6e 280a 2020 2020 2020 2020 6669  tion(.        fi
-0003ab10: 6e61 6c5f 6e61 6d65 2c0a 2020 2020 2020  nal_name,.      
-0003ab20: 2020 6368 756e 6b65 642e 6e61 6d65 2c0a    chunked.name,.
-0003ab30: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
-0003ab40: 6f6e 732c 0a20 2020 2020 2020 2070 6172  ons,.        par
-0003ab50: 7469 616c 285f 636f 6e63 6174 2c20 6967  tial(_concat, ig
-0003ab60: 6e6f 7265 5f69 6e64 6578 3d69 676e 6f72  nore_index=ignor
-0003ab70: 655f 696e 6465 7829 2c0a 2020 2020 2020  e_index),.      
-0003ab80: 2020 7061 7274 6961 6c28 636f 6d62 696e    partial(combin
-0003ab90: 652c 202a 2a63 6f6d 6269 6e65 5f6b 7761  e, **combine_kwa
-0003aba0: 7267 7329 2069 6620 636f 6d62 696e 655f  rgs) if combine_
-0003abb0: 6b77 6172 6773 2065 6c73 6520 636f 6d62  kwargs else comb
-0003abc0: 696e 652c 0a20 2020 2020 2020 2066 696e  ine,.        fin
-0003abd0: 616c 697a 655f 6675 6e63 3d70 6172 7469  alize_func=parti
-0003abe0: 616c 2861 6767 7265 6761 7465 2c20 2a2a  al(aggregate, **
-0003abf0: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
-0003ac00: 290a 2020 2020 2020 2020 6966 2061 6767  ).        if agg
-0003ac10: 7265 6761 7465 5f6b 7761 7267 730a 2020  regate_kwargs.  
-0003ac20: 2020 2020 2020 656c 7365 2061 6767 7265        else aggre
-0003ac30: 6761 7465 2c0a 2020 2020 2020 2020 7370  gate,.        sp
-0003ac40: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-0003ac50: 6576 6572 792c 0a20 2020 2020 2020 2073  every,.        s
-0003ac60: 706c 6974 5f6f 7574 3d73 706c 6974 5f6f  plit_out=split_o
-0003ac70: 7574 2069 6620 2873 706c 6974 5f6f 7574  ut if (split_out
-0003ac80: 2061 6e64 2073 706c 6974 5f6f 7574 203e   and split_out >
-0003ac90: 2031 2920 656c 7365 204e 6f6e 652c 0a20   1) else None,. 
-0003aca0: 2020 2020 2020 2074 7265 655f 6e6f 6465         tree_node
-0003acb0: 5f6e 616d 653d 6622 7b74 6f6b 656e 206f  _name=f"{token o
-0003acc0: 7220 6675 6e63 6e61 6d65 2863 6f6d 6269  r funcname(combi
-0003acd0: 6e65 297d 2d63 6f6d 6269 6e65 2d7b 746f  ne)}-combine-{to
-0003ace0: 6b65 6e5f 6b65 797d 222c 0a20 2020 2029  ken_key}",.    )
-0003acf0: 0a0a 2020 2020 6966 206d 6574 6120 6973  ..    if meta is
-0003ad00: 206e 6f5f 6465 6661 756c 743a 0a20 2020   no_default:.   
-0003ad10: 2020 2020 206d 6574 615f 6368 756e 6b20       meta_chunk 
-0003ad20: 3d20 5f65 6d75 6c61 7465 2863 6875 6e6b  = _emulate(chunk
-0003ad30: 2c20 2a61 7267 732c 2075 6466 3d54 7275  , *args, udf=Tru
-0003ad40: 652c 202a 2a63 6875 6e6b 5f6b 7761 7267  e, **chunk_kwarg
-0003ad50: 7329 0a20 2020 2020 2020 206d 6574 6120  s).        meta 
-0003ad60: 3d20 5f65 6d75 6c61 7465 280a 2020 2020  = _emulate(.    
-0003ad70: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-0003ad80: 652c 205f 636f 6e63 6174 285b 6d65 7461  e, _concat([meta
-0003ad90: 5f63 6875 6e6b 5d2c 2069 676e 6f72 655f  _chunk], ignore_
-0003ada0: 696e 6465 7829 2c20 7564 663d 5472 7565  index), udf=True
-0003adb0: 2c20 2a2a 6167 6772 6567 6174 655f 6b77  , **aggregate_kw
-0003adc0: 6172 6773 0a20 2020 2020 2020 2029 0a20  args.        ). 
-0003add0: 2020 206d 6574 6120 3d20 6d61 6b65 5f6d     meta = make_m
-0003ade0: 6574 6128 0a20 2020 2020 2020 206d 6574  eta(.        met
-0003adf0: 612c 0a20 2020 2020 2020 2069 6e64 6578  a,.        index
-0003ae00: 3d28 6765 7461 7474 7228 6d61 6b65 5f6d  =(getattr(make_m
-0003ae10: 6574 6128 6466 735b 305d 292c 2022 696e  eta(dfs[0]), "in
-0003ae20: 6465 7822 2c20 4e6f 6e65 2920 6966 2064  dex", None) if d
-0003ae30: 6673 2065 6c73 6520 4e6f 6e65 292c 0a20  fs else None),. 
-0003ae40: 2020 2020 2020 2070 6172 656e 745f 6d65         parent_me
-0003ae50: 7461 3d64 6673 5b30 5d2e 5f6d 6574 612c  ta=dfs[0]._meta,
-0003ae60: 0a20 2020 2029 0a0a 2020 2020 6772 6170  .    )..    grap
-0003ae70: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
-0003ae80: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
-0003ae90: 6f6e 7328 6669 6e61 6c5f 6e61 6d65 2c20  ons(final_name, 
-0003aea0: 6c61 7965 722c 2064 6570 656e 6465 6e63  layer, dependenc
-0003aeb0: 6965 733d 2863 6875 6e6b 6564 2c29 290a  ies=(chunked,)).
-0003aec0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
-0003aed0: 5b4e 6f6e 655d 202a 2028 2873 706c 6974  [None] * ((split
-0003aee0: 5f6f 7574 206f 7220 3129 202b 2031 290a  _out or 1) + 1).
-0003aef0: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
-0003af00: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
-0003af10: 6669 6e61 6c5f 6e61 6d65 2c20 6d65 7461  final_name, meta
-0003af20: 2c20 6469 7669 7369 6f6e 732c 2070 6172  , divisions, par
-0003af30: 656e 745f 6d65 7461 3d64 6673 5b30 5d2e  ent_meta=dfs[0].
-0003af40: 5f6d 6574 6129 0a0a 0a61 6361 203d 2061  _meta)...aca = a
-0003af50: 7070 6c79 5f63 6f6e 6361 745f 6170 706c  pply_concat_appl
-0003af60: 790a 0a0a 6465 6620 5f65 7874 7261 6374  y...def _extract
-0003af70: 5f6d 6574 6128 782c 206e 6f6e 656d 7074  _meta(x, nonempt
-0003af80: 793d 4661 6c73 6529 3a0a 2020 2020 2222  y=False):.    ""
-0003af90: 220a 2020 2020 4578 7472 6163 7420 696e  ".    Extract in
-0003afa0: 7465 726e 616c 2063 6163 6865 2064 6174  ternal cache dat
-0003afb0: 6120 2860 605f 6d65 7461 6060 2920 6672  a (``_meta``) fr
-0003afc0: 6f6d 2064 642e 4461 7461 4672 616d 6520  om dd.DataFrame 
-0003afd0: 2f20 6464 2e53 6572 6965 730a 2020 2020  / dd.Series.    
-0003afe0: 2222 220a 2020 2020 6966 2069 7369 6e73  """.    if isins
-0003aff0: 7461 6e63 6528 782c 2028 5363 616c 6172  tance(x, (Scalar
-0003b000: 2c20 5f46 7261 6d65 2929 3a0a 2020 2020  , _Frame)):.    
-0003b010: 2020 2020 7265 7475 726e 2078 2e5f 6d65      return x._me
-0003b020: 7461 5f6e 6f6e 656d 7074 7920 6966 206e  ta_nonempty if n
-0003b030: 6f6e 656d 7074 7920 656c 7365 2078 2e5f  onempty else x._
-0003b040: 6d65 7461 0a20 2020 2065 6c69 6620 6973  meta.    elif is
-0003b050: 696e 7374 616e 6365 2878 2c20 6c69 7374  instance(x, list
-0003b060: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0003b070: 6e20 5b5f 6578 7472 6163 745f 6d65 7461  n [_extract_meta
-0003b080: 285f 782c 206e 6f6e 656d 7074 7929 2066  (_x, nonempty) f
-0003b090: 6f72 205f 7820 696e 2078 5d0a 2020 2020  or _x in x].    
-0003b0a0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-0003b0b0: 782c 2074 7570 6c65 293a 0a20 2020 2020  x, tuple):.     
-0003b0c0: 2020 2072 6574 7572 6e20 7475 706c 6528     return tuple(
-0003b0d0: 5f65 7874 7261 6374 5f6d 6574 6128 5f78  _extract_meta(_x
-0003b0e0: 2c20 6e6f 6e65 6d70 7479 2920 666f 7220  , nonempty) for 
-0003b0f0: 5f78 2069 6e20 7829 0a20 2020 2065 6c69  _x in x).    eli
-0003b100: 6620 6973 696e 7374 616e 6365 2878 2c20  f isinstance(x, 
-0003b110: 6469 6374 293a 0a20 2020 2020 2020 2072  dict):.        r
-0003b120: 6573 203d 207b 7d0a 2020 2020 2020 2020  es = {}.        
-0003b130: 666f 7220 6b20 696e 2078 3a0a 2020 2020  for k in x:.    
-0003b140: 2020 2020 2020 2020 7265 735b 6b5d 203d          res[k] =
-0003b150: 205f 6578 7472 6163 745f 6d65 7461 2878   _extract_meta(x
-0003b160: 5b6b 5d2c 206e 6f6e 656d 7074 7929 0a20  [k], nonempty). 
-0003b170: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-0003b180: 730a 2020 2020 656c 6966 2069 7369 6e73  s.    elif isins
-0003b190: 7461 6e63 6528 782c 2044 656c 6179 6564  tance(x, Delayed
-0003b1a0: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
-0003b1b0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-0003b1c0: 2020 2020 2020 2020 2022 4361 6e6e 6f74           "Cannot
-0003b1d0: 2069 6e66 6572 2064 6174 6166 7261 6d65   infer dataframe
-0003b1e0: 206d 6574 6164 6174 6120 7769 7468 2061   metadata with a
-0003b1f0: 2060 6461 736b 2e64 656c 6179 6564 6020   `dask.delayed` 
-0003b200: 6172 6775 6d65 6e74 220a 2020 2020 2020  argument".      
-0003b210: 2020 290a 2020 2020 656c 7365 3a0a 2020    ).    else:.  
-0003b220: 2020 2020 2020 7265 7475 726e 2078 0a0a        return x..
-0003b230: 0a64 6566 205f 656d 756c 6174 6528 6675  .def _emulate(fu
-0003b240: 6e63 2c20 2a61 7267 732c 2075 6466 3d46  nc, *args, udf=F
-0003b250: 616c 7365 2c20 2a2a 6b77 6172 6773 293a  alse, **kwargs):
-0003b260: 0a20 2020 2022 2222 0a20 2020 2041 7070  .    """.    App
-0003b270: 6c79 2061 2066 756e 6374 696f 6e20 7573  ly a function us
-0003b280: 696e 6720 6172 6773 202f 206b 7761 7267  ing args / kwarg
-0003b290: 732e 2049 6620 6172 6775 6d65 6e74 7320  s. If arguments 
-0003b2a0: 636f 6e74 6169 6e20 6464 2e44 6174 6146  contain dd.DataF
-0003b2b0: 7261 6d65 202f 0a20 2020 2064 642e 5365  rame /.    dd.Se
-0003b2c0: 7269 6573 2c20 7573 696e 6720 696e 7465  ries, using inte
-0003b2d0: 726e 616c 2063 6163 6865 2028 6060 5f6d  rnal cache (``_m
-0003b2e0: 6574 6160 6029 2066 6f72 2063 616c 6375  eta``) for calcu
-0003b2f0: 6c61 7469 6f6e 0a20 2020 2022 2222 0a20  lation.    """. 
-0003b300: 2020 2077 6974 6820 7261 6973 655f 6f6e     with raise_on
-0003b310: 5f6d 6574 615f 6572 726f 7228 6675 6e63  _meta_error(func
-0003b320: 6e61 6d65 2866 756e 6329 2c20 7564 663d  name(func), udf=
-0003b330: 7564 6629 2c20 6368 6563 6b5f 6e75 6d65  udf), check_nume
-0003b340: 7269 635f 6f6e 6c79 5f64 6570 7265 6361  ric_only_depreca
-0003b350: 7469 6f6e 2829 3a0a 2020 2020 2020 2020  tion():.        
-0003b360: 7265 7475 726e 2066 756e 6328 2a5f 6578  return func(*_ex
-0003b370: 7472 6163 745f 6d65 7461 2861 7267 732c  tract_meta(args,
-0003b380: 2054 7275 6529 2c20 2a2a 5f65 7874 7261   True), **_extra
-0003b390: 6374 5f6d 6574 6128 6b77 6172 6773 2c20  ct_meta(kwargs, 
-0003b3a0: 5472 7565 2929 0a0a 0a40 696e 7365 7274  True))...@insert
-0003b3b0: 5f6d 6574 615f 7061 7261 6d5f 6465 7363  _meta_param_desc
-0003b3c0: 7269 7074 696f 6e0a 6465 6620 6d61 705f  ription.def map_
-0003b3d0: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-0003b3e0: 6675 6e63 2c0a 2020 2020 2a61 7267 732c  func,.    *args,
-0003b3f0: 0a20 2020 206d 6574 613d 6e6f 5f64 6566  .    meta=no_def
-0003b400: 6175 6c74 2c0a 2020 2020 656e 666f 7263  ault,.    enforc
-0003b410: 655f 6d65 7461 6461 7461 3d54 7275 652c  e_metadata=True,
-0003b420: 0a20 2020 2074 7261 6e73 666f 726d 5f64  .    transform_d
-0003b430: 6976 6973 696f 6e73 3d54 7275 652c 0a20  ivisions=True,. 
-0003b440: 2020 2061 6c69 676e 5f64 6174 6166 7261     align_datafra
-0003b450: 6d65 733d 5472 7565 2c0a 2020 2020 2a2a  mes=True,.    **
-0003b460: 6b77 6172 6773 2c0a 293a 0a20 2020 2022  kwargs,.):.    "
-0003b470: 2222 4170 706c 7920 5079 7468 6f6e 2066  ""Apply Python f
-0003b480: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
-0003b490: 4461 7461 4672 616d 6520 7061 7274 6974  DataFrame partit
-0003b4a0: 696f 6e2e 0a0a 2020 2020 5061 7261 6d65  ion...    Parame
-0003b4b0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-0003b4c0: 2d2d 2d0a 2020 2020 6675 6e63 203a 2066  ---.    func : f
-0003b4d0: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
-0003b4e0: 4675 6e63 7469 6f6e 2061 7070 6c69 6564  Function applied
-0003b4f0: 2074 6f20 6561 6368 2070 6172 7469 7469   to each partiti
-0003b500: 6f6e 2e0a 2020 2020 6172 6773 2c20 6b77  on..    args, kw
-0003b510: 6172 6773 203a 0a20 2020 2020 2020 2041  args :.        A
-0003b520: 7267 756d 656e 7473 2061 6e64 206b 6579  rguments and key
-0003b530: 776f 7264 7320 746f 2070 6173 7320 746f  words to pass to
-0003b540: 2074 6865 2066 756e 6374 696f 6e2e 2020   the function.  
-0003b550: 4174 206c 6561 7374 206f 6e65 206f 6620  At least one of 
-0003b560: 7468 650a 2020 2020 2020 2020 6172 6773  the.        args
-0003b570: 2073 686f 756c 6420 6265 2061 2044 6173   should be a Das
-0003b580: 6b2e 6461 7461 6672 616d 652e 2041 7267  k.dataframe. Arg
-0003b590: 756d 656e 7473 2061 6e64 206b 6579 776f  uments and keywo
-0003b5a0: 7264 7320 6d61 7920 636f 6e74 6169 6e0a  rds may contain.
-0003b5b0: 2020 2020 2020 2020 6060 5363 616c 6172          ``Scalar
-0003b5c0: 6060 2c20 6060 4465 6c61 7965 6460 6020  ``, ``Delayed`` 
-0003b5d0: 6f72 2072 6567 756c 6172 2070 7974 686f  or regular pytho
-0003b5e0: 6e20 6f62 6a65 6374 732e 2044 6174 6146  n objects. DataF
-0003b5f0: 7261 6d65 2d6c 696b 6520 6172 6773 0a20  rame-like args. 
-0003b600: 2020 2020 2020 2028 626f 7468 2064 6173         (both das
-0003b610: 6b20 616e 6420 7061 6e64 6173 2920 7769  k and pandas) wi
-0003b620: 6c6c 2062 6520 7265 7061 7274 6974 696f  ll be repartitio
-0003b630: 6e65 6420 746f 2061 6c69 676e 2028 6966  ned to align (if
-0003b640: 206e 6563 6573 7361 7279 290a 2020 2020   necessary).    
-0003b650: 2020 2020 6265 666f 7265 2061 7070 6c79      before apply
-0003b660: 696e 6720 7468 6520 6675 6e63 7469 6f6e  ing the function
-0003b670: 2028 7365 6520 6060 616c 6967 6e5f 6461   (see ``align_da
-0003b680: 7461 6672 616d 6573 6060 2074 6f20 636f  taframes`` to co
-0003b690: 6e74 726f 6c29 2e0a 2020 2020 656e 666f  ntrol)..    enfo
-0003b6a0: 7263 655f 6d65 7461 6461 7461 203a 2062  rce_metadata : b
-0003b6b0: 6f6f 6c2c 2064 6566 6175 6c74 2054 7275  ool, default Tru
-0003b6c0: 650a 2020 2020 2020 2020 5768 6574 6865  e.        Whethe
-0003b6d0: 7220 746f 2065 6e66 6f72 6365 2061 7420  r to enforce at 
-0003b6e0: 7275 6e74 696d 6520 7468 6174 2074 6865  runtime that the
-0003b6f0: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
-0003b700: 6520 4461 7461 4672 616d 650a 2020 2020  e DataFrame.    
-0003b710: 2020 2020 7072 6f64 7563 6564 2062 7920      produced by 
-0003b720: 6060 6675 6e63 6060 2061 6374 7561 6c6c  ``func`` actuall
-0003b730: 7920 6d61 7463 6865 7320 7468 6520 7374  y matches the st
-0003b740: 7275 6374 7572 6520 6f66 2060 606d 6574  ructure of ``met
-0003b750: 6160 602e 0a20 2020 2020 2020 2054 6869  a``..        Thi
-0003b760: 7320 7769 6c6c 2072 656e 616d 6520 616e  s will rename an
-0003b770: 6420 7265 6f72 6465 7220 636f 6c75 6d6e  d reorder column
-0003b780: 7320 666f 7220 6561 6368 2070 6172 7469  s for each parti
-0003b790: 7469 6f6e 2c0a 2020 2020 2020 2020 616e  tion,.        an
-0003b7a0: 6420 7769 6c6c 2072 6169 7365 2061 6e20  d will raise an 
-0003b7b0: 6572 726f 7220 6966 2074 6869 7320 646f  error if this do
-0003b7c0: 6573 6e27 7420 776f 726b 2c0a 2020 2020  esn't work,.    
-0003b7d0: 2020 2020 6275 7420 6974 2077 6f6e 2774      but it won't
-0003b7e0: 2072 6169 7365 2069 6620 6474 7970 6573   raise if dtypes
-0003b7f0: 2064 6f6e 2774 206d 6174 6368 2e0a 2020   don't match..  
-0003b800: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
-0003b810: 7369 6f6e 7320 3a20 626f 6f6c 2c20 6465  sions : bool, de
-0003b820: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
-0003b830: 2020 2057 6865 7468 6572 2074 6f20 6170     Whether to ap
-0003b840: 706c 7920 7468 6520 6675 6e63 7469 6f6e  ply the function
-0003b850: 206f 6e74 6f20 7468 6520 6469 7669 7369   onto the divisi
-0003b860: 6f6e 7320 616e 6420 6170 706c 7920 7468  ons and apply th
-0003b870: 6f73 650a 2020 2020 2020 2020 7472 616e  ose.        tran
-0003b880: 7366 6f72 6d65 6420 6469 7669 7369 6f6e  sformed division
-0003b890: 7320 746f 2074 6865 206f 7574 7075 742e  s to the output.
-0003b8a0: 0a20 2020 2061 6c69 676e 5f64 6174 6166  .    align_dataf
-0003b8b0: 7261 6d65 7320 3a20 626f 6f6c 2c20 6465  rames : bool, de
-0003b8c0: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
-0003b8d0: 2020 2057 6865 7468 6572 2074 6f20 7265     Whether to re
-0003b8e0: 7061 7274 6974 696f 6e20 4461 7461 4672  partition DataFr
-0003b8f0: 616d 652d 206f 7220 5365 7269 6573 2d6c  ame- or Series-l
-0003b900: 696b 6520 6172 6773 0a20 2020 2020 2020  ike args.       
-0003b910: 2028 626f 7468 2064 6173 6b20 616e 6420   (both dask and 
-0003b920: 7061 6e64 6173 2920 736f 2074 6865 6972  pandas) so their
-0003b930: 2064 6976 6973 696f 6e73 2061 6c69 676e   divisions align
-0003b940: 2062 6566 6f72 6520 6170 706c 7969 6e67   before applying
-0003b950: 0a20 2020 2020 2020 2074 6865 2066 756e  .        the fun
-0003b960: 6374 696f 6e2e 2054 6869 7320 7265 7175  ction. This requ
-0003b970: 6972 6573 2061 6c6c 2069 6e70 7574 7320  ires all inputs 
-0003b980: 746f 2068 6176 6520 6b6e 6f77 6e20 6469  to have known di
-0003b990: 7669 7369 6f6e 732e 0a20 2020 2020 2020  visions..       
-0003b9a0: 2053 696e 676c 652d 7061 7274 6974 696f   Single-partitio
-0003b9b0: 6e20 696e 7075 7473 2077 696c 6c20 6265  n inputs will be
-0003b9c0: 2073 706c 6974 2069 6e74 6f20 6d75 6c74   split into mult
-0003b9d0: 6970 6c65 2070 6172 7469 7469 6f6e 732e  iple partitions.
-0003b9e0: 0a0a 2020 2020 2020 2020 4966 2046 616c  ..        If Fal
-0003b9f0: 7365 2c20 616c 6c20 696e 7075 7473 206d  se, all inputs m
-0003ba00: 7573 7420 6861 7665 2065 6974 6865 7220  ust have either 
-0003ba10: 7468 6520 7361 6d65 206e 756d 6265 7220  the same number 
-0003ba20: 6f66 2070 6172 7469 7469 6f6e 730a 2020  of partitions.  
-0003ba30: 2020 2020 2020 6f72 2061 2073 696e 676c        or a singl
-0003ba40: 6520 7061 7274 6974 696f 6e2e 2053 696e  e partition. Sin
-0003ba50: 676c 652d 7061 7274 6974 696f 6e20 696e  gle-partition in
-0003ba60: 7075 7473 2077 696c 6c20 6265 2062 726f  puts will be bro
-0003ba70: 6164 6361 7374 2074 6f0a 2020 2020 2020  adcast to.      
-0003ba80: 2020 6576 6572 7920 7061 7274 6974 696f    every partitio
-0003ba90: 6e20 6f66 206d 756c 7469 2d70 6172 7469  n of multi-parti
-0003baa0: 7469 6f6e 2069 6e70 7574 732e 0a20 2020  tion inputs..   
-0003bab0: 2024 4d45 5441 0a20 2020 2022 2222 0a20   $META.    """. 
-0003bac0: 2020 206e 616d 6520 3d20 6b77 6172 6773     name = kwargs
-0003bad0: 2e70 6f70 2822 746f 6b65 6e22 2c20 4e6f  .pop("token", No
-0003bae0: 6e65 290a 2020 2020 7061 7265 6e74 5f6d  ne).    parent_m
-0003baf0: 6574 6120 3d20 6b77 6172 6773 2e70 6f70  eta = kwargs.pop
-0003bb00: 2822 7061 7265 6e74 5f6d 6574 6122 2c20  ("parent_meta", 
-0003bb10: 4e6f 6e65 290a 0a20 2020 2061 7373 6572  None)..    asser
-0003bb20: 7420 6361 6c6c 6162 6c65 2866 756e 6329  t callable(func)
-0003bb30: 0a20 2020 2069 6620 6e61 6d65 2069 7320  .    if name is 
-0003bb40: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0003bb50: 2020 746f 6b65 6e20 3d20 746f 6b65 6e69    token = tokeni
-0003bb60: 7a65 286d 6574 612c 202a 6172 6773 2c20  ze(meta, *args, 
-0003bb70: 2a2a 6b77 6172 6773 290a 2020 2020 656c  **kwargs).    el
-0003bb80: 7365 3a0a 2020 2020 2020 2020 6e61 6d65  se:.        name
-0003bb90: 203d 2066 756e 636e 616d 6528 6675 6e63   = funcname(func
-0003bba0: 290a 2020 2020 2020 2020 746f 6b65 6e20  ).        token 
-0003bbb0: 3d20 746f 6b65 6e69 7a65 2866 756e 632c  = tokenize(func,
-0003bbc0: 206d 6574 612c 202a 6172 6773 2c20 2a2a   meta, *args, **
-0003bbd0: 6b77 6172 6773 290a 2020 2020 6e61 6d65  kwargs).    name
-0003bbe0: 203d 2066 227b 6e61 6d65 7d2d 7b74 6f6b   = f"{name}-{tok
-0003bbf0: 656e 7d22 0a0a 2020 2020 6672 6f6d 2064  en}"..    from d
-0003bc00: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
-0003bc10: 6c74 6920 696d 706f 7274 205f 6d61 7962  lti import _mayb
-0003bc20: 655f 616c 6967 6e5f 7061 7274 6974 696f  e_align_partitio
-0003bc30: 6e73 0a0a 2020 2020 6966 2061 6c69 676e  ns..    if align
-0003bc40: 5f64 6174 6166 7261 6d65 733a 0a20 2020  _dataframes:.   
-0003bc50: 2020 2020 2061 7267 7320 3d20 5f6d 6179       args = _may
-0003bc60: 6265 5f66 726f 6d5f 7061 6e64 6173 2861  be_from_pandas(a
-0003bc70: 7267 7329 0a20 2020 2020 2020 2074 7279  rgs).        try
-0003bc80: 3a0a 2020 2020 2020 2020 2020 2020 6172  :.            ar
-0003bc90: 6773 203d 205f 6d61 7962 655f 616c 6967  gs = _maybe_alig
-0003bca0: 6e5f 7061 7274 6974 696f 6e73 2861 7267  n_partitions(arg
-0003bcb0: 7329 0a20 2020 2020 2020 2065 7863 6570  s).        excep
-0003bcc0: 7420 5661 6c75 6545 7272 6f72 2061 7320  t ValueError as 
-0003bcd0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0003bce0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0003bcf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003bd00: 2066 227b 657d 2e20 4966 2079 6f75 2064   f"{e}. If you d
-0003bd10: 6f6e 2774 2077 616e 7420 7468 6520 7061  on't want the pa
-0003bd20: 7274 6974 696f 6e73 2074 6f20 6265 2061  rtitions to be a
-0003bd30: 6c69 676e 6564 2c20 616e 6420 6172 6520  ligned, and are 
-0003bd40: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0003bd50: 2020 2263 616c 6c69 6e67 2060 6d61 705f    "calling `map_
-0003bd60: 7061 7274 6974 696f 6e73 6020 6469 7265  partitions` dire
-0003bd70: 6374 6c79 2c20 7061 7373 2060 616c 6967  ctly, pass `alig
-0003bd80: 6e5f 6461 7461 6672 616d 6573 3d46 616c  n_dataframes=Fal
-0003bd90: 7365 602e 220a 2020 2020 2020 2020 2020  se`.".          
-0003bda0: 2020 2920 6672 6f6d 2065 0a0a 2020 2020    ) from e..    
-0003bdb0: 6466 7320 3d20 5b64 6620 666f 7220 6466  dfs = [df for df
-0003bdc0: 2069 6e20 6172 6773 2069 6620 6973 696e   in args if isin
-0003bdd0: 7374 616e 6365 2864 662c 205f 4672 616d  stance(df, _Fram
-0003bde0: 6529 5d0a 0a20 2020 206d 6574 6120 3d20  e)]..    meta = 
-0003bdf0: 5f67 6574 5f6d 6574 615f 6d61 705f 7061  _get_meta_map_pa
-0003be00: 7274 6974 696f 6e73 2861 7267 732c 2064  rtitions(args, d
-0003be10: 6673 2c20 6675 6e63 2c20 6b77 6172 6773  fs, func, kwargs
-0003be20: 2c20 6d65 7461 2c20 7061 7265 6e74 5f6d  , meta, parent_m
-0003be30: 6574 6129 0a20 2020 2069 6620 616c 6c28  eta).    if all(
-0003be40: 6973 696e 7374 616e 6365 2861 7267 2c20  isinstance(arg, 
-0003be50: 5363 616c 6172 2920 666f 7220 6172 6720  Scalar) for arg 
-0003be60: 696e 2061 7267 7329 3a0a 2020 2020 2020  in args):.      
-0003be70: 2020 6c61 7965 7220 3d20 7b0a 2020 2020    layer = {.    
-0003be80: 2020 2020 2020 2020 286e 616d 652c 2030          (name, 0
-0003be90: 293a 2028 0a20 2020 2020 2020 2020 2020  ): (.           
-0003bea0: 2020 2020 2061 7070 6c79 2c0a 2020 2020       apply,.    
-0003beb0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
-0003bec0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003bed0: 2020 2874 7570 6c65 2c20 5b28 6172 672e    (tuple, [(arg.
-0003bee0: 5f6e 616d 652c 2030 2920 666f 7220 6172  _name, 0) for ar
-0003bef0: 6720 696e 2061 7267 735d 292c 0a20 2020  g in args]),.   
-0003bf00: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
-0003bf10: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-0003bf20: 2029 0a20 2020 2020 2020 207d 0a20 2020   ).        }.   
-0003bf30: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
-0003bf40: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-0003bf50: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
-0003bf60: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
-0003bf70: 656e 6369 6573 3d61 7267 7329 0a20 2020  encies=args).   
-0003bf80: 2020 2020 2072 6574 7572 6e20 5363 616c       return Scal
-0003bf90: 6172 2867 7261 7068 2c20 6e61 6d65 2c20  ar(graph, name, 
-0003bfa0: 6d65 7461 290a 0a20 2020 2061 7267 7332  meta)..    args2
-0003bfb0: 203d 205b 5d0a 2020 2020 6465 7065 6e64   = [].    depend
-0003bfc0: 656e 6369 6573 203d 205b 5d0a 2020 2020  encies = [].    
-0003bfd0: 666f 7220 6172 6720 696e 2061 7267 733a  for arg in args:
-0003bfe0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0003bff0: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
-0003c000: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-0003c010: 2061 7267 7332 2e61 7070 656e 6428 6172   args2.append(ar
-0003c020: 6729 0a20 2020 2020 2020 2020 2020 2064  g).            d
-0003c030: 6570 656e 6465 6e63 6965 732e 6170 7065  ependencies.appe
-0003c040: 6e64 2861 7267 290a 2020 2020 2020 2020  nd(arg).        
-0003c050: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
-0003c060: 2020 2020 2061 7267 203d 206e 6f72 6d61       arg = norma
-0003c070: 6c69 7a65 5f61 7267 2861 7267 290a 2020  lize_arg(arg).  
-0003c080: 2020 2020 2020 6172 6732 2c20 636f 6c6c        arg2, coll
-0003c090: 6563 7469 6f6e 7320 3d20 756e 7061 636b  ections = unpack
-0003c0a0: 5f63 6f6c 6c65 6374 696f 6e73 2861 7267  _collections(arg
-0003c0b0: 290a 2020 2020 2020 2020 6966 2063 6f6c  ).        if col
-0003c0c0: 6c65 6374 696f 6e73 3a0a 2020 2020 2020  lections:.      
-0003c0d0: 2020 2020 2020 6172 6773 322e 6170 7065        args2.appe
-0003c0e0: 6e64 2861 7267 3229 0a20 2020 2020 2020  nd(arg2).       
-0003c0f0: 2020 2020 2064 6570 656e 6465 6e63 6965       dependencie
-0003c100: 732e 6578 7465 6e64 2863 6f6c 6c65 6374  s.extend(collect
-0003c110: 696f 6e73 290a 2020 2020 2020 2020 656c  ions).        el
-0003c120: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0003c130: 6172 6773 322e 6170 7065 6e64 2861 7267  args2.append(arg
-0003c140: 290a 0a20 2020 206b 7761 7267 7333 203d  )..    kwargs3 =
-0003c150: 207b 7d0a 2020 2020 7369 6d70 6c65 203d   {}.    simple =
-0003c160: 2054 7275 650a 2020 2020 666f 7220 6b2c   True.    for k,
-0003c170: 2076 2069 6e20 6b77 6172 6773 2e69 7465   v in kwargs.ite
-0003c180: 6d73 2829 3a0a 2020 2020 2020 2020 7620  ms():.        v 
-0003c190: 3d20 6e6f 726d 616c 697a 655f 6172 6728  = normalize_arg(
-0003c1a0: 7629 0a20 2020 2020 2020 2076 2c20 636f  v).        v, co
-0003c1b0: 6c6c 6563 7469 6f6e 7320 3d20 756e 7061  llections = unpa
-0003c1c0: 636b 5f63 6f6c 6c65 6374 696f 6e73 2876  ck_collections(v
-0003c1d0: 290a 2020 2020 2020 2020 6465 7065 6e64  ).        depend
-0003c1e0: 656e 6369 6573 2e65 7874 656e 6428 636f  encies.extend(co
-0003c1f0: 6c6c 6563 7469 6f6e 7329 0a20 2020 2020  llections).     
-0003c200: 2020 206b 7761 7267 7333 5b6b 5d20 3d20     kwargs3[k] = 
-0003c210: 760a 2020 2020 2020 2020 6966 2063 6f6c  v.        if col
-0003c220: 6c65 6374 696f 6e73 3a0a 2020 2020 2020  lections:.      
-0003c230: 2020 2020 2020 7369 6d70 6c65 203d 2046        simple = F
-0003c240: 616c 7365 0a0a 2020 2020 6469 7669 7369  alse..    divisi
-0003c250: 6f6e 7320 3d20 5f67 6574 5f64 6976 6973  ons = _get_divis
-0003c260: 696f 6e73 5f6d 6170 5f70 6172 7469 7469  ions_map_partiti
-0003c270: 6f6e 7328 0a20 2020 2020 2020 2061 6c69  ons(.        ali
-0003c280: 676e 5f64 6174 6166 7261 6d65 732c 2074  gn_dataframes, t
-0003c290: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
-0003c2a0: 6e73 2c20 6466 732c 2066 756e 632c 2061  ns, dfs, func, a
-0003c2b0: 7267 732c 206b 7761 7267 730a 2020 2020  rgs, kwargs.    
-0003c2c0: 290a 0a20 2020 2069 6620 6861 735f 6b65  )..    if has_ke
-0003c2d0: 7977 6f72 6428 6675 6e63 2c20 2270 6172  yword(func, "par
-0003c2e0: 7469 7469 6f6e 5f69 6e66 6f22 293a 0a20  tition_info"):. 
-0003c2f0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-0003c300: 5f69 6e66 6f20 3d20 7b0a 2020 2020 2020  _info = {.      
-0003c310: 2020 2020 2020 2869 2c29 3a20 7b22 6e75        (i,): {"nu
-0003c320: 6d62 6572 223a 2069 2c20 2264 6976 6973  mber": i, "divis
-0003c330: 696f 6e22 3a20 6469 7669 7369 6f6e 7d0a  ion": division}.
-0003c340: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0003c350: 692c 2064 6976 6973 696f 6e20 696e 2065  i, division in e
-0003c360: 6e75 6d65 7261 7465 2864 6976 6973 696f  numerate(divisio
-0003c370: 6e73 5b3a 2d31 5d29 0a20 2020 2020 2020  ns[:-1]).       
-0003c380: 207d 0a0a 2020 2020 2020 2020 6172 6773   }..        args
-0003c390: 322e 696e 7365 7274 2830 2c20 426c 6f63  2.insert(0, Bloc
-0003c3a0: 6b77 6973 6544 6570 4469 6374 2870 6172  kwiseDepDict(par
-0003c3b0: 7469 7469 6f6e 5f69 6e66 6f29 290a 2020  tition_info)).  
-0003c3c0: 2020 2020 2020 6f72 6967 5f66 756e 6320        orig_func 
-0003c3d0: 3d20 6675 6e63 0a0a 2020 2020 2020 2020  = func..        
-0003c3e0: 6465 6620 6675 6e63 2870 6172 7469 7469  def func(partiti
-0003c3f0: 6f6e 5f69 6e66 6f2c 202a 6172 6773 2c20  on_info, *args, 
-0003c400: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-0003c410: 2020 2020 2020 2072 6574 7572 6e20 6f72         return or
-0003c420: 6967 5f66 756e 6328 2a61 7267 732c 202a  ig_func(*args, *
-0003c430: 2a6b 7761 7267 732c 2070 6172 7469 7469  *kwargs, partiti
-0003c440: 6f6e 5f69 6e66 6f3d 7061 7274 6974 696f  on_info=partitio
-0003c450: 6e5f 696e 666f 290a 0a20 2020 2069 6620  n_info)..    if 
-0003c460: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-0003c470: 3a0a 2020 2020 2020 2020 6473 6b20 3d20  :.        dsk = 
-0003c480: 7061 7274 6974 696f 6e77 6973 655f 6772  partitionwise_gr
-0003c490: 6170 6828 0a20 2020 2020 2020 2020 2020  aph(.           
-0003c4a0: 2061 7070 6c79 5f61 6e64 5f65 6e66 6f72   apply_and_enfor
-0003c4b0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
-0003c4c0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-0003c4d0: 2020 2a61 7267 7332 2c0a 2020 2020 2020    *args2,.      
-0003c4e0: 2020 2020 2020 6465 7065 6e64 656e 6369        dependenci
-0003c4f0: 6573 3d64 6570 656e 6465 6e63 6965 732c  es=dependencies,
-0003c500: 0a20 2020 2020 2020 2020 2020 205f 6675  .            _fu
-0003c510: 6e63 3d66 756e 632c 0a20 2020 2020 2020  nc=func,.       
-0003c520: 2020 2020 205f 6d65 7461 3d6d 6574 612c       _meta=meta,
-0003c530: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
-0003c540: 7761 7267 7333 2c0a 2020 2020 2020 2020  wargs3,.        
-0003c550: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-0003c560: 2020 2020 6b77 6172 6773 3420 3d20 6b77      kwargs4 = kw
-0003c570: 6172 6773 2069 6620 7369 6d70 6c65 2065  args if simple e
-0003c580: 6c73 6520 6b77 6172 6773 330a 2020 2020  lse kwargs3.    
-0003c590: 2020 2020 6473 6b20 3d20 7061 7274 6974      dsk = partit
-0003c5a0: 696f 6e77 6973 655f 6772 6170 6828 0a20  ionwise_graph(. 
-0003c5b0: 2020 2020 2020 2020 2020 2066 756e 632c             func,
-0003c5c0: 206e 616d 652c 202a 6172 6773 322c 202a   name, *args2, *
-0003c5d0: 2a6b 7761 7267 7334 2c20 6465 7065 6e64  *kwargs4, depend
-0003c5e0: 656e 6369 6573 3d64 6570 656e 6465 6e63  encies=dependenc
-0003c5f0: 6965 730a 2020 2020 2020 2020 290a 0a20  ies.        ).. 
-0003c600: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-0003c610: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-0003c620: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-0003c630: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-0003c640: 6573 3d64 6570 656e 6465 6e63 6965 7329  es=dependencies)
-0003c650: 0a20 2020 2072 6574 7572 6e20 6e65 775f  .    return new_
-0003c660: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
-0003c670: 206e 616d 652c 206d 6574 612c 2064 6976   name, meta, div
-0003c680: 6973 696f 6e73 290a 0a0a 6465 6620 5f67  isions)...def _g
-0003c690: 6574 5f64 6976 6973 696f 6e73 5f6d 6170  et_divisions_map
-0003c6a0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-0003c6b0: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
-0003c6c0: 732c 2074 7261 6e73 666f 726d 5f64 6976  s, transform_div
-0003c6d0: 6973 696f 6e73 2c20 6466 732c 2066 756e  isions, dfs, fun
-0003c6e0: 632c 2061 7267 732c 206b 7761 7267 730a  c, args, kwargs.
-0003c6f0: 293a 0a20 2020 2022 2222 0a20 2020 2048  ):.    """.    H
-0003c700: 656c 7065 7220 746f 2067 6574 2064 6976  elper to get div
-0003c710: 6973 696f 6e73 2066 6f72 206d 6170 5f70  isions for map_p
-0003c720: 6172 7469 7469 6f6e 7320 616e 6420 6d61  artitions and ma
-0003c730: 705f 6f76 6572 6c61 7020 6f75 7470 7574  p_overlap output
-0003c740: 2e0a 2020 2020 2222 220a 2020 2020 6966  ..    """.    if
-0003c750: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
-0003c760: 733a 0a20 2020 2020 2020 2064 6976 6973  s:.        divis
-0003c770: 696f 6e73 203d 2064 6673 5b30 5d2e 6469  ions = dfs[0].di
-0003c780: 7669 7369 6f6e 730a 2020 2020 656c 7365  visions.    else
-0003c790: 3a0a 2020 2020 2020 2020 2320 556e 616c  :.        # Unal
-0003c7a0: 6967 6e65 642c 2064 6673 2069 7320 6120  igned, dfs is a 
-0003c7b0: 6d69 7820 6f66 2031 2070 6172 7469 7469  mix of 1 partiti
-0003c7c0: 6f6e 2061 6e64 2031 2b20 7061 7274 6974  on and 1+ partit
-0003c7d0: 696f 6e20 6461 7461 6672 616d 6573 2c0a  ion dataframes,.
-0003c7e0: 2020 2020 2020 2020 2320 7573 6520 6c6f          # use lo
-0003c7f0: 6e67 6573 7420 6469 7669 7369 6f6e 7320  ngest divisions 
-0003c800: 666f 756e 640a 2020 2020 2020 2020 6469  found.        di
-0003c810: 7669 7369 6f6e 7320 3d20 6d61 7828 2864  visions = max((d
-0003c820: 2e64 6976 6973 696f 6e73 2066 6f72 2064  .divisions for d
-0003c830: 2069 6e20 6466 7329 2c20 6b65 793d 6c65   in dfs), key=le
-0003c840: 6e29 0a20 2020 2069 6620 7472 616e 7366  n).    if transf
-0003c850: 6f72 6d5f 6469 7669 7369 6f6e 7320 616e  orm_divisions an
-0003c860: 6420 6973 696e 7374 616e 6365 2864 6673  d isinstance(dfs
-0003c870: 5b30 5d2c 2049 6e64 6578 2920 616e 6420  [0], Index) and 
-0003c880: 6c65 6e28 6466 7329 203d 3d20 313a 0a20  len(dfs) == 1:. 
-0003c890: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0003c8a0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-0003c8b0: 7320 3d20 6675 6e63 280a 2020 2020 2020  s = func(.      
-0003c8c0: 2020 2020 2020 2020 2020 2a5b 7064 2e49            *[pd.I
-0003c8d0: 6e64 6578 2861 2e64 6976 6973 696f 6e73  ndex(a.divisions
-0003c8e0: 2920 6966 2061 2069 7320 6466 735b 305d  ) if a is dfs[0]
-0003c8f0: 2065 6c73 6520 6120 666f 7220 6120 696e   else a for a in
-0003c900: 2061 7267 735d 2c20 2a2a 6b77 6172 6773   args], **kwargs
-0003c910: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0003c920: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0003c930: 696e 7374 616e 6365 2864 6976 6973 696f  instance(divisio
-0003c940: 6e73 2c20 7064 2e49 6e64 6578 293a 0a20  ns, pd.Index):. 
-0003c950: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0003c960: 6976 6973 696f 6e73 203d 206d 6574 686f  ivisions = metho
-0003c970: 6473 2e74 6f6c 6973 7428 6469 7669 7369  ds.tolist(divisi
-0003c980: 6f6e 7329 0a20 2020 2020 2020 2065 7863  ons).        exc
-0003c990: 6570 7420 4578 6365 7074 696f 6e3a 0a20  ept Exception:. 
-0003c9a0: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
-0003c9b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0003c9c0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0003c9d0: 2076 616c 6964 5f64 6976 6973 696f 6e73   valid_divisions
-0003c9e0: 2864 6976 6973 696f 6e73 293a 0a20 2020  (divisions):.   
-0003c9f0: 2020 2020 2020 2020 2020 2020 2064 6976               div
-0003ca00: 6973 696f 6e73 203d 205b 4e6f 6e65 5d20  isions = [None] 
-0003ca10: 2a20 2864 6673 5b30 5d2e 6e70 6172 7469  * (dfs[0].nparti
-0003ca20: 7469 6f6e 7320 2b20 3129 0a20 2020 2072  tions + 1).    r
-0003ca30: 6574 7572 6e20 6469 7669 7369 6f6e 730a  eturn divisions.
-0003ca40: 0a0a 6465 6620 5f67 6574 5f6d 6574 615f  ..def _get_meta_
-0003ca50: 6d61 705f 7061 7274 6974 696f 6e73 2861  map_partitions(a
-0003ca60: 7267 732c 2064 6673 2c20 6675 6e63 2c20  rgs, dfs, func, 
-0003ca70: 6b77 6172 6773 2c20 6d65 7461 2c20 7061  kwargs, meta, pa
-0003ca80: 7265 6e74 5f6d 6574 6129 3a0a 2020 2020  rent_meta):.    
-0003ca90: 2222 220a 2020 2020 4865 6c70 6572 2074  """.    Helper t
-0003caa0: 6f20 6765 6e65 7261 7465 206d 6574 6164  o generate metad
-0003cab0: 6174 6120 666f 7220 6d61 705f 7061 7274  ata for map_part
-0003cac0: 6974 696f 6e73 2061 6e64 206d 6170 5f6f  itions and map_o
-0003cad0: 7665 726c 6170 206f 7574 7075 742e 0a20  verlap output.. 
-0003cae0: 2020 2022 2222 0a20 2020 206d 6574 615f     """.    meta_
-0003caf0: 696e 6465 7820 3d20 6765 7461 7474 7228  index = getattr(
-0003cb00: 6d61 6b65 5f6d 6574 6128 6466 735b 305d  make_meta(dfs[0]
-0003cb10: 292c 2022 696e 6465 7822 2c20 4e6f 6e65  ), "index", None
-0003cb20: 2920 6966 2064 6673 2065 6c73 6520 4e6f  ) if dfs else No
-0003cb30: 6e65 0a20 2020 2069 6620 7061 7265 6e74  ne.    if parent
-0003cb40: 5f6d 6574 6120 6973 204e 6f6e 6520 616e  _meta is None an
-0003cb50: 6420 6466 733a 0a20 2020 2020 2020 2070  d dfs:.        p
-0003cb60: 6172 656e 745f 6d65 7461 203d 2064 6673  arent_meta = dfs
-0003cb70: 5b30 5d2e 5f6d 6574 610a 2020 2020 6966  [0]._meta.    if
-0003cb80: 206d 6574 6120 6973 206e 6f5f 6465 6661   meta is no_defa
-0003cb90: 756c 743a 0a20 2020 2020 2020 2023 2055  ult:.        # U
-0003cba0: 7365 206e 6f6e 2d6e 6f72 6d61 6c69 7a65  se non-normalize
-0003cbb0: 6420 6b77 6172 6773 2068 6572 652c 2061  d kwargs here, a
-0003cbc0: 7320 7765 2077 616e 7420 7468 6520 7265  s we want the re
-0003cbd0: 616c 2076 616c 7565 7320 286e 6f74 0a20  al values (not. 
-0003cbe0: 2020 2020 2020 2023 2064 656c 6179 6564         # delayed
-0003cbf0: 2076 616c 7565 7329 0a20 2020 2020 2020   values).       
-0003cc00: 206d 6574 6120 3d20 5f65 6d75 6c61 7465   meta = _emulate
-0003cc10: 2866 756e 632c 202a 6172 6773 2c20 7564  (func, *args, ud
-0003cc20: 663d 5472 7565 2c20 2a2a 6b77 6172 6773  f=True, **kwargs
-0003cc30: 290a 2020 2020 2020 2020 6d65 7461 5f69  ).        meta_i
-0003cc40: 735f 656d 756c 6174 6564 203d 2054 7275  s_emulated = Tru
-0003cc50: 650a 2020 2020 656c 7365 3a0a 2020 2020  e.    else:.    
-0003cc60: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
-0003cc70: 6d65 7461 286d 6574 612c 2069 6e64 6578  meta(meta, index
-0003cc80: 3d6d 6574 615f 696e 6465 782c 2070 6172  =meta_index, par
-0003cc90: 656e 745f 6d65 7461 3d70 6172 656e 745f  ent_meta=parent_
-0003cca0: 6d65 7461 290a 2020 2020 2020 2020 6d65  meta).        me
-0003ccb0: 7461 5f69 735f 656d 756c 6174 6564 203d  ta_is_emulated =
-0003ccc0: 2046 616c 7365 0a0a 2020 2020 6966 206e   False..    if n
-0003ccd0: 6f74 2028 6861 735f 7061 7261 6c6c 656c  ot (has_parallel
-0003cce0: 5f74 7970 6528 6d65 7461 2920 6f72 2069  _type(meta) or i
-0003ccf0: 735f 6172 7261 796c 696b 6528 6d65 7461  s_arraylike(meta
-0003cd00: 2920 616e 6420 6d65 7461 2e73 6861 7065  ) and meta.shape
-0003cd10: 2920 616e 6420 6e6f 7420 616c 6c28 0a20  ) and not all(. 
-0003cd20: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
-0003cd30: 6528 6172 672c 2053 6361 6c61 7229 2066  e(arg, Scalar) f
-0003cd40: 6f72 2061 7267 2069 6e20 6172 6773 0a20  or arg in args. 
-0003cd50: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
-0003cd60: 206e 6f74 206d 6574 615f 6973 5f65 6d75   not meta_is_emu
-0003cd70: 6c61 7465 643a 0a20 2020 2020 2020 2020  lated:.         
-0003cd80: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-0003cd90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003cda0: 2020 224d 6574 6120 6973 206e 6f74 2076    "Meta is not v
-0003cdb0: 616c 6964 2c20 606d 6170 5f70 6172 7469  alid, `map_parti
-0003cdc0: 7469 6f6e 7360 2061 6e64 2060 6d61 705f  tions` and `map_
-0003cdd0: 6f76 6572 6c61 7060 2065 7870 6563 7473  overlap` expects
-0003cde0: 206f 7574 7075 7420 746f 2062 6520 6120   output to be a 
-0003cdf0: 7061 6e64 6173 206f 626a 6563 742e 2022  pandas object. "
-0003ce00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ce10: 2022 5472 7920 7061 7373 696e 6720 6120   "Try passing a 
-0003ce20: 7061 6e64 6173 206f 626a 6563 7420 6173  pandas object as
-0003ce30: 206d 6574 6120 6f72 2061 2064 6963 7420   meta or a dict 
-0003ce40: 6f72 2074 7570 6c65 2072 6570 7265 7365  or tuple represe
-0003ce50: 6e74 696e 6720 7468 6520 220a 2020 2020  nting the ".    
-0003ce60: 2020 2020 2020 2020 2020 2020 2228 6e61              "(na
-0003ce70: 6d65 2c20 6474 7970 6529 206f 6620 7468  me, dtype) of th
-0003ce80: 6520 636f 6c75 6d6e 732e 2049 6e20 7468  e columns. In th
-0003ce90: 6520 6675 7475 7265 2074 6865 206d 6574  e future the met
-0003cea0: 6120 796f 7520 7061 7373 6564 2077 696c  a you passed wil
-0003ceb0: 6c20 6e6f 7420 776f 726b 2e22 2c0a 2020  l not work.",.  
-0003cec0: 2020 2020 2020 2020 2020 2020 2020 4675                Fu
-0003ced0: 7475 7265 5761 726e 696e 672c 0a20 2020  tureWarning,.   
-0003cee0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0003cef0: 2020 2023 2049 6620 606d 6574 6160 2069     # If `meta` i
-0003cf00: 7320 6e6f 7420 6120 7061 6e64 6173 206f  s not a pandas o
-0003cf10: 626a 6563 742c 2074 6865 2063 6f6e 6361  bject, the conca
-0003cf20: 7465 6e61 7465 6420 7265 7375 6c74 7320  tenated results 
-0003cf30: 7769 6c6c 2062 6520 610a 2020 2020 2020  will be a.      
-0003cf40: 2020 2320 6469 6666 6572 656e 7420 7479    # different ty
-0003cf50: 7065 0a20 2020 2020 2020 206d 6574 6120  pe.        meta 
-0003cf60: 3d20 6d61 6b65 5f6d 6574 6128 5f63 6f6e  = make_meta(_con
-0003cf70: 6361 7428 5b6d 6574 615d 292c 2069 6e64  cat([meta]), ind
-0003cf80: 6578 3d6d 6574 615f 696e 6465 7829 0a0a  ex=meta_index)..
-0003cf90: 2020 2020 2320 456e 7375 7265 206d 6574      # Ensure met
-0003cfa0: 6120 6973 2065 6d70 7479 2073 6572 6965  a is empty serie
-0003cfb0: 730a 2020 2020 6d65 7461 203d 206d 616b  s.    meta = mak
-0003cfc0: 655f 6d65 7461 286d 6574 612c 2070 6172  e_meta(meta, par
-0003cfd0: 656e 745f 6d65 7461 3d70 6172 656e 745f  ent_meta=parent_
-0003cfe0: 6d65 7461 290a 0a20 2020 2072 6574 7572  meta)..    retur
-0003cff0: 6e20 6d65 7461 0a0a 0a64 6566 2061 7070  n meta...def app
-0003d000: 6c79 5f61 6e64 5f65 6e66 6f72 6365 282a  ly_and_enforce(*
-0003d010: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-0003d020: 0a20 2020 2022 2222 4170 706c 7920 6120  .    """Apply a 
-0003d030: 6675 6e63 7469 6f6e 2c20 616e 6420 656e  function, and en
-0003d040: 666f 7263 6520 7468 6520 6f75 7470 7574  force the output
-0003d050: 2074 6f20 6d61 7463 6820 6d65 7461 0a0a   to match meta..
-0003d060: 2020 2020 456e 7375 7265 7320 7468 6520      Ensures the 
-0003d070: 6f75 7470 7574 2068 6173 2074 6865 2073  output has the s
-0003d080: 616d 6520 636f 6c75 6d6e 732c 2065 7665  ame columns, eve
-0003d090: 6e20 6966 2065 6d70 7479 2e22 2222 0a20  n if empty.""". 
-0003d0a0: 2020 2066 756e 6320 3d20 6b77 6172 6773     func = kwargs
-0003d0b0: 2e70 6f70 2822 5f66 756e 6322 290a 2020  .pop("_func").  
-0003d0c0: 2020 6d65 7461 203d 206b 7761 7267 732e    meta = kwargs.
-0003d0d0: 706f 7028 225f 6d65 7461 2229 0a20 2020  pop("_meta").   
-0003d0e0: 2064 6620 3d20 6675 6e63 282a 6172 6773   df = func(*args
-0003d0f0: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
-0003d100: 6966 2069 735f 6461 7461 6672 616d 655f  if is_dataframe_
-0003d110: 6c69 6b65 2864 6629 206f 7220 6973 5f73  like(df) or is_s
-0003d120: 6572 6965 735f 6c69 6b65 2864 6629 206f  eries_like(df) o
-0003d130: 7220 6973 5f69 6e64 6578 5f6c 696b 6528  r is_index_like(
-0003d140: 6466 293a 0a20 2020 2020 2020 2069 6620  df):.        if 
-0003d150: 6e6f 7420 6c65 6e28 6466 293a 0a20 2020  not len(df):.   
-0003d160: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0003d170: 6d65 7461 0a20 2020 2020 2020 2069 6620  meta.        if 
-0003d180: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-0003d190: 6528 6466 293a 0a20 2020 2020 2020 2020  e(df):.         
-0003d1a0: 2020 2063 6865 636b 5f6d 6174 6368 696e     check_matchin
-0003d1b0: 675f 636f 6c75 6d6e 7328 6d65 7461 2c20  g_columns(meta, 
-0003d1c0: 6466 290a 2020 2020 2020 2020 2020 2020  df).            
-0003d1d0: 6320 3d20 6d65 7461 2e63 6f6c 756d 6e73  c = meta.columns
-0003d1e0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0003d1f0: 2020 2020 2020 2020 2020 2063 203d 206d             c = m
-0003d200: 6574 612e 6e61 6d65 0a20 2020 2020 2020  eta.name.       
-0003d210: 2072 6574 7572 6e20 5f72 656e 616d 6528   return _rename(
-0003d220: 632c 2064 6629 0a20 2020 2072 6574 7572  c, df).    retur
-0003d230: 6e20 6466 0a0a 0a64 6566 205f 7265 6e61  n df...def _rena
-0003d240: 6d65 2863 6f6c 756d 6e73 2c20 6466 293a  me(columns, df):
-0003d250: 0a20 2020 2022 2222 0a20 2020 2052 656e  .    """.    Ren
-0003d260: 616d 6520 636f 6c75 6d6e 7320 6f66 2070  ame columns of p
-0003d270: 642e 4461 7461 4672 616d 6520 6f72 206e  d.DataFrame or n
-0003d280: 616d 6520 6f66 2070 642e 5365 7269 6573  ame of pd.Series
-0003d290: 2e0a 2020 2020 4e6f 7420 666f 7220 6464  ..    Not for dd
-0003d2a0: 2e44 6174 6146 7261 6d65 206f 7220 6464  .DataFrame or dd
-0003d2b0: 2e53 6572 6965 732e 0a0a 2020 2020 5061  .Series...    Pa
-0003d2c0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-0003d2d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 636f 6c75  -------.    colu
-0003d2e0: 6d6e 7320 3a20 7475 706c 652c 2073 7472  mns : tuple, str
-0003d2f0: 696e 672c 2070 642e 4461 7461 4672 616d  ing, pd.DataFram
-0003d300: 6520 6f72 2070 642e 5365 7269 6573 0a20  e or pd.Series. 
-0003d310: 2020 2020 2020 2043 6f6c 756d 6e20 6e61         Column na
-0003d320: 6d65 732c 2053 6572 6965 7320 6e61 6d65  mes, Series name
-0003d330: 206f 7220 7061 6e64 6173 2069 6e73 7461   or pandas insta
-0003d340: 6e63 6520 7768 6963 6820 6861 7320 7468  nce which has th
-0003d350: 650a 2020 2020 2020 2020 7461 7267 6574  e.        target
-0003d360: 2063 6f6c 756d 6e20 6e61 6d65 7320 2f20   column names / 
-0003d370: 6e61 6d65 2e0a 2020 2020 6466 203a 2070  name..    df : p
-0003d380: 642e 4461 7461 4672 616d 6520 6f72 2070  d.DataFrame or p
-0003d390: 642e 5365 7269 6573 0a20 2020 2020 2020  d.Series.       
-0003d3a0: 2074 6172 6765 7420 4461 7461 4672 616d   target DataFram
-0003d3b0: 6520 2f20 5365 7269 6573 2074 6f20 6265  e / Series to be
-0003d3c0: 2072 656e 616d 6564 0a20 2020 2022 2222   renamed.    """
-0003d3d0: 0a20 2020 2061 7373 6572 7420 6e6f 7420  .    assert not 
-0003d3e0: 6973 696e 7374 616e 6365 2864 662c 205f  isinstance(df, _
-0003d3f0: 4672 616d 6529 0a0a 2020 2020 6966 2063  Frame)..    if c
-0003d400: 6f6c 756d 6e73 2069 7320 6e6f 5f64 6566  olumns is no_def
-0003d410: 6175 6c74 3a0a 2020 2020 2020 2020 7265  ault:.        re
-0003d420: 7475 726e 2064 660a 0a20 2020 2069 6620  turn df..    if 
-0003d430: 6973 696e 7374 616e 6365 2863 6f6c 756d  isinstance(colum
-0003d440: 6e73 2c20 4974 6572 6174 6f72 293a 0a20  ns, Iterator):. 
-0003d450: 2020 2020 2020 2063 6f6c 756d 6e73 203d         columns =
-0003d460: 206c 6973 7428 636f 6c75 6d6e 7329 0a0a   list(columns)..
-0003d470: 2020 2020 6966 2069 735f 6461 7461 6672      if is_datafr
-0003d480: 616d 655f 6c69 6b65 2864 6629 3a0a 2020  ame_like(df):.  
-0003d490: 2020 2020 2020 6966 2069 735f 6461 7461        if is_data
-0003d4a0: 6672 616d 655f 6c69 6b65 2863 6f6c 756d  frame_like(colum
-0003d4b0: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
-0003d4c0: 2063 6f6c 756d 6e73 203d 2063 6f6c 756d   columns = colum
-0003d4d0: 6e73 2e63 6f6c 756d 6e73 0a20 2020 2020  ns.columns.     
-0003d4e0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-0003d4f0: 616e 6365 2863 6f6c 756d 6e73 2c20 7064  ance(columns, pd
-0003d500: 2e49 6e64 6578 293a 0a20 2020 2020 2020  .Index):.       
-0003d510: 2020 2020 2063 6f6c 756d 6e73 203d 2070       columns = p
-0003d520: 642e 496e 6465 7828 636f 6c75 6d6e 7329  d.Index(columns)
-0003d530: 0a20 2020 2020 2020 2069 6620 280a 2020  .        if (.  
-0003d540: 2020 2020 2020 2020 2020 6c65 6e28 636f            len(co
-0003d550: 6c75 6d6e 7329 203d 3d20 6c65 6e28 6466  lumns) == len(df
-0003d560: 2e63 6f6c 756d 6e73 290a 2020 2020 2020  .columns).      
-0003d570: 2020 2020 2020 616e 6420 7479 7065 2863        and type(c
-0003d580: 6f6c 756d 6e73 2920 6973 2074 7970 6528  olumns) is type(
-0003d590: 6466 2e63 6f6c 756d 6e73 290a 2020 2020  df.columns).    
-0003d5a0: 2020 2020 2020 2020 616e 6420 636f 6c75          and colu
-0003d5b0: 6d6e 732e 6474 7970 6520 3d3d 2064 662e  mns.dtype == df.
-0003d5c0: 636f 6c75 6d6e 732e 6474 7970 650a 2020  columns.dtype.  
-0003d5d0: 2020 2020 2020 2020 2020 616e 6420 636f            and co
-0003d5e0: 6c75 6d6e 732e 6571 7561 6c73 2864 662e  lumns.equals(df.
-0003d5f0: 636f 6c75 6d6e 7329 0a20 2020 2020 2020  columns).       
-0003d600: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-0003d610: 2320 6966 2074 6172 6765 7420 6973 2069  # if target is i
-0003d620: 6465 6e74 6963 616c 2c20 7265 6e61 6d65  dentical, rename
-0003d630: 2069 7320 6e6f 7420 6e65 6365 7373 6172   is not necessar
-0003d640: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
-0003d650: 7475 726e 2064 660a 2020 2020 2020 2020  turn df.        
-0003d660: 2320 6465 6570 3d46 616c 7365 2064 6f65  # deep=False doe
-0003d670: 736e 2774 2064 6f65 736e 2774 2063 6f70  sn't doesn't cop
-0003d680: 7920 616e 7920 6461 7461 2f69 6e64 6963  y any data/indic
-0003d690: 6573 2c20 736f 2074 6869 7320 6973 2063  es, so this is c
-0003d6a0: 6865 6170 0a20 2020 2020 2020 2064 6620  heap.        df 
-0003d6b0: 3d20 6466 2e63 6f70 7928 6465 6570 3d46  = df.copy(deep=F
-0003d6c0: 616c 7365 290a 2020 2020 2020 2020 6466  alse).        df
-0003d6d0: 2e63 6f6c 756d 6e73 203d 2063 6f6c 756d  .columns = colum
-0003d6e0: 6e73 0a20 2020 2020 2020 2072 6574 7572  ns.        retur
-0003d6f0: 6e20 6466 0a20 2020 2065 6c69 6620 6973  n df.    elif is
-0003d700: 5f73 6572 6965 735f 6c69 6b65 2864 6629  _series_like(df)
-0003d710: 206f 7220 6973 5f69 6e64 6578 5f6c 696b   or is_index_lik
-0003d720: 6528 6466 293a 0a20 2020 2020 2020 2069  e(df):.        i
-0003d730: 6620 6973 5f73 6572 6965 735f 6c69 6b65  f is_series_like
-0003d740: 2863 6f6c 756d 6e73 2920 6f72 2069 735f  (columns) or is_
-0003d750: 696e 6465 785f 6c69 6b65 2863 6f6c 756d  index_like(colum
-0003d760: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
-0003d770: 2063 6f6c 756d 6e73 203d 2063 6f6c 756d   columns = colum
-0003d780: 6e73 2e6e 616d 650a 2020 2020 2020 2020  ns.name.        
-0003d790: 6966 2064 662e 6e61 6d65 203d 3d20 636f  if df.name == co
-0003d7a0: 6c75 6d6e 733a 0a20 2020 2020 2020 2020  lumns:.         
-0003d7b0: 2020 2072 6574 7572 6e20 6466 0a20 2020     return df.   
-0003d7c0: 2020 2020 2072 6574 7572 6e20 6466 2e72       return df.r
-0003d7d0: 656e 616d 6528 636f 6c75 6d6e 7329 0a20  ename(columns). 
-0003d7e0: 2020 2023 206d 6170 5f70 6172 7469 7469     # map_partiti
-0003d7f0: 6f6e 206d 6179 2070 6173 7320 6f74 6865  on may pass othe
-0003d800: 7220 7479 7065 730a 2020 2020 7265 7475  r types.    retu
-0003d810: 726e 2064 660a 0a0a 6465 6620 5f72 656e  rn df...def _ren
-0003d820: 616d 655f 6461 736b 2864 662c 206e 616d  ame_dask(df, nam
-0003d830: 6573 293a 0a20 2020 2022 2222 0a20 2020  es):.    """.   
-0003d840: 2044 6573 7472 7563 7469 7665 6c79 2072   Destructively r
-0003d850: 656e 616d 6520 636f 6c75 6d6e 7320 6f66  ename columns of
-0003d860: 2064 642e 4461 7461 4672 616d 6520 6f72   dd.DataFrame or
-0003d870: 206e 616d 6520 6f66 2064 642e 5365 7269   name of dd.Seri
-0003d880: 6573 2e0a 2020 2020 4e6f 7420 666f 7220  es..    Not for 
-0003d890: 7064 2e44 6174 6146 7261 6d65 206f 7220  pd.DataFrame or 
-0003d8a0: 7064 2e53 6572 6965 732e 0a0a 2020 2020  pd.Series...    
-0003d8b0: 496e 7465 726e 616c 6c79 2075 7365 6420  Internally used 
-0003d8c0: 746f 206f 7665 7277 7269 7465 2064 642e  to overwrite dd.
-0003d8d0: 4461 7461 4672 616d 652e 636f 6c75 6d6e  DataFrame.column
-0003d8e0: 7320 616e 6420 6464 2e53 6572 6965 732e  s and dd.Series.
-0003d8f0: 6e61 6d65 0a20 2020 2057 6520 6361 6e27  name.    We can'
-0003d900: 7420 7573 6520 6d61 705f 7061 7274 6974  t use map_partit
-0003d910: 696f 6e20 6265 6361 7573 6520 6974 2061  ion because it a
-0003d920: 7070 6c69 6573 2066 756e 6374 696f 6e20  pplies function 
-0003d930: 7468 656e 2072 656e 616d 650a 0a20 2020  then rename..   
-0003d940: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0003d950: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064  ----------.    d
-0003d960: 6620 3a20 6464 2e44 6174 6146 7261 6d65  f : dd.DataFrame
-0003d970: 206f 7220 6464 2e53 6572 6965 730a 2020   or dd.Series.  
-0003d980: 2020 2020 2020 7461 7267 6574 2044 6174        target Dat
-0003d990: 6146 7261 6d65 202f 2053 6572 6965 7320  aFrame / Series 
-0003d9a0: 746f 2062 6520 7265 6e61 6d65 640a 2020  to be renamed.  
-0003d9b0: 2020 6e61 6d65 7320 3a20 7475 706c 652c    names : tuple,
-0003d9c0: 2073 7472 696e 670a 2020 2020 2020 2020   string.        
-0003d9d0: 436f 6c75 6d6e 206e 616d 6573 2f53 6572  Column names/Ser
-0003d9e0: 6965 7320 6e61 6d65 0a20 2020 2022 2222  ies name.    """
-0003d9f0: 0a0a 2020 2020 6173 7365 7274 2069 7369  ..    assert isi
-0003da00: 6e73 7461 6e63 6528 6466 2c20 5f46 7261  nstance(df, _Fra
-0003da10: 6d65 290a 2020 2020 6d65 7461 6461 7461  me).    metadata
-0003da20: 203d 205f 7265 6e61 6d65 286e 616d 6573   = _rename(names
-0003da30: 2c20 6466 2e5f 6d65 7461 290a 2020 2020  , df._meta).    
-0003da40: 6e61 6d65 203d 2066 2272 656e 616d 652d  name = f"rename-
-0003da50: 7b74 6f6b 656e 697a 6528 6466 2c20 6d65  {tokenize(df, me
-0003da60: 7461 6461 7461 297d 220a 0a20 2020 2064  tadata)}"..    d
-0003da70: 736b 203d 2070 6172 7469 7469 6f6e 7769  sk = partitionwi
-0003da80: 7365 5f67 7261 7068 285f 7265 6e61 6d65  se_graph(_rename
-0003da90: 2c20 6e61 6d65 2c20 6d65 7461 6461 7461  , name, metadata
-0003daa0: 2c20 6466 290a 2020 2020 6772 6170 6820  , df).    graph 
-0003dab0: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-0003dac0: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-0003dad0: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
-0003dae0: 656e 6465 6e63 6965 733d 5b64 665d 290a  endencies=[df]).
-0003daf0: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
-0003db00: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
-0003db10: 6e61 6d65 2c20 6d65 7461 6461 7461 2c20  name, metadata, 
-0003db20: 6466 2e64 6976 6973 696f 6e73 290a 0a0a  df.divisions)...
-0003db30: 6465 6620 7175 616e 7469 6c65 2864 662c  def quantile(df,
-0003db40: 2071 2c20 6d65 7468 6f64 3d22 6465 6661   q, method="defa
-0003db50: 756c 7422 293a 0a20 2020 2022 2222 4170  ult"):.    """Ap
-0003db60: 7072 6f78 696d 6174 6520 7175 616e 7469  proximate quanti
-0003db70: 6c65 7320 6f66 2053 6572 6965 732e 0a0a  les of Series...
-0003db80: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-0003db90: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-0003dba0: 2020 7120 3a20 6c69 7374 2f61 7272 6179    q : list/array
-0003dbb0: 206f 6620 666c 6f61 7473 0a20 2020 2020   of floats.     
-0003dbc0: 2020 2049 7465 7261 626c 6520 6f66 206e     Iterable of n
-0003dbd0: 756d 6265 7273 2072 616e 6769 6e67 2066  umbers ranging f
-0003dbe0: 726f 6d20 3020 746f 2031 3030 2066 6f72  rom 0 to 100 for
-0003dbf0: 2074 6865 2064 6573 6972 6564 2071 7561   the desired qua
-0003dc00: 6e74 696c 6573 0a20 2020 206d 6574 686f  ntiles.    metho
-0003dc10: 6420 3a20 7b27 6465 6661 756c 7427 2c20  d : {'default', 
-0003dc20: 2774 6469 6765 7374 272c 2027 6461 736b  'tdigest', 'dask
-0003dc30: 277d 2c20 6f70 7469 6f6e 616c 0a20 2020  '}, optional.   
-0003dc40: 2020 2020 2057 6861 7420 6d65 7468 6f64       What method
-0003dc50: 2074 6f20 7573 652e 2042 7920 6465 6661   to use. By defa
-0003dc60: 756c 7420 7769 6c6c 2075 7365 2064 6173  ult will use das
-0003dc70: 6b27 7320 696e 7465 726e 616c 2063 7573  k's internal cus
-0003dc80: 746f 6d0a 2020 2020 2020 2020 616c 676f  tom.        algo
-0003dc90: 7269 7468 6d20 2860 6027 6461 736b 2760  rithm (``'dask'`
-0003dca0: 6029 2e20 2049 6620 7365 7420 746f 2060  `).  If set to `
-0003dcb0: 6027 7464 6967 6573 7427 6060 2077 696c  `'tdigest'`` wil
-0003dcc0: 6c20 7573 6520 7464 6967 6573 7420 666f  l use tdigest fo
-0003dcd0: 720a 2020 2020 2020 2020 666c 6f61 7473  r.        floats
-0003dce0: 2061 6e64 2069 6e74 7320 616e 6420 6661   and ints and fa
-0003dcf0: 6c6c 6261 636b 2074 6f20 7468 6520 6060  llback to the ``
-0003dd00: 2764 6173 6b27 6060 206f 7468 6572 7769  'dask'`` otherwi
-0003dd10: 7365 2e0a 2020 2020 2222 220a 2020 2020  se..    """.    
-0003dd20: 2320 6375 7272 656e 7420 696d 706c 656d  # current implem
-0003dd30: 656e 7461 7469 6f6e 206e 6565 6473 2071  entation needs q
-0003dd40: 2074 6f20 6265 2073 6f72 7465 6420 736f   to be sorted so
-0003dd50: 0a20 2020 2023 2073 6f72 7420 6966 2061  .    # sort if a
-0003dd60: 7272 6179 2d6c 696b 652c 206f 7468 6572  rray-like, other
-0003dd70: 7769 7365 206c 6561 7665 2069 7420 616c  wise leave it al
-0003dd80: 6f6e 650a 2020 2020 715f 6e64 6172 7261  one.    q_ndarra
-0003dd90: 7920 3d20 6e70 2e61 7272 6179 2871 290a  y = np.array(q).
-0003dda0: 2020 2020 6966 2071 5f6e 6461 7272 6179      if q_ndarray
-0003ddb0: 2e6e 6469 6d20 3e20 303a 0a20 2020 2020  .ndim > 0:.     
-0003ddc0: 2020 2071 5f6e 6461 7272 6179 2e73 6f72     q_ndarray.sor
-0003ddd0: 7428 6b69 6e64 3d22 6d65 7267 6573 6f72  t(kind="mergesor
-0003dde0: 7422 290a 2020 2020 2020 2020 7120 3d20  t").        q = 
-0003ddf0: 715f 6e64 6172 7261 790a 0a20 2020 2061  q_ndarray..    a
-0003de00: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-0003de10: 2864 662c 2053 6572 6965 7329 0a0a 2020  (df, Series)..  
-0003de20: 2020 616c 6c6f 7765 645f 6d65 7468 6f64    allowed_method
-0003de30: 7320 3d20 5b22 6465 6661 756c 7422 2c20  s = ["default", 
-0003de40: 2264 6173 6b22 2c20 2274 6469 6765 7374  "dask", "tdigest
-0003de50: 225d 0a20 2020 2069 6620 6d65 7468 6f64  "].    if method
-0003de60: 206e 6f74 2069 6e20 616c 6c6f 7765 645f   not in allowed_
-0003de70: 6d65 7468 6f64 733a 0a20 2020 2020 2020  methods:.       
-0003de80: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0003de90: 7228 226d 6574 686f 6420 6361 6e20 6f6e  r("method can on
-0003dea0: 6c79 2062 6520 2764 6566 6175 6c74 272c  ly be 'default',
-0003deb0: 2027 6461 736b 2720 6f72 2027 7464 6967   'dask' or 'tdig
-0003dec0: 6573 7427 2229 0a0a 2020 2020 6966 206d  est'")..    if m
-0003ded0: 6574 686f 6420 3d3d 2022 6465 6661 756c  ethod == "defaul
-0003dee0: 7422 3a0a 2020 2020 2020 2020 696e 7465  t":.        inte
-0003def0: 726e 616c 5f6d 6574 686f 6420 3d20 2264  rnal_method = "d
-0003df00: 6173 6b22 0a20 2020 2065 6c73 653a 0a20  ask".    else:. 
-0003df10: 2020 2020 2020 2069 6e74 6572 6e61 6c5f         internal_
-0003df20: 6d65 7468 6f64 203d 206d 6574 686f 640a  method = method.
-0003df30: 0a20 2020 2023 2063 7572 7265 6e74 6c79  .    # currently
-0003df40: 2c20 6f6e 6c79 2053 6572 6965 7320 6861  , only Series ha
-0003df50: 7320 7175 616e 7469 6c65 206d 6574 686f  s quantile metho
-0003df60: 640a 2020 2020 6966 2069 7369 6e73 7461  d.    if isinsta
-0003df70: 6e63 6528 6466 2c20 496e 6465 7829 3a0a  nce(df, Index):.
-0003df80: 2020 2020 2020 2020 7365 7269 6573 5f74          series_t
-0003df90: 7970 203d 2064 662e 5f6d 6574 612e 746f  yp = df._meta.to
-0003dfa0: 5f73 6572 6965 7328 292e 5f63 6f6e 7374  _series()._const
-0003dfb0: 7275 6374 6f72 0a20 2020 2020 2020 206d  ructor.        m
-0003dfc0: 6574 6120 3d20 6466 2e5f 6d65 7461 5f6e  eta = df._meta_n
-0003dfd0: 6f6e 656d 7074 792e 746f 5f73 6572 6965  onempty.to_serie
-0003dfe0: 7328 292e 7175 616e 7469 6c65 2871 290a  s().quantile(q).
-0003dff0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003e000: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
-0003e010: 696b 6528 6466 2e5f 6d65 7461 293a 0a20  ike(df._meta):. 
-0003e020: 2020 2020 2020 2020 2020 2073 6572 6965             serie
-0003e030: 735f 7479 7020 3d20 6466 2e5f 6d65 7461  s_typ = df._meta
-0003e040: 2e5f 636f 6e73 7472 7563 746f 720a 2020  ._constructor.  
-0003e050: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0003e060: 2020 2020 2020 2020 7365 7269 6573 5f74          series_t
-0003e070: 7970 203d 2064 662e 5f6d 6574 612e 5f63  yp = df._meta._c
-0003e080: 6f6e 7374 7275 6374 6f72 5f73 6c69 6365  onstructor_slice
-0003e090: 640a 2020 2020 2020 2020 6d65 7461 203d  d.        meta =
-0003e0a0: 2064 662e 5f6d 6574 615f 6e6f 6e65 6d70   df._meta_nonemp
-0003e0b0: 7479 2e71 7561 6e74 696c 6528 7129 0a0a  ty.quantile(q)..
-0003e0c0: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
-0003e0d0: 5f6c 696b 6528 6d65 7461 293a 0a20 2020  _like(meta):.   
-0003e0e0: 2020 2020 2023 2049 6e64 6578 2e71 7561       # Index.qua
-0003e0f0: 6e74 696c 6528 6c69 7374 2d6c 696b 6529  ntile(list-like)
-0003e100: 206d 7573 7420 6265 2070 642e 5365 7269   must be pd.Seri
-0003e110: 6573 2c20 6e6f 7420 7064 2e49 6e64 6578  es, not pd.Index
-0003e120: 0a20 2020 2020 2020 2064 665f 6e61 6d65  .        df_name
-0003e130: 203d 2064 662e 6e61 6d65 0a20 2020 2020   = df.name.     
-0003e140: 2020 2066 696e 616c 697a 655f 7473 6b20     finalize_tsk 
-0003e150: 3d20 6c61 6d62 6461 2074 736b 3a20 2873  = lambda tsk: (s
-0003e160: 6572 6965 735f 7479 702c 2074 736b 2c20  eries_typ, tsk, 
-0003e170: 712c 204e 6f6e 652c 2064 665f 6e61 6d65  q, None, df_name
-0003e180: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0003e190: 5f74 7970 6520 3d20 5365 7269 6573 0a20  _type = Series. 
-0003e1a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003e1b0: 2066 696e 616c 697a 655f 7473 6b20 3d20   finalize_tsk = 
-0003e1c0: 6c61 6d62 6461 2074 736b 3a20 2867 6574  lambda tsk: (get
-0003e1d0: 6974 656d 2c20 7473 6b2c 2030 290a 2020  item, tsk, 0).  
-0003e1e0: 2020 2020 2020 7265 7475 726e 5f74 7970        return_typ
-0003e1f0: 6520 3d20 5363 616c 6172 0a20 2020 2020  e = Scalar.     
-0003e200: 2020 2071 203d 205b 715d 0a0a 2020 2020     q = [q]..    
-0003e210: 2320 7061 6e64 6173 2075 7365 7320 7175  # pandas uses qu
-0003e220: 616e 7469 6c65 2069 6e20 5b30 2c20 315d  antile in [0, 1]
-0003e230: 0a20 2020 2023 206e 756d 7079 202f 2065  .    # numpy / e
-0003e240: 7665 7279 6f6e 6520 656c 7365 2075 7365  veryone else use
-0003e250: 7320 5b30 2c20 3130 305d 0a20 2020 2071  s [0, 100].    q
-0003e260: 7320 3d20 6e70 2e61 7361 7272 6179 2871  s = np.asarray(q
-0003e270: 2920 2a20 3130 300a 2020 2020 746f 6b65  ) * 100.    toke
-0003e280: 6e20 3d20 746f 6b65 6e69 7a65 2864 662c  n = tokenize(df,
-0003e290: 2071 7329 0a0a 2020 2020 6966 206c 656e   qs)..    if len
-0003e2a0: 2871 7329 203d 3d20 303a 0a20 2020 2020  (qs) == 0:.     
-0003e2b0: 2020 206e 616d 6520 3d20 2271 7561 6e74     name = "quant
-0003e2c0: 696c 6573 2d22 202b 2074 6f6b 656e 0a20  iles-" + token. 
-0003e2d0: 2020 2020 2020 2065 6d70 7479 5f69 6e64         empty_ind
-0003e2e0: 6578 203d 2070 642e 496e 6465 7828 5b5d  ex = pd.Index([]
-0003e2f0: 2c20 6474 7970 653d 666c 6f61 7429 0a0a  , dtype=float)..
-0003e300: 2020 2020 2020 2020 7265 7475 726e 2053          return S
-0003e310: 6572 6965 7328 0a20 2020 2020 2020 2020  eries(.         
-0003e320: 2020 207b 286e 616d 652c 2030 293a 2073     {(name, 0): s
-0003e330: 6572 6965 735f 7479 7028 5b5d 2c20 6e61  eries_typ([], na
-0003e340: 6d65 3d64 662e 6e61 6d65 2c20 696e 6465  me=df.name, inde
-0003e350: 783d 656d 7074 795f 696e 6465 782c 2064  x=empty_index, d
-0003e360: 7479 7065 3d22 666c 6f61 7422 297d 2c0a  type="float")},.
-0003e370: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-0003e380: 2c0a 2020 2020 2020 2020 2020 2020 6466  ,.            df
-0003e390: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
-0003e3a0: 2020 2020 5b4e 6f6e 652c 204e 6f6e 655d      [None, None]
-0003e3b0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0003e3c0: 656c 7365 3a0a 2020 2020 2020 2020 6e65  else:.        ne
-0003e3d0: 775f 6469 7669 7369 6f6e 7320 3d20 5b6e  w_divisions = [n
-0003e3e0: 702e 6d69 6e28 7129 2c20 6e70 2e6d 6178  p.min(q), np.max
-0003e3f0: 2871 295d 0a0a 2020 2020 6466 203d 2064  (q)]..    df = d
-0003e400: 662e 6472 6f70 6e61 2829 0a0a 2020 2020  f.dropna()..    
-0003e410: 6966 2069 6e74 6572 6e61 6c5f 6d65 7468  if internal_meth
-0003e420: 6f64 203d 3d20 2274 6469 6765 7374 2220  od == "tdigest" 
-0003e430: 616e 6420 280a 2020 2020 2020 2020 6e70  and (.        np
-0003e440: 2e69 7373 7562 6474 7970 6528 6466 2e64  .issubdtype(df.d
-0003e450: 7479 7065 2c20 6e70 2e66 6c6f 6174 696e  type, np.floatin
-0003e460: 6729 206f 7220 6e70 2e69 7373 7562 6474  g) or np.issubdt
-0003e470: 7970 6528 6466 2e64 7479 7065 2c20 6e70  ype(df.dtype, np
-0003e480: 2e69 6e74 6567 6572 290a 2020 2020 293a  .integer).    ):
-0003e490: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-0003e4a0: 736b 2e75 7469 6c73 2069 6d70 6f72 7420  sk.utils import 
-0003e4b0: 696d 706f 7274 5f72 6571 7569 7265 640a  import_required.
-0003e4c0: 0a20 2020 2020 2020 2069 6d70 6f72 745f  .        import_
-0003e4d0: 7265 7175 6972 6564 280a 2020 2020 2020  required(.      
-0003e4e0: 2020 2020 2020 2263 7269 636b 222c 2022        "crick", "
-0003e4f0: 6372 6963 6b20 6973 2061 2072 6571 7569  crick is a requi
-0003e500: 7265 6420 6465 7065 6e64 656e 6379 2066  red dependency f
-0003e510: 6f72 2075 7369 6e67 2074 6865 2074 2d64  or using the t-d
-0003e520: 6967 6573 7420 6d65 7468 6f64 2e22 0a20  igest method.". 
-0003e530: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0003e540: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-0003e550: 792e 7065 7263 656e 7469 6c65 2069 6d70  y.percentile imp
-0003e560: 6f72 7420 5f70 6572 6365 6e74 696c 6573  ort _percentiles
-0003e570: 5f66 726f 6d5f 7464 6967 6573 742c 205f  _from_tdigest, _
-0003e580: 7464 6967 6573 745f 6368 756e 6b0a 0a20  tdigest_chunk.. 
-0003e590: 2020 2020 2020 206e 616d 6520 3d20 2271         name = "q
-0003e5a0: 7561 6e74 696c 6573 5f74 6469 6765 7374  uantiles_tdigest
-0003e5b0: 2d31 2d22 202b 2074 6f6b 656e 0a20 2020  -1-" + token.   
-0003e5c0: 2020 2020 2076 616c 5f64 736b 203d 207b       val_dsk = {
-0003e5d0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
-0003e5e0: 6d65 2c20 6929 3a20 285f 7464 6967 6573  me, i): (_tdiges
-0003e5f0: 745f 6368 756e 6b2c 2028 6765 7461 7474  t_chunk, (getatt
-0003e600: 722c 206b 6579 2c20 2276 616c 7565 7322  r, key, "values"
-0003e610: 2929 0a20 2020 2020 2020 2020 2020 2066  )).            f
-0003e620: 6f72 2069 2c20 6b65 7920 696e 2065 6e75  or i, key in enu
-0003e630: 6d65 7261 7465 2864 662e 5f5f 6461 736b  merate(df.__dask
-0003e640: 5f6b 6579 735f 5f28 2929 0a20 2020 2020  _keys__()).     
-0003e650: 2020 207d 0a0a 2020 2020 2020 2020 6e61     }..        na
-0003e660: 6d65 3220 3d20 2271 7561 6e74 696c 6573  me2 = "quantiles
-0003e670: 5f74 6469 6765 7374 2d32 2d22 202b 2074  _tdigest-2-" + t
-0003e680: 6f6b 656e 0a20 2020 2020 2020 206d 6572  oken.        mer
-0003e690: 6765 5f64 736b 203d 207b 0a20 2020 2020  ge_dsk = {.     
-0003e6a0: 2020 2020 2020 2028 6e61 6d65 322c 2030         (name2, 0
-0003e6b0: 293a 2066 696e 616c 697a 655f 7473 6b28  ): finalize_tsk(
-0003e6c0: 285f 7065 7263 656e 7469 6c65 735f 6672  (_percentiles_fr
-0003e6d0: 6f6d 5f74 6469 6765 7374 2c20 7173 2c20  om_tdigest, qs, 
-0003e6e0: 736f 7274 6564 2876 616c 5f64 736b 2929  sorted(val_dsk))
-0003e6f0: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
-0003e700: 656c 7365 3a0a 2020 2020 2020 2020 6672  else:.        fr
-0003e710: 6f6d 2064 6173 6b2e 6172 7261 792e 6469  om dask.array.di
-0003e720: 7370 6174 6368 2069 6d70 6f72 7420 7065  spatch import pe
-0003e730: 7263 656e 7469 6c65 5f6c 6f6f 6b75 7020  rcentile_lookup 
-0003e740: 6173 205f 7065 7263 656e 7469 6c65 0a20  as _percentile. 
-0003e750: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-0003e760: 2e61 7272 6179 2e70 6572 6365 6e74 696c  .array.percentil
-0003e770: 6520 696d 706f 7274 206d 6572 6765 5f70  e import merge_p
-0003e780: 6572 6365 6e74 696c 6573 0a0a 2020 2020  ercentiles..    
-0003e790: 2020 2020 2320 4164 6420 3020 616e 6420      # Add 0 and 
-0003e7a0: 3130 3020 6475 7269 6e67 2063 616c 6375  100 during calcu
-0003e7b0: 6c61 7469 6f6e 2066 6f72 206d 6f72 6520  lation for more 
-0003e7c0: 726f 6275 7374 2062 6568 6176 696f 7220  robust behavior 
-0003e7d0: 2868 6f70 6566 756c 6c79 290a 2020 2020  (hopefully).    
-0003e7e0: 2020 2020 6361 6c63 5f71 7320 3d20 6e70      calc_qs = np
-0003e7f0: 2e70 6164 2871 732c 2031 2c20 6d6f 6465  .pad(qs, 1, mode
-0003e800: 3d22 636f 6e73 7461 6e74 2229 0a20 2020  ="constant").   
-0003e810: 2020 2020 2063 616c 635f 7173 5b2d 315d       calc_qs[-1]
-0003e820: 203d 2031 3030 0a20 2020 2020 2020 206e   = 100.        n
-0003e830: 616d 6520 3d20 2271 7561 6e74 696c 6573  ame = "quantiles
-0003e840: 2d31 2d22 202b 2074 6f6b 656e 0a20 2020  -1-" + token.   
-0003e850: 2020 2020 2076 616c 5f64 736b 203d 207b       val_dsk = {
-0003e860: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
-0003e870: 6d65 2c20 6929 3a20 285f 7065 7263 656e  me, i): (_percen
-0003e880: 7469 6c65 2c20 6b65 792c 2063 616c 635f  tile, key, calc_
-0003e890: 7173 290a 2020 2020 2020 2020 2020 2020  qs).            
-0003e8a0: 666f 7220 692c 206b 6579 2069 6e20 656e  for i, key in en
-0003e8b0: 756d 6572 6174 6528 6466 2e5f 5f64 6173  umerate(df.__das
-0003e8c0: 6b5f 6b65 7973 5f5f 2829 290a 2020 2020  k_keys__()).    
-0003e8d0: 2020 2020 7d0a 0a20 2020 2020 2020 206e      }..        n
-0003e8e0: 616d 6532 203d 2022 7175 616e 7469 6c65  ame2 = "quantile
-0003e8f0: 732d 322d 2220 2b20 746f 6b65 6e0a 2020  s-2-" + token.  
-0003e900: 2020 2020 2020 6d65 7267 655f 6473 6b20        merge_dsk 
-0003e910: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0003e920: 286e 616d 6532 2c20 3029 3a20 6669 6e61  (name2, 0): fina
-0003e930: 6c69 7a65 5f74 736b 280a 2020 2020 2020  lize_tsk(.      
-0003e940: 2020 2020 2020 2020 2020 280a 2020 2020            (.    
-0003e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e960: 6d65 7267 655f 7065 7263 656e 7469 6c65  merge_percentile
-0003e970: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0003e980: 2020 2020 2020 2071 732c 0a20 2020 2020         qs,.     
-0003e990: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0003e9a0: 6361 6c63 5f71 735d 202a 2064 662e 6e70  calc_qs] * df.np
-0003e9b0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
-0003e9c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0003e9d0: 6f72 7465 6428 7661 6c5f 6473 6b29 2c0a  orted(val_dsk),.
-0003e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e9f0: 2020 2020 226c 6f77 6572 222c 0a20 2020      "lower",.   
-0003ea00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ea10: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0003ea20: 2020 2020 2020 2020 2020 2046 616c 7365             False
-0003ea30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003ea40: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0003ea50: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
-0003ea60: 6473 6b20 3d20 6d65 7267 6528 7661 6c5f  dsk = merge(val_
-0003ea70: 6473 6b2c 206d 6572 6765 5f64 736b 290a  dsk, merge_dsk).
-0003ea80: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
-0003ea90: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-0003eaa0: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
-0003eab0: 322c 2064 736b 2c20 6465 7065 6e64 656e  2, dsk, dependen
-0003eac0: 6369 6573 3d5b 6466 5d29 0a20 2020 2072  cies=[df]).    r
-0003ead0: 6574 7572 6e20 7265 7475 726e 5f74 7970  eturn return_typ
-0003eae0: 6528 6772 6170 682c 206e 616d 6532 2c20  e(graph, name2, 
-0003eaf0: 6d65 7461 2c20 6e65 775f 6469 7669 7369  meta, new_divisi
-0003eb00: 6f6e 7329 0a0a 0a64 6566 205f 636f 765f  ons)...def _cov_
-0003eb10: 636f 7272 280a 2020 2020 6466 2c0a 2020  corr(.    df,.  
-0003eb20: 2020 6d69 6e5f 7065 7269 6f64 733d 4e6f    min_periods=No
-0003eb30: 6e65 2c0a 2020 2020 636f 7272 3d46 616c  ne,.    corr=Fal
-0003eb40: 7365 2c0a 2020 2020 7363 616c 6172 3d46  se,.    scalar=F
-0003eb50: 616c 7365 2c0a 2020 2020 6e75 6d65 7269  alse,.    numeri
-0003eb60: 635f 6f6e 6c79 3d6e 6f5f 6465 6661 756c  c_only=no_defaul
-0003eb70: 742c 0a20 2020 2073 706c 6974 5f65 7665  t,.    split_eve
-0003eb80: 7279 3d46 616c 7365 2c0a 293a 0a20 2020  ry=False,.):.   
-0003eb90: 2022 2222 4461 7461 4672 616d 6520 636f   """DataFrame co
-0003eba0: 7661 7269 616e 6365 2061 6e64 2070 6561  variance and pea
-0003ebb0: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
-0003ebc0: 2e0a 0a20 2020 2043 6f6d 7075 7465 7320  ...    Computes 
-0003ebd0: 7061 6972 7769 7365 2063 6f76 6172 6961  pairwise covaria
-0003ebe0: 6e63 6520 6f72 2063 6f72 7265 6c61 7469  nce or correlati
-0003ebf0: 6f6e 206f 6620 636f 6c75 6d6e 732c 2065  on of columns, e
-0003ec00: 7863 6c75 6469 6e67 204e 412f 6e75 6c6c  xcluding NA/null
-0003ec10: 0a20 2020 2076 616c 7565 732e 0a0a 2020  .    values...  
-0003ec20: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0003ec30: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0003ec40: 6466 203a 2044 6174 6146 7261 6d65 0a20  df : DataFrame. 
-0003ec50: 2020 206d 696e 5f70 6572 696f 6473 203a     min_periods :
-0003ec60: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-0003ec70: 2020 2020 2020 204d 696e 696d 756d 206e         Minimum n
-0003ec80: 756d 6265 7220 6f66 206f 6273 6572 7661  umber of observa
-0003ec90: 7469 6f6e 7320 7265 7175 6972 6564 2070  tions required p
-0003eca0: 6572 2070 6169 7220 6f66 2063 6f6c 756d  er pair of colum
-0003ecb0: 6e73 0a20 2020 2020 2020 2074 6f20 6861  ns.        to ha
-0003ecc0: 7665 2061 2076 616c 6964 2072 6573 756c  ve a valid resul
-0003ecd0: 742e 0a20 2020 2063 6f72 7220 3a20 626f  t..    corr : bo
-0003ece0: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
-0003ecf0: 2020 2020 2049 6620 5472 7565 2c20 636f       If True, co
-0003ed00: 6d70 7574 6520 7468 6520 5065 6172 736f  mpute the Pearso
-0003ed10: 6e20 636f 7272 656c 6174 696f 6e2e 2049  n correlation. I
-0003ed20: 6620 4661 6c73 6520 5b64 6566 6175 6c74  f False [default
-0003ed30: 5d2c 2063 6f6d 7075 7465 0a20 2020 2020  ], compute.     
-0003ed40: 2020 2074 6865 2063 6f76 6172 6961 6e63     the covarianc
-0003ed50: 652e 0a20 2020 2073 6361 6c61 7220 3a20  e..    scalar : 
-0003ed60: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-0003ed70: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-0003ed80: 636f 6d70 7574 6520 636f 7661 7269 616e  compute covarian
-0003ed90: 6365 2062 6574 7765 656e 2074 776f 2076  ce between two v
-0003eda0: 6172 6961 626c 6573 2061 7320 6120 7363  ariables as a sc
-0003edb0: 616c 6172 2e20 4f6e 6c79 0a20 2020 2020  alar. Only.     
-0003edc0: 2020 2076 616c 6964 2069 6620 6064 6660     valid if `df`
-0003edd0: 2068 6173 2032 2063 6f6c 756d 6e73 2e20   has 2 columns. 
-0003ede0: 2049 6620 4661 6c73 6520 5b64 6566 6175   If False [defau
-0003edf0: 6c74 5d2c 2063 6f6d 7075 7465 2074 6865  lt], compute the
-0003ee00: 2065 6e74 6972 650a 2020 2020 2020 2020   entire.        
-0003ee10: 636f 7661 7269 616e 6365 2f63 6f72 7265  covariance/corre
-0003ee20: 6c61 7469 6f6e 206d 6174 7269 782e 0a20  lation matrix.. 
-0003ee30: 2020 2073 706c 6974 5f65 7665 7279 203a     split_every :
-0003ee40: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-0003ee50: 2020 2020 2020 2047 726f 7570 2070 6172         Group par
-0003ee60: 7469 7469 6f6e 7320 696e 746f 2067 726f  titions into gro
-0003ee70: 7570 7320 6f66 2074 6869 7320 7369 7a65  ups of this size
-0003ee80: 2077 6869 6c65 2070 6572 666f 726d 696e   while performin
-0003ee90: 6720 610a 2020 2020 2020 2020 7472 6565  g a.        tree
-0003eea0: 2d72 6564 7563 7469 6f6e 2e20 4966 2073  -reduction. If s
-0003eeb0: 6574 2074 6f20 4661 6c73 652c 206e 6f20  et to False, no 
-0003eec0: 7472 6565 2d72 6564 7563 7469 6f6e 2077  tree-reduction w
-0003eed0: 696c 6c20 6265 2075 7365 642e 0a20 2020  ill be used..   
-0003eee0: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
-0003eef0: 4661 6c73 652e 0a20 2020 2022 2222 0a20  False..    """. 
-0003ef00: 2020 2069 6620 6d69 6e5f 7065 7269 6f64     if min_period
-0003ef10: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-0003ef20: 2020 206d 696e 5f70 6572 696f 6473 203d     min_periods =
-0003ef30: 2032 0a20 2020 2065 6c69 6620 6d69 6e5f   2.    elif min_
-0003ef40: 7065 7269 6f64 7320 3c20 323a 0a20 2020  periods < 2:.   
-0003ef50: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0003ef60: 4572 726f 7228 226d 696e 5f70 6572 696f  Error("min_perio
-0003ef70: 6473 206d 7573 7420 6265 203e 3d20 3222  ds must be >= 2"
-0003ef80: 290a 0a20 2020 2069 6620 7370 6c69 745f  )..    if split_
-0003ef90: 6576 6572 7920 6973 2046 616c 7365 3a0a  every is False:.
-0003efa0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-0003efb0: 6572 7920 3d20 6466 2e6e 7061 7274 6974  ery = df.npartit
-0003efc0: 696f 6e73 0a20 2020 2065 6c69 6620 7370  ions.    elif sp
-0003efd0: 6c69 745f 6576 6572 7920 3c20 3220 6f72  lit_every < 2 or
-0003efe0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0003eff0: 7370 6c69 745f 6576 6572 792c 2049 6e74  split_every, Int
-0003f000: 6567 7261 6c29 3a0a 2020 2020 2020 2020  egral):.        
-0003f010: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0003f020: 2822 7370 6c69 745f 6576 6572 7920 6d75  ("split_every mu
-0003f030: 7374 2062 6520 616e 2069 6e74 6567 6572  st be an integer
-0003f040: 203e 3d20 3222 290a 0a20 2020 2023 2048   >= 2")..    # H
-0003f050: 616e 646c 6520 7365 6c65 6374 696e 6720  andle selecting 
-0003f060: 6e75 6d65 7269 6320 6461 7461 2061 6e64  numeric data and
-0003f070: 2061 7373 6f63 6961 7465 6420 6465 7072   associated depr
-0003f080: 6563 6174 696f 6e20 7761 726e 696e 670a  ecation warning.
-0003f090: 2020 2020 6d61 7962 655f 7761 726e 203d      maybe_warn =
-0003f0a0: 2046 616c 7365 0a20 2020 2069 6620 6e75   False.    if nu
-0003f0b0: 6d65 7269 635f 6f6e 6c79 2069 7320 6e6f  meric_only is no
-0003f0c0: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
-0003f0d0: 2020 6966 2050 414e 4441 535f 4754 5f32    if PANDAS_GT_2
-0003f0e0: 3030 3a0a 2020 2020 2020 2020 2020 2020  00:.            
-0003f0f0: 6e75 6d65 7269 635f 6f6e 6c79 203d 2046  numeric_only = F
-0003f100: 616c 7365 0a20 2020 2020 2020 2065 6c69  alse.        eli
-0003f110: 6620 5041 4e44 4153 5f47 545f 3135 303a  f PANDAS_GT_150:
-0003f120: 0a20 2020 2020 2020 2020 2020 206d 6179  .            may
-0003f130: 6265 5f77 6172 6e20 3d20 5472 7565 0a20  be_warn = True. 
-0003f140: 2020 2020 2020 2020 2020 206e 756d 6572             numer
-0003f150: 6963 5f6f 6e6c 7920 3d20 5472 7565 0a20  ic_only = True. 
-0003f160: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0003f170: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
-0003f180: 5f6f 6e6c 7920 3d20 5472 7565 0a0a 2020  _only = True..  
-0003f190: 2020 616c 6c5f 6e75 6d65 7269 6320 3d20    all_numeric = 
-0003f1a0: 6466 2e5f 6765 745f 6e75 6d65 7269 635f  df._get_numeric_
-0003f1b0: 6461 7461 2829 2e5f 6e61 6d65 203d 3d20  data()._name == 
-0003f1c0: 6466 2e5f 6e61 6d65 0a20 2020 2069 6620  df._name.    if 
-0003f1d0: 6d61 7962 655f 7761 726e 2061 6e64 206e  maybe_warn and n
-0003f1e0: 6f74 2061 6c6c 5f6e 756d 6572 6963 3a0a  ot all_numeric:.
-0003f1f0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-0003f200: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-0003f210: 2020 2022 5468 6520 6465 6661 756c 7420     "The default 
-0003f220: 7661 6c75 6520 6f66 206e 756d 6572 6963  value of numeric
-0003f230: 5f6f 6e6c 7920 7769 6c6c 2062 6520 6046  _only will be `F
-0003f240: 616c 7365 6020 220a 2020 2020 2020 2020  alse` ".        
-0003f250: 2020 2020 2269 6e20 6120 6675 7475 7265      "in a future
-0003f260: 2076 6572 7369 6f6e 206f 6620 4461 736b   version of Dask
-0003f270: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-0003f280: 4675 7475 7265 5761 726e 696e 672c 0a20  FutureWarning,. 
-0003f290: 2020 2020 2020 2029 0a0a 2020 2020 6966         )..    if
-0003f2a0: 206e 756d 6572 6963 5f6f 6e6c 7920 616e   numeric_only an
-0003f2b0: 6420 6e6f 7420 616c 6c5f 6e75 6d65 7269  d not all_numeri
-0003f2c0: 633a 0a20 2020 2020 2020 2064 6620 3d20  c:.        df = 
-0003f2d0: 6466 2e5f 6765 745f 6e75 6d65 7269 635f  df._get_numeric_
-0003f2e0: 6461 7461 2829 0a0a 2020 2020 6966 2073  data()..    if s
-0003f2f0: 6361 6c61 7220 616e 6420 6c65 6e28 6466  calar and len(df
-0003f300: 2e63 6f6c 756d 6e73 2920 213d 2032 3a0a  .columns) != 2:.
-0003f310: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0003f320: 6c75 6545 7272 6f72 2822 7363 616c 6172  lueError("scalar
-0003f330: 206f 6e6c 7920 7661 6c69 6420 666f 7220   only valid for 
-0003f340: 3220 636f 6c75 6d6e 2064 6174 6166 7261  2 column datafra
-0003f350: 6d65 2229 0a0a 2020 2020 746f 6b65 6e20  me")..    token 
-0003f360: 3d20 746f 6b65 6e69 7a65 2864 662c 206d  = tokenize(df, m
-0003f370: 696e 5f70 6572 696f 6473 2c20 7363 616c  in_periods, scal
-0003f380: 6172 2c20 7370 6c69 745f 6576 6572 7929  ar, split_every)
-0003f390: 0a0a 2020 2020 6675 6e63 6e61 6d65 203d  ..    funcname =
-0003f3a0: 2022 636f 7272 2220 6966 2063 6f72 7220   "corr" if corr 
-0003f3b0: 656c 7365 2022 636f 7622 0a20 2020 2061  else "cov".    a
-0003f3c0: 203d 2066 227b 6675 6e63 6e61 6d65 7d2d   = f"{funcname}-
-0003f3d0: 6368 756e 6b2d 7b64 662e 5f6e 616d 657d  chunk-{df._name}
-0003f3e0: 220a 2020 2020 6473 6b20 3d20 7b0a 2020  ".    dsk = {.  
-0003f3f0: 2020 2020 2020 2861 2c20 6929 3a20 285f        (a, i): (_
-0003f400: 636f 765f 636f 7272 5f63 6875 6e6b 2c20  cov_corr_chunk, 
-0003f410: 662c 2063 6f72 7229 2066 6f72 2028 692c  f, corr) for (i,
-0003f420: 2066 2920 696e 2065 6e75 6d65 7261 7465   f) in enumerate
-0003f430: 2864 662e 5f5f 6461 736b 5f6b 6579 735f  (df.__dask_keys_
-0003f440: 5f28 2929 0a20 2020 207d 0a0a 2020 2020  _()).    }..    
-0003f450: 7072 6566 6978 203d 2066 227b 6675 6e63  prefix = f"{func
-0003f460: 6e61 6d65 7d2d 636f 6d62 696e 652d 7b64  name}-combine-{d
-0003f470: 662e 5f6e 616d 657d 2d22 0a20 2020 206b  f._name}-".    k
-0003f480: 203d 2064 662e 6e70 6172 7469 7469 6f6e   = df.npartition
-0003f490: 730a 2020 2020 6220 3d20 610a 2020 2020  s.    b = a.    
-0003f4a0: 6465 7074 6820 3d20 300a 2020 2020 7768  depth = 0.    wh
-0003f4b0: 696c 6520 6b20 3e20 7370 6c69 745f 6576  ile k > split_ev
-0003f4c0: 6572 793a 0a20 2020 2020 2020 2062 203d  ery:.        b =
-0003f4d0: 2070 7265 6669 7820 2b20 7374 7228 6465   prefix + str(de
-0003f4e0: 7074 6829 0a20 2020 2020 2020 2066 6f72  pth).        for
-0003f4f0: 2070 6172 745f 692c 2069 6e64 7320 696e   part_i, inds in
-0003f500: 2065 6e75 6d65 7261 7465 2870 6172 7469   enumerate(parti
-0003f510: 7469 6f6e 5f61 6c6c 2873 706c 6974 5f65  tion_all(split_e
-0003f520: 7665 7279 2c20 7261 6e67 6528 6b29 2929  very, range(k)))
-0003f530: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
-0003f540: 6b5b 2862 2c20 7061 7274 5f69 295d 203d  k[(b, part_i)] =
-0003f550: 2028 5f63 6f76 5f63 6f72 725f 636f 6d62   (_cov_corr_comb
-0003f560: 696e 652c 205b 2861 2c20 6929 2066 6f72  ine, [(a, i) for
-0003f570: 2069 2069 6e20 696e 6473 5d2c 2063 6f72   i in inds], cor
-0003f580: 7229 0a20 2020 2020 2020 206b 203d 2070  r).        k = p
-0003f590: 6172 745f 6920 2b20 310a 2020 2020 2020  art_i + 1.      
-0003f5a0: 2020 6120 3d20 620a 2020 2020 2020 2020    a = b.        
-0003f5b0: 6465 7074 6820 2b3d 2031 0a0a 2020 2020  depth += 1..    
-0003f5c0: 6e61 6d65 203d 2066 227b 6675 6e63 6e61  name = f"{funcna
-0003f5d0: 6d65 7d2d 7b74 6f6b 656e 7d22 0a20 2020  me}-{token}".   
-0003f5e0: 2064 736b 5b28 6e61 6d65 2c20 3029 5d20   dsk[(name, 0)] 
-0003f5f0: 3d20 280a 2020 2020 2020 2020 5f63 6f76  = (.        _cov
-0003f600: 5f63 6f72 725f 6167 672c 0a20 2020 2020  _corr_agg,.     
-0003f610: 2020 205b 2861 2c20 6929 2066 6f72 2069     [(a, i) for i
-0003f620: 2069 6e20 7261 6e67 6528 6b29 5d2c 0a20   in range(k)],. 
-0003f630: 2020 2020 2020 2064 662e 636f 6c75 6d6e         df.column
-0003f640: 732c 0a20 2020 2020 2020 206d 696e 5f70  s,.        min_p
-0003f650: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
-0003f660: 636f 7272 2c0a 2020 2020 2020 2020 7363  corr,.        sc
-0003f670: 616c 6172 2c0a 2020 2020 2020 2020 6466  alar,.        df
-0003f680: 2e5f 6d65 7461 2c0a 2020 2020 290a 2020  ._meta,.    ).  
-0003f690: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-0003f6a0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-0003f6b0: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-0003f6c0: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-0003f6d0: 733d 5b64 665d 290a 2020 2020 6966 2073  s=[df]).    if s
-0003f6e0: 6361 6c61 723a 0a20 2020 2020 2020 2072  calar:.        r
-0003f6f0: 6574 7572 6e20 5363 616c 6172 2867 7261  eturn Scalar(gra
-0003f700: 7068 2c20 6e61 6d65 2c20 2266 3822 290a  ph, name, "f8").
-0003f710: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
-0003f720: 6d65 7461 280a 2020 2020 2020 2020 5b28  meta(.        [(
-0003f730: 632c 2022 6638 2229 2066 6f72 2063 2069  c, "f8") for c i
-0003f740: 6e20 6466 2e63 6f6c 756d 6e73 5d2c 0a20  n df.columns],. 
-0003f750: 2020 2020 2020 2069 6e64 6578 3d6d 6574         index=met
-0003f760: 615f 7365 7269 6573 5f63 6f6e 7374 7275  a_series_constru
-0003f770: 6374 6f72 2864 6629 2864 662e 636f 6c75  ctor(df)(df.colu
-0003f780: 6d6e 7329 2c0a 2020 2020 2020 2020 7061  mns),.        pa
-0003f790: 7265 6e74 5f6d 6574 613d 6466 2e5f 6d65  rent_meta=df._me
-0003f7a0: 7461 2c0a 2020 2020 290a 2020 2020 7265  ta,.    ).    re
-0003f7b0: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
-0003f7c0: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
-0003f7d0: 6d65 7461 2c20 2864 662e 636f 6c75 6d6e  meta, (df.column
-0003f7e0: 732e 6d69 6e28 292c 2064 662e 636f 6c75  s.min(), df.colu
-0003f7f0: 6d6e 732e 6d61 7828 2929 290a 0a0a 6465  mns.max()))...de
-0003f800: 6620 5f63 6f76 5f63 6f72 725f 6368 756e  f _cov_corr_chun
-0003f810: 6b28 6466 2c20 636f 7272 3d46 616c 7365  k(df, corr=False
-0003f820: 293a 0a20 2020 2022 2222 4368 756e 6b20  ):.    """Chunk 
-0003f830: 7061 7274 206f 6620 6120 636f 7661 7269  part of a covari
-0003f840: 616e 6365 206f 7220 636f 7272 656c 6174  ance or correlat
-0003f850: 696f 6e20 636f 6d70 7574 6174 696f 6e22  ion computation"
-0003f860: 2222 0a20 2020 2073 6861 7065 203d 2028  "".    shape = (
-0003f870: 6466 2e73 6861 7065 5b31 5d2c 2064 662e  df.shape[1], df.
-0003f880: 7368 6170 655b 315d 290a 2020 2020 6466  shape[1]).    df
-0003f890: 203d 2064 662e 6173 7479 7065 2822 666c   = df.astype("fl
-0003f8a0: 6f61 7436 3422 2c20 636f 7079 3d46 616c  oat64", copy=Fal
-0003f8b0: 7365 290a 2020 2020 7375 6d73 203d 206e  se).    sums = n
-0003f8c0: 702e 7a65 726f 735f 6c69 6b65 2864 662e  p.zeros_like(df.
-0003f8d0: 7661 6c75 6573 2c20 7368 6170 653d 7368  values, shape=sh
-0003f8e0: 6170 6529 0a20 2020 2063 6f75 6e74 7320  ape).    counts 
-0003f8f0: 3d20 6e70 2e7a 6572 6f73 5f6c 696b 6528  = np.zeros_like(
-0003f900: 6466 2e76 616c 7565 732c 2073 6861 7065  df.values, shape
-0003f910: 3d73 6861 7065 290a 2020 2020 666f 7220  =shape).    for 
-0003f920: 6964 7820 696e 2072 616e 6765 286c 656e  idx in range(len
-0003f930: 2864 662e 636f 6c75 6d6e 7329 293a 0a20  (df.columns)):. 
-0003f940: 2020 2020 2020 206d 6173 6b20 3d20 6466         mask = df
-0003f950: 2e69 6c6f 635b 3a2c 2069 6478 5d2e 6e6f  .iloc[:, idx].no
-0003f960: 746e 756c 6c28 290a 2020 2020 2020 2020  tnull().        
-0003f970: 7375 6d73 5b69 6478 5d20 3d20 6466 5b6d  sums[idx] = df[m
-0003f980: 6173 6b5d 2e73 756d 2829 2e76 616c 7565  ask].sum().value
-0003f990: 730a 2020 2020 2020 2020 636f 756e 7473  s.        counts
-0003f9a0: 5b69 6478 5d20 3d20 6466 5b6d 6173 6b5d  [idx] = df[mask]
-0003f9b0: 2e63 6f75 6e74 2829 2e76 616c 7565 730a  .count().values.
-0003f9c0: 2020 2020 636f 7620 3d20 6466 2e63 6f76      cov = df.cov
-0003f9d0: 2829 2e76 616c 7565 730a 2020 2020 6474  ().values.    dt
-0003f9e0: 7970 6520 3d20 5b28 2273 756d 222c 2073  ype = [("sum", s
-0003f9f0: 756d 732e 6474 7970 6529 2c20 2822 636f  ums.dtype), ("co
-0003fa00: 756e 7422 2c20 636f 756e 7473 2e64 7479  unt", counts.dty
-0003fa10: 7065 292c 2028 2263 6f76 222c 2063 6f76  pe), ("cov", cov
-0003fa20: 2e64 7479 7065 295d 0a20 2020 2069 6620  .dtype)].    if 
-0003fa30: 636f 7272 3a0a 2020 2020 2020 2020 7769  corr:.        wi
-0003fa40: 7468 2077 6172 6e69 6e67 732e 6361 7463  th warnings.catc
-0003fa50: 685f 7761 726e 696e 6773 2872 6563 6f72  h_warnings(recor
-0003fa60: 643d 5472 7565 293a 0a20 2020 2020 2020  d=True):.       
-0003fa70: 2020 2020 2077 6172 6e69 6e67 732e 7369       warnings.si
-0003fa80: 6d70 6c65 6669 6c74 6572 2822 616c 7761  mplefilter("alwa
-0003fa90: 7973 2229 0a20 2020 2020 2020 2020 2020  ys").           
-0003faa0: 206d 7520 3d20 2873 756d 7320 2f20 636f   mu = (sums / co
-0003fab0: 756e 7473 292e 540a 2020 2020 2020 2020  unts).T.        
-0003fac0: 6d20 3d20 6e70 2e7a 6572 6f73 5f6c 696b  m = np.zeros_lik
-0003fad0: 6528 6466 2e76 616c 7565 732c 2073 6861  e(df.values, sha
-0003fae0: 7065 3d73 6861 7065 290a 2020 2020 2020  pe=shape).      
-0003faf0: 2020 6d61 736b 203d 2064 662e 6973 6e75    mask = df.isnu
-0003fb00: 6c6c 2829 2e76 616c 7565 730a 2020 2020  ll().values.    
-0003fb10: 2020 2020 666f 7220 6964 7820 696e 2072      for idx in r
-0003fb20: 616e 6765 286c 656e 2864 662e 636f 6c75  ange(len(df.colu
-0003fb30: 6d6e 7329 293a 0a20 2020 2020 2020 2020  mns)):.         
-0003fb40: 2020 2023 2041 766f 6964 2075 7369 6e67     # Avoid using
-0003fb50: 2075 6675 6e63 2e6f 7574 6572 2028 6e6f   ufunc.outer (no
-0003fb60: 7420 7375 7070 6f72 7465 6420 6279 2063  t supported by c
-0003fb70: 7570 7929 0a20 2020 2020 2020 2020 2020  upy).           
-0003fb80: 206d 755f 6469 7363 7265 7061 6e63 7920   mu_discrepancy 
-0003fb90: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-0003fba0: 2020 2020 6e70 2e73 7562 7472 6163 7428      np.subtract(
-0003fbb0: 6466 2e69 6c6f 635b 3a2c 2069 6478 5d2e  df.iloc[:, idx].
-0003fbc0: 7661 6c75 6573 5b3a 2c20 4e6f 6e65 5d2c  values[:, None],
-0003fbd0: 206d 755b 6964 785d 5b4e 6f6e 652c 203a   mu[idx][None, :
-0003fbe0: 5d29 202a 2a20 320a 2020 2020 2020 2020  ]) ** 2.        
-0003fbf0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0003fc00: 2020 6d75 5f64 6973 6372 6570 616e 6379    mu_discrepancy
-0003fc10: 5b6d 6173 6b5d 203d 206e 702e 6e61 6e0a  [mask] = np.nan.
-0003fc20: 2020 2020 2020 2020 2020 2020 6d5b 6964              m[id
-0003fc30: 785d 203d 206e 702e 6e61 6e73 756d 286d  x] = np.nansum(m
-0003fc40: 755f 6469 7363 7265 7061 6e63 792c 2061  u_discrepancy, a
-0003fc50: 7869 733d 3029 0a20 2020 2020 2020 206d  xis=0).        m
-0003fc60: 203d 206d 2e54 0a20 2020 2020 2020 2064   = m.T.        d
-0003fc70: 7479 7065 2e61 7070 656e 6428 2822 6d22  type.append(("m"
-0003fc80: 2c20 6d2e 6474 7970 6529 290a 0a20 2020  , m.dtype))..   
-0003fc90: 206f 7574 203d 207b 2273 756d 223a 2073   out = {"sum": s
-0003fca0: 756d 732c 2022 636f 756e 7422 3a20 636f  ums, "count": co
-0003fcb0: 756e 7473 2c20 2263 6f76 223a 2063 6f76  unts, "cov": cov
-0003fcc0: 202a 2028 636f 756e 7473 202d 2031 297d   * (counts - 1)}
-0003fcd0: 0a20 2020 2069 6620 636f 7272 3a0a 2020  .    if corr:.  
-0003fce0: 2020 2020 2020 6f75 745b 226d 225d 203d        out["m"] =
-0003fcf0: 206d 0a20 2020 2072 6574 7572 6e20 6f75   m.    return ou
-0003fd00: 740a 0a0a 6465 6620 5f63 6f76 5f63 6f72  t...def _cov_cor
-0003fd10: 725f 636f 6d62 696e 6528 6461 7461 5f69  r_combine(data_i
-0003fd20: 6e2c 2063 6f72 723d 4661 6c73 6529 3a0a  n, corr=False):.
-0003fd30: 2020 2020 6461 7461 203d 207b 2273 756d      data = {"sum
-0003fd40: 223a 204e 6f6e 652c 2022 636f 756e 7422  ": None, "count"
-0003fd50: 3a20 4e6f 6e65 2c20 2263 6f76 223a 204e  : None, "cov": N
-0003fd60: 6f6e 657d 0a20 2020 2069 6620 636f 7272  one}.    if corr
-0003fd70: 3a0a 2020 2020 2020 2020 6461 7461 5b22  :.        data["
-0003fd80: 6d22 5d20 3d20 4e6f 6e65 0a0a 2020 2020  m"] = None..    
-0003fd90: 666f 7220 6b20 696e 2064 6174 612e 6b65  for k in data.ke
-0003fda0: 7973 2829 3a0a 2020 2020 2020 2020 6461  ys():.        da
-0003fdb0: 7461 5b6b 5d20 3d20 5b64 5b6b 5d20 666f  ta[k] = [d[k] fo
-0003fdc0: 7220 6420 696e 2064 6174 615f 696e 5d0a  r d in data_in].
-0003fdd0: 2020 2020 2020 2020 6461 7461 5b6b 5d20          data[k] 
-0003fde0: 3d20 6e70 2e63 6f6e 6361 7465 6e61 7465  = np.concatenate
-0003fdf0: 2864 6174 615b 6b5d 292e 7265 7368 6170  (data[k]).reshap
-0003fe00: 6528 286c 656e 2864 6174 615b 6b5d 292c  e((len(data[k]),
-0003fe10: 2920 2b20 6461 7461 5b6b 5d5b 305d 2e73  ) + data[k][0].s
-0003fe20: 6861 7065 290a 0a20 2020 2073 756d 7320  hape)..    sums 
-0003fe30: 3d20 6e70 2e6e 616e 5f74 6f5f 6e75 6d28  = np.nan_to_num(
-0003fe40: 6461 7461 5b22 7375 6d22 5d29 0a20 2020  data["sum"]).   
-0003fe50: 2063 6f75 6e74 7320 3d20 6461 7461 5b22   counts = data["
-0003fe60: 636f 756e 7422 5d0a 0a20 2020 2063 756d  count"]..    cum
-0003fe70: 5f73 756d 7320 3d20 6e70 2e63 756d 7375  _sums = np.cumsu
-0003fe80: 6d28 7375 6d73 2c20 3029 0a20 2020 2063  m(sums, 0).    c
-0003fe90: 756d 5f63 6f75 6e74 7320 3d20 6e70 2e63  um_counts = np.c
-0003fea0: 756d 7375 6d28 636f 756e 7473 2c20 3029  umsum(counts, 0)
-0003feb0: 0a0a 2020 2020 7331 203d 2063 756d 5f73  ..    s1 = cum_s
-0003fec0: 756d 735b 3a2d 315d 0a20 2020 2073 3220  ums[:-1].    s2 
-0003fed0: 3d20 7375 6d73 5b31 3a5d 0a20 2020 206e  = sums[1:].    n
-0003fee0: 3120 3d20 6375 6d5f 636f 756e 7473 5b3a  1 = cum_counts[:
-0003fef0: 2d31 5d0a 2020 2020 6e32 203d 2063 6f75  -1].    n2 = cou
-0003ff00: 6e74 735b 313a 5d0a 2020 2020 7769 7468  nts[1:].    with
-0003ff10: 206e 702e 6572 7273 7461 7465 2869 6e76   np.errstate(inv
-0003ff20: 616c 6964 3d22 6967 6e6f 7265 2229 3a0a  alid="ignore"):.
-0003ff30: 2020 2020 2020 2020 6420 3d20 2873 3220          d = (s2 
-0003ff40: 2f20 6e32 2920 2d20 2873 3120 2f20 6e31  / n2) - (s1 / n1
-0003ff50: 290a 2020 2020 2020 2020 4320 3d20 6e70  ).        C = np
-0003ff60: 2e6e 616e 7375 6d28 0a20 2020 2020 2020  .nansum(.       
-0003ff70: 2020 2020 2028 6e31 202a 206e 3229 202f       (n1 * n2) /
-0003ff80: 2028 6e31 202b 206e 3229 202a 2028 6420   (n1 + n2) * (d 
-0003ff90: 2a20 642e 7472 616e 7370 6f73 6528 2830  * d.transpose((0
-0003ffa0: 2c20 322c 2031 2929 292c 2030 0a20 2020  , 2, 1))), 0.   
-0003ffb0: 2020 2020 2029 202b 206e 702e 6e61 6e73       ) + np.nans
-0003ffc0: 756d 2864 6174 615b 2263 6f76 225d 2c20  um(data["cov"], 
-0003ffd0: 3029 0a0a 2020 2020 6f75 7420 3d20 7b22  0)..    out = {"
-0003ffe0: 7375 6d22 3a20 6375 6d5f 7375 6d73 5b2d  sum": cum_sums[-
-0003fff0: 315d 2c20 2263 6f75 6e74 223a 2063 756d  1], "count": cum
-00040000: 5f63 6f75 6e74 735b 2d31 5d2c 2022 636f  _counts[-1], "co
-00040010: 7622 3a20 437d 0a0a 2020 2020 6966 2063  v": C}..    if c
-00040020: 6f72 723a 0a20 2020 2020 2020 206e 6f62  orr:.        nob
-00040030: 7320 3d20 6e70 2e77 6865 7265 2863 756d  s = np.where(cum
-00040040: 5f63 6f75 6e74 735b 2d31 5d2c 2063 756d  _counts[-1], cum
-00040050: 5f63 6f75 6e74 735b 2d31 5d2c 206e 702e  _counts[-1], np.
-00040060: 6e61 6e29 0a20 2020 2020 2020 206d 7520  nan).        mu 
-00040070: 3d20 6375 6d5f 7375 6d73 5b2d 315d 202f  = cum_sums[-1] /
-00040080: 206e 6f62 730a 2020 2020 2020 2020 636f   nobs.        co
-00040090: 756e 7473 5f6e 6120 3d20 6e70 2e77 6865  unts_na = np.whe
-000400a0: 7265 2863 6f75 6e74 732c 2063 6f75 6e74  re(counts, count
-000400b0: 732c 206e 702e 6e61 6e29 0a20 2020 2020  s, np.nan).     
-000400c0: 2020 206d 203d 206e 702e 6e61 6e73 756d     m = np.nansum
-000400d0: 2864 6174 615b 226d 225d 202b 2063 6f75  (data["m"] + cou
-000400e0: 6e74 7320 2a20 2873 756d 7320 2f20 636f  nts * (sums / co
-000400f0: 756e 7473 5f6e 6120 2d20 6d75 2920 2a2a  unts_na - mu) **
-00040100: 2032 2c20 6178 6973 3d30 290a 2020 2020   2, axis=0).    
-00040110: 2020 2020 6f75 745b 226d 225d 203d 206d      out["m"] = m
-00040120: 0a20 2020 2072 6574 7572 6e20 6f75 740a  .    return out.
-00040130: 0a0a 6465 6620 5f63 6f76 5f63 6f72 725f  ..def _cov_corr_
-00040140: 6167 6728 6461 7461 2c20 636f 6c73 2c20  agg(data, cols, 
-00040150: 6d69 6e5f 7065 7269 6f64 733d 322c 2063  min_periods=2, c
-00040160: 6f72 723d 4661 6c73 652c 2073 6361 6c61  orr=False, scala
-00040170: 723d 4661 6c73 652c 206c 696b 655f 6466  r=False, like_df
-00040180: 3d4e 6f6e 6529 3a0a 2020 2020 6f75 7420  =None):.    out 
-00040190: 3d20 5f63 6f76 5f63 6f72 725f 636f 6d62  = _cov_corr_comb
-000401a0: 696e 6528 6461 7461 2c20 636f 7272 290a  ine(data, corr).
-000401b0: 2020 2020 636f 756e 7473 203d 206f 7574      counts = out
-000401c0: 5b22 636f 756e 7422 5d0a 2020 2020 4320  ["count"].    C 
-000401d0: 3d20 6f75 745b 2263 6f76 225d 0a20 2020  = out["cov"].   
-000401e0: 2043 5b63 6f75 6e74 7320 3c20 6d69 6e5f   C[counts < min_
-000401f0: 7065 7269 6f64 735d 203d 206e 702e 6e61  periods] = np.na
-00040200: 6e0a 2020 2020 6966 2063 6f72 723a 0a20  n.    if corr:. 
-00040210: 2020 2020 2020 206d 3220 3d20 6f75 745b         m2 = out[
-00040220: 226d 225d 0a20 2020 2020 2020 2064 656e  "m"].        den
-00040230: 203d 206e 702e 7371 7274 286d 3220 2a20   = np.sqrt(m2 * 
-00040240: 6d32 2e54 290a 2020 2020 656c 7365 3a0a  m2.T).    else:.
-00040250: 2020 2020 2020 2020 6465 6e20 3d20 6e70          den = np
-00040260: 2e77 6865 7265 2863 6f75 6e74 732c 2063  .where(counts, c
-00040270: 6f75 6e74 732c 206e 702e 6e61 6e29 202d  ounts, np.nan) -
-00040280: 2031 0a20 2020 2077 6974 6820 6e70 2e65   1.    with np.e
-00040290: 7272 7374 6174 6528 696e 7661 6c69 643d  rrstate(invalid=
-000402a0: 2269 676e 6f72 6522 2c20 6469 7669 6465  "ignore", divide
-000402b0: 3d22 6967 6e6f 7265 2229 3a0a 2020 2020  ="ignore"):.    
-000402c0: 2020 2020 6d61 7420 3d20 4320 2f20 6465      mat = C / de
-000402d0: 6e0a 2020 2020 6966 2073 6361 6c61 723a  n.    if scalar:
-000402e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000402f0: 666c 6f61 7428 6d61 745b 302c 2031 5d29  float(mat[0, 1])
-00040300: 0a20 2020 2072 6574 7572 6e20 2870 642e  .    return (pd.
-00040310: 4461 7461 4672 616d 6520 6966 206c 696b  DataFrame if lik
-00040320: 655f 6466 2069 7320 4e6f 6e65 2065 6c73  e_df is None els
-00040330: 6520 6d65 7461 5f66 7261 6d65 5f63 6f6e  e meta_frame_con
-00040340: 7374 7275 6374 6f72 286c 696b 655f 6466  structor(like_df
-00040350: 2929 280a 2020 2020 2020 2020 6d61 742c  ))(.        mat,
-00040360: 2063 6f6c 756d 6e73 3d63 6f6c 732c 2069   columns=cols, i
-00040370: 6e64 6578 3d63 6f6c 730a 2020 2020 290a  ndex=cols.    ).
-00040380: 0a0a 6465 6620 7064 5f73 706c 6974 2864  ..def pd_split(d
-00040390: 662c 2070 2c20 7261 6e64 6f6d 5f73 7461  f, p, random_sta
-000403a0: 7465 3d4e 6f6e 652c 2073 6875 6666 6c65  te=None, shuffle
-000403b0: 3d46 616c 7365 293a 0a20 2020 2022 2222  =False):.    """
-000403c0: 5370 6c69 7420 4461 7461 4672 616d 6520  Split DataFrame 
-000403d0: 696e 746f 206d 756c 7469 706c 6520 7069  into multiple pi
-000403e0: 6563 6573 2070 7365 7564 6f72 616e 646f  eces pseudorando
-000403f0: 6d6c 790a 0a20 2020 203e 3e3e 2064 6620  mly..    >>> df 
-00040400: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-00040410: 2761 273a 205b 312c 2032 2c20 332c 2034  'a': [1, 2, 3, 4
-00040420: 2c20 352c 2036 5d2c 0a20 2020 202e 2e2e  , 5, 6],.    ...
-00040430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040440: 2020 2020 2762 273a 205b 322c 2033 2c20      'b': [2, 3, 
-00040450: 342c 2035 2c20 362c 2037 5d7d 290a 0a20  4, 5, 6, 7]}).. 
-00040460: 2020 203e 3e3e 2061 2c20 6220 3d20 7064     >>> a, b = pd
-00040470: 5f73 706c 6974 280a 2020 2020 2e2e 2e20  _split(.    ... 
-00040480: 2020 2020 6466 2c20 5b30 2e35 2c20 302e      df, [0.5, 0.
-00040490: 355d 2c20 7261 6e64 6f6d 5f73 7461 7465  5], random_state
-000404a0: 3d31 3233 2c20 7368 7566 666c 653d 5472  =123, shuffle=Tr
-000404b0: 7565 0a20 2020 202e 2e2e 2029 2020 2320  ue.    ... )  # 
-000404c0: 726f 7567 686c 7920 3530 2f35 3020 7370  roughly 50/50 sp
-000404d0: 6c69 740a 2020 2020 3e3e 3e20 610a 2020  lit.    >>> a.  
-000404e0: 2020 2020 2061 2020 620a 2020 2020 3320       a  b.    3 
-000404f0: 2034 2020 350a 2020 2020 3020 2031 2020   4  5.    0  1  
-00040500: 320a 2020 2020 3520 2036 2020 370a 2020  2.    5  6  7.  
-00040510: 2020 3e3e 3e20 620a 2020 2020 2020 2061    >>> b.       a
-00040520: 2020 620a 2020 2020 3120 2032 2020 330a    b.    1  2  3.
-00040530: 2020 2020 3420 2035 2020 360a 2020 2020      4  5  6.    
-00040540: 3220 2033 2020 340a 2020 2020 2222 220a  2  3  4.    """.
-00040550: 2020 2020 7020 3d20 6c69 7374 2870 290a      p = list(p).
-00040560: 2020 2020 6966 2073 6875 6666 6c65 3a0a      if shuffle:.
-00040570: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-00040580: 7369 6e73 7461 6e63 6528 7261 6e64 6f6d  sinstance(random
-00040590: 5f73 7461 7465 2c20 6e70 2e72 616e 646f  _state, np.rando
-000405a0: 6d2e 5261 6e64 6f6d 5374 6174 6529 3a0a  m.RandomState):.
-000405b0: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
-000405c0: 6f6d 5f73 7461 7465 203d 206e 702e 7261  om_state = np.ra
-000405d0: 6e64 6f6d 2e52 616e 646f 6d53 7461 7465  ndom.RandomState
-000405e0: 2872 616e 646f 6d5f 7374 6174 6529 0a20  (random_state). 
-000405f0: 2020 2020 2020 2064 6620 3d20 6466 2e73         df = df.s
-00040600: 616d 706c 6528 6672 6163 3d31 2e30 2c20  ample(frac=1.0, 
-00040610: 7261 6e64 6f6d 5f73 7461 7465 3d72 616e  random_state=ran
-00040620: 646f 6d5f 7374 6174 6529 0a20 2020 2069  dom_state).    i
-00040630: 6e64 6578 203d 2070 7365 7564 6f72 616e  ndex = pseudoran
-00040640: 646f 6d28 6c65 6e28 6466 292c 2070 2c20  dom(len(df), p, 
-00040650: 7261 6e64 6f6d 5f73 7461 7465 290a 2020  random_state).  
-00040660: 2020 7265 7475 726e 205b 6466 2e69 6c6f    return [df.ilo
-00040670: 635b 696e 6465 7820 3d3d 2069 5d20 666f  c[index == i] fo
-00040680: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
-00040690: 2870 2929 5d0a 0a0a 6465 6620 5f74 616b  (p))]...def _tak
-000406a0: 655f 6c61 7374 2861 2c20 736b 6970 6e61  e_last(a, skipna
-000406b0: 3d54 7275 6529 3a0a 2020 2020 2222 220a  =True):.    """.
-000406c0: 2020 2020 7461 6b65 206c 6173 7420 726f      take last ro
-000406d0: 7720 2853 6572 6965 7329 206f 6620 4461  w (Series) of Da
-000406e0: 7461 4672 616d 6520 2f20 6c61 7374 2076  taFrame / last v
-000406f0: 616c 7565 206f 6620 5365 7269 6573 0a20  alue of Series. 
-00040700: 2020 2063 6f6e 7369 6465 7269 6e67 204e     considering N
-00040710: 614e 2e0a 0a20 2020 2050 6172 616d 6574  aN...    Paramet
-00040720: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-00040730: 2d2d 0a20 2020 2061 203a 2070 642e 4461  --.    a : pd.Da
-00040740: 7461 4672 616d 6520 6f72 2070 642e 5365  taFrame or pd.Se
-00040750: 7269 6573 0a20 2020 2073 6b69 706e 6120  ries.    skipna 
-00040760: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
-00040770: 5472 7565 0a20 2020 2020 2020 2057 6865  True.        Whe
-00040780: 7468 6572 2074 6f20 6578 636c 7564 6520  ther to exclude 
-00040790: 4e61 4e0a 0a20 2020 2022 2222 0a0a 2020  NaN..    """..  
-000407a0: 2020 6465 6620 5f6c 6173 745f 7661 6c69    def _last_vali
-000407b0: 6428 7329 3a0a 2020 2020 2020 2020 666f  d(s):.        fo
-000407c0: 7220 6920 696e 2072 616e 6765 2831 2c20  r i in range(1, 
-000407d0: 6d69 6e28 3130 2c20 6c65 6e28 7329 202b  min(10, len(s) +
-000407e0: 2031 2929 3a0a 2020 2020 2020 2020 2020   1)):.          
-000407f0: 2020 7661 6c20 3d20 732e 696c 6f63 5b2d    val = s.iloc[-
-00040800: 695d 0a20 2020 2020 2020 2020 2020 2069  i].            i
-00040810: 6620 6e6f 7420 7064 2e69 736e 756c 6c28  f not pd.isnull(
-00040820: 7661 6c29 3a0a 2020 2020 2020 2020 2020  val):.          
-00040830: 2020 2020 2020 7265 7475 726e 2076 616c        return val
-00040840: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00040850: 2020 2020 2020 2020 2020 206e 6f6e 6e75             nonnu
-00040860: 6c6c 203d 2073 5b73 2e6e 6f74 6e61 2829  ll = s[s.notna()
-00040870: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
-00040880: 206e 6f74 206e 6f6e 6e75 6c6c 2e65 6d70   not nonnull.emp
-00040890: 7479 3a0a 2020 2020 2020 2020 2020 2020  ty:.            
-000408a0: 2020 2020 7265 7475 726e 206e 6f6e 6e75      return nonnu
-000408b0: 6c6c 2e69 6c6f 635b 2d31 5d0a 2020 2020  ll.iloc[-1].    
-000408c0: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
-000408d0: 0a20 2020 2069 6620 736b 6970 6e61 2069  .    if skipna i
-000408e0: 7320 4661 6c73 653a 0a20 2020 2020 2020  s False:.       
-000408f0: 2072 6574 7572 6e20 612e 696c 6f63 5b2d   return a.iloc[-
-00040900: 315d 0a20 2020 2065 6c73 653a 0a20 2020  1].    else:.   
-00040910: 2020 2020 2023 2074 616b 6520 6c61 7374       # take last
-00040920: 2076 616c 6964 2076 616c 7565 2065 7863   valid value exc
-00040930: 6c75 6469 6e67 204e 614e 2c20 4e61 4e20  luding NaN, NaN 
-00040940: 6c6f 6361 7469 6f6e 206d 6179 2062 6520  location may be 
-00040950: 6469 6666 6572 656e 740a 2020 2020 2020  different.      
-00040960: 2020 2320 696e 2065 6163 6820 636f 6c75    # in each colu
-00040970: 6d6e 0a20 2020 2020 2020 2069 6620 6973  mn.        if is
-00040980: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
-00040990: 6129 3a0a 2020 2020 2020 2020 2020 2020  a):.            
-000409a0: 2320 6372 6561 7465 2053 6572 6965 7320  # create Series 
-000409b0: 6672 6f6d 2061 7070 726f 7072 6961 7465  from appropriate
-000409c0: 2062 6163 6b65 6e64 2064 6174 6166 7261   backend datafra
-000409d0: 6d65 206c 6962 7261 7279 0a20 2020 2020  me library.     
-000409e0: 2020 2020 2020 2073 6572 6965 735f 7479         series_ty
-000409f0: 7020 3d20 7479 7065 2861 2e69 6c6f 635b  p = type(a.iloc[
-00040a00: 303a 312c 2030 5d29 0a20 2020 2020 2020  0:1, 0]).       
-00040a10: 2020 2020 2069 6620 612e 656d 7074 793a       if a.empty:
-00040a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040a30: 2072 6574 7572 6e20 7365 7269 6573 5f74   return series_t
-00040a40: 7970 285b 5d2c 2064 7479 7065 3d22 666c  yp([], dtype="fl
-00040a50: 6f61 7422 290a 2020 2020 2020 2020 2020  oat").          
-00040a60: 2020 7265 7475 726e 2073 6572 6965 735f    return series_
-00040a70: 7479 7028 0a20 2020 2020 2020 2020 2020  typ(.           
-00040a80: 2020 2020 205b 5f6c 6173 745f 7661 6c69       [_last_vali
-00040a90: 6428 612e 696c 6f63 5b3a 2c20 695d 2920  d(a.iloc[:, i]) 
-00040aa0: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
-00040ab0: 656e 2861 2e63 6f6c 756d 6e73 2929 5d2c  en(a.columns))],
-00040ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040ad0: 2069 6e64 6578 3d61 2e63 6f6c 756d 6e73   index=a.columns
-00040ae0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00040af0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00040b00: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00040b10: 205f 6c61 7374 5f76 616c 6964 2861 290a   _last_valid(a).
-00040b20: 0a0a 6465 6620 6368 6563 6b5f 6469 7669  ..def check_divi
-00040b30: 7369 6f6e 7328 6469 7669 7369 6f6e 7329  sions(divisions)
-00040b40: 3a0a 2020 2020 6966 206e 6f74 2069 7369  :.    if not isi
-00040b50: 6e73 7461 6e63 6528 6469 7669 7369 6f6e  nstance(division
-00040b60: 732c 2028 6c69 7374 2c20 7475 706c 6529  s, (list, tuple)
-00040b70: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
-00040b80: 2056 616c 7565 4572 726f 7228 224e 6577   ValueError("New
-00040b90: 2064 6976 6973 696f 6e20 6d75 7374 2062   division must b
-00040ba0: 6520 6c69 7374 206f 7220 7475 706c 6522  e list or tuple"
-00040bb0: 290a 2020 2020 6469 7669 7369 6f6e 7320  ).    divisions 
-00040bc0: 3d20 6c69 7374 2864 6976 6973 696f 6e73  = list(divisions
-00040bd0: 290a 2020 2020 6966 206c 656e 2864 6976  ).    if len(div
-00040be0: 6973 696f 6e73 2920 3d3d 2030 3a0a 2020  isions) == 0:.  
-00040bf0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00040c00: 6545 7272 6f72 2822 4e65 7720 6469 7669  eError("New divi
-00040c10: 7369 6f6e 206d 7573 7420 6e6f 7420 6265  sion must not be
-00040c20: 2065 6d70 7479 2229 0a20 2020 2069 6620   empty").    if 
-00040c30: 6469 7669 7369 6f6e 7320 213d 2073 6f72  divisions != sor
-00040c40: 7465 6428 6469 7669 7369 6f6e 7329 3a0a  ted(divisions):.
-00040c50: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00040c60: 6c75 6545 7272 6f72 2822 4e65 7720 6469  lueError("New di
-00040c70: 7669 7369 6f6e 206d 7573 7420 6265 2073  vision must be s
-00040c80: 6f72 7465 6422 290a 2020 2020 6966 206c  orted").    if l
-00040c90: 656e 2864 6976 6973 696f 6e73 5b3a 2d31  en(divisions[:-1
-00040ca0: 5d29 2021 3d20 6c65 6e28 6c69 7374 2875  ]) != len(list(u
-00040cb0: 6e69 7175 6528 6469 7669 7369 6f6e 735b  nique(divisions[
-00040cc0: 3a2d 315d 2929 293a 0a20 2020 2020 2020  :-1]))):.       
-00040cd0: 206d 7367 203d 2022 4e65 7720 6469 7669   msg = "New divi
-00040ce0: 7369 6f6e 206d 7573 7420 6265 2075 6e69  sion must be uni
-00040cf0: 7175 652c 2065 7863 6570 7420 666f 7220  que, except for 
-00040d00: 7468 6520 6c61 7374 2065 6c65 6d65 6e74  the last element
-00040d10: 220a 2020 2020 2020 2020 7261 6973 6520  ".        raise 
-00040d20: 5661 6c75 6545 7272 6f72 286d 7367 290a  ValueError(msg).
-00040d30: 0a0a 6465 6620 7265 7061 7274 6974 696f  ..def repartitio
-00040d40: 6e5f 6469 7669 7369 6f6e 7328 612c 2062  n_divisions(a, b
-00040d50: 2c20 6e61 6d65 2c20 6f75 7431 2c20 6f75  , name, out1, ou
-00040d60: 7432 2c20 666f 7263 653d 4661 6c73 6529  t2, force=False)
-00040d70: 3a0a 2020 2020 2222 2264 6173 6b20 6772  :.    """dask gr
-00040d80: 6170 6820 746f 2072 6570 6172 7469 7469  aph to repartiti
-00040d90: 6f6e 2064 6174 6166 7261 6d65 2062 7920  on dataframe by 
-00040da0: 6e65 7720 6469 7669 7369 6f6e 730a 0a20  new divisions.. 
-00040db0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00040dc0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00040dd0: 2061 203a 2074 7570 6c65 0a20 2020 2020   a : tuple.     
-00040de0: 2020 206f 6c64 2064 6976 6973 696f 6e73     old divisions
-00040df0: 0a20 2020 2062 203a 2074 7570 6c65 2c20  .    b : tuple, 
-00040e00: 6c69 7374 6d79 7079 0a20 2020 206f 7574  listmypy.    out
-00040e10: 3220 3a20 7374 720a 2020 2020 2020 2020  2 : str.        
-00040e20: 6e61 6d65 206f 6620 6e65 7720 6461 7461  name of new data
-00040e30: 6672 616d 650a 2020 2020 666f 7263 6520  frame.    force 
-00040e40: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
-00040e50: 4661 6c73 650a 2020 2020 2020 2020 416c  False.        Al
-00040e60: 6c6f 7773 2074 6865 2065 7870 616e 7369  lows the expansi
-00040e70: 6f6e 206f 6620 7468 6520 6578 6973 7469  on of the existi
-00040e80: 6e67 2064 6976 6973 696f 6e73 2e0a 2020  ng divisions..  
-00040e90: 2020 2020 2020 4966 2046 616c 7365 2074        If False t
-00040ea0: 6865 6e20 7468 6520 6e65 7720 6469 7669  hen the new divi
-00040eb0: 7369 6f6e 7320 6c6f 7765 7220 616e 6420  sions lower and 
-00040ec0: 7570 7065 7220 626f 756e 6473 206d 7573  upper bounds mus
-00040ed0: 7420 6265 0a20 2020 2020 2020 2074 6865  t be.        the
-00040ee0: 2073 616d 6520 6173 2074 6865 206f 6c64   same as the old
-00040ef0: 2064 6976 6973 696f 6e73 2e0a 0a20 2020   divisions...   
-00040f00: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
-00040f10: 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e 2066  ------.    >>> f
-00040f20: 726f 6d20 7070 7269 6e74 2069 6d70 6f72  rom pprint impor
-00040f30: 7420 7070 7269 6e74 0a20 2020 203e 3e3e  t pprint.    >>>
-00040f40: 2070 7072 696e 7428 7265 7061 7274 6974   pprint(repartit
-00040f50: 696f 6e5f 6469 7669 7369 6f6e 7328 5b31  ion_divisions([1
-00040f60: 2c20 332c 2037 5d2c 205b 312c 2034 2c20  , 3, 7], [1, 4, 
-00040f70: 362c 2037 5d2c 2027 6127 2c20 2762 272c  6, 7], 'a', 'b',
-00040f80: 2027 6327 2929 2020 2320 646f 6374 6573   'c'))  # doctes
-00040f90: 743a 202b 454c 4c49 5053 4953 0a20 2020  t: +ELLIPSIS.   
-00040fa0: 207b 2827 6227 2c20 3029 3a20 283c 6675   {('b', 0): (<fu
-00040fb0: 6e63 7469 6f6e 2062 6f75 6e64 6172 795f  nction boundary_
-00040fc0: 736c 6963 6520 6174 202e 2e2e 3e2c 2028  slice at ...>, (
-00040fd0: 2761 272c 2030 292c 2031 2c20 332c 2046  'a', 0), 1, 3, F
-00040fe0: 616c 7365 292c 0a20 2020 2020 2827 6227  alse),.     ('b'
-00040ff0: 2c20 3129 3a20 283c 6675 6e63 7469 6f6e  , 1): (<function
-00041000: 2062 6f75 6e64 6172 795f 736c 6963 6520   boundary_slice 
-00041010: 6174 202e 2e2e 3e2c 2028 2761 272c 2031  at ...>, ('a', 1
-00041020: 292c 2033 2c20 342c 2046 616c 7365 292c  ), 3, 4, False),
-00041030: 0a20 2020 2020 2827 6227 2c20 3229 3a20  .     ('b', 2): 
-00041040: 283c 6675 6e63 7469 6f6e 2062 6f75 6e64  (<function bound
-00041050: 6172 795f 736c 6963 6520 6174 202e 2e2e  ary_slice at ...
-00041060: 3e2c 2028 2761 272c 2031 292c 2034 2c20  >, ('a', 1), 4, 
-00041070: 362c 2046 616c 7365 292c 0a20 2020 2020  6, False),.     
-00041080: 2827 6227 2c20 3329 3a20 283c 6675 6e63  ('b', 3): (<func
-00041090: 7469 6f6e 2062 6f75 6e64 6172 795f 736c  tion boundary_sl
-000410a0: 6963 6520 6174 202e 2e2e 3e2c 2028 2761  ice at ...>, ('a
-000410b0: 272c 2031 292c 2036 2c20 372c 2054 7275  ', 1), 6, 7, Tru
-000410c0: 6529 2c0a 2020 2020 2028 2763 272c 2030  e),.     ('c', 0
-000410d0: 293a 2028 3c66 756e 6374 696f 6e20 636f  ): (<function co
-000410e0: 6e63 6174 2061 7420 2e2e 2e3e 2c20 5b28  ncat at ...>, [(
-000410f0: 2762 272c 2030 292c 2028 2762 272c 2031  'b', 0), ('b', 1
-00041100: 295d 292c 0a20 2020 2020 2827 6327 2c20  )]),.     ('c', 
-00041110: 3129 3a20 2827 6227 2c20 3229 2c0a 2020  1): ('b', 2),.  
-00041120: 2020 2028 2763 272c 2032 293a 2028 2762     ('c', 2): ('b
-00041130: 272c 2033 297d 0a20 2020 2022 2222 0a20  ', 3)}.    """. 
-00041140: 2020 2063 6865 636b 5f64 6976 6973 696f     check_divisio
-00041150: 6e73 2862 290a 0a20 2020 2069 6620 6c65  ns(b)..    if le
-00041160: 6e28 6229 203c 2032 3a0a 2020 2020 2020  n(b) < 2:.      
-00041170: 2020 2320 6d69 6e69 6d75 6d20 6469 7669    # minimum divi
-00041180: 7369 6f6e 2069 7320 3220 656c 656d 656e  sion is 2 elemen
-00041190: 7473 2c20 6c69 6b65 205b 302c 2030 5d0a  ts, like [0, 0].
-000411a0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-000411b0: 6c75 6545 7272 6f72 2822 4e65 7720 6469  lueError("New di
-000411c0: 7669 7369 6f6e 206d 7573 7420 6265 206c  vision must be l
-000411d0: 6f6e 6765 7220 7468 616e 2032 2065 6c65  onger than 2 ele
-000411e0: 6d65 6e74 7322 290a 0a20 2020 2069 6620  ments")..    if 
-000411f0: 666f 7263 653a 0a20 2020 2020 2020 2069  force:.        i
-00041200: 6620 615b 305d 203c 2062 5b30 5d3a 0a20  f a[0] < b[0]:. 
-00041210: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
-00041220: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00041230: 2020 2022 6c65 6674 2073 6964 6520 6f66     "left side of
-00041240: 2074 6865 206e 6577 2064 6976 6973 696f   the new divisio
-00041250: 6e20 6d75 7374 2062 6520 6571 7561 6c20  n must be equal 
-00041260: 6f72 2073 6d61 6c6c 6572 2022 0a20 2020  or smaller ".   
-00041270: 2020 2020 2020 2020 2020 2020 2022 7468               "th
-00041280: 616e 206f 6c64 2064 6976 6973 696f 6e22  an old division"
-00041290: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000412a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000412b0: 2056 616c 7565 4572 726f 7228 6d73 6729   ValueError(msg)
-000412c0: 0a20 2020 2020 2020 2069 6620 615b 2d31  .        if a[-1
-000412d0: 5d20 3e20 625b 2d31 5d3a 0a20 2020 2020  ] > b[-1]:.     
-000412e0: 2020 2020 2020 206d 7367 203d 2028 0a20         msg = (. 
-000412f0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00041300: 7269 6768 7420 7369 6465 206f 6620 7468  right side of th
-00041310: 6520 6e65 7720 6469 7669 7369 6f6e 206d  e new division m
-00041320: 7573 7420 6265 2065 7175 616c 206f 7220  ust be equal or 
-00041330: 6c61 7267 6572 2022 0a20 2020 2020 2020  larger ".       
-00041340: 2020 2020 2020 2020 2022 7468 616e 206f           "than o
-00041350: 6c64 2064 6976 6973 696f 6e22 0a20 2020  ld division".   
-00041360: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00041370: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00041380: 7565 4572 726f 7228 6d73 6729 0a20 2020  ueError(msg).   
-00041390: 2065 6c73 653a 0a20 2020 2020 2020 2069   else:.        i
-000413a0: 6620 615b 305d 2021 3d20 625b 305d 3a0a  f a[0] != b[0]:.
-000413b0: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
-000413c0: 3d20 226c 6566 7420 7369 6465 206f 6620  = "left side of 
-000413d0: 6f6c 6420 616e 6420 6e65 7720 6469 7669  old and new divi
-000413e0: 7369 6f6e 7320 6172 6520 6469 6666 6572  sions are differ
-000413f0: 656e 7422 0a20 2020 2020 2020 2020 2020  ent".           
-00041400: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00041410: 7228 6d73 6729 0a20 2020 2020 2020 2069  r(msg).        i
-00041420: 6620 615b 2d31 5d20 213d 2062 5b2d 315d  f a[-1] != b[-1]
-00041430: 3a0a 2020 2020 2020 2020 2020 2020 6d73  :.            ms
-00041440: 6720 3d20 2272 6967 6874 2073 6964 6520  g = "right side 
-00041450: 6f66 206f 6c64 2061 6e64 206e 6577 2064  of old and new d
-00041460: 6976 6973 696f 6e73 2061 7265 2064 6966  ivisions are dif
-00041470: 6665 7265 6e74 220a 2020 2020 2020 2020  ferent".        
-00041480: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00041490: 7272 6f72 286d 7367 290a 0a20 2020 2064  rror(msg)..    d
-000414a0: 6566 205f 6973 5f73 696e 676c 655f 6c61  ef _is_single_la
-000414b0: 7374 5f64 6976 2878 293a 0a20 2020 2020  st_div(x):.     
-000414c0: 2020 2022 2222 5768 6574 6865 7220 6c61     """Whether la
-000414d0: 7374 2064 6976 6973 696f 6e20 6f6e 6c79  st division only
-000414e0: 2063 6f6e 7461 696e 7320 7369 6e67 6c65   contains single
-000414f0: 206c 6162 656c 2222 220a 2020 2020 2020   label""".      
-00041500: 2020 7265 7475 726e 206c 656e 2878 2920    return len(x) 
-00041510: 3e3d 2032 2061 6e64 2078 5b2d 315d 203d  >= 2 and x[-1] =
-00041520: 3d20 785b 2d32 5d0a 0a20 2020 2063 203d  = x[-2]..    c =
-00041530: 205b 615b 305d 5d0a 2020 2020 6420 3d20   [a[0]].    d = 
-00041540: 6469 6374 2829 0a20 2020 206c 6f77 203d  dict().    low =
-00041550: 2061 5b30 5d0a 0a20 2020 2069 2c20 6a20   a[0]..    i, j 
-00041560: 3d20 312c 2031 2020 2320 696e 6469 6365  = 1, 1  # indice
-00041570: 7320 666f 7220 6f6c 642f 6e65 7720 6469  s for old/new di
-00041580: 7669 7369 6f6e 730a 2020 2020 6b20 3d20  visions.    k = 
-00041590: 3020 2023 2069 6e64 6578 2066 6f72 2074  0  # index for t
-000415a0: 656d 7020 6469 7669 7369 6f6e 730a 0a20  emp divisions.. 
-000415b0: 2020 206c 6173 745f 656c 656d 203d 205f     last_elem = _
-000415c0: 6973 5f73 696e 676c 655f 6c61 7374 5f64  is_single_last_d
-000415d0: 6976 2861 290a 0a20 2020 2023 2070 726f  iv(a)..    # pro
-000415e0: 6365 7373 2074 6872 6f75 6768 206f 6c64  cess through old
-000415f0: 2064 6976 6973 696f 6e0a 2020 2020 2320   division.    # 
-00041600: 6c65 6674 2070 6172 7420 6f66 206e 6577  left part of new
-00041610: 2064 6976 6973 696f 6e20 6361 6e20 6265   division can be
-00041620: 2070 726f 6365 7373 6564 2069 6e20 7468   processed in th
-00041630: 6973 206c 6f6f 700a 2020 2020 7768 696c  is loop.    whil
-00041640: 6520 6920 3c20 6c65 6e28 6129 2061 6e64  e i < len(a) and
-00041650: 206a 203c 206c 656e 2862 293a 0a20 2020   j < len(b):.   
-00041660: 2020 2020 2069 6620 615b 695d 203c 2062       if a[i] < b
-00041670: 5b6a 5d3a 0a20 2020 2020 2020 2020 2020  [j]:.           
-00041680: 2023 2074 7570 6c65 2069 7320 736f 6d65   # tuple is some
-00041690: 7468 696e 6720 6c69 6b65 3a0a 2020 2020  thing like:.    
-000416a0: 2020 2020 2020 2020 2320 286d 6574 686f          # (metho
-000416b0: 6473 2e62 6f75 6e64 6172 795f 736c 6963  ds.boundary_slic
-000416c0: 652c 2028 2766 726f 6d5f 7061 6e64 6173  e, ('from_pandas
-000416d0: 2d23 272c 2030 292c 2033 2c20 342c 2046  -#', 0), 3, 4, F
-000416e0: 616c 7365 2929 0a20 2020 2020 2020 2020  alse)).         
-000416f0: 2020 2064 5b28 6f75 7431 2c20 6b29 5d20     d[(out1, k)] 
-00041700: 3d20 286d 6574 686f 6473 2e62 6f75 6e64  = (methods.bound
-00041710: 6172 795f 736c 6963 652c 2028 6e61 6d65  ary_slice, (name
-00041720: 2c20 6920 2d20 3129 2c20 6c6f 772c 2061  , i - 1), low, a
-00041730: 5b69 5d2c 2046 616c 7365 290a 2020 2020  [i], False).    
-00041740: 2020 2020 2020 2020 6c6f 7720 3d20 615b          low = a[
-00041750: 695d 0a20 2020 2020 2020 2020 2020 2069  i].            i
-00041760: 202b 3d20 310a 2020 2020 2020 2020 656c   += 1.        el
-00041770: 6966 2061 5b69 5d20 3e20 625b 6a5d 3a0a  if a[i] > b[j]:.
-00041780: 2020 2020 2020 2020 2020 2020 645b 286f              d[(o
-00041790: 7574 312c 206b 295d 203d 2028 6d65 7468  ut1, k)] = (meth
-000417a0: 6f64 732e 626f 756e 6461 7279 5f73 6c69  ods.boundary_sli
-000417b0: 6365 2c20 286e 616d 652c 2069 202d 2031  ce, (name, i - 1
-000417c0: 292c 206c 6f77 2c20 625b 6a5d 2c20 4661  ), low, b[j], Fa
-000417d0: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
-000417e0: 206c 6f77 203d 2062 5b6a 5d0a 2020 2020   low = b[j].    
-000417f0: 2020 2020 2020 2020 6a20 2b3d 2031 0a20          j += 1. 
-00041800: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00041810: 2020 2020 2020 2020 2064 5b28 6f75 7431           d[(out1
-00041820: 2c20 6b29 5d20 3d20 286d 6574 686f 6473  , k)] = (methods
-00041830: 2e62 6f75 6e64 6172 795f 736c 6963 652c  .boundary_slice,
-00041840: 2028 6e61 6d65 2c20 6920 2d20 3129 2c20   (name, i - 1), 
-00041850: 6c6f 772c 2062 5b6a 5d2c 2046 616c 7365  low, b[j], False
-00041860: 290a 2020 2020 2020 2020 2020 2020 6c6f  ).            lo
-00041870: 7720 3d20 625b 6a5d 0a20 2020 2020 2020  w = b[j].       
-00041880: 2020 2020 2069 6620 6c65 6e28 6129 203d       if len(a) =
-00041890: 3d20 6920 2b20 3120 6f72 2061 5b69 5d20  = i + 1 or a[i] 
-000418a0: 3c20 615b 6920 2b20 315d 3a0a 2020 2020  < a[i + 1]:.    
-000418b0: 2020 2020 2020 2020 2020 2020 6a20 2b3d              j +=
-000418c0: 2031 0a20 2020 2020 2020 2020 2020 2069   1.            i
-000418d0: 202b 3d20 310a 2020 2020 2020 2020 632e   += 1.        c.
-000418e0: 6170 7065 6e64 286c 6f77 290a 2020 2020  append(low).    
-000418f0: 2020 2020 6b20 2b3d 2031 0a0a 2020 2020      k += 1..    
-00041900: 2320 7269 6768 7420 7061 7274 206f 6620  # right part of 
-00041910: 6e65 7720 6469 7669 7369 6f6e 2063 616e  new division can
-00041920: 2072 656d 6169 6e0a 2020 2020 6966 2061   remain.    if a
-00041930: 5b2d 315d 203c 2062 5b2d 315d 206f 7220  [-1] < b[-1] or 
-00041940: 625b 2d31 5d20 3d3d 2062 5b2d 325d 3a0a  b[-1] == b[-2]:.
-00041950: 2020 2020 2020 2020 666f 7220 5f6a 2069          for _j i
-00041960: 6e20 7261 6e67 6528 6a2c 206c 656e 2862  n range(j, len(b
-00041970: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00041980: 2320 616c 7761 7973 2075 7365 2072 6967  # always use rig
-00041990: 6874 2d6d 6f73 7420 6f66 206f 6c64 2064  ht-most of old d
-000419a0: 6976 6973 696f 6e0a 2020 2020 2020 2020  ivision.        
-000419b0: 2020 2020 2320 6265 6361 7573 6520 6974      # because it
-000419c0: 206d 6179 2063 6f6e 7461 696e 206c 6173   may contain las
-000419d0: 7420 656c 656d 656e 740a 2020 2020 2020  t element.      
-000419e0: 2020 2020 2020 6d20 3d20 6c65 6e28 6129        m = len(a)
-000419f0: 202d 2032 0a20 2020 2020 2020 2020 2020   - 2.           
-00041a00: 2064 5b28 6f75 7431 2c20 6b29 5d20 3d20   d[(out1, k)] = 
-00041a10: 286d 6574 686f 6473 2e62 6f75 6e64 6172  (methods.boundar
-00041a20: 795f 736c 6963 652c 2028 6e61 6d65 2c20  y_slice, (name, 
-00041a30: 6d29 2c20 6c6f 772c 2062 5b5f 6a5d 2c20  m), low, b[_j], 
-00041a40: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
-00041a50: 2020 206c 6f77 203d 2062 5b5f 6a5d 0a20     low = b[_j]. 
-00041a60: 2020 2020 2020 2020 2020 2063 2e61 7070             c.app
-00041a70: 656e 6428 6c6f 7729 0a20 2020 2020 2020  end(low).       
-00041a80: 2020 2020 206b 202b 3d20 310a 2020 2020       k += 1.    
-00041a90: 656c 7365 3a0a 2020 2020 2020 2020 2320  else:.        # 
-00041aa0: 6576 656e 2069 6620 6e65 7720 6469 7669  even if new divi
-00041ab0: 7369 6f6e 2069 7320 7072 6f63 6573 7365  sion is processe
-00041ac0: 6420 7468 726f 7567 682c 0a20 2020 2020  d through,.     
-00041ad0: 2020 2023 2072 6967 6874 2d6d 6f73 7420     # right-most 
-00041ae0: 656c 656d 656e 7420 6f66 206f 6c64 2064  element of old d
-00041af0: 6976 6973 696f 6e20 6361 6e20 7265 6d61  ivision can rema
-00041b00: 696e 0a20 2020 2020 2020 2069 6620 6c61  in.        if la
-00041b10: 7374 5f65 6c65 6d20 616e 6420 6920 3c20  st_elem and i < 
-00041b20: 6c65 6e28 6129 3a0a 2020 2020 2020 2020  len(a):.        
-00041b30: 2020 2020 645b 286f 7574 312c 206b 295d      d[(out1, k)]
-00041b40: 203d 2028 6d65 7468 6f64 732e 626f 756e   = (methods.boun
-00041b50: 6461 7279 5f73 6c69 6365 2c20 286e 616d  dary_slice, (nam
-00041b60: 652c 2069 202d 2031 292c 2061 5b69 5d2c  e, i - 1), a[i],
-00041b70: 2061 5b69 5d2c 2046 616c 7365 290a 2020   a[i], False).  
-00041b80: 2020 2020 2020 2020 2020 6b20 2b3d 2031            k += 1
-00041b90: 0a20 2020 2020 2020 2063 2e61 7070 656e  .        c.appen
-00041ba0: 6428 615b 2d31 5d29 0a0a 2020 2020 2320  d(a[-1])..    # 
-00041bb0: 7265 706c 6163 6520 6c61 7374 2065 6c65  replace last ele
-00041bc0: 6d65 6e74 206f 6620 7475 706c 6520 7769  ment of tuple wi
-00041bd0: 7468 2054 7275 650a 2020 2020 645b 286f  th True.    d[(o
-00041be0: 7574 312c 206b 202d 2031 295d 203d 2064  ut1, k - 1)] = d
-00041bf0: 5b28 6f75 7431 2c20 6b20 2d20 3129 5d5b  [(out1, k - 1)][
-00041c00: 3a2d 315d 202b 2028 5472 7565 2c29 0a0a  :-1] + (True,)..
-00041c10: 2020 2020 692c 206a 203d 2030 2c20 310a      i, j = 0, 1.
-00041c20: 0a20 2020 206c 6173 745f 656c 656d 203d  .    last_elem =
-00041c30: 205f 6973 5f73 696e 676c 655f 6c61 7374   _is_single_last
-00041c40: 5f64 6976 2863 290a 0a20 2020 2077 6869  _div(c)..    whi
-00041c50: 6c65 206a 203c 206c 656e 2862 293a 0a20  le j < len(b):. 
-00041c60: 2020 2020 2020 2074 6d70 203d 205b 5d0a         tmp = [].
-00041c70: 2020 2020 2020 2020 7768 696c 6520 635b          while c[
-00041c80: 695d 203c 2062 5b6a 5d3a 0a20 2020 2020  i] < b[j]:.     
-00041c90: 2020 2020 2020 2074 6d70 2e61 7070 656e         tmp.appen
-00041ca0: 6428 286f 7574 312c 2069 2929 0a20 2020  d((out1, i)).   
-00041cb0: 2020 2020 2020 2020 2069 202b 3d20 310a           i += 1.
-00041cc0: 2020 2020 2020 2020 7768 696c 6520 280a          while (.
-00041cd0: 2020 2020 2020 2020 2020 2020 6c61 7374              last
-00041ce0: 5f65 6c65 6d0a 2020 2020 2020 2020 2020  _elem.          
-00041cf0: 2020 616e 6420 635b 695d 203d 3d20 625b    and c[i] == b[
-00041d00: 2d31 5d0a 2020 2020 2020 2020 2020 2020  -1].            
-00041d10: 616e 6420 2862 5b2d 315d 2021 3d20 625b  and (b[-1] != b[
-00041d20: 2d32 5d20 6f72 206a 203d 3d20 6c65 6e28  -2] or j == len(
-00041d30: 6229 202d 2031 290a 2020 2020 2020 2020  b) - 1).        
-00041d40: 2020 2020 616e 6420 6920 3c20 6b0a 2020      and i < k.  
-00041d50: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00041d60: 2020 2020 2023 2061 7070 656e 6420 6966       # append if
-00041d70: 206c 6173 7420 7370 6c69 7420 6973 206e   last split is n
-00041d80: 6f74 2069 6e63 6c75 6465 640a 2020 2020  ot included.    
-00041d90: 2020 2020 2020 2020 746d 702e 6170 7065          tmp.appe
-00041da0: 6e64 2828 6f75 7431 2c20 6929 290a 2020  nd((out1, i)).  
-00041db0: 2020 2020 2020 2020 2020 6920 2b3d 2031            i += 1
-00041dc0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00041dd0: 746d 7029 203d 3d20 303a 0a20 2020 2020  tmp) == 0:.     
-00041de0: 2020 2020 2020 2023 2064 756d 6d79 2073         # dummy s
-00041df0: 6c69 6365 2074 6f20 7265 7475 726e 2065  lice to return e
-00041e00: 6d70 7479 2044 6174 6146 7261 6d65 206f  mpty DataFrame o
-00041e10: 7220 5365 7269 6573 2c0a 2020 2020 2020  r Series,.      
-00041e20: 2020 2020 2020 2320 7768 6963 6820 7265        # which re
-00041e30: 7461 696e 206f 7269 6769 6e61 6c20 6461  tain original da
-00041e40: 7461 2061 7474 7269 6275 7465 7320 2863  ta attributes (c
-00041e50: 6f6c 756d 6e73 202f 206e 616d 6529 0a20  olumns / name). 
-00041e60: 2020 2020 2020 2020 2020 2064 5b28 6f75             d[(ou
-00041e70: 7432 2c20 6a20 2d20 3129 5d20 3d20 286d  t2, j - 1)] = (m
-00041e80: 6574 686f 6473 2e62 6f75 6e64 6172 795f  ethods.boundary_
-00041e90: 736c 6963 652c 2028 6e61 6d65 2c20 3029  slice, (name, 0)
-00041ea0: 2c20 615b 305d 2c20 615b 305d 2c20 4661  , a[0], a[0], Fa
-00041eb0: 6c73 6529 0a20 2020 2020 2020 2065 6c69  lse).        eli
-00041ec0: 6620 6c65 6e28 746d 7029 203d 3d20 313a  f len(tmp) == 1:
-00041ed0: 0a20 2020 2020 2020 2020 2020 2064 5b28  .            d[(
-00041ee0: 6f75 7432 2c20 6a20 2d20 3129 5d20 3d20  out2, j - 1)] = 
-00041ef0: 746d 705b 305d 0a20 2020 2020 2020 2065  tmp[0].        e
-00041f00: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00041f10: 2069 6620 6e6f 7420 746d 703a 0a20 2020   if not tmp:.   
-00041f20: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00041f30: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-00041f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041f50: 2020 2022 6368 6563 6b20 666f 7220 6475     "check for du
-00041f60: 706c 6963 6174 6520 7061 7274 6974 696f  plicate partitio
-00041f70: 6e73 5c6e 6f6c 643a 5c6e 2573 5c6e 5c6e  ns\nold:\n%s\n\n
-00041f80: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00041f90: 2020 2020 2020 226e 6577 3a5c 6e25 735c        "new:\n%s\
-00041fa0: 6e5c 6e63 6f6d 6269 6e65 643a 5c6e 2573  n\ncombined:\n%s
-00041fb0: 2220 2520 2870 666f 726d 6174 2861 292c  " % (pformat(a),
-00041fc0: 2070 666f 726d 6174 2862 292c 2070 666f   pformat(b), pfo
-00041fd0: 726d 6174 2863 2929 0a20 2020 2020 2020  rmat(c)).       
-00041fe0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00041ff0: 2020 2020 2020 2064 5b28 6f75 7432 2c20         d[(out2, 
-00042000: 6a20 2d20 3129 5d20 3d20 286d 6574 686f  j - 1)] = (metho
-00042010: 6473 2e63 6f6e 6361 742c 2074 6d70 290a  ds.concat, tmp).
-00042020: 2020 2020 2020 2020 6a20 2b3d 2031 0a20          j += 1. 
-00042030: 2020 2072 6574 7572 6e20 640a 0a0a 6465     return d...de
-00042040: 6620 7265 7061 7274 6974 696f 6e5f 6672  f repartition_fr
-00042050: 6571 2864 662c 2066 7265 713d 4e6f 6e65  eq(df, freq=None
-00042060: 293a 0a20 2020 2022 2222 5265 7061 7274  ):.    """Repart
-00042070: 6974 696f 6e20 6120 7469 6d65 7365 7269  ition a timeseri
-00042080: 6573 2064 6174 6166 7261 6d65 2062 7920  es dataframe by 
-00042090: 6120 6e65 7720 6672 6571 7565 6e63 7922  a new frequency"
-000420a0: 2222 0a20 2020 2069 6620 6e6f 7420 6973  "".    if not is
-000420b0: 696e 7374 616e 6365 2864 662e 6469 7669  instance(df.divi
-000420c0: 7369 6f6e 735b 305d 2c20 7064 2e54 696d  sions[0], pd.Tim
-000420d0: 6573 7461 6d70 293a 0a20 2020 2020 2020  estamp):.       
-000420e0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-000420f0: 2822 4361 6e20 6f6e 6c79 2072 6570 6172  ("Can only repar
-00042100: 7469 7469 6f6e 206f 6e20 6672 6571 7565  tition on freque
-00042110: 6e63 7920 666f 7220 7469 6d65 7365 7269  ncy for timeseri
-00042120: 6573 2229 0a0a 2020 2020 6672 6571 203d  es")..    freq =
-00042130: 205f 6d61 705f 6672 6571 5f74 6f5f 7065   _map_freq_to_pe
-00042140: 7269 6f64 5f73 7461 7274 2866 7265 7129  riod_start(freq)
-00042150: 0a0a 2020 2020 7472 793a 0a20 2020 2020  ..    try:.     
-00042160: 2020 2073 7461 7274 203d 2064 662e 6469     start = df.di
-00042170: 7669 7369 6f6e 735b 305d 2e63 6569 6c28  visions[0].ceil(
-00042180: 6672 6571 290a 2020 2020 6578 6365 7074  freq).    except
-00042190: 2056 616c 7565 4572 726f 723a 0a20 2020   ValueError:.   
-000421a0: 2020 2020 2073 7461 7274 203d 2064 662e       start = df.
-000421b0: 6469 7669 7369 6f6e 735b 305d 0a20 2020  divisions[0].   
-000421c0: 2064 6976 6973 696f 6e73 203d 206d 6574   divisions = met
-000421d0: 686f 6473 2e74 6f6c 6973 7428 0a20 2020  hods.tolist(.   
-000421e0: 2020 2020 2070 642e 6461 7465 5f72 616e       pd.date_ran
-000421f0: 6765 2873 7461 7274 3d73 7461 7274 2c20  ge(start=start, 
-00042200: 656e 643d 6466 2e64 6976 6973 696f 6e73  end=df.divisions
-00042210: 5b2d 315d 2c20 6672 6571 3d66 7265 7129  [-1], freq=freq)
-00042220: 0a20 2020 2029 0a20 2020 2069 6620 6e6f  .    ).    if no
-00042230: 7420 6c65 6e28 6469 7669 7369 6f6e 7329  t len(divisions)
-00042240: 3a0a 2020 2020 2020 2020 6469 7669 7369  :.        divisi
-00042250: 6f6e 7320 3d20 5b64 662e 6469 7669 7369  ons = [df.divisi
-00042260: 6f6e 735b 305d 2c20 6466 2e64 6976 6973  ons[0], df.divis
-00042270: 696f 6e73 5b2d 315d 5d0a 2020 2020 656c  ions[-1]].    el
-00042280: 7365 3a0a 2020 2020 2020 2020 6469 7669  se:.        divi
-00042290: 7369 6f6e 732e 6170 7065 6e64 2864 662e  sions.append(df.
-000422a0: 6469 7669 7369 6f6e 735b 2d31 5d29 0a20  divisions[-1]). 
-000422b0: 2020 2020 2020 2069 6620 6469 7669 7369         if divisi
-000422c0: 6f6e 735b 305d 2021 3d20 6466 2e64 6976  ons[0] != df.div
-000422d0: 6973 696f 6e73 5b30 5d3a 0a20 2020 2020  isions[0]:.     
-000422e0: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
-000422f0: 203d 205b 6466 2e64 6976 6973 696f 6e73   = [df.divisions
-00042300: 5b30 5d5d 202b 2064 6976 6973 696f 6e73  [0]] + divisions
-00042310: 0a0a 2020 2020 7265 7475 726e 2064 662e  ..    return df.
-00042320: 7265 7061 7274 6974 696f 6e28 6469 7669  repartition(divi
-00042330: 7369 6f6e 733d 6469 7669 7369 6f6e 7329  sions=divisions)
-00042340: 0a0a 0a64 6566 205f 6d61 705f 6672 6571  ...def _map_freq
-00042350: 5f74 6f5f 7065 7269 6f64 5f73 7461 7274  _to_period_start
-00042360: 2866 7265 7129 3a0a 2020 2020 2222 2245  (freq):.    """E
-00042370: 6e73 7572 6520 7468 6174 2074 6865 2066  nsure that the f
-00042380: 7265 7175 656e 6379 2070 6572 7461 696e  requency pertain
-00042390: 7320 746f 2074 6865 202a 2a73 7461 7274  s to the **start
-000423a0: 2a2a 206f 6620 6120 7065 7269 6f64 2e0a  ** of a period..
-000423b0: 0a20 2020 2049 6620 652e 672e 2060 6672  .    If e.g. `fr
-000423c0: 6571 3d27 4d27 602c 2074 6865 6e20 7468  eq='M'`, then th
-000423d0: 6520 6469 7669 7369 6f6e 7320 6172 653a  e divisions are:
-000423e0: 0a20 2020 2020 2020 202d 2032 3032 312d  .        - 2021-
-000423f0: 3331 2d31 2030 303a 3030 3a30 3020 2873  31-1 00:00:00 (s
-00042400: 7461 7274 206f 6620 4665 6272 7561 7279  tart of February
-00042410: 2070 6172 7469 7469 6f6e 290a 2020 2020   partition).    
-00042420: 2020 2020 2d20 3230 3231 2d32 2d32 3820      - 2021-2-28 
-00042430: 3030 3a30 303a 3030 2028 7374 6172 7420  00:00:00 (start 
-00042440: 6f66 204d 6172 6368 2070 6172 7469 7469  of March partiti
-00042450: 6f6e 290a 2020 2020 2020 2020 2d20 2e2e  on).        - ..
-00042460: 2e0a 0a20 2020 2062 7574 2074 6869 7320  ...    but this 
-00042470: 2a2a 7368 6f75 6c64 2a2a 2062 653a 0a20  **should** be:. 
-00042480: 2020 2020 2020 202d 2032 3032 312d 322d         - 2021-2-
-00042490: 3120 3030 3a30 303a 3030 2028 7374 6172  1 00:00:00 (star
-000424a0: 7420 6f66 2046 6562 7275 6172 7920 7061  t of February pa
-000424b0: 7274 6974 696f 6e29 0a20 2020 2020 2020  rtition).       
-000424c0: 202d 2032 3032 312d 332d 3120 3030 3a30   - 2021-3-1 00:0
-000424d0: 303a 3030 2028 7374 6172 7420 6f66 204d  0:00 (start of M
-000424e0: 6172 6368 2070 6172 7469 7469 6f6e 290a  arch partition).
-000424f0: 2020 2020 2020 2020 2d20 2e2e 2e0a 0a20          - ..... 
-00042500: 2020 2054 6865 7265 666f 7265 2c20 7765     Therefore, we
-00042510: 206d 6170 2060 6672 6571 3d27 4d27 6020   map `freq='M'` 
-00042520: 746f 2060 6672 6571 3d27 4d53 2760 2028  to `freq='MS'` (
-00042530: 7361 6d65 2066 6f72 2071 7561 7274 6572  same for quarter
-00042540: 2061 6e64 2079 6561 7229 2e0a 2020 2020   and year)..    
-00042550: 2222 220a 0a20 2020 2069 6620 6e6f 7420  """..    if not 
-00042560: 6973 696e 7374 616e 6365 2866 7265 712c  isinstance(freq,
-00042570: 2073 7472 293a 0a20 2020 2020 2020 2072   str):.        r
-00042580: 6574 7572 6e20 6672 6571 0a0a 2020 2020  eturn freq..    
-00042590: 6f66 6673 6574 203d 2070 642e 7473 6572  offset = pd.tser
-000425a0: 6965 732e 6672 6571 7565 6e63 6965 732e  ies.frequencies.
-000425b0: 746f 5f6f 6666 7365 7428 6672 6571 290a  to_offset(freq).
-000425c0: 2020 2020 6f66 6673 6574 5f74 7970 655f      offset_type_
-000425d0: 6e61 6d65 203d 2074 7970 6528 6f66 6673  name = type(offs
-000425e0: 6574 292e 5f5f 6e61 6d65 5f5f 0a0a 2020  et).__name__..  
-000425f0: 2020 6966 206e 6f74 206f 6666 7365 745f    if not offset_
-00042600: 7479 7065 5f6e 616d 652e 656e 6473 7769  type_name.endswi
-00042610: 7468 2822 456e 6422 293a 0a20 2020 2020  th("End"):.     
-00042620: 2020 2072 6574 7572 6e20 6672 6571 0a0a     return freq..
-00042630: 2020 2020 6e65 775f 6f66 6673 6574 203d      new_offset =
-00042640: 206f 6666 7365 745f 7479 7065 5f6e 616d   offset_type_nam
-00042650: 655b 3a20 2d6c 656e 2822 456e 6422 295d  e[: -len("End")]
-00042660: 202b 2022 4265 6769 6e22 0a20 2020 2074   + "Begin".    t
-00042670: 7279 3a0a 2020 2020 2020 2020 6e65 775f  ry:.        new_
-00042680: 6f66 6673 6574 5f74 7970 6520 3d20 6765  offset_type = ge
-00042690: 7461 7474 7228 7064 2e74 7365 7269 6573  tattr(pd.tseries
-000426a0: 2e6f 6666 7365 7473 2c20 6e65 775f 6f66  .offsets, new_of
-000426b0: 6673 6574 290a 2020 2020 2020 2020 6966  fset).        if
-000426c0: 2022 2d22 2069 6e20 6672 6571 3a0a 2020   "-" in freq:.  
-000426d0: 2020 2020 2020 2020 2020 5f2c 2061 6e63            _, anc
-000426e0: 686f 7220 3d20 6672 6571 2e73 706c 6974  hor = freq.split
-000426f0: 2822 2d22 290a 2020 2020 2020 2020 2020  ("-").          
-00042700: 2020 616e 6368 6f72 203d 2022 2d22 202b    anchor = "-" +
-00042710: 2061 6e63 686f 720a 2020 2020 2020 2020   anchor.        
-00042720: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00042730: 2020 616e 6368 6f72 203d 2022 220a 2020    anchor = "".  
-00042740: 2020 2020 2020 6e20 3d20 7374 7228 6f66        n = str(of
-00042750: 6673 6574 2e6e 2920 6966 206f 6666 7365  fset.n) if offse
-00042760: 742e 6e20 213d 2031 2065 6c73 6520 2222  t.n != 1 else ""
-00042770: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00042780: 6622 7b6e 7d7b 6e65 775f 6f66 6673 6574  f"{n}{new_offset
-00042790: 5f74 7970 652e 5f70 7265 6669 787d 7b61  _type._prefix}{a
-000427a0: 6e63 686f 727d 220a 2020 2020 6578 6365  nchor}".    exce
-000427b0: 7074 2041 7474 7269 6275 7465 4572 726f  pt AttributeErro
-000427c0: 723a 0a20 2020 2020 2020 2072 6574 7572  r:.        retur
-000427d0: 6e20 6672 6571 0a0a 0a64 6566 2072 6570  n freq...def rep
-000427e0: 6172 7469 7469 6f6e 5f73 697a 6528 6466  artition_size(df
-000427f0: 2c20 7369 7a65 293a 0a20 2020 2022 2222  , size):.    """
-00042800: 0a20 2020 2052 6570 6172 7469 7469 6f6e  .    Repartition
-00042810: 2064 6174 6166 7261 6d65 2073 6f20 7468   dataframe so th
-00042820: 6174 206e 6577 2070 6172 7469 7469 6f6e  at new partition
-00042830: 7320 6861 7665 2061 7070 726f 7869 6d61  s have approxima
-00042840: 7465 6c79 2060 7369 7a65 6020 6d65 6d6f  tely `size` memo
-00042850: 7279 2075 7361 6765 2065 6163 680a 2020  ry usage each.  
-00042860: 2020 2222 220a 2020 2020 6966 2069 7369    """.    if isi
-00042870: 6e73 7461 6e63 6528 7369 7a65 2c20 7374  nstance(size, st
-00042880: 7229 3a0a 2020 2020 2020 2020 7369 7a65  r):.        size
-00042890: 203d 2070 6172 7365 5f62 7974 6573 2873   = parse_bytes(s
-000428a0: 697a 6529 0a20 2020 2073 697a 6520 3d20  ize).    size = 
-000428b0: 696e 7428 7369 7a65 290a 0a20 2020 206d  int(size)..    m
-000428c0: 656d 5f75 7361 6765 7320 3d20 6466 2e6d  em_usages = df.m
-000428d0: 6170 5f70 6172 7469 7469 6f6e 7328 746f  ap_partitions(to
-000428e0: 7461 6c5f 6d65 6d5f 7573 6167 652c 2064  tal_mem_usage, d
-000428f0: 6565 703d 5472 7565 292e 636f 6d70 7574  eep=True).comput
-00042900: 6528 290a 0a20 2020 2023 2031 2e20 7370  e()..    # 1. sp
-00042910: 6c69 7420 6561 6368 2070 6172 7469 7469  lit each partiti
-00042920: 6f6e 2074 6861 7420 6973 206c 6172 6765  on that is large
-00042930: 7220 7468 616e 2070 6172 7469 7469 6f6e  r than partition
-00042940: 5f73 697a 650a 2020 2020 6e73 706c 6974  _size.    nsplit
-00042950: 7320 3d20 3120 2b20 6d65 6d5f 7573 6167  s = 1 + mem_usag
-00042960: 6573 202f 2f20 7369 7a65 0a20 2020 2069  es // size.    i
-00042970: 6620 6e70 2e61 6e79 286e 7370 6c69 7473  f np.any(nsplits
-00042980: 203e 2031 293a 0a20 2020 2020 2020 2073   > 1):.        s
-00042990: 706c 6974 5f6e 616d 6520 3d20 6622 7265  plit_name = f"re
-000429a0: 7061 7274 6974 696f 6e2d 7370 6c69 742d  partition-split-
-000429b0: 7b73 697a 657d 2d7b 746f 6b65 6e69 7a65  {size}-{tokenize
-000429c0: 2864 6629 7d22 0a20 2020 2020 2020 2064  (df)}".        d
-000429d0: 6620 3d20 5f73 706c 6974 5f70 6172 7469  f = _split_parti
-000429e0: 7469 6f6e 7328 6466 2c20 6e73 706c 6974  tions(df, nsplit
-000429f0: 732c 2073 706c 6974 5f6e 616d 6529 0a20  s, split_name). 
-00042a00: 2020 2020 2020 2023 2075 7064 6174 6520         # update 
-00042a10: 6d65 6d5f 7573 6167 6573 2074 6f20 6163  mem_usages to ac
-00042a20: 636f 756e 7420 666f 7220 7468 6520 7370  count for the sp
-00042a30: 6c69 7420 7061 7274 6974 696f 6e73 0a20  lit partitions. 
-00042a40: 2020 2020 2020 2073 706c 6974 5f6d 656d         split_mem
-00042a50: 5f75 7361 6765 7320 3d20 5b5d 0a20 2020  _usages = [].   
-00042a60: 2020 2020 2066 6f72 206e 2c20 7573 6167       for n, usag
-00042a70: 6520 696e 207a 6970 286e 7370 6c69 7473  e in zip(nsplits
-00042a80: 2c20 6d65 6d5f 7573 6167 6573 293a 0a20  , mem_usages):. 
-00042a90: 2020 2020 2020 2020 2020 2073 706c 6974             split
-00042aa0: 5f6d 656d 5f75 7361 6765 732e 6578 7465  _mem_usages.exte
-00042ab0: 6e64 285b 7573 6167 6520 2f20 6e5d 202a  nd([usage / n] *
-00042ac0: 206e 290a 2020 2020 2020 2020 6d65 6d5f   n).        mem_
-00042ad0: 7573 6167 6573 203d 2070 642e 5365 7269  usages = pd.Seri
-00042ae0: 6573 2873 706c 6974 5f6d 656d 5f75 7361  es(split_mem_usa
-00042af0: 6765 7329 0a0a 2020 2020 2320 322e 206e  ges)..    # 2. n
-00042b00: 6f77 2074 6861 7420 616c 6c20 7061 7274  ow that all part
-00042b10: 6974 696f 6e73 2061 7265 206c 6573 7320  itions are less 
-00042b20: 7468 616e 2073 697a 652c 2063 6f6e 6361  than size, conca
-00042b30: 7420 7468 656d 2075 7020 746f 2073 697a  t them up to siz
-00042b40: 650a 2020 2020 6173 7365 7274 206e 702e  e.    assert np.
-00042b50: 616c 6c28 6d65 6d5f 7573 6167 6573 203c  all(mem_usages <
-00042b60: 3d20 7369 7a65 290a 2020 2020 6e65 775f  = size).    new_
-00042b70: 6e70 6172 7469 7469 6f6e 7320 3d20 6c69  npartitions = li
-00042b80: 7374 286d 6170 286c 656e 2c20 6974 6572  st(map(len, iter
-00042b90: 5f63 6875 6e6b 7328 6d65 6d5f 7573 6167  _chunks(mem_usag
-00042ba0: 6573 2c20 7369 7a65 2929 290a 2020 2020  es, size))).    
-00042bb0: 6e65 775f 7061 7274 6974 696f 6e73 5f62  new_partitions_b
-00042bc0: 6f75 6e64 6172 6965 7320 3d20 6e70 2e63  oundaries = np.c
-00042bd0: 756d 7375 6d28 6e65 775f 6e70 6172 7469  umsum(new_nparti
-00042be0: 7469 6f6e 7329 0a20 2020 206e 6577 5f6e  tions).    new_n
-00042bf0: 616d 6520 3d20 6622 7265 7061 7274 6974  ame = f"repartit
-00042c00: 696f 6e2d 7b73 697a 657d 2d7b 746f 6b65  ion-{size}-{toke
-00042c10: 6e69 7a65 2864 6629 7d22 0a20 2020 2072  nize(df)}".    r
-00042c20: 6574 7572 6e20 5f72 6570 6172 7469 7469  eturn _repartiti
-00042c30: 6f6e 5f66 726f 6d5f 626f 756e 6461 7269  on_from_boundari
-00042c40: 6573 2864 662c 206e 6577 5f70 6172 7469  es(df, new_parti
-00042c50: 7469 6f6e 735f 626f 756e 6461 7269 6573  tions_boundaries
-00042c60: 2c20 6e65 775f 6e61 6d65 290a 0a0a 6465  , new_name)...de
-00042c70: 6620 746f 7461 6c5f 6d65 6d5f 7573 6167  f total_mem_usag
-00042c80: 6528 6466 2c20 696e 6465 783d 5472 7565  e(df, index=True
-00042c90: 2c20 6465 6570 3d46 616c 7365 293a 0a20  , deep=False):. 
-00042ca0: 2020 206d 656d 5f75 7361 6765 203d 2064     mem_usage = d
-00042cb0: 662e 6d65 6d6f 7279 5f75 7361 6765 2869  f.memory_usage(i
-00042cc0: 6e64 6578 3d69 6e64 6578 2c20 6465 6570  ndex=index, deep
-00042cd0: 3d64 6565 7029 0a20 2020 2069 6620 6973  =deep).    if is
-00042ce0: 5f73 6572 6965 735f 6c69 6b65 286d 656d  _series_like(mem
-00042cf0: 5f75 7361 6765 293a 0a20 2020 2020 2020  _usage):.       
-00042d00: 206d 656d 5f75 7361 6765 203d 206d 656d   mem_usage = mem
-00042d10: 5f75 7361 6765 2e73 756d 2829 0a20 2020  _usage.sum().   
-00042d20: 2072 6574 7572 6e20 6d65 6d5f 7573 6167   return mem_usag
-00042d30: 650a 0a0a 6465 6620 7265 7061 7274 6974  e...def repartit
-00042d40: 696f 6e5f 6e70 6172 7469 7469 6f6e 7328  ion_npartitions(
-00042d50: 6466 2c20 6e70 6172 7469 7469 6f6e 7329  df, npartitions)
-00042d60: 3a0a 2020 2020 2222 2252 6570 6172 7469  :.    """Reparti
-00042d70: 7469 6f6e 2064 6174 6166 7261 6d65 2074  tion dataframe t
-00042d80: 6f20 6120 736d 616c 6c65 7220 6e75 6d62  o a smaller numb
-00042d90: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
-00042da0: 2222 220a 2020 2020 6e65 775f 6e61 6d65  """.    new_name
-00042db0: 203d 2022 7265 7061 7274 6974 696f 6e2d   = "repartition-
-00042dc0: 2564 2d25 7322 2025 2028 6e70 6172 7469  %d-%s" % (nparti
-00042dd0: 7469 6f6e 732c 2074 6f6b 656e 697a 6528  tions, tokenize(
-00042de0: 6466 2929 0a20 2020 2069 6620 6466 2e6e  df)).    if df.n
-00042df0: 7061 7274 6974 696f 6e73 203d 3d20 6e70  partitions == np
-00042e00: 6172 7469 7469 6f6e 733a 0a20 2020 2020  artitions:.     
-00042e10: 2020 2072 6574 7572 6e20 6466 0a20 2020     return df.   
-00042e20: 2065 6c69 6620 6466 2e6e 7061 7274 6974   elif df.npartit
-00042e30: 696f 6e73 203e 206e 7061 7274 6974 696f  ions > npartitio
-00042e40: 6e73 3a0a 2020 2020 2020 2020 6e70 6172  ns:.        npar
-00042e50: 7469 7469 6f6e 735f 7261 7469 6f20 3d20  titions_ratio = 
-00042e60: 6466 2e6e 7061 7274 6974 696f 6e73 202f  df.npartitions /
-00042e70: 206e 7061 7274 6974 696f 6e73 0a20 2020   npartitions.   
-00042e80: 2020 2020 206e 6577 5f70 6172 7469 7469       new_partiti
-00042e90: 6f6e 735f 626f 756e 6461 7269 6573 203d  ons_boundaries =
-00042ea0: 205b 0a20 2020 2020 2020 2020 2020 2069   [.            i
-00042eb0: 6e74 286e 6577 5f70 6172 7469 7469 6f6e  nt(new_partition
-00042ec0: 5f69 6e64 6578 202a 206e 7061 7274 6974  _index * npartit
-00042ed0: 696f 6e73 5f72 6174 696f 290a 2020 2020  ions_ratio).    
-00042ee0: 2020 2020 2020 2020 666f 7220 6e65 775f          for new_
-00042ef0: 7061 7274 6974 696f 6e5f 696e 6465 7820  partition_index 
-00042f00: 696e 2072 616e 6765 286e 7061 7274 6974  in range(npartit
-00042f10: 696f 6e73 202b 2031 290a 2020 2020 2020  ions + 1).      
-00042f20: 2020 5d0a 2020 2020 2020 2020 7265 7475    ].        retu
-00042f30: 726e 205f 7265 7061 7274 6974 696f 6e5f  rn _repartition_
-00042f40: 6672 6f6d 5f62 6f75 6e64 6172 6965 7328  from_boundaries(
-00042f50: 6466 2c20 6e65 775f 7061 7274 6974 696f  df, new_partitio
-00042f60: 6e73 5f62 6f75 6e64 6172 6965 732c 206e  ns_boundaries, n
-00042f70: 6577 5f6e 616d 6529 0a20 2020 2065 6c73  ew_name).    els
-00042f80: 653a 0a20 2020 2020 2020 2023 2044 726f  e:.        # Dro
-00042f90: 7020 6475 706c 6361 7465 7320 696e 2063  p duplcates in c
-00042fa0: 6173 6520 6c61 7374 2070 6172 7469 7469  ase last partiti
-00042fb0: 6f6e 2068 6173 2073 616d 650a 2020 2020  on has same.    
-00042fc0: 2020 2020 2320 7661 6c75 6520 666f 7220      # value for 
-00042fd0: 6d69 6e20 616e 6420 6d61 7820 6469 7669  min and max divi
-00042fe0: 7369 6f6e 0a20 2020 2020 2020 206f 7269  sion.        ori
-00042ff0: 6769 6e61 6c5f 6469 7669 7369 6f6e 7320  ginal_divisions 
-00043000: 3d20 6469 7669 7369 6f6e 7320 3d20 7064  = divisions = pd
-00043010: 2e53 6572 6965 7328 6466 2e64 6976 6973  .Series(df.divis
-00043020: 696f 6e73 292e 6472 6f70 5f64 7570 6c69  ions).drop_dupli
-00043030: 6361 7465 7328 290a 2020 2020 2020 2020  cates().        
-00043040: 6966 2064 662e 6b6e 6f77 6e5f 6469 7669  if df.known_divi
-00043050: 7369 6f6e 7320 616e 6420 280a 2020 2020  sions and (.    
-00043060: 2020 2020 2020 2020 6973 5f64 6174 6574          is_datet
-00043070: 696d 6536 345f 616e 795f 6474 7970 6528  ime64_any_dtype(
-00043080: 6469 7669 7369 6f6e 732e 6474 7970 6529  divisions.dtype)
-00043090: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-000430a0: 6973 5f6e 756d 6572 6963 5f64 7479 7065  is_numeric_dtype
-000430b0: 2864 6976 6973 696f 6e73 2e64 7479 7065  (divisions.dtype
-000430c0: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
-000430d0: 2020 2020 2020 2020 2069 6620 6973 5f64           if is_d
-000430e0: 6174 6574 696d 6536 345f 616e 795f 6474  atetime64_any_dt
-000430f0: 7970 6528 6469 7669 7369 6f6e 732e 6474  ype(divisions.dt
-00043100: 7970 6529 3a0a 2020 2020 2020 2020 2020  ype):.          
-00043110: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
-00043120: 3d20 6469 7669 7369 6f6e 732e 7661 6c75  = divisions.valu
-00043130: 6573 2e61 7374 7970 6528 2266 6c6f 6174  es.astype("float
-00043140: 3634 2229 0a0a 2020 2020 2020 2020 2020  64")..          
-00043150: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
-00043160: 696b 6528 6469 7669 7369 6f6e 7329 3a0a  ike(divisions):.
-00043170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043180: 6469 7669 7369 6f6e 7320 3d20 6469 7669  divisions = divi
-00043190: 7369 6f6e 732e 7661 6c75 6573 0a0a 2020  sions.values..  
-000431a0: 2020 2020 2020 2020 2020 6e20 3d20 6c65            n = le
-000431b0: 6e28 6469 7669 7369 6f6e 7329 0a20 2020  n(divisions).   
-000431c0: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
-000431d0: 6e73 203d 206e 702e 696e 7465 7270 280a  ns = np.interp(.
-000431e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000431f0: 783d 6e70 2e6c 696e 7370 6163 6528 302c  x=np.linspace(0,
-00043200: 206e 2c20 6e70 6172 7469 7469 6f6e 7320   n, npartitions 
-00043210: 2b20 3129 2c0a 2020 2020 2020 2020 2020  + 1),.          
-00043220: 2020 2020 2020 7870 3d6e 702e 6c69 6e73        xp=np.lins
-00043230: 7061 6365 2830 2c20 6e2c 206e 292c 0a20  pace(0, n, n),. 
-00043240: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00043250: 703d 6469 7669 7369 6f6e 732c 0a20 2020  p=divisions,.   
-00043260: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00043270: 2020 2020 2020 2069 6620 6973 5f64 6174         if is_dat
-00043280: 6574 696d 6536 345f 616e 795f 6474 7970  etime64_any_dtyp
-00043290: 6528 6f72 6967 696e 616c 5f64 6976 6973  e(original_divis
-000432a0: 696f 6e73 2e64 7479 7065 293a 0a20 2020  ions.dtype):.   
-000432b0: 2020 2020 2020 2020 2020 2020 2064 6976               div
-000432c0: 6973 696f 6e73 203d 206d 6574 686f 6473  isions = methods
-000432d0: 2e74 6f6c 6973 7428 0a20 2020 2020 2020  .tolist(.       
-000432e0: 2020 2020 2020 2020 2020 2020 2070 642e               pd.
-000432f0: 5365 7269 6573 2864 6976 6973 696f 6e73  Series(divisions
-00043300: 292e 6173 7479 7065 286f 7269 6769 6e61  ).astype(origina
-00043310: 6c5f 6469 7669 7369 6f6e 732e 6474 7970  l_divisions.dtyp
-00043320: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-00043330: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00043340: 2065 6c69 6620 6e70 2e69 7373 7562 6474   elif np.issubdt
-00043350: 7970 6528 6f72 6967 696e 616c 5f64 6976  ype(original_div
-00043360: 6973 696f 6e73 2e64 7479 7065 2c20 6e70  isions.dtype, np
-00043370: 2e69 6e74 6567 6572 293a 0a20 2020 2020  .integer):.     
-00043380: 2020 2020 2020 2020 2020 2064 6976 6973             divis
-00043390: 696f 6e73 203d 2064 6976 6973 696f 6e73  ions = divisions
-000433a0: 2e61 7374 7970 6528 6f72 6967 696e 616c  .astype(original
-000433b0: 5f64 6976 6973 696f 6e73 2e64 7479 7065  _divisions.dtype
-000433c0: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
-000433d0: 6620 6973 696e 7374 616e 6365 2864 6976  f isinstance(div
-000433e0: 6973 696f 6e73 2c20 6e70 2e6e 6461 7272  isions, np.ndarr
-000433f0: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
-00043400: 2020 2020 2064 6976 6973 696f 6e73 203d       divisions =
-00043410: 2064 6976 6973 696f 6e73 2e74 6f6c 6973   divisions.tolis
-00043420: 7428 290a 0a20 2020 2020 2020 2020 2020  t()..           
-00043430: 2064 6976 6973 696f 6e73 203d 206c 6973   divisions = lis
-00043440: 7428 6469 7669 7369 6f6e 7329 0a20 2020  t(divisions).   
-00043450: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
-00043460: 6e73 5b30 5d20 3d20 6466 2e64 6976 6973  ns[0] = df.divis
-00043470: 696f 6e73 5b30 5d0a 2020 2020 2020 2020  ions[0].        
-00043480: 2020 2020 6469 7669 7369 6f6e 735b 2d31      divisions[-1
-00043490: 5d20 3d20 6466 2e64 6976 6973 696f 6e73  ] = df.divisions
-000434a0: 5b2d 315d 0a0a 2020 2020 2020 2020 2020  [-1]..          
-000434b0: 2020 2320 456e 7375 7265 2074 6865 2063    # Ensure the c
-000434c0: 6f6d 7075 7465 6420 6469 7669 7369 6f6e  omputed division
-000434d0: 7320 6172 6520 756e 6971 7565 0a20 2020  s are unique.   
-000434e0: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
-000434f0: 6e73 203d 206c 6973 7428 756e 6971 7565  ns = list(unique
-00043500: 2864 6976 6973 696f 6e73 5b3a 2d31 5d29  (divisions[:-1])
-00043510: 2920 2b20 5b64 6976 6973 696f 6e73 5b2d  ) + [divisions[-
-00043520: 315d 5d0a 2020 2020 2020 2020 2020 2020  1]].            
-00043530: 7265 7475 726e 2064 662e 7265 7061 7274  return df.repart
-00043540: 6974 696f 6e28 6469 7669 7369 6f6e 733d  ition(divisions=
-00043550: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
-00043560: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00043570: 2020 2020 2064 6976 2c20 6d6f 6420 3d20       div, mod = 
-00043580: 6469 766d 6f64 286e 7061 7274 6974 696f  divmod(npartitio
-00043590: 6e73 2c20 6466 2e6e 7061 7274 6974 696f  ns, df.npartitio
-000435a0: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
-000435b0: 6e73 706c 6974 7320 3d20 5b64 6976 5d20  nsplits = [div] 
-000435c0: 2a20 6466 2e6e 7061 7274 6974 696f 6e73  * df.npartitions
-000435d0: 0a20 2020 2020 2020 2020 2020 206e 7370  .            nsp
-000435e0: 6c69 7473 5b2d 315d 202b 3d20 6d6f 640a  lits[-1] += mod.
-000435f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00043600: 726e 205f 7370 6c69 745f 7061 7274 6974  rn _split_partit
-00043610: 696f 6e73 2864 662c 206e 7370 6c69 7473  ions(df, nsplits
-00043620: 2c20 6e65 775f 6e61 6d65 290a 0a0a 6465  , new_name)...de
-00043630: 6620 5f72 6570 6172 7469 7469 6f6e 5f66  f _repartition_f
-00043640: 726f 6d5f 626f 756e 6461 7269 6573 2864  rom_boundaries(d
-00043650: 662c 206e 6577 5f70 6172 7469 7469 6f6e  f, new_partition
-00043660: 735f 626f 756e 6461 7269 6573 2c20 6e65  s_boundaries, ne
-00043670: 775f 6e61 6d65 293a 0a20 2020 2069 6620  w_name):.    if 
-00043680: 6e6f 7420 6973 696e 7374 616e 6365 286e  not isinstance(n
-00043690: 6577 5f70 6172 7469 7469 6f6e 735f 626f  ew_partitions_bo
-000436a0: 756e 6461 7269 6573 2c20 6c69 7374 293a  undaries, list):
-000436b0: 0a20 2020 2020 2020 206e 6577 5f70 6172  .        new_par
-000436c0: 7469 7469 6f6e 735f 626f 756e 6461 7269  titions_boundari
-000436d0: 6573 203d 206c 6973 7428 6e65 775f 7061  es = list(new_pa
-000436e0: 7274 6974 696f 6e73 5f62 6f75 6e64 6172  rtitions_boundar
-000436f0: 6965 7329 0a20 2020 2069 6620 6e65 775f  ies).    if new_
-00043700: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
-00043710: 6172 6965 735b 305d 203e 2030 3a0a 2020  aries[0] > 0:.  
-00043720: 2020 2020 2020 6e65 775f 7061 7274 6974        new_partit
-00043730: 696f 6e73 5f62 6f75 6e64 6172 6965 732e  ions_boundaries.
-00043740: 696e 7365 7274 2830 2c20 3029 0a20 2020  insert(0, 0).   
-00043750: 2069 6620 6e65 775f 7061 7274 6974 696f   if new_partitio
-00043760: 6e73 5f62 6f75 6e64 6172 6965 735b 2d31  ns_boundaries[-1
-00043770: 5d20 3c20 6466 2e6e 7061 7274 6974 696f  ] < df.npartitio
-00043780: 6e73 3a0a 2020 2020 2020 2020 6e65 775f  ns:.        new_
-00043790: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
-000437a0: 6172 6965 732e 6170 7065 6e64 2864 662e  aries.append(df.
-000437b0: 6e70 6172 7469 7469 6f6e 7329 0a20 2020  npartitions).   
-000437c0: 2064 736b 203d 207b 7d0a 2020 2020 666f   dsk = {}.    fo
-000437d0: 7220 692c 2028 7374 6172 742c 2065 6e64  r i, (start, end
-000437e0: 2920 696e 2065 6e75 6d65 7261 7465 280a  ) in enumerate(.
-000437f0: 2020 2020 2020 2020 7a69 7028 6e65 775f          zip(new_
-00043800: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
-00043810: 6172 6965 732c 206e 6577 5f70 6172 7469  aries, new_parti
-00043820: 7469 6f6e 735f 626f 756e 6461 7269 6573  tions_boundaries
-00043830: 5b31 3a5d 290a 2020 2020 293a 0a20 2020  [1:]).    ):.   
-00043840: 2020 2020 2064 736b 5b6e 6577 5f6e 616d       dsk[new_nam
-00043850: 652c 2069 5d20 3d20 286d 6574 686f 6473  e, i] = (methods
-00043860: 2e63 6f6e 6361 742c 205b 2864 662e 5f6e  .concat, [(df._n
-00043870: 616d 652c 206a 2920 666f 7220 6a20 696e  ame, j) for j in
-00043880: 2072 616e 6765 2873 7461 7274 2c20 656e   range(start, en
-00043890: 6429 5d29 0a20 2020 2064 6976 6973 696f  d)]).    divisio
-000438a0: 6e73 203d 205b 6466 2e64 6976 6973 696f  ns = [df.divisio
-000438b0: 6e73 5b69 5d20 666f 7220 6920 696e 206e  ns[i] for i in n
-000438c0: 6577 5f70 6172 7469 7469 6f6e 735f 626f  ew_partitions_bo
-000438d0: 756e 6461 7269 6573 5d0a 2020 2020 6772  undaries].    gr
-000438e0: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-000438f0: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-00043900: 7469 6f6e 7328 6e65 775f 6e61 6d65 2c20  tions(new_name, 
-00043910: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-00043920: 733d 5b64 665d 290a 2020 2020 7265 7475  s=[df]).    retu
-00043930: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
-00043940: 2867 7261 7068 2c20 6e65 775f 6e61 6d65  (graph, new_name
-00043950: 2c20 6466 2e5f 6d65 7461 2c20 6469 7669  , df._meta, divi
-00043960: 7369 6f6e 7329 0a0a 0a64 6566 205f 7370  sions)...def _sp
-00043970: 6c69 745f 7061 7274 6974 696f 6e73 2864  lit_partitions(d
-00043980: 662c 206e 7370 6c69 7473 2c20 6e65 775f  f, nsplits, new_
-00043990: 6e61 6d65 293a 0a20 2020 2022 2222 5370  name):.    """Sp
-000439a0: 6c69 7420 6120 4461 736b 2064 6174 6166  lit a Dask dataf
-000439b0: 7261 6d65 2069 6e74 6f20 6e65 7720 7061  rame into new pa
-000439c0: 7274 6974 696f 6e73 0a0a 2020 2020 5061  rtitions..    Pa
-000439d0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-000439e0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6466 3a20  -------.    df: 
-000439f0: 4461 7461 4672 616d 6520 6f72 2053 6572  DataFrame or Ser
-00043a00: 6965 730a 2020 2020 6e73 706c 6974 733a  ies.    nsplits:
-00043a10: 204c 6973 745b 696e 745d 0a20 2020 2020   List[int].     
-00043a20: 2020 204e 756d 6265 7220 6f66 2074 6172     Number of tar
-00043a30: 6765 7420 6461 7461 6672 616d 6573 2066  get dataframes f
-00043a40: 6f72 2065 6163 6820 7061 7274 6974 696f  or each partitio
-00043a50: 6e0a 2020 2020 2020 2020 5468 6520 6c65  n.        The le
-00043a60: 6e67 7468 206f 6620 6e73 706c 6974 7320  ngth of nsplits 
-00043a70: 7368 6f75 6c64 2062 6520 7468 6520 7361  should be the sa
-00043a80: 6d65 2061 7320 6466 2e6e 7061 7274 6974  me as df.npartit
-00043a90: 696f 6e73 0a20 2020 206e 6577 5f6e 616d  ions.    new_nam
-00043aa0: 653a 2073 7472 0a0a 2020 2020 5365 6520  e: str..    See 
-00043ab0: 416c 736f 0a20 2020 202d 2d2d 2d2d 2d2d  Also.    -------
-00043ac0: 2d0a 2020 2020 7265 7061 7274 6974 696f  -.    repartitio
-00043ad0: 6e5f 6e70 6172 7469 7469 6f6e 730a 2020  n_npartitions.  
-00043ae0: 2020 7265 7061 7274 6974 696f 6e5f 7369    repartition_si
-00043af0: 7a65 0a20 2020 2022 2222 0a20 2020 2069  ze.    """.    i
-00043b00: 6620 6c65 6e28 6e73 706c 6974 7329 2021  f len(nsplits) !
-00043b10: 3d20 6466 2e6e 7061 7274 6974 696f 6e73  = df.npartitions
-00043b20: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-00043b30: 5661 6c75 6545 7272 6f72 2866 226e 7370  ValueError(f"nsp
-00043b40: 6c69 7473 2073 686f 756c 6420 6861 7665  lits should have
-00043b50: 206c 656e 3d7b 6466 2e6e 7061 7274 6974   len={df.npartit
-00043b60: 696f 6e73 7d22 290a 0a20 2020 2064 736b  ions}")..    dsk
-00043b70: 203d 207b 7d0a 2020 2020 7370 6c69 745f   = {}.    split_
-00043b80: 6e61 6d65 203d 2066 2273 706c 6974 2d7b  name = f"split-{
-00043b90: 746f 6b65 6e69 7a65 2864 662c 206e 7370  tokenize(df, nsp
-00043ba0: 6c69 7473 297d 220a 2020 2020 6a20 3d20  lits)}".    j = 
-00043bb0: 300a 2020 2020 666f 7220 692c 206b 2069  0.    for i, k i
-00043bc0: 6e20 656e 756d 6572 6174 6528 6e73 706c  n enumerate(nspl
-00043bd0: 6974 7329 3a0a 2020 2020 2020 2020 6966  its):.        if
-00043be0: 206b 203d 3d20 313a 0a20 2020 2020 2020   k == 1:.       
-00043bf0: 2020 2020 2064 736b 5b6e 6577 5f6e 616d       dsk[new_nam
-00043c00: 652c 206a 5d20 3d20 2864 662e 5f6e 616d  e, j] = (df._nam
-00043c10: 652c 2069 290a 2020 2020 2020 2020 2020  e, i).          
-00043c20: 2020 6a20 2b3d 2031 0a20 2020 2020 2020    j += 1.       
-00043c30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00043c40: 2020 2064 736b 5b73 706c 6974 5f6e 616d     dsk[split_nam
-00043c50: 652c 2069 5d20 3d20 2873 706c 6974 5f65  e, i] = (split_e
-00043c60: 7665 6e6c 792c 2028 6466 2e5f 6e61 6d65  venly, (df._name
-00043c70: 2c20 6929 2c20 6b29 0a20 2020 2020 2020  , i), k).       
-00043c80: 2020 2020 2066 6f72 206a 6a20 696e 2072       for jj in r
-00043c90: 616e 6765 286b 293a 0a20 2020 2020 2020  ange(k):.       
-00043ca0: 2020 2020 2020 2020 2064 736b 5b6e 6577           dsk[new
-00043cb0: 5f6e 616d 652c 206a 5d20 3d20 2867 6574  _name, j] = (get
-00043cc0: 6974 656d 2c20 2873 706c 6974 5f6e 616d  item, (split_nam
-00043cd0: 652c 2069 292c 206a 6a29 0a20 2020 2020  e, i), jj).     
-00043ce0: 2020 2020 2020 2020 2020 206a 202b 3d20             j += 
-00043cf0: 310a 0a20 2020 2064 6976 6973 696f 6e73  1..    divisions
-00043d00: 203d 205b 4e6f 6e65 5d20 2a20 2831 202b   = [None] * (1 +
-00043d10: 2073 756d 286e 7370 6c69 7473 2929 0a20   sum(nsplits)). 
-00043d20: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-00043d30: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-00043d40: 6f6c 6c65 6374 696f 6e73 286e 6577 5f6e  ollections(new_n
-00043d50: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
-00043d60: 656e 6369 6573 3d5b 6466 5d29 0a20 2020  encies=[df]).   
-00043d70: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
-00043d80: 626a 6563 7428 6772 6170 682c 206e 6577  bject(graph, new
-00043d90: 5f6e 616d 652c 2064 662e 5f6d 6574 612c  _name, df._meta,
-00043da0: 2064 6976 6973 696f 6e73 290a 0a0a 6465   divisions)...de
-00043db0: 6620 7265 7061 7274 6974 696f 6e28 6466  f repartition(df
-00043dc0: 2c20 6469 7669 7369 6f6e 733d 4e6f 6e65  , divisions=None
-00043dd0: 2c20 666f 7263 653d 4661 6c73 6529 3a0a  , force=False):.
-00043de0: 2020 2020 2222 2252 6570 6172 7469 7469      """Repartiti
-00043df0: 6f6e 2064 6174 6166 7261 6d65 2061 6c6f  on dataframe alo
-00043e00: 6e67 206e 6577 2064 6976 6973 696f 6e73  ng new divisions
-00043e10: 0a0a 2020 2020 4461 736b 2e44 6174 6146  ..    Dask.DataF
-00043e20: 7261 6d65 206f 626a 6563 7473 2061 7265  rame objects are
-00043e30: 2070 6172 7469 7469 6f6e 6564 2061 6c6f   partitioned alo
-00043e40: 6e67 2074 6865 6972 2069 6e64 6578 2e20  ng their index. 
-00043e50: 204f 6674 656e 2077 6865 6e0a 2020 2020   Often when.    
-00043e60: 6d75 6c74 6970 6c65 2064 6174 6166 7261  multiple datafra
-00043e70: 6d65 7320 696e 7465 7261 6374 2077 6520  mes interact we 
-00043e80: 6e65 6564 2074 6f20 616c 6967 6e20 7468  need to align th
-00043e90: 6573 6520 7061 7274 6974 696f 6e69 6e67  ese partitioning
-00043ea0: 732e 2020 5468 650a 2020 2020 6060 7265  s.  The.    ``re
-00043eb0: 7061 7274 6974 696f 6e60 6020 6675 6e63  partition`` func
-00043ec0: 7469 6f6e 2063 6f6e 7374 7275 6374 7320  tion constructs 
-00043ed0: 6120 6e65 7720 4461 7461 4672 616d 6520  a new DataFrame 
-00043ee0: 6f62 6a65 6374 2068 6f6c 6469 6e67 2074  object holding t
-00043ef0: 6865 2073 616d 650a 2020 2020 6461 7461  he same.    data
-00043f00: 2062 7574 2070 6172 7469 7469 6f6e 6564   but partitioned
-00043f10: 206f 6e20 6469 6666 6572 656e 7420 7661   on different va
-00043f20: 6c75 6573 2e20 2049 7420 646f 6573 2074  lues.  It does t
-00043f30: 6869 7320 6279 2070 6572 666f 726d 696e  his by performin
-00043f40: 6720 610a 2020 2020 7365 7175 656e 6365  g a.    sequence
-00043f50: 206f 6620 6060 6c6f 6360 6020 616e 6420   of ``loc`` and 
-00043f60: 6060 636f 6e63 6174 6060 2063 616c 6c73  ``concat`` calls
-00043f70: 2074 6f20 7370 6c69 7420 616e 6420 6d65   to split and me
-00043f80: 7267 6520 7468 6520 7072 6576 696f 7573  rge the previous
-00043f90: 0a20 2020 2067 656e 6572 6174 696f 6e20  .    generation 
-00043fa0: 6f66 2070 6172 7469 7469 6f6e 732e 0a0a  of partitions...
-00043fb0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00043fc0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 0a20     ----------.. 
-00043fd0: 2020 2064 6976 6973 696f 6e73 203a 206c     divisions : l
-00043fe0: 6973 740a 2020 2020 2020 2020 4c69 7374  ist.        List
-00043ff0: 206f 6620 7061 7274 6974 696f 6e73 2074   of partitions t
-00044000: 6f20 6265 2075 7365 640a 2020 2020 666f  o be used.    fo
-00044010: 7263 6520 3a20 626f 6f6c 2c20 6465 6661  rce : bool, defa
-00044020: 756c 7420 4661 6c73 650a 2020 2020 2020  ult False.      
-00044030: 2020 416c 6c6f 7773 2074 6865 2065 7870    Allows the exp
-00044040: 616e 7369 6f6e 206f 6620 7468 6520 6578  ansion of the ex
-00044050: 6973 7469 6e67 2064 6976 6973 696f 6e73  isting divisions
-00044060: 2e0a 2020 2020 2020 2020 4966 2046 616c  ..        If Fal
-00044070: 7365 2074 6865 6e20 7468 6520 6e65 7720  se then the new 
-00044080: 6469 7669 7369 6f6e 7320 6c6f 7765 7220  divisions lower 
-00044090: 616e 6420 7570 7065 7220 626f 756e 6473  and upper bounds
-000440a0: 206d 7573 7420 6265 0a20 2020 2020 2020   must be.       
-000440b0: 2074 6865 2073 616d 6520 6173 2074 6865   the same as the
-000440c0: 206f 6c64 2064 6976 6973 696f 6e73 2e0a   old divisions..
-000440d0: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
-000440e0: 2020 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020    --------..    
-000440f0: 3e3e 3e20 6466 203d 2064 662e 7265 7061  >>> df = df.repa
-00044100: 7274 6974 696f 6e28 5b30 2c20 352c 2031  rtition([0, 5, 1
-00044110: 302c 2032 305d 2920 2023 2064 6f63 7465  0, 20])  # docte
-00044120: 7374 3a20 2b53 4b49 500a 0a20 2020 2041  st: +SKIP..    A
-00044130: 6c73 6f20 776f 726b 7320 6f6e 2050 616e  lso works on Pan
-00044140: 6461 7320 6f62 6a65 6374 730a 0a20 2020  das objects..   
-00044150: 203e 3e3e 2064 6466 203d 2064 642e 7265   >>> ddf = dd.re
-00044160: 7061 7274 6974 696f 6e28 6466 2c20 5b30  partition(df, [0
-00044170: 2c20 352c 2031 302c 2032 305d 2920 2023  , 5, 10, 20])  #
-00044180: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-00044190: 2020 2020 2222 220a 0a20 2020 2023 206e      """..    # n
-000441a0: 6f2d 6f70 2066 6173 7470 6174 6820 666f  o-op fastpath fo
-000441b0: 7220 7768 656e 2077 6520 616c 7265 6164  r when we alread
-000441c0: 7920 6861 7665 206d 6174 6368 696e 6720  y have matching 
-000441d0: 6469 7669 7369 6f6e 730a 2020 2020 6966  divisions.    if
-000441e0: 2069 735f 6461 736b 5f63 6f6c 6c65 6374   is_dask_collect
-000441f0: 696f 6e28 6466 2920 616e 6420 6466 2e64  ion(df) and df.d
-00044200: 6976 6973 696f 6e73 203d 3d20 6469 7669  ivisions == divi
-00044210: 7369 6f6e 733a 0a20 2020 2020 2020 2072  sions:.        r
-00044220: 6574 7572 6e20 6466 0a0a 2020 2020 746f  eturn df..    to
-00044230: 6b65 6e20 3d20 746f 6b65 6e69 7a65 2864  ken = tokenize(d
-00044240: 662c 2064 6976 6973 696f 6e73 290a 2020  f, divisions).  
-00044250: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00044260: 6466 2c20 5f46 7261 6d65 293a 0a20 2020  df, _Frame):.   
-00044270: 2020 2020 2074 6d70 203d 2022 7265 7061       tmp = "repa
-00044280: 7274 6974 696f 6e2d 7370 6c69 742d 2220  rtition-split-" 
-00044290: 2b20 746f 6b65 6e0a 2020 2020 2020 2020  + token.        
-000442a0: 6f75 7420 3d20 2272 6570 6172 7469 7469  out = "repartiti
-000442b0: 6f6e 2d6d 6572 6765 2d22 202b 2074 6f6b  on-merge-" + tok
-000442c0: 656e 0a20 2020 2020 2020 2064 736b 203d  en.        dsk =
-000442d0: 2072 6570 6172 7469 7469 6f6e 5f64 6976   repartition_div
-000442e0: 6973 696f 6e73 280a 2020 2020 2020 2020  isions(.        
-000442f0: 2020 2020 6466 2e64 6976 6973 696f 6e73      df.divisions
-00044300: 2c20 6469 7669 7369 6f6e 732c 2064 662e  , divisions, df.
-00044310: 5f6e 616d 652c 2074 6d70 2c20 6f75 742c  _name, tmp, out,
-00044320: 2066 6f72 6365 3d66 6f72 6365 0a20 2020   force=force.   
-00044330: 2020 2020 2029 0a20 2020 2020 2020 2067       ).        g
-00044340: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-00044350: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-00044360: 6374 696f 6e73 286f 7574 2c20 6473 6b2c  ctions(out, dsk,
-00044370: 2064 6570 656e 6465 6e63 6965 733d 5b64   dependencies=[d
-00044380: 665d 290a 2020 2020 2020 2020 7265 7475  f]).        retu
-00044390: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
-000443a0: 2867 7261 7068 2c20 6f75 742c 2064 662e  (graph, out, df.
-000443b0: 5f6d 6574 612c 2064 6976 6973 696f 6e73  _meta, divisions
-000443c0: 290a 2020 2020 656c 6966 2069 735f 6461  ).    elif is_da
-000443d0: 7461 6672 616d 655f 6c69 6b65 2864 6629  taframe_like(df)
-000443e0: 206f 7220 6973 5f73 6572 6965 735f 6c69   or is_series_li
-000443f0: 6b65 2864 6629 3a0a 2020 2020 2020 2020  ke(df):.        
-00044400: 6e61 6d65 203d 2022 7265 7061 7274 6974  name = "repartit
-00044410: 696f 6e2d 6461 7461 6672 616d 652d 2220  ion-dataframe-" 
-00044420: 2b20 746f 6b65 6e0a 2020 2020 2020 2020  + token.        
-00044430: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
-00044440: 616d 652e 7574 696c 7320 696d 706f 7274  ame.utils import
-00044450: 2073 6861 7264 5f64 665f 6f6e 5f69 6e64   shard_df_on_ind
-00044460: 6578 0a0a 2020 2020 2020 2020 6466 7320  ex..        dfs 
-00044470: 3d20 7368 6172 645f 6466 5f6f 6e5f 696e  = shard_df_on_in
-00044480: 6465 7828 6466 2c20 6469 7669 7369 6f6e  dex(df, division
-00044490: 735b 313a 2d31 5d29 0a20 2020 2020 2020  s[1:-1]).       
-000444a0: 2064 736b 203d 207b 286e 616d 652c 2069   dsk = {(name, i
-000444b0: 293a 2064 6620 666f 7220 692c 2064 6620  ): df for i, df 
-000444c0: 696e 2065 6e75 6d65 7261 7465 2864 6673  in enumerate(dfs
-000444d0: 297d 0a20 2020 2020 2020 2072 6574 7572  )}.        retur
-000444e0: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
-000444f0: 6473 6b2c 206e 616d 652c 2064 662c 2064  dsk, name, df, d
-00044500: 6976 6973 696f 6e73 290a 2020 2020 7261  ivisions).    ra
-00044510: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-00044520: 4461 7461 206d 7573 7420 6265 2044 6174  Data must be Dat
-00044530: 6146 7261 6d65 206f 7220 5365 7269 6573  aFrame or Series
-00044540: 2229 0a0a 0a64 6566 205f 7265 6475 6374  ")...def _reduct
-00044550: 696f 6e5f 6368 756e 6b28 782c 2061 6361  ion_chunk(x, aca
-00044560: 5f63 6875 6e6b 3d4e 6f6e 652c 202a 2a6b  _chunk=None, **k
-00044570: 7761 7267 7329 3a0a 2020 2020 6f20 3d20  wargs):.    o = 
-00044580: 6163 615f 6368 756e 6b28 782c 202a 2a6b  aca_chunk(x, **k
-00044590: 7761 7267 7329 0a20 2020 2023 2052 6574  wargs).    # Ret
-000445a0: 7572 6e20 6120 6461 7461 6672 616d 6520  urn a dataframe 
-000445b0: 736f 2074 6861 7420 7468 6520 636f 6e63  so that the conc
-000445c0: 6174 656e 6174 6564 2076 6572 7369 6f6e  atenated version
-000445d0: 2069 7320 616c 736f 2061 2064 6174 6166   is also a dataf
-000445e0: 7261 6d65 0a20 2020 2072 6574 7572 6e20  rame.    return 
-000445f0: 6f2e 746f 5f66 7261 6d65 2829 2e54 2069  o.to_frame().T i
-00044600: 6620 6973 5f73 6572 6965 735f 6c69 6b65  f is_series_like
-00044610: 286f 2920 656c 7365 206f 0a0a 0a64 6566  (o) else o...def
-00044620: 205f 7265 6475 6374 696f 6e5f 636f 6d62   _reduction_comb
-00044630: 696e 6528 782c 2061 6361 5f63 6f6d 6269  ine(x, aca_combi
-00044640: 6e65 3d4e 6f6e 652c 202a 2a6b 7761 7267  ne=None, **kwarg
-00044650: 7329 3a0a 2020 2020 6966 2069 7369 6e73  s):.    if isins
-00044660: 7461 6e63 6528 782c 206c 6973 7429 3a0a  tance(x, list):.
-00044670: 2020 2020 2020 2020 7820 3d20 7064 2e53          x = pd.S
-00044680: 6572 6965 7328 7829 0a20 2020 206f 203d  eries(x).    o =
-00044690: 2061 6361 5f63 6f6d 6269 6e65 2878 2c20   aca_combine(x, 
-000446a0: 2a2a 6b77 6172 6773 290a 2020 2020 2320  **kwargs).    # 
-000446b0: 5265 7475 726e 2061 2064 6174 6166 7261  Return a datafra
-000446c0: 6d65 2073 6f20 7468 6174 2074 6865 2063  me so that the c
-000446d0: 6f6e 6361 7465 6e61 7465 6420 7665 7273  oncatenated vers
-000446e0: 696f 6e20 6973 2061 6c73 6f20 6120 6461  ion is also a da
-000446f0: 7461 6672 616d 650a 2020 2020 7265 7475  taframe.    retu
-00044700: 726e 206f 2e74 6f5f 6672 616d 6528 292e  rn o.to_frame().
-00044710: 5420 6966 2069 735f 7365 7269 6573 5f6c  T if is_series_l
-00044720: 696b 6528 6f29 2065 6c73 6520 6f0a 0a0a  ike(o) else o...
-00044730: 6465 6620 5f72 6564 7563 7469 6f6e 5f61  def _reduction_a
-00044740: 6767 7265 6761 7465 2878 2c20 6163 615f  ggregate(x, aca_
-00044750: 6167 6772 6567 6174 653d 4e6f 6e65 2c20  aggregate=None, 
-00044760: 2a2a 6b77 6172 6773 293a 0a20 2020 2069  **kwargs):.    i
-00044770: 6620 6973 696e 7374 616e 6365 2878 2c20  f isinstance(x, 
-00044780: 6c69 7374 293a 0a20 2020 2020 2020 2078  list):.        x
-00044790: 203d 2070 642e 5365 7269 6573 2878 290a   = pd.Series(x).
-000447a0: 2020 2020 7265 7475 726e 2061 6361 5f61      return aca_a
-000447b0: 6767 7265 6761 7465 2878 2c20 2a2a 6b77  ggregate(x, **kw
-000447c0: 6172 6773 290a 0a0a 6465 6620 6964 786d  args)...def idxm
-000447d0: 6178 6d69 6e5f 6368 756e 6b28 782c 2066  axmin_chunk(x, f
-000447e0: 6e3d 4e6f 6e65 2c20 736b 6970 6e61 3d54  n=None, skipna=T
-000447f0: 7275 6529 3a0a 2020 2020 6d69 6e6d 6178  rue):.    minmax
-00044800: 203d 2022 6d61 7822 2069 6620 666e 203d   = "max" if fn =
-00044810: 3d20 2269 6478 6d61 7822 2065 6c73 6520  = "idxmax" else 
-00044820: 226d 696e 220a 2020 2020 6966 206c 656e  "min".    if len
-00044830: 2878 2920 3e20 303a 0a20 2020 2020 2020  (x) > 0:.       
-00044840: 2069 6478 203d 2067 6574 6174 7472 2878   idx = getattr(x
-00044850: 2c20 666e 2928 736b 6970 6e61 3d73 6b69  , fn)(skipna=ski
-00044860: 706e 6129 0a20 2020 2020 2020 2076 616c  pna).        val
-00044870: 7565 203d 2067 6574 6174 7472 2878 2c20  ue = getattr(x, 
-00044880: 6d69 6e6d 6178 2928 736b 6970 6e61 3d73  minmax)(skipna=s
-00044890: 6b69 706e 6129 0a20 2020 2065 6c73 653a  kipna).    else:
-000448a0: 0a20 2020 2020 2020 2069 6478 203d 2076  .        idx = v
-000448b0: 616c 7565 203d 206d 6574 615f 7365 7269  alue = meta_seri
-000448c0: 6573 5f63 6f6e 7374 7275 6374 6f72 2878  es_constructor(x
-000448d0: 2928 5b5d 2c20 6474 7970 653d 2269 3822  )([], dtype="i8"
-000448e0: 290a 2020 2020 6966 2069 735f 7365 7269  ).    if is_seri
-000448f0: 6573 5f6c 696b 6528 6964 7829 3a0a 2020  es_like(idx):.  
-00044900: 2020 2020 2020 7265 7475 726e 206d 6574        return met
-00044910: 615f 6672 616d 655f 636f 6e73 7472 7563  a_frame_construc
-00044920: 746f 7228 7829 287b 2269 6478 223a 2069  tor(x)({"idx": i
-00044930: 6478 2c20 2276 616c 7565 223a 2076 616c  dx, "value": val
-00044940: 7565 7d29 0a20 2020 2072 6574 7572 6e20  ue}).    return 
-00044950: 6d65 7461 5f66 7261 6d65 5f63 6f6e 7374  meta_frame_const
-00044960: 7275 6374 6f72 2878 2928 7b22 6964 7822  ructor(x)({"idx"
-00044970: 3a20 5b69 6478 5d2c 2022 7661 6c75 6522  : [idx], "value"
-00044980: 3a20 5b76 616c 7565 5d7d 290a 0a0a 6465  : [value]})...de
-00044990: 6620 6964 786d 6178 6d69 6e5f 726f 7728  f idxmaxmin_row(
-000449a0: 782c 2066 6e3d 4e6f 6e65 2c20 736b 6970  x, fn=None, skip
-000449b0: 6e61 3d54 7275 6529 3a0a 2020 2020 6d69  na=True):.    mi
-000449c0: 6e6d 6178 203d 2022 6d61 7822 2069 6620  nmax = "max" if 
-000449d0: 666e 203d 3d20 2269 6478 6d61 7822 2065  fn == "idxmax" e
-000449e0: 6c73 6520 226d 696e 220a 2020 2020 6966  lse "min".    if
-000449f0: 206c 656e 2878 2920 3e20 303a 0a20 2020   len(x) > 0:.   
-00044a00: 2020 2020 2078 203d 2078 2e73 6574 5f69       x = x.set_i
-00044a10: 6e64 6578 2822 6964 7822 290a 2020 2020  ndex("idx").    
-00044a20: 2020 2020 6964 7820 3d20 5b67 6574 6174      idx = [getat
-00044a30: 7472 2878 2e76 616c 7565 2c20 666e 2928  tr(x.value, fn)(
-00044a40: 736b 6970 6e61 3d73 6b69 706e 6129 5d0a  skipna=skipna)].
-00044a50: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
-00044a60: 5b67 6574 6174 7472 2878 2e76 616c 7565  [getattr(x.value
-00044a70: 2c20 6d69 6e6d 6178 2928 736b 6970 6e61  , minmax)(skipna
-00044a80: 3d73 6b69 706e 6129 5d0a 2020 2020 656c  =skipna)].    el
-00044a90: 7365 3a0a 2020 2020 2020 2020 6964 7820  se:.        idx 
-00044aa0: 3d20 7661 6c75 6520 3d20 6d65 7461 5f73  = value = meta_s
-00044ab0: 6572 6965 735f 636f 6e73 7472 7563 746f  eries_constructo
-00044ac0: 7228 7829 285b 5d2c 2064 7479 7065 3d22  r(x)([], dtype="
-00044ad0: 6938 2229 0a20 2020 2072 6574 7572 6e20  i8").    return 
-00044ae0: 6d65 7461 5f66 7261 6d65 5f63 6f6e 7374  meta_frame_const
-00044af0: 7275 6374 6f72 2878 2928 7b22 6964 7822  ructor(x)({"idx"
-00044b00: 3a20 6964 782c 2022 7661 6c75 6522 3a20  : idx, "value": 
-00044b10: 7661 6c75 657d 290a 0a0a 6465 6620 6964  value})...def id
-00044b20: 786d 6178 6d69 6e5f 636f 6d62 696e 6528  xmaxmin_combine(
-00044b30: 782c 2066 6e3d 4e6f 6e65 2c20 736b 6970  x, fn=None, skip
-00044b40: 6e61 3d54 7275 6529 3a0a 2020 2020 6966  na=True):.    if
-00044b50: 206c 656e 2878 2920 3c3d 2031 3a0a 2020   len(x) <= 1:.  
-00044b60: 2020 2020 2020 7265 7475 726e 2078 0a20        return x. 
-00044b70: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
-00044b80: 2020 2020 782e 6772 6f75 7062 7928 6c65      x.groupby(le
-00044b90: 7665 6c3d 3029 0a20 2020 2020 2020 202e  vel=0).        .
-00044ba0: 6170 706c 7928 6964 786d 6178 6d69 6e5f  apply(idxmaxmin_
-00044bb0: 726f 772c 2066 6e3d 666e 2c20 736b 6970  row, fn=fn, skip
-00044bc0: 6e61 3d73 6b69 706e 6129 0a20 2020 2020  na=skipna).     
-00044bd0: 2020 202e 7265 7365 745f 696e 6465 7828     .reset_index(
-00044be0: 6c65 7665 6c3d 312c 2064 726f 703d 5472  level=1, drop=Tr
-00044bf0: 7565 290a 2020 2020 290a 0a0a 6465 6620  ue).    )...def 
-00044c00: 6964 786d 6178 6d69 6e5f 6167 6728 782c  idxmaxmin_agg(x,
-00044c10: 2066 6e3d 4e6f 6e65 2c20 736b 6970 6e61   fn=None, skipna
-00044c20: 3d54 7275 652c 2073 6361 6c61 723d 4661  =True, scalar=Fa
-00044c30: 6c73 6529 3a0a 2020 2020 7265 7320 3d20  lse):.    res = 
-00044c40: 6964 786d 6178 6d69 6e5f 636f 6d62 696e  idxmaxmin_combin
-00044c50: 6528 782c 2066 6e2c 2073 6b69 706e 613d  e(x, fn, skipna=
-00044c60: 736b 6970 6e61 295b 2269 6478 225d 0a20  skipna)["idx"]. 
-00044c70: 2020 2069 6620 6c65 6e28 7265 7329 203d     if len(res) =
-00044c80: 3d20 303a 0a20 2020 2020 2020 2072 6169  = 0:.        rai
-00044c90: 7365 2056 616c 7565 4572 726f 7228 2261  se ValueError("a
-00044ca0: 7474 656d 7074 2074 6f20 6765 7420 6172  ttempt to get ar
-00044cb0: 676d 6178 206f 6620 616e 2065 6d70 7479  gmax of an empty
-00044cc0: 2073 6571 7565 6e63 6522 290a 2020 2020   sequence").    
-00044cd0: 6966 2073 6361 6c61 723a 0a20 2020 2020  if scalar:.     
-00044ce0: 2020 2072 6574 7572 6e20 7265 735b 305d     return res[0]
-00044cf0: 0a20 2020 2072 6573 2e6e 616d 6520 3d20  .    res.name = 
-00044d00: 4e6f 6e65 0a20 2020 2072 6574 7572 6e20  None.    return 
-00044d10: 7265 730a 0a0a 6465 6620 5f6d 6f64 655f  res...def _mode_
-00044d20: 6167 6772 6567 6174 6528 6466 2c20 6472  aggregate(df, dr
-00044d30: 6f70 6e61 293a 0a20 2020 2076 616c 7565  opna):.    value
-00044d40: 5f63 6f75 6e74 5f73 6572 6965 7320 3d20  _count_series = 
-00044d50: 6466 2e73 756d 2829 0a20 2020 206d 6178  df.sum().    max
-00044d60: 5f76 616c 203d 2076 616c 7565 5f63 6f75  _val = value_cou
-00044d70: 6e74 5f73 6572 6965 732e 6d61 7828 736b  nt_series.max(sk
-00044d80: 6970 6e61 3d64 726f 706e 6129 0a20 2020  ipna=dropna).   
-00044d90: 206d 6f64 655f 7365 7269 6573 203d 2028   mode_series = (
-00044da0: 0a20 2020 2020 2020 2076 616c 7565 5f63  .        value_c
-00044db0: 6f75 6e74 5f73 6572 6965 735b 7661 6c75  ount_series[valu
-00044dc0: 655f 636f 756e 745f 7365 7269 6573 203d  e_count_series =
-00044dd0: 3d20 6d61 785f 7661 6c5d 0a20 2020 2020  = max_val].     
-00044de0: 2020 202e 696e 6465 782e 746f 5f73 6572     .index.to_ser
-00044df0: 6965 7328 290a 2020 2020 2020 2020 2e73  ies().        .s
-00044e00: 6f72 745f 7661 6c75 6573 2829 0a20 2020  ort_values().   
-00044e10: 2020 2020 202e 7265 7365 745f 696e 6465       .reset_inde
-00044e20: 7828 6472 6f70 3d54 7275 6529 0a20 2020  x(drop=True).   
-00044e30: 2029 0a20 2020 2072 6574 7572 6e20 6d6f   ).    return mo
-00044e40: 6465 5f73 6572 6965 730a 0a0a 6465 6620  de_series...def 
-00044e50: 5f63 6f75 6e74 5f61 6767 7265 6761 7465  _count_aggregate
-00044e60: 2878 293a 0a20 2020 2072 6574 7572 6e20  (x):.    return 
-00044e70: 782e 7375 6d28 292e 6173 7479 7065 2822  x.sum().astype("
-00044e80: 696e 7436 3422 290a 0a0a 6465 6620 7361  int64")...def sa
-00044e90: 6665 5f68 6561 6428 6466 2c20 6e29 3a0a  fe_head(df, n):.
-00044ea0: 2020 2020 7220 3d20 4d2e 6865 6164 2864      r = M.head(d
-00044eb0: 662c 206e 290a 2020 2020 6966 206c 656e  f, n).    if len
-00044ec0: 2872 2920 213d 206e 3a0a 2020 2020 2020  (r) != n:.      
-00044ed0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-00044ee0: 0a20 2020 2020 2020 2020 2020 2066 2249  .            f"I
-00044ef0: 6e73 7566 6669 6369 656e 7420 656c 656d  nsufficient elem
-00044f00: 656e 7473 2066 6f72 2060 6865 6164 602e  ents for `head`.
-00044f10: 207b 6e7d 2065 6c65 6d65 6e74 7320 7265   {n} elements re
-00044f20: 7175 6573 7465 642c 206f 6e6c 7920 7b6c  quested, only {l
-00044f30: 656e 2872 297d 2022 0a20 2020 2020 2020  en(r)} ".       
-00044f40: 2020 2020 2022 656c 656d 656e 7473 2061       "elements a
-00044f50: 7661 696c 6162 6c65 2e20 5472 7920 7061  vailable. Try pa
-00044f60: 7373 696e 6720 6c61 7267 6572 2060 6e70  ssing larger `np
-00044f70: 6172 7469 7469 6f6e 7360 2074 6f20 6068  artitions` to `h
-00044f80: 6561 6460 2e22 0a20 2020 2020 2020 2029  ead`.".        )
-00044f90: 0a20 2020 2072 6574 7572 6e20 720a 0a0a  .    return r...
-00044fa0: 6465 6620 6d61 7962 655f 7368 6966 745f  def maybe_shift_
-00044fb0: 6469 7669 7369 6f6e 7328 6466 2c20 7065  divisions(df, pe
-00044fc0: 7269 6f64 732c 2066 7265 7129 3a0a 2020  riods, freq):.  
-00044fd0: 2020 2222 224d 6179 6265 2073 6869 6674    """Maybe shift
-00044fe0: 2064 6976 6973 696f 6e73 2062 7920 7065   divisions by pe
-00044ff0: 7269 6f64 7320 6f66 2073 697a 6520 6672  riods of size fr
-00045000: 6571 0a0a 2020 2020 5573 6564 2074 6f20  eq..    Used to 
-00045010: 7368 6966 7420 7468 6520 6469 7669 7369  shift the divisi
-00045020: 6f6e 7320 666f 7220 7468 6520 6073 6869  ons for the `shi
-00045030: 6674 6020 6d65 7468 6f64 2e20 4966 2066  ft` method. If f
-00045040: 7265 7120 6973 6e27 7420 6120 6669 7865  req isn't a fixe
-00045050: 640a 2020 2020 7369 7a65 2028 6e6f 7420  d.    size (not 
-00045060: 616e 6368 6f72 6564 206f 7220 7265 6c61  anchored or rela
-00045070: 7469 7665 292c 2074 6865 6e20 7468 6520  tive), then the 
-00045080: 6469 7669 7369 6f6e 7320 6172 6520 7368  divisions are sh
-00045090: 6966 7465 640a 2020 2020 6170 7072 6f70  ifted.    approp
-000450a0: 7269 6174 656c 792e 204f 7468 6572 7769  riately. Otherwi
-000450b0: 7365 2074 6865 2064 6976 6973 696f 6e73  se the divisions
-000450c0: 2061 7265 2063 6c65 6172 6564 2e0a 0a20   are cleared... 
-000450d0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-000450e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-000450f0: 2064 6620 3a20 6464 2e44 6174 6146 7261   df : dd.DataFra
-00045100: 6d65 2c20 6464 2e53 6572 6965 732c 206f  me, dd.Series, o
-00045110: 7220 6464 2e49 6e64 6578 0a20 2020 2070  r dd.Index.    p
-00045120: 6572 696f 6473 203a 2069 6e74 0a20 2020  eriods : int.   
-00045130: 2020 2020 2054 6865 206e 756d 6265 7220       The number 
-00045140: 6f66 2070 6572 696f 6473 2074 6f20 7368  of periods to sh
-00045150: 6966 742e 0a20 2020 2066 7265 7120 3a20  ift..    freq : 
-00045160: 4461 7465 4f66 6673 6574 2c20 7469 6d65  DateOffset, time
-00045170: 6465 6c74 612c 206f 7220 7469 6d65 2072  delta, or time r
-00045180: 756c 6520 7374 7269 6e67 0a20 2020 2020  ule string.     
-00045190: 2020 2054 6865 2066 7265 7175 656e 6379     The frequency
-000451a0: 2074 6f20 7368 6966 7420 6279 2e0a 2020   to shift by..  
-000451b0: 2020 2222 220a 2020 2020 6966 2069 7369    """.    if isi
-000451c0: 6e73 7461 6e63 6528 6672 6571 2c20 7374  nstance(freq, st
-000451d0: 7229 3a0a 2020 2020 2020 2020 6672 6571  r):.        freq
-000451e0: 203d 2070 642e 7473 6572 6965 732e 6672   = pd.tseries.fr
-000451f0: 6571 7565 6e63 6965 732e 746f 5f6f 6666  equencies.to_off
-00045200: 7365 7428 6672 6571 290a 0a20 2020 2069  set(freq)..    i
-00045210: 735f 6f66 6673 6574 203d 2069 7369 6e73  s_offset = isins
-00045220: 7461 6e63 6528 6672 6571 2c20 7064 2e44  tance(freq, pd.D
-00045230: 6174 654f 6666 7365 7429 0a20 2020 2069  ateOffset).    i
-00045240: 6620 6973 5f6f 6666 7365 743a 0a20 2020  f is_offset:.   
-00045250: 2020 2020 2069 6620 6672 6571 2e69 735f       if freq.is_
-00045260: 616e 6368 6f72 6564 2829 206f 7220 6e6f  anchored() or no
-00045270: 7420 6861 7361 7474 7228 6672 6571 2c20  t hasattr(freq, 
-00045280: 2264 656c 7461 2229 3a0a 2020 2020 2020  "delta"):.      
-00045290: 2020 2020 2020 2320 4361 6e27 7420 696e        # Can't in
-000452a0: 6665 7220 6469 7669 7369 6f6e 7320 6f6e  fer divisions on
-000452b0: 2072 656c 6174 6976 6520 6f72 2061 6e63   relative or anc
-000452c0: 686f 7265 6420 6f66 6673 6574 732c 2061  hored offsets, a
-000452d0: 730a 2020 2020 2020 2020 2020 2020 2320  s.            # 
-000452e0: 6469 7669 7369 6f6e 7320 6d61 7920 6e6f  divisions may no
-000452f0: 7720 7370 6c69 7420 6964 656e 7469 6361  w split identica
-00045300: 6c20 696e 6465 7820 7661 6c75 652e 0a20  l index value.. 
-00045310: 2020 2020 2020 2020 2020 2023 2028 652e             # (e.
-00045320: 672e 2069 6e64 6578 5f70 6172 7469 7469  g. index_partiti
-00045330: 6f6e 7320 3d20 5b5b 312c 2032 2c20 335d  ons = [[1, 2, 3]
-00045340: 2c20 5b33 2c20 342c 2035 5d5d 290a 2020  , [3, 4, 5]]).  
-00045350: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00045360: 2064 662e 636c 6561 725f 6469 7669 7369   df.clear_divisi
-00045370: 6f6e 7328 290a 2020 2020 6966 2064 662e  ons().    if df.
-00045380: 6b6e 6f77 6e5f 6469 7669 7369 6f6e 733a  known_divisions:
-00045390: 0a20 2020 2020 2020 2064 6976 7320 3d20  .        divs = 
-000453a0: 7064 2e53 6572 6965 7328 7261 6e67 6528  pd.Series(range(
-000453b0: 6c65 6e28 6466 2e64 6976 6973 696f 6e73  len(df.divisions
-000453c0: 2929 2c20 696e 6465 783d 6466 2e64 6976  )), index=df.div
-000453d0: 6973 696f 6e73 290a 2020 2020 2020 2020  isions).        
-000453e0: 6469 7669 7369 6f6e 7320 3d20 6469 7673  divisions = divs
-000453f0: 2e73 6869 6674 2870 6572 696f 6473 2c20  .shift(periods, 
-00045400: 6672 6571 3d66 7265 7129 2e69 6e64 6578  freq=freq).index
-00045410: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00045420: 6466 2e5f 5f63 6c61 7373 5f5f 2864 662e  df.__class__(df.
-00045430: 6461 736b 2c20 6466 2e5f 6e61 6d65 2c20  dask, df._name, 
-00045440: 6466 2e5f 6d65 7461 2c20 6469 7669 7369  df._meta, divisi
-00045450: 6f6e 7329 0a20 2020 2072 6574 7572 6e20  ons).    return 
-00045460: 6466 0a0a 0a40 7772 6170 7328 7064 2e74  df...@wraps(pd.t
-00045470: 6f5f 6461 7465 7469 6d65 290a 6465 6620  o_datetime).def 
-00045480: 746f 5f64 6174 6574 696d 6528 6172 672c  to_datetime(arg,
-00045490: 206d 6574 613d 4e6f 6e65 2c20 2a2a 6b77   meta=None, **kw
-000454a0: 6172 6773 293a 0a20 2020 2074 7a5f 6b77  args):.    tz_kw
-000454b0: 6172 6720 3d20 7b22 747a 223a 2022 7574  arg = {"tz": "ut
-000454c0: 6322 7d20 6966 206b 7761 7267 732e 6765  c"} if kwargs.ge
-000454d0: 7428 2275 7463 2229 2065 6c73 6520 7b7d  t("utc") else {}
-000454e0: 0a20 2020 2069 6620 6d65 7461 2069 7320  .    if meta is 
-000454f0: 4e6f 6e65 3a0a 2020 2020 2020 2020 6966  None:.        if
-00045500: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
-00045510: 2049 6e64 6578 293a 0a20 2020 2020 2020   Index):.       
-00045520: 2020 2020 206d 6574 6120 3d20 7064 2e44       meta = pd.D
-00045530: 6174 6574 696d 6549 6e64 6578 285b 5d2c  atetimeIndex([],
-00045540: 202a 2a74 7a5f 6b77 6172 6729 0a20 2020   **tz_kwarg).   
-00045550: 2020 2020 2020 2020 206d 6574 612e 6e61           meta.na
-00045560: 6d65 203d 2061 7267 2e6e 616d 650a 2020  me = arg.name.  
-00045570: 2020 2020 2020 656c 6966 206e 6f74 2028        elif not (
-00045580: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-00045590: 6528 6172 6729 206f 7220 6973 5f73 6572  e(arg) or is_ser
-000455a0: 6965 735f 6c69 6b65 2861 7267 2929 3a0a  ies_like(arg)):.
-000455b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-000455c0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-000455d0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-000455e0: 2020 2020 2020 2022 6461 736b 2e64 6174         "dask.dat
-000455f0: 6166 7261 6d65 2e74 6f5f 6461 7465 7469  aframe.to_dateti
-00045600: 6d65 2064 6f65 7320 6e6f 7420 7375 7070  me does not supp
-00045610: 6f72 7420 220a 2020 2020 2020 2020 2020  ort ".          
-00045620: 2020 2020 2020 226e 6f6e 2d69 6e64 6578        "non-index
-00045630: 2d61 626c 6520 6172 6775 6d65 6e74 7320  -able arguments 
-00045640: 286c 696b 6520 7363 616c 6172 7329 220a  (like scalars)".
-00045650: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00045660: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00045670: 2020 2020 2020 2020 6d65 7461 203d 206d          meta = m
-00045680: 6574 615f 7365 7269 6573 5f63 6f6e 7374  eta_series_const
-00045690: 7275 6374 6f72 2861 7267 2928 5b70 642e  ructor(arg)([pd.
-000456a0: 5469 6d65 7374 616d 7028 2232 3030 3022  Timestamp("2000"
-000456b0: 2c20 2a2a 747a 5f6b 7761 7267 295d 290a  , **tz_kwarg)]).
-000456c0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-000456d0: 2e69 6e64 6578 203d 206d 6574 612e 696e  .index = meta.in
-000456e0: 6465 782e 6173 7479 7065 2861 7267 2e69  dex.astype(arg.i
-000456f0: 6e64 6578 2e64 7479 7065 290a 2020 2020  ndex.dtype).    
-00045700: 2020 2020 2020 2020 6d65 7461 2e69 6e64          meta.ind
-00045710: 6578 2e6e 616d 6520 3d20 6172 672e 696e  ex.name = arg.in
-00045720: 6465 782e 6e61 6d65 0a20 2020 2069 6620  dex.name.    if 
-00045730: 5041 4e44 4153 5f47 545f 3230 3020 616e  PANDAS_GT_200 an
-00045740: 6420 2269 6e66 6572 5f64 6174 6574 696d  d "infer_datetim
-00045750: 655f 666f 726d 6174 2220 696e 206b 7761  e_format" in kwa
-00045760: 7267 733a 0a20 2020 2020 2020 2077 6172  rgs:.        war
-00045770: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-00045780: 2020 2020 2020 2020 2254 6865 2061 7267          "The arg
-00045790: 756d 656e 7420 2769 6e66 6572 5f64 6174  ument 'infer_dat
-000457a0: 6574 696d 655f 666f 726d 6174 2720 6973  etime_format' is
-000457b0: 2064 6570 7265 6361 7465 6420 616e 6420   deprecated and 
-000457c0: 7769 6c6c 2062 6520 7265 6d6f 7665 6420  will be removed 
-000457d0: 696e 2061 2066 7574 7572 6520 7665 7273  in a future vers
-000457e0: 696f 6e2e 2022 0a20 2020 2020 2020 2020  ion. ".         
-000457f0: 2020 2022 4120 7374 7269 6374 2076 6572     "A strict ver
-00045800: 7369 6f6e 206f 6620 6974 2069 7320 6e6f  sion of it is no
-00045810: 7720 7468 6520 6465 6661 756c 742c 2073  w the default, s
-00045820: 6565 2022 0a20 2020 2020 2020 2020 2020  ee ".           
-00045830: 2022 6874 7470 733a 2f2f 7061 6e64 6173   "https://pandas
-00045840: 2e70 7964 6174 612e 6f72 672f 7064 6570  .pydata.org/pdep
-00045850: 732f 3030 3034 2d63 6f6e 7369 7374 656e  s/0004-consisten
-00045860: 742d 746f 2d64 6174 6574 696d 652d 7061  t-to-datetime-pa
-00045870: 7273 696e 672e 6874 6d6c 2e20 220a 2020  rsing.html. ".  
-00045880: 2020 2020 2020 2020 2020 2259 6f75 2063            "You c
-00045890: 616e 2073 6166 656c 7920 7265 6d6f 7665  an safely remove
-000458a0: 2074 6869 7320 6172 6775 6d65 6e74 2e22   this argument."
-000458b0: 2c0a 2020 2020 2020 2020 2020 2020 5573  ,.            Us
-000458c0: 6572 5761 726e 696e 672c 0a20 2020 2020  erWarning,.     
-000458d0: 2020 2029 0a20 2020 2020 2020 206b 7761     ).        kwa
-000458e0: 7267 732e 706f 7028 2269 6e66 6572 5f64  rgs.pop("infer_d
-000458f0: 6174 6574 696d 655f 666f 726d 6174 2229  atetime_format")
-00045900: 0a0a 2020 2020 7265 7475 726e 206d 6170  ..    return map
-00045910: 5f70 6172 7469 7469 6f6e 7328 7064 2e74  _partitions(pd.t
-00045920: 6f5f 6461 7465 7469 6d65 2c20 6172 672c  o_datetime, arg,
-00045930: 206d 6574 613d 6d65 7461 2c20 2a2a 6b77   meta=meta, **kw
-00045940: 6172 6773 290a 0a0a 4077 7261 7073 2870  args)...@wraps(p
-00045950: 642e 746f 5f74 696d 6564 656c 7461 290a  d.to_timedelta).
-00045960: 6465 6620 746f 5f74 696d 6564 656c 7461  def to_timedelta
-00045970: 2861 7267 2c20 756e 6974 3d4e 6f6e 652c  (arg, unit=None,
-00045980: 2065 7272 6f72 733d 2272 6169 7365 2229   errors="raise")
-00045990: 3a0a 2020 2020 6d65 7461 203d 206d 6574  :.    meta = met
-000459a0: 615f 7365 7269 6573 5f63 6f6e 7374 7275  a_series_constru
-000459b0: 6374 6f72 2861 7267 2928 5b70 642e 5469  ctor(arg)([pd.Ti
-000459c0: 6d65 6465 6c74 6128 312c 2075 6e69 743d  medelta(1, unit=
-000459d0: 756e 6974 295d 290a 2020 2020 7265 7475  unit)]).    retu
-000459e0: 726e 206d 6170 5f70 6172 7469 7469 6f6e  rn map_partition
-000459f0: 7328 7064 2e74 6f5f 7469 6d65 6465 6c74  s(pd.to_timedelt
-00045a00: 612c 2061 7267 2c20 756e 6974 3d75 6e69  a, arg, unit=uni
-00045a10: 742c 2065 7272 6f72 733d 6572 726f 7273  t, errors=errors
-00045a20: 2c20 6d65 7461 3d6d 6574 6129 0a0a 0a69  , meta=meta)...i
-00045a30: 6620 6861 7361 7474 7228 7064 2c20 2269  f hasattr(pd, "i
-00045a40: 736e 6122 293a 0a0a 2020 2020 4077 7261  sna"):..    @wra
-00045a50: 7073 2870 642e 6973 6e61 290a 2020 2020  ps(pd.isna).    
-00045a60: 6465 6620 6973 6e61 2861 7267 293a 0a20  def isna(arg):. 
-00045a70: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
-00045a80: 705f 7061 7274 6974 696f 6e73 2870 642e  p_partitions(pd.
-00045a90: 6973 6e61 2c20 6172 6729 0a0a 0a64 6566  isna, arg)...def
-00045aa0: 205f 7265 7072 5f64 6174 615f 7365 7269   _repr_data_seri
-00045ab0: 6573 2873 2c20 696e 6465 7829 3a0a 2020  es(s, index):.  
-00045ac0: 2020 2222 2241 2068 656c 7065 7220 666f    """A helper fo
-00045ad0: 7220 6372 6561 7469 6e67 2074 6865 2060  r creating the `
-00045ae0: 605f 7265 7072 5f64 6174 6160 6020 7072  `_repr_data`` pr
-00045af0: 6f70 6572 7479 2222 220a 2020 2020 6e70  operty""".    np
-00045b00: 6172 7469 7469 6f6e 7320 3d20 6c65 6e28  artitions = len(
-00045b10: 696e 6465 7829 202d 2031 0a20 2020 2069  index) - 1.    i
-00045b20: 6620 6973 696e 7374 616e 6365 2873 2e64  f isinstance(s.d
-00045b30: 7479 7065 2c20 7064 2e43 6174 6567 6f72  type, pd.Categor
-00045b40: 6963 616c 4474 7970 6529 3a0a 2020 2020  icalDtype):.    
-00045b50: 2020 2020 6966 2068 6173 5f6b 6e6f 776e      if has_known
-00045b60: 5f63 6174 6567 6f72 6965 7328 7329 3a0a  _categories(s):.
-00045b70: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-00045b80: 6520 3d20 2263 6174 6567 6f72 795b 6b6e  e = "category[kn
-00045b90: 6f77 6e5d 220a 2020 2020 2020 2020 656c  own]".        el
-00045ba0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00045bb0: 6474 7970 6520 3d20 2263 6174 6567 6f72  dtype = "categor
-00045bc0: 795b 756e 6b6e 6f77 6e5d 220a 2020 2020  y[unknown]".    
-00045bd0: 656c 7365 3a0a 2020 2020 2020 2020 6474  else:.        dt
-00045be0: 7970 6520 3d20 7374 7228 732e 6474 7970  ype = str(s.dtyp
-00045bf0: 6529 0a20 2020 2072 6574 7572 6e20 7064  e).    return pd
-00045c00: 2e53 6572 6965 7328 5b64 7479 7065 5d20  .Series([dtype] 
-00045c10: 2b20 5b22 2e2e 2e22 5d20 2a20 6e70 6172  + ["..."] * npar
-00045c20: 7469 7469 6f6e 732c 2069 6e64 6578 3d69  titions, index=i
-00045c30: 6e64 6578 2c20 6e61 6d65 3d73 2e6e 616d  ndex, name=s.nam
-00045c40: 6529 0a0a 0a64 6566 2068 6173 5f70 6172  e)...def has_par
-00045c50: 616c 6c65 6c5f 7479 7065 2878 293a 0a20  allel_type(x):. 
-00045c60: 2020 2022 2222 446f 6573 2074 6869 7320     """Does this 
-00045c70: 6f62 6a65 6374 2068 6176 6520 6120 6461  object have a da
-00045c80: 736b 2064 6174 6166 7261 6d65 2065 7175  sk dataframe equ
-00045c90: 6976 616c 656e 743f 2222 220a 2020 2020  ivalent?""".    
-00045ca0: 7265 7475 726e 2067 6574 5f70 6172 616c  return get_paral
-00045cb0: 6c65 6c5f 7479 7065 2878 2920 6973 206e  lel_type(x) is n
-00045cc0: 6f74 2053 6361 6c61 720a 0a0a 6465 6620  ot Scalar...def 
-00045cd0: 6e65 775f 6464 5f6f 626a 6563 7428 6473  new_dd_object(ds
-00045ce0: 6b2c 206e 616d 652c 206d 6574 612c 2064  k, name, meta, d
-00045cf0: 6976 6973 696f 6e73 2c20 7061 7265 6e74  ivisions, parent
-00045d00: 5f6d 6574 613d 4e6f 6e65 293a 0a20 2020  _meta=None):.   
-00045d10: 2022 2222 4765 6e65 7269 6320 636f 6e73   """Generic cons
-00045d20: 7472 7563 746f 7220 666f 7220 6461 736b  tructor for dask
-00045d30: 2e64 6174 6166 7261 6d65 206f 626a 6563  .dataframe objec
-00045d40: 7473 2e0a 0a20 2020 2044 6563 6964 6573  ts...    Decides
-00045d50: 2074 6865 2061 7070 726f 7072 6961 7465   the appropriate
-00045d60: 206f 7574 7075 7420 636c 6173 7320 6261   output class ba
-00045d70: 7365 6420 6f6e 2074 6865 2074 7970 6520  sed on the type 
-00045d80: 6f66 2060 6d65 7461 6020 7072 6f76 6964  of `meta` provid
-00045d90: 6564 2e0a 2020 2020 2222 220a 2020 2020  ed..    """.    
-00045da0: 6966 2068 6173 5f70 6172 616c 6c65 6c5f  if has_parallel_
-00045db0: 7479 7065 286d 6574 6129 3a0a 2020 2020  type(meta):.    
-00045dc0: 2020 2020 7265 7475 726e 2067 6574 5f70      return get_p
-00045dd0: 6172 616c 6c65 6c5f 7479 7065 286d 6574  arallel_type(met
-00045de0: 6129 2864 736b 2c20 6e61 6d65 2c20 6d65  a)(dsk, name, me
-00045df0: 7461 2c20 6469 7669 7369 6f6e 7329 0a20  ta, divisions). 
-00045e00: 2020 2065 6c69 6620 6973 5f61 7272 6179     elif is_array
-00045e10: 6c69 6b65 286d 6574 6129 2061 6e64 206d  like(meta) and m
-00045e20: 6574 612e 7368 6170 653a 0a20 2020 2020  eta.shape:.     
-00045e30: 2020 2069 6d70 6f72 7420 6461 736b 2e61     import dask.a
-00045e40: 7272 6179 2061 7320 6461 0a0a 2020 2020  rray as da..    
-00045e50: 2020 2020 6368 756e 6b73 203d 2028 286e      chunks = ((n
-00045e60: 702e 6e61 6e2c 2920 2a20 286c 656e 2864  p.nan,) * (len(d
-00045e70: 6976 6973 696f 6e73 2920 2d20 3129 2c29  ivisions) - 1),)
-00045e80: 202b 2074 7570 6c65 280a 2020 2020 2020   + tuple(.      
-00045e90: 2020 2020 2020 2864 2c29 2066 6f72 2064        (d,) for d
-00045ea0: 2069 6e20 6d65 7461 2e73 6861 7065 5b31   in meta.shape[1
-00045eb0: 3a5d 0a20 2020 2020 2020 2029 0a20 2020  :].        ).   
-00045ec0: 2020 2020 2069 6620 6c65 6e28 6368 756e       if len(chun
-00045ed0: 6b73 2920 3e20 313a 0a20 2020 2020 2020  ks) > 1:.       
-00045ee0: 2020 2020 206c 6179 6572 203d 2064 736b       layer = dsk
-00045ef0: 2e6c 6179 6572 735b 6e61 6d65 5d0a 2020  .layers[name].  
-00045f00: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00045f10: 6e73 7461 6e63 6528 6c61 7965 722c 2042  nstance(layer, B
-00045f20: 6c6f 636b 7769 7365 293a 0a20 2020 2020  lockwise):.     
-00045f30: 2020 2020 2020 2020 2020 206c 6179 6572             layer
-00045f40: 2e6e 6577 5f61 7865 735b 226a 225d 203d  .new_axes["j"] =
-00045f50: 2063 6875 6e6b 735b 315d 5b30 5d0a 2020   chunks[1][0].  
-00045f60: 2020 2020 2020 2020 2020 2020 2020 6c61                la
-00045f70: 7965 722e 6f75 7470 7574 5f69 6e64 6963  yer.output_indic
-00045f80: 6573 203d 206c 6179 6572 2e6f 7574 7075  es = layer.outpu
-00045f90: 745f 696e 6469 6365 7320 2b20 2822 6a22  t_indices + ("j"
-00045fa0: 2c29 0a20 2020 2020 2020 2020 2020 2065  ,).            e
-00045fb0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00045fc0: 2020 2020 2073 7566 6669 7820 3d20 2830       suffix = (0
-00045fd0: 2c29 202a 2028 6c65 6e28 6368 756e 6b73  ,) * (len(chunks
-00045fe0: 2920 2d20 3129 0a20 2020 2020 2020 2020  ) - 1).         
-00045ff0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00046000: 7261 6e67 6528 6c65 6e28 6368 756e 6b73  range(len(chunks
-00046010: 5b30 5d29 293a 0a20 2020 2020 2020 2020  [0])):.         
-00046020: 2020 2020 2020 2020 2020 206c 6179 6572             layer
-00046030: 5b28 6e61 6d65 2c20 6929 202b 2073 7566  [(name, i) + suf
-00046040: 6669 785d 203d 206c 6179 6572 2e70 6f70  fix] = layer.pop
-00046050: 2828 6e61 6d65 2c20 6929 290a 2020 2020  ((name, i)).    
-00046060: 2020 2020 7265 7475 726e 2064 612e 4172      return da.Ar
-00046070: 7261 7928 6473 6b2c 206e 616d 653d 6e61  ray(dsk, name=na
-00046080: 6d65 2c20 6368 756e 6b73 3d63 6875 6e6b  me, chunks=chunk
-00046090: 732c 2064 7479 7065 3d6d 6574 612e 6474  s, dtype=meta.dt
-000460a0: 7970 6529 0a20 2020 2065 6c73 653a 0a20  ype).    else:. 
-000460b0: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
-000460c0: 745f 7061 7261 6c6c 656c 5f74 7970 6528  t_parallel_type(
-000460d0: 6d65 7461 2928 6473 6b2c 206e 616d 652c  meta)(dsk, name,
-000460e0: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
-000460f0: 290a 0a0a 6465 6620 7061 7274 6974 696f  )...def partitio
-00046100: 6e77 6973 655f 6772 6170 6828 6675 6e63  nwise_graph(func
-00046110: 2c20 6c61 7965 725f 6e61 6d65 2c20 2a61  , layer_name, *a
-00046120: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00046130: 2020 2020 2222 220a 2020 2020 4170 706c      """.    Appl
-00046140: 7920 6120 6675 6e63 7469 6f6e 2070 6172  y a function par
-00046150: 7469 7469 6f6e 2d77 6973 6520 6163 726f  tition-wise acro
-00046160: 7373 2061 7267 756d 656e 7473 2074 6f20  ss arguments to 
-00046170: 6372 6561 7465 206c 6179 6572 206f 6620  create layer of 
-00046180: 6120 6772 6170 680a 0a20 2020 2054 6869  a graph..    Thi
-00046190: 7320 6170 706c 6965 7320 6120 6675 6e63  s applies a func
-000461a0: 7469 6f6e 2c20 6060 6675 6e63 6060 2c20  tion, ``func``, 
-000461b0: 696e 2061 6e20 656d 6261 7272 6173 7369  in an embarrassi
-000461c0: 6e67 6c79 2070 6172 616c 6c65 6c20 6661  ngly parallel fa
-000461d0: 7368 696f 6e0a 2020 2020 6163 726f 7373  shion.    across
-000461e0: 2070 6172 7469 7469 6f6e 732f 6368 756e   partitions/chun
-000461f0: 6b73 2069 6e20 7468 6520 7072 6f76 6964  ks in the provid
-00046200: 6564 2061 7267 756d 656e 7473 2e20 2049  ed arguments.  I
-00046210: 7420 6861 6e64 6c65 7320 4461 7461 6672  t handles Datafr
-00046220: 616d 6573 2c0a 2020 2020 4172 7261 7973  ames,.    Arrays
-00046230: 2c20 616e 6420 7363 616c 6172 7320 736d  , and scalars sm
-00046240: 6f6f 7468 6c79 2c20 616e 6420 7265 6c69  oothly, and reli
-00046250: 6573 206f 6e20 7468 6520 6060 626c 6f63  es on the ``bloc
-00046260: 6b77 6973 6560 6020 6d61 6368 696e 6572  kwise`` machiner
-00046270: 790a 2020 2020 746f 2070 726f 7669 6465  y.    to provide
-00046280: 2061 206e 6963 656c 7920 7379 6d62 6f6c   a nicely symbol
-00046290: 6963 2067 7261 7068 2e0a 0a20 2020 2049  ic graph...    I
-000462a0: 7420 6973 206d 6f73 7420 636f 6d6d 6f6e  t is most common
-000462b0: 6c79 2075 7365 6420 696e 206f 7468 6572  ly used in other
-000462c0: 2067 7261 7068 2d62 7569 6c64 696e 6720   graph-building 
-000462d0: 6675 6e63 7469 6f6e 7320 746f 2063 7265  functions to cre
-000462e0: 6174 6520 7468 650a 2020 2020 6170 7072  ate the.    appr
-000462f0: 6f70 7269 6174 6520 6c61 7965 7220 6f66  opriate layer of
-00046300: 2074 6865 2072 6573 756c 7469 6e67 2064   the resulting d
-00046310: 6174 6166 7261 6d65 2e0a 0a20 2020 2050  ataframe...    P
-00046320: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00046330: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066 756e  --------.    fun
-00046340: 633a 2063 616c 6c61 626c 650a 2020 2020  c: callable.    
-00046350: 6c61 7965 725f 6e61 6d65 3a20 7374 720a  layer_name: str.
-00046360: 2020 2020 2020 2020 4465 7363 7269 7074          Descript
-00046370: 6976 6520 6e61 6d65 2066 6f72 2074 6865  ive name for the
-00046380: 206f 7065 7261 7469 6f6e 2e20 5573 6564   operation. Used
-00046390: 2061 7320 7468 6520 6f75 7470 7574 206e   as the output n
-000463a0: 616d 650a 2020 2020 2020 2020 696e 2074  ame.        in t
-000463b0: 6865 2072 6573 756c 7469 6e67 2060 6042  he resulting ``B
-000463c0: 6c6f 636b 7769 7365 6060 2067 7261 7068  lockwise`` graph
-000463d0: 206c 6179 6572 2e0a 2020 2020 2a61 7267   layer..    *arg
-000463e0: 733a 0a20 2020 202a 2a6b 7761 7267 733a  s:.    **kwargs:
-000463f0: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
-00046400: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6f75    -------.    ou
-00046410: 743a 2042 6c6f 636b 7769 7365 2067 7261  t: Blockwise gra
-00046420: 7068 0a0a 2020 2020 4578 616d 706c 6573  ph..    Examples
-00046430: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-00046440: 2020 3e3e 3e20 7375 6267 7261 7068 203d    >>> subgraph =
-00046450: 2070 6172 7469 7469 6f6e 7769 7365 5f67   partitionwise_g
-00046460: 7261 7068 2866 756e 6374 696f 6e2c 2078  raph(function, x
-00046470: 2c20 792c 207a 3d31 3233 2920 2023 2064  , y, z=123)  # d
-00046480: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
-00046490: 2020 3e3e 3e20 6c61 7965 7220 3d20 7061    >>> layer = pa
-000464a0: 7274 6974 696f 6e77 6973 655f 6772 6170  rtitionwise_grap
-000464b0: 6828 6675 6e63 7469 6f6e 2c20 6466 2c20  h(function, df, 
-000464c0: 782c 207a 3d31 3233 2920 2023 2064 6f63  x, z=123)  # doc
-000464d0: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
-000464e0: 3e3e 3e20 6772 6170 6820 3d20 4869 6768  >>> graph = High
-000464f0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-00046500: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
-00046510: 2c20 6c61 7965 722c 2064 6570 656e 6465  , layer, depende
-00046520: 6e63 6965 733d 5b64 662c 2078 5d29 2020  ncies=[df, x])  
-00046530: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-00046540: 0a20 2020 203e 3e3e 2072 6573 756c 7420  .    >>> result 
-00046550: 3d20 6e65 775f 6464 5f6f 626a 6563 7428  = new_dd_object(
-00046560: 6772 6170 682c 206e 616d 652c 206d 6574  graph, name, met
-00046570: 6164 6174 612c 2064 662e 6469 7669 7369  adata, df.divisi
-00046580: 6f6e 7329 2020 2320 646f 6374 6573 743a  ons)  # doctest:
-00046590: 202b 534b 4950 0a0a 2020 2020 5365 6520   +SKIP..    See 
-000465a0: 416c 736f 0a20 2020 202d 2d2d 2d2d 2d2d  Also.    -------
-000465b0: 2d0a 2020 2020 6d61 705f 7061 7274 6974  -.    map_partit
-000465c0: 696f 6e73 0a20 2020 2022 2222 0a20 2020  ions.    """.   
-000465d0: 2070 6169 7273 203d 205b 5d0a 2020 2020   pairs = [].    
-000465e0: 6e75 6d62 6c6f 636b 7320 3d20 7b7d 0a20  numblocks = {}. 
-000465f0: 2020 2066 6f72 2061 7267 2069 6e20 6172     for arg in ar
-00046600: 6773 3a0a 2020 2020 2020 2020 6966 2069  gs:.        if i
-00046610: 7369 6e73 7461 6e63 6528 6172 672c 205f  sinstance(arg, _
-00046620: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
-00046630: 2020 2020 7061 6972 732e 6578 7465 6e64      pairs.extend
-00046640: 285b 6172 672e 5f6e 616d 652c 2022 6922  ([arg._name, "i"
-00046650: 5d29 0a20 2020 2020 2020 2020 2020 206e  ]).            n
-00046660: 756d 626c 6f63 6b73 5b61 7267 2e5f 6e61  umblocks[arg._na
-00046670: 6d65 5d20 3d20 2861 7267 2e6e 7061 7274  me] = (arg.npart
-00046680: 6974 696f 6e73 2c29 0a20 2020 2020 2020  itions,).       
-00046690: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-000466a0: 2861 7267 2c20 5363 616c 6172 293a 0a20  (arg, Scalar):. 
-000466b0: 2020 2020 2020 2020 2020 2070 6169 7273             pairs
-000466c0: 2e65 7874 656e 6428 5b61 7267 2e5f 6e61  .extend([arg._na
-000466d0: 6d65 2c20 2269 225d 290a 2020 2020 2020  me, "i"]).      
-000466e0: 2020 2020 2020 6e75 6d62 6c6f 636b 735b        numblocks[
-000466f0: 6172 672e 5f6e 616d 655d 203d 2028 312c  arg._name] = (1,
-00046700: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-00046710: 7369 6e73 7461 6e63 6528 6172 672c 2041  sinstance(arg, A
-00046720: 7272 6179 293a 0a20 2020 2020 2020 2020  rray):.         
-00046730: 2020 2069 6620 6172 672e 6e64 696d 203d     if arg.ndim =
-00046740: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00046750: 2020 2020 2070 6169 7273 2e65 7874 656e       pairs.exten
-00046760: 6428 5b61 7267 2e6e 616d 652c 2022 6922  d([arg.name, "i"
-00046770: 5d29 0a20 2020 2020 2020 2020 2020 2065  ]).            e
-00046780: 6c69 6620 6172 672e 6e64 696d 203d 3d20  lif arg.ndim == 
-00046790: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-000467a0: 2020 2070 6169 7273 2e65 7874 656e 6428     pairs.extend(
-000467b0: 5b61 7267 2e6e 616d 652c 2022 225d 290a  [arg.name, ""]).
-000467c0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000467d0: 2061 7267 2e6e 6469 6d20 3d3d 2032 3a0a   arg.ndim == 2:.
-000467e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000467f0: 7061 6972 732e 6578 7465 6e64 285b 6172  pairs.extend([ar
-00046800: 672e 6e61 6d65 2c20 2269 6a22 5d29 0a20  g.name, "ij"]). 
-00046810: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00046820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00046830: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00046840: 7228 2243 616e 2774 2061 6464 206d 756c  r("Can't add mul
-00046850: 7469 2d64 696d 656e 7369 6f6e 616c 2061  ti-dimensional a
-00046860: 7272 6179 2074 6f20 6461 7461 6672 616d  rray to datafram
-00046870: 6573 2229 0a20 2020 2020 2020 2020 2020  es").           
-00046880: 206e 756d 626c 6f63 6b73 5b61 7267 2e5f   numblocks[arg._
-00046890: 6e61 6d65 5d20 3d20 6172 672e 6e75 6d62  name] = arg.numb
-000468a0: 6c6f 636b 730a 2020 2020 2020 2020 656c  locks.        el
-000468b0: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
-000468c0: 672c 2042 6c6f 636b 7769 7365 4465 7029  g, BlockwiseDep)
-000468d0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-000468e0: 206c 656e 2861 7267 2e6e 756d 626c 6f63   len(arg.numbloc
-000468f0: 6b73 2920 3d3d 2031 3a0a 2020 2020 2020  ks) == 1:.      
-00046900: 2020 2020 2020 2020 2020 7061 6972 732e            pairs.
-00046910: 6578 7465 6e64 285b 6172 672c 2022 6922  extend([arg, "i"
-00046920: 5d29 0a20 2020 2020 2020 2020 2020 2065  ]).            e
-00046930: 6c69 6620 6c65 6e28 6172 672e 6e75 6d62  lif len(arg.numb
-00046940: 6c6f 636b 7329 203d 3d20 323a 0a20 2020  locks) == 2:.   
-00046950: 2020 2020 2020 2020 2020 2020 2070 6169               pai
-00046960: 7273 2e65 7874 656e 6428 5b61 7267 2c20  rs.extend([arg, 
-00046970: 2269 6a22 5d29 0a20 2020 2020 2020 2020  "ij"]).         
-00046980: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00046990: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-000469a0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-000469b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000469c0: 2242 6c6f 636b 7769 7365 4465 7020 6172  "BlockwiseDep ar
-000469d0: 6720 7b61 7267 2172 7d20 6861 7320 7b6c  g {arg!r} has {l
-000469e0: 656e 2861 7267 2e6e 756d 626c 6f63 6b73  en(arg.numblocks
-000469f0: 297d 2064 696d 656e 7369 6f6e 733b 206f  )} dimensions; o
-00046a00: 6e6c 7920 3120 6f72 2032 2061 7265 2073  nly 1 or 2 are s
-00046a10: 7570 706f 7274 6564 2e22 0a20 2020 2020  upported.".     
-00046a20: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00046a30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00046a40: 2020 2020 2020 2070 6169 7273 2e65 7874         pairs.ext
-00046a50: 656e 6428 5b61 7267 2c20 4e6f 6e65 5d29  end([arg, None])
-00046a60: 0a20 2020 2072 6574 7572 6e20 626c 6f63  .    return bloc
-00046a70: 6b77 6973 6528 0a20 2020 2020 2020 2066  kwise(.        f
-00046a80: 756e 632c 206c 6179 6572 5f6e 616d 652c  unc, layer_name,
-00046a90: 2022 6922 2c20 2a70 6169 7273 2c20 6e75   "i", *pairs, nu
-00046aa0: 6d62 6c6f 636b 733d 6e75 6d62 6c6f 636b  mblocks=numblock
-00046ab0: 732c 2063 6f6e 6361 7465 6e61 7465 3d54  s, concatenate=T
-00046ac0: 7275 652c 202a 2a6b 7761 7267 730a 2020  rue, **kwargs.  
-00046ad0: 2020 290a 0a0a 6465 6620 6d65 7461 5f77    )...def meta_w
-00046ae0: 6172 6e69 6e67 2864 6629 3a0a 2020 2020  arning(df):.    
-00046af0: 2222 220a 2020 2020 5072 6f76 6964 6520  """.    Provide 
-00046b00: 616e 2069 6e66 6f72 6d61 7469 7665 206d  an informative m
-00046b10: 6573 7361 6765 2077 6865 6e20 7468 6520  essage when the 
-00046b20: 7573 6572 2069 7320 6173 6b65 6420 746f  user is asked to
-00046b30: 2070 726f 7669 6465 206d 6574 6164 6174   provide metadat
-00046b40: 610a 2020 2020 2222 220a 2020 2020 6966  a.    """.    if
-00046b50: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
-00046b60: 6b65 2864 6629 3a0a 2020 2020 2020 2020  ke(df):.        
-00046b70: 6d65 7461 5f73 7472 203d 207b 6b3a 2073  meta_str = {k: s
-00046b80: 7472 2876 2920 666f 7220 6b2c 2076 2069  tr(v) for k, v i
-00046b90: 6e20 6466 2e64 7479 7065 732e 746f 5f64  n df.dtypes.to_d
-00046ba0: 6963 7428 292e 6974 656d 7328 297d 0a20  ict().items()}. 
-00046bb0: 2020 2065 6c69 6620 6973 5f73 6572 6965     elif is_serie
-00046bc0: 735f 6c69 6b65 2864 6629 3a0a 2020 2020  s_like(df):.    
-00046bd0: 2020 2020 6d65 7461 5f73 7472 203d 2028      meta_str = (
-00046be0: 6466 2e6e 616d 652c 2073 7472 2864 662e  df.name, str(df.
-00046bf0: 6474 7970 6529 290a 2020 2020 656c 7365  dtype)).    else
-00046c00: 3a0a 2020 2020 2020 2020 6d65 7461 5f73  :.        meta_s
-00046c10: 7472 203d 204e 6f6e 650a 2020 2020 6d73  tr = None.    ms
-00046c20: 6720 3d20 280a 2020 2020 2020 2020 225c  g = (.        "\
-00046c30: 6e59 6f75 2064 6964 206e 6f74 2070 726f  nYou did not pro
-00046c40: 7669 6465 206d 6574 6164 6174 612c 2073  vide metadata, s
-00046c50: 6f20 4461 736b 2069 7320 7275 6e6e 696e  o Dask is runnin
-00046c60: 6720 796f 7572 2022 0a20 2020 2020 2020  g your ".       
-00046c70: 2022 6675 6e63 7469 6f6e 206f 6e20 6120   "function on a 
-00046c80: 736d 616c 6c20 6461 7461 7365 7420 746f  small dataset to
-00046c90: 2067 7565 7373 206f 7574 7075 7420 7479   guess output ty
-00046ca0: 7065 732e 2022 0a20 2020 2020 2020 2022  pes. ".        "
-00046cb0: 4974 2069 7320 706f 7373 6962 6c65 2074  It is possible t
-00046cc0: 6861 7420 4461 736b 2077 696c 6c20 6775  hat Dask will gu
-00046cd0: 6573 7320 696e 636f 7272 6563 746c 792e  ess incorrectly.
-00046ce0: 5c6e 220a 2020 2020 2020 2020 2254 6f20  \n".        "To 
-00046cf0: 7072 6f76 6964 6520 616e 2065 7870 6c69  provide an expli
-00046d00: 6369 7420 6f75 7470 7574 2074 7970 6573  cit output types
-00046d10: 206f 7220 746f 2073 696c 656e 6365 2074   or to silence t
-00046d20: 6869 7320 6d65 7373 6167 652c 2022 0a20  his message, ". 
-00046d30: 2020 2020 2020 2022 706c 6561 7365 2070         "please p
-00046d40: 726f 7669 6465 2074 6865 2060 6d65 7461  rovide the `meta
-00046d50: 3d60 206b 6579 776f 7264 2c20 6173 2064  =` keyword, as d
-00046d60: 6573 6372 6962 6564 2069 6e20 7468 6520  escribed in the 
-00046d70: 6d61 7020 6f72 2022 0a20 2020 2020 2020  map or ".       
-00046d80: 2022 6170 706c 7920 6675 6e63 7469 6f6e   "apply function
-00046d90: 2074 6861 7420 796f 7520 6172 6520 7573   that you are us
-00046da0: 696e 672e 220a 2020 2020 290a 2020 2020  ing.".    ).    
-00046db0: 6966 206d 6574 615f 7374 723a 0a20 2020  if meta_str:.   
-00046dc0: 2020 2020 206d 7367 202b 3d20 280a 2020       msg += (.  
-00046dd0: 2020 2020 2020 2020 2020 225c 6e22 0a20            "\n". 
-00046de0: 2020 2020 2020 2020 2020 2022 2020 4265             "  Be
-00046df0: 666f 7265 3a20 2e61 7070 6c79 2866 756e  fore: .apply(fun
-00046e00: 6329 5c6e 220a 2020 2020 2020 2020 2020  c)\n".          
-00046e10: 2020 2220 2041 6674 6572 3a20 202e 6170    "  After:  .ap
-00046e20: 706c 7928 6675 6e63 2c20 6d65 7461 3d25  ply(func, meta=%
-00046e30: 7329 5c6e 2220 2520 7374 7228 6d65 7461  s)\n" % str(meta
-00046e40: 5f73 7472 290a 2020 2020 2020 2020 290a  _str).        ).
-00046e50: 2020 2020 7265 7475 726e 206d 7367 0a0a      return msg..
-00046e60: 0a64 6566 2070 7265 6669 785f 7265 6475  .def prefix_redu
-00046e70: 6374 696f 6e28 662c 2064 6466 2c20 6964  ction(f, ddf, id
-00046e80: 656e 7469 7479 2c20 2a2a 6b77 6172 6773  entity, **kwargs
-00046e90: 293a 0a20 2020 2022 2222 436f 6d70 7574  ):.    """Comput
-00046ea0: 6573 2074 6865 2070 7265 6669 7820 7375  es the prefix su
-00046eb0: 6d73 206f 6620 6620 6f6e 2064 660a 0a20  ms of f on df.. 
-00046ec0: 2020 2049 6620 6466 2068 6173 2070 6172     If df has par
-00046ed0: 7469 7469 6f6e 7320 5b50 312c 2050 322c  titions [P1, P2,
-00046ee0: 202e 2e2e 2c20 506e 5d2c 2074 6865 6e20   ..., Pn], then 
-00046ef0: 7265 7475 726e 7320 7468 6520 4461 7461  returns the Data
-00046f00: 4672 616d 6520 7769 7468 0a20 2020 2070  Frame with.    p
-00046f10: 6172 7469 7469 6f6e 7320 5b66 2869 6465  artitions [f(ide
-00046f20: 6e74 6974 792c 2050 3129 2c0a 2020 2020  ntity, P1),.    
-00046f30: 2020 2020 2020 2020 2020 2020 6628 6628              f(f(
-00046f40: 6964 656e 7469 7479 2c20 5031 292c 2050  identity, P1), P
-00046f50: 3229 2c0a 2020 2020 2020 2020 2020 2020  2),.            
-00046f60: 2020 2020 6628 6628 6628 6964 656e 7469      f(f(f(identi
-00046f70: 7479 2c20 5031 292c 2050 3229 2c20 5033  ty, P1), P2), P3
-00046f80: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00046f90: 2020 202e 2e2e 5d0a 0a20 2020 2050 6172     ...]..    Par
-00046fa0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-00046fb0: 2d2d 2d2d 2d2d 0a20 2020 2066 203a 2063  ------.    f : c
-00046fc0: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
-00046fd0: 616e 2061 7373 6f63 6961 7469 7665 2066  an associative f
-00046fe0: 756e 6374 696f 6e20 660a 2020 2020 6464  unction f.    dd
-00046ff0: 6620 3a20 6464 2e44 6174 6146 7261 6d65  f : dd.DataFrame
-00047000: 0a20 2020 2069 6465 6e74 6974 7920 3a20  .    identity : 
-00047010: 7064 2e44 6174 6146 7261 6d65 0a20 2020  pd.DataFrame.   
-00047020: 2020 2020 2061 6e20 6964 656e 7469 7479       an identity
-00047030: 2065 6c65 6d65 6e74 206f 6620 662c 2074   element of f, t
-00047040: 6861 7420 6973 2066 2869 6465 6e74 6974  hat is f(identit
-00047050: 792c 2064 6629 203d 2066 2864 662c 2069  y, df) = f(df, i
-00047060: 6465 6e74 6974 7929 203d 2064 660a 2020  dentity) = df.  
-00047070: 2020 2222 220a 2020 2020 6473 6b20 3d20    """.    dsk = 
-00047080: 6469 6374 2829 0a20 2020 206e 616d 6520  dict().    name 
-00047090: 3d20 2270 7265 6669 785f 7265 6475 6374  = "prefix_reduct
-000470a0: 696f 6e2d 2220 2b20 746f 6b65 6e69 7a65  ion-" + tokenize
-000470b0: 2866 2c20 6464 662c 2069 6465 6e74 6974  (f, ddf, identit
-000470c0: 792c 202a 2a6b 7761 7267 7329 0a20 2020  y, **kwargs).   
-000470d0: 206d 6574 6120 3d20 6464 662e 5f6d 6574   meta = ddf._met
-000470e0: 610a 2020 2020 6e20 3d20 6c65 6e28 6464  a.    n = len(dd
-000470f0: 662e 6469 7669 7369 6f6e 7329 202d 2031  f.divisions) - 1
-00047100: 0a20 2020 2064 6976 6973 696f 6e73 203d  .    divisions =
-00047110: 205b 4e6f 6e65 5d20 2a20 286e 202b 2031   [None] * (n + 1
-00047120: 290a 0a20 2020 204e 203d 2031 0a20 2020  )..    N = 1.   
-00047130: 2077 6869 6c65 204e 203c 206e 3a0a 2020   while N < n:.  
-00047140: 2020 2020 2020 4e20 2a3d 2032 0a20 2020        N *= 2.   
-00047150: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00047160: 6e29 3a0a 2020 2020 2020 2020 6473 6b5b  n):.        dsk[
-00047170: 286e 616d 652c 2069 2c20 312c 2030 295d  (name, i, 1, 0)]
-00047180: 203d 2028 6170 706c 792c 2066 2c20 5b28   = (apply, f, [(
-00047190: 6464 662e 5f6e 616d 652c 2069 292c 2069  ddf._name, i), i
-000471a0: 6465 6e74 6974 795d 2c20 6b77 6172 6773  dentity], kwargs
-000471b0: 290a 2020 2020 666f 7220 6920 696e 2072  ).    for i in r
-000471c0: 616e 6765 286e 2c20 4e29 3a0a 2020 2020  ange(n, N):.    
-000471d0: 2020 2020 6473 6b5b 286e 616d 652c 2069      dsk[(name, i
-000471e0: 2c20 312c 2030 295d 203d 2069 6465 6e74  , 1, 0)] = ident
-000471f0: 6974 790a 0a20 2020 2064 203d 2031 0a20  ity..    d = 1. 
-00047200: 2020 2077 6869 6c65 2064 203c 204e 3a0a     while d < N:.
-00047210: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00047220: 2072 616e 6765 2830 2c20 4e2c 2032 202a   range(0, N, 2 *
-00047230: 2064 293a 0a20 2020 2020 2020 2020 2020   d):.           
-00047240: 2064 736b 5b28 6e61 6d65 2c20 6920 2b20   dsk[(name, i + 
-00047250: 3220 2a20 6420 2d20 312c 2032 202a 2064  2 * d - 1, 2 * d
-00047260: 2c20 3029 5d20 3d20 280a 2020 2020 2020  , 0)] = (.      
-00047270: 2020 2020 2020 2020 2020 6170 706c 792c            apply,
-00047280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047290: 2066 2c0a 2020 2020 2020 2020 2020 2020   f,.            
-000472a0: 2020 2020 5b28 6e61 6d65 2c20 6920 2b20      [(name, i + 
-000472b0: 6420 2d20 312c 2064 2c20 3029 2c20 286e  d - 1, d, 0), (n
-000472c0: 616d 652c 2069 202b 2032 202a 2064 202d  ame, i + 2 * d -
-000472d0: 2031 2c20 642c 2030 295d 2c0a 2020 2020   1, d, 0)],.    
-000472e0: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
-000472f0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
-00047300: 290a 2020 2020 2020 2020 6420 2a3d 2032  ).        d *= 2
-00047310: 0a0a 2020 2020 6473 6b5b 286e 616d 652c  ..    dsk[(name,
-00047320: 204e 202d 2031 2c20 4e2c 2031 295d 203d   N - 1, N, 1)] =
-00047330: 2069 6465 6e74 6974 790a 0a20 2020 2077   identity..    w
-00047340: 6869 6c65 2064 203e 2031 3a0a 2020 2020  hile d > 1:.    
-00047350: 2020 2020 6420 2f2f 3d20 320a 2020 2020      d //= 2.    
-00047360: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00047370: 6765 2830 2c20 4e2c 2032 202a 2064 293a  ge(0, N, 2 * d):
-00047380: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
-00047390: 5b28 6e61 6d65 2c20 6920 2b20 6420 2d20  [(name, i + d - 
-000473a0: 312c 2064 2c20 3129 5d20 3d20 286e 616d  1, d, 1)] = (nam
-000473b0: 652c 2069 202b 2032 202a 2064 202d 2031  e, i + 2 * d - 1
-000473c0: 2c20 3220 2a20 642c 2031 290a 2020 2020  , 2 * d, 1).    
-000473d0: 2020 2020 2020 2020 6473 6b5b 286e 616d          dsk[(nam
-000473e0: 652c 2069 202b 2032 202a 2064 202d 2031  e, i + 2 * d - 1
-000473f0: 2c20 642c 2031 295d 203d 2028 0a20 2020  , d, 1)] = (.   
-00047400: 2020 2020 2020 2020 2020 2020 2061 7070               app
-00047410: 6c79 2c0a 2020 2020 2020 2020 2020 2020  ly,.            
-00047420: 2020 2020 662c 0a20 2020 2020 2020 2020      f,.         
-00047430: 2020 2020 2020 205b 286e 616d 652c 2069         [(name, i
-00047440: 202b 2032 202a 2064 202d 2031 2c20 3220   + 2 * d - 1, 2 
-00047450: 2a20 642c 2031 292c 2028 6e61 6d65 2c20  * d, 1), (name, 
-00047460: 6920 2b20 6420 2d20 312c 2064 2c20 3029  i + d - 1, d, 0)
-00047470: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00047480: 2020 206b 7761 7267 732c 0a20 2020 2020     kwargs,.     
-00047490: 2020 2020 2020 2029 0a0a 2020 2020 666f         )..    fo
-000474a0: 7220 6920 696e 2072 616e 6765 286e 293a  r i in range(n):
-000474b0: 0a20 2020 2020 2020 2064 736b 5b28 6e61  .        dsk[(na
-000474c0: 6d65 2c20 6929 5d20 3d20 2861 7070 6c79  me, i)] = (apply
-000474d0: 2c20 662c 205b 286e 616d 652c 2069 2c20  , f, [(name, i, 
-000474e0: 312c 2031 292c 2069 6465 6e74 6974 795d  1, 1), identity]
-000474f0: 2c20 6b77 6172 6773 290a 0a20 2020 2067  , kwargs)..    g
-00047500: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-00047510: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-00047520: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
-00047530: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
-00047540: 6464 665d 290a 2020 2020 7265 7475 726e  ddf]).    return
-00047550: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
-00047560: 7261 7068 2c20 6e61 6d65 2c20 6d65 7461  raph, name, meta
-00047570: 2c20 6469 7669 7369 6f6e 7329 0a0a 0a64  , divisions)...d
-00047580: 6566 2073 7566 6669 785f 7265 6475 6374  ef suffix_reduct
-00047590: 696f 6e28 662c 2064 6466 2c20 6964 656e  ion(f, ddf, iden
-000475a0: 7469 7479 2c20 2a2a 6b77 6172 6773 293a  tity, **kwargs):
-000475b0: 0a20 2020 2022 2222 436f 6d70 7574 6573  .    """Computes
-000475c0: 2074 6865 2073 7566 6669 7820 7375 6d73   the suffix sums
-000475d0: 206f 6620 6620 6f6e 2064 660a 0a20 2020   of f on df..   
-000475e0: 2049 6620 6466 2068 6173 2070 6172 7469   If df has parti
-000475f0: 7469 6f6e 7320 5b50 312c 2050 322c 202e  tions [P1, P2, .
-00047600: 2e2e 2c20 506e 5d2c 2074 6865 6e20 7265  .., Pn], then re
-00047610: 7475 726e 7320 7468 6520 4461 7461 4672  turns the DataFr
-00047620: 616d 6520 7769 7468 0a20 2020 2070 6172  ame with.    par
-00047630: 7469 7469 6f6e 7320 5b66 2850 312c 2066  titions [f(P1, f
-00047640: 2850 322c 202e 2e2e 6628 506e 2c20 6964  (P2, ...f(Pn, id
-00047650: 656e 7469 7479 292e 2e2e 2929 2c0a 2020  entity)...)),.  
-00047660: 2020 2020 2020 2020 2020 2020 2020 6628                f(
-00047670: 5032 2c20 2e2e 2e66 2850 6e2c 2069 6465  P2, ...f(Pn, ide
-00047680: 6e74 6974 7929 2e2e 2e29 2c0a 2020 2020  ntity)...),.    
-00047690: 2020 2020 2020 2020 2020 2020 2e2e 2e66              ...f
-000476a0: 2850 6e2c 2069 6465 6e74 6974 7929 2e2e  (Pn, identity)..
-000476b0: 2e2c 0a20 2020 2020 2020 2020 2020 2020  .,.             
-000476c0: 2020 202e 2e2e 5d0a 0a20 2020 2050 6172     ...]..    Par
-000476d0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-000476e0: 2d2d 2d2d 2d2d 0a20 2020 2066 203a 2063  ------.    f : c
-000476f0: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
-00047700: 616e 2061 7373 6f63 6961 7469 7665 2066  an associative f
-00047710: 756e 6374 696f 6e20 660a 2020 2020 6464  unction f.    dd
-00047720: 6620 3a20 6464 2e44 6174 6146 7261 6d65  f : dd.DataFrame
-00047730: 0a20 2020 2069 6465 6e74 6974 7920 3a20  .    identity : 
-00047740: 7064 2e44 6174 6146 7261 6d65 0a20 2020  pd.DataFrame.   
-00047750: 2020 2020 2061 6e20 6964 656e 7469 7479       an identity
-00047760: 2065 6c65 6d65 6e74 206f 6620 662c 2074   element of f, t
-00047770: 6861 7420 6973 2066 2869 6465 6e74 6974  hat is f(identit
-00047780: 792c 2064 6629 203d 2066 2864 662c 2069  y, df) = f(df, i
-00047790: 6465 6e74 6974 7929 203d 2064 660a 2020  dentity) = df.  
-000477a0: 2020 6b77 6172 6773 203a 203f 3f0a 2020    kwargs : ??.  
-000477b0: 2020 2020 2020 6b65 7977 6f72 6420 6172        keyword ar
-000477c0: 6775 6d65 6e74 7320 6f66 2066 203f 3f0a  guments of f ??.
-000477d0: 2020 2020 2222 220a 2020 2020 6473 6b20      """.    dsk 
-000477e0: 3d20 6469 6374 2829 0a20 2020 206e 616d  = dict().    nam
-000477f0: 6520 3d20 2273 7566 6669 785f 7265 6475  e = "suffix_redu
-00047800: 6374 696f 6e2d 2220 2b20 746f 6b65 6e69  ction-" + tokeni
-00047810: 7a65 2866 2c20 6464 662c 2069 6465 6e74  ze(f, ddf, ident
-00047820: 6974 792c 202a 2a6b 7761 7267 7329 0a20  ity, **kwargs). 
-00047830: 2020 206d 6574 6120 3d20 6464 662e 5f6d     meta = ddf._m
-00047840: 6574 610a 2020 2020 6e20 3d20 6c65 6e28  eta.    n = len(
-00047850: 6464 662e 6469 7669 7369 6f6e 7329 202d  ddf.divisions) -
-00047860: 2031 0a20 2020 2064 6976 6973 696f 6e73   1.    divisions
-00047870: 203d 205b 4e6f 6e65 5d20 2a20 286e 202b   = [None] * (n +
-00047880: 2031 290a 0a20 2020 204e 203d 2031 0a20   1)..    N = 1. 
-00047890: 2020 2077 6869 6c65 204e 203c 206e 3a0a     while N < n:.
-000478a0: 2020 2020 2020 2020 4e20 2a3d 2032 0a20          N *= 2. 
-000478b0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-000478c0: 6528 6e29 3a0a 2020 2020 2020 2020 6473  e(n):.        ds
-000478d0: 6b5b 286e 616d 652c 2069 2c20 312c 2030  k[(name, i, 1, 0
-000478e0: 295d 203d 2028 6170 706c 792c 2066 2c20  )] = (apply, f, 
-000478f0: 5b28 6464 662e 5f6e 616d 652c 206e 202d  [(ddf._name, n -
-00047900: 2031 202d 2069 292c 2069 6465 6e74 6974   1 - i), identit
-00047910: 795d 2c20 6b77 6172 6773 290a 2020 2020  y], kwargs).    
-00047920: 666f 7220 6920 696e 2072 616e 6765 286e  for i in range(n
-00047930: 2c20 4e29 3a0a 2020 2020 2020 2020 6473  , N):.        ds
-00047940: 6b5b 286e 616d 652c 2069 2c20 312c 2030  k[(name, i, 1, 0
-00047950: 295d 203d 2069 6465 6e74 6974 790a 0a20  )] = identity.. 
-00047960: 2020 2064 203d 2031 0a20 2020 2077 6869     d = 1.    whi
-00047970: 6c65 2064 203c 204e 3a0a 2020 2020 2020  le d < N:.      
-00047980: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00047990: 2830 2c20 4e2c 2032 202a 2064 293a 0a20  (0, N, 2 * d):. 
-000479a0: 2020 2020 2020 2020 2020 2064 736b 5b28             dsk[(
-000479b0: 6e61 6d65 2c20 6920 2b20 3220 2a20 6420  name, i + 2 * d 
-000479c0: 2d20 312c 2032 202a 2064 2c20 3029 5d20  - 1, 2 * d, 0)] 
-000479d0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-000479e0: 2020 2020 6170 706c 792c 0a20 2020 2020      apply,.     
-000479f0: 2020 2020 2020 2020 2020 2066 2c0a 2020             f,.  
-00047a00: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
-00047a10: 6e61 6d65 2c20 6920 2b20 3220 2a20 6420  name, i + 2 * d 
-00047a20: 2d20 312c 2064 2c20 3029 2c20 286e 616d  - 1, d, 0), (nam
-00047a30: 652c 2069 202b 2064 202d 2031 2c20 642c  e, i + d - 1, d,
-00047a40: 2030 295d 2c0a 2020 2020 2020 2020 2020   0)],.          
-00047a50: 2020 2020 2020 6b77 6172 6773 2c0a 2020        kwargs,.  
-00047a60: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00047a70: 2020 2020 6420 2a3d 2032 0a0a 2020 2020      d *= 2..    
-00047a80: 6473 6b5b 286e 616d 652c 204e 202d 2031  dsk[(name, N - 1
-00047a90: 2c20 4e2c 2031 295d 203d 2069 6465 6e74  , N, 1)] = ident
-00047aa0: 6974 790a 0a20 2020 2077 6869 6c65 2064  ity..    while d
-00047ab0: 203e 2031 3a0a 2020 2020 2020 2020 6420   > 1:.        d 
-00047ac0: 2f2f 3d20 320a 2020 2020 2020 2020 666f  //= 2.        fo
-00047ad0: 7220 6920 696e 2072 616e 6765 2830 2c20  r i in range(0, 
-00047ae0: 4e2c 2032 202a 2064 293a 0a20 2020 2020  N, 2 * d):.     
-00047af0: 2020 2020 2020 2064 736b 5b28 6e61 6d65         dsk[(name
-00047b00: 2c20 6920 2b20 6420 2d20 312c 2064 2c20  , i + d - 1, d, 
-00047b10: 3129 5d20 3d20 286e 616d 652c 2069 202b  1)] = (name, i +
-00047b20: 2032 202a 2064 202d 2031 2c20 3220 2a20   2 * d - 1, 2 * 
-00047b30: 642c 2031 290a 2020 2020 2020 2020 2020  d, 1).          
-00047b40: 2020 6473 6b5b 286e 616d 652c 2069 202b    dsk[(name, i +
-00047b50: 2032 202a 2064 202d 2031 2c20 642c 2031   2 * d - 1, d, 1
-00047b60: 295d 203d 2028 0a20 2020 2020 2020 2020  )] = (.         
-00047b70: 2020 2020 2020 2061 7070 6c79 2c0a 2020         apply,.  
-00047b80: 2020 2020 2020 2020 2020 2020 2020 662c                f,
-00047b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047ba0: 205b 286e 616d 652c 2069 202b 2064 202d   [(name, i + d -
-00047bb0: 2031 2c20 642c 2030 292c 2028 6e61 6d65   1, d, 0), (name
-00047bc0: 2c20 6920 2b20 3220 2a20 6420 2d20 312c  , i + 2 * d - 1,
-00047bd0: 2032 202a 2064 2c20 3129 5d2c 0a20 2020   2 * d, 1)],.   
-00047be0: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
-00047bf0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-00047c00: 2029 0a0a 2020 2020 666f 7220 6920 696e   )..    for i in
-00047c10: 2072 616e 6765 286e 293a 0a20 2020 2020   range(n):.     
-00047c20: 2020 2064 736b 5b28 6e61 6d65 2c20 6929     dsk[(name, i)
-00047c30: 5d20 3d20 2861 7070 6c79 2c20 662c 205b  ] = (apply, f, [
-00047c40: 286e 616d 652c 206e 202d 2031 202d 2069  (name, n - 1 - i
-00047c50: 2c20 312c 2031 292c 2069 6465 6e74 6974  , 1, 1), identit
-00047c60: 795d 2c20 6b77 6172 6773 290a 0a20 2020  y], kwargs)..   
-00047c70: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-00047c80: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-00047c90: 6c65 6374 696f 6e73 286e 616d 652c 2064  lections(name, d
-00047ca0: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
-00047cb0: 3d5b 6464 665d 290a 2020 2020 7265 7475  =[ddf]).    retu
-00047cc0: 726e 206e 6577 5f64 645f 6f62 6a65 6374  rn new_dd_object
-00047cd0: 2867 7261 7068 2c20 6e61 6d65 2c20 6d65  (graph, name, me
-00047ce0: 7461 2c20 6469 7669 7369 6f6e 7329 0a0a  ta, divisions)..
-00047cf0: 0a64 6566 206d 6170 7365 7269 6573 2862  .def mapseries(b
-00047d00: 6173 655f 6368 756e 6b2c 2063 6f6e 6361  ase_chunk, conca
-00047d10: 745f 6d61 7029 3a0a 2020 2020 7265 7475  t_map):.    retu
-00047d20: 726e 2062 6173 655f 6368 756e 6b2e 6d61  rn base_chunk.ma
-00047d30: 7028 636f 6e63 6174 5f6d 6170 290a 0a0a  p(concat_map)...
-00047d40: 6465 6620 6d61 7073 6572 6965 735f 636f  def mapseries_co
-00047d50: 6d62 696e 6528 696e 6465 782c 2063 6f6e  mbine(index, con
-00047d60: 6361 745f 7265 7375 6c74 293a 0a20 2020  cat_result):.   
-00047d70: 2066 696e 616c 5f73 6572 6965 7320 3d20   final_series = 
-00047d80: 636f 6e63 6174 5f72 6573 756c 742e 736f  concat_result.so
-00047d90: 7274 5f69 6e64 6578 2829 0a20 2020 2066  rt_index().    f
-00047da0: 696e 616c 5f73 6572 6965 7320 3d20 696e  inal_series = in
-00047db0: 6465 782e 746f 5f73 6572 6965 7328 292e  dex.to_series().
-00047dc0: 6d61 7028 6669 6e61 6c5f 7365 7269 6573  map(final_series
-00047dd0: 290a 2020 2020 7265 7475 726e 2066 696e  ).    return fin
-00047de0: 616c 5f73 6572 6965 730a 0a0a 6465 6620  al_series...def 
-00047df0: 7365 7269 6573 5f6d 6170 2862 6173 655f  series_map(base_
-00047e00: 7365 7269 6573 2c20 6d61 705f 7365 7269  series, map_seri
-00047e10: 6573 293a 0a20 2020 206e 7061 7274 6974  es):.    npartit
-00047e20: 696f 6e73 203d 2062 6173 655f 7365 7269  ions = base_seri
-00047e30: 6573 2e6e 7061 7274 6974 696f 6e73 0a20  es.npartitions. 
-00047e40: 2020 2073 706c 6974 5f6f 7574 203d 206d     split_out = m
-00047e50: 6170 5f73 6572 6965 732e 6e70 6172 7469  ap_series.nparti
-00047e60: 7469 6f6e 730a 0a20 2020 2064 736b 203d  tions..    dsk =
-00047e70: 207b 7d0a 0a20 2020 2062 6173 655f 746f   {}..    base_to
-00047e80: 6b65 6e5f 6b65 7920 3d20 746f 6b65 6e69  ken_key = tokeni
-00047e90: 7a65 2862 6173 655f 7365 7269 6573 2c20  ze(base_series, 
-00047ea0: 7370 6c69 745f 6f75 7429 0a20 2020 2062  split_out).    b
-00047eb0: 6173 655f 7370 6c69 745f 7072 6566 6978  ase_split_prefix
-00047ec0: 203d 2066 2262 6173 652d 7370 6c69 742d   = f"base-split-
-00047ed0: 7b62 6173 655f 746f 6b65 6e5f 6b65 797d  {base_token_key}
-00047ee0: 220a 2020 2020 6261 7365 5f73 6861 7264  ".    base_shard
-00047ef0: 5f70 7265 6669 7820 3d20 6622 6261 7365  _prefix = f"base
-00047f00: 2d73 6861 7264 2d7b 6261 7365 5f74 6f6b  -shard-{base_tok
-00047f10: 656e 5f6b 6579 7d22 0a20 2020 2066 6f72  en_key}".    for
-00047f20: 2069 2c20 6b65 7920 696e 2065 6e75 6d65   i, key in enume
-00047f30: 7261 7465 2862 6173 655f 7365 7269 6573  rate(base_series
-00047f40: 2e5f 5f64 6173 6b5f 6b65 7973 5f5f 2829  .__dask_keys__()
-00047f50: 293a 0a20 2020 2020 2020 2064 736b 5b28  ):.        dsk[(
-00047f60: 6261 7365 5f73 706c 6974 5f70 7265 6669  base_split_prefi
-00047f70: 782c 2069 295d 203d 2028 6861 7368 5f73  x, i)] = (hash_s
-00047f80: 6861 7264 2c20 6b65 792c 2073 706c 6974  hard, key, split
-00047f90: 5f6f 7574 290a 2020 2020 2020 2020 666f  _out).        fo
-00047fa0: 7220 6a20 696e 2072 616e 6765 2873 706c  r j in range(spl
-00047fb0: 6974 5f6f 7574 293a 0a20 2020 2020 2020  it_out):.       
-00047fc0: 2020 2020 2064 736b 5b28 6261 7365 5f73       dsk[(base_s
-00047fd0: 6861 7264 5f70 7265 6669 782c 2030 2c20  hard_prefix, 0, 
-00047fe0: 692c 206a 295d 203d 2028 6765 7469 7465  i, j)] = (getite
-00047ff0: 6d2c 2028 6261 7365 5f73 706c 6974 5f70  m, (base_split_p
-00048000: 7265 6669 782c 2069 292c 206a 290a 0a20  refix, i), j).. 
-00048010: 2020 206d 6170 5f74 6f6b 656e 5f6b 6579     map_token_key
-00048020: 203d 2074 6f6b 656e 697a 6528 6d61 705f   = tokenize(map_
-00048030: 7365 7269 6573 290a 2020 2020 6d61 705f  series).    map_
-00048040: 7370 6c69 745f 7072 6566 6978 203d 2066  split_prefix = f
-00048050: 226d 6170 2d73 706c 6974 2d7b 6d61 705f  "map-split-{map_
-00048060: 746f 6b65 6e5f 6b65 797d 220a 2020 2020  token_key}".    
-00048070: 6d61 705f 7368 6172 645f 7072 6566 6978  map_shard_prefix
-00048080: 203d 2066 226d 6170 2d73 6861 7264 2d7b   = f"map-shard-{
-00048090: 6d61 705f 746f 6b65 6e5f 6b65 797d 220a  map_token_key}".
-000480a0: 2020 2020 666f 7220 692c 206b 6579 2069      for i, key i
-000480b0: 6e20 656e 756d 6572 6174 6528 6d61 705f  n enumerate(map_
-000480c0: 7365 7269 6573 2e5f 5f64 6173 6b5f 6b65  series.__dask_ke
-000480d0: 7973 5f5f 2829 293a 0a20 2020 2020 2020  ys__()):.       
-000480e0: 2064 736b 5b28 6d61 705f 7370 6c69 745f   dsk[(map_split_
-000480f0: 7072 6566 6978 2c20 6929 5d20 3d20 280a  prefix, i)] = (.
-00048100: 2020 2020 2020 2020 2020 2020 6861 7368              hash
-00048110: 5f73 6861 7264 2c0a 2020 2020 2020 2020  _shard,.        
-00048120: 2020 2020 6b65 792c 0a20 2020 2020 2020      key,.       
-00048130: 2020 2020 2073 706c 6974 5f6f 7574 2c0a       split_out,.
-00048140: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-00048150: 745f 6f75 745f 6f6e 5f69 6e64 6578 2c0a  t_out_on_index,.
-00048160: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-00048170: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00048180: 2020 2020 666f 7220 6a20 696e 2072 616e      for j in ran
-00048190: 6765 2873 706c 6974 5f6f 7574 293a 0a20  ge(split_out):. 
-000481a0: 2020 2020 2020 2020 2020 2064 736b 5b28             dsk[(
-000481b0: 6d61 705f 7368 6172 645f 7072 6566 6978  map_shard_prefix
-000481c0: 2c20 302c 2069 2c20 6a29 5d20 3d20 2867  , 0, i, j)] = (g
-000481d0: 6574 6974 656d 2c20 286d 6170 5f73 706c  etitem, (map_spl
-000481e0: 6974 5f70 7265 6669 782c 2069 292c 206a  it_prefix, i), j
-000481f0: 290a 0a20 2020 2074 6f6b 656e 5f6b 6579  )..    token_key
-00048200: 203d 2074 6f6b 656e 697a 6528 6261 7365   = tokenize(base
-00048210: 5f73 6572 6965 732c 206d 6170 5f73 6572  _series, map_ser
-00048220: 6965 7329 0a20 2020 206d 6170 5f70 7265  ies).    map_pre
-00048230: 6669 7820 3d20 6622 6d61 702d 7365 7269  fix = f"map-seri
-00048240: 6573 2d7b 746f 6b65 6e5f 6b65 797d 220a  es-{token_key}".
-00048250: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00048260: 6765 286e 7061 7274 6974 696f 6e73 293a  ge(npartitions):
-00048270: 0a20 2020 2020 2020 2066 6f72 206a 2069  .        for j i
-00048280: 6e20 7261 6e67 6528 7370 6c69 745f 6f75  n range(split_ou
-00048290: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-000482a0: 6473 6b5b 286d 6170 5f70 7265 6669 782c  dsk[(map_prefix,
-000482b0: 2069 2c20 6a29 5d20 3d20 280a 2020 2020   i, j)] = (.    
-000482c0: 2020 2020 2020 2020 2020 2020 6d61 7073              maps
-000482d0: 6572 6965 732c 0a20 2020 2020 2020 2020  eries,.         
-000482e0: 2020 2020 2020 2028 6261 7365 5f73 6861         (base_sha
-000482f0: 7264 5f70 7265 6669 782c 2030 2c20 692c  rd_prefix, 0, i,
-00048300: 206a 292c 0a20 2020 2020 2020 2020 2020   j),.           
-00048310: 2020 2020 2028 5f63 6f6e 6361 742c 205b       (_concat, [
-00048320: 286d 6170 5f73 6861 7264 5f70 7265 6669  (map_shard_prefi
-00048330: 782c 2030 2c20 6b2c 206a 2920 666f 7220  x, 0, k, j) for 
-00048340: 6b20 696e 2072 616e 6765 2873 706c 6974  k in range(split
-00048350: 5f6f 7574 295d 292c 0a20 2020 2020 2020  _out)]),.       
-00048360: 2020 2020 2029 0a0a 2020 2020 6669 6e61       )..    fina
-00048370: 6c5f 7072 6566 6978 203d 2066 226d 6170  l_prefix = f"map
-00048380: 2d73 6572 6965 732d 636f 6d62 696e 652d  -series-combine-
-00048390: 7b74 6f6b 656e 5f6b 6579 7d22 0a20 2020  {token_key}".   
-000483a0: 2066 6f72 2069 2c20 6b65 7920 696e 2065   for i, key in e
-000483b0: 6e75 6d65 7261 7465 2862 6173 655f 7365  numerate(base_se
-000483c0: 7269 6573 2e69 6e64 6578 2e5f 5f64 6173  ries.index.__das
-000483d0: 6b5f 6b65 7973 5f5f 2829 293a 0a20 2020  k_keys__()):.   
-000483e0: 2020 2020 2064 736b 5b28 6669 6e61 6c5f       dsk[(final_
-000483f0: 7072 6566 6978 2c20 6929 5d20 3d20 280a  prefix, i)] = (.
-00048400: 2020 2020 2020 2020 2020 2020 6d61 7073              maps
-00048410: 6572 6965 735f 636f 6d62 696e 652c 0a20  eries_combine,. 
-00048420: 2020 2020 2020 2020 2020 206b 6579 2c0a             key,.
-00048430: 2020 2020 2020 2020 2020 2020 285f 636f              (_co
-00048440: 6e63 6174 2c20 5b28 6d61 705f 7072 6566  ncat, [(map_pref
-00048450: 6978 2c20 692c 206a 2920 666f 7220 6a20  ix, i, j) for j 
-00048460: 696e 2072 616e 6765 2873 706c 6974 5f6f  in range(split_o
-00048470: 7574 295d 292c 0a20 2020 2020 2020 2029  ut)]),.        )
-00048480: 0a0a 2020 2020 6d65 7461 203d 206d 6170  ..    meta = map
-00048490: 5f73 6572 6965 732e 5f6d 6574 612e 636f  _series._meta.co
-000484a0: 7079 2829 0a20 2020 206d 6574 612e 696e  py().    meta.in
-000484b0: 6465 7820 3d20 6261 7365 5f73 6572 6965  dex = base_serie
-000484c0: 732e 5f6d 6574 612e 696e 6465 780a 2020  s._meta.index.  
-000484d0: 2020 6d65 7461 203d 206d 616b 655f 6d65    meta = make_me
-000484e0: 7461 286d 6574 6129 0a0a 2020 2020 6465  ta(meta)..    de
-000484f0: 7065 6e64 656e 6369 6573 203d 205b 6261  pendencies = [ba
-00048500: 7365 5f73 6572 6965 732c 206d 6170 5f73  se_series, map_s
-00048510: 6572 6965 732c 2062 6173 655f 7365 7269  eries, base_seri
-00048520: 6573 2e69 6e64 6578 5d0a 2020 2020 6772  es.index].    gr
-00048530: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-00048540: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-00048550: 7469 6f6e 7328 0a20 2020 2020 2020 2066  tions(.        f
-00048560: 696e 616c 5f70 7265 6669 782c 2064 736b  inal_prefix, dsk
-00048570: 2c20 6465 7065 6e64 656e 6369 6573 3d64  , dependencies=d
-00048580: 6570 656e 6465 6e63 6965 730a 2020 2020  ependencies.    
-00048590: 290a 2020 2020 6469 7669 7369 6f6e 7320  ).    divisions 
-000485a0: 3d20 6c69 7374 2862 6173 655f 7365 7269  = list(base_seri
-000485b0: 6573 2e64 6976 6973 696f 6e73 290a 0a20  es.divisions).. 
-000485c0: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
-000485d0: 5f6f 626a 6563 7428 6772 6170 682c 2066  _object(graph, f
-000485e0: 696e 616c 5f70 7265 6669 782c 206d 6574  inal_prefix, met
-000485f0: 612c 2064 6976 6973 696f 6e73 290a 0a0a  a, divisions)...
-00048600: 6465 6620 5f63 6f6e 7665 7274 5f74 6f5f  def _convert_to_
-00048610: 6e75 6d65 7269 6328 7365 7269 6573 2c20  numeric(series, 
-00048620: 736b 6970 6e61 293a 0a20 2020 2069 6620  skipna):.    if 
-00048630: 736b 6970 6e61 3a0a 2020 2020 2020 2020  skipna:.        
-00048640: 7265 7475 726e 2073 6572 6965 732e 6472  return series.dr
-00048650: 6f70 6e61 2829 2e76 6965 7728 2269 3822  opna().view("i8"
-00048660: 290a 0a20 2020 2023 2073 6572 6965 732e  )..    # series.
-00048670: 7669 6577 2822 6938 2229 2077 6974 6820  view("i8") with 
-00048680: 7064 2e4e 6154 2070 726f 6475 6365 7320  pd.NaT produces 
-00048690: 2d39 3232 3333 3732 3033 3638 3534 3737  -922337203685477
-000486a0: 3538 3038 2069 7320 7768 7920 7765 206e  5808 is why we n
-000486b0: 6565 6420 746f 2064 6f20 7468 6973 0a20  eed to do this. 
-000486c0: 2020 2072 6574 7572 6e20 7365 7269 6573     return series
-000486d0: 2e76 6965 7728 2269 3822 292e 6d61 736b  .view("i8").mask
-000486e0: 2873 6572 6965 732e 6973 6e75 6c6c 2829  (series.isnull()
-000486f0: 2c20 6e70 2e6e 616e 290a 0a0a 6465 6620  , np.nan)...def 
-00048700: 5f73 7172 745f 616e 645f 636f 6e76 6572  _sqrt_and_conver
-00048710: 745f 746f 5f74 696d 6564 656c 7461 2870  t_to_timedelta(p
-00048720: 6172 7469 7469 6f6e 2c20 6178 6973 2c20  artition, axis, 
-00048730: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-00048740: 3a0a 2020 2020 6966 2061 7869 7320 3d3d  :.    if axis ==
-00048750: 2031 3a0a 2020 2020 2020 2020 7769 7468   1:.        with
-00048760: 2077 6172 6e69 6e67 732e 6361 7463 685f   warnings.catch_
-00048770: 7761 726e 696e 6773 2829 3a0a 2020 2020  warnings():.    
-00048780: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00048790: 2e66 696c 7465 7277 6172 6e69 6e67 7328  .filterwarnings(
-000487a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000487b0: 2022 6967 6e6f 7265 222c 0a20 2020 2020   "ignore",.     
-000487c0: 2020 2020 2020 2020 2020 2063 6174 6567             categ
-000487d0: 6f72 793d 5275 6e74 696d 6557 6172 6e69  ory=RuntimeWarni
-000487e0: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
-000487f0: 2020 2020 6d65 7373 6167 653d 2269 6e76      message="inv
-00048800: 616c 6964 2076 616c 7565 2065 6e63 6f75  alid value encou
-00048810: 6e74 6572 6564 2069 6e20 6361 7374 222c  ntered in cast",
-00048820: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00048830: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00048840: 6e20 7064 2e74 6f5f 7469 6d65 6465 6c74  n pd.to_timedelt
-00048850: 6128 4d2e 7374 6428 7061 7274 6974 696f  a(M.std(partitio
-00048860: 6e2c 2061 7869 733d 6178 6973 2c20 2a61  n, axis=axis, *a
-00048870: 7267 732c 202a 2a6b 7761 7267 7329 290a  rgs, **kwargs)).
-00048880: 0a20 2020 2069 735f 6466 5f6c 696b 652c  .    is_df_like,
-00048890: 2074 696d 655f 636f 6c73 203d 206b 7761   time_cols = kwa
-000488a0: 7267 735b 2269 735f 6466 5f6c 696b 6522  rgs["is_df_like"
-000488b0: 5d2c 206b 7761 7267 735b 2274 696d 655f  ], kwargs["time_
-000488c0: 636f 6c73 225d 0a0a 2020 2020 7371 7274  cols"]..    sqrt
-000488d0: 203d 206e 702e 7371 7274 2870 6172 7469   = np.sqrt(parti
-000488e0: 7469 6f6e 290a 0a20 2020 2069 6620 6e6f  tion)..    if no
-000488f0: 7420 6973 5f64 665f 6c69 6b65 3a0a 2020  t is_df_like:.  
-00048900: 2020 2020 2020 7265 7475 726e 2070 642e        return pd.
-00048910: 746f 5f74 696d 6564 656c 7461 2873 7172  to_timedelta(sqr
-00048920: 7429 0a0a 2020 2020 7469 6d65 5f63 6f6c  t)..    time_col
-00048930: 5f6d 6173 6b20 3d20 7371 7274 2e69 6e64  _mask = sqrt.ind
-00048940: 6578 2e69 7369 6e28 7469 6d65 5f63 6f6c  ex.isin(time_col
-00048950: 7329 0a20 2020 206d 6174 6368 696e 675f  s).    matching_
-00048960: 7661 6c73 203d 2073 7172 745b 7469 6d65  vals = sqrt[time
-00048970: 5f63 6f6c 5f6d 6173 6b5d 0a20 2020 2066  _col_mask].    f
-00048980: 6f72 2074 696d 655f 636f 6c2c 206d 6174  or time_col, mat
-00048990: 6368 696e 675f 7661 6c20 696e 207a 6970  ching_val in zip
-000489a0: 2874 696d 655f 636f 6c73 2c20 6d61 7463  (time_cols, matc
-000489b0: 6869 6e67 5f76 616c 7329 3a0a 2020 2020  hing_vals):.    
-000489c0: 2020 2020 7371 7274 5b74 696d 655f 636f      sqrt[time_co
-000489d0: 6c5d 203d 2070 642e 746f 5f74 696d 6564  l] = pd.to_timed
-000489e0: 656c 7461 286d 6174 6368 696e 675f 7661  elta(matching_va
-000489f0: 6c29 0a0a 2020 2020 7265 7475 726e 2073  l)..    return s
-00048a00: 7172 740a 0a0a 6465 6620 5f72 6169 7365  qrt...def _raise
-00048a10: 5f69 665f 6e6f 745f 7365 7269 6573 5f6f  _if_not_series_o
-00048a20: 725f 6461 7461 6672 616d 6528 782c 2066  r_dataframe(x, f
-00048a30: 756e 636e 616d 6529 3a0a 2020 2020 2222  uncname):.    ""
-00048a40: 220a 2020 2020 5574 696c 6974 7920 6675  ".    Utility fu
-00048a50: 6e63 7469 6f6e 2074 6f20 7261 6973 6520  nction to raise 
-00048a60: 616e 2065 7272 6f72 2069 6620 616e 206f  an error if an o
-00048a70: 626a 6563 7420 6973 206e 6f74 2061 2053  bject is not a S
-00048a80: 6572 6965 7320 6f72 2044 6174 6146 7261  eries or DataFra
-00048a90: 6d65 0a20 2020 2022 2222 0a20 2020 2069  me.    """.    i
-00048aa0: 6620 6e6f 7420 6973 5f73 6572 6965 735f  f not is_series_
-00048ab0: 6c69 6b65 2878 2920 616e 6420 6e6f 7420  like(x) and not 
-00048ac0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-00048ad0: 6528 7829 3a0a 2020 2020 2020 2020 7261  e(x):.        ra
-00048ae0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-00048af0: 6564 4572 726f 7228 0a20 2020 2020 2020  edError(.       
-00048b00: 2020 2020 2022 6025 7360 2069 7320 6f6e       "`%s` is on
-00048b10: 6c79 2073 7570 706f 7274 6564 2077 6974  ly supported wit
-00048b20: 6820 6f62 6a65 6374 7320 7468 6174 2061  h objects that a
-00048b30: 7265 2044 6174 6166 7261 6d65 7320 6f72  re Dataframes or
-00048b40: 2053 6572 6965 7322 0a20 2020 2020 2020   Series".       
-00048b50: 2020 2020 2025 2066 756e 636e 616d 650a       % funcname.
-00048b60: 2020 2020 2020 2020 290a 0a0a 6465 6620          )...def 
-00048b70: 5f67 6574 6174 7472 5f6e 756d 6572 6963  _getattr_numeric
-00048b80: 5f6f 6e6c 7928 2a61 7267 732c 205f 6461  _only(*args, _da
-00048b90: 736b 5f6d 6574 686f 645f 6e61 6d65 2c20  sk_method_name, 
-00048ba0: 2a2a 6b77 6172 6773 293a 0a20 2020 2077  **kwargs):.    w
-00048bb0: 6974 6820 6368 6563 6b5f 6e75 6d65 7269  ith check_numeri
-00048bc0: 635f 6f6e 6c79 5f64 6570 7265 6361 7469  c_only_deprecati
-00048bd0: 6f6e 2829 3a0a 2020 2020 2020 2020 7265  on():.        re
-00048be0: 7475 726e 2067 6574 6174 7472 284d 2c20  turn getattr(M, 
-00048bf0: 5f64 6173 6b5f 6d65 7468 6f64 5f6e 616d  _dask_method_nam
-00048c00: 6529 282a 6172 6773 2c20 2a2a 6b77 6172  e)(*args, **kwar
-00048c10: 6773 290a                                gs).
+00032920: 2020 206f 6e3d 6f6e 2c0a 2020 2020 2020     on=on,.      
+00032930: 2020 2020 2020 2020 2020 2020 2020 6c73                ls
+00032940: 7566 6669 783d 6c73 7566 6669 782c 0a20  uffix=lsuffix,. 
+00032950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032960: 2020 2072 7375 6666 6978 3d72 7375 6666     rsuffix=rsuff
+00032970: 6978 2c0a 2020 2020 2020 2020 2020 2020  ix,.            
+00032980: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+00032990: 6f6e 733d 6e70 6172 7469 7469 6f6e 732c  ons=npartitions,
+000329a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000329b0: 2020 2020 2073 6875 6666 6c65 3d73 6875       shuffle=shu
+000329c0: 6666 6c65 2c0a 2020 2020 2020 2020 2020  ffle,.          
+000329d0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000329e0: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+000329f0: 7261 6d65 2e6d 756c 7469 2069 6d70 6f72  rame.multi impor
+00032a00: 7420 6d65 7267 650a 0a20 2020 2020 2020  t merge..       
+00032a10: 2072 6574 7572 6e20 6d65 7267 6528 0a20   return merge(. 
+00032a20: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+00032a30: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+00032a40: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00032a50: 686f 773d 686f 772c 0a20 2020 2020 2020  how=how,.       
+00032a60: 2020 2020 206c 6566 745f 696e 6465 783d       left_index=
+00032a70: 6f6e 2069 7320 4e6f 6e65 2c0a 2020 2020  on is None,.    
+00032a80: 2020 2020 2020 2020 7269 6768 745f 696e          right_in
+00032a90: 6465 783d 5472 7565 2c0a 2020 2020 2020  dex=True,.      
+00032aa0: 2020 2020 2020 6c65 6674 5f6f 6e3d 6f6e        left_on=on
+00032ab0: 2c0a 2020 2020 2020 2020 2020 2020 7375  ,.            su
+00032ac0: 6666 6978 6573 3d28 6c73 7566 6669 782c  ffixes=(lsuffix,
+00032ad0: 2072 7375 6666 6978 292c 0a20 2020 2020   rsuffix),.     
+00032ae0: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+00032af0: 6e73 3d6e 7061 7274 6974 696f 6e73 2c0a  ns=npartitions,.
+00032b00: 2020 2020 2020 2020 2020 2020 7368 7566              shuf
+00032b10: 666c 653d 7368 7566 666c 652c 0a20 2020  fle=shuffle,.   
+00032b20: 2020 2020 2029 0a0a 2020 2020 6966 206e       )..    if n
+00032b30: 6f74 2050 414e 4441 535f 4754 5f32 3030  ot PANDAS_GT_200
+00032b40: 3a0a 0a20 2020 2020 2020 2040 6465 7269  :..        @deri
+00032b50: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+00032b60: 4672 616d 6529 0a20 2020 2020 2020 2064  Frame).        d
+00032b70: 6566 2061 7070 656e 6428 7365 6c66 2c20  ef append(self, 
+00032b80: 6f74 6865 722c 2069 6e74 6572 6c65 6176  other, interleav
+00032b90: 655f 7061 7274 6974 696f 6e73 3d46 616c  e_partitions=Fal
+00032ba0: 7365 293a 0a20 2020 2020 2020 2020 2020  se):.           
+00032bb0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
+00032bc0: 7468 6572 2c20 5365 7269 6573 293a 0a20  ther, Series):. 
+00032bd0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00032be0: 7367 203d 2028 0a20 2020 2020 2020 2020  sg = (.         
+00032bf0: 2020 2020 2020 2020 2020 2022 556e 6162             "Unab
+00032c00: 6c65 2074 6f20 6170 7065 6e64 696e 6720  le to appending 
+00032c10: 6464 2e53 6572 6965 7320 746f 2064 642e  dd.Series to dd.
+00032c20: 4461 7461 4672 616d 652e 220a 2020 2020  DataFrame.".    
+00032c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032c40: 2255 7365 2070 642e 5365 7269 6573 2074  "Use pd.Series t
+00032c50: 6f20 6170 7065 6e64 2061 7320 726f 772e  o append as row.
+00032c60: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00032c70: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00032c80: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00032c90: 7272 6f72 286d 7367 290a 2020 2020 2020  rror(msg).      
+00032ca0: 2020 2020 2020 656c 6966 2069 735f 7365        elif is_se
+00032cb0: 7269 6573 5f6c 696b 6528 6f74 6865 7229  ries_like(other)
+00032cc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00032cd0: 2020 6f74 6865 7220 3d20 6f74 6865 722e    other = other.
+00032ce0: 746f 5f66 7261 6d65 2829 2e54 0a20 2020  to_frame().T.   
+00032cf0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00032d00: 7375 7065 7228 292e 6170 7065 6e64 286f  super().append(o
+00032d10: 7468 6572 2c20 696e 7465 726c 6561 7665  ther, interleave
+00032d20: 5f70 6172 7469 7469 6f6e 733d 696e 7465  _partitions=inte
+00032d30: 726c 6561 7665 5f70 6172 7469 7469 6f6e  rleave_partition
+00032d40: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
+00032d50: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00032d60: 6d65 290a 2020 2020 6465 6620 6974 6572  me).    def iter
+00032d70: 726f 7773 2873 656c 6629 3a0a 2020 2020  rows(self):.    
+00032d80: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00032d90: 6765 2873 656c 662e 6e70 6172 7469 7469  ge(self.npartiti
+00032da0: 6f6e 7329 3a0a 2020 2020 2020 2020 2020  ons):.          
+00032db0: 2020 6466 203d 2073 656c 662e 6765 745f    df = self.get_
+00032dc0: 7061 7274 6974 696f 6e28 6929 2e63 6f6d  partition(i).com
+00032dd0: 7075 7465 2829 0a20 2020 2020 2020 2020  pute().         
+00032de0: 2020 2079 6965 6c64 2066 726f 6d20 6466     yield from df
+00032df0: 2e69 7465 7272 6f77 7328 290a 0a20 2020  .iterrows()..   
+00032e00: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00032e10: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00032e20: 2064 6566 2069 7465 7274 7570 6c65 7328   def itertuples(
+00032e30: 7365 6c66 2c20 696e 6465 783d 5472 7565  self, index=True
+00032e40: 2c20 6e61 6d65 3d22 5061 6e64 6173 2229  , name="Pandas")
+00032e50: 3a0a 2020 2020 2020 2020 666f 7220 6920  :.        for i 
+00032e60: 696e 2072 616e 6765 2873 656c 662e 6e70  in range(self.np
+00032e70: 6172 7469 7469 6f6e 7329 3a0a 2020 2020  artitions):.    
+00032e80: 2020 2020 2020 2020 6466 203d 2073 656c          df = sel
+00032e90: 662e 6765 745f 7061 7274 6974 696f 6e28  f.get_partition(
+00032ea0: 6929 2e63 6f6d 7075 7465 2829 0a20 2020  i).compute().   
+00032eb0: 2020 2020 2020 2020 2079 6965 6c64 2066           yield f
+00032ec0: 726f 6d20 6466 2e69 7465 7274 7570 6c65  rom df.itertuple
+00032ed0: 7328 696e 6465 783d 696e 6465 782c 206e  s(index=index, n
+00032ee0: 616d 653d 6e61 6d65 290a 0a20 2020 2040  ame=name)..    @
+00032ef0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00032f00: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+00032f10: 6566 2069 7465 6d73 2873 656c 6629 3a0a  ef items(self):.
+00032f20: 2020 2020 2020 2020 666f 7220 636f 6c5f          for col_
+00032f30: 6964 782c 206c 6162 656c 2069 6e20 656e  idx, label in en
+00032f40: 756d 6572 6174 6528 7365 6c66 2e63 6f6c  umerate(self.col
+00032f50: 756d 6e73 293a 0a20 2020 2020 2020 2020  umns):.         
+00032f60: 2020 2079 6965 6c64 206c 6162 656c 2c20     yield label, 
+00032f70: 7365 6c66 2e69 6c6f 635b 3a2c 2063 6f6c  self.iloc[:, col
+00032f80: 5f69 6478 5d0a 0a20 2020 2040 636c 6173  _idx]..    @clas
+00032f90: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
+00032fa0: 5f62 696e 645f 6f70 6572 6174 6f72 5f6d  _bind_operator_m
+00032fb0: 6574 686f 6428 636c 732c 206e 616d 652c  ethod(cls, name,
+00032fc0: 206f 702c 206f 7269 6769 6e61 6c3d 7064   op, original=pd
+00032fd0: 2e44 6174 6146 7261 6d65 293a 0a20 2020  .DataFrame):.   
+00032fe0: 2020 2020 2022 2222 6269 6e64 206f 7065       """bind ope
+00032ff0: 7261 746f 7220 6d65 7468 6f64 206c 696b  rator method lik
+00033000: 6520 4461 7461 4672 616d 652e 6164 6420  e DataFrame.add 
+00033010: 746f 2074 6869 7320 636c 6173 7322 2222  to this class"""
+00033020: 0a0a 2020 2020 2020 2020 2320 6e61 6d65  ..        # name
+00033030: 206d 7573 7420 6265 2065 7870 6c69 6369   must be explici
+00033040: 746c 7920 7061 7373 6564 2066 6f72 2064  tly passed for d
+00033050: 6976 206d 6574 686f 6420 7768 6f73 6520  iv method whose 
+00033060: 6e61 6d65 2069 7320 7472 7565 6469 760a  name is truediv.
+00033070: 0a20 2020 2020 2020 2064 6566 206d 6574  .        def met
+00033080: 6828 7365 6c66 2c20 6f74 6865 722c 2061  h(self, other, a
+00033090: 7869 733d 2263 6f6c 756d 6e73 222c 206c  xis="columns", l
+000330a0: 6576 656c 3d4e 6f6e 652c 2066 696c 6c5f  evel=None, fill_
+000330b0: 7661 6c75 653d 4e6f 6e65 293a 0a20 2020  value=None):.   
+000330c0: 2020 2020 2020 2020 2069 6620 6c65 7665           if leve
+000330d0: 6c20 6973 206e 6f74 204e 6f6e 653a 0a20  l is not None:. 
+000330e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000330f0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+00033100: 7465 6445 7272 6f72 2822 6c65 7665 6c20  tedError("level 
+00033110: 6d75 7374 2062 6520 4e6f 6e65 2229 0a0a  must be None")..
+00033120: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00033130: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
+00033140: 655f 6178 6973 2861 7869 7329 0a0a 2020  e_axis(axis)..  
+00033150: 2020 2020 2020 2020 2020 6966 2061 7869            if axi
+00033160: 7320 696e 2028 312c 2022 636f 6c75 6d6e  s in (1, "column
+00033170: 7322 293a 0a20 2020 2020 2020 2020 2020  s"):.           
+00033180: 2020 2020 2023 2057 6865 6e20 6178 6973       # When axis
+00033190: 3d31 2061 6e64 206f 7468 6572 2069 7320  =1 and other is 
+000331a0: 6120 7365 7269 6573 2c20 606f 7468 6572  a series, `other
+000331b0: 6020 6973 2074 7261 6e73 706f 7365 640a  ` is transposed.
+000331c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000331d0: 2320 616e 6420 7468 6520 6f70 6572 6174  # and the operat
+000331e0: 6f72 2069 7320 6170 706c 6965 6420 6272  or is applied br
+000331f0: 6f61 6463 6173 7420 6163 726f 7373 2072  oadcast across r
+00033200: 6f77 732e 2054 6869 730a 2020 2020 2020  ows. This.      
+00033210: 2020 2020 2020 2020 2020 2320 6973 6e27            # isn'
+00033220: 7420 7375 7070 6f72 7465 6420 7769 7468  t supported with
+00033230: 2064 642e 5365 7269 6573 2e0a 2020 2020   dd.Series..    
+00033240: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00033250: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
+00033260: 2053 6572 6965 7329 3a0a 2020 2020 2020   Series):.      
+00033270: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
+00033280: 6720 3d20 6622 556e 6162 6c65 2074 6f20  g = f"Unable to 
+00033290: 7b6e 616d 657d 2064 642e 5365 7269 6573  {name} dd.Series
+000332a0: 2077 6974 6820 6178 6973 3d31 220a 2020   with axis=1".  
+000332b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000332c0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000332d0: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
+000332e0: 2020 2020 2020 2020 656c 6966 2069 735f          elif is_
+000332f0: 7365 7269 6573 5f6c 696b 6528 6f74 6865  series_like(othe
+00033300: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00033310: 2020 2020 2020 2020 2320 5370 6563 6961          # Specia
+00033320: 6c20 6361 7365 2066 6f72 2070 642e 5365  l case for pd.Se
+00033330: 7269 6573 2074 6f20 6176 6f69 6420 756e  ries to avoid un
+00033340: 7761 6e74 6564 2070 6172 7469 7469 6f6e  wanted partition
+00033350: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00033360: 2020 2020 2020 2020 2320 6f66 206f 7468          # of oth
+00033370: 6572 2e20 5765 2070 6173 7320 6974 2069  er. We pass it i
+00033380: 6e20 6173 2061 206b 7761 7267 2074 6f20  n as a kwarg to 
+00033390: 7072 6576 656e 7420 7468 6973 2e0a 2020  prevent this..  
+000333a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000333b0: 2020 6d65 7461 203d 205f 656d 756c 6174    meta = _emulat
+000333c0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+000333d0: 2020 2020 2020 2020 2020 206f 702c 2073             op, s
+000333e0: 656c 662c 206f 7468 6572 3d6f 7468 6572  elf, other=other
+000333f0: 2c20 6178 6973 3d61 7869 732c 2066 696c  , axis=axis, fil
+00033400: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
+00033410: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+00033420: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00033430: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00033440: 7572 6e20 6d61 705f 7061 7274 6974 696f  urn map_partitio
+00033450: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+00033460: 2020 2020 2020 2020 2020 2020 6f70 2c0a              op,.
+00033470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033480: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00033490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000334a0: 2020 2020 2020 6f74 6865 723d 6f74 6865        other=othe
+000334b0: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
+000334c0: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
+000334d0: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
+000334e0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+000334f0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+00033500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033510: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
+00033520: 5f76 616c 7565 2c0a 2020 2020 2020 2020  _value,.        
+00033530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033540: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00033550: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00033560: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00033570: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
+00033580: 3d20 5f65 6d75 6c61 7465 286f 702c 2073  = _emulate(op, s
+00033590: 656c 662c 206f 7468 6572 2c20 6178 6973  elf, other, axis
+000335a0: 3d61 7869 732c 2066 696c 6c5f 7661 6c75  =axis, fill_valu
+000335b0: 653d 6669 6c6c 5f76 616c 7565 290a 2020  e=fill_value).  
+000335c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000335d0: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
+000335e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000335f0: 206f 702c 0a20 2020 2020 2020 2020 2020   op,.           
+00033600: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00033610: 2020 2020 2020 2020 2020 206f 7468 6572             other
+00033620: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033630: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
+00033640: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+00033650: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
+00033660: 2020 2020 2020 2020 6669 6c6c 5f76 616c          fill_val
+00033670: 7565 3d66 696c 6c5f 7661 6c75 652c 0a20  ue=fill_value,. 
+00033680: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00033690: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+000336a0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+000336b0: 2020 2029 0a0a 2020 2020 2020 2020 6d65     )..        me
+000336c0: 7468 2e5f 5f6e 616d 655f 5f20 3d20 6e61  th.__name__ = na
+000336d0: 6d65 0a20 2020 2020 2020 2073 6574 6174  me.        setat
+000336e0: 7472 2863 6c73 2c20 6e61 6d65 2c20 6465  tr(cls, name, de
+000336f0: 7269 7665 645f 6672 6f6d 286f 7269 6769  rived_from(origi
+00033700: 6e61 6c29 286d 6574 6829 290a 0a20 2020  nal)(meth))..   
+00033710: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+00033720: 2020 6465 6620 5f62 696e 645f 636f 6d70    def _bind_comp
+00033730: 6172 6973 6f6e 5f6d 6574 686f 6428 636c  arison_method(cl
+00033740: 732c 206e 616d 652c 2063 6f6d 7061 7269  s, name, compari
+00033750: 736f 6e2c 206f 7269 6769 6e61 6c3d 7064  son, original=pd
+00033760: 2e44 6174 6146 7261 6d65 293a 0a20 2020  .DataFrame):.   
+00033770: 2020 2020 2022 2222 6269 6e64 2063 6f6d       """bind com
+00033780: 7061 7269 736f 6e20 6d65 7468 6f64 206c  parison method l
+00033790: 696b 6520 4461 7461 4672 616d 652e 6571  ike DataFrame.eq
+000337a0: 2074 6f20 7468 6973 2063 6c61 7373 2222   to this class""
+000337b0: 220a 0a20 2020 2020 2020 2064 6566 206d  "..        def m
+000337c0: 6574 6828 7365 6c66 2c20 6f74 6865 722c  eth(self, other,
+000337d0: 2061 7869 733d 2263 6f6c 756d 6e73 222c   axis="columns",
+000337e0: 206c 6576 656c 3d4e 6f6e 6529 3a0a 2020   level=None):.  
+000337f0: 2020 2020 2020 2020 2020 6966 206c 6576            if lev
+00033800: 656c 2069 7320 6e6f 7420 4e6f 6e65 3a0a  el is not None:.
+00033810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033820: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+00033830: 6e74 6564 4572 726f 7228 226c 6576 656c  ntedError("level
+00033840: 206d 7573 7420 6265 204e 6f6e 6522 290a   must be None").
+00033850: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00033860: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
+00033870: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
+00033880: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00033890: 656c 656d 7769 7365 2863 6f6d 7061 7269  elemwise(compari
+000338a0: 736f 6e2c 2073 656c 662c 206f 7468 6572  son, self, other
+000338b0: 2c20 6178 6973 3d61 7869 7329 0a0a 2020  , axis=axis)..  
+000338c0: 2020 2020 2020 6d65 7468 2e5f 5f6e 616d        meth.__nam
+000338d0: 655f 5f20 3d20 6e61 6d65 0a20 2020 2020  e__ = name.     
+000338e0: 2020 2073 6574 6174 7472 2863 6c73 2c20     setattr(cls, 
+000338f0: 6e61 6d65 2c20 6465 7269 7665 645f 6672  name, derived_fr
+00033900: 6f6d 286f 7269 6769 6e61 6c29 286d 6574  om(original)(met
+00033910: 6829 290a 0a20 2020 2040 696e 7365 7274  h))..    @insert
+00033920: 5f6d 6574 615f 7061 7261 6d5f 6465 7363  _meta_param_desc
+00033930: 7269 7074 696f 6e28 7061 643d 3132 290a  ription(pad=12).
+00033940: 2020 2020 6465 6620 6170 706c 7928 0a20      def apply(. 
+00033950: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00033960: 2020 2020 2066 756e 632c 0a20 2020 2020       func,.     
+00033970: 2020 2061 7869 733d 302c 0a20 2020 2020     axis=0,.     
+00033980: 2020 2062 726f 6164 6361 7374 3d4e 6f6e     broadcast=Non
+00033990: 652c 0a20 2020 2020 2020 2072 6177 3d46  e,.        raw=F
+000339a0: 616c 7365 2c0a 2020 2020 2020 2020 7265  alse,.        re
+000339b0: 6475 6365 3d4e 6f6e 652c 0a20 2020 2020  duce=None,.     
+000339c0: 2020 2061 7267 733d 2829 2c0a 2020 2020     args=(),.    
+000339d0: 2020 2020 6d65 7461 3d6e 6f5f 6465 6661      meta=no_defa
+000339e0: 756c 742c 0a20 2020 2020 2020 2072 6573  ult,.        res
+000339f0: 756c 745f 7479 7065 3d4e 6f6e 652c 0a20  ult_type=None,. 
+00033a00: 2020 2020 2020 202a 2a6b 7764 732c 0a20         **kwds,. 
+00033a10: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+00033a20: 2250 6172 616c 6c65 6c20 7665 7273 696f  "Parallel versio
+00033a30: 6e20 6f66 2070 616e 6461 732e 4461 7461  n of pandas.Data
+00033a40: 4672 616d 652e 6170 706c 790a 0a20 2020  Frame.apply..   
+00033a50: 2020 2020 2054 6869 7320 6d69 6d69 6373       This mimics
+00033a60: 2074 6865 2070 616e 6461 7320 7665 7273   the pandas vers
+00033a70: 696f 6e20 6578 6365 7074 2066 6f72 2074  ion except for t
+00033a80: 6865 2066 6f6c 6c6f 7769 6e67 3a0a 0a20  he following:.. 
+00033a90: 2020 2020 2020 2031 2e20 204f 6e6c 7920         1.  Only 
+00033aa0: 6060 6178 6973 3d31 6060 2069 7320 7375  ``axis=1`` is su
+00033ab0: 7070 6f72 7465 6420 2861 6e64 206d 7573  pported (and mus
+00033ac0: 7420 6265 2073 7065 6369 6669 6564 2065  t be specified e
+00033ad0: 7870 6c69 6369 746c 7929 2e0a 2020 2020  xplicitly)..    
+00033ae0: 2020 2020 322e 2020 5468 6520 7573 6572      2.  The user
+00033af0: 2073 686f 756c 6420 7072 6f76 6964 6520   should provide 
+00033b00: 6f75 7470 7574 206d 6574 6164 6174 6120  output metadata 
+00033b10: 7669 6120 7468 6520 606d 6574 6160 206b  via the `meta` k
+00033b20: 6579 776f 7264 2e0a 0a20 2020 2020 2020  eyword...       
+00033b30: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00033b40: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00033b50: 2020 2020 2020 2066 756e 6320 3a20 6675         func : fu
+00033b60: 6e63 7469 6f6e 0a20 2020 2020 2020 2020  nction.         
+00033b70: 2020 2046 756e 6374 696f 6e20 746f 2061     Function to a
+00033b80: 7070 6c79 2074 6f20 6561 6368 2063 6f6c  pply to each col
+00033b90: 756d 6e2f 726f 770a 2020 2020 2020 2020  umn/row.        
+00033ba0: 6178 6973 203a 207b 3020 6f72 2027 696e  axis : {0 or 'in
+00033bb0: 6465 7827 2c20 3120 6f72 2027 636f 6c75  dex', 1 or 'colu
+00033bc0: 6d6e 7327 7d2c 2064 6566 6175 6c74 2030  mns'}, default 0
+00033bd0: 0a20 2020 2020 2020 2020 2020 202d 2030  .            - 0
+00033be0: 206f 7220 2769 6e64 6578 273a 2061 7070   or 'index': app
+00033bf0: 6c79 2066 756e 6374 696f 6e20 746f 2065  ly function to e
+00033c00: 6163 6820 636f 6c75 6d6e 2028 4e4f 5420  ach column (NOT 
+00033c10: 5355 5050 4f52 5445 4429 0a20 2020 2020  SUPPORTED).     
+00033c20: 2020 2020 2020 202d 2031 206f 7220 2763         - 1 or 'c
+00033c30: 6f6c 756d 6e73 273a 2061 7070 6c79 2066  olumns': apply f
+00033c40: 756e 6374 696f 6e20 746f 2065 6163 6820  unction to each 
+00033c50: 726f 770a 2020 2020 2020 2020 244d 4554  row.        $MET
+00033c60: 410a 2020 2020 2020 2020 6172 6773 203a  A.        args :
+00033c70: 2074 7570 6c65 0a20 2020 2020 2020 2020   tuple.         
+00033c80: 2020 2050 6f73 6974 696f 6e61 6c20 6172     Positional ar
+00033c90: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
+00033ca0: 746f 2066 756e 6374 696f 6e20 696e 2061  to function in a
+00033cb0: 6464 6974 696f 6e20 746f 2074 6865 2061  ddition to the a
+00033cc0: 7272 6179 2f73 6572 6965 730a 0a20 2020  rray/series..   
+00033cd0: 2020 2020 2041 6464 6974 696f 6e61 6c20       Additional 
+00033ce0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+00033cf0: 7320 7769 6c6c 2062 6520 7061 7373 6564  s will be passed
+00033d00: 2061 7320 6b65 7977 6f72 6473 2074 6f20   as keywords to 
+00033d10: 7468 6520 6675 6e63 7469 6f6e 0a0a 2020  the function..  
+00033d20: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00033d30: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00033d40: 2020 2020 2020 6170 706c 6965 6420 3a20        applied : 
+00033d50: 5365 7269 6573 206f 7220 4461 7461 4672  Series or DataFr
+00033d60: 616d 650a 0a20 2020 2020 2020 2045 7861  ame..        Exa
+00033d70: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+00033d80: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+00033d90: 3e3e 2069 6d70 6f72 7420 7061 6e64 6173  >> import pandas
+00033da0: 2061 7320 7064 0a20 2020 2020 2020 203e   as pd.        >
+00033db0: 3e3e 2069 6d70 6f72 7420 6461 736b 2e64  >> import dask.d
+00033dc0: 6174 6166 7261 6d65 2061 7320 6464 0a20  ataframe as dd. 
+00033dd0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+00033de0: 7064 2e44 6174 6146 7261 6d65 287b 2778  pd.DataFrame({'x
+00033df0: 273a 205b 312c 2032 2c20 332c 2034 2c20  ': [1, 2, 3, 4, 
+00033e00: 355d 2c0a 2020 2020 2020 2020 2e2e 2e20  5],.        ... 
+00033e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033e20: 2020 2027 7927 3a20 5b31 2e2c 2032 2e2c     'y': [1., 2.,
+00033e30: 2033 2e2c 2034 2e2c 2035 2e5d 7d29 0a20   3., 4., 5.]}). 
+00033e40: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
+00033e50: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
+00033e60: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
+00033e70: 3229 0a0a 2020 2020 2020 2020 4170 706c  2)..        Appl
+00033e80: 7920 6120 6675 6e63 7469 6f6e 2074 6f20  y a function to 
+00033e90: 726f 772d 7769 7365 2070 6173 7369 6e67  row-wise passing
+00033ea0: 2069 6e20 6578 7472 6120 6172 6775 6d65   in extra argume
+00033eb0: 6e74 7320 696e 2060 6061 7267 7360 6020  nts in ``args`` 
+00033ec0: 616e 640a 2020 2020 2020 2020 6060 6b77  and.        ``kw
+00033ed0: 6172 6773 6060 3a0a 0a20 2020 2020 2020  args``:..       
+00033ee0: 203e 3e3e 2064 6566 206d 7961 6464 2872   >>> def myadd(r
+00033ef0: 6f77 2c20 612c 2062 3d31 293a 0a20 2020  ow, a, b=1):.   
+00033f00: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
+00033f10: 7572 6e20 726f 772e 7375 6d28 2920 2b20  urn row.sum() + 
+00033f20: 6120 2b20 620a 2020 2020 2020 2020 3e3e  a + b.        >>
+00033f30: 3e20 7265 7320 3d20 6464 662e 6170 706c  > res = ddf.appl
+00033f40: 7928 6d79 6164 642c 2061 7869 733d 312c  y(myadd, axis=1,
+00033f50: 2061 7267 733d 2832 2c29 2c20 623d 312e   args=(2,), b=1.
+00033f60: 3529 2020 2320 646f 6374 6573 743a 202b  5)  # doctest: +
+00033f70: 534b 4950 0a0a 2020 2020 2020 2020 4279  SKIP..        By
+00033f80: 2064 6566 6175 6c74 2c20 6461 736b 2074   default, dask t
+00033f90: 7269 6573 2074 6f20 696e 6665 7220 7468  ries to infer th
+00033fa0: 6520 6f75 7470 7574 206d 6574 6164 6174  e output metadat
+00033fb0: 6120 6279 2072 756e 6e69 6e67 2079 6f75  a by running you
+00033fc0: 720a 2020 2020 2020 2020 7072 6f76 6964  r.        provid
+00033fd0: 6564 2066 756e 6374 696f 6e20 6f6e 2073  ed function on s
+00033fe0: 6f6d 6520 6661 6b65 2064 6174 612e 2054  ome fake data. T
+00033ff0: 6869 7320 776f 726b 7320 7765 6c6c 2069  his works well i
+00034000: 6e20 6d61 6e79 2063 6173 6573 2c20 6275  n many cases, bu
+00034010: 740a 2020 2020 2020 2020 6361 6e20 736f  t.        can so
+00034020: 6d65 7469 6d65 7320 6265 2065 7870 656e  metimes be expen
+00034030: 7369 7665 2c20 6f72 2065 7665 6e20 6661  sive, or even fa
+00034040: 696c 2e20 546f 2061 766f 6964 2074 6869  il. To avoid thi
+00034050: 732c 2079 6f75 2063 616e 0a20 2020 2020  s, you can.     
+00034060: 2020 206d 616e 7561 6c6c 7920 7370 6563     manually spec
+00034070: 6966 7920 7468 6520 6f75 7470 7574 206d  ify the output m
+00034080: 6574 6164 6174 6120 7769 7468 2074 6865  etadata with the
+00034090: 2060 606d 6574 6160 6020 6b65 7977 6f72   ``meta`` keywor
+000340a0: 642e 2054 6869 730a 2020 2020 2020 2020  d. This.        
+000340b0: 6361 6e20 6265 2073 7065 6369 6669 6564  can be specified
+000340c0: 2069 6e20 6d61 6e79 2066 6f72 6d73 2c20   in many forms, 
+000340d0: 666f 7220 6d6f 7265 2069 6e66 6f72 6d61  for more informa
+000340e0: 7469 6f6e 2073 6565 0a20 2020 2020 2020  tion see.       
+000340f0: 2060 6064 6173 6b2e 6461 7461 6672 616d   ``dask.datafram
+00034100: 652e 7574 696c 732e 6d61 6b65 5f6d 6574  e.utils.make_met
+00034110: 6160 602e 0a0a 2020 2020 2020 2020 4865  a``...        He
+00034120: 7265 2077 6520 7370 6563 6966 7920 7468  re we specify th
+00034130: 6520 6f75 7470 7574 2069 7320 6120 5365  e output is a Se
+00034140: 7269 6573 2077 6974 6820 6e61 6d65 2060  ries with name `
+00034150: 6027 7827 6060 2c20 616e 6420 6474 7970  `'x'``, and dtyp
+00034160: 650a 2020 2020 2020 2020 6060 666c 6f61  e.        ``floa
+00034170: 7436 3460 603a 0a0a 2020 2020 2020 2020  t64``:..        
+00034180: 3e3e 3e20 7265 7320 3d20 6464 662e 6170  >>> res = ddf.ap
+00034190: 706c 7928 6d79 6164 642c 2061 7869 733d  ply(myadd, axis=
+000341a0: 312c 2061 7267 733d 2832 2c29 2c20 623d  1, args=(2,), b=
+000341b0: 312e 352c 206d 6574 613d 2827 7827 2c20  1.5, meta=('x', 
+000341c0: 2766 3827 2929 0a0a 2020 2020 2020 2020  'f8'))..        
+000341d0: 496e 2074 6865 2063 6173 6520 7768 6572  In the case wher
+000341e0: 6520 7468 6520 6d65 7461 6461 7461 2064  e the metadata d
+000341f0: 6f65 736e 2774 2063 6861 6e67 652c 2079  oesn't change, y
+00034200: 6f75 2063 616e 2061 6c73 6f20 7061 7373  ou can also pass
+00034210: 2069 6e0a 2020 2020 2020 2020 7468 6520   in.        the 
+00034220: 6f62 6a65 6374 2069 7473 656c 6620 6469  object itself di
+00034230: 7265 6374 6c79 3a0a 0a20 2020 2020 2020  rectly:..       
+00034240: 203e 3e3e 2072 6573 203d 2064 6466 2e61   >>> res = ddf.a
+00034250: 7070 6c79 286c 616d 6264 6120 726f 773a  pply(lambda row:
+00034260: 2072 6f77 202b 2031 2c20 6178 6973 3d31   row + 1, axis=1
+00034270: 2c20 6d65 7461 3d64 6466 290a 0a20 2020  , meta=ddf)..   
+00034280: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+00034290: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+000342a0: 2020 2020 2020 2064 6173 6b2e 4461 7461         dask.Data
+000342b0: 4672 616d 652e 6d61 705f 7061 7274 6974  Frame.map_partit
+000342c0: 696f 6e73 0a20 2020 2020 2020 2022 2222  ions.        """
+000342d0: 0a0a 2020 2020 2020 2020 6966 2062 726f  ..        if bro
+000342e0: 6164 6361 7374 2069 7320 6e6f 7420 4e6f  adcast is not No
+000342f0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00034300: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
+00034310: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00034320: 5468 6520 6062 726f 6164 6361 7374 6020  The `broadcast` 
+00034330: 6172 6775 6d65 6e74 2069 7320 6e6f 206c  argument is no l
+00034340: 6f6e 6765 7220 7573 6564 2f73 7570 706f  onger used/suppo
+00034350: 7274 6564 2e20 220a 2020 2020 2020 2020  rted. ".        
+00034360: 2020 2020 2020 2020 2249 7420 7769 6c6c          "It will
+00034370: 2062 6520 6472 6f70 7065 6420 696e 2061   be dropped in a
+00034380: 2066 7574 7572 6520 7265 6c65 6173 652e   future release.
+00034390: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000343a0: 2020 2063 6174 6567 6f72 793d 4675 7475     category=Futu
+000343b0: 7265 5761 726e 696e 672c 0a20 2020 2020  reWarning,.     
+000343c0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+000343d0: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
+000343e0: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
+000343f0: 7329 0a20 2020 2020 2020 2070 616e 6461  s).        panda
+00034400: 735f 6b77 6172 6773 203d 207b 2261 7869  s_kwargs = {"axi
+00034410: 7322 3a20 6178 6973 2c20 2272 6177 223a  s": axis, "raw":
+00034420: 2072 6177 2c20 2272 6573 756c 745f 7479   raw, "result_ty
+00034430: 7065 223a 2072 6573 756c 745f 7479 7065  pe": result_type
+00034440: 7d0a 0a20 2020 2020 2020 206b 7764 732e  }..        kwds.
+00034450: 7570 6461 7465 2870 616e 6461 735f 6b77  update(pandas_kw
+00034460: 6172 6773 290a 0a20 2020 2020 2020 2069  args)..        i
+00034470: 6620 6178 6973 203d 3d20 303a 0a20 2020  f axis == 0:.   
+00034480: 2020 2020 2020 2020 206d 7367 203d 2028           msg = (
+00034490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000344a0: 2022 6464 2e44 6174 6146 7261 6d65 2e61   "dd.DataFrame.a
+000344b0: 7070 6c79 206f 6e6c 7920 7375 7070 6f72  pply only suppor
+000344c0: 7473 2061 7869 733d 315c 6e22 0a20 2020  ts axis=1\n".   
+000344d0: 2020 2020 2020 2020 2020 2020 2022 2020               "  
+000344e0: 5472 793a 2064 662e 6170 706c 7928 6675  Try: df.apply(fu
+000344f0: 6e63 2c20 6178 6973 3d31 2922 0a20 2020  nc, axis=1)".   
+00034500: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00034510: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00034520: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00034530: 286d 7367 290a 0a20 2020 2020 2020 2069  (msg)..        i
+00034540: 6620 6d65 7461 2069 7320 6e6f 5f64 6566  f meta is no_def
+00034550: 6175 6c74 3a0a 2020 2020 2020 2020 2020  ault:.          
+00034560: 2020 6d65 7461 203d 205f 656d 756c 6174    meta = _emulat
+00034570: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00034580: 2020 204d 2e61 7070 6c79 2c20 7365 6c66     M.apply, self
+00034590: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792c  ._meta_nonempty,
+000345a0: 2066 756e 632c 2061 7267 733d 6172 6773   func, args=args
+000345b0: 2c20 7564 663d 5472 7565 2c20 2a2a 6b77  , udf=True, **kw
+000345c0: 6473 0a20 2020 2020 2020 2020 2020 2029  ds.            )
+000345d0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+000345e0: 6e69 6e67 732e 7761 726e 286d 6574 615f  nings.warn(meta_
+000345f0: 7761 726e 696e 6728 6d65 7461 2929 0a20  warning(meta)). 
+00034600: 2020 2020 2020 206b 7764 732e 7570 6461         kwds.upda
+00034610: 7465 287b 2270 6172 656e 745f 6d65 7461  te({"parent_meta
+00034620: 223a 2073 656c 662e 5f6d 6574 617d 290a  ": self._meta}).
+00034630: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+00034640: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
+00034650: 6170 706c 792c 2073 656c 662c 2066 756e  apply, self, fun
+00034660: 632c 2061 7267 733d 6172 6773 2c20 6d65  c, args=args, me
+00034670: 7461 3d6d 6574 612c 202a 2a6b 7764 7329  ta=meta, **kwds)
+00034680: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00034690: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+000346a0: 290a 2020 2020 6465 6620 6170 706c 796d  ).    def applym
+000346b0: 6170 2873 656c 662c 2066 756e 632c 206d  ap(self, func, m
+000346c0: 6574 613d 6e6f 5f64 6566 6175 6c74 293a  eta=no_default):
+000346d0: 0a20 2020 2020 2020 2023 204c 6574 2070  .        # Let p
+000346e0: 616e 6461 7320 7261 6973 6520 6465 7072  andas raise depr
+000346f0: 6563 6174 696f 6e20 7761 726e 696e 6773  ecation warnings
+00034700: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
+00034710: 6574 612e 6170 706c 796d 6170 2866 756e  eta.applymap(fun
+00034720: 6329 0a20 2020 2020 2020 2072 6574 7572  c).        retur
+00034730: 6e20 656c 656d 7769 7365 286d 6574 686f  n elemwise(metho
+00034740: 6473 2e61 7070 6c79 6d61 702c 2073 656c  ds.applymap, sel
+00034750: 662c 2066 756e 632c 206d 6574 613d 6d65  f, func, meta=me
+00034760: 7461 290a 0a20 2020 2064 6566 206d 6170  ta)..    def map
+00034770: 2873 656c 662c 2066 756e 632c 206d 6574  (self, func, met
+00034780: 613d 6e6f 5f64 6566 6175 6c74 293a 0a20  a=no_default):. 
+00034790: 2020 2020 2020 2069 6620 6e6f 7420 5041         if not PA
+000347a0: 4e44 4153 5f47 545f 3231 303a 0a20 2020  NDAS_GT_210:.   
+000347b0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+000347c0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+000347d0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+000347e0: 2020 2020 6622 4461 7461 4672 616d 652e      f"DataFrame.
+000347f0: 6d61 7020 7265 7175 6972 6573 2070 616e  map requires pan
+00034800: 6461 733e 3d32 2e31 2e30 2c20 6275 7420  das>=2.1.0, but 
+00034810: 7061 6e64 6173 3d7b 5041 4e44 4153 5f56  pandas={PANDAS_V
+00034820: 4552 5349 4f4e 7d20 6973 2022 0a20 2020  ERSION} is ".   
+00034830: 2020 2020 2020 2020 2020 2020 2022 696e               "in
+00034840: 7374 616c 6c65 642e 220a 2020 2020 2020  stalled.".      
+00034850: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00034860: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
+00034870: 4d2e 6d61 702c 2073 656c 662c 2066 756e  M.map, self, fun
+00034880: 632c 206d 6574 613d 6d65 7461 290a 0a20  c, meta=meta).. 
+00034890: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+000348a0: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+000348b0: 2020 2064 6566 2072 6f75 6e64 2873 656c     def round(sel
+000348c0: 662c 2064 6563 696d 616c 733d 3029 3a0a  f, decimals=0):.
+000348d0: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+000348e0: 6c65 6d77 6973 6528 4d2e 726f 756e 642c  lemwise(M.round,
+000348f0: 2073 656c 662c 2064 6563 696d 616c 7329   self, decimals)
+00034900: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00034910: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00034920: 290a 2020 2020 6465 6620 6e75 6e69 7175  ).    def nuniqu
+00034930: 6528 7365 6c66 2c20 7370 6c69 745f 6576  e(self, split_ev
+00034940: 6572 793d 4661 6c73 652c 2064 726f 706e  ery=False, dropn
+00034950: 613d 5472 7565 2c20 6178 6973 3d30 293a  a=True, axis=0):
+00034960: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
+00034970: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00034980: 2020 2023 2073 706c 6974 5f65 7665 7279     # split_every
+00034990: 206e 6f74 2075 7365 6420 666f 7220 6178   not used for ax
+000349a0: 6973 3d31 0a20 2020 2020 2020 2020 2020  is=1.           
+000349b0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+000349c0: 7461 5f6e 6f6e 656d 7074 792e 6e75 6e69  ta_nonempty.nuni
+000349d0: 7175 6528 6178 6973 3d61 7869 7329 0a20  que(axis=axis). 
+000349e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000349f0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+00034a00: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+00034a10: 2020 2020 2020 204d 2e6e 756e 6971 7565         M.nunique
+00034a20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00034a30: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
+00034a40: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
+00034a50: 656e 3d22 7365 7269 6573 2d6e 756e 6971  en="series-nuniq
+00034a60: 7565 222c 0a20 2020 2020 2020 2020 2020  ue",.           
+00034a70: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
+00034a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034a90: 6472 6f70 6e61 3d64 726f 706e 612c 0a20  dropna=dropna,. 
+00034aa0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00034ab0: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+00034ac0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00034ad0: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
+00034ae0: 653a 0a20 2020 2020 2020 2020 2020 206e  e:.            n
+00034af0: 756e 6971 7565 5f6c 6973 7420 3d20 5b0a  unique_list = [.
+00034b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034b10: 7365 6c66 5b63 6f6c 5d2e 6e75 6e69 7175  self[col].nuniqu
+00034b20: 6528 7370 6c69 745f 6576 6572 793d 7370  e(split_every=sp
+00034b30: 6c69 745f 6576 6572 792c 2064 726f 706e  lit_every, dropn
+00034b40: 613d 6472 6f70 6e61 290a 2020 2020 2020  a=dropna).      
+00034b50: 2020 2020 2020 2020 2020 666f 7220 636f            for co
+00034b60: 6c20 696e 2073 656c 662e 636f 6c75 6d6e  l in self.column
+00034b70: 730a 2020 2020 2020 2020 2020 2020 5d0a  s.            ].
+00034b80: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00034b90: 203d 2022 7365 7269 6573 2d22 202b 2074   = "series-" + t
+00034ba0: 6f6b 656e 697a 6528 2a6e 756e 6971 7565  okenize(*nunique
+00034bb0: 5f6c 6973 7429 0a20 2020 2020 2020 2020  _list).         
+00034bc0: 2020 2064 736b 203d 207b 0a20 2020 2020     dsk = {.     
+00034bd0: 2020 2020 2020 2020 2020 2028 6e61 6d65             (name
+00034be0: 2c20 3029 3a20 280a 2020 2020 2020 2020  , 0): (.        
+00034bf0: 2020 2020 2020 2020 2020 2020 6170 706c              appl
+00034c00: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00034c10: 2020 2020 2020 2070 642e 5365 7269 6573         pd.Series
+00034c20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00034c30: 2020 2020 2020 5b5b 2873 2e5f 6e61 6d65        [[(s._name
+00034c40: 2c20 3029 2066 6f72 2073 2069 6e20 6e75  , 0) for s in nu
+00034c50: 6e69 7175 655f 6c69 7374 5d5d 2c0a 2020  nique_list]],.  
+00034c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034c70: 2020 7b22 696e 6465 7822 3a20 7365 6c66    {"index": self
+00034c80: 2e63 6f6c 756d 6e73 7d2c 0a20 2020 2020  .columns},.     
+00034c90: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00034ca0: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
+00034cb0: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
+00034cc0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+00034cd0: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 280a  om_collections(.
+00034ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034cf0: 6e61 6d65 2c20 6473 6b2c 2064 6570 656e  name, dsk, depen
+00034d00: 6465 6e63 6965 733d 6e75 6e69 7175 655f  dencies=nunique_
+00034d10: 6c69 7374 0a20 2020 2020 2020 2020 2020  list.           
+00034d20: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+00034d30: 6574 7572 6e20 5365 7269 6573 2867 7261  eturn Series(gra
+00034d40: 7068 2c20 6e61 6d65 2c20 7365 6c66 2e5f  ph, name, self._
+00034d50: 6d65 7461 2e6e 756e 6971 7565 2829 2c20  meta.nunique(), 
+00034d60: 284e 6f6e 652c 204e 6f6e 6529 290a 0a20  (None, None)).. 
+00034d70: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00034d80: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00034d90: 2020 2064 6566 206d 6f64 6528 7365 6c66     def mode(self
+00034da0: 2c20 6472 6f70 6e61 3d54 7275 652c 2073  , dropna=True, s
+00034db0: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+00034dc0: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d46  , numeric_only=F
+00034dd0: 616c 7365 293a 0a20 2020 2020 2020 206d  alse):.        m
+00034de0: 6f64 655f 7365 7269 6573 5f6c 6973 7420  ode_series_list 
+00034df0: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
+00034e00: 2063 6f6c 5f69 6e64 6578 2069 6e20 7261   col_index in ra
+00034e10: 6e67 6528 6c65 6e28 7365 6c66 2e63 6f6c  nge(len(self.col
+00034e20: 756d 6e73 2929 3a0a 2020 2020 2020 2020  umns)):.        
+00034e30: 2020 2020 636f 6c5f 7365 7269 6573 203d      col_series =
+00034e40: 2073 656c 662e 696c 6f63 5b3a 2c20 636f   self.iloc[:, co
+00034e50: 6c5f 696e 6465 785d 0a20 2020 2020 2020  l_index].       
+00034e60: 2020 2020 2069 6620 6e75 6d65 7269 635f       if numeric_
+00034e70: 6f6e 6c79 2061 6e64 206e 6f74 2070 642e  only and not pd.
+00034e80: 6170 692e 7479 7065 732e 6973 5f6e 756d  api.types.is_num
+00034e90: 6572 6963 5f64 7479 7065 2863 6f6c 5f73  eric_dtype(col_s
+00034ea0: 6572 6965 732e 6474 7970 6529 3a0a 2020  eries.dtype):.  
+00034eb0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00034ec0: 6e74 696e 7565 0a20 2020 2020 2020 2020  ntinue.         
+00034ed0: 2020 206d 6f64 655f 7365 7269 6573 203d     mode_series =
+00034ee0: 2053 6572 6965 732e 6d6f 6465 280a 2020   Series.mode(.  
+00034ef0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00034f00: 6c5f 7365 7269 6573 2c20 6472 6f70 6e61  l_series, dropna
+00034f10: 3d64 726f 706e 612c 2073 706c 6974 5f65  =dropna, split_e
+00034f20: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+00034f30: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00034f40: 2020 2020 2020 2020 2020 206d 6f64 655f             mode_
+00034f50: 7365 7269 6573 5f6c 6973 742e 6170 7065  series_list.appe
+00034f60: 6e64 286d 6f64 655f 7365 7269 6573 290a  nd(mode_series).
+00034f70: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
+00034f80: 2263 6f6e 6361 742d 2220 2b20 746f 6b65  "concat-" + toke
+00034f90: 6e69 7a65 282a 6d6f 6465 5f73 6572 6965  nize(*mode_serie
+00034fa0: 735f 6c69 7374 290a 0a20 2020 2020 2020  s_list)..       
+00034fb0: 2064 736b 203d 207b 0a20 2020 2020 2020   dsk = {.       
+00034fc0: 2020 2020 2028 6e61 6d65 2c20 3029 3a20       (name, 0): 
+00034fd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00034fe0: 2020 6170 706c 792c 0a20 2020 2020 2020    apply,.       
+00034ff0: 2020 2020 2020 2020 206d 6574 686f 6473           methods
+00035000: 2e63 6f6e 6361 742c 0a20 2020 2020 2020  .concat,.       
+00035010: 2020 2020 2020 2020 205b 5b28 6466 2e5f           [[(df._
+00035020: 6e61 6d65 2c20 3029 2066 6f72 2064 6620  name, 0) for df 
+00035030: 696e 206d 6f64 655f 7365 7269 6573 5f6c  in mode_series_l
+00035040: 6973 745d 5d2c 0a20 2020 2020 2020 2020  ist]],.         
+00035050: 2020 2020 2020 207b 2261 7869 7322 3a20         {"axis": 
+00035060: 317d 2c0a 2020 2020 2020 2020 2020 2020  1},.            
+00035070: 290a 2020 2020 2020 2020 7d0a 0a20 2020  ).        }..   
+00035080: 2020 2020 206d 6574 6120 3d20 6d65 7468       meta = meth
+00035090: 6f64 732e 636f 6e63 6174 285b 6466 2e5f  ods.concat([df._
+000350a0: 6d65 7461 2066 6f72 2064 6620 696e 206d  meta for df in m
+000350b0: 6f64 655f 7365 7269 6573 5f6c 6973 745d  ode_series_list]
+000350c0: 2c20 6178 6973 3d31 290a 2020 2020 2020  , axis=1).      
+000350d0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+000350e0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+000350f0: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
+00035100: 2020 2020 2020 206e 616d 652c 2064 736b         name, dsk
+00035110: 2c20 6465 7065 6e64 656e 6369 6573 3d6d  , dependencies=m
+00035120: 6f64 655f 7365 7269 6573 5f6c 6973 740a  ode_series_list.
+00035130: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00035140: 2020 6464 6620 3d20 6e65 775f 6464 5f6f    ddf = new_dd_o
+00035150: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
+00035160: 652c 206d 6574 612c 2064 6976 6973 696f  e, meta, divisio
+00035170: 6e73 3d28 4e6f 6e65 2c20 4e6f 6e65 2929  ns=(None, None))
+00035180: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00035190: 2064 6466 0a0a 2020 2020 4064 6572 6976   ddf..    @deriv
+000351a0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+000351b0: 7261 6d65 290a 2020 2020 6465 6620 636f  rame).    def co
+000351c0: 7628 7365 6c66 2c20 6d69 6e5f 7065 7269  v(self, min_peri
+000351d0: 6f64 733d 4e6f 6e65 2c20 6e75 6d65 7269  ods=None, numeri
+000351e0: 635f 6f6e 6c79 3d6e 6f5f 6465 6661 756c  c_only=no_defaul
+000351f0: 742c 2073 706c 6974 5f65 7665 7279 3d46  t, split_every=F
+00035200: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
+00035210: 6574 7572 6e20 5f63 6f76 5f63 6f72 7228  eturn _cov_corr(
+00035220: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00035230: 662c 206d 696e 5f70 6572 696f 6473 2c20  f, min_periods, 
+00035240: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 756d  numeric_only=num
+00035250: 6572 6963 5f6f 6e6c 792c 2073 706c 6974  eric_only, split
+00035260: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+00035270: 7279 0a20 2020 2020 2020 2029 0a0a 2020  ry.        )..  
+00035280: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00035290: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+000352a0: 2020 6465 6620 636f 7272 280a 2020 2020    def corr(.    
+000352b0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+000352c0: 2020 6d65 7468 6f64 3d22 7065 6172 736f    method="pearso
+000352d0: 6e22 2c0a 2020 2020 2020 2020 6d69 6e5f  n",.        min_
+000352e0: 7065 7269 6f64 733d 4e6f 6e65 2c0a 2020  periods=None,.  
+000352f0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+00035300: 6c79 3d6e 6f5f 6465 6661 756c 742c 0a20  ly=no_default,. 
+00035310: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+00035320: 7279 3d46 616c 7365 2c0a 2020 2020 293a  ry=False,.    ):
+00035330: 0a20 2020 2020 2020 2069 6620 6d65 7468  .        if meth
+00035340: 6f64 2021 3d20 2270 6561 7273 6f6e 223a  od != "pearson":
+00035350: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00035360: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00035370: 6445 7272 6f72 2822 4f6e 6c79 2050 6561  dError("Only Pea
+00035380: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
+00035390: 2068 6173 2062 6565 6e20 696d 706c 656d   has been implem
+000353a0: 656e 7465 6422 290a 0a20 2020 2020 2020  ented")..       
+000353b0: 2072 6574 7572 6e20 5f63 6f76 5f63 6f72   return _cov_cor
+000353c0: 7228 0a20 2020 2020 2020 2020 2020 2073  r(.            s
+000353d0: 656c 662c 206d 696e 5f70 6572 696f 6473  elf, min_periods
+000353e0: 2c20 5472 7565 2c20 6e75 6d65 7269 635f  , True, numeric_
+000353f0: 6f6e 6c79 3d6e 756d 6572 6963 5f6f 6e6c  only=numeric_onl
+00035400: 792c 2073 706c 6974 5f65 7665 7279 3d73  y, split_every=s
+00035410: 706c 6974 5f65 7665 7279 0a20 2020 2020  plit_every.     
+00035420: 2020 2029 0a0a 2020 2020 6465 6620 696e     )..    def in
+00035430: 666f 2873 656c 662c 2062 7566 3d4e 6f6e  fo(self, buf=Non
+00035440: 652c 2076 6572 626f 7365 3d46 616c 7365  e, verbose=False
+00035450: 2c20 6d65 6d6f 7279 5f75 7361 6765 3d46  , memory_usage=F
+00035460: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
+00035470: 2222 0a20 2020 2020 2020 2043 6f6e 6369  "".        Conci
+00035480: 7365 2073 756d 6d61 7279 206f 6620 6120  se summary of a 
+00035490: 4461 736b 2044 6174 6146 7261 6d65 2e0a  Dask DataFrame..
+000354a0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+000354b0: 2020 2020 2069 6620 6275 6620 6973 204e       if buf is N
+000354c0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000354d0: 2069 6d70 6f72 7420 7379 730a 0a20 2020   import sys..   
+000354e0: 2020 2020 2020 2020 2062 7566 203d 2073           buf = s
+000354f0: 7973 2e73 7464 6f75 740a 0a20 2020 2020  ys.stdout..     
+00035500: 2020 206c 696e 6573 203d 205b 7374 7228     lines = [str(
+00035510: 7479 7065 2873 656c 6629 295d 0a0a 2020  type(self))]..  
+00035520: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
+00035530: 662e 636f 6c75 6d6e 7329 203d 3d20 303a  f.columns) == 0:
+00035540: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
+00035550: 6573 2e61 7070 656e 6428 6622 7b74 7970  es.append(f"{typ
+00035560: 6528 7365 6c66 2e69 6e64 6578 2e5f 6d65  e(self.index._me
+00035570: 7461 292e 5f5f 6e61 6d65 5f5f 7d3a 2030  ta).__name__}: 0
+00035580: 2065 6e74 7269 6573 2229 0a20 2020 2020   entries").     
+00035590: 2020 2020 2020 206c 696e 6573 2e61 7070         lines.app
+000355a0: 656e 6428 6622 456d 7074 7920 7b74 7970  end(f"Empty {typ
+000355b0: 6528 7365 6c66 292e 5f5f 6e61 6d65 5f5f  e(self).__name__
+000355c0: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
+000355d0: 6966 2050 414e 4441 535f 4754 5f31 3530  if PANDAS_GT_150
+000355e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000355f0: 2020 2320 7061 6e64 6173 2064 6174 6166    # pandas dataf
+00035600: 7261 6d65 2073 7461 7274 6564 2061 6464  rame started add
+00035610: 696e 6720 6120 6e65 776c 696e 6520 7768  ing a newline wh
+00035620: 656e 2069 6e66 6f20 6973 2063 616c 6c65  en info is calle
+00035630: 642e 0a20 2020 2020 2020 2020 2020 2020  d..             
+00035640: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
+00035650: 2222 290a 2020 2020 2020 2020 2020 2020  "").            
+00035660: 7075 745f 6c69 6e65 7328 6275 662c 206c  put_lines(buf, l
+00035670: 696e 6573 290a 2020 2020 2020 2020 2020  ines).          
+00035680: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+00035690: 2020 2320 4772 6f75 7020 616e 6420 6578    # Group and ex
+000356a0: 6563 7574 6520 7468 6520 7265 7175 6972  ecute the requir
+000356b0: 6564 2063 6f6d 7075 7461 7469 6f6e 730a  ed computations.
+000356c0: 2020 2020 2020 2020 636f 6d70 7574 6174          computat
+000356d0: 696f 6e73 203d 207b 7d0a 2020 2020 2020  ions = {}.      
+000356e0: 2020 6966 2076 6572 626f 7365 3a0a 2020    if verbose:.  
+000356f0: 2020 2020 2020 2020 2020 6d65 6d6f 7279            memory
+00035700: 5f75 7361 6765 203d 2054 7275 650a 2020  _usage = True.  
+00035710: 2020 2020 2020 2020 2020 636f 6d70 7574            comput
+00035720: 6174 696f 6e73 2e75 7064 6174 6528 7b22  ations.update({"
+00035730: 696e 6465 7822 3a20 7365 6c66 2e69 6e64  index": self.ind
+00035740: 6578 2c20 2263 6f75 6e74 223a 2073 656c  ex, "count": sel
+00035750: 662e 636f 756e 7428 297d 290a 2020 2020  f.count()}).    
+00035760: 2020 2020 6966 206d 656d 6f72 795f 7573      if memory_us
+00035770: 6167 653a 0a20 2020 2020 2020 2020 2020  age:.           
+00035780: 2063 6f6d 7075 7461 7469 6f6e 732e 7570   computations.up
+00035790: 6461 7465 280a 2020 2020 2020 2020 2020  date(.          
+000357a0: 2020 2020 2020 7b22 6d65 6d6f 7279 5f75        {"memory_u
+000357b0: 7361 6765 223a 2073 656c 662e 6d61 705f  sage": self.map_
+000357c0: 7061 7274 6974 696f 6e73 284d 2e6d 656d  partitions(M.mem
+000357d0: 6f72 795f 7573 6167 652c 2069 6e64 6578  ory_usage, index
+000357e0: 3d54 7275 6529 7d0a 2020 2020 2020 2020  =True)}.        
+000357f0: 2020 2020 290a 2020 2020 2020 2020 636f      ).        co
+00035800: 6d70 7574 6174 696f 6e73 203d 2064 6963  mputations = dic
+00035810: 7428 0a20 2020 2020 2020 2020 2020 207a  t(.            z
+00035820: 6970 2863 6f6d 7075 7461 7469 6f6e 732e  ip(computations.
+00035830: 6b65 7973 2829 2c20 6461 2e63 6f6d 7075  keys(), da.compu
+00035840: 7465 282a 636f 6d70 7574 6174 696f 6e73  te(*computations
+00035850: 2e76 616c 7565 7328 2929 290a 2020 2020  .values())).    
+00035860: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
+00035870: 6620 7665 7262 6f73 653a 0a20 2020 2020  f verbose:.     
+00035880: 2020 2020 2020 2069 6d70 6f72 7420 7465         import te
+00035890: 7874 7772 6170 0a0a 2020 2020 2020 2020  xtwrap..        
+000358a0: 2020 2020 696e 6465 7820 3d20 636f 6d70      index = comp
+000358b0: 7574 6174 696f 6e73 5b22 696e 6465 7822  utations["index"
+000358c0: 5d0a 2020 2020 2020 2020 2020 2020 636f  ].            co
+000358d0: 756e 7473 203d 2063 6f6d 7075 7461 7469  unts = computati
+000358e0: 6f6e 735b 2263 6f75 6e74 225d 0a20 2020  ons["count"].   
+000358f0: 2020 2020 2020 2020 206c 696e 6573 2e61           lines.a
+00035900: 7070 656e 6428 696e 6465 785f 7375 6d6d  ppend(index_summ
+00035910: 6172 7928 696e 6465 7829 290a 2020 2020  ary(index)).    
+00035920: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
+00035930: 7065 6e64 2866 2244 6174 6120 636f 6c75  pend(f"Data colu
+00035940: 6d6e 7320 2874 6f74 616c 207b 6c65 6e28  mns (total {len(
+00035950: 7365 6c66 2e63 6f6c 756d 6e73 297d 2063  self.columns)} c
+00035960: 6f6c 756d 6e73 293a 2229 0a0a 2020 2020  olumns):")..    
+00035970: 2020 2020 2020 2020 6672 6f6d 2070 616e          from pan
+00035980: 6461 732e 696f 2e66 6f72 6d61 7473 2e70  das.io.formats.p
+00035990: 7269 6e74 696e 6720 696d 706f 7274 2070  rinting import p
+000359a0: 7072 696e 745f 7468 696e 670a 0a20 2020  print_thing..   
+000359b0: 2020 2020 2020 2020 2073 7061 6365 203d           space =
+000359c0: 206d 6178 286c 656e 2870 7072 696e 745f   max(len(pprint_
+000359d0: 7468 696e 6728 6b29 2920 666f 7220 6b20  thing(k)) for k 
+000359e0: 696e 2073 656c 662e 636f 6c75 6d6e 7329  in self.columns)
+000359f0: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
+00035a00: 2063 6f6c 756d 6e5f 7769 6474 6820 3d20   column_width = 
+00035a10: 6d61 7828 7370 6163 652c 2037 290a 0a20  max(space, 7).. 
+00035a20: 2020 2020 2020 2020 2020 2068 6561 6465             heade
+00035a30: 7220 3d20 280a 2020 2020 2020 2020 2020  r = (.          
+00035a40: 2020 2020 2020 7465 7874 7772 6170 2e64        textwrap.d
+00035a50: 6564 656e 7428 0a20 2020 2020 2020 2020  edent(.         
+00035a60: 2020 2020 2020 2020 2020 2022 2222 5c0a             """\.
+00035a70: 2020 2020 2020 2020 2020 2020 2023 2020               #  
+00035a80: 207b 7b63 6f6c 756d 6e3a 3c7b 636f 6c75   {{column:<{colu
+00035a90: 6d6e 5f77 6964 7468 7d7d 7d20 4e6f 6e2d  mn_width}}} Non-
+00035aa0: 4e75 6c6c 2043 6f75 6e74 2020 4474 7970  Null Count  Dtyp
+00035ab0: 650a 2020 2020 2020 2020 2020 2020 2d2d  e.            --
+00035ac0: 2d20 207b 7b75 6e64 6572 6c3a 3c7b 636f  -  {{underl:<{co
+00035ad0: 6c75 6d6e 5f77 6964 7468 7d7d 7d20 2d2d  lumn_width}}} --
+00035ae0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2020 2d2d  ------------  --
+00035af0: 2d2d 2d22 2222 0a20 2020 2020 2020 2020  ---""".         
+00035b00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00035b10: 2020 2020 2020 2020 202e 666f 726d 6174           .format
+00035b20: 2863 6f6c 756d 6e5f 7769 6474 683d 636f  (column_width=co
+00035b30: 6c75 6d6e 5f77 6964 7468 290a 2020 2020  lumn_width).    
+00035b40: 2020 2020 2020 2020 2020 2020 2e66 6f72              .for
+00035b50: 6d61 7428 636f 6c75 6d6e 3d22 436f 6c75  mat(column="Colu
+00035b60: 6d6e 222c 2075 6e64 6572 6c3d 222d 2d2d  mn", underl="---
+00035b70: 2d2d 2d22 290a 2020 2020 2020 2020 2020  ---").          
+00035b80: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00035b90: 636f 6c75 6d6e 5f74 656d 706c 6174 6520  column_template 
+00035ba0: 3d20 7465 7874 7772 6170 2e64 6564 656e  = textwrap.deden
+00035bb0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00035bc0: 2020 2022 2222 5c0a 2020 2020 2020 2020     """\.        
+00035bd0: 2020 2020 7b7b 693a 5e33 7d7d 2020 7b7b      {{i:^3}}  {{
+00035be0: 6e61 6d65 3a3c 7b63 6f6c 756d 6e5f 7769  name:<{column_wi
+00035bf0: 6474 687d 7d7d 207b 7b63 6f75 6e74 7d7d  dth}}} {{count}}
+00035c00: 206e 6f6e 2d6e 756c 6c20 2020 2020 207b   non-null      {
+00035c10: 7b64 7479 7065 7d7d 2222 222e 666f 726d  {dtype}}""".form
+00035c20: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+00035c30: 2020 2020 2020 2020 636f 6c75 6d6e 5f77          column_w
+00035c40: 6964 7468 3d63 6f6c 756d 6e5f 7769 6474  idth=column_widt
+00035c50: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
+00035c60: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00035c70: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+00035c80: 6c75 6d6e 5f69 6e66 6f20 3d20 5b0a 2020  lumn_info = [.  
+00035c90: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00035ca0: 6c75 6d6e 5f74 656d 706c 6174 652e 666f  lumn_template.fo
+00035cb0: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
+00035cc0: 2020 2020 2020 2020 2020 693d 7070 7269            i=ppri
+00035cd0: 6e74 5f74 6869 6e67 2869 292c 0a20 2020  nt_thing(i),.   
+00035ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035cf0: 206e 616d 653d 7070 7269 6e74 5f74 6869   name=pprint_thi
+00035d00: 6e67 286e 616d 6529 2c0a 2020 2020 2020  ng(name),.      
+00035d10: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00035d20: 756e 743d 7070 7269 6e74 5f74 6869 6e67  unt=pprint_thing
+00035d30: 2863 6f75 6e74 292c 0a20 2020 2020 2020  (count),.       
+00035d40: 2020 2020 2020 2020 2020 2020 2064 7479               dty
+00035d50: 7065 3d70 7072 696e 745f 7468 696e 6728  pe=pprint_thing(
+00035d60: 6474 7970 6529 2c0a 2020 2020 2020 2020  dtype),.        
+00035d70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00035d80: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
+00035d90: 2028 6e61 6d65 2c20 636f 756e 742c 2064   (name, count, d
+00035da0: 7479 7065 2920 696e 2065 6e75 6d65 7261  type) in enumera
+00035db0: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
+00035dc0: 2020 2020 2020 2020 7a69 7028 7365 6c66          zip(self
+00035dd0: 2e63 6f6c 756d 6e73 2c20 636f 756e 7473  .columns, counts
+00035de0: 2c20 7365 6c66 2e64 7479 7065 7329 0a20  , self.dtypes). 
+00035df0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00035e00: 0a20 2020 2020 2020 2020 2020 205d 0a20  .            ]. 
+00035e10: 2020 2020 2020 2020 2020 206c 696e 6573             lines
+00035e20: 2e65 7874 656e 6428 6865 6164 6572 2e73  .extend(header.s
+00035e30: 706c 6974 2822 5c6e 2229 290a 2020 2020  plit("\n")).    
+00035e40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00035e50: 2020 2020 2020 636f 6c75 6d6e 5f69 6e66        column_inf
+00035e60: 6f20 3d20 5b69 6e64 6578 5f73 756d 6d61  o = [index_summa
+00035e70: 7279 2873 656c 662e 636f 6c75 6d6e 732c  ry(self.columns,
+00035e80: 206e 616d 653d 2243 6f6c 756d 6e73 2229   name="Columns")
+00035e90: 5d0a 0a20 2020 2020 2020 206c 696e 6573  ]..        lines
+00035ea0: 2e65 7874 656e 6428 636f 6c75 6d6e 5f69  .extend(column_i
+00035eb0: 6e66 6f29 0a20 2020 2020 2020 2064 7479  nfo).        dty
+00035ec0: 7065 5f63 6f75 6e74 7320 3d20 5b0a 2020  pe_counts = [.  
+00035ed0: 2020 2020 2020 2020 2020 2225 7328 2564            "%s(%d
+00035ee0: 2922 2025 206b 2066 6f72 206b 2069 6e20  )" % k for k in 
+00035ef0: 736f 7274 6564 2873 656c 662e 6474 7970  sorted(self.dtyp
+00035f00: 6573 2e76 616c 7565 5f63 6f75 6e74 7328  es.value_counts(
+00035f10: 292e 6974 656d 7328 292c 206b 6579 3d73  ).items(), key=s
+00035f20: 7472 290a 2020 2020 2020 2020 5d0a 2020  tr).        ].  
+00035f30: 2020 2020 2020 6c69 6e65 732e 6170 7065        lines.appe
+00035f40: 6e64 2822 6474 7970 6573 3a20 7b7d 222e  nd("dtypes: {}".
+00035f50: 666f 726d 6174 2822 2c20 222e 6a6f 696e  format(", ".join
+00035f60: 2864 7479 7065 5f63 6f75 6e74 7329 2929  (dtype_counts)))
+00035f70: 0a0a 2020 2020 2020 2020 6966 206d 656d  ..        if mem
+00035f80: 6f72 795f 7573 6167 653a 0a20 2020 2020  ory_usage:.     
+00035f90: 2020 2020 2020 206d 656d 6f72 795f 696e         memory_in
+00035fa0: 7420 3d20 636f 6d70 7574 6174 696f 6e73  t = computations
+00035fb0: 5b22 6d65 6d6f 7279 5f75 7361 6765 225d  ["memory_usage"]
+00035fc0: 2e73 756d 2829 0a20 2020 2020 2020 2020  .sum().         
+00035fd0: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
+00035fe0: 6622 6d65 6d6f 7279 2075 7361 6765 3a20  f"memory usage: 
+00035ff0: 7b6d 656d 6f72 795f 7265 7072 286d 656d  {memory_repr(mem
+00036000: 6f72 795f 696e 7429 7d5c 6e22 290a 0a20  ory_int)}\n").. 
+00036010: 2020 2020 2020 2070 7574 5f6c 696e 6573         put_lines
+00036020: 2862 7566 2c20 6c69 6e65 7329 0a0a 2020  (buf, lines)..  
+00036030: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00036040: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+00036050: 2020 6465 6620 6d65 6d6f 7279 5f75 7361    def memory_usa
+00036060: 6765 2873 656c 662c 2069 6e64 6578 3d54  ge(self, index=T
+00036070: 7275 652c 2064 6565 703d 4661 6c73 6529  rue, deep=False)
+00036080: 3a0a 2020 2020 2020 2020 7265 7375 6c74  :.        result
+00036090: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
+000360a0: 6974 696f 6e73 284d 2e6d 656d 6f72 795f  itions(M.memory_
+000360b0: 7573 6167 652c 2069 6e64 6578 3d69 6e64  usage, index=ind
+000360c0: 6578 2c20 6465 6570 3d64 6565 7029 0a20  ex, deep=deep). 
+000360d0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+000360e0: 7265 7375 6c74 2e67 726f 7570 6279 2872  result.groupby(r
+000360f0: 6573 756c 742e 696e 6465 7829 2e73 756d  esult.index).sum
+00036100: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
+00036110: 6e20 7265 7375 6c74 0a0a 2020 2020 6465  n result..    de
+00036120: 6620 7069 766f 745f 7461 626c 6528 7365  f pivot_table(se
+00036130: 6c66 2c20 696e 6465 783d 4e6f 6e65 2c20  lf, index=None, 
+00036140: 636f 6c75 6d6e 733d 4e6f 6e65 2c20 7661  columns=None, va
+00036150: 6c75 6573 3d4e 6f6e 652c 2061 6767 6675  lues=None, aggfu
+00036160: 6e63 3d22 6d65 616e 2229 3a0a 2020 2020  nc="mean"):.    
+00036170: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00036180: 4372 6561 7465 2061 2073 7072 6561 6473  Create a spreads
+00036190: 6865 6574 2d73 7479 6c65 2070 6976 6f74  heet-style pivot
+000361a0: 2074 6162 6c65 2061 7320 6120 4461 7461   table as a Data
+000361b0: 4672 616d 652e 2054 6172 6765 7420 6060  Frame. Target ``
+000361c0: 636f 6c75 6d6e 7360 600a 2020 2020 2020  columns``.      
+000361d0: 2020 6d75 7374 2068 6176 6520 6361 7465    must have cate
+000361e0: 676f 7279 2064 7479 7065 2074 6f20 696e  gory dtype to in
+000361f0: 6665 7220 7265 7375 6c74 2773 2060 6063  fer result's ``c
+00036200: 6f6c 756d 6e73 6060 2e0a 2020 2020 2020  olumns``..      
+00036210: 2020 6060 696e 6465 7860 602c 2060 6063    ``index``, ``c
+00036220: 6f6c 756d 6e73 6060 2c20 6060 7661 6c75  olumns``, ``valu
+00036230: 6573 6060 2061 6e64 2060 6061 6767 6675  es`` and ``aggfu
+00036240: 6e63 6060 206d 7573 7420 6265 2061 6c6c  nc`` must be all
+00036250: 2073 6361 6c61 722e 0a0a 2020 2020 2020   scalar...      
+00036260: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00036270: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00036280: 2020 2020 2020 2020 7661 6c75 6573 203a          values :
+00036290: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
+000362a0: 2020 2020 636f 6c75 6d6e 2074 6f20 6167      column to ag
+000362b0: 6772 6567 6174 650a 2020 2020 2020 2020  gregate.        
+000362c0: 696e 6465 7820 3a20 7363 616c 6172 0a20  index : scalar. 
+000362d0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+000362e0: 6e20 746f 2062 6520 696e 6465 780a 2020  n to be index.  
+000362f0: 2020 2020 2020 636f 6c75 6d6e 7320 3a20        columns : 
+00036300: 7363 616c 6172 0a20 2020 2020 2020 2020  scalar.         
+00036310: 2020 2063 6f6c 756d 6e20 746f 2062 6520     column to be 
+00036320: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
+00036330: 6167 6766 756e 6320 3a20 7b27 6d65 616e  aggfunc : {'mean
+00036340: 272c 2027 7375 6d27 2c20 2763 6f75 6e74  ', 'sum', 'count
+00036350: 277d 2c20 6465 6661 756c 7420 276d 6561  '}, default 'mea
+00036360: 6e27 0a0a 2020 2020 2020 2020 5265 7475  n'..        Retu
+00036370: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+00036380: 2d2d 2d0a 2020 2020 2020 2020 7461 626c  ---.        tabl
+00036390: 6520 3a20 4461 7461 4672 616d 650a 2020  e : DataFrame.  
+000363a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000363b0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+000363c0: 6672 616d 652e 7265 7368 6170 6520 696d  frame.reshape im
+000363d0: 706f 7274 2070 6976 6f74 5f74 6162 6c65  port pivot_table
+000363e0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000363f0: 2070 6976 6f74 5f74 6162 6c65 280a 2020   pivot_table(.  
+00036400: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
+00036410: 696e 6465 783d 696e 6465 782c 2063 6f6c  index=index, col
+00036420: 756d 6e73 3d63 6f6c 756d 6e73 2c20 7661  umns=columns, va
+00036430: 6c75 6573 3d76 616c 7565 732c 2061 6767  lues=values, agg
+00036440: 6675 6e63 3d61 6767 6675 6e63 0a20 2020  func=aggfunc.   
+00036450: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00036460: 6d65 6c74 280a 2020 2020 2020 2020 7365  melt(.        se
+00036470: 6c66 2c0a 2020 2020 2020 2020 6964 5f76  lf,.        id_v
+00036480: 6172 733d 4e6f 6e65 2c0a 2020 2020 2020  ars=None,.      
+00036490: 2020 7661 6c75 655f 7661 7273 3d4e 6f6e    value_vars=Non
+000364a0: 652c 0a20 2020 2020 2020 2076 6172 5f6e  e,.        var_n
+000364b0: 616d 653d 4e6f 6e65 2c0a 2020 2020 2020  ame=None,.      
+000364c0: 2020 7661 6c75 655f 6e61 6d65 3d22 7661    value_name="va
+000364d0: 6c75 6522 2c0a 2020 2020 2020 2020 636f  lue",.        co
+000364e0: 6c5f 6c65 7665 6c3d 4e6f 6e65 2c0a 2020  l_level=None,.  
+000364f0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00036500: 0a20 2020 2020 2020 2055 6e70 6976 6f74  .        Unpivot
+00036510: 7320 6120 4461 7461 4672 616d 6520 6672  s a DataFrame fr
+00036520: 6f6d 2077 6964 6520 666f 726d 6174 2074  om wide format t
+00036530: 6f20 6c6f 6e67 2066 6f72 6d61 742c 0a20  o long format,. 
+00036540: 2020 2020 2020 206f 7074 696f 6e61 6c6c         optionall
+00036550: 7920 6c65 6176 696e 6720 6964 656e 7469  y leaving identi
+00036560: 6669 6572 2076 6172 6961 626c 6573 2073  fier variables s
+00036570: 6574 2e0a 0a20 2020 2020 2020 2054 6869  et...        Thi
+00036580: 7320 6675 6e63 7469 6f6e 2069 7320 7573  s function is us
+00036590: 6566 756c 2074 6f20 6d61 7373 6167 6520  eful to massage 
+000365a0: 6120 4461 7461 4672 616d 6520 696e 746f  a DataFrame into
+000365b0: 2061 2066 6f72 6d61 7420 7768 6572 650a   a format where.
+000365c0: 2020 2020 2020 2020 6f6e 6520 6f72 206d          one or m
+000365d0: 6f72 6520 636f 6c75 6d6e 7320 6172 6520  ore columns are 
+000365e0: 6964 656e 7469 6669 6572 2076 6172 6961  identifier varia
+000365f0: 626c 6573 2028 6060 6964 5f76 6172 7360  bles (``id_vars`
+00036600: 6029 2c20 7768 696c 650a 2020 2020 2020  `), while.      
+00036610: 2020 616c 6c20 6f74 6865 7220 636f 6c75    all other colu
+00036620: 6d6e 732c 2063 6f6e 7369 6465 7265 6420  mns, considered 
+00036630: 6d65 6173 7572 6564 2076 6172 6961 626c  measured variabl
+00036640: 6573 2028 6060 7661 6c75 655f 7661 7273  es (``value_vars
+00036650: 6060 292c 0a20 2020 2020 2020 2061 7265  ``),.        are
+00036660: 2022 756e 7069 766f 7465 6422 2074 6f20   "unpivoted" to 
+00036670: 7468 6520 726f 7720 6178 6973 2c20 6c65  the row axis, le
+00036680: 6176 696e 6720 6a75 7374 2074 776f 206e  aving just two n
+00036690: 6f6e 2d69 6465 6e74 6966 6965 720a 2020  on-identifier.  
+000366a0: 2020 2020 2020 636f 6c75 6d6e 732c 2027        columns, '
+000366b0: 7661 7269 6162 6c65 2720 616e 6420 2776  variable' and 'v
+000366c0: 616c 7565 272e 0a0a 2020 2020 2020 2020  alue'...        
+000366d0: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+000366e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+000366f0: 2020 2020 2020 6672 616d 6520 3a20 4461        frame : Da
+00036700: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
+00036710: 6964 5f76 6172 7320 3a20 7475 706c 652c  id_vars : tuple,
+00036720: 206c 6973 742c 206f 7220 6e64 6172 7261   list, or ndarra
+00036730: 792c 206f 7074 696f 6e61 6c0a 2020 2020  y, optional.    
+00036740: 2020 2020 2020 2020 436f 6c75 6d6e 2873          Column(s
+00036750: 2920 746f 2075 7365 2061 7320 6964 656e  ) to use as iden
+00036760: 7469 6669 6572 2076 6172 6961 626c 6573  tifier variables
+00036770: 2e0a 2020 2020 2020 2020 7661 6c75 655f  ..        value_
+00036780: 7661 7273 203a 2074 7570 6c65 2c20 6c69  vars : tuple, li
+00036790: 7374 2c20 6f72 206e 6461 7272 6179 2c20  st, or ndarray, 
+000367a0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+000367b0: 2020 2020 2043 6f6c 756d 6e28 7329 2074       Column(s) t
+000367c0: 6f20 756e 7069 766f 742e 2049 6620 6e6f  o unpivot. If no
+000367d0: 7420 7370 6563 6966 6965 642c 2075 7365  t specified, use
+000367e0: 7320 616c 6c20 636f 6c75 6d6e 7320 7468  s all columns th
+000367f0: 6174 0a20 2020 2020 2020 2020 2020 2061  at.            a
+00036800: 7265 206e 6f74 2073 6574 2061 7320 6069  re not set as `i
+00036810: 645f 7661 7273 602e 0a20 2020 2020 2020  d_vars`..       
+00036820: 2076 6172 5f6e 616d 6520 3a20 7363 616c   var_name : scal
+00036830: 6172 0a20 2020 2020 2020 2020 2020 204e  ar.            N
+00036840: 616d 6520 746f 2075 7365 2066 6f72 2074  ame to use for t
+00036850: 6865 2027 7661 7269 6162 6c65 2720 636f  he 'variable' co
+00036860: 6c75 6d6e 2e20 4966 204e 6f6e 6520 6974  lumn. If None it
+00036870: 2075 7365 730a 2020 2020 2020 2020 2020   uses.          
+00036880: 2020 6060 6672 616d 652e 636f 6c75 6d6e    ``frame.column
+00036890: 732e 6e61 6d65 6060 206f 7220 2776 6172  s.name`` or 'var
+000368a0: 6961 626c 6527 2e0a 2020 2020 2020 2020  iable'..        
+000368b0: 7661 6c75 655f 6e61 6d65 203a 2073 6361  value_name : sca
+000368c0: 6c61 722c 2064 6566 6175 6c74 2027 7661  lar, default 'va
+000368d0: 6c75 6527 0a20 2020 2020 2020 2020 2020  lue'.           
+000368e0: 204e 616d 6520 746f 2075 7365 2066 6f72   Name to use for
+000368f0: 2074 6865 2027 7661 6c75 6527 2063 6f6c   the 'value' col
+00036900: 756d 6e2e 0a20 2020 2020 2020 2063 6f6c  umn..        col
+00036910: 5f6c 6576 656c 203a 2069 6e74 206f 7220  _level : int or 
+00036920: 7374 7269 6e67 2c20 6f70 7469 6f6e 616c  string, optional
+00036930: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00036940: 636f 6c75 6d6e 7320 6172 6520 6120 4d75  columns are a Mu
+00036950: 6c74 6949 6e64 6578 2074 6865 6e20 7573  ltiIndex then us
+00036960: 6520 7468 6973 206c 6576 656c 2074 6f20  e this level to 
+00036970: 6d65 6c74 2e0a 0a20 2020 2020 2020 2052  melt...        R
+00036980: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+00036990: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
+000369a0: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
+000369b0: 2020 2020 2055 6e70 6976 6f74 6564 2044       Unpivoted D
+000369c0: 6174 6146 7261 6d65 2e0a 0a20 2020 2020  ataFrame...     
+000369d0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+000369e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+000369f0: 2020 2020 2070 616e 6461 732e 4461 7461       pandas.Data
+00036a00: 4672 616d 652e 6d65 6c74 0a20 2020 2020  Frame.melt.     
+00036a10: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+00036a20: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+00036a30: 6d65 2e72 6573 6861 7065 2069 6d70 6f72  me.reshape impor
+00036a40: 7420 6d65 6c74 0a0a 2020 2020 2020 2020  t melt..        
+00036a50: 7265 7475 726e 206d 656c 7428 0a20 2020  return melt(.   
+00036a60: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
+00036a70: 2020 2020 2020 2020 2020 2069 645f 7661             id_va
+00036a80: 7273 3d69 645f 7661 7273 2c0a 2020 2020  rs=id_vars,.    
+00036a90: 2020 2020 2020 2020 7661 6c75 655f 7661          value_va
+00036aa0: 7273 3d76 616c 7565 5f76 6172 732c 0a20  rs=value_vars,. 
+00036ab0: 2020 2020 2020 2020 2020 2076 6172 5f6e             var_n
+00036ac0: 616d 653d 7661 725f 6e61 6d65 2c0a 2020  ame=var_name,.  
+00036ad0: 2020 2020 2020 2020 2020 7661 6c75 655f            value_
+00036ae0: 6e61 6d65 3d76 616c 7565 5f6e 616d 652c  name=value_name,
+00036af0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00036b00: 5f6c 6576 656c 3d63 6f6c 5f6c 6576 656c  _level=col_level
+00036b10: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00036b20: 2064 6566 2074 6f5f 7265 636f 7264 7328   def to_records(
+00036b30: 7365 6c66 2c20 696e 6465 783d 4661 6c73  self, index=Fals
+00036b40: 652c 206c 656e 6774 6873 3d4e 6f6e 6529  e, lengths=None)
+00036b50: 3a0a 2020 2020 2020 2020 6672 6f6d 2064  :.        from d
+00036b60: 6173 6b2e 6461 7461 6672 616d 652e 696f  ask.dataframe.io
+00036b70: 2069 6d70 6f72 7420 746f 5f72 6563 6f72   import to_recor
+00036b80: 6473 0a0a 2020 2020 2020 2020 6966 206c  ds..        if l
+00036b90: 656e 6774 6873 2069 7320 5472 7565 3a0a  engths is True:.
+00036ba0: 2020 2020 2020 2020 2020 2020 6c65 6e67              leng
+00036bb0: 7468 7320 3d20 7475 706c 6528 7365 6c66  ths = tuple(self
+00036bc0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+00036bd0: 6c65 6e29 2e63 6f6d 7075 7465 2829 290a  len).compute()).
+00036be0: 0a20 2020 2020 2020 2072 6563 6f72 6473  .        records
+00036bf0: 203d 2074 6f5f 7265 636f 7264 7328 7365   = to_records(se
+00036c00: 6c66 290a 0a20 2020 2020 2020 2063 6875  lf)..        chu
+00036c10: 6e6b 7320 3d20 7365 6c66 2e5f 7661 6c69  nks = self._vali
+00036c20: 6461 7465 5f63 6875 6e6b 7328 7265 636f  date_chunks(reco
+00036c30: 7264 732c 206c 656e 6774 6873 290a 2020  rds, lengths).  
+00036c40: 2020 2020 2020 7265 636f 7264 732e 5f63        records._c
+00036c50: 6875 6e6b 7320 3d20 2863 6875 6e6b 735b  hunks = (chunks[
+00036c60: 305d 2c29 0a0a 2020 2020 2020 2020 7265  0],)..        re
+00036c70: 7475 726e 2072 6563 6f72 6473 0a0a 2020  turn records..  
+00036c80: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00036c90: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+00036ca0: 2020 6465 6620 746f 5f68 746d 6c28 7365    def to_html(se
+00036cb0: 6c66 2c20 6d61 785f 726f 7773 3d35 293a  lf, max_rows=5):
+00036cc0: 0a20 2020 2020 2020 2023 2070 642e 5365  .        # pd.Se
+00036cd0: 7269 6573 2064 6f65 736e 2774 2068 6176  ries doesn't hav
+00036ce0: 6520 6874 6d6c 2072 6570 720a 2020 2020  e html repr.    
+00036cf0: 2020 2020 6461 7461 203d 2073 656c 662e      data = self.
+00036d00: 5f72 6570 725f 6461 7461 2829 2e74 6f5f  _repr_data().to_
+00036d10: 6874 6d6c 286d 6178 5f72 6f77 733d 6d61  html(max_rows=ma
+00036d20: 785f 726f 7773 2c20 7368 6f77 5f64 696d  x_rows, show_dim
+00036d30: 656e 7369 6f6e 733d 4661 6c73 6529 0a20  ensions=False). 
+00036d40: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
+00036d50: 745f 7465 6d70 6c61 7465 2822 6461 7461  t_template("data
+00036d60: 6672 616d 652e 6874 6d6c 2e6a 3222 292e  frame.html.j2").
+00036d70: 7265 6e64 6572 280a 2020 2020 2020 2020  render(.        
+00036d80: 2020 2020 6461 7461 3d64 6174 612c 0a20      data=data,. 
+00036d90: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+00036da0: 7365 6c66 2e5f 6e61 6d65 2c0a 2020 2020  self._name,.    
+00036db0: 2020 2020 2020 2020 6c61 7965 7273 3d6d          layers=m
+00036dc0: 6179 6265 5f70 6c75 7261 6c69 7a65 286c  aybe_pluralize(l
+00036dd0: 656e 2873 656c 662e 6461 736b 2e6c 6179  en(self.dask.lay
+00036de0: 6572 7329 2c20 2267 7261 7068 206c 6179  ers), "graph lay
+00036df0: 6572 2229 2c0a 2020 2020 2020 2020 290a  er"),.        ).
+00036e00: 0a20 2020 2064 6566 205f 7265 7072 5f64  .    def _repr_d
+00036e10: 6174 6128 7365 6c66 293a 0a20 2020 2020  ata(self):.     
+00036e20: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+00036e30: 6d65 7461 0a20 2020 2020 2020 2069 6e64  meta.        ind
+00036e40: 6578 203d 2073 656c 662e 5f72 6570 725f  ex = self._repr_
+00036e50: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
+00036e60: 2020 636f 6c73 203d 206d 6574 612e 636f    cols = meta.co
+00036e70: 6c75 6d6e 730a 2020 2020 2020 2020 6966  lumns.        if
+00036e80: 206c 656e 2863 6f6c 7329 203d 3d20 303a   len(cols) == 0:
+00036e90: 0a20 2020 2020 2020 2020 2020 2073 6572  .            ser
+00036ea0: 6965 735f 6466 203d 2070 642e 4461 7461  ies_df = pd.Data
+00036eb0: 4672 616d 6528 5b5b 5d5d 202a 206c 656e  Frame([[]] * len
+00036ec0: 2869 6e64 6578 292c 2063 6f6c 756d 6e73  (index), columns
+00036ed0: 3d63 6f6c 732c 2069 6e64 6578 3d69 6e64  =cols, index=ind
+00036ee0: 6578 290a 2020 2020 2020 2020 656c 7365  ex).        else
+00036ef0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00036f00: 7269 6573 5f64 6620 3d20 7064 2e63 6f6e  ries_df = pd.con
+00036f10: 6361 7428 0a20 2020 2020 2020 2020 2020  cat(.           
+00036f20: 2020 2020 205b 5f72 6570 725f 6461 7461       [_repr_data
+00036f30: 5f73 6572 6965 7328 732c 2069 6e64 6578  _series(s, index
+00036f40: 3d69 6e64 6578 2920 666f 7220 5f2c 2073  =index) for _, s
+00036f50: 2069 6e20 6d65 7461 2e69 7465 6d73 2829   in meta.items()
+00036f60: 5d2c 2061 7869 733d 310a 2020 2020 2020  ], axis=1.      
+00036f70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00036f80: 7265 7475 726e 2073 6572 6965 735f 6466  return series_df
+00036f90: 0a0a 2020 2020 6465 6620 5f72 6570 725f  ..    def _repr_
+00036fa0: 6874 6d6c 5f28 7365 6c66 293a 0a20 2020  html_(self):.   
+00036fb0: 2020 2020 2064 6174 6120 3d20 7365 6c66       data = self
+00036fc0: 2e5f 7265 7072 5f64 6174 6128 292e 746f  ._repr_data().to
+00036fd0: 5f68 746d 6c28 0a20 2020 2020 2020 2020  _html(.         
+00036fe0: 2020 206d 6178 5f72 6f77 733d 352c 2073     max_rows=5, s
+00036ff0: 686f 775f 6469 6d65 6e73 696f 6e73 3d46  how_dimensions=F
+00037000: 616c 7365 2c20 6e6f 7465 626f 6f6b 3d54  alse, notebook=T
+00037010: 7275 650a 2020 2020 2020 2020 290a 2020  rue.        ).  
+00037020: 2020 2020 2020 7265 7475 726e 2067 6574        return get
+00037030: 5f74 656d 706c 6174 6528 2264 6174 6166  _template("dataf
+00037040: 7261 6d65 2e68 746d 6c2e 6a32 2229 2e72  rame.html.j2").r
+00037050: 656e 6465 7228 0a20 2020 2020 2020 2020  ender(.         
+00037060: 2020 2064 6174 613d 6461 7461 2c0a 2020     data=data,.  
+00037070: 2020 2020 2020 2020 2020 6e61 6d65 3d73            name=s
+00037080: 656c 662e 5f6e 616d 652c 0a20 2020 2020  elf._name,.     
+00037090: 2020 2020 2020 206c 6179 6572 733d 6d61         layers=ma
+000370a0: 7962 655f 706c 7572 616c 697a 6528 6c65  ybe_pluralize(le
+000370b0: 6e28 7365 6c66 2e64 6173 6b2e 6c61 7965  n(self.dask.laye
+000370c0: 7273 292c 2022 6772 6170 6820 6c61 7965  rs), "graph laye
+000370d0: 7222 292c 0a20 2020 2020 2020 2029 0a0a  r"),.        )..
+000370e0: 2020 2020 6465 6620 5f73 656c 6563 745f      def _select_
+000370f0: 636f 6c75 6d6e 735f 6f72 5f69 6e64 6578  columns_or_index
+00037100: 2873 656c 662c 2063 6f6c 756d 6e73 5f6f  (self, columns_o
+00037110: 725f 696e 6465 7829 3a0a 2020 2020 2020  r_index):.      
+00037120: 2020 2222 220a 2020 2020 2020 2020 5061    """.        Pa
+00037130: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00037140: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00037150: 2020 2020 636f 6c75 6d6e 735f 6f72 5f69      columns_or_i
+00037160: 6e64 6578 0a20 2020 2020 2020 2020 2020  ndex.           
+00037170: 2043 6f6c 756d 6e20 6f72 2069 6e64 6578   Column or index
+00037180: 206e 616d 652c 206f 7220 6120 6c69 7374   name, or a list
+00037190: 206f 6620 7468 6573 650a 0a20 2020 2020   of these..     
+000371a0: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+000371b0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+000371c0: 2020 2064 642e 4461 7461 4672 616d 650a     dd.DataFrame.
+000371d0: 2020 2020 2020 2020 2020 2020 4461 736b              Dask
+000371e0: 2044 6174 6146 7261 6d65 2077 6974 6820   DataFrame with 
+000371f0: 636f 6c75 6d6e 7320 636f 7272 6573 706f  columns correspo
+00037200: 6e64 696e 6720 746f 2065 6163 6820 636f  nding to each co
+00037210: 6c75 6d6e 206f 720a 2020 2020 2020 2020  lumn or.        
+00037220: 2020 2020 696e 6465 7820 6c65 7665 6c20      index level 
+00037230: 696e 2063 6f6c 756d 6e73 5f6f 725f 696e  in columns_or_in
+00037240: 6465 782e 2020 4966 2069 6e63 6c75 6465  dex.  If include
+00037250: 642c 2074 6865 2063 6f6c 756d 6e0a 2020  d, the column.  
+00037260: 2020 2020 2020 2020 2020 636f 7272 6573            corres
+00037270: 706f 6e64 696e 6720 746f 2074 6865 2069  ponding to the i
+00037280: 6e64 6578 206c 6576 656c 2069 7320 6e61  ndex level is na
+00037290: 6d65 6420 5f69 6e64 6578 0a20 2020 2020  med _index.     
+000372a0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+000372b0: 2320 456e 7375 7265 2063 6f6c 756d 6e73  # Ensure columns
+000372c0: 5f6f 725f 696e 6465 7820 6973 2061 206c  _or_index is a l
+000372d0: 6973 740a 2020 2020 2020 2020 636f 6c75  ist.        colu
+000372e0: 6d6e 735f 6f72 5f69 6e64 6578 203d 2028  mns_or_index = (
+000372f0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00037300: 756d 6e73 5f6f 725f 696e 6465 780a 2020  umns_or_index.  
+00037310: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00037320: 6e73 7461 6e63 6528 636f 6c75 6d6e 735f  nstance(columns_
+00037330: 6f72 5f69 6e64 6578 2c20 6c69 7374 290a  or_index, list).
+00037340: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00037350: 205b 636f 6c75 6d6e 735f 6f72 5f69 6e64   [columns_or_ind
+00037360: 6578 5d0a 2020 2020 2020 2020 290a 0a20  ex].        ).. 
+00037370: 2020 2020 2020 2063 6f6c 756d 6e5f 6e61         column_na
+00037380: 6d65 7320 3d20 5b0a 2020 2020 2020 2020  mes = [.        
+00037390: 2020 2020 6e20 666f 7220 6e20 696e 2063      n for n in c
+000373a0: 6f6c 756d 6e73 5f6f 725f 696e 6465 7820  olumns_or_index 
+000373b0: 6966 2073 656c 662e 5f69 735f 636f 6c75  if self._is_colu
+000373c0: 6d6e 5f6c 6162 656c 5f72 6566 6572 656e  mn_label_referen
+000373d0: 6365 286e 290a 2020 2020 2020 2020 5d0a  ce(n).        ].
+000373e0: 0a20 2020 2020 2020 2073 656c 6563 7465  .        selecte
+000373f0: 645f 6466 203d 2073 656c 665b 636f 6c75  d_df = self[colu
+00037400: 6d6e 5f6e 616d 6573 5d0a 2020 2020 2020  mn_names].      
+00037410: 2020 6966 2073 656c 662e 5f63 6f6e 7461    if self._conta
+00037420: 696e 735f 696e 6465 785f 6e61 6d65 2863  ins_index_name(c
+00037430: 6f6c 756d 6e73 5f6f 725f 696e 6465 7829  olumns_or_index)
+00037440: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00037450: 496e 6465 7820 6e61 6d65 2077 6173 2069  Index name was i
+00037460: 6e63 6c75 6465 640a 2020 2020 2020 2020  ncluded.        
+00037470: 2020 2020 7365 6c65 6374 6564 5f64 6620      selected_df 
+00037480: 3d20 7365 6c65 6374 6564 5f64 662e 6173  = selected_df.as
+00037490: 7369 676e 285f 696e 6465 783d 7365 6c66  sign(_index=self
+000374a0: 2e69 6e64 6578 290a 0a20 2020 2020 2020  .index)..       
+000374b0: 2072 6574 7572 6e20 7365 6c65 6374 6564   return selected
+000374c0: 5f64 660a 0a20 2020 2064 6566 205f 6973  _df..    def _is
+000374d0: 5f63 6f6c 756d 6e5f 6c61 6265 6c5f 7265  _column_label_re
+000374e0: 6665 7265 6e63 6528 7365 6c66 2c20 6b65  ference(self, ke
+000374f0: 7929 3a0a 2020 2020 2020 2020 2222 220a  y):.        """.
+00037500: 2020 2020 2020 2020 5465 7374 2077 6865          Test whe
+00037510: 7468 6572 2061 206b 6579 2069 7320 6120  ther a key is a 
+00037520: 636f 6c75 6d6e 206c 6162 656c 2072 6566  column label ref
+00037530: 6572 656e 6365 0a0a 2020 2020 2020 2020  erence..        
+00037540: 546f 2062 6520 636f 6e73 6964 6572 6564  To be considered
+00037550: 2061 2063 6f6c 756d 6e20 6c61 6265 6c20   a column label 
+00037560: 7265 6665 7265 6e63 652c 2060 6b65 7960  reference, `key`
+00037570: 206d 7573 7420 6d61 7463 6820 7468 6520   must match the 
+00037580: 6e61 6d65 206f 6620 6174 0a20 2020 2020  name of at.     
+00037590: 2020 206c 6561 7374 206f 6e65 2063 6f6c     least one col
+000375a0: 756d 6e2e 0a20 2020 2020 2020 2022 2222  umn..        """
+000375b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000375c0: 280a 2020 2020 2020 2020 2020 2020 6e6f  (.            no
+000375d0: 7420 6973 5f64 6173 6b5f 636f 6c6c 6563  t is_dask_collec
+000375e0: 7469 6f6e 286b 6579 290a 2020 2020 2020  tion(key).      
+000375f0: 2020 2020 2020 616e 6420 286e 702e 6973        and (np.is
+00037600: 7363 616c 6172 286b 6579 2920 6f72 2069  scalar(key) or i
+00037610: 7369 6e73 7461 6e63 6528 6b65 792c 2074  sinstance(key, t
+00037620: 7570 6c65 2929 0a20 2020 2020 2020 2020  uple)).         
+00037630: 2020 2061 6e64 206b 6579 2069 6e20 7365     and key in se
+00037640: 6c66 2e63 6f6c 756d 6e73 0a20 2020 2020  lf.columns.     
+00037650: 2020 2029 0a0a 2020 2020 4063 6c61 7373     )..    @class
+00037660: 6d65 7468 6f64 0a20 2020 2064 6566 2066  method.    def f
+00037670: 726f 6d5f 6469 6374 280a 2020 2020 2020  rom_dict(.      
+00037680: 2020 636c 732c 2064 6174 612c 202a 2c20    cls, data, *, 
+00037690: 6e70 6172 7469 7469 6f6e 732c 206f 7269  npartitions, ori
+000376a0: 656e 743d 2263 6f6c 756d 6e73 222c 2064  ent="columns", d
+000376b0: 7479 7065 3d4e 6f6e 652c 2063 6f6c 756d  type=None, colum
+000376c0: 6e73 3d4e 6f6e 650a 2020 2020 293a 0a20  ns=None.    ):. 
+000376d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000376e0: 2020 2043 6f6e 7374 7275 6374 2061 2044     Construct a D
+000376f0: 6173 6b20 4461 7461 4672 616d 6520 6672  ask DataFrame fr
+00037700: 6f6d 2061 2050 7974 686f 6e20 4469 6374  om a Python Dict
+00037710: 696f 6e61 7279 0a0a 2020 2020 2020 2020  ionary..        
+00037720: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+00037730: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00037740: 2020 6461 736b 2e64 6174 6166 7261 6d65    dask.dataframe
+00037750: 2e66 726f 6d5f 6469 6374 0a20 2020 2020  .from_dict.     
+00037760: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+00037770: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+00037780: 6d65 2e69 6f20 696d 706f 7274 2066 726f  me.io import fro
+00037790: 6d5f 6469 6374 0a0a 2020 2020 2020 2020  m_dict..        
+000377a0: 7265 7475 726e 2066 726f 6d5f 6469 6374  return from_dict
+000377b0: 280a 2020 2020 2020 2020 2020 2020 6461  (.            da
+000377c0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+000377d0: 6e70 6172 7469 7469 6f6e 732c 0a20 2020  npartitions,.   
+000377e0: 2020 2020 2020 2020 206f 7269 656e 743d           orient=
+000377f0: 6f72 6965 6e74 2c0a 2020 2020 2020 2020  orient,.        
+00037800: 2020 2020 6474 7970 653d 6474 7970 652c      dtype=dtype,
+00037810: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00037820: 756d 6e73 3d63 6f6c 756d 6e73 2c0a 2020  umns=columns,.  
+00037830: 2020 2020 2020 2020 2020 636f 6e73 7472            constr
+00037840: 7563 746f 723d 636c 732e 5f70 6172 7469  uctor=cls._parti
+00037850: 7469 6f6e 5f74 7970 652c 0a20 2020 2020  tion_type,.     
+00037860: 2020 2029 0a0a 0a23 2062 696e 6420 6f70     )...# bind op
+00037870: 6572 6174 6f72 730a 2320 544f 444f 3a20  erators.# TODO: 
+00037880: 6479 6e61 6d69 6361 6c6c 7920 626f 756e  dynamically boun
+00037890: 6420 6f70 6572 6174 6f72 7320 6172 6520  d operators are 
+000378a0: 6465 6665 6174 696e 6720 7479 7065 2061  defeating type a
+000378b0: 6e6e 6f74 6174 696f 6e73 0a66 6f72 206f  nnotations.for o
+000378c0: 7020 696e 205b 0a20 2020 206f 7065 7261  p in [.    opera
+000378d0: 746f 722e 6162 732c 0a20 2020 206f 7065  tor.abs,.    ope
+000378e0: 7261 746f 722e 6164 642c 0a20 2020 206f  rator.add,.    o
+000378f0: 7065 7261 746f 722e 616e 645f 2c0a 2020  perator.and_,.  
+00037900: 2020 6f70 6572 6174 6f72 2e65 712c 0a20    operator.eq,. 
+00037910: 2020 206f 7065 7261 746f 722e 6774 2c0a     operator.gt,.
+00037920: 2020 2020 6f70 6572 6174 6f72 2e67 652c      operator.ge,
+00037930: 0a20 2020 206f 7065 7261 746f 722e 696e  .    operator.in
+00037940: 762c 0a20 2020 206f 7065 7261 746f 722e  v,.    operator.
+00037950: 6c74 2c0a 2020 2020 6f70 6572 6174 6f72  lt,.    operator
+00037960: 2e6c 652c 0a20 2020 206f 7065 7261 746f  .le,.    operato
+00037970: 722e 6d6f 642c 0a20 2020 206f 7065 7261  r.mod,.    opera
+00037980: 746f 722e 6d75 6c2c 0a20 2020 206f 7065  tor.mul,.    ope
+00037990: 7261 746f 722e 6e65 2c0a 2020 2020 6f70  rator.ne,.    op
+000379a0: 6572 6174 6f72 2e6e 6567 2c0a 2020 2020  erator.neg,.    
+000379b0: 6f70 6572 6174 6f72 2e6f 725f 2c0a 2020  operator.or_,.  
+000379c0: 2020 6f70 6572 6174 6f72 2e70 6f77 2c0a    operator.pow,.
+000379d0: 2020 2020 6f70 6572 6174 6f72 2e73 7562      operator.sub
+000379e0: 2c0a 2020 2020 6f70 6572 6174 6f72 2e74  ,.    operator.t
+000379f0: 7275 6564 6976 2c0a 2020 2020 6f70 6572  ruediv,.    oper
+00037a00: 6174 6f72 2e66 6c6f 6f72 6469 762c 0a20  ator.floordiv,. 
+00037a10: 2020 206f 7065 7261 746f 722e 786f 722c     operator.xor,
+00037a20: 0a5d 3a0a 2020 2020 5f46 7261 6d65 2e5f  .]:.    _Frame._
+00037a30: 6269 6e64 5f6f 7065 7261 746f 7228 6f70  bind_operator(op
+00037a40: 290a 2020 2020 5363 616c 6172 2e5f 6269  ).    Scalar._bi
+00037a50: 6e64 5f6f 7065 7261 746f 7228 6f70 290a  nd_operator(op).
+00037a60: 0a66 6f72 206e 616d 6520 696e 205b 0a20  .for name in [. 
+00037a70: 2020 2022 6164 6422 2c0a 2020 2020 2273     "add",.    "s
+00037a80: 7562 222c 0a20 2020 2022 6d75 6c22 2c0a  ub",.    "mul",.
+00037a90: 2020 2020 2264 6976 222c 0a20 2020 2022      "div",.    "
+00037aa0: 6469 7669 6465 222c 0a20 2020 2022 7472  divide",.    "tr
+00037ab0: 7565 6469 7622 2c0a 2020 2020 2266 6c6f  uediv",.    "flo
+00037ac0: 6f72 6469 7622 2c0a 2020 2020 226d 6f64  ordiv",.    "mod
+00037ad0: 222c 0a20 2020 2022 706f 7722 2c0a 2020  ",.    "pow",.  
+00037ae0: 2020 2272 6164 6422 2c0a 2020 2020 2272    "radd",.    "r
+00037af0: 7375 6222 2c0a 2020 2020 2272 6d75 6c22  sub",.    "rmul"
+00037b00: 2c0a 2020 2020 2272 6469 7622 2c0a 2020  ,.    "rdiv",.  
+00037b10: 2020 2272 7472 7565 6469 7622 2c0a 2020    "rtruediv",.  
+00037b20: 2020 2272 666c 6f6f 7264 6976 222c 0a20    "rfloordiv",. 
+00037b30: 2020 2022 726d 6f64 222c 0a20 2020 2022     "rmod",.    "
+00037b40: 7270 6f77 222c 0a5d 3a0a 2020 2020 6d65  rpow",.]:.    me
+00037b50: 7468 203d 2067 6574 6174 7472 2870 642e  th = getattr(pd.
+00037b60: 4461 7461 4672 616d 652c 206e 616d 6529  DataFrame, name)
+00037b70: 0a20 2020 2044 6174 6146 7261 6d65 2e5f  .    DataFrame._
+00037b80: 6269 6e64 5f6f 7065 7261 746f 725f 6d65  bind_operator_me
+00037b90: 7468 6f64 286e 616d 652c 206d 6574 6829  thod(name, meth)
+00037ba0: 0a0a 2020 2020 6d65 7468 203d 2067 6574  ..    meth = get
+00037bb0: 6174 7472 2870 642e 5365 7269 6573 2c20  attr(pd.Series, 
+00037bc0: 6e61 6d65 290a 2020 2020 5365 7269 6573  name).    Series
+00037bd0: 2e5f 6269 6e64 5f6f 7065 7261 746f 725f  ._bind_operator_
+00037be0: 6d65 7468 6f64 286e 616d 652c 206d 6574  method(name, met
+00037bf0: 6829 0a0a 666f 7220 6e61 6d65 2069 6e20  h)..for name in 
+00037c00: 5b22 6c74 222c 2022 6774 222c 2022 6c65  ["lt", "gt", "le
+00037c10: 222c 2022 6765 222c 2022 6e65 222c 2022  ", "ge", "ne", "
+00037c20: 6571 225d 3a0a 2020 2020 6d65 7468 203d  eq"]:.    meth =
+00037c30: 2067 6574 6174 7472 2870 642e 4461 7461   getattr(pd.Data
+00037c40: 4672 616d 652c 206e 616d 6529 0a20 2020  Frame, name).   
+00037c50: 2044 6174 6146 7261 6d65 2e5f 6269 6e64   DataFrame._bind
+00037c60: 5f63 6f6d 7061 7269 736f 6e5f 6d65 7468  _comparison_meth
+00037c70: 6f64 286e 616d 652c 206d 6574 6829 0a0a  od(name, meth)..
+00037c80: 2020 2020 6d65 7468 203d 2067 6574 6174      meth = getat
+00037c90: 7472 2870 642e 5365 7269 6573 2c20 6e61  tr(pd.Series, na
+00037ca0: 6d65 290a 2020 2020 5365 7269 6573 2e5f  me).    Series._
+00037cb0: 6269 6e64 5f63 6f6d 7061 7269 736f 6e5f  bind_comparison_
+00037cc0: 6d65 7468 6f64 286e 616d 652c 206d 6574  method(name, met
+00037cd0: 6829 0a0a 0a64 6566 2069 735f 6272 6f61  h)...def is_broa
+00037ce0: 6463 6173 7461 626c 6528 6466 732c 2073  dcastable(dfs, s
+00037cf0: 293a 0a20 2020 2022 2222 0a20 2020 2054  ):.    """.    T
+00037d00: 6869 7320 5365 7269 6573 2069 7320 6272  his Series is br
+00037d10: 6f61 6463 6173 7461 626c 6520 6167 6169  oadcastable agai
+00037d20: 6e73 7420 616e 6f74 6865 7220 6461 7461  nst another data
+00037d30: 6672 616d 6520 696e 2074 6865 2073 6571  frame in the seq
+00037d40: 7565 6e63 650a 2020 2020 2222 220a 0a20  uence.    """.. 
+00037d50: 2020 2064 6566 2063 6f6d 7061 7265 2873     def compare(s
+00037d60: 2c20 6466 293a 0a20 2020 2020 2020 2074  , df):.        t
+00037d70: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+00037d80: 7265 7475 726e 2073 2e64 6976 6973 696f  return s.divisio
+00037d90: 6e73 203d 3d20 2864 662e 636f 6c75 6d6e  ns == (df.column
+00037da0: 732e 6d69 6e28 292c 2064 662e 636f 6c75  s.min(), df.colu
+00037db0: 6d6e 732e 6d61 7828 2929 0a20 2020 2020  mns.max()).     
+00037dc0: 2020 2065 7863 6570 7420 5479 7065 4572     except TypeEr
+00037dd0: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+00037de0: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
+00037df0: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
+00037e00: 2020 2020 6973 696e 7374 616e 6365 2873      isinstance(s
+00037e10: 2c20 5365 7269 6573 290a 2020 2020 2020  , Series).      
+00037e20: 2020 616e 6420 732e 6e70 6172 7469 7469    and s.npartiti
+00037e30: 6f6e 7320 3d3d 2031 0a20 2020 2020 2020  ons == 1.       
+00037e40: 2061 6e64 2073 2e6b 6e6f 776e 5f64 6976   and s.known_div
+00037e50: 6973 696f 6e73 0a20 2020 2020 2020 2061  isions.        a
+00037e60: 6e64 2061 6e79 2863 6f6d 7061 7265 2873  nd any(compare(s
+00037e70: 2c20 6466 2920 666f 7220 6466 2069 6e20  , df) for df in 
+00037e80: 6466 7320 6966 2069 7369 6e73 7461 6e63  dfs if isinstanc
+00037e90: 6528 6466 2c20 4461 7461 4672 616d 6529  e(df, DataFrame)
+00037ea0: 290a 2020 2020 290a 0a0a 6465 6620 656c  ).    )...def el
+00037eb0: 656d 7769 7365 286f 702c 202a 6172 6773  emwise(op, *args
+00037ec0: 2c20 6d65 7461 3d6e 6f5f 6465 6661 756c  , meta=no_defaul
+00037ed0: 742c 206f 7574 3d4e 6f6e 652c 2074 7261  t, out=None, tra
+00037ee0: 6e73 666f 726d 5f64 6976 6973 696f 6e73  nsform_divisions
+00037ef0: 3d54 7275 652c 202a 2a6b 7761 7267 7329  =True, **kwargs)
+00037f00: 3a0a 2020 2020 2222 2245 6c65 6d65 6e74  :.    """Element
+00037f10: 7769 7365 206f 7065 7261 7469 6f6e 2066  wise operation f
+00037f20: 6f72 2044 6173 6b20 6461 7461 6672 616d  or Dask datafram
+00037f30: 6573 0a0a 2020 2020 5061 7261 6d65 7465  es..    Paramete
+00037f40: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+00037f50: 2d0a 2020 2020 6f70 3a20 6361 6c6c 6162  -.    op: callab
+00037f60: 6c65 0a20 2020 2020 2020 2046 756e 6374  le.        Funct
+00037f70: 696f 6e20 746f 2061 7070 6c79 2061 6372  ion to apply acr
+00037f80: 6f73 7320 696e 7075 7420 6461 7461 6672  oss input datafr
+00037f90: 616d 6573 0a20 2020 202a 6172 6773 3a20  ames.    *args: 
+00037fa0: 4461 7461 4672 616d 6573 2c20 5365 7269  DataFrames, Seri
+00037fb0: 6573 2c20 5363 616c 6172 732c 2041 7272  es, Scalars, Arr
+00037fc0: 6179 732c 0a20 2020 2020 2020 2054 6865  ays,.        The
+00037fd0: 2061 7267 756d 656e 7473 206f 6620 7468   arguments of th
+00037fe0: 6520 6f70 6572 6174 696f 6e0a 2020 2020  e operation.    
+00037ff0: 6d65 7461 3a20 7064 2e44 6174 6146 7261  meta: pd.DataFra
+00038000: 6d65 2c20 7064 2e53 6572 6965 7320 286f  me, pd.Series (o
+00038010: 7074 696f 6e61 6c29 0a20 2020 2020 2020  ptional).       
+00038020: 2056 616c 6964 206d 6574 6164 6174 6120   Valid metadata 
+00038030: 666f 7220 7468 6520 6f70 6572 6174 696f  for the operatio
+00038040: 6e2e 2020 5769 6c6c 2065 7661 6c75 6174  n.  Will evaluat
+00038050: 6520 6f6e 2061 2073 6d61 6c6c 2070 6965  e on a small pie
+00038060: 6365 206f 660a 2020 2020 2020 2020 6461  ce of.        da
+00038070: 7461 2069 6620 6e6f 7420 7072 6f76 6964  ta if not provid
+00038080: 6564 2e0a 2020 2020 7472 616e 7366 6f72  ed..    transfor
+00038090: 6d5f 6469 7669 7369 6f6e 733a 2062 6f6f  m_divisions: boo
+000380a0: 6c65 616e 0a20 2020 2020 2020 2049 6620  lean.        If 
+000380b0: 7468 6520 696e 7075 7420 6973 2061 2060  the input is a `
+000380c0: 6064 6173 6b2e 6461 7461 6672 616d 652e  `dask.dataframe.
+000380d0: 496e 6465 7860 6020 7765 206e 6f72 6d61  Index`` we norma
+000380e0: 6c6c 7920 7769 6c6c 2061 6c73 6f20 6170  lly will also ap
+000380f0: 706c 790a 2020 2020 2020 2020 7468 6520  ply.        the 
+00038100: 6675 6e63 7469 6f6e 206f 6e74 6f20 7468  function onto th
+00038110: 6520 6469 7669 7369 6f6e 7320 616e 6420  e divisions and 
+00038120: 6170 706c 7920 7468 6f73 6520 7472 616e  apply those tran
+00038130: 7366 6f72 6d65 6420 6469 7669 7369 6f6e  sformed division
+00038140: 730a 2020 2020 2020 2020 746f 2074 6865  s.        to the
+00038150: 206f 7574 7075 742e 2020 596f 7520 6361   output.  You ca
+00038160: 6e20 7061 7373 2060 6074 7261 6e73 666f  n pass ``transfo
+00038170: 726d 5f64 6976 6973 696f 6e73 3d46 616c  rm_divisions=Fal
+00038180: 7365 6060 2074 6f20 6f76 6572 7269 6465  se`` to override
+00038190: 0a20 2020 2020 2020 2074 6869 7320 6265  .        this be
+000381a0: 6861 7669 6f72 0a20 2020 206f 7574 203a  havior.    out :
+000381b0: 2060 6064 6173 6b2e 6172 7261 7960 6020   ``dask.array`` 
+000381c0: 6f72 2060 604e 6f6e 6560 600a 2020 2020  or ``None``.    
+000381d0: 2020 2020 4966 206f 7574 2069 7320 6120      If out is a 
+000381e0: 6461 736b 2e44 6174 6146 7261 6d65 2c20  dask.DataFrame, 
+000381f0: 6461 736b 2e53 6572 6965 7320 6f72 2064  dask.Series or d
+00038200: 6173 6b2e 5363 616c 6172 2074 6865 6e0a  ask.Scalar then.
+00038210: 2020 2020 2020 2020 7468 6973 206f 7665          this ove
+00038220: 7277 7269 7465 7320 7468 6520 636f 6e74  rwrites the cont
+00038230: 656e 7473 206f 6620 6974 2077 6974 6820  ents of it with 
+00038240: 7468 6520 7265 7375 6c74 0a20 2020 202a  the result.    *
+00038250: 2a6b 7761 7267 733a 2073 6361 6c61 7273  *kwargs: scalars
+00038260: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
+00038270: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00038280: 3e3e 3e20 656c 656d 7769 7365 286f 7065  >>> elemwise(ope
+00038290: 7261 746f 722e 6164 642c 2064 662e 782c  rator.add, df.x,
+000382a0: 2064 662e 7929 2020 2320 646f 6374 6573   df.y)  # doctes
+000382b0: 743a 202b 534b 4950 0a20 2020 2022 2222  t: +SKIP.    """
+000382c0: 0a20 2020 205f 6e61 6d65 203d 2066 756e  .    _name = fun
+000382d0: 636e 616d 6528 6f70 2920 2b20 222d 2220  cname(op) + "-" 
+000382e0: 2b20 746f 6b65 6e69 7a65 286f 702c 202a  + tokenize(op, *
+000382f0: 6172 6773 2c20 2a2a 6b77 6172 6773 290a  args, **kwargs).
+00038300: 0a20 2020 2061 7267 7320 3d20 5f6d 6179  .    args = _may
+00038310: 6265 5f66 726f 6d5f 7061 6e64 6173 2861  be_from_pandas(a
+00038320: 7267 7329 0a0a 2020 2020 6672 6f6d 2064  rgs)..    from d
+00038330: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
+00038340: 6c74 6920 696d 706f 7274 205f 6d61 7962  lti import _mayb
+00038350: 655f 616c 6967 6e5f 7061 7274 6974 696f  e_align_partitio
+00038360: 6e73 0a0a 2020 2020 6172 6773 203d 205f  ns..    args = _
+00038370: 6d61 7962 655f 616c 6967 6e5f 7061 7274  maybe_align_part
+00038380: 6974 696f 6e73 2861 7267 7329 0a20 2020  itions(args).   
+00038390: 2064 6173 6b73 203d 205b 6172 6720 666f   dasks = [arg fo
+000383a0: 7220 6172 6720 696e 2061 7267 7320 6966  r arg in args if
+000383b0: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
+000383c0: 2028 5f46 7261 6d65 2c20 5363 616c 6172   (_Frame, Scalar
+000383d0: 2c20 4172 7261 7929 295d 0a20 2020 2064  , Array))].    d
+000383e0: 6673 203d 205b 6466 2066 6f72 2064 6620  fs = [df for df 
+000383f0: 696e 2064 6173 6b73 2069 6620 6973 696e  in dasks if isin
+00038400: 7374 616e 6365 2864 662c 205f 4672 616d  stance(df, _Fram
+00038410: 6529 5d0a 0a20 2020 2023 2043 6c65 616e  e)]..    # Clean
+00038420: 2075 7020 6461 736b 2061 7272 6179 7320   up dask arrays 
+00038430: 6966 2070 7265 7365 6e74 0a20 2020 2064  if present.    d
+00038440: 6570 7320 3d20 6461 736b 732e 636f 7079  eps = dasks.copy
+00038450: 2829 0a20 2020 2066 6f72 2069 2c20 6120  ().    for i, a 
+00038460: 696e 2065 6e75 6d65 7261 7465 2864 6173  in enumerate(das
+00038470: 6b73 293a 0a20 2020 2020 2020 2069 6620  ks):.        if 
+00038480: 6e6f 7420 6973 696e 7374 616e 6365 2861  not isinstance(a
+00038490: 2c20 4172 7261 7929 3a0a 2020 2020 2020  , Array):.      
+000384a0: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
+000384b0: 2020 2020 2020 2023 2045 6e73 7572 6520         # Ensure 
+000384c0: 7468 6174 2074 6865 7920 6861 7665 2073  that they have s
+000384d0: 696d 696c 6172 2d69 7368 2063 6875 6e6b  imilar-ish chunk
+000384e0: 2073 7472 7563 7475 7265 0a20 2020 2020   structure.     
+000384f0: 2020 2069 6620 6e6f 7420 616c 6c28 6e6f     if not all(no
+00038500: 7420 612e 6368 756e 6b73 206f 7220 6c65  t a.chunks or le
+00038510: 6e28 612e 6368 756e 6b73 5b30 5d29 203d  n(a.chunks[0]) =
+00038520: 3d20 6466 2e6e 7061 7274 6974 696f 6e73  = df.npartitions
+00038530: 2066 6f72 2064 6620 696e 2064 6673 293a   for df in dfs):
+00038540: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
+00038550: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00038560: 2020 2020 2022 5768 656e 2063 6f6d 6269       "When combi
+00038570: 6e69 6e67 2064 6173 6b20 6172 7261 7973  ning dask arrays
+00038580: 2077 6974 6820 6461 7461 6672 616d 6573   with dataframes
+00038590: 2074 6865 7920 6d75 7374 2022 0a20 2020   they must ".   
+000385a0: 2020 2020 2020 2020 2020 2020 2022 6d61               "ma
+000385b0: 7463 6820 6368 756e 6b69 6e67 2065 7861  tch chunking exa
+000385c0: 6374 6c79 2e20 204f 7065 7261 7469 6f6e  ctly.  Operation
+000385d0: 3a20 2573 2220 2520 6675 6e63 6e61 6d65  : %s" % funcname
+000385e0: 286f 7029 0a20 2020 2020 2020 2020 2020  (op).           
+000385f0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+00038600: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00038610: 6d73 6729 0a20 2020 2020 2020 2023 2052  msg).        # R
+00038620: 6563 6875 6e6b 2074 6f20 6861 7665 2061  echunk to have a
+00038630: 2073 696e 676c 6520 6368 756e 6b20 616c   single chunk al
+00038640: 6f6e 6720 616c 6c20 6f74 6865 7220 6178  ong all other ax
+00038650: 6573 0a20 2020 2020 2020 2069 6620 612e  es.        if a.
+00038660: 6e64 696d 203e 2031 3a0a 2020 2020 2020  ndim > 1:.      
+00038670: 2020 2020 2020 6120 3d20 612e 7265 6368        a = a.rech
+00038680: 756e 6b28 7b69 202b 2031 3a20 6420 666f  unk({i + 1: d fo
+00038690: 7220 692c 2064 2069 6e20 656e 756d 6572  r i, d in enumer
+000386a0: 6174 6528 612e 7368 6170 655b 313a 5d29  ate(a.shape[1:])
+000386b0: 7d29 0a20 2020 2020 2020 2020 2020 2064  }).            d
+000386c0: 6173 6b73 5b69 5d20 3d20 610a 0a20 2020  asks[i] = a..   
+000386d0: 2064 6976 6973 696f 6e73 203d 2064 6673   divisions = dfs
+000386e0: 5b30 5d2e 6469 7669 7369 6f6e 730a 2020  [0].divisions.  
+000386f0: 2020 6966 2074 7261 6e73 666f 726d 5f64    if transform_d
+00038700: 6976 6973 696f 6e73 2061 6e64 2069 7369  ivisions and isi
+00038710: 6e73 7461 6e63 6528 6466 735b 305d 2c20  nstance(dfs[0], 
+00038720: 496e 6465 7829 2061 6e64 206c 656e 2864  Index) and len(d
+00038730: 6673 2920 3d3d 2031 3a0a 2020 2020 2020  fs) == 1:.      
+00038740: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00038750: 2020 2064 6976 6973 696f 6e73 203d 206f     divisions = o
+00038760: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
+00038770: 2020 202a 5b70 642e 496e 6465 7828 6172     *[pd.Index(ar
+00038780: 672e 6469 7669 7369 6f6e 7329 2069 6620  g.divisions) if 
+00038790: 6172 6720 6973 2064 6673 5b30 5d20 656c  arg is dfs[0] el
+000387a0: 7365 2061 7267 2066 6f72 2061 7267 2069  se arg for arg i
+000387b0: 6e20 6172 6773 5d2c 0a20 2020 2020 2020  n args],.       
+000387c0: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
+000387d0: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
+000387e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000387f0: 6973 696e 7374 616e 6365 2864 6976 6973  isinstance(divis
+00038800: 696f 6e73 2c20 7064 2e49 6e64 6578 293a  ions, pd.Index):
+00038810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038820: 2064 6976 6973 696f 6e73 203d 206d 6574   divisions = met
+00038830: 686f 6473 2e74 6f6c 6973 7428 6469 7669  hods.tolist(divi
+00038840: 7369 6f6e 7329 0a20 2020 2020 2020 2065  sions).        e
+00038850: 7863 6570 7420 4578 6365 7074 696f 6e3a  xcept Exception:
+00038860: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
+00038870: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
+00038880: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00038890: 6f74 2076 616c 6964 5f64 6976 6973 696f  ot valid_divisio
+000388a0: 6e73 2864 6976 6973 696f 6e73 293a 0a20  ns(divisions):. 
+000388b0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000388c0: 6976 6973 696f 6e73 203d 205b 4e6f 6e65  ivisions = [None
+000388d0: 5d20 2a20 2864 6673 5b30 5d2e 6e70 6172  ] * (dfs[0].npar
+000388e0: 7469 7469 6f6e 7320 2b20 3129 0a0a 2020  titions + 1)..  
+000388f0: 2020 5f69 735f 6272 6f61 6463 6173 7461    _is_broadcasta
+00038900: 626c 6520 3d20 7061 7274 6961 6c28 6973  ble = partial(is
+00038910: 5f62 726f 6164 6361 7374 6162 6c65 2c20  _broadcastable, 
+00038920: 6466 7329 0a20 2020 2064 6673 203d 206c  dfs).    dfs = l
+00038930: 6973 7428 7265 6d6f 7665 285f 6973 5f62  ist(remove(_is_b
+00038940: 726f 6164 6361 7374 6162 6c65 2c20 6466  roadcastable, df
+00038950: 7329 290a 0a20 2020 206f 7468 6572 203d  s))..    other =
+00038960: 205b 0a20 2020 2020 2020 2028 692c 2061   [.        (i, a
+00038970: 7267 290a 2020 2020 2020 2020 666f 7220  rg).        for 
+00038980: 692c 2061 7267 2069 6e20 656e 756d 6572  i, arg in enumer
+00038990: 6174 6528 6172 6773 290a 2020 2020 2020  ate(args).      
+000389a0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+000389b0: 6e63 6528 6172 672c 2028 5f46 7261 6d65  nce(arg, (_Frame
+000389c0: 2c20 5363 616c 6172 2c20 4172 7261 7929  , Scalar, Array)
+000389d0: 290a 2020 2020 5d0a 0a20 2020 2023 2061  ).    ]..    # a
+000389e0: 646a 7573 7420 7468 6520 6b65 7920 6c65  djust the key le
+000389f0: 6e67 7468 206f 6620 5363 616c 6172 0a20  ngth of Scalar. 
+00038a00: 2020 2064 736b 203d 2070 6172 7469 7469     dsk = partiti
+00038a10: 6f6e 7769 7365 5f67 7261 7068 286f 702c  onwise_graph(op,
+00038a20: 205f 6e61 6d65 2c20 2a61 7267 732c 202a   _name, *args, *
+00038a30: 2a6b 7761 7267 7329 0a0a 2020 2020 6772  *kwargs)..    gr
+00038a40: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+00038a50: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+00038a60: 7469 6f6e 7328 5f6e 616d 652c 2064 736b  tions(_name, dsk
+00038a70: 2c20 6465 7065 6e64 656e 6369 6573 3d64  , dependencies=d
+00038a80: 6570 7329 0a0a 2020 2020 6966 206d 6574  eps)..    if met
+00038a90: 6120 6973 206e 6f5f 6465 6661 756c 743a  a is no_default:
+00038aa0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00038ab0: 6466 7329 203e 3d20 3220 616e 6420 6e6f  dfs) >= 2 and no
+00038ac0: 7420 616c 6c28 6861 7361 7474 7228 642c  t all(hasattr(d,
+00038ad0: 2022 6e70 6172 7469 7469 6f6e 7322 2920   "npartitions") 
+00038ae0: 666f 7220 6420 696e 2064 6173 6b73 293a  for d in dasks):
+00038af0: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
+00038b00: 686f 756c 6420 6e6f 7420 6f63 6375 7220  hould not occur 
+00038b10: 696e 2063 7572 7265 6e74 2066 756e 6373  in current funcs
+00038b20: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
+00038b30: 203d 2022 656c 656d 7769 7365 2077 6974   = "elemwise wit
+00038b40: 6820 3220 6f72 206d 6f72 6520 4461 7461  h 2 or more Data
+00038b50: 4672 616d 6573 2061 6e64 2053 6361 6c61  Frames and Scala
+00038b60: 7220 6973 206e 6f74 2073 7570 706f 7274  r is not support
+00038b70: 6564 220a 2020 2020 2020 2020 2020 2020  ed".            
+00038b80: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+00038b90: 6e74 6564 4572 726f 7228 6d73 6729 0a20  ntedError(msg). 
+00038ba0: 2020 2020 2020 2023 2046 6f72 2062 726f         # For bro
+00038bb0: 6164 6361 7374 6162 6c65 2073 6572 6965  adcastable serie
+00038bc0: 732c 2075 7365 206e 6f20 726f 7773 2e0a  s, use no rows..
+00038bd0: 2020 2020 2020 2020 7061 7274 7320 3d20          parts = 
+00038be0: 5b0a 2020 2020 2020 2020 2020 2020 642e  [.            d.
+00038bf0: 5f6d 6574 610a 2020 2020 2020 2020 2020  _meta.          
+00038c00: 2020 6966 205f 6973 5f62 726f 6164 6361    if _is_broadca
+00038c10: 7374 6162 6c65 2864 290a 2020 2020 2020  stable(d).      
+00038c20: 2020 2020 2020 656c 7365 206e 702e 656d        else np.em
+00038c30: 7074 7928 2829 2c20 6474 7970 653d 642e  pty((), dtype=d.
+00038c40: 6474 7970 6529 0a20 2020 2020 2020 2020  dtype).         
+00038c50: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00038c60: 2864 2c20 4172 7261 7929 0a20 2020 2020  (d, Array).     
+00038c70: 2020 2020 2020 2065 6c73 6520 642e 5f6d         else d._m
+00038c80: 6574 615f 6e6f 6e65 6d70 7479 0a20 2020  eta_nonempty.   
+00038c90: 2020 2020 2020 2020 2066 6f72 2064 2069           for d i
+00038ca0: 6e20 6461 736b 730a 2020 2020 2020 2020  n dasks.        
+00038cb0: 5d0a 2020 2020 2020 2020 7769 7468 2072  ].        with r
+00038cc0: 6169 7365 5f6f 6e5f 6d65 7461 5f65 7272  aise_on_meta_err
+00038cd0: 6f72 2866 756e 636e 616d 6528 6f70 2929  or(funcname(op))
+00038ce0: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
+00038cf0: 7461 203d 2070 6172 7469 616c 5f62 795f  ta = partial_by_
+00038d00: 6f72 6465 7228 2a70 6172 7473 2c20 6675  order(*parts, fu
+00038d10: 6e63 7469 6f6e 3d6f 702c 206f 7468 6572  nction=op, other
+00038d20: 3d6f 7468 6572 290a 0a20 2020 2072 6573  =other)..    res
+00038d30: 756c 7420 3d20 6e65 775f 6464 5f6f 626a  ult = new_dd_obj
+00038d40: 6563 7428 6772 6170 682c 205f 6e61 6d65  ect(graph, _name
+00038d50: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
+00038d60: 7329 0a20 2020 2072 6574 7572 6e20 6861  s).    return ha
+00038d70: 6e64 6c65 5f6f 7574 286f 7574 2c20 7265  ndle_out(out, re
+00038d80: 7375 6c74 290a 0a0a 6465 6620 6861 6e64  sult)...def hand
+00038d90: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
+00038da0: 6c74 293a 0a20 2020 2022 2222 4861 6e64  lt):.    """Hand
+00038db0: 6c65 206f 7574 2070 6172 616d 6574 6572  le out parameter
+00038dc0: 730a 0a20 2020 2049 6620 6f75 7420 6973  s..    If out is
+00038dd0: 2061 2064 6173 6b2e 4461 7461 4672 616d   a dask.DataFram
+00038de0: 652c 2064 6173 6b2e 5365 7269 6573 206f  e, dask.Series o
+00038df0: 7220 6461 736b 2e53 6361 6c61 7220 7468  r dask.Scalar th
+00038e00: 656e 0a20 2020 2074 6869 7320 6f76 6572  en.    this over
+00038e10: 7772 6974 6573 2074 6865 2063 6f6e 7465  writes the conte
+00038e20: 6e74 7320 6f66 2069 7420 7769 7468 2074  nts of it with t
+00038e30: 6865 2072 6573 756c 740a 2020 2020 2222  he result.    ""
+00038e40: 220a 2020 2020 6966 2069 7369 6e73 7461  ".    if isinsta
+00038e50: 6e63 6528 6f75 742c 2074 7570 6c65 293a  nce(out, tuple):
+00038e60: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00038e70: 6f75 7429 203d 3d20 313a 0a20 2020 2020  out) == 1:.     
+00038e80: 2020 2020 2020 206f 7574 203d 206f 7574         out = out
+00038e90: 5b30 5d0a 2020 2020 2020 2020 656c 6966  [0].        elif
+00038ea0: 206c 656e 286f 7574 2920 3e20 313a 0a20   len(out) > 1:. 
+00038eb0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00038ec0: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+00038ed0: 7272 6f72 2822 5468 6520 6f75 7420 7061  rror("The out pa
+00038ee0: 7261 6d65 7465 7220 6973 206e 6f74 2066  rameter is not f
+00038ef0: 756c 6c79 2073 7570 706f 7274 6564 2229  ully supported")
+00038f00: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00038f10: 2020 2020 2020 2020 2020 206f 7574 203d             out =
+00038f20: 204e 6f6e 650a 0a20 2020 2023 204e 6f74   None..    # Not
+00038f30: 6963 652c 2077 6520 7573 6520 2e5f 5f63  ice, we use .__c
+00038f40: 6c61 7373 5f5f 2061 7320 6f70 706f 7365  lass__ as oppose
+00038f50: 6420 746f 2074 7970 6528 2920 696e 206f  d to type() in o
+00038f60: 7264 6572 2074 6f20 7375 7070 6f72 740a  rder to support.
+00038f70: 2020 2020 2320 6f62 6a65 6374 2070 726f      # object pro
+00038f80: 7869 6573 2073 6565 203c 6874 7470 733a  xies see <https:
+00038f90: 2f2f 6769 7468 7562 2e63 6f6d 2f64 6173  //github.com/das
+00038fa0: 6b2f 6461 736b 2f70 756c 6c2f 3639 3831  k/dask/pull/6981
+00038fb0: 3e0a 2020 2020 6966 206f 7574 2069 7320  >.    if out is 
+00038fc0: 6e6f 7420 4e6f 6e65 2061 6e64 206f 7574  not None and out
+00038fd0: 2e5f 5f63 6c61 7373 5f5f 2021 3d20 7265  .__class__ != re
+00038fe0: 7375 6c74 2e5f 5f63 6c61 7373 5f5f 3a0a  sult.__class__:.
+00038ff0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00039000: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+00039010: 2020 2020 2022 4d69 736d 6174 6368 6564       "Mismatched
+00039020: 2074 7970 6573 2062 6574 7765 656e 2072   types between r
+00039030: 6573 756c 7420 616e 6420 6f75 7420 7061  esult and out pa
+00039040: 7261 6d65 7465 722e 2022 0a20 2020 2020  rameter. ".     
+00039050: 2020 2020 2020 2022 6f75 743d 2573 2c20         "out=%s, 
+00039060: 7265 7375 6c74 3d25 7322 2025 2028 7374  result=%s" % (st
+00039070: 7228 7479 7065 286f 7574 2929 2c20 7374  r(type(out)), st
+00039080: 7228 7479 7065 2872 6573 756c 7429 2929  r(type(result)))
+00039090: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000390a0: 6966 2069 7369 6e73 7461 6e63 6528 6f75  if isinstance(ou
+000390b0: 742c 2044 6174 6146 7261 6d65 293a 0a20  t, DataFrame):. 
+000390c0: 2020 2020 2020 2069 6620 6c65 6e28 6f75         if len(ou
+000390d0: 742e 636f 6c75 6d6e 7329 2021 3d20 6c65  t.columns) != le
+000390e0: 6e28 7265 7375 6c74 2e63 6f6c 756d 6e73  n(result.columns
+000390f0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00039100: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00039110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039120: 2022 4d69 736d 6174 6368 6564 2063 6f6c   "Mismatched col
+00039130: 756d 6e73 2063 6f75 6e74 2062 6574 7765  umns count betwe
+00039140: 656e 2072 6573 756c 7420 616e 6420 6f75  en result and ou
+00039150: 7420 7061 7261 6d65 7465 722e 2022 0a20  t parameter. ". 
+00039160: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00039170: 6f75 743d 2573 2c20 7265 7375 6c74 3d25  out=%s, result=%
+00039180: 7322 2025 2028 7374 7228 6c65 6e28 6f75  s" % (str(len(ou
+00039190: 742e 636f 6c75 6d6e 7329 292c 2073 7472  t.columns)), str
+000391a0: 286c 656e 2872 6573 756c 742e 636f 6c75  (len(result.colu
+000391b0: 6d6e 7329 2929 0a20 2020 2020 2020 2020  mns))).         
+000391c0: 2020 2029 0a0a 2020 2020 6966 2069 7369     )..    if isi
+000391d0: 6e73 7461 6e63 6528 6f75 742c 2028 5365  nstance(out, (Se
+000391e0: 7269 6573 2c20 4461 7461 4672 616d 652c  ries, DataFrame,
+000391f0: 2053 6361 6c61 7229 293a 0a20 2020 2020   Scalar)):.     
+00039200: 2020 206f 7574 2e5f 6d65 7461 203d 2072     out._meta = r
+00039210: 6573 756c 742e 5f6d 6574 610a 2020 2020  esult._meta.    
+00039220: 2020 2020 6f75 742e 5f6e 616d 6520 3d20      out._name = 
+00039230: 7265 7375 6c74 2e5f 6e61 6d65 0a20 2020  result._name.   
+00039240: 2020 2020 206f 7574 2e64 6173 6b20 3d20       out.dask = 
+00039250: 7265 7375 6c74 2e64 6173 6b0a 0a20 2020  result.dask..   
+00039260: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00039270: 7374 616e 6365 286f 7574 2c20 5363 616c  stance(out, Scal
+00039280: 6172 293a 0a20 2020 2020 2020 2020 2020  ar):.           
+00039290: 206f 7574 2e5f 6469 7669 7369 6f6e 7320   out._divisions 
+000392a0: 3d20 7265 7375 6c74 2e64 6976 6973 696f  = result.divisio
+000392b0: 6e73 0a20 2020 2065 6c69 6620 6f75 7420  ns.    elif out 
+000392c0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000392d0: 2020 2020 206d 7367 203d 2028 0a20 2020       msg = (.   
+000392e0: 2020 2020 2020 2020 2022 5468 6520 6f75           "The ou
+000392f0: 7420 7061 7261 6d65 7465 7220 6973 206e  t parameter is n
+00039300: 6f74 2066 756c 6c79 2073 7570 706f 7274  ot fully support
+00039310: 6564 2e22 0a20 2020 2020 2020 2020 2020  ed.".           
+00039320: 2022 2052 6563 6569 7665 6420 7479 7065   " Received type
+00039330: 2025 732c 2065 7870 6563 7465 6420 2573   %s, expected %s
+00039340: 2022 0a20 2020 2020 2020 2020 2020 2025   ".            %
+00039350: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00039360: 2020 2074 7970 656e 616d 6528 7479 7065     typename(type
+00039370: 286f 7574 2929 2c0a 2020 2020 2020 2020  (out)),.        
+00039380: 2020 2020 2020 2020 7479 7065 6e61 6d65          typename
+00039390: 2874 7970 6528 7265 7375 6c74 2929 2c0a  (type(result)),.
+000393a0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000393b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000393c0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+000393d0: 6e74 6564 4572 726f 7228 6d73 6729 0a20  ntedError(msg). 
+000393e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000393f0: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
+00039400: 0a64 6566 205f 6d61 7962 655f 6672 6f6d  .def _maybe_from
+00039410: 5f70 616e 6461 7328 6466 7329 3a0a 2020  _pandas(dfs):.  
+00039420: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+00039430: 6672 616d 652e 696f 2069 6d70 6f72 7420  frame.io import 
+00039440: 6672 6f6d 5f70 616e 6461 730a 0a20 2020  from_pandas..   
+00039450: 2064 6673 203d 205b 0a20 2020 2020 2020   dfs = [.       
+00039460: 2066 726f 6d5f 7061 6e64 6173 2864 662c   from_pandas(df,
+00039470: 2031 290a 2020 2020 2020 2020 6966 2028   1).        if (
+00039480: 6973 5f73 6572 6965 735f 6c69 6b65 2864  is_series_like(d
+00039490: 6629 206f 7220 6973 5f64 6174 6166 7261  f) or is_datafra
+000394a0: 6d65 5f6c 696b 6528 6466 2929 2061 6e64  me_like(df)) and
+000394b0: 206e 6f74 2069 735f 6461 736b 5f63 6f6c   not is_dask_col
+000394c0: 6c65 6374 696f 6e28 6466 290a 2020 2020  lection(df).    
+000394d0: 2020 2020 656c 7365 2064 660a 2020 2020      else df.    
+000394e0: 2020 2020 666f 7220 6466 2069 6e20 6466      for df in df
+000394f0: 730a 2020 2020 5d0a 2020 2020 7265 7475  s.    ].    retu
+00039500: 726e 2064 6673 0a0a 0a64 6566 2068 6173  rn dfs...def has
+00039510: 685f 7368 6172 6428 0a20 2020 2064 662c  h_shard(.    df,
+00039520: 206e 7061 7274 732c 2073 706c 6974 5f6f   nparts, split_o
+00039530: 7574 5f73 6574 7570 3d4e 6f6e 652c 2073  ut_setup=None, s
+00039540: 706c 6974 5f6f 7574 5f73 6574 7570 5f6b  plit_out_setup_k
+00039550: 7761 7267 733d 4e6f 6e65 2c20 6967 6e6f  wargs=None, igno
+00039560: 7265 5f69 6e64 6578 3d46 616c 7365 0a29  re_index=False.)
+00039570: 3a0a 2020 2020 6966 2073 706c 6974 5f6f  :.    if split_o
+00039580: 7574 5f73 6574 7570 3a0a 2020 2020 2020  ut_setup:.      
+00039590: 2020 6820 3d20 7370 6c69 745f 6f75 745f    h = split_out_
+000395a0: 7365 7475 7028 6466 2c20 2a2a 2873 706c  setup(df, **(spl
+000395b0: 6974 5f6f 7574 5f73 6574 7570 5f6b 7761  it_out_setup_kwa
+000395c0: 7267 7320 6f72 207b 7d29 290a 2020 2020  rgs or {})).    
+000395d0: 656c 7365 3a0a 2020 2020 2020 2020 6820  else:.        h 
+000395e0: 3d20 6466 0a0a 2020 2020 6820 3d20 6861  = df..    h = ha
+000395f0: 7368 5f6f 626a 6563 745f 6469 7370 6174  sh_object_dispat
+00039600: 6368 2868 2c20 696e 6465 783d 4661 6c73  ch(h, index=Fals
+00039610: 6529 0a20 2020 2072 6574 7572 6e20 6772  e).    return gr
+00039620: 6f75 705f 7370 6c69 745f 6469 7370 6174  oup_split_dispat
+00039630: 6368 2864 662c 2068 2025 206e 7061 7274  ch(df, h % npart
+00039640: 732c 206e 7061 7274 732c 2069 676e 6f72  s, nparts, ignor
+00039650: 655f 696e 6465 783d 6967 6e6f 7265 5f69  e_index=ignore_i
+00039660: 6e64 6578 290a 0a0a 6465 6620 7370 6c69  ndex)...def spli
+00039670: 745f 6576 656e 6c79 2864 662c 206b 293a  t_evenly(df, k):
+00039680: 0a20 2020 2022 2222 5370 6c69 7420 6461  .    """Split da
+00039690: 7461 6672 616d 6520 696e 746f 206b 2072  taframe into k r
+000396a0: 6f75 6768 6c79 2065 7175 616c 2070 6172  oughly equal par
+000396b0: 7473 2222 220a 2020 2020 6469 7669 7369  ts""".    divisi
+000396c0: 6f6e 7320 3d20 6e70 2e6c 696e 7370 6163  ons = np.linspac
+000396d0: 6528 302c 206c 656e 2864 6629 2c20 6b20  e(0, len(df), k 
+000396e0: 2b20 3129 2e61 7374 7970 6528 696e 7429  + 1).astype(int)
+000396f0: 0a20 2020 2072 6574 7572 6e20 7b69 3a20  .    return {i: 
+00039700: 6466 2e69 6c6f 635b 6469 7669 7369 6f6e  df.iloc[division
+00039710: 735b 695d 203a 2064 6976 6973 696f 6e73  s[i] : divisions
+00039720: 5b69 202b 2031 5d5d 2066 6f72 2069 2069  [i + 1]] for i i
+00039730: 6e20 7261 6e67 6528 6b29 7d0a 0a0a 6465  n range(k)}...de
+00039740: 6620 7370 6c69 745f 6f75 745f 6f6e 5f69  f split_out_on_i
+00039750: 6e64 6578 2864 6629 3a0a 2020 2020 6820  ndex(df):.    h 
+00039760: 3d20 6466 2e69 6e64 6578 0a20 2020 2069  = df.index.    i
+00039770: 6620 6973 696e 7374 616e 6365 2868 2c20  f isinstance(h, 
+00039780: 7064 2e4d 756c 7469 496e 6465 7829 3a0a  pd.MultiIndex):.
+00039790: 2020 2020 2020 2020 6820 3d20 6d65 7461          h = meta
+000397a0: 5f66 7261 6d65 5f63 6f6e 7374 7275 6374  _frame_construct
+000397b0: 6f72 2864 6629 285b 5d2c 2069 6e64 6578  or(df)([], index
+000397c0: 3d68 292e 7265 7365 745f 696e 6465 7828  =h).reset_index(
+000397d0: 290a 2020 2020 7265 7475 726e 2068 0a0a  ).    return h..
+000397e0: 0a64 6566 2073 706c 6974 5f6f 7574 5f6f  .def split_out_o
+000397f0: 6e5f 636f 6c73 2864 662c 2063 6f6c 733d  n_cols(df, cols=
+00039800: 4e6f 6e65 293a 0a20 2020 2072 6574 7572  None):.    retur
+00039810: 6e20 6466 5b63 6f6c 735d 0a0a 0a40 696e  n df[cols]...@in
+00039820: 7365 7274 5f6d 6574 615f 7061 7261 6d5f  sert_meta_param_
+00039830: 6465 7363 7269 7074 696f 6e0a 6465 6620  description.def 
+00039840: 6170 706c 795f 636f 6e63 6174 5f61 7070  apply_concat_app
+00039850: 6c79 280a 2020 2020 6172 6773 2c0a 2020  ly(.    args,.  
+00039860: 2020 6368 756e 6b3d 4e6f 6e65 2c0a 2020    chunk=None,.  
+00039870: 2020 6167 6772 6567 6174 653d 4e6f 6e65    aggregate=None
+00039880: 2c0a 2020 2020 636f 6d62 696e 653d 4e6f  ,.    combine=No
+00039890: 6e65 2c0a 2020 2020 6d65 7461 3d6e 6f5f  ne,.    meta=no_
+000398a0: 6465 6661 756c 742c 0a20 2020 2074 6f6b  default,.    tok
+000398b0: 656e 3d4e 6f6e 652c 0a20 2020 2063 6875  en=None,.    chu
+000398c0: 6e6b 5f6b 7761 7267 733d 4e6f 6e65 2c0a  nk_kwargs=None,.
+000398d0: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
+000398e0: 6172 6773 3d4e 6f6e 652c 0a20 2020 2063  args=None,.    c
+000398f0: 6f6d 6269 6e65 5f6b 7761 7267 733d 4e6f  ombine_kwargs=No
+00039900: 6e65 2c0a 2020 2020 7370 6c69 745f 6576  ne,.    split_ev
+00039910: 6572 793d 4e6f 6e65 2c0a 2020 2020 7370  ery=None,.    sp
+00039920: 6c69 745f 6f75 743d 4e6f 6e65 2c0a 2020  lit_out=None,.  
+00039930: 2020 7370 6c69 745f 6f75 745f 7365 7475    split_out_setu
+00039940: 703d 4e6f 6e65 2c0a 2020 2020 7370 6c69  p=None,.    spli
+00039950: 745f 6f75 745f 7365 7475 705f 6b77 6172  t_out_setup_kwar
+00039960: 6773 3d4e 6f6e 652c 0a20 2020 2073 6f72  gs=None,.    sor
+00039970: 743d 4e6f 6e65 2c0a 2020 2020 6967 6e6f  t=None,.    igno
+00039980: 7265 5f69 6e64 6578 3d46 616c 7365 2c0a  re_index=False,.
+00039990: 2020 2020 2a2a 6b77 6172 6773 2c0a 293a      **kwargs,.):
+000399a0: 0a20 2020 2022 2222 4170 706c 7920 6120  .    """Apply a 
+000399b0: 6675 6e63 7469 6f6e 2074 6f20 626c 6f63  function to bloc
+000399c0: 6b73 2c20 7468 656e 2063 6f6e 6361 742c  ks, then concat,
+000399d0: 2074 6865 6e20 6170 706c 7920 6167 6169   then apply agai
+000399e0: 6e0a 0a20 2020 2050 6172 616d 6574 6572  n..    Parameter
+000399f0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00039a00: 0a20 2020 2061 7267 7320 3a0a 2020 2020  .    args :.    
+00039a10: 2020 2020 506f 7369 7469 6f6e 616c 2061      Positional a
+00039a20: 7267 756d 656e 7473 2066 6f72 2074 6865  rguments for the
+00039a30: 2060 6368 756e 6b60 2066 756e 6374 696f   `chunk` functio
+00039a40: 6e2e 2041 6c6c 2060 6461 736b 2e64 6174  n. All `dask.dat
+00039a50: 6166 7261 6d65 600a 2020 2020 2020 2020  aframe`.        
+00039a60: 6f62 6a65 6374 7320 7368 6f75 6c64 2062  objects should b
+00039a70: 6520 7061 7274 6974 696f 6e65 6420 616e  e partitioned an
+00039a80: 6420 696e 6465 7865 6420 6571 7569 7661  d indexed equiva
+00039a90: 6c65 6e74 6c79 2e0a 2020 2020 6368 756e  lently..    chun
+00039aa0: 6b20 3a20 6675 6e63 7469 6f6e 205b 626c  k : function [bl
+00039ab0: 6f63 6b2d 7065 722d 6172 675d 202d 3e20  ock-per-arg] -> 
+00039ac0: 626c 6f63 6b0a 2020 2020 2020 2020 4675  block.        Fu
+00039ad0: 6e63 7469 6f6e 2074 6f20 6f70 6572 6174  nction to operat
+00039ae0: 6520 6f6e 2065 6163 6820 626c 6f63 6b20  e on each block 
+00039af0: 6f66 2064 6174 610a 2020 2020 6167 6772  of data.    aggr
+00039b00: 6567 6174 6520 3a20 6675 6e63 7469 6f6e  egate : function
+00039b10: 2063 6f6e 6361 7465 6e61 7465 642d 626c   concatenated-bl
+00039b20: 6f63 6b20 2d3e 2062 6c6f 636b 0a20 2020  ock -> block.   
+00039b30: 2020 2020 2046 756e 6374 696f 6e20 746f       Function to
+00039b40: 206f 7065 7261 7465 206f 6e20 7468 6520   operate on the 
+00039b50: 636f 6e63 6174 656e 6174 6564 2072 6573  concatenated res
+00039b60: 756c 7420 6f66 2063 6875 6e6b 0a20 2020  ult of chunk.   
+00039b70: 2063 6f6d 6269 6e65 203a 2066 756e 6374   combine : funct
+00039b80: 696f 6e20 636f 6e63 6174 656e 6174 6564  ion concatenated
+00039b90: 2d62 6c6f 636b 202d 3e20 626c 6f63 6b2c  -block -> block,
+00039ba0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00039bb0: 2020 4675 6e63 7469 6f6e 2074 6f20 6f70    Function to op
+00039bc0: 6572 6174 6520 6f6e 2069 6e74 6572 6d65  erate on interme
+00039bd0: 6469 6174 6520 636f 6e63 6174 656e 6174  diate concatenat
+00039be0: 6564 2072 6573 756c 7473 206f 6620 6368  ed results of ch
+00039bf0: 756e 6b0a 2020 2020 2020 2020 696e 2061  unk.        in a
+00039c00: 2074 7265 652d 7265 6475 6374 696f 6e2e   tree-reduction.
+00039c10: 2049 6620 6e6f 7420 7072 6f76 6964 6564   If not provided
+00039c20: 2c20 6465 6661 756c 7473 2074 6f20 6167  , defaults to ag
+00039c30: 6772 6567 6174 652e 0a20 2020 2024 4d45  gregate..    $ME
+00039c40: 5441 0a20 2020 2074 6f6b 656e 203a 2073  TA.    token : s
+00039c50: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
+00039c60: 2020 2020 2054 6865 206e 616d 6520 746f       The name to
+00039c70: 2075 7365 2066 6f72 2074 6865 206f 7574   use for the out
+00039c80: 7075 7420 6b65 7973 2e0a 2020 2020 6368  put keys..    ch
+00039c90: 756e 6b5f 6b77 6172 6773 203a 2064 6963  unk_kwargs : dic
+00039ca0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+00039cb0: 2020 2020 4b65 7977 6f72 6473 2066 6f72      Keywords for
+00039cc0: 2074 6865 2063 6875 6e6b 2066 756e 6374   the chunk funct
+00039cd0: 696f 6e20 6f6e 6c79 2e0a 2020 2020 6167  ion only..    ag
+00039ce0: 6772 6567 6174 655f 6b77 6172 6773 203a  gregate_kwargs :
+00039cf0: 2064 6963 742c 206f 7074 696f 6e61 6c0a   dict, optional.
+00039d00: 2020 2020 2020 2020 4b65 7977 6f72 6473          Keywords
+00039d10: 2066 6f72 2074 6865 2061 6767 7265 6761   for the aggrega
+00039d20: 7465 2066 756e 6374 696f 6e20 6f6e 6c79  te function only
+00039d30: 2e0a 2020 2020 636f 6d62 696e 655f 6b77  ..    combine_kw
+00039d40: 6172 6773 203a 2064 6963 742c 206f 7074  args : dict, opt
+00039d50: 696f 6e61 6c0a 2020 2020 2020 2020 4b65  ional.        Ke
+00039d60: 7977 6f72 6473 2066 6f72 2074 6865 2063  ywords for the c
+00039d70: 6f6d 6269 6e65 2066 756e 6374 696f 6e20  ombine function 
+00039d80: 6f6e 6c79 2e0a 2020 2020 7370 6c69 745f  only..    split_
+00039d90: 6576 6572 7920 3a20 696e 742c 206f 7074  every : int, opt
+00039da0: 696f 6e61 6c0a 2020 2020 2020 2020 4772  ional.        Gr
+00039db0: 6f75 7020 7061 7274 6974 696f 6e73 2069  oup partitions i
+00039dc0: 6e74 6f20 6772 6f75 7073 206f 6620 7468  nto groups of th
+00039dd0: 6973 2073 697a 6520 7768 696c 6520 7065  is size while pe
+00039de0: 7266 6f72 6d69 6e67 2061 0a20 2020 2020  rforming a.     
+00039df0: 2020 2074 7265 652d 7265 6475 6374 696f     tree-reductio
+00039e00: 6e2e 2049 6620 7365 7420 746f 2046 616c  n. If set to Fal
+00039e10: 7365 2c20 6e6f 2074 7265 652d 7265 6475  se, no tree-redu
+00039e20: 6374 696f 6e20 7769 6c6c 2062 6520 7573  ction will be us
+00039e30: 6564 2c0a 2020 2020 2020 2020 616e 6420  ed,.        and 
+00039e40: 616c 6c20 696e 7465 726d 6564 6961 7465  all intermediate
+00039e50: 7320 7769 6c6c 2062 6520 636f 6e63 6174  s will be concat
+00039e60: 656e 6174 6564 2061 6e64 2070 6173 7365  enated and passe
+00039e70: 6420 746f 2060 6061 6767 7265 6761 7465  d to ``aggregate
+00039e80: 6060 2e0a 2020 2020 2020 2020 4465 6661  ``..        Defa
+00039e90: 756c 7420 6973 2038 2e0a 2020 2020 7370  ult is 8..    sp
+00039ea0: 6c69 745f 6f75 7420 3a20 696e 742c 206f  lit_out : int, o
+00039eb0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00039ec0: 4e75 6d62 6572 206f 6620 6f75 7470 7574  Number of output
+00039ed0: 2070 6172 7469 7469 6f6e 732e 2053 706c   partitions. Spl
+00039ee0: 6974 206f 6363 7572 7320 6166 7465 7220  it occurs after 
+00039ef0: 6669 7273 7420 6368 756e 6b20 7265 6475  first chunk redu
+00039f00: 6374 696f 6e2e 0a20 2020 2073 706c 6974  ction..    split
+00039f10: 5f6f 7574 5f73 6574 7570 203a 2063 616c  _out_setup : cal
+00039f20: 6c61 626c 652c 206f 7074 696f 6e61 6c0a  lable, optional.
+00039f30: 2020 2020 2020 2020 4966 2070 726f 7669          If provi
+00039f40: 6465 642c 2074 6869 7320 6675 6e63 7469  ded, this functi
+00039f50: 6f6e 2069 7320 6361 6c6c 6564 206f 6e20  on is called on 
+00039f60: 6561 6368 2063 6875 6e6b 2062 6566 6f72  each chunk befor
+00039f70: 6520 7065 7266 6f72 6d69 6e67 0a20 2020  e performing.   
+00039f80: 2020 2020 2074 6865 2068 6173 682d 7370       the hash-sp
+00039f90: 6c69 742e 2049 7420 7368 6f75 6c64 2072  lit. It should r
+00039fa0: 6574 7572 6e20 6120 7061 6e64 6173 206f  eturn a pandas o
+00039fb0: 626a 6563 742c 2077 6865 7265 2065 6163  bject, where eac
+00039fc0: 6820 726f 770a 2020 2020 2020 2020 2865  h row.        (e
+00039fd0: 7863 6c75 6469 6e67 2074 6865 2069 6e64  xcluding the ind
+00039fe0: 6578 2920 6973 2068 6173 6865 642e 2049  ex) is hashed. I
+00039ff0: 6620 6e6f 7420 7072 6f76 6964 6564 2c20  f not provided, 
+0003a000: 7468 6520 6368 756e 6b20 6973 2068 6173  the chunk is has
+0003a010: 6865 640a 2020 2020 2020 2020 6173 2069  hed.        as i
+0003a020: 732e 0a20 2020 2073 706c 6974 5f6f 7574  s..    split_out
+0003a030: 5f73 6574 7570 5f6b 7761 7267 7320 3a20  _setup_kwargs : 
+0003a040: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
+0003a050: 2020 2020 2020 204b 6579 776f 7264 7320         Keywords 
+0003a060: 666f 7220 7468 6520 6073 706c 6974 5f6f  for the `split_o
+0003a070: 7574 5f73 6574 7570 6020 6675 6e63 7469  ut_setup` functi
+0003a080: 6f6e 206f 6e6c 792e 0a20 2020 2073 6f72  on only..    sor
+0003a090: 7420 3a20 626f 6f6c 2c20 6465 6661 756c  t : bool, defaul
+0003a0a0: 7420 4e6f 6e65 0a20 2020 2020 2020 2049  t None.        I
+0003a0b0: 6620 616c 6c6f 7765 642c 2073 6f72 7420  f allowed, sort 
+0003a0c0: 7468 6520 6b65 7973 206f 6620 7468 6520  the keys of the 
+0003a0d0: 6f75 7470 7574 2061 6767 7265 6761 7469  output aggregati
+0003a0e0: 6f6e 2e0a 2020 2020 6967 6e6f 7265 5f69  on..    ignore_i
+0003a0f0: 6e64 6578 203a 2062 6f6f 6c2c 2064 6566  ndex : bool, def
+0003a100: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
+0003a110: 2020 2049 6620 5472 7565 2c20 646f 206e     If True, do n
+0003a120: 6f74 2070 7265 7365 7276 6520 696e 6465  ot preserve inde
+0003a130: 7820 7661 6c75 6573 2074 6872 6f75 6768  x values through
+0003a140: 6f75 7420 4143 4120 6f70 6572 6174 696f  out ACA operatio
+0003a150: 6e73 2e0a 2020 2020 6b77 6172 6773 203a  ns..    kwargs :
+0003a160: 0a20 2020 2020 2020 2041 6c6c 2072 656d  .        All rem
+0003a170: 6169 6e69 6e67 206b 6579 776f 7264 7320  aining keywords 
+0003a180: 7769 6c6c 2062 6520 7061 7373 6564 2074  will be passed t
+0003a190: 6f20 6060 6368 756e 6b60 602c 2060 6061  o ``chunk``, ``a
+0003a1a0: 6767 7265 6761 7465 6060 2c20 616e 640a  ggregate``, and.
+0003a1b0: 2020 2020 2020 2020 6060 636f 6d62 696e          ``combin
+0003a1c0: 6560 602e 0a0a 2020 2020 4578 616d 706c  e``...    Exampl
+0003a1d0: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
+0003a1e0: 2020 2020 3e3e 3e20 6465 6620 6368 756e      >>> def chun
+0003a1f0: 6b28 615f 626c 6f63 6b2c 2062 5f62 6c6f  k(a_block, b_blo
+0003a200: 636b 293a 0a20 2020 202e 2e2e 2020 2020  ck):.    ...    
+0003a210: 2070 6173 730a 0a20 2020 203e 3e3e 2064   pass..    >>> d
+0003a220: 6566 2061 6767 2864 6629 3a0a 2020 2020  ef agg(df):.    
+0003a230: 2e2e 2e20 2020 2020 7061 7373 0a0a 2020  ...     pass..  
+0003a240: 2020 3e3e 3e20 6170 706c 795f 636f 6e63    >>> apply_conc
+0003a250: 6174 5f61 7070 6c79 285b 612c 2062 5d2c  at_apply([a, b],
+0003a260: 2063 6875 6e6b 3d63 6875 6e6b 2c20 6167   chunk=chunk, ag
+0003a270: 6772 6567 6174 653d 6167 6729 2020 2320  gregate=agg)  # 
+0003a280: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
+0003a290: 2020 2022 2222 0a20 2020 2069 6620 7370     """.    if sp
+0003a2a0: 6c69 745f 6f75 7420 6973 204e 6f6e 653a  lit_out is None:
+0003a2b0: 0a20 2020 2020 2020 2073 706c 6974 5f6f  .        split_o
+0003a2c0: 7574 203d 2031 0a20 2020 2069 6620 6368  ut = 1.    if ch
+0003a2d0: 756e 6b5f 6b77 6172 6773 2069 7320 4e6f  unk_kwargs is No
+0003a2e0: 6e65 3a0a 2020 2020 2020 2020 6368 756e  ne:.        chun
+0003a2f0: 6b5f 6b77 6172 6773 203d 2064 6963 7428  k_kwargs = dict(
+0003a300: 290a 2020 2020 6966 2061 6767 7265 6761  ).    if aggrega
+0003a310: 7465 5f6b 7761 7267 7320 6973 204e 6f6e  te_kwargs is Non
+0003a320: 653a 0a20 2020 2020 2020 2061 6767 7265  e:.        aggre
+0003a330: 6761 7465 5f6b 7761 7267 7320 3d20 6469  gate_kwargs = di
+0003a340: 6374 2829 0a20 2020 2063 6875 6e6b 5f6b  ct().    chunk_k
+0003a350: 7761 7267 732e 7570 6461 7465 286b 7761  wargs.update(kwa
+0003a360: 7267 7329 0a20 2020 2061 6767 7265 6761  rgs).    aggrega
+0003a370: 7465 5f6b 7761 7267 732e 7570 6461 7465  te_kwargs.update
+0003a380: 286b 7761 7267 7329 0a0a 2020 2020 6966  (kwargs)..    if
+0003a390: 2063 6f6d 6269 6e65 2069 7320 4e6f 6e65   combine is None
+0003a3a0: 3a0a 2020 2020 2020 2020 6966 2063 6f6d  :.        if com
+0003a3b0: 6269 6e65 5f6b 7761 7267 733a 0a20 2020  bine_kwargs:.   
+0003a3c0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0003a3d0: 616c 7565 4572 726f 7228 2260 636f 6d62  alueError("`comb
+0003a3e0: 696e 655f 6b77 6172 6773 6020 7072 6f76  ine_kwargs` prov
+0003a3f0: 6964 6564 2077 6974 6820 6e6f 2060 636f  ided with no `co
+0003a400: 6d62 696e 6560 2229 0a20 2020 2020 2020  mbine`").       
+0003a410: 2063 6f6d 6269 6e65 203d 2061 6767 7265   combine = aggre
+0003a420: 6761 7465 0a20 2020 2020 2020 2063 6f6d  gate.        com
+0003a430: 6269 6e65 5f6b 7761 7267 7320 3d20 6167  bine_kwargs = ag
+0003a440: 6772 6567 6174 655f 6b77 6172 6773 0a20  gregate_kwargs. 
+0003a450: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003a460: 2069 6620 636f 6d62 696e 655f 6b77 6172   if combine_kwar
+0003a470: 6773 2069 7320 4e6f 6e65 3a0a 2020 2020  gs is None:.    
+0003a480: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
+0003a490: 6b77 6172 6773 203d 2064 6963 7428 290a  kwargs = dict().
+0003a4a0: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
+0003a4b0: 6b77 6172 6773 2e75 7064 6174 6528 6b77  kwargs.update(kw
+0003a4c0: 6172 6773 290a 0a20 2020 2069 6620 6e6f  args)..    if no
+0003a4d0: 7420 6973 696e 7374 616e 6365 2861 7267  t isinstance(arg
+0003a4e0: 732c 2028 7475 706c 652c 206c 6973 7429  s, (tuple, list)
+0003a4f0: 293a 0a20 2020 2020 2020 2061 7267 7320  ):.        args 
+0003a500: 3d20 5b61 7267 735d 0a0a 2020 2020 6466  = [args]..    df
+0003a510: 7320 3d20 5b61 7267 2066 6f72 2061 7267  s = [arg for arg
+0003a520: 2069 6e20 6172 6773 2069 6620 6973 696e   in args if isin
+0003a530: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
+0003a540: 6d65 295d 0a0a 2020 2020 6e70 6172 7469  me)]..    nparti
+0003a550: 7469 6f6e 7320 3d20 7b61 7267 2e6e 7061  tions = {arg.npa
+0003a560: 7274 6974 696f 6e73 2066 6f72 2061 7267  rtitions for arg
+0003a570: 2069 6e20 6466 737d 0a20 2020 2069 6620   in dfs}.    if 
+0003a580: 6c65 6e28 6e70 6172 7469 7469 6f6e 7329  len(npartitions)
+0003a590: 203e 2031 3a0a 2020 2020 2020 2020 7261   > 1:.        ra
+0003a5a0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+0003a5b0: 416c 6c20 6172 6775 6d65 6e74 7320 6d75  All arguments mu
+0003a5c0: 7374 2068 6176 6520 7361 6d65 206e 756d  st have same num
+0003a5d0: 6265 7220 6f66 2070 6172 7469 7469 6f6e  ber of partition
+0003a5e0: 7322 290a 2020 2020 6e70 6172 7469 7469  s").    npartiti
+0003a5f0: 6f6e 7320 3d20 6e70 6172 7469 7469 6f6e  ons = npartition
+0003a600: 732e 706f 7028 290a 0a20 2020 2069 6620  s.pop()..    if 
+0003a610: 7370 6c69 745f 6576 6572 7920 6973 204e  split_every is N
+0003a620: 6f6e 653a 0a20 2020 2020 2020 2073 706c  one:.        spl
+0003a630: 6974 5f65 7665 7279 203d 2038 0a20 2020  it_every = 8.   
+0003a640: 2065 6c69 6620 7370 6c69 745f 6576 6572   elif split_ever
+0003a650: 7920 6973 2046 616c 7365 3a0a 2020 2020  y is False:.    
+0003a660: 2020 2020 7370 6c69 745f 6576 6572 7920      split_every 
+0003a670: 3d20 6e70 6172 7469 7469 6f6e 730a 2020  = npartitions.  
+0003a680: 2020 656c 6966 2073 706c 6974 5f65 7665    elif split_eve
+0003a690: 7279 203c 2032 206f 7220 6e6f 7420 6973  ry < 2 or not is
+0003a6a0: 696e 7374 616e 6365 2873 706c 6974 5f65  instance(split_e
+0003a6b0: 7665 7279 2c20 496e 7465 6772 616c 293a  very, Integral):
+0003a6c0: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+0003a6d0: 616c 7565 4572 726f 7228 2273 706c 6974  alueError("split
+0003a6e0: 5f65 7665 7279 206d 7573 7420 6265 2061  _every must be a
+0003a6f0: 6e20 696e 7465 6765 7220 3e3d 2032 2229  n integer >= 2")
+0003a700: 0a0a 2020 2020 746f 6b65 6e5f 6b65 7920  ..    token_key 
+0003a710: 3d20 746f 6b65 6e69 7a65 280a 2020 2020  = tokenize(.    
+0003a720: 2020 2020 746f 6b65 6e20 6f72 2028 6368      token or (ch
+0003a730: 756e 6b2c 2061 6767 7265 6761 7465 292c  unk, aggregate),
+0003a740: 0a20 2020 2020 2020 206d 6574 612c 0a20  .        meta,. 
+0003a750: 2020 2020 2020 2061 7267 732c 0a20 2020         args,.   
+0003a760: 2020 2020 2063 6875 6e6b 5f6b 7761 7267       chunk_kwarg
+0003a770: 732c 0a20 2020 2020 2020 2061 6767 7265  s,.        aggre
+0003a780: 6761 7465 5f6b 7761 7267 732c 0a20 2020  gate_kwargs,.   
+0003a790: 2020 2020 2063 6f6d 6269 6e65 5f6b 7761       combine_kwa
+0003a7a0: 7267 732c 0a20 2020 2020 2020 2073 706c  rgs,.        spl
+0003a7b0: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
+0003a7c0: 2020 7370 6c69 745f 6f75 742c 0a20 2020    split_out,.   
+0003a7d0: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
+0003a7e0: 6574 7570 2c0a 2020 2020 2020 2020 7370  etup,.        sp
+0003a7f0: 6c69 745f 6f75 745f 7365 7475 705f 6b77  lit_out_setup_kw
+0003a800: 6172 6773 2c0a 2020 2020 290a 0a20 2020  args,.    )..   
+0003a810: 2023 2042 6c6f 636b 7769 7365 2043 6875   # Blockwise Chu
+0003a820: 6e6b 204c 6179 6572 0a20 2020 2063 6875  nk Layer.    chu
+0003a830: 6e6b 5f6e 616d 6520 3d20 6622 7b74 6f6b  nk_name = f"{tok
+0003a840: 656e 206f 7220 6675 6e63 6e61 6d65 2863  en or funcname(c
+0003a850: 6875 6e6b 297d 2d63 6875 6e6b 2d7b 746f  hunk)}-chunk-{to
+0003a860: 6b65 6e5f 6b65 797d 220a 2020 2020 6368  ken_key}".    ch
+0003a870: 756e 6b65 6420 3d20 6d61 705f 6261 675f  unked = map_bag_
+0003a880: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+0003a890: 2020 2020 6368 756e 6b2c 0a20 2020 2020      chunk,.     
+0003a8a0: 2020 2023 2043 6f6e 7665 7274 205f 4672     # Convert _Fr
+0003a8b0: 616d 6520 636f 6c6c 6563 7469 6f6e 7320  ame collections 
+0003a8c0: 746f 2042 6167 0a20 2020 2020 2020 202a  to Bag.        *
+0003a8d0: 5b0a 2020 2020 2020 2020 2020 2020 6172  [.            ar
+0003a8e0: 672e 746f 5f62 6167 2866 6f72 6d61 743d  g.to_bag(format=
+0003a8f0: 2266 7261 6d65 2229 2069 6620 6973 696e  "frame") if isin
+0003a900: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
+0003a910: 6d65 2920 656c 7365 2061 7267 0a20 2020  me) else arg.   
+0003a920: 2020 2020 2020 2020 2066 6f72 2061 7267           for arg
+0003a930: 2069 6e20 6172 6773 0a20 2020 2020 2020   in args.       
+0003a940: 205d 2c0a 2020 2020 2020 2020 746f 6b65   ],.        toke
+0003a950: 6e3d 6368 756e 6b5f 6e61 6d65 2c0a 2020  n=chunk_name,.  
+0003a960: 2020 2020 2020 2a2a 6368 756e 6b5f 6b77        **chunk_kw
+0003a970: 6172 6773 2c0a 2020 2020 290a 0a20 2020  args,.    )..   
+0003a980: 2023 204e 4f54 453a 2060 6368 756e 6b65   # NOTE: `chunke
+0003a990: 6460 2069 7320 6e6f 7720 6120 4261 6720  d` is now a Bag 
+0003a9a0: 636f 6c6c 6563 7469 6f6e 2e0a 2020 2020  collection..    
+0003a9b0: 2320 5765 2064 6f6e 2774 2075 7365 2061  # We don't use a
+0003a9c0: 2044 6174 6146 7261 6d65 2063 6f6c 6c65   DataFrame colle
+0003a9d0: 6374 696f 6e2c 2062 6563 6175 7365 0a20  ction, because. 
+0003a9e0: 2020 2023 2074 6865 2070 6172 7469 7469     # the partiti
+0003a9f0: 6f6e 7320 6d61 7920 6e6f 7420 636f 6e74  ons may not cont
+0003aa00: 6169 6e20 6461 7461 6672 616d 652d 6c69  ain dataframe-li
+0003aa10: 6b65 0a20 2020 2023 206f 626a 6563 7473  ke.    # objects
+0003aa20: 2061 6e79 6d6f 7265 2e0a 0a20 2020 2023   anymore...    #
+0003aa30: 2042 6c6f 636b 7769 7365 2053 706c 6974   Blockwise Split
+0003aa40: 204c 6179 6572 0a20 2020 2069 6620 7370   Layer.    if sp
+0003aa50: 6c69 745f 6f75 7420 616e 6420 7370 6c69  lit_out and spli
+0003aa60: 745f 6f75 7420 3e20 313a 0a20 2020 2020  t_out > 1:.     
+0003aa70: 2020 2063 6875 6e6b 6564 203d 2063 6875     chunked = chu
+0003aa80: 6e6b 6564 2e6d 6170 5f70 6172 7469 7469  nked.map_partiti
+0003aa90: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+0003aaa0: 2068 6173 685f 7368 6172 642c 0a20 2020   hash_shard,.   
+0003aab0: 2020 2020 2020 2020 2073 706c 6974 5f6f           split_o
+0003aac0: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
+0003aad0: 7370 6c69 745f 6f75 745f 7365 7475 702c  split_out_setup,
+0003aae0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+0003aaf0: 6974 5f6f 7574 5f73 6574 7570 5f6b 7761  it_out_setup_kwa
+0003ab00: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+0003ab10: 2069 676e 6f72 655f 696e 6465 782c 0a20   ignore_index,. 
+0003ab20: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
+0003ab30: 3d22 7370 6c69 742d 2573 2220 2520 746f  ="split-%s" % to
+0003ab40: 6b65 6e5f 6b65 792c 0a20 2020 2020 2020  ken_key,.       
+0003ab50: 2029 0a0a 2020 2020 2320 4861 6e64 6c65   )..    # Handle
+0003ab60: 2073 6f72 7420 6265 6861 7669 6f72 0a20   sort behavior. 
+0003ab70: 2020 2069 6620 736f 7274 2069 7320 6e6f     if sort is no
+0003ab80: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0003ab90: 6966 2073 6f72 7420 616e 6420 7370 6c69  if sort and spli
+0003aba0: 745f 6f75 7420 3e20 313a 0a20 2020 2020  t_out > 1:.     
+0003abb0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+0003abc0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+0003abd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003abe0: 2020 2243 616e 6e6f 7420 6775 6172 616e    "Cannot guaran
+0003abf0: 7465 6520 736f 7274 6564 206b 6579 7320  tee sorted keys 
+0003ac00: 666f 7220 6073 706c 6974 5f6f 7574 3e31  for `split_out>1
+0003ac10: 602e 220a 2020 2020 2020 2020 2020 2020  `.".            
+0003ac20: 2020 2020 2220 5472 7920 7573 696e 6720      " Try using 
+0003ac30: 7370 6c69 745f 6f75 743d 312c 206f 7220  split_out=1, or 
+0003ac40: 6772 6f75 7069 6e67 2077 6974 6820 736f  grouping with so
+0003ac50: 7274 3d46 616c 7365 2e22 0a20 2020 2020  rt=False.".     
+0003ac60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0003ac70: 2061 6767 7265 6761 7465 5f6b 7761 7267   aggregate_kwarg
+0003ac80: 7320 3d20 6167 6772 6567 6174 655f 6b77  s = aggregate_kw
+0003ac90: 6172 6773 206f 7220 7b7d 0a20 2020 2020  args or {}.     
+0003aca0: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
+0003acb0: 7267 735b 2273 6f72 7422 5d20 3d20 736f  rgs["sort"] = so
+0003acc0: 7274 0a0a 2020 2020 2320 5472 6565 2d52  rt..    # Tree-R
+0003acd0: 6564 7563 7469 6f6e 204c 6179 6572 0a20  eduction Layer. 
+0003ace0: 2020 2066 696e 616c 5f6e 616d 6520 3d20     final_name = 
+0003acf0: 6622 7b74 6f6b 656e 206f 7220 6675 6e63  f"{token or func
+0003ad00: 6e61 6d65 2861 6767 7265 6761 7465 297d  name(aggregate)}
+0003ad10: 2d61 6767 2d7b 746f 6b65 6e5f 6b65 797d  -agg-{token_key}
+0003ad20: 220a 2020 2020 6c61 7965 7220 3d20 4461  ".    layer = Da
+0003ad30: 7461 4672 616d 6554 7265 6552 6564 7563  taFrameTreeReduc
+0003ad40: 7469 6f6e 280a 2020 2020 2020 2020 6669  tion(.        fi
+0003ad50: 6e61 6c5f 6e61 6d65 2c0a 2020 2020 2020  nal_name,.      
+0003ad60: 2020 6368 756e 6b65 642e 6e61 6d65 2c0a    chunked.name,.
+0003ad70: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0003ad80: 6f6e 732c 0a20 2020 2020 2020 2070 6172  ons,.        par
+0003ad90: 7469 616c 285f 636f 6e63 6174 2c20 6967  tial(_concat, ig
+0003ada0: 6e6f 7265 5f69 6e64 6578 3d69 676e 6f72  nore_index=ignor
+0003adb0: 655f 696e 6465 7829 2c0a 2020 2020 2020  e_index),.      
+0003adc0: 2020 7061 7274 6961 6c28 636f 6d62 696e    partial(combin
+0003add0: 652c 202a 2a63 6f6d 6269 6e65 5f6b 7761  e, **combine_kwa
+0003ade0: 7267 7329 2069 6620 636f 6d62 696e 655f  rgs) if combine_
+0003adf0: 6b77 6172 6773 2065 6c73 6520 636f 6d62  kwargs else comb
+0003ae00: 696e 652c 0a20 2020 2020 2020 2066 696e  ine,.        fin
+0003ae10: 616c 697a 655f 6675 6e63 3d70 6172 7469  alize_func=parti
+0003ae20: 616c 2861 6767 7265 6761 7465 2c20 2a2a  al(aggregate, **
+0003ae30: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
+0003ae40: 290a 2020 2020 2020 2020 6966 2061 6767  ).        if agg
+0003ae50: 7265 6761 7465 5f6b 7761 7267 730a 2020  regate_kwargs.  
+0003ae60: 2020 2020 2020 656c 7365 2061 6767 7265        else aggre
+0003ae70: 6761 7465 2c0a 2020 2020 2020 2020 7370  gate,.        sp
+0003ae80: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+0003ae90: 6576 6572 792c 0a20 2020 2020 2020 2073  every,.        s
+0003aea0: 706c 6974 5f6f 7574 3d73 706c 6974 5f6f  plit_out=split_o
+0003aeb0: 7574 2069 6620 2873 706c 6974 5f6f 7574  ut if (split_out
+0003aec0: 2061 6e64 2073 706c 6974 5f6f 7574 203e   and split_out >
+0003aed0: 2031 2920 656c 7365 204e 6f6e 652c 0a20   1) else None,. 
+0003aee0: 2020 2020 2020 2074 7265 655f 6e6f 6465         tree_node
+0003aef0: 5f6e 616d 653d 6622 7b74 6f6b 656e 206f  _name=f"{token o
+0003af00: 7220 6675 6e63 6e61 6d65 2863 6f6d 6269  r funcname(combi
+0003af10: 6e65 297d 2d63 6f6d 6269 6e65 2d7b 746f  ne)}-combine-{to
+0003af20: 6b65 6e5f 6b65 797d 222c 0a20 2020 2029  ken_key}",.    )
+0003af30: 0a0a 2020 2020 6966 206d 6574 6120 6973  ..    if meta is
+0003af40: 206e 6f5f 6465 6661 756c 743a 0a20 2020   no_default:.   
+0003af50: 2020 2020 206d 6574 615f 6368 756e 6b20       meta_chunk 
+0003af60: 3d20 5f65 6d75 6c61 7465 2863 6875 6e6b  = _emulate(chunk
+0003af70: 2c20 2a61 7267 732c 2075 6466 3d54 7275  , *args, udf=Tru
+0003af80: 652c 202a 2a63 6875 6e6b 5f6b 7761 7267  e, **chunk_kwarg
+0003af90: 7329 0a20 2020 2020 2020 206d 6574 6120  s).        meta 
+0003afa0: 3d20 5f65 6d75 6c61 7465 280a 2020 2020  = _emulate(.    
+0003afb0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+0003afc0: 652c 205f 636f 6e63 6174 285b 6d65 7461  e, _concat([meta
+0003afd0: 5f63 6875 6e6b 5d2c 2069 676e 6f72 655f  _chunk], ignore_
+0003afe0: 696e 6465 7829 2c20 7564 663d 5472 7565  index), udf=True
+0003aff0: 2c20 2a2a 6167 6772 6567 6174 655f 6b77  , **aggregate_kw
+0003b000: 6172 6773 0a20 2020 2020 2020 2029 0a20  args.        ). 
+0003b010: 2020 206d 6574 6120 3d20 6d61 6b65 5f6d     meta = make_m
+0003b020: 6574 6128 0a20 2020 2020 2020 206d 6574  eta(.        met
+0003b030: 612c 0a20 2020 2020 2020 2069 6e64 6578  a,.        index
+0003b040: 3d28 6765 7461 7474 7228 6d61 6b65 5f6d  =(getattr(make_m
+0003b050: 6574 6128 6466 735b 305d 292c 2022 696e  eta(dfs[0]), "in
+0003b060: 6465 7822 2c20 4e6f 6e65 2920 6966 2064  dex", None) if d
+0003b070: 6673 2065 6c73 6520 4e6f 6e65 292c 0a20  fs else None),. 
+0003b080: 2020 2020 2020 2070 6172 656e 745f 6d65         parent_me
+0003b090: 7461 3d64 6673 5b30 5d2e 5f6d 6574 612c  ta=dfs[0]._meta,
+0003b0a0: 0a20 2020 2029 0a0a 2020 2020 6772 6170  .    )..    grap
+0003b0b0: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+0003b0c0: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+0003b0d0: 6f6e 7328 6669 6e61 6c5f 6e61 6d65 2c20  ons(final_name, 
+0003b0e0: 6c61 7965 722c 2064 6570 656e 6465 6e63  layer, dependenc
+0003b0f0: 6965 733d 2863 6875 6e6b 6564 2c29 290a  ies=(chunked,)).
+0003b100: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+0003b110: 5b4e 6f6e 655d 202a 2028 2873 706c 6974  [None] * ((split
+0003b120: 5f6f 7574 206f 7220 3129 202b 2031 290a  _out or 1) + 1).
+0003b130: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
+0003b140: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
+0003b150: 6669 6e61 6c5f 6e61 6d65 2c20 6d65 7461  final_name, meta
+0003b160: 2c20 6469 7669 7369 6f6e 732c 2070 6172  , divisions, par
+0003b170: 656e 745f 6d65 7461 3d64 6673 5b30 5d2e  ent_meta=dfs[0].
+0003b180: 5f6d 6574 6129 0a0a 0a61 6361 203d 2061  _meta)...aca = a
+0003b190: 7070 6c79 5f63 6f6e 6361 745f 6170 706c  pply_concat_appl
+0003b1a0: 790a 0a0a 6465 6620 5f65 7874 7261 6374  y...def _extract
+0003b1b0: 5f6d 6574 6128 782c 206e 6f6e 656d 7074  _meta(x, nonempt
+0003b1c0: 793d 4661 6c73 6529 3a0a 2020 2020 2222  y=False):.    ""
+0003b1d0: 220a 2020 2020 4578 7472 6163 7420 696e  ".    Extract in
+0003b1e0: 7465 726e 616c 2063 6163 6865 2064 6174  ternal cache dat
+0003b1f0: 6120 2860 605f 6d65 7461 6060 2920 6672  a (``_meta``) fr
+0003b200: 6f6d 2064 642e 4461 7461 4672 616d 6520  om dd.DataFrame 
+0003b210: 2f20 6464 2e53 6572 6965 730a 2020 2020  / dd.Series.    
+0003b220: 2222 220a 2020 2020 6966 2069 7369 6e73  """.    if isins
+0003b230: 7461 6e63 6528 782c 2028 5363 616c 6172  tance(x, (Scalar
+0003b240: 2c20 5f46 7261 6d65 2929 3a0a 2020 2020  , _Frame)):.    
+0003b250: 2020 2020 7265 7475 726e 2078 2e5f 6d65      return x._me
+0003b260: 7461 5f6e 6f6e 656d 7074 7920 6966 206e  ta_nonempty if n
+0003b270: 6f6e 656d 7074 7920 656c 7365 2078 2e5f  onempty else x._
+0003b280: 6d65 7461 0a20 2020 2065 6c69 6620 6973  meta.    elif is
+0003b290: 696e 7374 616e 6365 2878 2c20 6c69 7374  instance(x, list
+0003b2a0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0003b2b0: 6e20 5b5f 6578 7472 6163 745f 6d65 7461  n [_extract_meta
+0003b2c0: 285f 782c 206e 6f6e 656d 7074 7929 2066  (_x, nonempty) f
+0003b2d0: 6f72 205f 7820 696e 2078 5d0a 2020 2020  or _x in x].    
+0003b2e0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+0003b2f0: 782c 2074 7570 6c65 293a 0a20 2020 2020  x, tuple):.     
+0003b300: 2020 2072 6574 7572 6e20 7475 706c 6528     return tuple(
+0003b310: 5f65 7874 7261 6374 5f6d 6574 6128 5f78  _extract_meta(_x
+0003b320: 2c20 6e6f 6e65 6d70 7479 2920 666f 7220  , nonempty) for 
+0003b330: 5f78 2069 6e20 7829 0a20 2020 2065 6c69  _x in x).    eli
+0003b340: 6620 6973 696e 7374 616e 6365 2878 2c20  f isinstance(x, 
+0003b350: 6469 6374 293a 0a20 2020 2020 2020 2072  dict):.        r
+0003b360: 6573 203d 207b 7d0a 2020 2020 2020 2020  es = {}.        
+0003b370: 666f 7220 6b20 696e 2078 3a0a 2020 2020  for k in x:.    
+0003b380: 2020 2020 2020 2020 7265 735b 6b5d 203d          res[k] =
+0003b390: 205f 6578 7472 6163 745f 6d65 7461 2878   _extract_meta(x
+0003b3a0: 5b6b 5d2c 206e 6f6e 656d 7074 7929 0a20  [k], nonempty). 
+0003b3b0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+0003b3c0: 730a 2020 2020 656c 6966 2069 7369 6e73  s.    elif isins
+0003b3d0: 7461 6e63 6528 782c 2044 656c 6179 6564  tance(x, Delayed
+0003b3e0: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+0003b3f0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0003b400: 2020 2020 2020 2020 2022 4361 6e6e 6f74           "Cannot
+0003b410: 2069 6e66 6572 2064 6174 6166 7261 6d65   infer dataframe
+0003b420: 206d 6574 6164 6174 6120 7769 7468 2061   metadata with a
+0003b430: 2060 6461 736b 2e64 656c 6179 6564 6020   `dask.delayed` 
+0003b440: 6172 6775 6d65 6e74 220a 2020 2020 2020  argument".      
+0003b450: 2020 290a 2020 2020 656c 7365 3a0a 2020    ).    else:.  
+0003b460: 2020 2020 2020 7265 7475 726e 2078 0a0a        return x..
+0003b470: 0a64 6566 205f 656d 756c 6174 6528 6675  .def _emulate(fu
+0003b480: 6e63 2c20 2a61 7267 732c 2075 6466 3d46  nc, *args, udf=F
+0003b490: 616c 7365 2c20 2a2a 6b77 6172 6773 293a  alse, **kwargs):
+0003b4a0: 0a20 2020 2022 2222 0a20 2020 2041 7070  .    """.    App
+0003b4b0: 6c79 2061 2066 756e 6374 696f 6e20 7573  ly a function us
+0003b4c0: 696e 6720 6172 6773 202f 206b 7761 7267  ing args / kwarg
+0003b4d0: 732e 2049 6620 6172 6775 6d65 6e74 7320  s. If arguments 
+0003b4e0: 636f 6e74 6169 6e20 6464 2e44 6174 6146  contain dd.DataF
+0003b4f0: 7261 6d65 202f 0a20 2020 2064 642e 5365  rame /.    dd.Se
+0003b500: 7269 6573 2c20 7573 696e 6720 696e 7465  ries, using inte
+0003b510: 726e 616c 2063 6163 6865 2028 6060 5f6d  rnal cache (``_m
+0003b520: 6574 6160 6029 2066 6f72 2063 616c 6375  eta``) for calcu
+0003b530: 6c61 7469 6f6e 0a20 2020 2022 2222 0a20  lation.    """. 
+0003b540: 2020 2077 6974 6820 7261 6973 655f 6f6e     with raise_on
+0003b550: 5f6d 6574 615f 6572 726f 7228 6675 6e63  _meta_error(func
+0003b560: 6e61 6d65 2866 756e 6329 2c20 7564 663d  name(func), udf=
+0003b570: 7564 6629 2c20 6368 6563 6b5f 6e75 6d65  udf), check_nume
+0003b580: 7269 635f 6f6e 6c79 5f64 6570 7265 6361  ric_only_depreca
+0003b590: 7469 6f6e 2829 3a0a 2020 2020 2020 2020  tion():.        
+0003b5a0: 7265 7475 726e 2066 756e 6328 2a5f 6578  return func(*_ex
+0003b5b0: 7472 6163 745f 6d65 7461 2861 7267 732c  tract_meta(args,
+0003b5c0: 2054 7275 6529 2c20 2a2a 5f65 7874 7261   True), **_extra
+0003b5d0: 6374 5f6d 6574 6128 6b77 6172 6773 2c20  ct_meta(kwargs, 
+0003b5e0: 5472 7565 2929 0a0a 0a40 696e 7365 7274  True))...@insert
+0003b5f0: 5f6d 6574 615f 7061 7261 6d5f 6465 7363  _meta_param_desc
+0003b600: 7269 7074 696f 6e0a 6465 6620 6d61 705f  ription.def map_
+0003b610: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+0003b620: 6675 6e63 2c0a 2020 2020 2a61 7267 732c  func,.    *args,
+0003b630: 0a20 2020 206d 6574 613d 6e6f 5f64 6566  .    meta=no_def
+0003b640: 6175 6c74 2c0a 2020 2020 656e 666f 7263  ault,.    enforc
+0003b650: 655f 6d65 7461 6461 7461 3d54 7275 652c  e_metadata=True,
+0003b660: 0a20 2020 2074 7261 6e73 666f 726d 5f64  .    transform_d
+0003b670: 6976 6973 696f 6e73 3d54 7275 652c 0a20  ivisions=True,. 
+0003b680: 2020 2061 6c69 676e 5f64 6174 6166 7261     align_datafra
+0003b690: 6d65 733d 5472 7565 2c0a 2020 2020 2a2a  mes=True,.    **
+0003b6a0: 6b77 6172 6773 2c0a 293a 0a20 2020 2022  kwargs,.):.    "
+0003b6b0: 2222 4170 706c 7920 5079 7468 6f6e 2066  ""Apply Python f
+0003b6c0: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
+0003b6d0: 4461 7461 4672 616d 6520 7061 7274 6974  DataFrame partit
+0003b6e0: 696f 6e2e 0a0a 2020 2020 5061 7261 6d65  ion...    Parame
+0003b6f0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+0003b700: 2d2d 2d0a 2020 2020 6675 6e63 203a 2066  ---.    func : f
+0003b710: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
+0003b720: 4675 6e63 7469 6f6e 2061 7070 6c69 6564  Function applied
+0003b730: 2074 6f20 6561 6368 2070 6172 7469 7469   to each partiti
+0003b740: 6f6e 2e0a 2020 2020 6172 6773 2c20 6b77  on..    args, kw
+0003b750: 6172 6773 203a 0a20 2020 2020 2020 2041  args :.        A
+0003b760: 7267 756d 656e 7473 2061 6e64 206b 6579  rguments and key
+0003b770: 776f 7264 7320 746f 2070 6173 7320 746f  words to pass to
+0003b780: 2074 6865 2066 756e 6374 696f 6e2e 2020   the function.  
+0003b790: 4174 206c 6561 7374 206f 6e65 206f 6620  At least one of 
+0003b7a0: 7468 650a 2020 2020 2020 2020 6172 6773  the.        args
+0003b7b0: 2073 686f 756c 6420 6265 2061 2044 6173   should be a Das
+0003b7c0: 6b2e 6461 7461 6672 616d 652e 2041 7267  k.dataframe. Arg
+0003b7d0: 756d 656e 7473 2061 6e64 206b 6579 776f  uments and keywo
+0003b7e0: 7264 7320 6d61 7920 636f 6e74 6169 6e0a  rds may contain.
+0003b7f0: 2020 2020 2020 2020 6060 5363 616c 6172          ``Scalar
+0003b800: 6060 2c20 6060 4465 6c61 7965 6460 6020  ``, ``Delayed`` 
+0003b810: 6f72 2072 6567 756c 6172 2070 7974 686f  or regular pytho
+0003b820: 6e20 6f62 6a65 6374 732e 2044 6174 6146  n objects. DataF
+0003b830: 7261 6d65 2d6c 696b 6520 6172 6773 0a20  rame-like args. 
+0003b840: 2020 2020 2020 2028 626f 7468 2064 6173         (both das
+0003b850: 6b20 616e 6420 7061 6e64 6173 2920 7769  k and pandas) wi
+0003b860: 6c6c 2062 6520 7265 7061 7274 6974 696f  ll be repartitio
+0003b870: 6e65 6420 746f 2061 6c69 676e 2028 6966  ned to align (if
+0003b880: 206e 6563 6573 7361 7279 290a 2020 2020   necessary).    
+0003b890: 2020 2020 6265 666f 7265 2061 7070 6c79      before apply
+0003b8a0: 696e 6720 7468 6520 6675 6e63 7469 6f6e  ing the function
+0003b8b0: 2028 7365 6520 6060 616c 6967 6e5f 6461   (see ``align_da
+0003b8c0: 7461 6672 616d 6573 6060 2074 6f20 636f  taframes`` to co
+0003b8d0: 6e74 726f 6c29 2e0a 2020 2020 656e 666f  ntrol)..    enfo
+0003b8e0: 7263 655f 6d65 7461 6461 7461 203a 2062  rce_metadata : b
+0003b8f0: 6f6f 6c2c 2064 6566 6175 6c74 2054 7275  ool, default Tru
+0003b900: 650a 2020 2020 2020 2020 5768 6574 6865  e.        Whethe
+0003b910: 7220 746f 2065 6e66 6f72 6365 2061 7420  r to enforce at 
+0003b920: 7275 6e74 696d 6520 7468 6174 2074 6865  runtime that the
+0003b930: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
+0003b940: 6520 4461 7461 4672 616d 650a 2020 2020  e DataFrame.    
+0003b950: 2020 2020 7072 6f64 7563 6564 2062 7920      produced by 
+0003b960: 6060 6675 6e63 6060 2061 6374 7561 6c6c  ``func`` actuall
+0003b970: 7920 6d61 7463 6865 7320 7468 6520 7374  y matches the st
+0003b980: 7275 6374 7572 6520 6f66 2060 606d 6574  ructure of ``met
+0003b990: 6160 602e 0a20 2020 2020 2020 2054 6869  a``..        Thi
+0003b9a0: 7320 7769 6c6c 2072 656e 616d 6520 616e  s will rename an
+0003b9b0: 6420 7265 6f72 6465 7220 636f 6c75 6d6e  d reorder column
+0003b9c0: 7320 666f 7220 6561 6368 2070 6172 7469  s for each parti
+0003b9d0: 7469 6f6e 2c0a 2020 2020 2020 2020 616e  tion,.        an
+0003b9e0: 6420 7769 6c6c 2072 6169 7365 2061 6e20  d will raise an 
+0003b9f0: 6572 726f 7220 6966 2074 6869 7320 646f  error if this do
+0003ba00: 6573 6e27 7420 776f 726b 2c0a 2020 2020  esn't work,.    
+0003ba10: 2020 2020 6275 7420 6974 2077 6f6e 2774      but it won't
+0003ba20: 2072 6169 7365 2069 6620 6474 7970 6573   raise if dtypes
+0003ba30: 2064 6f6e 2774 206d 6174 6368 2e0a 2020   don't match..  
+0003ba40: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
+0003ba50: 7369 6f6e 7320 3a20 626f 6f6c 2c20 6465  sions : bool, de
+0003ba60: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
+0003ba70: 2020 2057 6865 7468 6572 2074 6f20 6170     Whether to ap
+0003ba80: 706c 7920 7468 6520 6675 6e63 7469 6f6e  ply the function
+0003ba90: 206f 6e74 6f20 7468 6520 6469 7669 7369   onto the divisi
+0003baa0: 6f6e 7320 616e 6420 6170 706c 7920 7468  ons and apply th
+0003bab0: 6f73 650a 2020 2020 2020 2020 7472 616e  ose.        tran
+0003bac0: 7366 6f72 6d65 6420 6469 7669 7369 6f6e  sformed division
+0003bad0: 7320 746f 2074 6865 206f 7574 7075 742e  s to the output.
+0003bae0: 0a20 2020 2061 6c69 676e 5f64 6174 6166  .    align_dataf
+0003baf0: 7261 6d65 7320 3a20 626f 6f6c 2c20 6465  rames : bool, de
+0003bb00: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
+0003bb10: 2020 2057 6865 7468 6572 2074 6f20 7265     Whether to re
+0003bb20: 7061 7274 6974 696f 6e20 4461 7461 4672  partition DataFr
+0003bb30: 616d 652d 206f 7220 5365 7269 6573 2d6c  ame- or Series-l
+0003bb40: 696b 6520 6172 6773 0a20 2020 2020 2020  ike args.       
+0003bb50: 2028 626f 7468 2064 6173 6b20 616e 6420   (both dask and 
+0003bb60: 7061 6e64 6173 2920 736f 2074 6865 6972  pandas) so their
+0003bb70: 2064 6976 6973 696f 6e73 2061 6c69 676e   divisions align
+0003bb80: 2062 6566 6f72 6520 6170 706c 7969 6e67   before applying
+0003bb90: 0a20 2020 2020 2020 2074 6865 2066 756e  .        the fun
+0003bba0: 6374 696f 6e2e 2054 6869 7320 7265 7175  ction. This requ
+0003bbb0: 6972 6573 2061 6c6c 2069 6e70 7574 7320  ires all inputs 
+0003bbc0: 746f 2068 6176 6520 6b6e 6f77 6e20 6469  to have known di
+0003bbd0: 7669 7369 6f6e 732e 0a20 2020 2020 2020  visions..       
+0003bbe0: 2053 696e 676c 652d 7061 7274 6974 696f   Single-partitio
+0003bbf0: 6e20 696e 7075 7473 2077 696c 6c20 6265  n inputs will be
+0003bc00: 2073 706c 6974 2069 6e74 6f20 6d75 6c74   split into mult
+0003bc10: 6970 6c65 2070 6172 7469 7469 6f6e 732e  iple partitions.
+0003bc20: 0a0a 2020 2020 2020 2020 4966 2046 616c  ..        If Fal
+0003bc30: 7365 2c20 616c 6c20 696e 7075 7473 206d  se, all inputs m
+0003bc40: 7573 7420 6861 7665 2065 6974 6865 7220  ust have either 
+0003bc50: 7468 6520 7361 6d65 206e 756d 6265 7220  the same number 
+0003bc60: 6f66 2070 6172 7469 7469 6f6e 730a 2020  of partitions.  
+0003bc70: 2020 2020 2020 6f72 2061 2073 696e 676c        or a singl
+0003bc80: 6520 7061 7274 6974 696f 6e2e 2053 696e  e partition. Sin
+0003bc90: 676c 652d 7061 7274 6974 696f 6e20 696e  gle-partition in
+0003bca0: 7075 7473 2077 696c 6c20 6265 2062 726f  puts will be bro
+0003bcb0: 6164 6361 7374 2074 6f0a 2020 2020 2020  adcast to.      
+0003bcc0: 2020 6576 6572 7920 7061 7274 6974 696f    every partitio
+0003bcd0: 6e20 6f66 206d 756c 7469 2d70 6172 7469  n of multi-parti
+0003bce0: 7469 6f6e 2069 6e70 7574 732e 0a20 2020  tion inputs..   
+0003bcf0: 2024 4d45 5441 0a20 2020 2022 2222 0a20   $META.    """. 
+0003bd00: 2020 206e 616d 6520 3d20 6b77 6172 6773     name = kwargs
+0003bd10: 2e70 6f70 2822 746f 6b65 6e22 2c20 4e6f  .pop("token", No
+0003bd20: 6e65 290a 2020 2020 7061 7265 6e74 5f6d  ne).    parent_m
+0003bd30: 6574 6120 3d20 6b77 6172 6773 2e70 6f70  eta = kwargs.pop
+0003bd40: 2822 7061 7265 6e74 5f6d 6574 6122 2c20  ("parent_meta", 
+0003bd50: 4e6f 6e65 290a 0a20 2020 2061 7373 6572  None)..    asser
+0003bd60: 7420 6361 6c6c 6162 6c65 2866 756e 6329  t callable(func)
+0003bd70: 0a20 2020 2069 6620 6e61 6d65 2069 7320  .    if name is 
+0003bd80: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0003bd90: 2020 746f 6b65 6e20 3d20 746f 6b65 6e69    token = tokeni
+0003bda0: 7a65 286d 6574 612c 202a 6172 6773 2c20  ze(meta, *args, 
+0003bdb0: 2a2a 6b77 6172 6773 290a 2020 2020 656c  **kwargs).    el
+0003bdc0: 7365 3a0a 2020 2020 2020 2020 6e61 6d65  se:.        name
+0003bdd0: 203d 2066 756e 636e 616d 6528 6675 6e63   = funcname(func
+0003bde0: 290a 2020 2020 2020 2020 746f 6b65 6e20  ).        token 
+0003bdf0: 3d20 746f 6b65 6e69 7a65 2866 756e 632c  = tokenize(func,
+0003be00: 206d 6574 612c 202a 6172 6773 2c20 2a2a   meta, *args, **
+0003be10: 6b77 6172 6773 290a 2020 2020 6e61 6d65  kwargs).    name
+0003be20: 203d 2066 227b 6e61 6d65 7d2d 7b74 6f6b   = f"{name}-{tok
+0003be30: 656e 7d22 0a0a 2020 2020 6672 6f6d 2064  en}"..    from d
+0003be40: 6173 6b2e 6461 7461 6672 616d 652e 6d75  ask.dataframe.mu
+0003be50: 6c74 6920 696d 706f 7274 205f 6d61 7962  lti import _mayb
+0003be60: 655f 616c 6967 6e5f 7061 7274 6974 696f  e_align_partitio
+0003be70: 6e73 0a0a 2020 2020 6966 2061 6c69 676e  ns..    if align
+0003be80: 5f64 6174 6166 7261 6d65 733a 0a20 2020  _dataframes:.   
+0003be90: 2020 2020 2061 7267 7320 3d20 5f6d 6179       args = _may
+0003bea0: 6265 5f66 726f 6d5f 7061 6e64 6173 2861  be_from_pandas(a
+0003beb0: 7267 7329 0a20 2020 2020 2020 2074 7279  rgs).        try
+0003bec0: 3a0a 2020 2020 2020 2020 2020 2020 6172  :.            ar
+0003bed0: 6773 203d 205f 6d61 7962 655f 616c 6967  gs = _maybe_alig
+0003bee0: 6e5f 7061 7274 6974 696f 6e73 2861 7267  n_partitions(arg
+0003bef0: 7329 0a20 2020 2020 2020 2065 7863 6570  s).        excep
+0003bf00: 7420 5661 6c75 6545 7272 6f72 2061 7320  t ValueError as 
+0003bf10: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0003bf20: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0003bf30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003bf40: 2066 227b 657d 2e20 4966 2079 6f75 2064   f"{e}. If you d
+0003bf50: 6f6e 2774 2077 616e 7420 7468 6520 7061  on't want the pa
+0003bf60: 7274 6974 696f 6e73 2074 6f20 6265 2061  rtitions to be a
+0003bf70: 6c69 676e 6564 2c20 616e 6420 6172 6520  ligned, and are 
+0003bf80: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0003bf90: 2020 2263 616c 6c69 6e67 2060 6d61 705f    "calling `map_
+0003bfa0: 7061 7274 6974 696f 6e73 6020 6469 7265  partitions` dire
+0003bfb0: 6374 6c79 2c20 7061 7373 2060 616c 6967  ctly, pass `alig
+0003bfc0: 6e5f 6461 7461 6672 616d 6573 3d46 616c  n_dataframes=Fal
+0003bfd0: 7365 602e 220a 2020 2020 2020 2020 2020  se`.".          
+0003bfe0: 2020 2920 6672 6f6d 2065 0a0a 2020 2020    ) from e..    
+0003bff0: 6466 7320 3d20 5b64 6620 666f 7220 6466  dfs = [df for df
+0003c000: 2069 6e20 6172 6773 2069 6620 6973 696e   in args if isin
+0003c010: 7374 616e 6365 2864 662c 205f 4672 616d  stance(df, _Fram
+0003c020: 6529 5d0a 0a20 2020 206d 6574 6120 3d20  e)]..    meta = 
+0003c030: 5f67 6574 5f6d 6574 615f 6d61 705f 7061  _get_meta_map_pa
+0003c040: 7274 6974 696f 6e73 2861 7267 732c 2064  rtitions(args, d
+0003c050: 6673 2c20 6675 6e63 2c20 6b77 6172 6773  fs, func, kwargs
+0003c060: 2c20 6d65 7461 2c20 7061 7265 6e74 5f6d  , meta, parent_m
+0003c070: 6574 6129 0a20 2020 2069 6620 616c 6c28  eta).    if all(
+0003c080: 6973 696e 7374 616e 6365 2861 7267 2c20  isinstance(arg, 
+0003c090: 5363 616c 6172 2920 666f 7220 6172 6720  Scalar) for arg 
+0003c0a0: 696e 2061 7267 7329 3a0a 2020 2020 2020  in args):.      
+0003c0b0: 2020 6c61 7965 7220 3d20 7b0a 2020 2020    layer = {.    
+0003c0c0: 2020 2020 2020 2020 286e 616d 652c 2030          (name, 0
+0003c0d0: 293a 2028 0a20 2020 2020 2020 2020 2020  ): (.           
+0003c0e0: 2020 2020 2061 7070 6c79 2c0a 2020 2020       apply,.    
+0003c0f0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+0003c100: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003c110: 2020 2874 7570 6c65 2c20 5b28 6172 672e    (tuple, [(arg.
+0003c120: 5f6e 616d 652c 2030 2920 666f 7220 6172  _name, 0) for ar
+0003c130: 6720 696e 2061 7267 735d 292c 0a20 2020  g in args]),.   
+0003c140: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
+0003c150: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+0003c160: 2029 0a20 2020 2020 2020 207d 0a20 2020   ).        }.   
+0003c170: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+0003c180: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+0003c190: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+0003c1a0: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
+0003c1b0: 656e 6369 6573 3d61 7267 7329 0a20 2020  encies=args).   
+0003c1c0: 2020 2020 2072 6574 7572 6e20 5363 616c       return Scal
+0003c1d0: 6172 2867 7261 7068 2c20 6e61 6d65 2c20  ar(graph, name, 
+0003c1e0: 6d65 7461 290a 0a20 2020 2061 7267 7332  meta)..    args2
+0003c1f0: 203d 205b 5d0a 2020 2020 6465 7065 6e64   = [].    depend
+0003c200: 656e 6369 6573 203d 205b 5d0a 2020 2020  encies = [].    
+0003c210: 666f 7220 6172 6720 696e 2061 7267 733a  for arg in args:
+0003c220: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0003c230: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
+0003c240: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
+0003c250: 2061 7267 7332 2e61 7070 656e 6428 6172   args2.append(ar
+0003c260: 6729 0a20 2020 2020 2020 2020 2020 2064  g).            d
+0003c270: 6570 656e 6465 6e63 6965 732e 6170 7065  ependencies.appe
+0003c280: 6e64 2861 7267 290a 2020 2020 2020 2020  nd(arg).        
+0003c290: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
+0003c2a0: 2020 2020 2061 7267 203d 206e 6f72 6d61       arg = norma
+0003c2b0: 6c69 7a65 5f61 7267 2861 7267 290a 2020  lize_arg(arg).  
+0003c2c0: 2020 2020 2020 6172 6732 2c20 636f 6c6c        arg2, coll
+0003c2d0: 6563 7469 6f6e 7320 3d20 756e 7061 636b  ections = unpack
+0003c2e0: 5f63 6f6c 6c65 6374 696f 6e73 2861 7267  _collections(arg
+0003c2f0: 290a 2020 2020 2020 2020 6966 2063 6f6c  ).        if col
+0003c300: 6c65 6374 696f 6e73 3a0a 2020 2020 2020  lections:.      
+0003c310: 2020 2020 2020 6172 6773 322e 6170 7065        args2.appe
+0003c320: 6e64 2861 7267 3229 0a20 2020 2020 2020  nd(arg2).       
+0003c330: 2020 2020 2064 6570 656e 6465 6e63 6965       dependencie
+0003c340: 732e 6578 7465 6e64 2863 6f6c 6c65 6374  s.extend(collect
+0003c350: 696f 6e73 290a 2020 2020 2020 2020 656c  ions).        el
+0003c360: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003c370: 6172 6773 322e 6170 7065 6e64 2861 7267  args2.append(arg
+0003c380: 290a 0a20 2020 206b 7761 7267 7333 203d  )..    kwargs3 =
+0003c390: 207b 7d0a 2020 2020 7369 6d70 6c65 203d   {}.    simple =
+0003c3a0: 2054 7275 650a 2020 2020 666f 7220 6b2c   True.    for k,
+0003c3b0: 2076 2069 6e20 6b77 6172 6773 2e69 7465   v in kwargs.ite
+0003c3c0: 6d73 2829 3a0a 2020 2020 2020 2020 7620  ms():.        v 
+0003c3d0: 3d20 6e6f 726d 616c 697a 655f 6172 6728  = normalize_arg(
+0003c3e0: 7629 0a20 2020 2020 2020 2076 2c20 636f  v).        v, co
+0003c3f0: 6c6c 6563 7469 6f6e 7320 3d20 756e 7061  llections = unpa
+0003c400: 636b 5f63 6f6c 6c65 6374 696f 6e73 2876  ck_collections(v
+0003c410: 290a 2020 2020 2020 2020 6465 7065 6e64  ).        depend
+0003c420: 656e 6369 6573 2e65 7874 656e 6428 636f  encies.extend(co
+0003c430: 6c6c 6563 7469 6f6e 7329 0a20 2020 2020  llections).     
+0003c440: 2020 206b 7761 7267 7333 5b6b 5d20 3d20     kwargs3[k] = 
+0003c450: 760a 2020 2020 2020 2020 6966 2063 6f6c  v.        if col
+0003c460: 6c65 6374 696f 6e73 3a0a 2020 2020 2020  lections:.      
+0003c470: 2020 2020 2020 7369 6d70 6c65 203d 2046        simple = F
+0003c480: 616c 7365 0a0a 2020 2020 6469 7669 7369  alse..    divisi
+0003c490: 6f6e 7320 3d20 5f67 6574 5f64 6976 6973  ons = _get_divis
+0003c4a0: 696f 6e73 5f6d 6170 5f70 6172 7469 7469  ions_map_partiti
+0003c4b0: 6f6e 7328 0a20 2020 2020 2020 2061 6c69  ons(.        ali
+0003c4c0: 676e 5f64 6174 6166 7261 6d65 732c 2074  gn_dataframes, t
+0003c4d0: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
+0003c4e0: 6e73 2c20 6466 732c 2066 756e 632c 2061  ns, dfs, func, a
+0003c4f0: 7267 732c 206b 7761 7267 730a 2020 2020  rgs, kwargs.    
+0003c500: 290a 0a20 2020 2069 6620 6861 735f 6b65  )..    if has_ke
+0003c510: 7977 6f72 6428 6675 6e63 2c20 2270 6172  yword(func, "par
+0003c520: 7469 7469 6f6e 5f69 6e66 6f22 293a 0a20  tition_info"):. 
+0003c530: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+0003c540: 5f69 6e66 6f20 3d20 7b0a 2020 2020 2020  _info = {.      
+0003c550: 2020 2020 2020 2869 2c29 3a20 7b22 6e75        (i,): {"nu
+0003c560: 6d62 6572 223a 2069 2c20 2264 6976 6973  mber": i, "divis
+0003c570: 696f 6e22 3a20 6469 7669 7369 6f6e 7d0a  ion": division}.
+0003c580: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0003c590: 692c 2064 6976 6973 696f 6e20 696e 2065  i, division in e
+0003c5a0: 6e75 6d65 7261 7465 2864 6976 6973 696f  numerate(divisio
+0003c5b0: 6e73 5b3a 2d31 5d29 0a20 2020 2020 2020  ns[:-1]).       
+0003c5c0: 207d 0a0a 2020 2020 2020 2020 6172 6773   }..        args
+0003c5d0: 322e 696e 7365 7274 2830 2c20 426c 6f63  2.insert(0, Bloc
+0003c5e0: 6b77 6973 6544 6570 4469 6374 2870 6172  kwiseDepDict(par
+0003c5f0: 7469 7469 6f6e 5f69 6e66 6f29 290a 2020  tition_info)).  
+0003c600: 2020 2020 2020 6f72 6967 5f66 756e 6320        orig_func 
+0003c610: 3d20 6675 6e63 0a0a 2020 2020 2020 2020  = func..        
+0003c620: 6465 6620 6675 6e63 2870 6172 7469 7469  def func(partiti
+0003c630: 6f6e 5f69 6e66 6f2c 202a 6172 6773 2c20  on_info, *args, 
+0003c640: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+0003c650: 2020 2020 2020 2072 6574 7572 6e20 6f72         return or
+0003c660: 6967 5f66 756e 6328 2a61 7267 732c 202a  ig_func(*args, *
+0003c670: 2a6b 7761 7267 732c 2070 6172 7469 7469  *kwargs, partiti
+0003c680: 6f6e 5f69 6e66 6f3d 7061 7274 6974 696f  on_info=partitio
+0003c690: 6e5f 696e 666f 290a 0a20 2020 2069 6620  n_info)..    if 
+0003c6a0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+0003c6b0: 3a0a 2020 2020 2020 2020 6473 6b20 3d20  :.        dsk = 
+0003c6c0: 7061 7274 6974 696f 6e77 6973 655f 6772  partitionwise_gr
+0003c6d0: 6170 6828 0a20 2020 2020 2020 2020 2020  aph(.           
+0003c6e0: 2061 7070 6c79 5f61 6e64 5f65 6e66 6f72   apply_and_enfor
+0003c6f0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
+0003c700: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+0003c710: 2020 2a61 7267 7332 2c0a 2020 2020 2020    *args2,.      
+0003c720: 2020 2020 2020 6465 7065 6e64 656e 6369        dependenci
+0003c730: 6573 3d64 6570 656e 6465 6e63 6965 732c  es=dependencies,
+0003c740: 0a20 2020 2020 2020 2020 2020 205f 6675  .            _fu
+0003c750: 6e63 3d66 756e 632c 0a20 2020 2020 2020  nc=func,.       
+0003c760: 2020 2020 205f 6d65 7461 3d6d 6574 612c       _meta=meta,
+0003c770: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
+0003c780: 7761 7267 7333 2c0a 2020 2020 2020 2020  wargs3,.        
+0003c790: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+0003c7a0: 2020 2020 6b77 6172 6773 3420 3d20 6b77      kwargs4 = kw
+0003c7b0: 6172 6773 2069 6620 7369 6d70 6c65 2065  args if simple e
+0003c7c0: 6c73 6520 6b77 6172 6773 330a 2020 2020  lse kwargs3.    
+0003c7d0: 2020 2020 6473 6b20 3d20 7061 7274 6974      dsk = partit
+0003c7e0: 696f 6e77 6973 655f 6772 6170 6828 0a20  ionwise_graph(. 
+0003c7f0: 2020 2020 2020 2020 2020 2066 756e 632c             func,
+0003c800: 206e 616d 652c 202a 6172 6773 322c 202a   name, *args2, *
+0003c810: 2a6b 7761 7267 7334 2c20 6465 7065 6e64  *kwargs4, depend
+0003c820: 656e 6369 6573 3d64 6570 656e 6465 6e63  encies=dependenc
+0003c830: 6965 730a 2020 2020 2020 2020 290a 0a20  ies.        ).. 
+0003c840: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+0003c850: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+0003c860: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
+0003c870: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+0003c880: 6573 3d64 6570 656e 6465 6e63 6965 7329  es=dependencies)
+0003c890: 0a20 2020 2072 6574 7572 6e20 6e65 775f  .    return new_
+0003c8a0: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
+0003c8b0: 206e 616d 652c 206d 6574 612c 2064 6976   name, meta, div
+0003c8c0: 6973 696f 6e73 290a 0a0a 6465 6620 5f67  isions)...def _g
+0003c8d0: 6574 5f64 6976 6973 696f 6e73 5f6d 6170  et_divisions_map
+0003c8e0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+0003c8f0: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
+0003c900: 732c 2074 7261 6e73 666f 726d 5f64 6976  s, transform_div
+0003c910: 6973 696f 6e73 2c20 6466 732c 2066 756e  isions, dfs, fun
+0003c920: 632c 2061 7267 732c 206b 7761 7267 730a  c, args, kwargs.
+0003c930: 293a 0a20 2020 2022 2222 0a20 2020 2048  ):.    """.    H
+0003c940: 656c 7065 7220 746f 2067 6574 2064 6976  elper to get div
+0003c950: 6973 696f 6e73 2066 6f72 206d 6170 5f70  isions for map_p
+0003c960: 6172 7469 7469 6f6e 7320 616e 6420 6d61  artitions and ma
+0003c970: 705f 6f76 6572 6c61 7020 6f75 7470 7574  p_overlap output
+0003c980: 2e0a 2020 2020 2222 220a 2020 2020 6966  ..    """.    if
+0003c990: 2061 6c69 676e 5f64 6174 6166 7261 6d65   align_dataframe
+0003c9a0: 733a 0a20 2020 2020 2020 2064 6976 6973  s:.        divis
+0003c9b0: 696f 6e73 203d 2064 6673 5b30 5d2e 6469  ions = dfs[0].di
+0003c9c0: 7669 7369 6f6e 730a 2020 2020 656c 7365  visions.    else
+0003c9d0: 3a0a 2020 2020 2020 2020 2320 556e 616c  :.        # Unal
+0003c9e0: 6967 6e65 642c 2064 6673 2069 7320 6120  igned, dfs is a 
+0003c9f0: 6d69 7820 6f66 2031 2070 6172 7469 7469  mix of 1 partiti
+0003ca00: 6f6e 2061 6e64 2031 2b20 7061 7274 6974  on and 1+ partit
+0003ca10: 696f 6e20 6461 7461 6672 616d 6573 2c0a  ion dataframes,.
+0003ca20: 2020 2020 2020 2020 2320 7573 6520 6c6f          # use lo
+0003ca30: 6e67 6573 7420 6469 7669 7369 6f6e 7320  ngest divisions 
+0003ca40: 666f 756e 640a 2020 2020 2020 2020 6469  found.        di
+0003ca50: 7669 7369 6f6e 7320 3d20 6d61 7828 2864  visions = max((d
+0003ca60: 2e64 6976 6973 696f 6e73 2066 6f72 2064  .divisions for d
+0003ca70: 2069 6e20 6466 7329 2c20 6b65 793d 6c65   in dfs), key=le
+0003ca80: 6e29 0a20 2020 2069 6620 7472 616e 7366  n).    if transf
+0003ca90: 6f72 6d5f 6469 7669 7369 6f6e 7320 616e  orm_divisions an
+0003caa0: 6420 6973 696e 7374 616e 6365 2864 6673  d isinstance(dfs
+0003cab0: 5b30 5d2c 2049 6e64 6578 2920 616e 6420  [0], Index) and 
+0003cac0: 6c65 6e28 6466 7329 203d 3d20 313a 0a20  len(dfs) == 1:. 
+0003cad0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0003cae0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+0003caf0: 7320 3d20 6675 6e63 280a 2020 2020 2020  s = func(.      
+0003cb00: 2020 2020 2020 2020 2020 2a5b 7064 2e49            *[pd.I
+0003cb10: 6e64 6578 2861 2e64 6976 6973 696f 6e73  ndex(a.divisions
+0003cb20: 2920 6966 2061 2069 7320 6466 735b 305d  ) if a is dfs[0]
+0003cb30: 2065 6c73 6520 6120 666f 7220 6120 696e   else a for a in
+0003cb40: 2061 7267 735d 2c20 2a2a 6b77 6172 6773   args], **kwargs
+0003cb50: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0003cb60: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+0003cb70: 696e 7374 616e 6365 2864 6976 6973 696f  instance(divisio
+0003cb80: 6e73 2c20 7064 2e49 6e64 6578 293a 0a20  ns, pd.Index):. 
+0003cb90: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0003cba0: 6976 6973 696f 6e73 203d 206d 6574 686f  ivisions = metho
+0003cbb0: 6473 2e74 6f6c 6973 7428 6469 7669 7369  ds.tolist(divisi
+0003cbc0: 6f6e 7329 0a20 2020 2020 2020 2065 7863  ons).        exc
+0003cbd0: 6570 7420 4578 6365 7074 696f 6e3a 0a20  ept Exception:. 
+0003cbe0: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+0003cbf0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0003cc00: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0003cc10: 2076 616c 6964 5f64 6976 6973 696f 6e73   valid_divisions
+0003cc20: 2864 6976 6973 696f 6e73 293a 0a20 2020  (divisions):.   
+0003cc30: 2020 2020 2020 2020 2020 2020 2064 6976               div
+0003cc40: 6973 696f 6e73 203d 205b 4e6f 6e65 5d20  isions = [None] 
+0003cc50: 2a20 2864 6673 5b30 5d2e 6e70 6172 7469  * (dfs[0].nparti
+0003cc60: 7469 6f6e 7320 2b20 3129 0a20 2020 2072  tions + 1).    r
+0003cc70: 6574 7572 6e20 6469 7669 7369 6f6e 730a  eturn divisions.
+0003cc80: 0a0a 6465 6620 5f67 6574 5f6d 6574 615f  ..def _get_meta_
+0003cc90: 6d61 705f 7061 7274 6974 696f 6e73 2861  map_partitions(a
+0003cca0: 7267 732c 2064 6673 2c20 6675 6e63 2c20  rgs, dfs, func, 
+0003ccb0: 6b77 6172 6773 2c20 6d65 7461 2c20 7061  kwargs, meta, pa
+0003ccc0: 7265 6e74 5f6d 6574 6129 3a0a 2020 2020  rent_meta):.    
+0003ccd0: 2222 220a 2020 2020 4865 6c70 6572 2074  """.    Helper t
+0003cce0: 6f20 6765 6e65 7261 7465 206d 6574 6164  o generate metad
+0003ccf0: 6174 6120 666f 7220 6d61 705f 7061 7274  ata for map_part
+0003cd00: 6974 696f 6e73 2061 6e64 206d 6170 5f6f  itions and map_o
+0003cd10: 7665 726c 6170 206f 7574 7075 742e 0a20  verlap output.. 
+0003cd20: 2020 2022 2222 0a20 2020 206d 6574 615f     """.    meta_
+0003cd30: 696e 6465 7820 3d20 6765 7461 7474 7228  index = getattr(
+0003cd40: 6d61 6b65 5f6d 6574 6128 6466 735b 305d  make_meta(dfs[0]
+0003cd50: 292c 2022 696e 6465 7822 2c20 4e6f 6e65  ), "index", None
+0003cd60: 2920 6966 2064 6673 2065 6c73 6520 4e6f  ) if dfs else No
+0003cd70: 6e65 0a20 2020 2069 6620 7061 7265 6e74  ne.    if parent
+0003cd80: 5f6d 6574 6120 6973 204e 6f6e 6520 616e  _meta is None an
+0003cd90: 6420 6466 733a 0a20 2020 2020 2020 2070  d dfs:.        p
+0003cda0: 6172 656e 745f 6d65 7461 203d 2064 6673  arent_meta = dfs
+0003cdb0: 5b30 5d2e 5f6d 6574 610a 2020 2020 6966  [0]._meta.    if
+0003cdc0: 206d 6574 6120 6973 206e 6f5f 6465 6661   meta is no_defa
+0003cdd0: 756c 743a 0a20 2020 2020 2020 2023 2055  ult:.        # U
+0003cde0: 7365 206e 6f6e 2d6e 6f72 6d61 6c69 7a65  se non-normalize
+0003cdf0: 6420 6b77 6172 6773 2068 6572 652c 2061  d kwargs here, a
+0003ce00: 7320 7765 2077 616e 7420 7468 6520 7265  s we want the re
+0003ce10: 616c 2076 616c 7565 7320 286e 6f74 0a20  al values (not. 
+0003ce20: 2020 2020 2020 2023 2064 656c 6179 6564         # delayed
+0003ce30: 2076 616c 7565 7329 0a20 2020 2020 2020   values).       
+0003ce40: 206d 6574 6120 3d20 5f65 6d75 6c61 7465   meta = _emulate
+0003ce50: 2866 756e 632c 202a 6172 6773 2c20 7564  (func, *args, ud
+0003ce60: 663d 5472 7565 2c20 2a2a 6b77 6172 6773  f=True, **kwargs
+0003ce70: 290a 2020 2020 2020 2020 6d65 7461 5f69  ).        meta_i
+0003ce80: 735f 656d 756c 6174 6564 203d 2054 7275  s_emulated = Tru
+0003ce90: 650a 2020 2020 656c 7365 3a0a 2020 2020  e.    else:.    
+0003cea0: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
+0003ceb0: 6d65 7461 286d 6574 612c 2069 6e64 6578  meta(meta, index
+0003cec0: 3d6d 6574 615f 696e 6465 782c 2070 6172  =meta_index, par
+0003ced0: 656e 745f 6d65 7461 3d70 6172 656e 745f  ent_meta=parent_
+0003cee0: 6d65 7461 290a 2020 2020 2020 2020 6d65  meta).        me
+0003cef0: 7461 5f69 735f 656d 756c 6174 6564 203d  ta_is_emulated =
+0003cf00: 2046 616c 7365 0a0a 2020 2020 6966 206e   False..    if n
+0003cf10: 6f74 2028 6861 735f 7061 7261 6c6c 656c  ot (has_parallel
+0003cf20: 5f74 7970 6528 6d65 7461 2920 6f72 2069  _type(meta) or i
+0003cf30: 735f 6172 7261 796c 696b 6528 6d65 7461  s_arraylike(meta
+0003cf40: 2920 616e 6420 6d65 7461 2e73 6861 7065  ) and meta.shape
+0003cf50: 2920 616e 6420 6e6f 7420 616c 6c28 0a20  ) and not all(. 
+0003cf60: 2020 2020 2020 2069 7369 6e73 7461 6e63         isinstanc
+0003cf70: 6528 6172 672c 2053 6361 6c61 7229 2066  e(arg, Scalar) f
+0003cf80: 6f72 2061 7267 2069 6e20 6172 6773 0a20  or arg in args. 
+0003cf90: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
+0003cfa0: 206e 6f74 206d 6574 615f 6973 5f65 6d75   not meta_is_emu
+0003cfb0: 6c61 7465 643a 0a20 2020 2020 2020 2020  lated:.         
+0003cfc0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+0003cfd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003cfe0: 2020 224d 6574 6120 6973 206e 6f74 2076    "Meta is not v
+0003cff0: 616c 6964 2c20 606d 6170 5f70 6172 7469  alid, `map_parti
+0003d000: 7469 6f6e 7360 2061 6e64 2060 6d61 705f  tions` and `map_
+0003d010: 6f76 6572 6c61 7060 2065 7870 6563 7473  overlap` expects
+0003d020: 206f 7574 7075 7420 746f 2062 6520 6120   output to be a 
+0003d030: 7061 6e64 6173 206f 626a 6563 742e 2022  pandas object. "
+0003d040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d050: 2022 5472 7920 7061 7373 696e 6720 6120   "Try passing a 
+0003d060: 7061 6e64 6173 206f 626a 6563 7420 6173  pandas object as
+0003d070: 206d 6574 6120 6f72 2061 2064 6963 7420   meta or a dict 
+0003d080: 6f72 2074 7570 6c65 2072 6570 7265 7365  or tuple represe
+0003d090: 6e74 696e 6720 7468 6520 220a 2020 2020  nting the ".    
+0003d0a0: 2020 2020 2020 2020 2020 2020 2228 6e61              "(na
+0003d0b0: 6d65 2c20 6474 7970 6529 206f 6620 7468  me, dtype) of th
+0003d0c0: 6520 636f 6c75 6d6e 732e 2049 6e20 7468  e columns. In th
+0003d0d0: 6520 6675 7475 7265 2074 6865 206d 6574  e future the met
+0003d0e0: 6120 796f 7520 7061 7373 6564 2077 696c  a you passed wil
+0003d0f0: 6c20 6e6f 7420 776f 726b 2e22 2c0a 2020  l not work.",.  
+0003d100: 2020 2020 2020 2020 2020 2020 2020 4675                Fu
+0003d110: 7475 7265 5761 726e 696e 672c 0a20 2020  tureWarning,.   
+0003d120: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0003d130: 2020 2023 2049 6620 606d 6574 6160 2069     # If `meta` i
+0003d140: 7320 6e6f 7420 6120 7061 6e64 6173 206f  s not a pandas o
+0003d150: 626a 6563 742c 2074 6865 2063 6f6e 6361  bject, the conca
+0003d160: 7465 6e61 7465 6420 7265 7375 6c74 7320  tenated results 
+0003d170: 7769 6c6c 2062 6520 610a 2020 2020 2020  will be a.      
+0003d180: 2020 2320 6469 6666 6572 656e 7420 7479    # different ty
+0003d190: 7065 0a20 2020 2020 2020 206d 6574 6120  pe.        meta 
+0003d1a0: 3d20 6d61 6b65 5f6d 6574 6128 5f63 6f6e  = make_meta(_con
+0003d1b0: 6361 7428 5b6d 6574 615d 292c 2069 6e64  cat([meta]), ind
+0003d1c0: 6578 3d6d 6574 615f 696e 6465 7829 0a0a  ex=meta_index)..
+0003d1d0: 2020 2020 2320 456e 7375 7265 206d 6574      # Ensure met
+0003d1e0: 6120 6973 2065 6d70 7479 2073 6572 6965  a is empty serie
+0003d1f0: 730a 2020 2020 6d65 7461 203d 206d 616b  s.    meta = mak
+0003d200: 655f 6d65 7461 286d 6574 612c 2070 6172  e_meta(meta, par
+0003d210: 656e 745f 6d65 7461 3d70 6172 656e 745f  ent_meta=parent_
+0003d220: 6d65 7461 290a 0a20 2020 2072 6574 7572  meta)..    retur
+0003d230: 6e20 6d65 7461 0a0a 0a64 6566 2061 7070  n meta...def app
+0003d240: 6c79 5f61 6e64 5f65 6e66 6f72 6365 282a  ly_and_enforce(*
+0003d250: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+0003d260: 0a20 2020 2022 2222 4170 706c 7920 6120  .    """Apply a 
+0003d270: 6675 6e63 7469 6f6e 2c20 616e 6420 656e  function, and en
+0003d280: 666f 7263 6520 7468 6520 6f75 7470 7574  force the output
+0003d290: 2074 6f20 6d61 7463 6820 6d65 7461 0a0a   to match meta..
+0003d2a0: 2020 2020 456e 7375 7265 7320 7468 6520      Ensures the 
+0003d2b0: 6f75 7470 7574 2068 6173 2074 6865 2073  output has the s
+0003d2c0: 616d 6520 636f 6c75 6d6e 732c 2065 7665  ame columns, eve
+0003d2d0: 6e20 6966 2065 6d70 7479 2e22 2222 0a20  n if empty.""". 
+0003d2e0: 2020 2066 756e 6320 3d20 6b77 6172 6773     func = kwargs
+0003d2f0: 2e70 6f70 2822 5f66 756e 6322 290a 2020  .pop("_func").  
+0003d300: 2020 6d65 7461 203d 206b 7761 7267 732e    meta = kwargs.
+0003d310: 706f 7028 225f 6d65 7461 2229 0a20 2020  pop("_meta").   
+0003d320: 2064 6620 3d20 6675 6e63 282a 6172 6773   df = func(*args
+0003d330: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
+0003d340: 6966 2069 735f 6461 7461 6672 616d 655f  if is_dataframe_
+0003d350: 6c69 6b65 2864 6629 206f 7220 6973 5f73  like(df) or is_s
+0003d360: 6572 6965 735f 6c69 6b65 2864 6629 206f  eries_like(df) o
+0003d370: 7220 6973 5f69 6e64 6578 5f6c 696b 6528  r is_index_like(
+0003d380: 6466 293a 0a20 2020 2020 2020 2069 6620  df):.        if 
+0003d390: 6e6f 7420 6c65 6e28 6466 293a 0a20 2020  not len(df):.   
+0003d3a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0003d3b0: 6d65 7461 0a20 2020 2020 2020 2069 6620  meta.        if 
+0003d3c0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+0003d3d0: 6528 6466 293a 0a20 2020 2020 2020 2020  e(df):.         
+0003d3e0: 2020 2063 6865 636b 5f6d 6174 6368 696e     check_matchin
+0003d3f0: 675f 636f 6c75 6d6e 7328 6d65 7461 2c20  g_columns(meta, 
+0003d400: 6466 290a 2020 2020 2020 2020 2020 2020  df).            
+0003d410: 6320 3d20 6d65 7461 2e63 6f6c 756d 6e73  c = meta.columns
+0003d420: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0003d430: 2020 2020 2020 2020 2020 2063 203d 206d             c = m
+0003d440: 6574 612e 6e61 6d65 0a20 2020 2020 2020  eta.name.       
+0003d450: 2072 6574 7572 6e20 5f72 656e 616d 6528   return _rename(
+0003d460: 632c 2064 6629 0a20 2020 2072 6574 7572  c, df).    retur
+0003d470: 6e20 6466 0a0a 0a64 6566 205f 7265 6e61  n df...def _rena
+0003d480: 6d65 2863 6f6c 756d 6e73 2c20 6466 293a  me(columns, df):
+0003d490: 0a20 2020 2022 2222 0a20 2020 2052 656e  .    """.    Ren
+0003d4a0: 616d 6520 636f 6c75 6d6e 7320 6f66 2070  ame columns of p
+0003d4b0: 642e 4461 7461 4672 616d 6520 6f72 206e  d.DataFrame or n
+0003d4c0: 616d 6520 6f66 2070 642e 5365 7269 6573  ame of pd.Series
+0003d4d0: 2e0a 2020 2020 4e6f 7420 666f 7220 6464  ..    Not for dd
+0003d4e0: 2e44 6174 6146 7261 6d65 206f 7220 6464  .DataFrame or dd
+0003d4f0: 2e53 6572 6965 732e 0a0a 2020 2020 5061  .Series...    Pa
+0003d500: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+0003d510: 2d2d 2d2d 2d2d 2d0a 2020 2020 636f 6c75  -------.    colu
+0003d520: 6d6e 7320 3a20 7475 706c 652c 2073 7472  mns : tuple, str
+0003d530: 696e 672c 2070 642e 4461 7461 4672 616d  ing, pd.DataFram
+0003d540: 6520 6f72 2070 642e 5365 7269 6573 0a20  e or pd.Series. 
+0003d550: 2020 2020 2020 2043 6f6c 756d 6e20 6e61         Column na
+0003d560: 6d65 732c 2053 6572 6965 7320 6e61 6d65  mes, Series name
+0003d570: 206f 7220 7061 6e64 6173 2069 6e73 7461   or pandas insta
+0003d580: 6e63 6520 7768 6963 6820 6861 7320 7468  nce which has th
+0003d590: 650a 2020 2020 2020 2020 7461 7267 6574  e.        target
+0003d5a0: 2063 6f6c 756d 6e20 6e61 6d65 7320 2f20   column names / 
+0003d5b0: 6e61 6d65 2e0a 2020 2020 6466 203a 2070  name..    df : p
+0003d5c0: 642e 4461 7461 4672 616d 6520 6f72 2070  d.DataFrame or p
+0003d5d0: 642e 5365 7269 6573 0a20 2020 2020 2020  d.Series.       
+0003d5e0: 2074 6172 6765 7420 4461 7461 4672 616d   target DataFram
+0003d5f0: 6520 2f20 5365 7269 6573 2074 6f20 6265  e / Series to be
+0003d600: 2072 656e 616d 6564 0a20 2020 2022 2222   renamed.    """
+0003d610: 0a20 2020 2061 7373 6572 7420 6e6f 7420  .    assert not 
+0003d620: 6973 696e 7374 616e 6365 2864 662c 205f  isinstance(df, _
+0003d630: 4672 616d 6529 0a0a 2020 2020 6966 2063  Frame)..    if c
+0003d640: 6f6c 756d 6e73 2069 7320 6e6f 5f64 6566  olumns is no_def
+0003d650: 6175 6c74 3a0a 2020 2020 2020 2020 7265  ault:.        re
+0003d660: 7475 726e 2064 660a 0a20 2020 2069 6620  turn df..    if 
+0003d670: 6973 696e 7374 616e 6365 2863 6f6c 756d  isinstance(colum
+0003d680: 6e73 2c20 4974 6572 6174 6f72 293a 0a20  ns, Iterator):. 
+0003d690: 2020 2020 2020 2063 6f6c 756d 6e73 203d         columns =
+0003d6a0: 206c 6973 7428 636f 6c75 6d6e 7329 0a0a   list(columns)..
+0003d6b0: 2020 2020 6966 2069 735f 6461 7461 6672      if is_datafr
+0003d6c0: 616d 655f 6c69 6b65 2864 6629 3a0a 2020  ame_like(df):.  
+0003d6d0: 2020 2020 2020 6966 2069 735f 6461 7461        if is_data
+0003d6e0: 6672 616d 655f 6c69 6b65 2863 6f6c 756d  frame_like(colum
+0003d6f0: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
+0003d700: 2063 6f6c 756d 6e73 203d 2063 6f6c 756d   columns = colum
+0003d710: 6e73 2e63 6f6c 756d 6e73 0a20 2020 2020  ns.columns.     
+0003d720: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+0003d730: 616e 6365 2863 6f6c 756d 6e73 2c20 7064  ance(columns, pd
+0003d740: 2e49 6e64 6578 293a 0a20 2020 2020 2020  .Index):.       
+0003d750: 2020 2020 2063 6f6c 756d 6e73 203d 2070       columns = p
+0003d760: 642e 496e 6465 7828 636f 6c75 6d6e 7329  d.Index(columns)
+0003d770: 0a20 2020 2020 2020 2069 6620 280a 2020  .        if (.  
+0003d780: 2020 2020 2020 2020 2020 6c65 6e28 636f            len(co
+0003d790: 6c75 6d6e 7329 203d 3d20 6c65 6e28 6466  lumns) == len(df
+0003d7a0: 2e63 6f6c 756d 6e73 290a 2020 2020 2020  .columns).      
+0003d7b0: 2020 2020 2020 616e 6420 7479 7065 2863        and type(c
+0003d7c0: 6f6c 756d 6e73 2920 6973 2074 7970 6528  olumns) is type(
+0003d7d0: 6466 2e63 6f6c 756d 6e73 290a 2020 2020  df.columns).    
+0003d7e0: 2020 2020 2020 2020 616e 6420 636f 6c75          and colu
+0003d7f0: 6d6e 732e 6474 7970 6520 3d3d 2064 662e  mns.dtype == df.
+0003d800: 636f 6c75 6d6e 732e 6474 7970 650a 2020  columns.dtype.  
+0003d810: 2020 2020 2020 2020 2020 616e 6420 636f            and co
+0003d820: 6c75 6d6e 732e 6571 7561 6c73 2864 662e  lumns.equals(df.
+0003d830: 636f 6c75 6d6e 7329 0a20 2020 2020 2020  columns).       
+0003d840: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0003d850: 2320 6966 2074 6172 6765 7420 6973 2069  # if target is i
+0003d860: 6465 6e74 6963 616c 2c20 7265 6e61 6d65  dentical, rename
+0003d870: 2069 7320 6e6f 7420 6e65 6365 7373 6172   is not necessar
+0003d880: 790a 2020 2020 2020 2020 2020 2020 7265  y.            re
+0003d890: 7475 726e 2064 660a 2020 2020 2020 2020  turn df.        
+0003d8a0: 2320 6465 6570 3d46 616c 7365 2064 6f65  # deep=False doe
+0003d8b0: 736e 2774 2064 6f65 736e 2774 2063 6f70  sn't doesn't cop
+0003d8c0: 7920 616e 7920 6461 7461 2f69 6e64 6963  y any data/indic
+0003d8d0: 6573 2c20 736f 2074 6869 7320 6973 2063  es, so this is c
+0003d8e0: 6865 6170 0a20 2020 2020 2020 2064 6620  heap.        df 
+0003d8f0: 3d20 6466 2e63 6f70 7928 6465 6570 3d46  = df.copy(deep=F
+0003d900: 616c 7365 290a 2020 2020 2020 2020 6466  alse).        df
+0003d910: 2e63 6f6c 756d 6e73 203d 2063 6f6c 756d  .columns = colum
+0003d920: 6e73 0a20 2020 2020 2020 2072 6574 7572  ns.        retur
+0003d930: 6e20 6466 0a20 2020 2065 6c69 6620 6973  n df.    elif is
+0003d940: 5f73 6572 6965 735f 6c69 6b65 2864 6629  _series_like(df)
+0003d950: 206f 7220 6973 5f69 6e64 6578 5f6c 696b   or is_index_lik
+0003d960: 6528 6466 293a 0a20 2020 2020 2020 2069  e(df):.        i
+0003d970: 6620 6973 5f73 6572 6965 735f 6c69 6b65  f is_series_like
+0003d980: 2863 6f6c 756d 6e73 2920 6f72 2069 735f  (columns) or is_
+0003d990: 696e 6465 785f 6c69 6b65 2863 6f6c 756d  index_like(colum
+0003d9a0: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
+0003d9b0: 2063 6f6c 756d 6e73 203d 2063 6f6c 756d   columns = colum
+0003d9c0: 6e73 2e6e 616d 650a 2020 2020 2020 2020  ns.name.        
+0003d9d0: 6966 2064 662e 6e61 6d65 203d 3d20 636f  if df.name == co
+0003d9e0: 6c75 6d6e 733a 0a20 2020 2020 2020 2020  lumns:.         
+0003d9f0: 2020 2072 6574 7572 6e20 6466 0a20 2020     return df.   
+0003da00: 2020 2020 2072 6574 7572 6e20 6466 2e72       return df.r
+0003da10: 656e 616d 6528 636f 6c75 6d6e 7329 0a20  ename(columns). 
+0003da20: 2020 2023 206d 6170 5f70 6172 7469 7469     # map_partiti
+0003da30: 6f6e 206d 6179 2070 6173 7320 6f74 6865  on may pass othe
+0003da40: 7220 7479 7065 730a 2020 2020 7265 7475  r types.    retu
+0003da50: 726e 2064 660a 0a0a 6465 6620 5f72 656e  rn df...def _ren
+0003da60: 616d 655f 6461 736b 2864 662c 206e 616d  ame_dask(df, nam
+0003da70: 6573 293a 0a20 2020 2022 2222 0a20 2020  es):.    """.   
+0003da80: 2044 6573 7472 7563 7469 7665 6c79 2072   Destructively r
+0003da90: 656e 616d 6520 636f 6c75 6d6e 7320 6f66  ename columns of
+0003daa0: 2064 642e 4461 7461 4672 616d 6520 6f72   dd.DataFrame or
+0003dab0: 206e 616d 6520 6f66 2064 642e 5365 7269   name of dd.Seri
+0003dac0: 6573 2e0a 2020 2020 4e6f 7420 666f 7220  es..    Not for 
+0003dad0: 7064 2e44 6174 6146 7261 6d65 206f 7220  pd.DataFrame or 
+0003dae0: 7064 2e53 6572 6965 732e 0a0a 2020 2020  pd.Series...    
+0003daf0: 496e 7465 726e 616c 6c79 2075 7365 6420  Internally used 
+0003db00: 746f 206f 7665 7277 7269 7465 2064 642e  to overwrite dd.
+0003db10: 4461 7461 4672 616d 652e 636f 6c75 6d6e  DataFrame.column
+0003db20: 7320 616e 6420 6464 2e53 6572 6965 732e  s and dd.Series.
+0003db30: 6e61 6d65 0a20 2020 2057 6520 6361 6e27  name.    We can'
+0003db40: 7420 7573 6520 6d61 705f 7061 7274 6974  t use map_partit
+0003db50: 696f 6e20 6265 6361 7573 6520 6974 2061  ion because it a
+0003db60: 7070 6c69 6573 2066 756e 6374 696f 6e20  pplies function 
+0003db70: 7468 656e 2072 656e 616d 650a 0a20 2020  then rename..   
+0003db80: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0003db90: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064  ----------.    d
+0003dba0: 6620 3a20 6464 2e44 6174 6146 7261 6d65  f : dd.DataFrame
+0003dbb0: 206f 7220 6464 2e53 6572 6965 730a 2020   or dd.Series.  
+0003dbc0: 2020 2020 2020 7461 7267 6574 2044 6174        target Dat
+0003dbd0: 6146 7261 6d65 202f 2053 6572 6965 7320  aFrame / Series 
+0003dbe0: 746f 2062 6520 7265 6e61 6d65 640a 2020  to be renamed.  
+0003dbf0: 2020 6e61 6d65 7320 3a20 7475 706c 652c    names : tuple,
+0003dc00: 2073 7472 696e 670a 2020 2020 2020 2020   string.        
+0003dc10: 436f 6c75 6d6e 206e 616d 6573 2f53 6572  Column names/Ser
+0003dc20: 6965 7320 6e61 6d65 0a20 2020 2022 2222  ies name.    """
+0003dc30: 0a0a 2020 2020 6173 7365 7274 2069 7369  ..    assert isi
+0003dc40: 6e73 7461 6e63 6528 6466 2c20 5f46 7261  nstance(df, _Fra
+0003dc50: 6d65 290a 2020 2020 6d65 7461 6461 7461  me).    metadata
+0003dc60: 203d 205f 7265 6e61 6d65 286e 616d 6573   = _rename(names
+0003dc70: 2c20 6466 2e5f 6d65 7461 290a 2020 2020  , df._meta).    
+0003dc80: 6e61 6d65 203d 2066 2272 656e 616d 652d  name = f"rename-
+0003dc90: 7b74 6f6b 656e 697a 6528 6466 2c20 6d65  {tokenize(df, me
+0003dca0: 7461 6461 7461 297d 220a 0a20 2020 2064  tadata)}"..    d
+0003dcb0: 736b 203d 2070 6172 7469 7469 6f6e 7769  sk = partitionwi
+0003dcc0: 7365 5f67 7261 7068 285f 7265 6e61 6d65  se_graph(_rename
+0003dcd0: 2c20 6e61 6d65 2c20 6d65 7461 6461 7461  , name, metadata
+0003dce0: 2c20 6466 290a 2020 2020 6772 6170 6820  , df).    graph 
+0003dcf0: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
+0003dd00: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
+0003dd10: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
+0003dd20: 656e 6465 6e63 6965 733d 5b64 665d 290a  endencies=[df]).
+0003dd30: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
+0003dd40: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
+0003dd50: 6e61 6d65 2c20 6d65 7461 6461 7461 2c20  name, metadata, 
+0003dd60: 6466 2e64 6976 6973 696f 6e73 290a 0a0a  df.divisions)...
+0003dd70: 6465 6620 7175 616e 7469 6c65 2864 662c  def quantile(df,
+0003dd80: 2071 2c20 6d65 7468 6f64 3d22 6465 6661   q, method="defa
+0003dd90: 756c 7422 293a 0a20 2020 2022 2222 4170  ult"):.    """Ap
+0003dda0: 7072 6f78 696d 6174 6520 7175 616e 7469  proximate quanti
+0003ddb0: 6c65 7320 6f66 2053 6572 6965 732e 0a0a  les of Series...
+0003ddc0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0003ddd0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0003dde0: 2020 7120 3a20 6c69 7374 2f61 7272 6179    q : list/array
+0003ddf0: 206f 6620 666c 6f61 7473 0a20 2020 2020   of floats.     
+0003de00: 2020 2049 7465 7261 626c 6520 6f66 206e     Iterable of n
+0003de10: 756d 6265 7273 2072 616e 6769 6e67 2066  umbers ranging f
+0003de20: 726f 6d20 3020 746f 2031 3030 2066 6f72  rom 0 to 100 for
+0003de30: 2074 6865 2064 6573 6972 6564 2071 7561   the desired qua
+0003de40: 6e74 696c 6573 0a20 2020 206d 6574 686f  ntiles.    metho
+0003de50: 6420 3a20 7b27 6465 6661 756c 7427 2c20  d : {'default', 
+0003de60: 2774 6469 6765 7374 272c 2027 6461 736b  'tdigest', 'dask
+0003de70: 277d 2c20 6f70 7469 6f6e 616c 0a20 2020  '}, optional.   
+0003de80: 2020 2020 2057 6861 7420 6d65 7468 6f64       What method
+0003de90: 2074 6f20 7573 652e 2042 7920 6465 6661   to use. By defa
+0003dea0: 756c 7420 7769 6c6c 2075 7365 2064 6173  ult will use das
+0003deb0: 6b27 7320 696e 7465 726e 616c 2063 7573  k's internal cus
+0003dec0: 746f 6d0a 2020 2020 2020 2020 616c 676f  tom.        algo
+0003ded0: 7269 7468 6d20 2860 6027 6461 736b 2760  rithm (``'dask'`
+0003dee0: 6029 2e20 2049 6620 7365 7420 746f 2060  `).  If set to `
+0003def0: 6027 7464 6967 6573 7427 6060 2077 696c  `'tdigest'`` wil
+0003df00: 6c20 7573 6520 7464 6967 6573 7420 666f  l use tdigest fo
+0003df10: 720a 2020 2020 2020 2020 666c 6f61 7473  r.        floats
+0003df20: 2061 6e64 2069 6e74 7320 616e 6420 6661   and ints and fa
+0003df30: 6c6c 6261 636b 2074 6f20 7468 6520 6060  llback to the ``
+0003df40: 2764 6173 6b27 6060 206f 7468 6572 7769  'dask'`` otherwi
+0003df50: 7365 2e0a 2020 2020 2222 220a 2020 2020  se..    """.    
+0003df60: 2320 6375 7272 656e 7420 696d 706c 656d  # current implem
+0003df70: 656e 7461 7469 6f6e 206e 6565 6473 2071  entation needs q
+0003df80: 2074 6f20 6265 2073 6f72 7465 6420 736f   to be sorted so
+0003df90: 0a20 2020 2023 2073 6f72 7420 6966 2061  .    # sort if a
+0003dfa0: 7272 6179 2d6c 696b 652c 206f 7468 6572  rray-like, other
+0003dfb0: 7769 7365 206c 6561 7665 2069 7420 616c  wise leave it al
+0003dfc0: 6f6e 650a 2020 2020 715f 6e64 6172 7261  one.    q_ndarra
+0003dfd0: 7920 3d20 6e70 2e61 7272 6179 2871 290a  y = np.array(q).
+0003dfe0: 2020 2020 6966 2071 5f6e 6461 7272 6179      if q_ndarray
+0003dff0: 2e6e 6469 6d20 3e20 303a 0a20 2020 2020  .ndim > 0:.     
+0003e000: 2020 2071 5f6e 6461 7272 6179 2e73 6f72     q_ndarray.sor
+0003e010: 7428 6b69 6e64 3d22 6d65 7267 6573 6f72  t(kind="mergesor
+0003e020: 7422 290a 2020 2020 2020 2020 7120 3d20  t").        q = 
+0003e030: 715f 6e64 6172 7261 790a 0a20 2020 2061  q_ndarray..    a
+0003e040: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
+0003e050: 2864 662c 2053 6572 6965 7329 0a0a 2020  (df, Series)..  
+0003e060: 2020 616c 6c6f 7765 645f 6d65 7468 6f64    allowed_method
+0003e070: 7320 3d20 5b22 6465 6661 756c 7422 2c20  s = ["default", 
+0003e080: 2264 6173 6b22 2c20 2274 6469 6765 7374  "dask", "tdigest
+0003e090: 225d 0a20 2020 2069 6620 6d65 7468 6f64  "].    if method
+0003e0a0: 206e 6f74 2069 6e20 616c 6c6f 7765 645f   not in allowed_
+0003e0b0: 6d65 7468 6f64 733a 0a20 2020 2020 2020  methods:.       
+0003e0c0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0003e0d0: 7228 226d 6574 686f 6420 6361 6e20 6f6e  r("method can on
+0003e0e0: 6c79 2062 6520 2764 6566 6175 6c74 272c  ly be 'default',
+0003e0f0: 2027 6461 736b 2720 6f72 2027 7464 6967   'dask' or 'tdig
+0003e100: 6573 7427 2229 0a0a 2020 2020 6966 206d  est'")..    if m
+0003e110: 6574 686f 6420 3d3d 2022 6465 6661 756c  ethod == "defaul
+0003e120: 7422 3a0a 2020 2020 2020 2020 696e 7465  t":.        inte
+0003e130: 726e 616c 5f6d 6574 686f 6420 3d20 2264  rnal_method = "d
+0003e140: 6173 6b22 0a20 2020 2065 6c73 653a 0a20  ask".    else:. 
+0003e150: 2020 2020 2020 2069 6e74 6572 6e61 6c5f         internal_
+0003e160: 6d65 7468 6f64 203d 206d 6574 686f 640a  method = method.
+0003e170: 0a20 2020 2023 2063 7572 7265 6e74 6c79  .    # currently
+0003e180: 2c20 6f6e 6c79 2053 6572 6965 7320 6861  , only Series ha
+0003e190: 7320 7175 616e 7469 6c65 206d 6574 686f  s quantile metho
+0003e1a0: 640a 2020 2020 6966 2069 7369 6e73 7461  d.    if isinsta
+0003e1b0: 6e63 6528 6466 2c20 496e 6465 7829 3a0a  nce(df, Index):.
+0003e1c0: 2020 2020 2020 2020 7365 7269 6573 5f74          series_t
+0003e1d0: 7970 203d 2064 662e 5f6d 6574 612e 746f  yp = df._meta.to
+0003e1e0: 5f73 6572 6965 7328 292e 5f63 6f6e 7374  _series()._const
+0003e1f0: 7275 6374 6f72 0a20 2020 2020 2020 206d  ructor.        m
+0003e200: 6574 6120 3d20 6466 2e5f 6d65 7461 5f6e  eta = df._meta_n
+0003e210: 6f6e 656d 7074 792e 746f 5f73 6572 6965  onempty.to_serie
+0003e220: 7328 292e 7175 616e 7469 6c65 2871 290a  s().quantile(q).
+0003e230: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0003e240: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
+0003e250: 696b 6528 6466 2e5f 6d65 7461 293a 0a20  ike(df._meta):. 
+0003e260: 2020 2020 2020 2020 2020 2073 6572 6965             serie
+0003e270: 735f 7479 7020 3d20 6466 2e5f 6d65 7461  s_typ = df._meta
+0003e280: 2e5f 636f 6e73 7472 7563 746f 720a 2020  ._constructor.  
+0003e290: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0003e2a0: 2020 2020 2020 2020 7365 7269 6573 5f74          series_t
+0003e2b0: 7970 203d 2064 662e 5f6d 6574 612e 5f63  yp = df._meta._c
+0003e2c0: 6f6e 7374 7275 6374 6f72 5f73 6c69 6365  onstructor_slice
+0003e2d0: 640a 2020 2020 2020 2020 6d65 7461 203d  d.        meta =
+0003e2e0: 2064 662e 5f6d 6574 615f 6e6f 6e65 6d70   df._meta_nonemp
+0003e2f0: 7479 2e71 7561 6e74 696c 6528 7129 0a0a  ty.quantile(q)..
+0003e300: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
+0003e310: 5f6c 696b 6528 6d65 7461 293a 0a20 2020  _like(meta):.   
+0003e320: 2020 2020 2023 2049 6e64 6578 2e71 7561       # Index.qua
+0003e330: 6e74 696c 6528 6c69 7374 2d6c 696b 6529  ntile(list-like)
+0003e340: 206d 7573 7420 6265 2070 642e 5365 7269   must be pd.Seri
+0003e350: 6573 2c20 6e6f 7420 7064 2e49 6e64 6578  es, not pd.Index
+0003e360: 0a20 2020 2020 2020 2064 665f 6e61 6d65  .        df_name
+0003e370: 203d 2064 662e 6e61 6d65 0a20 2020 2020   = df.name.     
+0003e380: 2020 2066 696e 616c 697a 655f 7473 6b20     finalize_tsk 
+0003e390: 3d20 6c61 6d62 6461 2074 736b 3a20 2873  = lambda tsk: (s
+0003e3a0: 6572 6965 735f 7479 702c 2074 736b 2c20  eries_typ, tsk, 
+0003e3b0: 712c 204e 6f6e 652c 2064 665f 6e61 6d65  q, None, df_name
+0003e3c0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0003e3d0: 5f74 7970 6520 3d20 5365 7269 6573 0a20  _type = Series. 
+0003e3e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003e3f0: 2066 696e 616c 697a 655f 7473 6b20 3d20   finalize_tsk = 
+0003e400: 6c61 6d62 6461 2074 736b 3a20 2867 6574  lambda tsk: (get
+0003e410: 6974 656d 2c20 7473 6b2c 2030 290a 2020  item, tsk, 0).  
+0003e420: 2020 2020 2020 7265 7475 726e 5f74 7970        return_typ
+0003e430: 6520 3d20 5363 616c 6172 0a20 2020 2020  e = Scalar.     
+0003e440: 2020 2071 203d 205b 715d 0a0a 2020 2020     q = [q]..    
+0003e450: 2320 7061 6e64 6173 2075 7365 7320 7175  # pandas uses qu
+0003e460: 616e 7469 6c65 2069 6e20 5b30 2c20 315d  antile in [0, 1]
+0003e470: 0a20 2020 2023 206e 756d 7079 202f 2065  .    # numpy / e
+0003e480: 7665 7279 6f6e 6520 656c 7365 2075 7365  veryone else use
+0003e490: 7320 5b30 2c20 3130 305d 0a20 2020 2071  s [0, 100].    q
+0003e4a0: 7320 3d20 6e70 2e61 7361 7272 6179 2871  s = np.asarray(q
+0003e4b0: 2920 2a20 3130 300a 2020 2020 746f 6b65  ) * 100.    toke
+0003e4c0: 6e20 3d20 746f 6b65 6e69 7a65 2864 662c  n = tokenize(df,
+0003e4d0: 2071 7329 0a0a 2020 2020 6966 206c 656e   qs)..    if len
+0003e4e0: 2871 7329 203d 3d20 303a 0a20 2020 2020  (qs) == 0:.     
+0003e4f0: 2020 206e 616d 6520 3d20 2271 7561 6e74     name = "quant
+0003e500: 696c 6573 2d22 202b 2074 6f6b 656e 0a20  iles-" + token. 
+0003e510: 2020 2020 2020 2065 6d70 7479 5f69 6e64         empty_ind
+0003e520: 6578 203d 2070 642e 496e 6465 7828 5b5d  ex = pd.Index([]
+0003e530: 2c20 6474 7970 653d 666c 6f61 7429 0a0a  , dtype=float)..
+0003e540: 2020 2020 2020 2020 7265 7475 726e 2053          return S
+0003e550: 6572 6965 7328 0a20 2020 2020 2020 2020  eries(.         
+0003e560: 2020 207b 286e 616d 652c 2030 293a 2073     {(name, 0): s
+0003e570: 6572 6965 735f 7479 7028 5b5d 2c20 6e61  eries_typ([], na
+0003e580: 6d65 3d64 662e 6e61 6d65 2c20 696e 6465  me=df.name, inde
+0003e590: 783d 656d 7074 795f 696e 6465 782c 2064  x=empty_index, d
+0003e5a0: 7479 7065 3d22 666c 6f61 7422 297d 2c0a  type="float")},.
+0003e5b0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0003e5c0: 2c0a 2020 2020 2020 2020 2020 2020 6466  ,.            df
+0003e5d0: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
+0003e5e0: 2020 2020 5b4e 6f6e 652c 204e 6f6e 655d      [None, None]
+0003e5f0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0003e600: 656c 7365 3a0a 2020 2020 2020 2020 6e65  else:.        ne
+0003e610: 775f 6469 7669 7369 6f6e 7320 3d20 5b6e  w_divisions = [n
+0003e620: 702e 6d69 6e28 7129 2c20 6e70 2e6d 6178  p.min(q), np.max
+0003e630: 2871 295d 0a0a 2020 2020 6466 203d 2064  (q)]..    df = d
+0003e640: 662e 6472 6f70 6e61 2829 0a0a 2020 2020  f.dropna()..    
+0003e650: 6966 2069 6e74 6572 6e61 6c5f 6d65 7468  if internal_meth
+0003e660: 6f64 203d 3d20 2274 6469 6765 7374 2220  od == "tdigest" 
+0003e670: 616e 6420 280a 2020 2020 2020 2020 6e70  and (.        np
+0003e680: 2e69 7373 7562 6474 7970 6528 6466 2e64  .issubdtype(df.d
+0003e690: 7479 7065 2c20 6e70 2e66 6c6f 6174 696e  type, np.floatin
+0003e6a0: 6729 206f 7220 6e70 2e69 7373 7562 6474  g) or np.issubdt
+0003e6b0: 7970 6528 6466 2e64 7479 7065 2c20 6e70  ype(df.dtype, np
+0003e6c0: 2e69 6e74 6567 6572 290a 2020 2020 293a  .integer).    ):
+0003e6d0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+0003e6e0: 736b 2e75 7469 6c73 2069 6d70 6f72 7420  sk.utils import 
+0003e6f0: 696d 706f 7274 5f72 6571 7569 7265 640a  import_required.
+0003e700: 0a20 2020 2020 2020 2069 6d70 6f72 745f  .        import_
+0003e710: 7265 7175 6972 6564 280a 2020 2020 2020  required(.      
+0003e720: 2020 2020 2020 2263 7269 636b 222c 2022        "crick", "
+0003e730: 6372 6963 6b20 6973 2061 2072 6571 7569  crick is a requi
+0003e740: 7265 6420 6465 7065 6e64 656e 6379 2066  red dependency f
+0003e750: 6f72 2075 7369 6e67 2074 6865 2074 2d64  or using the t-d
+0003e760: 6967 6573 7420 6d65 7468 6f64 2e22 0a20  igest method.". 
+0003e770: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0003e780: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
+0003e790: 792e 7065 7263 656e 7469 6c65 2069 6d70  y.percentile imp
+0003e7a0: 6f72 7420 5f70 6572 6365 6e74 696c 6573  ort _percentiles
+0003e7b0: 5f66 726f 6d5f 7464 6967 6573 742c 205f  _from_tdigest, _
+0003e7c0: 7464 6967 6573 745f 6368 756e 6b0a 0a20  tdigest_chunk.. 
+0003e7d0: 2020 2020 2020 206e 616d 6520 3d20 2271         name = "q
+0003e7e0: 7561 6e74 696c 6573 5f74 6469 6765 7374  uantiles_tdigest
+0003e7f0: 2d31 2d22 202b 2074 6f6b 656e 0a20 2020  -1-" + token.   
+0003e800: 2020 2020 2076 616c 5f64 736b 203d 207b       val_dsk = {
+0003e810: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
+0003e820: 6d65 2c20 6929 3a20 285f 7464 6967 6573  me, i): (_tdiges
+0003e830: 745f 6368 756e 6b2c 2028 6765 7461 7474  t_chunk, (getatt
+0003e840: 722c 206b 6579 2c20 2276 616c 7565 7322  r, key, "values"
+0003e850: 2929 0a20 2020 2020 2020 2020 2020 2066  )).            f
+0003e860: 6f72 2069 2c20 6b65 7920 696e 2065 6e75  or i, key in enu
+0003e870: 6d65 7261 7465 2864 662e 5f5f 6461 736b  merate(df.__dask
+0003e880: 5f6b 6579 735f 5f28 2929 0a20 2020 2020  _keys__()).     
+0003e890: 2020 207d 0a0a 2020 2020 2020 2020 6e61     }..        na
+0003e8a0: 6d65 3220 3d20 2271 7561 6e74 696c 6573  me2 = "quantiles
+0003e8b0: 5f74 6469 6765 7374 2d32 2d22 202b 2074  _tdigest-2-" + t
+0003e8c0: 6f6b 656e 0a20 2020 2020 2020 206d 6572  oken.        mer
+0003e8d0: 6765 5f64 736b 203d 207b 0a20 2020 2020  ge_dsk = {.     
+0003e8e0: 2020 2020 2020 2028 6e61 6d65 322c 2030         (name2, 0
+0003e8f0: 293a 2066 696e 616c 697a 655f 7473 6b28  ): finalize_tsk(
+0003e900: 285f 7065 7263 656e 7469 6c65 735f 6672  (_percentiles_fr
+0003e910: 6f6d 5f74 6469 6765 7374 2c20 7173 2c20  om_tdigest, qs, 
+0003e920: 736f 7274 6564 2876 616c 5f64 736b 2929  sorted(val_dsk))
+0003e930: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
+0003e940: 656c 7365 3a0a 2020 2020 2020 2020 6672  else:.        fr
+0003e950: 6f6d 2064 6173 6b2e 6172 7261 792e 6469  om dask.array.di
+0003e960: 7370 6174 6368 2069 6d70 6f72 7420 7065  spatch import pe
+0003e970: 7263 656e 7469 6c65 5f6c 6f6f 6b75 7020  rcentile_lookup 
+0003e980: 6173 205f 7065 7263 656e 7469 6c65 0a20  as _percentile. 
+0003e990: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+0003e9a0: 2e61 7272 6179 2e70 6572 6365 6e74 696c  .array.percentil
+0003e9b0: 6520 696d 706f 7274 206d 6572 6765 5f70  e import merge_p
+0003e9c0: 6572 6365 6e74 696c 6573 0a0a 2020 2020  ercentiles..    
+0003e9d0: 2020 2020 2320 4164 6420 3020 616e 6420      # Add 0 and 
+0003e9e0: 3130 3020 6475 7269 6e67 2063 616c 6375  100 during calcu
+0003e9f0: 6c61 7469 6f6e 2066 6f72 206d 6f72 6520  lation for more 
+0003ea00: 726f 6275 7374 2062 6568 6176 696f 7220  robust behavior 
+0003ea10: 2868 6f70 6566 756c 6c79 290a 2020 2020  (hopefully).    
+0003ea20: 2020 2020 6361 6c63 5f71 7320 3d20 6e70      calc_qs = np
+0003ea30: 2e70 6164 2871 732c 2031 2c20 6d6f 6465  .pad(qs, 1, mode
+0003ea40: 3d22 636f 6e73 7461 6e74 2229 0a20 2020  ="constant").   
+0003ea50: 2020 2020 2063 616c 635f 7173 5b2d 315d       calc_qs[-1]
+0003ea60: 203d 2031 3030 0a20 2020 2020 2020 206e   = 100.        n
+0003ea70: 616d 6520 3d20 2271 7561 6e74 696c 6573  ame = "quantiles
+0003ea80: 2d31 2d22 202b 2074 6f6b 656e 0a20 2020  -1-" + token.   
+0003ea90: 2020 2020 2076 616c 5f64 736b 203d 207b       val_dsk = {
+0003eaa0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
+0003eab0: 6d65 2c20 6929 3a20 285f 7065 7263 656e  me, i): (_percen
+0003eac0: 7469 6c65 2c20 6b65 792c 2063 616c 635f  tile, key, calc_
+0003ead0: 7173 290a 2020 2020 2020 2020 2020 2020  qs).            
+0003eae0: 666f 7220 692c 206b 6579 2069 6e20 656e  for i, key in en
+0003eaf0: 756d 6572 6174 6528 6466 2e5f 5f64 6173  umerate(df.__das
+0003eb00: 6b5f 6b65 7973 5f5f 2829 290a 2020 2020  k_keys__()).    
+0003eb10: 2020 2020 7d0a 0a20 2020 2020 2020 206e      }..        n
+0003eb20: 616d 6532 203d 2022 7175 616e 7469 6c65  ame2 = "quantile
+0003eb30: 732d 322d 2220 2b20 746f 6b65 6e0a 2020  s-2-" + token.  
+0003eb40: 2020 2020 2020 6d65 7267 655f 6473 6b20        merge_dsk 
+0003eb50: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0003eb60: 286e 616d 6532 2c20 3029 3a20 6669 6e61  (name2, 0): fina
+0003eb70: 6c69 7a65 5f74 736b 280a 2020 2020 2020  lize_tsk(.      
+0003eb80: 2020 2020 2020 2020 2020 280a 2020 2020            (.    
+0003eb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eba0: 6d65 7267 655f 7065 7263 656e 7469 6c65  merge_percentile
+0003ebb0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0003ebc0: 2020 2020 2020 2071 732c 0a20 2020 2020         qs,.     
+0003ebd0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0003ebe0: 6361 6c63 5f71 735d 202a 2064 662e 6e70  calc_qs] * df.np
+0003ebf0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
+0003ec00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003ec10: 6f72 7465 6428 7661 6c5f 6473 6b29 2c0a  orted(val_dsk),.
+0003ec20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ec30: 2020 2020 226c 6f77 6572 222c 0a20 2020      "lower",.   
+0003ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ec50: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0003ec60: 2020 2020 2020 2020 2020 2046 616c 7365             False
+0003ec70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003ec80: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0003ec90: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
+0003eca0: 6473 6b20 3d20 6d65 7267 6528 7661 6c5f  dsk = merge(val_
+0003ecb0: 6473 6b2c 206d 6572 6765 5f64 736b 290a  dsk, merge_dsk).
+0003ecc0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+0003ecd0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+0003ece0: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
+0003ecf0: 322c 2064 736b 2c20 6465 7065 6e64 656e  2, dsk, dependen
+0003ed00: 6369 6573 3d5b 6466 5d29 0a20 2020 2072  cies=[df]).    r
+0003ed10: 6574 7572 6e20 7265 7475 726e 5f74 7970  eturn return_typ
+0003ed20: 6528 6772 6170 682c 206e 616d 6532 2c20  e(graph, name2, 
+0003ed30: 6d65 7461 2c20 6e65 775f 6469 7669 7369  meta, new_divisi
+0003ed40: 6f6e 7329 0a0a 0a64 6566 205f 636f 765f  ons)...def _cov_
+0003ed50: 636f 7272 280a 2020 2020 6466 2c0a 2020  corr(.    df,.  
+0003ed60: 2020 6d69 6e5f 7065 7269 6f64 733d 4e6f    min_periods=No
+0003ed70: 6e65 2c0a 2020 2020 636f 7272 3d46 616c  ne,.    corr=Fal
+0003ed80: 7365 2c0a 2020 2020 7363 616c 6172 3d46  se,.    scalar=F
+0003ed90: 616c 7365 2c0a 2020 2020 6e75 6d65 7269  alse,.    numeri
+0003eda0: 635f 6f6e 6c79 3d6e 6f5f 6465 6661 756c  c_only=no_defaul
+0003edb0: 742c 0a20 2020 2073 706c 6974 5f65 7665  t,.    split_eve
+0003edc0: 7279 3d46 616c 7365 2c0a 293a 0a20 2020  ry=False,.):.   
+0003edd0: 2022 2222 4461 7461 4672 616d 6520 636f   """DataFrame co
+0003ede0: 7661 7269 616e 6365 2061 6e64 2070 6561  variance and pea
+0003edf0: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
+0003ee00: 2e0a 0a20 2020 2043 6f6d 7075 7465 7320  ...    Computes 
+0003ee10: 7061 6972 7769 7365 2063 6f76 6172 6961  pairwise covaria
+0003ee20: 6e63 6520 6f72 2063 6f72 7265 6c61 7469  nce or correlati
+0003ee30: 6f6e 206f 6620 636f 6c75 6d6e 732c 2065  on of columns, e
+0003ee40: 7863 6c75 6469 6e67 204e 412f 6e75 6c6c  xcluding NA/null
+0003ee50: 0a20 2020 2076 616c 7565 732e 0a0a 2020  .    values...  
+0003ee60: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0003ee70: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0003ee80: 6466 203a 2044 6174 6146 7261 6d65 0a20  df : DataFrame. 
+0003ee90: 2020 206d 696e 5f70 6572 696f 6473 203a     min_periods :
+0003eea0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
+0003eeb0: 2020 2020 2020 204d 696e 696d 756d 206e         Minimum n
+0003eec0: 756d 6265 7220 6f66 206f 6273 6572 7661  umber of observa
+0003eed0: 7469 6f6e 7320 7265 7175 6972 6564 2070  tions required p
+0003eee0: 6572 2070 6169 7220 6f66 2063 6f6c 756d  er pair of colum
+0003eef0: 6e73 0a20 2020 2020 2020 2074 6f20 6861  ns.        to ha
+0003ef00: 7665 2061 2076 616c 6964 2072 6573 756c  ve a valid resul
+0003ef10: 742e 0a20 2020 2063 6f72 7220 3a20 626f  t..    corr : bo
+0003ef20: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
+0003ef30: 2020 2020 2049 6620 5472 7565 2c20 636f       If True, co
+0003ef40: 6d70 7574 6520 7468 6520 5065 6172 736f  mpute the Pearso
+0003ef50: 6e20 636f 7272 656c 6174 696f 6e2e 2049  n correlation. I
+0003ef60: 6620 4661 6c73 6520 5b64 6566 6175 6c74  f False [default
+0003ef70: 5d2c 2063 6f6d 7075 7465 0a20 2020 2020  ], compute.     
+0003ef80: 2020 2074 6865 2063 6f76 6172 6961 6e63     the covarianc
+0003ef90: 652e 0a20 2020 2073 6361 6c61 7220 3a20  e..    scalar : 
+0003efa0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
+0003efb0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+0003efc0: 636f 6d70 7574 6520 636f 7661 7269 616e  compute covarian
+0003efd0: 6365 2062 6574 7765 656e 2074 776f 2076  ce between two v
+0003efe0: 6172 6961 626c 6573 2061 7320 6120 7363  ariables as a sc
+0003eff0: 616c 6172 2e20 4f6e 6c79 0a20 2020 2020  alar. Only.     
+0003f000: 2020 2076 616c 6964 2069 6620 6064 6660     valid if `df`
+0003f010: 2068 6173 2032 2063 6f6c 756d 6e73 2e20   has 2 columns. 
+0003f020: 2049 6620 4661 6c73 6520 5b64 6566 6175   If False [defau
+0003f030: 6c74 5d2c 2063 6f6d 7075 7465 2074 6865  lt], compute the
+0003f040: 2065 6e74 6972 650a 2020 2020 2020 2020   entire.        
+0003f050: 636f 7661 7269 616e 6365 2f63 6f72 7265  covariance/corre
+0003f060: 6c61 7469 6f6e 206d 6174 7269 782e 0a20  lation matrix.. 
+0003f070: 2020 2073 706c 6974 5f65 7665 7279 203a     split_every :
+0003f080: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
+0003f090: 2020 2020 2020 2047 726f 7570 2070 6172         Group par
+0003f0a0: 7469 7469 6f6e 7320 696e 746f 2067 726f  titions into gro
+0003f0b0: 7570 7320 6f66 2074 6869 7320 7369 7a65  ups of this size
+0003f0c0: 2077 6869 6c65 2070 6572 666f 726d 696e   while performin
+0003f0d0: 6720 610a 2020 2020 2020 2020 7472 6565  g a.        tree
+0003f0e0: 2d72 6564 7563 7469 6f6e 2e20 4966 2073  -reduction. If s
+0003f0f0: 6574 2074 6f20 4661 6c73 652c 206e 6f20  et to False, no 
+0003f100: 7472 6565 2d72 6564 7563 7469 6f6e 2077  tree-reduction w
+0003f110: 696c 6c20 6265 2075 7365 642e 0a20 2020  ill be used..   
+0003f120: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
+0003f130: 4661 6c73 652e 0a20 2020 2022 2222 0a20  False..    """. 
+0003f140: 2020 2069 6620 6d69 6e5f 7065 7269 6f64     if min_period
+0003f150: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+0003f160: 2020 206d 696e 5f70 6572 696f 6473 203d     min_periods =
+0003f170: 2032 0a20 2020 2065 6c69 6620 6d69 6e5f   2.    elif min_
+0003f180: 7065 7269 6f64 7320 3c20 323a 0a20 2020  periods < 2:.   
+0003f190: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0003f1a0: 4572 726f 7228 226d 696e 5f70 6572 696f  Error("min_perio
+0003f1b0: 6473 206d 7573 7420 6265 203e 3d20 3222  ds must be >= 2"
+0003f1c0: 290a 0a20 2020 2069 6620 7370 6c69 745f  )..    if split_
+0003f1d0: 6576 6572 7920 6973 2046 616c 7365 3a0a  every is False:.
+0003f1e0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+0003f1f0: 6572 7920 3d20 6466 2e6e 7061 7274 6974  ery = df.npartit
+0003f200: 696f 6e73 0a20 2020 2065 6c69 6620 7370  ions.    elif sp
+0003f210: 6c69 745f 6576 6572 7920 3c20 3220 6f72  lit_every < 2 or
+0003f220: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0003f230: 7370 6c69 745f 6576 6572 792c 2049 6e74  split_every, Int
+0003f240: 6567 7261 6c29 3a0a 2020 2020 2020 2020  egral):.        
+0003f250: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0003f260: 2822 7370 6c69 745f 6576 6572 7920 6d75  ("split_every mu
+0003f270: 7374 2062 6520 616e 2069 6e74 6567 6572  st be an integer
+0003f280: 203e 3d20 3222 290a 0a20 2020 2023 2048   >= 2")..    # H
+0003f290: 616e 646c 6520 7365 6c65 6374 696e 6720  andle selecting 
+0003f2a0: 6e75 6d65 7269 6320 6461 7461 2061 6e64  numeric data and
+0003f2b0: 2061 7373 6f63 6961 7465 6420 6465 7072   associated depr
+0003f2c0: 6563 6174 696f 6e20 7761 726e 696e 670a  ecation warning.
+0003f2d0: 2020 2020 6d61 7962 655f 7761 726e 203d      maybe_warn =
+0003f2e0: 2046 616c 7365 0a20 2020 2069 6620 6e75   False.    if nu
+0003f2f0: 6d65 7269 635f 6f6e 6c79 2069 7320 6e6f  meric_only is no
+0003f300: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
+0003f310: 2020 6966 2050 414e 4441 535f 4754 5f32    if PANDAS_GT_2
+0003f320: 3030 3a0a 2020 2020 2020 2020 2020 2020  00:.            
+0003f330: 6e75 6d65 7269 635f 6f6e 6c79 203d 2046  numeric_only = F
+0003f340: 616c 7365 0a20 2020 2020 2020 2065 6c69  alse.        eli
+0003f350: 6620 5041 4e44 4153 5f47 545f 3135 303a  f PANDAS_GT_150:
+0003f360: 0a20 2020 2020 2020 2020 2020 206d 6179  .            may
+0003f370: 6265 5f77 6172 6e20 3d20 5472 7565 0a20  be_warn = True. 
+0003f380: 2020 2020 2020 2020 2020 206e 756d 6572             numer
+0003f390: 6963 5f6f 6e6c 7920 3d20 5472 7565 0a20  ic_only = True. 
+0003f3a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0003f3b0: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
+0003f3c0: 5f6f 6e6c 7920 3d20 5472 7565 0a0a 2020  _only = True..  
+0003f3d0: 2020 616c 6c5f 6e75 6d65 7269 6320 3d20    all_numeric = 
+0003f3e0: 6466 2e5f 6765 745f 6e75 6d65 7269 635f  df._get_numeric_
+0003f3f0: 6461 7461 2829 2e5f 6e61 6d65 203d 3d20  data()._name == 
+0003f400: 6466 2e5f 6e61 6d65 0a20 2020 2069 6620  df._name.    if 
+0003f410: 6d61 7962 655f 7761 726e 2061 6e64 206e  maybe_warn and n
+0003f420: 6f74 2061 6c6c 5f6e 756d 6572 6963 3a0a  ot all_numeric:.
+0003f430: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0003f440: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+0003f450: 2020 2022 5468 6520 6465 6661 756c 7420     "The default 
+0003f460: 7661 6c75 6520 6f66 206e 756d 6572 6963  value of numeric
+0003f470: 5f6f 6e6c 7920 7769 6c6c 2062 6520 6046  _only will be `F
+0003f480: 616c 7365 6020 220a 2020 2020 2020 2020  alse` ".        
+0003f490: 2020 2020 2269 6e20 6120 6675 7475 7265      "in a future
+0003f4a0: 2076 6572 7369 6f6e 206f 6620 4461 736b   version of Dask
+0003f4b0: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
+0003f4c0: 4675 7475 7265 5761 726e 696e 672c 0a20  FutureWarning,. 
+0003f4d0: 2020 2020 2020 2029 0a0a 2020 2020 6966         )..    if
+0003f4e0: 206e 756d 6572 6963 5f6f 6e6c 7920 616e   numeric_only an
+0003f4f0: 6420 6e6f 7420 616c 6c5f 6e75 6d65 7269  d not all_numeri
+0003f500: 633a 0a20 2020 2020 2020 2064 6620 3d20  c:.        df = 
+0003f510: 6466 2e5f 6765 745f 6e75 6d65 7269 635f  df._get_numeric_
+0003f520: 6461 7461 2829 0a0a 2020 2020 6966 2073  data()..    if s
+0003f530: 6361 6c61 7220 616e 6420 6c65 6e28 6466  calar and len(df
+0003f540: 2e63 6f6c 756d 6e73 2920 213d 2032 3a0a  .columns) != 2:.
+0003f550: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0003f560: 6c75 6545 7272 6f72 2822 7363 616c 6172  lueError("scalar
+0003f570: 206f 6e6c 7920 7661 6c69 6420 666f 7220   only valid for 
+0003f580: 3220 636f 6c75 6d6e 2064 6174 6166 7261  2 column datafra
+0003f590: 6d65 2229 0a0a 2020 2020 746f 6b65 6e20  me")..    token 
+0003f5a0: 3d20 746f 6b65 6e69 7a65 2864 662c 206d  = tokenize(df, m
+0003f5b0: 696e 5f70 6572 696f 6473 2c20 7363 616c  in_periods, scal
+0003f5c0: 6172 2c20 7370 6c69 745f 6576 6572 7929  ar, split_every)
+0003f5d0: 0a0a 2020 2020 6675 6e63 6e61 6d65 203d  ..    funcname =
+0003f5e0: 2022 636f 7272 2220 6966 2063 6f72 7220   "corr" if corr 
+0003f5f0: 656c 7365 2022 636f 7622 0a20 2020 2061  else "cov".    a
+0003f600: 203d 2066 227b 6675 6e63 6e61 6d65 7d2d   = f"{funcname}-
+0003f610: 6368 756e 6b2d 7b64 662e 5f6e 616d 657d  chunk-{df._name}
+0003f620: 220a 2020 2020 6473 6b20 3d20 7b0a 2020  ".    dsk = {.  
+0003f630: 2020 2020 2020 2861 2c20 6929 3a20 285f        (a, i): (_
+0003f640: 636f 765f 636f 7272 5f63 6875 6e6b 2c20  cov_corr_chunk, 
+0003f650: 662c 2063 6f72 7229 2066 6f72 2028 692c  f, corr) for (i,
+0003f660: 2066 2920 696e 2065 6e75 6d65 7261 7465   f) in enumerate
+0003f670: 2864 662e 5f5f 6461 736b 5f6b 6579 735f  (df.__dask_keys_
+0003f680: 5f28 2929 0a20 2020 207d 0a0a 2020 2020  _()).    }..    
+0003f690: 7072 6566 6978 203d 2066 227b 6675 6e63  prefix = f"{func
+0003f6a0: 6e61 6d65 7d2d 636f 6d62 696e 652d 7b64  name}-combine-{d
+0003f6b0: 662e 5f6e 616d 657d 2d22 0a20 2020 206b  f._name}-".    k
+0003f6c0: 203d 2064 662e 6e70 6172 7469 7469 6f6e   = df.npartition
+0003f6d0: 730a 2020 2020 6220 3d20 610a 2020 2020  s.    b = a.    
+0003f6e0: 6465 7074 6820 3d20 300a 2020 2020 7768  depth = 0.    wh
+0003f6f0: 696c 6520 6b20 3e20 7370 6c69 745f 6576  ile k > split_ev
+0003f700: 6572 793a 0a20 2020 2020 2020 2062 203d  ery:.        b =
+0003f710: 2070 7265 6669 7820 2b20 7374 7228 6465   prefix + str(de
+0003f720: 7074 6829 0a20 2020 2020 2020 2066 6f72  pth).        for
+0003f730: 2070 6172 745f 692c 2069 6e64 7320 696e   part_i, inds in
+0003f740: 2065 6e75 6d65 7261 7465 2870 6172 7469   enumerate(parti
+0003f750: 7469 6f6e 5f61 6c6c 2873 706c 6974 5f65  tion_all(split_e
+0003f760: 7665 7279 2c20 7261 6e67 6528 6b29 2929  very, range(k)))
+0003f770: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
+0003f780: 6b5b 2862 2c20 7061 7274 5f69 295d 203d  k[(b, part_i)] =
+0003f790: 2028 5f63 6f76 5f63 6f72 725f 636f 6d62   (_cov_corr_comb
+0003f7a0: 696e 652c 205b 2861 2c20 6929 2066 6f72  ine, [(a, i) for
+0003f7b0: 2069 2069 6e20 696e 6473 5d2c 2063 6f72   i in inds], cor
+0003f7c0: 7229 0a20 2020 2020 2020 206b 203d 2070  r).        k = p
+0003f7d0: 6172 745f 6920 2b20 310a 2020 2020 2020  art_i + 1.      
+0003f7e0: 2020 6120 3d20 620a 2020 2020 2020 2020    a = b.        
+0003f7f0: 6465 7074 6820 2b3d 2031 0a0a 2020 2020  depth += 1..    
+0003f800: 6e61 6d65 203d 2066 227b 6675 6e63 6e61  name = f"{funcna
+0003f810: 6d65 7d2d 7b74 6f6b 656e 7d22 0a20 2020  me}-{token}".   
+0003f820: 2064 736b 5b28 6e61 6d65 2c20 3029 5d20   dsk[(name, 0)] 
+0003f830: 3d20 280a 2020 2020 2020 2020 5f63 6f76  = (.        _cov
+0003f840: 5f63 6f72 725f 6167 672c 0a20 2020 2020  _corr_agg,.     
+0003f850: 2020 205b 2861 2c20 6929 2066 6f72 2069     [(a, i) for i
+0003f860: 2069 6e20 7261 6e67 6528 6b29 5d2c 0a20   in range(k)],. 
+0003f870: 2020 2020 2020 2064 662e 636f 6c75 6d6e         df.column
+0003f880: 732c 0a20 2020 2020 2020 206d 696e 5f70  s,.        min_p
+0003f890: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
+0003f8a0: 636f 7272 2c0a 2020 2020 2020 2020 7363  corr,.        sc
+0003f8b0: 616c 6172 2c0a 2020 2020 2020 2020 6466  alar,.        df
+0003f8c0: 2e5f 6d65 7461 2c0a 2020 2020 290a 2020  ._meta,.    ).  
+0003f8d0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+0003f8e0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+0003f8f0: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
+0003f900: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
+0003f910: 733d 5b64 665d 290a 2020 2020 6966 2073  s=[df]).    if s
+0003f920: 6361 6c61 723a 0a20 2020 2020 2020 2072  calar:.        r
+0003f930: 6574 7572 6e20 5363 616c 6172 2867 7261  eturn Scalar(gra
+0003f940: 7068 2c20 6e61 6d65 2c20 2266 3822 290a  ph, name, "f8").
+0003f950: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
+0003f960: 6d65 7461 280a 2020 2020 2020 2020 5b28  meta(.        [(
+0003f970: 632c 2022 6638 2229 2066 6f72 2063 2069  c, "f8") for c i
+0003f980: 6e20 6466 2e63 6f6c 756d 6e73 5d2c 0a20  n df.columns],. 
+0003f990: 2020 2020 2020 2069 6e64 6578 3d6d 6574         index=met
+0003f9a0: 615f 7365 7269 6573 5f63 6f6e 7374 7275  a_series_constru
+0003f9b0: 6374 6f72 2864 6629 2864 662e 636f 6c75  ctor(df)(df.colu
+0003f9c0: 6d6e 7329 2c0a 2020 2020 2020 2020 7061  mns),.        pa
+0003f9d0: 7265 6e74 5f6d 6574 613d 6466 2e5f 6d65  rent_meta=df._me
+0003f9e0: 7461 2c0a 2020 2020 290a 2020 2020 7265  ta,.    ).    re
+0003f9f0: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
+0003fa00: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
+0003fa10: 6d65 7461 2c20 2864 662e 636f 6c75 6d6e  meta, (df.column
+0003fa20: 732e 6d69 6e28 292c 2064 662e 636f 6c75  s.min(), df.colu
+0003fa30: 6d6e 732e 6d61 7828 2929 290a 0a0a 6465  mns.max()))...de
+0003fa40: 6620 5f63 6f76 5f63 6f72 725f 6368 756e  f _cov_corr_chun
+0003fa50: 6b28 6466 2c20 636f 7272 3d46 616c 7365  k(df, corr=False
+0003fa60: 293a 0a20 2020 2022 2222 4368 756e 6b20  ):.    """Chunk 
+0003fa70: 7061 7274 206f 6620 6120 636f 7661 7269  part of a covari
+0003fa80: 616e 6365 206f 7220 636f 7272 656c 6174  ance or correlat
+0003fa90: 696f 6e20 636f 6d70 7574 6174 696f 6e22  ion computation"
+0003faa0: 2222 0a20 2020 2073 6861 7065 203d 2028  "".    shape = (
+0003fab0: 6466 2e73 6861 7065 5b31 5d2c 2064 662e  df.shape[1], df.
+0003fac0: 7368 6170 655b 315d 290a 2020 2020 6466  shape[1]).    df
+0003fad0: 203d 2064 662e 6173 7479 7065 2822 666c   = df.astype("fl
+0003fae0: 6f61 7436 3422 2c20 636f 7079 3d46 616c  oat64", copy=Fal
+0003faf0: 7365 290a 2020 2020 7375 6d73 203d 206e  se).    sums = n
+0003fb00: 702e 7a65 726f 735f 6c69 6b65 2864 662e  p.zeros_like(df.
+0003fb10: 7661 6c75 6573 2c20 7368 6170 653d 7368  values, shape=sh
+0003fb20: 6170 6529 0a20 2020 2063 6f75 6e74 7320  ape).    counts 
+0003fb30: 3d20 6e70 2e7a 6572 6f73 5f6c 696b 6528  = np.zeros_like(
+0003fb40: 6466 2e76 616c 7565 732c 2073 6861 7065  df.values, shape
+0003fb50: 3d73 6861 7065 290a 2020 2020 666f 7220  =shape).    for 
+0003fb60: 6964 7820 696e 2072 616e 6765 286c 656e  idx in range(len
+0003fb70: 2864 662e 636f 6c75 6d6e 7329 293a 0a20  (df.columns)):. 
+0003fb80: 2020 2020 2020 206d 6173 6b20 3d20 6466         mask = df
+0003fb90: 2e69 6c6f 635b 3a2c 2069 6478 5d2e 6e6f  .iloc[:, idx].no
+0003fba0: 746e 756c 6c28 290a 2020 2020 2020 2020  tnull().        
+0003fbb0: 7375 6d73 5b69 6478 5d20 3d20 6466 5b6d  sums[idx] = df[m
+0003fbc0: 6173 6b5d 2e73 756d 2829 2e76 616c 7565  ask].sum().value
+0003fbd0: 730a 2020 2020 2020 2020 636f 756e 7473  s.        counts
+0003fbe0: 5b69 6478 5d20 3d20 6466 5b6d 6173 6b5d  [idx] = df[mask]
+0003fbf0: 2e63 6f75 6e74 2829 2e76 616c 7565 730a  .count().values.
+0003fc00: 2020 2020 2320 5370 6563 6961 6c20 6361      # Special ca
+0003fc10: 7365 2073 696e 676c 652d 726f 7720 4461  se single-row Da
+0003fc20: 7461 4672 616d 6520 636f 7620 746f 2061  taFrame cov to a
+0003fc30: 766f 6964 2077 6172 6e69 6e67 7320 6672  void warnings fr
+0003fc40: 6f6d 2070 616e 6461 732e 0a20 2020 2069  om pandas..    i
+0003fc50: 6620 6466 2e73 6861 7065 5b30 5d20 3d3d  f df.shape[0] ==
+0003fc60: 2031 3a0a 2020 2020 2020 2020 636f 7620   1:.        cov 
+0003fc70: 3d20 6e70 2e66 756c 6c5f 6c69 6b65 2873  = np.full_like(s
+0003fc80: 756d 732c 206e 702e 6e61 6e29 2020 2320  ums, np.nan)  # 
+0003fc90: 616c 7761 7973 2061 6e20 616c 6c20 6e61  always an all na
+0003fca0: 6e20 7265 7375 6c74 0a20 2020 2065 6c73  n result.    els
+0003fcb0: 653a 0a20 2020 2020 2020 2063 6f76 203d  e:.        cov =
+0003fcc0: 2064 662e 636f 7628 292e 7661 6c75 6573   df.cov().values
+0003fcd0: 0a20 2020 2064 7479 7065 203d 205b 2822  .    dtype = [("
+0003fce0: 7375 6d22 2c20 7375 6d73 2e64 7479 7065  sum", sums.dtype
+0003fcf0: 292c 2028 2263 6f75 6e74 222c 2063 6f75  ), ("count", cou
+0003fd00: 6e74 732e 6474 7970 6529 2c20 2822 636f  nts.dtype), ("co
+0003fd10: 7622 2c20 636f 762e 6474 7970 6529 5d0a  v", cov.dtype)].
+0003fd20: 2020 2020 6966 2063 6f72 723a 0a20 2020      if corr:.   
+0003fd30: 2020 2020 2077 6974 6820 7761 726e 696e       with warnin
+0003fd40: 6773 2e63 6174 6368 5f77 6172 6e69 6e67  gs.catch_warning
+0003fd50: 7328 7265 636f 7264 3d54 7275 6529 3a0a  s(record=True):.
+0003fd60: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+0003fd70: 696e 6773 2e73 696d 706c 6566 696c 7465  ings.simplefilte
+0003fd80: 7228 2261 6c77 6179 7322 290a 2020 2020  r("always").    
+0003fd90: 2020 2020 2020 2020 6d75 203d 2028 7375          mu = (su
+0003fda0: 6d73 202f 2063 6f75 6e74 7329 2e54 0a20  ms / counts).T. 
+0003fdb0: 2020 2020 2020 206d 203d 206e 702e 7a65         m = np.ze
+0003fdc0: 726f 735f 6c69 6b65 2864 662e 7661 6c75  ros_like(df.valu
+0003fdd0: 6573 2c20 7368 6170 653d 7368 6170 6529  es, shape=shape)
+0003fde0: 0a20 2020 2020 2020 206d 6173 6b20 3d20  .        mask = 
+0003fdf0: 6466 2e69 736e 756c 6c28 292e 7661 6c75  df.isnull().valu
+0003fe00: 6573 0a20 2020 2020 2020 2066 6f72 2069  es.        for i
+0003fe10: 6478 2069 6e20 7261 6e67 6528 6c65 6e28  dx in range(len(
+0003fe20: 6466 2e63 6f6c 756d 6e73 2929 3a0a 2020  df.columns)):.  
+0003fe30: 2020 2020 2020 2020 2020 2320 4176 6f69            # Avoi
+0003fe40: 6420 7573 696e 6720 7566 756e 632e 6f75  d using ufunc.ou
+0003fe50: 7465 7220 286e 6f74 2073 7570 706f 7274  ter (not support
+0003fe60: 6564 2062 7920 6375 7079 290a 2020 2020  ed by cupy).    
+0003fe70: 2020 2020 2020 2020 6d75 5f64 6973 6372          mu_discr
+0003fe80: 6570 616e 6379 203d 2028 0a20 2020 2020  epancy = (.     
+0003fe90: 2020 2020 2020 2020 2020 206e 702e 7375             np.su
+0003fea0: 6274 7261 6374 2864 662e 696c 6f63 5b3a  btract(df.iloc[:
+0003feb0: 2c20 6964 785d 2e76 616c 7565 735b 3a2c  , idx].values[:,
+0003fec0: 204e 6f6e 655d 2c20 6d75 5b69 6478 5d5b   None], mu[idx][
+0003fed0: 4e6f 6e65 2c20 3a5d 2920 2a2a 2032 0a20  None, :]) ** 2. 
+0003fee0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0003fef0: 2020 2020 2020 2020 206d 755f 6469 7363           mu_disc
+0003ff00: 7265 7061 6e63 795b 6d61 736b 5d20 3d20  repancy[mask] = 
+0003ff10: 6e70 2e6e 616e 0a20 2020 2020 2020 2020  np.nan.         
+0003ff20: 2020 206d 5b69 6478 5d20 3d20 6e70 2e6e     m[idx] = np.n
+0003ff30: 616e 7375 6d28 6d75 5f64 6973 6372 6570  ansum(mu_discrep
+0003ff40: 616e 6379 2c20 6178 6973 3d30 290a 2020  ancy, axis=0).  
+0003ff50: 2020 2020 2020 6d20 3d20 6d2e 540a 2020        m = m.T.  
+0003ff60: 2020 2020 2020 6474 7970 652e 6170 7065        dtype.appe
+0003ff70: 6e64 2828 226d 222c 206d 2e64 7479 7065  nd(("m", m.dtype
+0003ff80: 2929 0a0a 2020 2020 6f75 7420 3d20 7b22  ))..    out = {"
+0003ff90: 7375 6d22 3a20 7375 6d73 2c20 2263 6f75  sum": sums, "cou
+0003ffa0: 6e74 223a 2063 6f75 6e74 732c 2022 636f  nt": counts, "co
+0003ffb0: 7622 3a20 636f 7620 2a20 2863 6f75 6e74  v": cov * (count
+0003ffc0: 7320 2d20 3129 7d0a 2020 2020 6966 2063  s - 1)}.    if c
+0003ffd0: 6f72 723a 0a20 2020 2020 2020 206f 7574  orr:.        out
+0003ffe0: 5b22 6d22 5d20 3d20 6d0a 2020 2020 7265  ["m"] = m.    re
+0003fff0: 7475 726e 206f 7574 0a0a 0a64 6566 205f  turn out...def _
+00040000: 636f 765f 636f 7272 5f63 6f6d 6269 6e65  cov_corr_combine
+00040010: 2864 6174 615f 696e 2c20 636f 7272 3d46  (data_in, corr=F
+00040020: 616c 7365 293a 0a20 2020 2064 6174 6120  alse):.    data 
+00040030: 3d20 7b22 7375 6d22 3a20 4e6f 6e65 2c20  = {"sum": None, 
+00040040: 2263 6f75 6e74 223a 204e 6f6e 652c 2022  "count": None, "
+00040050: 636f 7622 3a20 4e6f 6e65 7d0a 2020 2020  cov": None}.    
+00040060: 6966 2063 6f72 723a 0a20 2020 2020 2020  if corr:.       
+00040070: 2064 6174 615b 226d 225d 203d 204e 6f6e   data["m"] = Non
+00040080: 650a 0a20 2020 2066 6f72 206b 2069 6e20  e..    for k in 
+00040090: 6461 7461 2e6b 6579 7328 293a 0a20 2020  data.keys():.   
+000400a0: 2020 2020 2064 6174 615b 6b5d 203d 205b       data[k] = [
+000400b0: 645b 6b5d 2066 6f72 2064 2069 6e20 6461  d[k] for d in da
+000400c0: 7461 5f69 6e5d 0a20 2020 2020 2020 2064  ta_in].        d
+000400d0: 6174 615b 6b5d 203d 206e 702e 636f 6e63  ata[k] = np.conc
+000400e0: 6174 656e 6174 6528 6461 7461 5b6b 5d29  atenate(data[k])
+000400f0: 2e72 6573 6861 7065 2828 6c65 6e28 6461  .reshape((len(da
+00040100: 7461 5b6b 5d29 2c29 202b 2064 6174 615b  ta[k]),) + data[
+00040110: 6b5d 5b30 5d2e 7368 6170 6529 0a0a 2020  k][0].shape)..  
+00040120: 2020 7375 6d73 203d 206e 702e 6e61 6e5f    sums = np.nan_
+00040130: 746f 5f6e 756d 2864 6174 615b 2273 756d  to_num(data["sum
+00040140: 225d 290a 2020 2020 636f 756e 7473 203d  "]).    counts =
+00040150: 2064 6174 615b 2263 6f75 6e74 225d 0a0a   data["count"]..
+00040160: 2020 2020 6375 6d5f 7375 6d73 203d 206e      cum_sums = n
+00040170: 702e 6375 6d73 756d 2873 756d 732c 2030  p.cumsum(sums, 0
+00040180: 290a 2020 2020 6375 6d5f 636f 756e 7473  ).    cum_counts
+00040190: 203d 206e 702e 6375 6d73 756d 2863 6f75   = np.cumsum(cou
+000401a0: 6e74 732c 2030 290a 0a20 2020 2073 3120  nts, 0)..    s1 
+000401b0: 3d20 6375 6d5f 7375 6d73 5b3a 2d31 5d0a  = cum_sums[:-1].
+000401c0: 2020 2020 7332 203d 2073 756d 735b 313a      s2 = sums[1:
+000401d0: 5d0a 2020 2020 6e31 203d 2063 756d 5f63  ].    n1 = cum_c
+000401e0: 6f75 6e74 735b 3a2d 315d 0a20 2020 206e  ounts[:-1].    n
+000401f0: 3220 3d20 636f 756e 7473 5b31 3a5d 0a20  2 = counts[1:]. 
+00040200: 2020 2077 6974 6820 6e70 2e65 7272 7374     with np.errst
+00040210: 6174 6528 696e 7661 6c69 643d 2269 676e  ate(invalid="ign
+00040220: 6f72 6522 293a 0a20 2020 2020 2020 2064  ore"):.        d
+00040230: 203d 2028 7332 202f 206e 3229 202d 2028   = (s2 / n2) - (
+00040240: 7331 202f 206e 3129 0a20 2020 2020 2020  s1 / n1).       
+00040250: 2043 203d 206e 702e 6e61 6e73 756d 280a   C = np.nansum(.
+00040260: 2020 2020 2020 2020 2020 2020 286e 3120              (n1 
+00040270: 2a20 6e32 2920 2f20 286e 3120 2b20 6e32  * n2) / (n1 + n2
+00040280: 2920 2a20 2864 202a 2064 2e74 7261 6e73  ) * (d * d.trans
+00040290: 706f 7365 2828 302c 2032 2c20 3129 2929  pose((0, 2, 1)))
+000402a0: 2c20 300a 2020 2020 2020 2020 2920 2b20  , 0.        ) + 
+000402b0: 6e70 2e6e 616e 7375 6d28 6461 7461 5b22  np.nansum(data["
+000402c0: 636f 7622 5d2c 2030 290a 0a20 2020 206f  cov"], 0)..    o
+000402d0: 7574 203d 207b 2273 756d 223a 2063 756d  ut = {"sum": cum
+000402e0: 5f73 756d 735b 2d31 5d2c 2022 636f 756e  _sums[-1], "coun
+000402f0: 7422 3a20 6375 6d5f 636f 756e 7473 5b2d  t": cum_counts[-
+00040300: 315d 2c20 2263 6f76 223a 2043 7d0a 0a20  1], "cov": C}.. 
+00040310: 2020 2069 6620 636f 7272 3a0a 2020 2020     if corr:.    
+00040320: 2020 2020 6e6f 6273 203d 206e 702e 7768      nobs = np.wh
+00040330: 6572 6528 6375 6d5f 636f 756e 7473 5b2d  ere(cum_counts[-
+00040340: 315d 2c20 6375 6d5f 636f 756e 7473 5b2d  1], cum_counts[-
+00040350: 315d 2c20 6e70 2e6e 616e 290a 2020 2020  1], np.nan).    
+00040360: 2020 2020 6d75 203d 2063 756d 5f73 756d      mu = cum_sum
+00040370: 735b 2d31 5d20 2f20 6e6f 6273 0a20 2020  s[-1] / nobs.   
+00040380: 2020 2020 2063 6f75 6e74 735f 6e61 203d       counts_na =
+00040390: 206e 702e 7768 6572 6528 636f 756e 7473   np.where(counts
+000403a0: 2c20 636f 756e 7473 2c20 6e70 2e6e 616e  , counts, np.nan
+000403b0: 290a 2020 2020 2020 2020 6d20 3d20 6e70  ).        m = np
+000403c0: 2e6e 616e 7375 6d28 6461 7461 5b22 6d22  .nansum(data["m"
+000403d0: 5d20 2b20 636f 756e 7473 202a 2028 7375  ] + counts * (su
+000403e0: 6d73 202f 2063 6f75 6e74 735f 6e61 202d  ms / counts_na -
+000403f0: 206d 7529 202a 2a20 322c 2061 7869 733d   mu) ** 2, axis=
+00040400: 3029 0a20 2020 2020 2020 206f 7574 5b22  0).        out["
+00040410: 6d22 5d20 3d20 6d0a 2020 2020 7265 7475  m"] = m.    retu
+00040420: 726e 206f 7574 0a0a 0a64 6566 205f 636f  rn out...def _co
+00040430: 765f 636f 7272 5f61 6767 2864 6174 612c  v_corr_agg(data,
+00040440: 2063 6f6c 732c 206d 696e 5f70 6572 696f   cols, min_perio
+00040450: 6473 3d32 2c20 636f 7272 3d46 616c 7365  ds=2, corr=False
+00040460: 2c20 7363 616c 6172 3d46 616c 7365 2c20  , scalar=False, 
+00040470: 6c69 6b65 5f64 663d 4e6f 6e65 293a 0a20  like_df=None):. 
+00040480: 2020 206f 7574 203d 205f 636f 765f 636f     out = _cov_co
+00040490: 7272 5f63 6f6d 6269 6e65 2864 6174 612c  rr_combine(data,
+000404a0: 2063 6f72 7229 0a20 2020 2063 6f75 6e74   corr).    count
+000404b0: 7320 3d20 6f75 745b 2263 6f75 6e74 225d  s = out["count"]
+000404c0: 0a20 2020 2043 203d 206f 7574 5b22 636f  .    C = out["co
+000404d0: 7622 5d0a 2020 2020 435b 636f 756e 7473  v"].    C[counts
+000404e0: 203c 206d 696e 5f70 6572 696f 6473 5d20   < min_periods] 
+000404f0: 3d20 6e70 2e6e 616e 0a20 2020 2069 6620  = np.nan.    if 
+00040500: 636f 7272 3a0a 2020 2020 2020 2020 6d32  corr:.        m2
+00040510: 203d 206f 7574 5b22 6d22 5d0a 2020 2020   = out["m"].    
+00040520: 2020 2020 6465 6e20 3d20 6e70 2e73 7172      den = np.sqr
+00040530: 7428 6d32 202a 206d 322e 5429 0a20 2020  t(m2 * m2.T).   
+00040540: 2065 6c73 653a 0a20 2020 2020 2020 2064   else:.        d
+00040550: 656e 203d 206e 702e 7768 6572 6528 636f  en = np.where(co
+00040560: 756e 7473 2c20 636f 756e 7473 2c20 6e70  unts, counts, np
+00040570: 2e6e 616e 2920 2d20 310a 2020 2020 7769  .nan) - 1.    wi
+00040580: 7468 206e 702e 6572 7273 7461 7465 2869  th np.errstate(i
+00040590: 6e76 616c 6964 3d22 6967 6e6f 7265 222c  nvalid="ignore",
+000405a0: 2064 6976 6964 653d 2269 676e 6f72 6522   divide="ignore"
+000405b0: 293a 0a20 2020 2020 2020 206d 6174 203d  ):.        mat =
+000405c0: 2043 202f 2064 656e 0a20 2020 2069 6620   C / den.    if 
+000405d0: 7363 616c 6172 3a0a 2020 2020 2020 2020  scalar:.        
+000405e0: 7265 7475 726e 2066 6c6f 6174 286d 6174  return float(mat
+000405f0: 5b30 2c20 315d 290a 2020 2020 7265 7475  [0, 1]).    retu
+00040600: 726e 2028 7064 2e44 6174 6146 7261 6d65  rn (pd.DataFrame
+00040610: 2069 6620 6c69 6b65 5f64 6620 6973 204e   if like_df is N
+00040620: 6f6e 6520 656c 7365 206d 6574 615f 6672  one else meta_fr
+00040630: 616d 655f 636f 6e73 7472 7563 746f 7228  ame_constructor(
+00040640: 6c69 6b65 5f64 6629 2928 0a20 2020 2020  like_df))(.     
+00040650: 2020 206d 6174 2c20 636f 6c75 6d6e 733d     mat, columns=
+00040660: 636f 6c73 2c20 696e 6465 783d 636f 6c73  cols, index=cols
+00040670: 0a20 2020 2029 0a0a 0a64 6566 2070 645f  .    )...def pd_
+00040680: 7370 6c69 7428 6466 2c20 702c 2072 616e  split(df, p, ran
+00040690: 646f 6d5f 7374 6174 653d 4e6f 6e65 2c20  dom_state=None, 
+000406a0: 7368 7566 666c 653d 4661 6c73 6529 3a0a  shuffle=False):.
+000406b0: 2020 2020 2222 2253 706c 6974 2044 6174      """Split Dat
+000406c0: 6146 7261 6d65 2069 6e74 6f20 6d75 6c74  aFrame into mult
+000406d0: 6970 6c65 2070 6965 6365 7320 7073 6575  iple pieces pseu
+000406e0: 646f 7261 6e64 6f6d 6c79 0a0a 2020 2020  dorandomly..    
+000406f0: 3e3e 3e20 6466 203d 2070 642e 4461 7461  >>> df = pd.Data
+00040700: 4672 616d 6528 7b27 6127 3a20 5b31 2c20  Frame({'a': [1, 
+00040710: 322c 2033 2c20 342c 2035 2c20 365d 2c0a  2, 3, 4, 5, 6],.
+00040720: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00040730: 2020 2020 2020 2020 2020 2027 6227 3a20             'b': 
+00040740: 5b32 2c20 332c 2034 2c20 352c 2036 2c20  [2, 3, 4, 5, 6, 
+00040750: 375d 7d29 0a0a 2020 2020 3e3e 3e20 612c  7]})..    >>> a,
+00040760: 2062 203d 2070 645f 7370 6c69 7428 0a20   b = pd_split(. 
+00040770: 2020 202e 2e2e 2020 2020 2064 662c 205b     ...     df, [
+00040780: 302e 352c 2030 2e35 5d2c 2072 616e 646f  0.5, 0.5], rando
+00040790: 6d5f 7374 6174 653d 3132 332c 2073 6875  m_state=123, shu
+000407a0: 6666 6c65 3d54 7275 650a 2020 2020 2e2e  ffle=True.    ..
+000407b0: 2e20 2920 2023 2072 6f75 6768 6c79 2035  . )  # roughly 5
+000407c0: 302f 3530 2073 706c 6974 0a20 2020 203e  0/50 split.    >
+000407d0: 3e3e 2061 0a20 2020 2020 2020 6120 2062  >> a.       a  b
+000407e0: 0a20 2020 2033 2020 3420 2035 0a20 2020  .    3  4  5.   
+000407f0: 2030 2020 3120 2032 0a20 2020 2035 2020   0  1  2.    5  
+00040800: 3620 2037 0a20 2020 203e 3e3e 2062 0a20  6  7.    >>> b. 
+00040810: 2020 2020 2020 6120 2062 0a20 2020 2031        a  b.    1
+00040820: 2020 3220 2033 0a20 2020 2034 2020 3520    2  3.    4  5 
+00040830: 2036 0a20 2020 2032 2020 3320 2034 0a20   6.    2  3  4. 
+00040840: 2020 2022 2222 0a20 2020 2070 203d 206c     """.    p = l
+00040850: 6973 7428 7029 0a20 2020 2069 6620 7368  ist(p).    if sh
+00040860: 7566 666c 653a 0a20 2020 2020 2020 2069  uffle:.        i
+00040870: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00040880: 2872 616e 646f 6d5f 7374 6174 652c 206e  (random_state, n
+00040890: 702e 7261 6e64 6f6d 2e52 616e 646f 6d53  p.random.RandomS
+000408a0: 7461 7465 293a 0a20 2020 2020 2020 2020  tate):.         
+000408b0: 2020 2072 616e 646f 6d5f 7374 6174 6520     random_state 
+000408c0: 3d20 6e70 2e72 616e 646f 6d2e 5261 6e64  = np.random.Rand
+000408d0: 6f6d 5374 6174 6528 7261 6e64 6f6d 5f73  omState(random_s
+000408e0: 7461 7465 290a 2020 2020 2020 2020 6466  tate).        df
+000408f0: 203d 2064 662e 7361 6d70 6c65 2866 7261   = df.sample(fra
+00040900: 633d 312e 302c 2072 616e 646f 6d5f 7374  c=1.0, random_st
+00040910: 6174 653d 7261 6e64 6f6d 5f73 7461 7465  ate=random_state
+00040920: 290a 2020 2020 696e 6465 7820 3d20 7073  ).    index = ps
+00040930: 6575 646f 7261 6e64 6f6d 286c 656e 2864  eudorandom(len(d
+00040940: 6629 2c20 702c 2072 616e 646f 6d5f 7374  f), p, random_st
+00040950: 6174 6529 0a20 2020 2072 6574 7572 6e20  ate).    return 
+00040960: 5b64 662e 696c 6f63 5b69 6e64 6578 203d  [df.iloc[index =
+00040970: 3d20 695d 2066 6f72 2069 2069 6e20 7261  = i] for i in ra
+00040980: 6e67 6528 6c65 6e28 7029 295d 0a0a 0a64  nge(len(p))]...d
+00040990: 6566 205f 7461 6b65 5f6c 6173 7428 612c  ef _take_last(a,
+000409a0: 2073 6b69 706e 613d 5472 7565 293a 0a20   skipna=True):. 
+000409b0: 2020 2022 2222 0a20 2020 2074 616b 6520     """.    take 
+000409c0: 6c61 7374 2072 6f77 2028 5365 7269 6573  last row (Series
+000409d0: 2920 6f66 2044 6174 6146 7261 6d65 202f  ) of DataFrame /
+000409e0: 206c 6173 7420 7661 6c75 6520 6f66 2053   last value of S
+000409f0: 6572 6965 730a 2020 2020 636f 6e73 6964  eries.    consid
+00040a00: 6572 696e 6720 4e61 4e2e 0a0a 2020 2020  ering NaN...    
+00040a10: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
+00040a20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6120  ---------.    a 
+00040a30: 3a20 7064 2e44 6174 6146 7261 6d65 206f  : pd.DataFrame o
+00040a40: 7220 7064 2e53 6572 6965 730a 2020 2020  r pd.Series.    
+00040a50: 736b 6970 6e61 203a 2062 6f6f 6c2c 2064  skipna : bool, d
+00040a60: 6566 6175 6c74 2054 7275 650a 2020 2020  efault True.    
+00040a70: 2020 2020 5768 6574 6865 7220 746f 2065      Whether to e
+00040a80: 7863 6c75 6465 204e 614e 0a0a 2020 2020  xclude NaN..    
+00040a90: 2222 220a 0a20 2020 2064 6566 205f 6c61  """..    def _la
+00040aa0: 7374 5f76 616c 6964 2873 293a 0a20 2020  st_valid(s):.   
+00040ab0: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00040ac0: 6e67 6528 312c 206d 696e 2831 302c 206c  nge(1, min(10, l
+00040ad0: 656e 2873 2920 2b20 3129 293a 0a20 2020  en(s) + 1)):.   
+00040ae0: 2020 2020 2020 2020 2076 616c 203d 2073           val = s
+00040af0: 2e69 6c6f 635b 2d69 5d0a 2020 2020 2020  .iloc[-i].      
+00040b00: 2020 2020 2020 6966 206e 6f74 2070 642e        if not pd.
+00040b10: 6973 6e75 6c6c 2876 616c 293a 0a20 2020  isnull(val):.   
+00040b20: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00040b30: 7572 6e20 7661 6c0a 2020 2020 2020 2020  urn val.        
+00040b40: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00040b50: 2020 6e6f 6e6e 756c 6c20 3d20 735b 732e    nonnull = s[s.
+00040b60: 6e6f 746e 6128 295d 0a20 2020 2020 2020  notna()].       
+00040b70: 2020 2020 2069 6620 6e6f 7420 6e6f 6e6e       if not nonn
+00040b80: 756c 6c2e 656d 7074 793a 0a20 2020 2020  ull.empty:.     
+00040b90: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00040ba0: 6e20 6e6f 6e6e 756c 6c2e 696c 6f63 5b2d  n nonnull.iloc[-
+00040bb0: 315d 0a20 2020 2020 2020 2072 6574 7572  1].        retur
+00040bc0: 6e20 4e6f 6e65 0a0a 2020 2020 6966 2073  n None..    if s
+00040bd0: 6b69 706e 6120 6973 2046 616c 7365 3a0a  kipna is False:.
+00040be0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00040bf0: 2e69 6c6f 635b 2d31 5d0a 2020 2020 656c  .iloc[-1].    el
+00040c00: 7365 3a0a 2020 2020 2020 2020 2320 7461  se:.        # ta
+00040c10: 6b65 206c 6173 7420 7661 6c69 6420 7661  ke last valid va
+00040c20: 6c75 6520 6578 636c 7564 696e 6720 4e61  lue excluding Na
+00040c30: 4e2c 204e 614e 206c 6f63 6174 696f 6e20  N, NaN location 
+00040c40: 6d61 7920 6265 2064 6966 6665 7265 6e74  may be different
+00040c50: 0a20 2020 2020 2020 2023 2069 6e20 6561  .        # in ea
+00040c60: 6368 2063 6f6c 756d 6e0a 2020 2020 2020  ch column.      
+00040c70: 2020 6966 2069 735f 6461 7461 6672 616d    if is_datafram
+00040c80: 655f 6c69 6b65 2861 293a 0a20 2020 2020  e_like(a):.     
+00040c90: 2020 2020 2020 2023 2063 7265 6174 6520         # create 
+00040ca0: 5365 7269 6573 2066 726f 6d20 6170 7072  Series from appr
+00040cb0: 6f70 7269 6174 6520 6261 636b 656e 6420  opriate backend 
+00040cc0: 6461 7461 6672 616d 6520 6c69 6272 6172  dataframe librar
+00040cd0: 790a 2020 2020 2020 2020 2020 2020 7365  y.            se
+00040ce0: 7269 6573 5f74 7970 203d 2074 7970 6528  ries_typ = type(
+00040cf0: 612e 696c 6f63 5b30 3a31 2c20 305d 290a  a.iloc[0:1, 0]).
+00040d00: 2020 2020 2020 2020 2020 2020 6966 2061              if a
+00040d10: 2e65 6d70 7479 3a0a 2020 2020 2020 2020  .empty:.        
+00040d20: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00040d30: 6572 6965 735f 7479 7028 5b5d 2c20 6474  eries_typ([], dt
+00040d40: 7970 653d 2266 6c6f 6174 2229 0a20 2020  ype="float").   
+00040d50: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00040d60: 7365 7269 6573 5f74 7970 280a 2020 2020  series_typ(.    
+00040d70: 2020 2020 2020 2020 2020 2020 5b5f 6c61              [_la
+00040d80: 7374 5f76 616c 6964 2861 2e69 6c6f 635b  st_valid(a.iloc[
+00040d90: 3a2c 2069 5d29 2066 6f72 2069 2069 6e20  :, i]) for i in 
+00040da0: 7261 6e67 6528 6c65 6e28 612e 636f 6c75  range(len(a.colu
+00040db0: 6d6e 7329 295d 2c0a 2020 2020 2020 2020  mns))],.        
+00040dc0: 2020 2020 2020 2020 696e 6465 783d 612e          index=a.
+00040dd0: 636f 6c75 6d6e 732c 0a20 2020 2020 2020  columns,.       
+00040de0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00040df0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00040e00: 2072 6574 7572 6e20 5f6c 6173 745f 7661   return _last_va
+00040e10: 6c69 6428 6129 0a0a 0a64 6566 2063 6865  lid(a)...def che
+00040e20: 636b 5f64 6976 6973 696f 6e73 2864 6976  ck_divisions(div
+00040e30: 6973 696f 6e73 293a 0a20 2020 2069 6620  isions):.    if 
+00040e40: 6e6f 7420 6973 696e 7374 616e 6365 2864  not isinstance(d
+00040e50: 6976 6973 696f 6e73 2c20 286c 6973 742c  ivisions, (list,
+00040e60: 2074 7570 6c65 2929 3a0a 2020 2020 2020   tuple)):.      
+00040e70: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00040e80: 6f72 2822 4e65 7720 6469 7669 7369 6f6e  or("New division
+00040e90: 206d 7573 7420 6265 206c 6973 7420 6f72   must be list or
+00040ea0: 2074 7570 6c65 2229 0a20 2020 2064 6976   tuple").    div
+00040eb0: 6973 696f 6e73 203d 206c 6973 7428 6469  isions = list(di
+00040ec0: 7669 7369 6f6e 7329 0a20 2020 2069 6620  visions).    if 
+00040ed0: 6c65 6e28 6469 7669 7369 6f6e 7329 203d  len(divisions) =
+00040ee0: 3d20 303a 0a20 2020 2020 2020 2072 6169  = 0:.        rai
+00040ef0: 7365 2056 616c 7565 4572 726f 7228 224e  se ValueError("N
+00040f00: 6577 2064 6976 6973 696f 6e20 6d75 7374  ew division must
+00040f10: 206e 6f74 2062 6520 656d 7074 7922 290a   not be empty").
+00040f20: 2020 2020 6966 2064 6976 6973 696f 6e73      if divisions
+00040f30: 2021 3d20 736f 7274 6564 2864 6976 6973   != sorted(divis
+00040f40: 696f 6e73 293a 0a20 2020 2020 2020 2072  ions):.        r
+00040f50: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00040f60: 224e 6577 2064 6976 6973 696f 6e20 6d75  "New division mu
+00040f70: 7374 2062 6520 736f 7274 6564 2229 0a20  st be sorted"). 
+00040f80: 2020 2069 6620 6c65 6e28 6469 7669 7369     if len(divisi
+00040f90: 6f6e 735b 3a2d 315d 2920 213d 206c 656e  ons[:-1]) != len
+00040fa0: 286c 6973 7428 756e 6971 7565 2864 6976  (list(unique(div
+00040fb0: 6973 696f 6e73 5b3a 2d31 5d29 2929 3a0a  isions[:-1]))):.
+00040fc0: 2020 2020 2020 2020 6d73 6720 3d20 224e          msg = "N
+00040fd0: 6577 2064 6976 6973 696f 6e20 6d75 7374  ew division must
+00040fe0: 2062 6520 756e 6971 7565 2c20 6578 6365   be unique, exce
+00040ff0: 7074 2066 6f72 2074 6865 206c 6173 7420  pt for the last 
+00041000: 656c 656d 656e 7422 0a20 2020 2020 2020  element".       
+00041010: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00041020: 7228 6d73 6729 0a0a 0a64 6566 2072 6570  r(msg)...def rep
+00041030: 6172 7469 7469 6f6e 5f64 6976 6973 696f  artition_divisio
+00041040: 6e73 2861 2c20 622c 206e 616d 652c 206f  ns(a, b, name, o
+00041050: 7574 312c 206f 7574 322c 2066 6f72 6365  ut1, out2, force
+00041060: 3d46 616c 7365 293a 0a20 2020 2022 2222  =False):.    """
+00041070: 6461 736b 2067 7261 7068 2074 6f20 7265  dask graph to re
+00041080: 7061 7274 6974 696f 6e20 6461 7461 6672  partition datafr
+00041090: 616d 6520 6279 206e 6577 2064 6976 6973  ame by new divis
+000410a0: 696f 6e73 0a0a 2020 2020 5061 7261 6d65  ions..    Parame
+000410b0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+000410c0: 2d2d 2d0a 2020 2020 6120 3a20 7475 706c  ---.    a : tupl
+000410d0: 650a 2020 2020 2020 2020 6f6c 6420 6469  e.        old di
+000410e0: 7669 7369 6f6e 730a 2020 2020 6220 3a20  visions.    b : 
+000410f0: 7475 706c 652c 206c 6973 746d 7970 790a  tuple, listmypy.
+00041100: 2020 2020 6f75 7432 203a 2073 7472 0a20      out2 : str. 
+00041110: 2020 2020 2020 206e 616d 6520 6f66 206e         name of n
+00041120: 6577 2064 6174 6166 7261 6d65 0a20 2020  ew dataframe.   
+00041130: 2066 6f72 6365 203a 2062 6f6f 6c2c 2064   force : bool, d
+00041140: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+00041150: 2020 2020 2041 6c6c 6f77 7320 7468 6520       Allows the 
+00041160: 6578 7061 6e73 696f 6e20 6f66 2074 6865  expansion of the
+00041170: 2065 7869 7374 696e 6720 6469 7669 7369   existing divisi
+00041180: 6f6e 732e 0a20 2020 2020 2020 2049 6620  ons..        If 
+00041190: 4661 6c73 6520 7468 656e 2074 6865 206e  False then the n
+000411a0: 6577 2064 6976 6973 696f 6e73 206c 6f77  ew divisions low
+000411b0: 6572 2061 6e64 2075 7070 6572 2062 6f75  er and upper bou
+000411c0: 6e64 7320 6d75 7374 2062 650a 2020 2020  nds must be.    
+000411d0: 2020 2020 7468 6520 7361 6d65 2061 7320      the same as 
+000411e0: 7468 6520 6f6c 6420 6469 7669 7369 6f6e  the old division
+000411f0: 732e 0a0a 2020 2020 4578 616d 706c 6573  s...    Examples
+00041200: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
+00041210: 2020 3e3e 3e20 6672 6f6d 2070 7072 696e    >>> from pprin
+00041220: 7420 696d 706f 7274 2070 7072 696e 740a  t import pprint.
+00041230: 2020 2020 3e3e 3e20 7070 7269 6e74 2872      >>> pprint(r
+00041240: 6570 6172 7469 7469 6f6e 5f64 6976 6973  epartition_divis
+00041250: 696f 6e73 285b 312c 2033 2c20 375d 2c20  ions([1, 3, 7], 
+00041260: 5b31 2c20 342c 2036 2c20 375d 2c20 2761  [1, 4, 6, 7], 'a
+00041270: 272c 2027 6227 2c20 2763 2729 2920 2023  ', 'b', 'c'))  #
+00041280: 2064 6f63 7465 7374 3a20 2b45 4c4c 4950   doctest: +ELLIP
+00041290: 5349 530a 2020 2020 7b28 2762 272c 2030  SIS.    {('b', 0
+000412a0: 293a 2028 3c66 756e 6374 696f 6e20 626f  ): (<function bo
+000412b0: 756e 6461 7279 5f73 6c69 6365 2061 7420  undary_slice at 
+000412c0: 2e2e 2e3e 2c20 2827 6127 2c20 3029 2c20  ...>, ('a', 0), 
+000412d0: 312c 2033 2c20 4661 6c73 6529 2c0a 2020  1, 3, False),.  
+000412e0: 2020 2028 2762 272c 2031 293a 2028 3c66     ('b', 1): (<f
+000412f0: 756e 6374 696f 6e20 626f 756e 6461 7279  unction boundary
+00041300: 5f73 6c69 6365 2061 7420 2e2e 2e3e 2c20  _slice at ...>, 
+00041310: 2827 6127 2c20 3129 2c20 332c 2034 2c20  ('a', 1), 3, 4, 
+00041320: 4661 6c73 6529 2c0a 2020 2020 2028 2762  False),.     ('b
+00041330: 272c 2032 293a 2028 3c66 756e 6374 696f  ', 2): (<functio
+00041340: 6e20 626f 756e 6461 7279 5f73 6c69 6365  n boundary_slice
+00041350: 2061 7420 2e2e 2e3e 2c20 2827 6127 2c20   at ...>, ('a', 
+00041360: 3129 2c20 342c 2036 2c20 4661 6c73 6529  1), 4, 6, False)
+00041370: 2c0a 2020 2020 2028 2762 272c 2033 293a  ,.     ('b', 3):
+00041380: 2028 3c66 756e 6374 696f 6e20 626f 756e   (<function boun
+00041390: 6461 7279 5f73 6c69 6365 2061 7420 2e2e  dary_slice at ..
+000413a0: 2e3e 2c20 2827 6127 2c20 3129 2c20 362c  .>, ('a', 1), 6,
+000413b0: 2037 2c20 5472 7565 292c 0a20 2020 2020   7, True),.     
+000413c0: 2827 6327 2c20 3029 3a20 283c 6675 6e63  ('c', 0): (<func
+000413d0: 7469 6f6e 2063 6f6e 6361 7420 6174 202e  tion concat at .
+000413e0: 2e2e 3e2c 205b 2827 6227 2c20 3029 2c20  ..>, [('b', 0), 
+000413f0: 2827 6227 2c20 3129 5d29 2c0a 2020 2020  ('b', 1)]),.    
+00041400: 2028 2763 272c 2031 293a 2028 2762 272c   ('c', 1): ('b',
+00041410: 2032 292c 0a20 2020 2020 2827 6327 2c20   2),.     ('c', 
+00041420: 3229 3a20 2827 6227 2c20 3329 7d0a 2020  2): ('b', 3)}.  
+00041430: 2020 2222 220a 2020 2020 6368 6563 6b5f    """.    check_
+00041440: 6469 7669 7369 6f6e 7328 6229 0a0a 2020  divisions(b)..  
+00041450: 2020 6966 206c 656e 2862 2920 3c20 323a    if len(b) < 2:
+00041460: 0a20 2020 2020 2020 2023 206d 696e 696d  .        # minim
+00041470: 756d 2064 6976 6973 696f 6e20 6973 2032  um division is 2
+00041480: 2065 6c65 6d65 6e74 732c 206c 696b 6520   elements, like 
+00041490: 5b30 2c20 305d 0a20 2020 2020 2020 2072  [0, 0].        r
+000414a0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+000414b0: 224e 6577 2064 6976 6973 696f 6e20 6d75  "New division mu
+000414c0: 7374 2062 6520 6c6f 6e67 6572 2074 6861  st be longer tha
+000414d0: 6e20 3220 656c 656d 656e 7473 2229 0a0a  n 2 elements")..
+000414e0: 2020 2020 6966 2066 6f72 6365 3a0a 2020      if force:.  
+000414f0: 2020 2020 2020 6966 2061 5b30 5d20 3c20        if a[0] < 
+00041500: 625b 305d 3a0a 2020 2020 2020 2020 2020  b[0]:.          
+00041510: 2020 6d73 6720 3d20 280a 2020 2020 2020    msg = (.      
+00041520: 2020 2020 2020 2020 2020 226c 6566 7420            "left 
+00041530: 7369 6465 206f 6620 7468 6520 6e65 7720  side of the new 
+00041540: 6469 7669 7369 6f6e 206d 7573 7420 6265  division must be
+00041550: 2065 7175 616c 206f 7220 736d 616c 6c65   equal or smalle
+00041560: 7220 220a 2020 2020 2020 2020 2020 2020  r ".            
+00041570: 2020 2020 2274 6861 6e20 6f6c 6420 6469      "than old di
+00041580: 7669 7369 6f6e 220a 2020 2020 2020 2020  vision".        
+00041590: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000415a0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000415b0: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
+000415c0: 6966 2061 5b2d 315d 203e 2062 5b2d 315d  if a[-1] > b[-1]
+000415d0: 3a0a 2020 2020 2020 2020 2020 2020 6d73  :.            ms
+000415e0: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
+000415f0: 2020 2020 2020 2272 6967 6874 2073 6964        "right sid
+00041600: 6520 6f66 2074 6865 206e 6577 2064 6976  e of the new div
+00041610: 6973 696f 6e20 6d75 7374 2062 6520 6571  ision must be eq
+00041620: 7561 6c20 6f72 206c 6172 6765 7220 220a  ual or larger ".
+00041630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041640: 2274 6861 6e20 6f6c 6420 6469 7669 7369  "than old divisi
+00041650: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
+00041660: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
+00041670: 6973 6520 5661 6c75 6545 7272 6f72 286d  ise ValueError(m
+00041680: 7367 290a 2020 2020 656c 7365 3a0a 2020  sg).    else:.  
+00041690: 2020 2020 2020 6966 2061 5b30 5d20 213d        if a[0] !=
+000416a0: 2062 5b30 5d3a 0a20 2020 2020 2020 2020   b[0]:.         
+000416b0: 2020 206d 7367 203d 2022 6c65 6674 2073     msg = "left s
+000416c0: 6964 6520 6f66 206f 6c64 2061 6e64 206e  ide of old and n
+000416d0: 6577 2064 6976 6973 696f 6e73 2061 7265  ew divisions are
+000416e0: 2064 6966 6665 7265 6e74 220a 2020 2020   different".    
+000416f0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00041700: 6c75 6545 7272 6f72 286d 7367 290a 2020  lueError(msg).  
+00041710: 2020 2020 2020 6966 2061 5b2d 315d 2021        if a[-1] !
+00041720: 3d20 625b 2d31 5d3a 0a20 2020 2020 2020  = b[-1]:.       
+00041730: 2020 2020 206d 7367 203d 2022 7269 6768       msg = "righ
+00041740: 7420 7369 6465 206f 6620 6f6c 6420 616e  t side of old an
+00041750: 6420 6e65 7720 6469 7669 7369 6f6e 7320  d new divisions 
+00041760: 6172 6520 6469 6666 6572 656e 7422 0a20  are different". 
+00041770: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00041780: 2056 616c 7565 4572 726f 7228 6d73 6729   ValueError(msg)
+00041790: 0a0a 2020 2020 6465 6620 5f69 735f 7369  ..    def _is_si
+000417a0: 6e67 6c65 5f6c 6173 745f 6469 7628 7829  ngle_last_div(x)
+000417b0: 3a0a 2020 2020 2020 2020 2222 2257 6865  :.        """Whe
+000417c0: 7468 6572 206c 6173 7420 6469 7669 7369  ther last divisi
+000417d0: 6f6e 206f 6e6c 7920 636f 6e74 6169 6e73  on only contains
+000417e0: 2073 696e 676c 6520 6c61 6265 6c22 2222   single label"""
+000417f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00041800: 6c65 6e28 7829 203e 3d20 3220 616e 6420  len(x) >= 2 and 
+00041810: 785b 2d31 5d20 3d3d 2078 5b2d 325d 0a0a  x[-1] == x[-2]..
+00041820: 2020 2020 6320 3d20 5b61 5b30 5d5d 0a20      c = [a[0]]. 
+00041830: 2020 2064 203d 2064 6963 7428 290a 2020     d = dict().  
+00041840: 2020 6c6f 7720 3d20 615b 305d 0a0a 2020    low = a[0]..  
+00041850: 2020 692c 206a 203d 2031 2c20 3120 2023    i, j = 1, 1  #
+00041860: 2069 6e64 6963 6573 2066 6f72 206f 6c64   indices for old
+00041870: 2f6e 6577 2064 6976 6973 696f 6e73 0a20  /new divisions. 
+00041880: 2020 206b 203d 2030 2020 2320 696e 6465     k = 0  # inde
+00041890: 7820 666f 7220 7465 6d70 2064 6976 6973  x for temp divis
+000418a0: 696f 6e73 0a0a 2020 2020 6c61 7374 5f65  ions..    last_e
+000418b0: 6c65 6d20 3d20 5f69 735f 7369 6e67 6c65  lem = _is_single
+000418c0: 5f6c 6173 745f 6469 7628 6129 0a0a 2020  _last_div(a)..  
+000418d0: 2020 2320 7072 6f63 6573 7320 7468 726f    # process thro
+000418e0: 7567 6820 6f6c 6420 6469 7669 7369 6f6e  ugh old division
+000418f0: 0a20 2020 2023 206c 6566 7420 7061 7274  .    # left part
+00041900: 206f 6620 6e65 7720 6469 7669 7369 6f6e   of new division
+00041910: 2063 616e 2062 6520 7072 6f63 6573 7365   can be processe
+00041920: 6420 696e 2074 6869 7320 6c6f 6f70 0a20  d in this loop. 
+00041930: 2020 2077 6869 6c65 2069 203c 206c 656e     while i < len
+00041940: 2861 2920 616e 6420 6a20 3c20 6c65 6e28  (a) and j < len(
+00041950: 6229 3a0a 2020 2020 2020 2020 6966 2061  b):.        if a
+00041960: 5b69 5d20 3c20 625b 6a5d 3a0a 2020 2020  [i] < b[j]:.    
+00041970: 2020 2020 2020 2020 2320 7475 706c 6520          # tuple 
+00041980: 6973 2073 6f6d 6574 6869 6e67 206c 696b  is something lik
+00041990: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+000419a0: 2028 6d65 7468 6f64 732e 626f 756e 6461   (methods.bounda
+000419b0: 7279 5f73 6c69 6365 2c20 2827 6672 6f6d  ry_slice, ('from
+000419c0: 5f70 616e 6461 732d 2327 2c20 3029 2c20  _pandas-#', 0), 
+000419d0: 332c 2034 2c20 4661 6c73 6529 290a 2020  3, 4, False)).  
+000419e0: 2020 2020 2020 2020 2020 645b 286f 7574            d[(out
+000419f0: 312c 206b 295d 203d 2028 6d65 7468 6f64  1, k)] = (method
+00041a00: 732e 626f 756e 6461 7279 5f73 6c69 6365  s.boundary_slice
+00041a10: 2c20 286e 616d 652c 2069 202d 2031 292c  , (name, i - 1),
+00041a20: 206c 6f77 2c20 615b 695d 2c20 4661 6c73   low, a[i], Fals
+00041a30: 6529 0a20 2020 2020 2020 2020 2020 206c  e).            l
+00041a40: 6f77 203d 2061 5b69 5d0a 2020 2020 2020  ow = a[i].      
+00041a50: 2020 2020 2020 6920 2b3d 2031 0a20 2020        i += 1.   
+00041a60: 2020 2020 2065 6c69 6620 615b 695d 203e       elif a[i] >
+00041a70: 2062 5b6a 5d3a 0a20 2020 2020 2020 2020   b[j]:.         
+00041a80: 2020 2064 5b28 6f75 7431 2c20 6b29 5d20     d[(out1, k)] 
+00041a90: 3d20 286d 6574 686f 6473 2e62 6f75 6e64  = (methods.bound
+00041aa0: 6172 795f 736c 6963 652c 2028 6e61 6d65  ary_slice, (name
+00041ab0: 2c20 6920 2d20 3129 2c20 6c6f 772c 2062  , i - 1), low, b
+00041ac0: 5b6a 5d2c 2046 616c 7365 290a 2020 2020  [j], False).    
+00041ad0: 2020 2020 2020 2020 6c6f 7720 3d20 625b          low = b[
+00041ae0: 6a5d 0a20 2020 2020 2020 2020 2020 206a  j].            j
+00041af0: 202b 3d20 310a 2020 2020 2020 2020 656c   += 1.        el
+00041b00: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00041b10: 645b 286f 7574 312c 206b 295d 203d 2028  d[(out1, k)] = (
+00041b20: 6d65 7468 6f64 732e 626f 756e 6461 7279  methods.boundary
+00041b30: 5f73 6c69 6365 2c20 286e 616d 652c 2069  _slice, (name, i
+00041b40: 202d 2031 292c 206c 6f77 2c20 625b 6a5d   - 1), low, b[j]
+00041b50: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
+00041b60: 2020 2020 206c 6f77 203d 2062 5b6a 5d0a       low = b[j].
+00041b70: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00041b80: 656e 2861 2920 3d3d 2069 202b 2031 206f  en(a) == i + 1 o
+00041b90: 7220 615b 695d 203c 2061 5b69 202b 2031  r a[i] < a[i + 1
+00041ba0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+00041bb0: 2020 206a 202b 3d20 310a 2020 2020 2020     j += 1.      
+00041bc0: 2020 2020 2020 6920 2b3d 2031 0a20 2020        i += 1.   
+00041bd0: 2020 2020 2063 2e61 7070 656e 6428 6c6f       c.append(lo
+00041be0: 7729 0a20 2020 2020 2020 206b 202b 3d20  w).        k += 
+00041bf0: 310a 0a20 2020 2023 2072 6967 6874 2070  1..    # right p
+00041c00: 6172 7420 6f66 206e 6577 2064 6976 6973  art of new divis
+00041c10: 696f 6e20 6361 6e20 7265 6d61 696e 0a20  ion can remain. 
+00041c20: 2020 2069 6620 615b 2d31 5d20 3c20 625b     if a[-1] < b[
+00041c30: 2d31 5d20 6f72 2062 5b2d 315d 203d 3d20  -1] or b[-1] == 
+00041c40: 625b 2d32 5d3a 0a20 2020 2020 2020 2066  b[-2]:.        f
+00041c50: 6f72 205f 6a20 696e 2072 616e 6765 286a  or _j in range(j
+00041c60: 2c20 6c65 6e28 6229 293a 0a20 2020 2020  , len(b)):.     
+00041c70: 2020 2020 2020 2023 2061 6c77 6179 7320         # always 
+00041c80: 7573 6520 7269 6768 742d 6d6f 7374 206f  use right-most o
+00041c90: 6620 6f6c 6420 6469 7669 7369 6f6e 0a20  f old division. 
+00041ca0: 2020 2020 2020 2020 2020 2023 2062 6563             # bec
+00041cb0: 6175 7365 2069 7420 6d61 7920 636f 6e74  ause it may cont
+00041cc0: 6169 6e20 6c61 7374 2065 6c65 6d65 6e74  ain last element
+00041cd0: 0a20 2020 2020 2020 2020 2020 206d 203d  .            m =
+00041ce0: 206c 656e 2861 2920 2d20 320a 2020 2020   len(a) - 2.    
+00041cf0: 2020 2020 2020 2020 645b 286f 7574 312c          d[(out1,
+00041d00: 206b 295d 203d 2028 6d65 7468 6f64 732e   k)] = (methods.
+00041d10: 626f 756e 6461 7279 5f73 6c69 6365 2c20  boundary_slice, 
+00041d20: 286e 616d 652c 206d 292c 206c 6f77 2c20  (name, m), low, 
+00041d30: 625b 5f6a 5d2c 2046 616c 7365 290a 2020  b[_j], False).  
+00041d40: 2020 2020 2020 2020 2020 6c6f 7720 3d20            low = 
+00041d50: 625b 5f6a 5d0a 2020 2020 2020 2020 2020  b[_j].          
+00041d60: 2020 632e 6170 7065 6e64 286c 6f77 290a    c.append(low).
+00041d70: 2020 2020 2020 2020 2020 2020 6b20 2b3d              k +=
+00041d80: 2031 0a20 2020 2065 6c73 653a 0a20 2020   1.    else:.   
+00041d90: 2020 2020 2023 2065 7665 6e20 6966 206e       # even if n
+00041da0: 6577 2064 6976 6973 696f 6e20 6973 2070  ew division is p
+00041db0: 726f 6365 7373 6564 2074 6872 6f75 6768  rocessed through
+00041dc0: 2c0a 2020 2020 2020 2020 2320 7269 6768  ,.        # righ
+00041dd0: 742d 6d6f 7374 2065 6c65 6d65 6e74 206f  t-most element o
+00041de0: 6620 6f6c 6420 6469 7669 7369 6f6e 2063  f old division c
+00041df0: 616e 2072 656d 6169 6e0a 2020 2020 2020  an remain.      
+00041e00: 2020 6966 206c 6173 745f 656c 656d 2061    if last_elem a
+00041e10: 6e64 2069 203c 206c 656e 2861 293a 0a20  nd i < len(a):. 
+00041e20: 2020 2020 2020 2020 2020 2064 5b28 6f75             d[(ou
+00041e30: 7431 2c20 6b29 5d20 3d20 286d 6574 686f  t1, k)] = (metho
+00041e40: 6473 2e62 6f75 6e64 6172 795f 736c 6963  ds.boundary_slic
+00041e50: 652c 2028 6e61 6d65 2c20 6920 2d20 3129  e, (name, i - 1)
+00041e60: 2c20 615b 695d 2c20 615b 695d 2c20 4661  , a[i], a[i], Fa
+00041e70: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
+00041e80: 206b 202b 3d20 310a 2020 2020 2020 2020   k += 1.        
+00041e90: 632e 6170 7065 6e64 2861 5b2d 315d 290a  c.append(a[-1]).
+00041ea0: 0a20 2020 2023 2072 6570 6c61 6365 206c  .    # replace l
+00041eb0: 6173 7420 656c 656d 656e 7420 6f66 2074  ast element of t
+00041ec0: 7570 6c65 2077 6974 6820 5472 7565 0a20  uple with True. 
+00041ed0: 2020 2064 5b28 6f75 7431 2c20 6b20 2d20     d[(out1, k - 
+00041ee0: 3129 5d20 3d20 645b 286f 7574 312c 206b  1)] = d[(out1, k
+00041ef0: 202d 2031 295d 5b3a 2d31 5d20 2b20 2854   - 1)][:-1] + (T
+00041f00: 7275 652c 290a 0a20 2020 2069 2c20 6a20  rue,)..    i, j 
+00041f10: 3d20 302c 2031 0a0a 2020 2020 6c61 7374  = 0, 1..    last
+00041f20: 5f65 6c65 6d20 3d20 5f69 735f 7369 6e67  _elem = _is_sing
+00041f30: 6c65 5f6c 6173 745f 6469 7628 6329 0a0a  le_last_div(c)..
+00041f40: 2020 2020 7768 696c 6520 6a20 3c20 6c65      while j < le
+00041f50: 6e28 6229 3a0a 2020 2020 2020 2020 746d  n(b):.        tm
+00041f60: 7020 3d20 5b5d 0a20 2020 2020 2020 2077  p = [].        w
+00041f70: 6869 6c65 2063 5b69 5d20 3c20 625b 6a5d  hile c[i] < b[j]
+00041f80: 3a0a 2020 2020 2020 2020 2020 2020 746d  :.            tm
+00041f90: 702e 6170 7065 6e64 2828 6f75 7431 2c20  p.append((out1, 
+00041fa0: 6929 290a 2020 2020 2020 2020 2020 2020  i)).            
+00041fb0: 6920 2b3d 2031 0a20 2020 2020 2020 2077  i += 1.        w
+00041fc0: 6869 6c65 2028 0a20 2020 2020 2020 2020  hile (.         
+00041fd0: 2020 206c 6173 745f 656c 656d 0a20 2020     last_elem.   
+00041fe0: 2020 2020 2020 2020 2061 6e64 2063 5b69           and c[i
+00041ff0: 5d20 3d3d 2062 5b2d 315d 0a20 2020 2020  ] == b[-1].     
+00042000: 2020 2020 2020 2061 6e64 2028 625b 2d31         and (b[-1
+00042010: 5d20 213d 2062 5b2d 325d 206f 7220 6a20  ] != b[-2] or j 
+00042020: 3d3d 206c 656e 2862 2920 2d20 3129 0a20  == len(b) - 1). 
+00042030: 2020 2020 2020 2020 2020 2061 6e64 2069             and i
+00042040: 203c 206b 0a20 2020 2020 2020 2029 3a0a   < k.        ):.
+00042050: 2020 2020 2020 2020 2020 2020 2320 6170              # ap
+00042060: 7065 6e64 2069 6620 6c61 7374 2073 706c  pend if last spl
+00042070: 6974 2069 7320 6e6f 7420 696e 636c 7564  it is not includ
+00042080: 6564 0a20 2020 2020 2020 2020 2020 2074  ed.            t
+00042090: 6d70 2e61 7070 656e 6428 286f 7574 312c  mp.append((out1,
+000420a0: 2069 2929 0a20 2020 2020 2020 2020 2020   i)).           
+000420b0: 2069 202b 3d20 310a 2020 2020 2020 2020   i += 1.        
+000420c0: 6966 206c 656e 2874 6d70 2920 3d3d 2030  if len(tmp) == 0
+000420d0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+000420e0: 6475 6d6d 7920 736c 6963 6520 746f 2072  dummy slice to r
+000420f0: 6574 7572 6e20 656d 7074 7920 4461 7461  eturn empty Data
+00042100: 4672 616d 6520 6f72 2053 6572 6965 732c  Frame or Series,
+00042110: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
+00042120: 6869 6368 2072 6574 6169 6e20 6f72 6967  hich retain orig
+00042130: 696e 616c 2064 6174 6120 6174 7472 6962  inal data attrib
+00042140: 7574 6573 2028 636f 6c75 6d6e 7320 2f20  utes (columns / 
+00042150: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
+00042160: 2020 645b 286f 7574 322c 206a 202d 2031    d[(out2, j - 1
+00042170: 295d 203d 2028 6d65 7468 6f64 732e 626f  )] = (methods.bo
+00042180: 756e 6461 7279 5f73 6c69 6365 2c20 286e  undary_slice, (n
+00042190: 616d 652c 2030 292c 2061 5b30 5d2c 2061  ame, 0), a[0], a
+000421a0: 5b30 5d2c 2046 616c 7365 290a 2020 2020  [0], False).    
+000421b0: 2020 2020 656c 6966 206c 656e 2874 6d70      elif len(tmp
+000421c0: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
+000421d0: 2020 2020 645b 286f 7574 322c 206a 202d      d[(out2, j -
+000421e0: 2031 295d 203d 2074 6d70 5b30 5d0a 2020   1)] = tmp[0].  
+000421f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00042200: 2020 2020 2020 2020 6966 206e 6f74 2074          if not t
+00042210: 6d70 3a0a 2020 2020 2020 2020 2020 2020  mp:.            
+00042220: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00042230: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00042240: 2020 2020 2020 2020 2020 2263 6865 636b            "check
+00042250: 2066 6f72 2064 7570 6c69 6361 7465 2070   for duplicate p
+00042260: 6172 7469 7469 6f6e 735c 6e6f 6c64 3a5c  artitions\nold:\
+00042270: 6e25 735c 6e5c 6e22 0a20 2020 2020 2020  n%s\n\n".       
+00042280: 2020 2020 2020 2020 2020 2020 2022 6e65               "ne
+00042290: 773a 5c6e 2573 5c6e 5c6e 636f 6d62 696e  w:\n%s\n\ncombin
+000422a0: 6564 3a5c 6e25 7322 2025 2028 7066 6f72  ed:\n%s" % (pfor
+000422b0: 6d61 7428 6129 2c20 7066 6f72 6d61 7428  mat(a), pformat(
+000422c0: 6229 2c20 7066 6f72 6d61 7428 6329 290a  b), pformat(c)).
+000422d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000422e0: 290a 2020 2020 2020 2020 2020 2020 645b  ).            d[
+000422f0: 286f 7574 322c 206a 202d 2031 295d 203d  (out2, j - 1)] =
+00042300: 2028 6d65 7468 6f64 732e 636f 6e63 6174   (methods.concat
+00042310: 2c20 746d 7029 0a20 2020 2020 2020 206a  , tmp).        j
+00042320: 202b 3d20 310a 2020 2020 7265 7475 726e   += 1.    return
+00042330: 2064 0a0a 0a64 6566 2072 6570 6172 7469   d...def reparti
+00042340: 7469 6f6e 5f66 7265 7128 6466 2c20 6672  tion_freq(df, fr
+00042350: 6571 3d4e 6f6e 6529 3a0a 2020 2020 2222  eq=None):.    ""
+00042360: 2252 6570 6172 7469 7469 6f6e 2061 2074  "Repartition a t
+00042370: 696d 6573 6572 6965 7320 6461 7461 6672  imeseries datafr
+00042380: 616d 6520 6279 2061 206e 6577 2066 7265  ame by a new fre
+00042390: 7175 656e 6379 2222 220a 2020 2020 6966  quency""".    if
+000423a0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+000423b0: 6466 2e64 6976 6973 696f 6e73 5b30 5d2c  df.divisions[0],
+000423c0: 2070 642e 5469 6d65 7374 616d 7029 3a0a   pd.Timestamp):.
+000423d0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+000423e0: 7065 4572 726f 7228 2243 616e 206f 6e6c  peError("Can onl
+000423f0: 7920 7265 7061 7274 6974 696f 6e20 6f6e  y repartition on
+00042400: 2066 7265 7175 656e 6379 2066 6f72 2074   frequency for t
+00042410: 696d 6573 6572 6965 7322 290a 0a20 2020  imeseries")..   
+00042420: 2066 7265 7120 3d20 5f6d 6170 5f66 7265   freq = _map_fre
+00042430: 715f 746f 5f70 6572 696f 645f 7374 6172  q_to_period_star
+00042440: 7428 6672 6571 290a 0a20 2020 2074 7279  t(freq)..    try
+00042450: 3a0a 2020 2020 2020 2020 7374 6172 7420  :.        start 
+00042460: 3d20 6466 2e64 6976 6973 696f 6e73 5b30  = df.divisions[0
+00042470: 5d2e 6365 696c 2866 7265 7129 0a20 2020  ].ceil(freq).   
+00042480: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
+00042490: 6f72 3a0a 2020 2020 2020 2020 7374 6172  or:.        star
+000424a0: 7420 3d20 6466 2e64 6976 6973 696f 6e73  t = df.divisions
+000424b0: 5b30 5d0a 2020 2020 6469 7669 7369 6f6e  [0].    division
+000424c0: 7320 3d20 6d65 7468 6f64 732e 746f 6c69  s = methods.toli
+000424d0: 7374 280a 2020 2020 2020 2020 7064 2e64  st(.        pd.d
+000424e0: 6174 655f 7261 6e67 6528 7374 6172 743d  ate_range(start=
+000424f0: 7374 6172 742c 2065 6e64 3d64 662e 6469  start, end=df.di
+00042500: 7669 7369 6f6e 735b 2d31 5d2c 2066 7265  visions[-1], fre
+00042510: 713d 6672 6571 290a 2020 2020 290a 2020  q=freq).    ).  
+00042520: 2020 6966 206e 6f74 206c 656e 2864 6976    if not len(div
+00042530: 6973 696f 6e73 293a 0a20 2020 2020 2020  isions):.       
+00042540: 2064 6976 6973 696f 6e73 203d 205b 6466   divisions = [df
+00042550: 2e64 6976 6973 696f 6e73 5b30 5d2c 2064  .divisions[0], d
+00042560: 662e 6469 7669 7369 6f6e 735b 2d31 5d5d  f.divisions[-1]]
+00042570: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00042580: 2020 2064 6976 6973 696f 6e73 2e61 7070     divisions.app
+00042590: 656e 6428 6466 2e64 6976 6973 696f 6e73  end(df.divisions
+000425a0: 5b2d 315d 290a 2020 2020 2020 2020 6966  [-1]).        if
+000425b0: 2064 6976 6973 696f 6e73 5b30 5d20 213d   divisions[0] !=
+000425c0: 2064 662e 6469 7669 7369 6f6e 735b 305d   df.divisions[0]
+000425d0: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
+000425e0: 7669 7369 6f6e 7320 3d20 5b64 662e 6469  visions = [df.di
+000425f0: 7669 7369 6f6e 735b 305d 5d20 2b20 6469  visions[0]] + di
+00042600: 7669 7369 6f6e 730a 0a20 2020 2072 6574  visions..    ret
+00042610: 7572 6e20 6466 2e72 6570 6172 7469 7469  urn df.repartiti
+00042620: 6f6e 2864 6976 6973 696f 6e73 3d64 6976  on(divisions=div
+00042630: 6973 696f 6e73 290a 0a0a 6465 6620 5f6d  isions)...def _m
+00042640: 6170 5f66 7265 715f 746f 5f70 6572 696f  ap_freq_to_perio
+00042650: 645f 7374 6172 7428 6672 6571 293a 0a20  d_start(freq):. 
+00042660: 2020 2022 2222 456e 7375 7265 2074 6861     """Ensure tha
+00042670: 7420 7468 6520 6672 6571 7565 6e63 7920  t the frequency 
+00042680: 7065 7274 6169 6e73 2074 6f20 7468 6520  pertains to the 
+00042690: 2a2a 7374 6172 742a 2a20 6f66 2061 2070  **start** of a p
+000426a0: 6572 696f 642e 0a0a 2020 2020 4966 2065  eriod...    If e
+000426b0: 2e67 2e20 6066 7265 713d 274d 2760 2c20  .g. `freq='M'`, 
+000426c0: 7468 656e 2074 6865 2064 6976 6973 696f  then the divisio
+000426d0: 6e73 2061 7265 3a0a 2020 2020 2020 2020  ns are:.        
+000426e0: 2d20 3230 3231 2d33 312d 3120 3030 3a30  - 2021-31-1 00:0
+000426f0: 303a 3030 2028 7374 6172 7420 6f66 2046  0:00 (start of F
+00042700: 6562 7275 6172 7920 7061 7274 6974 696f  ebruary partitio
+00042710: 6e29 0a20 2020 2020 2020 202d 2032 3032  n).        - 202
+00042720: 312d 322d 3238 2030 303a 3030 3a30 3020  1-2-28 00:00:00 
+00042730: 2873 7461 7274 206f 6620 4d61 7263 6820  (start of March 
+00042740: 7061 7274 6974 696f 6e29 0a20 2020 2020  partition).     
+00042750: 2020 202d 202e 2e2e 0a0a 2020 2020 6275     - .....    bu
+00042760: 7420 7468 6973 202a 2a73 686f 756c 642a  t this **should*
+00042770: 2a20 6265 3a0a 2020 2020 2020 2020 2d20  * be:.        - 
+00042780: 3230 3231 2d32 2d31 2030 303a 3030 3a30  2021-2-1 00:00:0
+00042790: 3020 2873 7461 7274 206f 6620 4665 6272  0 (start of Febr
+000427a0: 7561 7279 2070 6172 7469 7469 6f6e 290a  uary partition).
+000427b0: 2020 2020 2020 2020 2d20 3230 3231 2d33          - 2021-3
+000427c0: 2d31 2030 303a 3030 3a30 3020 2873 7461  -1 00:00:00 (sta
+000427d0: 7274 206f 6620 4d61 7263 6820 7061 7274  rt of March part
+000427e0: 6974 696f 6e29 0a20 2020 2020 2020 202d  ition).        -
+000427f0: 202e 2e2e 0a0a 2020 2020 5468 6572 6566   .....    Theref
+00042800: 6f72 652c 2077 6520 6d61 7020 6066 7265  ore, we map `fre
+00042810: 713d 274d 2760 2074 6f20 6066 7265 713d  q='M'` to `freq=
+00042820: 274d 5327 6020 2873 616d 6520 666f 7220  'MS'` (same for 
+00042830: 7175 6172 7465 7220 616e 6420 7965 6172  quarter and year
+00042840: 292e 0a20 2020 2022 2222 0a0a 2020 2020  )..    """..    
+00042850: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00042860: 6528 6672 6571 2c20 7374 7229 3a0a 2020  e(freq, str):.  
+00042870: 2020 2020 2020 7265 7475 726e 2066 7265        return fre
+00042880: 710a 0a20 2020 206f 6666 7365 7420 3d20  q..    offset = 
+00042890: 7064 2e74 7365 7269 6573 2e66 7265 7175  pd.tseries.frequ
+000428a0: 656e 6369 6573 2e74 6f5f 6f66 6673 6574  encies.to_offset
+000428b0: 2866 7265 7129 0a20 2020 206f 6666 7365  (freq).    offse
+000428c0: 745f 7479 7065 5f6e 616d 6520 3d20 7479  t_type_name = ty
+000428d0: 7065 286f 6666 7365 7429 2e5f 5f6e 616d  pe(offset).__nam
+000428e0: 655f 5f0a 0a20 2020 2069 6620 6e6f 7420  e__..    if not 
+000428f0: 6f66 6673 6574 5f74 7970 655f 6e61 6d65  offset_type_name
+00042900: 2e65 6e64 7377 6974 6828 2245 6e64 2229  .endswith("End")
+00042910: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00042920: 2066 7265 710a 0a20 2020 206e 6577 5f6f   freq..    new_o
+00042930: 6666 7365 7420 3d20 6f66 6673 6574 5f74  ffset = offset_t
+00042940: 7970 655f 6e61 6d65 5b3a 202d 6c65 6e28  ype_name[: -len(
+00042950: 2245 6e64 2229 5d20 2b20 2242 6567 696e  "End")] + "Begin
+00042960: 220a 2020 2020 7472 793a 0a20 2020 2020  ".    try:.     
+00042970: 2020 206e 6577 5f6f 6666 7365 745f 7479     new_offset_ty
+00042980: 7065 203d 2067 6574 6174 7472 2870 642e  pe = getattr(pd.
+00042990: 7473 6572 6965 732e 6f66 6673 6574 732c  tseries.offsets,
+000429a0: 206e 6577 5f6f 6666 7365 7429 0a20 2020   new_offset).   
+000429b0: 2020 2020 2069 6620 222d 2220 696e 2066       if "-" in f
+000429c0: 7265 713a 0a20 2020 2020 2020 2020 2020  req:.           
+000429d0: 205f 2c20 616e 6368 6f72 203d 2066 7265   _, anchor = fre
+000429e0: 712e 7370 6c69 7428 222d 2229 0a20 2020  q.split("-").   
+000429f0: 2020 2020 2020 2020 2061 6e63 686f 7220           anchor 
+00042a00: 3d20 222d 2220 2b20 616e 6368 6f72 0a20  = "-" + anchor. 
+00042a10: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00042a20: 2020 2020 2020 2020 2061 6e63 686f 7220           anchor 
+00042a30: 3d20 2222 0a20 2020 2020 2020 206e 203d  = "".        n =
+00042a40: 2073 7472 286f 6666 7365 742e 6e29 2069   str(offset.n) i
+00042a50: 6620 6f66 6673 6574 2e6e 2021 3d20 3120  f offset.n != 1 
+00042a60: 656c 7365 2022 220a 2020 2020 2020 2020  else "".        
+00042a70: 7265 7475 726e 2066 227b 6e7d 7b6e 6577  return f"{n}{new
+00042a80: 5f6f 6666 7365 745f 7479 7065 2e5f 7072  _offset_type._pr
+00042a90: 6566 6978 7d7b 616e 6368 6f72 7d22 0a20  efix}{anchor}". 
+00042aa0: 2020 2065 7863 6570 7420 4174 7472 6962     except Attrib
+00042ab0: 7574 6545 7272 6f72 3a0a 2020 2020 2020  uteError:.      
+00042ac0: 2020 7265 7475 726e 2066 7265 710a 0a0a    return freq...
+00042ad0: 6465 6620 7265 7061 7274 6974 696f 6e5f  def repartition_
+00042ae0: 7369 7a65 2864 662c 2073 697a 6529 3a0a  size(df, size):.
+00042af0: 2020 2020 2222 220a 2020 2020 5265 7061      """.    Repa
+00042b00: 7274 6974 696f 6e20 6461 7461 6672 616d  rtition datafram
+00042b10: 6520 736f 2074 6861 7420 6e65 7720 7061  e so that new pa
+00042b20: 7274 6974 696f 6e73 2068 6176 6520 6170  rtitions have ap
+00042b30: 7072 6f78 696d 6174 656c 7920 6073 697a  proximately `siz
+00042b40: 6560 206d 656d 6f72 7920 7573 6167 6520  e` memory usage 
+00042b50: 6561 6368 0a20 2020 2022 2222 0a20 2020  each.    """.   
+00042b60: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
+00042b70: 697a 652c 2073 7472 293a 0a20 2020 2020  ize, str):.     
+00042b80: 2020 2073 697a 6520 3d20 7061 7273 655f     size = parse_
+00042b90: 6279 7465 7328 7369 7a65 290a 2020 2020  bytes(size).    
+00042ba0: 7369 7a65 203d 2069 6e74 2873 697a 6529  size = int(size)
+00042bb0: 0a0a 2020 2020 6d65 6d5f 7573 6167 6573  ..    mem_usages
+00042bc0: 203d 2064 662e 6d61 705f 7061 7274 6974   = df.map_partit
+00042bd0: 696f 6e73 2874 6f74 616c 5f6d 656d 5f75  ions(total_mem_u
+00042be0: 7361 6765 2c20 6465 6570 3d54 7275 6529  sage, deep=True)
+00042bf0: 2e63 6f6d 7075 7465 2829 0a0a 2020 2020  .compute()..    
+00042c00: 2320 312e 2073 706c 6974 2065 6163 6820  # 1. split each 
+00042c10: 7061 7274 6974 696f 6e20 7468 6174 2069  partition that i
+00042c20: 7320 6c61 7267 6572 2074 6861 6e20 7061  s larger than pa
+00042c30: 7274 6974 696f 6e5f 7369 7a65 0a20 2020  rtition_size.   
+00042c40: 206e 7370 6c69 7473 203d 2031 202b 206d   nsplits = 1 + m
+00042c50: 656d 5f75 7361 6765 7320 2f2f 2073 697a  em_usages // siz
+00042c60: 650a 2020 2020 6966 206e 702e 616e 7928  e.    if np.any(
+00042c70: 6e73 706c 6974 7320 3e20 3129 3a0a 2020  nsplits > 1):.  
+00042c80: 2020 2020 2020 7370 6c69 745f 6e61 6d65        split_name
+00042c90: 203d 2066 2272 6570 6172 7469 7469 6f6e   = f"repartition
+00042ca0: 2d73 706c 6974 2d7b 7369 7a65 7d2d 7b74  -split-{size}-{t
+00042cb0: 6f6b 656e 697a 6528 6466 297d 220a 2020  okenize(df)}".  
+00042cc0: 2020 2020 2020 6466 203d 205f 7370 6c69        df = _spli
+00042cd0: 745f 7061 7274 6974 696f 6e73 2864 662c  t_partitions(df,
+00042ce0: 206e 7370 6c69 7473 2c20 7370 6c69 745f   nsplits, split_
+00042cf0: 6e61 6d65 290a 2020 2020 2020 2020 2320  name).        # 
+00042d00: 7570 6461 7465 206d 656d 5f75 7361 6765  update mem_usage
+00042d10: 7320 746f 2061 6363 6f75 6e74 2066 6f72  s to account for
+00042d20: 2074 6865 2073 706c 6974 2070 6172 7469   the split parti
+00042d30: 7469 6f6e 730a 2020 2020 2020 2020 7370  tions.        sp
+00042d40: 6c69 745f 6d65 6d5f 7573 6167 6573 203d  lit_mem_usages =
+00042d50: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
+00042d60: 6e2c 2075 7361 6765 2069 6e20 7a69 7028  n, usage in zip(
+00042d70: 6e73 706c 6974 732c 206d 656d 5f75 7361  nsplits, mem_usa
+00042d80: 6765 7329 3a0a 2020 2020 2020 2020 2020  ges):.          
+00042d90: 2020 7370 6c69 745f 6d65 6d5f 7573 6167    split_mem_usag
+00042da0: 6573 2e65 7874 656e 6428 5b75 7361 6765  es.extend([usage
+00042db0: 202f 206e 5d20 2a20 6e29 0a20 2020 2020   / n] * n).     
+00042dc0: 2020 206d 656d 5f75 7361 6765 7320 3d20     mem_usages = 
+00042dd0: 7064 2e53 6572 6965 7328 7370 6c69 745f  pd.Series(split_
+00042de0: 6d65 6d5f 7573 6167 6573 290a 0a20 2020  mem_usages)..   
+00042df0: 2023 2032 2e20 6e6f 7720 7468 6174 2061   # 2. now that a
+00042e00: 6c6c 2070 6172 7469 7469 6f6e 7320 6172  ll partitions ar
+00042e10: 6520 6c65 7373 2074 6861 6e20 7369 7a65  e less than size
+00042e20: 2c20 636f 6e63 6174 2074 6865 6d20 7570  , concat them up
+00042e30: 2074 6f20 7369 7a65 0a20 2020 2061 7373   to size.    ass
+00042e40: 6572 7420 6e70 2e61 6c6c 286d 656d 5f75  ert np.all(mem_u
+00042e50: 7361 6765 7320 3c3d 2073 697a 6529 0a20  sages <= size). 
+00042e60: 2020 206e 6577 5f6e 7061 7274 6974 696f     new_npartitio
+00042e70: 6e73 203d 206c 6973 7428 6d61 7028 6c65  ns = list(map(le
+00042e80: 6e2c 2069 7465 725f 6368 756e 6b73 286d  n, iter_chunks(m
+00042e90: 656d 5f75 7361 6765 732c 2073 697a 6529  em_usages, size)
+00042ea0: 2929 0a20 2020 206e 6577 5f70 6172 7469  )).    new_parti
+00042eb0: 7469 6f6e 735f 626f 756e 6461 7269 6573  tions_boundaries
+00042ec0: 203d 206e 702e 6375 6d73 756d 286e 6577   = np.cumsum(new
+00042ed0: 5f6e 7061 7274 6974 696f 6e73 290a 2020  _npartitions).  
+00042ee0: 2020 6e65 775f 6e61 6d65 203d 2066 2272    new_name = f"r
+00042ef0: 6570 6172 7469 7469 6f6e 2d7b 7369 7a65  epartition-{size
+00042f00: 7d2d 7b74 6f6b 656e 697a 6528 6466 297d  }-{tokenize(df)}
+00042f10: 220a 2020 2020 7265 7475 726e 205f 7265  ".    return _re
+00042f20: 7061 7274 6974 696f 6e5f 6672 6f6d 5f62  partition_from_b
+00042f30: 6f75 6e64 6172 6965 7328 6466 2c20 6e65  oundaries(df, ne
+00042f40: 775f 7061 7274 6974 696f 6e73 5f62 6f75  w_partitions_bou
+00042f50: 6e64 6172 6965 732c 206e 6577 5f6e 616d  ndaries, new_nam
+00042f60: 6529 0a0a 0a64 6566 2074 6f74 616c 5f6d  e)...def total_m
+00042f70: 656d 5f75 7361 6765 2864 662c 2069 6e64  em_usage(df, ind
+00042f80: 6578 3d54 7275 652c 2064 6565 703d 4661  ex=True, deep=Fa
+00042f90: 6c73 6529 3a0a 2020 2020 6d65 6d5f 7573  lse):.    mem_us
+00042fa0: 6167 6520 3d20 6466 2e6d 656d 6f72 795f  age = df.memory_
+00042fb0: 7573 6167 6528 696e 6465 783d 696e 6465  usage(index=inde
+00042fc0: 782c 2064 6565 703d 6465 6570 290a 2020  x, deep=deep).  
+00042fd0: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
+00042fe0: 696b 6528 6d65 6d5f 7573 6167 6529 3a0a  ike(mem_usage):.
+00042ff0: 2020 2020 2020 2020 6d65 6d5f 7573 6167          mem_usag
+00043000: 6520 3d20 6d65 6d5f 7573 6167 652e 7375  e = mem_usage.su
+00043010: 6d28 290a 2020 2020 7265 7475 726e 206d  m().    return m
+00043020: 656d 5f75 7361 6765 0a0a 0a64 6566 2072  em_usage...def r
+00043030: 6570 6172 7469 7469 6f6e 5f6e 7061 7274  epartition_npart
+00043040: 6974 696f 6e73 2864 662c 206e 7061 7274  itions(df, npart
+00043050: 6974 696f 6e73 293a 0a20 2020 2022 2222  itions):.    """
+00043060: 5265 7061 7274 6974 696f 6e20 6461 7461  Repartition data
+00043070: 6672 616d 6520 746f 2061 2073 6d61 6c6c  frame to a small
+00043080: 6572 206e 756d 6265 7220 6f66 2070 6172  er number of par
+00043090: 7469 7469 6f6e 7322 2222 0a20 2020 206e  titions""".    n
+000430a0: 6577 5f6e 616d 6520 3d20 2272 6570 6172  ew_name = "repar
+000430b0: 7469 7469 6f6e 2d25 642d 2573 2220 2520  tition-%d-%s" % 
+000430c0: 286e 7061 7274 6974 696f 6e73 2c20 746f  (npartitions, to
+000430d0: 6b65 6e69 7a65 2864 6629 290a 2020 2020  kenize(df)).    
+000430e0: 6966 2064 662e 6e70 6172 7469 7469 6f6e  if df.npartition
+000430f0: 7320 3d3d 206e 7061 7274 6974 696f 6e73  s == npartitions
+00043100: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00043110: 2064 660a 2020 2020 656c 6966 2064 662e   df.    elif df.
+00043120: 6e70 6172 7469 7469 6f6e 7320 3e20 6e70  npartitions > np
+00043130: 6172 7469 7469 6f6e 733a 0a20 2020 2020  artitions:.     
+00043140: 2020 206e 7061 7274 6974 696f 6e73 5f72     npartitions_r
+00043150: 6174 696f 203d 2064 662e 6e70 6172 7469  atio = df.nparti
+00043160: 7469 6f6e 7320 2f20 6e70 6172 7469 7469  tions / npartiti
+00043170: 6f6e 730a 2020 2020 2020 2020 6e65 775f  ons.        new_
+00043180: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
+00043190: 6172 6965 7320 3d20 5b0a 2020 2020 2020  aries = [.      
+000431a0: 2020 2020 2020 696e 7428 6e65 775f 7061        int(new_pa
+000431b0: 7274 6974 696f 6e5f 696e 6465 7820 2a20  rtition_index * 
+000431c0: 6e70 6172 7469 7469 6f6e 735f 7261 7469  npartitions_rati
+000431d0: 6f29 0a20 2020 2020 2020 2020 2020 2066  o).            f
+000431e0: 6f72 206e 6577 5f70 6172 7469 7469 6f6e  or new_partition
+000431f0: 5f69 6e64 6578 2069 6e20 7261 6e67 6528  _index in range(
+00043200: 6e70 6172 7469 7469 6f6e 7320 2b20 3129  npartitions + 1)
+00043210: 0a20 2020 2020 2020 205d 0a20 2020 2020  .        ].     
+00043220: 2020 2072 6574 7572 6e20 5f72 6570 6172     return _repar
+00043230: 7469 7469 6f6e 5f66 726f 6d5f 626f 756e  tition_from_boun
+00043240: 6461 7269 6573 2864 662c 206e 6577 5f70  daries(df, new_p
+00043250: 6172 7469 7469 6f6e 735f 626f 756e 6461  artitions_bounda
+00043260: 7269 6573 2c20 6e65 775f 6e61 6d65 290a  ries, new_name).
+00043270: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00043280: 2020 2320 4472 6f70 2064 7570 6c63 6174    # Drop duplcat
+00043290: 6573 2069 6e20 6361 7365 206c 6173 7420  es in case last 
+000432a0: 7061 7274 6974 696f 6e20 6861 7320 7361  partition has sa
+000432b0: 6d65 0a20 2020 2020 2020 2023 2076 616c  me.        # val
+000432c0: 7565 2066 6f72 206d 696e 2061 6e64 206d  ue for min and m
+000432d0: 6178 2064 6976 6973 696f 6e0a 2020 2020  ax division.    
+000432e0: 2020 2020 6f72 6967 696e 616c 5f64 6976      original_div
+000432f0: 6973 696f 6e73 203d 2064 6976 6973 696f  isions = divisio
+00043300: 6e73 203d 2070 642e 5365 7269 6573 2864  ns = pd.Series(d
+00043310: 662e 6469 7669 7369 6f6e 7329 2e64 726f  f.divisions).dro
+00043320: 705f 6475 706c 6963 6174 6573 2829 0a20  p_duplicates(). 
+00043330: 2020 2020 2020 2069 6620 6466 2e6b 6e6f         if df.kno
+00043340: 776e 5f64 6976 6973 696f 6e73 2061 6e64  wn_divisions and
+00043350: 2028 0a20 2020 2020 2020 2020 2020 2069   (.            i
+00043360: 735f 6461 7465 7469 6d65 3634 5f61 6e79  s_datetime64_any
+00043370: 5f64 7479 7065 2864 6976 6973 696f 6e73  _dtype(divisions
+00043380: 2e64 7479 7065 290a 2020 2020 2020 2020  .dtype).        
+00043390: 2020 2020 6f72 2069 735f 6e75 6d65 7269      or is_numeri
+000433a0: 635f 6474 7970 6528 6469 7669 7369 6f6e  c_dtype(division
+000433b0: 732e 6474 7970 6529 0a20 2020 2020 2020  s.dtype).       
+000433c0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+000433d0: 6966 2069 735f 6461 7465 7469 6d65 3634  if is_datetime64
+000433e0: 5f61 6e79 5f64 7479 7065 2864 6976 6973  _any_dtype(divis
+000433f0: 696f 6e73 2e64 7479 7065 293a 0a20 2020  ions.dtype):.   
+00043400: 2020 2020 2020 2020 2020 2020 2064 6976               div
+00043410: 6973 696f 6e73 203d 2064 6976 6973 696f  isions = divisio
+00043420: 6e73 2e76 616c 7565 732e 6173 7479 7065  ns.values.astype
+00043430: 2822 666c 6f61 7436 3422 290a 0a20 2020  ("float64")..   
+00043440: 2020 2020 2020 2020 2069 6620 6973 5f73           if is_s
+00043450: 6572 6965 735f 6c69 6b65 2864 6976 6973  eries_like(divis
+00043460: 696f 6e73 293a 0a20 2020 2020 2020 2020  ions):.         
+00043470: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+00043480: 203d 2064 6976 6973 696f 6e73 2e76 616c   = divisions.val
+00043490: 7565 730a 0a20 2020 2020 2020 2020 2020  ues..           
+000434a0: 206e 203d 206c 656e 2864 6976 6973 696f   n = len(divisio
+000434b0: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
+000434c0: 6469 7669 7369 6f6e 7320 3d20 6e70 2e69  divisions = np.i
+000434d0: 6e74 6572 7028 0a20 2020 2020 2020 2020  nterp(.         
+000434e0: 2020 2020 2020 2078 3d6e 702e 6c69 6e73         x=np.lins
+000434f0: 7061 6365 2830 2c20 6e2c 206e 7061 7274  pace(0, n, npart
+00043500: 6974 696f 6e73 202b 2031 292c 0a20 2020  itions + 1),.   
+00043510: 2020 2020 2020 2020 2020 2020 2078 703d               xp=
+00043520: 6e70 2e6c 696e 7370 6163 6528 302c 206e  np.linspace(0, n
+00043530: 2c20 6e29 2c0a 2020 2020 2020 2020 2020  , n),.          
+00043540: 2020 2020 2020 6670 3d64 6976 6973 696f        fp=divisio
+00043550: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+00043560: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00043570: 2069 735f 6461 7465 7469 6d65 3634 5f61   is_datetime64_a
+00043580: 6e79 5f64 7479 7065 286f 7269 6769 6e61  ny_dtype(origina
+00043590: 6c5f 6469 7669 7369 6f6e 732e 6474 7970  l_divisions.dtyp
+000435a0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+000435b0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+000435c0: 6d65 7468 6f64 732e 746f 6c69 7374 280a  methods.tolist(.
+000435d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000435e0: 2020 2020 7064 2e53 6572 6965 7328 6469      pd.Series(di
+000435f0: 7669 7369 6f6e 7329 2e61 7374 7970 6528  visions).astype(
+00043600: 6f72 6967 696e 616c 5f64 6976 6973 696f  original_divisio
+00043610: 6e73 2e64 7479 7065 290a 2020 2020 2020  ns.dtype).      
+00043620: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00043630: 2020 2020 2020 2020 656c 6966 206e 702e          elif np.
+00043640: 6973 7375 6264 7479 7065 286f 7269 6769  issubdtype(origi
+00043650: 6e61 6c5f 6469 7669 7369 6f6e 732e 6474  nal_divisions.dt
+00043660: 7970 652c 206e 702e 696e 7465 6765 7229  ype, np.integer)
+00043670: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00043680: 2020 6469 7669 7369 6f6e 7320 3d20 6469    divisions = di
+00043690: 7669 7369 6f6e 732e 6173 7479 7065 286f  visions.astype(o
+000436a0: 7269 6769 6e61 6c5f 6469 7669 7369 6f6e  riginal_division
+000436b0: 732e 6474 7970 6529 0a0a 2020 2020 2020  s.dtype)..      
+000436c0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+000436d0: 6e63 6528 6469 7669 7369 6f6e 732c 206e  nce(divisions, n
+000436e0: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
+000436f0: 2020 2020 2020 2020 2020 2020 6469 7669              divi
+00043700: 7369 6f6e 7320 3d20 6469 7669 7369 6f6e  sions = division
+00043710: 732e 746f 6c69 7374 2829 0a0a 2020 2020  s.tolist()..    
+00043720: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+00043730: 7320 3d20 6c69 7374 2864 6976 6973 696f  s = list(divisio
+00043740: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
+00043750: 6469 7669 7369 6f6e 735b 305d 203d 2064  divisions[0] = d
+00043760: 662e 6469 7669 7369 6f6e 735b 305d 0a20  f.divisions[0]. 
+00043770: 2020 2020 2020 2020 2020 2064 6976 6973             divis
+00043780: 696f 6e73 5b2d 315d 203d 2064 662e 6469  ions[-1] = df.di
+00043790: 7669 7369 6f6e 735b 2d31 5d0a 0a20 2020  visions[-1]..   
+000437a0: 2020 2020 2020 2020 2023 2045 6e73 7572           # Ensur
+000437b0: 6520 7468 6520 636f 6d70 7574 6564 2064  e the computed d
+000437c0: 6976 6973 696f 6e73 2061 7265 2075 6e69  ivisions are uni
+000437d0: 7175 650a 2020 2020 2020 2020 2020 2020  que.            
+000437e0: 6469 7669 7369 6f6e 7320 3d20 6c69 7374  divisions = list
+000437f0: 2875 6e69 7175 6528 6469 7669 7369 6f6e  (unique(division
+00043800: 735b 3a2d 315d 2929 202b 205b 6469 7669  s[:-1])) + [divi
+00043810: 7369 6f6e 735b 2d31 5d5d 0a20 2020 2020  sions[-1]].     
+00043820: 2020 2020 2020 2072 6574 7572 6e20 6466         return df
+00043830: 2e72 6570 6172 7469 7469 6f6e 2864 6976  .repartition(div
+00043840: 6973 696f 6e73 3d64 6976 6973 696f 6e73  isions=divisions
+00043850: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00043860: 2020 2020 2020 2020 2020 2020 6469 762c              div,
+00043870: 206d 6f64 203d 2064 6976 6d6f 6428 6e70   mod = divmod(np
+00043880: 6172 7469 7469 6f6e 732c 2064 662e 6e70  artitions, df.np
+00043890: 6172 7469 7469 6f6e 7329 0a20 2020 2020  artitions).     
+000438a0: 2020 2020 2020 206e 7370 6c69 7473 203d         nsplits =
+000438b0: 205b 6469 765d 202a 2064 662e 6e70 6172   [div] * df.npar
+000438c0: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
+000438d0: 2020 2020 6e73 706c 6974 735b 2d31 5d20      nsplits[-1] 
+000438e0: 2b3d 206d 6f64 0a20 2020 2020 2020 2020  += mod.         
+000438f0: 2020 2072 6574 7572 6e20 5f73 706c 6974     return _split
+00043900: 5f70 6172 7469 7469 6f6e 7328 6466 2c20  _partitions(df, 
+00043910: 6e73 706c 6974 732c 206e 6577 5f6e 616d  nsplits, new_nam
+00043920: 6529 0a0a 0a64 6566 205f 7265 7061 7274  e)...def _repart
+00043930: 6974 696f 6e5f 6672 6f6d 5f62 6f75 6e64  ition_from_bound
+00043940: 6172 6965 7328 6466 2c20 6e65 775f 7061  aries(df, new_pa
+00043950: 7274 6974 696f 6e73 5f62 6f75 6e64 6172  rtitions_boundar
+00043960: 6965 732c 206e 6577 5f6e 616d 6529 3a0a  ies, new_name):.
+00043970: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00043980: 7461 6e63 6528 6e65 775f 7061 7274 6974  tance(new_partit
+00043990: 696f 6e73 5f62 6f75 6e64 6172 6965 732c  ions_boundaries,
+000439a0: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
+000439b0: 6e65 775f 7061 7274 6974 696f 6e73 5f62  new_partitions_b
+000439c0: 6f75 6e64 6172 6965 7320 3d20 6c69 7374  oundaries = list
+000439d0: 286e 6577 5f70 6172 7469 7469 6f6e 735f  (new_partitions_
+000439e0: 626f 756e 6461 7269 6573 290a 2020 2020  boundaries).    
+000439f0: 6966 206e 6577 5f70 6172 7469 7469 6f6e  if new_partition
+00043a00: 735f 626f 756e 6461 7269 6573 5b30 5d20  s_boundaries[0] 
+00043a10: 3e20 303a 0a20 2020 2020 2020 206e 6577  > 0:.        new
+00043a20: 5f70 6172 7469 7469 6f6e 735f 626f 756e  _partitions_boun
+00043a30: 6461 7269 6573 2e69 6e73 6572 7428 302c  daries.insert(0,
+00043a40: 2030 290a 2020 2020 6966 206e 6577 5f70   0).    if new_p
+00043a50: 6172 7469 7469 6f6e 735f 626f 756e 6461  artitions_bounda
+00043a60: 7269 6573 5b2d 315d 203c 2064 662e 6e70  ries[-1] < df.np
+00043a70: 6172 7469 7469 6f6e 733a 0a20 2020 2020  artitions:.     
+00043a80: 2020 206e 6577 5f70 6172 7469 7469 6f6e     new_partition
+00043a90: 735f 626f 756e 6461 7269 6573 2e61 7070  s_boundaries.app
+00043aa0: 656e 6428 6466 2e6e 7061 7274 6974 696f  end(df.npartitio
+00043ab0: 6e73 290a 2020 2020 6473 6b20 3d20 7b7d  ns).    dsk = {}
+00043ac0: 0a20 2020 2066 6f72 2069 2c20 2873 7461  .    for i, (sta
+00043ad0: 7274 2c20 656e 6429 2069 6e20 656e 756d  rt, end) in enum
+00043ae0: 6572 6174 6528 0a20 2020 2020 2020 207a  erate(.        z
+00043af0: 6970 286e 6577 5f70 6172 7469 7469 6f6e  ip(new_partition
+00043b00: 735f 626f 756e 6461 7269 6573 2c20 6e65  s_boundaries, ne
+00043b10: 775f 7061 7274 6974 696f 6e73 5f62 6f75  w_partitions_bou
+00043b20: 6e64 6172 6965 735b 313a 5d29 0a20 2020  ndaries[1:]).   
+00043b30: 2029 3a0a 2020 2020 2020 2020 6473 6b5b   ):.        dsk[
+00043b40: 6e65 775f 6e61 6d65 2c20 695d 203d 2028  new_name, i] = (
+00043b50: 6d65 7468 6f64 732e 636f 6e63 6174 2c20  methods.concat, 
+00043b60: 5b28 6466 2e5f 6e61 6d65 2c20 6a29 2066  [(df._name, j) f
+00043b70: 6f72 206a 2069 6e20 7261 6e67 6528 7374  or j in range(st
+00043b80: 6172 742c 2065 6e64 295d 290a 2020 2020  art, end)]).    
+00043b90: 6469 7669 7369 6f6e 7320 3d20 5b64 662e  divisions = [df.
+00043ba0: 6469 7669 7369 6f6e 735b 695d 2066 6f72  divisions[i] for
+00043bb0: 2069 2069 6e20 6e65 775f 7061 7274 6974   i in new_partit
+00043bc0: 696f 6e73 5f62 6f75 6e64 6172 6965 735d  ions_boundaries]
+00043bd0: 0a20 2020 2067 7261 7068 203d 2048 6967  .    graph = Hig
+00043be0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+00043bf0: 5f63 6f6c 6c65 6374 696f 6e73 286e 6577  _collections(new
+00043c00: 5f6e 616d 652c 2064 736b 2c20 6465 7065  _name, dsk, depe
+00043c10: 6e64 656e 6369 6573 3d5b 6466 5d29 0a20  ndencies=[df]). 
+00043c20: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
+00043c30: 5f6f 626a 6563 7428 6772 6170 682c 206e  _object(graph, n
+00043c40: 6577 5f6e 616d 652c 2064 662e 5f6d 6574  ew_name, df._met
+00043c50: 612c 2064 6976 6973 696f 6e73 290a 0a0a  a, divisions)...
+00043c60: 6465 6620 5f73 706c 6974 5f70 6172 7469  def _split_parti
+00043c70: 7469 6f6e 7328 6466 2c20 6e73 706c 6974  tions(df, nsplit
+00043c80: 732c 206e 6577 5f6e 616d 6529 3a0a 2020  s, new_name):.  
+00043c90: 2020 2222 2253 706c 6974 2061 2044 6173    """Split a Das
+00043ca0: 6b20 6461 7461 6672 616d 6520 696e 746f  k dataframe into
+00043cb0: 206e 6577 2070 6172 7469 7469 6f6e 730a   new partitions.
+00043cc0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00043cd0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00043ce0: 2020 2064 663a 2044 6174 6146 7261 6d65     df: DataFrame
+00043cf0: 206f 7220 5365 7269 6573 0a20 2020 206e   or Series.    n
+00043d00: 7370 6c69 7473 3a20 4c69 7374 5b69 6e74  splits: List[int
+00043d10: 5d0a 2020 2020 2020 2020 4e75 6d62 6572  ].        Number
+00043d20: 206f 6620 7461 7267 6574 2064 6174 6166   of target dataf
+00043d30: 7261 6d65 7320 666f 7220 6561 6368 2070  rames for each p
+00043d40: 6172 7469 7469 6f6e 0a20 2020 2020 2020  artition.       
+00043d50: 2054 6865 206c 656e 6774 6820 6f66 206e   The length of n
+00043d60: 7370 6c69 7473 2073 686f 756c 6420 6265  splits should be
+00043d70: 2074 6865 2073 616d 6520 6173 2064 662e   the same as df.
+00043d80: 6e70 6172 7469 7469 6f6e 730a 2020 2020  npartitions.    
+00043d90: 6e65 775f 6e61 6d65 3a20 7374 720a 0a20  new_name: str.. 
+00043da0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+00043db0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2072 6570  --------.    rep
+00043dc0: 6172 7469 7469 6f6e 5f6e 7061 7274 6974  artition_npartit
+00043dd0: 696f 6e73 0a20 2020 2072 6570 6172 7469  ions.    reparti
+00043de0: 7469 6f6e 5f73 697a 650a 2020 2020 2222  tion_size.    ""
+00043df0: 220a 2020 2020 6966 206c 656e 286e 7370  ".    if len(nsp
+00043e00: 6c69 7473 2920 213d 2064 662e 6e70 6172  lits) != df.npar
+00043e10: 7469 7469 6f6e 733a 0a20 2020 2020 2020  titions:.       
+00043e20: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00043e30: 7228 6622 6e73 706c 6974 7320 7368 6f75  r(f"nsplits shou
+00043e40: 6c64 2068 6176 6520 6c65 6e3d 7b64 662e  ld have len={df.
+00043e50: 6e70 6172 7469 7469 6f6e 737d 2229 0a0a  npartitions}")..
+00043e60: 2020 2020 6473 6b20 3d20 7b7d 0a20 2020      dsk = {}.   
+00043e70: 2073 706c 6974 5f6e 616d 6520 3d20 6622   split_name = f"
+00043e80: 7370 6c69 742d 7b74 6f6b 656e 697a 6528  split-{tokenize(
+00043e90: 6466 2c20 6e73 706c 6974 7329 7d22 0a20  df, nsplits)}". 
+00043ea0: 2020 206a 203d 2030 0a20 2020 2066 6f72     j = 0.    for
+00043eb0: 2069 2c20 6b20 696e 2065 6e75 6d65 7261   i, k in enumera
+00043ec0: 7465 286e 7370 6c69 7473 293a 0a20 2020  te(nsplits):.   
+00043ed0: 2020 2020 2069 6620 6b20 3d3d 2031 3a0a       if k == 1:.
+00043ee0: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
+00043ef0: 6e65 775f 6e61 6d65 2c20 6a5d 203d 2028  new_name, j] = (
+00043f00: 6466 2e5f 6e61 6d65 2c20 6929 0a20 2020  df._name, i).   
+00043f10: 2020 2020 2020 2020 206a 202b 3d20 310a           j += 1.
+00043f20: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00043f30: 2020 2020 2020 2020 2020 6473 6b5b 7370            dsk[sp
+00043f40: 6c69 745f 6e61 6d65 2c20 695d 203d 2028  lit_name, i] = (
+00043f50: 7370 6c69 745f 6576 656e 6c79 2c20 2864  split_evenly, (d
+00043f60: 662e 5f6e 616d 652c 2069 292c 206b 290a  f._name, i), k).
+00043f70: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00043f80: 6a6a 2069 6e20 7261 6e67 6528 6b29 3a0a  jj in range(k):.
+00043f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043fa0: 6473 6b5b 6e65 775f 6e61 6d65 2c20 6a5d  dsk[new_name, j]
+00043fb0: 203d 2028 6765 7469 7465 6d2c 2028 7370   = (getitem, (sp
+00043fc0: 6c69 745f 6e61 6d65 2c20 6929 2c20 6a6a  lit_name, i), jj
+00043fd0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00043fe0: 2020 6a20 2b3d 2031 0a0a 2020 2020 6469    j += 1..    di
+00043ff0: 7669 7369 6f6e 7320 3d20 5b4e 6f6e 655d  visions = [None]
+00044000: 202a 2028 3120 2b20 7375 6d28 6e73 706c   * (1 + sum(nspl
+00044010: 6974 7329 290a 2020 2020 6772 6170 6820  its)).    graph 
+00044020: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
+00044030: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
+00044040: 7328 6e65 775f 6e61 6d65 2c20 6473 6b2c  s(new_name, dsk,
+00044050: 2064 6570 656e 6465 6e63 6965 733d 5b64   dependencies=[d
+00044060: 665d 290a 2020 2020 7265 7475 726e 206e  f]).    return n
+00044070: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
+00044080: 7068 2c20 6e65 775f 6e61 6d65 2c20 6466  ph, new_name, df
+00044090: 2e5f 6d65 7461 2c20 6469 7669 7369 6f6e  ._meta, division
+000440a0: 7329 0a0a 0a64 6566 2072 6570 6172 7469  s)...def reparti
+000440b0: 7469 6f6e 2864 662c 2064 6976 6973 696f  tion(df, divisio
+000440c0: 6e73 3d4e 6f6e 652c 2066 6f72 6365 3d46  ns=None, force=F
+000440d0: 616c 7365 293a 0a20 2020 2022 2222 5265  alse):.    """Re
+000440e0: 7061 7274 6974 696f 6e20 6461 7461 6672  partition datafr
+000440f0: 616d 6520 616c 6f6e 6720 6e65 7720 6469  ame along new di
+00044100: 7669 7369 6f6e 730a 0a20 2020 2044 6173  visions..    Das
+00044110: 6b2e 4461 7461 4672 616d 6520 6f62 6a65  k.DataFrame obje
+00044120: 6374 7320 6172 6520 7061 7274 6974 696f  cts are partitio
+00044130: 6e65 6420 616c 6f6e 6720 7468 6569 7220  ned along their 
+00044140: 696e 6465 782e 2020 4f66 7465 6e20 7768  index.  Often wh
+00044150: 656e 0a20 2020 206d 756c 7469 706c 6520  en.    multiple 
+00044160: 6461 7461 6672 616d 6573 2069 6e74 6572  dataframes inter
+00044170: 6163 7420 7765 206e 6565 6420 746f 2061  act we need to a
+00044180: 6c69 676e 2074 6865 7365 2070 6172 7469  lign these parti
+00044190: 7469 6f6e 696e 6773 2e20 2054 6865 0a20  tionings.  The. 
+000441a0: 2020 2060 6072 6570 6172 7469 7469 6f6e     ``repartition
+000441b0: 6060 2066 756e 6374 696f 6e20 636f 6e73  `` function cons
+000441c0: 7472 7563 7473 2061 206e 6577 2044 6174  tructs a new Dat
+000441d0: 6146 7261 6d65 206f 626a 6563 7420 686f  aFrame object ho
+000441e0: 6c64 696e 6720 7468 6520 7361 6d65 0a20  lding the same. 
+000441f0: 2020 2064 6174 6120 6275 7420 7061 7274     data but part
+00044200: 6974 696f 6e65 6420 6f6e 2064 6966 6665  itioned on diffe
+00044210: 7265 6e74 2076 616c 7565 732e 2020 4974  rent values.  It
+00044220: 2064 6f65 7320 7468 6973 2062 7920 7065   does this by pe
+00044230: 7266 6f72 6d69 6e67 2061 0a20 2020 2073  rforming a.    s
+00044240: 6571 7565 6e63 6520 6f66 2060 606c 6f63  equence of ``loc
+00044250: 6060 2061 6e64 2060 6063 6f6e 6361 7460  `` and ``concat`
+00044260: 6020 6361 6c6c 7320 746f 2073 706c 6974  ` calls to split
+00044270: 2061 6e64 206d 6572 6765 2074 6865 2070   and merge the p
+00044280: 7265 7669 6f75 730a 2020 2020 6765 6e65  revious.    gene
+00044290: 7261 7469 6f6e 206f 6620 7061 7274 6974  ration of partit
+000442a0: 696f 6e73 2e0a 0a20 2020 2050 6172 616d  ions...    Param
+000442b0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+000442c0: 2d2d 2d2d 0a0a 2020 2020 6469 7669 7369  ----..    divisi
+000442d0: 6f6e 7320 3a20 6c69 7374 0a20 2020 2020  ons : list.     
+000442e0: 2020 204c 6973 7420 6f66 2070 6172 7469     List of parti
+000442f0: 7469 6f6e 7320 746f 2062 6520 7573 6564  tions to be used
+00044300: 0a20 2020 2066 6f72 6365 203a 2062 6f6f  .    force : boo
+00044310: 6c2c 2064 6566 6175 6c74 2046 616c 7365  l, default False
+00044320: 0a20 2020 2020 2020 2041 6c6c 6f77 7320  .        Allows 
+00044330: 7468 6520 6578 7061 6e73 696f 6e20 6f66  the expansion of
+00044340: 2074 6865 2065 7869 7374 696e 6720 6469   the existing di
+00044350: 7669 7369 6f6e 732e 0a20 2020 2020 2020  visions..       
+00044360: 2049 6620 4661 6c73 6520 7468 656e 2074   If False then t
+00044370: 6865 206e 6577 2064 6976 6973 696f 6e73  he new divisions
+00044380: 206c 6f77 6572 2061 6e64 2075 7070 6572   lower and upper
+00044390: 2062 6f75 6e64 7320 6d75 7374 2062 650a   bounds must be.
+000443a0: 2020 2020 2020 2020 7468 6520 7361 6d65          the same
+000443b0: 2061 7320 7468 6520 6f6c 6420 6469 7669   as the old divi
+000443c0: 7369 6f6e 732e 0a0a 2020 2020 4578 616d  sions...    Exam
+000443d0: 706c 6573 0a20 2020 202d 2d2d 2d2d 2d2d  ples.    -------
+000443e0: 2d0a 0a20 2020 203e 3e3e 2064 6620 3d20  -..    >>> df = 
+000443f0: 6466 2e72 6570 6172 7469 7469 6f6e 285b  df.repartition([
+00044400: 302c 2035 2c20 3130 2c20 3230 5d29 2020  0, 5, 10, 20])  
+00044410: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
+00044420: 0a0a 2020 2020 416c 736f 2077 6f72 6b73  ..    Also works
+00044430: 206f 6e20 5061 6e64 6173 206f 626a 6563   on Pandas objec
+00044440: 7473 0a0a 2020 2020 3e3e 3e20 6464 6620  ts..    >>> ddf 
+00044450: 3d20 6464 2e72 6570 6172 7469 7469 6f6e  = dd.repartition
+00044460: 2864 662c 205b 302c 2035 2c20 3130 2c20  (df, [0, 5, 10, 
+00044470: 3230 5d29 2020 2320 646f 6374 6573 743a  20])  # doctest:
+00044480: 202b 534b 4950 0a20 2020 2022 2222 0a0a   +SKIP.    """..
+00044490: 2020 2020 2320 6e6f 2d6f 7020 6661 7374      # no-op fast
+000444a0: 7061 7468 2066 6f72 2077 6865 6e20 7765  path for when we
+000444b0: 2061 6c72 6561 6479 2068 6176 6520 6d61   already have ma
+000444c0: 7463 6869 6e67 2064 6976 6973 696f 6e73  tching divisions
+000444d0: 0a20 2020 2069 6620 6973 5f64 6173 6b5f  .    if is_dask_
+000444e0: 636f 6c6c 6563 7469 6f6e 2864 6629 2061  collection(df) a
+000444f0: 6e64 2064 662e 6469 7669 7369 6f6e 7320  nd df.divisions 
+00044500: 3d3d 2064 6976 6973 696f 6e73 3a0a 2020  == divisions:.  
+00044510: 2020 2020 2020 7265 7475 726e 2064 660a        return df.
+00044520: 0a20 2020 2074 6f6b 656e 203d 2074 6f6b  .    token = tok
+00044530: 656e 697a 6528 6466 2c20 6469 7669 7369  enize(df, divisi
+00044540: 6f6e 7329 0a20 2020 2069 6620 6973 696e  ons).    if isin
+00044550: 7374 616e 6365 2864 662c 205f 4672 616d  stance(df, _Fram
+00044560: 6529 3a0a 2020 2020 2020 2020 746d 7020  e):.        tmp 
+00044570: 3d20 2272 6570 6172 7469 7469 6f6e 2d73  = "repartition-s
+00044580: 706c 6974 2d22 202b 2074 6f6b 656e 0a20  plit-" + token. 
+00044590: 2020 2020 2020 206f 7574 203d 2022 7265         out = "re
+000445a0: 7061 7274 6974 696f 6e2d 6d65 7267 652d  partition-merge-
+000445b0: 2220 2b20 746f 6b65 6e0a 2020 2020 2020  " + token.      
+000445c0: 2020 6473 6b20 3d20 7265 7061 7274 6974    dsk = repartit
+000445d0: 696f 6e5f 6469 7669 7369 6f6e 7328 0a20  ion_divisions(. 
+000445e0: 2020 2020 2020 2020 2020 2064 662e 6469             df.di
+000445f0: 7669 7369 6f6e 732c 2064 6976 6973 696f  visions, divisio
+00044600: 6e73 2c20 6466 2e5f 6e61 6d65 2c20 746d  ns, df._name, tm
+00044610: 702c 206f 7574 2c20 666f 7263 653d 666f  p, out, force=fo
+00044620: 7263 650a 2020 2020 2020 2020 290a 2020  rce.        ).  
+00044630: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
+00044640: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+00044650: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6f75  m_collections(ou
+00044660: 742c 2064 736b 2c20 6465 7065 6e64 656e  t, dsk, dependen
+00044670: 6369 6573 3d5b 6466 5d29 0a20 2020 2020  cies=[df]).     
+00044680: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
+00044690: 5f6f 626a 6563 7428 6772 6170 682c 206f  _object(graph, o
+000446a0: 7574 2c20 6466 2e5f 6d65 7461 2c20 6469  ut, df._meta, di
+000446b0: 7669 7369 6f6e 7329 0a20 2020 2065 6c69  visions).    eli
+000446c0: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
+000446d0: 696b 6528 6466 2920 6f72 2069 735f 7365  ike(df) or is_se
+000446e0: 7269 6573 5f6c 696b 6528 6466 293a 0a20  ries_like(df):. 
+000446f0: 2020 2020 2020 206e 616d 6520 3d20 2272         name = "r
+00044700: 6570 6172 7469 7469 6f6e 2d64 6174 6166  epartition-dataf
+00044710: 7261 6d65 2d22 202b 2074 6f6b 656e 0a20  rame-" + token. 
+00044720: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00044730: 2e64 6174 6166 7261 6d65 2e75 7469 6c73  .dataframe.utils
+00044740: 2069 6d70 6f72 7420 7368 6172 645f 6466   import shard_df
+00044750: 5f6f 6e5f 696e 6465 780a 0a20 2020 2020  _on_index..     
+00044760: 2020 2064 6673 203d 2073 6861 7264 5f64     dfs = shard_d
+00044770: 665f 6f6e 5f69 6e64 6578 2864 662c 2064  f_on_index(df, d
+00044780: 6976 6973 696f 6e73 5b31 3a2d 315d 290a  ivisions[1:-1]).
+00044790: 2020 2020 2020 2020 6473 6b20 3d20 7b28          dsk = {(
+000447a0: 6e61 6d65 2c20 6929 3a20 6466 2066 6f72  name, i): df for
+000447b0: 2069 2c20 6466 2069 6e20 656e 756d 6572   i, df in enumer
+000447c0: 6174 6528 6466 7329 7d0a 2020 2020 2020  ate(dfs)}.      
+000447d0: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
+000447e0: 6f62 6a65 6374 2864 736b 2c20 6e61 6d65  object(dsk, name
+000447f0: 2c20 6466 2c20 6469 7669 7369 6f6e 7329  , df, divisions)
+00044800: 0a20 2020 2072 6169 7365 2056 616c 7565  .    raise Value
+00044810: 4572 726f 7228 2244 6174 6120 6d75 7374  Error("Data must
+00044820: 2062 6520 4461 7461 4672 616d 6520 6f72   be DataFrame or
+00044830: 2053 6572 6965 7322 290a 0a0a 6465 6620   Series")...def 
+00044840: 5f72 6564 7563 7469 6f6e 5f63 6875 6e6b  _reduction_chunk
+00044850: 2878 2c20 6163 615f 6368 756e 6b3d 4e6f  (x, aca_chunk=No
+00044860: 6e65 2c20 2a2a 6b77 6172 6773 293a 0a20  ne, **kwargs):. 
+00044870: 2020 206f 203d 2061 6361 5f63 6875 6e6b     o = aca_chunk
+00044880: 2878 2c20 2a2a 6b77 6172 6773 290a 2020  (x, **kwargs).  
+00044890: 2020 2320 5265 7475 726e 2061 2064 6174    # Return a dat
+000448a0: 6166 7261 6d65 2073 6f20 7468 6174 2074  aframe so that t
+000448b0: 6865 2063 6f6e 6361 7465 6e61 7465 6420  he concatenated 
+000448c0: 7665 7273 696f 6e20 6973 2061 6c73 6f20  version is also 
+000448d0: 6120 6461 7461 6672 616d 650a 2020 2020  a dataframe.    
+000448e0: 6966 206e 6f74 2069 735f 7365 7269 6573  if not is_series
+000448f0: 5f6c 696b 6528 6f29 3a0a 2020 2020 2020  _like(o):.      
+00044900: 2020 7265 7475 726e 206f 0a20 2020 2072    return o.    r
+00044910: 6573 756c 7420 3d20 6f2e 746f 5f66 7261  esult = o.to_fra
+00044920: 6d65 2829 2e54 0a20 2020 2069 6620 6f2e  me().T.    if o.
+00044930: 6474 7970 652e 6b69 6e64 203d 3d20 224f  dtype.kind == "O
+00044940: 223a 0a20 2020 2020 2020 2023 2057 6173  ":.        # Was
+00044950: 2063 6f65 7263 6564 2074 6f20 6f62 6a65   coerced to obje
+00044960: 6374 2c20 736f 2063 6173 7420 6261 636b  ct, so cast back
+00044970: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00044980: 7265 7375 6c74 2e69 6e66 6572 5f6f 626a  result.infer_obj
+00044990: 6563 7473 2829 0a20 2020 2072 6574 7572  ects().    retur
+000449a0: 6e20 7265 7375 6c74 0a0a 0a64 6566 205f  n result...def _
+000449b0: 7265 6475 6374 696f 6e5f 636f 6d62 696e  reduction_combin
+000449c0: 6528 782c 2061 6361 5f63 6f6d 6269 6e65  e(x, aca_combine
+000449d0: 3d4e 6f6e 652c 202a 2a6b 7761 7267 7329  =None, **kwargs)
+000449e0: 3a0a 2020 2020 6966 2069 7369 6e73 7461  :.    if isinsta
+000449f0: 6e63 6528 782c 206c 6973 7429 3a0a 2020  nce(x, list):.  
+00044a00: 2020 2020 2020 7820 3d20 7064 2e53 6572        x = pd.Ser
+00044a10: 6965 7328 7829 0a20 2020 206f 203d 2061  ies(x).    o = a
+00044a20: 6361 5f63 6f6d 6269 6e65 2878 2c20 2a2a  ca_combine(x, **
+00044a30: 6b77 6172 6773 290a 2020 2020 2320 5265  kwargs).    # Re
+00044a40: 7475 726e 2061 2064 6174 6166 7261 6d65  turn a dataframe
+00044a50: 2073 6f20 7468 6174 2074 6865 2063 6f6e   so that the con
+00044a60: 6361 7465 6e61 7465 6420 7665 7273 696f  catenated versio
+00044a70: 6e20 6973 2061 6c73 6f20 6120 6461 7461  n is also a data
+00044a80: 6672 616d 650a 2020 2020 7265 7475 726e  frame.    return
+00044a90: 206f 2e74 6f5f 6672 616d 6528 292e 5420   o.to_frame().T 
+00044aa0: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
+00044ab0: 6528 6f29 2065 6c73 6520 6f0a 0a0a 6465  e(o) else o...de
+00044ac0: 6620 5f72 6564 7563 7469 6f6e 5f61 6767  f _reduction_agg
+00044ad0: 7265 6761 7465 2878 2c20 6163 615f 6167  regate(x, aca_ag
+00044ae0: 6772 6567 6174 653d 4e6f 6e65 2c20 2a2a  gregate=None, **
+00044af0: 6b77 6172 6773 293a 0a20 2020 2069 6620  kwargs):.    if 
+00044b00: 6973 696e 7374 616e 6365 2878 2c20 6c69  isinstance(x, li
+00044b10: 7374 293a 0a20 2020 2020 2020 2078 203d  st):.        x =
+00044b20: 2070 642e 5365 7269 6573 2878 290a 2020   pd.Series(x).  
+00044b30: 2020 7265 7475 726e 2061 6361 5f61 6767    return aca_agg
+00044b40: 7265 6761 7465 2878 2c20 2a2a 6b77 6172  regate(x, **kwar
+00044b50: 6773 290a 0a0a 6465 6620 6964 786d 6178  gs)...def idxmax
+00044b60: 6d69 6e5f 6368 756e 6b28 782c 2066 6e3d  min_chunk(x, fn=
+00044b70: 4e6f 6e65 2c20 736b 6970 6e61 3d54 7275  None, skipna=Tru
+00044b80: 6529 3a0a 2020 2020 6d69 6e6d 6178 203d  e):.    minmax =
+00044b90: 2022 6d61 7822 2069 6620 666e 203d 3d20   "max" if fn == 
+00044ba0: 2269 6478 6d61 7822 2065 6c73 6520 226d  "idxmax" else "m
+00044bb0: 696e 220a 2020 2020 6966 206c 656e 2878  in".    if len(x
+00044bc0: 2920 3e20 303a 0a20 2020 2020 2020 2069  ) > 0:.        i
+00044bd0: 6478 203d 2067 6574 6174 7472 2878 2c20  dx = getattr(x, 
+00044be0: 666e 2928 736b 6970 6e61 3d73 6b69 706e  fn)(skipna=skipn
+00044bf0: 6129 0a20 2020 2020 2020 2076 616c 7565  a).        value
+00044c00: 203d 2067 6574 6174 7472 2878 2c20 6d69   = getattr(x, mi
+00044c10: 6e6d 6178 2928 736b 6970 6e61 3d73 6b69  nmax)(skipna=ski
+00044c20: 706e 6129 0a20 2020 2065 6c73 653a 0a20  pna).    else:. 
+00044c30: 2020 2020 2020 2069 6478 203d 2076 616c         idx = val
+00044c40: 7565 203d 206d 6574 615f 7365 7269 6573  ue = meta_series
+00044c50: 5f63 6f6e 7374 7275 6374 6f72 2878 2928  _constructor(x)(
+00044c60: 5b5d 2c20 6474 7970 653d 2269 3822 290a  [], dtype="i8").
+00044c70: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
+00044c80: 5f6c 696b 6528 6964 7829 3a0a 2020 2020  _like(idx):.    
+00044c90: 2020 2020 7265 7475 726e 206d 6574 615f      return meta_
+00044ca0: 6672 616d 655f 636f 6e73 7472 7563 746f  frame_constructo
+00044cb0: 7228 7829 287b 2269 6478 223a 2069 6478  r(x)({"idx": idx
+00044cc0: 2c20 2276 616c 7565 223a 2076 616c 7565  , "value": value
+00044cd0: 7d29 0a20 2020 2072 6574 7572 6e20 6d65  }).    return me
+00044ce0: 7461 5f66 7261 6d65 5f63 6f6e 7374 7275  ta_frame_constru
+00044cf0: 6374 6f72 2878 2928 7b22 6964 7822 3a20  ctor(x)({"idx": 
+00044d00: 5b69 6478 5d2c 2022 7661 6c75 6522 3a20  [idx], "value": 
+00044d10: 5b76 616c 7565 5d7d 290a 0a0a 6465 6620  [value]})...def 
+00044d20: 6964 786d 6178 6d69 6e5f 726f 7728 782c  idxmaxmin_row(x,
+00044d30: 2066 6e3d 4e6f 6e65 2c20 736b 6970 6e61   fn=None, skipna
+00044d40: 3d54 7275 6529 3a0a 2020 2020 6d69 6e6d  =True):.    minm
+00044d50: 6178 203d 2022 6d61 7822 2069 6620 666e  ax = "max" if fn
+00044d60: 203d 3d20 2269 6478 6d61 7822 2065 6c73   == "idxmax" els
+00044d70: 6520 226d 696e 220a 2020 2020 6966 206c  e "min".    if l
+00044d80: 656e 2878 2920 3e20 303a 0a20 2020 2020  en(x) > 0:.     
+00044d90: 2020 2078 203d 2078 2e73 6574 5f69 6e64     x = x.set_ind
+00044da0: 6578 2822 6964 7822 290a 2020 2020 2020  ex("idx").      
+00044db0: 2020 6964 7820 3d20 5b67 6574 6174 7472    idx = [getattr
+00044dc0: 2878 2e76 616c 7565 2c20 666e 2928 736b  (x.value, fn)(sk
+00044dd0: 6970 6e61 3d73 6b69 706e 6129 5d0a 2020  ipna=skipna)].  
+00044de0: 2020 2020 2020 7661 6c75 6520 3d20 5b67        value = [g
+00044df0: 6574 6174 7472 2878 2e76 616c 7565 2c20  etattr(x.value, 
+00044e00: 6d69 6e6d 6178 2928 736b 6970 6e61 3d73  minmax)(skipna=s
+00044e10: 6b69 706e 6129 5d0a 2020 2020 656c 7365  kipna)].    else
+00044e20: 3a0a 2020 2020 2020 2020 6964 7820 3d20  :.        idx = 
+00044e30: 7661 6c75 6520 3d20 6d65 7461 5f73 6572  value = meta_ser
+00044e40: 6965 735f 636f 6e73 7472 7563 746f 7228  ies_constructor(
+00044e50: 7829 285b 5d2c 2064 7479 7065 3d22 6938  x)([], dtype="i8
+00044e60: 2229 0a20 2020 2072 6574 7572 6e20 6d65  ").    return me
+00044e70: 7461 5f66 7261 6d65 5f63 6f6e 7374 7275  ta_frame_constru
+00044e80: 6374 6f72 2878 2928 0a20 2020 2020 2020  ctor(x)(.       
+00044e90: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00044ea0: 6964 7822 3a20 6d65 7461 5f73 6572 6965  idx": meta_serie
+00044eb0: 735f 636f 6e73 7472 7563 746f 7228 7829  s_constructor(x)
+00044ec0: 2869 6478 2c20 6474 7970 653d 782e 696e  (idx, dtype=x.in
+00044ed0: 6465 782e 6474 7970 6529 2c0a 2020 2020  dex.dtype),.    
+00044ee0: 2020 2020 2020 2020 2276 616c 7565 223a          "value":
+00044ef0: 206d 6574 615f 7365 7269 6573 5f63 6f6e   meta_series_con
+00044f00: 7374 7275 6374 6f72 2878 2928 7661 6c75  structor(x)(valu
+00044f10: 652c 2064 7479 7065 3d78 2e64 7479 7065  e, dtype=x.dtype
+00044f20: 732e 696c 6f63 5b30 5d29 2c0a 2020 2020  s.iloc[0]),.    
+00044f30: 2020 2020 7d0a 2020 2020 290a 0a0a 6465      }.    )...de
+00044f40: 6620 6964 786d 6178 6d69 6e5f 636f 6d62  f idxmaxmin_comb
+00044f50: 696e 6528 782c 2066 6e3d 4e6f 6e65 2c20  ine(x, fn=None, 
+00044f60: 736b 6970 6e61 3d54 7275 6529 3a0a 2020  skipna=True):.  
+00044f70: 2020 6966 206c 656e 2878 2920 3c3d 2031    if len(x) <= 1
+00044f80: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00044f90: 2078 0a20 2020 2072 6574 7572 6e20 280a   x.    return (.
+00044fa0: 2020 2020 2020 2020 782e 6772 6f75 7062          x.groupb
+00044fb0: 7928 6c65 7665 6c3d 3029 0a20 2020 2020  y(level=0).     
+00044fc0: 2020 202e 6170 706c 7928 6964 786d 6178     .apply(idxmax
+00044fd0: 6d69 6e5f 726f 772c 2066 6e3d 666e 2c20  min_row, fn=fn, 
+00044fe0: 736b 6970 6e61 3d73 6b69 706e 6129 0a20  skipna=skipna). 
+00044ff0: 2020 2020 2020 202e 7265 7365 745f 696e         .reset_in
+00045000: 6465 7828 6c65 7665 6c3d 312c 2064 726f  dex(level=1, dro
+00045010: 703d 5472 7565 290a 2020 2020 290a 0a0a  p=True).    )...
+00045020: 6465 6620 6964 786d 6178 6d69 6e5f 6167  def idxmaxmin_ag
+00045030: 6728 782c 2066 6e3d 4e6f 6e65 2c20 736b  g(x, fn=None, sk
+00045040: 6970 6e61 3d54 7275 652c 2073 6361 6c61  ipna=True, scala
+00045050: 723d 4661 6c73 6529 3a0a 2020 2020 7265  r=False):.    re
+00045060: 7320 3d20 6964 786d 6178 6d69 6e5f 636f  s = idxmaxmin_co
+00045070: 6d62 696e 6528 782c 2066 6e2c 2073 6b69  mbine(x, fn, ski
+00045080: 706e 613d 736b 6970 6e61 295b 2269 6478  pna=skipna)["idx
+00045090: 225d 0a20 2020 2069 6620 6c65 6e28 7265  "].    if len(re
+000450a0: 7329 203d 3d20 303a 0a20 2020 2020 2020  s) == 0:.       
+000450b0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+000450c0: 7228 2261 7474 656d 7074 2074 6f20 6765  r("attempt to ge
+000450d0: 7420 6172 676d 6178 206f 6620 616e 2065  t argmax of an e
+000450e0: 6d70 7479 2073 6571 7565 6e63 6522 290a  mpty sequence").
+000450f0: 2020 2020 6966 2073 6361 6c61 723a 0a20      if scalar:. 
+00045100: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00045110: 735b 305d 0a20 2020 2072 6573 2e6e 616d  s[0].    res.nam
+00045120: 6520 3d20 4e6f 6e65 0a20 2020 2072 6574  e = None.    ret
+00045130: 7572 6e20 7265 730a 0a0a 6465 6620 5f6d  urn res...def _m
+00045140: 6f64 655f 6167 6772 6567 6174 6528 6466  ode_aggregate(df
+00045150: 2c20 6472 6f70 6e61 293a 0a20 2020 2076  , dropna):.    v
+00045160: 616c 7565 5f63 6f75 6e74 5f73 6572 6965  alue_count_serie
+00045170: 7320 3d20 6466 2e73 756d 2829 0a20 2020  s = df.sum().   
+00045180: 206d 6178 5f76 616c 203d 2076 616c 7565   max_val = value
+00045190: 5f63 6f75 6e74 5f73 6572 6965 732e 6d61  _count_series.ma
+000451a0: 7828 736b 6970 6e61 3d64 726f 706e 6129  x(skipna=dropna)
+000451b0: 0a20 2020 206d 6f64 655f 7365 7269 6573  .    mode_series
+000451c0: 203d 2028 0a20 2020 2020 2020 2076 616c   = (.        val
+000451d0: 7565 5f63 6f75 6e74 5f73 6572 6965 735b  ue_count_series[
+000451e0: 7661 6c75 655f 636f 756e 745f 7365 7269  value_count_seri
+000451f0: 6573 203d 3d20 6d61 785f 7661 6c5d 0a20  es == max_val]. 
+00045200: 2020 2020 2020 202e 696e 6465 782e 746f         .index.to
+00045210: 5f73 6572 6965 7328 290a 2020 2020 2020  _series().      
+00045220: 2020 2e73 6f72 745f 7661 6c75 6573 2829    .sort_values()
+00045230: 0a20 2020 2020 2020 202e 7265 7365 745f  .        .reset_
+00045240: 696e 6465 7828 6472 6f70 3d54 7275 6529  index(drop=True)
+00045250: 0a20 2020 2029 0a20 2020 2072 6574 7572  .    ).    retur
+00045260: 6e20 6d6f 6465 5f73 6572 6965 730a 0a0a  n mode_series...
+00045270: 6465 6620 5f63 6f75 6e74 5f61 6767 7265  def _count_aggre
+00045280: 6761 7465 2878 293a 0a20 2020 2072 6574  gate(x):.    ret
+00045290: 7572 6e20 782e 7375 6d28 292e 6173 7479  urn x.sum().asty
+000452a0: 7065 2822 696e 7436 3422 290a 0a0a 6465  pe("int64")...de
+000452b0: 6620 7361 6665 5f68 6561 6428 6466 2c20  f safe_head(df, 
+000452c0: 6e29 3a0a 2020 2020 7220 3d20 4d2e 6865  n):.    r = M.he
+000452d0: 6164 2864 662c 206e 290a 2020 2020 6966  ad(df, n).    if
+000452e0: 206c 656e 2872 2920 213d 206e 3a0a 2020   len(r) != n:.  
+000452f0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+00045300: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
+00045310: 2066 2249 6e73 7566 6669 6369 656e 7420   f"Insufficient 
+00045320: 656c 656d 656e 7473 2066 6f72 2060 6865  elements for `he
+00045330: 6164 602e 207b 6e7d 2065 6c65 6d65 6e74  ad`. {n} element
+00045340: 7320 7265 7175 6573 7465 642c 206f 6e6c  s requested, onl
+00045350: 7920 7b6c 656e 2872 297d 2022 0a20 2020  y {len(r)} ".   
+00045360: 2020 2020 2020 2020 2022 656c 656d 656e           "elemen
+00045370: 7473 2061 7661 696c 6162 6c65 2e20 5472  ts available. Tr
+00045380: 7920 7061 7373 696e 6720 6c61 7267 6572  y passing larger
+00045390: 2060 6e70 6172 7469 7469 6f6e 7360 2074   `npartitions` t
+000453a0: 6f20 6068 6561 6460 2e22 0a20 2020 2020  o `head`.".     
+000453b0: 2020 2029 0a20 2020 2072 6574 7572 6e20     ).    return 
+000453c0: 720a 0a0a 6465 6620 6d61 7962 655f 7368  r...def maybe_sh
+000453d0: 6966 745f 6469 7669 7369 6f6e 7328 6466  ift_divisions(df
+000453e0: 2c20 7065 7269 6f64 732c 2066 7265 7129  , periods, freq)
+000453f0: 3a0a 2020 2020 2222 224d 6179 6265 2073  :.    """Maybe s
+00045400: 6869 6674 2064 6976 6973 696f 6e73 2062  hift divisions b
+00045410: 7920 7065 7269 6f64 7320 6f66 2073 697a  y periods of siz
+00045420: 6520 6672 6571 0a0a 2020 2020 5573 6564  e freq..    Used
+00045430: 2074 6f20 7368 6966 7420 7468 6520 6469   to shift the di
+00045440: 7669 7369 6f6e 7320 666f 7220 7468 6520  visions for the 
+00045450: 6073 6869 6674 6020 6d65 7468 6f64 2e20  `shift` method. 
+00045460: 4966 2066 7265 7120 6973 6e27 7420 6120  If freq isn't a 
+00045470: 6669 7865 640a 2020 2020 7369 7a65 2028  fixed.    size (
+00045480: 6e6f 7420 616e 6368 6f72 6564 206f 7220  not anchored or 
+00045490: 7265 6c61 7469 7665 292c 2074 6865 6e20  relative), then 
+000454a0: 7468 6520 6469 7669 7369 6f6e 7320 6172  the divisions ar
+000454b0: 6520 7368 6966 7465 640a 2020 2020 6170  e shifted.    ap
+000454c0: 7072 6f70 7269 6174 656c 792e 204f 7468  propriately. Oth
+000454d0: 6572 7769 7365 2074 6865 2064 6976 6973  erwise the divis
+000454e0: 696f 6e73 2061 7265 2063 6c65 6172 6564  ions are cleared
+000454f0: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+00045500: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00045510: 0a20 2020 2064 6620 3a20 6464 2e44 6174  .    df : dd.Dat
+00045520: 6146 7261 6d65 2c20 6464 2e53 6572 6965  aFrame, dd.Serie
+00045530: 732c 206f 7220 6464 2e49 6e64 6578 0a20  s, or dd.Index. 
+00045540: 2020 2070 6572 696f 6473 203a 2069 6e74     periods : int
+00045550: 0a20 2020 2020 2020 2054 6865 206e 756d  .        The num
+00045560: 6265 7220 6f66 2070 6572 696f 6473 2074  ber of periods t
+00045570: 6f20 7368 6966 742e 0a20 2020 2066 7265  o shift..    fre
+00045580: 7120 3a20 4461 7465 4f66 6673 6574 2c20  q : DateOffset, 
+00045590: 7469 6d65 6465 6c74 612c 206f 7220 7469  timedelta, or ti
+000455a0: 6d65 2072 756c 6520 7374 7269 6e67 0a20  me rule string. 
+000455b0: 2020 2020 2020 2054 6865 2066 7265 7175         The frequ
+000455c0: 656e 6379 2074 6f20 7368 6966 7420 6279  ency to shift by
+000455d0: 2e0a 2020 2020 2222 220a 2020 2020 6966  ..    """.    if
+000455e0: 2069 7369 6e73 7461 6e63 6528 6672 6571   isinstance(freq
+000455f0: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
+00045600: 6672 6571 203d 2070 642e 7473 6572 6965  freq = pd.tserie
+00045610: 732e 6672 6571 7565 6e63 6965 732e 746f  s.frequencies.to
+00045620: 5f6f 6666 7365 7428 6672 6571 290a 0a20  _offset(freq).. 
+00045630: 2020 2069 735f 6f66 6673 6574 203d 2069     is_offset = i
+00045640: 7369 6e73 7461 6e63 6528 6672 6571 2c20  sinstance(freq, 
+00045650: 7064 2e44 6174 654f 6666 7365 7429 0a20  pd.DateOffset). 
+00045660: 2020 2069 6620 6973 5f6f 6666 7365 743a     if is_offset:
+00045670: 0a20 2020 2020 2020 2069 6620 6672 6571  .        if freq
+00045680: 2e69 735f 616e 6368 6f72 6564 2829 206f  .is_anchored() o
+00045690: 7220 6e6f 7420 6861 7361 7474 7228 6672  r not hasattr(fr
+000456a0: 6571 2c20 2264 656c 7461 2229 3a0a 2020  eq, "delta"):.  
+000456b0: 2020 2020 2020 2020 2020 2320 4361 6e27            # Can'
+000456c0: 7420 696e 6665 7220 6469 7669 7369 6f6e  t infer division
+000456d0: 7320 6f6e 2072 656c 6174 6976 6520 6f72  s on relative or
+000456e0: 2061 6e63 686f 7265 6420 6f66 6673 6574   anchored offset
+000456f0: 732c 2061 730a 2020 2020 2020 2020 2020  s, as.          
+00045700: 2020 2320 6469 7669 7369 6f6e 7320 6d61    # divisions ma
+00045710: 7920 6e6f 7720 7370 6c69 7420 6964 656e  y now split iden
+00045720: 7469 6361 6c20 696e 6465 7820 7661 6c75  tical index valu
+00045730: 652e 0a20 2020 2020 2020 2020 2020 2023  e..            #
+00045740: 2028 652e 672e 2069 6e64 6578 5f70 6172   (e.g. index_par
+00045750: 7469 7469 6f6e 7320 3d20 5b5b 312c 2032  titions = [[1, 2
+00045760: 2c20 335d 2c20 5b33 2c20 342c 2035 5d5d  , 3], [3, 4, 5]]
+00045770: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00045780: 7475 726e 2064 662e 636c 6561 725f 6469  turn df.clear_di
+00045790: 7669 7369 6f6e 7328 290a 2020 2020 6966  visions().    if
+000457a0: 2064 662e 6b6e 6f77 6e5f 6469 7669 7369   df.known_divisi
+000457b0: 6f6e 733a 0a20 2020 2020 2020 2064 6976  ons:.        div
+000457c0: 7320 3d20 7064 2e53 6572 6965 7328 7261  s = pd.Series(ra
+000457d0: 6e67 6528 6c65 6e28 6466 2e64 6976 6973  nge(len(df.divis
+000457e0: 696f 6e73 2929 2c20 696e 6465 783d 6466  ions)), index=df
+000457f0: 2e64 6976 6973 696f 6e73 290a 2020 2020  .divisions).    
+00045800: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+00045810: 6469 7673 2e73 6869 6674 2870 6572 696f  divs.shift(perio
+00045820: 6473 2c20 6672 6571 3d66 7265 7129 2e69  ds, freq=freq).i
+00045830: 6e64 6578 0a20 2020 2020 2020 2072 6574  ndex.        ret
+00045840: 7572 6e20 6466 2e5f 5f63 6c61 7373 5f5f  urn df.__class__
+00045850: 2864 662e 6461 736b 2c20 6466 2e5f 6e61  (df.dask, df._na
+00045860: 6d65 2c20 6466 2e5f 6d65 7461 2c20 6469  me, df._meta, di
+00045870: 7669 7369 6f6e 7329 0a20 2020 2072 6574  visions).    ret
+00045880: 7572 6e20 6466 0a0a 0a40 7772 6170 7328  urn df...@wraps(
+00045890: 7064 2e74 6f5f 6461 7465 7469 6d65 290a  pd.to_datetime).
+000458a0: 6465 6620 746f 5f64 6174 6574 696d 6528  def to_datetime(
+000458b0: 6172 672c 206d 6574 613d 4e6f 6e65 2c20  arg, meta=None, 
+000458c0: 2a2a 6b77 6172 6773 293a 0a20 2020 2074  **kwargs):.    t
+000458d0: 7a5f 6b77 6172 6720 3d20 7b22 747a 223a  z_kwarg = {"tz":
+000458e0: 2022 7574 6322 7d20 6966 206b 7761 7267   "utc"} if kwarg
+000458f0: 732e 6765 7428 2275 7463 2229 2065 6c73  s.get("utc") els
+00045900: 6520 7b7d 0a20 2020 2069 6620 6d65 7461  e {}.    if meta
+00045910: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00045920: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00045930: 6172 672c 2049 6e64 6578 293a 0a20 2020  arg, Index):.   
+00045940: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+00045950: 7064 2e44 6174 6574 696d 6549 6e64 6578  pd.DatetimeIndex
+00045960: 285b 5d2c 202a 2a74 7a5f 6b77 6172 6729  ([], **tz_kwarg)
+00045970: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00045980: 612e 6e61 6d65 203d 2061 7267 2e6e 616d  a.name = arg.nam
+00045990: 650a 2020 2020 2020 2020 656c 6966 206e  e.        elif n
+000459a0: 6f74 2028 6973 5f64 6174 6166 7261 6d65  ot (is_dataframe
+000459b0: 5f6c 696b 6528 6172 6729 206f 7220 6973  _like(arg) or is
+000459c0: 5f73 6572 6965 735f 6c69 6b65 2861 7267  _series_like(arg
+000459d0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+000459e0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+000459f0: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
+00045a00: 2020 2020 2020 2020 2020 2022 6461 736b             "dask
+00045a10: 2e64 6174 6166 7261 6d65 2e74 6f5f 6461  .dataframe.to_da
+00045a20: 7465 7469 6d65 2064 6f65 7320 6e6f 7420  tetime does not 
+00045a30: 7375 7070 6f72 7420 220a 2020 2020 2020  support ".      
+00045a40: 2020 2020 2020 2020 2020 226e 6f6e 2d69            "non-i
+00045a50: 6e64 6578 2d61 626c 6520 6172 6775 6d65  ndex-able argume
+00045a60: 6e74 7320 286c 696b 6520 7363 616c 6172  nts (like scalar
+00045a70: 7329 220a 2020 2020 2020 2020 2020 2020  s)".            
+00045a80: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00045a90: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00045aa0: 203d 206d 6574 615f 7365 7269 6573 5f63   = meta_series_c
+00045ab0: 6f6e 7374 7275 6374 6f72 2861 7267 2928  onstructor(arg)(
+00045ac0: 5b70 642e 5469 6d65 7374 616d 7028 2232  [pd.Timestamp("2
+00045ad0: 3030 3022 2c20 2a2a 747a 5f6b 7761 7267  000", **tz_kwarg
+00045ae0: 295d 290a 2020 2020 2020 2020 2020 2020  )]).            
+00045af0: 6d65 7461 2e69 6e64 6578 203d 206d 6574  meta.index = met
+00045b00: 612e 696e 6465 782e 6173 7479 7065 2861  a.index.astype(a
+00045b10: 7267 2e69 6e64 6578 2e64 7479 7065 290a  rg.index.dtype).
+00045b20: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00045b30: 2e69 6e64 6578 2e6e 616d 6520 3d20 6172  .index.name = ar
+00045b40: 672e 696e 6465 782e 6e61 6d65 0a20 2020  g.index.name.   
+00045b50: 2069 6620 5041 4e44 4153 5f47 545f 3230   if PANDAS_GT_20
+00045b60: 3020 616e 6420 2269 6e66 6572 5f64 6174  0 and "infer_dat
+00045b70: 6574 696d 655f 666f 726d 6174 2220 696e  etime_format" in
+00045b80: 206b 7761 7267 733a 0a20 2020 2020 2020   kwargs:.       
+00045b90: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
+00045ba0: 2020 2020 2020 2020 2020 2020 2254 6865              "The
+00045bb0: 2061 7267 756d 656e 7420 2769 6e66 6572   argument 'infer
+00045bc0: 5f64 6174 6574 696d 655f 666f 726d 6174  _datetime_format
+00045bd0: 2720 6973 2064 6570 7265 6361 7465 6420  ' is deprecated 
+00045be0: 616e 6420 7769 6c6c 2062 6520 7265 6d6f  and will be remo
+00045bf0: 7665 6420 696e 2061 2066 7574 7572 6520  ved in a future 
+00045c00: 7665 7273 696f 6e2e 2022 0a20 2020 2020  version. ".     
+00045c10: 2020 2020 2020 2022 4120 7374 7269 6374         "A strict
+00045c20: 2076 6572 7369 6f6e 206f 6620 6974 2069   version of it i
+00045c30: 7320 6e6f 7720 7468 6520 6465 6661 756c  s now the defaul
+00045c40: 742c 2073 6565 2022 0a20 2020 2020 2020  t, see ".       
+00045c50: 2020 2020 2022 6874 7470 733a 2f2f 7061       "https://pa
+00045c60: 6e64 6173 2e70 7964 6174 612e 6f72 672f  ndas.pydata.org/
+00045c70: 7064 6570 732f 3030 3034 2d63 6f6e 7369  pdeps/0004-consi
+00045c80: 7374 656e 742d 746f 2d64 6174 6574 696d  stent-to-datetim
+00045c90: 652d 7061 7273 696e 672e 6874 6d6c 2e20  e-parsing.html. 
+00045ca0: 220a 2020 2020 2020 2020 2020 2020 2259  ".            "Y
+00045cb0: 6f75 2063 616e 2073 6166 656c 7920 7265  ou can safely re
+00045cc0: 6d6f 7665 2074 6869 7320 6172 6775 6d65  move this argume
+00045cd0: 6e74 2e22 2c0a 2020 2020 2020 2020 2020  nt.",.          
+00045ce0: 2020 5573 6572 5761 726e 696e 672c 0a20    UserWarning,. 
+00045cf0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00045d00: 206b 7761 7267 732e 706f 7028 2269 6e66   kwargs.pop("inf
+00045d10: 6572 5f64 6174 6574 696d 655f 666f 726d  er_datetime_form
+00045d20: 6174 2229 0a0a 2020 2020 7265 7475 726e  at")..    return
+00045d30: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
+00045d40: 7064 2e74 6f5f 6461 7465 7469 6d65 2c20  pd.to_datetime, 
+00045d50: 6172 672c 206d 6574 613d 6d65 7461 2c20  arg, meta=meta, 
+00045d60: 2a2a 6b77 6172 6773 290a 0a0a 4077 7261  **kwargs)...@wra
+00045d70: 7073 2870 642e 746f 5f74 696d 6564 656c  ps(pd.to_timedel
+00045d80: 7461 290a 6465 6620 746f 5f74 696d 6564  ta).def to_timed
+00045d90: 656c 7461 2861 7267 2c20 756e 6974 3d4e  elta(arg, unit=N
+00045da0: 6f6e 652c 2065 7272 6f72 733d 2272 6169  one, errors="rai
+00045db0: 7365 2229 3a0a 2020 2020 6d65 7461 203d  se"):.    meta =
+00045dc0: 206d 6574 615f 7365 7269 6573 5f63 6f6e   meta_series_con
+00045dd0: 7374 7275 6374 6f72 2861 7267 2928 5b70  structor(arg)([p
+00045de0: 642e 5469 6d65 6465 6c74 6128 312c 2075  d.Timedelta(1, u
+00045df0: 6e69 743d 756e 6974 295d 290a 2020 2020  nit=unit)]).    
+00045e00: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
+00045e10: 7469 6f6e 7328 7064 2e74 6f5f 7469 6d65  tions(pd.to_time
+00045e20: 6465 6c74 612c 2061 7267 2c20 756e 6974  delta, arg, unit
+00045e30: 3d75 6e69 742c 2065 7272 6f72 733d 6572  =unit, errors=er
+00045e40: 726f 7273 2c20 6d65 7461 3d6d 6574 6129  rors, meta=meta)
+00045e50: 0a0a 0a69 6620 6861 7361 7474 7228 7064  ...if hasattr(pd
+00045e60: 2c20 2269 736e 6122 293a 0a0a 2020 2020  , "isna"):..    
+00045e70: 4077 7261 7073 2870 642e 6973 6e61 290a  @wraps(pd.isna).
+00045e80: 2020 2020 6465 6620 6973 6e61 2861 7267      def isna(arg
+00045e90: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00045ea0: 6e20 6d61 705f 7061 7274 6974 696f 6e73  n map_partitions
+00045eb0: 2870 642e 6973 6e61 2c20 6172 6729 0a0a  (pd.isna, arg)..
+00045ec0: 0a64 6566 205f 7265 7072 5f64 6174 615f  .def _repr_data_
+00045ed0: 7365 7269 6573 2873 2c20 696e 6465 7829  series(s, index)
+00045ee0: 3a0a 2020 2020 2222 2241 2068 656c 7065  :.    """A helpe
+00045ef0: 7220 666f 7220 6372 6561 7469 6e67 2074  r for creating t
+00045f00: 6865 2060 605f 7265 7072 5f64 6174 6160  he ``_repr_data`
+00045f10: 6020 7072 6f70 6572 7479 2222 220a 2020  ` property""".  
+00045f20: 2020 6e70 6172 7469 7469 6f6e 7320 3d20    npartitions = 
+00045f30: 6c65 6e28 696e 6465 7829 202d 2031 0a20  len(index) - 1. 
+00045f40: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00045f50: 2873 2e64 7479 7065 2c20 7064 2e43 6174  (s.dtype, pd.Cat
+00045f60: 6567 6f72 6963 616c 4474 7970 6529 3a0a  egoricalDtype):.
+00045f70: 2020 2020 2020 2020 6966 2068 6173 5f6b          if has_k
+00045f80: 6e6f 776e 5f63 6174 6567 6f72 6965 7328  nown_categories(
+00045f90: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00045fa0: 6474 7970 6520 3d20 2263 6174 6567 6f72  dtype = "categor
+00045fb0: 795b 6b6e 6f77 6e5d 220a 2020 2020 2020  y[known]".      
+00045fc0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00045fd0: 2020 2020 6474 7970 6520 3d20 2263 6174      dtype = "cat
+00045fe0: 6567 6f72 795b 756e 6b6e 6f77 6e5d 220a  egory[unknown]".
+00045ff0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00046000: 2020 6474 7970 6520 3d20 7374 7228 732e    dtype = str(s.
+00046010: 6474 7970 6529 0a20 2020 2072 6574 7572  dtype).    retur
+00046020: 6e20 7064 2e53 6572 6965 7328 5b64 7479  n pd.Series([dty
+00046030: 7065 5d20 2b20 5b22 2e2e 2e22 5d20 2a20  pe] + ["..."] * 
+00046040: 6e70 6172 7469 7469 6f6e 732c 2069 6e64  npartitions, ind
+00046050: 6578 3d69 6e64 6578 2c20 6e61 6d65 3d73  ex=index, name=s
+00046060: 2e6e 616d 6529 0a0a 0a64 6566 2068 6173  .name)...def has
+00046070: 5f70 6172 616c 6c65 6c5f 7479 7065 2878  _parallel_type(x
+00046080: 293a 0a20 2020 2022 2222 446f 6573 2074  ):.    """Does t
+00046090: 6869 7320 6f62 6a65 6374 2068 6176 6520  his object have 
+000460a0: 6120 6461 736b 2064 6174 6166 7261 6d65  a dask dataframe
+000460b0: 2065 7175 6976 616c 656e 743f 2222 220a   equivalent?""".
+000460c0: 2020 2020 7265 7475 726e 2067 6574 5f70      return get_p
+000460d0: 6172 616c 6c65 6c5f 7479 7065 2878 2920  arallel_type(x) 
+000460e0: 6973 206e 6f74 2053 6361 6c61 720a 0a0a  is not Scalar...
+000460f0: 6465 6620 6e65 775f 6464 5f6f 626a 6563  def new_dd_objec
+00046100: 7428 6473 6b2c 206e 616d 652c 206d 6574  t(dsk, name, met
+00046110: 612c 2064 6976 6973 696f 6e73 2c20 7061  a, divisions, pa
+00046120: 7265 6e74 5f6d 6574 613d 4e6f 6e65 293a  rent_meta=None):
+00046130: 0a20 2020 2022 2222 4765 6e65 7269 6320  .    """Generic 
+00046140: 636f 6e73 7472 7563 746f 7220 666f 7220  constructor for 
+00046150: 6461 736b 2e64 6174 6166 7261 6d65 206f  dask.dataframe o
+00046160: 626a 6563 7473 2e0a 0a20 2020 2044 6563  bjects...    Dec
+00046170: 6964 6573 2074 6865 2061 7070 726f 7072  ides the appropr
+00046180: 6961 7465 206f 7574 7075 7420 636c 6173  iate output clas
+00046190: 7320 6261 7365 6420 6f6e 2074 6865 2074  s based on the t
+000461a0: 7970 6520 6f66 2060 6d65 7461 6020 7072  ype of `meta` pr
+000461b0: 6f76 6964 6564 2e0a 2020 2020 2222 220a  ovided..    """.
+000461c0: 2020 2020 6966 2068 6173 5f70 6172 616c      if has_paral
+000461d0: 6c65 6c5f 7479 7065 286d 6574 6129 3a0a  lel_type(meta):.
+000461e0: 2020 2020 2020 2020 7265 7475 726e 2067          return g
+000461f0: 6574 5f70 6172 616c 6c65 6c5f 7479 7065  et_parallel_type
+00046200: 286d 6574 6129 2864 736b 2c20 6e61 6d65  (meta)(dsk, name
+00046210: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
+00046220: 7329 0a20 2020 2065 6c69 6620 6973 5f61  s).    elif is_a
+00046230: 7272 6179 6c69 6b65 286d 6574 6129 2061  rraylike(meta) a
+00046240: 6e64 206d 6574 612e 7368 6170 653a 0a20  nd meta.shape:. 
+00046250: 2020 2020 2020 2069 6d70 6f72 7420 6461         import da
+00046260: 736b 2e61 7272 6179 2061 7320 6461 0a0a  sk.array as da..
+00046270: 2020 2020 2020 2020 6368 756e 6b73 203d          chunks =
+00046280: 2028 286e 702e 6e61 6e2c 2920 2a20 286c   ((np.nan,) * (l
+00046290: 656e 2864 6976 6973 696f 6e73 2920 2d20  en(divisions) - 
+000462a0: 3129 2c29 202b 2074 7570 6c65 280a 2020  1),) + tuple(.  
+000462b0: 2020 2020 2020 2020 2020 2864 2c29 2066            (d,) f
+000462c0: 6f72 2064 2069 6e20 6d65 7461 2e73 6861  or d in meta.sha
+000462d0: 7065 5b31 3a5d 0a20 2020 2020 2020 2029  pe[1:].        )
+000462e0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+000462f0: 6368 756e 6b73 2920 3e20 313a 0a20 2020  chunks) > 1:.   
+00046300: 2020 2020 2020 2020 206c 6179 6572 203d           layer =
+00046310: 2064 736b 2e6c 6179 6572 735b 6e61 6d65   dsk.layers[name
+00046320: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+00046330: 2069 7369 6e73 7461 6e63 6528 6c61 7965   isinstance(laye
+00046340: 722c 2042 6c6f 636b 7769 7365 293a 0a20  r, Blockwise):. 
+00046350: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00046360: 6179 6572 2e6e 6577 5f61 7865 735b 226a  ayer.new_axes["j
+00046370: 225d 203d 2063 6875 6e6b 735b 315d 5b30  "] = chunks[1][0
+00046380: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00046390: 2020 6c61 7965 722e 6f75 7470 7574 5f69    layer.output_i
+000463a0: 6e64 6963 6573 203d 206c 6179 6572 2e6f  ndices = layer.o
+000463b0: 7574 7075 745f 696e 6469 6365 7320 2b20  utput_indices + 
+000463c0: 2822 6a22 2c29 0a20 2020 2020 2020 2020  ("j",).         
+000463d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000463e0: 2020 2020 2020 2020 2073 7566 6669 7820           suffix 
+000463f0: 3d20 2830 2c29 202a 2028 6c65 6e28 6368  = (0,) * (len(ch
+00046400: 756e 6b73 2920 2d20 3129 0a20 2020 2020  unks) - 1).     
+00046410: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00046420: 2069 6e20 7261 6e67 6528 6c65 6e28 6368   in range(len(ch
+00046430: 756e 6b73 5b30 5d29 293a 0a20 2020 2020  unks[0])):.     
+00046440: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00046450: 6179 6572 5b28 6e61 6d65 2c20 6929 202b  ayer[(name, i) +
+00046460: 2073 7566 6669 785d 203d 206c 6179 6572   suffix] = layer
+00046470: 2e70 6f70 2828 6e61 6d65 2c20 6929 290a  .pop((name, i)).
+00046480: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+00046490: 612e 4172 7261 7928 6473 6b2c 206e 616d  a.Array(dsk, nam
+000464a0: 653d 6e61 6d65 2c20 6368 756e 6b73 3d63  e=name, chunks=c
+000464b0: 6875 6e6b 732c 2064 7479 7065 3d6d 6574  hunks, dtype=met
+000464c0: 612e 6474 7970 6529 0a20 2020 2065 6c73  a.dtype).    els
+000464d0: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
+000464e0: 6e20 6765 745f 7061 7261 6c6c 656c 5f74  n get_parallel_t
+000464f0: 7970 6528 6d65 7461 2928 6473 6b2c 206e  ype(meta)(dsk, n
+00046500: 616d 652c 206d 6574 612c 2064 6976 6973  ame, meta, divis
+00046510: 696f 6e73 290a 0a0a 6465 6620 7061 7274  ions)...def part
+00046520: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
+00046530: 6675 6e63 2c20 6c61 7965 725f 6e61 6d65  func, layer_name
+00046540: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+00046550: 7329 3a0a 2020 2020 2222 220a 2020 2020  s):.    """.    
+00046560: 4170 706c 7920 6120 6675 6e63 7469 6f6e  Apply a function
+00046570: 2070 6172 7469 7469 6f6e 2d77 6973 6520   partition-wise 
+00046580: 6163 726f 7373 2061 7267 756d 656e 7473  across arguments
+00046590: 2074 6f20 6372 6561 7465 206c 6179 6572   to create layer
+000465a0: 206f 6620 6120 6772 6170 680a 0a20 2020   of a graph..   
+000465b0: 2054 6869 7320 6170 706c 6965 7320 6120   This applies a 
+000465c0: 6675 6e63 7469 6f6e 2c20 6060 6675 6e63  function, ``func
+000465d0: 6060 2c20 696e 2061 6e20 656d 6261 7272  ``, in an embarr
+000465e0: 6173 7369 6e67 6c79 2070 6172 616c 6c65  assingly paralle
+000465f0: 6c20 6661 7368 696f 6e0a 2020 2020 6163  l fashion.    ac
+00046600: 726f 7373 2070 6172 7469 7469 6f6e 732f  ross partitions/
+00046610: 6368 756e 6b73 2069 6e20 7468 6520 7072  chunks in the pr
+00046620: 6f76 6964 6564 2061 7267 756d 656e 7473  ovided arguments
+00046630: 2e20 2049 7420 6861 6e64 6c65 7320 4461  .  It handles Da
+00046640: 7461 6672 616d 6573 2c0a 2020 2020 4172  taframes,.    Ar
+00046650: 7261 7973 2c20 616e 6420 7363 616c 6172  rays, and scalar
+00046660: 7320 736d 6f6f 7468 6c79 2c20 616e 6420  s smoothly, and 
+00046670: 7265 6c69 6573 206f 6e20 7468 6520 6060  relies on the ``
+00046680: 626c 6f63 6b77 6973 6560 6020 6d61 6368  blockwise`` mach
+00046690: 696e 6572 790a 2020 2020 746f 2070 726f  inery.    to pro
+000466a0: 7669 6465 2061 206e 6963 656c 7920 7379  vide a nicely sy
+000466b0: 6d62 6f6c 6963 2067 7261 7068 2e0a 0a20  mbolic graph... 
+000466c0: 2020 2049 7420 6973 206d 6f73 7420 636f     It is most co
+000466d0: 6d6d 6f6e 6c79 2075 7365 6420 696e 206f  mmonly used in o
+000466e0: 7468 6572 2067 7261 7068 2d62 7569 6c64  ther graph-build
+000466f0: 696e 6720 6675 6e63 7469 6f6e 7320 746f  ing functions to
+00046700: 2063 7265 6174 6520 7468 650a 2020 2020   create the.    
+00046710: 6170 7072 6f70 7269 6174 6520 6c61 7965  appropriate laye
+00046720: 7220 6f66 2074 6865 2072 6573 756c 7469  r of the resulti
+00046730: 6e67 2064 6174 6166 7261 6d65 2e0a 0a20  ng dataframe... 
+00046740: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00046750: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00046760: 2066 756e 633a 2063 616c 6c61 626c 650a   func: callable.
+00046770: 2020 2020 6c61 7965 725f 6e61 6d65 3a20      layer_name: 
+00046780: 7374 720a 2020 2020 2020 2020 4465 7363  str.        Desc
+00046790: 7269 7074 6976 6520 6e61 6d65 2066 6f72  riptive name for
+000467a0: 2074 6865 206f 7065 7261 7469 6f6e 2e20   the operation. 
+000467b0: 5573 6564 2061 7320 7468 6520 6f75 7470  Used as the outp
+000467c0: 7574 206e 616d 650a 2020 2020 2020 2020  ut name.        
+000467d0: 696e 2074 6865 2072 6573 756c 7469 6e67  in the resulting
+000467e0: 2060 6042 6c6f 636b 7769 7365 6060 2067   ``Blockwise`` g
+000467f0: 7261 7068 206c 6179 6572 2e0a 2020 2020  raph layer..    
+00046800: 2a61 7267 733a 0a20 2020 202a 2a6b 7761  *args:.    **kwa
+00046810: 7267 733a 0a0a 2020 2020 5265 7475 726e  rgs:..    Return
+00046820: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+00046830: 2020 6f75 743a 2042 6c6f 636b 7769 7365    out: Blockwise
+00046840: 2067 7261 7068 0a0a 2020 2020 4578 616d   graph..    Exam
+00046850: 706c 6573 0a20 2020 202d 2d2d 2d2d 2d2d  ples.    -------
+00046860: 2d0a 2020 2020 3e3e 3e20 7375 6267 7261  -.    >>> subgra
+00046870: 7068 203d 2070 6172 7469 7469 6f6e 7769  ph = partitionwi
+00046880: 7365 5f67 7261 7068 2866 756e 6374 696f  se_graph(functio
+00046890: 6e2c 2078 2c20 792c 207a 3d31 3233 2920  n, x, y, z=123) 
+000468a0: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+000468b0: 500a 2020 2020 3e3e 3e20 6c61 7965 7220  P.    >>> layer 
+000468c0: 3d20 7061 7274 6974 696f 6e77 6973 655f  = partitionwise_
+000468d0: 6772 6170 6828 6675 6e63 7469 6f6e 2c20  graph(function, 
+000468e0: 6466 2c20 782c 207a 3d31 3233 2920 2023  df, x, z=123)  #
+000468f0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
+00046900: 2020 2020 3e3e 3e20 6772 6170 6820 3d20      >>> graph = 
+00046910: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
+00046920: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
+00046930: 6e61 6d65 2c20 6c61 7965 722c 2064 6570  name, layer, dep
+00046940: 656e 6465 6e63 6965 733d 5b64 662c 2078  endencies=[df, x
+00046950: 5d29 2020 2320 646f 6374 6573 743a 202b  ])  # doctest: +
+00046960: 534b 4950 0a20 2020 203e 3e3e 2072 6573  SKIP.    >>> res
+00046970: 756c 7420 3d20 6e65 775f 6464 5f6f 626a  ult = new_dd_obj
+00046980: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
+00046990: 206d 6574 6164 6174 612c 2064 662e 6469   metadata, df.di
+000469a0: 7669 7369 6f6e 7329 2020 2320 646f 6374  visions)  # doct
+000469b0: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
+000469c0: 5365 6520 416c 736f 0a20 2020 202d 2d2d  See Also.    ---
+000469d0: 2d2d 2d2d 2d0a 2020 2020 6d61 705f 7061  -----.    map_pa
+000469e0: 7274 6974 696f 6e73 0a20 2020 2022 2222  rtitions.    """
+000469f0: 0a20 2020 2070 6169 7273 203d 205b 5d0a  .    pairs = [].
+00046a00: 2020 2020 6e75 6d62 6c6f 636b 7320 3d20      numblocks = 
+00046a10: 7b7d 0a20 2020 2066 6f72 2061 7267 2069  {}.    for arg i
+00046a20: 6e20 6172 6773 3a0a 2020 2020 2020 2020  n args:.        
+00046a30: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
+00046a40: 672c 205f 4672 616d 6529 3a0a 2020 2020  g, _Frame):.    
+00046a50: 2020 2020 2020 2020 7061 6972 732e 6578          pairs.ex
+00046a60: 7465 6e64 285b 6172 672e 5f6e 616d 652c  tend([arg._name,
+00046a70: 2022 6922 5d29 0a20 2020 2020 2020 2020   "i"]).         
+00046a80: 2020 206e 756d 626c 6f63 6b73 5b61 7267     numblocks[arg
+00046a90: 2e5f 6e61 6d65 5d20 3d20 2861 7267 2e6e  ._name] = (arg.n
+00046aa0: 7061 7274 6974 696f 6e73 2c29 0a20 2020  partitions,).   
+00046ab0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
+00046ac0: 616e 6365 2861 7267 2c20 5363 616c 6172  ance(arg, Scalar
+00046ad0: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
+00046ae0: 6169 7273 2e65 7874 656e 6428 5b61 7267  airs.extend([arg
+00046af0: 2e5f 6e61 6d65 2c20 2269 225d 290a 2020  ._name, "i"]).  
+00046b00: 2020 2020 2020 2020 2020 6e75 6d62 6c6f            numblo
+00046b10: 636b 735b 6172 672e 5f6e 616d 655d 203d  cks[arg._name] =
+00046b20: 2028 312c 290a 2020 2020 2020 2020 656c   (1,).        el
+00046b30: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
+00046b40: 672c 2041 7272 6179 293a 0a20 2020 2020  g, Array):.     
+00046b50: 2020 2020 2020 2069 6620 6172 672e 6e64         if arg.nd
+00046b60: 696d 203d 3d20 313a 0a20 2020 2020 2020  im == 1:.       
+00046b70: 2020 2020 2020 2020 2070 6169 7273 2e65           pairs.e
+00046b80: 7874 656e 6428 5b61 7267 2e6e 616d 652c  xtend([arg.name,
+00046b90: 2022 6922 5d29 0a20 2020 2020 2020 2020   "i"]).         
+00046ba0: 2020 2065 6c69 6620 6172 672e 6e64 696d     elif arg.ndim
+00046bb0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00046bc0: 2020 2020 2020 2070 6169 7273 2e65 7874         pairs.ext
+00046bd0: 656e 6428 5b61 7267 2e6e 616d 652c 2022  end([arg.name, "
+00046be0: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
+00046bf0: 656c 6966 2061 7267 2e6e 6469 6d20 3d3d  elif arg.ndim ==
+00046c00: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+00046c10: 2020 2020 7061 6972 732e 6578 7465 6e64      pairs.extend
+00046c20: 285b 6172 672e 6e61 6d65 2c20 2269 6a22  ([arg.name, "ij"
+00046c30: 5d29 0a20 2020 2020 2020 2020 2020 2065  ]).            e
+00046c40: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00046c50: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00046c60: 4572 726f 7228 2243 616e 2774 2061 6464  Error("Can't add
+00046c70: 206d 756c 7469 2d64 696d 656e 7369 6f6e   multi-dimension
+00046c80: 616c 2061 7272 6179 2074 6f20 6461 7461  al array to data
+00046c90: 6672 616d 6573 2229 0a20 2020 2020 2020  frames").       
+00046ca0: 2020 2020 206e 756d 626c 6f63 6b73 5b61       numblocks[a
+00046cb0: 7267 2e5f 6e61 6d65 5d20 3d20 6172 672e  rg._name] = arg.
+00046cc0: 6e75 6d62 6c6f 636b 730a 2020 2020 2020  numblocks.      
+00046cd0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00046ce0: 6528 6172 672c 2042 6c6f 636b 7769 7365  e(arg, Blockwise
+00046cf0: 4465 7029 3a0a 2020 2020 2020 2020 2020  Dep):.          
+00046d00: 2020 6966 206c 656e 2861 7267 2e6e 756d    if len(arg.num
+00046d10: 626c 6f63 6b73 2920 3d3d 2031 3a0a 2020  blocks) == 1:.  
+00046d20: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00046d30: 6972 732e 6578 7465 6e64 285b 6172 672c  irs.extend([arg,
+00046d40: 2022 6922 5d29 0a20 2020 2020 2020 2020   "i"]).         
+00046d50: 2020 2065 6c69 6620 6c65 6e28 6172 672e     elif len(arg.
+00046d60: 6e75 6d62 6c6f 636b 7329 203d 3d20 323a  numblocks) == 2:
+00046d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00046d80: 2070 6169 7273 2e65 7874 656e 6428 5b61   pairs.extend([a
+00046d90: 7267 2c20 2269 6a22 5d29 0a20 2020 2020  rg, "ij"]).     
+00046da0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00046db0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00046dc0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+00046dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046de0: 2020 2066 2242 6c6f 636b 7769 7365 4465     f"BlockwiseDe
+00046df0: 7020 6172 6720 7b61 7267 2172 7d20 6861  p arg {arg!r} ha
+00046e00: 7320 7b6c 656e 2861 7267 2e6e 756d 626c  s {len(arg.numbl
+00046e10: 6f63 6b73 297d 2064 696d 656e 7369 6f6e  ocks)} dimension
+00046e20: 733b 206f 6e6c 7920 3120 6f72 2032 2061  s; only 1 or 2 a
+00046e30: 7265 2073 7570 706f 7274 6564 2e22 0a20  re supported.". 
+00046e40: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00046e50: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00046e60: 2020 2020 2020 2020 2020 2070 6169 7273             pairs
+00046e70: 2e65 7874 656e 6428 5b61 7267 2c20 4e6f  .extend([arg, No
+00046e80: 6e65 5d29 0a20 2020 2072 6574 7572 6e20  ne]).    return 
+00046e90: 626c 6f63 6b77 6973 6528 0a20 2020 2020  blockwise(.     
+00046ea0: 2020 2066 756e 632c 206c 6179 6572 5f6e     func, layer_n
+00046eb0: 616d 652c 2022 6922 2c20 2a70 6169 7273  ame, "i", *pairs
+00046ec0: 2c20 6e75 6d62 6c6f 636b 733d 6e75 6d62  , numblocks=numb
+00046ed0: 6c6f 636b 732c 2063 6f6e 6361 7465 6e61  locks, concatena
+00046ee0: 7465 3d54 7275 652c 202a 2a6b 7761 7267  te=True, **kwarg
+00046ef0: 730a 2020 2020 290a 0a0a 6465 6620 6d65  s.    )...def me
+00046f00: 7461 5f77 6172 6e69 6e67 2864 6629 3a0a  ta_warning(df):.
+00046f10: 2020 2020 2222 220a 2020 2020 5072 6f76      """.    Prov
+00046f20: 6964 6520 616e 2069 6e66 6f72 6d61 7469  ide an informati
+00046f30: 7665 206d 6573 7361 6765 2077 6865 6e20  ve message when 
+00046f40: 7468 6520 7573 6572 2069 7320 6173 6b65  the user is aske
+00046f50: 6420 746f 2070 726f 7669 6465 206d 6574  d to provide met
+00046f60: 6164 6174 610a 2020 2020 2222 220a 2020  adata.    """.  
+00046f70: 2020 6966 2069 735f 6461 7461 6672 616d    if is_datafram
+00046f80: 655f 6c69 6b65 2864 6629 3a0a 2020 2020  e_like(df):.    
+00046f90: 2020 2020 6d65 7461 5f73 7472 203d 207b      meta_str = {
+00046fa0: 6b3a 2073 7472 2876 2920 666f 7220 6b2c  k: str(v) for k,
+00046fb0: 2076 2069 6e20 6466 2e64 7479 7065 732e   v in df.dtypes.
+00046fc0: 746f 5f64 6963 7428 292e 6974 656d 7328  to_dict().items(
+00046fd0: 297d 0a20 2020 2065 6c69 6620 6973 5f73  )}.    elif is_s
+00046fe0: 6572 6965 735f 6c69 6b65 2864 6629 3a0a  eries_like(df):.
+00046ff0: 2020 2020 2020 2020 6d65 7461 5f73 7472          meta_str
+00047000: 203d 2028 6466 2e6e 616d 652c 2073 7472   = (df.name, str
+00047010: 2864 662e 6474 7970 6529 290a 2020 2020  (df.dtype)).    
+00047020: 656c 7365 3a0a 2020 2020 2020 2020 6d65  else:.        me
+00047030: 7461 5f73 7472 203d 204e 6f6e 650a 2020  ta_str = None.  
+00047040: 2020 6d73 6720 3d20 280a 2020 2020 2020    msg = (.      
+00047050: 2020 225c 6e59 6f75 2064 6964 206e 6f74    "\nYou did not
+00047060: 2070 726f 7669 6465 206d 6574 6164 6174   provide metadat
+00047070: 612c 2073 6f20 4461 736b 2069 7320 7275  a, so Dask is ru
+00047080: 6e6e 696e 6720 796f 7572 2022 0a20 2020  nning your ".   
+00047090: 2020 2020 2022 6675 6e63 7469 6f6e 206f       "function o
+000470a0: 6e20 6120 736d 616c 6c20 6461 7461 7365  n a small datase
+000470b0: 7420 746f 2067 7565 7373 206f 7574 7075  t to guess outpu
+000470c0: 7420 7479 7065 732e 2022 0a20 2020 2020  t types. ".     
+000470d0: 2020 2022 4974 2069 7320 706f 7373 6962     "It is possib
+000470e0: 6c65 2074 6861 7420 4461 736b 2077 696c  le that Dask wil
+000470f0: 6c20 6775 6573 7320 696e 636f 7272 6563  l guess incorrec
+00047100: 746c 792e 5c6e 220a 2020 2020 2020 2020  tly.\n".        
+00047110: 2254 6f20 7072 6f76 6964 6520 616e 2065  "To provide an e
+00047120: 7870 6c69 6369 7420 6f75 7470 7574 2074  xplicit output t
+00047130: 7970 6573 206f 7220 746f 2073 696c 656e  ypes or to silen
+00047140: 6365 2074 6869 7320 6d65 7373 6167 652c  ce this message,
+00047150: 2022 0a20 2020 2020 2020 2022 706c 6561   ".        "plea
+00047160: 7365 2070 726f 7669 6465 2074 6865 2060  se provide the `
+00047170: 6d65 7461 3d60 206b 6579 776f 7264 2c20  meta=` keyword, 
+00047180: 6173 2064 6573 6372 6962 6564 2069 6e20  as described in 
+00047190: 7468 6520 6d61 7020 6f72 2022 0a20 2020  the map or ".   
+000471a0: 2020 2020 2022 6170 706c 7920 6675 6e63       "apply func
+000471b0: 7469 6f6e 2074 6861 7420 796f 7520 6172  tion that you ar
+000471c0: 6520 7573 696e 672e 220a 2020 2020 290a  e using.".    ).
+000471d0: 2020 2020 6966 206d 6574 615f 7374 723a      if meta_str:
+000471e0: 0a20 2020 2020 2020 206d 7367 202b 3d20  .        msg += 
+000471f0: 280a 2020 2020 2020 2020 2020 2020 225c  (.            "\
+00047200: 6e22 0a20 2020 2020 2020 2020 2020 2022  n".            "
+00047210: 2020 4265 666f 7265 3a20 2e61 7070 6c79    Before: .apply
+00047220: 2866 756e 6329 5c6e 220a 2020 2020 2020  (func)\n".      
+00047230: 2020 2020 2020 2220 2041 6674 6572 3a20        "  After: 
+00047240: 202e 6170 706c 7928 6675 6e63 2c20 6d65   .apply(func, me
+00047250: 7461 3d25 7329 5c6e 2220 2520 7374 7228  ta=%s)\n" % str(
+00047260: 6d65 7461 5f73 7472 290a 2020 2020 2020  meta_str).      
+00047270: 2020 290a 2020 2020 7265 7475 726e 206d    ).    return m
+00047280: 7367 0a0a 0a64 6566 2070 7265 6669 785f  sg...def prefix_
+00047290: 7265 6475 6374 696f 6e28 662c 2064 6466  reduction(f, ddf
+000472a0: 2c20 6964 656e 7469 7479 2c20 2a2a 6b77  , identity, **kw
+000472b0: 6172 6773 293a 0a20 2020 2022 2222 436f  args):.    """Co
+000472c0: 6d70 7574 6573 2074 6865 2070 7265 6669  mputes the prefi
+000472d0: 7820 7375 6d73 206f 6620 6620 6f6e 2064  x sums of f on d
+000472e0: 660a 0a20 2020 2049 6620 6466 2068 6173  f..    If df has
+000472f0: 2070 6172 7469 7469 6f6e 7320 5b50 312c   partitions [P1,
+00047300: 2050 322c 202e 2e2e 2c20 506e 5d2c 2074   P2, ..., Pn], t
+00047310: 6865 6e20 7265 7475 726e 7320 7468 6520  hen returns the 
+00047320: 4461 7461 4672 616d 6520 7769 7468 0a20  DataFrame with. 
+00047330: 2020 2070 6172 7469 7469 6f6e 7320 5b66     partitions [f
+00047340: 2869 6465 6e74 6974 792c 2050 3129 2c0a  (identity, P1),.
+00047350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047360: 6628 6628 6964 656e 7469 7479 2c20 5031  f(f(identity, P1
+00047370: 292c 2050 3229 2c0a 2020 2020 2020 2020  ), P2),.        
+00047380: 2020 2020 2020 2020 6628 6628 6628 6964          f(f(f(id
+00047390: 656e 7469 7479 2c20 5031 292c 2050 3229  entity, P1), P2)
+000473a0: 2c20 5033 292c 0a20 2020 2020 2020 2020  , P3),.         
+000473b0: 2020 2020 2020 202e 2e2e 5d0a 0a20 2020         ...]..   
+000473c0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+000473d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066  ----------.    f
+000473e0: 203a 2063 616c 6c61 626c 650a 2020 2020   : callable.    
+000473f0: 2020 2020 616e 2061 7373 6f63 6961 7469      an associati
+00047400: 7665 2066 756e 6374 696f 6e20 660a 2020  ve function f.  
+00047410: 2020 6464 6620 3a20 6464 2e44 6174 6146    ddf : dd.DataF
+00047420: 7261 6d65 0a20 2020 2069 6465 6e74 6974  rame.    identit
+00047430: 7920 3a20 7064 2e44 6174 6146 7261 6d65  y : pd.DataFrame
+00047440: 0a20 2020 2020 2020 2061 6e20 6964 656e  .        an iden
+00047450: 7469 7479 2065 6c65 6d65 6e74 206f 6620  tity element of 
+00047460: 662c 2074 6861 7420 6973 2066 2869 6465  f, that is f(ide
+00047470: 6e74 6974 792c 2064 6629 203d 2066 2864  ntity, df) = f(d
+00047480: 662c 2069 6465 6e74 6974 7929 203d 2064  f, identity) = d
+00047490: 660a 2020 2020 2222 220a 2020 2020 6473  f.    """.    ds
+000474a0: 6b20 3d20 6469 6374 2829 0a20 2020 206e  k = dict().    n
+000474b0: 616d 6520 3d20 2270 7265 6669 785f 7265  ame = "prefix_re
+000474c0: 6475 6374 696f 6e2d 2220 2b20 746f 6b65  duction-" + toke
+000474d0: 6e69 7a65 2866 2c20 6464 662c 2069 6465  nize(f, ddf, ide
+000474e0: 6e74 6974 792c 202a 2a6b 7761 7267 7329  ntity, **kwargs)
+000474f0: 0a20 2020 206d 6574 6120 3d20 6464 662e  .    meta = ddf.
+00047500: 5f6d 6574 610a 2020 2020 6e20 3d20 6c65  _meta.    n = le
+00047510: 6e28 6464 662e 6469 7669 7369 6f6e 7329  n(ddf.divisions)
+00047520: 202d 2031 0a20 2020 2064 6976 6973 696f   - 1.    divisio
+00047530: 6e73 203d 205b 4e6f 6e65 5d20 2a20 286e  ns = [None] * (n
+00047540: 202b 2031 290a 0a20 2020 204e 203d 2031   + 1)..    N = 1
+00047550: 0a20 2020 2077 6869 6c65 204e 203c 206e  .    while N < n
+00047560: 3a0a 2020 2020 2020 2020 4e20 2a3d 2032  :.        N *= 2
+00047570: 0a20 2020 2066 6f72 2069 2069 6e20 7261  .    for i in ra
+00047580: 6e67 6528 6e29 3a0a 2020 2020 2020 2020  nge(n):.        
+00047590: 6473 6b5b 286e 616d 652c 2069 2c20 312c  dsk[(name, i, 1,
+000475a0: 2030 295d 203d 2028 6170 706c 792c 2066   0)] = (apply, f
+000475b0: 2c20 5b28 6464 662e 5f6e 616d 652c 2069  , [(ddf._name, i
+000475c0: 292c 2069 6465 6e74 6974 795d 2c20 6b77  ), identity], kw
+000475d0: 6172 6773 290a 2020 2020 666f 7220 6920  args).    for i 
+000475e0: 696e 2072 616e 6765 286e 2c20 4e29 3a0a  in range(n, N):.
+000475f0: 2020 2020 2020 2020 6473 6b5b 286e 616d          dsk[(nam
+00047600: 652c 2069 2c20 312c 2030 295d 203d 2069  e, i, 1, 0)] = i
+00047610: 6465 6e74 6974 790a 0a20 2020 2064 203d  dentity..    d =
+00047620: 2031 0a20 2020 2077 6869 6c65 2064 203c   1.    while d <
+00047630: 204e 3a0a 2020 2020 2020 2020 666f 7220   N:.        for 
+00047640: 6920 696e 2072 616e 6765 2830 2c20 4e2c  i in range(0, N,
+00047650: 2032 202a 2064 293a 0a20 2020 2020 2020   2 * d):.       
+00047660: 2020 2020 2064 736b 5b28 6e61 6d65 2c20       dsk[(name, 
+00047670: 6920 2b20 3220 2a20 6420 2d20 312c 2032  i + 2 * d - 1, 2
+00047680: 202a 2064 2c20 3029 5d20 3d20 280a 2020   * d, 0)] = (.  
+00047690: 2020 2020 2020 2020 2020 2020 2020 6170                ap
+000476a0: 706c 792c 0a20 2020 2020 2020 2020 2020  ply,.           
+000476b0: 2020 2020 2066 2c0a 2020 2020 2020 2020       f,.        
+000476c0: 2020 2020 2020 2020 5b28 6e61 6d65 2c20          [(name, 
+000476d0: 6920 2b20 6420 2d20 312c 2064 2c20 3029  i + d - 1, d, 0)
+000476e0: 2c20 286e 616d 652c 2069 202b 2032 202a  , (name, i + 2 *
+000476f0: 2064 202d 2031 2c20 642c 2030 295d 2c0a   d - 1, d, 0)],.
+00047700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047710: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+00047720: 2020 2020 290a 2020 2020 2020 2020 6420      ).        d 
+00047730: 2a3d 2032 0a0a 2020 2020 6473 6b5b 286e  *= 2..    dsk[(n
+00047740: 616d 652c 204e 202d 2031 2c20 4e2c 2031  ame, N - 1, N, 1
+00047750: 295d 203d 2069 6465 6e74 6974 790a 0a20  )] = identity.. 
+00047760: 2020 2077 6869 6c65 2064 203e 2031 3a0a     while d > 1:.
+00047770: 2020 2020 2020 2020 6420 2f2f 3d20 320a          d //= 2.
+00047780: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00047790: 2072 616e 6765 2830 2c20 4e2c 2032 202a   range(0, N, 2 *
+000477a0: 2064 293a 0a20 2020 2020 2020 2020 2020   d):.           
+000477b0: 2064 736b 5b28 6e61 6d65 2c20 6920 2b20   dsk[(name, i + 
+000477c0: 6420 2d20 312c 2064 2c20 3129 5d20 3d20  d - 1, d, 1)] = 
+000477d0: 286e 616d 652c 2069 202b 2032 202a 2064  (name, i + 2 * d
+000477e0: 202d 2031 2c20 3220 2a20 642c 2031 290a   - 1, 2 * d, 1).
+000477f0: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
+00047800: 286e 616d 652c 2069 202b 2032 202a 2064  (name, i + 2 * d
+00047810: 202d 2031 2c20 642c 2031 295d 203d 2028   - 1, d, 1)] = (
+00047820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047830: 2061 7070 6c79 2c0a 2020 2020 2020 2020   apply,.        
+00047840: 2020 2020 2020 2020 662c 0a20 2020 2020          f,.     
+00047850: 2020 2020 2020 2020 2020 205b 286e 616d             [(nam
+00047860: 652c 2069 202b 2032 202a 2064 202d 2031  e, i + 2 * d - 1
+00047870: 2c20 3220 2a20 642c 2031 292c 2028 6e61  , 2 * d, 1), (na
+00047880: 6d65 2c20 6920 2b20 6420 2d20 312c 2064  me, i + d - 1, d
+00047890: 2c20 3029 5d2c 0a20 2020 2020 2020 2020  , 0)],.         
+000478a0: 2020 2020 2020 206b 7761 7267 732c 0a20         kwargs,. 
+000478b0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+000478c0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+000478d0: 286e 293a 0a20 2020 2020 2020 2064 736b  (n):.        dsk
+000478e0: 5b28 6e61 6d65 2c20 6929 5d20 3d20 2861  [(name, i)] = (a
+000478f0: 7070 6c79 2c20 662c 205b 286e 616d 652c  pply, f, [(name,
+00047900: 2069 2c20 312c 2031 292c 2069 6465 6e74   i, 1, 1), ident
+00047910: 6974 795d 2c20 6b77 6172 6773 290a 0a20  ity], kwargs).. 
+00047920: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+00047930: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+00047940: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
+00047950: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+00047960: 6573 3d5b 6464 665d 290a 2020 2020 7265  es=[ddf]).    re
+00047970: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
+00047980: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
+00047990: 6d65 7461 2c20 6469 7669 7369 6f6e 7329  meta, divisions)
+000479a0: 0a0a 0a64 6566 2073 7566 6669 785f 7265  ...def suffix_re
+000479b0: 6475 6374 696f 6e28 662c 2064 6466 2c20  duction(f, ddf, 
+000479c0: 6964 656e 7469 7479 2c20 2a2a 6b77 6172  identity, **kwar
+000479d0: 6773 293a 0a20 2020 2022 2222 436f 6d70  gs):.    """Comp
+000479e0: 7574 6573 2074 6865 2073 7566 6669 7820  utes the suffix 
+000479f0: 7375 6d73 206f 6620 6620 6f6e 2064 660a  sums of f on df.
+00047a00: 0a20 2020 2049 6620 6466 2068 6173 2070  .    If df has p
+00047a10: 6172 7469 7469 6f6e 7320 5b50 312c 2050  artitions [P1, P
+00047a20: 322c 202e 2e2e 2c20 506e 5d2c 2074 6865  2, ..., Pn], the
+00047a30: 6e20 7265 7475 726e 7320 7468 6520 4461  n returns the Da
+00047a40: 7461 4672 616d 6520 7769 7468 0a20 2020  taFrame with.   
+00047a50: 2070 6172 7469 7469 6f6e 7320 5b66 2850   partitions [f(P
+00047a60: 312c 2066 2850 322c 202e 2e2e 6628 506e  1, f(P2, ...f(Pn
+00047a70: 2c20 6964 656e 7469 7479 292e 2e2e 2929  , identity)...))
+00047a80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00047a90: 2020 6628 5032 2c20 2e2e 2e66 2850 6e2c    f(P2, ...f(Pn,
+00047aa0: 2069 6465 6e74 6974 7929 2e2e 2e29 2c0a   identity)...),.
+00047ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047ac0: 2e2e 2e66 2850 6e2c 2069 6465 6e74 6974  ...f(Pn, identit
+00047ad0: 7929 2e2e 2e2c 0a20 2020 2020 2020 2020  y)...,.         
+00047ae0: 2020 2020 2020 202e 2e2e 5d0a 0a20 2020         ...]..   
+00047af0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00047b00: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066  ----------.    f
+00047b10: 203a 2063 616c 6c61 626c 650a 2020 2020   : callable.    
+00047b20: 2020 2020 616e 2061 7373 6f63 6961 7469      an associati
+00047b30: 7665 2066 756e 6374 696f 6e20 660a 2020  ve function f.  
+00047b40: 2020 6464 6620 3a20 6464 2e44 6174 6146    ddf : dd.DataF
+00047b50: 7261 6d65 0a20 2020 2069 6465 6e74 6974  rame.    identit
+00047b60: 7920 3a20 7064 2e44 6174 6146 7261 6d65  y : pd.DataFrame
+00047b70: 0a20 2020 2020 2020 2061 6e20 6964 656e  .        an iden
+00047b80: 7469 7479 2065 6c65 6d65 6e74 206f 6620  tity element of 
+00047b90: 662c 2074 6861 7420 6973 2066 2869 6465  f, that is f(ide
+00047ba0: 6e74 6974 792c 2064 6629 203d 2066 2864  ntity, df) = f(d
+00047bb0: 662c 2069 6465 6e74 6974 7929 203d 2064  f, identity) = d
+00047bc0: 660a 2020 2020 6b77 6172 6773 203a 203f  f.    kwargs : ?
+00047bd0: 3f0a 2020 2020 2020 2020 6b65 7977 6f72  ?.        keywor
+00047be0: 6420 6172 6775 6d65 6e74 7320 6f66 2066  d arguments of f
+00047bf0: 203f 3f0a 2020 2020 2222 220a 2020 2020   ??.    """.    
+00047c00: 6473 6b20 3d20 6469 6374 2829 0a20 2020  dsk = dict().   
+00047c10: 206e 616d 6520 3d20 2273 7566 6669 785f   name = "suffix_
+00047c20: 7265 6475 6374 696f 6e2d 2220 2b20 746f  reduction-" + to
+00047c30: 6b65 6e69 7a65 2866 2c20 6464 662c 2069  kenize(f, ddf, i
+00047c40: 6465 6e74 6974 792c 202a 2a6b 7761 7267  dentity, **kwarg
+00047c50: 7329 0a20 2020 206d 6574 6120 3d20 6464  s).    meta = dd
+00047c60: 662e 5f6d 6574 610a 2020 2020 6e20 3d20  f._meta.    n = 
+00047c70: 6c65 6e28 6464 662e 6469 7669 7369 6f6e  len(ddf.division
+00047c80: 7329 202d 2031 0a20 2020 2064 6976 6973  s) - 1.    divis
+00047c90: 696f 6e73 203d 205b 4e6f 6e65 5d20 2a20  ions = [None] * 
+00047ca0: 286e 202b 2031 290a 0a20 2020 204e 203d  (n + 1)..    N =
+00047cb0: 2031 0a20 2020 2077 6869 6c65 204e 203c   1.    while N <
+00047cc0: 206e 3a0a 2020 2020 2020 2020 4e20 2a3d   n:.        N *=
+00047cd0: 2032 0a20 2020 2066 6f72 2069 2069 6e20   2.    for i in 
+00047ce0: 7261 6e67 6528 6e29 3a0a 2020 2020 2020  range(n):.      
+00047cf0: 2020 6473 6b5b 286e 616d 652c 2069 2c20    dsk[(name, i, 
+00047d00: 312c 2030 295d 203d 2028 6170 706c 792c  1, 0)] = (apply,
+00047d10: 2066 2c20 5b28 6464 662e 5f6e 616d 652c   f, [(ddf._name,
+00047d20: 206e 202d 2031 202d 2069 292c 2069 6465   n - 1 - i), ide
+00047d30: 6e74 6974 795d 2c20 6b77 6172 6773 290a  ntity], kwargs).
+00047d40: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00047d50: 6765 286e 2c20 4e29 3a0a 2020 2020 2020  ge(n, N):.      
+00047d60: 2020 6473 6b5b 286e 616d 652c 2069 2c20    dsk[(name, i, 
+00047d70: 312c 2030 295d 203d 2069 6465 6e74 6974  1, 0)] = identit
+00047d80: 790a 0a20 2020 2064 203d 2031 0a20 2020  y..    d = 1.   
+00047d90: 2077 6869 6c65 2064 203c 204e 3a0a 2020   while d < N:.  
+00047da0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00047db0: 616e 6765 2830 2c20 4e2c 2032 202a 2064  ange(0, N, 2 * d
+00047dc0: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
+00047dd0: 736b 5b28 6e61 6d65 2c20 6920 2b20 3220  sk[(name, i + 2 
+00047de0: 2a20 6420 2d20 312c 2032 202a 2064 2c20  * d - 1, 2 * d, 
+00047df0: 3029 5d20 3d20 280a 2020 2020 2020 2020  0)] = (.        
+00047e00: 2020 2020 2020 2020 6170 706c 792c 0a20          apply,. 
+00047e10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00047e20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00047e30: 2020 5b28 6e61 6d65 2c20 6920 2b20 3220    [(name, i + 2 
+00047e40: 2a20 6420 2d20 312c 2064 2c20 3029 2c20  * d - 1, d, 0), 
+00047e50: 286e 616d 652c 2069 202b 2064 202d 2031  (name, i + d - 1
+00047e60: 2c20 642c 2030 295d 2c0a 2020 2020 2020  , d, 0)],.      
+00047e70: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
+00047e80: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00047e90: 2020 2020 2020 2020 6420 2a3d 2032 0a0a          d *= 2..
+00047ea0: 2020 2020 6473 6b5b 286e 616d 652c 204e      dsk[(name, N
+00047eb0: 202d 2031 2c20 4e2c 2031 295d 203d 2069   - 1, N, 1)] = i
+00047ec0: 6465 6e74 6974 790a 0a20 2020 2077 6869  dentity..    whi
+00047ed0: 6c65 2064 203e 2031 3a0a 2020 2020 2020  le d > 1:.      
+00047ee0: 2020 6420 2f2f 3d20 320a 2020 2020 2020    d //= 2.      
+00047ef0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00047f00: 2830 2c20 4e2c 2032 202a 2064 293a 0a20  (0, N, 2 * d):. 
+00047f10: 2020 2020 2020 2020 2020 2064 736b 5b28             dsk[(
+00047f20: 6e61 6d65 2c20 6920 2b20 6420 2d20 312c  name, i + d - 1,
+00047f30: 2064 2c20 3129 5d20 3d20 286e 616d 652c   d, 1)] = (name,
+00047f40: 2069 202b 2032 202a 2064 202d 2031 2c20   i + 2 * d - 1, 
+00047f50: 3220 2a20 642c 2031 290a 2020 2020 2020  2 * d, 1).      
+00047f60: 2020 2020 2020 6473 6b5b 286e 616d 652c        dsk[(name,
+00047f70: 2069 202b 2032 202a 2064 202d 2031 2c20   i + 2 * d - 1, 
+00047f80: 642c 2031 295d 203d 2028 0a20 2020 2020  d, 1)] = (.     
+00047f90: 2020 2020 2020 2020 2020 2061 7070 6c79             apply
+00047fa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00047fb0: 2020 662c 0a20 2020 2020 2020 2020 2020    f,.           
+00047fc0: 2020 2020 205b 286e 616d 652c 2069 202b       [(name, i +
+00047fd0: 2064 202d 2031 2c20 642c 2030 292c 2028   d - 1, d, 0), (
+00047fe0: 6e61 6d65 2c20 6920 2b20 3220 2a20 6420  name, i + 2 * d 
+00047ff0: 2d20 312c 2032 202a 2064 2c20 3129 5d2c  - 1, 2 * d, 1)],
+00048000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00048010: 206b 7761 7267 732c 0a20 2020 2020 2020   kwargs,.       
+00048020: 2020 2020 2029 0a0a 2020 2020 666f 7220       )..    for 
+00048030: 6920 696e 2072 616e 6765 286e 293a 0a20  i in range(n):. 
+00048040: 2020 2020 2020 2064 736b 5b28 6e61 6d65         dsk[(name
+00048050: 2c20 6929 5d20 3d20 2861 7070 6c79 2c20  , i)] = (apply, 
+00048060: 662c 205b 286e 616d 652c 206e 202d 2031  f, [(name, n - 1
+00048070: 202d 2069 2c20 312c 2031 292c 2069 6465   - i, 1, 1), ide
+00048080: 6e74 6974 795d 2c20 6b77 6172 6773 290a  ntity], kwargs).
+00048090: 0a20 2020 2067 7261 7068 203d 2048 6967  .    graph = Hig
+000480a0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+000480b0: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+000480c0: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
+000480d0: 6369 6573 3d5b 6464 665d 290a 2020 2020  cies=[ddf]).    
+000480e0: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
+000480f0: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
+00048100: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
+00048110: 7329 0a0a 0a64 6566 206d 6170 7365 7269  s)...def mapseri
+00048120: 6573 2862 6173 655f 6368 756e 6b2c 2063  es(base_chunk, c
+00048130: 6f6e 6361 745f 6d61 7029 3a0a 2020 2020  oncat_map):.    
+00048140: 7265 7475 726e 2062 6173 655f 6368 756e  return base_chun
+00048150: 6b2e 6d61 7028 636f 6e63 6174 5f6d 6170  k.map(concat_map
+00048160: 290a 0a0a 6465 6620 6d61 7073 6572 6965  )...def mapserie
+00048170: 735f 636f 6d62 696e 6528 696e 6465 782c  s_combine(index,
+00048180: 2063 6f6e 6361 745f 7265 7375 6c74 293a   concat_result):
+00048190: 0a20 2020 2066 696e 616c 5f73 6572 6965  .    final_serie
+000481a0: 7320 3d20 636f 6e63 6174 5f72 6573 756c  s = concat_resul
+000481b0: 742e 736f 7274 5f69 6e64 6578 2829 0a20  t.sort_index(). 
+000481c0: 2020 2066 696e 616c 5f73 6572 6965 7320     final_series 
+000481d0: 3d20 696e 6465 782e 746f 5f73 6572 6965  = index.to_serie
+000481e0: 7328 292e 6d61 7028 6669 6e61 6c5f 7365  s().map(final_se
+000481f0: 7269 6573 290a 2020 2020 7265 7475 726e  ries).    return
+00048200: 2066 696e 616c 5f73 6572 6965 730a 0a0a   final_series...
+00048210: 6465 6620 7365 7269 6573 5f6d 6170 2862  def series_map(b
+00048220: 6173 655f 7365 7269 6573 2c20 6d61 705f  ase_series, map_
+00048230: 7365 7269 6573 293a 0a20 2020 206e 7061  series):.    npa
+00048240: 7274 6974 696f 6e73 203d 2062 6173 655f  rtitions = base_
+00048250: 7365 7269 6573 2e6e 7061 7274 6974 696f  series.npartitio
+00048260: 6e73 0a20 2020 2073 706c 6974 5f6f 7574  ns.    split_out
+00048270: 203d 206d 6170 5f73 6572 6965 732e 6e70   = map_series.np
+00048280: 6172 7469 7469 6f6e 730a 0a20 2020 2064  artitions..    d
+00048290: 736b 203d 207b 7d0a 0a20 2020 2062 6173  sk = {}..    bas
+000482a0: 655f 746f 6b65 6e5f 6b65 7920 3d20 746f  e_token_key = to
+000482b0: 6b65 6e69 7a65 2862 6173 655f 7365 7269  kenize(base_seri
+000482c0: 6573 2c20 7370 6c69 745f 6f75 7429 0a20  es, split_out). 
+000482d0: 2020 2062 6173 655f 7370 6c69 745f 7072     base_split_pr
+000482e0: 6566 6978 203d 2066 2262 6173 652d 7370  efix = f"base-sp
+000482f0: 6c69 742d 7b62 6173 655f 746f 6b65 6e5f  lit-{base_token_
+00048300: 6b65 797d 220a 2020 2020 6261 7365 5f73  key}".    base_s
+00048310: 6861 7264 5f70 7265 6669 7820 3d20 6622  hard_prefix = f"
+00048320: 6261 7365 2d73 6861 7264 2d7b 6261 7365  base-shard-{base
+00048330: 5f74 6f6b 656e 5f6b 6579 7d22 0a20 2020  _token_key}".   
+00048340: 2066 6f72 2069 2c20 6b65 7920 696e 2065   for i, key in e
+00048350: 6e75 6d65 7261 7465 2862 6173 655f 7365  numerate(base_se
+00048360: 7269 6573 2e5f 5f64 6173 6b5f 6b65 7973  ries.__dask_keys
+00048370: 5f5f 2829 293a 0a20 2020 2020 2020 2064  __()):.        d
+00048380: 736b 5b28 6261 7365 5f73 706c 6974 5f70  sk[(base_split_p
+00048390: 7265 6669 782c 2069 295d 203d 2028 6861  refix, i)] = (ha
+000483a0: 7368 5f73 6861 7264 2c20 6b65 792c 2073  sh_shard, key, s
+000483b0: 706c 6974 5f6f 7574 290a 2020 2020 2020  plit_out).      
+000483c0: 2020 666f 7220 6a20 696e 2072 616e 6765    for j in range
+000483d0: 2873 706c 6974 5f6f 7574 293a 0a20 2020  (split_out):.   
+000483e0: 2020 2020 2020 2020 2064 736b 5b28 6261           dsk[(ba
+000483f0: 7365 5f73 6861 7264 5f70 7265 6669 782c  se_shard_prefix,
+00048400: 2030 2c20 692c 206a 295d 203d 2028 6765   0, i, j)] = (ge
+00048410: 7469 7465 6d2c 2028 6261 7365 5f73 706c  titem, (base_spl
+00048420: 6974 5f70 7265 6669 782c 2069 292c 206a  it_prefix, i), j
+00048430: 290a 0a20 2020 206d 6170 5f74 6f6b 656e  )..    map_token
+00048440: 5f6b 6579 203d 2074 6f6b 656e 697a 6528  _key = tokenize(
+00048450: 6d61 705f 7365 7269 6573 290a 2020 2020  map_series).    
+00048460: 6d61 705f 7370 6c69 745f 7072 6566 6978  map_split_prefix
+00048470: 203d 2066 226d 6170 2d73 706c 6974 2d7b   = f"map-split-{
+00048480: 6d61 705f 746f 6b65 6e5f 6b65 797d 220a  map_token_key}".
+00048490: 2020 2020 6d61 705f 7368 6172 645f 7072      map_shard_pr
+000484a0: 6566 6978 203d 2066 226d 6170 2d73 6861  efix = f"map-sha
+000484b0: 7264 2d7b 6d61 705f 746f 6b65 6e5f 6b65  rd-{map_token_ke
+000484c0: 797d 220a 2020 2020 666f 7220 692c 206b  y}".    for i, k
+000484d0: 6579 2069 6e20 656e 756d 6572 6174 6528  ey in enumerate(
+000484e0: 6d61 705f 7365 7269 6573 2e5f 5f64 6173  map_series.__das
+000484f0: 6b5f 6b65 7973 5f5f 2829 293a 0a20 2020  k_keys__()):.   
+00048500: 2020 2020 2064 736b 5b28 6d61 705f 7370       dsk[(map_sp
+00048510: 6c69 745f 7072 6566 6978 2c20 6929 5d20  lit_prefix, i)] 
+00048520: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00048530: 6861 7368 5f73 6861 7264 2c0a 2020 2020  hash_shard,.    
+00048540: 2020 2020 2020 2020 6b65 792c 0a20 2020          key,.   
+00048550: 2020 2020 2020 2020 2073 706c 6974 5f6f           split_o
+00048560: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
+00048570: 7370 6c69 745f 6f75 745f 6f6e 5f69 6e64  split_out_on_ind
+00048580: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
+00048590: 4e6f 6e65 2c0a 2020 2020 2020 2020 290a  None,.        ).
+000485a0: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
+000485b0: 2072 616e 6765 2873 706c 6974 5f6f 7574   range(split_out
+000485c0: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
+000485d0: 736b 5b28 6d61 705f 7368 6172 645f 7072  sk[(map_shard_pr
+000485e0: 6566 6978 2c20 302c 2069 2c20 6a29 5d20  efix, 0, i, j)] 
+000485f0: 3d20 2867 6574 6974 656d 2c20 286d 6170  = (getitem, (map
+00048600: 5f73 706c 6974 5f70 7265 6669 782c 2069  _split_prefix, i
+00048610: 292c 206a 290a 0a20 2020 2074 6f6b 656e  ), j)..    token
+00048620: 5f6b 6579 203d 2074 6f6b 656e 697a 6528  _key = tokenize(
+00048630: 6261 7365 5f73 6572 6965 732c 206d 6170  base_series, map
+00048640: 5f73 6572 6965 7329 0a20 2020 206d 6170  _series).    map
+00048650: 5f70 7265 6669 7820 3d20 6622 6d61 702d  _prefix = f"map-
+00048660: 7365 7269 6573 2d7b 746f 6b65 6e5f 6b65  series-{token_ke
+00048670: 797d 220a 2020 2020 666f 7220 6920 696e  y}".    for i in
+00048680: 2072 616e 6765 286e 7061 7274 6974 696f   range(npartitio
+00048690: 6e73 293a 0a20 2020 2020 2020 2066 6f72  ns):.        for
+000486a0: 206a 2069 6e20 7261 6e67 6528 7370 6c69   j in range(spli
+000486b0: 745f 6f75 7429 3a0a 2020 2020 2020 2020  t_out):.        
+000486c0: 2020 2020 6473 6b5b 286d 6170 5f70 7265      dsk[(map_pre
+000486d0: 6669 782c 2069 2c20 6a29 5d20 3d20 280a  fix, i, j)] = (.
+000486e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000486f0: 6d61 7073 6572 6965 732c 0a20 2020 2020  mapseries,.     
+00048700: 2020 2020 2020 2020 2020 2028 6261 7365             (base
+00048710: 5f73 6861 7264 5f70 7265 6669 782c 2030  _shard_prefix, 0
+00048720: 2c20 692c 206a 292c 0a20 2020 2020 2020  , i, j),.       
+00048730: 2020 2020 2020 2020 2028 5f63 6f6e 6361           (_conca
+00048740: 742c 205b 286d 6170 5f73 6861 7264 5f70  t, [(map_shard_p
+00048750: 7265 6669 782c 2030 2c20 6b2c 206a 2920  refix, 0, k, j) 
+00048760: 666f 7220 6b20 696e 2072 616e 6765 2873  for k in range(s
+00048770: 706c 6974 5f6f 7574 295d 292c 0a20 2020  plit_out)]),.   
+00048780: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00048790: 6669 6e61 6c5f 7072 6566 6978 203d 2066  final_prefix = f
+000487a0: 226d 6170 2d73 6572 6965 732d 636f 6d62  "map-series-comb
+000487b0: 696e 652d 7b74 6f6b 656e 5f6b 6579 7d22  ine-{token_key}"
+000487c0: 0a20 2020 2066 6f72 2069 2c20 6b65 7920  .    for i, key 
+000487d0: 696e 2065 6e75 6d65 7261 7465 2862 6173  in enumerate(bas
+000487e0: 655f 7365 7269 6573 2e69 6e64 6578 2e5f  e_series.index._
+000487f0: 5f64 6173 6b5f 6b65 7973 5f5f 2829 293a  _dask_keys__()):
+00048800: 0a20 2020 2020 2020 2064 736b 5b28 6669  .        dsk[(fi
+00048810: 6e61 6c5f 7072 6566 6978 2c20 6929 5d20  nal_prefix, i)] 
+00048820: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00048830: 6d61 7073 6572 6965 735f 636f 6d62 696e  mapseries_combin
+00048840: 652c 0a20 2020 2020 2020 2020 2020 206b  e,.            k
+00048850: 6579 2c0a 2020 2020 2020 2020 2020 2020  ey,.            
+00048860: 285f 636f 6e63 6174 2c20 5b28 6d61 705f  (_concat, [(map_
+00048870: 7072 6566 6978 2c20 692c 206a 2920 666f  prefix, i, j) fo
+00048880: 7220 6a20 696e 2072 616e 6765 2873 706c  r j in range(spl
+00048890: 6974 5f6f 7574 295d 292c 0a20 2020 2020  it_out)]),.     
+000488a0: 2020 2029 0a0a 2020 2020 6d65 7461 203d     )..    meta =
+000488b0: 206d 6170 5f73 6572 6965 732e 5f6d 6574   map_series._met
+000488c0: 612e 636f 7079 2829 0a20 2020 206d 6574  a.copy().    met
+000488d0: 612e 696e 6465 7820 3d20 6261 7365 5f73  a.index = base_s
+000488e0: 6572 6965 732e 5f6d 6574 612e 696e 6465  eries._meta.inde
+000488f0: 780a 2020 2020 6d65 7461 203d 206d 616b  x.    meta = mak
+00048900: 655f 6d65 7461 286d 6574 6129 0a0a 2020  e_meta(meta)..  
+00048910: 2020 6465 7065 6e64 656e 6369 6573 203d    dependencies =
+00048920: 205b 6261 7365 5f73 6572 6965 732c 206d   [base_series, m
+00048930: 6170 5f73 6572 6965 732c 2062 6173 655f  ap_series, base_
+00048940: 7365 7269 6573 2e69 6e64 6578 5d0a 2020  series.index].  
+00048950: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+00048960: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+00048970: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
+00048980: 2020 2066 696e 616c 5f70 7265 6669 782c     final_prefix,
+00048990: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+000489a0: 6573 3d64 6570 656e 6465 6e63 6965 730a  es=dependencies.
+000489b0: 2020 2020 290a 2020 2020 6469 7669 7369      ).    divisi
+000489c0: 6f6e 7320 3d20 6c69 7374 2862 6173 655f  ons = list(base_
+000489d0: 7365 7269 6573 2e64 6976 6973 696f 6e73  series.divisions
+000489e0: 290a 0a20 2020 2072 6574 7572 6e20 6e65  )..    return ne
+000489f0: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
+00048a00: 682c 2066 696e 616c 5f70 7265 6669 782c  h, final_prefix,
+00048a10: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
+00048a20: 290a 0a0a 6465 6620 5f63 6f6e 7665 7274  )...def _convert
+00048a30: 5f74 6f5f 6e75 6d65 7269 6328 7365 7269  _to_numeric(seri
+00048a40: 6573 2c20 736b 6970 6e61 293a 0a20 2020  es, skipna):.   
+00048a50: 2069 6620 736b 6970 6e61 3a0a 2020 2020   if skipna:.    
+00048a60: 2020 2020 7265 7475 726e 2073 6572 6965      return serie
+00048a70: 732e 6472 6f70 6e61 2829 2e76 6965 7728  s.dropna().view(
+00048a80: 2269 3822 290a 0a20 2020 2023 2073 6572  "i8")..    # ser
+00048a90: 6965 732e 7669 6577 2822 6938 2229 2077  ies.view("i8") w
+00048aa0: 6974 6820 7064 2e4e 6154 2070 726f 6475  ith pd.NaT produ
+00048ab0: 6365 7320 2d39 3232 3333 3732 3033 3638  ces -92233720368
+00048ac0: 3534 3737 3538 3038 2069 7320 7768 7920  54775808 is why 
+00048ad0: 7765 206e 6565 6420 746f 2064 6f20 7468  we need to do th
+00048ae0: 6973 0a20 2020 2072 6574 7572 6e20 7365  is.    return se
+00048af0: 7269 6573 2e76 6965 7728 2269 3822 292e  ries.view("i8").
+00048b00: 6d61 736b 2873 6572 6965 732e 6973 6e75  mask(series.isnu
+00048b10: 6c6c 2829 2c20 6e70 2e6e 616e 290a 0a0a  ll(), np.nan)...
+00048b20: 6465 6620 5f73 7172 745f 616e 645f 636f  def _sqrt_and_co
+00048b30: 6e76 6572 745f 746f 5f74 696d 6564 656c  nvert_to_timedel
+00048b40: 7461 2870 6172 7469 7469 6f6e 2c20 6178  ta(partition, ax
+00048b50: 6973 2c20 2a61 7267 732c 202a 2a6b 7761  is, *args, **kwa
+00048b60: 7267 7329 3a0a 2020 2020 6966 2061 7869  rgs):.    if axi
+00048b70: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
+00048b80: 7769 7468 2077 6172 6e69 6e67 732e 6361  with warnings.ca
+00048b90: 7463 685f 7761 726e 696e 6773 2829 3a0a  tch_warnings():.
+00048ba0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+00048bb0: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
+00048bc0: 6e67 7328 0a20 2020 2020 2020 2020 2020  ngs(.           
+00048bd0: 2020 2020 2022 6967 6e6f 7265 222c 0a20       "ignore",. 
+00048be0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00048bf0: 6174 6567 6f72 793d 5275 6e74 696d 6557  ategory=RuntimeW
+00048c00: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
+00048c10: 2020 2020 2020 2020 6d65 7373 6167 653d          message=
+00048c20: 2269 6e76 616c 6964 2076 616c 7565 2065  "invalid value e
+00048c30: 6e63 6f75 6e74 6572 6564 2069 6e20 6361  ncountered in ca
+00048c40: 7374 222c 0a20 2020 2020 2020 2020 2020  st",.           
+00048c50: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+00048c60: 6574 7572 6e20 7064 2e74 6f5f 7469 6d65  eturn pd.to_time
+00048c70: 6465 6c74 6128 4d2e 7374 6428 7061 7274  delta(M.std(part
+00048c80: 6974 696f 6e2c 2061 7869 733d 6178 6973  ition, axis=axis
+00048c90: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
+00048ca0: 7329 290a 0a20 2020 2069 735f 6466 5f6c  s))..    is_df_l
+00048cb0: 696b 652c 2074 696d 655f 636f 6c73 203d  ike, time_cols =
+00048cc0: 206b 7761 7267 735b 2269 735f 6466 5f6c   kwargs["is_df_l
+00048cd0: 696b 6522 5d2c 206b 7761 7267 735b 2274  ike"], kwargs["t
+00048ce0: 696d 655f 636f 6c73 225d 0a0a 2020 2020  ime_cols"]..    
+00048cf0: 7371 7274 203d 206e 702e 7371 7274 2870  sqrt = np.sqrt(p
+00048d00: 6172 7469 7469 6f6e 290a 0a20 2020 2069  artition)..    i
+00048d10: 6620 6e6f 7420 6973 5f64 665f 6c69 6b65  f not is_df_like
+00048d20: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00048d30: 2070 642e 746f 5f74 696d 6564 656c 7461   pd.to_timedelta
+00048d40: 2873 7172 7429 0a0a 2020 2020 7469 6d65  (sqrt)..    time
+00048d50: 5f63 6f6c 5f6d 6173 6b20 3d20 7371 7274  _col_mask = sqrt
+00048d60: 2e69 6e64 6578 2e69 7369 6e28 7469 6d65  .index.isin(time
+00048d70: 5f63 6f6c 7329 0a20 2020 206d 6174 6368  _cols).    match
+00048d80: 696e 675f 7661 6c73 203d 2073 7172 745b  ing_vals = sqrt[
+00048d90: 7469 6d65 5f63 6f6c 5f6d 6173 6b5d 0a20  time_col_mask]. 
+00048da0: 2020 2066 6f72 2074 696d 655f 636f 6c2c     for time_col,
+00048db0: 206d 6174 6368 696e 675f 7661 6c20 696e   matching_val in
+00048dc0: 207a 6970 2874 696d 655f 636f 6c73 2c20   zip(time_cols, 
+00048dd0: 6d61 7463 6869 6e67 5f76 616c 7329 3a0a  matching_vals):.
+00048de0: 2020 2020 2020 2020 7371 7274 5b74 696d          sqrt[tim
+00048df0: 655f 636f 6c5d 203d 2070 642e 746f 5f74  e_col] = pd.to_t
+00048e00: 696d 6564 656c 7461 286d 6174 6368 696e  imedelta(matchin
+00048e10: 675f 7661 6c29 0a0a 2020 2020 7265 7475  g_val)..    retu
+00048e20: 726e 2073 7172 740a 0a0a 6465 6620 5f72  rn sqrt...def _r
+00048e30: 6169 7365 5f69 665f 6e6f 745f 7365 7269  aise_if_not_seri
+00048e40: 6573 5f6f 725f 6461 7461 6672 616d 6528  es_or_dataframe(
+00048e50: 782c 2066 756e 636e 616d 6529 3a0a 2020  x, funcname):.  
+00048e60: 2020 2222 220a 2020 2020 5574 696c 6974    """.    Utilit
+00048e70: 7920 6675 6e63 7469 6f6e 2074 6f20 7261  y function to ra
+00048e80: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
+00048e90: 616e 206f 626a 6563 7420 6973 206e 6f74  an object is not
+00048ea0: 2061 2053 6572 6965 7320 6f72 2044 6174   a Series or Dat
+00048eb0: 6146 7261 6d65 0a20 2020 2022 2222 0a20  aFrame.    """. 
+00048ec0: 2020 2069 6620 6e6f 7420 6973 5f73 6572     if not is_ser
+00048ed0: 6965 735f 6c69 6b65 2878 2920 616e 6420  ies_like(x) and 
+00048ee0: 6e6f 7420 6973 5f64 6174 6166 7261 6d65  not is_dataframe
+00048ef0: 5f6c 696b 6528 7829 3a0a 2020 2020 2020  _like(x):.      
+00048f00: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+00048f10: 6d65 6e74 6564 4572 726f 7228 0a20 2020  mentedError(.   
+00048f20: 2020 2020 2020 2020 2022 6025 7360 2069           "`%s` i
+00048f30: 7320 6f6e 6c79 2073 7570 706f 7274 6564  s only supported
+00048f40: 2077 6974 6820 6f62 6a65 6374 7320 7468   with objects th
+00048f50: 6174 2061 7265 2044 6174 6166 7261 6d65  at are Dataframe
+00048f60: 7320 6f72 2053 6572 6965 7322 0a20 2020  s or Series".   
+00048f70: 2020 2020 2020 2020 2025 2066 756e 636e           % funcn
+00048f80: 616d 650a 2020 2020 2020 2020 290a 0a0a  ame.        )...
+00048f90: 6465 6620 5f67 6574 6174 7472 5f6e 756d  def _getattr_num
+00048fa0: 6572 6963 5f6f 6e6c 7928 2a61 7267 732c  eric_only(*args,
+00048fb0: 205f 6461 736b 5f6d 6574 686f 645f 6e61   _dask_method_na
+00048fc0: 6d65 2c20 2a2a 6b77 6172 6773 293a 0a20  me, **kwargs):. 
+00048fd0: 2020 2077 6974 6820 6368 6563 6b5f 6e75     with check_nu
+00048fe0: 6d65 7269 635f 6f6e 6c79 5f64 6570 7265  meric_only_depre
+00048ff0: 6361 7469 6f6e 2829 3a0a 2020 2020 2020  cation():.      
+00049000: 2020 7265 7475 726e 2067 6574 6174 7472    return getattr
+00049010: 284d 2c20 5f64 6173 6b5f 6d65 7468 6f64  (M, _dask_method
+00049020: 5f6e 616d 6529 282a 6172 6773 2c20 2a2a  _name)(*args, **
+00049030: 6b77 6172 6773 290a                      kwargs).
```

### Comparing `dask-2023.4.1/dask/dataframe/dispatch.py` & `dask-2023.5.0/dask/dataframe/dispatch.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/extensions.py` & `dask-2023.5.0/dask/dataframe/extensions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/groupby.py` & `dask-2023.5.0/dask/dataframe/groupby.py`

 * *Files 2% similar despite different names*

```diff
@@ -21,25 +21,27 @@
     check_numeric_only_deprecation,
     check_observed_deprecation,
 )
 from dask.dataframe.core import (
     GROUP_KEYS_DEFAULT,
     DataFrame,
     Series,
+    _convert_to_numeric,
     _extract_meta,
     _Frame,
     aca,
     map_partitions,
     new_dd_object,
     no_default,
     split_out_on_index,
 )
 from dask.dataframe.dispatch import grouper_dispatch
 from dask.dataframe.methods import concat, drop_columns
 from dask.dataframe.utils import (
+    get_numeric_only_kwargs,
     insert_meta_param_description,
     is_dataframe_like,
     is_index_like,
     is_series_like,
     make_meta,
     raise_on_meta_error,
 )
@@ -85,20 +87,17 @@
     "In the future, `sort` for groupby operations will default to `True`"
     " to match the behavior of pandas. However, `sort=True` does not work"
     " with `split_out>1`. To retain the current behavior for multiple"
     " output partitions, set `sort=False`."
 )
 
 NUMERIC_ONLY_NOT_IMPLEMENTED = [
-    "corr",
-    "cov",
     "cumprod",
     "cumsum",
     "mean",
-    "median",
     "std",
     "var",
 ]
 
 
 def _determine_levels(by):
     """Determine the correct levels argument to groupby."""
@@ -340,19 +339,15 @@
                 and len(args) > 0
                 and args[0] not in NUMERIC_ONLY_NOT_IMPLEMENTED
             )
             if maybe_raise:
                 numeric_only = kwargs.get("numeric_only", no_default)
                 # Prior to `pandas=1.5`, `numeric_only` support wasn't uniformly supported
                 # in pandas. We don't support `numeric_only=False` in this case.
-                if not PANDAS_GT_150 and (
-                    numeric_only is False
-                    or numeric_only is not no_default
-                    and func.__name__ in ["corr", "cov", "cumprod", "cumsum"]
-                ):
+                if not PANDAS_GT_150 and numeric_only is False:
                     raise NotImplementedError(
                         "'numeric_only=False' is not implemented in Dask."
                     )
                 if not self._all_numeric():
                     if numeric_only is False or (
                         PANDAS_GT_200 and numeric_only is no_default
                     ):
@@ -514,15 +509,19 @@
                 ),
                 names=result.index.names,
             )
         if has_categoricals:
             # If we found any categoricals, append unobserved values to the end of the
             # frame.
             new_cats = full_index[~full_index.isin(result.index)]
-            empty = pd.DataFrame(pd.NA, index=new_cats, columns=result.columns)
+            empty_data = {
+                c: pd.Series(index=new_cats, dtype=result[c].dtype)
+                for c in result.columns
+            }
+            empty = pd.DataFrame(empty_data)
             result = pd.concat([result, empty])
 
     return result
 
 
 def _apply_chunk(df, *by, dropna=None, observed=None, **kwargs):
     func = kwargs.pop("chunk")
@@ -536,17 +535,15 @@
     else:
         if isinstance(columns, (tuple, list, set, pd.Index)):
             columns = list(columns)
         return func(g[columns], **kwargs)
 
 
 def _var_chunk(df, *by, numeric_only=no_default):
-    numeric_only_kwargs = (
-        {} if numeric_only is no_default else {"numeric_only": numeric_only}
-    )
+    numeric_only_kwargs = get_numeric_only_kwargs(numeric_only)
     if is_series_like(df):
         df = df.to_frame()
 
     df = df.copy()
 
     g = _groupby_raise_unaligned(df, by=by)
     with check_numeric_only_deprecation():
@@ -565,17 +562,15 @@
 
 
 def _var_combine(g, levels, sort=False):
     return g.groupby(level=levels, sort=sort).sum()
 
 
 def _var_agg(g, levels, ddof, sort=False, numeric_only=no_default):
-    numeric_only_kwargs = (
-        {} if numeric_only is no_default else {"numeric_only": numeric_only}
-    )
+    numeric_only_kwargs = get_numeric_only_kwargs(numeric_only)
     g = g.groupby(level=levels, sort=sort).sum(**numeric_only_kwargs)
     nc = len(g.columns)
     x = g[g.columns[: nc // 3]]
     # chunks columns are tuples (value, name), so we just keep the value part
     x2 = g[g.columns[nc // 3 : 2 * nc // 3]].rename(columns=lambda c: c[0])
     n = g[g.columns[-nc // 3 :]].rename(columns=lambda c: c[0])
 
@@ -613,15 +608,19 @@
         div[div < 0] = 0
         val = (df[mul_col] - df[i] * df[j] / n).values[0] / div.values[0]
         if std:
             ii = f"{i}{i}"
             jj = f"{j}{j}"
             std_val_i = (df[ii] - (df[i] ** 2) / ni).values[0] / div.values[0]
             std_val_j = (df[jj] - (df[j] ** 2) / nj).values[0] / div.values[0]
-            val = val / np.sqrt(std_val_i * std_val_j)
+            sqrt_val = np.sqrt(std_val_i * std_val_j)
+            if sqrt_val == 0:
+                val = np.nan
+            else:
+                val = val / sqrt_val
 
         vals[idx] = val
         if i != j:
             idx = num_cols * x + y
             vals[idx] = val
 
     level_1 = cols
@@ -645,31 +644,36 @@
     # https://github.com/pandas-dev/pandas/issues/43568
     # Make sure index dtype is int (even if _df is empty)
     # https://github.com/dask/dask/pull/9701
     _df.index = np.zeros(len(_df), dtype=int)
     return _df
 
 
-def _cov_chunk(df, *by):
+def _cov_chunk(df, *by, numeric_only=no_default):
     """Covariance Chunk Logic
 
     Parameters
     ----------
     df : Pandas.DataFrame
     std : bool, optional
         When std=True we are calculating with Correlation
 
     Returns
     -------
     tuple
         Processed X, Multiplied Cols,
     """
+    numeric_only_kwargs = get_numeric_only_kwargs(numeric_only)
     if is_series_like(df):
         df = df.to_frame()
     df = df.copy()
+    if numeric_only is False:
+        dt_df = df.select_dtypes(include=["datetime", "timedelta"])
+        for col in dt_df.columns:
+            df[col] = _convert_to_numeric(dt_df[col], True)
 
     # mapping columns to str(numerical) values allows us to easily handle
     # arbitrary column names (numbers, string, empty strings)
     col_mapping = collections.OrderedDict()
     for i, c in enumerate(df.columns):
         col_mapping[c] = str(i)
     df = df.rename(columns=col_mapping)
@@ -678,15 +682,15 @@
     # when grouping by external series don't exclude columns
     is_mask = any(is_series_like(s) for s in by)
     if not is_mask:
         by = [col_mapping[k] for k in by]
         cols = cols.difference(pd.Index(by))
 
     g = _groupby_raise_unaligned(df, by=by)
-    x = g.sum()
+    x = g.sum(**numeric_only_kwargs)
 
     mul = g.apply(_mul_cols, cols=cols).reset_index(level=-1, drop=True)
 
     n = g[x.columns].count().rename(columns=lambda c: f"{c}-count")
     return (x, mul, n, col_mapping)
 
 
@@ -1612,17 +1616,18 @@
                 **self.dropna,
             ),
             split_out=split_out,
             split_out_setup=split_out_on_index,
             sort=self.sort,
         )
 
-    def _cum_agg(self, token, chunk, aggregate, initial):
+    def _cum_agg(self, token, chunk, aggregate, initial, numeric_only=no_default):
         """Wrapper for cumulative groupby operation"""
-        meta = chunk(self._meta)
+        numeric_only_kwargs = get_numeric_only_kwargs(numeric_only)
+        meta = chunk(self._meta, **numeric_only_kwargs)
         columns = meta.name if is_series_like(meta) else meta.columns
         by_cols = self.by if isinstance(self.by, list) else [self.by]
 
         # rename "by" columns internally
         # to fix cumulative operations on the same "by" columns
         # ref: https://github.com/dask/dask/issues/9313
         if columns is not None:
@@ -1720,15 +1725,17 @@
             )
 
         dependencies = [cumpart_raw]
         if self.obj.npartitions > 1:
             dependencies += [cumpart_ext, cumlast]
 
         graph = HighLevelGraph.from_collections(name, dask, dependencies=dependencies)
-        return new_dd_object(graph, name, chunk(self._meta), self.obj.divisions)
+        return new_dd_object(
+            graph, name, chunk(self._meta, **numeric_only_kwargs), self.obj.divisions
+        )
 
     def compute(self, **kwargs):
         raise NotImplementedError(
             "DataFrameGroupBy does not allow compute method."
             "Please chain it with an aggregation method (like ``.mean()``) or get a "
             "specific group using ``.get_group()`` before calling ``compute()``"
         )
@@ -1781,26 +1788,38 @@
     def cumsum(self, axis=no_default, numeric_only=no_default):
         axis = self._normalize_axis(axis, "cumsum")
         if axis:
             if axis in (1, "columns") and isinstance(self, SeriesGroupBy):
                 raise ValueError(f"No axis named {axis} for object type Series")
             return self.obj.cumsum(axis=axis)
         else:
-            return self._cum_agg("cumsum", chunk=M.cumsum, aggregate=M.add, initial=0)
+            return self._cum_agg(
+                "cumsum",
+                chunk=M.cumsum,
+                aggregate=M.add,
+                initial=0,
+                numeric_only=numeric_only,
+            )
 
     @derived_from(pd.core.groupby.GroupBy)
     @numeric_only_not_implemented
     def cumprod(self, axis=no_default, numeric_only=no_default):
         axis = self._normalize_axis(axis, "cumprod")
         if axis:
             if axis in (1, "columns") and isinstance(self, SeriesGroupBy):
                 raise ValueError(f"No axis named {axis} for object type Series")
             return self.obj.cumprod(axis=axis)
         else:
-            return self._cum_agg("cumprod", chunk=M.cumprod, aggregate=M.mul, initial=1)
+            return self._cum_agg(
+                "cumprod",
+                chunk=M.cumprod,
+                aggregate=M.mul,
+                initial=1,
+                numeric_only=numeric_only,
+            )
 
     @derived_from(pd.core.groupby.GroupBy)
     def cumcount(self, axis=no_default):
         if axis is not no_default:
             warnings.warn(
                 "The `axis` keyword argument is deprecated and will removed in a future release. "
                 "Previously it was unused and had no effect.",
@@ -1816,17 +1835,15 @@
         self,
         split_every=None,
         split_out=1,
         shuffle=None,
         min_count=None,
         numeric_only=no_default,
     ):
-        numeric_kwargs = (
-            {} if numeric_only is no_default else {"numeric_only": numeric_only}
-        )
+        numeric_kwargs = get_numeric_only_kwargs(numeric_only)
         result = self._single_agg(
             func=M.sum,
             token="sum",
             split_every=split_every,
             split_out=split_out,
             shuffle=shuffle,
             chunk_kwargs=numeric_kwargs,
@@ -1843,17 +1860,15 @@
         self,
         split_every=None,
         split_out=1,
         shuffle=None,
         min_count=None,
         numeric_only=no_default,
     ):
-        numeric_kwargs = (
-            {} if numeric_only is no_default else {"numeric_only": numeric_only}
-        )
+        numeric_kwargs = get_numeric_only_kwargs(numeric_only)
         result = self._single_agg(
             func=M.prod,
             token="prod",
             split_every=split_every,
             split_out=split_out,
             shuffle=shuffle,
             chunk_kwargs=numeric_kwargs,
@@ -1862,38 +1877,36 @@
         if min_count:
             return result.where(self.count() >= min_count, other=np.NaN)
         else:
             return result
 
     @derived_from(pd.core.groupby.GroupBy)
     def min(self, split_every=None, split_out=1, shuffle=None, numeric_only=no_default):
-        if numeric_only is no_default:
-            numeric_only = False
+        numeric_kwargs = get_numeric_only_kwargs(numeric_only)
         return self._single_agg(
             func=M.min,
             token="min",
             split_every=split_every,
             split_out=split_out,
             shuffle=shuffle,
-            chunk_kwargs={"numeric_only": numeric_only},
-            aggregate_kwargs={"numeric_only": numeric_only},
+            chunk_kwargs=numeric_kwargs,
+            aggregate_kwargs=numeric_kwargs,
         )
 
     @derived_from(pd.core.groupby.GroupBy)
     def max(self, split_every=None, split_out=1, shuffle=None, numeric_only=no_default):
-        if numeric_only is no_default:
-            numeric_only = False
+        numeric_kwargs = get_numeric_only_kwargs(numeric_only)
         return self._single_agg(
             func=M.max,
             token="max",
             split_every=split_every,
             split_out=split_out,
             shuffle=shuffle,
-            chunk_kwargs={"numeric_only": numeric_only},
-            aggregate_kwargs={"numeric_only": numeric_only},
+            chunk_kwargs=numeric_kwargs,
+            aggregate_kwargs=numeric_kwargs,
         )
 
     @derived_from(pd.DataFrame)
     @numeric_only_deprecate_default
     def idxmin(
         self,
         split_every=None,
@@ -1905,27 +1918,25 @@
     ):
         if axis in (1, "columns"):
             raise NotImplementedError(
                 f"The axis={axis} keyword is not implemented for groupby.idxmin"
             )
         self._normalize_axis(axis, "idxmin")
         chunk_kwargs = dict(skipna=skipna)
-        if numeric_only is not no_default:
-            chunk_kwargs["numeric_only"] = numeric_only
+        numeric_kwargs = get_numeric_only_kwargs(numeric_only)
+        chunk_kwargs.update(numeric_kwargs)
         return self._single_agg(
             func=M.idxmin,
             token="idxmin",
             aggfunc=M.first,
             split_every=split_every,
             split_out=split_out,
             shuffle=shuffle,
             chunk_kwargs=chunk_kwargs,
-            aggregate_kwargs={}
-            if numeric_only is no_default
-            else {"numeric_only": numeric_only},
+            aggregate_kwargs=numeric_kwargs,
         )
 
     @derived_from(pd.DataFrame)
     @numeric_only_deprecate_default
     def idxmax(
         self,
         split_every=None,
@@ -1937,27 +1948,25 @@
     ):
         if axis in (1, "columns"):
             raise NotImplementedError(
                 f"The axis={axis} keyword is not implemented for groupby.idxmax"
             )
         self._normalize_axis(axis, "idxmax")
         chunk_kwargs = dict(skipna=skipna)
-        if numeric_only is not no_default:
-            chunk_kwargs["numeric_only"] = numeric_only
+        numeric_kwargs = get_numeric_only_kwargs(numeric_only)
+        chunk_kwargs.update(numeric_kwargs)
         return self._single_agg(
             func=M.idxmax,
             token="idxmax",
             aggfunc=M.first,
             split_every=split_every,
             split_out=split_out,
             shuffle=shuffle,
             chunk_kwargs=chunk_kwargs,
-            aggregate_kwargs={}
-            if numeric_only is no_default
-            else {"numeric_only": numeric_only},
+            aggregate_kwargs=numeric_kwargs,
         )
 
     @derived_from(pd.core.groupby.GroupBy)
     def count(self, split_every=None, split_out=1, shuffle=None):
         return self._single_agg(
             func=M.count,
             token="count",
@@ -1982,34 +1991,31 @@
             )
         c = self.count(split_every=split_every, split_out=split_out, shuffle=shuffle)
         if is_dataframe_like(s):
             c = c[s.columns]
         return s / c
 
     @derived_from(pd.core.groupby.GroupBy)
-    @numeric_only_not_implemented
     def median(
         self, split_every=None, split_out=1, shuffle=None, numeric_only=no_default
     ):
         if shuffle is False:
             raise ValueError(
                 "In order to aggregate with 'median', you must use shuffling-based "
                 "aggregation (e.g., shuffle='tasks')"
             )
 
         # FIXME: This is using a different default but it is not fully
         # understood why this is a better choice. For more context, see
         # https://github.com/dask/dask/pull/9826/files#r1072395307
         # https://github.com/dask/distributed/issues/5502
         shuffle = shuffle or config.get("dataframe.shuffle.method", None) or "tasks"
-        numeric_only_kwargs = (
-            {"numeric_only": numeric_only} if numeric_only is not no_default else {}
-        )
+        numeric_only_kwargs = get_numeric_only_kwargs(numeric_only)
 
-        with check_numeric_only_deprecation():
+        with check_numeric_only_deprecation(name="median"):
             meta = self._meta_nonempty.median(**numeric_only_kwargs)
         columns = meta.name if is_series_like(meta) else meta.columns
         by = self.by if isinstance(self.by, list) else [self.by]
         return _shuffle_aggregate(
             [self.obj] + by,
             token="non-agg",
             chunk=_non_agg_chunk,
@@ -2020,14 +2026,15 @@
             },
             aggregate=_groupby_aggregate,
             aggregate_kwargs={
                 "aggfunc": _median_aggregate,
                 "levels": _determine_levels(self.by),
                 **self.observed,
                 **self.dropna,
+                **numeric_only_kwargs,
             },
             split_every=split_every,
             split_out=split_out,
             shuffle=shuffle,
             sort=self.sort,
         )
 
@@ -2093,41 +2100,44 @@
                 split_out=split_out,
                 numeric_only=numeric_only,
             )
         result = map_partitions(np.sqrt, v, meta=v)
         return result
 
     @derived_from(pd.DataFrame)
-    @numeric_only_not_implemented
     def corr(self, ddof=1, split_every=None, split_out=1, numeric_only=no_default):
         """Groupby correlation:
         corr(X, Y) = cov(X, Y) / (std_x * std_y)
         """
+        if not PANDAS_GT_150 and numeric_only is not no_default:
+            raise TypeError("numeric_only not supported for pandas < 1.5")
         return self.cov(
             split_every=split_every,
             split_out=split_out,
             std=True,
             numeric_only=numeric_only,
         )
 
     @derived_from(pd.DataFrame)
-    @numeric_only_not_implemented
     def cov(
         self, ddof=1, split_every=None, split_out=1, std=False, numeric_only=no_default
     ):
         """Groupby covariance is accomplished by
 
         1. Computing intermediate values for sum, count, and the product of
            all columns: a b c -> a*a, a*b, b*b, b*c, c*c.
 
         2. The values are then aggregated and the final covariance value is calculated:
            cov(X, Y) = X*Y - Xbar * Ybar
 
         When `std` is True calculate Correlation
         """
+        if not PANDAS_GT_150 and numeric_only is not no_default:
+            raise TypeError("numeric_only not supported for pandas < 1.5")
+        numeric_only_kwargs = get_numeric_only_kwargs(numeric_only)
         if self.sort is None and split_out > 1:
             warnings.warn(SORT_SPLIT_OUT_WARNING, FutureWarning)
 
         levels = _determine_levels(self.by)
 
         is_mask = any(is_series_like(s) for s in self.by)
         if self._slice:
@@ -2143,14 +2153,15 @@
             else [self.obj] + self.by,
             chunk=_cov_chunk,
             aggregate=_cov_agg,
             combine=_cov_combine,
             token=self._token_prefix + "cov",
             aggregate_kwargs={"ddof": ddof, "levels": levels, "std": std},
             combine_kwargs={"levels": levels},
+            chunk_kwargs=numeric_only_kwargs,
             split_every=split_every,
             split_out=split_out,
             split_out_setup=split_out_on_index,
             sort=self.sort,
         )
 
         if isinstance(self.obj, Series):
@@ -2159,40 +2170,38 @@
             result = result[self._slice]
         return result
 
     @derived_from(pd.core.groupby.GroupBy)
     def first(
         self, split_every=None, split_out=1, shuffle=None, numeric_only=no_default
     ):
-        if numeric_only is no_default:
-            numeric_only = False
+        numeric_kwargs = get_numeric_only_kwargs(numeric_only)
         return self._single_agg(
             func=M.first,
             token="first",
             split_every=split_every,
             split_out=split_out,
             shuffle=shuffle,
-            chunk_kwargs={"numeric_only": numeric_only},
-            aggregate_kwargs={"numeric_only": numeric_only},
+            chunk_kwargs=numeric_kwargs,
+            aggregate_kwargs=numeric_kwargs,
         )
 
     @derived_from(pd.core.groupby.GroupBy)
     def last(
         self, split_every=None, split_out=1, shuffle=None, numeric_only=no_default
     ):
-        if numeric_only is no_default:
-            numeric_only = False
+        numeric_kwargs = get_numeric_only_kwargs(numeric_only)
         return self._single_agg(
             token="last",
             func=M.last,
             split_every=split_every,
             split_out=split_out,
             shuffle=shuffle,
-            chunk_kwargs={"numeric_only": numeric_only},
-            aggregate_kwargs={"numeric_only": numeric_only},
+            chunk_kwargs=numeric_kwargs,
+            aggregate_kwargs=numeric_kwargs,
         )
 
     @derived_from(
         pd.core.groupby.GroupBy,
         inconsistencies="If the group is not present, Dask will return an empty Series/DataFrame.",
     )
     def get_group(self, key):
@@ -2532,15 +2541,15 @@
         1.  If the grouper does not align with the index then this causes a full
             shuffle.  The order of rows within each group may not be preserved.
         2.  Dask's GroupBy.transform is not appropriate for aggregations. For custom
             aggregations, use :class:`dask.dataframe.groupby.Aggregation`.
 
         .. warning::
 
-           Pandas' groupby-transform can be used to to apply arbitrary functions,
+           Pandas' groupby-transform can be used to apply arbitrary functions,
            including aggregations that result in one row per group. Dask's
            groupby-transform will apply ``func`` once on each group, doing a shuffle
            if needed, such that each group is contained in one partition.
            When ``func`` is a reduction, e.g., you'll end up with one row
            per group. To apply a custom aggregation with Dask,
            use :class:`dask.dataframe.groupby.Aggregation`.
 
@@ -2603,14 +2612,19 @@
             token=funcname(func),
             group_keys=self.group_keys,
             **self.observed,
             **self.dropna,
             **kwargs,
         )
 
+        if isinstance(self, DataFrameGroupBy):
+            index_name = df3.index.name
+            df3 = df3.reset_index().set_index(index_name or "index")
+            df3.index = df3.index.rename(index_name)
+
         return df3
 
     @insert_meta_param_description(pad=12)
     def shift(
         self, periods=1, freq=None, axis=no_default, fill_value=None, meta=no_default
     ):
         """Parallel version of pandas GroupBy.shift
```

### Comparing `dask-2023.4.1/dask/dataframe/hyperloglog.py` & `dask-2023.5.0/dask/dataframe/hyperloglog.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/indexing.py` & `dask-2023.5.0/dask/dataframe/indexing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/__init__.py` & `dask-2023.5.0/dask/dataframe/io/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/csv.py` & `dask-2023.5.0/dask/dataframe/io/csv.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/demo.py` & `dask-2023.5.0/dask/dataframe/io/demo.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/hdf.py` & `dask-2023.5.0/dask/dataframe/io/hdf.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/io.py` & `dask-2023.5.0/dask/dataframe/io/io.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/json.py` & `dask-2023.5.0/dask/dataframe/io/json.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/orc/arrow.py` & `dask-2023.5.0/dask/dataframe/io/orc/arrow.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/orc/core.py` & `dask-2023.5.0/dask/dataframe/io/orc/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/parquet/arrow.py` & `dask-2023.5.0/dask/dataframe/io/parquet/arrow.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/parquet/core.py` & `dask-2023.5.0/dask/dataframe/io/parquet/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/parquet/fastparquet.py` & `dask-2023.5.0/dask/dataframe/io/parquet/fastparquet.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/parquet/utils.py` & `dask-2023.5.0/dask/dataframe/io/parquet/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/sql.py` & `dask-2023.5.0/dask/dataframe/io/sql.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/tests/test_csv.py` & `dask-2023.5.0/dask/dataframe/io/tests/test_csv.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/tests/test_demo.py` & `dask-2023.5.0/dask/dataframe/io/tests/test_demo.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/tests/test_hdf.py` & `dask-2023.5.0/dask/dataframe/io/tests/test_hdf.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/tests/test_io.py` & `dask-2023.5.0/dask/dataframe/io/tests/test_io.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/tests/test_json.py` & `dask-2023.5.0/dask/dataframe/io/tests/test_json.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/tests/test_orc.py` & `dask-2023.5.0/dask/dataframe/io/tests/test_orc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/tests/test_parquet.py` & `dask-2023.5.0/dask/dataframe/io/tests/test_parquet.py`

 * *Files 0% similar despite different names*

```diff
@@ -1180,15 +1180,18 @@
         # fastparquet choooses to use masked type to be able to get true repr of
         # 16-bit int
         assert_eq(ddf.astype("UInt16"), ddf2, check_divisions=False)
     else:
         assert_eq(ddf, ddf2, check_divisions=False)
 
 
-@pytest.mark.xfail_with_pyarrow_strings  # https://github.com/apache/arrow/issues/33727
+@pytest.mark.xfail(
+    pyarrow_strings_enabled() and pyarrow_version < parse_version("12.0.0"),
+    reason="Known failure with pyarrow strings: https://github.com/apache/arrow/issues/33727",
+)
 def test_categories(tmpdir, engine):
     fn = str(tmpdir)
     df = pd.DataFrame({"x": [1, 2, 3, 4, 5], "y": list("caaab")})
     ddf = dd.from_pandas(df, npartitions=2)
     ddf["y"] = ddf.y.astype("category")
     ddf.to_parquet(fn, engine=engine)
     ddf2 = dd.read_parquet(
```

### Comparing `dask-2023.4.1/dask/dataframe/io/tests/test_sql.py` & `dask-2023.5.0/dask/dataframe/io/tests/test_sql.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/io/utils.py` & `dask-2023.5.0/dask/dataframe/io/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/methods.py` & `dask-2023.5.0/dask/dataframe/methods.py`

 * *Files 2% similar despite different names*

```diff
@@ -7,14 +7,15 @@
 from tlz import partition
 
 from dask.dataframe._compat import (
     PANDAS_GT_131,
     PANDAS_GT_140,
     PANDAS_GT_200,
     check_apply_dataframe_deprecation,
+    check_applymap_dataframe_deprecation,
     check_convert_dtype_deprecation,
     check_observed_deprecation,
 )
 
 #  preserve compatibility while moving dispatch objects
 from dask.dataframe.dispatch import (  # noqa: F401
     concat,
@@ -54,14 +55,19 @@
 
 def apply(df, *args, **kwargs):
     with check_convert_dtype_deprecation():
         with check_apply_dataframe_deprecation():
             return df.apply(*args, **kwargs)
 
 
+def applymap(df, *args, **kwargs):
+    with check_applymap_dataframe_deprecation():
+        return df.applymap(*args, **kwargs)
+
+
 def try_loc(df, iindexer, cindexer=None):
     """
     .loc for unknown divisions
     """
     try:
         return loc(df, iindexer, cindexer)
     except KeyError:
```

### Comparing `dask-2023.4.1/dask/dataframe/multi.py` & `dask-2023.5.0/dask/dataframe/multi.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/numeric.py` & `dask-2023.5.0/dask/dataframe/numeric.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/optimize.py` & `dask-2023.5.0/dask/dataframe/optimize.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/partitionquantiles.py` & `dask-2023.5.0/dask/dataframe/partitionquantiles.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/reshape.py` & `dask-2023.5.0/dask/dataframe/reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/rolling.py` & `dask-2023.5.0/dask/dataframe/rolling.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/shuffle.py` & `dask-2023.5.0/dask/dataframe/shuffle.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_accessors.py` & `dask-2023.5.0/dask/dataframe/tests/test_accessors.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_arithmetics_reduction.py` & `dask-2023.5.0/dask/dataframe/tests/test_arithmetics_reduction.py`

 * *Files 1% similar despite different names*

```diff
@@ -24,14 +24,19 @@
 )
 
 try:
     import scipy
 except ImportError:
     scipy = None
 
+try:
+    import pyarrow as pa
+except ImportError:
+    pa = None
+
 
 @pytest.mark.slow
 def test_arithmetics():
     dsk = {
         ("x", 0): pd.DataFrame({"a": [1, 2, 3], "b": [4, 5, 6]}, index=[0, 1, 3]),
         ("x", 1): pd.DataFrame({"a": [4, 5, 6], "b": [3, 2, 1]}, index=[5, 6, 8]),
         ("x", 2): pd.DataFrame({"a": [7, 8, 9], "b": [0, 0, 0]}, index=[9, 9, 9]),
@@ -1271,106 +1276,144 @@
 
     with check_numeric_only_deprecation():
         expected = getattr(df, func)(**kwargs)
         actual = getattr(ddf, func)(**kwargs)
         assert_eq(expected, actual)
 
 
-def test_reductions_frame_dtypes_numeric_only_supported():
+def test_count_numeric_only_axis_one():
+    df = pd.DataFrame(
+        {
+            "int": [1, 2, 3, 4, 5, 6, 7, 8],
+            "float": [1.0, 2.0, 3.0, 4.0, np.nan, 6.0, 7.0, 8.0],
+            "dt": [pd.NaT] + [datetime(2011, i, 1) for i in range(1, 8)],
+            "str": list("abcdefgh"),
+            "timedelta": pd.to_timedelta([1, 2, 3, 4, 5, 6, 7, np.nan]),
+            "bool": [True, False] * 4,
+        }
+    )
+    ddf = dd.from_pandas(df, npartitions=2)
+
+    assert_eq(ddf.count(axis=1), df.count(axis=1))
+    assert_eq(
+        ddf.count(numeric_only=False, axis=1), df.count(numeric_only=False, axis=1)
+    )
+    assert_eq(ddf.count(numeric_only=True, axis=1), df.count(numeric_only=True, axis=1))
+
+
+@pytest.mark.parametrize(
+    "func", ["sum", "prod", "product", "min", "max", "count", "var"]
+)
+def test_reductions_frame_dtypes_numeric_only_supported(func):
     df = pd.DataFrame(
         {
             "int": [1, 2, 3, 4, 5, 6, 7, 8],
             "float": [1.0, 2.0, 3.0, 4.0, np.nan, 6.0, 7.0, 8.0],
             "dt": [pd.NaT] + [datetime(2011, i, 1) for i in range(1, 8)],
             "str": list("abcdefgh"),
             "timedelta": pd.to_timedelta([1, 2, 3, 4, 5, 6, 7, np.nan]),
             "bool": [True, False] * 4,
         }
     )
 
     ddf = dd.from_pandas(df, 3)
-    funcs = ["sum"]
+    numeric_only_false_raises = ["sum", "prod", "product", "var"]
 
-    for func in funcs:
-        assert_eq(
-            getattr(df, func)(numeric_only=True),
-            getattr(ddf, func)(numeric_only=True),
-        )
+    # `numeric_only=True` is always supported
+    assert_eq(
+        getattr(df, func)(numeric_only=True),
+        getattr(ddf, func)(numeric_only=True),
+    )
+
+    # `numeric_only=False`
+    if func in numeric_only_false_raises:
         with pytest.raises(
             TypeError,
-            match="'DatetimeArray' with dtype datetime64.*|'DatetimeArray' does not implement reduction 'sum'",
+            match="'DatetimeArray' with dtype datetime64.*|'DatetimeArray' does not implement reduction",
         ):
             getattr(ddf, func)(numeric_only=False)
 
-        if PANDAS_GT_200:
+        warning = FutureWarning
+    else:
+        assert_eq(
+            getattr(df, func)(numeric_only=False),
+            getattr(ddf, func)(numeric_only=False),
+        )
+        warning = None
+
+    # `numeric_only` default value
+    if PANDAS_GT_200:
+        if func in numeric_only_false_raises:
             with pytest.raises(
-                TypeError, match="'DatetimeArray' with dtype datetime64.*"
+                TypeError,
+                match="'DatetimeArray' with dtype datetime64.*|'DatetimeArray' does not implement reduction",
             ):
                 getattr(ddf, func)()
-        elif PANDAS_GT_150:
-            with pytest.warns(FutureWarning, match="The default value of numeric_only"):
-                pd_result = getattr(df, func)()
-            with pytest.warns(FutureWarning, match="The default value of numeric_only"):
-                dd_result = getattr(ddf, func)()
-            assert_eq(pd_result, dd_result)
         else:
-            with pytest.warns(FutureWarning, match="Dropping of nuisance"):
-                pd_result = getattr(df, func)()
-            with pytest.warns(FutureWarning, match="Dropping of nuisance"):
-                dd_result = getattr(ddf, func)()
-            assert_eq(pd_result, dd_result)
+            assert_eq(
+                getattr(df, func)(),
+                getattr(ddf, func)(),
+            )
+    elif PANDAS_GT_150:
+        with pytest.warns(warning, match="The default value of numeric_only"):
+            pd_result = getattr(df, func)()
+        with pytest.warns(warning, match="The default value of numeric_only"):
+            dd_result = getattr(ddf, func)()
+        assert_eq(pd_result, dd_result)
+    else:
+        if func == "var":
+            warning = None
+        with pytest.warns(warning, match="Dropping of nuisance"):
+            pd_result = getattr(df, func)()
+        with pytest.warns(warning, match="Dropping of nuisance"):
+            dd_result = getattr(ddf, func)()
+        assert_eq(pd_result, dd_result)
 
     df_numerics = df[["int", "float", "bool"]]
     ddf_numerics = ddf[["int", "float", "bool"]]
 
-    for func in funcs:
-        assert_eq(
-            getattr(df_numerics, func)(),
-            getattr(ddf_numerics, func)(),
-        )
-        assert_eq(
-            getattr(df_numerics, func)(numeric_only=False),
-            getattr(ddf_numerics, func)(numeric_only=False),
-        )
+    assert_eq(
+        getattr(df_numerics, func)(),
+        getattr(ddf_numerics, func)(),
+    )
+    assert_eq(
+        getattr(df_numerics, func)(numeric_only=False),
+        getattr(ddf_numerics, func)(numeric_only=False),
+    )
 
 
-def test_reductions_frame_dtypes_numeric_only():
+@pytest.mark.parametrize(
+    "func",
+    [
+        "mean",
+        "std",
+        "sem",
+    ],
+)
+def test_reductions_frame_dtypes_numeric_only(func):
     df = pd.DataFrame(
         {
             "int": [1, 2, 3, 4, 5, 6, 7, 8],
             "float": [1.0, 2.0, 3.0, 4.0, np.nan, 6.0, 7.0, 8.0],
             "dt": [pd.NaT] + [datetime(2011, i, 1) for i in range(1, 8)],
             "str": list("abcdefgh"),
             "timedelta": pd.to_timedelta([1, 2, 3, 4, 5, 6, 7, np.nan]),
             "bool": [True, False] * 4,
         }
     )
 
     ddf = dd.from_pandas(df, 3)
     kwargs = {"numeric_only": True}
-    funcs = [
-        "prod",
-        "product",
-        "min",
-        "max",
-        "mean",
-        "var",
-        "std",
-        "count",
-        "sem",
-    ]
 
-    for func in funcs:
-        assert_eq(
-            getattr(df, func)(**kwargs),
-            getattr(ddf, func)(**kwargs),
-            check_dtype=func in ["mean", "max"],
-        )
-        with pytest.raises(NotImplementedError, match="'numeric_only=False"):
-            getattr(ddf, func)(numeric_only=False)
+    assert_eq(
+        getattr(df, func)(**kwargs),
+        getattr(ddf, func)(**kwargs),
+    )
+    with pytest.raises(NotImplementedError, match="'numeric_only=False"):
+        getattr(ddf, func)(numeric_only=False)
 
     assert_eq(df.sem(ddof=0, **kwargs), ddf.sem(ddof=0, **kwargs))
     assert_eq(df.std(ddof=0, **kwargs), ddf.std(ddof=0, **kwargs))
     assert_eq(df.var(ddof=0, **kwargs), ddf.var(ddof=0, **kwargs))
     assert_eq(df.var(skipna=False, **kwargs), ddf.var(skipna=False, **kwargs))
     assert_eq(
         df.var(skipna=False, ddof=0, **kwargs), ddf.var(skipna=False, ddof=0, **kwargs)
@@ -1381,20 +1424,18 @@
 
     df_numerics = df[["int", "float", "bool"]]
     ddf_numerics = ddf[["int", "float", "bool"]]
 
     assert_eq(df_numerics, ddf._get_numeric_data())
     assert ddf_numerics._get_numeric_data().dask == ddf_numerics.dask
 
-    for func in funcs:
-        assert_eq(
-            getattr(df_numerics, func)(),
-            getattr(ddf_numerics, func)(),
-            check_dtype=func in ["mean", "max"],
-        )
+    assert_eq(
+        getattr(df_numerics, func)(),
+        getattr(ddf_numerics, func)(),
+    )
 
 
 @pytest.mark.parametrize("split_every", [False, 2])
 def test_reductions_frame_nan(split_every):
     df = pd.DataFrame(
         {
             "a": [1, 2, np.nan, 4, 5, 6, 7, 8],
@@ -1768,13 +1809,43 @@
     expected = pdf2.std(axis=1, **kwargs)
     with dctx:
         result = ddf2.std(axis=1, **kwargs)
     if success:
         assert_eq(result, expected)
 
 
+@pytest.mark.parametrize(
+    "dtypes",
+    [
+        pytest.param(
+            ("int64[pyarrow]", "float64[pyarrow]"),
+            marks=pytest.mark.skipif(
+                pa is None or not PANDAS_GT_150,
+                reason="requires pyarrow installed and ArrowDtype",
+            ),
+        ),
+        ("Int64", "Float64"),
+    ],
+)
+@pytest.mark.parametrize("func", ["std", "var", "skew"])
+def test_reductions_with_pandas_and_arrow_ea(dtypes, func):
+    if func in ["skew"]:
+        pytest.importorskip("scipy")
+        if "pyarrow" in dtypes[0]:
+            pytest.xfail("skew not implemented for arrow dtypes")
+
+    pdf = pd.DataFrame({"a": [1, 2, 3, 4], "b": [4, 5, 6, 7]}).astype(
+        {"a": dtypes[0], "b": dtypes[1]}
+    )
+    ddf = dd.from_pandas(pdf, npartitions=2)
+    pd_result = getattr(pdf, func)()
+    dd_result = getattr(ddf, func)()
+
+    assert_eq(dd_result, pd_result, check_dtype=False)  # _meta is wrongly NA
+
+
 def test_std_raises_on_index():
     with pytest.raises(
         NotImplementedError,
         match="`std` is only supported with objects that are Dataframes or Series",
     ):
         dd.from_pandas(pd.DataFrame({"test": [1, 2]}), npartitions=2).index.std()
```

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_boolean.py` & `dask-2023.5.0/dask/dataframe/tests/test_boolean.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_categorical.py` & `dask-2023.5.0/dask/dataframe/tests/test_categorical.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_dataframe.py` & `dask-2023.5.0/dask/dataframe/tests/test_dataframe.py`

 * *Files 0% similar despite different names*

```diff
@@ -3223,20 +3223,46 @@
 
     func = lambda row: row["x"] + row["y"]
 
     with pytest.warns(FutureWarning, match="Meta is not valid"):
         ddf.apply(func, axis=1, meta=int)
 
 
-def test_applymap():
+@pytest.mark.skipif(not PANDAS_GT_210, reason="Not available before")
+def test_dataframe_map():
+    df = pd.DataFrame({"x": [1, 2, 3, 4], "y": [10, 20, 30, 40]})
+    ddf = dd.from_pandas(df, npartitions=2)
+    assert_eq(ddf.map(lambda x: x + 1), df.map(lambda x: x + 1))
+    assert_eq(ddf.map(lambda x: (x, x)), df.map(lambda x: (x, x)))
+
+
+@pytest.mark.skipif(PANDAS_GT_210, reason="Available at 2.1")
+def test_dataframe_map_raises():
     df = pd.DataFrame({"x": [1, 2, 3, 4], "y": [10, 20, 30, 40]})
     ddf = dd.from_pandas(df, npartitions=2)
-    assert_eq(ddf.applymap(lambda x: x + 1), df.applymap(lambda x: x + 1))
+    with pytest.raises(NotImplementedError, match="DataFrame.map requires pandas"):
+        ddf.map(lambda x: x + 1)
 
-    assert_eq(ddf.applymap(lambda x: (x, x)), df.applymap(lambda x: (x, x)))
+
+def test_applymap():
+    df = pd.DataFrame({"x": [1, 2, 3, 4], "y": [10, 20, 30, 40]})
+    ddf = dd.from_pandas(df, npartitions=2)
+    msg = "DataFrame.applymap has been deprecated"
+    warning = FutureWarning if PANDAS_GT_210 else None
+    with pytest.warns(warning, match=msg):
+        ddf_result = ddf.applymap(lambda x: x + 1)
+    with pytest.warns(warning, match=msg):
+        pdf_result = df.applymap(lambda x: x + 1)
+    assert_eq(ddf_result, pdf_result)
+
+    with pytest.warns(warning, match=msg):
+        ddf_result = ddf.applymap(lambda x: (x, x))
+    with pytest.warns(warning, match=msg):
+        pdf_result = df.applymap(lambda x: (x, x))
+    assert_eq(ddf_result, pdf_result)
 
 
 def test_add_prefix():
     df = pd.DataFrame({"x": [1, 2, 3, 4, 5], "y": [4, 5, 6, 7, 8]})
     ddf = dd.from_pandas(df, npartitions=2)
     assert_eq(ddf.add_prefix("abc"), df.add_prefix("abc"))
     assert_eq(ddf.x.add_prefix("abc"), df.x.add_prefix("abc"))
@@ -3451,24 +3477,25 @@
     assert_eq(result, expected)
 
     # test with split_every
     result2 = ddf.A.corr(ddf.B.rename("A"), split_every=2)
     assert_eq(result2, expected)
 
 
-def test_cov_corr_meta():
+@pytest.mark.parametrize("chunksize", [1, 2])
+def test_cov_corr_meta(chunksize):
     df = pd.DataFrame(
         {
             "a": np.array([1, 2, 3, 4]),
             "b": np.array([1.0, 2.0, 3.0, 4.0], dtype="f4"),
             "c": np.array([1.0, 2.0, 3.0, 4.0]),
         },
         index=pd.Index([1, 2, 3, 4], name="myindex"),
     )
-    ddf = dd.from_pandas(df, npartitions=2)
+    ddf = dd.from_pandas(df, chunksize=chunksize)
     assert_eq(ddf.corr(), df.corr())
     assert_eq(ddf.cov(), df.cov())
     assert ddf.a.cov(ddf.b)._meta.dtype == "f8"
     assert ddf.a.corr(ddf.b)._meta.dtype == "f8"
 
 
 @pytest.mark.slow
@@ -4223,14 +4250,30 @@
     ddf = dd.concat([dd.from_pandas(empty, npartitions=1)] * 10)
     with pytest.raises(ValueError):
         ddf.idxmax().compute()
     with pytest.raises(ValueError):
         ddf.b.idxmax().compute()
 
 
+def test_mode_numeric_only():
+    df = pd.DataFrame(
+        {
+            "int": [1, 2, 3, 4, 5, 6, 7, 8],
+            "float": [1.0, 2.0, 3.0, 4.0, np.nan, 6.0, 7.0, 8.0],
+            "dt": [pd.NaT] + [datetime(2010, i, 1) for i in range(1, 8)],
+            "timedelta": pd.to_timedelta([1, 2, 3, 4, 5, 6, 7, np.nan]),
+        }
+    )
+    ddf = dd.from_pandas(df, npartitions=2)
+
+    assert_eq(ddf.mode(numeric_only=False), df.mode(numeric_only=False))
+    assert_eq(ddf.mode(), df.mode())
+    assert_eq(ddf.mode(numeric_only=True), df.mode(numeric_only=True))
+
+
 def test_getitem_meta():
     data = {"col1": ["a", "a", "b"], "col2": [0, 1, 0]}
 
     df = pd.DataFrame(data=data, columns=["col1", "col2"])
     ddf = dd.from_pandas(df, npartitions=1)
 
     assert_eq(df.col2[df.col1 == "a"], ddf.col2[ddf.col1 == "a"])
@@ -5774,7 +5817,63 @@
 
         # Default `to_backend` shouldn't change data
         assert_eq(df, df.to_backend())
 
         # Moving to a "missing" backend should raise an error
         with pytest.raises(ValueError, match="No backend dispatch registered"):
             df.to_backend("missing")
+
+
+@pytest.mark.parametrize("func", ["max", "sum"])
+def test_transform_getitem_works(func):
+    df = pd.DataFrame({"ints": [1, 2, 3], "grouper": [0, 1, 0]})
+
+    ddf = dd.from_pandas(df, npartitions=2)
+
+    # what happens here is not exactly a transform, but a reduction
+    # the result of which is broadcasted back to the original shape.
+    # Broadcasting an aggregation in this manner is very performant in pandas
+    meta = df.groupby("grouper").transform(func)
+    df["new"] = df.groupby("grouper").transform(func)["ints"]
+    ddf["new"] = ddf.groupby("grouper").transform(func, meta=meta)["ints"]
+
+    assert_eq(df, ddf)
+
+
+@pytest.mark.parametrize(
+    "df,cond",
+    [
+        (pd.DataFrame({"x": [1, 2]}, index=[1, 2]), [[True], [False]]),
+        (pd.DataFrame({"x": [1, 2], "y": [3, 4]}), [[True, False], [True, False]]),
+        (pd.DataFrame({"x": [1, 2], "y": [3, 4]}), [[True, True], [False, False]]),
+        (
+            pd.DataFrame({"x": [1, 2, 3, 4], "y": [3, 4, 5, 6]}),
+            [[True, True], [True, True], [False, False], [False, False]],
+        ),
+        (
+            pd.DataFrame({"x": [1, 2, 3, 4], "y": [3, 4, 5, 6]}),
+            [[True, False], [True, False], [True, False], [True, False]],
+        ),
+    ],
+)
+def test_mask_where_array_like(df, cond):
+    """DataFrame.mask fails for single-row partitions
+    https://github.com/dask/dask/issues/9848
+    """
+    ddf = dd.from_pandas(df, npartitions=2)
+
+    # ensure raises when list is provided
+    with pytest.raises(ValueError, match="can be aligned"):
+        ddf.mask(cond=cond, other=5)
+
+    with pytest.raises(ValueError, match="can be aligned"):
+        ddf.where(cond=cond, other=5)
+
+    # but works when DataFrame is provided, with matching index
+    dd_cond = pd.DataFrame(cond, index=df.index, columns=df.columns)
+    expected = df.mask(cond=cond, other=5)
+    result = ddf.mask(cond=dd_cond, other=5)
+    assert_eq(expected, result)
+
+    expected = df.where(cond=cond, other=5)
+    result = ddf.where(cond=dd_cond, other=5)
+    assert_eq(expected, result)
```

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_extensions.py` & `dask-2023.5.0/dask/dataframe/tests/test_extensions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_format.py` & `dask-2023.5.0/dask/dataframe/tests/test_format.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_groupby.py` & `dask-2023.5.0/dask/dataframe/tests/test_groupby.py`

 * *Files 0% similar despite different names*

```diff
@@ -40,22 +40,15 @@
         "mean",
         marks=pytest.mark.xfail(
             condition=PANDAS_GT_200,
             reason="numeric_only=False not implemented",
             strict=False,
         ),
     ),
-    pytest.param(
-        "median",
-        marks=pytest.mark.xfail(
-            condition=PANDAS_GT_200,
-            reason="numeric_only=False not implemented",
-            strict=False,
-        ),
-    ),
+    "median",
     "min",
     "max",
     "count",
     "size",
     pytest.param(
         "std",
         marks=pytest.mark.xfail(
@@ -2239,15 +2232,17 @@
     # TODO: add deprecation warnings to match pandas
     ctx = contextlib.nullcontext()
     if func != "sum":
         ctx = check_nuisance_columns_warning()
     with ctx, check_numeric_only_deprecation():
         expected = getattr(df, func)()
     with _check_warning(
-        func == "std" and not PANDAS_GT_200, FutureWarning, message="numeric_only"
+        func in ["std", "var"] and not PANDAS_GT_200,
+        FutureWarning,
+        message="numeric_only",
     ):
         result = getattr(ddf, func)()
     assert_eq(expected, result)
 
     # DataFrameGroupBy
     with record_numeric_only_warnings() as rec_pd:
         expected = getattr(df.groupby("x"), func)()
@@ -2701,15 +2696,15 @@
         assert_eq(
             pdf.groupby("A")["B"].transform(transformation),
             ddf.groupby("A")["B"].transform(transformation),
         )
 
 
 @pytest.mark.parametrize("npartitions", list(range(1, 10)))
-@pytest.mark.parametrize("indexed", [True, False])
+@pytest.mark.parametrize("indexed", [True, False], ids=["indexed", "not_indexed"])
 def test_groupby_transform_ufunc_partitioning(npartitions, indexed):
     pdf = pd.DataFrame({"group": [1, 2, 3, 4, 5] * 20, "value": np.random.randn(100)})
 
     if indexed:
         pdf = pdf.set_index("group")
 
     ddf = dd.from_pandas(pdf, npartitions)
@@ -3222,14 +3217,16 @@
 @pytest.mark.parametrize("groupby", ["cat_1", ["cat_1", "cat_2"]])
 @pytest.mark.parametrize("observed", [True, False], ids=["observed", "unobserved"])
 def test_groupby_aggregate_categorical_observed(
     known_cats, ordered_cats, agg_func, groupby, observed
 ):
     if agg_func in ["cov", "corr", "nunique"]:
         pytest.skip("Not implemented for DataFrameGroupBy yet.")
+    if agg_func == "median" and isinstance(groupby, str):
+        pytest.skip("Can't calculate median over categorical")
     if agg_func in ["sum", "count", "prod"] and groupby != "cat_1":
         pytest.skip("Gives zeros rather than nans.")
     if agg_func in ["std", "var"] and observed:
         pytest.skip("Can't calculate observed with all nans")
     if agg_func in ["sum", "prod"] and PANDAS_GT_200:
         pytest.xfail("Not implemented for category type with pandas 2.0")
 
@@ -3508,14 +3505,15 @@
     [
         "min",
         "max",
         "sum",
         "prod",
         "first",
         "last",
+        "median",
         pytest.param(
             "idxmax",
             marks=pytest.mark.skip(reason="https://github.com/dask/dask/issues/9882"),
         ),
         pytest.param(
             "idxmin",
             marks=pytest.mark.skip(reason="https://github.com/dask/dask/issues/9882"),
@@ -3543,29 +3541,32 @@
     kwargs = {} if numeric_only is None else {"numeric_only": numeric_only}
 
     # Some groupby methods will raise deprecation warnings or TypeErrors
     # depending on the version of pandas being used. Here we check that
     # dask and panadas have similar behavior
     ctx = contextlib.nullcontext()
     if PANDAS_GT_150 and not PANDAS_GT_200:
-        if func in ("sum", "prod"):
+        if func in ("sum", "prod", "median"):
             if numeric_only is None:
                 ctx = pytest.warns(
                     FutureWarning, match="The default value of numeric_only"
                 )
             elif numeric_only is False:
                 ctx = pytest.warns(FutureWarning, match="Dropping invalid columns")
 
     try:
         with ctx:
             expected = getattr(pdf.groupby("ints"), func)(**kwargs)
         successful_compute = True
-    except TypeError as e:
+    except TypeError:
         # Make sure dask and pandas raise the same error message
-        ctx = pytest.raises(TypeError, match=str(e))
+        # We raise the error on _meta_nonempty, actual element may differ
+        ctx = pytest.raises(
+            TypeError, match="Cannot convert|could not convert|does not support"
+        )
         successful_compute = False
 
     # Here's where we check that dask behaves the same as pandas
     with ctx:
         result = getattr(ddf.groupby("ints"), func)(**kwargs)
         if successful_compute:
             # expected is None if an error was raised
@@ -3606,30 +3607,51 @@
     [
         "min",
         "max",
         "sum",
         "prod",
         "first",
         "last",
-        # "corr",  TODO: These will get implemented in a follow up
-        # "cov",
-        # "cumprod",
-        # "cumsum",
+        "corr",
+        "cov",
+        "cumprod",
+        "cumsum",
         "mean",
         "median",
         "std",
         "var",
     ],
 )
 def test_groupby_numeric_only_true(func):
-    df = pd.DataFrame({"A": [1, 1, 2], "B": [3, 4, 3], "C": ["a", "b", "c"]})
-    ddf = dd.from_pandas(df, npartitions=3)
+    df = pd.DataFrame({"A": [1, 1, 2, 2], "B": [3, 4, 3, 4], "C": ["a", "b", "c", "d"]})
+    ddf = dd.from_pandas(df, npartitions=2)
 
-    if func in ["var", "std"] and not PANDAS_GT_150:
+    if func in ["var", "std", "cov", "corr"] and not PANDAS_GT_150:
         with pytest.raises(TypeError, match="numeric_only not supported"):
             getattr(ddf.groupby("A"), func)(numeric_only=True)
         with pytest.raises(TypeError, match="got an unexpected keyword"):
             getattr(df.groupby("A"), func)(numeric_only=True)
     else:
         ddf_result = getattr(ddf.groupby("A"), func)(numeric_only=True)
         pdf_result = getattr(df.groupby("A"), func)(numeric_only=True)
         assert_eq(ddf_result, pdf_result)
+
+
+@pytest.mark.skipif(not PANDAS_GT_150, reason="numeric_only not supported for <1.5")
+@pytest.mark.parametrize("func", ["cov", "corr"])
+def test_groupby_numeric_only_false_cov_corr(func):
+    df = pd.DataFrame(
+        {
+            "float": [1.0, 2.0, 3.0, 4.0, 5, 6.0, 7.0, 8.0],
+            "int": [1, 2, 3, 4, 5, 6, 7, 8],
+            "timedelta": pd.to_timedelta([1, 2, 3, 4, 5, 6, 7, 8]),
+            "A": 1,
+        }
+    )
+    ddf = dd.from_pandas(df, npartitions=2)
+    dd_result = getattr(ddf.groupby("A"), func)(numeric_only=False)
+    pd_result = getattr(df.groupby("A"), func)(numeric_only=False)
+    assert_eq(dd_result, pd_result)
+
+    dd_result = getattr(ddf.groupby("A"), func)(numeric_only=True)
+    pd_result = getattr(df.groupby("A"), func)(numeric_only=True)
+    assert_eq(dd_result, pd_result)
```

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_hashing.py` & `dask-2023.5.0/dask/dataframe/tests/test_hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_hyperloglog.py` & `dask-2023.5.0/dask/dataframe/tests/test_hyperloglog.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_indexing.py` & `dask-2023.5.0/dask/dataframe/tests/test_indexing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_merge_column_and_index.py` & `dask-2023.5.0/dask/dataframe/tests/test_merge_column_and_index.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_multi.py` & `dask-2023.5.0/dask/dataframe/tests/test_multi.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_numeric.py` & `dask-2023.5.0/dask/dataframe/tests/test_numeric.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_optimize_dataframe.py` & `dask-2023.5.0/dask/dataframe/tests/test_optimize_dataframe.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_pyarrow.py` & `dask-2023.5.0/dask/dataframe/tests/test_pyarrow.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_pyarrow_compat.py` & `dask-2023.5.0/dask/dataframe/tests/test_pyarrow_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_reshape.py` & `dask-2023.5.0/dask/dataframe/tests/test_reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_rolling.py` & `dask-2023.5.0/dask/dataframe/tests/test_rolling.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_shuffle.py` & `dask-2023.5.0/dask/dataframe/tests/test_shuffle.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_ufunc.py` & `dask-2023.5.0/dask/dataframe/tests/test_ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tests/test_utils_dataframe.py` & `dask-2023.5.0/dask/dataframe/tests/test_utils_dataframe.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tseries/resample.py` & `dask-2023.5.0/dask/dataframe/tseries/resample.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/tseries/tests/test_resample.py` & `dask-2023.5.0/dask/dataframe/tseries/tests/test_resample.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dataframe/utils.py` & `dask-2023.5.0/dask/dataframe/utils.py`

 * *Files 0% similar despite different names*

```diff
@@ -825,7 +825,13 @@
         else object
     )
 
 
 def pyarrow_strings_enabled():
     """Config setting to convert objects to pyarrow strings"""
     return bool(config.get("dataframe.convert-string"))
+
+
+def get_numeric_only_kwargs(numeric_only) -> dict:
+    from dask.dataframe.core import no_default  # Avoid circular import
+
+    return {} if numeric_only is no_default else {"numeric_only": numeric_only}
```

### Comparing `dask-2023.4.1/dask/datasets.py` & `dask-2023.5.0/dask/datasets.py`

 * *Files 4% similar despite different names*

```diff
@@ -1,9 +1,11 @@
 import random
 
+from packaging.version import Version
+
 from dask.utils import import_required
 
 
 def timeseries(
     start="2000-01-01",
     end="2000-01-31",
     freq="1s",
@@ -70,19 +72,27 @@
 def _generate_mimesis(field, schema_description, records_per_partition, seed):
     """Generate data for a single partition of a dask bag
 
     See Also
     --------
     _make_mimesis
     """
+    import mimesis
     from mimesis.schema import Field, Schema
 
     field = Field(seed=seed, **field)
-    schema = Schema(schema=lambda: schema_description(field))
-    return [schema.create(iterations=1)[0] for i in range(records_per_partition)]
+    # `iterations=` kwarg moved from `Schema.create()` to `Schema.__init__()`
+    # starting with `mimesis=9`.
+    schema_kwargs, create_kwargs = {}, {}
+    if Version(mimesis.__version__) < Version("9.0.0"):
+        create_kwargs["iterations"] = 1
+    else:
+        schema_kwargs["iterations"] = 1
+    schema = Schema(schema=lambda: schema_description(field), **schema_kwargs)
+    return [schema.create(**create_kwargs)[0] for i in range(records_per_partition)]
 
 
 def _make_mimesis(field, schema, npartitions, records_per_partition, seed=None):
     """
     Make a Dask Bag filled with data randomly generated by the mimesis projet
 
     Parameters
```

### Comparing `dask-2023.4.1/dask/delayed.py` & `dask-2023.5.0/dask/delayed.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/diagnostics/profile.py` & `dask-2023.5.0/dask/diagnostics/profile.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/diagnostics/profile_visualize.py` & `dask-2023.5.0/dask/diagnostics/profile_visualize.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/diagnostics/progress.py` & `dask-2023.5.0/dask/diagnostics/progress.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/diagnostics/tests/test_profiler.py` & `dask-2023.5.0/dask/diagnostics/tests/test_profiler.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/diagnostics/tests/test_progress.py` & `dask-2023.5.0/dask/diagnostics/tests/test_progress.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/distributed.py` & `dask-2023.5.0/dask/distributed.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/dot.py` & `dask-2023.5.0/dask/dot.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/graph_manipulation.py` & `dask-2023.5.0/dask/graph_manipulation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/hashing.py` & `dask-2023.5.0/dask/hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/highlevelgraph.py` & `dask-2023.5.0/dask/highlevelgraph.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/layers.py` & `dask-2023.5.0/dask/layers.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/local.py` & `dask-2023.5.0/dask/local.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/multiprocessing.py` & `dask-2023.5.0/dask/multiprocessing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/optimization.py` & `dask-2023.5.0/dask/optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/order.py` & `dask-2023.5.0/dask/order.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/rewrite.py` & `dask-2023.5.0/dask/rewrite.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/sizeof.py` & `dask-2023.5.0/dask/sizeof.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/system.py` & `dask-2023.5.0/dask/system.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_backends.py` & `dask-2023.5.0/dask/tests/test_backends.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_base.py` & `dask-2023.5.0/dask/tests/test_base.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_cache.py` & `dask-2023.5.0/dask/tests/test_cache.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_callbacks.py` & `dask-2023.5.0/dask/tests/test_callbacks.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_ci.py` & `dask-2023.5.0/dask/tests/test_ci.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_cli.py` & `dask-2023.5.0/dask/tests/test_cli.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_config.py` & `dask-2023.5.0/dask/tests/test_config.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_context.py` & `dask-2023.5.0/dask/tests/test_context.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_core.py` & `dask-2023.5.0/dask/tests/test_core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_datasets.py` & `dask-2023.5.0/dask/tests/test_datasets.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_delayed.py` & `dask-2023.5.0/dask/tests/test_delayed.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_distributed.py` & `dask-2023.5.0/dask/tests/test_distributed.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_docs.py` & `dask-2023.5.0/dask/tests/test_docs.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_dot.py` & `dask-2023.5.0/dask/tests/test_dot.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_graph_manipulation.py` & `dask-2023.5.0/dask/tests/test_graph_manipulation.py`

 * *Files 6% similar despite different names*

```diff
@@ -13,14 +13,15 @@
 from dask.highlevelgraph import HighLevelGraph
 from dask.tests.test_base import Tuple
 from dask.utils_test import import_or_none
 
 da = import_or_none("dask.array")
 dd = import_or_none("dask.dataframe")
 pd = import_or_none("pandas")
+zarr = import_or_none("zarr")
 
 
 class NodeCounter:
     def __init__(self):
         self.n = 0
 
     def f(self, x):
@@ -221,36 +222,60 @@
     out = clone({"x": [t2]}, omit={"y": [t1, t3]}, assume_layers=layers)
     assert dask.compute(out) == ({"x": [(3,)]},)
     c8 = out["x"][0]
     assert_no_common_keys(c8, t2, omit=t1, layers=layers)
     assert_no_common_keys(c8, t3, layers=layers)
 
 
-@pytest.mark.skipif("not da or not dd")
+@pytest.mark.skipif("not da")
 @pytest.mark.parametrize(
     "literal",
     [
         1,
         (1,),
         [1],
         {1: 1},
         {1},
     ],
 )
 def test_blockwise_clone_with_literals(literal):
+    """https://github.com/dask/dask/issues/8978
+
+    clone() on the result of a dask.array.blockwise operation with a (iterable) literal
+    argument
+    """
     arr = da.ones(10, chunks=1)
 
     def noop(arr, lit):
         return arr
 
     blk = da.blockwise(noop, "x", arr, "x", literal, None)
 
     cln = clone(blk)
 
     assert_no_common_keys(blk, cln, layers=True)
+    da.utils.assert_eq(blk, cln)
+
+
+@pytest.mark.skipif("not da or not zarr")
+def test_blockwise_clone_with_no_indices():
+    """https://github.com/dask/dask/issues/9621
+
+    clone() on a Blockwise layer on top of a dependency layer with no indices
+    """
+    blk = da.from_zarr(zarr.ones(10))
+    # This use case leverages the current implementation details of from_array when the
+    # input is neither a numpy.ndarray nor a list. If it were to change in the future,
+    # please find another way to create a use case that satisfies these assertions.
+    assert isinstance(blk.dask.layers[blk.name], Blockwise)
+    assert any(isinstance(k, str) for k in blk.dask)
+
+    cln = clone(blk)
+    assert_no_common_keys(blk, cln, layers=True)
+    da.utils.assert_eq(blk, cln)
 
 
 @pytest.mark.parametrize("layers", [False, True])
 def test_bind(layers):
     dsk1 = {("a-1", h1): 1, ("a-1", h2): 2}
     dsk2 = {"b-1": (add, ("a-1", h1), ("a-1", h2))}
     dsk3 = {"c-1": "b-1"}
```

### Comparing `dask-2023.4.1/dask/tests/test_hashing.py` & `dask-2023.5.0/dask/tests/test_hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_highgraph.py` & `dask-2023.5.0/dask/tests/test_highgraph.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_layers.py` & `dask-2023.5.0/dask/tests/test_layers.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_local.py` & `dask-2023.5.0/dask/tests/test_local.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_multiprocessing.py` & `dask-2023.5.0/dask/tests/test_multiprocessing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_optimization.py` & `dask-2023.5.0/dask/tests/test_optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_order.py` & `dask-2023.5.0/dask/tests/test_order.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_rewrite.py` & `dask-2023.5.0/dask/tests/test_rewrite.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_sizeof.py` & `dask-2023.5.0/dask/tests/test_sizeof.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_spark_compat.py` & `dask-2023.5.0/dask/tests/test_spark_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_system.py` & `dask-2023.5.0/dask/tests/test_system.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_threaded.py` & `dask-2023.5.0/dask/tests/test_threaded.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_typing.py` & `dask-2023.5.0/dask/tests/test_typing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_utils.py` & `dask-2023.5.0/dask/tests/test_utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/tests/test_utils_test.py` & `dask-2023.5.0/dask/tests/test_utils_test.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/threaded.py` & `dask-2023.5.0/dask/threaded.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/typing.py` & `dask-2023.5.0/dask/typing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/utils.py` & `dask-2023.5.0/dask/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/utils_test.py` & `dask-2023.5.0/dask/utils_test.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/widgets/__init__.py` & `dask-2023.5.0/dask/widgets/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/widgets/templates/array.html.j2` & `dask-2023.5.0/dask/widgets/templates/array.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/widgets/templates/highlevelgraph.html.j2` & `dask-2023.5.0/dask/widgets/templates/highlevelgraph.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/widgets/templates/highlevelgraph_layer.html.j2` & `dask-2023.5.0/dask/widgets/templates/highlevelgraph_layer.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/widgets/tests/test_widgets.py` & `dask-2023.5.0/dask/widgets/tests/test_widgets.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask/widgets/widgets.py` & `dask-2023.5.0/dask/widgets/widgets.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/dask.egg-info/PKG-INFO` & `dask-2023.5.0/dask.egg-info/PKG-INFO`

 * *Files 4% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask
-Version: 2023.4.1
+Version: 2023.5.0
 Summary: Parallel PyData with Task Scheduling
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Homepage, https://github.com/dask/dask/
 Keywords: task-scheduling parallel numpy pandas pydata
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
```

### Comparing `dask-2023.4.1/dask.egg-info/SOURCES.txt` & `dask-2023.5.0/dask.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/Makefile` & `dask-2023.5.0/docs/Makefile`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/make.bat` & `dask-2023.5.0/docs/make.bat`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/10-minutes-to-dask.rst` & `dask-2023.5.0/docs/source/10-minutes-to-dask.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/_static/config_converter.js` & `dask-2023.5.0/docs/source/_static/config_converter.js`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/_static/dask-simple.png` & `dask-2023.5.0/docs/source/_static/dask-simple.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/_static/main-page.css` & `dask-2023.5.0/docs/source/_static/main-page.css`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/_static/profile.html` & `dask-2023.5.0/docs/source/_static/profile.html`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/_static/stacked_profile.html` & `dask-2023.5.0/docs/source/_static/stacked_profile.html`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/_static/style.css` & `dask-2023.5.0/docs/source/_static/style.css`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/_static/transpose_cyto.html` & `dask-2023.5.0/docs/source/_static/transpose_cyto.html`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/_static/yaml.min.js` & `dask-2023.5.0/docs/source/_static/yaml.min.js`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/api.rst` & `dask-2023.5.0/docs/source/api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-api.rst` & `dask-2023.5.0/docs/source/array-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-assignment.rst` & `dask-2023.5.0/docs/source/array-assignment.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-best-practices.rst` & `dask-2023.5.0/docs/source/array-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-chunks.rst` & `dask-2023.5.0/docs/source/array-chunks.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-creation.rst` & `dask-2023.5.0/docs/source/array-creation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-design.rst` & `dask-2023.5.0/docs/source/array-design.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-gufunc.rst` & `dask-2023.5.0/docs/source/array-gufunc.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-overlap.rst` & `dask-2023.5.0/docs/source/array-overlap.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-random.rst` & `dask-2023.5.0/docs/source/array-random.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-slicing.rst` & `dask-2023.5.0/docs/source/array-slicing.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-sparse.rst` & `dask-2023.5.0/docs/source/array-sparse.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-stack.rst` & `dask-2023.5.0/docs/source/array-stack.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array-stats.rst` & `dask-2023.5.0/docs/source/array-stats.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/array.rst` & `dask-2023.5.0/docs/source/array.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/bag-api.rst` & `dask-2023.5.0/docs/source/bag-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/bag-creation.rst` & `dask-2023.5.0/docs/source/bag-creation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/bag.rst` & `dask-2023.5.0/docs/source/bag.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/best-practices.rst` & `dask-2023.5.0/docs/source/best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/caching.rst` & `dask-2023.5.0/docs/source/caching.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/changelog.rst` & `dask-2023.5.0/docs/source/changelog.rst`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,56 @@
 Changelog
 =========
 
+.. _v2023.5.0:
+
+2023.5.0
+--------
+
+Released on May 12, 2023
+
+Enhancements
+^^^^^^^^^^^^
+- Implement ``numeric_only=False`` for ``GroupBy.corr`` and ``GroupBy.cov`` (:pr:`10264`) `Patrick Hoefler`_
+- Add support for ``numeric_only=False`` in ``DataFrame.var`` (:pr:`10250`) `Patrick Hoefler`_
+- Add ``numeric_only`` support to ``DataFrame.mode`` (:pr:`10257`) `Patrick Hoefler`_
+- Add ``DataFrame.map`` to ``dask.DataFrame`` API (:pr:`10246`) `Patrick Hoefler`_
+- Adjust for ``DataFrame.applymap`` deprecation and all ``NA`` ``concat`` behaviour change (:pr:`10245`) `Patrick Hoefler`_
+- Enable ``numeric_only=False`` for ``DataFrame.count`` (:pr:`10234`) `Patrick Hoefler`_
+- Disallow array input in mask/where (:pr:`10163`) `Irina Truong`_
+- Support ``numeric_only=True`` in ``GroupBy.corr`` and ``GroupBy.cov`` (:pr:`10227`) `Patrick Hoefler`_
+- Add ``numeric_only`` support to ``GroupBy.median`` (:pr:`10236`) `Patrick Hoefler`_
+- Support ``mimesis=9`` in ``dask.datasets`` (:pr:`10241`) `James Bourbeau`_
+- Add ``numeric_only`` support to ``min``, ``max`` and ``prod`` (:pr:`10219`) `Patrick Hoefler`_
+- Add ``numeric_only=True`` support for ``GroupBy.cumsum`` and ``GroupBy.cumprod`` (:pr:`10224`) `Patrick Hoefler`_
+- Add helper to unpack ``numeric_only`` keyword (:pr:`10228`) `Patrick Hoefler`_
+
+Bug Fixes
+^^^^^^^^^
+- Fix ``clone`` + ``from_array`` failure (:pr:`10211`) `crusaderky`_
+- Fix dataframe reductions for ea dtypes (:pr:`10150`) `Patrick Hoefler`_
+- Avoid scalar conversion deprecation warning in ``numpy=1.25`` (:pr:`10248`) `James Bourbeau`_
+- Make sure transform output has the same index as input (:pr:`10184`) `Irina Truong`_
+- Fix ``corr`` and ``cov`` on a single-row partition (:pr:`9756`) `Irina Truong`_
+- Fix ``test_groupby_numeric_only_supported`` and ``test_groupby_aggregate_categorical_observed`` upstream errors  (:pr:`10243`) `Irina Truong`_
+
+Documentation
+^^^^^^^^^^^^^
+- Clean up futures docs (:pr:`10266`) `Matthew Rocklin`_
+- Add ``Index`` API reference (:pr:`10263`) `hotpotato`_
+
+Maintenance
+^^^^^^^^^^^
+- Warn when meta is passed to ``apply`` (:pr:`10256`) `Patrick Hoefler`_
+- Remove ``imageio`` version restriction in CI (:pr:`10260`) `Patrick Hoefler`_
+- Remove unused ``DataFrame`` variance methods (:pr:`10252`) `Patrick Hoefler`_
+- Un-``xfail`` ``test_categories`` with ``pyarrow`` strings and ``pyarrow>=12`` (:pr:`10244`) `Irina Truong`_
+- Bump gpuCI ``PYTHON_VER`` 3.8->3.9 (:pr:`10233`) `Charles Blackmon-Luca`_
+
+
 .. _v2023.4.1:
 
 2023.4.1
 --------
 
 Released on April 28, 2023
```

### Comparing `dask-2023.4.1/docs/source/cli.rst` & `dask-2023.5.0/docs/source/cli.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/conf.py` & `dask-2023.5.0/docs/source/conf.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/configuration.rst` & `dask-2023.5.0/docs/source/configuration.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/custom-collections.rst` & `dask-2023.5.0/docs/source/custom-collections.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/custom-graphs.rst` & `dask-2023.5.0/docs/source/custom-graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dashboard-progress-script.py` & `dask-2023.5.0/docs/source/dashboard-progress-script.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dashboard.rst` & `dask-2023.5.0/docs/source/dashboard.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/daskcheatsheet.pdf` & `dask-2023.5.0/docs/source/daskcheatsheet.pdf`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dataframe-best-practices.rst` & `dask-2023.5.0/docs/source/dataframe-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dataframe-categoricals.rst` & `dask-2023.5.0/docs/source/dataframe-categoricals.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dataframe-create.rst` & `dask-2023.5.0/docs/source/dataframe-create.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dataframe-design.rst` & `dask-2023.5.0/docs/source/dataframe-design.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dataframe-extend.rst` & `dask-2023.5.0/docs/source/dataframe-extend.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dataframe-groupby.rst` & `dask-2023.5.0/docs/source/dataframe-groupby.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dataframe-indexing.rst` & `dask-2023.5.0/docs/source/dataframe-indexing.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dataframe-joins.rst` & `dask-2023.5.0/docs/source/dataframe-joins.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dataframe-parquet.rst` & `dask-2023.5.0/docs/source/dataframe-parquet.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dataframe-sql.rst` & `dask-2023.5.0/docs/source/dataframe-sql.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/dataframe.rst` & `dask-2023.5.0/docs/source/dataframe.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/delayed-api.rst` & `dask-2023.5.0/docs/source/delayed-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/delayed-best-practices.rst` & `dask-2023.5.0/docs/source/delayed-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/delayed-collections.rst` & `dask-2023.5.0/docs/source/delayed-collections.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/delayed.rst` & `dask-2023.5.0/docs/source/delayed.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/deploying-cli.rst` & `dask-2023.5.0/docs/source/deploying-cli.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/deploying-cloud.rst` & `dask-2023.5.0/docs/source/deploying-cloud.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/deploying-docker.rst` & `dask-2023.5.0/docs/source/deploying-docker.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/deploying-hpc.rst` & `dask-2023.5.0/docs/source/deploying-hpc.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/deploying-kubernetes.rst` & `dask-2023.5.0/docs/source/deploying-kubernetes.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/deploying-python-advanced.rst` & `dask-2023.5.0/docs/source/deploying-python-advanced.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/deploying-python.rst` & `dask-2023.5.0/docs/source/deploying-python.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/deploying-ssh.rst` & `dask-2023.5.0/docs/source/deploying-ssh.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/deploying.rst` & `dask-2023.5.0/docs/source/deploying.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/deployment-considerations.rst` & `dask-2023.5.0/docs/source/deployment-considerations.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/develop.rst` & `dask-2023.5.0/docs/source/develop.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/diagnostics-distributed.rst` & `dask-2023.5.0/docs/source/diagnostics-distributed.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/diagnostics-local.rst` & `dask-2023.5.0/docs/source/diagnostics-local.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/ecosystem.rst` & `dask-2023.5.0/docs/source/ecosystem.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/faq.rst` & `dask-2023.5.0/docs/source/faq.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/futures.rst` & `dask-2023.5.0/docs/source/futures.rst`

 * *Files 2% similar despite different names*

```diff
@@ -2,51 +2,37 @@
 =======
 
 .. meta::
     :description: Dask futures reimplements the Python futures API so you can scale your Python futures workflow across a Dask cluster.
 
 Dask supports a real-time task framework that extends Python's
 `concurrent.futures <https://docs.python.org/3/library/concurrent.futures.html>`_
-interface. Dask futures reimplements most of the Python futures API, allowing
-you to scale your Python futures workflow across a Dask cluster with minimal
-code changes. 
-
-.. figure:: images/concurrent-futures-threaded.webp
-    :alt: Conceptual diagram of Python futures threading executor
-    :align: center
-    :width: 75%
-
-    Using the Python futures ``ThreadPoolExecutor`` you can improve efficiency
-    by using multiple threads to have multiple requests at the same time.
-    Image from `Jim Anderson 2019 <https://realpython.com/python-concurrency/#threading-version>`_.
-
-This interface is good for arbitrary task scheduling like
-:doc:`dask.delayed <delayed>`, but is immediate rather than lazy, which
-provides some more flexibility in situations where the computations may evolve
-over time. These features depend on the second generation task scheduler found in
-`dask.distributed <https://distributed.dask.org/en/latest>`_ (which,
-despite its name, runs very well on a single machine).
-
-Though Dask futures is one of Dask's more powerful APIs, it is often not needed unless
-you have a particular use case for handling concurrency on the client. One of the higher-level
-Dask APIs, e.g. Dask Array or Dask Delayed, will suit most users' needs, without introducing
-the additional complexity that comes with concurrency.
+interface. Dask futures allow you to scale generic Python workflows across
+a Dask cluster with minimal code changes.
 
 .. raw:: html
 
    <iframe width="560"
            height="315"
            src="https://www.youtube.com/embed/07EiCpdhtDE"
            style="margin: 0 auto 20px auto; display: block;"
            frameborder="0"
            allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen></iframe>
 
 .. currentmodule:: distributed
 
+This interface is good for arbitrary task scheduling like
+:doc:`dask.delayed <delayed>`, but is immediate rather than lazy, which
+provides some more flexibility in situations where the computations may evolve
+over time. These features depend on the second generation task scheduler found in
+`dask.distributed <https://distributed.dask.org/en/latest>`_ (which,
+despite its name, runs very well on a single machine).
+
+
 Examples
 --------
 
 Visit https://examples.dask.org/futures.html to see and run examples
 using futures with Dask.
 
 Start Dask Client
@@ -868,15 +854,15 @@
        counter = await future  # gather actor object locally
 
        counter.increment()  # send off a request asynchronously
        await counter.increment()  # or wait until it was received
 
        n = await counter.n  # attribute access also must be awaited
 
-Generally, all I/O operations that trigger computations (e.g. ``to_parquet``) should be done using the ``compute=False`` 
+Generally, all I/O operations that trigger computations (e.g. ``to_parquet``) should be done using the ``compute=False``
 parameter to avoid asynchronous blocking:
 
 .. code-block:: python
 
    await client.compute(ddf.to_parquet('/tmp/some.parquet', compute=False))
 
 API
```

### Comparing `dask-2023.4.1/docs/source/gpu.rst` & `dask-2023.5.0/docs/source/gpu.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/graph_manipulation.rst` & `dask-2023.5.0/docs/source/graph_manipulation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/graphs.rst` & `dask-2023.5.0/docs/source/graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/graphviz.rst` & `dask-2023.5.0/docs/source/graphviz.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/high-level-graphs.rst` & `dask-2023.5.0/docs/source/high-level-graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/how-to/adaptive.rst` & `dask-2023.5.0/docs/source/how-to/adaptive.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/how-to/connect-to-remote-data.rst` & `dask-2023.5.0/docs/source/how-to/connect-to-remote-data.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/how-to/customize-initialization.rst` & `dask-2023.5.0/docs/source/how-to/customize-initialization.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/how-to/debug.rst` & `dask-2023.5.0/docs/source/how-to/debug.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/how-to/extend-sizeof.rst` & `dask-2023.5.0/docs/source/how-to/extend-sizeof.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/how-to/manage-environments.rst` & `dask-2023.5.0/docs/source/how-to/manage-environments.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/how-to/selecting-the-collection-backend.rst` & `dask-2023.5.0/docs/source/how-to/selecting-the-collection-backend.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/how-to/setup-prometheus.rst` & `dask-2023.5.0/docs/source/how-to/setup-prometheus.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/10_minutes_array_graph.png` & `dask-2023.5.0/docs/source/images/10_minutes_array_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/10_minutes_bag_graph.png` & `dask-2023.5.0/docs/source/images/10_minutes_bag_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/10_minutes_dataframe_graph.png` & `dask-2023.5.0/docs/source/images/10_minutes_dataframe_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/HHMI_Janelia_Color.png` & `dask-2023.5.0/docs/source/images/HHMI_Janelia_Color.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/array.svg` & `dask-2023.5.0/docs/source/images/array.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/async-embarrassing.gif` & `dask-2023.5.0/docs/source/images/async-embarrassing.gif`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/concurrent-futures-threaded.webp` & `dask-2023.5.0/docs/source/images/concurrent-futures-threaded.webp`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/crosstalk.svg` & `dask-2023.5.0/docs/source/images/crosstalk.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dashboard_jupyterlab.png` & `dask-2023.5.0/docs/source/images/dashboard_jupyterlab.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dashboard_link.png` & `dask-2023.5.0/docs/source/images/dashboard_link.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dashboard_memory.png` & `dask-2023.5.0/docs/source/images/dashboard_memory.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dashboard_memory_new.gif` & `dask-2023.5.0/docs/source/images/dashboard_memory_new.gif`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dashboard_progress.png` & `dask-2023.5.0/docs/source/images/dashboard_progress.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dashboard_status.png` & `dask-2023.5.0/docs/source/images/dashboard_status.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dashboard_task_processing.png` & `dask-2023.5.0/docs/source/images/dashboard_task_processing.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dashboard_task_stream_unhealthy.png` & `dask-2023.5.0/docs/source/images/dashboard_task_stream_unhealthy.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dashboard_taskstream_healthy.png` & `dask-2023.5.0/docs/source/images/dashboard_taskstream_healthy.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask-adaptive.svg` & `dask-2023.5.0/docs/source/images/dask-adaptive.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask-array.svg` & `dask-2023.5.0/docs/source/images/dask-array.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask-cluster-manager.svg` & `dask-2023.5.0/docs/source/images/dask-cluster-manager.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask-dataframe.svg` & `dask-2023.5.0/docs/source/images/dask-dataframe.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask-overview-distributed-callout.svg` & `dask-2023.5.0/docs/source/images/dask-overview-distributed-callout.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask-overview-schedulers.svg` & `dask-2023.5.0/docs/source/images/dask-overview-schedulers.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask-overview.svg` & `dask-2023.5.0/docs/source/images/dask-overview.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask_horizontal.svg` & `dask-2023.5.0/docs/source/images/dask_horizontal.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask_horizontal_black.svg` & `dask-2023.5.0/docs/source/images/dask_horizontal_black.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask_horizontal_on_blue.svg` & `dask-2023.5.0/docs/source/images/dask_horizontal_on_blue.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask_horizontal_on_pink.svg` & `dask-2023.5.0/docs/source/images/dask_horizontal_on_pink.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask_horizontal_white.svg` & `dask-2023.5.0/docs/source/images/dask_horizontal_white.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask_icon.svg` & `dask-2023.5.0/docs/source/images/dask_icon.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask_icon_black.svg` & `dask-2023.5.0/docs/source/images/dask_icon_black.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask_icon_on_pink.svg` & `dask-2023.5.0/docs/source/images/dask_icon_on_pink.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/dask_icon_white.svg` & `dask-2023.5.0/docs/source/images/dask_icon_white.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/delayed-inc-double-add.svg` & `dask-2023.5.0/docs/source/images/delayed-inc-double-add.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/distributed-overview.svg` & `dask-2023.5.0/docs/source/images/distributed-overview.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/frame-shuffle.svg` & `dask-2023.5.0/docs/source/images/frame-shuffle.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/frame-sort.svg` & `dask-2023.5.0/docs/source/images/frame-sort.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/frame.svg` & `dask-2023.5.0/docs/source/images/frame.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/gputester-msg.png` & `dask-2023.5.0/docs/source/images/gputester-msg.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/growth_of_languages.png` & `dask-2023.5.0/docs/source/images/growth_of_languages.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/growth_of_libraries.png` & `dask-2023.5.0/docs/source/images/growth_of_libraries.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/inc-add.svg` & `dask-2023.5.0/docs/source/images/inc-add.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/map-reduce-task-scheduling.svg` & `dask-2023.5.0/docs/source/images/map-reduce-task-scheduling.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/map_blocks_drop_axis.png` & `dask-2023.5.0/docs/source/images/map_blocks_drop_axis.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/merge_chunks.png` & `dask-2023.5.0/docs/source/images/merge_chunks.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/merge_chunks_false.png` & `dask-2023.5.0/docs/source/images/merge_chunks_false.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/optimize_dask1.svg` & `dask-2023.5.0/docs/source/images/optimize_dask1.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/optimize_dask2.svg` & `dask-2023.5.0/docs/source/images/optimize_dask2.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/optimize_dask3.svg` & `dask-2023.5.0/docs/source/images/optimize_dask3.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/optimize_dask4.svg` & `dask-2023.5.0/docs/source/images/optimize_dask4.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/optimize_dask5.svg` & `dask-2023.5.0/docs/source/images/optimize_dask5.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/order-failure.png` & `dask-2023.5.0/docs/source/images/order-failure.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/order-success.png` & `dask-2023.5.0/docs/source/images/order-success.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/overlap.svg` & `dask-2023.5.0/docs/source/images/overlap.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/overlapping-blocks.svg` & `dask-2023.5.0/docs/source/images/overlapping-blocks.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/overlapping-neighbors.svg` & `dask-2023.5.0/docs/source/images/overlapping-neighbors.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/pipeline.svg` & `dask-2023.5.0/docs/source/images/pipeline.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/reshape.png` & `dask-2023.5.0/docs/source/images/reshape.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/reshape_problem.png` & `dask-2023.5.0/docs/source/images/reshape_problem.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/reshape_rechunked.png` & `dask-2023.5.0/docs/source/images/reshape_rechunked.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/scaling-edges.png` & `dask-2023.5.0/docs/source/images/scaling-edges.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/scaling-nodes.png` & `dask-2023.5.0/docs/source/images/scaling-nodes.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/simple-dask.png` & `dask-2023.5.0/docs/source/images/simple-dask.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/transpose-hlg-hovertooltip.png` & `dask-2023.5.0/docs/source/images/transpose-hlg-hovertooltip.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/transpose-hlg-html-repr.png` & `dask-2023.5.0/docs/source/images/transpose-hlg-html-repr.png`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/transpose.svg` & `dask-2023.5.0/docs/source/images/transpose.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/transpose_opt.svg` & `dask-2023.5.0/docs/source/images/transpose_opt.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/trivial.svg` & `dask-2023.5.0/docs/source/images/trivial.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/images/unoverlapping-neighbors.svg` & `dask-2023.5.0/docs/source/images/unoverlapping-neighbors.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/index.rst` & `dask-2023.5.0/docs/source/index.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/install.rst` & `dask-2023.5.0/docs/source/install.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/logos.rst` & `dask-2023.5.0/docs/source/logos.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/maintainers.rst` & `dask-2023.5.0/docs/source/maintainers.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/optimize.rst` & `dask-2023.5.0/docs/source/optimize.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/order.rst` & `dask-2023.5.0/docs/source/order.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/phases-of-computation.rst` & `dask-2023.5.0/docs/source/phases-of-computation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/presentations.rst` & `dask-2023.5.0/docs/source/presentations.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/scheduler-overview.rst` & `dask-2023.5.0/docs/source/scheduler-overview.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/scheduling-policy.rst` & `dask-2023.5.0/docs/source/scheduling-policy.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/scheduling.rst` & `dask-2023.5.0/docs/source/scheduling.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/scripts/scheduling.py` & `dask-2023.5.0/docs/source/scripts/scheduling.py`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/shared.rst` & `dask-2023.5.0/docs/source/shared.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/spark.rst` & `dask-2023.5.0/docs/source/spark.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/spec.rst` & `dask-2023.5.0/docs/source/spec.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/support.rst` & `dask-2023.5.0/docs/source/support.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/understanding-performance.rst` & `dask-2023.5.0/docs/source/understanding-performance.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/user-interfaces.rst` & `dask-2023.5.0/docs/source/user-interfaces.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/docs/source/why.rst` & `dask-2023.5.0/docs/source/why.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.4.1/pyproject.toml` & `dask-2023.5.0/pyproject.toml`

 * *Files 0% similar despite different names*

```diff
@@ -52,15 +52,15 @@
 array = ["numpy >= 1.21"]
 # keeping for backwards compatibility
 bag = []
 dataframe = [
     "numpy >= 1.21",
     "pandas >= 1.3",
 ]
-distributed = ["distributed == 2023.4.1"]
+distributed = ["distributed == 2023.5.0"]
 diagnostics = [
     "bokeh >= 2.4.2",
     "jinja2 >= 2.10.3",
 ]
 # keeping for backwards compatibility
 delayed = []
 complete = [
```

