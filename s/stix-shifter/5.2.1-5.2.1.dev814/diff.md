# Comparing `tmp/stix_shifter-5.2.1-py2.py3-none-any.whl.zip` & `tmp/stix_shifter-5.2.1.dev814-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,18 +1,18 @@
-Zip file size: 27986 bytes, number of entries: 16
--rw-rw-r--  2.0 unx        0 b- defN 23-May-01 12:35 stix_shifter/__init__.py
--rw-rw-r--  2.0 unx        0 b- defN 23-May-01 12:35 stix_shifter/scripts/__init__.py
--rw-rw-r--  2.0 unx    18616 b- defN 23-May-01 12:35 stix_shifter/scripts/stix_shifter.py
--rw-rw-r--  2.0 unx    14038 b- defN 23-May-01 12:35 stix_shifter/scripts/supported_property_exporter.py
--rw-rw-r--  2.0 unx        0 b- defN 23-May-01 12:35 stix_shifter/stix_translation/__init__.py
--rw-rw-r--  2.0 unx    21897 b- defN 23-May-01 12:37 stix_shifter/stix_translation/json_to_stix_translator.py
--rw-rw-r--  2.0 unx     8319 b- defN 23-May-01 12:35 stix_shifter/stix_translation/stix_translation.py
--rw-rw-r--  2.0 unx        0 b- defN 23-May-01 12:35 stix_shifter/stix_transmission/__init__.py
--rw-rw-r--  2.0 unx     4462 b- defN 23-May-01 12:35 stix_shifter/stix_transmission/stix_transmission.py
--rw-rw-r--  2.0 unx    12786 b- defN 23-May-01 12:37 stix_shifter-5.2.1.dist-info/LICENSE.md
--rw-rw-r--  2.0 unx     8770 b- defN 23-May-01 12:37 stix_shifter-5.2.1.dist-info/METADATA
--rw-rw-r--  2.0 unx     1418 b- defN 23-May-01 12:37 stix_shifter-5.2.1.dist-info/NOTICE
--rw-rw-r--  2.0 unx      110 b- defN 23-May-01 12:37 stix_shifter-5.2.1.dist-info/WHEEL
--rw-rw-r--  2.0 unx       72 b- defN 23-May-01 12:37 stix_shifter-5.2.1.dist-info/entry_points.txt
--rw-rw-r--  2.0 unx       13 b- defN 23-May-01 12:37 stix_shifter-5.2.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1494 b- defN 23-May-01 12:37 stix_shifter-5.2.1.dist-info/RECORD
-16 files, 91995 bytes uncompressed, 25450 bytes compressed:  72.3%
+Zip file size: 27471 bytes, number of entries: 16
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-12 13:56 stix_shifter/__init__.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-12 13:56 stix_shifter/scripts/__init__.py
+-rw-rw-r--  2.0 unx    17105 b- defN 23-May-12 13:56 stix_shifter/scripts/stix_shifter.py
+-rw-rw-r--  2.0 unx    13819 b- defN 23-May-12 13:56 stix_shifter/scripts/supported_property_exporter.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-12 13:56 stix_shifter/stix_translation/__init__.py
+-rw-rw-r--  2.0 unx    21567 b- defN 23-May-12 13:59 stix_shifter/stix_translation/json_to_stix_translator.py
+-rw-rw-r--  2.0 unx     8132 b- defN 23-May-12 13:56 stix_shifter/stix_translation/stix_translation.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-May-12 13:56 stix_shifter/stix_transmission/__init__.py
+-rw-rw-r--  2.0 unx     4462 b- defN 23-May-12 13:56 stix_shifter/stix_transmission/stix_transmission.py
+-rw-rw-r--  2.0 unx    12786 b- defN 23-May-12 13:59 stix_shifter-5.2.1.dev814.dist-info/LICENSE.md
+-rw-rw-r--  2.0 unx     7816 b- defN 23-May-12 13:59 stix_shifter-5.2.1.dev814.dist-info/METADATA
+-rw-rw-r--  2.0 unx     1418 b- defN 23-May-12 13:59 stix_shifter-5.2.1.dev814.dist-info/NOTICE
+-rw-rw-r--  2.0 unx      110 b- defN 23-May-12 13:59 stix_shifter-5.2.1.dev814.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       72 b- defN 23-May-12 13:59 stix_shifter-5.2.1.dev814.dist-info/entry_points.txt
+-rw-rw-r--  2.0 unx       13 b- defN 23-May-12 13:59 stix_shifter-5.2.1.dev814.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     1543 b- defN 23-May-12 13:59 stix_shifter-5.2.1.dev814.dist-info/RECORD
+16 files, 88843 bytes uncompressed, 24837 bytes compressed:  72.0%
```

## zipnote {}

```diff
@@ -21,29 +21,29 @@
 
 Filename: stix_shifter/stix_transmission/__init__.py
 Comment: 
 
 Filename: stix_shifter/stix_transmission/stix_transmission.py
 Comment: 
 
-Filename: stix_shifter-5.2.1.dist-info/LICENSE.md
+Filename: stix_shifter-5.2.1.dev814.dist-info/LICENSE.md
 Comment: 
 
-Filename: stix_shifter-5.2.1.dist-info/METADATA
+Filename: stix_shifter-5.2.1.dev814.dist-info/METADATA
 Comment: 
 
-Filename: stix_shifter-5.2.1.dist-info/NOTICE
+Filename: stix_shifter-5.2.1.dev814.dist-info/NOTICE
 Comment: 
 
-Filename: stix_shifter-5.2.1.dist-info/WHEEL
+Filename: stix_shifter-5.2.1.dev814.dist-info/WHEEL
 Comment: 
 
-Filename: stix_shifter-5.2.1.dist-info/entry_points.txt
+Filename: stix_shifter-5.2.1.dev814.dist-info/entry_points.txt
 Comment: 
 
-Filename: stix_shifter-5.2.1.dist-info/top_level.txt
+Filename: stix_shifter-5.2.1.dev814.dist-info/top_level.txt
 Comment: 
 
-Filename: stix_shifter-5.2.1.dist-info/RECORD
+Filename: stix_shifter-5.2.1.dev814.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## stix_shifter/scripts/stix_shifter.py

```diff
@@ -15,15 +15,14 @@
 
 TRANSLATE = 'translate'
 TRANSMIT = 'transmit'
 EXECUTE = 'execute'
 HOST = 'host'
 MAPPING = 'mapping'
 MODULES = 'modules'
-CONFIGS = 'configs'
 
 
 def main():
     """
     Stix-shifter can either be called to either translate or transmit.
     In the case of translation, stix-shifter either translates a stix pattern to a datasource query,
     or converts data source query results into JSON of STIX observations.
@@ -70,21 +69,16 @@
         'data', type=str, help='The STIX pattern or JSON results to be translated')
     translate_parser.add_argument('options', nargs='?', help='Options dictionary')
     translate_parser.add_argument('recursion_limit', type=int, nargs='?', help='Maximum depth of Python interpreter stack')
 
     # optional arguments
     translate_parser.add_argument('-x', '--stix-validator', action='store_true',
                                   help='Run the STIX 2 validator against the translated results')
-    # configs parser
-    configs_parser = parent_subparsers.add_parser(CONFIGS, help='Get configs list')
-    configs_parser.add_argument('module', nargs='?', type=str, help='Module name')
-
     # modules parser
-    modules_parser = parent_subparsers.add_parser(MODULES, help='Get configs list')
-    modules_parser.add_argument('module', nargs='?', type=str, help='Module name')
+    parent_subparsers.add_parser(MODULES, help='Get modules list')
 
     # mapping parser
     mapping_parser = parent_subparsers.add_parser(
         MAPPING, help='Get module mapping')
     # positional arguments
     mapping_parser.add_argument('module', help='The translation module to use')
 
@@ -107,38 +101,29 @@
         type=str,
         help='Data source authentication'
     )
 
     # operation subparser
     operation_subparser = transmit_parser.add_subparsers(title="operation", dest="operation_command")
     operation_subparser.add_parser(stix_transmission.PING, help="Pings the data source")
-    
     query_operation_parser = operation_subparser.add_parser(stix_transmission.QUERY, help="Executes a query on the data source")
     query_operation_parser.add_argument('query_string', help='native datasource query string')
-    
     results_operation_parser = operation_subparser.add_parser(stix_transmission.RESULTS, help="Fetches the results of the data source query")
     results_operation_parser.add_argument('search_id', help='uuid of executed query')
     results_operation_parser.add_argument('offset', help='offset of results')
     results_operation_parser.add_argument('length', help='length of results')
-    results_operation_parser.add_argument('metadata', nargs='?', help='metadata to fetch results')
-    
     resultsstix_operation_parser = operation_subparser.add_parser(stix_transmission.RESULTS_STIX, help="Fetches the results of the data source query, response is translated in STIX")
     resultsstix_operation_parser.add_argument('search_id', help='uuid of executed query')
     resultsstix_operation_parser.add_argument('offset', help='offset of results')
     resultsstix_operation_parser.add_argument('length', help='length of results')
     resultsstix_operation_parser.add_argument('data_source', help='STIX identity object representing a datasource')
-    resultsstix_operation_parser.add_argument('metadata', nargs='?', help='metadata to fetch results')
-
     status_operation_parser = operation_subparser.add_parser(stix_transmission.STATUS, help="Gets the current status of the query")
     status_operation_parser.add_argument('search_id', help='uuid of executed query')
-    status_operation_parser.add_argument('metadata', nargs='?', help='metadata to fetch results')
-
     delete_operation_parser = operation_subparser.add_parser(stix_transmission.DELETE, help="Delete a running query on the data source")
     delete_operation_parser.add_argument('search_id', help='id of query to remove')
-    
     operation_subparser.add_parser(stix_transmission.IS_ASYNC, help='Checks if the query operation is asynchronous')
 
     execute_parser = parent_subparsers.add_parser(EXECUTE, help='Translate and fully execute a query')
     # positional arguments
     execute_parser.add_argument(
         'transmission_module',
         help='Which connection module to use'
@@ -200,34 +185,31 @@
         utils_logger.init(logging.DEBUG)
     else:
         utils_logger.init(logging.INFO)
 
     log = utils_logger.set_logger(__name__)
 
 
-    if hasattr(args, 'data') and args.data:
-        if args.command in [TRANSLATE] and args.translate_type == 'query':
-            pass
-        else:
-            try:
-                args.data = json.loads(args.data)
-            except Exception as ex:
-                log.debug(exception_to_string(ex))
-                log.error('Cannot convert supplied data json string to json')
-                help_and_exit = True
+    if args.command not in [TRANSLATE] and hasattr(args, 'data') and args.data:
+        try:
+            args.data = json.loads(args.data)
+        except Exception as ex:
+            log.debug(exception_to_string(ex))
+            log.error('Cannot convert supplied data json string to json')
+            help_and_exit = True
 
     if hasattr(args, 'data_source') and args.data_source:
         try:
             args.data_source = json.loads(args.data_source)
         except Exception as ex:
             log.debug(exception_to_string(ex))
             log.error('Cannot convert supplied data_source json string to json')
             help_and_exit = True
 
-    if 'module' in args and args.module:
+    if 'module' in args:
         args_module_dialects = args.module
 
         options = {}
         if 'options' in args and args.options:
             options = json.loads(args.options)
 
         module = process_dialects(args_module_dialects, options)[0]
@@ -359,23 +341,15 @@
         translation = stix_translation.StixTranslation()
         result = translation.translate(args.module, stix_translation.MAPPING, None, None, options=options)
     elif args.command == MODULES:
         translation = stix_translation.StixTranslation()
         result = {}
         all_modules = modules_list()
         for m in all_modules:
-            if not args.module or args.module == m:
-                result[m] = translation.translate(m, stix_translation.DIALECTS, None, None)
-    elif args.command == CONFIGS:
-        translation = stix_translation.StixTranslation()
-        result = {}
-        all_modules = modules_list()
-        for m in all_modules:
-            if not args.module or args.module == m:
-                result[m] = translation.translate(m, stix_translation.CONFIGS, None, None)
+            result[m] = translation.translate(m, stix_translation.DIALECTS, None, None)
     elif args.command == TRANSMIT:
         result = transmit(args)  # stix_transmission
 
     print(json.dumps(result, indent=4, sort_keys=False))
     exit(0)
 
 
@@ -389,46 +363,37 @@
         status <search id>,
         results <search id> <offset> <length>,
         results_stix <search id> <offset> <length> <data_source>
         ping,
         is_async
     >
     """
-    log = utils_logger.set_logger(__name__)
     connection_dict = json.loads(args.connection)
     configuration_dict = json.loads(args.configuration)
     transmission = stix_transmission.StixTransmission(args.module, connection_dict, configuration_dict)
 
     operation_command = args.operation_command
-    if 'metadata' in args and args.metadata:
-        metadata = args.metadata
-        try:
-            metadata = json.loads(metadata)
-        except Exception as ex:
-            log.debug(exception_to_string(ex))
-            log.error('Cannot convert supplied metadata string to json')
-            pass
 
     if operation_command == stix_transmission.QUERY:
         query = args.query_string
         result = transmission.query(query)
     elif operation_command == stix_transmission.STATUS:
         search_id = args.search_id
-        result = transmission.status(search_id, metadata=None)
+        result = transmission.status(search_id)
     elif operation_command == stix_transmission.RESULTS:
         search_id = args.search_id
         offset = args.offset
         length = args.length
-        result = transmission.results(search_id, offset, length, metadata=None)
+        result = transmission.results(search_id, offset, length)
     elif operation_command == stix_transmission.RESULTS_STIX:
         search_id = args.search_id
         offset = args.offset
         length = args.length
         data_source = args.data_source
-        result = transmission.results_stix(search_id, offset, length, data_source, metadata=None)
+        result = transmission.results_stix(search_id, offset, length, data_source)
     elif operation_command == stix_transmission.DELETE:
         search_id = args.search_id
         result = transmission.delete(search_id)
     elif operation_command == stix_transmission.PING:
         result = transmission.ping()
     elif operation_command == stix_transmission.IS_ASYNC:
         result = transmission.is_async()
```

## stix_shifter/scripts/supported_property_exporter.py

```diff
@@ -1,15 +1,15 @@
 import json
 from os import path
 import re
 from datetime import datetime
 
 current_dir = path.abspath(path.dirname(__file__))
 
-CONNECTOR_MODULE_PATH = path.abspath(path.join(current_dir, "../../stix_shifter_modules"))
+TRANSLATION_MODULE_PATH = path.abspath(path.join(current_dir, "../../stix_shifter_modules"))
 ADAPTER_GUIDE_PATH = path.abspath(path.join(current_dir, '../../adapter-guide'))
 
 # Add new connectors to this dictionary as they become available. The key must match the name of the translation module.
 CONNECTORS = {
     "qradar": "IBM QRadar", 
     "splunk": "Splunk Enterprise Security", 
     "bigfix": "HCL BigFix", 
@@ -36,34 +36,32 @@
     "paloalto": "PaloAlto Cortex XDR",
     "sentinelone": "SentinelOne",
     "reaqta": "IBM Security ReaQta",
     "darktrace": "Darktrace",
     "rhacs": "Red Hat Advanced Cluster Security for Kubernetes (StackRox)",
     "ibm_security_verify": "IBM Security Verify",
     "gcp_chronicle": "GCP Chronicle",
-    "azure_log_analytics": "Azure Log Analytics",
-    "okta": "Okta"
+    "azure_log_analytics": "Azure Log Analytics"
 }
 
-DEFAULT_DIALECT = "default"
-
 DIALECTS = {
     "qradar": ["events", "flows"],
     "aws_athena": ["guardduty", "ocsf", "vpcflow"],
     "aws_cloud_watch_logs": ["guardduty", "vpcflow"],
     "datadog": ["events", "processes"],
     "guardium": ["qsearch", "report"],
     "infoblox": ["dnsEventData", "dossierData", "tideDbData"],
     "paloalto": ["xdr_data"],
     "secretserver": ["event"],
     "trendmicro_vision_one": ["endpointActivityData", "messageActivityData"],
-    "azure_log_analytics": ["SecurityAlert", "SecurityEvent", "SecurityIncident"],
-    "elastic_ecs": [DEFAULT_DIALECT, "beats"]
+    "azure_log_analytics": ["SecurityAlert", "SecurityEvent", "SecurityIncident"]
 }
 
+DEFAULT_DIALECT = "default"
+
 STIX_OPERATORS = {
     "ComparisonExpressionOperators.And": "AND (Comparision)",
     "ComparisonExpressionOperators.Or": "OR (Comparision)",
     "ComparisonComparators.GreaterThan": ">",
     "ComparisonComparators.GreaterThanOrEqual": ">=",
     "ComparisonComparators.LessThan": "<",
     "ComparisonComparators.LessThanOrEqual": "<=",
@@ -81,62 +79,62 @@
 }
 
 now = datetime.now()
 UPDATED_AT = now.strftime("%D")
 
 def __main__():
 
-    table_of_contents = "# Currently supported STIX objects and properties\n\n"
+    table_of_contents = "# Currently supported STIX objects and properties\n"
     table_of_contents += "Each connector supports a set of STIX objects and properties as defined in the connector's mapping files. There is also a set of common STIX properties that all cyber observable objects must contain. See [STIXâ„¢ Version 2.0. Part 4: Cyber Observable Objects](http://docs.oasis-open.org/cti/stix/v2.0/stix-v2.0-part4-cyber-observable-objects.html) for more information on STIX objects.\n"
-    table_of_contents += "## Common cyber observable properties\n\n"
+    table_of_contents += "## Common cyber observable properties\n"
     table_of_contents += "- created\n"
     table_of_contents += "- modified\n"
     table_of_contents += "- first_observed\n"
     table_of_contents += "- last_observed\n"
     table_of_contents += "- number_observed\n\n"
-    table_of_contents += "## Supported data sources\n\n"
+    table_of_contents += "## Supported data sources\n"
     table_of_contents += "Stix-shifter currently offers connector support for the following cybersecurity products. Click on a data source to see a list of STIX attributes and properties it supports.\n\n"
 
     table_of_contents_file_path = path.abspath(path.join(ADAPTER_GUIDE_PATH, "supported-mappings.md"))
     table_of_contents_file = open(table_of_contents_file_path, "w")
 
     for index, (key, module) in enumerate(CONNECTORS.items()):
         try:
-            filepath = path.abspath(path.join(CONNECTOR_MODULE_PATH, key, "stix_translation/json", "to_stix_map.json"))    
+            filepath = path.abspath(path.join(TRANSLATION_MODULE_PATH, key, "stix_translation/json", "to_stix_map.json"))    
             to_stix_json_file = open(filepath)
             loaded_to_stix_json = json.loads(to_stix_json_file.read())
             
 
         except(Exception):
             print("Error for {} module".format(key))
             continue
 
         data_field_alias_mapping = []
         if key == 'qradar':
             try:
-                fields_filepath = path.abspath(path.join(CONNECTOR_MODULE_PATH, key, "stix_translation/json", "aql_events_fields.json"))    
+                fields_filepath = path.abspath(path.join(TRANSLATION_MODULE_PATH, key, "stix_translation/json", "aql_events_fields.json"))    
                 fields_json_file = open(fields_filepath)
                 loaded_fields_json = json.loads(fields_json_file.read())
                 data_field_alias_mapping = loaded_fields_json.get('default') # array of fields
                 fields_json_file.close()
             except(Exception):
                 print("Error for {} module".format(key))
                 continue
 
         stix_attribute_collection = _parse_attributes(loaded_to_stix_json, key, {})
         
         output_string = ""
         output_string += "##### Updated on " + UPDATED_AT + "\n"
         output_string += "## " + module + "\n"
-        table_of_contents += "- [{}]({})\n".format(module, "../stix_shifter_modules/{}/{}_supported_stix.md".format(key, key))
+        table_of_contents += "- [{}]({})\n".format(module, "connectors/{}_supported_stix.md".format(key))
 
 
         # OPERATORS
         try:
-            filepath = path.abspath(path.join(CONNECTOR_MODULE_PATH, key, "stix_translation/json", "operators.json")) 
+            filepath = path.abspath(path.join(TRANSLATION_MODULE_PATH, key, "stix_translation/json", "operators.json")) 
             operators_json_file = open(filepath)   
             loaded_operators_json = json.loads(operators_json_file.read())
             stix_operator_collection = _parse_operators(loaded_operators_json, {})
             output_string += "### Supported STIX Operators\n"
             output_string += "*Comparison AND/OR operators are inside the observation while observation AND/OR operators are between observations (square brackets).*\n\n"
             output_string += "| STIX Operator | Data Source Operator |\n"
             output_string += "|--|--|\n"
@@ -154,18 +152,18 @@
             dialects = [DEFAULT_DIALECT]
             if key in DIALECTS:
                 dialects = DIALECTS[key]
             for dialect in dialects:
                 if dialect == DEFAULT_DIALECT:
                     dialect = ""
                     output_string += "### Searchable STIX objects and properties\n"
-                    filepath = path.abspath(path.join(CONNECTOR_MODULE_PATH, key, "stix_translation/json", "from_stix_map.json"))    
+                    filepath = path.abspath(path.join(TRANSLATION_MODULE_PATH, key, "stix_translation/json", "from_stix_map.json"))    
                 else:
-                    output_string += "### Searchable STIX objects and properties for {} dialect\n".format(dialect.capitalize())
-                    filepath = path.abspath(path.join(CONNECTOR_MODULE_PATH, key, "stix_translation/json", "{}from_stix_map.json".format(dialect + "_")))    
+                    output_string += "### Searchable STIX objects and properties for {}\n".format(dialect.capitalize())
+                    filepath = path.abspath(path.join(TRANSLATION_MODULE_PATH, key, "stix_translation/json", "{}from_stix_map.json".format(dialect + "_")))    
                 from_stix_json_file = open(filepath)
                 loaded_from_stix_json = json.loads(from_stix_json_file.read())
                 # sorted_from_stix_objects = json.dumps(loaded_from_stix_json, sort_keys=True)
                 # sorted_attribute_objects = json.loads(sorted_attribute_objects)
                 if key == 'cybereason':
                     output_string += "*The Cybereason connector can only join specific linked fields with the AND operator as defined in its [configmap](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/stix_shifter_modules/aws_athena/stix_translation/json/operators.json).*\n\n"
                 output_string += "| STIX Object and Property | Mapped Data Source Fields |\n"
@@ -193,16 +191,15 @@
         except Exception as e:
             print("Error constructing from-STIX mapping table for {} module: {}".format(key, e))
             continue
 
         
         # TO-STIX 
         try:
-            # supported_stix_file_path = path.abspath(path.join(ADAPTER_GUIDE_PATH, "connectors", "{}_supported_stix.md".format(key)))
-            supported_stix_file_path = path.abspath(path.join(CONNECTOR_MODULE_PATH, key, "{}_supported_stix.md".format(key)))
+            supported_stix_file_path = path.abspath(path.join(ADAPTER_GUIDE_PATH, "connectors", "{}_supported_stix.md".format(key)))
             supported_stix_file = open(supported_stix_file_path, "w")   
             sorted_attribute_objects = json.dumps(stix_attribute_collection, sort_keys=True)
             sorted_attribute_objects = json.loads(sorted_attribute_objects)
             output_string += "### Supported STIX Objects and Properties for Query Results\n"
             output_string += "| STIX Object | STIX Property | Data Source Field |\n"
             output_string += "|--|--|--|\n"
             for stix_object, property_list in sorted_attribute_objects.items():
```

## stix_shifter/stix_translation/json_to_stix_translator.py

```diff
@@ -15,49 +15,41 @@
 NUMBER_OBSERVED_KEY = 'number_observed'
 FIRST_OBSERVED_KEY = 'first_observed'
 LAST_OBSERVED_KEY = 'last_observed'
 
 
 # convert JSON data to STIX object using map_data and transformers
 def convert_to_stix(data_source, map_data, data, transformers, options, callback=None):
-    try:
-        ds2stix = DataSourceObjToStixObj(data_source, map_data, transformers, options, callback)
 
-        # map data list to list of transformed objects
-        observation = ds2stix.transform
-        results = list(map(observation, data))
-
-        for stix_object in results:
-            if ds2stix.spec_version == "2.1":
-                del stix_object["objects"]
-            ds2stix.bundle["objects"].append(stix_object)
-
-        for _, value in ds2stix.unique_cybox_objects.items():
-            ds2stix.bundle["objects"].append(value)
-
-        if options.get('stix_validator'):
-            if ds2stix.spec_version == "2.1":
-                # Serialize and Deserialize bundle to covert StixObjectIds to strings
-                bundle_obj = json.dumps(ds2stix.bundle, sort_keys=False)
-                bundle_obj = json.loads(bundle_obj)
-            else:
-                bundle_obj = ds2stix.bundle
-            validated_result = validate_instance(bundle_obj, ValidationOptions(version=ds2stix.spec_version))
-            print_results(validated_result)
-
-        return ds2stix.bundle
-
-    except Exception as e:
-        try:
-            # try to print the error line
-            logger_log = logger.set_logger(__name__)
-            logger_log.error(logger.last_tb_to_string(e))
-        except:
-            pass
-        raise e
+    ds2stix = DataSourceObjToStixObj(data_source, map_data, transformers, options, callback)
+
+    # map data list to list of transformed objects
+    observation = ds2stix.transform
+    results = list(map(observation, data))
+
+    for stix_object in results:
+        if ds2stix.spec_version == "2.1":
+            del stix_object["objects"]
+        ds2stix.bundle["objects"].append(stix_object)
+
+    for _, value in ds2stix.unique_cybox_objects.items():
+        ds2stix.bundle["objects"].append(value)
+
+    if options.get('stix_validator'):
+        if ds2stix.spec_version == "2.1":
+            # Serialize and Deserialize bundle to covert StixObjectIds to strings
+            bundle_obj = json.dumps(ds2stix.bundle, sort_keys=False)
+            bundle_obj = json.loads(bundle_obj)
+        else:
+            bundle_obj = ds2stix.bundle
+        validated_result = validate_instance(bundle_obj, ValidationOptions(version=ds2stix.spec_version))
+        print_results(validated_result)
+
+    return ds2stix.bundle
+
 
 class DataSourceObjToStixObj:
     logger = logger.set_logger(__name__)
 
     def __init__(self, data_source, ds_to_stix_map, transformers, options, callback=None):
         self.identity_id = data_source["id"]
         self.ds_to_stix_map = ds_to_stix_map
```

## stix_shifter/stix_translation/stix_translation.py

```diff
@@ -11,15 +11,14 @@
 from stix_shifter_utils.utils import logger
 from stix_shifter_utils.utils.logger import exception_to_string
 
 RESULTS = 'results'
 QUERY = 'query'
 PARSE = 'parse'
 MAPPING = 'mapping'
-CONFIGS = 'configs'
 DIALECTS = 'dialects'
 SUPPORTED_ATTRIBUTES = "supported_attributes"
 MAPPING_ERROR = "Unable to map the following STIX objects and properties:"
 OPERATOR_MAPPING_ERROR = "Unable to map the following STIX Operators:"
 ATTRIBUTE_MAPPING_ERROR = "Unable to map the following STIX objects and properties:"
 DEFAULT_DIALECT = 'default'
 
@@ -39,29 +38,25 @@
         code = None
         try:
             try:
                 connector_module = importlib.import_module("stix_shifter_modules." + module + ".entry_point")
             except Exception as ex:
                 raise UnsupportedDataSourceException("{} is an unsupported data source.".format(module))
             try:
-                if not translate_type == CONFIGS and not translate_type == DIALECTS:
+                if not translate_type == DIALECTS:
                     validated_options = param_validator(module, options, 'connection.options')
                 else:
                     validated_options = {}
                 entry_point = connector_module.EntryPoint(options=validated_options)
             except Exception as ex:
                 track = traceback.format_exc()
                 self.logger.error(ex)
                 self.logger.debug(track)
                 raise
 
-            if translate_type == CONFIGS:
-                dialects = entry_point.get_configs_full()
-                return dialects
-
             if translate_type == DIALECTS:
                 dialects = entry_point.get_dialects_full()
                 return dialects
 
             if len(dialects) == 0:
                 dialects = entry_point.get_dialects()
                 language = validated_options['language']
```

## Comparing `stix_shifter-5.2.1.dist-info/LICENSE.md` & `stix_shifter-5.2.1.dev814.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `stix_shifter-5.2.1.dist-info/METADATA` & `stix_shifter-5.2.1.dev814.dist-info/METADATA`

 * *Files 7% similar despite different names*

```diff
@@ -1,79 +1,86 @@
 Metadata-Version: 2.1
 Name: stix-shifter
-Version: 5.2.1
+Version: 5.2.1.dev814
 Summary: Tools and interface to translate STIX formatted results and queries to different data source formats and to set up appropriate connection strings for invoking and triggering actions in openwhisk
 Home-page: https://github.com/opencybersecurityalliance/stix-shifter
 Author: ibm
 Author-email: 
 Project-URL: Source, https://github.com/opencybersecurityalliance/stix-shifter
 Keywords: datasource stix translate transform transmit
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Description-Content-Type: text/markdown
 License-File: LICENSE.md
 License-File: NOTICE
-Requires-Dist: requests-toolbelt (==0.10.1)
-Requires-Dist: aiohttp-retry (==2.8.3)
-Requires-Dist: pyOpenSSL (==23.1.1)
-Requires-Dist: python-dateutil (==2.8.2)
-Requires-Dist: stix2-patterns (==1.3.2)
-Requires-Dist: aiomysql (==0.1.1)
+Requires-Dist: aiomysql (==0.0.21)
+Requires-Dist: antlr4-python3-runtime (==4.8)
+Requires-Dist: urllib3 (==1.26.15)
+Requires-Dist: aioboto3 (==10.4.0)
 Requires-Dist: jsonmerge (==1.9.0)
-Requires-Dist: stix2-matcher (==3.0.0)
-Requires-Dist: colorlog (==6.7.0)
+Requires-Dist: stix2-patterns (==1.3.2)
+Requires-Dist: requests-toolbelt (==0.10.1)
 Requires-Dist: asynctest (==0.13.0)
+Requires-Dist: json-fix (==0.5.1)
 Requires-Dist: asyncio (==3.4.3)
-Requires-Dist: antlr4-python3-runtime (==4.8)
-Requires-Dist: json-fix (==0.5.2)
-Requires-Dist: urllib3 (==1.26.15)
-Requires-Dist: flask (==2.3.1)
-Requires-Dist: azure-identity (==1.12.0)
+Requires-Dist: adal (==1.2.7)
+Requires-Dist: stix2-matcher (==3.0.0)
+Requires-Dist: xmltodict (==0.13.0)
 Requires-Dist: flatten-json (==0.1.13)
-Requires-Dist: aioboto3 (==11.1.0)
+Requires-Dist: pyOpenSSL (==23.0.0)
 Requires-Dist: stix2-validator (==3.1.3)
-Requires-Dist: xmltodict (==0.13.0)
+Requires-Dist: python-dateutil (==2.8.2)
+Requires-Dist: colorlog (==6.7.0)
+Requires-Dist: aiohttp-retry (==2.4.0)
+Requires-Dist: flask (==2.2.3)
 
-[![example workflow](https://github.com/opencybersecurityalliance/stix-shifter/actions/workflows/main.yml/badge.svg)](https://github.com/opencybersecurityalliance/stix-shifter/actions)
 [![codecov](https://codecov.io/gh/opencybersecurityalliance/stix-shifter/branch/develop/graph/badge.svg?token=gQvl14peRj)](https://codecov.io/gh/opencybersecurityalliance/stix-shifter)
 
-# Introduction to STIX-Shifter
+### Join us on Slack!
+
+[Click here](https://docs.google.com/forms/d/1vEAqg9SKBF3UMtmbJJ9qqLarrXN5zeVG3_obedA3DKs) and fill out the form to receive an invite to the Open Cybersecurity Alliance slack instance, then join the #stix-shifter channel, to meet and discuss usage with the team.
+
+### Introduction Webinar!
+
+[Click here](https://ibm.biz/BdzTyA) to view an introduction webinar on STIX Shifter and the use cases it solves for.
+
+### Introduction
 
 STIX-shifter is an open source python library allowing software to connect to products that house data repositories by using STIX Patterning, and return results as STIX Observations.
 
-This library takes in STIX 2 Patterns as input, and "finds" data that matches the patterns inside various products that house repositories of cybersecurity data. Examples of such products include SIEM systems, endpoint management systems, threat intelligence platforms, orchestration platforms, network control points, data lakes, and more.
+For more information about this project, see the [STIX-shifter Overview](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/OVERVIEW.md)
 
-In addition to "finding" the data by using these patterns, STIX-Shifter also _transforms the output_ into STIX 2 Observations. Why would we do that you ask? To put it simply - so that all of the security data, regardless of the source, mostly looks and behaves the same.
+### Dependencies
 
-[## Project Overview and CLI Commands](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/OVERVIEW.md)
+This stix-shifter has the following dependencies:
 
-For general information about STIX, this project, and the command line utilities, see the [STIX-shifter Overview](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/OVERVIEW.md)
+- [stix2-patterns==1.3.0](https://pypi.org/project/stix2-patterns/)
+- [stix2-validator==1.1.2](https://pypi.org/project/stix2-validator/)
+- [stix2-matcher==1.0.0](https://pypi.org/project/stix2-matcher/)
+- [antlr4-python3-runtime==4.8](https://pypi.org/project/antlr4-python3-runtime/)
+- [python-dateutil==2.8.1](https://pypi.org/project/python-dateutil/)
 
+Your development environment must use Python version: 3.8 greater
 
-# Installation
+## Installation
 
-The recommended method for installing stix-shifter is via pip. Two prerequisite packages needs to be installed inlcuding the package of stix-shifter connector module to complete a stix-shifter connector installation. Run the below commands to install all the packages:
+The recommended method for installing the STIX-shifter is via pip. Two prerequisite packages needs to be installed inlcuding the package of stix-shifter connector module to complete a stix-shifter connector installation. Run below commands to install all the packages-
 
 1. Main stix-shifter package:  `pip install stix-shifter`
 
 2. Stix-shifter Utility package:  `pip install stix-shifter-utils`
 
 3. Desired stix-shifter connector module package:  `pip install stix-shifter-modules-<module name> `
    Example:  `pip install stix-shifter-modules-qradar`
 
-## Dependencies
+## Usage
 
-STIX-shifter requries Python 3.8 or greater. See the [requirements file](stix_shifter/requirements.txt) for library dependencies. 
 
-# Usage
-
-STIX-Shifter can use used the following ways:
-
-## 1. As a command line utility
+### As A Command Line Utility
 
 The STIX-Shifter comes with a bundled script which you can use to translate STIX Pattern to a native datasource query. It can also be used to translate a JSON data source query result to a STIX bundle of observable objects. You can also send query to a datasource by using a transmission option. 
 
 More details of the command line option can be found [here](https://github.com/opencybersecurityalliance/stix-shifter/blob/master/OVERVIEW.md#how-to-use)
 
 ```
 $ stix-shifter translate <MODULE NAME> query "<STIX IDENTITY OBJECT>" "<STIX PATTERN>" "<OPTIONS>"
@@ -86,17 +93,17 @@
 In order to build `stix-shifter` packages from source follow the below prerequisite steps:
    1. Go to the stix-shifter parent directory
    2. Optionally, you can create a Python 3 virtual environemnt:
        `virtualenv -p python3 virtualenv && source virtualenv/bin/activate`
    3. Run setup: `python3 setup.py install`
 
 
-## 2. Running from the source
+### Running From the Source
 
-You may also use the `python3 main.py` script. All the options are the same as the command line utility described above.
+You may also use `python3 main.py` script. All the options are the same as "As a command line utility" usage above.
 
 Example:
 
 ```
 python3 main.py translate qradar query {} "[ipv4-addr:value = '127.0.0.1']" {}
 ```
 
@@ -104,15 +111,15 @@
    1. Go to the stix-shifter parent directory
    2. Optionally, you can create a Python 3 virtual environemnt:
        `virtualenv -p python3 virtualenv && source virtualenv/bin/activate`
    3. Run setup to install dependancies: `INSTALL_REQUIREMENTS_ONLY=1 python3 setup.py install`. 
 
 **Note:** setup.py only installs dependencies when INSTALL_REQUIREMENTS_ONLY=1 directive is used. This option is similar to `python3 generate_requirements.py && pip install -r requirements.txt`
 
-## 3. As a library
+### As A Library
 
 You can also use this library to integrate STIX Shifter into your own tools. You can translate a STIX Pattern:
 
 ```
 from stix_shifter.stix_translation import stix_translation
 
 translation = stix_translation.StixTranslation()
@@ -122,47 +129,35 @@
 ```
 ### Use of custom mappings
 
 If a connector has been installed using pip, the process for editing the STIX mappings is different than if you have pulled-down the project. When working locally, you can edit the mapping files directly. See the [mapping files for the MySQL connector](stix_shifter_modules/mysql/stix_translation/json) as an example. Editing the mapping files won't work if the connector has been installed with pip; the setup script of the stix-shifter package includes the mapppings inside `config.json`. This allows stix-shifter to injest custom mappings as part of the connector's configuration.
 
 Refer to [Use of custom mappings](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/adapter-guide/custom_mappings.md) for more details on how to edit the mappings in the configuration.
 
-# Contributing
+## Contributing
 
 We are thrilled you are considering contributing! We welcome all contributors.
-Please read our [guidelines for contributing](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/CONTRIBUTING.md).
 
-## [Connector Developer Guide](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/adapter-guide/develop-stix-adapter.md)
+Please read our [guidelines for contributing](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/CONTRIBUTING.md).
 
-<!-- If you want to create a new connector for STIX-shifter, see the [developer guide](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/adapter-guide/develop-stix-adapter.md) -->
+## Developer Guides
 
-## [Jupyter Notebook Development Labs](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/lab)
+If you want to create a new connector for STIX-shifter, see the [developer guide](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/adapter-guide/develop-stix-adapter.md)
 
-<!-- There are also a few [Jupyter Notebook labs](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/lab) that cover the CLI commands and dev process. -->
+There are also a few [Jupyter Notebook labs](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/lab) that cover the CLI commands and dev process.
 
-# Licensing
+## Licensing
 
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
 
     http://www.apache.org/licenses/LICENSE-2.0
 
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 
-# More Resources
-
-## Join us on Slack!
-
-[Click here](https://docs.google.com/forms/d/1vEAqg9SKBF3UMtmbJJ9qqLarrXN5zeVG3_obedA3DKs) and fill out the form to receive an invite to the Open Cybersecurity Alliance slack instance, then join the #stix-shifter channel, to meet and discuss usage with the team.
-
-## Introduction Webinar!
-
-[Click here](https://ibm.biz/BdzTyA) to view an introduction webinar on STIX Shifter and the use cases it solves for.
-
-## Changelog
-
-- [Changelog](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/CHANGELOG.md)
+## More Resources
+   - [Changelog](https://github.com/opencybersecurityalliance/stix-shifter/blob/develop/CHANGELOG.md)
```

## Comparing `stix_shifter-5.2.1.dist-info/NOTICE` & `stix_shifter-5.2.1.dev814.dist-info/NOTICE`

 * *Files identical despite different names*

## Comparing `stix_shifter-5.2.1.dist-info/RECORD` & `stix_shifter-5.2.1.dev814.dist-info/RECORD`

 * *Files 16% similar despite different names*

```diff
@@ -1,16 +1,16 @@
 stix_shifter/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter/scripts/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-stix_shifter/scripts/stix_shifter.py,sha256=pZzTPgbHNwHCXImxGb5hjw-502BRl8dtIrUAFBYynPs,18616
-stix_shifter/scripts/supported_property_exporter.py,sha256=NV_AbXJOBrMMqjOiMAh6v9BQl5kHfVmgERnp8E0ko4U,14038
+stix_shifter/scripts/stix_shifter.py,sha256=BoA5tn25ztACSjWeeMJTVgoYNAIoFIAS6_gWP_Z6p7I,17105
+stix_shifter/scripts/supported_property_exporter.py,sha256=GFfi4Y1WzkaYEVd5SzD4uogltqutnbJKbCgx4LkBERo,13819
 stix_shifter/stix_translation/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-stix_shifter/stix_translation/json_to_stix_translator.py,sha256=Y1Vxu4Ry0YG1E0fGPjaXGYjMkzXlcs7hZJicAGMGfh4,21897
-stix_shifter/stix_translation/stix_translation.py,sha256=KUzBIb2WrJ5HlgTsXtFHnHzqNbZgyOJWo6zWGp9jDhM,8319
+stix_shifter/stix_translation/json_to_stix_translator.py,sha256=72KkjPPwPGUxxyhtYaq9CcFAOOKG_emxSqKeCnmveyw,21567
+stix_shifter/stix_translation/stix_translation.py,sha256=hkNg2F7JUXAb4C3ow8i7ZdqQFUWzTYN_kmIH3raOxk8,8132
 stix_shifter/stix_transmission/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter/stix_transmission/stix_transmission.py,sha256=g03U6wMu2Yj0gCCtr8ox6fJGu27EoPem5y_7cIGLedY,4462
-stix_shifter-5.2.1.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
-stix_shifter-5.2.1.dist-info/METADATA,sha256=5pej2DMuUhOudXVUxhoeicL7HsHNIQcKV9UtClZY5-A,8770
-stix_shifter-5.2.1.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
-stix_shifter-5.2.1.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
-stix_shifter-5.2.1.dist-info/entry_points.txt,sha256=7FNxDTZWzRwKCGlz-6f13MKrNgyrA_lKCsObJ1z6Swg,72
-stix_shifter-5.2.1.dist-info/top_level.txt,sha256=wAbFHOjr2ue_lgkQ5YGPNi1xgSbyyn0X05oB91b9qhs,13
-stix_shifter-5.2.1.dist-info/RECORD,,
+stix_shifter-5.2.1.dev814.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
+stix_shifter-5.2.1.dev814.dist-info/METADATA,sha256=uW5gPCpkYlQcM0aJkIui18UtVLmkSFg0nbJCBGutdfg,7816
+stix_shifter-5.2.1.dev814.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
+stix_shifter-5.2.1.dev814.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
+stix_shifter-5.2.1.dev814.dist-info/entry_points.txt,sha256=7FNxDTZWzRwKCGlz-6f13MKrNgyrA_lKCsObJ1z6Swg,72
+stix_shifter-5.2.1.dev814.dist-info/top_level.txt,sha256=wAbFHOjr2ue_lgkQ5YGPNi1xgSbyyn0X05oB91b9qhs,13
+stix_shifter-5.2.1.dev814.dist-info/RECORD,,
```

