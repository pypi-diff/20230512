# Comparing `tmp/custardpy-0.3.7-py3-none-any.whl.zip` & `tmp/custardpy-0.4.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,35 +1,34 @@
-Zip file size: 37918 bytes, number of entries: 33
+Zip file size: 38119 bytes, number of entries: 32
 -rw-rw-r--  2.0 unx     2579 b- defN 23-Apr-26 06:20 custardpy/CannyEdge.py
 -rw-rw-r--  2.0 unx     6496 b- defN 23-Apr-26 06:20 custardpy/Cluster.py
 -rw-rw-r--  2.0 unx     3589 b- defN 23-Apr-26 06:20 custardpy/DirectionalRelativeFreq.py
--rw-rw-r--  2.0 unx     2515 b- defN 23-Apr-26 06:20 custardpy/DirectionalityIndex.py
+-rw-rw-r--  2.0 unx     2361 b- defN 23-May-09 04:17 custardpy/DirectionalityIndex.py
 -rw-rw-r--  2.0 unx     4529 b- defN 23-Apr-26 06:20 custardpy/HiCmodule.py
 -rw-rw-r--  2.0 unx     4455 b- defN 23-Apr-26 06:20 custardpy/InsulationScore.py
 -rw-rw-r--  2.0 unx     2678 b- defN 23-Apr-26 06:20 custardpy/MAnorm.py
--rw-rw-r--  2.0 unx    10946 b- defN 23-Apr-26 06:20 custardpy/PlotModule.py
+-rw-rw-r--  2.0 unx    10965 b- defN 23-May-12 06:45 custardpy/PlotModule.py
 -rw-rw-r--  2.0 unx       19 b- defN 23-Apr-26 06:20 custardpy/__init__.py
 -rw-rw-r--  2.0 unx      604 b- defN 23-Apr-26 06:20 custardpy/checkHiCfile.py
 -rw-rw-r--  2.0 unx     2683 b- defN 23-Apr-25 13:19 custardpy/convert_JuicerDump_to_dense.py
 -rw-rw-r--  2.0 unx      341 b- defN 23-Apr-26 06:20 custardpy/generateCmap.py
--rw-rw-r--  2.0 unx     1636 b- defN 23-Apr-26 06:20 custardpy/loadData.py
--rwxrwxr-x  2.0 unx     4441 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/InsulationScore.py
--rwxrwxr-x  2.0 unx      590 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/checkHiCfile.py
--rwxrwxr-x  2.0 unx     2669 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/convert_JuicerDump_to_dense.py
--rwxrwxr-x  2.0 unx     4041 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/drawSquareMulti
--rwxrwxr-x  2.0 unx     2745 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/drawSquarePair
--rwxrwxr-x  2.0 unx     3088 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/drawSquareRatioMulti
--rwxrwxr-x  2.0 unx     2550 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/drawSquareRatioPair
--rwxrwxr-x  2.0 unx     4066 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/drawTriangleMulti
--rwxrwxr-x  2.0 unx     3578 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/drawTrianglePair
--rwxrwxr-x  2.0 unx     3967 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/drawTriangleRatioMulti
--rwxrwxr-x  2.0 unx     1177 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/getBoundaryfromInsulationScore
--rwxrwxr-x  2.0 unx     2325 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/plotCompartmentGenome
--rwxrwxr-x  2.0 unx      931 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/plotHiCMatrix
--rwxrwxr-x  2.0 unx    12044 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/plotHiCfeature
--rwxrwxr-x  2.0 unx     1436 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/plotInsulationScore
--rwxrwxr-x  2.0 unx     1199 b- defN 23-Apr-29 08:30 custardpy-0.3.7.data/scripts/plotMultiScaleInsulationScore
--rw-rw-r--  2.0 unx     3294 b- defN 23-Apr-29 08:30 custardpy-0.3.7.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-Apr-29 08:30 custardpy-0.3.7.dist-info/WHEEL
--rw-rw-r--  2.0 unx       10 b- defN 23-Apr-29 08:30 custardpy-0.3.7.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3065 b- defN 23-Apr-29 08:30 custardpy-0.3.7.dist-info/RECORD
-33 files, 100378 bytes uncompressed, 32896 bytes compressed:  67.2%
+-rw-rw-r--  2.0 unx     1636 b- defN 23-May-11 06:20 custardpy/loadData.py
+-rwxrwxr-x  2.0 unx     4441 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/InsulationScore.py
+-rwxrwxr-x  2.0 unx      590 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/checkHiCfile.py
+-rwxrwxr-x  2.0 unx     2669 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/convert_JuicerDump_to_dense.py
+-rwxrwxr-x  2.0 unx     4018 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/drawSquareMulti
+-rwxrwxr-x  2.0 unx     2805 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/drawSquarePair
+-rwxrwxr-x  2.0 unx     3084 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/drawSquareRatioMulti
+-rwxrwxr-x  2.0 unx     2550 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/drawSquareRatioPair
+-rwxrwxr-x  2.0 unx     4217 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/drawTriangleMulti
+-rwxrwxr-x  2.0 unx     3572 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/drawTrianglePair
+-rwxrwxr-x  2.0 unx     1177 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/getBoundaryfromInsulationScore
+-rwxrwxr-x  2.0 unx     2326 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/plotCompartmentGenome
+-rwxrwxr-x  2.0 unx      931 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/plotHiCMatrix
+-rwxrwxr-x  2.0 unx    23454 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/plotHiCfeature
+-rwxrwxr-x  2.0 unx     1436 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/plotInsulationScore
+-rwxrwxr-x  2.0 unx     1199 b- defN 23-May-12 06:50 custardpy-0.4.0.data/scripts/plotMultiScaleInsulationScore
+-rw-rw-r--  2.0 unx     3294 b- defN 23-May-12 06:50 custardpy-0.4.0.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-May-12 06:50 custardpy-0.4.0.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       10 b- defN 23-May-12 06:50 custardpy-0.4.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     2957 b- defN 23-May-12 06:50 custardpy-0.4.0.dist-info/RECORD
+32 files, 107757 bytes uncompressed, 33275 bytes compressed:  69.1%
```

## zipnote {}

```diff
@@ -33,68 +33,65 @@
 
 Filename: custardpy/generateCmap.py
 Comment: 
 
 Filename: custardpy/loadData.py
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/InsulationScore.py
+Filename: custardpy-0.4.0.data/scripts/InsulationScore.py
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/checkHiCfile.py
+Filename: custardpy-0.4.0.data/scripts/checkHiCfile.py
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/convert_JuicerDump_to_dense.py
+Filename: custardpy-0.4.0.data/scripts/convert_JuicerDump_to_dense.py
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/drawSquareMulti
+Filename: custardpy-0.4.0.data/scripts/drawSquareMulti
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/drawSquarePair
+Filename: custardpy-0.4.0.data/scripts/drawSquarePair
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/drawSquareRatioMulti
+Filename: custardpy-0.4.0.data/scripts/drawSquareRatioMulti
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/drawSquareRatioPair
+Filename: custardpy-0.4.0.data/scripts/drawSquareRatioPair
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/drawTriangleMulti
+Filename: custardpy-0.4.0.data/scripts/drawTriangleMulti
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/drawTrianglePair
+Filename: custardpy-0.4.0.data/scripts/drawTrianglePair
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/drawTriangleRatioMulti
+Filename: custardpy-0.4.0.data/scripts/getBoundaryfromInsulationScore
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/getBoundaryfromInsulationScore
+Filename: custardpy-0.4.0.data/scripts/plotCompartmentGenome
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/plotCompartmentGenome
+Filename: custardpy-0.4.0.data/scripts/plotHiCMatrix
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/plotHiCMatrix
+Filename: custardpy-0.4.0.data/scripts/plotHiCfeature
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/plotHiCfeature
+Filename: custardpy-0.4.0.data/scripts/plotInsulationScore
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/plotInsulationScore
+Filename: custardpy-0.4.0.data/scripts/plotMultiScaleInsulationScore
 Comment: 
 
-Filename: custardpy-0.3.7.data/scripts/plotMultiScaleInsulationScore
+Filename: custardpy-0.4.0.dist-info/METADATA
 Comment: 
 
-Filename: custardpy-0.3.7.dist-info/METADATA
+Filename: custardpy-0.4.0.dist-info/WHEEL
 Comment: 
 
-Filename: custardpy-0.3.7.dist-info/WHEEL
+Filename: custardpy-0.4.0.dist-info/top_level.txt
 Comment: 
 
-Filename: custardpy-0.3.7.dist-info/top_level.txt
-Comment: 
-
-Filename: custardpy-0.3.7.dist-info/RECORD
+Filename: custardpy-0.4.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## custardpy/DirectionalityIndex.py

```diff
@@ -8,17 +8,20 @@
 from custardpy.InsulationScore import MultiInsulationScore
 
 def calcDI(mat, resolution, *, distance=1000000):
     def getDI(mat, i, len):
         A = round(np.triu(mat[i-len:i, i-len:i]).sum(), 6)
         B = round(np.triu(mat[i:i+len, i:i+len]).sum(), 6)
         E = round((A + B)/2, 6)
-#        print (A, B, E, A-E, B-E, (A-E)**2, (A-E)**2/E)
-#        DI = ((A-E)**2 + (B-E)**2) /E
-        DI = ((A-E)**2)*2 /E
+
+        if E != 0:
+            DI = ((A-E)**2)*2 / E
+        else:
+            DI = 0
+
         if A > B:
             DI = -DI
         return DI
 
     len = int(distance / resolution)
     array = np.zeros(mat.shape[0])
     mat2 = np.nan_to_num(mat)
@@ -27,17 +30,14 @@
     return array
 
 def getDirectionalityIndexOfMultiSample(samples, labels, *, distance=1000000):
     for i, sample in enumerate(samples):
         if i==0: Matrix = sample.getDirectionalityIndex(distance=distance)
         else:    Matrix = np.vstack((Matrix,sample.getDirectionalityIndex(distance=distance)))
     Matrix = np.nan_to_num(Matrix)
-#    Matrix = pd.DataFrame(Matrix)
-#    Matrix = Matrix.replace(-np.inf,np.nan).fillna(0)
-#    Matrix.index = labels
     return Matrix
 
 if(__name__ == '__main__'):
     parser = argparse.ArgumentParser()
     parser.add_argument("matrix", help="Input matrix", type=str)
     parser.add_argument("output", help="Output prefix", type=str)
     parser.add_argument("chr", help="Chromosome", type=str)
```

## custardpy/PlotModule.py

```diff
@@ -2,77 +2,109 @@
 import pandas as pd
 import matplotlib.pyplot as plt
 from scipy import ndimage
 from custardpy.generateCmap import *
 
 Mega = 1000000
 
-def pltxticks_mega(start, end, figstart, figend):
+def pltxticks_mega_subplot2grid(start, end, figstart, figend, *, ax=None):
     xlen = (figend - figstart)
-    nmem = int(xlen/Mega) +1
+    nmem = int(xlen/Mega) + 1
     x = start + np.arange(nmem) * (end-start) * Mega/xlen
     xval = np.array(((figstart/Mega + np.arange(nmem))*10), dtype=np.int64) / 10
-    plt.xticks(x, xval)
 
-def pltxticks(start, end, figstart, figend, nmem):
+    if ax is None:
+        plt.xticks(x, xval)
+    else:
+        ax.set_xticks(x, xval)
+
+def pltxticks_subplot2grid(start, end, figstart, figend, nmem, *, ax=None):
     mem = int((end - start)/nmem)
     x = start + np.arange(nmem+1) * mem
     val = (figend - figstart) / nmem
     xval = np.array(((figstart + np.arange(nmem+1) * val) / Mega * 10), dtype=np.int64) / 10
-    plt.xticks(x, xval)
+    
+#    print (x)
+#    print (xval)
+    if ax is None:
+        plt.xticks(x, xval)
+    else:
+        ax.set_xticks(x, xval)
 
-def pltyticks(start, end, figstart, figend, nmem):
+def pltyticks_subplot2grid(start, end, figstart, figend, nmem, *, ax=None):
     mem = int((end - start)/nmem)
     x = start + np.arange(nmem+1) * mem
     val = (figend - figstart) / nmem
     xval = (figstart + np.arange(nmem+1)*val)/Mega
-    plt.yticks(x, xval)
 
-def axxticks(ax, start, end, figstart, figend, nmem):
-    mem = int((end - start)/nmem)
-    x = start + np.arange(nmem+1) * mem
-    val = (figend - figstart) / nmem
-    xval = (figstart + np.arange(nmem+1)*val)/Mega
-    ax.set_xticks(x)
-    ax.set_xticklabels(xval)
+    if ax is None:
+        plt.yticks(x, xval)
+    else:
+        ax.set_yticks(x, xval)
 
-def ytickoff(plt):
-    plt.tick_params(
-        axis='y',          # changes apply to the x-axis
-        which='both',      # both major and minor ticks are affected
-        left=False,        # ticks along the bottom edge are off
-        right=False,       # ticks along the top edge are off
-        labelleft=False
-    )
-
-def xtickoff(plt):
-    plt.tick_params(
-        axis='x',          # changes apply to the x-axis
-        which='both',      # both major and minor ticks are affected
-        bottom=False,      # ticks along the bottom edge are off
-        top=False,         # ticks along the top edge are off
-        labelbottom=False  # labels along the bottom edge are off
-    )
+def ytickoff_ax(*, ax=None):
+    if ax is None:
+        plt.tick_params(
+            axis='y',          # changes apply to the y-axis
+            which='both',      # both major and minor ticks are affected
+            left=False,        # ticks along the bottom edge are off
+            right=False,       # ticks along the top edge are off
+            labelleft=False
+        )
+    else:
+        ax.tick_params(
+            axis='y',          # changes apply to the y-axis
+            which='both',      # both major and minor ticks are affected
+            left=False,        # ticks along the bottom edge are off
+            right=False,       # ticks along the top edge are off
+            labelleft=False
+        )
+
+def xtickoff_ax(*, ax=None):
+    if ax is None:
+        plt.tick_params(
+            axis='x',          # changes apply to the x-axis
+            which='both',      # both major and minor ticks are affected
+            bottom=False,      # ticks along the bottom edge are off
+            top=False,         # ticks along the top edge are off
+            labelbottom=False  # labels along the bottom edge are off
+        )
+    else:
+        ax.tick_params(
+            axis='x',          # changes apply to the x-axis
+            which='both',      # both major and minor ticks are affected
+            bottom=False,      # ticks along the bottom edge are off
+            top=False,         # ticks along the top edge are off
+            labelbottom=False  # labels along the bottom edge are off
+        )
 
-def drawHeatmapSquare(plt, matrix, resolution, *, tads="", loops="",
+def calculate_start_end(matrix, figstart, figend, resolution):
+    s = int(figstart / resolution)
+    e = int(figend / resolution)
+    if e == 0:
+        e = matrix.shape[0]
+    return s, e
+
+def extract_submatrix(matrix, s, e):
+    if isinstance(matrix, pd.DataFrame):
+        return matrix.iloc[s:e, s:e]
+    else:
+        return matrix[s:e, s:e]
+
+def drawHeatmapSquare(matrix, resolution, *, tads=None, loops=None,
                       figstart=0, figend=0, distancemax=0,
                       vmin=0, vmax=50, label="", xticks=True,
                       cmap=generate_cmap(['#FFFFFF', '#d10a3f'])):
-    s = int(figstart / resolution)
-    e = int(figend   / resolution)
-    if (e==0): e = matrix.shape[0]
 
-    if (isinstance(matrix, pd.DataFrame)):
-        mat = matrix.iloc[s:e,s:e]
-    else:
-        mat = matrix[s:e,s:e]
+    s, e = calculate_start_end(matrix, figstart, figend, resolution)
+    mat = extract_submatrix(matrix, s, e)
 
     plt.imshow(mat, clim=(vmin, vmax), cmap=cmap, interpolation="nearest", aspect=1)
 
-    if (isinstance(tads, pd.DataFrame)):
+    if not tads is None:
         for tad in tads.itertuples(name=None):
             x1 = int(tad[2])/resolution - s
             x2 = int(tad[3])/resolution - s
             if x1 > 0:
                 plt.vlines(x1, x1, min(x2, e-s), linestyle='dashed', linewidth=0.6)
             if x2 < e-s:
                 plt.vlines(x2, max(0, x1), x2, linestyle='dashed', linewidth=0.6)
@@ -80,214 +112,185 @@
                 plt.hlines(x1, x1, min(x2, e-s), linestyle='dashed', linewidth=0.6)
             if x2 < e-s:
                 plt.hlines(x2, max(0, x1), x2, linestyle='dashed', linewidth=0.6)
 
     plt.xlim(0, e-s)
     plt.ylim(e-s, 0)
 
-    if (label != ""): plt.title(label)
+    plt.title(label)
     if (xticks):
-        pltxticks(0, e-s, figstart, figend, 5)
+        pltxticks_subplot2grid(0, e-s, figstart, figend, 5)
     else:
-        xtickoff(plt)
-
-    ytickoff(plt)
+        xtickoff_ax()
 
+    ytickoff_ax()
 
-def drawHeatmapTriangle(plt, matrix, resolution, *, tads="", loops="",
-                        figstart=0, figend=0, distancemax=5000000,
-                        vmin=0, vmax=50, label="", xticks=True,
-                        cmap=generate_cmap(['#FFFFFF', '#d10a3f'])):
-    s = int(figstart / resolution)
-    e = int(figend   / resolution)
-    if (e==0): e = matrix.shape[0]
+def get_xbin_sqrt2(posi, s, resolution):
+    return (posi/resolution - s) * np.sqrt(2)
 
+def calculate_fig_length(e, s):
     sqrt2 = np.sqrt(2)
-    figlength = (e-s)*sqrt2
+    return (e - s) * sqrt2
 
-    if (isinstance(matrix, pd.DataFrame)):
-        mat = matrix.iloc[s:e,s:e]
+def limit_yaxis_subplot2grid(distance_max, resolution, ynum, _figstart, _figend, *, ax=None):
+    if (distance_max > 0):
+        ystart = max(0, ynum - distance_max/resolution)
+        figstart = 0
+        figend = min(distance_max, (_figend - _figstart))
     else:
-        mat = matrix[s:e,s:e]
+        ystart = 0
+        figstart = 0
+        figend = _figend - _figstart
 
-    dst = ndimage.rotate(mat, 45, order=0, reshape=True, prefilter=False, cval=0)
-    plt.imshow(dst, clim=(vmin, vmax), cmap=cmap, interpolation="nearest", aspect='auto')
-    plt.colorbar()
+    if ax is None:
+        plt.ylim(ynum, ystart)
+    else:
+        ax.set_ylim(ynum, ystart)
+    pltyticks_subplot2grid(ynum, ystart, figstart, figend, 5, ax=ax)
 
-    ynum = dst.shape[0]/2
-    if (isinstance(tads, pd.DataFrame)):
-        for tad in tads.itertuples(name=None):
-            x1 = tad[2]/resolution - s
-            x2 = tad[3]/resolution - s
-            x1 *= sqrt2
-            x2 *= sqrt2
-            if (x1 >0):
-                xmed = (x1 + min([x2, figlength]))/2
+def plot_tads_subplot2grid(tads, s, fig_length, resolution, ynum, *, ax=None):
+    if tads is None:
+        return
+
+    for tad in tads.itertuples(name=None):
+        x1 = get_xbin_sqrt2(tad[2], s, resolution) #(tad[2]/resolution - s) * np.sqrt(2)
+        x2 = get_xbin_sqrt2(tad[3], s, resolution) #(tad[3]/resolution - s) * np.sqrt(2)
+        if (x1 >0):
+            xmed = (x1 + min([x2, fig_length]))/2
+            if ax is None:
                 plt.plot([x1, min([xmed, x2])],[ynum, ynum-(xmed-x1)],
-                         color='k', linestyle='dashed', linewidth=0.6)
-            if (x2 < figlength):
-                xmed = (max([x1, 0]) + x2) /2
+                        color='k', linestyle='dashed', linewidth=0.6)
+            else:
+                ax.plot([x1, min([xmed, x2])],[ynum, ynum-(xmed-x1)],
+                        color='k', linestyle='dashed', linewidth=0.6)
+
+        if (x2 < fig_length):
+            xmed = (max([x1, 0]) + x2) /2
+            if ax is None:
                 plt.plot([x2, xmed],[ynum, ynum-(x2-xmed)],
-                         color='k', linestyle='dashed', linewidth=0.6)
+                        color='k', linestyle='dashed', linewidth=0.6)
+            else:
+                ax.plot([x2, xmed],[ynum, ynum-(x2-xmed)],
+                        color='k', linestyle='dashed', linewidth=0.6)
+
+def plot_loops_subplot2grid(loops, s, fig_length, resolution, ynum, *, ax=None):
+    if loops is None:
+        return
+
+    for loop in loops.itertuples(name=None):
+        x1 = get_xbin_sqrt2((loop[2] + loop[3])/2, s, resolution) # ((loop[2] + loop[3])/2/resolution - s) * np.sqrt(2)
+        x2 = get_xbin_sqrt2((loop[5] + loop[6])/2, s, resolution) # ((loop[5] + loop[6])/2/resolution - s) * np.sqrt(2)
+
+        if (x1 >0 and x2 < fig_length):
+            xmed = (x1 + min([x2, fig_length]))/2
+            if ax is None:
+                plt.scatter(xmed, ynum-(xmed-x1), s=60, marker="o",  facecolor='None', edgecolors='blue')
+            else:
+                ax.scatter(xmed, ynum-(xmed-x1), s=60, marker="o",  facecolor='None', edgecolors='blue')
 
-    if (isinstance(loops, pd.DataFrame)):
-        for loop in loops.itertuples(name=None):
-            x1 = (loop[2] + loop[3])/2/resolution - s
-            x2 = (loop[5] + loop[6])/2/resolution - s
-            x1 *= sqrt2
-            x2 *= sqrt2
+def drawHeatmapTriangle_subplot2grid(matrix, resolution, *, figstart=0, figend=0,
+                                     distance_max=5000000, vmin=0, vmax=50, label="",
+                                     xticks=True, tads=None, loops=None, cmap=None,
+                                     logratio=False, control_label="Control",
+                                     heatmap_ax=None, colorbar_ax=None):
+    if cmap is None:
+        cmap = generate_cmap(['#FFFFFF', '#d10a3f'])
 
-            if (x1 >0 and x2 < figlength):
-                xmed = (x1 + min([x2, figlength]))/2
-                plt.scatter(xmed, ynum-(xmed-x1), s=60, marker="o",  facecolor='None', edgecolors='blue')
+    s, e = calculate_start_end(matrix, figstart, figend, resolution)
+    fig_length = calculate_fig_length(e, s)
 
-#            if (x1 >0):
-#                xmed = (x1 + min([x2, (e-s)*1.41]))/2
-#                plt.plot([x1, min([xmed, x2])],[ynum, ynum-(xmed-x1)],
-#                         color='b', linestyle='dashed', linewidth=0.5)
-#            if (x2 < (e-s)*1.41):
-#                xmed = (max([x1, 0]) + x2) /2
-#                plt.plot([x2, xmed],[ynum, ynum-(x2-xmed)],
-#                         color='b', linestyle='dashed', linewidth=0.6)
+    mat = extract_submatrix(matrix, s, e)
+    rotated_mat = ndimage.rotate(mat, 45, order=0, reshape=True, prefilter=False, cval=0)
 
-    if (distancemax > 0):
-        ystart = max(0, ynum - distancemax/resolution)
-        plt.ylim(ynum, ystart)
-        pltyticks(ynum, ystart, 0, min(distancemax, (figend - figstart)), 5)
+    if heatmap_ax is None:
+        plt.imshow(rotated_mat, clim=(vmin, vmax), cmap=cmap, interpolation="nearest", aspect='auto')
     else:
-        ystart = 0
-        plt.ylim(ynum, ystart)
-        pltyticks(ynum, ystart, 0, figend - figstart, 5)
+        img = heatmap_ax.imshow(rotated_mat, clim=(vmin, vmax), cmap=cmap, interpolation="nearest", aspect='auto')
 
-    if (label != ""): plt.title(label)
+    if colorbar_ax is None:
+        plt.colorbar()
+    else:
+        plt.colorbar(img, cax=colorbar_ax)
+
+    ynum = rotated_mat.shape[0] / 2
+    plot_tads_subplot2grid(tads, s, fig_length, resolution, ynum, ax=heatmap_ax)
+    plot_loops_subplot2grid(loops, s, fig_length, resolution, ynum, ax=heatmap_ax)
+
+    limit_yaxis_subplot2grid(distance_max, resolution, ynum, figstart, figend, ax=heatmap_ax)
+
+    # plot xticks
     if (xticks):
         if (figend - figstart > Mega*10):
-                pltxticks_mega(0, figlength, figstart, figend)
+            pltxticks_mega_subplot2grid(0, fig_length, figstart, figend, ax=heatmap_ax)
         else:
-                nxticks = max(int((figend - figstart)/Mega), 10)
-                pltxticks(0, figlength, figstart, figend, nxticks)
+            nxticks = max(int((figend - figstart)/Mega), 10)
+            pltxticks_subplot2grid(0, fig_length, figstart, figend, nxticks, ax=heatmap_ax)
+    else:
+        xtickoff_ax(ax=heatmap_ax)
+    
+    ytickoff_ax(ax=heatmap_ax)
+
+    # title
+    if logratio:
+        str_title = "log(" + label + "/" + control_label + ")"
     else:
-        xtickoff(plt)
+        str_title = label
+    if heatmap_ax is None:
+        plt.title(str_title)
+    else:
+        heatmap_ax.set_title(str_title)
 
-def drawHeatmapTrianglePair(plt, matrix1, matrix2, resolution, *,
-                            tads="", loops="", tads2="", loops2="",
-                            figstart=0, figend=0, distancemax=5000000,
+def drawHeatmapTrianglePair(matrix1, matrix2, resolution, *,
+                            tads=None, loops=None, tads2=None, loops2=None,
+                            figstart=0, figend=0, distance_max=5000000,
                             vmin=0, vmax=50, label="", xticks=True,
                             cmap=generate_cmap(['#FFFFFF', '#d10a3f'])):
-    s = int(figstart / resolution)
-    e = int(figend   / resolution)
-    if (e==0): e = matrix1.shape[0]
+    s, e = calculate_start_end(matrix1, figstart, figend, resolution)
+    fig_length = calculate_fig_length(e, s)
 
-    if (isinstance(matrix1, pd.DataFrame)):
-        mat = matrix1.iloc[s:e,s:e]
-    else:
-        mat = matrix1[s:e,s:e]
+    mat = extract_submatrix(matrix1, s, e)
 
     plt.figure(figsize=(12, 8))
     plt.subplot(2, 1, 1)
 
-    dst = ndimage.rotate(mat, 45, order=0, reshape=True, prefilter=False, cval=0)
-    plt.imshow(dst, clim=(vmin, vmax), cmap=cmap, interpolation="nearest", aspect='auto')
+    rotated_mat = ndimage.rotate(mat, 45, order=0, reshape=True, prefilter=False, cval=0)
+    plt.imshow(rotated_mat, clim=(vmin, vmax), cmap=cmap, interpolation="nearest", aspect='auto')
     plt.colorbar()
 
-    ynum = dst.shape[0]/2
-    if (isinstance(tads, pd.DataFrame)):
-        for tad in tads.itertuples(name=None):
-            x1 = tad[2]/resolution - s
-            x2 = tad[3]/resolution - s
-            x1 *= 1.41
-            x2 *= 1.41
-            if (x1 >0):
-                xmed = (x1 + min([x2, (e-s)*1.41]))/2
-                plt.plot([x1, min([xmed, x2])],[ynum, ynum-(xmed-x1)],
-                         color='k', linestyle='dashed', linewidth=0.6)
-            if (x2 < (e-s)*1.41):
-                xmed = (max([x1, 0]) + x2) /2
-                plt.plot([x2, xmed],[ynum, ynum-(x2-xmed)],
-                         color='k', linestyle='dashed', linewidth=0.6)
-
-    if (isinstance(loops, pd.DataFrame)):
-        for loop in loops.itertuples(name=None):
-            x1 = (loop[2] + loop[3])/2/resolution - s
-            x2 = (loop[5] + loop[6])/2/resolution - s
-            x1 *= 1.41
-            x2 *= 1.41
-            if (x1 >0):
-                xmed = (x1 + min([x2, (e-s)*1.41]))/2
-                plt.plot([x1, min([xmed, x2])],[ynum, ynum-(xmed-x1)],
-                         color='b', linestyle='dashed', linewidth=0.5)
-            if (x2 < (e-s)*1.41):
-                xmed = (max([x1, 0]) + x2) /2
-                plt.plot([x2, xmed],[ynum, ynum-(x2-xmed)],
-                         color='b', linestyle='dashed', linewidth=0.6)
-
-    if (distancemax > 0):
-        ystart = max(0, ynum - distancemax/resolution)
-        plt.ylim(ynum, ystart)
-        pltyticks(ynum, ystart, 0, min(distancemax, (figend - figstart)), 5)
-    else:
-        ystart = 0
-        plt.ylim(ynum, ystart)
-        pltyticks(ynum, ystart, 0, figend - figstart, 5)
-
-    if (label != ""): plt.title(label)
-    xtickoff(plt)
-    ytickoff(plt)
-
+    ynum = rotated_mat.shape[0]/2
+    plot_tads_subplot2grid(tads, s, fig_length, resolution, ynum)
+    plot_loops_subplot2grid(loops, s, fig_length, resolution, ynum)
+
+    limit_yaxis_subplot2grid(distance_max, resolution, ynum, figstart, figend)
+
+    plt.title(label)
+    xtickoff_ax()
+    ytickoff_ax()
 
     plt.subplot(2, 1, 2)
-    if (isinstance(matrix2, pd.DataFrame)):
-        mat2 = matrix2.iloc[s:e,s:e]
-    else:
-        mat2 = matrix2[s:e,s:e]
 
-    dst = ndimage.rotate(mat2, 45, order=0, reshape=True, prefilter=False, cval=0)
-    plt.imshow(dst, clim=(vmin, vmax), cmap=cmap, interpolation="nearest", aspect='auto')
+    mat2 = extract_submatrix(matrix2, s, e)
+    rotated_mat = ndimage.rotate(mat2, 45, order=0, reshape=True, prefilter=False, cval=0)
+    plt.imshow(rotated_mat, clim=(vmin, vmax), cmap=cmap, interpolation="nearest", aspect='auto')
     plt.colorbar()
 
-    ynum = dst.shape[0]/2
-    if (isinstance(tads2, pd.DataFrame)):
-        for tad in tads2.itertuples(name=None):
-            x1 = tad[2]/resolution - s
-            x2 = tad[3]/resolution - s
-            x1 *= 1.41
-            x2 *= 1.41
-            if (x1 >0):
-                xmed = (x1 + min([x2, (e-s)*1.41]))/2
-                plt.plot([x1, min([xmed, x2])],[ynum, ynum-(xmed-x1)],
-                         color='k', linestyle='dashed', linewidth=0.6)
-            if (x2 < (e-s)*1.41):
-                xmed = (max([x1, 0]) + x2) /2
-                plt.plot([x2, xmed],[ynum, ynum-(x2-xmed)],
-                         color='k', linestyle='dashed', linewidth=0.6)
-
-    if (isinstance(loops2, pd.DataFrame)):
-        for loop in loops2.itertuples(name=None):
-            x1 = (loop[2] + loop[3])/2/resolution - s
-            x2 = (loop[5] + loop[6])/2/resolution - s
-            x1 *= 1.41
-            x2 *= 1.41
-            if (x1 >0):
-                xmed = (x1 + min([x2, (e-s)*1.41]))/2
-                plt.plot([x1, min([xmed, x2])],[ynum, ynum-(xmed-x1)],
-                         color='b', linestyle='dashed', linewidth=0.5)
-            if (x2 < (e-s)*1.41):
-                xmed = (max([x1, 0]) + x2) /2
-                plt.plot([x2, xmed],[ynum, ynum-(x2-xmed)],
-                         color='b', linestyle='dashed', linewidth=0.6)
+    ynum = rotated_mat.shape[0]/2
+    plot_tads_subplot2grid(tads2, s, fig_length, resolution, ynum)
+    plot_loops_subplot2grid(loops2, s, fig_length, resolution, ynum)
 
-    if (distancemax > 0):
-        ystart = max(0, ynum - distancemax/resolution)
+    if (distance_max > 0):
+        ystart = max(0, ynum - distance_max/resolution)
         plt.ylim(ystart, ynum)
-#        pltyticks(ynum, ystart, 0, min(distancemax, (figend - figstart)), 5)
+        pltyticks_subplot2grid(ynum, ystart, 0, min(distance_max, (figend - figstart)), 5)
     else:
         ystart = 0
         plt.ylim(ystart, ynum)
-#        pltyticks(ynum, ystart, 0, figend - figstart, 5)
+        pltyticks_subplot2grid(ynum, ystart, 0, figend - figstart, 5)
 
-#    if (label != ""): plt.title(label)
     if (xticks):
-        pltxticks(0, (e-s)*1.41, figstart, figend, 10)
+        pltxticks_subplot2grid(0, (e-s)*1.41, figstart, figend, 10)
     else:
-        xtickoff(plt)
+        xtickoff_ax()
+
+    ytickoff_ax()
 
     plt.tight_layout()
```

## Comparing `custardpy-0.3.7.data/scripts/InsulationScore.py` & `custardpy-0.4.0.data/scripts/InsulationScore.py`

 * *Files identical despite different names*

## Comparing `custardpy-0.3.7.data/scripts/checkHiCfile.py` & `custardpy-0.4.0.data/scripts/checkHiCfile.py`

 * *Files identical despite different names*

## Comparing `custardpy-0.3.7.data/scripts/convert_JuicerDump_to_dense.py` & `custardpy-0.4.0.data/scripts/convert_JuicerDump_to_dense.py`

 * *Files identical despite different names*

## Comparing `custardpy-0.3.7.data/scripts/drawSquareMulti` & `custardpy-0.4.0.data/scripts/drawSquareMulti`

 * *Files 1% similar despite different names*

```diff
@@ -25,15 +25,15 @@
     parser.add_argument("-e", "--end", help="end bp (default: 1000000)", type=int, default=1000000)
     parser.add_argument("--vmax", help="max value of color bar (default: 50)", type=int, default=50)
     parser.add_argument("--vmin", help="min value of color bar (default: 0)", type=int, default=0)
 #    parser.add_argument("--xsize", help="xsize for figure", type=int, default=3)
 #    parser.add_argument("--ysize", help="ysize for figure", type=int, default=3)
 
     args = parser.parse_args()
-    print(args)
+#    print(args)
 
     dirs = []
     labels = []
     for input in args.input:
         dirs.append(input[0])
         if (len(input) >1):
             labels.append(input[1])
@@ -75,27 +75,27 @@
     for i, sample in enumerate(samples):
         tadfile = dirs[i] + "/TAD/" + type + "/" + str(resolution) + "_blocks.bedpe"
         print(tadfile)
         tads = loadTADs(tadfile, chr, start=figstart, end=figend)
         loopfile = dirs[i] + "/loops/" + type + "/merged_loops.bedpe"
         print(loopfile)
         loops = loadloops(loopfile, chr, start=figstart, end=figend)
+        
         # Hi-C Map
         plt.subplot(int(len(labels)/2)+1, 2, i+1)
         if (args.log):
-            drawHeatmapSquare(plt, sample.getlog(), resolution,
+            drawHeatmapSquare(sample.getlog(), resolution,
                                 figstart=figstart, figend=figend,
                                 tads=tads, loops=loops,
                                 vmax=vmax, vmin=vmin,
                                 label=labels[i], xticks=(not args.xtickoff))
         else:
-            drawHeatmapSquare(plt, sample.getmatrix(), resolution,
+            drawHeatmapSquare(sample.getmatrix(), resolution,
                                 figstart=figstart, figend=figend,
                                 tads=tads, loops=loops,
                                 vmax=vmax, vmin=vmin,
                                 label=labels[i], xticks=(not args.xtickoff))
 
-    plt.tight_layout()
     plt.savefig(args.output + ".pdf")
 
 if(__name__ == '__main__'):
     main()
```

## Comparing `custardpy-0.3.7.data/scripts/drawSquarePair` & `custardpy-0.4.0.data/scripts/drawSquareRatioPair`

 * *Files 18% similar despite different names*

```diff
@@ -1,85 +1,77 @@
 #!python
 # -*- coding: utf-8 -*-
 
 import argparse
 import matplotlib.pyplot as plt
 import seaborn as sns
+import sys
+from scipy import ndimage
 from custardpy.HiCmodule import JuicerMatrix
-from custardpy.InsulationScore import getInsulationScoreOfMultiSample
 from custardpy.generateCmap import *
-from custardpy.loadData import *
 from custardpy.PlotModule import *
-
-#import pdb
+from custardpy.DirectionalRelativeFreq import make3dmatrixRatio
 
 def main():
     parser = argparse.ArgumentParser()
     tp = lambda x:list(map(str, x.split(':')))
-    parser.add_argument("input", help="<Input matri>", type=tp, nargs='*')
-    parser.add_argument("-o", "--output", help="Output prefix", type=str, default="output")
-    parser.add_argument("--log", help="logged count", action='store_true')
+    parser.add_argument("input", help="<Input matrix>", type=tp, nargs='*')
+    parser.add_argument("output", help="Output prefix", type=str)
     parser.add_argument("-r", "--resolution", help="resolution", type=int, default=25000)
     parser.add_argument("-s", "--start", help="start bp", type=int, default=0)
     parser.add_argument("-e", "--end", help="end bp", type=int, default=1000000)
-    parser.add_argument("--vmax", help="max value of color bar", type=int, default=50)
-    parser.add_argument("--vmin", help="min value of color bar", type=int, default=0)
-    parser.add_argument("-d", "--vizdistancemax", help="max distance in heatmap", type=int, default=0)
-    parser.add_argument("--xsize", help="xsize for figure", type=int, default=10)
+    parser.add_argument("--vmax", help="max value of color bar", type=int, default=1)
+    parser.add_argument("--vmin", help="min value of color bar", type=int, default=-1)
+    parser.add_argument("--xsize", help="xsize for figure", type=int, default=3)
     parser.add_argument("--ysize", help="ysize (* times of samples)", type=int, default=3)
 
     args = parser.parse_args()
 #    print(args)
 
     dirs = []
     labels = []
     for input in args.input:
         dirs.append(input[0])
         if (len(input) >1):
             labels.append(input[1])
         else:
             labels.append("")
 
-    if len(dirs) != 2:
-        print ("Error: specify two samples (-i).")
+    if len(dirs) == 0:
+        print ("Error: specify input data (-i).")
         exit()
 
     resolution = args.resolution
     figstart = args.start
     figend = args.end
     s = int(figstart / resolution)
     e = int(figend   / resolution)
     vmax = args.vmax
     vmin = args.vmin
-    if (args.log):
-        vmax = np.log1p(vmax)
-        vmin = np.log1p(vmin)
 
     print (resolution)
+
     samples = []
     for dir in dirs:
         samples.append(JuicerMatrix("RPM", dir, resolution))
 
-    plt.subplot(1, 1, 1)
-    if (args.log):
-        m1 = samples[0].getlog()
-        m2 = samples[1].getlog()
-    else:
-        m1 = samples[0].getmatrix()
-        m2 = samples[1].getmatrix()
+    smooth_median_filter = 3
+    mt1 = make3dmatrixRatio([samples[0], samples[1]], smooth_median_filter)
+    mt2 = make3dmatrixRatio([samples[2], samples[3]], smooth_median_filter)
 
-    matrix = np.triu(m1) + np.tril(m2, k=-1)
+    matrix = np.triu(mt1[0], k=1) + np.tril(mt2[0], k=-1)
 
-    if (labels[0] != "" and labels[1] != ""):
-        label = labels[0] + "-" + labels[1]
+    if (labels[1] != "" and labels[3] != ""):
+        label = labels[1] + "-" + labels[3]
     else:
         label = ""
 
+    plt.subplot(1, 1, 1)
     drawHeatmapSquare(plt, matrix, resolution,
                       figstart=figstart, figend=figend,
                       vmax=vmax, vmin=vmin,
+                      cmap=generate_cmap(['#1310cc', '#FFFFFF', '#d10a3f']),
                       label=label, xticks=False)
     plt.savefig(args.output + ".pdf")
 
-
 if(__name__ == '__main__'):
     main()
```

## Comparing `custardpy-0.3.7.data/scripts/drawSquareRatioMulti` & `custardpy-0.4.0.data/scripts/drawSquareRatioMulti`

 * *Files 0% similar despite different names*

```diff
@@ -22,15 +22,15 @@
     parser.add_argument("-r", "--resolution", help="resolution (default: 25000)", type=int, default=25000)
     parser.add_argument("-s", "--start", help="start bp (default: 0)", type=int, default=0)
     parser.add_argument("-e", "--end", help="end bp (default: 1000000)", type=int, default=1000000)
     parser.add_argument("--vmax", help="max value of color bar (default: 1)", type=int, default=1)
     parser.add_argument("--vmin", help="min value of color bar (default: -1)", type=int, default=-1)
 
     args = parser.parse_args()
-    print(args)
+#    print(args)
 
     dirs = []
     labels = []
     for input in args.input:
         dirs.append(input[0])
         if (len(input) >1):
             labels.append(input[1])
@@ -71,15 +71,15 @@
     plt.figure(figsize=(6, 3 * max(2,math.ceil(nsample/2))))
  #   plt.figure(figsize=(nsample*args.xsize/2, figsize_y))
 
     for i, sample in enumerate(EnrichMatrices):
         # Hi-C Map
 #        plt.subplot(math.ceil(nsample/2), 2, i+1)
         plt.subplot(int(len(labels)/2)+1, 2, i+1)
-        drawHeatmapSquare(plt, sample, resolution,
+        drawHeatmapSquare(sample, resolution,
                           figstart=figstart, figend=figend,
                           vmax=vmax, vmin=vmin,
                           cmap=generate_cmap(['#1310cc', '#FFFFFF', '#d10a3f']),
                           label=labels[i+1], xticks=False)
 
     plt.tight_layout()
     plt.savefig(args.output + ".pdf")
```

## Comparing `custardpy-0.3.7.data/scripts/drawTriangleMulti` & `custardpy-0.4.0.data/scripts/drawTriangleMulti`

 * *Files 3% similar despite different names*

```diff
@@ -24,15 +24,15 @@
     parser.add_argument("--vmax", help="max value of color bar (default: 50)", type=int, default=50)
     parser.add_argument("--vmin", help="min value of color bar (default: 0)", type=int, default=0)
     parser.add_argument("-d", "--vizdistancemax", help="max distance in heatmap", type=int, default=0)
 #    parser.add_argument("--xsize", help="xsize for figure", type=int, default=10)
     parser.add_argument("--ysize", help="ysize (* times of samples)", type=int, default=3)
 
     args = parser.parse_args()
-    print(args)
+#    print(args)
 
     dirs = []
     labels = []
     for input in args.input:
         dirs.append(input[0])
         if (len(input) >1):
             labels.append(input[1])
@@ -54,47 +54,48 @@
     s = int(figstart / resolution)
     e = int(figend   / resolution)
     vmax = args.vmax
     vmin = args.vmin
     if (args.log):
         vmax = np.log1p(vmax)
         vmin = np.log1p(vmin)
-    figsize_x = max(int((figend-figstart)/2000000), 10)
 
     print (chr)
     print (resolution)
     samples = []
     for dir in dirs:
         observed = dir + "/Matrix/intrachromosomal/" + str(resolution) + "/observed."  + type + "." + chr + ".matrix.gz"
         samples.append(JuicerMatrix("RPM", observed, resolution))
+    nsample = len(samples)
 
     ### Plot
-    nsample = len(samples)
-    plt.figure(figsize=(figsize_x, nsample*args.ysize))
+    figsize_x = max(int((figend-figstart)/2000000), 10)
+    figsize_y = nsample * args.ysize
+    plt.figure(figsize=(figsize_x, figsize_y))
 
     for i, sample in enumerate(samples):
         tadfile = dirs[i] + "/TAD/" + type + "/" + str(resolution) + "_blocks.bedpe"
         print(tadfile)
         tads = loadTADs(tadfile, chr, start=figstart, end=figend)
         loopfile = dirs[i] + "/loops/" + type + "/merged_loops.bedpe"
         print(loopfile)
         loops = loadloops(loopfile, chr, start=figstart, end=figend)
         # Hi-C Map
         plt.subplot2grid((nsample*2, 4), (i*2,0), rowspan=2, colspan=4)
         if (args.log):
-            drawHeatmapTriangle(plt, sample.getlog(), resolution,
-                                figstart=figstart, figend=figend,
-                                tads=tads, loops=loops,
-                                vmax=vmax, vmin=vmin, distancemax=args.vizdistancemax,
-                                label=labels[i], xticks=True)
+            drawHeatmapTriangle_subplot2grid(sample.getlog(), resolution,
+                                             figstart=figstart, figend=figend,
+                                             tads=tads, loops=loops,
+                                             vmax=vmax, vmin=vmin, distance_max=args.vizdistancemax,
+                                             label=labels[i], xticks=True)
         else:
-            drawHeatmapTriangle(plt, sample.getmatrix(), resolution,
-                                figstart=figstart, figend=figend,
-                                tads=tads, loops=loops,
-                                vmax=vmax, vmin=vmin, distancemax=args.vizdistancemax,
-                                label=labels[i], xticks=True)
+            drawHeatmapTriangle_subplot2grid(sample.getmatrix(), resolution,
+                                             figstart=figstart, figend=figend,
+                                             tads=tads, loops=loops,
+                                             vmax=vmax, vmin=vmin, distance_max=args.vizdistancemax,
+                                             label=labels[i], xticks=True)
 
     plt.tight_layout()
     plt.savefig(args.output + ".pdf")
 
 if(__name__ == '__main__'):
     main()
```

## Comparing `custardpy-0.3.7.data/scripts/drawTrianglePair` & `custardpy-0.4.0.data/scripts/drawTrianglePair`

 * *Files 2% similar despite different names*

```diff
@@ -37,23 +37,21 @@
     for input in args.input:
         dirs.append(input[0])
         if (len(input) >1):
             labels.append(input[1])
         else:
             labels.append("")
 
-
     if len(dirs) != 2:
         print ("Error: specify two samples (-i).")
         exit()
     if args.chr is None:
         print ("Error: specify chromosome (-c).")
         exit()
 
-
     chr = args.chr
     resolution = args.resolution
     type = args.type
     figstart = args.start
     figend = args.end
     s = int(figstart / resolution)
     e = int(figend   / resolution)
@@ -75,19 +73,19 @@
        print(tadfile)
        tads.append(loadTADs(tadfile, chr, start=figstart, end=figend))
        loopfile = dir + "/loops/"  + type + "/merged_loops.bedpe"
        print(loopfile)
        loops.append(loadloops(loopfile, chr, start=figstart, end=figend))
 
     ### Plot
-    drawHeatmapTrianglePair(plt, samples[0].getmatrix(), samples[1].getmatrix(),
+    drawHeatmapTrianglePair(samples[0].getmatrix(), samples[1].getmatrix(),
                             resolution,
                             figstart=figstart, figend=figend,
                             tads=tads[0], loops=loops[0],
                             tads2=tads[1], loops2=loops[1],
-                            vmax=vmax, vmin=vmin, distancemax=args.vizdistancemax,
+                            vmax=vmax, vmin=vmin, distance_max=args.vizdistancemax,
                             label=labels[0] + "(upper)-" + labels[1] + "(lower)", xticks=True)
 
     plt.savefig(args.output + ".pdf")
 
 if(__name__ == '__main__'):
     main()
```

## Comparing `custardpy-0.3.7.data/scripts/getBoundaryfromInsulationScore` & `custardpy-0.4.0.data/scripts/getBoundaryfromInsulationScore`

 * *Files identical despite different names*

## Comparing `custardpy-0.3.7.data/scripts/plotCompartmentGenome` & `custardpy-0.4.0.data/scripts/plotCompartmentGenome`

 * *Files 1% similar despite different names*

```diff
@@ -15,15 +15,15 @@
     parser.add_argument("input", help="<Input directory>:<label>", type=tp, nargs='*')
     parser.add_argument("-o", "--output", help="Output prefix", type=str, default="output")
     parser.add_argument("--type", help="normalize type (default: SCALE)", type=str, default="SCALE")
     parser.add_argument("-r", "--resolution", help="resolution (default: 25000)", type=int, default=25000)
     parser.add_argument("--heatmap", help="heatmap", action='store_true')
 
     args = parser.parse_args()
-    print(args)
+#    print(args)
 
     dirs = []
     labels = []
     for input in args.input:
         dirs.append(input[0])
         if (len(input) >1):
             labels.append(input[1])
```

## Comparing `custardpy-0.3.7.data/scripts/plotHiCMatrix` & `custardpy-0.4.0.data/scripts/plotHiCMatrix`

 * *Files identical despite different names*

## Comparing `custardpy-0.3.7.data/scripts/plotInsulationScore` & `custardpy-0.4.0.data/scripts/plotInsulationScore`

 * *Files identical despite different names*

## Comparing `custardpy-0.3.7.data/scripts/plotMultiScaleInsulationScore` & `custardpy-0.4.0.data/scripts/plotMultiScaleInsulationScore`

 * *Files identical despite different names*

## Comparing `custardpy-0.3.7.dist-info/METADATA` & `custardpy-0.4.0.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: custardpy
-Version: 0.3.7
+Version: 0.4.0
 Summary: Hi-C analysis tools by Python3
 Home-page: https://github.com/rnakato/custardpy
 Author: Ryuichiro Nakato
 Author-email: rnakato@iqb.u-tokyo.ac.jp
 License: GPL3.0
 Keywords: Hi-C analysis,3D genome,NGS
 Classifier: Programming Language :: Python :: 3
```

## Comparing `custardpy-0.3.7.dist-info/RECORD` & `custardpy-0.4.0.dist-info/RECORD`

 * *Files 27% similar despite different names*

```diff
@@ -1,33 +1,32 @@
 custardpy/CannyEdge.py,sha256=HUq9S2m4mWJp0mRaO-ZYXR8LAOHW7kv7woNxnUID8CM,2579
 custardpy/Cluster.py,sha256=Pu-YFLIYedO1sxJNjALD7SGgFz71u6FIQY6kr2govDU,6496
 custardpy/DirectionalRelativeFreq.py,sha256=clPb6nzU08ah0b-u4mEIrQL6YHKdei2D7jTNDkPJcEo,3589
-custardpy/DirectionalityIndex.py,sha256=OUPzPgQQmmQ49UQ1YEs933u44xBaFy1Ab-3e3eviFyY,2515
+custardpy/DirectionalityIndex.py,sha256=pNP4uefIxTlDQeHg8Zun1UQZv96xei-KX3B50r932s8,2361
 custardpy/HiCmodule.py,sha256=96E5VkiiB9Zsp2MVBkr5GaXj0nJ8a0XT-kiWN-xU1c4,4529
 custardpy/InsulationScore.py,sha256=e8VoYJslKrgBKPdaC3pdfZnTJgiN3zZ1amgWY7fetnI,4455
 custardpy/MAnorm.py,sha256=sg-I5OovXWJWPUmbtpK7D3zzQvKt62_dkG_AdEZ3e2g,2678
-custardpy/PlotModule.py,sha256=eK4jK4iu4Fma6s7wFeyfGhuQDu81Ki3lxYpYNbMHTZU,10946
+custardpy/PlotModule.py,sha256=GqmPGnu7iJJlZT0TRMGoX6JLuv_2JtwzHr7Co-zHbxI,10965
 custardpy/__init__.py,sha256=pljStzHkOlIPJ-VqOndpGtMuaulFmd4gYB84LdbwgBE,19
 custardpy/checkHiCfile.py,sha256=aQURdjWppDtxDcTemU6d3E20T9L-CtiKVu4a32BuVpM,604
 custardpy/convert_JuicerDump_to_dense.py,sha256=ndZ_Xuu-KSqLiit65Buoo_qDhhQGMT6HfuVNz6bSWxM,2683
 custardpy/generateCmap.py,sha256=WK06-7u2dqLOQJpptbuXU87fSfOPKO44b_gM_CbTOIY,341
 custardpy/loadData.py,sha256=FxMBAfo-6lyQf6jcgeS3CYc93sD68IXwljwsfS5VlXA,1636
-custardpy-0.3.7.data/scripts/InsulationScore.py,sha256=R77hB_rlJv0U7E9l6q2wOXBYTrFZy4xtweCuRDdqnIo,4441
-custardpy-0.3.7.data/scripts/checkHiCfile.py,sha256=aLY4g1ZUutpcPYd9fc2Qov3S75f_lHduWSfpXD_2wSM,590
-custardpy-0.3.7.data/scripts/convert_JuicerDump_to_dense.py,sha256=c-gznLRUWjmUxLNel4xBJy4UqzfF-DXvHsqfTlwlTI4,2669
-custardpy-0.3.7.data/scripts/drawSquareMulti,sha256=4d4lJ5LVP_mNTc-RhVPjhL9B8CCmwzjgr4AV1OZNz4o,4041
-custardpy-0.3.7.data/scripts/drawSquarePair,sha256=ihfDSCkfhdQmevNfO42D-OaHmExoivDXFwD4xN039Ds,2745
-custardpy-0.3.7.data/scripts/drawSquareRatioMulti,sha256=YHZG2i2YAMjnJ27N03IUZOffJPXjsG1qvg4GL5ELrxA,3088
-custardpy-0.3.7.data/scripts/drawSquareRatioPair,sha256=cb3onEni6Btnfmvjg0qqdanU_zMRlwIkLSqUej0RDpU,2550
-custardpy-0.3.7.data/scripts/drawTriangleMulti,sha256=cphGwHedpPjZc2CbpGE9a-u_g-DWcYN4YltQm9DKCWk,4066
-custardpy-0.3.7.data/scripts/drawTrianglePair,sha256=72ptujBfNTwHzN7dPbRlw6kV0xkFePcYUP3ySstir7g,3578
-custardpy-0.3.7.data/scripts/drawTriangleRatioMulti,sha256=92S2yyI7R6lils6O4OlYaukcgnDIh0U-b40IhQN4GsA,3967
-custardpy-0.3.7.data/scripts/getBoundaryfromInsulationScore,sha256=va6VuB9hXSHYVY15NceZoZz7PBrVn6w5uArvUh7mrlI,1177
-custardpy-0.3.7.data/scripts/plotCompartmentGenome,sha256=UlBn4hwUaNTxpRt-gJ-hh9PLRaU9UbgGON3Mq6BoXgE,2325
-custardpy-0.3.7.data/scripts/plotHiCMatrix,sha256=X2_vom3RWL3NVH9gqkHcCm2yg5W2nAF4qItHE1P7uAE,931
-custardpy-0.3.7.data/scripts/plotHiCfeature,sha256=OXTvUaFkCqOME8viohUNheCQJi-8KjzQMay8_JDOFj8,12044
-custardpy-0.3.7.data/scripts/plotInsulationScore,sha256=pWWgN9haZ_YYeZz5vVftbLzJI8bqoIx9Y8VB4bR9hak,1436
-custardpy-0.3.7.data/scripts/plotMultiScaleInsulationScore,sha256=xEUaByR9xa1mzYICBl5V7sraup6Xna-24gCuqEJN8GI,1199
-custardpy-0.3.7.dist-info/METADATA,sha256=KtEJ4I2WaF9rUlKm9RlTf-8EceL_5D5BjF4CGT2-F0k,3294
-custardpy-0.3.7.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-custardpy-0.3.7.dist-info/top_level.txt,sha256=FQEyEhVh5ak4j-9SgLBKkvJ9VMvz2ckZQcaBHR5_10E,10
-custardpy-0.3.7.dist-info/RECORD,,
+custardpy-0.4.0.data/scripts/InsulationScore.py,sha256=R77hB_rlJv0U7E9l6q2wOXBYTrFZy4xtweCuRDdqnIo,4441
+custardpy-0.4.0.data/scripts/checkHiCfile.py,sha256=aLY4g1ZUutpcPYd9fc2Qov3S75f_lHduWSfpXD_2wSM,590
+custardpy-0.4.0.data/scripts/convert_JuicerDump_to_dense.py,sha256=c-gznLRUWjmUxLNel4xBJy4UqzfF-DXvHsqfTlwlTI4,2669
+custardpy-0.4.0.data/scripts/drawSquareMulti,sha256=CglmEyROocAEthLY5JfDY3O9vPD0gxyroqEkw4gdZjM,4018
+custardpy-0.4.0.data/scripts/drawSquarePair,sha256=-GFkF5IujV86-BCfp1L87npPrlKhixjR4AoIHVddm90,2805
+custardpy-0.4.0.data/scripts/drawSquareRatioMulti,sha256=Xj6t0xLuR1RCOJp0DgYwTVkfKjOFRmtSF-_BbVL9Ll8,3084
+custardpy-0.4.0.data/scripts/drawSquareRatioPair,sha256=cb3onEni6Btnfmvjg0qqdanU_zMRlwIkLSqUej0RDpU,2550
+custardpy-0.4.0.data/scripts/drawTriangleMulti,sha256=qjAmS69euSMRFGgkSv0UXRPvfVrnJatCVQgP9Gvx_w4,4217
+custardpy-0.4.0.data/scripts/drawTrianglePair,sha256=bMr9g_0jihotOc5Bt3p4tLwXo3s06fK4gCkW-ivUwAo,3572
+custardpy-0.4.0.data/scripts/getBoundaryfromInsulationScore,sha256=va6VuB9hXSHYVY15NceZoZz7PBrVn6w5uArvUh7mrlI,1177
+custardpy-0.4.0.data/scripts/plotCompartmentGenome,sha256=bqLM1O4yAGCsrvPyaGvmkq1rsc3NR9V6j6rTbXmX0co,2326
+custardpy-0.4.0.data/scripts/plotHiCMatrix,sha256=X2_vom3RWL3NVH9gqkHcCm2yg5W2nAF4qItHE1P7uAE,931
+custardpy-0.4.0.data/scripts/plotHiCfeature,sha256=F5LgkWMMpioxETU78BbiGotrue41HOoDs73O1bQTtd0,23454
+custardpy-0.4.0.data/scripts/plotInsulationScore,sha256=pWWgN9haZ_YYeZz5vVftbLzJI8bqoIx9Y8VB4bR9hak,1436
+custardpy-0.4.0.data/scripts/plotMultiScaleInsulationScore,sha256=xEUaByR9xa1mzYICBl5V7sraup6Xna-24gCuqEJN8GI,1199
+custardpy-0.4.0.dist-info/METADATA,sha256=qQqpgNpdNvuEgoxV_G6MztDSNLfMZ6JN78rMDeMfp7I,3294
+custardpy-0.4.0.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+custardpy-0.4.0.dist-info/top_level.txt,sha256=FQEyEhVh5ak4j-9SgLBKkvJ9VMvz2ckZQcaBHR5_10E,10
+custardpy-0.4.0.dist-info/RECORD,,
```

