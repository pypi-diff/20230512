# Comparing `tmp/fastremap-1.9.1.tar.gz` & `tmp/fastremap-1.9.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist/fastremap-1.9.1.tar", last modified: Sat Feb 22 05:58:45 2020, max compression
+gzip compressed data, was "dist/fastremap-1.9.2.tar", last modified: Tue Feb 25 04:30:40 2020, max compression
```

## Comparing `fastremap-1.9.1.tar` & `fastremap-1.9.2.tar`

### file list

```diff
@@ -1,26 +1,26 @@
-drwxrwxr-x   0 ws9       (1678) ws9       (1678)        0 2020-02-22 05:58:45.000000 fastremap-1.9.1/
--rw-rw-r--   0 ws9       (1678) ws9       (1678)     7907 2020-02-22 05:43:27.000000 fastremap-1.9.1/ipt.hpp
--rw-rw-r--   0 ws9       (1678) ws9       (1678)  3866844 2020-02-22 05:56:23.000000 fastremap-1.9.1/fastremap.cpp
--rw-rw-r--   0 ws9       (1678) ws9       (1678)     1175 2020-02-14 22:58:56.000000 fastremap-1.9.1/Dockerfile
--rw-rw-r--   0 ws9       (1678) ws9       (1678)     1091 2019-02-13 07:38:00.000000 fastremap-1.9.1/.travis.yml
--rw-rw-r--   0 ws9       (1678) ws9       (1678)       52 2020-02-22 05:58:45.000000 fastremap-1.9.1/AUTHORS
--rw-rw-r--   0 ws9       (1678) ws9       (1678)     1262 2019-02-13 07:57:54.000000 fastremap-1.9.1/test.cpp
-drwxrwxr-x   0 ws9       (1678) ws9       (1678)        0 2020-02-22 05:58:45.000000 fastremap-1.9.1/fastremap.egg-info/
--rw-rw-r--   0 ws9       (1678) ws9       (1678)       46 2020-02-22 05:58:45.000000 fastremap-1.9.1/fastremap.egg-info/pbr.json
--rw-rw-r--   0 ws9       (1678) ws9       (1678)        6 2020-02-22 05:58:45.000000 fastremap-1.9.1/fastremap.egg-info/requires.txt
--rw-rw-r--   0 ws9       (1678) ws9       (1678)       10 2020-02-22 05:58:45.000000 fastremap-1.9.1/fastremap.egg-info/top_level.txt
--rw-rw-r--   0 ws9       (1678) ws9       (1678)     9617 2020-02-22 05:58:45.000000 fastremap-1.9.1/fastremap.egg-info/PKG-INFO
--rw-rw-r--   0 ws9       (1678) ws9       (1678)      410 2020-02-22 05:58:45.000000 fastremap-1.9.1/fastremap.egg-info/SOURCES.txt
--rw-rw-r--   0 ws9       (1678) ws9       (1678)        1 2019-01-22 02:31:21.000000 fastremap-1.9.1/fastremap.egg-info/not-zip-safe
--rw-rw-r--   0 ws9       (1678) ws9       (1678)        1 2020-02-22 05:58:45.000000 fastremap-1.9.1/fastremap.egg-info/dependency_links.txt
--rw-rw-r--   0 ws9       (1678) ws9       (1678)       19 2019-01-16 22:38:16.000000 fastremap-1.9.1/requirements_dev.txt
--rw-rw-r--   0 ws9       (1678) ws9       (1678)     9617 2020-02-22 05:58:45.000000 fastremap-1.9.1/PKG-INFO
--rw-rw-r--   0 ws9       (1678) ws9       (1678)     3016 2020-02-22 05:58:45.000000 fastremap-1.9.1/ChangeLog
--rw-rw-r--   0 ws9       (1678) ws9       (1678)     7324 2020-02-14 22:58:32.000000 fastremap-1.9.1/README.md
--rw-rw-r--   0 ws9       (1678) ws9       (1678)    25448 2020-02-22 05:56:14.000000 fastremap-1.9.1/fastremap.pyx
--rw-rw-r--   0 ws9       (1678) ws9       (1678)        6 2019-02-13 07:57:54.000000 fastremap-1.9.1/requirements.txt
--rw-rw-r--   0 ws9       (1678) ws9       (1678)      782 2019-08-20 23:29:58.000000 fastremap-1.9.1/setup.py
--rw-rw-r--   0 ws9       (1678) ws9       (1678)    15092 2020-02-14 22:58:32.000000 fastremap-1.9.1/automated_test.py
--rw-rw-r--   0 ws9       (1678) ws9       (1678)     7652 2019-01-16 23:01:36.000000 fastremap-1.9.1/LICENSE
--rw-rw-r--   0 ws9       (1678) ws9       (1678)      387 2020-02-14 22:53:30.000000 fastremap-1.9.1/test.py
--rw-rw-r--   0 ws9       (1678) ws9       (1678)      924 2020-02-22 05:58:45.000000 fastremap-1.9.1/setup.cfg
+drwxrwxr-x   0 ws9       (1678) ws9       (1678)        0 2020-02-25 04:30:40.000000 fastremap-1.9.2/
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)     7907 2020-02-22 05:43:27.000000 fastremap-1.9.2/ipt.hpp
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)  3916509 2020-02-25 04:28:17.000000 fastremap-1.9.2/fastremap.cpp
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)     1175 2020-02-14 22:58:56.000000 fastremap-1.9.2/Dockerfile
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)     1091 2019-02-13 07:38:00.000000 fastremap-1.9.2/.travis.yml
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)       52 2020-02-25 04:30:40.000000 fastremap-1.9.2/AUTHORS
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)     1262 2019-02-13 07:57:54.000000 fastremap-1.9.2/test.cpp
+drwxrwxr-x   0 ws9       (1678) ws9       (1678)        0 2020-02-25 04:30:40.000000 fastremap-1.9.2/fastremap.egg-info/
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)       46 2020-02-25 04:30:40.000000 fastremap-1.9.2/fastremap.egg-info/pbr.json
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)        6 2020-02-25 04:30:40.000000 fastremap-1.9.2/fastremap.egg-info/requires.txt
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)       10 2020-02-25 04:30:40.000000 fastremap-1.9.2/fastremap.egg-info/top_level.txt
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)     9617 2020-02-25 04:30:40.000000 fastremap-1.9.2/fastremap.egg-info/PKG-INFO
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)      410 2020-02-25 04:30:40.000000 fastremap-1.9.2/fastremap.egg-info/SOURCES.txt
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)        1 2019-01-22 02:31:21.000000 fastremap-1.9.2/fastremap.egg-info/not-zip-safe
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)        1 2020-02-25 04:30:40.000000 fastremap-1.9.2/fastremap.egg-info/dependency_links.txt
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)       19 2019-01-16 22:38:16.000000 fastremap-1.9.2/requirements_dev.txt
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)     9617 2020-02-25 04:30:40.000000 fastremap-1.9.2/PKG-INFO
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)     3127 2020-02-25 04:30:40.000000 fastremap-1.9.2/ChangeLog
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)     7324 2020-02-14 22:58:32.000000 fastremap-1.9.2/README.md
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)    25666 2020-02-25 04:28:11.000000 fastremap-1.9.2/fastremap.pyx
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)        6 2019-02-13 07:57:54.000000 fastremap-1.9.2/requirements.txt
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)      782 2019-08-20 23:29:58.000000 fastremap-1.9.2/setup.py
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)    15092 2020-02-14 22:58:32.000000 fastremap-1.9.2/automated_test.py
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)     7652 2019-01-16 23:01:36.000000 fastremap-1.9.2/LICENSE
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)     1023 2020-02-25 04:26:45.000000 fastremap-1.9.2/test.py
+-rw-rw-r--   0 ws9       (1678) ws9       (1678)      924 2020-02-25 04:30:40.000000 fastremap-1.9.2/setup.cfg
```

### Comparing `fastremap-1.9.1/ipt.hpp` & `fastremap-1.9.2/ipt.hpp`

 * *Files identical despite different names*

### Comparing `fastremap-1.9.1/fastremap.cpp` & `fastremap-1.9.2/fastremap.cpp`

 * *Files 1% similar despite different names*

```diff
@@ -2755,15 +2755,15 @@
 static const char __pyx_k_sort[] = "sort";
 static const char __pyx_k_step[] = "step";
 static const char __pyx_k_stop[] = "stop";
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_uniq[] = "uniq";
 static const char __pyx_k_vals[] = "vals";
 static const char __pyx_k_view[] = "view";
-static const char __pyx_k_1_9_1[] = "1.9.1";
+static const char __pyx_k_1_9_2[] = "1.9.2";
 static const char __pyx_k_ASCII[] = "ASCII";
 static const char __pyx_k_accum[] = "accum";
 static const char __pyx_k_array[] = "array";
 static const char __pyx_k_class[] = "__class__";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_finfo[] = "finfo";
@@ -2869,14 +2869,15 @@
 static const char __pyx_k_functools[] = "functools";
 static const char __pyx_k_last_elem[] = "last_elem";
 static const char __pyx_k_max_label[] = "max_label";
 static const char __pyx_k_max_value[] = "max_value";
 static const char __pyx_k_min_label[] = "min_label";
 static const char __pyx_k_min_value[] = "min_value";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
+static const char __pyx_k_real_size[] = "real_size";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
 static const char __pyx_k_seq_dtype[] = "seq_dtype";
 static const char __pyx_k_transpose[] = "transpose";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
 static const char __pyx_k_as_strided[] = "as_strided";
 static const char __pyx_k_issubdtype[] = "issubdtype";
@@ -2967,15 +2968,15 @@
 static const char __pyx_k_got_differing_extents_in_dimensi[] = "got differing extents in dimension %d (got %d and %d)";
 static const char __pyx_k_ndarray_is_not_Fortran_contiguou[] = "ndarray is not Fortran contiguous";
 static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
 static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
 static const char __pyx_k_unable_to_allocate_shape_and_str[] = "unable to allocate shape and strides.";
 static const char __pyx_k_Format_string_allocated_too_shor_2[] = "Format string allocated too short.";
 static PyObject *__pyx_kp_s_;
-static PyObject *__pyx_kp_u_1_9_1;
+static PyObject *__pyx_kp_u_1_9_2;
 static PyObject *__pyx_n_s_ASCII;
 static PyObject *__pyx_kp_s_Buffer_view_does_not_expose_stri;
 static PyObject *__pyx_n_u_C;
 static PyObject *__pyx_n_u_C_CONTIGUOUS;
 static PyObject *__pyx_kp_s_Can_only_create_a_buffer_that_is;
 static PyObject *__pyx_kp_s_Cannot_assign_to_read_only_memor;
 static PyObject *__pyx_kp_s_Cannot_create_writable_memory_vi;
@@ -3155,14 +3156,15 @@
 static PyObject *__pyx_n_s_pyx_result;
 static PyObject *__pyx_n_s_pyx_state;
 static PyObject *__pyx_n_s_pyx_type;
 static PyObject *__pyx_n_s_pyx_unpickle_Enum;
 static PyObject *__pyx_n_s_pyx_vtable;
 static PyObject *__pyx_n_s_range;
 static PyObject *__pyx_n_s_real;
+static PyObject *__pyx_n_s_real_size;
 static PyObject *__pyx_n_s_reduce;
 static PyObject *__pyx_n_s_reduce_2;
 static PyObject *__pyx_n_s_reduce_cython;
 static PyObject *__pyx_n_s_reduce_ex;
 static PyObject *__pyx_n_s_refit;
 static PyObject *__pyx_n_s_remap;
 static PyObject *__pyx_n_s_remap_2;
@@ -47738,20 +47740,26 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_9fastremap_202unique_via_array(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_labels, size_t __pyx_v_max_label) {
   PyArrayObject *__pyx_v_counts = 0;
   size_t __pyx_v_voxels;
   size_t __pyx_v_i;
-  PyObject *__pyx_v_segids = 0;
-  PyObject *__pyx_v_cts = 0;
+  size_t __pyx_v_real_size;
+  PyArrayObject *__pyx_v_segids = 0;
+  PyArrayObject *__pyx_v_cts = 0;
+  size_t __pyx_v_j;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_counts;
   __Pyx_Buffer __pyx_pybuffer_counts;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_cts;
+  __Pyx_Buffer __pyx_pybuffer_cts;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_labels;
   __Pyx_Buffer __pyx_pybuffer_labels;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_segids;
+  __Pyx_Buffer __pyx_pybuffer_segids;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
@@ -47759,22 +47767,33 @@
   size_t __pyx_t_7;
   size_t __pyx_t_8;
   size_t __pyx_t_9;
   size_t __pyx_t_10;
   size_t __pyx_t_11;
   size_t __pyx_t_12;
   int __pyx_t_13;
-  int __pyx_t_14;
-  size_t __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
+  PyArrayObject *__pyx_t_14 = NULL;
+  PyArrayObject *__pyx_t_15 = NULL;
+  size_t __pyx_t_16;
+  size_t __pyx_t_17;
+  size_t __pyx_t_18;
+  size_t __pyx_t_19;
   __Pyx_RefNannySetupContext("__pyx_fuse_0unique_via_array", 0);
   __pyx_pybuffer_counts.pybuffer.buf = NULL;
   __pyx_pybuffer_counts.refcount = 0;
   __pyx_pybuffernd_counts.data = NULL;
   __pyx_pybuffernd_counts.rcbuffer = &__pyx_pybuffer_counts;
+  __pyx_pybuffer_segids.pybuffer.buf = NULL;
+  __pyx_pybuffer_segids.refcount = 0;
+  __pyx_pybuffernd_segids.data = NULL;
+  __pyx_pybuffernd_segids.rcbuffer = &__pyx_pybuffer_segids;
+  __pyx_pybuffer_cts.pybuffer.buf = NULL;
+  __pyx_pybuffer_cts.refcount = 0;
+  __pyx_pybuffernd_cts.data = NULL;
+  __pyx_pybuffernd_cts.rcbuffer = &__pyx_pybuffer_cts;
   __pyx_pybuffer_labels.pybuffer.buf = NULL;
   __pyx_pybuffer_labels.refcount = 0;
   __pyx_pybuffernd_labels.data = NULL;
   __pyx_pybuffernd_labels.rcbuffer = &__pyx_pybuffer_labels;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_labels.rcbuffer->pybuffer, (PyObject*)__pyx_v_labels, &__Pyx_TypeInfo_nn_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 689, __pyx_L1_error)
@@ -47896,166 +47915,327 @@
     __pyx_v_i = __pyx_t_9;
 
     /* "fastremap.pyx":704
  *   cdef size_t i = 0
  *   for i in range(voxels):
  *     counts[labels[i]] += 1             # <<<<<<<<<<<<<<
  * 
- *   cdef list segids = []
+ *   cdef size_t real_size = 0
  */
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = (*__Pyx_BufPtrStrided1d(uint8_t *, __pyx_pybuffernd_labels.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_labels.diminfo[0].strides));
     *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_counts.diminfo[0].strides) += 1;
   }
 
   /* "fastremap.pyx":706
  *     counts[labels[i]] += 1
  * 
- *   cdef list segids = []             # <<<<<<<<<<<<<<
- *   cdef list cts = []
- * 
- */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_segids = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "fastremap.pyx":707
- * 
- *   cdef list segids = []
- *   cdef list cts = []             # <<<<<<<<<<<<<<
- * 
+ *   cdef size_t real_size = 0             # <<<<<<<<<<<<<<
  *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_cts = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
+  __pyx_v_real_size = 0;
 
-  /* "fastremap.pyx":709
- *   cdef list cts = []
+  /* "fastremap.pyx":707
  * 
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
  *     if counts[i] > 0:
- *       segids.append(i)
+ *       real_size += 1
  */
   __pyx_t_7 = (__pyx_v_max_label + 1);
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "fastremap.pyx":710
- * 
+    /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     __pyx_t_12 = __pyx_v_i;
     __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
     if (__pyx_t_13) {
 
-      /* "fastremap.pyx":711
+      /* "fastremap.pyx":709
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:
- *       segids.append(i)             # <<<<<<<<<<<<<<
- *       cts.append(counts[i])
+ *       real_size += 1             # <<<<<<<<<<<<<<
  * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
  */
-      __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_segids, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_v_real_size = (__pyx_v_real_size + 1);
 
-      /* "fastremap.pyx":712
- *     if counts[i] > 0:
- *       segids.append(i)
- *       cts.append(counts[i])             # <<<<<<<<<<<<<<
- * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
- */
-      __pyx_t_15 = __pyx_v_i;
-      __pyx_t_5 = __Pyx_PyInt_From_uint32_t((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_counts.diminfo[0].strides))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_cts, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-      /* "fastremap.pyx":710
- * 
+      /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     }
   }
 
-  /* "fastremap.pyx":714
- *       cts.append(counts[i])
+  /* "fastremap.pyx":711
+ *       real_size += 1
  * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)             # <<<<<<<<<<<<<<
- * 
- * def transpose(arr):
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
  */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(__pyx_v_segids);
-  __Pyx_GIVEREF(__pyx_v_segids);
-  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_segids);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 711, __pyx_L1_error)
+  __pyx_t_14 = ((PyArrayObject *)__pyx_t_2);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_segids.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_segids = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 711, __pyx_L1_error)
+    } else {__pyx_pybuffernd_segids.diminfo[0].strides = __pyx_pybuffernd_segids.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_segids.diminfo[0].shape = __pyx_pybuffernd_segids.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_14 = 0;
+  __pyx_v_segids = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_v_cts);
-  __Pyx_GIVEREF(__pyx_v_cts);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_cts);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint32); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_16) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_16);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_16);
-  __pyx_t_2 = 0;
-  __pyx_t_16 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_15 = ((PyArrayObject *)__pyx_t_4);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cts.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_cts = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 714, __pyx_L1_error)
+    } else {__pyx_pybuffernd_cts.diminfo[0].strides = __pyx_pybuffernd_cts.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cts.diminfo[0].shape = __pyx_pybuffernd_cts.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_15 = 0;
+  __pyx_v_cts = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_4 = 0;
+
+  /* "fastremap.pyx":718
+ *   )
+ * 
+ *   cdef size_t j = 0             # <<<<<<<<<<<<<<
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ */
+  __pyx_v_j = 0;
+
+  /* "fastremap.pyx":719
+ * 
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ */
+  __pyx_t_7 = (__pyx_v_max_label + 1);
+  __pyx_t_8 = __pyx_t_7;
+  for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
+    __pyx_v_i = __pyx_t_9;
+
+    /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    __pyx_t_16 = __pyx_v_i;
+    __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
+    if (__pyx_t_13) {
+
+      /* "fastremap.pyx":721
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ *       segids[j] = i             # <<<<<<<<<<<<<<
+ *       cts[j] = counts[i]
+ *       j += 1
+ */
+      __pyx_t_17 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint8_t *, __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_segids.diminfo[0].strides) = __pyx_v_i;
+
+      /* "fastremap.pyx":722
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ *       cts[j] = counts[i]             # <<<<<<<<<<<<<<
+ *       j += 1
+ * 
+ */
+      __pyx_t_18 = __pyx_v_i;
+      __pyx_t_19 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_cts.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_counts.diminfo[0].strides));
+
+      /* "fastremap.pyx":723
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ *       j += 1             # <<<<<<<<<<<<<<
+ * 
+ *   return segids, cts
+ */
+      __pyx_v_j = (__pyx_v_j + 1);
+
+      /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    }
+  }
+
+  /* "fastremap.pyx":725
+ *       j += 1
+ * 
+ *   return segids, cts             # <<<<<<<<<<<<<<
+ * 
+ * def transpose(arr):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_INCREF(((PyObject *)__pyx_v_segids));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_segids));
+  PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_segids));
+  __Pyx_INCREF(((PyObject *)__pyx_v_cts));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_cts));
+  PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_cts));
+  __pyx_r = __pyx_t_4;
+  __pyx_t_4 = 0;
   goto __pyx_L0;
 
   /* "fastremap.pyx":689
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * @cython.nonecheck(False)
  * def unique_via_array(cnp.ndarray[ALLINT, ndim=1] labels, size_t max_label):             # <<<<<<<<<<<<<<
  *   """
@@ -48065,32 +48245,35 @@
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_16);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
   __Pyx_AddTraceback("fastremap.unique_via_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_counts);
-  __Pyx_XDECREF(__pyx_v_segids);
-  __Pyx_XDECREF(__pyx_v_cts);
+  __Pyx_XDECREF((PyObject *)__pyx_v_segids);
+  __Pyx_XDECREF((PyObject *)__pyx_v_cts);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_fuse_1__pyx_pw_9fastremap_205unique_via_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
@@ -48159,20 +48342,26 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_9fastremap_204unique_via_array(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_labels, size_t __pyx_v_max_label) {
   PyArrayObject *__pyx_v_counts = 0;
   size_t __pyx_v_voxels;
   size_t __pyx_v_i;
-  PyObject *__pyx_v_segids = 0;
-  PyObject *__pyx_v_cts = 0;
+  size_t __pyx_v_real_size;
+  PyArrayObject *__pyx_v_segids = 0;
+  PyArrayObject *__pyx_v_cts = 0;
+  size_t __pyx_v_j;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_counts;
   __Pyx_Buffer __pyx_pybuffer_counts;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_cts;
+  __Pyx_Buffer __pyx_pybuffer_cts;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_labels;
   __Pyx_Buffer __pyx_pybuffer_labels;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_segids;
+  __Pyx_Buffer __pyx_pybuffer_segids;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
@@ -48180,22 +48369,33 @@
   size_t __pyx_t_7;
   size_t __pyx_t_8;
   size_t __pyx_t_9;
   size_t __pyx_t_10;
   size_t __pyx_t_11;
   size_t __pyx_t_12;
   int __pyx_t_13;
-  int __pyx_t_14;
-  size_t __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
+  PyArrayObject *__pyx_t_14 = NULL;
+  PyArrayObject *__pyx_t_15 = NULL;
+  size_t __pyx_t_16;
+  size_t __pyx_t_17;
+  size_t __pyx_t_18;
+  size_t __pyx_t_19;
   __Pyx_RefNannySetupContext("__pyx_fuse_1unique_via_array", 0);
   __pyx_pybuffer_counts.pybuffer.buf = NULL;
   __pyx_pybuffer_counts.refcount = 0;
   __pyx_pybuffernd_counts.data = NULL;
   __pyx_pybuffernd_counts.rcbuffer = &__pyx_pybuffer_counts;
+  __pyx_pybuffer_segids.pybuffer.buf = NULL;
+  __pyx_pybuffer_segids.refcount = 0;
+  __pyx_pybuffernd_segids.data = NULL;
+  __pyx_pybuffernd_segids.rcbuffer = &__pyx_pybuffer_segids;
+  __pyx_pybuffer_cts.pybuffer.buf = NULL;
+  __pyx_pybuffer_cts.refcount = 0;
+  __pyx_pybuffernd_cts.data = NULL;
+  __pyx_pybuffernd_cts.rcbuffer = &__pyx_pybuffer_cts;
   __pyx_pybuffer_labels.pybuffer.buf = NULL;
   __pyx_pybuffer_labels.refcount = 0;
   __pyx_pybuffernd_labels.data = NULL;
   __pyx_pybuffernd_labels.rcbuffer = &__pyx_pybuffer_labels;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_labels.rcbuffer->pybuffer, (PyObject*)__pyx_v_labels, &__Pyx_TypeInfo_nn_uint16_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 689, __pyx_L1_error)
@@ -48317,166 +48517,327 @@
     __pyx_v_i = __pyx_t_9;
 
     /* "fastremap.pyx":704
  *   cdef size_t i = 0
  *   for i in range(voxels):
  *     counts[labels[i]] += 1             # <<<<<<<<<<<<<<
  * 
- *   cdef list segids = []
+ *   cdef size_t real_size = 0
  */
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = (*__Pyx_BufPtrStrided1d(uint16_t *, __pyx_pybuffernd_labels.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_labels.diminfo[0].strides));
     *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_counts.diminfo[0].strides) += 1;
   }
 
   /* "fastremap.pyx":706
  *     counts[labels[i]] += 1
  * 
- *   cdef list segids = []             # <<<<<<<<<<<<<<
- *   cdef list cts = []
- * 
- */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_segids = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "fastremap.pyx":707
- * 
- *   cdef list segids = []
- *   cdef list cts = []             # <<<<<<<<<<<<<<
- * 
+ *   cdef size_t real_size = 0             # <<<<<<<<<<<<<<
  *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_cts = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
+  __pyx_v_real_size = 0;
 
-  /* "fastremap.pyx":709
- *   cdef list cts = []
+  /* "fastremap.pyx":707
  * 
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
  *     if counts[i] > 0:
- *       segids.append(i)
+ *       real_size += 1
  */
   __pyx_t_7 = (__pyx_v_max_label + 1);
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "fastremap.pyx":710
- * 
+    /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     __pyx_t_12 = __pyx_v_i;
     __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
     if (__pyx_t_13) {
 
-      /* "fastremap.pyx":711
+      /* "fastremap.pyx":709
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:
- *       segids.append(i)             # <<<<<<<<<<<<<<
- *       cts.append(counts[i])
+ *       real_size += 1             # <<<<<<<<<<<<<<
  * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
  */
-      __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_segids, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_v_real_size = (__pyx_v_real_size + 1);
 
-      /* "fastremap.pyx":712
- *     if counts[i] > 0:
- *       segids.append(i)
- *       cts.append(counts[i])             # <<<<<<<<<<<<<<
- * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
- */
-      __pyx_t_15 = __pyx_v_i;
-      __pyx_t_5 = __Pyx_PyInt_From_uint32_t((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_counts.diminfo[0].strides))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_cts, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-      /* "fastremap.pyx":710
- * 
+      /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     }
   }
 
-  /* "fastremap.pyx":714
- *       cts.append(counts[i])
- * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)             # <<<<<<<<<<<<<<
+  /* "fastremap.pyx":711
+ *       real_size += 1
  * 
- * def transpose(arr):
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
  */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(__pyx_v_segids);
-  __Pyx_GIVEREF(__pyx_v_segids);
-  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_segids);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 711, __pyx_L1_error)
+  __pyx_t_14 = ((PyArrayObject *)__pyx_t_2);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_segids.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn_uint16_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_segids = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 711, __pyx_L1_error)
+    } else {__pyx_pybuffernd_segids.diminfo[0].strides = __pyx_pybuffernd_segids.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_segids.diminfo[0].shape = __pyx_pybuffernd_segids.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_14 = 0;
+  __pyx_v_segids = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_v_cts);
-  __Pyx_GIVEREF(__pyx_v_cts);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_cts);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint32); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_16) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_16);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_16);
-  __pyx_t_2 = 0;
-  __pyx_t_16 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_15 = ((PyArrayObject *)__pyx_t_4);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cts.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_cts = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 714, __pyx_L1_error)
+    } else {__pyx_pybuffernd_cts.diminfo[0].strides = __pyx_pybuffernd_cts.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cts.diminfo[0].shape = __pyx_pybuffernd_cts.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_15 = 0;
+  __pyx_v_cts = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_4 = 0;
+
+  /* "fastremap.pyx":718
+ *   )
+ * 
+ *   cdef size_t j = 0             # <<<<<<<<<<<<<<
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ */
+  __pyx_v_j = 0;
+
+  /* "fastremap.pyx":719
+ * 
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ */
+  __pyx_t_7 = (__pyx_v_max_label + 1);
+  __pyx_t_8 = __pyx_t_7;
+  for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
+    __pyx_v_i = __pyx_t_9;
+
+    /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    __pyx_t_16 = __pyx_v_i;
+    __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
+    if (__pyx_t_13) {
+
+      /* "fastremap.pyx":721
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ *       segids[j] = i             # <<<<<<<<<<<<<<
+ *       cts[j] = counts[i]
+ *       j += 1
+ */
+      __pyx_t_17 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint16_t *, __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_segids.diminfo[0].strides) = __pyx_v_i;
+
+      /* "fastremap.pyx":722
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ *       cts[j] = counts[i]             # <<<<<<<<<<<<<<
+ *       j += 1
+ * 
+ */
+      __pyx_t_18 = __pyx_v_i;
+      __pyx_t_19 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_cts.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_counts.diminfo[0].strides));
+
+      /* "fastremap.pyx":723
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ *       j += 1             # <<<<<<<<<<<<<<
+ * 
+ *   return segids, cts
+ */
+      __pyx_v_j = (__pyx_v_j + 1);
+
+      /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    }
+  }
+
+  /* "fastremap.pyx":725
+ *       j += 1
+ * 
+ *   return segids, cts             # <<<<<<<<<<<<<<
+ * 
+ * def transpose(arr):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_INCREF(((PyObject *)__pyx_v_segids));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_segids));
+  PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_segids));
+  __Pyx_INCREF(((PyObject *)__pyx_v_cts));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_cts));
+  PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_cts));
+  __pyx_r = __pyx_t_4;
+  __pyx_t_4 = 0;
   goto __pyx_L0;
 
   /* "fastremap.pyx":689
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * @cython.nonecheck(False)
  * def unique_via_array(cnp.ndarray[ALLINT, ndim=1] labels, size_t max_label):             # <<<<<<<<<<<<<<
  *   """
@@ -48486,32 +48847,35 @@
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_16);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
   __Pyx_AddTraceback("fastremap.unique_via_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_counts);
-  __Pyx_XDECREF(__pyx_v_segids);
-  __Pyx_XDECREF(__pyx_v_cts);
+  __Pyx_XDECREF((PyObject *)__pyx_v_segids);
+  __Pyx_XDECREF((PyObject *)__pyx_v_cts);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_fuse_2__pyx_pw_9fastremap_207unique_via_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
@@ -48580,20 +48944,26 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_9fastremap_206unique_via_array(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_labels, size_t __pyx_v_max_label) {
   PyArrayObject *__pyx_v_counts = 0;
   size_t __pyx_v_voxels;
   size_t __pyx_v_i;
-  PyObject *__pyx_v_segids = 0;
-  PyObject *__pyx_v_cts = 0;
+  size_t __pyx_v_real_size;
+  PyArrayObject *__pyx_v_segids = 0;
+  PyArrayObject *__pyx_v_cts = 0;
+  size_t __pyx_v_j;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_counts;
   __Pyx_Buffer __pyx_pybuffer_counts;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_cts;
+  __Pyx_Buffer __pyx_pybuffer_cts;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_labels;
   __Pyx_Buffer __pyx_pybuffer_labels;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_segids;
+  __Pyx_Buffer __pyx_pybuffer_segids;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
@@ -48601,22 +48971,33 @@
   size_t __pyx_t_7;
   size_t __pyx_t_8;
   size_t __pyx_t_9;
   size_t __pyx_t_10;
   size_t __pyx_t_11;
   size_t __pyx_t_12;
   int __pyx_t_13;
-  int __pyx_t_14;
-  size_t __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
+  PyArrayObject *__pyx_t_14 = NULL;
+  PyArrayObject *__pyx_t_15 = NULL;
+  size_t __pyx_t_16;
+  size_t __pyx_t_17;
+  size_t __pyx_t_18;
+  size_t __pyx_t_19;
   __Pyx_RefNannySetupContext("__pyx_fuse_2unique_via_array", 0);
   __pyx_pybuffer_counts.pybuffer.buf = NULL;
   __pyx_pybuffer_counts.refcount = 0;
   __pyx_pybuffernd_counts.data = NULL;
   __pyx_pybuffernd_counts.rcbuffer = &__pyx_pybuffer_counts;
+  __pyx_pybuffer_segids.pybuffer.buf = NULL;
+  __pyx_pybuffer_segids.refcount = 0;
+  __pyx_pybuffernd_segids.data = NULL;
+  __pyx_pybuffernd_segids.rcbuffer = &__pyx_pybuffer_segids;
+  __pyx_pybuffer_cts.pybuffer.buf = NULL;
+  __pyx_pybuffer_cts.refcount = 0;
+  __pyx_pybuffernd_cts.data = NULL;
+  __pyx_pybuffernd_cts.rcbuffer = &__pyx_pybuffer_cts;
   __pyx_pybuffer_labels.pybuffer.buf = NULL;
   __pyx_pybuffer_labels.refcount = 0;
   __pyx_pybuffernd_labels.data = NULL;
   __pyx_pybuffernd_labels.rcbuffer = &__pyx_pybuffer_labels;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_labels.rcbuffer->pybuffer, (PyObject*)__pyx_v_labels, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 689, __pyx_L1_error)
@@ -48738,166 +49119,327 @@
     __pyx_v_i = __pyx_t_9;
 
     /* "fastremap.pyx":704
  *   cdef size_t i = 0
  *   for i in range(voxels):
  *     counts[labels[i]] += 1             # <<<<<<<<<<<<<<
  * 
- *   cdef list segids = []
+ *   cdef size_t real_size = 0
  */
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = (*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_labels.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_labels.diminfo[0].strides));
     *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_counts.diminfo[0].strides) += 1;
   }
 
   /* "fastremap.pyx":706
  *     counts[labels[i]] += 1
  * 
- *   cdef list segids = []             # <<<<<<<<<<<<<<
- *   cdef list cts = []
- * 
- */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_segids = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "fastremap.pyx":707
- * 
- *   cdef list segids = []
- *   cdef list cts = []             # <<<<<<<<<<<<<<
- * 
+ *   cdef size_t real_size = 0             # <<<<<<<<<<<<<<
  *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_cts = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
+  __pyx_v_real_size = 0;
 
-  /* "fastremap.pyx":709
- *   cdef list cts = []
+  /* "fastremap.pyx":707
  * 
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
  *     if counts[i] > 0:
- *       segids.append(i)
+ *       real_size += 1
  */
   __pyx_t_7 = (__pyx_v_max_label + 1);
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "fastremap.pyx":710
- * 
+    /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     __pyx_t_12 = __pyx_v_i;
     __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
     if (__pyx_t_13) {
 
-      /* "fastremap.pyx":711
+      /* "fastremap.pyx":709
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:
- *       segids.append(i)             # <<<<<<<<<<<<<<
- *       cts.append(counts[i])
+ *       real_size += 1             # <<<<<<<<<<<<<<
  * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
  */
-      __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_segids, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_v_real_size = (__pyx_v_real_size + 1);
 
-      /* "fastremap.pyx":712
- *     if counts[i] > 0:
- *       segids.append(i)
- *       cts.append(counts[i])             # <<<<<<<<<<<<<<
- * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
- */
-      __pyx_t_15 = __pyx_v_i;
-      __pyx_t_5 = __Pyx_PyInt_From_uint32_t((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_counts.diminfo[0].strides))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_cts, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-      /* "fastremap.pyx":710
- * 
+      /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     }
   }
 
-  /* "fastremap.pyx":714
- *       cts.append(counts[i])
- * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)             # <<<<<<<<<<<<<<
+  /* "fastremap.pyx":711
+ *       real_size += 1
  * 
- * def transpose(arr):
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
  */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(__pyx_v_segids);
-  __Pyx_GIVEREF(__pyx_v_segids);
-  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_segids);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 711, __pyx_L1_error)
+  __pyx_t_14 = ((PyArrayObject *)__pyx_t_2);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_segids.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_segids = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 711, __pyx_L1_error)
+    } else {__pyx_pybuffernd_segids.diminfo[0].strides = __pyx_pybuffernd_segids.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_segids.diminfo[0].shape = __pyx_pybuffernd_segids.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_14 = 0;
+  __pyx_v_segids = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_v_cts);
-  __Pyx_GIVEREF(__pyx_v_cts);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_cts);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint32); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_16) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_16);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_16);
-  __pyx_t_2 = 0;
-  __pyx_t_16 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_15 = ((PyArrayObject *)__pyx_t_4);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cts.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_cts = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 714, __pyx_L1_error)
+    } else {__pyx_pybuffernd_cts.diminfo[0].strides = __pyx_pybuffernd_cts.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cts.diminfo[0].shape = __pyx_pybuffernd_cts.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_15 = 0;
+  __pyx_v_cts = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_4 = 0;
+
+  /* "fastremap.pyx":718
+ *   )
+ * 
+ *   cdef size_t j = 0             # <<<<<<<<<<<<<<
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ */
+  __pyx_v_j = 0;
+
+  /* "fastremap.pyx":719
+ * 
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ */
+  __pyx_t_7 = (__pyx_v_max_label + 1);
+  __pyx_t_8 = __pyx_t_7;
+  for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
+    __pyx_v_i = __pyx_t_9;
+
+    /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    __pyx_t_16 = __pyx_v_i;
+    __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
+    if (__pyx_t_13) {
+
+      /* "fastremap.pyx":721
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ *       segids[j] = i             # <<<<<<<<<<<<<<
+ *       cts[j] = counts[i]
+ *       j += 1
+ */
+      __pyx_t_17 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_segids.diminfo[0].strides) = __pyx_v_i;
+
+      /* "fastremap.pyx":722
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ *       cts[j] = counts[i]             # <<<<<<<<<<<<<<
+ *       j += 1
+ * 
+ */
+      __pyx_t_18 = __pyx_v_i;
+      __pyx_t_19 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_cts.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_counts.diminfo[0].strides));
+
+      /* "fastremap.pyx":723
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ *       j += 1             # <<<<<<<<<<<<<<
+ * 
+ *   return segids, cts
+ */
+      __pyx_v_j = (__pyx_v_j + 1);
+
+      /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    }
+  }
+
+  /* "fastremap.pyx":725
+ *       j += 1
+ * 
+ *   return segids, cts             # <<<<<<<<<<<<<<
+ * 
+ * def transpose(arr):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_INCREF(((PyObject *)__pyx_v_segids));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_segids));
+  PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_segids));
+  __Pyx_INCREF(((PyObject *)__pyx_v_cts));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_cts));
+  PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_cts));
+  __pyx_r = __pyx_t_4;
+  __pyx_t_4 = 0;
   goto __pyx_L0;
 
   /* "fastremap.pyx":689
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * @cython.nonecheck(False)
  * def unique_via_array(cnp.ndarray[ALLINT, ndim=1] labels, size_t max_label):             # <<<<<<<<<<<<<<
  *   """
@@ -48907,32 +49449,35 @@
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_16);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
   __Pyx_AddTraceback("fastremap.unique_via_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_counts);
-  __Pyx_XDECREF(__pyx_v_segids);
-  __Pyx_XDECREF(__pyx_v_cts);
+  __Pyx_XDECREF((PyObject *)__pyx_v_segids);
+  __Pyx_XDECREF((PyObject *)__pyx_v_cts);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_fuse_3__pyx_pw_9fastremap_209unique_via_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
@@ -49001,20 +49546,26 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_9fastremap_208unique_via_array(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_labels, size_t __pyx_v_max_label) {
   PyArrayObject *__pyx_v_counts = 0;
   size_t __pyx_v_voxels;
   size_t __pyx_v_i;
-  PyObject *__pyx_v_segids = 0;
-  PyObject *__pyx_v_cts = 0;
+  size_t __pyx_v_real_size;
+  PyArrayObject *__pyx_v_segids = 0;
+  PyArrayObject *__pyx_v_cts = 0;
+  size_t __pyx_v_j;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_counts;
   __Pyx_Buffer __pyx_pybuffer_counts;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_cts;
+  __Pyx_Buffer __pyx_pybuffer_cts;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_labels;
   __Pyx_Buffer __pyx_pybuffer_labels;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_segids;
+  __Pyx_Buffer __pyx_pybuffer_segids;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
@@ -49022,22 +49573,33 @@
   size_t __pyx_t_7;
   size_t __pyx_t_8;
   size_t __pyx_t_9;
   size_t __pyx_t_10;
   uint64_t __pyx_t_11;
   size_t __pyx_t_12;
   int __pyx_t_13;
-  int __pyx_t_14;
-  size_t __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
+  PyArrayObject *__pyx_t_14 = NULL;
+  PyArrayObject *__pyx_t_15 = NULL;
+  size_t __pyx_t_16;
+  size_t __pyx_t_17;
+  size_t __pyx_t_18;
+  size_t __pyx_t_19;
   __Pyx_RefNannySetupContext("__pyx_fuse_3unique_via_array", 0);
   __pyx_pybuffer_counts.pybuffer.buf = NULL;
   __pyx_pybuffer_counts.refcount = 0;
   __pyx_pybuffernd_counts.data = NULL;
   __pyx_pybuffernd_counts.rcbuffer = &__pyx_pybuffer_counts;
+  __pyx_pybuffer_segids.pybuffer.buf = NULL;
+  __pyx_pybuffer_segids.refcount = 0;
+  __pyx_pybuffernd_segids.data = NULL;
+  __pyx_pybuffernd_segids.rcbuffer = &__pyx_pybuffer_segids;
+  __pyx_pybuffer_cts.pybuffer.buf = NULL;
+  __pyx_pybuffer_cts.refcount = 0;
+  __pyx_pybuffernd_cts.data = NULL;
+  __pyx_pybuffernd_cts.rcbuffer = &__pyx_pybuffer_cts;
   __pyx_pybuffer_labels.pybuffer.buf = NULL;
   __pyx_pybuffer_labels.refcount = 0;
   __pyx_pybuffernd_labels.data = NULL;
   __pyx_pybuffernd_labels.rcbuffer = &__pyx_pybuffer_labels;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_labels.rcbuffer->pybuffer, (PyObject*)__pyx_v_labels, &__Pyx_TypeInfo_nn_uint64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 689, __pyx_L1_error)
@@ -49159,166 +49721,327 @@
     __pyx_v_i = __pyx_t_9;
 
     /* "fastremap.pyx":704
  *   cdef size_t i = 0
  *   for i in range(voxels):
  *     counts[labels[i]] += 1             # <<<<<<<<<<<<<<
  * 
- *   cdef list segids = []
+ *   cdef size_t real_size = 0
  */
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = (*__Pyx_BufPtrStrided1d(uint64_t *, __pyx_pybuffernd_labels.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_labels.diminfo[0].strides));
     *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_counts.diminfo[0].strides) += 1;
   }
 
   /* "fastremap.pyx":706
  *     counts[labels[i]] += 1
  * 
- *   cdef list segids = []             # <<<<<<<<<<<<<<
- *   cdef list cts = []
- * 
- */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_segids = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "fastremap.pyx":707
- * 
- *   cdef list segids = []
- *   cdef list cts = []             # <<<<<<<<<<<<<<
- * 
+ *   cdef size_t real_size = 0             # <<<<<<<<<<<<<<
  *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_cts = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
+  __pyx_v_real_size = 0;
 
-  /* "fastremap.pyx":709
- *   cdef list cts = []
+  /* "fastremap.pyx":707
  * 
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
  *     if counts[i] > 0:
- *       segids.append(i)
+ *       real_size += 1
  */
   __pyx_t_7 = (__pyx_v_max_label + 1);
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "fastremap.pyx":710
- * 
+    /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     __pyx_t_12 = __pyx_v_i;
     __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
     if (__pyx_t_13) {
 
-      /* "fastremap.pyx":711
+      /* "fastremap.pyx":709
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:
- *       segids.append(i)             # <<<<<<<<<<<<<<
- *       cts.append(counts[i])
+ *       real_size += 1             # <<<<<<<<<<<<<<
  * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
  */
-      __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_segids, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_v_real_size = (__pyx_v_real_size + 1);
 
-      /* "fastremap.pyx":712
- *     if counts[i] > 0:
- *       segids.append(i)
- *       cts.append(counts[i])             # <<<<<<<<<<<<<<
- * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
- */
-      __pyx_t_15 = __pyx_v_i;
-      __pyx_t_5 = __Pyx_PyInt_From_uint32_t((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_counts.diminfo[0].strides))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_cts, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-      /* "fastremap.pyx":710
- * 
+      /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     }
   }
 
-  /* "fastremap.pyx":714
- *       cts.append(counts[i])
+  /* "fastremap.pyx":711
+ *       real_size += 1
  * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)             # <<<<<<<<<<<<<<
- * 
- * def transpose(arr):
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
  */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(__pyx_v_segids);
-  __Pyx_GIVEREF(__pyx_v_segids);
-  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_segids);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 711, __pyx_L1_error)
+  __pyx_t_14 = ((PyArrayObject *)__pyx_t_2);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_segids.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn_uint64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_segids = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 711, __pyx_L1_error)
+    } else {__pyx_pybuffernd_segids.diminfo[0].strides = __pyx_pybuffernd_segids.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_segids.diminfo[0].shape = __pyx_pybuffernd_segids.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_14 = 0;
+  __pyx_v_segids = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_v_cts);
-  __Pyx_GIVEREF(__pyx_v_cts);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_cts);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint32); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_16) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_16);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_16);
-  __pyx_t_2 = 0;
-  __pyx_t_16 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_15 = ((PyArrayObject *)__pyx_t_4);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cts.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_cts = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 714, __pyx_L1_error)
+    } else {__pyx_pybuffernd_cts.diminfo[0].strides = __pyx_pybuffernd_cts.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cts.diminfo[0].shape = __pyx_pybuffernd_cts.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_15 = 0;
+  __pyx_v_cts = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_4 = 0;
+
+  /* "fastremap.pyx":718
+ *   )
+ * 
+ *   cdef size_t j = 0             # <<<<<<<<<<<<<<
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ */
+  __pyx_v_j = 0;
+
+  /* "fastremap.pyx":719
+ * 
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ */
+  __pyx_t_7 = (__pyx_v_max_label + 1);
+  __pyx_t_8 = __pyx_t_7;
+  for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
+    __pyx_v_i = __pyx_t_9;
+
+    /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    __pyx_t_16 = __pyx_v_i;
+    __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
+    if (__pyx_t_13) {
+
+      /* "fastremap.pyx":721
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ *       segids[j] = i             # <<<<<<<<<<<<<<
+ *       cts[j] = counts[i]
+ *       j += 1
+ */
+      __pyx_t_17 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint64_t *, __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_segids.diminfo[0].strides) = __pyx_v_i;
+
+      /* "fastremap.pyx":722
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ *       cts[j] = counts[i]             # <<<<<<<<<<<<<<
+ *       j += 1
+ * 
+ */
+      __pyx_t_18 = __pyx_v_i;
+      __pyx_t_19 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_cts.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_counts.diminfo[0].strides));
+
+      /* "fastremap.pyx":723
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ *       j += 1             # <<<<<<<<<<<<<<
+ * 
+ *   return segids, cts
+ */
+      __pyx_v_j = (__pyx_v_j + 1);
+
+      /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    }
+  }
+
+  /* "fastremap.pyx":725
+ *       j += 1
+ * 
+ *   return segids, cts             # <<<<<<<<<<<<<<
+ * 
+ * def transpose(arr):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_INCREF(((PyObject *)__pyx_v_segids));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_segids));
+  PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_segids));
+  __Pyx_INCREF(((PyObject *)__pyx_v_cts));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_cts));
+  PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_cts));
+  __pyx_r = __pyx_t_4;
+  __pyx_t_4 = 0;
   goto __pyx_L0;
 
   /* "fastremap.pyx":689
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * @cython.nonecheck(False)
  * def unique_via_array(cnp.ndarray[ALLINT, ndim=1] labels, size_t max_label):             # <<<<<<<<<<<<<<
  *   """
@@ -49328,32 +50051,35 @@
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_16);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
   __Pyx_AddTraceback("fastremap.unique_via_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_counts);
-  __Pyx_XDECREF(__pyx_v_segids);
-  __Pyx_XDECREF(__pyx_v_cts);
+  __Pyx_XDECREF((PyObject *)__pyx_v_segids);
+  __Pyx_XDECREF((PyObject *)__pyx_v_cts);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_fuse_4__pyx_pw_9fastremap_211unique_via_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
@@ -49422,20 +50148,26 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_9fastremap_210unique_via_array(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_labels, size_t __pyx_v_max_label) {
   PyArrayObject *__pyx_v_counts = 0;
   size_t __pyx_v_voxels;
   size_t __pyx_v_i;
-  PyObject *__pyx_v_segids = 0;
-  PyObject *__pyx_v_cts = 0;
+  size_t __pyx_v_real_size;
+  PyArrayObject *__pyx_v_segids = 0;
+  PyArrayObject *__pyx_v_cts = 0;
+  size_t __pyx_v_j;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_counts;
   __Pyx_Buffer __pyx_pybuffer_counts;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_cts;
+  __Pyx_Buffer __pyx_pybuffer_cts;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_labels;
   __Pyx_Buffer __pyx_pybuffer_labels;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_segids;
+  __Pyx_Buffer __pyx_pybuffer_segids;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
@@ -49443,22 +50175,33 @@
   size_t __pyx_t_7;
   size_t __pyx_t_8;
   size_t __pyx_t_9;
   size_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   size_t __pyx_t_12;
   int __pyx_t_13;
-  int __pyx_t_14;
-  size_t __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
+  PyArrayObject *__pyx_t_14 = NULL;
+  PyArrayObject *__pyx_t_15 = NULL;
+  size_t __pyx_t_16;
+  size_t __pyx_t_17;
+  size_t __pyx_t_18;
+  size_t __pyx_t_19;
   __Pyx_RefNannySetupContext("__pyx_fuse_4unique_via_array", 0);
   __pyx_pybuffer_counts.pybuffer.buf = NULL;
   __pyx_pybuffer_counts.refcount = 0;
   __pyx_pybuffernd_counts.data = NULL;
   __pyx_pybuffernd_counts.rcbuffer = &__pyx_pybuffer_counts;
+  __pyx_pybuffer_segids.pybuffer.buf = NULL;
+  __pyx_pybuffer_segids.refcount = 0;
+  __pyx_pybuffernd_segids.data = NULL;
+  __pyx_pybuffernd_segids.rcbuffer = &__pyx_pybuffer_segids;
+  __pyx_pybuffer_cts.pybuffer.buf = NULL;
+  __pyx_pybuffer_cts.refcount = 0;
+  __pyx_pybuffernd_cts.data = NULL;
+  __pyx_pybuffernd_cts.rcbuffer = &__pyx_pybuffer_cts;
   __pyx_pybuffer_labels.pybuffer.buf = NULL;
   __pyx_pybuffer_labels.refcount = 0;
   __pyx_pybuffernd_labels.data = NULL;
   __pyx_pybuffernd_labels.rcbuffer = &__pyx_pybuffer_labels;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_labels.rcbuffer->pybuffer, (PyObject*)__pyx_v_labels, &__Pyx_TypeInfo_nn_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 689, __pyx_L1_error)
@@ -49580,166 +50323,327 @@
     __pyx_v_i = __pyx_t_9;
 
     /* "fastremap.pyx":704
  *   cdef size_t i = 0
  *   for i in range(voxels):
  *     counts[labels[i]] += 1             # <<<<<<<<<<<<<<
  * 
- *   cdef list segids = []
+ *   cdef size_t real_size = 0
  */
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = (*__Pyx_BufPtrStrided1d(int8_t *, __pyx_pybuffernd_labels.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_labels.diminfo[0].strides));
     *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_counts.diminfo[0].strides) += 1;
   }
 
   /* "fastremap.pyx":706
  *     counts[labels[i]] += 1
  * 
- *   cdef list segids = []             # <<<<<<<<<<<<<<
- *   cdef list cts = []
- * 
- */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_segids = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "fastremap.pyx":707
- * 
- *   cdef list segids = []
- *   cdef list cts = []             # <<<<<<<<<<<<<<
- * 
+ *   cdef size_t real_size = 0             # <<<<<<<<<<<<<<
  *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_cts = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
+  __pyx_v_real_size = 0;
 
-  /* "fastremap.pyx":709
- *   cdef list cts = []
+  /* "fastremap.pyx":707
  * 
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
  *     if counts[i] > 0:
- *       segids.append(i)
+ *       real_size += 1
  */
   __pyx_t_7 = (__pyx_v_max_label + 1);
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "fastremap.pyx":710
- * 
+    /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     __pyx_t_12 = __pyx_v_i;
     __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
     if (__pyx_t_13) {
 
-      /* "fastremap.pyx":711
+      /* "fastremap.pyx":709
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:
- *       segids.append(i)             # <<<<<<<<<<<<<<
- *       cts.append(counts[i])
- * 
- */
-      __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_segids, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-      /* "fastremap.pyx":712
- *     if counts[i] > 0:
- *       segids.append(i)
- *       cts.append(counts[i])             # <<<<<<<<<<<<<<
+ *       real_size += 1             # <<<<<<<<<<<<<<
  * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
  */
-      __pyx_t_15 = __pyx_v_i;
-      __pyx_t_5 = __Pyx_PyInt_From_uint32_t((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_counts.diminfo[0].strides))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_cts, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_v_real_size = (__pyx_v_real_size + 1);
 
-      /* "fastremap.pyx":710
- * 
+      /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     }
   }
 
-  /* "fastremap.pyx":714
- *       cts.append(counts[i])
- * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)             # <<<<<<<<<<<<<<
+  /* "fastremap.pyx":711
+ *       real_size += 1
  * 
- * def transpose(arr):
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
  */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(__pyx_v_segids);
-  __Pyx_GIVEREF(__pyx_v_segids);
-  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_segids);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 711, __pyx_L1_error)
+  __pyx_t_14 = ((PyArrayObject *)__pyx_t_2);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_segids.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn_int8_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_segids = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 711, __pyx_L1_error)
+    } else {__pyx_pybuffernd_segids.diminfo[0].strides = __pyx_pybuffernd_segids.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_segids.diminfo[0].shape = __pyx_pybuffernd_segids.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_14 = 0;
+  __pyx_v_segids = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_v_cts);
-  __Pyx_GIVEREF(__pyx_v_cts);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_cts);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint32); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_16) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_16);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_16);
-  __pyx_t_2 = 0;
-  __pyx_t_16 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_15 = ((PyArrayObject *)__pyx_t_4);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cts.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_cts = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 714, __pyx_L1_error)
+    } else {__pyx_pybuffernd_cts.diminfo[0].strides = __pyx_pybuffernd_cts.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cts.diminfo[0].shape = __pyx_pybuffernd_cts.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_15 = 0;
+  __pyx_v_cts = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_4 = 0;
+
+  /* "fastremap.pyx":718
+ *   )
+ * 
+ *   cdef size_t j = 0             # <<<<<<<<<<<<<<
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ */
+  __pyx_v_j = 0;
+
+  /* "fastremap.pyx":719
+ * 
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ */
+  __pyx_t_7 = (__pyx_v_max_label + 1);
+  __pyx_t_8 = __pyx_t_7;
+  for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
+    __pyx_v_i = __pyx_t_9;
+
+    /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    __pyx_t_16 = __pyx_v_i;
+    __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
+    if (__pyx_t_13) {
+
+      /* "fastremap.pyx":721
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ *       segids[j] = i             # <<<<<<<<<<<<<<
+ *       cts[j] = counts[i]
+ *       j += 1
+ */
+      __pyx_t_17 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(int8_t *, __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_segids.diminfo[0].strides) = __pyx_v_i;
+
+      /* "fastremap.pyx":722
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ *       cts[j] = counts[i]             # <<<<<<<<<<<<<<
+ *       j += 1
+ * 
+ */
+      __pyx_t_18 = __pyx_v_i;
+      __pyx_t_19 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_cts.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_counts.diminfo[0].strides));
+
+      /* "fastremap.pyx":723
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ *       j += 1             # <<<<<<<<<<<<<<
+ * 
+ *   return segids, cts
+ */
+      __pyx_v_j = (__pyx_v_j + 1);
+
+      /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    }
+  }
+
+  /* "fastremap.pyx":725
+ *       j += 1
+ * 
+ *   return segids, cts             # <<<<<<<<<<<<<<
+ * 
+ * def transpose(arr):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_INCREF(((PyObject *)__pyx_v_segids));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_segids));
+  PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_segids));
+  __Pyx_INCREF(((PyObject *)__pyx_v_cts));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_cts));
+  PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_cts));
+  __pyx_r = __pyx_t_4;
+  __pyx_t_4 = 0;
   goto __pyx_L0;
 
   /* "fastremap.pyx":689
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * @cython.nonecheck(False)
  * def unique_via_array(cnp.ndarray[ALLINT, ndim=1] labels, size_t max_label):             # <<<<<<<<<<<<<<
  *   """
@@ -49749,32 +50653,35 @@
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_16);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
   __Pyx_AddTraceback("fastremap.unique_via_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_counts);
-  __Pyx_XDECREF(__pyx_v_segids);
-  __Pyx_XDECREF(__pyx_v_cts);
+  __Pyx_XDECREF((PyObject *)__pyx_v_segids);
+  __Pyx_XDECREF((PyObject *)__pyx_v_cts);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_fuse_5__pyx_pw_9fastremap_213unique_via_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
@@ -49843,20 +50750,26 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_9fastremap_212unique_via_array(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_labels, size_t __pyx_v_max_label) {
   PyArrayObject *__pyx_v_counts = 0;
   size_t __pyx_v_voxels;
   size_t __pyx_v_i;
-  PyObject *__pyx_v_segids = 0;
-  PyObject *__pyx_v_cts = 0;
+  size_t __pyx_v_real_size;
+  PyArrayObject *__pyx_v_segids = 0;
+  PyArrayObject *__pyx_v_cts = 0;
+  size_t __pyx_v_j;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_counts;
   __Pyx_Buffer __pyx_pybuffer_counts;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_cts;
+  __Pyx_Buffer __pyx_pybuffer_cts;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_labels;
   __Pyx_Buffer __pyx_pybuffer_labels;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_segids;
+  __Pyx_Buffer __pyx_pybuffer_segids;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
@@ -49864,22 +50777,33 @@
   size_t __pyx_t_7;
   size_t __pyx_t_8;
   size_t __pyx_t_9;
   size_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   size_t __pyx_t_12;
   int __pyx_t_13;
-  int __pyx_t_14;
-  size_t __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
+  PyArrayObject *__pyx_t_14 = NULL;
+  PyArrayObject *__pyx_t_15 = NULL;
+  size_t __pyx_t_16;
+  size_t __pyx_t_17;
+  size_t __pyx_t_18;
+  size_t __pyx_t_19;
   __Pyx_RefNannySetupContext("__pyx_fuse_5unique_via_array", 0);
   __pyx_pybuffer_counts.pybuffer.buf = NULL;
   __pyx_pybuffer_counts.refcount = 0;
   __pyx_pybuffernd_counts.data = NULL;
   __pyx_pybuffernd_counts.rcbuffer = &__pyx_pybuffer_counts;
+  __pyx_pybuffer_segids.pybuffer.buf = NULL;
+  __pyx_pybuffer_segids.refcount = 0;
+  __pyx_pybuffernd_segids.data = NULL;
+  __pyx_pybuffernd_segids.rcbuffer = &__pyx_pybuffer_segids;
+  __pyx_pybuffer_cts.pybuffer.buf = NULL;
+  __pyx_pybuffer_cts.refcount = 0;
+  __pyx_pybuffernd_cts.data = NULL;
+  __pyx_pybuffernd_cts.rcbuffer = &__pyx_pybuffer_cts;
   __pyx_pybuffer_labels.pybuffer.buf = NULL;
   __pyx_pybuffer_labels.refcount = 0;
   __pyx_pybuffernd_labels.data = NULL;
   __pyx_pybuffernd_labels.rcbuffer = &__pyx_pybuffer_labels;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_labels.rcbuffer->pybuffer, (PyObject*)__pyx_v_labels, &__Pyx_TypeInfo_nn_int16_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 689, __pyx_L1_error)
@@ -50001,166 +50925,327 @@
     __pyx_v_i = __pyx_t_9;
 
     /* "fastremap.pyx":704
  *   cdef size_t i = 0
  *   for i in range(voxels):
  *     counts[labels[i]] += 1             # <<<<<<<<<<<<<<
  * 
- *   cdef list segids = []
+ *   cdef size_t real_size = 0
  */
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = (*__Pyx_BufPtrStrided1d(int16_t *, __pyx_pybuffernd_labels.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_labels.diminfo[0].strides));
     *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_counts.diminfo[0].strides) += 1;
   }
 
   /* "fastremap.pyx":706
  *     counts[labels[i]] += 1
  * 
- *   cdef list segids = []             # <<<<<<<<<<<<<<
- *   cdef list cts = []
- * 
- */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_segids = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "fastremap.pyx":707
- * 
- *   cdef list segids = []
- *   cdef list cts = []             # <<<<<<<<<<<<<<
- * 
+ *   cdef size_t real_size = 0             # <<<<<<<<<<<<<<
  *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_cts = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
+  __pyx_v_real_size = 0;
 
-  /* "fastremap.pyx":709
- *   cdef list cts = []
+  /* "fastremap.pyx":707
  * 
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
  *     if counts[i] > 0:
- *       segids.append(i)
+ *       real_size += 1
  */
   __pyx_t_7 = (__pyx_v_max_label + 1);
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "fastremap.pyx":710
- * 
+    /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     __pyx_t_12 = __pyx_v_i;
     __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
     if (__pyx_t_13) {
 
-      /* "fastremap.pyx":711
+      /* "fastremap.pyx":709
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:
- *       segids.append(i)             # <<<<<<<<<<<<<<
- *       cts.append(counts[i])
- * 
- */
-      __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_segids, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-      /* "fastremap.pyx":712
- *     if counts[i] > 0:
- *       segids.append(i)
- *       cts.append(counts[i])             # <<<<<<<<<<<<<<
+ *       real_size += 1             # <<<<<<<<<<<<<<
  * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
  */
-      __pyx_t_15 = __pyx_v_i;
-      __pyx_t_5 = __Pyx_PyInt_From_uint32_t((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_counts.diminfo[0].strides))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_cts, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_v_real_size = (__pyx_v_real_size + 1);
 
-      /* "fastremap.pyx":710
- * 
+      /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     }
   }
 
-  /* "fastremap.pyx":714
- *       cts.append(counts[i])
- * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)             # <<<<<<<<<<<<<<
+  /* "fastremap.pyx":711
+ *       real_size += 1
  * 
- * def transpose(arr):
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
  */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(__pyx_v_segids);
-  __Pyx_GIVEREF(__pyx_v_segids);
-  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_segids);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 711, __pyx_L1_error)
+  __pyx_t_14 = ((PyArrayObject *)__pyx_t_2);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_segids.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn_int16_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_segids = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 711, __pyx_L1_error)
+    } else {__pyx_pybuffernd_segids.diminfo[0].strides = __pyx_pybuffernd_segids.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_segids.diminfo[0].shape = __pyx_pybuffernd_segids.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_14 = 0;
+  __pyx_v_segids = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_v_cts);
-  __Pyx_GIVEREF(__pyx_v_cts);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_cts);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint32); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_16) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_16);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_16);
-  __pyx_t_2 = 0;
-  __pyx_t_16 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_15 = ((PyArrayObject *)__pyx_t_4);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cts.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_cts = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 714, __pyx_L1_error)
+    } else {__pyx_pybuffernd_cts.diminfo[0].strides = __pyx_pybuffernd_cts.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cts.diminfo[0].shape = __pyx_pybuffernd_cts.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_15 = 0;
+  __pyx_v_cts = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_4 = 0;
+
+  /* "fastremap.pyx":718
+ *   )
+ * 
+ *   cdef size_t j = 0             # <<<<<<<<<<<<<<
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ */
+  __pyx_v_j = 0;
+
+  /* "fastremap.pyx":719
+ * 
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ */
+  __pyx_t_7 = (__pyx_v_max_label + 1);
+  __pyx_t_8 = __pyx_t_7;
+  for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
+    __pyx_v_i = __pyx_t_9;
+
+    /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    __pyx_t_16 = __pyx_v_i;
+    __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
+    if (__pyx_t_13) {
+
+      /* "fastremap.pyx":721
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ *       segids[j] = i             # <<<<<<<<<<<<<<
+ *       cts[j] = counts[i]
+ *       j += 1
+ */
+      __pyx_t_17 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(int16_t *, __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_segids.diminfo[0].strides) = __pyx_v_i;
+
+      /* "fastremap.pyx":722
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ *       cts[j] = counts[i]             # <<<<<<<<<<<<<<
+ *       j += 1
+ * 
+ */
+      __pyx_t_18 = __pyx_v_i;
+      __pyx_t_19 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_cts.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_counts.diminfo[0].strides));
+
+      /* "fastremap.pyx":723
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ *       j += 1             # <<<<<<<<<<<<<<
+ * 
+ *   return segids, cts
+ */
+      __pyx_v_j = (__pyx_v_j + 1);
+
+      /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    }
+  }
+
+  /* "fastremap.pyx":725
+ *       j += 1
+ * 
+ *   return segids, cts             # <<<<<<<<<<<<<<
+ * 
+ * def transpose(arr):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_INCREF(((PyObject *)__pyx_v_segids));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_segids));
+  PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_segids));
+  __Pyx_INCREF(((PyObject *)__pyx_v_cts));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_cts));
+  PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_cts));
+  __pyx_r = __pyx_t_4;
+  __pyx_t_4 = 0;
   goto __pyx_L0;
 
   /* "fastremap.pyx":689
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * @cython.nonecheck(False)
  * def unique_via_array(cnp.ndarray[ALLINT, ndim=1] labels, size_t max_label):             # <<<<<<<<<<<<<<
  *   """
@@ -50170,32 +51255,35 @@
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_16);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
   __Pyx_AddTraceback("fastremap.unique_via_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_counts);
-  __Pyx_XDECREF(__pyx_v_segids);
-  __Pyx_XDECREF(__pyx_v_cts);
+  __Pyx_XDECREF((PyObject *)__pyx_v_segids);
+  __Pyx_XDECREF((PyObject *)__pyx_v_cts);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_fuse_6__pyx_pw_9fastremap_215unique_via_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
@@ -50264,20 +51352,26 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_9fastremap_214unique_via_array(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_labels, size_t __pyx_v_max_label) {
   PyArrayObject *__pyx_v_counts = 0;
   size_t __pyx_v_voxels;
   size_t __pyx_v_i;
-  PyObject *__pyx_v_segids = 0;
-  PyObject *__pyx_v_cts = 0;
+  size_t __pyx_v_real_size;
+  PyArrayObject *__pyx_v_segids = 0;
+  PyArrayObject *__pyx_v_cts = 0;
+  size_t __pyx_v_j;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_counts;
   __Pyx_Buffer __pyx_pybuffer_counts;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_cts;
+  __Pyx_Buffer __pyx_pybuffer_cts;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_labels;
   __Pyx_Buffer __pyx_pybuffer_labels;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_segids;
+  __Pyx_Buffer __pyx_pybuffer_segids;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
@@ -50285,22 +51379,33 @@
   size_t __pyx_t_7;
   size_t __pyx_t_8;
   size_t __pyx_t_9;
   size_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   size_t __pyx_t_12;
   int __pyx_t_13;
-  int __pyx_t_14;
-  size_t __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
+  PyArrayObject *__pyx_t_14 = NULL;
+  PyArrayObject *__pyx_t_15 = NULL;
+  size_t __pyx_t_16;
+  size_t __pyx_t_17;
+  size_t __pyx_t_18;
+  size_t __pyx_t_19;
   __Pyx_RefNannySetupContext("__pyx_fuse_6unique_via_array", 0);
   __pyx_pybuffer_counts.pybuffer.buf = NULL;
   __pyx_pybuffer_counts.refcount = 0;
   __pyx_pybuffernd_counts.data = NULL;
   __pyx_pybuffernd_counts.rcbuffer = &__pyx_pybuffer_counts;
+  __pyx_pybuffer_segids.pybuffer.buf = NULL;
+  __pyx_pybuffer_segids.refcount = 0;
+  __pyx_pybuffernd_segids.data = NULL;
+  __pyx_pybuffernd_segids.rcbuffer = &__pyx_pybuffer_segids;
+  __pyx_pybuffer_cts.pybuffer.buf = NULL;
+  __pyx_pybuffer_cts.refcount = 0;
+  __pyx_pybuffernd_cts.data = NULL;
+  __pyx_pybuffernd_cts.rcbuffer = &__pyx_pybuffer_cts;
   __pyx_pybuffer_labels.pybuffer.buf = NULL;
   __pyx_pybuffer_labels.refcount = 0;
   __pyx_pybuffernd_labels.data = NULL;
   __pyx_pybuffernd_labels.rcbuffer = &__pyx_pybuffer_labels;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_labels.rcbuffer->pybuffer, (PyObject*)__pyx_v_labels, &__Pyx_TypeInfo_nn_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 689, __pyx_L1_error)
@@ -50422,166 +51527,327 @@
     __pyx_v_i = __pyx_t_9;
 
     /* "fastremap.pyx":704
  *   cdef size_t i = 0
  *   for i in range(voxels):
  *     counts[labels[i]] += 1             # <<<<<<<<<<<<<<
  * 
- *   cdef list segids = []
+ *   cdef size_t real_size = 0
  */
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = (*__Pyx_BufPtrStrided1d(int32_t *, __pyx_pybuffernd_labels.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_labels.diminfo[0].strides));
     *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_counts.diminfo[0].strides) += 1;
   }
 
   /* "fastremap.pyx":706
  *     counts[labels[i]] += 1
  * 
- *   cdef list segids = []             # <<<<<<<<<<<<<<
- *   cdef list cts = []
- * 
- */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_segids = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "fastremap.pyx":707
- * 
- *   cdef list segids = []
- *   cdef list cts = []             # <<<<<<<<<<<<<<
- * 
+ *   cdef size_t real_size = 0             # <<<<<<<<<<<<<<
  *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_cts = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
+  __pyx_v_real_size = 0;
 
-  /* "fastremap.pyx":709
- *   cdef list cts = []
+  /* "fastremap.pyx":707
  * 
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
  *     if counts[i] > 0:
- *       segids.append(i)
+ *       real_size += 1
  */
   __pyx_t_7 = (__pyx_v_max_label + 1);
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "fastremap.pyx":710
- * 
+    /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     __pyx_t_12 = __pyx_v_i;
     __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
     if (__pyx_t_13) {
 
-      /* "fastremap.pyx":711
+      /* "fastremap.pyx":709
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:
- *       segids.append(i)             # <<<<<<<<<<<<<<
- *       cts.append(counts[i])
+ *       real_size += 1             # <<<<<<<<<<<<<<
  * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
  */
-      __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_segids, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-      /* "fastremap.pyx":712
- *     if counts[i] > 0:
- *       segids.append(i)
- *       cts.append(counts[i])             # <<<<<<<<<<<<<<
- * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
- */
-      __pyx_t_15 = __pyx_v_i;
-      __pyx_t_5 = __Pyx_PyInt_From_uint32_t((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_counts.diminfo[0].strides))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_cts, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_v_real_size = (__pyx_v_real_size + 1);
 
-      /* "fastremap.pyx":710
- * 
+      /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     }
   }
 
-  /* "fastremap.pyx":714
- *       cts.append(counts[i])
+  /* "fastremap.pyx":711
+ *       real_size += 1
  * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)             # <<<<<<<<<<<<<<
- * 
- * def transpose(arr):
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
  */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(__pyx_v_segids);
-  __Pyx_GIVEREF(__pyx_v_segids);
-  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_segids);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 711, __pyx_L1_error)
+  __pyx_t_14 = ((PyArrayObject *)__pyx_t_2);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_segids.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn_int32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_segids = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 711, __pyx_L1_error)
+    } else {__pyx_pybuffernd_segids.diminfo[0].strides = __pyx_pybuffernd_segids.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_segids.diminfo[0].shape = __pyx_pybuffernd_segids.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_14 = 0;
+  __pyx_v_segids = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_v_cts);
-  __Pyx_GIVEREF(__pyx_v_cts);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_cts);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint32); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_16) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_16);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_16);
-  __pyx_t_2 = 0;
-  __pyx_t_16 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_15 = ((PyArrayObject *)__pyx_t_4);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cts.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_cts = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 714, __pyx_L1_error)
+    } else {__pyx_pybuffernd_cts.diminfo[0].strides = __pyx_pybuffernd_cts.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cts.diminfo[0].shape = __pyx_pybuffernd_cts.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_15 = 0;
+  __pyx_v_cts = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_4 = 0;
+
+  /* "fastremap.pyx":718
+ *   )
+ * 
+ *   cdef size_t j = 0             # <<<<<<<<<<<<<<
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ */
+  __pyx_v_j = 0;
+
+  /* "fastremap.pyx":719
+ * 
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ */
+  __pyx_t_7 = (__pyx_v_max_label + 1);
+  __pyx_t_8 = __pyx_t_7;
+  for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
+    __pyx_v_i = __pyx_t_9;
+
+    /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    __pyx_t_16 = __pyx_v_i;
+    __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
+    if (__pyx_t_13) {
+
+      /* "fastremap.pyx":721
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ *       segids[j] = i             # <<<<<<<<<<<<<<
+ *       cts[j] = counts[i]
+ *       j += 1
+ */
+      __pyx_t_17 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(int32_t *, __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_segids.diminfo[0].strides) = __pyx_v_i;
+
+      /* "fastremap.pyx":722
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ *       cts[j] = counts[i]             # <<<<<<<<<<<<<<
+ *       j += 1
+ * 
+ */
+      __pyx_t_18 = __pyx_v_i;
+      __pyx_t_19 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_cts.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_counts.diminfo[0].strides));
+
+      /* "fastremap.pyx":723
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ *       j += 1             # <<<<<<<<<<<<<<
+ * 
+ *   return segids, cts
+ */
+      __pyx_v_j = (__pyx_v_j + 1);
+
+      /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    }
+  }
+
+  /* "fastremap.pyx":725
+ *       j += 1
+ * 
+ *   return segids, cts             # <<<<<<<<<<<<<<
+ * 
+ * def transpose(arr):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_INCREF(((PyObject *)__pyx_v_segids));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_segids));
+  PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_segids));
+  __Pyx_INCREF(((PyObject *)__pyx_v_cts));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_cts));
+  PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_cts));
+  __pyx_r = __pyx_t_4;
+  __pyx_t_4 = 0;
   goto __pyx_L0;
 
   /* "fastremap.pyx":689
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * @cython.nonecheck(False)
  * def unique_via_array(cnp.ndarray[ALLINT, ndim=1] labels, size_t max_label):             # <<<<<<<<<<<<<<
  *   """
@@ -50591,32 +51857,35 @@
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_16);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
   __Pyx_AddTraceback("fastremap.unique_via_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_counts);
-  __Pyx_XDECREF(__pyx_v_segids);
-  __Pyx_XDECREF(__pyx_v_cts);
+  __Pyx_XDECREF((PyObject *)__pyx_v_segids);
+  __Pyx_XDECREF((PyObject *)__pyx_v_cts);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_fuse_7__pyx_pw_9fastremap_217unique_via_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
@@ -50685,20 +51954,26 @@
   return __pyx_r;
 }
 
 static PyObject *__pyx_pf_9fastremap_216unique_via_array(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_labels, size_t __pyx_v_max_label) {
   PyArrayObject *__pyx_v_counts = 0;
   size_t __pyx_v_voxels;
   size_t __pyx_v_i;
-  PyObject *__pyx_v_segids = 0;
-  PyObject *__pyx_v_cts = 0;
+  size_t __pyx_v_real_size;
+  PyArrayObject *__pyx_v_segids = 0;
+  PyArrayObject *__pyx_v_cts = 0;
+  size_t __pyx_v_j;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_counts;
   __Pyx_Buffer __pyx_pybuffer_counts;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_cts;
+  __Pyx_Buffer __pyx_pybuffer_cts;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_labels;
   __Pyx_Buffer __pyx_pybuffer_labels;
+  __Pyx_LocalBuf_ND __pyx_pybuffernd_segids;
+  __Pyx_Buffer __pyx_pybuffer_segids;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
@@ -50706,22 +51981,33 @@
   size_t __pyx_t_7;
   size_t __pyx_t_8;
   size_t __pyx_t_9;
   size_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   size_t __pyx_t_12;
   int __pyx_t_13;
-  int __pyx_t_14;
-  size_t __pyx_t_15;
-  PyObject *__pyx_t_16 = NULL;
+  PyArrayObject *__pyx_t_14 = NULL;
+  PyArrayObject *__pyx_t_15 = NULL;
+  size_t __pyx_t_16;
+  size_t __pyx_t_17;
+  size_t __pyx_t_18;
+  size_t __pyx_t_19;
   __Pyx_RefNannySetupContext("__pyx_fuse_7unique_via_array", 0);
   __pyx_pybuffer_counts.pybuffer.buf = NULL;
   __pyx_pybuffer_counts.refcount = 0;
   __pyx_pybuffernd_counts.data = NULL;
   __pyx_pybuffernd_counts.rcbuffer = &__pyx_pybuffer_counts;
+  __pyx_pybuffer_segids.pybuffer.buf = NULL;
+  __pyx_pybuffer_segids.refcount = 0;
+  __pyx_pybuffernd_segids.data = NULL;
+  __pyx_pybuffernd_segids.rcbuffer = &__pyx_pybuffer_segids;
+  __pyx_pybuffer_cts.pybuffer.buf = NULL;
+  __pyx_pybuffer_cts.refcount = 0;
+  __pyx_pybuffernd_cts.data = NULL;
+  __pyx_pybuffernd_cts.rcbuffer = &__pyx_pybuffer_cts;
   __pyx_pybuffer_labels.pybuffer.buf = NULL;
   __pyx_pybuffer_labels.refcount = 0;
   __pyx_pybuffernd_labels.data = NULL;
   __pyx_pybuffernd_labels.rcbuffer = &__pyx_pybuffer_labels;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_labels.rcbuffer->pybuffer, (PyObject*)__pyx_v_labels, &__Pyx_TypeInfo_nn_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 689, __pyx_L1_error)
@@ -50843,166 +52129,327 @@
     __pyx_v_i = __pyx_t_9;
 
     /* "fastremap.pyx":704
  *   cdef size_t i = 0
  *   for i in range(voxels):
  *     counts[labels[i]] += 1             # <<<<<<<<<<<<<<
  * 
- *   cdef list segids = []
+ *   cdef size_t real_size = 0
  */
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = (*__Pyx_BufPtrStrided1d(int64_t *, __pyx_pybuffernd_labels.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_labels.diminfo[0].strides));
     *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_counts.diminfo[0].strides) += 1;
   }
 
   /* "fastremap.pyx":706
  *     counts[labels[i]] += 1
  * 
- *   cdef list segids = []             # <<<<<<<<<<<<<<
- *   cdef list cts = []
- * 
- */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 706, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_segids = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
-
-  /* "fastremap.pyx":707
- * 
- *   cdef list segids = []
- *   cdef list cts = []             # <<<<<<<<<<<<<<
- * 
+ *   cdef size_t real_size = 0             # <<<<<<<<<<<<<<
  *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
  */
-  __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 707, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  __pyx_v_cts = ((PyObject*)__pyx_t_5);
-  __pyx_t_5 = 0;
+  __pyx_v_real_size = 0;
 
-  /* "fastremap.pyx":709
- *   cdef list cts = []
+  /* "fastremap.pyx":707
  * 
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
  *     if counts[i] > 0:
- *       segids.append(i)
+ *       real_size += 1
  */
   __pyx_t_7 = (__pyx_v_max_label + 1);
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "fastremap.pyx":710
- * 
+    /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     __pyx_t_12 = __pyx_v_i;
     __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
     if (__pyx_t_13) {
 
-      /* "fastremap.pyx":711
+      /* "fastremap.pyx":709
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:
- *       segids.append(i)             # <<<<<<<<<<<<<<
- *       cts.append(counts[i])
- * 
- */
-      __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_segids, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 711, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-
-      /* "fastremap.pyx":712
- *     if counts[i] > 0:
- *       segids.append(i)
- *       cts.append(counts[i])             # <<<<<<<<<<<<<<
+ *       real_size += 1             # <<<<<<<<<<<<<<
  * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
  */
-      __pyx_t_15 = __pyx_v_i;
-      __pyx_t_5 = __Pyx_PyInt_From_uint32_t((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_counts.diminfo[0].strides))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_14 = __Pyx_PyList_Append(__pyx_v_cts, __pyx_t_5); if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 712, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __pyx_v_real_size = (__pyx_v_real_size + 1);
 
-      /* "fastremap.pyx":710
- * 
+      /* "fastremap.pyx":708
+ *   cdef size_t real_size = 0
  *   for i in range(max_label + 1):
  *     if counts[i] > 0:             # <<<<<<<<<<<<<<
- *       segids.append(i)
- *       cts.append(counts[i])
+ *       real_size += 1
+ * 
  */
     }
   }
 
-  /* "fastremap.pyx":714
- *       cts.append(counts[i])
- * 
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)             # <<<<<<<<<<<<<<
+  /* "fastremap.pyx":711
+ *       real_size += 1
  * 
- * def transpose(arr):
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
  */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_5 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_INCREF(__pyx_v_segids);
-  __Pyx_GIVEREF(__pyx_v_segids);
-  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_segids);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 711, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GIVEREF(__pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
+  __pyx_t_1 = 0;
+
+  /* "fastremap.pyx":712
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(
+ *     (real_size,), dtype=labels.dtype             # <<<<<<<<<<<<<<
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ */
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_labels), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+
+  /* "fastremap.pyx":711
+ *       real_size += 1
+ * 
+ *   cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ */
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 711, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 711, __pyx_L1_error)
+  __pyx_t_14 = ((PyArrayObject *)__pyx_t_2);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_segids.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_segids = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 711, __pyx_L1_error)
+    } else {__pyx_pybuffernd_segids.diminfo[0].strides = __pyx_pybuffernd_segids.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_segids.diminfo[0].shape = __pyx_pybuffernd_segids.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_14 = 0;
+  __pyx_v_segids = ((PyArrayObject *)__pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_2 = __Pyx_PyInt_FromSize_t(__pyx_v_real_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_v_cts);
-  __Pyx_GIVEREF(__pyx_v_cts);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_cts);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_2);
+  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
+  __pyx_t_2 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_5);
+  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
+  __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":715
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(
+ *     (real_size,), dtype=np.uint32             # <<<<<<<<<<<<<<
+ *   )
+ * 
+ */
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 715, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uint32); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_16 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uint32); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 715, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_16) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
-  __pyx_t_16 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_16);
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+
+  /* "fastremap.pyx":714
+ *     (real_size,), dtype=labels.dtype
+ *   )
+ *   cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros(             # <<<<<<<<<<<<<<
+ *     (real_size,), dtype=np.uint32
+ *   )
+ */
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 714, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_16);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_16);
-  __pyx_t_2 = 0;
-  __pyx_t_16 = 0;
-  __pyx_r = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 714, __pyx_L1_error)
+  __pyx_t_15 = ((PyArrayObject *)__pyx_t_4);
+  {
+    __Pyx_BufFmt_StackElem __pyx_stack[1];
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cts.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+      __pyx_v_cts = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf = NULL;
+      __PYX_ERR(0, 714, __pyx_L1_error)
+    } else {__pyx_pybuffernd_cts.diminfo[0].strides = __pyx_pybuffernd_cts.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cts.diminfo[0].shape = __pyx_pybuffernd_cts.rcbuffer->pybuffer.shape[0];
+    }
+  }
+  __pyx_t_15 = 0;
+  __pyx_v_cts = ((PyArrayObject *)__pyx_t_4);
+  __pyx_t_4 = 0;
+
+  /* "fastremap.pyx":718
+ *   )
+ * 
+ *   cdef size_t j = 0             # <<<<<<<<<<<<<<
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ */
+  __pyx_v_j = 0;
+
+  /* "fastremap.pyx":719
+ * 
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):             # <<<<<<<<<<<<<<
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ */
+  __pyx_t_7 = (__pyx_v_max_label + 1);
+  __pyx_t_8 = __pyx_t_7;
+  for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
+    __pyx_v_i = __pyx_t_9;
+
+    /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    __pyx_t_16 = __pyx_v_i;
+    __pyx_t_13 = (((*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_counts.diminfo[0].strides)) > 0) != 0);
+    if (__pyx_t_13) {
+
+      /* "fastremap.pyx":721
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:
+ *       segids[j] = i             # <<<<<<<<<<<<<<
+ *       cts[j] = counts[i]
+ *       j += 1
+ */
+      __pyx_t_17 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(int64_t *, __pyx_pybuffernd_segids.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_segids.diminfo[0].strides) = __pyx_v_i;
+
+      /* "fastremap.pyx":722
+ *     if counts[i] > 0:
+ *       segids[j] = i
+ *       cts[j] = counts[i]             # <<<<<<<<<<<<<<
+ *       j += 1
+ * 
+ */
+      __pyx_t_18 = __pyx_v_i;
+      __pyx_t_19 = __pyx_v_j;
+      *__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_cts.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_cts.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(uint32_t *, __pyx_pybuffernd_counts.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_counts.diminfo[0].strides));
+
+      /* "fastremap.pyx":723
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ *       j += 1             # <<<<<<<<<<<<<<
+ * 
+ *   return segids, cts
+ */
+      __pyx_v_j = (__pyx_v_j + 1);
+
+      /* "fastremap.pyx":720
+ *   cdef size_t j = 0
+ *   for i in range(max_label + 1):
+ *     if counts[i] > 0:             # <<<<<<<<<<<<<<
+ *       segids[j] = i
+ *       cts[j] = counts[i]
+ */
+    }
+  }
+
+  /* "fastremap.pyx":725
+ *       j += 1
+ * 
+ *   return segids, cts             # <<<<<<<<<<<<<<
+ * 
+ * def transpose(arr):
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_INCREF(((PyObject *)__pyx_v_segids));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_segids));
+  PyTuple_SET_ITEM(__pyx_t_4, 0, ((PyObject *)__pyx_v_segids));
+  __Pyx_INCREF(((PyObject *)__pyx_v_cts));
+  __Pyx_GIVEREF(((PyObject *)__pyx_v_cts));
+  PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_cts));
+  __pyx_r = __pyx_t_4;
+  __pyx_t_4 = 0;
   goto __pyx_L0;
 
   /* "fastremap.pyx":689
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * @cython.nonecheck(False)
  * def unique_via_array(cnp.ndarray[ALLINT, ndim=1] labels, size_t max_label):             # <<<<<<<<<<<<<<
  *   """
@@ -51012,39 +52459,42 @@
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5);
-  __Pyx_XDECREF(__pyx_t_16);
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
     __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
   __Pyx_AddTraceback("fastremap.unique_via_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   goto __pyx_L2;
   __pyx_L0:;
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_counts.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_cts.rcbuffer->pybuffer);
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_labels.rcbuffer->pybuffer);
+  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_segids.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_counts);
-  __Pyx_XDECREF(__pyx_v_segids);
-  __Pyx_XDECREF(__pyx_v_cts);
+  __Pyx_XDECREF((PyObject *)__pyx_v_segids);
+  __Pyx_XDECREF((PyObject *)__pyx_v_cts);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastremap.pyx":716
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
+/* "fastremap.pyx":727
+ *   return segids, cts
  * 
  * def transpose(arr):             # <<<<<<<<<<<<<<
  *   """
  *   transpose(arr)
  */
 
 /* Python wrapper */
@@ -51076,189 +52526,189 @@
   int __pyx_t_5;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   __Pyx_RefNannySetupContext("transpose", 0);
   __Pyx_INCREF(__pyx_v_arr);
 
-  /* "fastremap.pyx":727
+  /* "fastremap.pyx":738
  *   Returns: transposed numpy array
  *   """
  *   if not arr.flags['F_CONTIGUOUS'] and not arr.flags['C_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     arr = np.copy(arr, order='C')
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 727, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 727, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 727, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_5 = ((!__pyx_t_4) != 0);
   if (__pyx_t_5) {
   } else {
     __pyx_t_1 = __pyx_t_5;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 727, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_3, __pyx_n_u_C_CONTIGUOUS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 727, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_3, __pyx_n_u_C_CONTIGUOUS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 727, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_4 = ((!__pyx_t_5) != 0);
   __pyx_t_1 = __pyx_t_4;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastremap.pyx":728
+    /* "fastremap.pyx":739
  *   """
  *   if not arr.flags['F_CONTIGUOUS'] and not arr.flags['C_CONTIGUOUS']:
  *     arr = np.copy(arr, order='C')             # <<<<<<<<<<<<<<
  * 
  *   shape = arr.shape
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 728, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 739, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_copy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 728, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_copy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 739, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 728, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 739, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_v_arr);
     __Pyx_GIVEREF(__pyx_v_arr);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_arr);
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 728, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 739, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_order, __pyx_n_u_C) < 0) __PYX_ERR(0, 728, __pyx_L1_error)
-    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 728, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_order, __pyx_n_u_C) < 0) __PYX_ERR(0, 739, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 739, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_7);
     __pyx_t_7 = 0;
 
-    /* "fastremap.pyx":727
+    /* "fastremap.pyx":738
  *   Returns: transposed numpy array
  *   """
  *   if not arr.flags['F_CONTIGUOUS'] and not arr.flags['C_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     arr = np.copy(arr, order='C')
  * 
  */
   }
 
-  /* "fastremap.pyx":730
+  /* "fastremap.pyx":741
  *     arr = np.copy(arr, order='C')
  * 
  *   shape = arr.shape             # <<<<<<<<<<<<<<
  *   strides = arr.strides
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 730, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_v_shape = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "fastremap.pyx":731
+  /* "fastremap.pyx":742
  * 
  *   shape = arr.shape
  *   strides = arr.strides             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_strides); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_strides); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 742, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_v_strides = __pyx_t_7;
   __pyx_t_7 = 0;
 
-  /* "fastremap.pyx":733
+  /* "fastremap.pyx":744
  *   strides = arr.strides
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   dtype = arr.dtype
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 733, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 733, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_7 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_6);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 733, __pyx_L1_error)
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 733, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_nbytes = __pyx_t_8;
 
-  /* "fastremap.pyx":735
+  /* "fastremap.pyx":746
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  * 
  *   dtype = arr.dtype             # <<<<<<<<<<<<<<
  *   if arr.dtype == np.bool:
  *     arr = arr.view(np.uint8)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 735, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 746, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_v_dtype = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastremap.pyx":736
+  /* "fastremap.pyx":747
  * 
  *   dtype = arr.dtype
  *   if arr.dtype == np.bool:             # <<<<<<<<<<<<<<
  *     arr = arr.view(np.uint8)
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 747, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 747, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_bool); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_bool); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 747, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyObject_RichCompare(__pyx_t_2, __pyx_t_6, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_7 = PyObject_RichCompare(__pyx_t_2, __pyx_t_6, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 747, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 747, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   if (__pyx_t_1) {
 
-    /* "fastremap.pyx":737
+    /* "fastremap.pyx":748
  *   dtype = arr.dtype
  *   if arr.dtype == np.bool:
  *     arr = arr.view(np.uint8)             # <<<<<<<<<<<<<<
  * 
  *   if arr.ndim == 2:
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 737, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 737, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 737, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -51266,290 +52716,290 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 737, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_7);
     __pyx_t_7 = 0;
 
-    /* "fastremap.pyx":736
+    /* "fastremap.pyx":747
  * 
  *   dtype = arr.dtype
  *   if arr.dtype == np.bool:             # <<<<<<<<<<<<<<
  *     arr = arr.view(np.uint8)
  * 
  */
   }
 
-  /* "fastremap.pyx":739
+  /* "fastremap.pyx":750
  *     arr = arr.view(np.uint8)
  * 
  *   if arr.ndim == 2:             # <<<<<<<<<<<<<<
  *     arr = ipt2d(arr)
  *     return arr.view(dtype)
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 739, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 750, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_7, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 739, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_7, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 750, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 739, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 750, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (__pyx_t_1) {
 
-    /* "fastremap.pyx":740
+    /* "fastremap.pyx":751
  * 
  *   if arr.ndim == 2:
  *     arr = ipt2d(arr)             # <<<<<<<<<<<<<<
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_ipt2d); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_ipt2d); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 751, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_6 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 740, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 751, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "fastremap.pyx":741
+    /* "fastremap.pyx":752
  *   if arr.ndim == 2:
  *     arr = ipt2d(arr)
  *     return arr.view(dtype)             # <<<<<<<<<<<<<<
  *   elif arr.ndim == 3:
  *     arr = ipt3d(arr)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 752, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_6 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3, __pyx_v_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_dtype);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 741, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 752, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_r = __pyx_t_6;
     __pyx_t_6 = 0;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":739
+    /* "fastremap.pyx":750
  *     arr = arr.view(np.uint8)
  * 
  *   if arr.ndim == 2:             # <<<<<<<<<<<<<<
  *     arr = ipt2d(arr)
  *     return arr.view(dtype)
  */
   }
 
-  /* "fastremap.pyx":742
+  /* "fastremap.pyx":753
  *     arr = ipt2d(arr)
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:             # <<<<<<<<<<<<<<
  *     arr = ipt3d(arr)
  *     return arr.view(dtype)
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 753, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = __Pyx_PyInt_EqObjC(__pyx_t_6, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_EqObjC(__pyx_t_6, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 753, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 753, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   if (__pyx_t_1) {
 
-    /* "fastremap.pyx":743
+    /* "fastremap.pyx":754
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:
  *     arr = ipt3d(arr)             # <<<<<<<<<<<<<<
  *     return arr.view(dtype)
  *   elif arr.ndim == 4:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_ipt3d); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_ipt3d); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 754, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_7 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_3, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 743, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 754, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_7);
     __pyx_t_7 = 0;
 
-    /* "fastremap.pyx":744
+    /* "fastremap.pyx":755
  *   elif arr.ndim == 3:
  *     arr = ipt3d(arr)
  *     return arr.view(dtype)             # <<<<<<<<<<<<<<
  *   elif arr.ndim == 4:
  *     arr = ipt4d(arr)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 755, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_7 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_3, __pyx_v_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_dtype);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 755, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_r = __pyx_t_7;
     __pyx_t_7 = 0;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":742
+    /* "fastremap.pyx":753
  *     arr = ipt2d(arr)
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:             # <<<<<<<<<<<<<<
  *     arr = ipt3d(arr)
  *     return arr.view(dtype)
  */
   }
 
-  /* "fastremap.pyx":745
+  /* "fastremap.pyx":756
  *     arr = ipt3d(arr)
  *     return arr.view(dtype)
  *   elif arr.ndim == 4:             # <<<<<<<<<<<<<<
  *     arr = ipt4d(arr)
  *     return arr.view(dtype)
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 745, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_7, __pyx_int_4, 4, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 745, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_7, __pyx_int_4, 4, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 745, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (__pyx_t_1) {
 
-    /* "fastremap.pyx":746
+    /* "fastremap.pyx":757
  *     return arr.view(dtype)
  *   elif arr.ndim == 4:
  *     arr = ipt4d(arr)             # <<<<<<<<<<<<<<
  *     return arr.view(dtype)
  *   else:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_ipt4d); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 746, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_ipt4d); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_6 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 746, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 757, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "fastremap.pyx":747
+    /* "fastremap.pyx":758
  *   elif arr.ndim == 4:
  *     arr = ipt4d(arr)
  *     return arr.view(dtype)             # <<<<<<<<<<<<<<
  *   else:
  *     return arr.T
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 747, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 758, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_6 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3, __pyx_v_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_dtype);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 747, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 758, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_r = __pyx_t_6;
     __pyx_t_6 = 0;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":745
+    /* "fastremap.pyx":756
  *     arr = ipt3d(arr)
  *     return arr.view(dtype)
  *   elif arr.ndim == 4:             # <<<<<<<<<<<<<<
  *     arr = ipt4d(arr)
  *     return arr.view(dtype)
  */
   }
 
-  /* "fastremap.pyx":749
+  /* "fastremap.pyx":760
  *     return arr.view(dtype)
  *   else:
  *     return arr.T             # <<<<<<<<<<<<<<
  * 
  * def asfortranarray(arr):
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_T); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 749, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_T); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 760, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_r = __pyx_t_6;
     __pyx_t_6 = 0;
     goto __pyx_L0;
   }
 
-  /* "fastremap.pyx":716
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
+  /* "fastremap.pyx":727
+ *   return segids, cts
  * 
  * def transpose(arr):             # <<<<<<<<<<<<<<
  *   """
  *   transpose(arr)
  */
 
   /* function exit code */
@@ -51566,15 +53016,15 @@
   __Pyx_XDECREF(__pyx_v_dtype);
   __Pyx_XDECREF(__pyx_v_arr);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastremap.pyx":751
+/* "fastremap.pyx":762
  *     return arr.T
  * 
  * def asfortranarray(arr):             # <<<<<<<<<<<<<<
  *   """
  *   asfortranarray(arr)
  */
 
@@ -51611,252 +53061,252 @@
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
   PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
   __Pyx_RefNannySetupContext("asfortranarray", 0);
   __Pyx_INCREF(__pyx_v_arr);
 
-  /* "fastremap.pyx":762
+  /* "fastremap.pyx":773
  *   Returns: transposed numpy array
  *   """
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     return arr
  *   elif not arr.flags['C_CONTIGUOUS']:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 762, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 773, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_1, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 762, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_1, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 773, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 762, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 773, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_3) {
 
-    /* "fastremap.pyx":763
+    /* "fastremap.pyx":774
  *   """
  *   if arr.flags['F_CONTIGUOUS']:
  *     return arr             # <<<<<<<<<<<<<<
  *   elif not arr.flags['C_CONTIGUOUS']:
  *     return np.asfortranarray(arr)
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_v_arr);
     __pyx_r = __pyx_v_arr;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":762
+    /* "fastremap.pyx":773
  *   Returns: transposed numpy array
  *   """
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     return arr
  *   elif not arr.flags['C_CONTIGUOUS']:
  */
   }
 
-  /* "fastremap.pyx":764
+  /* "fastremap.pyx":775
  *   if arr.flags['F_CONTIGUOUS']:
  *     return arr
  *   elif not arr.flags['C_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     return np.asfortranarray(arr)
  *   elif arr.ndim == 1:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 764, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 775, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_C_CONTIGUOUS); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_C_CONTIGUOUS); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 775, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 764, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 775, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_4 = ((!__pyx_t_3) != 0);
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":765
+    /* "fastremap.pyx":776
  *     return arr
  *   elif not arr.flags['C_CONTIGUOUS']:
  *     return np.asfortranarray(arr)             # <<<<<<<<<<<<<<
  *   elif arr.ndim == 1:
  *     return arr
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 765, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 776, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_asfortranarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 765, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_asfortranarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 776, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 765, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 776, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":764
+    /* "fastremap.pyx":775
  *   if arr.flags['F_CONTIGUOUS']:
  *     return arr
  *   elif not arr.flags['C_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     return np.asfortranarray(arr)
  *   elif arr.ndim == 1:
  */
   }
 
-  /* "fastremap.pyx":766
+  /* "fastremap.pyx":777
  *   elif not arr.flags['C_CONTIGUOUS']:
  *     return np.asfortranarray(arr)
  *   elif arr.ndim == 1:             # <<<<<<<<<<<<<<
  *     return arr
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 766, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 766, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 777, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 766, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 777, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":767
+    /* "fastremap.pyx":778
  *     return np.asfortranarray(arr)
  *   elif arr.ndim == 1:
  *     return arr             # <<<<<<<<<<<<<<
  * 
  *   shape = arr.shape
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_v_arr);
     __pyx_r = __pyx_v_arr;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":766
+    /* "fastremap.pyx":777
  *   elif not arr.flags['C_CONTIGUOUS']:
  *     return np.asfortranarray(arr)
  *   elif arr.ndim == 1:             # <<<<<<<<<<<<<<
  *     return arr
  * 
  */
   }
 
-  /* "fastremap.pyx":769
+  /* "fastremap.pyx":780
  *     return arr
  * 
  *   shape = arr.shape             # <<<<<<<<<<<<<<
  *   strides = arr.strides
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 769, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 780, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_v_shape = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "fastremap.pyx":770
+  /* "fastremap.pyx":781
  * 
  *   shape = arr.shape
  *   strides = arr.strides             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_strides); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 770, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_strides); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 781, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_v_strides = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "fastremap.pyx":772
+  /* "fastremap.pyx":783
  *   strides = arr.strides
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   dtype = arr.dtype
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 772, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 772, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 772, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 783, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 772, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 783, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":774
+  /* "fastremap.pyx":785
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  * 
  *   dtype = arr.dtype             # <<<<<<<<<<<<<<
  *   if arr.dtype == np.bool:
  *     arr = arr.view(np.uint8)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 774, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_v_dtype = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastremap.pyx":775
+  /* "fastremap.pyx":786
  * 
  *   dtype = arr.dtype
  *   if arr.dtype == np.bool:             # <<<<<<<<<<<<<<
  *     arr = arr.view(np.uint8)
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 775, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 775, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_bool); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 775, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_bool); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 775, __pyx_L1_error)
+  __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 786, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 775, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 786, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":776
+    /* "fastremap.pyx":787
  *   dtype = arr.dtype
  *   if arr.dtype == np.bool:
  *     arr = arr.view(np.uint8)             # <<<<<<<<<<<<<<
  * 
  *   if arr.ndim == 2:
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 776, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 787, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 776, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 787, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 776, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 787, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -51864,574 +53314,574 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 776, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 787, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "fastremap.pyx":775
+    /* "fastremap.pyx":786
  * 
  *   dtype = arr.dtype
  *   if arr.dtype == np.bool:             # <<<<<<<<<<<<<<
  *     arr = arr.view(np.uint8)
  * 
  */
   }
 
-  /* "fastremap.pyx":778
+  /* "fastremap.pyx":789
  *     arr = arr.view(np.uint8)
  * 
  *   if arr.ndim == 2:             # <<<<<<<<<<<<<<
  *     arr = ipt2d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes))
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 778, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 789, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_5, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_5, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 789, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 778, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 789, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":779
+    /* "fastremap.pyx":790
  * 
  *   if arr.ndim == 2:
  *     arr = ipt2d(arr)             # <<<<<<<<<<<<<<
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes))
  *     return arr.view(dtype)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_ipt2d); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 779, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_ipt2d); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 790, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 790, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastremap.pyx":780
+    /* "fastremap.pyx":791
  *   if arr.ndim == 2:
  *     arr = ipt2d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes))             # <<<<<<<<<<<<<<
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_lib); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_lib); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_arr);
     __Pyx_GIVEREF(__pyx_v_arr);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_arr);
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 780, __pyx_L1_error)
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 780, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 791, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_10 = PyNumber_Multiply(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Multiply(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_10);
     PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_10);
     __pyx_t_2 = 0;
     __pyx_t_10 = 0;
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_strides, __pyx_t_9) < 0) __PYX_ERR(0, 780, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_strides, __pyx_t_9) < 0) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 791, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_9);
     __pyx_t_9 = 0;
 
-    /* "fastremap.pyx":781
+    /* "fastremap.pyx":792
  *     arr = ipt2d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes))
  *     return arr.view(dtype)             # <<<<<<<<<<<<<<
  *   elif arr.ndim == 3:
  *     arr = ipt3d(arr)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 781, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 792, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_9 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_v_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_dtype);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 781, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 792, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_r = __pyx_t_9;
     __pyx_t_9 = 0;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":778
+    /* "fastremap.pyx":789
  *     arr = arr.view(np.uint8)
  * 
  *   if arr.ndim == 2:             # <<<<<<<<<<<<<<
  *     arr = ipt2d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes))
  */
   }
 
-  /* "fastremap.pyx":782
+  /* "fastremap.pyx":793
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes))
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:             # <<<<<<<<<<<<<<
  *     arr = ipt3d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes, shape[0] * shape[1] * nbytes))
  */
-  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_9, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_9, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":783
+    /* "fastremap.pyx":794
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:
  *     arr = ipt3d(arr)             # <<<<<<<<<<<<<<
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes, shape[0] * shape[1] * nbytes))
  *     return arr.view(dtype)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_ipt3d); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 783, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_ipt3d); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 794, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_9);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_9, function);
       }
     }
     __pyx_t_6 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_1, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 783, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 794, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "fastremap.pyx":784
+    /* "fastremap.pyx":795
  *   elif arr.ndim == 3:
  *     arr = ipt3d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes, shape[0] * shape[1] * nbytes))             # <<<<<<<<<<<<<<
  *     return arr.view(dtype)
  *   elif arr.ndim == 4:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_lib); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_lib); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_v_arr);
     __Pyx_GIVEREF(__pyx_v_arr);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_arr);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 784, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 784, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 795, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_8 = PyNumber_Multiply(__pyx_t_10, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Multiply(__pyx_t_10, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_11 = PyNumber_Multiply(__pyx_t_2, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_11 = PyNumber_Multiply(__pyx_t_2, __pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_2 = PyNumber_Multiply(__pyx_t_11, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Multiply(__pyx_t_11, __pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = PyTuple_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_10 = PyTuple_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_t_2);
     __pyx_t_5 = 0;
     __pyx_t_8 = 0;
     __pyx_t_2 = 0;
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_strides, __pyx_t_10) < 0) __PYX_ERR(0, 784, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_strides, __pyx_t_10) < 0) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 795, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_10);
     __pyx_t_10 = 0;
 
-    /* "fastremap.pyx":785
+    /* "fastremap.pyx":796
  *     arr = ipt3d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes, shape[0] * shape[1] * nbytes))
  *     return arr.view(dtype)             # <<<<<<<<<<<<<<
  *   elif arr.ndim == 4:
  *     arr = ipt4d(arr)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 785, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 796, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_10 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_v_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_dtype);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 785, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 796, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_r = __pyx_t_10;
     __pyx_t_10 = 0;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":782
+    /* "fastremap.pyx":793
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes))
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:             # <<<<<<<<<<<<<<
  *     arr = ipt3d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes, shape[0] * shape[1] * nbytes))
  */
   }
 
-  /* "fastremap.pyx":786
+  /* "fastremap.pyx":797
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes, shape[0] * shape[1] * nbytes))
  *     return arr.view(dtype)
  *   elif arr.ndim == 4:             # <<<<<<<<<<<<<<
  *     arr = ipt4d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,
  */
-  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_10, __pyx_int_4, 4, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_10, __pyx_int_4, 4, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":787
+    /* "fastremap.pyx":798
  *     return arr.view(dtype)
  *   elif arr.ndim == 4:
  *     arr = ipt4d(arr)             # <<<<<<<<<<<<<<
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,
  *       strides=(
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_ipt4d); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 787, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_ipt4d); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 798, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_10);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_10, function);
       }
     }
     __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_6, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 787, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 798, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastremap.pyx":788
+    /* "fastremap.pyx":799
  *   elif arr.ndim == 4:
  *     arr = ipt4d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,             # <<<<<<<<<<<<<<
  *       strides=(
  *         nbytes,
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 799, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_lib); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 788, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_lib); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 799, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 799, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 788, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 799, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 799, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_arr);
     __Pyx_GIVEREF(__pyx_v_arr);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_arr);
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 788, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 799, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 788, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 799, __pyx_L1_error)
 
-    /* "fastremap.pyx":790
+    /* "fastremap.pyx":801
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,
  *       strides=(
  *         nbytes,             # <<<<<<<<<<<<<<
  *         shape[0] * nbytes,
  *         shape[0] * shape[1] * nbytes,
  */
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 790, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
 
-    /* "fastremap.pyx":791
+    /* "fastremap.pyx":802
  *       strides=(
  *         nbytes,
  *         shape[0] * nbytes,             # <<<<<<<<<<<<<<
  *         shape[0] * shape[1] * nbytes,
  *         shape[0] * shape[1] * shape[2] * nbytes
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 791, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 802, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 791, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 802, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 791, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 802, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastremap.pyx":792
+    /* "fastremap.pyx":803
  *         nbytes,
  *         shape[0] * nbytes,
  *         shape[0] * shape[1] * nbytes,             # <<<<<<<<<<<<<<
  *         shape[0] * shape[1] * shape[2] * nbytes
  *       ))
  */
-    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 792, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 803, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 792, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 803, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_11 = PyNumber_Multiply(__pyx_t_8, __pyx_t_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 792, __pyx_L1_error)
+    __pyx_t_11 = PyNumber_Multiply(__pyx_t_8, __pyx_t_2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 803, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 792, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 803, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_8 = PyNumber_Multiply(__pyx_t_11, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 792, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Multiply(__pyx_t_11, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 803, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "fastremap.pyx":793
+    /* "fastremap.pyx":804
  *         shape[0] * nbytes,
  *         shape[0] * shape[1] * nbytes,
  *         shape[0] * shape[1] * shape[2] * nbytes             # <<<<<<<<<<<<<<
  *       ))
  *     return arr.view(dtype)
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 793, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 793, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_12 = PyNumber_Multiply(__pyx_t_2, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 793, __pyx_L1_error)
+    __pyx_t_12 = PyNumber_Multiply(__pyx_t_2, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_shape, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 793, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_GetItemInt(__pyx_v_shape, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_2 = PyNumber_Multiply(__pyx_t_12, __pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 793, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Multiply(__pyx_t_12, __pyx_t_11); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 793, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_12 = PyNumber_Multiply(__pyx_t_2, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 793, __pyx_L1_error)
+    __pyx_t_12 = PyNumber_Multiply(__pyx_t_2, __pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastremap.pyx":790
+    /* "fastremap.pyx":801
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,
  *       strides=(
  *         nbytes,             # <<<<<<<<<<<<<<
  *         shape[0] * nbytes,
  *         shape[0] * shape[1] * nbytes,
  */
-    __pyx_t_11 = PyTuple_New(4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 790, __pyx_L1_error)
+    __pyx_t_11 = PyTuple_New(4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 801, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_11, 2, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_12);
     PyTuple_SET_ITEM(__pyx_t_11, 3, __pyx_t_12);
     __pyx_t_9 = 0;
     __pyx_t_5 = 0;
     __pyx_t_8 = 0;
     __pyx_t_12 = 0;
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_strides, __pyx_t_11) < 0) __PYX_ERR(0, 788, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_strides, __pyx_t_11) < 0) __PYX_ERR(0, 799, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastremap.pyx":788
+    /* "fastremap.pyx":799
  *   elif arr.ndim == 4:
  *     arr = ipt4d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,             # <<<<<<<<<<<<<<
  *       strides=(
  *         nbytes,
  */
-    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 788, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 799, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_11);
     __pyx_t_11 = 0;
 
-    /* "fastremap.pyx":795
+    /* "fastremap.pyx":806
  *         shape[0] * shape[1] * shape[2] * nbytes
  *       ))
  *     return arr.view(dtype)             # <<<<<<<<<<<<<<
  *   else:
  *     return np.asfortranarray(arr)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 795, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_11 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_v_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_dtype);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 795, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_r = __pyx_t_11;
     __pyx_t_11 = 0;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":786
+    /* "fastremap.pyx":797
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(nbytes, shape[0] * nbytes, shape[0] * shape[1] * nbytes))
  *     return arr.view(dtype)
  *   elif arr.ndim == 4:             # <<<<<<<<<<<<<<
  *     arr = ipt4d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,
  */
   }
 
-  /* "fastremap.pyx":797
+  /* "fastremap.pyx":808
  *     return arr.view(dtype)
  *   else:
  *     return np.asfortranarray(arr)             # <<<<<<<<<<<<<<
  * 
  * def ascontiguousarray(arr):
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 797, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_asfortranarray); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 797, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_asfortranarray); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_11 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 797, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_r = __pyx_t_11;
     __pyx_t_11 = 0;
     goto __pyx_L0;
   }
 
-  /* "fastremap.pyx":751
+  /* "fastremap.pyx":762
  *     return arr.T
  * 
  * def asfortranarray(arr):             # <<<<<<<<<<<<<<
  *   """
  *   asfortranarray(arr)
  */
 
@@ -52454,15 +53904,15 @@
   __Pyx_XDECREF(__pyx_v_dtype);
   __Pyx_XDECREF(__pyx_v_arr);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastremap.pyx":799
+/* "fastremap.pyx":810
  *     return np.asfortranarray(arr)
  * 
  * def ascontiguousarray(arr):             # <<<<<<<<<<<<<<
  *   """
  *   ascontiguousarray(arr)
  */
 
@@ -52498,252 +53948,252 @@
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   PyObject *__pyx_t_10 = NULL;
   PyObject *__pyx_t_11 = NULL;
   __Pyx_RefNannySetupContext("ascontiguousarray", 0);
   __Pyx_INCREF(__pyx_v_arr);
 
-  /* "fastremap.pyx":810
+  /* "fastremap.pyx":821
  *   Returns: transposed numpy array
  *   """
  *   if arr.flags['C_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     return arr
  *   elif not arr.flags['F_CONTIGUOUS']:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_1, __pyx_n_u_C_CONTIGUOUS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_1, __pyx_n_u_C_CONTIGUOUS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_3) {
 
-    /* "fastremap.pyx":811
+    /* "fastremap.pyx":822
  *   """
  *   if arr.flags['C_CONTIGUOUS']:
  *     return arr             # <<<<<<<<<<<<<<
  *   elif not arr.flags['F_CONTIGUOUS']:
  *     return np.ascontiguousarray(arr)
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_v_arr);
     __pyx_r = __pyx_v_arr;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":810
+    /* "fastremap.pyx":821
  *   Returns: transposed numpy array
  *   """
  *   if arr.flags['C_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     return arr
  *   elif not arr.flags['F_CONTIGUOUS']:
  */
   }
 
-  /* "fastremap.pyx":812
+  /* "fastremap.pyx":823
  *   if arr.flags['C_CONTIGUOUS']:
  *     return arr
  *   elif not arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     return np.ascontiguousarray(arr)
  *   elif arr.ndim == 1:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 812, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 823, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 812, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 823, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 812, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 823, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_4 = ((!__pyx_t_3) != 0);
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":813
+    /* "fastremap.pyx":824
  *     return arr
  *   elif not arr.flags['F_CONTIGUOUS']:
  *     return np.ascontiguousarray(arr)             # <<<<<<<<<<<<<<
  *   elif arr.ndim == 1:
  *     return arr
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 813, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 824, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ascontiguousarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 813, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ascontiguousarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 824, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 813, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 824, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":812
+    /* "fastremap.pyx":823
  *   if arr.flags['C_CONTIGUOUS']:
  *     return arr
  *   elif not arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     return np.ascontiguousarray(arr)
  *   elif arr.ndim == 1:
  */
   }
 
-  /* "fastremap.pyx":814
+  /* "fastremap.pyx":825
  *   elif not arr.flags['F_CONTIGUOUS']:
  *     return np.ascontiguousarray(arr)
  *   elif arr.ndim == 1:             # <<<<<<<<<<<<<<
  *     return arr
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":815
+    /* "fastremap.pyx":826
  *     return np.ascontiguousarray(arr)
  *   elif arr.ndim == 1:
  *     return arr             # <<<<<<<<<<<<<<
  * 
  *   shape = arr.shape
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_v_arr);
     __pyx_r = __pyx_v_arr;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":814
+    /* "fastremap.pyx":825
  *   elif not arr.flags['F_CONTIGUOUS']:
  *     return np.ascontiguousarray(arr)
  *   elif arr.ndim == 1:             # <<<<<<<<<<<<<<
  *     return arr
  * 
  */
   }
 
-  /* "fastremap.pyx":817
+  /* "fastremap.pyx":828
  *     return arr
  * 
  *   shape = arr.shape             # <<<<<<<<<<<<<<
  *   strides = arr.strides
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 817, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 828, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_v_shape = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "fastremap.pyx":818
+  /* "fastremap.pyx":829
  * 
  *   shape = arr.shape
  *   strides = arr.strides             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_strides); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 818, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_strides); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 829, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_v_strides = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "fastremap.pyx":820
+  /* "fastremap.pyx":831
  *   strides = arr.strides
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   dtype = arr.dtype
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 820, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 820, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 820, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 820, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 831, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 820, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 820, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 831, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":822
+  /* "fastremap.pyx":833
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  * 
  *   dtype = arr.dtype             # <<<<<<<<<<<<<<
  *   if arr.dtype == np.bool:
  *     arr = arr.view(np.uint8)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 822, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 833, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_v_dtype = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastremap.pyx":823
+  /* "fastremap.pyx":834
  * 
  *   dtype = arr.dtype
  *   if arr.dtype == np.bool:             # <<<<<<<<<<<<<<
  *     arr = arr.view(np.uint8)
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 823, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 834, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 823, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 834, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_bool); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 823, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_bool); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 834, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 823, __pyx_L1_error)
+  __pyx_t_5 = PyObject_RichCompare(__pyx_t_2, __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 834, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 823, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 834, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":824
+    /* "fastremap.pyx":835
  *   dtype = arr.dtype
  *   if arr.dtype == np.bool:
  *     arr = arr.view(np.uint8)             # <<<<<<<<<<<<<<
  * 
  *   if arr.ndim == 2:
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 824, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 835, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 824, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 835, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 824, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_uint8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 835, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -52751,614 +54201,614 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 824, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 835, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "fastremap.pyx":823
+    /* "fastremap.pyx":834
  * 
  *   dtype = arr.dtype
  *   if arr.dtype == np.bool:             # <<<<<<<<<<<<<<
  *     arr = arr.view(np.uint8)
  * 
  */
   }
 
-  /* "fastremap.pyx":826
+  /* "fastremap.pyx":837
  *     arr = arr.view(np.uint8)
  * 
  *   if arr.ndim == 2:             # <<<<<<<<<<<<<<
  *     arr = ipt2d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(shape[1] * nbytes, nbytes))
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 826, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 837, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_5, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 826, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_5, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 837, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 826, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 837, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":827
+    /* "fastremap.pyx":838
  * 
  *   if arr.ndim == 2:
  *     arr = ipt2d(arr)             # <<<<<<<<<<<<<<
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(shape[1] * nbytes, nbytes))
  *     return arr.view(dtype)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_ipt2d); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_ipt2d); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 838, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 827, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastremap.pyx":828
+    /* "fastremap.pyx":839
  *   if arr.ndim == 2:
  *     arr = ipt2d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(shape[1] * nbytes, nbytes))             # <<<<<<<<<<<<<<
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_lib); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_lib); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_arr);
     __Pyx_GIVEREF(__pyx_v_arr);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_arr);
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 828, __pyx_L1_error)
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 828, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 839, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = PyNumber_Multiply(__pyx_t_2, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_t_2, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_8);
     __pyx_t_9 = 0;
     __pyx_t_8 = 0;
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_strides, __pyx_t_2) < 0) __PYX_ERR(0, 828, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_strides, __pyx_t_2) < 0) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 839, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "fastremap.pyx":829
+    /* "fastremap.pyx":840
  *     arr = ipt2d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(shape[1] * nbytes, nbytes))
  *     return arr.view(dtype)             # <<<<<<<<<<<<<<
  *   elif arr.ndim == 3:
  *     arr = ipt3d(arr)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 829, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_v_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_dtype);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 829, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 840, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":826
+    /* "fastremap.pyx":837
  *     arr = arr.view(np.uint8)
  * 
  *   if arr.ndim == 2:             # <<<<<<<<<<<<<<
  *     arr = ipt2d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(shape[1] * nbytes, nbytes))
  */
   }
 
-  /* "fastremap.pyx":830
+  /* "fastremap.pyx":841
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(shape[1] * nbytes, nbytes))
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:             # <<<<<<<<<<<<<<
  *     arr = ipt3d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 830, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 841, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_2, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 830, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_EqObjC(__pyx_t_2, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 841, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 830, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 841, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":831
+    /* "fastremap.pyx":842
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:
  *     arr = ipt3d(arr)             # <<<<<<<<<<<<<<
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(
  *         shape[2] * shape[1] * nbytes,
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_ipt3d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_ipt3d); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_6 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 831, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 842, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "fastremap.pyx":832
+    /* "fastremap.pyx":843
  *   elif arr.ndim == 3:
  *     arr = ipt3d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(             # <<<<<<<<<<<<<<
  *         shape[2] * shape[1] * nbytes,
  *         shape[2] * nbytes,
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 832, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 843, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_lib); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 832, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_lib); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 832, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 843, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 832, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 832, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 843, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_v_arr);
     __Pyx_GIVEREF(__pyx_v_arr);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_arr);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 832, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 843, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 832, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 843, __pyx_L1_error)
 
-    /* "fastremap.pyx":833
+    /* "fastremap.pyx":844
  *     arr = ipt3d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(
  *         shape[2] * shape[1] * nbytes,             # <<<<<<<<<<<<<<
  *         shape[2] * nbytes,
  *         nbytes,
  */
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_shape, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 833, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_shape, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 844, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 833, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 844, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = PyNumber_Multiply(__pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 833, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 844, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 833, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 844, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_5 = PyNumber_Multiply(__pyx_t_9, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 833, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Multiply(__pyx_t_9, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 844, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastremap.pyx":834
+    /* "fastremap.pyx":845
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(
  *         shape[2] * shape[1] * nbytes,
  *         shape[2] * nbytes,             # <<<<<<<<<<<<<<
  *         nbytes,
  *       ))
  */
-    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_shape, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 834, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_GetItemInt(__pyx_v_shape, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 845, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 834, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 845, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_10 = PyNumber_Multiply(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 834, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Multiply(__pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 845, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "fastremap.pyx":835
+    /* "fastremap.pyx":846
  *         shape[2] * shape[1] * nbytes,
  *         shape[2] * nbytes,
  *         nbytes,             # <<<<<<<<<<<<<<
  *       ))
  *     return arr.view(dtype)
  */
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 835, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 846, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
 
-    /* "fastremap.pyx":833
+    /* "fastremap.pyx":844
  *     arr = ipt3d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(
  *         shape[2] * shape[1] * nbytes,             # <<<<<<<<<<<<<<
  *         shape[2] * nbytes,
  *         nbytes,
  */
-    __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 833, __pyx_L1_error)
+    __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 844, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_10);
     PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_10);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_t_9);
     __pyx_t_5 = 0;
     __pyx_t_10 = 0;
     __pyx_t_9 = 0;
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_strides, __pyx_t_8) < 0) __PYX_ERR(0, 832, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_strides, __pyx_t_8) < 0) __PYX_ERR(0, 843, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastremap.pyx":832
+    /* "fastremap.pyx":843
  *   elif arr.ndim == 3:
  *     arr = ipt3d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(             # <<<<<<<<<<<<<<
  *         shape[2] * shape[1] * nbytes,
  *         shape[2] * nbytes,
  */
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 832, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 843, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_8);
     __pyx_t_8 = 0;
 
-    /* "fastremap.pyx":837
+    /* "fastremap.pyx":848
  *         nbytes,
  *       ))
  *     return arr.view(dtype)             # <<<<<<<<<<<<<<
  *   elif arr.ndim == 4:
  *     arr = ipt4d(arr)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 837, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 848, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_8 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_v_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_dtype);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 837, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 848, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_r = __pyx_t_8;
     __pyx_t_8 = 0;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":830
+    /* "fastremap.pyx":841
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(shape[1] * nbytes, nbytes))
  *     return arr.view(dtype)
  *   elif arr.ndim == 3:             # <<<<<<<<<<<<<<
  *     arr = ipt3d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape, strides=(
  */
   }
 
-  /* "fastremap.pyx":838
+  /* "fastremap.pyx":849
  *       ))
  *     return arr.view(dtype)
  *   elif arr.ndim == 4:             # <<<<<<<<<<<<<<
  *     arr = ipt4d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 838, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_ndim); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_8, __pyx_int_4, 4, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_8, __pyx_int_4, 4, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 838, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 849, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":839
+    /* "fastremap.pyx":850
  *     return arr.view(dtype)
  *   elif arr.ndim == 4:
  *     arr = ipt4d(arr)             # <<<<<<<<<<<<<<
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,
  *       strides=(
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_ipt4d); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 839, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_ipt4d); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 850, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_8, function);
       }
     }
     __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_6, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 839, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastremap.pyx":840
+    /* "fastremap.pyx":851
  *   elif arr.ndim == 4:
  *     arr = ipt4d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,             # <<<<<<<<<<<<<<
  *       strides=(
  *         shape[3] * shape[2] * shape[1] * nbytes,
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_lib); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 840, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_lib); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_stride_tricks); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 840, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_as_strided); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_arr);
     __Pyx_GIVEREF(__pyx_v_arr);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_arr);
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 840, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 840, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_shape, __pyx_v_shape) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
 
-    /* "fastremap.pyx":842
+    /* "fastremap.pyx":853
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,
  *       strides=(
  *         shape[3] * shape[2] * shape[1] * nbytes,             # <<<<<<<<<<<<<<
  *         shape[3] * shape[2] * nbytes,
  *         shape[3] * nbytes,
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_shape, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_shape, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_10 = PyNumber_Multiply(__pyx_t_2, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Multiply(__pyx_t_2, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_shape, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_2 = PyNumber_Multiply(__pyx_t_10, __pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Multiply(__pyx_t_10, __pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_10 = PyNumber_Multiply(__pyx_t_2, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Multiply(__pyx_t_2, __pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "fastremap.pyx":843
+    /* "fastremap.pyx":854
  *       strides=(
  *         shape[3] * shape[2] * shape[1] * nbytes,
  *         shape[3] * shape[2] * nbytes,             # <<<<<<<<<<<<<<
  *         shape[3] * nbytes,
  *         nbytes,
  */
-    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_shape, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 843, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_GetItemInt(__pyx_v_shape, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 854, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 854, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = PyNumber_Multiply(__pyx_t_9, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 843, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Multiply(__pyx_t_9, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 854, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 854, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_9 = PyNumber_Multiply(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 843, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Multiply(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 854, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "fastremap.pyx":844
+    /* "fastremap.pyx":855
  *         shape[3] * shape[2] * shape[1] * nbytes,
  *         shape[3] * shape[2] * nbytes,
  *         shape[3] * nbytes,             # <<<<<<<<<<<<<<
  *         nbytes,
  *       ))
  */
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 844, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_shape, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 855, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 844, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 855, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_11 = PyNumber_Multiply(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 844, __pyx_L1_error)
+    __pyx_t_11 = PyNumber_Multiply(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 855, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "fastremap.pyx":845
+    /* "fastremap.pyx":856
  *         shape[3] * shape[2] * nbytes,
  *         shape[3] * nbytes,
  *         nbytes,             # <<<<<<<<<<<<<<
  *       ))
  *     return arr.view(dtype)
  */
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 845, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_nbytes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 856, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
 
-    /* "fastremap.pyx":842
+    /* "fastremap.pyx":853
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,
  *       strides=(
  *         shape[3] * shape[2] * shape[1] * nbytes,             # <<<<<<<<<<<<<<
  *         shape[3] * shape[2] * nbytes,
  *         shape[3] * nbytes,
  */
-    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_10);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_10);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_11);
     PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_11);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_t_5);
     __pyx_t_10 = 0;
     __pyx_t_9 = 0;
     __pyx_t_11 = 0;
     __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_strides, __pyx_t_2) < 0) __PYX_ERR(0, 840, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_strides, __pyx_t_2) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "fastremap.pyx":840
+    /* "fastremap.pyx":851
  *   elif arr.ndim == 4:
  *     arr = ipt4d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,             # <<<<<<<<<<<<<<
  *       strides=(
  *         shape[3] * shape[2] * shape[1] * nbytes,
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 840, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 851, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF_SET(__pyx_v_arr, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "fastremap.pyx":847
+    /* "fastremap.pyx":858
  *         nbytes,
  *       ))
  *     return arr.view(dtype)             # <<<<<<<<<<<<<<
  *   else:
  *     return np.ascontiguousarray(arr)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 847, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arr, __pyx_n_s_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 858, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_v_dtype) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_dtype);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 847, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 858, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
 
-    /* "fastremap.pyx":838
+    /* "fastremap.pyx":849
  *       ))
  *     return arr.view(dtype)
  *   elif arr.ndim == 4:             # <<<<<<<<<<<<<<
  *     arr = ipt4d(arr)
  *     arr = np.lib.stride_tricks.as_strided(arr, shape=shape,
  */
   }
 
-  /* "fastremap.pyx":849
+  /* "fastremap.pyx":860
  *     return arr.view(dtype)
  *   else:
  *     return np.ascontiguousarray(arr)             # <<<<<<<<<<<<<<
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 849, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 860, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ascontiguousarray); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 849, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ascontiguousarray); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 860, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_v_arr) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_arr);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 849, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 860, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
   }
 
-  /* "fastremap.pyx":799
+  /* "fastremap.pyx":810
  *     return np.asfortranarray(arr)
  * 
  * def ascontiguousarray(arr):             # <<<<<<<<<<<<<<
  *   """
  *   ascontiguousarray(arr)
  */
 
@@ -53380,15 +54830,15 @@
   __Pyx_XDECREF(__pyx_v_dtype);
   __Pyx_XDECREF(__pyx_v_arr);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastremap.pyx":851
+/* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -53426,31 +54876,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 1); __PYX_ERR(0, 851, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 1); __PYX_ERR(0, 862, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 2); __PYX_ERR(0, 851, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 2); __PYX_ERR(0, 862, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 3); __PYX_ERR(0, 851, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 3); __PYX_ERR(0, 862, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") < 0)) __PYX_ERR(0, 851, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") < 0)) __PYX_ERR(0, 862, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -53459,15 +54909,15 @@
     __pyx_v_signatures = values[0];
     __pyx_v_args = values[1];
     __pyx_v_kwargs = values[2];
     __pyx_v_defaults = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 851, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 862, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastremap.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9fastremap_48ipt2d(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
 
@@ -53518,146 +54968,146 @@
   PyObject *__pyx_t_14 = NULL;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   int __pyx_t_18;
   __Pyx_RefNannySetupContext("ipt2d", 0);
   __Pyx_INCREF(__pyx_v_kwargs);
-  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
   PyList_SET_ITEM(__pyx_t_1, 0, Py_None);
   __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
   __pyx_t_3 = (__pyx_v_kwargs != Py_None);
   __pyx_t_4 = (__pyx_t_3 != 0);
   if (__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_kwargs); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_kwargs); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_t_3 = ((!__pyx_t_4) != 0);
   __pyx_t_2 = __pyx_t_3;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_2) {
     __Pyx_INCREF(Py_None);
     __Pyx_DECREF_SET(__pyx_v_kwargs, Py_None);
   }
-  __pyx_t_1 = ((PyObject *)__Pyx_ImportNumPyArrayTypeIfAvailable()); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__Pyx_ImportNumPyArrayTypeIfAvailable()); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
   __pyx_t_1 = 0;
   __pyx_v_itemsize = -1L;
   __pyx_v____pyx_uint8_t_is_signed = (!((((uint8_t)-1L) > 0) != 0));
   __pyx_v____pyx_uint16_t_is_signed = (!((((uint16_t)-1L) > 0) != 0));
   __pyx_v____pyx_uint32_t_is_signed = (!((((uint32_t)-1L) > 0) != 0));
   __pyx_v____pyx_uint64_t_is_signed = (!((((uint64_t)-1L) > 0) != 0));
   __pyx_v____pyx_int8_t_is_signed = (!((((int8_t)-1L) > 0) != 0));
   __pyx_v____pyx_int16_t_is_signed = (!((((int16_t)-1L) > 0) != 0));
   __pyx_v____pyx_int32_t_is_signed = (!((((int32_t)-1L) > 0) != 0));
   __pyx_v____pyx_int64_t_is_signed = (!((((int64_t)-1L) > 0) != 0));
   if (unlikely(__pyx_v_args == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(0, 851, __pyx_L1_error)
+    __PYX_ERR(0, 862, __pyx_L1_error)
   }
-  __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_t_2 = ((0 < __pyx_t_5) != 0);
   if (__pyx_t_2) {
     if (unlikely(__pyx_v_args == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 851, __pyx_L1_error)
+      __PYX_ERR(0, 862, __pyx_L1_error)
     }
-    __pyx_t_1 = __Pyx_GetItemInt_Tuple(((PyObject*)__pyx_v_args), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt_Tuple(((PyObject*)__pyx_v_args), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_arg = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L6;
   }
   __pyx_t_3 = (__pyx_v_kwargs != Py_None);
   __pyx_t_4 = (__pyx_t_3 != 0);
   if (__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L7_bool_binop_done;
   }
   if (unlikely(__pyx_v_kwargs == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 851, __pyx_L1_error)
+    __PYX_ERR(0, 862, __pyx_L1_error)
   }
-  __pyx_t_4 = (__Pyx_PyDict_ContainsTF(__pyx_n_s_arr, ((PyObject*)__pyx_v_kwargs), Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyDict_ContainsTF(__pyx_n_s_arr, ((PyObject*)__pyx_v_kwargs), Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_t_3 = (__pyx_t_4 != 0);
   __pyx_t_2 = __pyx_t_3;
   __pyx_L7_bool_binop_done:;
   if (__pyx_t_2) {
     if (unlikely(__pyx_v_kwargs == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 851, __pyx_L1_error)
+      __PYX_ERR(0, 862, __pyx_L1_error)
     }
-    __pyx_t_1 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_kwargs), __pyx_n_s_arr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_kwargs), __pyx_n_s_arr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_arg = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L6;
   }
   /*else*/ {
     if (unlikely(__pyx_v_args == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-      __PYX_ERR(0, 851, __pyx_L1_error)
+      __PYX_ERR(0, 862, __pyx_L1_error)
     }
-    __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 851, __pyx_L1_error)
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 862, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_int_1);
     __Pyx_INCREF(__pyx_kp_s_);
     __Pyx_GIVEREF(__pyx_kp_s_);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_kp_s_);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Expected_at_least_d_argument_s_g, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Expected_at_least_d_argument_s_g, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 851, __pyx_L1_error)
+    __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_L6:;
   while (1) {
     __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
     __pyx_t_3 = (__pyx_t_2 != 0);
     if (__pyx_t_3) {
       __pyx_t_3 = __Pyx_TypeCheck(__pyx_v_arg, __pyx_v_ndarray); 
       __pyx_t_2 = (__pyx_t_3 != 0);
       if (__pyx_t_2) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_v_dtype = __pyx_t_6;
         __pyx_t_6 = 0;
         goto __pyx_L12;
       }
       __pyx_t_2 = __pyx_memoryview_check(__pyx_v_arg); 
       __pyx_t_3 = (__pyx_t_2 != 0);
       if (__pyx_t_3) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_base); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_base); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_v_arg_base = __pyx_t_6;
         __pyx_t_6 = 0;
         __pyx_t_3 = __Pyx_TypeCheck(__pyx_v_arg_base, __pyx_v_ndarray); 
         __pyx_t_2 = (__pyx_t_3 != 0);
         if (__pyx_t_2) {
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg_base, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg_base, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __pyx_v_dtype = __pyx_t_6;
           __pyx_t_6 = 0;
           goto __pyx_L13;
         }
         /*else*/ {
           __Pyx_INCREF(Py_None);
@@ -53671,265 +55121,265 @@
         __pyx_v_dtype = Py_None;
       }
       __pyx_L12:;
       __pyx_v_itemsize = -1L;
       __pyx_t_2 = (__pyx_v_dtype != Py_None);
       __pyx_t_3 = (__pyx_t_2 != 0);
       if (__pyx_t_3) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_v_itemsize = __pyx_t_5;
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_kind); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_kind); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_Ord(__pyx_t_6); if (unlikely(__pyx_t_7 == ((long)(long)(Py_UCS4)-1))) __PYX_ERR(0, 851, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Ord(__pyx_t_6); if (unlikely(__pyx_t_7 == ((long)(long)(Py_UCS4)-1))) __PYX_ERR(0, 862, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_v_kind = __pyx_t_7;
         __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
         switch (__pyx_v_kind) {
           case 'i':
           case 'u':
           __pyx_t_2 = (((sizeof(uint8_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L16_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 2) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L16_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint8_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L16_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(uint16_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L20_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 2) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L20_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint16_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L20_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(uint32_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L24_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 2) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L24_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint32_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L24_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(uint64_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L28_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 2) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L28_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint64_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L28_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int8_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L32_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 2) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L32_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int8_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L32_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int16_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L36_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 2) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L36_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int16_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L36_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int32_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L40_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 2) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L40_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int32_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L40_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int64_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L44_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 2) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L44_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int64_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L44_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           break;
           case 'f':
           __pyx_t_2 = (((sizeof(float)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L48_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 2) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L48_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(double)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L51_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 2) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L51_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           break;
           case 'c':
           __pyx_t_2 = (((sizeof(__pyx_t_float_complex)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L54_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 862, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 2) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L54_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           break;
           case 'O':
           break;
           default: break;
         }
@@ -53946,15 +55396,15 @@
     __pyx_L57_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint8_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -53968,15 +55418,15 @@
     __pyx_L61_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint16_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -53990,15 +55440,15 @@
     __pyx_L65_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint32_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -54012,15 +55462,15 @@
     __pyx_L69_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint64_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -54034,15 +55484,15 @@
     __pyx_L73_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int8_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -54056,15 +55506,15 @@
     __pyx_L77_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int16_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -54078,15 +55528,15 @@
     __pyx_L81_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int32_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -54100,15 +55550,15 @@
     __pyx_L85_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int64_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -54122,15 +55572,15 @@
     __pyx_L89_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -54144,15 +55594,15 @@
     __pyx_L93_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -54166,100 +55616,100 @@
     __pyx_L97_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_float_complex(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
-    if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
     goto __pyx_L10_break;
   }
   __pyx_L10_break:;
-  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_v_candidates = ((PyObject*)__pyx_t_6);
   __pyx_t_6 = 0;
   __pyx_t_5 = 0;
   if (unlikely(__pyx_v_signatures == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 851, __pyx_L1_error)
+    __PYX_ERR(0, 862, __pyx_L1_error)
   }
-  __pyx_t_1 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&__pyx_t_9), (&__pyx_t_10)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&__pyx_t_9), (&__pyx_t_10)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_6);
   __pyx_t_6 = __pyx_t_1;
   __pyx_t_1 = 0;
   while (1) {
     __pyx_t_11 = __Pyx_dict_iter_next(__pyx_t_6, __pyx_t_9, &__pyx_t_5, &__pyx_t_1, NULL, NULL, __pyx_t_10);
     if (unlikely(__pyx_t_11 == 0)) break;
-    if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_XDECREF_SET(__pyx_v_sig, __pyx_t_1);
     __pyx_t_1 = 0;
     __pyx_v_match_found = 0;
-    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_sig, __pyx_n_s_strip); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_sig, __pyx_n_s_strip); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __pyx_t_14 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
       __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
       if (likely(__pyx_t_14)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
         __Pyx_INCREF(__pyx_t_14);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_13, function);
       }
     }
     __pyx_t_12 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_14, __pyx_kp_s__2) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_kp_s__2);
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_split); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_split); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __pyx_t_12 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
       __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_13);
       if (likely(__pyx_t_12)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
         __Pyx_INCREF(__pyx_t_12);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_13, function);
       }
     }
     __pyx_t_1 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_12, __pyx_kp_s__3) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_kp_s__3);
     __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_XDECREF_SET(__pyx_v_src_sig, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_15 = PyList_GET_SIZE(__pyx_v_dest_sig); if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1))) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_15 = PyList_GET_SIZE(__pyx_v_dest_sig); if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1))) __PYX_ERR(0, 862, __pyx_L1_error)
     __pyx_t_16 = __pyx_t_15;
     for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
       __pyx_v_i = __pyx_t_17;
-      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_dest_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_dest_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_XDECREF_SET(__pyx_v_dst_type, __pyx_t_1);
       __pyx_t_1 = 0;
       __pyx_t_3 = (__pyx_v_dst_type != Py_None);
       __pyx_t_2 = (__pyx_t_3 != 0);
       if (__pyx_t_2) {
-        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_src_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_src_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_13 = PyObject_RichCompare(__pyx_t_1, __pyx_v_dst_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 851, __pyx_L1_error)
+        __pyx_t_13 = PyObject_RichCompare(__pyx_t_1, __pyx_v_dst_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 862, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 851, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         if (__pyx_t_2) {
           __pyx_v_match_found = 1;
           goto __pyx_L105;
         }
         /*else*/ {
           __pyx_v_match_found = 0;
@@ -54267,45 +55717,45 @@
         }
         __pyx_L105:;
       }
     }
     __pyx_L103_break:;
     __pyx_t_2 = (__pyx_v_match_found != 0);
     if (__pyx_t_2) {
-      __pyx_t_18 = __Pyx_PyList_Append(__pyx_v_candidates, __pyx_v_sig); if (unlikely(__pyx_t_18 == ((int)-1))) __PYX_ERR(0, 851, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyList_Append(__pyx_v_candidates, __pyx_v_sig); if (unlikely(__pyx_t_18 == ((int)-1))) __PYX_ERR(0, 862, __pyx_L1_error)
     }
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_2 = (PyList_GET_SIZE(__pyx_v_candidates) != 0);
   __pyx_t_3 = ((!__pyx_t_2) != 0);
   if (__pyx_t_3) {
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 851, __pyx_L1_error)
+    __PYX_ERR(0, 862, __pyx_L1_error)
   }
-  __pyx_t_9 = PyList_GET_SIZE(__pyx_v_candidates); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_9 = PyList_GET_SIZE(__pyx_v_candidates); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_t_3 = ((__pyx_t_9 > 1) != 0);
   if (__pyx_t_3) {
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 851, __pyx_L1_error)
+    __PYX_ERR(0, 862, __pyx_L1_error)
   }
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     if (unlikely(__pyx_v_signatures == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 851, __pyx_L1_error)
+      __PYX_ERR(0, 862, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_candidates, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_candidates, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_13 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_signatures), __pyx_t_6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_signatures), __pyx_t_6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 862, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_r = __pyx_t_13;
     __pyx_t_13 = 0;
     goto __pyx_L0;
   }
 
@@ -54337,15 +55787,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_0__pyx_pw_9fastremap_221ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_0__pyx_mdef_9fastremap_221ipt2d = {"__pyx_fuse_0ipt2d", (PyCFunction)__pyx_fuse_0__pyx_pw_9fastremap_221ipt2d, METH_O, 0};
 static PyObject *__pyx_fuse_0__pyx_pw_9fastremap_221ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt2d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_220ipt2d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -54380,143 +55830,143 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_0ipt2d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "fastremap.pyx":852
+  /* "fastremap.pyx":863
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":857
+  /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":858
+    /* "fastremap.pyx":869
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *   else:
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":859
+    /* "fastremap.pyx":870
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[1]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":857
+    /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":861
+  /* "fastremap.pyx":872
  *     sy = arr.shape[1]
  *   else:
  *     sx = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[0]
  * 
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":862
+    /* "fastremap.pyx":873
  *   else:
  *     sx = arr.shape[1]
  *     sy = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":864
+  /* "fastremap.pyx":875
  *     sy = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":869
+  /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":871
+    /* "fastremap.pyx":882
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_8 = 0;
@@ -54528,37 +55978,37 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 871, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":870
+    /* "fastremap.pyx":881
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint8_t>(((uint8_t *)(&(*((uint8_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":869
+    /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":876
+    /* "fastremap.pyx":887
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_10 = 0;
@@ -54570,37 +56020,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 876, __pyx_L1_error)
+      __PYX_ERR(0, 887, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":875
+    /* "fastremap.pyx":886
  *     )
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint16_t>(((uint16_t *)(&(*((uint8_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_10 * __pyx_v_arrview.strides[0]) ) + __pyx_t_11 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":874
+    /* "fastremap.pyx":885
  *       sx, sy
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":881
+    /* "fastremap.pyx":892
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_12 = 0;
@@ -54612,37 +56062,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 881, __pyx_L1_error)
+      __PYX_ERR(0, 892, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":880
+    /* "fastremap.pyx":891
  *     )
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint32_t>(((uint32_t *)(&(*((uint8_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":879
+    /* "fastremap.pyx":890
  *       sx, sy
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":886
+    /* "fastremap.pyx":897
  *   else:
  *     _ipt2d[uint64_t](
  *       <uint64_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_14 = 0;
@@ -54654,41 +56104,41 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 886, __pyx_L1_error)
+      __PYX_ERR(0, 897, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":885
+    /* "fastremap.pyx":896
  *     )
  *   else:
  *     _ipt2d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint64_t>(((uint64_t *)(&(*((uint8_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
     break;
   }
 
-  /* "fastremap.pyx":890
+  /* "fastremap.pyx":901
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -54720,15 +56170,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_1__pyx_pw_9fastremap_223ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_1__pyx_mdef_9fastremap_223ipt2d = {"__pyx_fuse_1ipt2d", (PyCFunction)__pyx_fuse_1__pyx_pw_9fastremap_223ipt2d, METH_O, 0};
 static PyObject *__pyx_fuse_1__pyx_pw_9fastremap_223ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt2d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_222ipt2d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -54763,143 +56213,143 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_1ipt2d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint16_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint16_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "fastremap.pyx":852
+  /* "fastremap.pyx":863
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":857
+  /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":858
+    /* "fastremap.pyx":869
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *   else:
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":859
+    /* "fastremap.pyx":870
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[1]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":857
+    /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":861
+  /* "fastremap.pyx":872
  *     sy = arr.shape[1]
  *   else:
  *     sx = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[0]
  * 
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":862
+    /* "fastremap.pyx":873
  *   else:
  *     sx = arr.shape[1]
  *     sy = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":864
+  /* "fastremap.pyx":875
  *     sy = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":869
+  /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":871
+    /* "fastremap.pyx":882
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_8 = 0;
@@ -54911,37 +56361,37 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 871, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":870
+    /* "fastremap.pyx":881
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint8_t>(((uint8_t *)(&(*((uint16_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":869
+    /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":876
+    /* "fastremap.pyx":887
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_10 = 0;
@@ -54953,37 +56403,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 876, __pyx_L1_error)
+      __PYX_ERR(0, 887, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":875
+    /* "fastremap.pyx":886
  *     )
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint16_t>(((uint16_t *)(&(*((uint16_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_10 * __pyx_v_arrview.strides[0]) ) + __pyx_t_11 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":874
+    /* "fastremap.pyx":885
  *       sx, sy
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":881
+    /* "fastremap.pyx":892
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_12 = 0;
@@ -54995,37 +56445,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 881, __pyx_L1_error)
+      __PYX_ERR(0, 892, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":880
+    /* "fastremap.pyx":891
  *     )
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint32_t>(((uint32_t *)(&(*((uint16_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":879
+    /* "fastremap.pyx":890
  *       sx, sy
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":886
+    /* "fastremap.pyx":897
  *   else:
  *     _ipt2d[uint64_t](
  *       <uint64_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_14 = 0;
@@ -55037,41 +56487,41 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 886, __pyx_L1_error)
+      __PYX_ERR(0, 897, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":885
+    /* "fastremap.pyx":896
  *     )
  *   else:
  *     _ipt2d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint64_t>(((uint64_t *)(&(*((uint16_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
     break;
   }
 
-  /* "fastremap.pyx":890
+  /* "fastremap.pyx":901
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -55103,15 +56553,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_2__pyx_pw_9fastremap_225ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_2__pyx_mdef_9fastremap_225ipt2d = {"__pyx_fuse_2ipt2d", (PyCFunction)__pyx_fuse_2__pyx_pw_9fastremap_225ipt2d, METH_O, 0};
 static PyObject *__pyx_fuse_2__pyx_pw_9fastremap_225ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt2d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_224ipt2d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -55146,143 +56596,143 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_2ipt2d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "fastremap.pyx":852
+  /* "fastremap.pyx":863
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":857
+  /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":858
+    /* "fastremap.pyx":869
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *   else:
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":859
+    /* "fastremap.pyx":870
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[1]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":857
+    /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":861
+  /* "fastremap.pyx":872
  *     sy = arr.shape[1]
  *   else:
  *     sx = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[0]
  * 
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":862
+    /* "fastremap.pyx":873
  *   else:
  *     sx = arr.shape[1]
  *     sy = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":864
+  /* "fastremap.pyx":875
  *     sy = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":869
+  /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":871
+    /* "fastremap.pyx":882
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_8 = 0;
@@ -55294,37 +56744,37 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 871, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":870
+    /* "fastremap.pyx":881
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint8_t>(((uint8_t *)(&(*((uint32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":869
+    /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":876
+    /* "fastremap.pyx":887
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_10 = 0;
@@ -55336,37 +56786,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 876, __pyx_L1_error)
+      __PYX_ERR(0, 887, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":875
+    /* "fastremap.pyx":886
  *     )
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint16_t>(((uint16_t *)(&(*((uint32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_10 * __pyx_v_arrview.strides[0]) ) + __pyx_t_11 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":874
+    /* "fastremap.pyx":885
  *       sx, sy
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":881
+    /* "fastremap.pyx":892
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_12 = 0;
@@ -55378,37 +56828,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 881, __pyx_L1_error)
+      __PYX_ERR(0, 892, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":880
+    /* "fastremap.pyx":891
  *     )
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint32_t>(((uint32_t *)(&(*((uint32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":879
+    /* "fastremap.pyx":890
  *       sx, sy
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":886
+    /* "fastremap.pyx":897
  *   else:
  *     _ipt2d[uint64_t](
  *       <uint64_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_14 = 0;
@@ -55420,41 +56870,41 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 886, __pyx_L1_error)
+      __PYX_ERR(0, 897, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":885
+    /* "fastremap.pyx":896
  *     )
  *   else:
  *     _ipt2d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint64_t>(((uint64_t *)(&(*((uint32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
     break;
   }
 
-  /* "fastremap.pyx":890
+  /* "fastremap.pyx":901
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -55486,15 +56936,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_3__pyx_pw_9fastremap_227ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_3__pyx_mdef_9fastremap_227ipt2d = {"__pyx_fuse_3ipt2d", (PyCFunction)__pyx_fuse_3__pyx_pw_9fastremap_227ipt2d, METH_O, 0};
 static PyObject *__pyx_fuse_3__pyx_pw_9fastremap_227ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt2d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_226ipt2d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -55529,143 +56979,143 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_3ipt2d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "fastremap.pyx":852
+  /* "fastremap.pyx":863
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_uint64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":857
+  /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":858
+    /* "fastremap.pyx":869
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *   else:
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":859
+    /* "fastremap.pyx":870
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[1]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":857
+    /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":861
+  /* "fastremap.pyx":872
  *     sy = arr.shape[1]
  *   else:
  *     sx = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[0]
  * 
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":862
+    /* "fastremap.pyx":873
  *   else:
  *     sx = arr.shape[1]
  *     sy = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":864
+  /* "fastremap.pyx":875
  *     sy = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":869
+  /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":871
+    /* "fastremap.pyx":882
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_8 = 0;
@@ -55677,37 +57127,37 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 871, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":870
+    /* "fastremap.pyx":881
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint8_t>(((uint8_t *)(&(*((uint64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":869
+    /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":876
+    /* "fastremap.pyx":887
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_10 = 0;
@@ -55719,37 +57169,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 876, __pyx_L1_error)
+      __PYX_ERR(0, 887, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":875
+    /* "fastremap.pyx":886
  *     )
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint16_t>(((uint16_t *)(&(*((uint64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_10 * __pyx_v_arrview.strides[0]) ) + __pyx_t_11 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":874
+    /* "fastremap.pyx":885
  *       sx, sy
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":881
+    /* "fastremap.pyx":892
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_12 = 0;
@@ -55761,37 +57211,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 881, __pyx_L1_error)
+      __PYX_ERR(0, 892, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":880
+    /* "fastremap.pyx":891
  *     )
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint32_t>(((uint32_t *)(&(*((uint64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":879
+    /* "fastremap.pyx":890
  *       sx, sy
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":886
+    /* "fastremap.pyx":897
  *   else:
  *     _ipt2d[uint64_t](
  *       <uint64_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_14 = 0;
@@ -55803,41 +57253,41 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 886, __pyx_L1_error)
+      __PYX_ERR(0, 897, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":885
+    /* "fastremap.pyx":896
  *     )
  *   else:
  *     _ipt2d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint64_t>(((uint64_t *)(&(*((uint64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
     break;
   }
 
-  /* "fastremap.pyx":890
+  /* "fastremap.pyx":901
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -55869,15 +57319,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_4__pyx_pw_9fastremap_229ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_4__pyx_mdef_9fastremap_229ipt2d = {"__pyx_fuse_4ipt2d", (PyCFunction)__pyx_fuse_4__pyx_pw_9fastremap_229ipt2d, METH_O, 0};
 static PyObject *__pyx_fuse_4__pyx_pw_9fastremap_229ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt2d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_228ipt2d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -55912,143 +57362,143 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_4ipt2d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "fastremap.pyx":852
+  /* "fastremap.pyx":863
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":857
+  /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":858
+    /* "fastremap.pyx":869
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *   else:
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":859
+    /* "fastremap.pyx":870
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[1]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":857
+    /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":861
+  /* "fastremap.pyx":872
  *     sy = arr.shape[1]
  *   else:
  *     sx = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[0]
  * 
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":862
+    /* "fastremap.pyx":873
  *   else:
  *     sx = arr.shape[1]
  *     sy = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":864
+  /* "fastremap.pyx":875
  *     sy = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":869
+  /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":871
+    /* "fastremap.pyx":882
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_8 = 0;
@@ -56060,37 +57510,37 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 871, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":870
+    /* "fastremap.pyx":881
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint8_t>(((uint8_t *)(&(*((int8_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":869
+    /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":876
+    /* "fastremap.pyx":887
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_10 = 0;
@@ -56102,37 +57552,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 876, __pyx_L1_error)
+      __PYX_ERR(0, 887, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":875
+    /* "fastremap.pyx":886
  *     )
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint16_t>(((uint16_t *)(&(*((int8_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_10 * __pyx_v_arrview.strides[0]) ) + __pyx_t_11 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":874
+    /* "fastremap.pyx":885
  *       sx, sy
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":881
+    /* "fastremap.pyx":892
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_12 = 0;
@@ -56144,37 +57594,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 881, __pyx_L1_error)
+      __PYX_ERR(0, 892, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":880
+    /* "fastremap.pyx":891
  *     )
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint32_t>(((uint32_t *)(&(*((int8_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":879
+    /* "fastremap.pyx":890
  *       sx, sy
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":886
+    /* "fastremap.pyx":897
  *   else:
  *     _ipt2d[uint64_t](
  *       <uint64_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_14 = 0;
@@ -56186,41 +57636,41 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 886, __pyx_L1_error)
+      __PYX_ERR(0, 897, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":885
+    /* "fastremap.pyx":896
  *     )
  *   else:
  *     _ipt2d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint64_t>(((uint64_t *)(&(*((int8_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
     break;
   }
 
-  /* "fastremap.pyx":890
+  /* "fastremap.pyx":901
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -56252,15 +57702,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_5__pyx_pw_9fastremap_231ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_5__pyx_mdef_9fastremap_231ipt2d = {"__pyx_fuse_5ipt2d", (PyCFunction)__pyx_fuse_5__pyx_pw_9fastremap_231ipt2d, METH_O, 0};
 static PyObject *__pyx_fuse_5__pyx_pw_9fastremap_231ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt2d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_230ipt2d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -56295,143 +57745,143 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_5ipt2d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int16_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int16_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "fastremap.pyx":852
+  /* "fastremap.pyx":863
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":857
+  /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":858
+    /* "fastremap.pyx":869
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *   else:
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":859
+    /* "fastremap.pyx":870
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[1]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":857
+    /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":861
+  /* "fastremap.pyx":872
  *     sy = arr.shape[1]
  *   else:
  *     sx = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[0]
  * 
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":862
+    /* "fastremap.pyx":873
  *   else:
  *     sx = arr.shape[1]
  *     sy = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":864
+  /* "fastremap.pyx":875
  *     sy = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":869
+  /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":871
+    /* "fastremap.pyx":882
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_8 = 0;
@@ -56443,37 +57893,37 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 871, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":870
+    /* "fastremap.pyx":881
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint8_t>(((uint8_t *)(&(*((int16_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":869
+    /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":876
+    /* "fastremap.pyx":887
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_10 = 0;
@@ -56485,37 +57935,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 876, __pyx_L1_error)
+      __PYX_ERR(0, 887, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":875
+    /* "fastremap.pyx":886
  *     )
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint16_t>(((uint16_t *)(&(*((int16_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_10 * __pyx_v_arrview.strides[0]) ) + __pyx_t_11 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":874
+    /* "fastremap.pyx":885
  *       sx, sy
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":881
+    /* "fastremap.pyx":892
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_12 = 0;
@@ -56527,37 +57977,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 881, __pyx_L1_error)
+      __PYX_ERR(0, 892, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":880
+    /* "fastremap.pyx":891
  *     )
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint32_t>(((uint32_t *)(&(*((int16_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":879
+    /* "fastremap.pyx":890
  *       sx, sy
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":886
+    /* "fastremap.pyx":897
  *   else:
  *     _ipt2d[uint64_t](
  *       <uint64_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_14 = 0;
@@ -56569,41 +58019,41 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 886, __pyx_L1_error)
+      __PYX_ERR(0, 897, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":885
+    /* "fastremap.pyx":896
  *     )
  *   else:
  *     _ipt2d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint64_t>(((uint64_t *)(&(*((int16_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
     break;
   }
 
-  /* "fastremap.pyx":890
+  /* "fastremap.pyx":901
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -56635,15 +58085,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_6__pyx_pw_9fastremap_233ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_6__pyx_mdef_9fastremap_233ipt2d = {"__pyx_fuse_6ipt2d", (PyCFunction)__pyx_fuse_6__pyx_pw_9fastremap_233ipt2d, METH_O, 0};
 static PyObject *__pyx_fuse_6__pyx_pw_9fastremap_233ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt2d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_232ipt2d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -56678,143 +58128,143 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_6ipt2d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "fastremap.pyx":852
+  /* "fastremap.pyx":863
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":857
+  /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":858
+    /* "fastremap.pyx":869
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *   else:
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":859
+    /* "fastremap.pyx":870
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[1]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":857
+    /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":861
+  /* "fastremap.pyx":872
  *     sy = arr.shape[1]
  *   else:
  *     sx = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[0]
  * 
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":862
+    /* "fastremap.pyx":873
  *   else:
  *     sx = arr.shape[1]
  *     sy = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":864
+  /* "fastremap.pyx":875
  *     sy = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":869
+  /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":871
+    /* "fastremap.pyx":882
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_8 = 0;
@@ -56826,37 +58276,37 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 871, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":870
+    /* "fastremap.pyx":881
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint8_t>(((uint8_t *)(&(*((int32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":869
+    /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":876
+    /* "fastremap.pyx":887
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_10 = 0;
@@ -56868,37 +58318,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 876, __pyx_L1_error)
+      __PYX_ERR(0, 887, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":875
+    /* "fastremap.pyx":886
  *     )
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint16_t>(((uint16_t *)(&(*((int32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_10 * __pyx_v_arrview.strides[0]) ) + __pyx_t_11 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":874
+    /* "fastremap.pyx":885
  *       sx, sy
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":881
+    /* "fastremap.pyx":892
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_12 = 0;
@@ -56910,37 +58360,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 881, __pyx_L1_error)
+      __PYX_ERR(0, 892, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":880
+    /* "fastremap.pyx":891
  *     )
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint32_t>(((uint32_t *)(&(*((int32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":879
+    /* "fastremap.pyx":890
  *       sx, sy
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":886
+    /* "fastremap.pyx":897
  *   else:
  *     _ipt2d[uint64_t](
  *       <uint64_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_14 = 0;
@@ -56952,41 +58402,41 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 886, __pyx_L1_error)
+      __PYX_ERR(0, 897, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":885
+    /* "fastremap.pyx":896
  *     )
  *   else:
  *     _ipt2d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint64_t>(((uint64_t *)(&(*((int32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
     break;
   }
 
-  /* "fastremap.pyx":890
+  /* "fastremap.pyx":901
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -57018,15 +58468,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_7__pyx_pw_9fastremap_235ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_7__pyx_mdef_9fastremap_235ipt2d = {"__pyx_fuse_7ipt2d", (PyCFunction)__pyx_fuse_7__pyx_pw_9fastremap_235ipt2d, METH_O, 0};
 static PyObject *__pyx_fuse_7__pyx_pw_9fastremap_235ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt2d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_234ipt2d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -57061,143 +58511,143 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_7ipt2d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "fastremap.pyx":852
+  /* "fastremap.pyx":863
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn_int64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":857
+  /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":858
+    /* "fastremap.pyx":869
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *   else:
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":859
+    /* "fastremap.pyx":870
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[1]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":857
+    /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":861
+  /* "fastremap.pyx":872
  *     sy = arr.shape[1]
  *   else:
  *     sx = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[0]
  * 
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":862
+    /* "fastremap.pyx":873
  *   else:
  *     sx = arr.shape[1]
  *     sy = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":864
+  /* "fastremap.pyx":875
  *     sy = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":869
+  /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":871
+    /* "fastremap.pyx":882
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_8 = 0;
@@ -57209,37 +58659,37 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 871, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":870
+    /* "fastremap.pyx":881
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint8_t>(((uint8_t *)(&(*((int64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":869
+    /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":876
+    /* "fastremap.pyx":887
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_10 = 0;
@@ -57251,37 +58701,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 876, __pyx_L1_error)
+      __PYX_ERR(0, 887, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":875
+    /* "fastremap.pyx":886
  *     )
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint16_t>(((uint16_t *)(&(*((int64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_10 * __pyx_v_arrview.strides[0]) ) + __pyx_t_11 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":874
+    /* "fastremap.pyx":885
  *       sx, sy
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":881
+    /* "fastremap.pyx":892
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_12 = 0;
@@ -57293,37 +58743,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 881, __pyx_L1_error)
+      __PYX_ERR(0, 892, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":880
+    /* "fastremap.pyx":891
  *     )
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint32_t>(((uint32_t *)(&(*((int64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":879
+    /* "fastremap.pyx":890
  *       sx, sy
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":886
+    /* "fastremap.pyx":897
  *   else:
  *     _ipt2d[uint64_t](
  *       <uint64_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_14 = 0;
@@ -57335,41 +58785,41 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 886, __pyx_L1_error)
+      __PYX_ERR(0, 897, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":885
+    /* "fastremap.pyx":896
  *     )
  *   else:
  *     _ipt2d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint64_t>(((uint64_t *)(&(*((int64_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
     break;
   }
 
-  /* "fastremap.pyx":890
+  /* "fastremap.pyx":901
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -57401,15 +58851,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_8__pyx_pw_9fastremap_237ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_8__pyx_mdef_9fastremap_237ipt2d = {"__pyx_fuse_8ipt2d", (PyCFunction)__pyx_fuse_8__pyx_pw_9fastremap_237ipt2d, METH_O, 0};
 static PyObject *__pyx_fuse_8__pyx_pw_9fastremap_237ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt2d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_236ipt2d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -57444,143 +58894,143 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_8ipt2d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "fastremap.pyx":852
+  /* "fastremap.pyx":863
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_float(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":857
+  /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":858
+    /* "fastremap.pyx":869
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *   else:
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":859
+    /* "fastremap.pyx":870
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[1]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":857
+    /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":861
+  /* "fastremap.pyx":872
  *     sy = arr.shape[1]
  *   else:
  *     sx = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[0]
  * 
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":862
+    /* "fastremap.pyx":873
  *   else:
  *     sx = arr.shape[1]
  *     sy = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":864
+  /* "fastremap.pyx":875
  *     sy = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":869
+  /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":871
+    /* "fastremap.pyx":882
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_8 = 0;
@@ -57592,37 +59042,37 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 871, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":870
+    /* "fastremap.pyx":881
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint8_t>(((uint8_t *)(&(*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":869
+    /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":876
+    /* "fastremap.pyx":887
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_10 = 0;
@@ -57634,37 +59084,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 876, __pyx_L1_error)
+      __PYX_ERR(0, 887, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":875
+    /* "fastremap.pyx":886
  *     )
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint16_t>(((uint16_t *)(&(*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_10 * __pyx_v_arrview.strides[0]) ) + __pyx_t_11 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":874
+    /* "fastremap.pyx":885
  *       sx, sy
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":881
+    /* "fastremap.pyx":892
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_12 = 0;
@@ -57676,37 +59126,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 881, __pyx_L1_error)
+      __PYX_ERR(0, 892, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":880
+    /* "fastremap.pyx":891
  *     )
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint32_t>(((uint32_t *)(&(*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":879
+    /* "fastremap.pyx":890
  *       sx, sy
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":886
+    /* "fastremap.pyx":897
  *   else:
  *     _ipt2d[uint64_t](
  *       <uint64_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_14 = 0;
@@ -57718,41 +59168,41 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 886, __pyx_L1_error)
+      __PYX_ERR(0, 897, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":885
+    /* "fastremap.pyx":896
  *     )
  *   else:
  *     _ipt2d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint64_t>(((uint64_t *)(&(*((float *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
     break;
   }
 
-  /* "fastremap.pyx":890
+  /* "fastremap.pyx":901
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -57784,15 +59234,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_9__pyx_pw_9fastremap_239ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_9__pyx_mdef_9fastremap_239ipt2d = {"__pyx_fuse_9ipt2d", (PyCFunction)__pyx_fuse_9__pyx_pw_9fastremap_239ipt2d, METH_O, 0};
 static PyObject *__pyx_fuse_9__pyx_pw_9fastremap_239ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt2d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_238ipt2d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -57827,143 +59277,143 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_9ipt2d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "fastremap.pyx":852
+  /* "fastremap.pyx":863
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":857
+  /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":858
+    /* "fastremap.pyx":869
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *   else:
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":859
+    /* "fastremap.pyx":870
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[1]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":857
+    /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":861
+  /* "fastremap.pyx":872
  *     sy = arr.shape[1]
  *   else:
  *     sx = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[0]
  * 
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":862
+    /* "fastremap.pyx":873
  *   else:
  *     sx = arr.shape[1]
  *     sy = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":864
+  /* "fastremap.pyx":875
  *     sy = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":869
+  /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":871
+    /* "fastremap.pyx":882
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_8 = 0;
@@ -57975,37 +59425,37 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 871, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":870
+    /* "fastremap.pyx":881
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint8_t>(((uint8_t *)(&(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":869
+    /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":876
+    /* "fastremap.pyx":887
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_10 = 0;
@@ -58017,37 +59467,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 876, __pyx_L1_error)
+      __PYX_ERR(0, 887, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":875
+    /* "fastremap.pyx":886
  *     )
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint16_t>(((uint16_t *)(&(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_10 * __pyx_v_arrview.strides[0]) ) + __pyx_t_11 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":874
+    /* "fastremap.pyx":885
  *       sx, sy
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":881
+    /* "fastremap.pyx":892
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_12 = 0;
@@ -58059,37 +59509,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 881, __pyx_L1_error)
+      __PYX_ERR(0, 892, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":880
+    /* "fastremap.pyx":891
  *     )
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint32_t>(((uint32_t *)(&(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":879
+    /* "fastremap.pyx":890
  *       sx, sy
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":886
+    /* "fastremap.pyx":897
  *   else:
  *     _ipt2d[uint64_t](
  *       <uint64_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_14 = 0;
@@ -58101,41 +59551,41 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 886, __pyx_L1_error)
+      __PYX_ERR(0, 897, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":885
+    /* "fastremap.pyx":896
  *     )
  *   else:
  *     _ipt2d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint64_t>(((uint64_t *)(&(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
     break;
   }
 
-  /* "fastremap.pyx":890
+  /* "fastremap.pyx":901
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -58167,15 +59617,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_10__pyx_pw_9fastremap_241ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_10__pyx_mdef_9fastremap_241ipt2d = {"__pyx_fuse_10ipt2d", (PyCFunction)__pyx_fuse_10__pyx_pw_9fastremap_241ipt2d, METH_O, 0};
 static PyObject *__pyx_fuse_10__pyx_pw_9fastremap_241ipt2d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt2d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 862, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_240ipt2d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -58210,143 +59660,143 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_10ipt2d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 2, 1, __pyx_stack) == -1)) __PYX_ERR(0, 862, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "fastremap.pyx":852
+  /* "fastremap.pyx":863
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_float_complex(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 852, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds___pyx_t_float_complex(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":857
+  /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":858
+    /* "fastremap.pyx":869
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *   else:
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":859
+    /* "fastremap.pyx":870
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[1]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":857
+    /* "fastremap.pyx":868
  *   cdef size_t sy
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":861
+  /* "fastremap.pyx":872
  *     sy = arr.shape[1]
  *   else:
  *     sx = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[0]
  * 
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":862
+    /* "fastremap.pyx":873
  *   else:
  *     sx = arr.shape[1]
  *     sy = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":864
+  /* "fastremap.pyx":875
  *     sy = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":869
+  /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":871
+    /* "fastremap.pyx":882
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_8 = 0;
@@ -58358,37 +59808,37 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 871, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":870
+    /* "fastremap.pyx":881
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt2d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint8_t>(((uint8_t *)(&(*((__pyx_t_float_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":869
+    /* "fastremap.pyx":880
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint8_t](
  *       <uint8_t*>&arrview[0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":876
+    /* "fastremap.pyx":887
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_10 = 0;
@@ -58400,37 +59850,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 876, __pyx_L1_error)
+      __PYX_ERR(0, 887, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":875
+    /* "fastremap.pyx":886
  *     )
  *   elif nbytes == 2:
  *     _ipt2d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint16_t>(((uint16_t *)(&(*((__pyx_t_float_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_10 * __pyx_v_arrview.strides[0]) ) + __pyx_t_11 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":874
+    /* "fastremap.pyx":885
  *       sx, sy
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint16_t](
  *       <uint16_t*>&arrview[0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":881
+    /* "fastremap.pyx":892
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_12 = 0;
@@ -58442,37 +59892,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 881, __pyx_L1_error)
+      __PYX_ERR(0, 892, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":880
+    /* "fastremap.pyx":891
  *     )
  *   elif nbytes == 4:
  *     _ipt2d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint32_t>(((uint32_t *)(&(*((__pyx_t_float_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
 
-    /* "fastremap.pyx":879
+    /* "fastremap.pyx":890
  *       sx, sy
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt2d[uint32_t](
  *       <uint32_t*>&arrview[0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":886
+    /* "fastremap.pyx":897
  *   else:
  *     _ipt2d[uint64_t](
  *       <uint64_t*>&arrview[0,0],             # <<<<<<<<<<<<<<
  *       sx, sy
  *     )
  */
     __pyx_t_14 = 0;
@@ -58484,41 +59934,41 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[0])) __pyx_t_7 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 886, __pyx_L1_error)
+      __PYX_ERR(0, 897, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":885
+    /* "fastremap.pyx":896
  *     )
  *   else:
  *     _ipt2d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0],
  *       sx, sy
  */
     pyipt::_ipt2d<uint64_t>(((uint64_t *)(&(*((__pyx_t_float_complex *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ))))), __pyx_v_sx, __pyx_v_sy);
     break;
   }
 
-  /* "fastremap.pyx":890
+  /* "fastremap.pyx":901
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
 
@@ -58543,15 +59993,15 @@
   __pyx_L2:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_arrview, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastremap.pyx":892
+/* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -58589,31 +60039,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 1); __PYX_ERR(0, 892, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 1); __PYX_ERR(0, 903, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 2); __PYX_ERR(0, 892, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 2); __PYX_ERR(0, 903, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 3); __PYX_ERR(0, 892, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 3); __PYX_ERR(0, 903, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") < 0)) __PYX_ERR(0, 892, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") < 0)) __PYX_ERR(0, 903, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -58622,15 +60072,15 @@
     __pyx_v_signatures = values[0];
     __pyx_v_args = values[1];
     __pyx_v_kwargs = values[2];
     __pyx_v_defaults = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 892, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 903, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastremap.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9fastremap_50ipt3d(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
 
@@ -58681,146 +60131,146 @@
   PyObject *__pyx_t_14 = NULL;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   int __pyx_t_18;
   __Pyx_RefNannySetupContext("ipt3d", 0);
   __Pyx_INCREF(__pyx_v_kwargs);
-  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
   PyList_SET_ITEM(__pyx_t_1, 0, Py_None);
   __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
   __pyx_t_3 = (__pyx_v_kwargs != Py_None);
   __pyx_t_4 = (__pyx_t_3 != 0);
   if (__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_kwargs); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_kwargs); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_t_3 = ((!__pyx_t_4) != 0);
   __pyx_t_2 = __pyx_t_3;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_2) {
     __Pyx_INCREF(Py_None);
     __Pyx_DECREF_SET(__pyx_v_kwargs, Py_None);
   }
-  __pyx_t_1 = ((PyObject *)__Pyx_ImportNumPyArrayTypeIfAvailable()); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__Pyx_ImportNumPyArrayTypeIfAvailable()); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
   __pyx_t_1 = 0;
   __pyx_v_itemsize = -1L;
   __pyx_v____pyx_uint8_t_is_signed = (!((((uint8_t)-1L) > 0) != 0));
   __pyx_v____pyx_uint16_t_is_signed = (!((((uint16_t)-1L) > 0) != 0));
   __pyx_v____pyx_uint32_t_is_signed = (!((((uint32_t)-1L) > 0) != 0));
   __pyx_v____pyx_uint64_t_is_signed = (!((((uint64_t)-1L) > 0) != 0));
   __pyx_v____pyx_int8_t_is_signed = (!((((int8_t)-1L) > 0) != 0));
   __pyx_v____pyx_int16_t_is_signed = (!((((int16_t)-1L) > 0) != 0));
   __pyx_v____pyx_int32_t_is_signed = (!((((int32_t)-1L) > 0) != 0));
   __pyx_v____pyx_int64_t_is_signed = (!((((int64_t)-1L) > 0) != 0));
   if (unlikely(__pyx_v_args == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(0, 892, __pyx_L1_error)
+    __PYX_ERR(0, 903, __pyx_L1_error)
   }
-  __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_t_2 = ((0 < __pyx_t_5) != 0);
   if (__pyx_t_2) {
     if (unlikely(__pyx_v_args == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 892, __pyx_L1_error)
+      __PYX_ERR(0, 903, __pyx_L1_error)
     }
-    __pyx_t_1 = __Pyx_GetItemInt_Tuple(((PyObject*)__pyx_v_args), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt_Tuple(((PyObject*)__pyx_v_args), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_arg = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L6;
   }
   __pyx_t_3 = (__pyx_v_kwargs != Py_None);
   __pyx_t_4 = (__pyx_t_3 != 0);
   if (__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L7_bool_binop_done;
   }
   if (unlikely(__pyx_v_kwargs == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 892, __pyx_L1_error)
+    __PYX_ERR(0, 903, __pyx_L1_error)
   }
-  __pyx_t_4 = (__Pyx_PyDict_ContainsTF(__pyx_n_s_arr, ((PyObject*)__pyx_v_kwargs), Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyDict_ContainsTF(__pyx_n_s_arr, ((PyObject*)__pyx_v_kwargs), Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_t_3 = (__pyx_t_4 != 0);
   __pyx_t_2 = __pyx_t_3;
   __pyx_L7_bool_binop_done:;
   if (__pyx_t_2) {
     if (unlikely(__pyx_v_kwargs == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 892, __pyx_L1_error)
+      __PYX_ERR(0, 903, __pyx_L1_error)
     }
-    __pyx_t_1 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_kwargs), __pyx_n_s_arr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_kwargs), __pyx_n_s_arr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_arg = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L6;
   }
   /*else*/ {
     if (unlikely(__pyx_v_args == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-      __PYX_ERR(0, 892, __pyx_L1_error)
+      __PYX_ERR(0, 903, __pyx_L1_error)
     }
-    __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 892, __pyx_L1_error)
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 903, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_int_1);
     __Pyx_INCREF(__pyx_kp_s_);
     __Pyx_GIVEREF(__pyx_kp_s_);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_kp_s_);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Expected_at_least_d_argument_s_g, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Expected_at_least_d_argument_s_g, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 892, __pyx_L1_error)
+    __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_L6:;
   while (1) {
     __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
     __pyx_t_3 = (__pyx_t_2 != 0);
     if (__pyx_t_3) {
       __pyx_t_3 = __Pyx_TypeCheck(__pyx_v_arg, __pyx_v_ndarray); 
       __pyx_t_2 = (__pyx_t_3 != 0);
       if (__pyx_t_2) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_v_dtype = __pyx_t_6;
         __pyx_t_6 = 0;
         goto __pyx_L12;
       }
       __pyx_t_2 = __pyx_memoryview_check(__pyx_v_arg); 
       __pyx_t_3 = (__pyx_t_2 != 0);
       if (__pyx_t_3) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_base); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_base); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_v_arg_base = __pyx_t_6;
         __pyx_t_6 = 0;
         __pyx_t_3 = __Pyx_TypeCheck(__pyx_v_arg_base, __pyx_v_ndarray); 
         __pyx_t_2 = (__pyx_t_3 != 0);
         if (__pyx_t_2) {
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg_base, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg_base, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __pyx_v_dtype = __pyx_t_6;
           __pyx_t_6 = 0;
           goto __pyx_L13;
         }
         /*else*/ {
           __Pyx_INCREF(Py_None);
@@ -58834,265 +60284,265 @@
         __pyx_v_dtype = Py_None;
       }
       __pyx_L12:;
       __pyx_v_itemsize = -1L;
       __pyx_t_2 = (__pyx_v_dtype != Py_None);
       __pyx_t_3 = (__pyx_t_2 != 0);
       if (__pyx_t_3) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_v_itemsize = __pyx_t_5;
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_kind); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_kind); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_Ord(__pyx_t_6); if (unlikely(__pyx_t_7 == ((long)(long)(Py_UCS4)-1))) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Ord(__pyx_t_6); if (unlikely(__pyx_t_7 == ((long)(long)(Py_UCS4)-1))) __PYX_ERR(0, 903, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_v_kind = __pyx_t_7;
         __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
         switch (__pyx_v_kind) {
           case 'i':
           case 'u':
           __pyx_t_2 = (((sizeof(uint8_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L16_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L16_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint8_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L16_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(uint16_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L20_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L20_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint16_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L20_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(uint32_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L24_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L24_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint32_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L24_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(uint64_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L28_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L28_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint64_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L28_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int8_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L32_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L32_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int8_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L32_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int16_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L36_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L36_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int16_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L36_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int32_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L40_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L40_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int32_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L40_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int64_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L44_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L44_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int64_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L44_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           break;
           case 'f':
           __pyx_t_2 = (((sizeof(float)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L48_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L48_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(double)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L51_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L51_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           break;
           case 'c':
           __pyx_t_2 = (((sizeof(__pyx_t_float_complex)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L54_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 903, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 3) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L54_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           break;
           case 'O':
           break;
           default: break;
         }
@@ -59109,15 +60559,15 @@
     __pyx_L57_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint8_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -59131,15 +60581,15 @@
     __pyx_L61_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint16_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -59153,15 +60603,15 @@
     __pyx_L65_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint32_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -59175,15 +60625,15 @@
     __pyx_L69_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint64_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -59197,15 +60647,15 @@
     __pyx_L73_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int8_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -59219,15 +60669,15 @@
     __pyx_L77_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int16_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -59241,15 +60691,15 @@
     __pyx_L81_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int32_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -59263,15 +60713,15 @@
     __pyx_L85_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int64_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -59285,15 +60735,15 @@
     __pyx_L89_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -59307,15 +60757,15 @@
     __pyx_L93_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -59329,100 +60779,100 @@
     __pyx_L97_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_float_complex(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
-    if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
     goto __pyx_L10_break;
   }
   __pyx_L10_break:;
-  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_v_candidates = ((PyObject*)__pyx_t_6);
   __pyx_t_6 = 0;
   __pyx_t_5 = 0;
   if (unlikely(__pyx_v_signatures == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 892, __pyx_L1_error)
+    __PYX_ERR(0, 903, __pyx_L1_error)
   }
-  __pyx_t_1 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&__pyx_t_9), (&__pyx_t_10)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&__pyx_t_9), (&__pyx_t_10)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_6);
   __pyx_t_6 = __pyx_t_1;
   __pyx_t_1 = 0;
   while (1) {
     __pyx_t_11 = __Pyx_dict_iter_next(__pyx_t_6, __pyx_t_9, &__pyx_t_5, &__pyx_t_1, NULL, NULL, __pyx_t_10);
     if (unlikely(__pyx_t_11 == 0)) break;
-    if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_XDECREF_SET(__pyx_v_sig, __pyx_t_1);
     __pyx_t_1 = 0;
     __pyx_v_match_found = 0;
-    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_sig, __pyx_n_s_strip); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_sig, __pyx_n_s_strip); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __pyx_t_14 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
       __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
       if (likely(__pyx_t_14)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
         __Pyx_INCREF(__pyx_t_14);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_13, function);
       }
     }
     __pyx_t_12 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_14, __pyx_kp_s__2) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_kp_s__2);
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_split); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_split); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __pyx_t_12 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
       __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_13);
       if (likely(__pyx_t_12)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
         __Pyx_INCREF(__pyx_t_12);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_13, function);
       }
     }
     __pyx_t_1 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_12, __pyx_kp_s__3) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_kp_s__3);
     __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_XDECREF_SET(__pyx_v_src_sig, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_15 = PyList_GET_SIZE(__pyx_v_dest_sig); if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1))) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_15 = PyList_GET_SIZE(__pyx_v_dest_sig); if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1))) __PYX_ERR(0, 903, __pyx_L1_error)
     __pyx_t_16 = __pyx_t_15;
     for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
       __pyx_v_i = __pyx_t_17;
-      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_dest_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_dest_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_XDECREF_SET(__pyx_v_dst_type, __pyx_t_1);
       __pyx_t_1 = 0;
       __pyx_t_3 = (__pyx_v_dst_type != Py_None);
       __pyx_t_2 = (__pyx_t_3 != 0);
       if (__pyx_t_2) {
-        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_src_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_src_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_13 = PyObject_RichCompare(__pyx_t_1, __pyx_v_dst_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_13 = PyObject_RichCompare(__pyx_t_1, __pyx_v_dst_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 903, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 892, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 903, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         if (__pyx_t_2) {
           __pyx_v_match_found = 1;
           goto __pyx_L105;
         }
         /*else*/ {
           __pyx_v_match_found = 0;
@@ -59430,45 +60880,45 @@
         }
         __pyx_L105:;
       }
     }
     __pyx_L103_break:;
     __pyx_t_2 = (__pyx_v_match_found != 0);
     if (__pyx_t_2) {
-      __pyx_t_18 = __Pyx_PyList_Append(__pyx_v_candidates, __pyx_v_sig); if (unlikely(__pyx_t_18 == ((int)-1))) __PYX_ERR(0, 892, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyList_Append(__pyx_v_candidates, __pyx_v_sig); if (unlikely(__pyx_t_18 == ((int)-1))) __PYX_ERR(0, 903, __pyx_L1_error)
     }
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_2 = (PyList_GET_SIZE(__pyx_v_candidates) != 0);
   __pyx_t_3 = ((!__pyx_t_2) != 0);
   if (__pyx_t_3) {
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 892, __pyx_L1_error)
+    __PYX_ERR(0, 903, __pyx_L1_error)
   }
-  __pyx_t_9 = PyList_GET_SIZE(__pyx_v_candidates); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_9 = PyList_GET_SIZE(__pyx_v_candidates); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_t_3 = ((__pyx_t_9 > 1) != 0);
   if (__pyx_t_3) {
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 892, __pyx_L1_error)
+    __PYX_ERR(0, 903, __pyx_L1_error)
   }
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     if (unlikely(__pyx_v_signatures == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 892, __pyx_L1_error)
+      __PYX_ERR(0, 903, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_candidates, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_candidates, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_13 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_signatures), __pyx_t_6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 892, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_signatures), __pyx_t_6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_r = __pyx_t_13;
     __pyx_t_13 = 0;
     goto __pyx_L0;
   }
 
@@ -59500,15 +60950,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_0__pyx_pw_9fastremap_245ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_0__pyx_mdef_9fastremap_245ipt3d = {"__pyx_fuse_0ipt3d", (PyCFunction)__pyx_fuse_0__pyx_pw_9fastremap_245ipt3d, METH_O, 0};
 static PyObject *__pyx_fuse_0__pyx_pw_9fastremap_245ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt3d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_244ipt3d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -59548,161 +60998,161 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_0ipt3d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2];
 
-  /* "fastremap.pyx":893
+  /* "fastremap.pyx":904
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":899
+  /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":900
+    /* "fastremap.pyx":911
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":901
+    /* "fastremap.pyx":912
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *   else:
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":902
+    /* "fastremap.pyx":913
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[2]
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":899
+    /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":904
+  /* "fastremap.pyx":915
  *     sz = arr.shape[2]
  *   else:
  *     sx = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":905
+    /* "fastremap.pyx":916
  *   else:
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[0]
  * 
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":906
+    /* "fastremap.pyx":917
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":908
+  /* "fastremap.pyx":919
  *     sz = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":913
+  /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":915
+    /* "fastremap.pyx":926
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_8 = 0;
@@ -59719,37 +61169,37 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_10 < 0) {
       __pyx_t_10 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_10 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 915, __pyx_L1_error)
+      __PYX_ERR(0, 926, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":914
+    /* "fastremap.pyx":925
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint8_t>(((uint8_t *)(&(*((uint8_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":913
+    /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":920
+    /* "fastremap.pyx":931
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_11 = 0;
@@ -59766,37 +61216,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 920, __pyx_L1_error)
+      __PYX_ERR(0, 931, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":919
+    /* "fastremap.pyx":930
  *     )
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint16_t>(((uint16_t *)(&(*((uint8_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_11 * __pyx_v_arrview.strides[0]) ) + __pyx_t_12 * __pyx_v_arrview.strides[1]) ) + __pyx_t_13 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":918
+    /* "fastremap.pyx":929
  *       sx, sy, sz
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":925
+    /* "fastremap.pyx":936
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_14 = 0;
@@ -59813,37 +61263,37 @@
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_16 < 0) {
       __pyx_t_16 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_16 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_16 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 925, __pyx_L1_error)
+      __PYX_ERR(0, 936, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":924
+    /* "fastremap.pyx":935
  *     )
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint32_t>(((uint32_t *)(&(*((uint8_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ) + __pyx_t_16 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":923
+    /* "fastremap.pyx":934
  *       sx, sy, sz
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":930
+    /* "fastremap.pyx":941
  *   else:
  *     _ipt3d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_17 = 0;
@@ -59860,41 +61310,41 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 930, __pyx_L1_error)
+      __PYX_ERR(0, 941, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":929
+    /* "fastremap.pyx":940
  *     )
  *   else:
  *     _ipt3d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint64_t>(((uint64_t *)(&(*((uint8_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_17 * __pyx_v_arrview.strides[0]) ) + __pyx_t_18 * __pyx_v_arrview.strides[1]) ) + __pyx_t_19 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
     break;
   }
 
-  /* "fastremap.pyx":934
+  /* "fastremap.pyx":945
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -59926,15 +61376,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_1__pyx_pw_9fastremap_247ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_1__pyx_mdef_9fastremap_247ipt3d = {"__pyx_fuse_1ipt3d", (PyCFunction)__pyx_fuse_1__pyx_pw_9fastremap_247ipt3d, METH_O, 0};
 static PyObject *__pyx_fuse_1__pyx_pw_9fastremap_247ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt3d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_246ipt3d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -59974,161 +61424,161 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_1ipt3d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint16_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint16_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2];
 
-  /* "fastremap.pyx":893
+  /* "fastremap.pyx":904
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":899
+  /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":900
+    /* "fastremap.pyx":911
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":901
+    /* "fastremap.pyx":912
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *   else:
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":902
+    /* "fastremap.pyx":913
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[2]
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":899
+    /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":904
+  /* "fastremap.pyx":915
  *     sz = arr.shape[2]
  *   else:
  *     sx = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":905
+    /* "fastremap.pyx":916
  *   else:
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[0]
  * 
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":906
+    /* "fastremap.pyx":917
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":908
+  /* "fastremap.pyx":919
  *     sz = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":913
+  /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":915
+    /* "fastremap.pyx":926
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_8 = 0;
@@ -60145,37 +61595,37 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_10 < 0) {
       __pyx_t_10 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_10 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 915, __pyx_L1_error)
+      __PYX_ERR(0, 926, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":914
+    /* "fastremap.pyx":925
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint8_t>(((uint8_t *)(&(*((uint16_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":913
+    /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":920
+    /* "fastremap.pyx":931
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_11 = 0;
@@ -60192,37 +61642,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 920, __pyx_L1_error)
+      __PYX_ERR(0, 931, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":919
+    /* "fastremap.pyx":930
  *     )
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint16_t>(((uint16_t *)(&(*((uint16_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_11 * __pyx_v_arrview.strides[0]) ) + __pyx_t_12 * __pyx_v_arrview.strides[1]) ) + __pyx_t_13 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":918
+    /* "fastremap.pyx":929
  *       sx, sy, sz
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":925
+    /* "fastremap.pyx":936
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_14 = 0;
@@ -60239,37 +61689,37 @@
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_16 < 0) {
       __pyx_t_16 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_16 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_16 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 925, __pyx_L1_error)
+      __PYX_ERR(0, 936, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":924
+    /* "fastremap.pyx":935
  *     )
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint32_t>(((uint32_t *)(&(*((uint16_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ) + __pyx_t_16 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":923
+    /* "fastremap.pyx":934
  *       sx, sy, sz
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":930
+    /* "fastremap.pyx":941
  *   else:
  *     _ipt3d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_17 = 0;
@@ -60286,41 +61736,41 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 930, __pyx_L1_error)
+      __PYX_ERR(0, 941, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":929
+    /* "fastremap.pyx":940
  *     )
  *   else:
  *     _ipt3d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint64_t>(((uint64_t *)(&(*((uint16_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_17 * __pyx_v_arrview.strides[0]) ) + __pyx_t_18 * __pyx_v_arrview.strides[1]) ) + __pyx_t_19 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
     break;
   }
 
-  /* "fastremap.pyx":934
+  /* "fastremap.pyx":945
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -60352,15 +61802,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_2__pyx_pw_9fastremap_249ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_2__pyx_mdef_9fastremap_249ipt3d = {"__pyx_fuse_2ipt3d", (PyCFunction)__pyx_fuse_2__pyx_pw_9fastremap_249ipt3d, METH_O, 0};
 static PyObject *__pyx_fuse_2__pyx_pw_9fastremap_249ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt3d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_248ipt3d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -60400,161 +61850,161 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_2ipt3d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2];
 
-  /* "fastremap.pyx":893
+  /* "fastremap.pyx":904
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":899
+  /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":900
+    /* "fastremap.pyx":911
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":901
+    /* "fastremap.pyx":912
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *   else:
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":902
+    /* "fastremap.pyx":913
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[2]
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":899
+    /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":904
+  /* "fastremap.pyx":915
  *     sz = arr.shape[2]
  *   else:
  *     sx = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":905
+    /* "fastremap.pyx":916
  *   else:
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[0]
  * 
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":906
+    /* "fastremap.pyx":917
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":908
+  /* "fastremap.pyx":919
  *     sz = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":913
+  /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":915
+    /* "fastremap.pyx":926
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_8 = 0;
@@ -60571,37 +62021,37 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_10 < 0) {
       __pyx_t_10 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_10 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 915, __pyx_L1_error)
+      __PYX_ERR(0, 926, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":914
+    /* "fastremap.pyx":925
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint8_t>(((uint8_t *)(&(*((uint32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":913
+    /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":920
+    /* "fastremap.pyx":931
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_11 = 0;
@@ -60618,37 +62068,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 920, __pyx_L1_error)
+      __PYX_ERR(0, 931, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":919
+    /* "fastremap.pyx":930
  *     )
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint16_t>(((uint16_t *)(&(*((uint32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_11 * __pyx_v_arrview.strides[0]) ) + __pyx_t_12 * __pyx_v_arrview.strides[1]) ) + __pyx_t_13 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":918
+    /* "fastremap.pyx":929
  *       sx, sy, sz
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":925
+    /* "fastremap.pyx":936
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_14 = 0;
@@ -60665,37 +62115,37 @@
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_16 < 0) {
       __pyx_t_16 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_16 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_16 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 925, __pyx_L1_error)
+      __PYX_ERR(0, 936, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":924
+    /* "fastremap.pyx":935
  *     )
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint32_t>(((uint32_t *)(&(*((uint32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ) + __pyx_t_16 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":923
+    /* "fastremap.pyx":934
  *       sx, sy, sz
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":930
+    /* "fastremap.pyx":941
  *   else:
  *     _ipt3d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_17 = 0;
@@ -60712,41 +62162,41 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 930, __pyx_L1_error)
+      __PYX_ERR(0, 941, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":929
+    /* "fastremap.pyx":940
  *     )
  *   else:
  *     _ipt3d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint64_t>(((uint64_t *)(&(*((uint32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_17 * __pyx_v_arrview.strides[0]) ) + __pyx_t_18 * __pyx_v_arrview.strides[1]) ) + __pyx_t_19 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
     break;
   }
 
-  /* "fastremap.pyx":934
+  /* "fastremap.pyx":945
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -60778,15 +62228,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_3__pyx_pw_9fastremap_251ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_3__pyx_mdef_9fastremap_251ipt3d = {"__pyx_fuse_3ipt3d", (PyCFunction)__pyx_fuse_3__pyx_pw_9fastremap_251ipt3d, METH_O, 0};
 static PyObject *__pyx_fuse_3__pyx_pw_9fastremap_251ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt3d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_250ipt3d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -60826,161 +62276,161 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_3ipt3d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2];
 
-  /* "fastremap.pyx":893
+  /* "fastremap.pyx":904
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_uint64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":899
+  /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":900
+    /* "fastremap.pyx":911
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":901
+    /* "fastremap.pyx":912
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *   else:
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":902
+    /* "fastremap.pyx":913
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[2]
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":899
+    /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":904
+  /* "fastremap.pyx":915
  *     sz = arr.shape[2]
  *   else:
  *     sx = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":905
+    /* "fastremap.pyx":916
  *   else:
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[0]
  * 
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":906
+    /* "fastremap.pyx":917
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":908
+  /* "fastremap.pyx":919
  *     sz = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":913
+  /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":915
+    /* "fastremap.pyx":926
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_8 = 0;
@@ -60997,37 +62447,37 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_10 < 0) {
       __pyx_t_10 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_10 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 915, __pyx_L1_error)
+      __PYX_ERR(0, 926, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":914
+    /* "fastremap.pyx":925
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint8_t>(((uint8_t *)(&(*((uint64_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":913
+    /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":920
+    /* "fastremap.pyx":931
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_11 = 0;
@@ -61044,37 +62494,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 920, __pyx_L1_error)
+      __PYX_ERR(0, 931, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":919
+    /* "fastremap.pyx":930
  *     )
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint16_t>(((uint16_t *)(&(*((uint64_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_11 * __pyx_v_arrview.strides[0]) ) + __pyx_t_12 * __pyx_v_arrview.strides[1]) ) + __pyx_t_13 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":918
+    /* "fastremap.pyx":929
  *       sx, sy, sz
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":925
+    /* "fastremap.pyx":936
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_14 = 0;
@@ -61091,37 +62541,37 @@
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_16 < 0) {
       __pyx_t_16 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_16 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_16 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 925, __pyx_L1_error)
+      __PYX_ERR(0, 936, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":924
+    /* "fastremap.pyx":935
  *     )
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint32_t>(((uint32_t *)(&(*((uint64_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ) + __pyx_t_16 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":923
+    /* "fastremap.pyx":934
  *       sx, sy, sz
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":930
+    /* "fastremap.pyx":941
  *   else:
  *     _ipt3d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_17 = 0;
@@ -61138,41 +62588,41 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 930, __pyx_L1_error)
+      __PYX_ERR(0, 941, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":929
+    /* "fastremap.pyx":940
  *     )
  *   else:
  *     _ipt3d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint64_t>(((uint64_t *)(&(*((uint64_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_17 * __pyx_v_arrview.strides[0]) ) + __pyx_t_18 * __pyx_v_arrview.strides[1]) ) + __pyx_t_19 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
     break;
   }
 
-  /* "fastremap.pyx":934
+  /* "fastremap.pyx":945
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -61204,15 +62654,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_4__pyx_pw_9fastremap_253ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_4__pyx_mdef_9fastremap_253ipt3d = {"__pyx_fuse_4ipt3d", (PyCFunction)__pyx_fuse_4__pyx_pw_9fastremap_253ipt3d, METH_O, 0};
 static PyObject *__pyx_fuse_4__pyx_pw_9fastremap_253ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt3d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_252ipt3d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -61252,161 +62702,161 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_4ipt3d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2];
 
-  /* "fastremap.pyx":893
+  /* "fastremap.pyx":904
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":899
+  /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":900
+    /* "fastremap.pyx":911
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":901
+    /* "fastremap.pyx":912
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *   else:
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":902
+    /* "fastremap.pyx":913
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[2]
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":899
+    /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":904
+  /* "fastremap.pyx":915
  *     sz = arr.shape[2]
  *   else:
  *     sx = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":905
+    /* "fastremap.pyx":916
  *   else:
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[0]
  * 
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":906
+    /* "fastremap.pyx":917
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":908
+  /* "fastremap.pyx":919
  *     sz = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":913
+  /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":915
+    /* "fastremap.pyx":926
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_8 = 0;
@@ -61423,37 +62873,37 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_10 < 0) {
       __pyx_t_10 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_10 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 915, __pyx_L1_error)
+      __PYX_ERR(0, 926, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":914
+    /* "fastremap.pyx":925
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint8_t>(((uint8_t *)(&(*((int8_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":913
+    /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":920
+    /* "fastremap.pyx":931
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_11 = 0;
@@ -61470,37 +62920,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 920, __pyx_L1_error)
+      __PYX_ERR(0, 931, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":919
+    /* "fastremap.pyx":930
  *     )
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint16_t>(((uint16_t *)(&(*((int8_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_11 * __pyx_v_arrview.strides[0]) ) + __pyx_t_12 * __pyx_v_arrview.strides[1]) ) + __pyx_t_13 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":918
+    /* "fastremap.pyx":929
  *       sx, sy, sz
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":925
+    /* "fastremap.pyx":936
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_14 = 0;
@@ -61517,37 +62967,37 @@
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_16 < 0) {
       __pyx_t_16 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_16 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_16 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 925, __pyx_L1_error)
+      __PYX_ERR(0, 936, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":924
+    /* "fastremap.pyx":935
  *     )
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint32_t>(((uint32_t *)(&(*((int8_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ) + __pyx_t_16 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":923
+    /* "fastremap.pyx":934
  *       sx, sy, sz
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":930
+    /* "fastremap.pyx":941
  *   else:
  *     _ipt3d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_17 = 0;
@@ -61564,41 +63014,41 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 930, __pyx_L1_error)
+      __PYX_ERR(0, 941, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":929
+    /* "fastremap.pyx":940
  *     )
  *   else:
  *     _ipt3d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint64_t>(((uint64_t *)(&(*((int8_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_17 * __pyx_v_arrview.strides[0]) ) + __pyx_t_18 * __pyx_v_arrview.strides[1]) ) + __pyx_t_19 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
     break;
   }
 
-  /* "fastremap.pyx":934
+  /* "fastremap.pyx":945
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -61630,15 +63080,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_5__pyx_pw_9fastremap_255ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_5__pyx_mdef_9fastremap_255ipt3d = {"__pyx_fuse_5ipt3d", (PyCFunction)__pyx_fuse_5__pyx_pw_9fastremap_255ipt3d, METH_O, 0};
 static PyObject *__pyx_fuse_5__pyx_pw_9fastremap_255ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt3d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_254ipt3d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -61678,161 +63128,161 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_5ipt3d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int16_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int16_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2];
 
-  /* "fastremap.pyx":893
+  /* "fastremap.pyx":904
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":899
+  /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":900
+    /* "fastremap.pyx":911
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":901
+    /* "fastremap.pyx":912
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *   else:
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":902
+    /* "fastremap.pyx":913
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[2]
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":899
+    /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":904
+  /* "fastremap.pyx":915
  *     sz = arr.shape[2]
  *   else:
  *     sx = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":905
+    /* "fastremap.pyx":916
  *   else:
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[0]
  * 
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":906
+    /* "fastremap.pyx":917
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":908
+  /* "fastremap.pyx":919
  *     sz = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":913
+  /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":915
+    /* "fastremap.pyx":926
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_8 = 0;
@@ -61849,37 +63299,37 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_10 < 0) {
       __pyx_t_10 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_10 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 915, __pyx_L1_error)
+      __PYX_ERR(0, 926, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":914
+    /* "fastremap.pyx":925
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint8_t>(((uint8_t *)(&(*((int16_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":913
+    /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":920
+    /* "fastremap.pyx":931
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_11 = 0;
@@ -61896,37 +63346,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 920, __pyx_L1_error)
+      __PYX_ERR(0, 931, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":919
+    /* "fastremap.pyx":930
  *     )
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint16_t>(((uint16_t *)(&(*((int16_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_11 * __pyx_v_arrview.strides[0]) ) + __pyx_t_12 * __pyx_v_arrview.strides[1]) ) + __pyx_t_13 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":918
+    /* "fastremap.pyx":929
  *       sx, sy, sz
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":925
+    /* "fastremap.pyx":936
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_14 = 0;
@@ -61943,37 +63393,37 @@
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_16 < 0) {
       __pyx_t_16 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_16 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_16 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 925, __pyx_L1_error)
+      __PYX_ERR(0, 936, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":924
+    /* "fastremap.pyx":935
  *     )
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint32_t>(((uint32_t *)(&(*((int16_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ) + __pyx_t_16 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":923
+    /* "fastremap.pyx":934
  *       sx, sy, sz
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":930
+    /* "fastremap.pyx":941
  *   else:
  *     _ipt3d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_17 = 0;
@@ -61990,41 +63440,41 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 930, __pyx_L1_error)
+      __PYX_ERR(0, 941, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":929
+    /* "fastremap.pyx":940
  *     )
  *   else:
  *     _ipt3d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint64_t>(((uint64_t *)(&(*((int16_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_17 * __pyx_v_arrview.strides[0]) ) + __pyx_t_18 * __pyx_v_arrview.strides[1]) ) + __pyx_t_19 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
     break;
   }
 
-  /* "fastremap.pyx":934
+  /* "fastremap.pyx":945
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -62056,15 +63506,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_6__pyx_pw_9fastremap_257ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_6__pyx_mdef_9fastremap_257ipt3d = {"__pyx_fuse_6ipt3d", (PyCFunction)__pyx_fuse_6__pyx_pw_9fastremap_257ipt3d, METH_O, 0};
 static PyObject *__pyx_fuse_6__pyx_pw_9fastremap_257ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt3d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_256ipt3d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -62104,161 +63554,161 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_6ipt3d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2];
 
-  /* "fastremap.pyx":893
+  /* "fastremap.pyx":904
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":899
+  /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":900
+    /* "fastremap.pyx":911
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":901
+    /* "fastremap.pyx":912
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *   else:
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":902
+    /* "fastremap.pyx":913
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[2]
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":899
+    /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":904
+  /* "fastremap.pyx":915
  *     sz = arr.shape[2]
  *   else:
  *     sx = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":905
+    /* "fastremap.pyx":916
  *   else:
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[0]
  * 
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":906
+    /* "fastremap.pyx":917
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":908
+  /* "fastremap.pyx":919
  *     sz = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":913
+  /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":915
+    /* "fastremap.pyx":926
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_8 = 0;
@@ -62275,37 +63725,37 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_10 < 0) {
       __pyx_t_10 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_10 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 915, __pyx_L1_error)
+      __PYX_ERR(0, 926, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":914
+    /* "fastremap.pyx":925
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint8_t>(((uint8_t *)(&(*((int32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":913
+    /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":920
+    /* "fastremap.pyx":931
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_11 = 0;
@@ -62322,37 +63772,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 920, __pyx_L1_error)
+      __PYX_ERR(0, 931, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":919
+    /* "fastremap.pyx":930
  *     )
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint16_t>(((uint16_t *)(&(*((int32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_11 * __pyx_v_arrview.strides[0]) ) + __pyx_t_12 * __pyx_v_arrview.strides[1]) ) + __pyx_t_13 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":918
+    /* "fastremap.pyx":929
  *       sx, sy, sz
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":925
+    /* "fastremap.pyx":936
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_14 = 0;
@@ -62369,37 +63819,37 @@
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_16 < 0) {
       __pyx_t_16 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_16 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_16 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 925, __pyx_L1_error)
+      __PYX_ERR(0, 936, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":924
+    /* "fastremap.pyx":935
  *     )
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint32_t>(((uint32_t *)(&(*((int32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ) + __pyx_t_16 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":923
+    /* "fastremap.pyx":934
  *       sx, sy, sz
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":930
+    /* "fastremap.pyx":941
  *   else:
  *     _ipt3d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_17 = 0;
@@ -62416,41 +63866,41 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 930, __pyx_L1_error)
+      __PYX_ERR(0, 941, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":929
+    /* "fastremap.pyx":940
  *     )
  *   else:
  *     _ipt3d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint64_t>(((uint64_t *)(&(*((int32_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_17 * __pyx_v_arrview.strides[0]) ) + __pyx_t_18 * __pyx_v_arrview.strides[1]) ) + __pyx_t_19 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
     break;
   }
 
-  /* "fastremap.pyx":934
+  /* "fastremap.pyx":945
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -62482,15 +63932,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_7__pyx_pw_9fastremap_259ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_7__pyx_mdef_9fastremap_259ipt3d = {"__pyx_fuse_7ipt3d", (PyCFunction)__pyx_fuse_7__pyx_pw_9fastremap_259ipt3d, METH_O, 0};
 static PyObject *__pyx_fuse_7__pyx_pw_9fastremap_259ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt3d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_258ipt3d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -62530,161 +63980,161 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_7ipt3d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2];
 
-  /* "fastremap.pyx":893
+  /* "fastremap.pyx":904
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn_int64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":899
+  /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":900
+    /* "fastremap.pyx":911
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":901
+    /* "fastremap.pyx":912
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *   else:
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":902
+    /* "fastremap.pyx":913
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[2]
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":899
+    /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":904
+  /* "fastremap.pyx":915
  *     sz = arr.shape[2]
  *   else:
  *     sx = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":905
+    /* "fastremap.pyx":916
  *   else:
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[0]
  * 
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":906
+    /* "fastremap.pyx":917
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":908
+  /* "fastremap.pyx":919
  *     sz = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":913
+  /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":915
+    /* "fastremap.pyx":926
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_8 = 0;
@@ -62701,37 +64151,37 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_10 < 0) {
       __pyx_t_10 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_10 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 915, __pyx_L1_error)
+      __PYX_ERR(0, 926, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":914
+    /* "fastremap.pyx":925
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint8_t>(((uint8_t *)(&(*((int64_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":913
+    /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":920
+    /* "fastremap.pyx":931
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_11 = 0;
@@ -62748,37 +64198,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 920, __pyx_L1_error)
+      __PYX_ERR(0, 931, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":919
+    /* "fastremap.pyx":930
  *     )
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint16_t>(((uint16_t *)(&(*((int64_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_11 * __pyx_v_arrview.strides[0]) ) + __pyx_t_12 * __pyx_v_arrview.strides[1]) ) + __pyx_t_13 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":918
+    /* "fastremap.pyx":929
  *       sx, sy, sz
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":925
+    /* "fastremap.pyx":936
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_14 = 0;
@@ -62795,37 +64245,37 @@
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_16 < 0) {
       __pyx_t_16 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_16 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_16 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 925, __pyx_L1_error)
+      __PYX_ERR(0, 936, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":924
+    /* "fastremap.pyx":935
  *     )
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint32_t>(((uint32_t *)(&(*((int64_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ) + __pyx_t_16 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":923
+    /* "fastremap.pyx":934
  *       sx, sy, sz
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":930
+    /* "fastremap.pyx":941
  *   else:
  *     _ipt3d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_17 = 0;
@@ -62842,41 +64292,41 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 930, __pyx_L1_error)
+      __PYX_ERR(0, 941, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":929
+    /* "fastremap.pyx":940
  *     )
  *   else:
  *     _ipt3d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint64_t>(((uint64_t *)(&(*((int64_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_17 * __pyx_v_arrview.strides[0]) ) + __pyx_t_18 * __pyx_v_arrview.strides[1]) ) + __pyx_t_19 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
     break;
   }
 
-  /* "fastremap.pyx":934
+  /* "fastremap.pyx":945
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -62908,15 +64358,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_8__pyx_pw_9fastremap_261ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_8__pyx_mdef_9fastremap_261ipt3d = {"__pyx_fuse_8ipt3d", (PyCFunction)__pyx_fuse_8__pyx_pw_9fastremap_261ipt3d, METH_O, 0};
 static PyObject *__pyx_fuse_8__pyx_pw_9fastremap_261ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt3d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_260ipt3d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -62956,161 +64406,161 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_8ipt3d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2];
 
-  /* "fastremap.pyx":893
+  /* "fastremap.pyx":904
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_float(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":899
+  /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":900
+    /* "fastremap.pyx":911
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":901
+    /* "fastremap.pyx":912
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *   else:
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":902
+    /* "fastremap.pyx":913
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[2]
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":899
+    /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":904
+  /* "fastremap.pyx":915
  *     sz = arr.shape[2]
  *   else:
  *     sx = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":905
+    /* "fastremap.pyx":916
  *   else:
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[0]
  * 
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":906
+    /* "fastremap.pyx":917
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":908
+  /* "fastremap.pyx":919
  *     sz = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":913
+  /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":915
+    /* "fastremap.pyx":926
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_8 = 0;
@@ -63127,37 +64577,37 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_10 < 0) {
       __pyx_t_10 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_10 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 915, __pyx_L1_error)
+      __PYX_ERR(0, 926, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":914
+    /* "fastremap.pyx":925
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint8_t>(((uint8_t *)(&(*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":913
+    /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":920
+    /* "fastremap.pyx":931
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_11 = 0;
@@ -63174,37 +64624,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 920, __pyx_L1_error)
+      __PYX_ERR(0, 931, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":919
+    /* "fastremap.pyx":930
  *     )
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint16_t>(((uint16_t *)(&(*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_11 * __pyx_v_arrview.strides[0]) ) + __pyx_t_12 * __pyx_v_arrview.strides[1]) ) + __pyx_t_13 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":918
+    /* "fastremap.pyx":929
  *       sx, sy, sz
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":925
+    /* "fastremap.pyx":936
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_14 = 0;
@@ -63221,37 +64671,37 @@
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_16 < 0) {
       __pyx_t_16 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_16 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_16 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 925, __pyx_L1_error)
+      __PYX_ERR(0, 936, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":924
+    /* "fastremap.pyx":935
  *     )
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint32_t>(((uint32_t *)(&(*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ) + __pyx_t_16 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":923
+    /* "fastremap.pyx":934
  *       sx, sy, sz
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":930
+    /* "fastremap.pyx":941
  *   else:
  *     _ipt3d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_17 = 0;
@@ -63268,41 +64718,41 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 930, __pyx_L1_error)
+      __PYX_ERR(0, 941, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":929
+    /* "fastremap.pyx":940
  *     )
  *   else:
  *     _ipt3d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint64_t>(((uint64_t *)(&(*((float *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_17 * __pyx_v_arrview.strides[0]) ) + __pyx_t_18 * __pyx_v_arrview.strides[1]) ) + __pyx_t_19 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
     break;
   }
 
-  /* "fastremap.pyx":934
+  /* "fastremap.pyx":945
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -63334,15 +64784,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_9__pyx_pw_9fastremap_263ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_9__pyx_mdef_9fastremap_263ipt3d = {"__pyx_fuse_9ipt3d", (PyCFunction)__pyx_fuse_9__pyx_pw_9fastremap_263ipt3d, METH_O, 0};
 static PyObject *__pyx_fuse_9__pyx_pw_9fastremap_263ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt3d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_262ipt3d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -63382,161 +64832,161 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_9ipt3d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2];
 
-  /* "fastremap.pyx":893
+  /* "fastremap.pyx":904
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_double(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":899
+  /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":900
+    /* "fastremap.pyx":911
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":901
+    /* "fastremap.pyx":912
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *   else:
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":902
+    /* "fastremap.pyx":913
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[2]
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":899
+    /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":904
+  /* "fastremap.pyx":915
  *     sz = arr.shape[2]
  *   else:
  *     sx = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":905
+    /* "fastremap.pyx":916
  *   else:
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[0]
  * 
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":906
+    /* "fastremap.pyx":917
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":908
+  /* "fastremap.pyx":919
  *     sz = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":913
+  /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":915
+    /* "fastremap.pyx":926
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_8 = 0;
@@ -63553,37 +65003,37 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_10 < 0) {
       __pyx_t_10 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_10 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 915, __pyx_L1_error)
+      __PYX_ERR(0, 926, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":914
+    /* "fastremap.pyx":925
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint8_t>(((uint8_t *)(&(*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":913
+    /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":920
+    /* "fastremap.pyx":931
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_11 = 0;
@@ -63600,37 +65050,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 920, __pyx_L1_error)
+      __PYX_ERR(0, 931, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":919
+    /* "fastremap.pyx":930
  *     )
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint16_t>(((uint16_t *)(&(*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_11 * __pyx_v_arrview.strides[0]) ) + __pyx_t_12 * __pyx_v_arrview.strides[1]) ) + __pyx_t_13 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":918
+    /* "fastremap.pyx":929
  *       sx, sy, sz
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":925
+    /* "fastremap.pyx":936
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_14 = 0;
@@ -63647,37 +65097,37 @@
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_16 < 0) {
       __pyx_t_16 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_16 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_16 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 925, __pyx_L1_error)
+      __PYX_ERR(0, 936, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":924
+    /* "fastremap.pyx":935
  *     )
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint32_t>(((uint32_t *)(&(*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ) + __pyx_t_16 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":923
+    /* "fastremap.pyx":934
  *       sx, sy, sz
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":930
+    /* "fastremap.pyx":941
  *   else:
  *     _ipt3d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_17 = 0;
@@ -63694,41 +65144,41 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 930, __pyx_L1_error)
+      __PYX_ERR(0, 941, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":929
+    /* "fastremap.pyx":940
  *     )
  *   else:
  *     _ipt3d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint64_t>(((uint64_t *)(&(*((double *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_17 * __pyx_v_arrview.strides[0]) ) + __pyx_t_18 * __pyx_v_arrview.strides[1]) ) + __pyx_t_19 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
     break;
   }
 
-  /* "fastremap.pyx":934
+  /* "fastremap.pyx":945
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -63760,15 +65210,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_10__pyx_pw_9fastremap_265ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_10__pyx_mdef_9fastremap_265ipt3d = {"__pyx_fuse_10ipt3d", (PyCFunction)__pyx_fuse_10__pyx_pw_9fastremap_265ipt3d, METH_O, 0};
 static PyObject *__pyx_fuse_10__pyx_pw_9fastremap_265ipt3d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt3d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 903, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_264ipt3d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -63808,161 +65258,161 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_10ipt3d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 892, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 3, 1, __pyx_stack) == -1)) __PYX_ERR(0, 903, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2];
 
-  /* "fastremap.pyx":893
+  /* "fastremap.pyx":904
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_float_complex(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsds___pyx_t_float_complex(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":899
+  /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 910, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":900
+    /* "fastremap.pyx":911
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":901
+    /* "fastremap.pyx":912
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *   else:
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":902
+    /* "fastremap.pyx":913
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[2]
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":899
+    /* "fastremap.pyx":910
  *   cdef size_t sz
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":904
+  /* "fastremap.pyx":915
  *     sz = arr.shape[2]
  *   else:
  *     sx = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":905
+    /* "fastremap.pyx":916
  *   else:
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[0]
  * 
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":906
+    /* "fastremap.pyx":917
  *     sx = arr.shape[2]
  *     sy = arr.shape[1]
  *     sz = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":908
+  /* "fastremap.pyx":919
  *     sz = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":913
+  /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":915
+    /* "fastremap.pyx":926
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_8 = 0;
@@ -63979,37 +65429,37 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_10 < 0) {
       __pyx_t_10 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_10 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 915, __pyx_L1_error)
+      __PYX_ERR(0, 926, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":914
+    /* "fastremap.pyx":925
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt3d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint8_t>(((uint8_t *)(&(*((__pyx_t_float_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":913
+    /* "fastremap.pyx":924
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":920
+    /* "fastremap.pyx":931
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_11 = 0;
@@ -64026,37 +65476,37 @@
     } else if (unlikely(__pyx_t_12 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_13 < 0) {
       __pyx_t_13 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_13 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_13 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 920, __pyx_L1_error)
+      __PYX_ERR(0, 931, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":919
+    /* "fastremap.pyx":930
  *     )
  *   elif nbytes == 2:
  *     _ipt3d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint16_t>(((uint16_t *)(&(*((__pyx_t_float_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_11 * __pyx_v_arrview.strides[0]) ) + __pyx_t_12 * __pyx_v_arrview.strides[1]) ) + __pyx_t_13 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":918
+    /* "fastremap.pyx":929
  *       sx, sy, sz
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":925
+    /* "fastremap.pyx":936
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_14 = 0;
@@ -64073,37 +65523,37 @@
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_16 < 0) {
       __pyx_t_16 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_16 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_16 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 925, __pyx_L1_error)
+      __PYX_ERR(0, 936, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":924
+    /* "fastremap.pyx":935
  *     )
  *   elif nbytes == 4:
  *     _ipt3d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint32_t>(((uint32_t *)(&(*((__pyx_t_float_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_14 * __pyx_v_arrview.strides[0]) ) + __pyx_t_15 * __pyx_v_arrview.strides[1]) ) + __pyx_t_16 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
 
-    /* "fastremap.pyx":923
+    /* "fastremap.pyx":934
  *       sx, sy, sz
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt3d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":930
+    /* "fastremap.pyx":941
  *   else:
  *     _ipt3d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz
  *     )
  */
     __pyx_t_17 = 0;
@@ -64120,41 +65570,41 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[1])) __pyx_t_7 = 1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[2];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 2;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 930, __pyx_L1_error)
+      __PYX_ERR(0, 941, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":929
+    /* "fastremap.pyx":940
  *     )
  *   else:
  *     _ipt3d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0],
  *       sx, sy, sz
  */
     pyipt::_ipt3d<uint64_t>(((uint64_t *)(&(*((__pyx_t_float_complex *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_17 * __pyx_v_arrview.strides[0]) ) + __pyx_t_18 * __pyx_v_arrview.strides[1]) ) + __pyx_t_19 * __pyx_v_arrview.strides[2]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz);
     break;
   }
 
-  /* "fastremap.pyx":934
+  /* "fastremap.pyx":945
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
 
@@ -64179,15 +65629,15 @@
   __pyx_L2:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_arrview, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastremap.pyx":936
+/* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -64225,31 +65675,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_signatures)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_args)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 1); __PYX_ERR(0, 936, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 1); __PYX_ERR(0, 947, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_kwargs)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 2); __PYX_ERR(0, 936, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 2); __PYX_ERR(0, 947, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_defaults)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 3); __PYX_ERR(0, 936, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, 3); __PYX_ERR(0, 947, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") < 0)) __PYX_ERR(0, 936, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__pyx_fused_cpdef") < 0)) __PYX_ERR(0, 947, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -64258,15 +65708,15 @@
     __pyx_v_signatures = values[0];
     __pyx_v_args = values[1];
     __pyx_v_kwargs = values[2];
     __pyx_v_defaults = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 936, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__pyx_fused_cpdef", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 947, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastremap.__pyx_fused_cpdef", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_9fastremap_52ipt4d(__pyx_self, __pyx_v_signatures, __pyx_v_args, __pyx_v_kwargs, __pyx_v_defaults);
 
@@ -64317,146 +65767,146 @@
   PyObject *__pyx_t_14 = NULL;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   int __pyx_t_18;
   __Pyx_RefNannySetupContext("ipt4d", 0);
   __Pyx_INCREF(__pyx_v_kwargs);
-  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
   PyList_SET_ITEM(__pyx_t_1, 0, Py_None);
   __pyx_v_dest_sig = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
   __pyx_t_3 = (__pyx_v_kwargs != Py_None);
   __pyx_t_4 = (__pyx_t_3 != 0);
   if (__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_kwargs); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_kwargs); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_t_3 = ((!__pyx_t_4) != 0);
   __pyx_t_2 = __pyx_t_3;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_2) {
     __Pyx_INCREF(Py_None);
     __Pyx_DECREF_SET(__pyx_v_kwargs, Py_None);
   }
-  __pyx_t_1 = ((PyObject *)__Pyx_ImportNumPyArrayTypeIfAvailable()); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_1 = ((PyObject *)__Pyx_ImportNumPyArrayTypeIfAvailable()); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_ndarray = ((PyTypeObject*)__pyx_t_1);
   __pyx_t_1 = 0;
   __pyx_v_itemsize = -1L;
   __pyx_v____pyx_uint8_t_is_signed = (!((((uint8_t)-1L) > 0) != 0));
   __pyx_v____pyx_uint16_t_is_signed = (!((((uint16_t)-1L) > 0) != 0));
   __pyx_v____pyx_uint32_t_is_signed = (!((((uint32_t)-1L) > 0) != 0));
   __pyx_v____pyx_uint64_t_is_signed = (!((((uint64_t)-1L) > 0) != 0));
   __pyx_v____pyx_int8_t_is_signed = (!((((int8_t)-1L) > 0) != 0));
   __pyx_v____pyx_int16_t_is_signed = (!((((int16_t)-1L) > 0) != 0));
   __pyx_v____pyx_int32_t_is_signed = (!((((int32_t)-1L) > 0) != 0));
   __pyx_v____pyx_int64_t_is_signed = (!((((int64_t)-1L) > 0) != 0));
   if (unlikely(__pyx_v_args == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(0, 936, __pyx_L1_error)
+    __PYX_ERR(0, 947, __pyx_L1_error)
   }
-  __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_t_2 = ((0 < __pyx_t_5) != 0);
   if (__pyx_t_2) {
     if (unlikely(__pyx_v_args == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 936, __pyx_L1_error)
+      __PYX_ERR(0, 947, __pyx_L1_error)
     }
-    __pyx_t_1 = __Pyx_GetItemInt_Tuple(((PyObject*)__pyx_v_args), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt_Tuple(((PyObject*)__pyx_v_args), 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_arg = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L6;
   }
   __pyx_t_3 = (__pyx_v_kwargs != Py_None);
   __pyx_t_4 = (__pyx_t_3 != 0);
   if (__pyx_t_4) {
   } else {
     __pyx_t_2 = __pyx_t_4;
     goto __pyx_L7_bool_binop_done;
   }
   if (unlikely(__pyx_v_kwargs == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 936, __pyx_L1_error)
+    __PYX_ERR(0, 947, __pyx_L1_error)
   }
-  __pyx_t_4 = (__Pyx_PyDict_ContainsTF(__pyx_n_s_arr, ((PyObject*)__pyx_v_kwargs), Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyDict_ContainsTF(__pyx_n_s_arr, ((PyObject*)__pyx_v_kwargs), Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_t_3 = (__pyx_t_4 != 0);
   __pyx_t_2 = __pyx_t_3;
   __pyx_L7_bool_binop_done:;
   if (__pyx_t_2) {
     if (unlikely(__pyx_v_kwargs == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 936, __pyx_L1_error)
+      __PYX_ERR(0, 947, __pyx_L1_error)
     }
-    __pyx_t_1 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_kwargs), __pyx_n_s_arr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_kwargs), __pyx_n_s_arr); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_arg = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L6;
   }
   /*else*/ {
     if (unlikely(__pyx_v_args == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-      __PYX_ERR(0, 936, __pyx_L1_error)
+      __PYX_ERR(0, 947, __pyx_L1_error)
     }
-    __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 936, __pyx_L1_error)
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_GET_SIZE(((PyObject*)__pyx_v_args)); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 947, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_int_1);
     __Pyx_INCREF(__pyx_kp_s_);
     __Pyx_GIVEREF(__pyx_kp_s_);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_kp_s_);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Expected_at_least_d_argument_s_g, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyString_Format(__pyx_kp_s_Expected_at_least_d_argument_s_g, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_TypeError, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 936, __pyx_L1_error)
+    __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_L6:;
   while (1) {
     __pyx_t_2 = (__pyx_v_ndarray != ((PyTypeObject*)Py_None));
     __pyx_t_3 = (__pyx_t_2 != 0);
     if (__pyx_t_3) {
       __pyx_t_3 = __Pyx_TypeCheck(__pyx_v_arg, __pyx_v_ndarray); 
       __pyx_t_2 = (__pyx_t_3 != 0);
       if (__pyx_t_2) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_v_dtype = __pyx_t_6;
         __pyx_t_6 = 0;
         goto __pyx_L12;
       }
       __pyx_t_2 = __pyx_memoryview_check(__pyx_v_arg); 
       __pyx_t_3 = (__pyx_t_2 != 0);
       if (__pyx_t_3) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_base); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_base); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_v_arg_base = __pyx_t_6;
         __pyx_t_6 = 0;
         __pyx_t_3 = __Pyx_TypeCheck(__pyx_v_arg_base, __pyx_v_ndarray); 
         __pyx_t_2 = (__pyx_t_3 != 0);
         if (__pyx_t_2) {
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg_base, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg_base, __pyx_n_s_dtype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __pyx_v_dtype = __pyx_t_6;
           __pyx_t_6 = 0;
           goto __pyx_L13;
         }
         /*else*/ {
           __Pyx_INCREF(Py_None);
@@ -64470,265 +65920,265 @@
         __pyx_v_dtype = Py_None;
       }
       __pyx_L12:;
       __pyx_v_itemsize = -1L;
       __pyx_t_2 = (__pyx_v_dtype != Py_None);
       __pyx_t_3 = (__pyx_t_2 != 0);
       if (__pyx_t_3) {
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_v_itemsize = __pyx_t_5;
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_kind); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_dtype, __pyx_n_s_kind); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_7 = __Pyx_PyObject_Ord(__pyx_t_6); if (unlikely(__pyx_t_7 == ((long)(long)(Py_UCS4)-1))) __PYX_ERR(0, 936, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Ord(__pyx_t_6); if (unlikely(__pyx_t_7 == ((long)(long)(Py_UCS4)-1))) __PYX_ERR(0, 947, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_v_kind = __pyx_t_7;
         __pyx_v_dtype_signed = (__pyx_v_kind == 'i');
         switch (__pyx_v_kind) {
           case 'i':
           case 'u':
           __pyx_t_2 = (((sizeof(uint8_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L16_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 4) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L16_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint8_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L16_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(uint16_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L20_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 4) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L20_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint16_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L20_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(uint32_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L24_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 4) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L24_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint32_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L24_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(uint64_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L28_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 4) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L28_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_uint64_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L28_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int8_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L32_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 4) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L32_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int8_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L32_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int16_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L36_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 4) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L36_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int16_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L36_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int32_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L40_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 4) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L40_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int32_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L40_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(int64_t)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L44_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 4) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L44_bool_binop_done;
           }
           __pyx_t_2 = ((!((__pyx_v____pyx_int64_t_is_signed ^ __pyx_v_dtype_signed) != 0)) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L44_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           break;
           case 'f':
           __pyx_t_2 = (((sizeof(float)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L48_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 4) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L48_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           __pyx_t_2 = (((sizeof(double)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L51_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 4) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L51_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           break;
           case 'c':
           __pyx_t_2 = (((sizeof(__pyx_t_float_complex)) == __pyx_v_itemsize) != 0);
           if (__pyx_t_2) {
           } else {
             __pyx_t_3 = __pyx_t_2;
             goto __pyx_L54_bool_binop_done;
           }
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_arg, __pyx_n_s_ndim); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_5 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 947, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_2 = ((((Py_ssize_t)__pyx_t_5) == 4) != 0);
           __pyx_t_3 = __pyx_t_2;
           __pyx_L54_bool_binop_done:;
           if (__pyx_t_3) {
-            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+            if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
             goto __pyx_L10_break;
           }
           break;
           case 'O':
           break;
           default: break;
         }
@@ -64745,15 +66195,15 @@
     __pyx_L57_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint8_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -64767,15 +66217,15 @@
     __pyx_L61_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint16_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -64789,15 +66239,15 @@
     __pyx_L65_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint32_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -64811,15 +66261,15 @@
     __pyx_L69_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint64_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_uint64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -64833,15 +66283,15 @@
     __pyx_L73_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int8_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int8_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -64855,15 +66305,15 @@
     __pyx_L77_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int16_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int16_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -64877,15 +66327,15 @@
     __pyx_L81_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int32_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int32_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -64899,15 +66349,15 @@
     __pyx_L85_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int64_t(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_int64_t, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -64921,15 +66371,15 @@
     __pyx_L89_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_float(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_float, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -64943,15 +66393,15 @@
     __pyx_L93_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_n_s_double, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
     __pyx_t_2 = ((__pyx_v_itemsize == -1L) != 0);
@@ -64965,100 +66415,100 @@
     __pyx_L97_bool_binop_done:;
     if (__pyx_t_3) {
       __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds___pyx_t_float_complex(__pyx_v_arg, 0); 
       __pyx_v_memslice = __pyx_t_8;
       __pyx_t_3 = (__pyx_v_memslice.memview != 0);
       if (__pyx_t_3) {
         __PYX_XDEC_MEMVIEW((&__pyx_v_memslice), 1); 
-        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, __pyx_kp_s_float_complex, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         goto __pyx_L10_break;
       }
       /*else*/ {
         PyErr_Clear(); 
       }
     }
-    if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_SetItemInt(__pyx_v_dest_sig, 0, Py_None, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
     goto __pyx_L10_break;
   }
   __pyx_L10_break:;
-  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_v_candidates = ((PyObject*)__pyx_t_6);
   __pyx_t_6 = 0;
   __pyx_t_5 = 0;
   if (unlikely(__pyx_v_signatures == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 936, __pyx_L1_error)
+    __PYX_ERR(0, 947, __pyx_L1_error)
   }
-  __pyx_t_1 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&__pyx_t_9), (&__pyx_t_10)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_dict_iterator(((PyObject*)__pyx_v_signatures), 1, ((PyObject *)NULL), (&__pyx_t_9), (&__pyx_t_10)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_6);
   __pyx_t_6 = __pyx_t_1;
   __pyx_t_1 = 0;
   while (1) {
     __pyx_t_11 = __Pyx_dict_iter_next(__pyx_t_6, __pyx_t_9, &__pyx_t_5, &__pyx_t_1, NULL, NULL, __pyx_t_10);
     if (unlikely(__pyx_t_11 == 0)) break;
-    if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__pyx_t_11 == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_XDECREF_SET(__pyx_v_sig, __pyx_t_1);
     __pyx_t_1 = 0;
     __pyx_v_match_found = 0;
-    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_sig, __pyx_n_s_strip); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_sig, __pyx_n_s_strip); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __pyx_t_14 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
       __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_13);
       if (likely(__pyx_t_14)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
         __Pyx_INCREF(__pyx_t_14);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_13, function);
       }
     }
     __pyx_t_12 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_14, __pyx_kp_s__2) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_kp_s__2);
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_split); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_split); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __pyx_t_12 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_13))) {
       __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_13);
       if (likely(__pyx_t_12)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_13);
         __Pyx_INCREF(__pyx_t_12);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_13, function);
       }
     }
     __pyx_t_1 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_13, __pyx_t_12, __pyx_kp_s__3) : __Pyx_PyObject_CallOneArg(__pyx_t_13, __pyx_kp_s__3);
     __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_XDECREF_SET(__pyx_v_src_sig, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_15 = PyList_GET_SIZE(__pyx_v_dest_sig); if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1))) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_15 = PyList_GET_SIZE(__pyx_v_dest_sig); if (unlikely(__pyx_t_15 == ((Py_ssize_t)-1))) __PYX_ERR(0, 947, __pyx_L1_error)
     __pyx_t_16 = __pyx_t_15;
     for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
       __pyx_v_i = __pyx_t_17;
-      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_dest_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 936, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_dest_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_XDECREF_SET(__pyx_v_dst_type, __pyx_t_1);
       __pyx_t_1 = 0;
       __pyx_t_3 = (__pyx_v_dst_type != Py_None);
       __pyx_t_2 = (__pyx_t_3 != 0);
       if (__pyx_t_2) {
-        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_src_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 936, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_src_sig, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_13 = PyObject_RichCompare(__pyx_t_1, __pyx_v_dst_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 936, __pyx_L1_error)
+        __pyx_t_13 = PyObject_RichCompare(__pyx_t_1, __pyx_v_dst_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_13); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 947, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_13); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
         if (__pyx_t_2) {
           __pyx_v_match_found = 1;
           goto __pyx_L105;
         }
         /*else*/ {
           __pyx_v_match_found = 0;
@@ -65066,45 +66516,45 @@
         }
         __pyx_L105:;
       }
     }
     __pyx_L103_break:;
     __pyx_t_2 = (__pyx_v_match_found != 0);
     if (__pyx_t_2) {
-      __pyx_t_18 = __Pyx_PyList_Append(__pyx_v_candidates, __pyx_v_sig); if (unlikely(__pyx_t_18 == ((int)-1))) __PYX_ERR(0, 936, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyList_Append(__pyx_v_candidates, __pyx_v_sig); if (unlikely(__pyx_t_18 == ((int)-1))) __PYX_ERR(0, 947, __pyx_L1_error)
     }
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_2 = (PyList_GET_SIZE(__pyx_v_candidates) != 0);
   __pyx_t_3 = ((!__pyx_t_2) != 0);
   if (__pyx_t_3) {
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 936, __pyx_L1_error)
+    __PYX_ERR(0, 947, __pyx_L1_error)
   }
-  __pyx_t_9 = PyList_GET_SIZE(__pyx_v_candidates); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_9 = PyList_GET_SIZE(__pyx_v_candidates); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_t_3 = ((__pyx_t_9 > 1) != 0);
   if (__pyx_t_3) {
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_Raise(__pyx_t_6, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __PYX_ERR(0, 936, __pyx_L1_error)
+    __PYX_ERR(0, 947, __pyx_L1_error)
   }
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     if (unlikely(__pyx_v_signatures == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 936, __pyx_L1_error)
+      __PYX_ERR(0, 947, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_candidates, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_GetItemInt_List(__pyx_v_candidates, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_13 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_signatures), __pyx_t_6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyDict_GetItem(((PyObject*)__pyx_v_signatures), __pyx_t_6); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_13);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_r = __pyx_t_13;
     __pyx_t_13 = 0;
     goto __pyx_L0;
   }
 
@@ -65136,15 +66586,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_0__pyx_pw_9fastremap_269ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_0__pyx_mdef_9fastremap_269ipt4d = {"__pyx_fuse_0ipt4d", (PyCFunction)__pyx_fuse_0__pyx_pw_9fastremap_269ipt4d, METH_O, 0};
 static PyObject *__pyx_fuse_0__pyx_pw_9fastremap_269ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt4d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_268ipt4d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -65189,179 +66639,179 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_0ipt4d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2]; __pyx_pybuffernd_arr.diminfo[3].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[3]; __pyx_pybuffernd_arr.diminfo[3].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[3];
 
-  /* "fastremap.pyx":937
+  /* "fastremap.pyx":948
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":944
+  /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":945
+    /* "fastremap.pyx":956
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":946
+    /* "fastremap.pyx":957
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":947
+    /* "fastremap.pyx":958
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[3]
  *   else:
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":948
+    /* "fastremap.pyx":959
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[3]
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":944
+    /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":950
+  /* "fastremap.pyx":961
  *     sw = arr.shape[3]
  *   else:
  *     sx = arr.shape[3]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":951
+    /* "fastremap.pyx":962
  *   else:
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":952
+    /* "fastremap.pyx":963
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[0]
  * 
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":953
+    /* "fastremap.pyx":964
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":955
+  /* "fastremap.pyx":966
  *     sw = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":960
+  /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":962
+    /* "fastremap.pyx":973
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_8 = 0;
@@ -65383,37 +66833,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 962, __pyx_L1_error)
+      __PYX_ERR(0, 973, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":961
+    /* "fastremap.pyx":972
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint8_t>(((uint8_t *)(&(*((uint8_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ) + __pyx_t_11 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":960
+    /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":967
+    /* "fastremap.pyx":978
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_12 = 0;
@@ -65435,37 +66885,37 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 967, __pyx_L1_error)
+      __PYX_ERR(0, 978, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":966
+    /* "fastremap.pyx":977
  *     )
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint16_t>(((uint16_t *)(&(*((uint8_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ) + __pyx_t_14 * __pyx_v_arrview.strides[2]) ) + __pyx_t_15 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":965
+    /* "fastremap.pyx":976
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":972
+    /* "fastremap.pyx":983
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_16 = 0;
@@ -65487,37 +66937,37 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 972, __pyx_L1_error)
+      __PYX_ERR(0, 983, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":971
+    /* "fastremap.pyx":982
  *     )
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint32_t>(((uint32_t *)(&(*((uint8_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_16 * __pyx_v_arrview.strides[0]) ) + __pyx_t_17 * __pyx_v_arrview.strides[1]) ) + __pyx_t_18 * __pyx_v_arrview.strides[2]) ) + __pyx_t_19 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":970
+    /* "fastremap.pyx":981
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":977
+    /* "fastremap.pyx":988
  *   else:
  *     _ipt4d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_20 = 0;
@@ -65539,40 +66989,40 @@
     } else if (unlikely(__pyx_t_22 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_23 < 0) {
       __pyx_t_23 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_23 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_23 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 977, __pyx_L1_error)
+      __PYX_ERR(0, 988, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":976
+    /* "fastremap.pyx":987
  *     )
  *   else:
  *     _ipt4d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint64_t>(((uint64_t *)(&(*((uint8_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_20 * __pyx_v_arrview.strides[0]) ) + __pyx_t_21 * __pyx_v_arrview.strides[1]) ) + __pyx_t_22 * __pyx_v_arrview.strides[2]) ) + __pyx_t_23 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
     break;
   }
 
-  /* "fastremap.pyx":981
+  /* "fastremap.pyx":992
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -65604,15 +67054,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_1__pyx_pw_9fastremap_271ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_1__pyx_mdef_9fastremap_271ipt4d = {"__pyx_fuse_1ipt4d", (PyCFunction)__pyx_fuse_1__pyx_pw_9fastremap_271ipt4d, METH_O, 0};
 static PyObject *__pyx_fuse_1__pyx_pw_9fastremap_271ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt4d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_270ipt4d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -65657,179 +67107,179 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_1ipt4d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint16_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint16_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2]; __pyx_pybuffernd_arr.diminfo[3].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[3]; __pyx_pybuffernd_arr.diminfo[3].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[3];
 
-  /* "fastremap.pyx":937
+  /* "fastremap.pyx":948
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":944
+  /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":945
+    /* "fastremap.pyx":956
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":946
+    /* "fastremap.pyx":957
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":947
+    /* "fastremap.pyx":958
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[3]
  *   else:
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":948
+    /* "fastremap.pyx":959
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[3]
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":944
+    /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":950
+  /* "fastremap.pyx":961
  *     sw = arr.shape[3]
  *   else:
  *     sx = arr.shape[3]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":951
+    /* "fastremap.pyx":962
  *   else:
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":952
+    /* "fastremap.pyx":963
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[0]
  * 
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":953
+    /* "fastremap.pyx":964
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":955
+  /* "fastremap.pyx":966
  *     sw = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":960
+  /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":962
+    /* "fastremap.pyx":973
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_8 = 0;
@@ -65851,37 +67301,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 962, __pyx_L1_error)
+      __PYX_ERR(0, 973, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":961
+    /* "fastremap.pyx":972
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint8_t>(((uint8_t *)(&(*((uint16_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ) + __pyx_t_11 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":960
+    /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":967
+    /* "fastremap.pyx":978
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_12 = 0;
@@ -65903,37 +67353,37 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 967, __pyx_L1_error)
+      __PYX_ERR(0, 978, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":966
+    /* "fastremap.pyx":977
  *     )
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint16_t>(((uint16_t *)(&(*((uint16_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ) + __pyx_t_14 * __pyx_v_arrview.strides[2]) ) + __pyx_t_15 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":965
+    /* "fastremap.pyx":976
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":972
+    /* "fastremap.pyx":983
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_16 = 0;
@@ -65955,37 +67405,37 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 972, __pyx_L1_error)
+      __PYX_ERR(0, 983, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":971
+    /* "fastremap.pyx":982
  *     )
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint32_t>(((uint32_t *)(&(*((uint16_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_16 * __pyx_v_arrview.strides[0]) ) + __pyx_t_17 * __pyx_v_arrview.strides[1]) ) + __pyx_t_18 * __pyx_v_arrview.strides[2]) ) + __pyx_t_19 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":970
+    /* "fastremap.pyx":981
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":977
+    /* "fastremap.pyx":988
  *   else:
  *     _ipt4d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_20 = 0;
@@ -66007,40 +67457,40 @@
     } else if (unlikely(__pyx_t_22 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_23 < 0) {
       __pyx_t_23 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_23 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_23 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 977, __pyx_L1_error)
+      __PYX_ERR(0, 988, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":976
+    /* "fastremap.pyx":987
  *     )
  *   else:
  *     _ipt4d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint64_t>(((uint64_t *)(&(*((uint16_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_20 * __pyx_v_arrview.strides[0]) ) + __pyx_t_21 * __pyx_v_arrview.strides[1]) ) + __pyx_t_22 * __pyx_v_arrview.strides[2]) ) + __pyx_t_23 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
     break;
   }
 
-  /* "fastremap.pyx":981
+  /* "fastremap.pyx":992
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -66072,15 +67522,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_2__pyx_pw_9fastremap_273ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_2__pyx_mdef_9fastremap_273ipt4d = {"__pyx_fuse_2ipt4d", (PyCFunction)__pyx_fuse_2__pyx_pw_9fastremap_273ipt4d, METH_O, 0};
 static PyObject *__pyx_fuse_2__pyx_pw_9fastremap_273ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt4d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_272ipt4d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -66125,179 +67575,179 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_2ipt4d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2]; __pyx_pybuffernd_arr.diminfo[3].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[3]; __pyx_pybuffernd_arr.diminfo[3].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[3];
 
-  /* "fastremap.pyx":937
+  /* "fastremap.pyx":948
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":944
+  /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":945
+    /* "fastremap.pyx":956
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":946
+    /* "fastremap.pyx":957
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":947
+    /* "fastremap.pyx":958
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[3]
  *   else:
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":948
+    /* "fastremap.pyx":959
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[3]
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":944
+    /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":950
+  /* "fastremap.pyx":961
  *     sw = arr.shape[3]
  *   else:
  *     sx = arr.shape[3]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":951
+    /* "fastremap.pyx":962
  *   else:
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":952
+    /* "fastremap.pyx":963
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[0]
  * 
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":953
+    /* "fastremap.pyx":964
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":955
+  /* "fastremap.pyx":966
  *     sw = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":960
+  /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":962
+    /* "fastremap.pyx":973
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_8 = 0;
@@ -66319,37 +67769,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 962, __pyx_L1_error)
+      __PYX_ERR(0, 973, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":961
+    /* "fastremap.pyx":972
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint8_t>(((uint8_t *)(&(*((uint32_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ) + __pyx_t_11 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":960
+    /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":967
+    /* "fastremap.pyx":978
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_12 = 0;
@@ -66371,37 +67821,37 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 967, __pyx_L1_error)
+      __PYX_ERR(0, 978, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":966
+    /* "fastremap.pyx":977
  *     )
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint16_t>(((uint16_t *)(&(*((uint32_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ) + __pyx_t_14 * __pyx_v_arrview.strides[2]) ) + __pyx_t_15 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":965
+    /* "fastremap.pyx":976
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":972
+    /* "fastremap.pyx":983
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_16 = 0;
@@ -66423,37 +67873,37 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 972, __pyx_L1_error)
+      __PYX_ERR(0, 983, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":971
+    /* "fastremap.pyx":982
  *     )
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint32_t>(((uint32_t *)(&(*((uint32_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_16 * __pyx_v_arrview.strides[0]) ) + __pyx_t_17 * __pyx_v_arrview.strides[1]) ) + __pyx_t_18 * __pyx_v_arrview.strides[2]) ) + __pyx_t_19 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":970
+    /* "fastremap.pyx":981
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":977
+    /* "fastremap.pyx":988
  *   else:
  *     _ipt4d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_20 = 0;
@@ -66475,40 +67925,40 @@
     } else if (unlikely(__pyx_t_22 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_23 < 0) {
       __pyx_t_23 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_23 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_23 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 977, __pyx_L1_error)
+      __PYX_ERR(0, 988, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":976
+    /* "fastremap.pyx":987
  *     )
  *   else:
  *     _ipt4d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint64_t>(((uint64_t *)(&(*((uint32_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_20 * __pyx_v_arrview.strides[0]) ) + __pyx_t_21 * __pyx_v_arrview.strides[1]) ) + __pyx_t_22 * __pyx_v_arrview.strides[2]) ) + __pyx_t_23 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
     break;
   }
 
-  /* "fastremap.pyx":981
+  /* "fastremap.pyx":992
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -66540,15 +67990,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_3__pyx_pw_9fastremap_275ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_3__pyx_mdef_9fastremap_275ipt4d = {"__pyx_fuse_3ipt4d", (PyCFunction)__pyx_fuse_3__pyx_pw_9fastremap_275ipt4d, METH_O, 0};
 static PyObject *__pyx_fuse_3__pyx_pw_9fastremap_275ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt4d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_274ipt4d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -66593,179 +68043,179 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_3ipt4d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint64_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_uint64_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2]; __pyx_pybuffernd_arr.diminfo[3].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[3]; __pyx_pybuffernd_arr.diminfo[3].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[3];
 
-  /* "fastremap.pyx":937
+  /* "fastremap.pyx":948
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_uint64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":944
+  /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":945
+    /* "fastremap.pyx":956
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":946
+    /* "fastremap.pyx":957
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":947
+    /* "fastremap.pyx":958
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[3]
  *   else:
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":948
+    /* "fastremap.pyx":959
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[3]
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":944
+    /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":950
+  /* "fastremap.pyx":961
  *     sw = arr.shape[3]
  *   else:
  *     sx = arr.shape[3]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":951
+    /* "fastremap.pyx":962
  *   else:
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":952
+    /* "fastremap.pyx":963
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[0]
  * 
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":953
+    /* "fastremap.pyx":964
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":955
+  /* "fastremap.pyx":966
  *     sw = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":960
+  /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":962
+    /* "fastremap.pyx":973
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_8 = 0;
@@ -66787,37 +68237,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 962, __pyx_L1_error)
+      __PYX_ERR(0, 973, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":961
+    /* "fastremap.pyx":972
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint8_t>(((uint8_t *)(&(*((uint64_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ) + __pyx_t_11 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":960
+    /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":967
+    /* "fastremap.pyx":978
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_12 = 0;
@@ -66839,37 +68289,37 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 967, __pyx_L1_error)
+      __PYX_ERR(0, 978, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":966
+    /* "fastremap.pyx":977
  *     )
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint16_t>(((uint16_t *)(&(*((uint64_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ) + __pyx_t_14 * __pyx_v_arrview.strides[2]) ) + __pyx_t_15 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":965
+    /* "fastremap.pyx":976
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":972
+    /* "fastremap.pyx":983
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_16 = 0;
@@ -66891,37 +68341,37 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 972, __pyx_L1_error)
+      __PYX_ERR(0, 983, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":971
+    /* "fastremap.pyx":982
  *     )
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint32_t>(((uint32_t *)(&(*((uint64_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_16 * __pyx_v_arrview.strides[0]) ) + __pyx_t_17 * __pyx_v_arrview.strides[1]) ) + __pyx_t_18 * __pyx_v_arrview.strides[2]) ) + __pyx_t_19 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":970
+    /* "fastremap.pyx":981
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":977
+    /* "fastremap.pyx":988
  *   else:
  *     _ipt4d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_20 = 0;
@@ -66943,40 +68393,40 @@
     } else if (unlikely(__pyx_t_22 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_23 < 0) {
       __pyx_t_23 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_23 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_23 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 977, __pyx_L1_error)
+      __PYX_ERR(0, 988, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":976
+    /* "fastremap.pyx":987
  *     )
  *   else:
  *     _ipt4d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint64_t>(((uint64_t *)(&(*((uint64_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_20 * __pyx_v_arrview.strides[0]) ) + __pyx_t_21 * __pyx_v_arrview.strides[1]) ) + __pyx_t_22 * __pyx_v_arrview.strides[2]) ) + __pyx_t_23 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
     break;
   }
 
-  /* "fastremap.pyx":981
+  /* "fastremap.pyx":992
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -67008,15 +68458,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_4__pyx_pw_9fastremap_277ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_4__pyx_mdef_9fastremap_277ipt4d = {"__pyx_fuse_4ipt4d", (PyCFunction)__pyx_fuse_4__pyx_pw_9fastremap_277ipt4d, METH_O, 0};
 static PyObject *__pyx_fuse_4__pyx_pw_9fastremap_277ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt4d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_276ipt4d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -67061,179 +68511,179 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_4ipt4d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2]; __pyx_pybuffernd_arr.diminfo[3].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[3]; __pyx_pybuffernd_arr.diminfo[3].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[3];
 
-  /* "fastremap.pyx":937
+  /* "fastremap.pyx":948
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int8_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":944
+  /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":945
+    /* "fastremap.pyx":956
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":946
+    /* "fastremap.pyx":957
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":947
+    /* "fastremap.pyx":958
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[3]
  *   else:
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":948
+    /* "fastremap.pyx":959
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[3]
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":944
+    /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":950
+  /* "fastremap.pyx":961
  *     sw = arr.shape[3]
  *   else:
  *     sx = arr.shape[3]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":951
+    /* "fastremap.pyx":962
  *   else:
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":952
+    /* "fastremap.pyx":963
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[0]
  * 
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":953
+    /* "fastremap.pyx":964
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":955
+  /* "fastremap.pyx":966
  *     sw = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":960
+  /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":962
+    /* "fastremap.pyx":973
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_8 = 0;
@@ -67255,37 +68705,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 962, __pyx_L1_error)
+      __PYX_ERR(0, 973, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":961
+    /* "fastremap.pyx":972
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint8_t>(((uint8_t *)(&(*((int8_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ) + __pyx_t_11 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":960
+    /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":967
+    /* "fastremap.pyx":978
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_12 = 0;
@@ -67307,37 +68757,37 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 967, __pyx_L1_error)
+      __PYX_ERR(0, 978, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":966
+    /* "fastremap.pyx":977
  *     )
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint16_t>(((uint16_t *)(&(*((int8_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ) + __pyx_t_14 * __pyx_v_arrview.strides[2]) ) + __pyx_t_15 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":965
+    /* "fastremap.pyx":976
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":972
+    /* "fastremap.pyx":983
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_16 = 0;
@@ -67359,37 +68809,37 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 972, __pyx_L1_error)
+      __PYX_ERR(0, 983, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":971
+    /* "fastremap.pyx":982
  *     )
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint32_t>(((uint32_t *)(&(*((int8_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_16 * __pyx_v_arrview.strides[0]) ) + __pyx_t_17 * __pyx_v_arrview.strides[1]) ) + __pyx_t_18 * __pyx_v_arrview.strides[2]) ) + __pyx_t_19 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":970
+    /* "fastremap.pyx":981
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":977
+    /* "fastremap.pyx":988
  *   else:
  *     _ipt4d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_20 = 0;
@@ -67411,40 +68861,40 @@
     } else if (unlikely(__pyx_t_22 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_23 < 0) {
       __pyx_t_23 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_23 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_23 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 977, __pyx_L1_error)
+      __PYX_ERR(0, 988, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":976
+    /* "fastremap.pyx":987
  *     )
  *   else:
  *     _ipt4d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint64_t>(((uint64_t *)(&(*((int8_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_20 * __pyx_v_arrview.strides[0]) ) + __pyx_t_21 * __pyx_v_arrview.strides[1]) ) + __pyx_t_22 * __pyx_v_arrview.strides[2]) ) + __pyx_t_23 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
     break;
   }
 
-  /* "fastremap.pyx":981
+  /* "fastremap.pyx":992
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -67476,15 +68926,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_5__pyx_pw_9fastremap_279ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_5__pyx_mdef_9fastremap_279ipt4d = {"__pyx_fuse_5ipt4d", (PyCFunction)__pyx_fuse_5__pyx_pw_9fastremap_279ipt4d, METH_O, 0};
 static PyObject *__pyx_fuse_5__pyx_pw_9fastremap_279ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt4d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_278ipt4d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -67529,179 +68979,179 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_5ipt4d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int16_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int16_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2]; __pyx_pybuffernd_arr.diminfo[3].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[3]; __pyx_pybuffernd_arr.diminfo[3].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[3];
 
-  /* "fastremap.pyx":937
+  /* "fastremap.pyx":948
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int16_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":944
+  /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":945
+    /* "fastremap.pyx":956
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":946
+    /* "fastremap.pyx":957
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":947
+    /* "fastremap.pyx":958
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[3]
  *   else:
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":948
+    /* "fastremap.pyx":959
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[3]
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":944
+    /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":950
+  /* "fastremap.pyx":961
  *     sw = arr.shape[3]
  *   else:
  *     sx = arr.shape[3]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":951
+    /* "fastremap.pyx":962
  *   else:
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":952
+    /* "fastremap.pyx":963
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[0]
  * 
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":953
+    /* "fastremap.pyx":964
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":955
+  /* "fastremap.pyx":966
  *     sw = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":960
+  /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":962
+    /* "fastremap.pyx":973
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_8 = 0;
@@ -67723,37 +69173,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 962, __pyx_L1_error)
+      __PYX_ERR(0, 973, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":961
+    /* "fastremap.pyx":972
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint8_t>(((uint8_t *)(&(*((int16_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ) + __pyx_t_11 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":960
+    /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":967
+    /* "fastremap.pyx":978
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_12 = 0;
@@ -67775,37 +69225,37 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 967, __pyx_L1_error)
+      __PYX_ERR(0, 978, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":966
+    /* "fastremap.pyx":977
  *     )
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint16_t>(((uint16_t *)(&(*((int16_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ) + __pyx_t_14 * __pyx_v_arrview.strides[2]) ) + __pyx_t_15 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":965
+    /* "fastremap.pyx":976
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":972
+    /* "fastremap.pyx":983
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_16 = 0;
@@ -67827,37 +69277,37 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 972, __pyx_L1_error)
+      __PYX_ERR(0, 983, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":971
+    /* "fastremap.pyx":982
  *     )
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint32_t>(((uint32_t *)(&(*((int16_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_16 * __pyx_v_arrview.strides[0]) ) + __pyx_t_17 * __pyx_v_arrview.strides[1]) ) + __pyx_t_18 * __pyx_v_arrview.strides[2]) ) + __pyx_t_19 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":970
+    /* "fastremap.pyx":981
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":977
+    /* "fastremap.pyx":988
  *   else:
  *     _ipt4d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_20 = 0;
@@ -67879,40 +69329,40 @@
     } else if (unlikely(__pyx_t_22 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_23 < 0) {
       __pyx_t_23 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_23 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_23 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 977, __pyx_L1_error)
+      __PYX_ERR(0, 988, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":976
+    /* "fastremap.pyx":987
  *     )
  *   else:
  *     _ipt4d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint64_t>(((uint64_t *)(&(*((int16_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_20 * __pyx_v_arrview.strides[0]) ) + __pyx_t_21 * __pyx_v_arrview.strides[1]) ) + __pyx_t_22 * __pyx_v_arrview.strides[2]) ) + __pyx_t_23 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
     break;
   }
 
-  /* "fastremap.pyx":981
+  /* "fastremap.pyx":992
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -67944,15 +69394,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_6__pyx_pw_9fastremap_281ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_6__pyx_mdef_9fastremap_281ipt4d = {"__pyx_fuse_6ipt4d", (PyCFunction)__pyx_fuse_6__pyx_pw_9fastremap_281ipt4d, METH_O, 0};
 static PyObject *__pyx_fuse_6__pyx_pw_9fastremap_281ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt4d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_280ipt4d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -67997,179 +69447,179 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_6ipt4d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2]; __pyx_pybuffernd_arr.diminfo[3].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[3]; __pyx_pybuffernd_arr.diminfo[3].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[3];
 
-  /* "fastremap.pyx":937
+  /* "fastremap.pyx":948
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int32_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":944
+  /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":945
+    /* "fastremap.pyx":956
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":946
+    /* "fastremap.pyx":957
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":947
+    /* "fastremap.pyx":958
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[3]
  *   else:
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":948
+    /* "fastremap.pyx":959
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[3]
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":944
+    /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":950
+  /* "fastremap.pyx":961
  *     sw = arr.shape[3]
  *   else:
  *     sx = arr.shape[3]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":951
+    /* "fastremap.pyx":962
  *   else:
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":952
+    /* "fastremap.pyx":963
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[0]
  * 
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":953
+    /* "fastremap.pyx":964
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":955
+  /* "fastremap.pyx":966
  *     sw = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":960
+  /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":962
+    /* "fastremap.pyx":973
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_8 = 0;
@@ -68191,37 +69641,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 962, __pyx_L1_error)
+      __PYX_ERR(0, 973, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":961
+    /* "fastremap.pyx":972
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint8_t>(((uint8_t *)(&(*((int32_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ) + __pyx_t_11 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":960
+    /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":967
+    /* "fastremap.pyx":978
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_12 = 0;
@@ -68243,37 +69693,37 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 967, __pyx_L1_error)
+      __PYX_ERR(0, 978, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":966
+    /* "fastremap.pyx":977
  *     )
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint16_t>(((uint16_t *)(&(*((int32_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ) + __pyx_t_14 * __pyx_v_arrview.strides[2]) ) + __pyx_t_15 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":965
+    /* "fastremap.pyx":976
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":972
+    /* "fastremap.pyx":983
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_16 = 0;
@@ -68295,37 +69745,37 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 972, __pyx_L1_error)
+      __PYX_ERR(0, 983, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":971
+    /* "fastremap.pyx":982
  *     )
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint32_t>(((uint32_t *)(&(*((int32_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_16 * __pyx_v_arrview.strides[0]) ) + __pyx_t_17 * __pyx_v_arrview.strides[1]) ) + __pyx_t_18 * __pyx_v_arrview.strides[2]) ) + __pyx_t_19 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":970
+    /* "fastremap.pyx":981
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":977
+    /* "fastremap.pyx":988
  *   else:
  *     _ipt4d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_20 = 0;
@@ -68347,40 +69797,40 @@
     } else if (unlikely(__pyx_t_22 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_23 < 0) {
       __pyx_t_23 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_23 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_23 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 977, __pyx_L1_error)
+      __PYX_ERR(0, 988, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":976
+    /* "fastremap.pyx":987
  *     )
  *   else:
  *     _ipt4d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint64_t>(((uint64_t *)(&(*((int32_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_20 * __pyx_v_arrview.strides[0]) ) + __pyx_t_21 * __pyx_v_arrview.strides[1]) ) + __pyx_t_22 * __pyx_v_arrview.strides[2]) ) + __pyx_t_23 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
     break;
   }
 
-  /* "fastremap.pyx":981
+  /* "fastremap.pyx":992
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -68412,15 +69862,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_7__pyx_pw_9fastremap_283ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_7__pyx_mdef_9fastremap_283ipt4d = {"__pyx_fuse_7ipt4d", (PyCFunction)__pyx_fuse_7__pyx_pw_9fastremap_283ipt4d, METH_O, 0};
 static PyObject *__pyx_fuse_7__pyx_pw_9fastremap_283ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt4d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_282ipt4d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -68465,179 +69915,179 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_7ipt4d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_nn_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2]; __pyx_pybuffernd_arr.diminfo[3].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[3]; __pyx_pybuffernd_arr.diminfo[3].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[3];
 
-  /* "fastremap.pyx":937
+  /* "fastremap.pyx":948
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_nn_int64_t(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":944
+  /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":945
+    /* "fastremap.pyx":956
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":946
+    /* "fastremap.pyx":957
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":947
+    /* "fastremap.pyx":958
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[3]
  *   else:
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":948
+    /* "fastremap.pyx":959
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[3]
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":944
+    /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":950
+  /* "fastremap.pyx":961
  *     sw = arr.shape[3]
  *   else:
  *     sx = arr.shape[3]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":951
+    /* "fastremap.pyx":962
  *   else:
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":952
+    /* "fastremap.pyx":963
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[0]
  * 
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":953
+    /* "fastremap.pyx":964
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":955
+  /* "fastremap.pyx":966
  *     sw = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":960
+  /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":962
+    /* "fastremap.pyx":973
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_8 = 0;
@@ -68659,37 +70109,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 962, __pyx_L1_error)
+      __PYX_ERR(0, 973, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":961
+    /* "fastremap.pyx":972
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint8_t>(((uint8_t *)(&(*((int64_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ) + __pyx_t_11 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":960
+    /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":967
+    /* "fastremap.pyx":978
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_12 = 0;
@@ -68711,37 +70161,37 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 967, __pyx_L1_error)
+      __PYX_ERR(0, 978, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":966
+    /* "fastremap.pyx":977
  *     )
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint16_t>(((uint16_t *)(&(*((int64_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ) + __pyx_t_14 * __pyx_v_arrview.strides[2]) ) + __pyx_t_15 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":965
+    /* "fastremap.pyx":976
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":972
+    /* "fastremap.pyx":983
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_16 = 0;
@@ -68763,37 +70213,37 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 972, __pyx_L1_error)
+      __PYX_ERR(0, 983, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":971
+    /* "fastremap.pyx":982
  *     )
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint32_t>(((uint32_t *)(&(*((int64_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_16 * __pyx_v_arrview.strides[0]) ) + __pyx_t_17 * __pyx_v_arrview.strides[1]) ) + __pyx_t_18 * __pyx_v_arrview.strides[2]) ) + __pyx_t_19 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":970
+    /* "fastremap.pyx":981
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":977
+    /* "fastremap.pyx":988
  *   else:
  *     _ipt4d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_20 = 0;
@@ -68815,40 +70265,40 @@
     } else if (unlikely(__pyx_t_22 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_23 < 0) {
       __pyx_t_23 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_23 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_23 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 977, __pyx_L1_error)
+      __PYX_ERR(0, 988, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":976
+    /* "fastremap.pyx":987
  *     )
  *   else:
  *     _ipt4d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint64_t>(((uint64_t *)(&(*((int64_t *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_20 * __pyx_v_arrview.strides[0]) ) + __pyx_t_21 * __pyx_v_arrview.strides[1]) ) + __pyx_t_22 * __pyx_v_arrview.strides[2]) ) + __pyx_t_23 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
     break;
   }
 
-  /* "fastremap.pyx":981
+  /* "fastremap.pyx":992
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -68880,15 +70330,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_8__pyx_pw_9fastremap_285ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_8__pyx_mdef_9fastremap_285ipt4d = {"__pyx_fuse_8ipt4d", (PyCFunction)__pyx_fuse_8__pyx_pw_9fastremap_285ipt4d, METH_O, 0};
 static PyObject *__pyx_fuse_8__pyx_pw_9fastremap_285ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt4d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_284ipt4d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -68933,179 +70383,179 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_8ipt4d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_float, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2]; __pyx_pybuffernd_arr.diminfo[3].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[3]; __pyx_pybuffernd_arr.diminfo[3].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[3];
 
-  /* "fastremap.pyx":937
+  /* "fastremap.pyx":948
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_float(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_float(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":944
+  /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":945
+    /* "fastremap.pyx":956
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":946
+    /* "fastremap.pyx":957
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":947
+    /* "fastremap.pyx":958
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[3]
  *   else:
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":948
+    /* "fastremap.pyx":959
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[3]
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":944
+    /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":950
+  /* "fastremap.pyx":961
  *     sw = arr.shape[3]
  *   else:
  *     sx = arr.shape[3]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":951
+    /* "fastremap.pyx":962
  *   else:
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":952
+    /* "fastremap.pyx":963
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[0]
  * 
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":953
+    /* "fastremap.pyx":964
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":955
+  /* "fastremap.pyx":966
  *     sw = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":960
+  /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":962
+    /* "fastremap.pyx":973
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_8 = 0;
@@ -69127,37 +70577,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 962, __pyx_L1_error)
+      __PYX_ERR(0, 973, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":961
+    /* "fastremap.pyx":972
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint8_t>(((uint8_t *)(&(*((float *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ) + __pyx_t_11 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":960
+    /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":967
+    /* "fastremap.pyx":978
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_12 = 0;
@@ -69179,37 +70629,37 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 967, __pyx_L1_error)
+      __PYX_ERR(0, 978, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":966
+    /* "fastremap.pyx":977
  *     )
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint16_t>(((uint16_t *)(&(*((float *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ) + __pyx_t_14 * __pyx_v_arrview.strides[2]) ) + __pyx_t_15 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":965
+    /* "fastremap.pyx":976
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":972
+    /* "fastremap.pyx":983
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_16 = 0;
@@ -69231,37 +70681,37 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 972, __pyx_L1_error)
+      __PYX_ERR(0, 983, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":971
+    /* "fastremap.pyx":982
  *     )
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint32_t>(((uint32_t *)(&(*((float *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_16 * __pyx_v_arrview.strides[0]) ) + __pyx_t_17 * __pyx_v_arrview.strides[1]) ) + __pyx_t_18 * __pyx_v_arrview.strides[2]) ) + __pyx_t_19 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":970
+    /* "fastremap.pyx":981
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":977
+    /* "fastremap.pyx":988
  *   else:
  *     _ipt4d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_20 = 0;
@@ -69283,40 +70733,40 @@
     } else if (unlikely(__pyx_t_22 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_23 < 0) {
       __pyx_t_23 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_23 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_23 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 977, __pyx_L1_error)
+      __PYX_ERR(0, 988, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":976
+    /* "fastremap.pyx":987
  *     )
  *   else:
  *     _ipt4d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint64_t>(((uint64_t *)(&(*((float *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_20 * __pyx_v_arrview.strides[0]) ) + __pyx_t_21 * __pyx_v_arrview.strides[1]) ) + __pyx_t_22 * __pyx_v_arrview.strides[2]) ) + __pyx_t_23 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
     break;
   }
 
-  /* "fastremap.pyx":981
+  /* "fastremap.pyx":992
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -69348,15 +70798,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_9__pyx_pw_9fastremap_287ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_9__pyx_mdef_9fastremap_287ipt4d = {"__pyx_fuse_9ipt4d", (PyCFunction)__pyx_fuse_9__pyx_pw_9fastremap_287ipt4d, METH_O, 0};
 static PyObject *__pyx_fuse_9__pyx_pw_9fastremap_287ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt4d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_286ipt4d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -69401,179 +70851,179 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_9ipt4d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2]; __pyx_pybuffernd_arr.diminfo[3].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[3]; __pyx_pybuffernd_arr.diminfo[3].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[3];
 
-  /* "fastremap.pyx":937
+  /* "fastremap.pyx":948
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds_double(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":944
+  /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":945
+    /* "fastremap.pyx":956
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":946
+    /* "fastremap.pyx":957
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":947
+    /* "fastremap.pyx":958
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[3]
  *   else:
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":948
+    /* "fastremap.pyx":959
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[3]
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":944
+    /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":950
+  /* "fastremap.pyx":961
  *     sw = arr.shape[3]
  *   else:
  *     sx = arr.shape[3]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":951
+    /* "fastremap.pyx":962
  *   else:
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":952
+    /* "fastremap.pyx":963
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[0]
  * 
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":953
+    /* "fastremap.pyx":964
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":955
+  /* "fastremap.pyx":966
  *     sw = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":960
+  /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":962
+    /* "fastremap.pyx":973
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_8 = 0;
@@ -69595,37 +71045,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 962, __pyx_L1_error)
+      __PYX_ERR(0, 973, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":961
+    /* "fastremap.pyx":972
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint8_t>(((uint8_t *)(&(*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ) + __pyx_t_11 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":960
+    /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":967
+    /* "fastremap.pyx":978
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_12 = 0;
@@ -69647,37 +71097,37 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 967, __pyx_L1_error)
+      __PYX_ERR(0, 978, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":966
+    /* "fastremap.pyx":977
  *     )
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint16_t>(((uint16_t *)(&(*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ) + __pyx_t_14 * __pyx_v_arrview.strides[2]) ) + __pyx_t_15 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":965
+    /* "fastremap.pyx":976
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":972
+    /* "fastremap.pyx":983
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_16 = 0;
@@ -69699,37 +71149,37 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 972, __pyx_L1_error)
+      __PYX_ERR(0, 983, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":971
+    /* "fastremap.pyx":982
  *     )
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint32_t>(((uint32_t *)(&(*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_16 * __pyx_v_arrview.strides[0]) ) + __pyx_t_17 * __pyx_v_arrview.strides[1]) ) + __pyx_t_18 * __pyx_v_arrview.strides[2]) ) + __pyx_t_19 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":970
+    /* "fastremap.pyx":981
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":977
+    /* "fastremap.pyx":988
  *   else:
  *     _ipt4d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_20 = 0;
@@ -69751,40 +71201,40 @@
     } else if (unlikely(__pyx_t_22 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_23 < 0) {
       __pyx_t_23 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_23 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_23 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 977, __pyx_L1_error)
+      __PYX_ERR(0, 988, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":976
+    /* "fastremap.pyx":987
  *     )
  *   else:
  *     _ipt4d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint64_t>(((uint64_t *)(&(*((double *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_20 * __pyx_v_arrview.strides[0]) ) + __pyx_t_21 * __pyx_v_arrview.strides[1]) ) + __pyx_t_22 * __pyx_v_arrview.strides[2]) ) + __pyx_t_23 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
     break;
   }
 
-  /* "fastremap.pyx":981
+  /* "fastremap.pyx":992
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -69816,15 +71266,15 @@
 /* Python wrapper */
 static PyObject *__pyx_fuse_10__pyx_pw_9fastremap_289ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr); /*proto*/
 static PyMethodDef __pyx_fuse_10__pyx_mdef_9fastremap_289ipt4d = {"__pyx_fuse_10ipt4d", (PyCFunction)__pyx_fuse_10__pyx_pw_9fastremap_289ipt4d, METH_O, 0};
 static PyObject *__pyx_fuse_10__pyx_pw_9fastremap_289ipt4d(PyObject *__pyx_self, PyObject *__pyx_v_arr) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ipt4d (wrapper)", 0);
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_arr), __pyx_ptype_5numpy_ndarray, 1, "arr", 0))) __PYX_ERR(0, 947, __pyx_L1_error)
   __pyx_r = __pyx_pf_9fastremap_288ipt4d(__pyx_self, ((PyArrayObject *)__pyx_v_arr));
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -69869,179 +71319,179 @@
   __Pyx_RefNannySetupContext("__pyx_fuse_10ipt4d", 0);
   __pyx_pybuffer_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_arr.refcount = 0;
   __pyx_pybuffernd_arr.data = NULL;
   __pyx_pybuffernd_arr.rcbuffer = &__pyx_pybuffer_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 936, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_arr, &__Pyx_TypeInfo___pyx_t_float_complex, PyBUF_FORMAT| PyBUF_STRIDES, 4, 1, __pyx_stack) == -1)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __pyx_pybuffernd_arr.diminfo[0].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_arr.diminfo[0].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_arr.diminfo[1].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_arr.diminfo[1].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_arr.diminfo[2].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_arr.diminfo[2].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[2]; __pyx_pybuffernd_arr.diminfo[3].strides = __pyx_pybuffernd_arr.rcbuffer->pybuffer.strides[3]; __pyx_pybuffernd_arr.diminfo[3].shape = __pyx_pybuffernd_arr.rcbuffer->pybuffer.shape[3];
 
-  /* "fastremap.pyx":937
+  /* "fastremap.pyx":948
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr             # <<<<<<<<<<<<<<
  * 
  *   cdef size_t sx
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds___pyx_t_float_complex(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsdsdsds___pyx_t_float_complex(((PyObject *)__pyx_v_arr), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 948, __pyx_L1_error)
   __pyx_v_arrview = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastremap.pyx":944
+  /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_flags); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_F_CONTIGUOUS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
 
-    /* "fastremap.pyx":945
+    /* "fastremap.pyx":956
  * 
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  */
     __pyx_v_sx = (__pyx_v_arr->dimensions[0]);
 
-    /* "fastremap.pyx":946
+    /* "fastremap.pyx":957
  *   if arr.flags['F_CONTIGUOUS']:
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":947
+    /* "fastremap.pyx":958
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[3]
  *   else:
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":948
+    /* "fastremap.pyx":959
  *     sy = arr.shape[1]
  *     sz = arr.shape[2]
  *     sw = arr.shape[3]             # <<<<<<<<<<<<<<
  *   else:
  *     sx = arr.shape[3]
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":944
+    /* "fastremap.pyx":955
  *   cdef size_t sw
  * 
  *   if arr.flags['F_CONTIGUOUS']:             # <<<<<<<<<<<<<<
  *     sx = arr.shape[0]
  *     sy = arr.shape[1]
  */
     goto __pyx_L3;
   }
 
-  /* "fastremap.pyx":950
+  /* "fastremap.pyx":961
  *     sw = arr.shape[3]
  *   else:
  *     sx = arr.shape[3]             # <<<<<<<<<<<<<<
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  */
   /*else*/ {
     __pyx_v_sx = (__pyx_v_arr->dimensions[3]);
 
-    /* "fastremap.pyx":951
+    /* "fastremap.pyx":962
  *   else:
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]             # <<<<<<<<<<<<<<
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]
  */
     __pyx_v_sy = (__pyx_v_arr->dimensions[2]);
 
-    /* "fastremap.pyx":952
+    /* "fastremap.pyx":963
  *     sx = arr.shape[3]
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]             # <<<<<<<<<<<<<<
  *     sw = arr.shape[0]
  * 
  */
     __pyx_v_sz = (__pyx_v_arr->dimensions[1]);
 
-    /* "fastremap.pyx":953
+    /* "fastremap.pyx":964
  *     sy = arr.shape[2]
  *     sz = arr.shape[1]
  *     sw = arr.shape[0]             # <<<<<<<<<<<<<<
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize
  */
     __pyx_v_sw = (__pyx_v_arr->dimensions[0]);
   }
   __pyx_L3:;
 
-  /* "fastremap.pyx":955
+  /* "fastremap.pyx":966
  *     sw = arr.shape[0]
  * 
  *   cdef int nbytes = np.dtype(arr.dtype).itemsize             # <<<<<<<<<<<<<<
  * 
  *   # ipt doesn't do anything with values,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dtype); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_arr), __pyx_n_s_dtype); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_itemsize); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_t_5); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_nbytes = __pyx_t_7;
 
-  /* "fastremap.pyx":960
+  /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
   switch (__pyx_v_nbytes) {
     case 1:
 
-    /* "fastremap.pyx":962
+    /* "fastremap.pyx":973
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_8 = 0;
@@ -70063,37 +71513,37 @@
     } else if (unlikely(__pyx_t_10 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_11 < 0) {
       __pyx_t_11 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_11 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_11 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 962, __pyx_L1_error)
+      __PYX_ERR(0, 973, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":961
+    /* "fastremap.pyx":972
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:
  *     _ipt4d[uint8_t](             # <<<<<<<<<<<<<<
  *       <uint8_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint8_t>(((uint8_t *)(&(*((__pyx_t_float_complex *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_8 * __pyx_v_arrview.strides[0]) ) + __pyx_t_9 * __pyx_v_arrview.strides[1]) ) + __pyx_t_10 * __pyx_v_arrview.strides[2]) ) + __pyx_t_11 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":960
+    /* "fastremap.pyx":971
  *   # just moves them around, so only bit width matters
  *   # int, uint, float, bool who cares
  *   if nbytes == 1:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint8_t](
  *       <uint8_t*>&arrview[0,0,0,0],
  */
     break;
     case 2:
 
-    /* "fastremap.pyx":967
+    /* "fastremap.pyx":978
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_12 = 0;
@@ -70115,37 +71565,37 @@
     } else if (unlikely(__pyx_t_14 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 967, __pyx_L1_error)
+      __PYX_ERR(0, 978, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":966
+    /* "fastremap.pyx":977
  *     )
  *   elif nbytes == 2:
  *     _ipt4d[uint16_t](             # <<<<<<<<<<<<<<
  *       <uint16_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint16_t>(((uint16_t *)(&(*((__pyx_t_float_complex *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_12 * __pyx_v_arrview.strides[0]) ) + __pyx_t_13 * __pyx_v_arrview.strides[1]) ) + __pyx_t_14 * __pyx_v_arrview.strides[2]) ) + __pyx_t_15 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":965
+    /* "fastremap.pyx":976
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 2:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint16_t](
  *       <uint16_t*>&arrview[0,0,0,0],
  */
     break;
     case 4:
 
-    /* "fastremap.pyx":972
+    /* "fastremap.pyx":983
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_16 = 0;
@@ -70167,37 +71617,37 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 972, __pyx_L1_error)
+      __PYX_ERR(0, 983, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":971
+    /* "fastremap.pyx":982
  *     )
  *   elif nbytes == 4:
  *     _ipt4d[uint32_t](             # <<<<<<<<<<<<<<
  *       <uint32_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint32_t>(((uint32_t *)(&(*((__pyx_t_float_complex *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_16 * __pyx_v_arrview.strides[0]) ) + __pyx_t_17 * __pyx_v_arrview.strides[1]) ) + __pyx_t_18 * __pyx_v_arrview.strides[2]) ) + __pyx_t_19 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
 
-    /* "fastremap.pyx":970
+    /* "fastremap.pyx":981
  *       sx, sy, sz, sw
  *     )
  *   elif nbytes == 4:             # <<<<<<<<<<<<<<
  *     _ipt4d[uint32_t](
  *       <uint32_t*>&arrview[0,0,0,0],
  */
     break;
     default:
 
-    /* "fastremap.pyx":977
+    /* "fastremap.pyx":988
  *   else:
  *     _ipt4d[uint64_t](
  *       <uint64_t*>&arrview[0,0,0,0],             # <<<<<<<<<<<<<<
  *       sx, sy, sz, sw
  *     )
  */
     __pyx_t_20 = 0;
@@ -70219,40 +71669,40 @@
     } else if (unlikely(__pyx_t_22 >= __pyx_v_arrview.shape[2])) __pyx_t_7 = 2;
     if (__pyx_t_23 < 0) {
       __pyx_t_23 += __pyx_v_arrview.shape[3];
       if (unlikely(__pyx_t_23 < 0)) __pyx_t_7 = 3;
     } else if (unlikely(__pyx_t_23 >= __pyx_v_arrview.shape[3])) __pyx_t_7 = 3;
     if (unlikely(__pyx_t_7 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_7);
-      __PYX_ERR(0, 977, __pyx_L1_error)
+      __PYX_ERR(0, 988, __pyx_L1_error)
     }
 
-    /* "fastremap.pyx":976
+    /* "fastremap.pyx":987
  *     )
  *   else:
  *     _ipt4d[uint64_t](             # <<<<<<<<<<<<<<
  *       <uint64_t*>&arrview[0,0,0,0],
  *       sx, sy, sz, sw
  */
     pyipt::_ipt4d<uint64_t>(((uint64_t *)(&(*((__pyx_t_float_complex *) ( /* dim=3 */ (( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_arrview.data + __pyx_t_20 * __pyx_v_arrview.strides[0]) ) + __pyx_t_21 * __pyx_v_arrview.strides[1]) ) + __pyx_t_22 * __pyx_v_arrview.strides[2]) ) + __pyx_t_23 * __pyx_v_arrview.strides[3]) ))))), __pyx_v_sx, __pyx_v_sy, __pyx_v_sz, __pyx_v_sw);
     break;
   }
 
-  /* "fastremap.pyx":981
+  /* "fastremap.pyx":992
  *     )
  * 
  *   return arr             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_arr));
   __pyx_r = ((PyObject *)__pyx_v_arr);
   goto __pyx_L0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
 
@@ -86280,15 +87730,15 @@
 #else
     #define CYTHON_SMALL_CODE
 #endif
 #endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_kp_s_, __pyx_k_, sizeof(__pyx_k_), 0, 0, 1, 0},
-  {&__pyx_kp_u_1_9_1, __pyx_k_1_9_1, sizeof(__pyx_k_1_9_1), 0, 1, 0, 0},
+  {&__pyx_kp_u_1_9_2, __pyx_k_1_9_2, sizeof(__pyx_k_1_9_2), 0, 1, 0, 0},
   {&__pyx_n_s_ASCII, __pyx_k_ASCII, sizeof(__pyx_k_ASCII), 0, 0, 1, 1},
   {&__pyx_kp_s_Buffer_view_does_not_expose_stri, __pyx_k_Buffer_view_does_not_expose_stri, sizeof(__pyx_k_Buffer_view_does_not_expose_stri), 0, 0, 1, 0},
   {&__pyx_n_u_C, __pyx_k_C, sizeof(__pyx_k_C), 0, 1, 0, 1},
   {&__pyx_n_u_C_CONTIGUOUS, __pyx_k_C_CONTIGUOUS, sizeof(__pyx_k_C_CONTIGUOUS), 0, 1, 0, 1},
   {&__pyx_kp_s_Can_only_create_a_buffer_that_is, __pyx_k_Can_only_create_a_buffer_that_is, sizeof(__pyx_k_Can_only_create_a_buffer_that_is), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_assign_to_read_only_memor, __pyx_k_Cannot_assign_to_read_only_memor, sizeof(__pyx_k_Cannot_assign_to_read_only_memor), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_create_writable_memory_vi, __pyx_k_Cannot_create_writable_memory_vi, sizeof(__pyx_k_Cannot_create_writable_memory_vi), 0, 0, 1, 0},
@@ -86468,14 +87918,15 @@
   {&__pyx_n_s_pyx_result, __pyx_k_pyx_result, sizeof(__pyx_k_pyx_result), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_state, __pyx_k_pyx_state, sizeof(__pyx_k_pyx_state), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_type, __pyx_k_pyx_type, sizeof(__pyx_k_pyx_type), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_unpickle_Enum, __pyx_k_pyx_unpickle_Enum, sizeof(__pyx_k_pyx_unpickle_Enum), 0, 0, 1, 1},
   {&__pyx_n_s_pyx_vtable, __pyx_k_pyx_vtable, sizeof(__pyx_k_pyx_vtable), 0, 0, 1, 1},
   {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
   {&__pyx_n_s_real, __pyx_k_real, sizeof(__pyx_k_real), 0, 0, 1, 1},
+  {&__pyx_n_s_real_size, __pyx_k_real_size, sizeof(__pyx_k_real_size), 0, 0, 1, 1},
   {&__pyx_n_s_reduce, __pyx_k_reduce, sizeof(__pyx_k_reduce), 0, 0, 1, 1},
   {&__pyx_n_s_reduce_2, __pyx_k_reduce_2, sizeof(__pyx_k_reduce_2), 0, 0, 1, 1},
   {&__pyx_n_s_reduce_cython, __pyx_k_reduce_cython, sizeof(__pyx_k_reduce_cython), 0, 0, 1, 1},
   {&__pyx_n_s_reduce_ex, __pyx_k_reduce_ex, sizeof(__pyx_k_reduce_ex), 0, 0, 1, 1},
   {&__pyx_n_s_refit, __pyx_k_refit, sizeof(__pyx_k_refit), 0, 0, 1, 1},
   {&__pyx_n_s_remap, __pyx_k_remap, sizeof(__pyx_k_remap), 0, 0, 1, 1},
   {&__pyx_n_s_remap_2, __pyx_k_remap_2, sizeof(__pyx_k_remap_2), 0, 0, 1, 1},
@@ -87151,90 +88602,90 @@
   /* "fastremap.pyx":689
  * @cython.wraparound(False)  # turn off negative index wrapping for entire function
  * @cython.nonecheck(False)
  * def unique_via_array(cnp.ndarray[ALLINT, ndim=1] labels, size_t max_label):             # <<<<<<<<<<<<<<
  *   """
  *   unique(cnp.ndarray[ALLINT, ndim=1] labels, return_counts=False)
  */
-  __pyx_tuple__84 = PyTuple_Pack(7, __pyx_n_s_labels, __pyx_n_s_max_label, __pyx_n_s_counts, __pyx_n_s_voxels, __pyx_n_s_i, __pyx_n_s_segids, __pyx_n_s_cts); if (unlikely(!__pyx_tuple__84)) __PYX_ERR(0, 689, __pyx_L1_error)
+  __pyx_tuple__84 = PyTuple_Pack(9, __pyx_n_s_labels, __pyx_n_s_max_label, __pyx_n_s_counts, __pyx_n_s_voxels, __pyx_n_s_i, __pyx_n_s_real_size, __pyx_n_s_segids, __pyx_n_s_cts, __pyx_n_s_j); if (unlikely(!__pyx_tuple__84)) __PYX_ERR(0, 689, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__84);
   __Pyx_GIVEREF(__pyx_tuple__84);
-  __pyx_codeobj__85 = (PyObject*)__Pyx_PyCode_New(2, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__84, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_unique_via_array, 689, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__85)) __PYX_ERR(0, 689, __pyx_L1_error)
+  __pyx_codeobj__85 = (PyObject*)__Pyx_PyCode_New(2, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__84, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_unique_via_array, 689, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__85)) __PYX_ERR(0, 689, __pyx_L1_error)
 
-  /* "fastremap.pyx":716
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
+  /* "fastremap.pyx":727
+ *   return segids, cts
  * 
  * def transpose(arr):             # <<<<<<<<<<<<<<
  *   """
  *   transpose(arr)
  */
-  __pyx_tuple__86 = PyTuple_Pack(5, __pyx_n_s_arr, __pyx_n_s_shape, __pyx_n_s_strides, __pyx_n_s_nbytes, __pyx_n_s_dtype); if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 716, __pyx_L1_error)
+  __pyx_tuple__86 = PyTuple_Pack(5, __pyx_n_s_arr, __pyx_n_s_shape, __pyx_n_s_strides, __pyx_n_s_nbytes, __pyx_n_s_dtype); if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__86);
   __Pyx_GIVEREF(__pyx_tuple__86);
-  __pyx_codeobj__87 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__86, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_transpose, 716, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__87)) __PYX_ERR(0, 716, __pyx_L1_error)
+  __pyx_codeobj__87 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__86, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_transpose, 727, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__87)) __PYX_ERR(0, 727, __pyx_L1_error)
 
-  /* "fastremap.pyx":751
+  /* "fastremap.pyx":762
  *     return arr.T
  * 
  * def asfortranarray(arr):             # <<<<<<<<<<<<<<
  *   """
  *   asfortranarray(arr)
  */
-  __pyx_tuple__88 = PyTuple_Pack(5, __pyx_n_s_arr, __pyx_n_s_shape, __pyx_n_s_strides, __pyx_n_s_nbytes, __pyx_n_s_dtype); if (unlikely(!__pyx_tuple__88)) __PYX_ERR(0, 751, __pyx_L1_error)
+  __pyx_tuple__88 = PyTuple_Pack(5, __pyx_n_s_arr, __pyx_n_s_shape, __pyx_n_s_strides, __pyx_n_s_nbytes, __pyx_n_s_dtype); if (unlikely(!__pyx_tuple__88)) __PYX_ERR(0, 762, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__88);
   __Pyx_GIVEREF(__pyx_tuple__88);
-  __pyx_codeobj__89 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__88, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_asfortranarray, 751, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__89)) __PYX_ERR(0, 751, __pyx_L1_error)
+  __pyx_codeobj__89 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__88, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_asfortranarray, 762, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__89)) __PYX_ERR(0, 762, __pyx_L1_error)
 
-  /* "fastremap.pyx":799
+  /* "fastremap.pyx":810
  *     return np.asfortranarray(arr)
  * 
  * def ascontiguousarray(arr):             # <<<<<<<<<<<<<<
  *   """
  *   ascontiguousarray(arr)
  */
-  __pyx_tuple__90 = PyTuple_Pack(5, __pyx_n_s_arr, __pyx_n_s_shape, __pyx_n_s_strides, __pyx_n_s_nbytes, __pyx_n_s_dtype); if (unlikely(!__pyx_tuple__90)) __PYX_ERR(0, 799, __pyx_L1_error)
+  __pyx_tuple__90 = PyTuple_Pack(5, __pyx_n_s_arr, __pyx_n_s_shape, __pyx_n_s_strides, __pyx_n_s_nbytes, __pyx_n_s_dtype); if (unlikely(!__pyx_tuple__90)) __PYX_ERR(0, 810, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__90);
   __Pyx_GIVEREF(__pyx_tuple__90);
-  __pyx_codeobj__91 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__90, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_ascontiguousarray, 799, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__91)) __PYX_ERR(0, 799, __pyx_L1_error)
+  __pyx_codeobj__91 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__90, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_ascontiguousarray, 810, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__91)) __PYX_ERR(0, 810, __pyx_L1_error)
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
-  __pyx_tuple__92 = PyTuple_Pack(5, __pyx_n_s_arr, __pyx_n_s_arrview, __pyx_n_s_sx, __pyx_n_s_sy, __pyx_n_s_nbytes); if (unlikely(!__pyx_tuple__92)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_tuple__92 = PyTuple_Pack(5, __pyx_n_s_arr, __pyx_n_s_arrview, __pyx_n_s_sx, __pyx_n_s_sy, __pyx_n_s_nbytes); if (unlikely(!__pyx_tuple__92)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__92);
   __Pyx_GIVEREF(__pyx_tuple__92);
-  __pyx_codeobj__93 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__92, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_ipt2d, 851, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__93)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_codeobj__93 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__92, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_ipt2d, 862, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__93)) __PYX_ERR(0, 862, __pyx_L1_error)
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
-  __pyx_tuple__94 = PyTuple_Pack(6, __pyx_n_s_arr, __pyx_n_s_arrview, __pyx_n_s_sx, __pyx_n_s_sy, __pyx_n_s_sz, __pyx_n_s_nbytes); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_tuple__94 = PyTuple_Pack(6, __pyx_n_s_arr, __pyx_n_s_arrview, __pyx_n_s_sx, __pyx_n_s_sy, __pyx_n_s_sz, __pyx_n_s_nbytes); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__94);
   __Pyx_GIVEREF(__pyx_tuple__94);
-  __pyx_codeobj__95 = (PyObject*)__Pyx_PyCode_New(1, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__94, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_ipt3d, 892, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__95)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_codeobj__95 = (PyObject*)__Pyx_PyCode_New(1, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__94, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_ipt3d, 903, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__95)) __PYX_ERR(0, 903, __pyx_L1_error)
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
-  __pyx_tuple__96 = PyTuple_Pack(7, __pyx_n_s_arr, __pyx_n_s_arrview, __pyx_n_s_sx, __pyx_n_s_sy, __pyx_n_s_sz, __pyx_n_s_sw, __pyx_n_s_nbytes); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_tuple__96 = PyTuple_Pack(7, __pyx_n_s_arr, __pyx_n_s_arrview, __pyx_n_s_sx, __pyx_n_s_sy, __pyx_n_s_sz, __pyx_n_s_sw, __pyx_n_s_nbytes); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__96);
   __Pyx_GIVEREF(__pyx_tuple__96);
-  __pyx_codeobj__97 = (PyObject*)__Pyx_PyCode_New(1, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__96, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_ipt4d, 936, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__97)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_codeobj__97 = (PyObject*)__Pyx_PyCode_New(1, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__96, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastremap_pyx, __pyx_n_s_ipt4d, 947, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__97)) __PYX_ERR(0, 947, __pyx_L1_error)
 
   /* "View.MemoryView":286
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
@@ -87736,23 +89187,23 @@
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_2) < 0) __PYX_ERR(0, 27, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "fastremap.pyx":30
  * cimport numpy as cnp
  * 
- * __version__ = '1.9.1'             # <<<<<<<<<<<<<<
+ * __version__ = '1.9.2'             # <<<<<<<<<<<<<<
  * __VERSION__ = __version__
  * 
  */
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_version, __pyx_kp_u_1_9_1) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_version, __pyx_kp_u_1_9_2) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
 
   /* "fastremap.pyx":31
  * 
- * __version__ = '1.9.1'
+ * __version__ = '1.9.2'
  * __VERSION__ = __version__             # <<<<<<<<<<<<<<
  * 
  * ctypedef fused UINT:
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_version); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 31, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_VERSION, __pyx_t_2) < 0) __PYX_ERR(0, 31, __pyx_L1_error)
@@ -88524,264 +89975,264 @@
   __Pyx_GOTREF(__pyx_t_19);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_19, __pyx_empty_tuple);
   ((__pyx_FusedFunctionObject *) __pyx_t_19)->__signatures__ = __pyx_t_18;
   __Pyx_GIVEREF(__pyx_t_18);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_unique_via_array, __pyx_t_19) < 0) __PYX_ERR(0, 689, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_19); __pyx_t_19 = 0;
 
-  /* "fastremap.pyx":716
- *   return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
+  /* "fastremap.pyx":727
+ *   return segids, cts
  * 
  * def transpose(arr):             # <<<<<<<<<<<<<<
  *   """
  *   transpose(arr)
  */
-  __pyx_t_20 = PyCFunction_NewEx(&__pyx_mdef_9fastremap_43transpose, NULL, __pyx_n_s_fastremap); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 716, __pyx_L1_error)
+  __pyx_t_20 = PyCFunction_NewEx(&__pyx_mdef_9fastremap_43transpose, NULL, __pyx_n_s_fastremap); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_20);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_transpose, __pyx_t_20) < 0) __PYX_ERR(0, 716, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_transpose, __pyx_t_20) < 0) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
 
-  /* "fastremap.pyx":751
+  /* "fastremap.pyx":762
  *     return arr.T
  * 
  * def asfortranarray(arr):             # <<<<<<<<<<<<<<
  *   """
  *   asfortranarray(arr)
  */
-  __pyx_t_20 = PyCFunction_NewEx(&__pyx_mdef_9fastremap_45asfortranarray, NULL, __pyx_n_s_fastremap); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 751, __pyx_L1_error)
+  __pyx_t_20 = PyCFunction_NewEx(&__pyx_mdef_9fastremap_45asfortranarray, NULL, __pyx_n_s_fastremap); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 762, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_20);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_asfortranarray, __pyx_t_20) < 0) __PYX_ERR(0, 751, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_asfortranarray, __pyx_t_20) < 0) __PYX_ERR(0, 762, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
 
-  /* "fastremap.pyx":799
+  /* "fastremap.pyx":810
  *     return np.asfortranarray(arr)
  * 
  * def ascontiguousarray(arr):             # <<<<<<<<<<<<<<
  *   """
  *   ascontiguousarray(arr)
  */
-  __pyx_t_20 = PyCFunction_NewEx(&__pyx_mdef_9fastremap_47ascontiguousarray, NULL, __pyx_n_s_fastremap); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 799, __pyx_L1_error)
+  __pyx_t_20 = PyCFunction_NewEx(&__pyx_mdef_9fastremap_47ascontiguousarray, NULL, __pyx_n_s_fastremap); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 810, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_20);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ascontiguousarray, __pyx_t_20) < 0) __PYX_ERR(0, 799, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ascontiguousarray, __pyx_t_20) < 0) __PYX_ERR(0, 810, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
 
-  /* "fastremap.pyx":851
+  /* "fastremap.pyx":862
  *     return np.ascontiguousarray(arr)
  * 
  * def ipt2d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=2] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:] arrview = arr
  * 
  */
-  __pyx_t_20 = __Pyx_PyDict_NewPresized(11); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_20 = __Pyx_PyDict_NewPresized(11); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_20);
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_0__pyx_mdef_9fastremap_221ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_0__pyx_mdef_9fastremap_221ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_uint8_t, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_uint8_t, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_1__pyx_mdef_9fastremap_223ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_1__pyx_mdef_9fastremap_223ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_uint16_t, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_uint16_t, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_2__pyx_mdef_9fastremap_225ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_2__pyx_mdef_9fastremap_225ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_uint32_t, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_uint32_t, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_3__pyx_mdef_9fastremap_227ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_3__pyx_mdef_9fastremap_227ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_uint64_t, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_uint64_t, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_4__pyx_mdef_9fastremap_229ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_4__pyx_mdef_9fastremap_229ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_int8_t, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_int8_t, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_5__pyx_mdef_9fastremap_231ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_5__pyx_mdef_9fastremap_231ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_int16_t, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_int16_t, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_6__pyx_mdef_9fastremap_233ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_6__pyx_mdef_9fastremap_233ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_int32_t, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_int32_t, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_7__pyx_mdef_9fastremap_235ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_7__pyx_mdef_9fastremap_235ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_int64_t, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_int64_t, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_8__pyx_mdef_9fastremap_237ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_8__pyx_mdef_9fastremap_237ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_float, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_float, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_9__pyx_mdef_9fastremap_239ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_9__pyx_mdef_9fastremap_239ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_double, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_20, __pyx_n_s_double, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_10__pyx_mdef_9fastremap_241ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_fuse_10__pyx_mdef_9fastremap_241ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_20, __pyx_kp_s_float_complex, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_20, __pyx_kp_s_float_complex, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_mdef_9fastremap_49ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_21 = __pyx_FusedFunction_NewEx(&__pyx_mdef_9fastremap_49ipt2d, 0, __pyx_n_s_ipt2d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__93)); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_21);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_21, __pyx_empty_tuple);
   ((__pyx_FusedFunctionObject *) __pyx_t_21)->__signatures__ = __pyx_t_20;
   __Pyx_GIVEREF(__pyx_t_20);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ipt2d, __pyx_t_21) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ipt2d, __pyx_t_21) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
 
-  /* "fastremap.pyx":892
+  /* "fastremap.pyx":903
  *   return arr
  * 
  * def ipt3d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=3] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:] arrview = arr
  * 
  */
-  __pyx_t_22 = __Pyx_PyDict_NewPresized(11); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_22 = __Pyx_PyDict_NewPresized(11); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_22);
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_0__pyx_mdef_9fastremap_245ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_0__pyx_mdef_9fastremap_245ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_uint8_t, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_uint8_t, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_1__pyx_mdef_9fastremap_247ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_1__pyx_mdef_9fastremap_247ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_uint16_t, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_uint16_t, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_2__pyx_mdef_9fastremap_249ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_2__pyx_mdef_9fastremap_249ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_uint32_t, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_uint32_t, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_3__pyx_mdef_9fastremap_251ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_3__pyx_mdef_9fastremap_251ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_uint64_t, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_uint64_t, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_4__pyx_mdef_9fastremap_253ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_4__pyx_mdef_9fastremap_253ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_int8_t, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_int8_t, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_5__pyx_mdef_9fastremap_255ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_5__pyx_mdef_9fastremap_255ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_int16_t, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_int16_t, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_6__pyx_mdef_9fastremap_257ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_6__pyx_mdef_9fastremap_257ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_int32_t, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_int32_t, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_7__pyx_mdef_9fastremap_259ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_7__pyx_mdef_9fastremap_259ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_int64_t, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_int64_t, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_8__pyx_mdef_9fastremap_261ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_8__pyx_mdef_9fastremap_261ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_float, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_float, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_9__pyx_mdef_9fastremap_263ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_9__pyx_mdef_9fastremap_263ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_double, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_22, __pyx_n_s_double, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_10__pyx_mdef_9fastremap_265ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_fuse_10__pyx_mdef_9fastremap_265ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_22, __pyx_kp_s_float_complex, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_22, __pyx_kp_s_float_complex, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
-  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_mdef_9fastremap_51ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_23 = __pyx_FusedFunction_NewEx(&__pyx_mdef_9fastremap_51ipt3d, 0, __pyx_n_s_ipt3d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__95)); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_23);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_23, __pyx_empty_tuple);
   ((__pyx_FusedFunctionObject *) __pyx_t_23)->__signatures__ = __pyx_t_22;
   __Pyx_GIVEREF(__pyx_t_22);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ipt3d, __pyx_t_23) < 0) __PYX_ERR(0, 892, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ipt3d, __pyx_t_23) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
 
-  /* "fastremap.pyx":936
+  /* "fastremap.pyx":947
  *   return arr
  * 
  * def ipt4d(cnp.ndarray[COMPLEX_NUMBER, cast=True, ndim=4] arr):             # <<<<<<<<<<<<<<
  *   cdef COMPLEX_NUMBER[:,:,:,:] arrview = arr
  * 
  */
-  __pyx_t_24 = __Pyx_PyDict_NewPresized(11); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_24 = __Pyx_PyDict_NewPresized(11); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_24);
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_0__pyx_mdef_9fastremap_269ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_0__pyx_mdef_9fastremap_269ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_uint8_t, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_uint8_t, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_1__pyx_mdef_9fastremap_271ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_1__pyx_mdef_9fastremap_271ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_uint16_t, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_uint16_t, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_2__pyx_mdef_9fastremap_273ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_2__pyx_mdef_9fastremap_273ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_uint32_t, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_uint32_t, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_3__pyx_mdef_9fastremap_275ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_3__pyx_mdef_9fastremap_275ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_uint64_t, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_uint64_t, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_4__pyx_mdef_9fastremap_277ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_4__pyx_mdef_9fastremap_277ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_int8_t, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_int8_t, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_5__pyx_mdef_9fastremap_279ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_5__pyx_mdef_9fastremap_279ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_int16_t, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_int16_t, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_6__pyx_mdef_9fastremap_281ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_6__pyx_mdef_9fastremap_281ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_int32_t, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_int32_t, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_7__pyx_mdef_9fastremap_283ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_7__pyx_mdef_9fastremap_283ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_int64_t, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_int64_t, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_8__pyx_mdef_9fastremap_285ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_8__pyx_mdef_9fastremap_285ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_float, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_float, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_9__pyx_mdef_9fastremap_287ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_9__pyx_mdef_9fastremap_287ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_double, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_24, __pyx_n_s_double, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_10__pyx_mdef_9fastremap_289ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_fuse_10__pyx_mdef_9fastremap_289ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
-  if (PyDict_SetItem(__pyx_t_24, __pyx_kp_s_float_complex, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_24, __pyx_kp_s_float_complex, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_mdef_9fastremap_53ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 936, __pyx_L1_error)
+  __pyx_t_25 = __pyx_FusedFunction_NewEx(&__pyx_mdef_9fastremap_53ipt4d, 0, __pyx_n_s_ipt4d, NULL, __pyx_n_s_fastremap, __pyx_d, ((PyObject *)__pyx_codeobj__97)); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_25, __pyx_empty_tuple);
   ((__pyx_FusedFunctionObject *) __pyx_t_25)->__signatures__ = __pyx_t_24;
   __Pyx_GIVEREF(__pyx_t_24);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ipt4d, __pyx_t_25) < 0) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_ipt4d, __pyx_t_25) < 0) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
   /* "fastremap.pyx":1
  * """             # <<<<<<<<<<<<<<
  * Functions related to remapping image volumes.
  * 
  */
```

### Comparing `fastremap-1.9.1/Dockerfile` & `fastremap-1.9.2/Dockerfile`

 * *Files identical despite different names*

### Comparing `fastremap-1.9.1/.travis.yml` & `fastremap-1.9.2/.travis.yml`

 * *Files identical despite different names*

### Comparing `fastremap-1.9.1/test.cpp` & `fastremap-1.9.2/test.cpp`

 * *Files identical despite different names*

### Comparing `fastremap-1.9.1/fastremap.egg-info/PKG-INFO` & `fastremap-1.9.2/fastremap.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: fastremap
-Version: 1.9.1
+Version: 1.9.2
 Summary: Remap, mask, renumber, and in-place transpose numpy arrays.
 Home-page: https://github.com/seung-lab/fastremap/
 Author: William Silversmith
 Author-email: ws9@princeton.edu
 License: LGPLv3
 Description: [![Build Status](https://travis-ci.org/seung-lab/fastremap.svg?branch=master)](https://travis-ci.org/seung-lab/fastremap) [![PyPI version](https://badge.fury.io/py/fastremap.svg)](https://badge.fury.io/py/fastremap)
```

### Comparing `fastremap-1.9.1/PKG-INFO` & `fastremap-1.9.2/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: fastremap
-Version: 1.9.1
+Version: 1.9.2
 Summary: Remap, mask, renumber, and in-place transpose numpy arrays.
 Home-page: https://github.com/seung-lab/fastremap/
 Author: William Silversmith
 Author-email: ws9@princeton.edu
 License: LGPLv3
 Description: [![Build Status](https://travis-ci.org/seung-lab/fastremap.svg?branch=master)](https://travis-ci.org/seung-lab/fastremap) [![PyPI version](https://badge.fury.io/py/fastremap.svg)](https://badge.fury.io/py/fastremap)
```

### Comparing `fastremap-1.9.1/ChangeLog` & `fastremap-1.9.2/ChangeLog`

 * *Files 8% similar despite different names*

```diff
@@ -1,10 +1,16 @@
 CHANGES
 =======
 
+1.9.2
+-----
+
+* release(1.9.2): fixed performance issue with fastremap.unique
+* perf: faster unique\_va\_array
+
 1.9.1
 -----
 
 * release(1.9.1): ipt handles 64-bit addressable arrays
 * fix: support 64-bit addressable volumes for IPT
 
 1.9.0
```

### Comparing `fastremap-1.9.1/README.md` & `fastremap-1.9.2/README.md`

 * *Files identical despite different names*

### Comparing `fastremap-1.9.1/fastremap.pyx` & `fastremap-1.9.2/fastremap.pyx`

 * *Files 0% similar despite different names*

```diff
@@ -23,15 +23,15 @@
 
 from functools import reduce
 import operator
 
 import numpy as np
 cimport numpy as cnp
 
-__version__ = '1.9.1'
+__version__ = '1.9.2'
 __VERSION__ = __version__
 
 ctypedef fused UINT:
   uint8_t
   uint16_t
   uint32_t
   uint64_t
@@ -699,23 +699,34 @@
   )
 
   cdef size_t voxels = labels.shape[0]
   cdef size_t i = 0
   for i in range(voxels):
     counts[labels[i]] += 1
 
-  cdef list segids = []
-  cdef list cts = []
+  cdef size_t real_size = 0
+  for i in range(max_label + 1):
+    if counts[i] > 0:
+      real_size += 1
 
+  cdef cnp.ndarray[ALLINT, ndim=1] segids = np.zeros( 
+    (real_size,), dtype=labels.dtype
+  )
+  cdef cnp.ndarray[uint32_t, ndim=1] cts = np.zeros( 
+    (real_size,), dtype=np.uint32
+  )
+
+  cdef size_t j = 0
   for i in range(max_label + 1):
     if counts[i] > 0:
-      segids.append(i)
-      cts.append(counts[i])
+      segids[j] = i
+      cts[j] = counts[i]
+      j += 1
 
-  return np.array(segids, dtype=labels.dtype), np.array(cts, dtype=np.uint32)
+  return segids, cts
   
 def transpose(arr):
   """
   transpose(arr)
 
   For up to four dimensional matrices, perform in-place transposition. 
   Square matrices up to three dimensions are faster than numpy's out-of-place
```

### Comparing `fastremap-1.9.1/setup.py` & `fastremap-1.9.2/setup.py`

 * *Files identical despite different names*

### Comparing `fastremap-1.9.1/automated_test.py` & `fastremap-1.9.2/automated_test.py`

 * *Files identical despite different names*

### Comparing `fastremap-1.9.1/LICENSE` & `fastremap-1.9.2/LICENSE`

 * *Files identical despite different names*

### Comparing `fastremap-1.9.1/setup.cfg` & `fastremap-1.9.2/setup.cfg`

 * *Files identical despite different names*

